# 菜单重构总结

## 重构日期
2025-01-21

## 重构目标
按照 `menu-structure.md` 文档要求，重新梳理左侧菜单结构，实现菜单分组架构。

## 主要改动

### 1. 菜单分组结构

按照文档要求，菜单已分为四组：

#### 【第一组】固定仪表盘
- **可见范围**：平台级、系统级、应用级 都可见
- **菜单项**：
  - 📊 仪表盘 (`/dashboard`)

#### 【第二组】应用菜单（插件式加载）
- **可见范围**：根据用户权限和已安装插件动态加载
- **当前状态**：预留位置，待插件系统实现后动态加载
- **设计要点**：
  - 插件式的菜单按分组菜单设计
  - 应用的名称作为分组名，不可点击，只显示
  - 插件里的菜单直接显示到左侧菜单

#### 【第三组】系统菜单
- **可见范围**：平台级、系统级、应用级 可见
- **当前菜单项**：
  - 👤 用户管理 (`/users`) - 已基本完成
  - 👥 角色管理 (`/roles`) - 已基本完成
- **已移除**：
  - ❌ 组织管理 (`/tenants`) - 已移至运营中心（第四组）
- **待开发**：
  - 权限管理
  - 系统配置
  - 日志管理

#### 【第四组】运营中心
- **可见范围**：仅平台级管理员可见
- **菜单项**：
  - 📊 运营看板 (`/operations/dashboard`) - 已基本完成
  - 🏢 组织管理 (`/operations/tenants`) - 已基本完成
  - 📈 系统状态 (`/operations/monitoring`) - 已基本完成
  - 📦 套餐管理 (`/operations/packages`) - 待完善

### 2. 代码改动

#### 文件：`riveredge-shell/src/layouts/BasicLayout.tsx`

**改动内容**：

1. **菜单配置重构** (`menuConfig`)
   - 添加了详细的分组注释
   - 移除了第三组中的组织管理菜单
   - 添加了第二组应用菜单的预留位置和示例结构
   - 添加了 TODO 注释，标注待开发功能

2. **权限过滤逻辑优化** (`filteredMenuData`)
   - 更新了权限控制注释说明
   - 移除了对第三组组织管理的过滤逻辑（因为已移除）
   - 添加了应用菜单权限过滤的 TODO 注释

### 3. 权限控制规则

| 用户级别 | 可见菜单组 |
|---------|-----------|
| 平台级管理员 | 第一组 + 第二组 + 第三组 + 第四组 |
| 系统级管理员 | 第一组 + 第二组 + 第三组 |
| 应用级用户 | 第一组 + 第二组（根据权限过滤） |

### 4. 后续开发计划

#### 短期（系统菜单完善）
- [ ] 权限管理功能开发
- [ ] 系统配置功能开发
- [ ] 日志管理功能开发

#### 中期（应用菜单插件化）
- [ ] 插件系统架构设计
- [ ] 插件菜单注册机制
- [ ] 插件菜单动态加载
- [ ] 插件菜单权限控制

#### 长期（菜单增强）
- [ ] 菜单分组可视化（分隔线或分组标题）
- [ ] 菜单折叠/展开功能
- [ ] 菜单排序和自定义
- [ ] 菜单缓存和懒加载

## 注意事项

1. **组织管理位置变更**
   - 原位置：第三组系统菜单
   - 新位置：第四组运营中心
   - 影响：系统级管理员和应用级用户不再可见组织管理菜单

2. **应用菜单预留**
   - 第二组应用菜单目前为空
   - 待插件系统实现后，将从插件系统动态加载
   - 插件菜单将按分组显示，应用名称作为分组标题

3. **权限控制**
   - 运营中心（第四组）仅平台级管理员可见
   - 系统菜单（第三组）所有级别可见，但根据具体功能可能有权限点控制

## 验证清单

- [x] 菜单结构按照文档要求重新组织
- [x] 组织管理从第三组移除
- [x] 组织管理保留在第四组运营中心
- [x] 权限过滤逻辑更新
- [x] 代码注释完善
- [x] 无语法错误
- [x] 符合框架开发规范

## 相关文档

- [菜单结构设计文档](./menu-structure.md)
- [框架开发规范](../../Farming%20Plan/2.rules/README.md)

