# AI 助手操作前强制检查清单

## ⚠️ 绝对规则 - 违反即终止

在执行任何代码生成、修改、创建操作之前，必须逐项检查以下规则：

### 1. 库选择优先级检查 ⭐ **第一优先级**

**在执行任何操作前，必须按顺序检查：**

1. ✅ **是否优先检查了官方库？**
   - React 官方是否有推荐方式？
   - Ant Design Pro Components 官方是否有推荐方式？
   - TanStack Query 官方是否有推荐方式？
   - React Router DOM 官方是否有推荐方式？

2. ✅ **是否优先检查了官方文档？**
   - 是否查看了官方文档的最佳实践？
   - 是否查看了官方示例代码？

3. ✅ **是否避免了自定义实现？**
   - 官方库能满足需求吗？
   - 是否有成熟稳定的第三方库？
   - 只有在官方库和成熟库都无法满足时，才考虑自定义实现

### 2. 禁止重复造轮子检查

**在执行任何操作前，必须检查：**

- ❌ **禁止自己实现 API 请求封装**（使用官方推荐方式）
- ❌ **禁止自己实现状态管理**（使用 Zustand 官方方式）
- ❌ **禁止自己实现数据获取**（使用 TanStack Query 官方方式）
- ❌ **禁止跳过官方推荐方式**（必须先使用官方方式）

### 3. 操作前强制检查流程

**每次代码生成/修改前，必须执行：**

1. **第一步：检查官方库**
   ```bash
   # 伪代码示例
   if (需要实现功能) {
       先检查官方库是否有推荐方式
       如果有，使用官方方式
       如果没有，检查成熟第三方库
       如果都没有，才考虑自定义实现
   }
   ```

2. **第二步：验证是否符合规则**
   - 是否使用了官方推荐方式？
   - 是否避免了自定义实现？
   - 是否遵循了库选择优先级？

3. **第三步：如果违反规则，立即停止**
   - 不要继续操作
   - 不要生成代码
   - 不要创建文件
   - 明确说明违反了哪条规则

## 具体规则引用

### 库选择优先级规范（来自 .cursorrules）

**第一优先级：官方库**
- ✅ 优先使用官方提供的库和组件
- ✅ 优先使用官方推荐的扩展和插件
- ✅ 优先使用官方文档中的最佳实践

**第二优先级：成熟库**
- ✅ 如果官方库不满足需求，优先查找成熟稳定的第三方库

**第三优先级：自定义实现**
- ⚠️ 只有在官方库和成熟库都无法满足需求时，才考虑自己实现

### 禁止事项（来自 .cursorrules）

- ❌ **禁止跳过优先级检查**：必须按照优先级顺序检查
- ❌ **禁止直接使用第三方库**：必须先检查官方库
- ❌ **禁止使用不成熟的库**：必须选择成熟稳定的库
- ❌ **禁止重复造轮子**：官方库或成熟库能满足需求时，禁止自己实现

## 检查清单使用说明

**每次执行操作前，必须：**

1. 打开此文件
2. 逐项检查所有规则
3. 确认符合所有规则后，才能执行操作
4. 如果发现违反规则，立即停止并说明原因

## 历史教训

**2025-11-19：违反规则案例**
- ❌ 自己实现了连接池管理函数（`ensure_db_connection`, `_reinit_connection_pool` 等）
- ❌ 没有先检查 Tortoise ORM 官方是否有 `register_tortoise`
- ❌ 重复造轮子，违反了"禁止重复造轮子"规则
- ✅ 正确做法：使用 Tortoise ORM 官方推荐的 `register_tortoise`

**必须永远记住：先检查官方库，再考虑其他方案！**

