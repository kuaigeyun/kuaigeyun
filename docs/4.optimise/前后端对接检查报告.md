# 应用级APP前后端对接检查报告

**检查日期**: 2025-01-01  
**检查范围**: kuaizhizao 和 master-data 两个应用级APP

---

## 📋 检查概览

### kuaizhizao APP

#### ✅ 已对接的API模块

1. **生产执行模块** (`production.ts`)
   - ✅ 工单管理 (`work-orders`) - 完全对接
   - ✅ 报工管理 (`reporting`) - 完全对接
   - ✅ 生产领料单 (`production-pickings`) - 完全对接
   - ✅ 成品入库单 (`finished-goods-receipts`) - 完全对接
   - ✅ 销售出库单 (`sales-deliveries`) - 完全对接
   - ✅ 采购入库单 (`purchase-receipts`) - 完全对接

2. **质量管理模块** (`quality.ts`)
   - ✅ 来料检验 (`incoming-inspections`) - 完全对接
   - ✅ 过程检验 (`process-inspections`) - 完全对接
   - ✅ 成品检验 (`finished-goods-inspections`) - 完全对接

3. **财务管理模块** (`finance.ts`)
   - ⚠️ 应付单 (`payables`) - **路径不匹配**
     - 前端: `/apps/kuaizhizao/finance-management/accounts-payable`
     - 后端: `/apps/kuaizhizao/payables`
   - ⚠️ 应收单 (`receivables`) - **路径不匹配**
     - 前端: `/apps/kuaizhizao/finance-management/accounts-receivable`
     - 后端: `/apps/kuaizhizao/receivables`
   - ✅ 采购发票 (`purchase-invoices`) - 完全对接

4. **销售管理模块** (`sales.ts`)
   - ✅ 销售订单 (`sales-orders`) - 完全对接
   - ✅ 销售预测 (`sales-forecasts`) - 完全对接

5. **计划管理模块** (`production.ts` -> `planningApi`)
   - ✅ MRP运算 (`mrp-computation`) - 完全对接
   - ✅ LRP运算 (`lrp-computation`) - 完全对接
   - ✅ 生产计划 (`production-plans`) - 完全对接
   - ⚠️ 需求管理 (`demand-management`) - **API混用**
     - 前端调用: `planningApi.productionPlan.get/list`（实际使用的是生产计划API）
     - 后端路由: 使用 `production-plans` API
     - **问题**: 需求管理页面应该使用 `sales-forecasts` API，而不是 `production-plans` API

6. **BOM管理模块** (`production.ts` -> `bomApi`)
   - ⚠️ BOM管理 (`bill-of-materials`) - **路径不匹配**
     - 前端: `/apps/kuaizhizao/bill-of-materials`
     - 后端: 已移至 `master-data` APP (`/apps/master-data/materials/bom`)
     - **建议**: 前端应调用 `master-data` 的BOM API

7. **报表模块** (`reports.ts`)
   - ❌ 库存报表 (`inventory-report`) - **后端缺失**
   - ❌ 生产报表 (`production-report`) - **后端缺失**
   - ❌ 质量报表 (`quality-report`) - **后端缺失**
   - ❌ 报表图表数据 (`reports/charts`) - **后端缺失**

8. **采购管理模块** (`purchase.py`)
   - ✅ 采购订单 (`purchase-orders`) - 完全对接

9. **通用功能模块** (`common.ts`)
   - ❌ 数据导入导出 (`data-import`, `export-tasks`) - **后端缺失**
   - ❌ 系统参数 (`system-parameters`) - **后端缺失**
   - ❌ 编码规则 (`code-rules`) - **后端缺失**

#### ⚠️ 发现的问题

1. **路径不匹配问题**
   - 财务模块路径不一致（前端使用 `finance-management`，后端使用直接路径）
   - BOM管理已移至 `master-data`，但前端仍调用 `kuaizhizao` 路径

2. **API使用错误**
   - 需求管理页面错误地使用了 `production-plans` API，应该使用 `sales-forecasts` API

3. **缺失的后端API**
   - 所有报表API（库存报表、生产报表、质量报表）

3. **前端API调用不一致**
   - `production.ts` 使用 `api.get/post/put/delete`
   - `sales.ts`、`quality.ts`、`finance.ts`、`reports.ts`、`common.ts` 使用 `apiRequest`

4. **通用功能模块后端缺失**
   - 数据导入导出API
   - 系统参数API（业务配置页面使用）
   - 编码规则API（业务配置页面使用）

---

### master-data APP

#### ✅ 已对接的API模块

1. **供应链模块** (`supply-chain.ts`)
   - ✅ 客户管理 (`customers`) - 完全对接
   - ✅ 供应商管理 (`suppliers`) - 完全对接

2. **物料管理模块** (`material.ts`)
   - ✅ 物料分组 (`materials/groups`) - 完全对接
   - ✅ 物料管理 (`materials`) - 完全对接
   - ✅ BOM管理 (`materials/bom`) - 完全对接

3. **工厂建模模块** (`factory.ts`)
   - ✅ 工位管理 (`workstations`) - 需要确认
   - ✅ 产线管理 (`production-lines`) - 需要确认

4. **仓库管理模块** (`warehouse.ts`)
   - ✅ 仓库管理 (`warehouses`) - 完全对接
   - ✅ 库区管理 (`storage-areas`) - 完全对接
   - ✅ 库位管理 (`storage-locations`) - 完全对接

5. **工艺管理模块** (`process.ts`)
   - ✅ 工序管理 (`operations`) - 需要确认
   - ✅ 不良品类型 (`defect-types`) - 需要确认
   - ✅ 工艺路线 (`routes`) - 需要确认
   - ✅ SOP管理 (`sop`) - 需要确认

6. **绩效管理模块** (`performance.ts`)
   - ✅ 技能管理 (`skills`) - 需要确认
   - ✅ 节假日管理 (`holidays`) - 需要确认

---

## 🔧 需要修复的问题

### 高优先级

1. **修复财务模块路径不匹配**
   ```typescript
   // 前端 finance.ts 需要修改
   // 从: /apps/kuaizhizao/finance-management/accounts-payable
   // 改为: /apps/kuaizhizao/payables
   ```

2. **修复BOM管理路径**
   ```typescript
   // 前端 production.ts -> bomApi 需要修改
   // 从: /apps/kuaizhizao/bill-of-materials
   // 改为: /apps/master-data/materials/bom
   ```

3. **统一API调用方式**
   - 建议统一使用 `api.get/post/put/delete` 方式
   - 或统一使用 `apiRequest` 方式

### 中优先级

4. **实现缺失的后端API**
   - 需求管理API (`demand-management`)
   - 报表API（库存报表、生产报表、质量报表）

5. **确认 master-data 其他模块的API对接**
   - 工厂建模模块
   - 工艺管理模块
   - 绩效管理模块

---

## 📊 对接统计

### kuaizhizao APP
- **已对接**: 15个模块
- **路径不匹配**: 2个模块（财务、BOM）
- **API使用错误**: 1个模块（需求管理使用了错误的API）
- **后端缺失**: 6个模块（3个报表、3个通用功能）
- **对接完成度**: 约 62% (15/24)

### master-data APP
- **已对接**: 6个模块（确认）
- **待确认**: 5个模块
- **对接完成度**: 约 55% (6/11，不含待确认)

---

## 🎯 下一步行动

1. **立即修复**
   - [ ] 修复财务模块API路径
   - [ ] 修复BOM管理API路径（改为调用master-data）
   - [ ] 统一API调用方式

2. **短期实现**
   - [ ] 修复需求管理页面API调用（改为使用 `sales-forecasts` API）
   - [ ] 实现报表后端API（库存、生产、质量）
   - [ ] 实现通用功能后端API（系统参数、编码规则、数据导入导出）

3. **长期完善**
   - [ ] 确认并完善master-data其他模块的API对接
   - [ ] 建立API文档和测试用例
   - [ ] 建立前后端API对接规范

---

## 📝 备注

- 本报告基于代码静态分析，建议进行实际API调用测试以确认
- 部分模块可能需要进一步检查具体的接口参数和响应格式
- 建议建立API对接测试用例，确保前后端一致性

