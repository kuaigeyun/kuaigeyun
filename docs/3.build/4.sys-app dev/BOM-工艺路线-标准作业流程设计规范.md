# BOM、工艺路线、标准作业流程（SOP）设计规范

> 本文档从《用户使用场景推演-MTS-MTO.md》中提取了关于BOM（物料清单）、工艺路线、标准作业流程（SOP）的核心设计内容，用于强化设计参考。

**提取日期**：2026-01-08  
**来源文档**：用户使用场景推演-MTS-MTO.md  
**设计阶段**：强化设计阶段

> **相关文档**：
> - [物料编码管理设计规范.md](./物料编码管理设计规范.md) - 物料编码映射机制、智能识别重复物料、多编码搜索等详细设计

---

## 目录

1. [BOM（物料清单）管理](#1-bom物料清单管理)
2. [工序和工艺路线配置](#2-工序和工艺路线配置)
3. [标准作业流程（SOP）设计](#3-标准作业流程sop设计)
4. [工序类型和跳转规则](#4-工序类型和跳转规则)

---

## 1. BOM（物料清单）管理

### 1.1 用户操作流程

**第四步：创建BOM（使用universheet批量导入）**

1. 进入"主数据管理" → "产品管理" → "BOM管理"
2. 打开BOM导入universheet在线表格（系统自动创建模板）
3. 在universheet中创建BOM（支持使用任意部门编码，实时保存）：
   - **产品A的BOM示例：**
     ```
     产品A（1个，可使用SALE-A001或DES-A001或主编码MAT-FIN-0001）
     ├── 注塑件A（2个，可使用PROD-A001或主编码MAT-SEMI-0001）
     │   └── 塑料颗粒A（100g，可使用PUR-A001或主编码MAT-RAW-0001）
     ├── 注塑件B（1个，可使用PROD-A002或主编码MAT-SEMI-0002）
     │   └── 塑料颗粒B（50g，可使用PUR-A002或主编码MAT-RAW-0002）
     └── 螺丝（4个，可使用WH-A001或主编码MAT-RAW-0003）
     ```

### 1.2 系统行为

#### 1.2.1 物料编码映射机制（核心功能）

> **详细设计请参考**：[物料编码管理设计规范.md](./物料编码管理设计规范.md)

**核心功能概述**：
- **主编码体系**：系统自动生成主编码（MAT-{类型}-{序号}），作为系统内部唯一标识
- **部门编码保留**：各部门编码作为别名保留，业务可正常使用
- **自动映射**：输入任意部门编码，系统自动映射到主编码
- **智能识别重复物料**：支持高/中/低置信度识别，AI辅助识别
- **物料映射工具**：可视化合并重复物料，建立编码映射关系

#### 1.2.2 多单位管理（核心功能）

- **单位换算**：系统自动在不同单位间进行换算（基于配置的换算比例）
- **单位选择**：在采购、入库、出库、生产等环节，支持选择不同单位
- **自动换算示例**：
  - 采购时使用"吨"，系统自动换算为库存单位"kg"存储
  - 销售时使用"箱"，系统自动换算为库存单位"个"扣减
  - **BOM中使用"kg"，系统自动换算为采购单位"吨"生成采购需求**
- **单位验证**：系统自动验证单位换算的合理性（防止换算错误）
- **多单位库存显示**：库存查询时，支持同时显示多个单位的库存数量

#### 1.2.3 BOM数据管理

- ✅ **批量导入BOM数据**（universheet在线表格，支持使用任意部门编码，实时保存）
- ✅ **自动识别部门编码**，映射到主编码（详见[物料编码管理设计规范.md](./物料编码管理设计规范.md)）
- ✅ **自动验证BOM数据完整性**（父子件关系）
- ✅ **自动生成BOM层级结构**

### 1.3 AI智能建议

通过Inngest AI工作流提供智能建议：

- **智能识别重复物料**（核心功能，详见[物料编码管理设计规范.md](./物料编码管理设计规范.md)）：
  - 基于物料名称、规格、单位等多维度匹配
  - 基于拼音匹配、模糊匹配识别相似物料
  - 基于历史数据学习，提高识别准确率
  - 提供重复物料合并建议
- **分析BOM结构合理性**，建议优化：
  - 检测循环依赖
  - 建议BOM层级优化
- **智能建议单位配置**（核心功能）：
  - 基于物料类型，建议常用单位（如：原材料建议kg、吨，成品建议个、箱）
  - 基于历史数据，建议单位换算比例（如：基于采购历史，建议1箱=1000个）
  - 检测单位配置合理性（如：检测换算比例是否合理）

### 1.4 验收标准

> **物料编码相关验收标准详见**：[物料编码管理设计规范.md](./物料编码管理设计规范.md)

- ✅ **物料编码映射机制正常**（核心功能，详见物料编码管理设计规范）
- ✅ **智能识别重复物料正常**（高/中/低置信度识别，详见物料编码管理设计规范）
- ✅ **物料映射工具正常**（可视化合并重复物料，详见物料编码管理设计规范）
- ✅ **多编码搜索正常**（支持输入任意部门编码搜索，详见物料编码管理设计规范）
- ✅ **多单位管理正常**（核心功能）：
  - ✅ 单位换算功能正常（支持多单位间自动换算）
  - ✅ 单位选择功能正常（采购、入库、出库、生产等环节支持选择不同单位）
  - ✅ 多单位库存显示正常（库存查询时同时显示多个单位的库存数量）
  - ✅ 单位验证功能正常（自动验证单位换算的合理性）
- ✅ **BOM数据导入成功**（支持universheet在线表格批量导入，支持使用任意部门编码，实时保存）
- ✅ **BOM数据验证通过**（多层级BOM展开正常）
- ✅ **AI建议正常显示**（悬浮提示，不打断操作流程）

### 1.5 优化效果

- ⚡ **解决编码不统一问题**：各部门可继续使用原有编码，系统自动映射（详见[物料编码管理设计规范.md](./物料编码管理设计规范.md)）
- ⚡ **不中断业务**：先导入后整理，业务可正常使用
- ⚡ **渐进式整理**：逐步建立映射关系，不强制一次性统一
- ⚡ **智能识别**：AI辅助识别重复物料，减少人工工作量
- ⚡ **灵活使用**：各部门可继续使用原有编码，系统自动映射到主编码
- ⚡ **多单位管理**：支持采购、库存、生产、销售使用不同单位，系统自动换算

---

## 2. 工序和工艺路线配置

### 2.1 用户操作流程

#### 2.1.1 第一步：创建工序（基础工序库）

**进入"主数据管理" → "工艺管理" → "工序管理"**

**方式1：批量导入（推荐）**
- 打开工序导入universheet在线表格（系统自动创建模板）
- 在universheet中填写工序数据（实时保存）：
  - 工序编码、工序名称、工序描述
  - 所属车间、工作中心
  - **工序类型**（核心功能，新增）：
    - 按数量报工：需要输入完成数量、合格数量（如：注塑、组装、包装）
    - 按状态报工：只有完成/未完成状态，无数量概念（如：检验、测试、审批）
  - 标准工时、准备时间
  - **是否允许跳转**（核心功能，新增）：
    - 不允许跳转：必须完成上道工序才能开始下道工序（默认）
    - 允许跳转：可以并行进行，不依赖上道工序完成
  - **默认物料分组**（核心功能，新增）：
    - 可选择物料分组（如：注塑件分组、组装件分组）
    - 同一分组的物料默认使用相同工艺路线
- 点击"导入"按钮，系统自动创建工序

**方式2：快速创建（小企业）**
- 点击"新建"按钮
- 填写工序信息：
  - 工序编码：OP001
  - 工序名称：注塑
  - 所属车间：注塑车间
  - 工作中心：注塑机1
  - **工序类型**：按数量报工（需要输入完成数量、合格数量）
  - **是否允许跳转**：不允许跳转（必须完成上道工序）
  - **默认物料分组**：注塑件分组（可选）
  - 标准工时：10分钟/件
- 提交创建

**常用工序示例**：
- 注塑工序（注塑车间，按数量报工，不允许跳转）
- 组装工序（组装车间，按数量报工，不允许跳转）
- 包装工序（包装车间，按数量报工，不允许跳转）
- 检验工序（质量部，按状态报工，允许跳转）
- 测试工序（测试部，按状态报工，允许跳转）
- 审批工序（管理部，按状态报工，允许跳转）

#### 2.1.2 第二步：创建工艺路线（两种模式）

**进入"主数据管理" → "工艺管理" → "工艺路线管理"**

##### 方式1：简易路线（推荐，中小企业常用）

1. 点击"新建" → 选择"简易路线"
2. **绑定物料或物料分组**（核心功能，新增，参考黑湖小工单）：
   - **方式A：绑定物料分组**（推荐，批量管理）
     - 选择绑定类型：物料分组
     - 选择物料分组：注塑件分组（包含产品A、产品B、产品C）
     - 保存绑定关系
   - **方式B：绑定单个物料**（精确控制）
     - 选择绑定类型：物料
     - 选择物料：产品A
     - 保存绑定关系
   - **注意**：物料优先级大于物料分组，如果物料单独绑定了工艺路线，优先使用物料绑定的工艺路线
3. 拖拽工序设置顺序：
   ```
   工序1：注塑工序（注塑车间，注塑机1，按数量报工，不允许跳转）
   工序2：组装工序（组装车间，组装线1，按数量报工，不允许跳转）
   工序3：包装工序（包装车间，包装线1，按数量报工，不允许跳转）
   ```
4. **设置工序跳转规则**（核心功能，新增）：
   - 工序1：不允许跳转（必须完成上道工序才能开始）
   - 工序2：不允许跳转（必须完成工序1才能开始）
   - 工序3：不允许跳转（必须完成工序2才能开始）
5. 设置每个工序的标准工时和准备时间
6. **支持子工艺路线**（核心功能，新增）：
   - 可以为某个工序设置子工艺路线（如：组装工序的子工艺路线）
   - 子工艺路线可以独立管理，支持嵌套
7. 提交创建
8. **完成，<5分钟**

##### 方式2：带SOP工艺路线（可选，有SOP需求的企业）

1. 点击"新建" → 选择"带SOP工艺路线"
2. **绑定物料或物料分组**（核心功能，新增，参考黑湖小工单）：
   - **方式A：绑定物料分组**（推荐，批量管理）
     - 选择绑定类型：物料分组
     - 选择物料分组：注塑件分组（包含产品A、产品B、产品C）
     - 保存绑定关系
   - **方式B：绑定单个物料**（精确控制）
     - 选择绑定类型：物料
     - 选择物料：产品A
     - 保存绑定关系
   - **注意**：物料优先级大于物料分组，如果物料单独绑定了工艺路线，优先使用物料绑定的工艺路线
3. 拖拽工序设置顺序（同简易路线）
4. **设置工序类型和跳转规则**（核心功能，新增）：
   - 工序1：注塑工序（按数量报工，不允许跳转）
   - 工序2：组装工序（按数量报工，不允许跳转）
   - 工序3：检验工序（按状态报工，允许跳转，可与组装并行）
   - 工序4：包装工序（按数量报工，不允许跳转）
5. **为每个工序关联SOP**：
   - 工序1：注塑工序 → 关联SOP《注塑作业标准》
   - 工序2：组装工序 → 关联SOP《组装作业标准》
   - 工序3：检验工序 → 关联SOP《检验作业标准》
   - 工序4：包装工序 → 关联SOP《包装作业标准》
6. **SOP设计时指定收集参数**（核心功能，新增）：
   - 进入"主数据管理" → "工艺管理" → "SOP管理"
   - 编辑SOP：组装工序SOP《组装作业标准》
   - 进入"报工参数收集"配置页面
   - **配置参数收集表单**（Formily表单设计器）：
     - 参数1：扭矩
       - 参数类型：数字
       - 参数名称：扭矩
       - 单位：N·m
       - 必填：是
       - 验证规则：范围20-30
       - 默认值：25
     - 参数2：外观检查
       - 参数类型：选择
       - 参数名称：外观检查
       - 选项：是/否
       - 必填：是
     - 参数3：备注
       - 参数类型：文本
       - 参数名称：备注
       - 必填：否
   - 保存SOP配置（form_config自动保存）
   - **其他SOP同样配置**：
     - 注塑工序SOP：温度（数字，范围180-200）、压力（数字，范围50-80）、时间（数字）
     - 检验工序SOP：检验结果（选择：合格/不合格）、检验员（文本）
     - 包装工序SOP：包装数量（数字）、标签检查（是/否）
7. **支持子工艺路线**（核心功能，新增）：
   - 可以为某个工序设置子工艺路线（如：组装工序的子工艺路线）
   - 子工艺路线示例：
     ```
     主工艺路线：产品A工艺路线
     ├── 工序1：注塑工序
     ├── 工序2：组装工序
     │   └── 子工艺路线：组装子工艺路线
     │       ├── 子工序1：预组装（按数量报工）
     │       ├── 子工序2：主组装（按数量报工）
     │       └── 子工序3：紧固（按状态报工）
     ├── 工序3：检验工序（按状态报工，允许跳转）
     └── 工序4：包装工序
     ```
8. 设置每个工序的标准工时和准备时间
9. 提交创建
10. **完成，<10分钟**

#### 2.1.3 第三步：关联产品工艺路线（支持物料分组和物料绑定）

**方式1：工艺路线绑定物料分组**（推荐，批量管理）
- 进入"主数据管理" → "工艺管理" → "工艺路线管理"
- 编辑工艺路线：注塑件通用工艺路线
- 进入"绑定物料"页面
- 选择绑定类型：物料分组
- 选择物料分组：注塑件分组（包含产品A、产品B、产品C）
- 保存绑定关系
- **系统自动应用**：
  - 注塑件分组下的所有物料（产品A、产品B、产品C）自动关联该工艺路线
  - 创建工单时，如果物料没有单独绑定工艺路线，则自动使用分组绑定的工艺路线

**方式2：工艺路线绑定单个物料**（精确控制，优先级高于物料分组）
- 进入"主数据管理" → "工艺管理" → "工艺路线管理"
- 编辑工艺路线：产品A专用工艺路线
- 进入"绑定物料"页面
- 选择绑定类型：物料
- 选择物料：产品A
- 保存绑定关系
- **系统自动应用**：
  - 产品A优先使用"产品A专用工艺路线"（即使产品A属于注塑件分组，也优先使用物料绑定的工艺路线）
  - 创建工单时，如果物料有单独绑定的工艺路线，优先使用物料绑定的工艺路线（物料优先级大于物料分组）

**方式3：在物料主数据中直接关联**（传统方式，兼容保留）
- 进入"主数据管理" → "产品管理" → "物料主数据"
- 编辑产品：产品A
- 选择默认工艺路线：产品A工艺路线
- 保存

**优先级规则**（核心功能，参考黑湖小工单）：
- **物料绑定 > 物料分组绑定**：如果物料同时绑定了工艺路线，且物料所属的分组也绑定了工艺路线，优先使用物料绑定的工艺路线
- **自动继承**：如果物料没有单独绑定工艺路线，但所属分组绑定了工艺路线，则自动使用分组绑定的工艺路线
- **创建工单时自动匹配**：新建工单选择物料后，系统自动按优先级匹配工艺路线（物料绑定 → 物料分组绑定）

### 2.2 系统行为

#### 2.2.1 工序管理

- ✅ **批量导入工序**：支持universheet在线表格批量导入工序（一次性完成，实时保存）
- ✅ **工序类型管理**（核心功能，新增）：
  - **按数量报工**：需要输入完成数量、合格数量（如：注塑、组装、包装）
  - **按状态报工**：只有完成/未完成状态，无数量概念（如：检验、测试、审批）
  - 报工时根据工序类型自动显示对应的报工界面
- ✅ **工序跳转控制**（核心功能，新增）：
  - **不允许跳转**：必须完成上道工序才能开始下道工序（默认）
  - **允许跳转**：可以并行进行，不依赖上道工序完成
  - 工单执行时，系统自动校验工序跳转规则
  - 不允许跳转的工序，必须等待上道工序完成才能报工
  - 允许跳转的工序，可以随时报工（不依赖上道工序）

#### 2.2.2 工艺路线管理

- ✅ **工艺路线绑定物料分组或物料**（核心功能，新增，参考黑湖小工单）：
  - **工艺路线可绑定物料分组**：同一分组的物料自动使用相同工艺路线，减少重复配置
  - **工艺路线可绑定单个物料**：支持为特定物料绑定专用工艺路线，精确控制
  - **物料优先级大于物料分组**：如果物料同时绑定了工艺路线，且物料所属的分组也绑定了工艺路线，优先使用物料绑定的工艺路线
  - **自动继承机制**：如果物料没有单独绑定工艺路线，但所属分组绑定了工艺路线，则自动使用分组绑定的工艺路线
  - **创建工单时自动匹配**：新建工单选择物料后，系统自动按优先级匹配工艺路线（物料绑定 → 物料分组绑定）
  - 支持物料分组管理（创建分组、添加物料到分组、设置分组工艺路线）
- ✅ **子工艺路线支持**（核心功能，新增）：
  - 支持为某个工序设置子工艺路线
  - 子工艺路线可以独立管理，支持嵌套
  - 子工艺路线可以有自己的工序顺序、SOP、跳转规则
  - 报工时，先完成子工艺路线的所有工序，才能完成主工序
- ✅ **简易路线**：支持创建简易工艺路线（仅工序顺序，无SOP）
- ✅ **带SOP工艺路线**：支持创建带SOP的工艺路线（工序+SOP）
- ✅ **拖拽排序**：支持拖拽调整工序顺序（可视化操作）
- ✅ **智能默认值**：创建工艺路线时，自动填充标准工时（基于工序）
- ✅ **关联产品**：工艺路线可关联到产品，工单创建时自动应用
- ✅ **关联物料分组**：工艺路线可关联到物料分组，同一分组的产品自动应用（核心功能，新增）

### 2.3 AI智能建议

通过Inngest AI工作流提供智能建议：

- 检测工序配置完整性，提示缺失的关键字段（如：标准工时、工作中心、工序类型、跳转规则）
- 分析工艺路线合理性，建议优化（如：检测工序顺序合理性、建议并行工序、建议设置跳转规则）
- 基于历史数据，建议标准工时设置
- **智能建议工序类型**（核心功能，新增）：
  - 基于工序名称，建议工序类型（如：检验、测试建议按状态报工）
  - 基于历史数据，分析工序类型使用情况
- **智能建议跳转规则**（核心功能，新增）：
  - 基于工序类型，建议跳转规则（如：检验工序建议允许跳转）
  - 基于历史数据，分析工序并行情况

### 2.4 验收标准

- ✅ 工序创建成功（支持universheet在线表格批量导入，实时保存）
- ✅ **工序类型配置成功**（核心功能，新增）：
  - ✅ 按数量报工工序配置成功（需要输入完成数量、合格数量）
  - ✅ 按状态报工工序配置成功（只有完成/未完成状态）
  - ✅ 报工时根据工序类型自动显示对应的报工界面
- ✅ **工序跳转规则配置成功**（核心功能，新增）：
  - ✅ 不允许跳转配置成功（必须完成上道工序才能开始下道工序）
  - ✅ 允许跳转配置成功（可以并行进行）
  - ✅ 工单执行时，系统自动校验工序跳转规则
- ✅ **工艺路线绑定物料分组或物料成功**（核心功能，新增，参考黑湖小工单）：
  - ✅ 工艺路线可以绑定到物料分组（批量管理）
  - ✅ 工艺路线可以绑定到单个物料（精确控制）
  - ✅ 物料优先级大于物料分组（如果物料绑定了工艺路线，优先使用物料绑定的工艺路线）
  - ✅ 自动继承机制正常（如果物料没有绑定，但所属分组绑定了工艺路线，自动使用分组绑定的工艺路线）
  - ✅ 创建工单时，自动匹配工艺路线成功（物料绑定 → 物料分组绑定）
- ✅ **子工艺路线配置成功**（核心功能，新增）：
  - ✅ 支持为某个工序设置子工艺路线
  - ✅ 子工艺路线可以独立管理，支持嵌套
  - ✅ 报工时，先完成子工艺路线的所有工序，才能完成主工序
- ✅ 简易路线创建成功（工序顺序配置）
- ✅ 带SOP工艺路线创建成功（工序+SOP关联）
- ✅ **SOP参数收集配置成功**（SOP设计时指定收集参数）
- ✅ 工艺路线关联产品成功（工单创建时自动应用）
- ✅ 工艺路线关联物料分组成功（同一分组的产品自动应用）
- ✅ 拖拽排序正常（可视化调整工序顺序）
- ✅ AI建议正常显示（悬浮提示，不打断操作流程）

### 2.5 优化效果

- ⚡ **操作步骤减少**：批量导入工序，一次性完成
- ⚡ **时间缩短**：简易路线<5分钟，带SOP路线<10分钟
- ⚡ **学习成本降低**：拖拽操作，直观易懂
- ⚡ **工序类型灵活**：支持按数量报工和按状态报工，适应不同工序特点
- ⚡ **跳转控制精确**：支持工序跳转规则，灵活控制工序执行顺序
- ⚡ **物料分组管理**：同一分组使用相同工艺路线，减少重复配置
- ⚡ **子工艺路线支持**：支持复杂工艺路线，满足嵌套工艺需求

---

## 3. 标准作业流程（SOP）设计

### 3.1 SOP与工艺路线的关联

SOP作为工艺路线中工序的作业标准，在创建"带SOP工艺路线"时，需要为每个工序关联对应的SOP。

### 3.2 SOP参数收集配置（核心功能）

#### 3.2.1 配置流程

1. 进入"主数据管理" → "工艺管理" → "SOP管理"
2. 编辑SOP：组装工序SOP《组装作业标准》
3. 进入"报工参数收集"配置页面
4. **配置参数收集表单**（Formily表单设计器）

#### 3.2.2 参数类型支持

- **数字类型**：
  - 参数名称：扭矩
  - 单位：N·m
  - 必填：是
  - 验证规则：范围20-30
  - 默认值：25
- **选择类型**：
  - 参数名称：外观检查
  - 选项：是/否
  - 必填：是
- **文本类型**：
  - 参数名称：备注
  - 必填：否
- **日期类型**：支持日期、时间、日期时间选择

#### 3.2.3 SOP配置示例

**注塑工序SOP**：
- 温度（数字，范围180-200）
- 压力（数字，范围50-80）
- 时间（数字）

**检验工序SOP**：
- 检验结果（选择：合格/不合格）
- 检验员（文本）

**包装工序SOP**：
- 包装数量（数字）
- 标签检查（是/否）

### 3.3 SOP系统行为

- ✅ **SOP参数收集配置**：SOP设计时可指定报工时需要收集的参数（核心功能，新增）
  - 支持数字、文本、选择、日期等参数类型
  - 支持参数必填/可选设置
  - 支持参数验证规则（范围、格式等）
- ✅ **SOP关联工序**：工艺路线中工序可关联SOP
- ✅ **报工时参数收集**：报工时根据SOP配置自动显示参数收集表单
- ✅ **参数验证**：报工时自动验证参数是否符合SOP配置的验证规则

### 3.4 验收标准

- ✅ **SOP参数收集配置成功**（SOP设计时指定收集参数）
- ✅ 报工时根据SOP配置显示参数收集表单
- ✅ 参数验证规则生效（范围、格式等）
- ✅ 必填参数校验正常

---

## 4. 工序类型和跳转规则

### 4.1 工序类型

#### 4.1.1 按数量报工

**适用场景**：
- 注塑工序
- 组装工序
- 包装工序

**报工要求**：
- 需要输入完成数量
- 需要输入合格数量
- 系统自动计算不合格数量

#### 4.1.2 按状态报工

**适用场景**：
- 检验工序
- 测试工序
- 审批工序

**报工要求**：
- 只需要选择完成/未完成状态
- 无数量概念
- 适用于质量检验、测试、审批等非生产性工序

### 4.2 工序跳转规则

#### 4.2.1 不允许跳转（默认）

**规则**：
- 必须完成上道工序才能开始下道工序
- 工单执行时，系统自动校验工序跳转规则
- 不允许跳转的工序，必须等待上道工序完成才能报工

**适用场景**：
- 注塑工序 → 组装工序 → 包装工序（顺序执行）

#### 4.2.2 允许跳转

**规则**：
- 可以并行进行，不依赖上道工序完成
- 允许跳转的工序，可以随时报工（不依赖上道工序）

**适用场景**：
- 组装工序 + 检验工序（可并行执行）
- 测试工序（可随时执行，不依赖生产工序）

### 4.3 使用场景示例

**场景1：按数量报工 vs 按状态报工**

- **注塑工序报工**（按数量报工）：
  - 进入报工界面
  - 系统显示：完成数量、合格数量输入框
  - 输入：完成数量100个，合格数量95个
  - 提交报工
- **检验工序报工**（按状态报工）：
  - 进入报工界面
  - 系统显示：完成状态选择（完成/未完成）
  - 选择：完成
  - 提交报工

**场景2：工序跳转规则**

- **不允许跳转**：注塑工序 → 组装工序 → 包装工序（必须顺序执行）
- **允许跳转**：组装工序 + 检验工序（可并行执行）

---

## 5. 核心功能总结

### 5.1 BOM管理核心功能

1. **物料编码映射机制**：支持多编码体系，自动映射（详见[物料编码管理设计规范.md](./物料编码管理设计规范.md)）
2. **多单位管理**：支持多单位换算，自动处理
3. **批量导入**：支持universheet在线表格批量导入
4. **智能识别**：AI辅助识别重复物料（详见物料编码管理设计规范）
5. **BOM验证**：自动验证BOM数据完整性

### 5.2 工艺路线核心功能

1. **工序类型管理**：按数量报工 vs 按状态报工
2. **工序跳转控制**：不允许跳转 vs 允许跳转
3. **工艺路线绑定**：支持物料分组和物料绑定，优先级管理
4. **子工艺路线支持**：支持嵌套工艺路线
5. **简易路线 vs 带SOP路线**：两种模式满足不同需求

### 5.3 SOP核心功能

1. **参数收集配置**：SOP设计时指定报工参数
2. **多参数类型支持**：数字、文本、选择、日期等
3. **参数验证规则**：范围、格式等验证
4. **必填/可选设置**：灵活的参数配置

### 5.4 优先级规则

1. **物料绑定 > 物料分组绑定**：物料优先级高于分组
2. **自动继承机制**：物料自动继承分组工艺路线
3. **创建工单时自动匹配**：按优先级自动匹配工艺路线

---

## 6. 设计要点

### 6.1 用户体验优化

- ⚡ **操作步骤减少**：批量导入，一次性完成
- ⚡ **时间缩短**：简易路线<5分钟，带SOP路线<10分钟
- ⚡ **学习成本降低**：拖拽操作，直观易懂
- ⚡ **智能建议**：AI辅助，不打断操作流程

### 6.2 灵活性设计

- ⚡ **多编码支持**：各部门可继续使用原有编码（详见[物料编码管理设计规范.md](./物料编码管理设计规范.md)）
- ⚡ **多单位管理**：支持采购、库存、生产、销售使用不同单位
- ⚡ **工序类型灵活**：支持按数量报工和按状态报工
- ⚡ **跳转控制精确**：支持工序跳转规则，灵活控制工序执行顺序

### 6.3 可扩展性设计

- ⚡ **子工艺路线支持**：支持嵌套工艺路线
- ⚡ **物料分组管理**：同一分组使用相同工艺路线，减少重复配置
- ⚡ **SOP参数扩展**：支持多种参数类型，可扩展

---

## 7. 后续强化设计方向

### 7.1 BOM管理强化

1. **BOM版本管理**：支持BOM版本控制，历史版本追溯
2. **BOM替代料管理**：支持替代料配置和自动替换
3. **BOM成本计算**：基于BOM自动计算产品成本
4. **BOM可视化**：BOM树形结构可视化展示

### 7.2 工艺路线强化

1. **工艺路线版本管理**：支持工艺路线版本控制
2. **工艺路线优化建议**：基于历史数据，AI建议工艺路线优化
3. **工艺路线模板**：支持工艺路线模板，快速创建
4. **工艺路线对比分析**：不同工艺路线对比分析

### 7.3 SOP强化

1. **SOP版本管理**：支持SOP版本控制
2. **SOP审批流程**：SOP创建、修改审批流程
3. **SOP执行监控**：SOP执行情况监控和分析
4. **SOP知识库**：SOP知识库管理，支持搜索和推荐

---

**文档结束**
