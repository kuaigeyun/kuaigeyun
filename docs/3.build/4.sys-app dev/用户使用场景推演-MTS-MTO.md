# 用户使用场景推演 - MTS/MTO模式完整流程

## 📋 推演概述

**目标：** 推演全新用户从0开始使用快智造系统的完整流程  
**场景：** MTS（按库存生产）和MTO（按订单生产）两种模式  
**原则：** 考虑制造业通用需求，个性化需求通过定制解决  
**用户角色：** 系统管理员、生产管理员、车间工人、仓库管理员、质量管理员、财务人员

---

## 1. 系统初始化阶段（第1天）

### 1.1 系统注册与登录

**用户操作：**
1. 访问系统登录页面
2. 选择"组织注册"
3. 填写组织信息：
   - 组织名称：XX制造有限公司
   - 组织代码：XXMFG
   - 联系人信息
   - 套餐选择（基础版/标准版/高级版）
4. 创建组织管理员账号
5. 登录系统

**系统行为：**
- ✅ 创建租户（Tenant）
- ✅ 创建组织管理员账号
- ✅ 分配默认权限
- ✅ 初始化默认菜单
- ✅ 初始化默认系统参数

**验收标准：**
- ✅ 组织注册成功
- ✅ 组织管理员账号创建成功
- ✅ 登录成功，进入工作台

备注：注册设置暂时使用现有流程，后期若需优化再进行
---

### 1.2 基础配置

**用户操作：**
1. 进入"系统设置" → "系统参数"
2. 配置基础参数：
   - 组织名称、地址、联系方式
   - 默认货币、日期格式
   - 默认语言（中文）
   - 时区设置
3. 进入"系统设置" → "编码规则"
4. 配置编码规则：
   - 工单编码规则：`工单-{YYYYMMDD}-{序号}`（如：工单-20260101-001）
   - 采购单编码规则：`采购-{YYYYMMDD}-{序号}`
   - 销售订单编码规则：`订单-{YYYYMMDD}-{序号}`
   - 入库单编码规则：`入库-{YYYYMMDD}-{序号}`
   - 出库单编码规则：`出库-{YYYYMMDD}-{序号}`

备注 ： 编码规则系统已有建设，暂时按照原有的，后期根据情况决定是否需要改进

**系统行为：**
- ✅ 保存系统参数
- ✅ 保存编码规则
- ✅ 验证编码规则格式

**验收标准：**
- ✅ 系统参数配置成功
- ✅ 编码规则配置成功
- ✅ 编码规则验证通过

---

## 2. 基础数据配置阶段（第2-3天）

### 2.1 组织架构配置

**用户操作：**
1. 进入"系统管理" → "部门管理"
2. 创建部门树形结构：
   ```
   公司总部
   ├── 生产部
   │   ├── 生产一部
   │   ├── 生产二部
   │   └── 生产三部
   ├── 质量部
   ├── 仓储部
   ├── 采购部
   └── 销售部
   ```
3. 进入"系统管理" → "员工管理"
4. 创建员工账号：
   - 生产管理员（张三）
   - 车间工人（李四、王五）
   - 仓库管理员（赵六）
   - 质量管理员（孙七）
   - 财务人员（周八）
5. 分配员工到对应部门
6. 设置员工角色和权限

**系统行为：**
- ✅ 创建部门树形结构
- ✅ 创建员工账号
- ✅ 分配部门
- ✅ 分配角色和权限

**验收标准：**
- ✅ 部门树形结构创建成功
- ✅ 员工账号创建成功
- ✅ 员工分配到对应部门
- ✅ 角色和权限分配成功

---
备注 ：目前具备基础功能 后期看情况再优化

### 2.2 工厂建模配置（主数据管理APP）

**用户操作：**
1. 进入"主数据管理" → "工厂建模" → "车间设置"
2. 创建车间：
   - 车间1：注塑车间
   - 车间2：组装车间
   - 车间3：包装车间
3. 进入"主数据管理" → "工厂建模" → "工作中心"
4. 创建工作中心：
   - 注塑车间：
     - 注塑机1（工作中心001）
     - 注塑机2（工作中心002）
   - 组装车间：
     - 组装线1（工作中心003）
     - 组装线2（工作中心004）
   - 包装车间：
     - 包装线1（工作中心005）

**系统行为：**
- ✅ 创建车间数据
- ✅ 创建工作中心数据
- ✅ 建立车间-工作中心关联关系

**验收标准：**
- ✅ 车间创建成功
- ✅ 工作中心创建成功
- ✅ 关联关系建立成功

---

### 2.3 物料主数据配置（主数据管理APP）

**用户操作：**
1. 进入"主数据管理" → "产品管理" → "物料主数据"
2. 创建物料（使用Excel批量导入）：
   - **原材料：**
     - 塑料颗粒A（编码：RAW001）
     - 塑料颗粒B（编码：RAW002）
     - 螺丝（编码：RAW003）
   - **半成品：**
     - 注塑件A（编码：SEMI001）
     - 注塑件B（编码：SEMI002）
   - **成品：**
     - 产品A（编码：FIN001）
     - 产品B（编码：FIN002）
3. 配置物料属性：
   - 物料名称、规格、单位
   - 物料类型（原材料/半成品/成品）
   - 默认仓库
   - 安全库存
4. 进入"主数据管理" → "产品管理" → "BOM管理"
5. 创建BOM（使用Excel批量导入）：
   - **产品A的BOM：**
     ```
     产品A（1个）
     ├── 注塑件A（2个）
     │   └── 塑料颗粒A（100g）
     ├── 注塑件B（1个）
     │   └── 塑料颗粒B（50g）
     └── 螺丝（4个）
     ```
   - **产品B的BOM：**
     ```
     产品B（1个）
     ├── 注塑件A（1个）
     │   └── 塑料颗粒A（50g）
     └── 螺丝（2个）
     ```

**系统行为：**
- ✅ 批量导入物料数据（Excel）
- ✅ 批量导入BOM数据（Excel）
- ✅ 验证物料数据完整性
- ✅ 验证BOM数据完整性（父子件关系）

**验收标准：**
- ✅ 物料数据导入成功（支持Excel批量导入）
- ✅ BOM数据导入成功（支持Excel批量导入）
- ✅ 物料数据验证通过
- ✅ BOM数据验证通过（多层级BOM展开正常）

---

### 2.4 仓库配置（主数据管理APP）

**用户操作：**
1. 进入"主数据管理" → "仓库管理" → "仓库设置"
2. 创建仓库：
   - 原材料仓库（编码：WH001）
   - 半成品仓库（编码：WH002）
   - 成品仓库（编码：WH003）
3. 创建库区（可选）：
   - 原材料仓库：
     - A区（塑料区）
     - B区（五金区）
4. 创建库位（可选）：
   - A区-A01、A02、A03...

**系统行为：**
- ✅ 创建仓库数据
- ✅ 创建库区数据（可选）
- ✅ 创建库位数据（可选）

**验收标准：**
- ✅ 仓库创建成功
- ✅ 库区创建成功（可选）
- ✅ 库位创建成功（可选）

---

### 2.5 供应链主数据配置（主数据管理APP）

**用户操作：**
1. 进入"主数据管理" → "供应链主数据" → "供应商管理"
2. 创建供应商（使用Excel批量导入）：
   - 供应商A（编码：SUP001）- 塑料颗粒供应商
   - 供应商B（编码：SUP002）- 螺丝供应商
3. 进入"主数据管理" → "供应链主数据" → "客户管理"
4. 创建客户（使用Excel批量导入）：
   - 客户A（编码：CUS001）
   - 客户B（编码：CUS002）

**系统行为：**
- ✅ 批量导入供应商数据（Excel）
- ✅ 批量导入客户数据（Excel）

**验收标准：**
- ✅ 供应商数据导入成功（支持Excel批量导入）
- ✅ 客户数据导入成功（支持Excel批量导入）

---

### 2.6 初始库存录入

**用户操作：**
1. 进入"快智造" → "仓储管理" → "库存查询"
2. 查看当前库存（应该为空）
3. 进入"快智造" → "仓储管理" → "入库管理"
4. 创建初始库存入库单（使用Excel批量导入）：
   - 原材料仓库：
     - 塑料颗粒A：1000kg
     - 塑料颗粒B：500kg
     - 螺丝：10000个
   - 半成品仓库：
     - 注塑件A：100个
     - 注塑件B：50个
   - 成品仓库：
     - 产品A：10个
     - 产品B：5个
5. 提交入库单，系统自动更新库存

**系统行为：**
- ✅ 批量导入入库单数据（Excel）
- ✅ 自动更新库存数量
- ✅ 记录入库历史

**验收标准：**
- ✅ 入库单创建成功（支持Excel批量导入）
- ✅ 库存自动更新成功
- ✅ 入库历史记录成功

---

## 3. MTS模式业务流程推演（按库存生产）

### 3.1 需求管理阶段

**用户操作：**
1. 进入"快智造" → "计划管理" → "需求管理" → "销售预测(MTS)"
2. 创建销售预测（使用Excel批量导入）：
   - 产品A：1月份预测100个，2月份预测120个，3月份预测150个
   - 产品B：1月份预测50个，2月份预测60个，3月份预测80个
3. 提交销售预测

**系统行为：**
- ✅ 保存销售预测数据
- ✅ 标记为MTS模式
- ✅ 批量导入销售预测（Excel）

**验收标准：**
- ✅ 销售预测创建成功（支持Excel批量导入）
- ✅ 销售预测标记为MTS模式

---

### 3.2 MRP运算阶段

**用户操作：**
1. 进入"快智造" → "计划管理" → "计划排程" → "MRP运算(MTS)"
2. 选择销售预测（1月份预测）
3. 点击"运行MRP运算"
4. 系统自动计算：
   - 根据销售预测和当前库存计算物料需求
   - 根据BOM展开计算原材料需求
   - 生成工单建议和采购建议
5. 查看MRP运算结果：
   - 物料需求清单
   - 工单建议（产品A需要生产90个，产品B需要生产45个）
   - 采购建议（塑料颗粒A需要采购9kg，螺丝需要采购360个）
6. 导出MRP运算结果（Excel）

**系统行为：**
- ✅ 执行MRP运算（异步，使用Inngest工作流）
- ✅ 根据销售预测和库存计算物料需求
- ✅ 根据BOM展开计算原材料需求
- ✅ 生成工单建议和采购建议
- ✅ 支持Excel导出MRP结果

**验收标准：**
- ✅ MRP运算成功（支持大数据量：1000+物料）
- ✅ 物料需求计算正确
- ✅ 工单建议生成正确
- ✅ 采购建议生成正确
- ✅ MRP结果导出成功（Excel）

---

### 3.3 工单创建阶段

**用户操作：**
1. 进入"快智造" → "生产执行" → "工单管理" → "工单列表"
2. 根据MRP运算结果创建工单：
   - 方式1：手动创建工单
     - 点击"新建"按钮
     - 选择产品：产品A
     - 选择数量：90个
     - 选择车间：组装车间
     - 选择工作中心：组装线1
     - 选择计划开始时间：2026-01-05 08:00
     - 选择计划结束时间：2026-01-05 18:00
     - 提交工单
   - 方式2：批量导入工单（使用Excel）
     - 下载工单导入模板
     - 填写工单数据（产品、数量、车间、工作中心等）
     - 上传Excel文件
     - 系统自动创建工单
3. 查看工单列表（使用高级搜索，支持拼音搜索）
4. 查看工单详情（使用Drawer）
5. 打印工单（支持打印模板）

**系统行为：**
- ✅ 自动生成工单号（工单-20260105-001）
- ✅ 创建工单数据
- ✅ 根据BOM自动生成工单工序
- ✅ 生成工单二维码（用于扫码报工）
- ✅ 批量导入工单（Excel）
- ✅ 高级搜索（拼音搜索）
- ✅ 打印工单

**验收标准：**
- ✅ 工单创建成功（支持Excel批量导入）
- ✅ 工单号自动生成成功（支持中文前缀）
- ✅ 工单工序自动生成成功
- ✅ 工单二维码生成成功（支持中文）
- ✅ 工单高级搜索可用（拼音搜索）
- ✅ 工单打印可用

---

### 3.4 高级排产阶段（可选）

**用户操作：**
1. 进入"快智造" → "计划管理" → "高级排产" → "排产甘特图"
2. 查看所有待排产工单
3. 拖拽调整工单排产计划：
   - 调整工单开始时间
   - 调整工单结束时间
   - 调整工作中心分配
4. 系统自动检查工作中心能力
5. 保存排产计划
6. 导出排产计划（Excel）
7. 打印排产计划（打印模板）

**系统行为：**
- ✅ 显示排产甘特图（可视化排程）
- ✅ 支持拖拽调整排产计划
- ✅ 检查工作中心能力
- ✅ 保存排产计划
- ✅ 导出排产计划（Excel）
- ✅ 打印排产计划

**验收标准：**
- ✅ 排产甘特图展示正常（支持拖拽）
- ✅ 工作中心能力检查正常
- ✅ 排产计划保存成功
- ✅ 排产计划导出成功（Excel）
- ✅ 排产计划打印可用

---

### 3.5 工单下达阶段

**用户操作：**
1. 进入"快智造" → "生产执行" → "工单管理" → "工单列表"
2. 选择已排产的工单
3. 点击"下达"按钮
4. 确认下达工单
5. 工单状态变为"已下达"

**系统行为：**
- ✅ 更新工单状态为"已下达"
- ✅ 触发工单状态流转工作流（Inngest）
- ✅ 通知相关人员（生产管理员、车间工人）

**验收标准：**
- ✅ 工单下达成功
- ✅ 工单状态更新成功
- ✅ 通知发送成功

---

### 3.6 生产领料阶段

**用户操作：**
1. 进入"快智造" → "仓储管理" → "出库管理"
2. 创建生产领料出库单：
   - 方式1：手动创建
     - 点击"新建"按钮
     - 选择关联工单：工单-20260105-001（产品A）
     - 系统自动根据BOM生成领料需求：
       - 注塑件A：180个（从半成品仓库）
       - 注塑件B：90个（从半成品仓库）
       - 螺丝：360个（从原材料仓库）
     - 确认领料数量
     - 提交出库单
   - 方式2：批量导入（使用Excel）
3. 系统自动更新库存
4. 打印出库单（打印模板）

**系统行为：**
- ✅ 根据工单和BOM自动生成领料需求
- ✅ 创建出库单
- ✅ 自动更新库存数量
- ✅ 记录出库历史
- ✅ 批量导入出库单（Excel）
- ✅ 打印出库单

**验收标准：**
- ✅ 生产领料出库单创建成功（支持Excel批量导入）
- ✅ 领料需求自动生成正确
- ✅ 库存自动更新成功
- ✅ 出库单打印可用

---

### 3.7 报工阶段

**用户操作：**
1. **车间工人操作（移动端）：**
   - 打开移动端报工界面
   - 扫描工单二维码（或手动输入工单号）
   - 选择工序：组装工序
   - 输入完成数量：90个
   - 输入合格数量：88个（2个不良）
   - 输入工时：8小时
   - 输入备注（支持语音输入）："正常完成"
   - 提交报工
2. **生产管理员操作（PC端）：**
   - 进入"快智造" → "生产执行" → "报工管理" → "报工记录查询"
   - 查看报工记录（使用高级搜索，支持拼音搜索）
   - 查看工单进度（自动更新）

**系统行为：**
- ✅ 扫码报工（支持二维码、条形码）
- ✅ 记录报工数据
- ✅ 自动更新工单进度
- ✅ 自动判断工单完工（所有工序完成）
- ✅ 触发报工数据处理工作流（Inngest）
- ✅ 触发工单进度更新工作流（Inngest）
- ✅ 高级搜索（拼音搜索）
- ✅ 批量导入报工记录（Excel）

**验收标准：**
- ✅ 报工功能正常（移动端优化）
- ✅ 扫码报工正常（支持中文二维码）
- ✅ 工单进度自动更新正常
- ✅ 工单完工自动判断正常
- ✅ 报工记录高级搜索可用（拼音搜索）
- ✅ 报工记录批量导入可用（Excel导入）

---

### 3.8 成品入库阶段

**用户操作：**
1. 进入"快智造" → "仓储管理" → "入库管理"
2. 创建成品入库单：
   - 方式1：手动创建
     - 点击"新建"按钮
     - 选择关联工单：工单-20260105-001（产品A）
     - 系统自动填充：
       - 物料：产品A
       - 数量：88个（合格数量）
       - 仓库：成品仓库
     - 确认入库数量
     - 提交入库单
   - 方式2：批量导入（使用Excel）
3. 系统自动更新库存
4. 打印入库单（打印模板）

**系统行为：**
- ✅ 根据工单自动填充入库信息
- ✅ 创建入库单
- ✅ 自动更新库存数量
- ✅ 记录入库历史
- ✅ 批量导入入库单（Excel）
- ✅ 打印入库单

**验收标准：**
- ✅ 成品入库单创建成功（支持Excel批量导入）
- ✅ 入库信息自动填充正确
- ✅ 库存自动更新成功
- ✅ 入库单打印可用

---

### 3.9 销售出库阶段

**用户操作：**
1. 进入"快智造" → "仓储管理" → "出库管理"
2. 创建销售出库单（MTS模式，从库存发货）：
   - 点击"新建"按钮
   - 选择出库类型：销售出库
   - 选择客户：客户A
   - 选择物料：产品A
   - 选择数量：50个
   - 选择仓库：成品仓库
   - 提交出库单
3. 系统自动更新库存
4. 打印出库单（打印模板）

**系统行为：**
- ✅ 创建销售出库单（MTS模式）
- ✅ 自动更新库存数量
- ✅ 记录出库历史
- ✅ 打印出库单

**验收标准：**
- ✅ 销售出库单创建成功
- ✅ 库存自动更新成功
- ✅ 出库单打印可用

---

### 3.10 生产看板监控

**用户操作：**
1. 进入"快智造" → "报表分析" → "生产监控" → "生产看板"
2. 查看实时生产数据：
   - 进行中工单数：5个
   - 完工工单数：10个
   - 延期工单数：1个
   - 工单进度可视化（进度条、状态卡片）
3. 查看工单详情（点击工单卡片）
4. 导出看板数据（Excel、PDF）
5. 切换到"大屏模式"（支持大屏显示）

**系统行为：**
- ✅ 实时数据推送（WebSocket，延迟<100ms）
- ✅ 工单进度可视化
- ✅ 关键指标统计
- ✅ 数据导出（Excel、PDF）
- ✅ 大屏模式支持

**验收标准：**
- ✅ 生产看板数据实时更新正常（WebSocket）
- ✅ 工单进度可视化正常
- ✅ 关键指标统计正常
- ✅ 数据导出可用（Excel、PDF）
- ✅ 大屏模式可用

---

## 4. MTO模式业务流程推演（按订单生产）

### 4.1 需求管理阶段

**用户操作：**
1. 进入"快智造" → "计划管理" → "需求管理" → "销售订单(MTO)"
2. 创建销售订单（使用Excel批量导入）：
   - 订单1：
     - 客户：客户A
     - 产品：产品A
     - 数量：100个
     - 交货日期：2026-01-20
   - 订单2：
     - 客户：客户B
     - 产品：产品B
     - 数量：50个
     - 交货日期：2026-01-25
3. 提交销售订单

**系统行为：**
- ✅ 保存销售订单数据
- ✅ 标记为MTO模式
- ✅ 批量导入销售订单（Excel）

**验收标准：**
- ✅ 销售订单创建成功（支持Excel批量导入）
- ✅ 销售订单标记为MTO模式

---

### 4.2 LRP运算阶段

**用户操作：**
1. 进入"快智造" → "计划管理" → "计划排程" → "LRP运算(MTO)"
2. 选择销售订单（订单1）
3. 点击"运行LRP运算"
4. 系统自动计算：
   - 根据销售订单和当前库存计算物料需求
   - 根据BOM展开计算原材料需求
   - 生成工单建议和采购建议（针对特定订单）
5. 查看LRP运算结果：
   - 物料需求清单（订单专属）
   - 工单建议（产品A需要生产100个，关联订单1）
   - 采购建议（针对订单1的采购需求）
6. 导出LRP运算结果（Excel）

**系统行为：**
- ✅ 执行LRP运算（异步，使用Inngest工作流）
- ✅ 根据销售订单和库存计算物料需求
- ✅ 根据BOM展开计算原材料需求
- ✅ 生成工单建议和采购建议（订单专属）
- ✅ 支持Excel导出LRP结果

**验收标准：**
- ✅ LRP运算成功（支持大数据量：1000+物料）
- ✅ 物料需求计算正确（订单专属）
- ✅ 工单建议生成正确（关联订单）
- ✅ 采购建议生成正确（订单专属）
- ✅ LRP结果导出成功（Excel）

---

### 4.3 工单创建阶段（关联订单）

**用户操作：**
1. 进入"快智造" → "生产执行" → "工单管理" → "工单列表"
2. 根据LRP运算结果创建工单：
   - 点击"新建"按钮
   - 选择产品：产品A
   - 选择数量：100个
   - **关联销售订单：订单1**（MTO模式关键）
   - 选择车间：组装车间
   - 选择工作中心：组装线1
   - 选择计划开始时间：2026-01-10 08:00
   - 选择计划结束时间：2026-01-15 18:00
   - 提交工单
3. 系统自动标记为MTO模式工单
4. 查看工单详情（显示关联订单信息）

**系统行为：**
- ✅ 自动生成工单号（工单-20260110-001）
- ✅ 创建工单数据（关联销售订单）
- ✅ 标记为MTO模式
- ✅ 根据BOM自动生成工单工序
- ✅ 生成工单二维码（用于扫码报工）

**验收标准：**
- ✅ 工单创建成功（关联销售订单）
- ✅ 工单标记为MTO模式
- ✅ 工单关联订单信息正确

---

### 4.4 高级排产阶段（可选）

**用户操作：**
1. 进入"快智造" → "计划管理" → "高级排产" → "排产甘特图"
2. 查看所有待排产工单（包括MTO工单）
3. 根据订单交货日期调整排产计划：
   - 订单1交货日期：2026-01-20
   - 调整工单排产计划，确保在交货日期前完成
4. 拖拽调整工单排产计划
5. 保存排产计划

**系统行为：**
- ✅ 显示排产甘特图（包含MTO工单）
- ✅ 支持拖拽调整排产计划
- ✅ 检查订单交货日期
- ✅ 保存排产计划

**验收标准：**
- ✅ 排产甘特图展示正常（包含MTO工单）
- ✅ 订单交货日期检查正常
- ✅ 排产计划保存成功

---

### 4.5 工单下达阶段

**用户操作：**
1. 进入"快智造" → "生产执行" → "工单管理" → "工单列表"
2. 选择已排产的MTO工单
3. 点击"下达"按钮
4. 确认下达工单
5. 工单状态变为"已下达"

**系统行为：**
- ✅ 更新工单状态为"已下达"
- ✅ 触发工单状态流转工作流（Inngest）
- ✅ 通知相关人员

**验收标准：**
- ✅ 工单下达成功
- ✅ 工单状态更新成功
- ✅ 通知发送成功

---

### 4.6 生产领料阶段（订单专属库存）

**用户操作：**
1. 进入"快智造" → "仓储管理" → "出库管理"
2. 创建生产领料出库单：
   - 点击"新建"按钮
   - 选择关联工单：工单-20260110-001（产品A，关联订单1）
   - 系统自动根据BOM生成领料需求：
     - 注塑件A：200个（从半成品仓库）
     - 注塑件B：100个（从半成品仓库）
     - 螺丝：400个（从原材料仓库）
   - 确认领料数量
   - 提交出库单
3. 系统自动标记为订单专属库存（MTO模式）

**系统行为：**
- ✅ 根据工单和BOM自动生成领料需求
- ✅ 创建出库单（关联订单）
- ✅ 标记为订单专属库存（MTO模式）
- ✅ 自动更新库存数量（预留订单专属库存）

**验收标准：**
- ✅ 生产领料出库单创建成功（关联订单）
- ✅ 订单专属库存标记成功
- ✅ 库存自动更新成功

---

### 4.7 报工阶段

**用户操作：**
1. **车间工人操作（移动端）：**
   - 打开移动端报工界面
   - 扫描工单二维码（或手动输入工单号）
   - 选择工序：组装工序
   - 输入完成数量：100个
   - 输入合格数量：98个（2个不良）
   - 输入工时：10小时
   - 输入备注（支持语音输入）："正常完成"
   - 提交报工
2. **生产管理员操作（PC端）：**
   - 查看报工记录
   - 查看工单进度（自动更新）

**系统行为：**
- ✅ 扫码报工（支持二维码、条形码）
- ✅ 记录报工数据
- ✅ 自动更新工单进度
- ✅ 自动判断工单完工

**验收标准：**
- ✅ 报工功能正常（移动端优化）
- ✅ 工单进度自动更新正常
- ✅ 工单完工自动判断正常

---

### 4.8 成品入库阶段（订单专属库存）

**用户操作：**
1. 进入"快智造" → "仓储管理" → "入库管理"
2. 创建成品入库单：
   - 点击"新建"按钮
   - 选择关联工单：工单-20260110-001（产品A，关联订单1）
   - 系统自动填充：
     - 物料：产品A
     - 数量：98个（合格数量）
     - 仓库：成品仓库
     - **关联销售订单：订单1**（MTO模式关键）
   - 确认入库数量
   - 提交入库单
3. 系统自动标记为订单专属库存（MTO模式）

**系统行为：**
- ✅ 根据工单自动填充入库信息
- ✅ 创建入库单（关联销售订单）
- ✅ 标记为订单专属库存（MTO模式）
- ✅ 自动更新库存数量（订单专属库存）

**验收标准：**
- ✅ 成品入库单创建成功（关联订单）
- ✅ 订单专属库存标记成功
- ✅ 库存自动更新成功

---

### 4.9 销售出库阶段（关联订单）

**用户操作：**
1. 进入"快智造" → "仓储管理" → "出库管理"
2. 创建销售出库单（MTO模式，关联订单）：
   - 点击"新建"按钮
   - 选择出库类型：销售出库
   - **选择关联销售订单：订单1**（MTO模式关键）
   - 系统自动填充：
     - 客户：客户A
     - 物料：产品A
     - 数量：98个（订单专属库存）
     - 仓库：成品仓库
   - 确认出库数量
   - 提交出库单
3. 系统自动更新库存（释放订单专属库存）
4. 打印出库单（打印模板）

**系统行为：**
- ✅ 创建销售出库单（关联销售订单）
- ✅ 自动填充订单信息
- ✅ 自动更新库存数量（释放订单专属库存）
- ✅ 记录出库历史
- ✅ 打印出库单

**验收标准：**
- ✅ 销售出库单创建成功（关联订单）
- ✅ 订单信息自动填充正确
- ✅ 库存自动更新成功（释放订单专属库存）
- ✅ 出库单打印可用

---

## 5. 质量管理流程推演（第二阶段扩展）

### 5.1 来料检验

**用户操作：**
1. 进入"快智造" → "质量管理" → "来料检验"
2. 创建来料检验单：
   - 选择关联采购单
   - 选择物料：塑料颗粒A
   - 输入检验数量：1000kg
   - 输入合格数量：980kg
   - 输入不良数量：20kg
   - 选择检验结果：部分合格
   - 输入检验人：质量管理员（孙七）
   - 提交检验单
3. 系统自动处理：
   - 合格物料自动入库
   - 不良物料标记为不良品

**系统行为：**
- ✅ 创建来料检验单
- ✅ 自动处理合格物料入库
- ✅ 自动处理不良物料标记
- ✅ 触发检验数据处理工作流（Inngest）
- ✅ 触发不良品处理工作流（Inngest）

**验收标准：**
- ✅ 来料检验单创建成功
- ✅ 合格物料自动入库成功
- ✅ 不良物料标记成功

---

### 5.2 过程检验

**用户操作：**
1. 进入"快智造" → "质量管理" → "过程检验"
2. 创建过程检验单：
   - 选择关联工单：工单-20260110-001
   - 选择关联工序：组装工序
   - 输入检验数量：100个
   - 输入合格数量：98个
   - 输入不良数量：2个
   - 选择不良品类型：外观不良
   - 选择检验结果：部分合格
   - 输入检验人：质量管理员（孙七）
   - 提交检验单
3. 系统自动处理：
   - 合格数量计入报工合格数
   - 不良数量标记为不良品

**系统行为：**
- ✅ 创建过程检验单
- ✅ 自动更新报工合格数
- ✅ 自动标记不良品
- ✅ 触发检验数据处理工作流（Inngest）

**验收标准：**
- ✅ 过程检验单创建成功
- ✅ 报工合格数自动更新成功
- ✅ 不良品标记成功

---

### 5.3 成品检验

**用户操作：**
1. 进入"快智造" → "质量管理" → "成品检验"
2. 创建成品检验单：
   - 选择关联工单：工单-20260110-001
   - 输入检验数量：100个
   - 输入合格数量：98个
   - 输入不良数量：2个
   - 选择检验结果：部分合格
   - 输入检验人：质量管理员（孙七）
   - 提交检验单
3. 系统自动处理：
   - 合格数量允许入库
   - 不良数量不允许入库

**系统行为：**
- ✅ 创建成品检验单
- ✅ 自动处理合格数量入库
- ✅ 自动处理不良数量标记

**验收标准：**
- ✅ 成品检验单创建成功
- ✅ 合格数量入库处理成功
- ✅ 不良数量标记成功

---

## 6. 财务协同流程推演（第二阶段扩展）

### 6.1 应付管理

**用户操作：**
1. 进入"快智造" → "财务协同" → "应付管理"
2. 查看应付单列表（系统自动生成）：
   - 采购入库后，系统自动生成应付单
   - 应付单关联采购单和供应商
3. 查看应付单详情
4. 记录付款信息：
   - 输入已付金额：5000元
   - 输入付款日期：2026-01-15
   - 提交付款信息
5. 系统自动更新应付单状态（部分付款/已付款）
6. 导出应付单（Excel）
7. 打印应付单（打印模板）

**系统行为：**
- ✅ 自动生成应付单（采购入库后）
- ✅ 触发应付单生成工作流（Inngest）
- ✅ 自动更新应付单状态
- ✅ 导出应付单（Excel）
- ✅ 打印应付单

**验收标准：**
- ✅ 应付单自动生成成功
- ✅ 应付单状态更新成功
- ✅ 应付单导出可用（Excel）
- ✅ 应付单打印可用

---

### 6.2 应收管理

**用户操作：**
1. 进入"快智造" → "财务协同" → "应收管理"
2. 查看应收单列表（系统自动生成）：
   - 销售出库后，系统自动生成应收单
   - 应收单关联销售订单和客户
3. 查看应收单详情
4. 记录收款信息：
   - 输入已收金额：10000元
   - 输入收款日期：2026-01-20
   - 提交收款信息
5. 系统自动更新应收单状态（部分收款/已收款）
6. 导出应收单（Excel）
7. 打印应收单（打印模板）

**系统行为：**
- ✅ 自动生成应收单（销售出库后）
- ✅ 触发应收单生成工作流（Inngest）
- ✅ 自动更新应收单状态
- ✅ 导出应收单（Excel）
- ✅ 打印应收单

**验收标准：**
- ✅ 应收单自动生成成功
- ✅ 应收单状态更新成功
- ✅ 应收单导出可用（Excel）
- ✅ 应收单打印可用

---

## 7. 报表分析流程推演

### 7.1 库存报表

**用户操作：**
1. 进入"快智造" → "报表分析" → "库存报表"
2. 查看库存报表：
   - 库存查询（实时库存）
   - 库存周转率分析
   - 库存预警（低于安全库存）
3. 导出库存报表（Excel、PDF）
4. 打印库存报表（打印模板）

**系统行为：**
- ✅ 实时库存查询
- ✅ 库存周转率计算
- ✅ 库存预警检查
- ✅ 报表导出（Excel、PDF）
- ✅ 报表打印

**验收标准：**
- ✅ 库存报表查询正常
- ✅ 库存周转率计算正确
- ✅ 库存预警正常
- ✅ 报表导出可用（Excel、PDF）
- ✅ 报表打印可用

---

### 7.2 生产报表

**用户操作：**
1. 进入"快智造" → "报表分析" → "生产报表"
2. 查看生产报表：
   - 工单绩效分析（准时完工率、计划达成率）
   - 生产效率分析
   - 设备利用率分析
3. 导出生产报表（Excel、PDF）
4. 打印生产报表（打印模板）
5. 切换到"大屏模式"（支持大屏显示）

**系统行为：**
- ✅ 工单绩效分析计算
- ✅ 生产效率分析计算
- ✅ 设备利用率分析计算
- ✅ 报表导出（Excel、PDF）
- ✅ 报表打印
- ✅ 大屏模式支持

**验收标准：**
- ✅ 生产报表查询正常
- ✅ 工单绩效分析正确
- ✅ 报表导出可用（Excel、PDF）
- ✅ 报表打印可用
- ✅ 大屏模式可用

---

### 7.3 质量报表

**用户操作：**
1. 进入"快智造" → "报表分析" → "质量报表"
2. 查看质量报表：
   - 质量合格率统计（按产品、工序等维度）
   - 不良品类型分析
   - 质量趋势分析
3. 导出质量报表（Excel、PDF）
4. 打印质量报表（打印模板）

**系统行为：**
- ✅ 质量合格率计算
- ✅ 不良品类型统计
- ✅ 质量趋势分析
- ✅ 报表导出（Excel、PDF）
- ✅ 报表打印

**验收标准：**
- ✅ 质量报表查询正常
- ✅ 质量合格率统计正确
- ✅ 报表导出可用（Excel、PDF）
- ✅ 报表打印可用

---

## 8. 通用需求场景

### 8.1 数据导入导出

**通用需求：**
- ✅ 所有列表页面支持Excel批量导入
- ✅ 所有列表页面支持Excel批量导出
- ✅ 支持Excel模板下载
- ✅ 支持Excel数据验证
- ✅ 支持Excel错误提示（中文）

**个性化需求（后期定制）：**
- ⚠️ 自定义导入字段映射
- ⚠️ 自定义导出格式
- ⚠️ 自定义数据验证规则

---

### 8.2 高级搜索

**通用需求：**
- ✅ 所有列表页面支持高级搜索
- ✅ 支持拼音搜索（符合中国用户习惯）
- ✅ 支持快速筛选
- ✅ 支持筛选条件保存

**个性化需求（后期定制）：**
- ⚠️ 自定义搜索字段
- ⚠️ 自定义筛选条件
- ⚠️ 自定义搜索逻辑

---

### 8.3 打印功能

**通用需求：**
- ✅ 所有单据支持打印
- ✅ 支持打印模板
- ✅ 支持打印预览
- ✅ 支持批量打印

**个性化需求（后期定制）：**
- ⚠️ 自定义打印模板
- ⚠️ 自定义打印格式
- ⚠️ 自定义打印字段

---

### 8.4 移动端支持

**通用需求：**
- ✅ 报工界面移动端优化
- ✅ 支持扫码功能（二维码、条形码）
- ✅ 支持语音输入
- ✅ 支持离线功能（网络不稳定场景）

**个性化需求（后期定制）：**
- ⚠️ 自定义移动端界面
- ⚠️ 自定义扫码规则
- ⚠️ 自定义离线数据同步规则

---

### 8.5 实时数据推送

**通用需求：**
- ✅ 生产看板实时更新（WebSocket）
- ✅ 设备看板实时更新（WebSocket）
- ✅ 数据推送延迟<100ms
- ✅ 支持断线重连

**个性化需求（后期定制）：**
- ⚠️ 自定义推送频率
- ⚠️ 自定义推送内容
- ⚠️ 自定义推送规则

---

### 8.6 权限管理

**通用需求：**
- ✅ 基于角色的权限控制（RBAC）
- ✅ 支持部门权限
- ✅ 支持数据权限（租户隔离）

**个性化需求（后期定制）：**
- ⚠️ 自定义角色权限
- ⚠️ 自定义数据权限规则
- ⚠️ 自定义审批流程权限

---

### 8.7 审批流程

**通用需求：**
- ✅ 支持工单审批流程
- ✅ 支持采购单审批流程
- ✅ 支持销售订单审批流程
- ✅ 支持流程可视化设计器

**个性化需求（后期定制）：**
- ⚠️ 自定义审批流程
- ⚠️ 自定义审批规则
- ⚠️ 自定义审批条件

---

## 9. 个性化需求场景（后期定制）

### 9.1 自定义字段

**场景：** 企业需要添加自定义字段（如：客户编号、供应商评级等）

**解决方案：**
- ⚠️ 通过"自定义字段"功能添加
- ⚠️ 支持文本、数字、日期、下拉等类型
- ⚠️ 支持字段验证规则

---

### 9.2 自定义报表

**场景：** 企业需要自定义报表格式和内容

**解决方案：**
- ⚠️ 通过"报表设计器"自定义报表
- ⚠️ 支持拖拽式设计
- ⚠️ 支持自定义数据源
- ⚠️ 支持自定义图表类型

---

### 9.3 自定义工作流

**场景：** 企业需要自定义业务流程（如：特殊审批流程）

**解决方案：**
- ⚠️ 通过"流程设计器"自定义工作流
- ⚠️ 支持条件分支
- ⚠️ 支持并行流程
- ⚠️ 支持子流程

---

### 9.4 第三方系统集成

**场景：** 企业需要与ERP、PLM、SCADA等系统集成

**解决方案：**
- ⚠️ 通过"集成配置"功能配置
- ⚠️ 支持RESTful API集成
- ⚠️ 支持Webhook集成
- ⚠️ 支持数据同步规则

---

## 10. 总结

### 10.1 系统初始化流程

1. **系统注册与登录**（第1天）
   - 组织注册
   - 创建组织管理员账号
   - 基础配置（系统参数、编码规则）

2. **基础数据配置**（第2-3天）
   - 组织架构配置（部门、员工）
   - 工厂建模配置（车间、工作中心）
   - 物料主数据配置（物料、BOM）
   - 仓库配置（仓库、库区、库位）
   - 供应链主数据配置（供应商、客户）
   - 初始库存录入

### 10.2 MTS模式业务流程

1. **需求管理** → 销售预测
2. **计划排程** → MRP运算 → 生成工单建议和采购建议
3. **高级排产** → 排产甘特图（可选）
4. **工单管理** → 创建工单 → 下达工单
5. **生产领料** → 根据BOM生成领料需求
6. **报工管理** → 扫码报工 → 自动更新工单进度
7. **成品入库** → 自动更新库存
8. **销售出库** → 从库存发货（MTS模式）
9. **生产看板** → 实时监控生产进度

### 10.3 MTO模式业务流程

1. **需求管理** → 销售订单
2. **计划排程** → LRP运算 → 生成工单建议和采购建议（订单专属）
3. **高级排产** → 排产甘特图（可选）
4. **工单管理** → 创建工单（关联订单） → 下达工单
5. **生产领料** → 根据BOM生成领料需求（订单专属库存）
6. **报工管理** → 扫码报工 → 自动更新工单进度
7. **成品入库** → 自动更新库存（订单专属库存）
8. **销售出库** → 关联订单发货（MTO模式）
9. **生产看板** → 实时监控生产进度

### 10.4 质量管理流程（第二阶段扩展）

1. **来料检验** → 采购到货物料检验
2. **过程检验** → 生产报工环节关键工序检验
3. **成品检验** → 生产完工成品最终检验

### 10.5 财务协同流程（第二阶段扩展）

1. **应付管理** → 采购入库后自动生成应付单
2. **应收管理** → 销售出库后自动生成应收单

### 10.6 报表分析流程

1. **库存报表** → 库存查询、库存周转率分析
2. **生产报表** → 工单绩效分析、生产效率分析
3. **质量报表** → 质量合格率统计、质量趋势分析

### 10.7 通用需求

- ✅ 数据导入导出（Excel批量导入导出）
- ✅ 高级搜索（拼音搜索、快速筛选）
- ✅ 打印功能（打印模板、打印预览）
- ✅ 移动端支持（报工界面、扫码功能）
- ✅ 实时数据推送（WebSocket实时更新）
- ✅ 权限管理（RBAC、数据权限）
- ✅ 审批流程（流程可视化设计器）

### 10.8 个性化需求（后期定制）

- ⚠️ 自定义字段
- ⚠️ 自定义报表
- ⚠️ 自定义工作流
- ⚠️ 第三方系统集成

---

**文档创建时间：** 2025-12-27  
**文档作者：** Luigi Lu  
**推演场景：** MTS模式、MTO模式完整业务流程  
**适用对象：** 全新用户从0开始使用系统

