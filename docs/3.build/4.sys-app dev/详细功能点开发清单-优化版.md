# 详细功能点开发清单（优化版）

## 📋 清单概述

**目标：** 建立详细的功能点开发清单，每个功能点完成后立即测试，结合Inngest工作流完善流程  
**原则：** 完成一项测试一项，确保质量，统一布局，优化用户体验，符合中国制造业实情  
**时间范围：** 2025-12-27 至 2026-06-15

---

## 1. 已完成功能清单（可复用）

### 1.1 高级搜索功能（✅ 已完成）

**功能描述：**
- 支持多字段组合搜索
- 支持拼音搜索（符合中国用户习惯）
- 支持快速筛选
- 支持筛选条件组合（AND/OR）
- 支持保存搜索条件

**组件位置：**
- `riveredge-frontend/src/components/riveredge-query/index.tsx`
- `riveredge-backend/src/core/utils/search_utils.py`

**使用方式：**
```typescript
<UniTable
  showAdvancedSearch={true}
  // ...其他配置
/>
```

**可复用场景：**
- ✅ 工单列表搜索
- ✅ 物料列表搜索
- ✅ 报工记录搜索
- ✅ 库存查询搜索
- ✅ 所有列表页面搜索

### 1.2 UniSheet导入功能（✅ 已完成）

**功能描述：**
- 使用Univer Sheet进行Excel数据导入（符合中国用户Excel使用习惯）
- 支持数据预览和编辑
- 支持表头自动填充
- 支持示例数据填充
- 支持数据验证

**组件位置：**
- `riveredge-frontend/src/components/uni-import/index.tsx`

**使用方式：**
```typescript
<UniImport
  visible={importVisible}
  onCancel={() => setImportVisible(false)}
  onConfirm={handleImport}
  headers={['字段1', '字段2']}
  exampleRow={['示例1', '示例2']}
/>
```

**可复用场景：**
- ✅ 工单批量导入
- ✅ 物料批量导入
- ✅ 报工记录批量导入
- ✅ 销售预测导入
- ✅ 销售订单导入
- ✅ 所有需要批量导入的场景

### 1.3 Inngest工作流（✅ 已完成）

**功能描述：**
- 支持异步任务执行
- 支持定时任务调度
- 支持工作流编排
- 支持任务重试
- 支持任务监控

**已实现工作流：**
- ✅ 消息发送工作流（`message_sender_function`）
- ✅ 定时任务执行工作流（`scheduled_task_executor_function`）
- ✅ 审批流程工作流（`approval_workflow_function`）
- ✅ 数据备份工作流（`data_backup_executor_function`）
- ✅ SOP执行工作流（`sop_execution_workflow_function`）

**可复用场景：**
- ✅ 工单状态流转工作流
- ✅ MRP/LRP运算工作流
- ✅ 报工数据采集工作流
- ✅ 库存更新工作流
- ✅ 报表生成工作流

---

## 2. 页面布局统一性规范

### 2.1 统一页面结构

**标准页面结构：**
```typescript
<PageContainer
  title="页面标题"
  extra={[
    // 操作按钮（新建、导入、导出等）
  ]}
>
  <UniTable
    // 统一表格配置
    showAdvancedSearch={true}  // 高级搜索
    showImport={true}          // 导入功能
    showExport={true}          // 导出功能
    // ...其他配置
  />
</PageContainer>
```

**页面容器要求：**
- ✅ 所有页面使用 `PageContainer` 组件
- ✅ 统一页面标题和描述
- ✅ 统一页面间距和布局
- ✅ 统一操作按钮位置（右上角）

### 2.2 统一表格配置

**标准表格配置：**
```typescript
<UniTable
  // 基础配置
  columns={columns}
  request={loadData}
  
  // 功能配置
  showAdvancedSearch={true}     // 高级搜索
  showImport={true}             // 导入功能
  showExport={true}             // 导出功能
  showBatchDelete={true}        // 批量删除
  showRefresh={true}            // 刷新功能
  
  // 操作配置
  onCreate={handleCreate}       // 新建（Modal）
  onEdit={handleEdit}           // 编辑（Modal）
  onDetail={handleDetail}       // 详情（Drawer）
  onDelete={handleDelete}       // 删除
/>
```

**表格操作规范：**
- ✅ 新建：使用Modal弹窗
- ✅ 编辑：使用Modal弹窗
- ✅ 详情：使用Drawer抽屉
- ✅ 删除：使用确认对话框
- ✅ 批量操作：支持多选

### 2.3 统一表单布局

**标准表单布局：**
```typescript
<ProForm
  layout="horizontal"           // 水平布局
  labelCol={{ span: 6 }}        // 标签宽度
  wrapperCol={{ span: 18 }}     // 输入框宽度
  grid={true}                    // 网格布局
  rowProps={{ gutter: 16 }}     // 间距
>
  <ProFormText
    name="field1"
    label="字段1"
    rules={[{ required: true, message: '请输入字段1' }]}
  />
  {/* ...其他字段 */}
</ProForm>
```

**表单布局要求：**
- ✅ 统一使用ProForm组件
- ✅ 统一字段布局（水平布局，标签6列，输入框18列）
- ✅ 统一字段间距（16px）
- ✅ 统一必填标识（红色*号）
- ✅ 统一错误提示（中文提示）

### 2.4 统一操作按钮

**标准操作按钮位置：**
- ✅ 页面右上角：新建、导入、导出、刷新
- ✅ 表格操作列：编辑、详情、删除
- ✅ 表单底部：提交、取消

**操作按钮样式：**
- ✅ 主要操作：Primary按钮（蓝色）
- ✅ 次要操作：Default按钮（白色）
- ✅ 危险操作：Danger按钮（红色）
- ✅ 统一图标：使用Ant Design图标

---

## 3. 中国制造业实情考虑

### 3.1 用户习惯

**Excel使用习惯：**
- ✅ 大量使用Excel进行数据管理
- ✅ 习惯Excel导入导出功能
- ✅ 需要Excel模板下载
- ✅ 需要Excel数据验证

**操作习惯：**
- ✅ 习惯批量操作（批量导入、批量删除）
- ✅ 习惯快速搜索（拼音搜索、模糊搜索）
- ✅ 习惯数据导出（Excel、PDF）
- ✅ 习惯数据打印

### 3.2 业务场景

**生产场景：**
- ✅ 车间工人使用手机/平板报工（移动端优化）
- ✅ 需要扫码功能（工单二维码、物料二维码）
- ✅ 需要离线功能（网络不稳定场景）
- ✅ 需要语音输入（报工备注）

**管理场景：**
- ✅ 需要实时看板（生产进度、设备状态）
- ✅ 需要数据大屏（生产监控大屏）
- ✅ 需要报表分析（生产报表、质量报表）
- ✅ 需要数据导出（Excel报表）

### 3.3 数据特点

**数据量大：**
- ✅ 工单数据量大（每天数百个工单）
- ✅ 报工数据量大（每天数千条报工记录）
- ✅ 库存数据量大（数万种物料）
- ✅ 需要高效的数据查询和展示

**数据实时性：**
- ✅ 生产数据需要实时更新
- ✅ 库存数据需要实时更新
- ✅ 看板数据需要实时更新
- ✅ 需要WebSocket实时推送

---

## 4. 系统级功能点清单（优化版）

### 4.1 第一阶段：基础能力建设（3-4周）

#### 功能点1.1：完善文件头注释

**功能描述：** 所有Python文件添加Author和Date信息

**任务清单：**
- [ ] 检查所有API路由文件（40+个文件）
- [ ] 检查所有服务文件（30+个文件）
- [ ] 检查所有模型文件（50+个文件）
- [ ] 检查所有Schema文件（50+个文件）

**测试用例：**
- [ ] 验证所有文件都有文件头注释
- [ ] 验证文件头注释格式统一
- [ ] 验证Author和Date信息完整

**验收标准：**
- ✅ 所有Python文件都有文件头注释
- ✅ 文件头注释格式统一
- ✅ Author和Date信息完整

**预计时间：** 1-2天

---

#### 功能点1.2：应用管理机制完善

**功能描述：** 完善应用注册和路由管理机制

**任务清单：**
- [ ] 完善应用注册API（`POST /api/v1/core/applications`）
- [ ] 完善应用路由注册机制（`ApplicationRouteManager`）
- [ ] 完善应用菜单配置机制（`manifest.json`）
- [ ] 完善应用依赖检查机制
- [ ] 完善应用启用/禁用机制

**测试用例：**
- [ ] 测试应用注册功能
- [ ] 测试应用路由注册功能
- [ ] 测试应用菜单配置功能
- [ ] 测试应用依赖检查功能
- [ ] 测试应用启用/禁用功能

**验收标准：**
- ✅ 应用注册API可用
- ✅ 应用路由自动注册
- ✅ 应用菜单自动加载
- ✅ 应用依赖检查正确
- ✅ 应用启用/禁用正常

**预计时间：** 1周

---

#### 功能点1.3：编码规则服务

**功能描述：** 实现编码规则管理服务，支持自定义编码规则（符合中国制造业编码习惯）

**任务清单：**
- [ ] 创建编码规则模型（`CodeRule`）
- [ ] 创建编码规则服务（`CodeRuleService`）
- [ ] 创建编码规则API（`/api/v1/core/code-rules`）
- [ ] 实现编码生成逻辑（支持日期、序号、前缀等）
  - [ ] 支持日期格式（YYYYMMDD、YYYY-MM-DD等）
  - [ ] 支持序号格式（001、0001等）
  - [ ] 支持前缀/后缀（WO、PO等）
  - [ ] 支持自定义分隔符（-、_等）
- [ ] 实现编码规则验证
- [ ] 前端页面：编码规则管理（使用UniTable + 高级搜索）
- [ ] 前端页面：编码规则配置（使用统一表单布局）

**测试用例：**
- [ ] 测试编码规则创建
- [ ] 测试编码规则更新
- [ ] 测试编码规则删除
- [ ] 测试编码生成（日期格式：YYYYMMDD）
- [ ] 测试编码生成（序号格式：001）
- [ ] 测试编码生成（前缀+日期+序号：WO20260101001）
- [ ] 测试编码唯一性验证
- [ ] 测试编码规则高级搜索功能
- [ ] 测试编码规则批量导入功能（使用UniSheet）

**验收标准：**
- ✅ 编码规则CRUD功能正常
- ✅ 编码生成逻辑正确
- ✅ 编码唯一性验证正常
- ✅ 编码规则API可用
- ✅ 编码规则页面布局统一
- ✅ 编码规则批量导入可用

**Inngest工作流：**
- ⚠️ 可选：编码生成异步任务（大数据量场景）

**预计时间：** 0.5周

---

#### 功能点1.4：数据访问层优化

**功能描述：** 优化数据库连接和查询性能（支持大数据量场景）

**任务清单：**
- [ ] 优化数据库连接池配置
- [ ] 优化ORM查询性能（添加索引）
- [ ] 实现查询缓存机制（Redis）
- [ ] 实现查询结果缓存
- [ ] 实现慢查询监控
- [ ] 实现查询性能分析工具

**测试用例：**
- [ ] 测试数据库连接池性能
- [ ] 测试ORM查询性能（大数据量：10万+记录）
- [ ] 测试查询缓存命中率
- [ ] 测试查询结果缓存有效期
- [ ] 测试慢查询监控功能
- [ ] 测试查询性能分析工具

**验收标准：**
- ✅ 数据库连接池配置优化
- ✅ ORM查询性能提升50%+
- ✅ 查询缓存命中率>80%
- ✅ 慢查询监控正常
- ✅ 查询性能分析工具可用

**预计时间：** 1周

---

#### 功能点1.5：文件管理服务完善

**功能描述：** 完善文件上传/下载功能（支持Excel、PDF等常用格式）

**任务清单：**
- [ ] 完善文件上传API（支持大文件，支持Excel、PDF等格式）
- [ ] 完善文件下载API（支持断点续传）
- [ ] 实现文件预览功能（图片、PDF、Excel等）
- [ ] 实现文件管理功能（列表、删除等）
- [ ] 实现文件权限控制
- [ ] 前端页面：文件管理（使用UniTable + 高级搜索）
- [ ] 前端页面：文件上传（使用统一上传组件）

**测试用例：**
- [ ] 测试文件上传（小文件）
- [ ] 测试文件上传（大文件>100MB）
- [ ] 测试文件上传（Excel格式）
- [ ] 测试文件上传（PDF格式）
- [ ] 测试文件下载功能
- [ ] 测试文件预览功能（图片）
- [ ] 测试文件预览功能（PDF）
- [ ] 测试文件预览功能（Excel）
- [ ] 测试文件删除功能
- [ ] 测试文件权限控制
- [ ] 测试文件管理高级搜索功能

**验收标准：**
- ✅ 文件上传功能正常（支持Excel、PDF等格式）
- ✅ 文件下载功能正常
- ✅ 文件预览功能正常（图片、PDF、Excel）
- ✅ 文件管理功能正常
- ✅ 文件权限控制正常
- ✅ 文件管理页面布局统一

**预计时间：** 0.5周

---

### 4.2 第二阶段：服务接口层完善（3-4周）

#### 功能点2.1：定义核心服务接口

**功能描述：** 为所有服务定义接口

**任务清单：**
- [ ] 定义部门管理服务接口（`DepartmentServiceInterface`）
- [ ] 定义系统参数服务接口（`SystemParameterServiceInterface`）
- [ ] 定义文件管理服务接口（`FileServiceInterface`）
- [ ] 定义菜单管理服务接口（`MenuServiceInterface`）
- [ ] 定义权限管理服务接口（`PermissionServiceInterface`）
- [ ] 定义编码规则服务接口（`CodeRuleServiceInterface`）
- [ ] ... 等30+个服务接口

**测试用例：**
- [ ] 测试服务接口定义完整性
- [ ] 测试服务接口方法签名正确性
- [ ] 测试服务接口继承关系正确性

**验收标准：**
- ✅ 所有服务都有接口定义
- ✅ 服务接口方法签名正确
- ✅ 服务接口继承关系正确

**预计时间：** 2周

---

#### 功能点2.2：创建服务适配器

**功能描述：** 为所有服务创建适配器实现

**任务清单：**
- [ ] 创建部门管理服务适配器（`DepartmentServiceImpl`）
- [ ] 创建系统参数服务适配器（`SystemParameterServiceImpl`）
- [ ] 创建文件管理服务适配器（`FileServiceImpl`）
- [ ] ... 等30+个服务适配器

**测试用例：**
- [ ] 测试服务适配器实现完整性
- [ ] 测试服务适配器方法实现正确性
- [ ] 测试服务适配器注册到服务注册表

**验收标准：**
- ✅ 所有服务都有适配器实现
- ✅ 服务适配器方法实现正确
- ✅ 服务适配器注册成功

**预计时间：** 2周

---

#### 功能点2.3：创建依赖注入函数

**功能描述：** 为所有服务创建依赖注入函数

**任务清单：**
- [ ] 创建部门服务依赖注入函数（`get_department_service_with_fallback`）
- [ ] 创建系统参数服务依赖注入函数（`get_system_parameter_service_with_fallback`）
- [ ] ... 等30+个依赖注入函数

**测试用例：**
- [ ] 测试依赖注入函数可用性
- [ ] 测试依赖注入函数fallback机制
- [ ] 测试依赖注入函数在API路由中使用

**验收标准：**
- ✅ 所有服务都有依赖注入函数
- ✅ 依赖注入函数fallback机制正常
- ✅ 依赖注入函数在API路由中可用

**预计时间：** 1周

---

### 4.3 第三阶段：API路由迁移（2-3周）

#### 功能点3.1：迁移核心API路由

**功能描述：** 迁移所有API路由到依赖注入模式

**任务清单：**
- [ ] 迁移用户管理API（部分已完成）
- [ ] 迁移部门管理API
- [ ] 迁移系统参数API
- [ ] 迁移文件管理API
- [ ] 迁移菜单管理API
- [ ] 迁移权限管理API
- [ ] ... 等200+个路由

**测试用例：**
- [ ] 测试每个API路由使用依赖注入
- [ ] 测试每个API路由功能正常
- [ ] 测试每个API路由性能正常

**验收标准：**
- ✅ 所有API路由都使用依赖注入
- ✅ 所有API路由功能正常
- ✅ 所有API路由性能正常

**预计时间：** 2-3周

---

### 4.4 第四阶段：MES系统针对性能力建设（4-6周）

#### 功能点4.1：实时数据推送机制

**功能描述：** 实现WebSocket/SSE实时数据推送（符合中国制造业实时监控需求）

**任务清单：**
- [ ] 实现WebSocket服务器端（FastAPI）
- [ ] 实现WebSocket客户端（React）
- [ ] 实现数据推送机制
- [ ] 实现断线重连机制（网络不稳定场景）
- [ ] 实现消息队列（可选）
- [ ] 实现数据推送性能优化（支持多客户端）

**测试用例：**
- [ ] 测试WebSocket连接建立
- [ ] 测试数据推送功能
- [ ] 测试断线重连功能（模拟网络中断）
- [ ] 测试多客户端连接（100+客户端）
- [ ] 测试消息队列功能（可选）
- [ ] 测试数据推送性能（低延迟）

**验收标准：**
- ✅ WebSocket连接正常
- ✅ 数据推送功能正常
- ✅ 断线重连功能正常（网络不稳定场景）
- ✅ 支持多客户端连接（100+客户端）
- ✅ 数据推送延迟<100ms

**Inngest工作流：**
- ⚠️ 可选：数据推送异步任务（大数据量场景）

**预计时间：** 1-2周

---

#### 功能点4.2：大数据量查询优化

**功能描述：** 优化大数据量查询性能（支持中国制造业大数据量场景）

**任务清单：**
- [ ] 分析慢查询日志
- [ ] 优化数据库索引
- [ ] 实现游标分页（支持10万+记录）
- [ ] 实现查询缓存
- [ ] 实现查询性能分析工具
- [ ] 性能测试和优化

**测试用例：**
- [ ] 测试数据库索引优化效果
- [ ] 测试游标分页性能（10万+记录）
- [ ] 测试查询缓存命中率
- [ ] 测试大数据量查询性能（10万+记录）
- [ ] 测试查询性能分析工具

**验收标准：**
- ✅ 数据库索引优化完成
- ✅ 游标分页性能提升50%+
- ✅ 查询缓存命中率>80%
- ✅ 大数据量查询性能满足要求（10万+记录，<2秒）
- ✅ 查询性能分析工具可用

**预计时间：** 1-2周

---

#### 功能点4.3：流程引擎增强

**功能描述：** 增强审批流程引擎，支持复杂业务流程（符合中国制造业审批习惯）

**任务清单：**
- [ ] 扩展流程模型（支持条件分支、并行流程）
- [ ] 实现流程执行引擎
- [ ] 实现流程可视化设计器（拖拽式设计）
- [ ] 实现流程监控和统计
- [ ] 前端页面：流程设计器（使用统一布局）
- [ ] 前端页面：流程监控（使用统一布局）

**测试用例：**
- [ ] 测试条件分支流程
- [ ] 测试并行流程
- [ ] 测试流程可视化设计器
- [ ] 测试流程监控和统计
- [ ] 测试流程页面布局统一性

**验收标准：**
- ✅ 支持条件分支流程
- ✅ 支持并行流程
- ✅ 流程可视化设计器可用（拖拽式设计）
- ✅ 流程监控和统计正常
- ✅ 流程页面布局统一

**Inngest工作流：**
- ✅ 必需：流程执行工作流（`approval_workflow_function`）

**预计时间：** 2-3周

---

#### 功能点4.4：报表系统增强

**功能描述：** 增强报表配置和导出功能（符合中国制造业报表需求）

**任务清单：**
- [ ] 实现报表设计器（拖拽式设计）
- [ ] 实现报表引擎
- [ ] 实现报表导出（Excel、PDF）
  - [ ] Excel导出（支持复杂格式、图表）
  - [ ] PDF导出（支持中文字体）
- [ ] 实现报表模板管理
- [ ] 实现报表调度（定时生成报表）
- [ ] 前端页面：报表设计器（使用统一布局）
- [ ] 前端页面：报表管理（使用UniTable + 高级搜索）

**测试用例：**
- [ ] 测试报表设计器功能（拖拽式设计）
- [ ] 测试报表引擎功能
- [ ] 测试报表导出（Excel，支持复杂格式）
- [ ] 测试报表导出（PDF，支持中文）
- [ ] 测试报表模板管理
- [ ] 测试报表调度功能
- [ ] 测试报表页面布局统一性
- [ ] 测试报表高级搜索功能

**验收标准：**
- ✅ 报表设计器可用（拖拽式设计）
- ✅ 报表引擎功能正常
- ✅ 报表导出功能正常（Excel、PDF，支持中文）
- ✅ 报表模板管理正常
- ✅ 报表调度功能正常
- ✅ 报表页面布局统一

**Inngest工作流：**
- ✅ 必需：报表生成工作流（异步生成大报表）

**预计时间：** 2-3周

---

## 5. 应用级功能点清单（快智造）- 优化版

### 5.1 MVP阶段功能点（6周）

#### 功能点M1.1：基础架构搭建

**功能描述：** 搭建快智造应用基础架构

**任务清单：**
- [ ] 创建应用目录结构
- [ ] 注册应用到系统（Application模型）
- [ ] 创建应用路由注册
- [ ] 创建应用菜单配置（`manifest.json`）
- [ ] 创建核心数据模型（WorkOrder、WorkOrderProcess、WorkReport、Inventory、StockIn、StockOut）
- [ ] 创建数据库迁移脚本
- [ ] 集成 master_data API（调用基础数据）

**测试用例：**
- [ ] 测试应用注册成功
- [ ] 测试应用路由注册成功
- [ ] 测试应用菜单加载成功
- [ ] 测试数据模型创建成功
- [ ] 测试数据库迁移成功
- [ ] 测试 master_data API调用成功

**验收标准：**
- ✅ 应用注册成功
- ✅ 应用路由注册成功
- ✅ 应用菜单加载成功
- ✅ 数据模型创建成功
- ✅ 数据库迁移成功
- ✅ master_data API调用成功

**预计时间：** 0.5周

---

#### 功能点M1.2：基础数据API集成

**功能描述：** 集成主数据管理APP的基础数据API（只读）

**任务清单：**
- [ ] 创建 master_data API 客户端服务（只读调用）
- [ ] 实现工厂/车间/工作中心数据获取接口
- [ ] 实现物料/BOM数据获取接口
- [ ] 实现仓库数据获取接口
- [ ] 前端页面：基础数据选择组件（下拉选择、树形选择，支持拼音搜索）
- [ ] 前端页面：基础数据展示组件（只读展示）
- [ ] 前端页面：提供跳转链接到 master_data 应用进行基础数据管理

**测试用例：**
- [ ] 测试工厂/车间/工作中心数据获取
- [ ] 测试物料/BOM数据获取
- [ ] 测试仓库数据获取
- [ ] 测试基础数据选择组件（下拉选择）
- [ ] 测试基础数据选择组件（树形选择）
- [ ] 测试基础数据选择组件（拼音搜索）
- [ ] 测试基础数据展示组件
- [ ] 测试跳转链接功能

**验收标准：**
- ✅ master_data API客户端服务可用
- ✅ 基础数据获取功能正常
- ✅ 基础数据选择组件可用（支持拼音搜索）
- ✅ 基础数据展示组件可用
- ✅ 跳转链接功能正常

**预计时间：** 0.5周

---

#### 功能点M1.3：工单管理

**功能描述：** 实现工单管理核心功能（符合中国制造业工单管理习惯）

**任务清单：**
- [ ] 工单管理API（创建、下达、查询、状态更新）
- [ ] 工单工序管理API
- [ ] 工单号自动生成（基于编码规则，支持中文前缀）
- [ ] 前端页面：工单列表（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：工单创建/编辑（使用统一表单布局，选择物料、车间、工作中心）
- [ ] 前端页面：工单详情（使用Drawer，统一布局）
- [ ] **齐套料分析API**（根据BOM展开物料需求，检查库存齐套情况）
- [ ] **齐套料分析页面**（显示齐套状态、缺料明细、缺料数量）
- [ ] 工单状态流转逻辑（创建→下达→执行→完工）
- [ ] **工单下达前齐套检查**（缺料时提示，可选择强制下达）
- [ ] 工单二维码生成（用于扫码报工，支持中文显示）
- [ ] 工单打印功能（支持打印模板）

**测试用例：**
- [ ] 测试工单创建功能
- [ ] 测试工单下达功能
- [ ] 测试工单查询功能（列表、详情）
- [ ] 测试工单状态更新功能
- [ ] 测试工单号自动生成功能（中文前缀：工单-20260101001）
- [ ] **测试齐套料分析功能（根据BOM展开物料需求）**
- [ ] **测试齐套料分析功能（检查库存齐套情况）**
- [ ] **测试齐套料分析功能（显示缺料明细和缺料数量）**
- [ ] **测试工单下达前齐套检查功能（缺料时提示）**
- [ ] **测试工单强制下达功能（缺料时仍可下达）**
- [ ] 测试工单状态流转逻辑
- [ ] 测试工单二维码生成功能（支持中文）
- [ ] 测试工单列表高级搜索功能（拼音搜索）
- [ ] 测试工单批量导入功能（使用UniSheet）
- [ ] 测试工单打印功能
- [ ] 测试工单页面布局统一性

**验收标准：**
- ✅ 工单CRUD功能正常
- ✅ 工单状态流转正常
- ✅ 工单号自动生成正常（支持中文前缀）
- ✅ **齐套料分析功能正常（BOM展开、库存检查、缺料明细）**
- ✅ **工单下达前齐套检查正常（缺料提示、强制下达）**
- ✅ 工单二维码生成正常（支持中文）
- ✅ 工单列表高级搜索可用（拼音搜索）
- ✅ 工单批量导入可用（Excel导入）
- ✅ 工单打印功能可用
- ✅ 工单页面布局统一

**Inngest工作流：**
- ✅ 必需：工单状态流转工作流（异步处理状态变更）
- ✅ 必需：齐套料分析工作流（异步分析物料齐套情况）
- ⚠️ 可选：工单批量导入工作流（大数据量导入）

**预计时间：** 1.5周（含齐套料分析功能）

---

#### 功能点M1.4：报工管理

**功能描述：** 实现报工管理功能（符合中国制造业报工习惯，移动端优化）

**任务清单：**
- [ ] 报工API（扫码报工、进度汇报）
- [ ] 报工记录查询API
- [ ] 前端页面：报工界面（支持扫码，移动端优化，支持语音输入）
- [ ] 前端页面：报工记录查询（使用UniTable + 高级搜索 + 统一布局）
- [ ] 报工后自动更新工单进度
- [ ] 工单完工自动判断（所有工序完成）
- [ ] 报工数据验证（数量、工时等）

**测试用例：**
- [ ] 测试扫码报工功能（移动端）
- [ ] 测试进度汇报功能
- [ ] 测试报工记录查询功能
- [ ] 测试报工后工单进度更新
- [ ] 测试工单完工自动判断
- [ ] 测试报工记录高级搜索功能（拼音搜索）
- [ ] 测试报工记录批量导入功能（使用UniSheet）
- [ ] 测试报工数据验证（数量、工时）
- [ ] 测试报工界面移动端适配
- [ ] 测试报工界面语音输入功能
- [ ] 测试报工页面布局统一性

**验收标准：**
- ✅ 报工功能正常（移动端优化）
- ✅ 报工记录查询正常
- ✅ 工单进度自动更新正常
- ✅ 工单完工自动判断正常
- ✅ 报工记录高级搜索可用（拼音搜索）
- ✅ 报工记录批量导入可用（Excel导入）
- ✅ 报工数据验证正常
- ✅ 报工界面移动端适配良好
- ✅ 报工页面布局统一

**Inngest工作流：**
- ✅ 必需：报工数据处理工作流（异步处理报工数据）
- ✅ 必需：工单进度更新工作流（异步更新工单进度）

**预计时间：** 1周

---

#### 功能点M1.5：仓储管理

**功能描述：** 实现基础仓储管理功能（符合中国制造业仓储管理习惯）

**任务清单：**
- [ ] 库存管理API（查询、更新）
- [ ] 入库单API（创建、查询）
- [ ] 出库单API（创建、查询）
- [ ] 前端页面：库存查询（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：入库单管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：出库单管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 生产领料功能（关联工单，根据BOM生成领料需求）
- [ ] 成品入库功能（关联工单）
- [ ] 库存自动更新（入库/出库后更新库存）
- [ ] 库存盘点功能（支持Excel导入盘点数据）
- [ ] **安全库存管理**（设置安全库存、最低库存、最高库存）
- [ ] **库存预警功能**（缺料预警、积压预警、过期预警）
- [ ] **ABC分类管理**（自动分类A/B/C类物料）
- [ ] **齐套料分析功能**（根据工单BOM分析物料齐套情况，支持多工单批量分析）

**测试用例：**
- [ ] 测试库存查询功能
- [ ] 测试库存更新功能
- [ ] 测试入库单创建功能
- [ ] 测试出库单创建功能
- [ ] 测试生产领料功能
- [ ] 测试成品入库功能
- [ ] 测试库存自动更新功能
- [ ] 测试库存查询高级搜索功能（拼音搜索）
- [ ] 测试入库单批量导入功能（使用UniSheet）
- [ ] 测试出库单批量导入功能（使用UniSheet）
- [ ] 测试库存盘点功能（Excel导入）
- [ ] **测试安全库存设置功能**
- [ ] **测试缺料预警功能（低于安全库存自动预警）**
- [ ] **测试积压预警功能（超过最高库存自动预警）**
- [ ] **测试ABC分类功能（自动分类A/B/C类物料）**
- [ ] **测试齐套料分析功能（根据工单BOM分析物料齐套情况）**
- [ ] **测试多工单批量齐套分析功能**
- [ ] 测试仓储管理页面布局统一性

**验收标准：**
- ✅ 库存管理功能正常
- ✅ 入库单管理功能正常
- ✅ 出库单管理功能正常
- ✅ 生产领料功能正常
- ✅ 成品入库功能正常
- ✅ 库存自动更新正常
- ✅ 库存查询高级搜索可用（拼音搜索）
- ✅ 入库单批量导入可用（Excel导入）
- ✅ 出库单批量导入可用（Excel导入）
- ✅ 库存盘点功能可用（Excel导入）
- ✅ **安全库存管理正常（设置、预警）**
- ✅ **库存预警功能正常（缺料、积压、过期预警）**
- ✅ **ABC分类管理正常（自动分类、分类查询）**
- ✅ **齐套料分析功能正常（单工单、多工单批量分析）**
- ✅ 仓储管理页面布局统一

**Inngest工作流：**
- ✅ 必需：库存更新工作流（异步更新库存）
- ✅ 必需：库存预警工作流（定时检查库存预警）
- ⚠️ 可选：库存盘点工作流（定时盘点）

**预计时间：** 1.5周

---

#### 功能点M1.6：生产看板

**功能描述：** 实现生产看板功能（符合中国制造业看板需求，支持大屏显示）

**任务清单：**
- [ ] 生产看板API（工单进度、状态统计）
- [ ] 前端页面：生产看板（实时数据展示，支持大屏模式）
- [ ] 工单进度可视化（进度条、状态卡片）
- [ ] 关键指标统计（进行中工单数、完工工单数、延期工单数）
- [ ] **延期预警功能**（工单延期自动预警）
- [ ] **交期达成率统计**（按时完工率）
- [ ] 看板数据实时更新（WebSocket）
- [ ] 看板数据导出（Excel、PDF）

**测试用例：**
- [ ] 测试生产看板API功能
- [ ] 测试工单进度可视化
- [ ] 测试关键指标统计
- [ ] 测试实时数据更新（WebSocket）
- [ ] 测试看板大屏模式
- [ ] 测试看板数据导出（Excel）
- [ ] 测试看板数据导出（PDF）
- [ ] 测试看板页面布局统一性

**验收标准：**
- ✅ 生产看板API功能正常
- ✅ 工单进度可视化正常
- ✅ 关键指标统计正常
- ✅ 实时数据更新正常（WebSocket，延迟<100ms）
- ✅ 看板大屏模式可用
- ✅ 看板数据导出可用（Excel、PDF）

**Inngest工作流：**
- ✅ 必需：看板数据更新工作流（定时更新看板数据）

**预计时间：** 0.5周

---

#### 功能点M1.7：预警中心（新增）

**功能描述：** 实现统一预警中心（符合中小制造业企业预警需求，实用、易用）

**任务清单：**
- [ ] 预警中心API（统一预警查询、预警处理）
- [ ] 前端页面：预警中心（使用UniTable + 高级搜索 + 统一布局）
- [ ] **库存预警**（缺料预警、积压预警、过期预警）
- [ ] **交期预警**（工单延期预警、交期风险预警）
- [ ] **质量预警**（不良品率超标预警、检验异常预警）
- [ ] **设备预警**（设备故障预警、保养到期预警）
- [ ] **成本预警**（成本超预算预警、成本异常预警）
- [ ] 预警规则配置（预警阈值设置）
- [ ] 预警消息推送（站内消息、短信、邮件）
- [ ] 预警处理流程（确认、处理、关闭）
- [ ] 预警统计报表（预警趋势、预警分类统计）

**测试用例：**
- [ ] 测试库存预警功能（缺料、积压、过期）
- [ ] 测试交期预警功能（延期、风险）
- [ ] 测试质量预警功能（不良品率、检验异常）
- [ ] 测试设备预警功能（故障、保养到期）
- [ ] 测试成本预警功能（超预算、异常）
- [ ] 测试预警规则配置功能
- [ ] 测试预警消息推送功能（站内消息、短信、邮件）
- [ ] 测试预警处理流程（确认、处理、关闭）
- [ ] 测试预警统计报表功能
- [ ] 测试预警中心高级搜索功能（拼音搜索）
- [ ] 测试预警中心页面布局统一性

**验收标准：**
- ✅ 预警中心功能正常（统一预警管理）
- ✅ 库存预警功能正常（缺料、积压、过期）
- ✅ 交期预警功能正常（延期、风险）
- ✅ 质量预警功能正常（不良品率、检验异常）
- ✅ 设备预警功能正常（故障、保养到期）
- ✅ 成本预警功能正常（超预算、异常）
- ✅ 预警规则配置正常（阈值设置）
- ✅ 预警消息推送正常（站内消息、短信、邮件）
- ✅ 预警处理流程正常（确认、处理、关闭）
- ✅ 预警统计报表正常（趋势、分类统计）
- ✅ 预警中心高级搜索可用（拼音搜索）
- ✅ 预警中心页面布局统一

**Inngest工作流：**
- ✅ 必需：预警检查工作流（定时检查各类预警）
- ✅ 必需：预警消息推送工作流（异步推送预警消息）

**预计时间：** 1.5周

---

#### 功能点M1.8：测试与优化

**功能描述：** 测试MVP功能，优化用户体验（符合中国制造业用户习惯）

**任务清单：**
- [ ] 功能测试（所有功能点）
- [ ] 性能测试（大数据量场景：10万+记录）
- [ ] 移动端测试（报工界面）
- [ ] 用户体验优化（符合中国用户习惯）
- [ ] 文档编写（用户手册、API文档，中文）
- [ ] 示例数据准备（符合中国制造业场景）

**测试用例：**
- [ ] 端到端测试（完整业务流程）
- [ ] 性能测试（并发用户50+、大数据量10万+）
- [ ] 移动端测试（报工界面，iOS、Android）
- [ ] 用户体验测试（符合中国用户习惯）
- [ ] 中文显示测试（所有页面中文显示正常）

**验收标准：**
- ✅ 所有功能测试通过
- ✅ 性能测试满足要求（10万+记录，<2秒）
- ✅ 移动端测试通过（iOS、Android）
- ✅ 用户体验良好（符合中国用户习惯）
- ✅ 文档完整（中文）
- ✅ 示例数据符合中国制造业场景

**预计时间：** 1周

---

### 5.2 第一阶段扩展功能点（10-12周）

#### 功能点M2.0：成本管理（新增，中小制造业企业核心需求）

**功能描述：** 实现成本管理功能（符合中小制造业企业成本控制需求，实用、易用）

**任务清单：**
- [ ] 成本核算API（材料成本、人工成本、制造费用）
- [ ] 标准成本管理API（标准成本设置、标准成本查询）
- [ ] 实际成本管理API（实际成本计算、实际成本查询）
- [ ] 成本分析API（成本构成分析、成本趋势分析、成本对比分析）
- [ ] 前端页面：标准成本管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：实际成本查询（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：成本分析报表（使用统一布局，图表展示）
- [ ] **材料成本核算**（基于BOM和采购价格）
- [ ] **人工成本核算**（基于报工工时和人工费率）
- [ ] **制造费用核算**（设备折旧、水电费等）
- [ ] **成本预警功能**（成本超预算预警、成本异常预警）
- [ ] **成本对比分析**（标准成本 vs 实际成本、同期对比）
- [ ] 成本数据导出（Excel导出）
- [ ] 成本数据打印（打印模板）

**测试用例：**
- [ ] 测试标准成本设置功能
- [ ] 测试材料成本核算功能（基于BOM和采购价格）
- [ ] 测试人工成本核算功能（基于报工工时和人工费率）
- [ ] 测试制造费用核算功能（设备折旧、水电费等）
- [ ] 测试实际成本计算功能（工单成本、产品成本）
- [ ] 测试成本构成分析功能（材料、人工、费用占比）
- [ ] 测试成本趋势分析功能（月度、季度、年度趋势）
- [ ] 测试成本对比分析功能（标准 vs 实际、同期对比）
- [ ] 测试成本预警功能（超预算、异常）
- [ ] 测试成本数据导出功能（Excel导出）
- [ ] 测试成本数据打印功能
- [ ] 测试成本管理高级搜索功能（拼音搜索）
- [ ] 测试成本管理页面布局统一性

**验收标准：**
- ✅ 成本核算功能正常（材料、人工、费用）
- ✅ 标准成本管理正常（设置、查询）
- ✅ 实际成本管理正常（计算、查询）
- ✅ 成本分析功能正常（构成、趋势、对比）
- ✅ 成本预警功能正常（超预算、异常）
- ✅ 成本数据导出可用（Excel导出）
- ✅ 成本数据打印可用
- ✅ 成本管理高级搜索可用（拼音搜索）
- ✅ 成本管理页面布局统一

**Inngest工作流：**
- ✅ 必需：成本核算工作流（异步计算工单成本、产品成本）
- ✅ 必需：成本预警工作流（定时检查成本预警）

**预计时间：** 2.5周

---

#### 功能点M2.1：需求管理

**功能描述：** 实现MTS/MTO需求管理（符合中国制造业需求管理习惯）

**任务清单：**
- [ ] 销售预测API（MTS模式）
- [ ] 销售订单API（MTO模式）
- [ ] 前端页面：销售预测管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：销售订单管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 需求数据导入功能（Excel导入，使用UniSheet）
- [ ] 需求数据导出功能（Excel导出）
- [ ] 需求数据打印功能（打印模板）

**测试用例：**
- [ ] 测试销售预测CRUD功能
- [ ] 测试销售订单CRUD功能
- [ ] 测试销售预测高级搜索功能（拼音搜索）
- [ ] 测试销售订单高级搜索功能（拼音搜索）
- [ ] 测试需求数据导入功能（使用UniSheet）
- [ ] 测试需求数据导出功能（Excel导出）
- [ ] 测试需求数据打印功能
- [ ] 测试需求管理页面布局统一性

**验收标准：**
- ✅ 销售预测管理功能正常
- ✅ 销售订单管理功能正常
- ✅ 需求数据导入功能正常（Excel导入）
- ✅ 需求数据导出功能正常（Excel导出）
- ✅ 需求数据打印功能可用
- ✅ 需求管理页面布局统一

**Inngest工作流：**
- ⚠️ 可选：需求数据导入工作流（大数据量导入）

**预计时间：** 2周

---

#### 功能点M2.2：计划排程（MRP/LRP运算）

**功能描述：** 实现MRP/LRP运算（符合中国制造业计划排程需求）

**任务清单：**
- [ ] MRP运算引擎（根据销售预测和库存计算物料需求）
- [ ] LRP运算引擎（根据销售订单计算批次需求）
- [ ] MRP结果API
- [ ] LRP结果API
- [ ] 前端页面：MRP运算界面（使用统一布局）
- [ ] 前端页面：LRP运算界面（使用统一布局）
- [ ] 前端页面：MRP/LRP结果展示（使用UniTable + 高级搜索 + 统一布局）
- [ ] 自动生成工单建议（根据MRP/LRP结果）
- [ ] 自动生成采购建议（根据MRP/LRP结果）
- [ ] MRP/LRP结果导出（Excel导出）

**测试用例：**
- [ ] 测试MRP运算功能
- [ ] 测试LRP运算功能
- [ ] 测试MRP结果展示
- [ ] 测试LRP结果展示
- [ ] 测试工单建议生成
- [ ] 测试采购建议生成
- [ ] 测试MRP/LRP运算性能（大数据量：1000+物料）
- [ ] 测试MRP/LRP结果导出（Excel导出）
- [ ] 测试MRP/LRP页面布局统一性

**验收标准：**
- ✅ MRP运算功能正常
- ✅ LRP运算功能正常
- ✅ 工单建议生成正常
- ✅ 采购建议生成正常
- ✅ MRP/LRP运算性能满足要求（1000+物料，<30秒）
- ✅ MRP/LRP结果导出可用（Excel导出）
- ✅ MRP/LRP页面布局统一

**Inngest工作流：**
- ✅ 必需：MRP运算工作流（异步执行MRP运算）
- ✅ 必需：LRP运算工作流（异步执行LRP运算）

**预计时间：** 3周

---

#### 功能点M2.3：高级排产

**功能描述：** 实现可视化排产（符合中国制造业排产需求）

**任务清单：**
- [ ] 排产计划API
- [ ] 排产甘特图API（获取排产数据）
- [ ] 前端页面：排产甘特图（可视化排程，支持拖拽）
- [ ] 拖拽调整排产计划
- [ ] 工作中心能力检查
- [ ] 排产计划导出（Excel导出）
- [ ] 排产计划打印（打印模板）

**测试用例：**
- [ ] 测试排产计划创建功能
- [ ] 测试排产甘特图展示功能
- [ ] 测试拖拽调整排产计划功能
- [ ] 测试工作中心能力检查功能
- [ ] 测试排产计划导出（Excel导出）
- [ ] 测试排产计划打印功能
- [ ] 测试排产页面布局统一性

**验收标准：**
- ✅ 排产计划功能正常
- ✅ 排产甘特图展示正常（支持拖拽）
- ✅ 拖拽调整排产计划正常
- ✅ 工作中心能力检查正常
- ✅ 排产计划导出可用（Excel导出）
- ✅ 排产计划打印可用
- ✅ 排产页面布局统一

**Inngest工作流：**
- ⚠️ 可选：排产计划优化工作流（自动优化排产计划）

**预计时间：** 2周

---

#### 功能点M2.4：采购管理

**功能描述：** 实现采购管理功能（符合中国制造业采购管理习惯）

**任务清单：**
- [ ] 采购单API
- [ ] 前端页面：采购单管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 根据MRP/LRP采购建议生成采购单
- [ ] 采购入库功能（关联采购单）
- [ ] 采购单批量导入（Excel导入，使用UniSheet）
- [ ] 采购单导出（Excel导出）
- [ ] 采购单打印（打印模板）

**测试用例：**
- [ ] 测试采购单CRUD功能
- [ ] 测试采购单高级搜索功能（拼音搜索）
- [ ] 测试根据MRP/LRP建议生成采购单
- [ ] 测试采购入库功能
- [ ] 测试采购单批量导入功能（使用UniSheet）
- [ ] 测试采购单导出功能（Excel导出）
- [ ] 测试采购单打印功能
- [ ] 测试采购管理页面布局统一性

**验收标准：**
- ✅ 采购单管理功能正常
- ✅ 采购单高级搜索可用（拼音搜索）
- ✅ 采购单批量导入可用（Excel导入）
- ✅ 采购单导出可用（Excel导出）
- ✅ 采购单打印可用
- ✅ 采购管理页面布局统一

**Inngest工作流：**
- ⚠️ 可选：采购单批量导入工作流（大数据量导入）

**预计时间：** 1.5周

---

#### 功能点M2.5：销售出库

**功能描述：** 实现销售出库功能（符合中国制造业销售出库习惯）

**任务清单：**
- [ ] 销售出库API（MTO关联订单，MTS从库存发货）
- [ ] 前端页面：销售出库管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] MTO订单专属库存管理
- [ ] 生产退料功能
- [ ] 销售出库批量导入（Excel导入，使用UniSheet）
- [ ] 销售出库导出（Excel导出）
- [ ] 销售出库打印（打印模板）

**测试用例：**
- [ ] 测试销售出库功能（MTO模式）
- [ ] 测试销售出库功能（MTS模式）
- [ ] 测试MTO订单专属库存管理
- [ ] 测试生产退料功能
- [ ] 测试销售出库高级搜索功能（拼音搜索）
- [ ] 测试销售出库批量导入功能（使用UniSheet）
- [ ] 测试销售出库导出功能（Excel导出）
- [ ] 测试销售出库打印功能
- [ ] 测试销售出库页面布局统一性

**验收标准：**
- ✅ 销售出库功能正常
- ✅ MTO订单专属库存管理正常
- ✅ 生产退料功能正常
- ✅ 销售出库批量导入可用（Excel导入）
- ✅ 销售出库导出可用（Excel导出）
- ✅ 销售出库打印可用
- ✅ 销售出库页面布局统一

**预计时间：** 1周

---

#### 功能点M2.6：设备管理（增强，中小制造业企业核心需求）

**功能描述：** 实现设备管理功能（符合中小制造业企业设备管理需求，实用、易用）

**任务清单：**
- [ ] 设备台账管理API（设备信息、设备档案）
- [ ] 设备保养计划API（保养计划、保养记录）
- [ ] 设备故障管理API（故障记录、故障处理）
- [ ] 设备看板API（设备状态监控、设备利用率统计）
- [ ] 前端页面：设备台账管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：设备保养计划（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：设备故障记录（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：设备看板（实时数据展示，支持大屏模式）
- [ ] **设备保养提醒**（保养到期自动提醒）
- [ ] **设备故障预警**（故障频率异常预警）
- [ ] **设备利用率统计**（设备利用率、OEE统计）
- [ ] 设备状态实时更新（WebSocket）
- [ ] 设备数据导出（Excel导出）
- [ ] 设备数据打印（打印模板）

**测试用例：**
- [ ] 测试设备台账管理功能（创建、查询、更新）
- [ ] 测试设备保养计划功能（创建、查询、执行）
- [ ] 测试设备故障记录功能（记录、查询、处理）
- [ ] 测试设备保养提醒功能（到期提醒）
- [ ] 测试设备故障预警功能（频率异常预警）
- [ ] 测试设备利用率统计功能（利用率、OEE）
- [ ] 测试设备看板功能（状态监控、实时更新）
- [ ] 测试设备数据导出功能（Excel导出）
- [ ] 测试设备数据打印功能
- [ ] 测试设备管理高级搜索功能（拼音搜索）
- [ ] 测试设备管理页面布局统一性

**验收标准：**
- ✅ 设备台账管理功能正常（信息、档案）
- ✅ 设备保养计划功能正常（计划、记录）
- ✅ 设备故障管理功能正常（记录、处理）
- ✅ 设备保养提醒功能正常（到期提醒）
- ✅ 设备故障预警功能正常（频率异常预警）
- ✅ 设备利用率统计正常（利用率、OEE）
- ✅ 设备看板功能正常（状态监控、实时更新）
- ✅ 设备数据导出可用（Excel导出）
- ✅ 设备数据打印可用
- ✅ 设备管理高级搜索可用（拼音搜索）
- ✅ 设备管理页面布局统一

**Inngest工作流：**
- ✅ 必需：设备保养提醒工作流（定时检查保养到期）
- ✅ 必需：设备故障预警工作流（定时检查故障频率）
- ✅ 必需：设备看板数据更新工作流（定时更新看板数据）

**预计时间：** 2周

---

**测试用例：**
- [ ] 测试设备看板API功能
- [ ] 测试设备状态实时更新（WebSocket）
- [ ] 测试设备看板大屏模式
- [ ] 测试设备看板数据导出（Excel导出）
- [ ] 测试设备看板页面布局统一性

**验收标准：**
- ✅ 设备看板功能正常
- ✅ 设备状态实时更新正常（WebSocket，延迟<100ms）
- ✅ 设备看板大屏模式可用
- ✅ 设备看板数据导出可用（Excel导出）
- ✅ 设备看板页面布局统一

**预计时间：** 0.5周

---

### 5.3 第二阶段扩展功能点（8-10周）

#### 功能点M3.0：人员效率管理（新增，中小制造业企业核心需求）

**功能描述：** 实现人员效率管理功能（符合中小制造业企业人员管理需求，实用、易用）

**任务清单：**
- [ ] 计件工资管理API（计件单价、计件工资计算）
- [ ] 工时统计API（报工工时统计、人员工时统计）
- [ ] 人员效率分析API（人员效率统计、效率趋势分析）
- [ ] 人员绩效统计API（产量统计、质量统计、效率统计）
- [ ] 前端页面：计件工资管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：工时统计（使用统一布局，图表展示）
- [ ] 前端页面：人员效率分析（使用统一布局，图表展示）
- [ ] 前端页面：人员绩效统计（使用统一布局，图表展示）
- [ ] **计件工资自动计算**（基于报工数量和计件单价）
- [ ] **工时统计**（按人员、按工单、按工序统计）
- [ ] **人员效率分析**（产量效率、质量效率、综合效率）
- [ ] **人员绩效排名**（产量排名、质量排名、效率排名）
- [ ] 人员效率数据导出（Excel导出）
- [ ] 人员效率数据打印（打印模板）

**测试用例：**
- [ ] 测试计件工资设置功能（计件单价设置）
- [ ] 测试计件工资自动计算功能（基于报工数量）
- [ ] 测试工时统计功能（按人员、按工单、按工序）
- [ ] 测试人员效率分析功能（产量、质量、综合效率）
- [ ] 测试人员绩效统计功能（产量、质量、效率）
- [ ] 测试人员绩效排名功能（产量、质量、效率排名）
- [ ] 测试人员效率数据导出功能（Excel导出）
- [ ] 测试人员效率数据打印功能
- [ ] 测试人员效率管理高级搜索功能（拼音搜索）
- [ ] 测试人员效率管理页面布局统一性

**验收标准：**
- ✅ 计件工资管理功能正常（设置、计算）
- ✅ 工时统计功能正常（按人员、按工单、按工序）
- ✅ 人员效率分析功能正常（产量、质量、综合效率）
- ✅ 人员绩效统计功能正常（产量、质量、效率）
- ✅ 人员绩效排名功能正常（产量、质量、效率排名）
- ✅ 人员效率数据导出可用（Excel导出）
- ✅ 人员效率数据打印可用
- ✅ 人员效率管理高级搜索可用（拼音搜索）
- ✅ 人员效率管理页面布局统一

**Inngest工作流：**
- ✅ 必需：计件工资计算工作流（异步计算计件工资）
- ✅ 必需：人员效率统计工作流（定时统计人员效率）

**预计时间：** 2周

---

#### 功能点M3.1：质量管理

**功能描述：** 实现完整的质量管理功能（符合中国制造业质量管理习惯）

**任务清单：**
- [ ] 来料检验API
- [ ] 过程检验API
- [ ] 成品检验API
- [ ] 前端页面：来料检验管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：过程检验管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：成品检验管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 检验结果关联库存（合格/不合格分别处理）
- [ ] 不良品处理流程
- [ ] 检验记录批量导入（Excel导入，使用UniSheet）
- [ ] 检验记录导出（Excel导出）
- [ ] 检验记录打印（打印模板）

**测试用例：**
- [ ] 测试来料检验功能
- [ ] 测试过程检验功能
- [ ] 测试成品检验功能
- [ ] 测试检验结果关联库存
- [ ] 测试不良品处理流程
- [ ] 测试检验记录高级搜索功能（拼音搜索）
- [ ] 测试检验记录批量导入功能（使用UniSheet）
- [ ] 测试检验记录导出功能（Excel导出）
- [ ] 测试检验记录打印功能
- [ ] 测试质量管理页面布局统一性

**验收标准：**
- ✅ 质量管理功能正常
- ✅ 检验结果关联库存正常
- ✅ 不良品处理流程正常
- ✅ 检验记录批量导入可用（Excel导入）
- ✅ 检验记录导出可用（Excel导出）
- ✅ 检验记录打印可用
- ✅ 质量管理页面布局统一

**Inngest工作流：**
- ✅ 必需：检验数据处理工作流（异步处理检验数据）
- ✅ 必需：不良品处理工作流（异步处理不良品）

**预计时间：** 3周

---

#### 功能点M3.2：财务协同

**功能描述：** 实现财务协同功能（符合中国制造业财务管理习惯）

**任务清单：**
- [ ] 应付管理API
- [ ] 应收管理API
- [ ] 前端页面：应付管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：应收管理（使用UniTable + 高级搜索 + 统一布局）
- [ ] 自动生成应付单（采购入库后）
- [ ] 自动生成应收单（销售出库后）
- [ ] 应付/应收数据导出（Excel导出）
- [ ] 应付/应收数据打印（打印模板）

**测试用例：**
- [ ] 测试应付管理功能
- [ ] 测试应收管理功能
- [ ] 测试自动生成应付单
- [ ] 测试自动生成应收单
- [ ] 测试应付/应收高级搜索功能（拼音搜索）
- [ ] 测试应付/应收数据导出功能（Excel导出）
- [ ] 测试应付/应收数据打印功能
- [ ] 测试财务协同页面布局统一性

**验收标准：**
- ✅ 财务协同功能正常
- ✅ 自动生成应付单正常
- ✅ 自动生成应收单正常
- ✅ 应付/应收数据导出可用（Excel导出）
- ✅ 应付/应收数据打印可用
- ✅ 财务协同页面布局统一

**Inngest工作流：**
- ✅ 必需：应付单生成工作流（异步生成应付单）
- ✅ 必需：应收单生成工作流（异步生成应收单）

**预计时间：** 2周

---

#### 功能点M3.3：经营看板（新增，中小制造业企业核心需求）

**功能描述：** 实现经营看板功能（符合中小制造业企业经营决策需求，实用、易用）

**任务清单：**
- [ ] 经营看板API（关键指标监控、异常预警）
- [ ] 前端页面：经营看板（实时数据展示，支持大屏模式）
- [ ] **关键指标监控**（产量、质量、成本、交期、库存等）
- [ ] **异常预警看板**（各类异常预警汇总）
- [ ] **经营趋势分析**（产量趋势、成本趋势、质量趋势等）
- [ ] **对比分析**（同期对比、目标对比）
- [ ] 看板数据实时更新（WebSocket）
- [ ] 看板数据导出（Excel、PDF）
- [ ] 看板自定义配置（指标选择、布局配置）

**测试用例：**
- [ ] 测试关键指标监控功能（产量、质量、成本、交期、库存）
- [ ] 测试异常预警看板功能（各类异常预警汇总）
- [ ] 测试经营趋势分析功能（产量、成本、质量趋势）
- [ ] 测试对比分析功能（同期对比、目标对比）
- [ ] 测试看板数据实时更新功能（WebSocket）
- [ ] 测试看板大屏模式功能
- [ ] 测试看板自定义配置功能（指标选择、布局配置）
- [ ] 测试看板数据导出功能（Excel、PDF）
- [ ] 测试经营看板页面布局统一性

**验收标准：**
- ✅ 关键指标监控功能正常（产量、质量、成本、交期、库存）
- ✅ 异常预警看板功能正常（各类异常预警汇总）
- ✅ 经营趋势分析功能正常（产量、成本、质量趋势）
- ✅ 对比分析功能正常（同期对比、目标对比）
- ✅ 看板数据实时更新正常（WebSocket，延迟<100ms）
- ✅ 看板大屏模式可用
- ✅ 看板自定义配置可用（指标选择、布局配置）
- ✅ 看板数据导出可用（Excel、PDF）
- ✅ 经营看板页面布局统一

**Inngest工作流：**
- ✅ 必需：经营看板数据更新工作流（定时更新看板数据）

**预计时间：** 1.5周

---

#### 功能点M3.4：高级报表

**功能描述：** 实现高级报表功能（符合中国制造业报表需求）

**任务清单：**
- [ ] 库存周转率分析API
- [ ] 工单绩效分析API
- [ ] 质量合格率统计API
- [ ] **成本分析报表API**（成本构成、成本趋势、成本对比）
- [ ] **设备利用率报表API**（设备利用率、OEE统计）
- [ ] **人员效率报表API**（人员效率、绩效排名）
- [ ] 前端页面：库存报表（使用统一布局）
- [ ] 前端页面：生产报表（使用统一布局）
- [ ] 前端页面：质量报表（使用统一布局）
- [ ] 前端页面：成本报表（使用统一布局）
- [ ] 前端页面：设备报表（使用统一布局）
- [ ] 前端页面：人员报表（使用统一布局）
- [ ] 报表导出功能（Excel、PDF，支持中文）
- [ ] 报表打印功能（打印模板）
- [ ] 报表大屏展示（支持大屏模式）

**测试用例：**
- [ ] 测试库存周转率分析功能
- [ ] 测试工单绩效分析功能
- [ ] 测试质量合格率统计功能
- [ ] 测试成本分析报表功能（成本构成、成本趋势、成本对比）
- [ ] 测试设备利用率报表功能（设备利用率、OEE统计）
- [ ] 测试人员效率报表功能（人员效率、绩效排名）
- [ ] 测试报表导出功能（Excel，支持中文）
- [ ] 测试报表导出功能（PDF，支持中文）
- [ ] 测试报表打印功能
- [ ] 测试报表大屏展示功能
- [ ] 测试高级报表页面布局统一性

**验收标准：**
- ✅ 高级报表功能正常（库存、生产、质量、成本、设备、人员）
- ✅ 成本分析报表正常（成本构成、成本趋势、成本对比）
- ✅ 设备利用率报表正常（设备利用率、OEE统计）
- ✅ 人员效率报表正常（人员效率、绩效排名）
- ✅ 报表导出功能正常（Excel、PDF，支持中文）
- ✅ 报表打印功能可用
- ✅ 报表大屏展示可用
- ✅ 高级报表页面布局统一

**Inngest工作流：**
- ✅ 必需：报表生成工作流（异步生成大报表）

**预计时间：** 2周

---

## 6. 应用级功能点清单（主数据管理）- 优化版

### 6.1 MVP支持优化功能点（4.5周）

#### 功能点D1.1：批量查询接口

**功能描述：** 添加批量查询接口（根据UUID列表批量获取）

**任务清单：**
- [ ] 实现物料批量查询接口（`POST /api/v1/apps/master-data/materials/batch`）
- [ ] 实现车间批量查询接口（`POST /api/v1/apps/master-data/factory/workshops/batch`）
- [ ] 实现产线批量查询接口（`POST /api/v1/apps/master-data/factory/production-lines/batch`）
- [ ] 实现仓库批量查询接口（`POST /api/v1/apps/master-data/warehouse/warehouses/batch`）

**测试用例：**
- [ ] 测试物料批量查询（10个UUID）
- [ ] 测试物料批量查询（100个UUID）
- [ ] 测试车间批量查询
- [ ] 测试产线批量查询
- [ ] 测试仓库批量查询
- [ ] 测试批量查询性能（<500ms for 100 UUIDs）

**验收标准：**
- ✅ 批量查询接口可用
- ✅ 批量查询性能满足要求（<500ms for 100 UUIDs）

**预计时间：** 0.5周

---

#### 功能点D1.2：简化查询接口

**功能描述：** 添加简化查询接口（只返回必要字段，支持拼音搜索）

**任务清单：**
- [ ] 实现物料简化查询接口（`GET /api/v1/apps/master-data/materials/simple`，支持拼音搜索）
- [ ] 实现车间简化查询接口（`GET /api/v1/apps/master-data/factory/workshops/simple`，支持拼音搜索）
- [ ] 实现产线简化查询接口（`GET /api/v1/apps/master-data/factory/production-lines/simple`，支持拼音搜索）
- [ ] 实现仓库简化查询接口（`GET /api/v1/apps/master-data/warehouse/warehouses/simple`，支持拼音搜索）

**测试用例：**
- [ ] 测试物料简化查询功能（拼音搜索）
- [ ] 测试车间简化查询功能（拼音搜索）
- [ ] 测试产线简化查询功能（拼音搜索）
- [ ] 测试仓库简化查询功能（拼音搜索）
- [ ] 测试简化查询性能（对比完整查询，提升50%+）

**验收标准：**
- ✅ 简化查询接口可用（支持拼音搜索）
- ✅ 简化查询性能提升50%+

**预计时间：** 0.5周

---

#### 功能点D1.3：BOM查询优化

**功能描述：** 优化BOM查询接口（支持多层级BOM，符合中国制造业BOM结构）

**任务清单：**
- [ ] 实现BOM多层级展开接口（`GET /api/v1/apps/master-data/materials/bom/expand/{material_uuid}`）
- [ ] 实现BOM扁平化展开接口（`GET /api/v1/apps/master-data/materials/bom/flatten/{material_uuid}`）
- [ ] 优化BOM查询性能（支持10层+ BOM）
- [ ] 前端页面：BOM树形展示（使用统一布局）

**测试用例：**
- [ ] 测试BOM多层级展开功能（10层BOM）
- [ ] 测试BOM扁平化展开功能（10层BOM）
- [ ] 测试BOM查询性能（10层BOM，<2秒）
- [ ] 测试BOM树形展示功能
- [ ] 测试BOM页面布局统一性

**验收标准：**
- ✅ BOM查询优化接口可用（支持10层+ BOM）
- ✅ BOM查询性能满足要求（10层BOM，<2秒）
- ✅ BOM树形展示可用
- ✅ BOM页面布局统一

**预计时间：** 0.5周

---

#### 功能点D1.4：数据验证接口完善

**功能描述：** 完善数据验证接口（符合中国制造业数据验证需求）

**任务清单：**
- [ ] 完善工单数据验证接口（`GET /api/v1/apps/master-data/validation/work-order-data-integrity`）
- [ ] 添加Material存在性验证
- [ ] 添加BOM存在性验证
- [ ] 添加Workshop和ProductionLine存在性验证
- [ ] 添加Warehouse存在性验证
- [ ] 添加数据完整性验证（必填字段、关联关系等）
- [ ] 前端页面：数据验证结果展示（使用统一布局）

**测试用例：**
- [ ] 测试Material存在性验证
- [ ] 测试BOM存在性验证
- [ ] 测试Workshop和ProductionLine存在性验证
- [ ] 测试Warehouse存在性验证
- [ ] 测试数据完整性验证
- [ ] 测试完整数据验证流程
- [ ] 测试数据验证结果展示页面布局统一性

**验收标准：**
- ✅ 数据验证接口完善
- ✅ 所有验证逻辑正确
- ✅ 数据验证结果展示页面布局统一

**预计时间：** 0.5周

---

#### 功能点D1.5：物料变体管理

**功能描述：** 实现物料变体管理功能（符合中国制造业物料变体管理需求，如颜色、尺寸、规格等变体）

**任务清单：**
- [ ] 创建物料变体模型（`MaterialVariant`）
  - [ ] 变体属性定义（颜色、尺寸、规格等）
  - [ ] 变体属性值管理
  - [ ] 变体与主物料关联
- [ ] 创建物料变体服务（`MaterialVariantService`）
  - [ ] 变体创建、更新、删除
  - [ ] 变体查询（支持拼音搜索）
  - [ ] 变体批量操作
- [ ] 创建物料变体API（`/api/v1/apps/master-data/materials/variants`）
  - [ ] `POST /variants` - 创建变体
  - [ ] `GET /variants` - 查询变体列表（支持高级搜索）
  - [ ] `GET /variants/{uuid}` - 查询变体详情
  - [ ] `PUT /variants/{uuid}` - 更新变体
  - [ ] `DELETE /variants/{uuid}` - 删除变体
  - [ ] `POST /variants/batch` - 批量查询变体
- [ ] 前端页面：变体管理列表（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：变体创建/编辑（使用统一表单布局）
  - [ ] 变体属性选择（下拉选择、多选）
  - [ ] 变体属性值输入（支持自定义）
  - [ ] 变体与主物料关联选择（支持拼音搜索）
- [ ] 前端页面：变体详情（使用Drawer，统一布局）
- [ ] 变体批量导入功能（Excel导入，使用UniSheet）
- [ ] 变体批量导出功能（Excel导出）
- [ ] 变体打印功能（打印模板）

**测试用例：**
- [ ] 测试变体创建功能（颜色变体：红色、蓝色）
- [ ] 测试变体创建功能（尺寸变体：S、M、L）
- [ ] 测试变体创建功能（规格变体：规格A、规格B）
- [ ] 测试变体查询功能（列表、详情）
- [ ] 测试变体更新功能
- [ ] 测试变体删除功能
- [ ] 测试变体高级搜索功能（拼音搜索）
- [ ] 测试变体批量查询功能（10个UUID）
- [ ] 测试变体批量导入功能（使用UniSheet）
- [ ] 测试变体批量导出功能（Excel导出）
- [ ] 测试变体打印功能
- [ ] 测试变体与主物料关联功能
- [ ] 测试变体属性值验证功能
- [ ] 测试变体页面布局统一性

**验收标准：**
- ✅ 变体CRUD功能正常
- ✅ 变体属性管理正常（颜色、尺寸、规格等）
- ✅ 变体与主物料关联正常
- ✅ 变体高级搜索可用（拼音搜索）
- ✅ 变体批量导入可用（Excel导入）
- ✅ 变体批量导出可用（Excel导出）
- ✅ 变体打印功能可用
- ✅ 变体页面布局统一

**预计时间：** 1周

---

#### 功能点D1.6：物料批次号管理

**功能描述：** 实现物料批次号管理功能（符合中国制造业批次管理需求，支持批次追溯）

**任务清单：**
- [ ] 创建批次号模型（`MaterialBatch`）
  - [ ] 批次号生成规则（支持自定义规则）
  - [ ] 批次号与物料关联
  - [ ] 批次号属性（生产日期、有效期、供应商等）
  - [ ] 批次号状态管理（在库、已出库、已过期等）
- [ ] 创建批次号服务（`MaterialBatchService`）
  - [ ] 批次号自动生成（基于编码规则）
  - [ ] 批次号创建、更新、删除
  - [ ] 批次号查询（支持拼音搜索、批次号搜索）
  - [ ] 批次号批量操作
  - [ ] 批次号追溯功能（正向追溯、反向追溯）
- [ ] 创建批次号API（`/api/v1/apps/master-data/materials/batches`）
  - [ ] `POST /batches` - 创建批次号
  - [ ] `GET /batches` - 查询批次号列表（支持高级搜索）
  - [ ] `GET /batches/{uuid}` - 查询批次号详情
  - [ ] `PUT /batches/{uuid}` - 更新批次号
  - [ ] `DELETE /batches/{uuid}` - 删除批次号
  - [ ] `POST /batches/batch` - 批量查询批次号
  - [ ] `GET /batches/{uuid}/trace-forward` - 正向追溯
  - [ ] `GET /batches/{uuid}/trace-backward` - 反向追溯
- [ ] 前端页面：批次号管理列表（使用UniTable + 高级搜索 + 统一布局）
- [ ] 前端页面：批次号创建/编辑（使用统一表单布局）
  - [ ] 批次号自动生成（基于编码规则）
  - [ ] 批次号手动输入（支持自定义）
  - [ ] 批次号属性输入（生产日期、有效期、供应商等）
  - [ ] 批次号与物料关联选择（支持拼音搜索）
- [ ] 前端页面：批次号详情（使用Drawer，统一布局）
- [ ] 前端页面：批次号追溯（正向追溯、反向追溯，使用统一布局）
- [ ] 批次号批量导入功能（Excel导入，使用UniSheet）
- [ ] 批次号批量导出功能（Excel导出）
- [ ] 批次号打印功能（打印模板，支持二维码）
- [ ] 批次号二维码生成（用于扫码追溯）

**测试用例：**
- [ ] 测试批次号自动生成功能（基于编码规则：批次-20260101001）
- [ ] 测试批次号手动输入功能
- [ ] 测试批次号创建功能（生产日期、有效期、供应商）
- [ ] 测试批次号查询功能（列表、详情）
- [ ] 测试批次号更新功能
- [ ] 测试批次号删除功能
- [ ] 测试批次号高级搜索功能（拼音搜索、批次号搜索）
- [ ] 测试批次号批量查询功能（10个UUID）
- [ ] 测试批次号批量导入功能（使用UniSheet）
- [ ] 测试批次号批量导出功能（Excel导出）
- [ ] 测试批次号打印功能（支持二维码）
- [ ] 测试批次号二维码生成功能（用于扫码追溯）
- [ ] 测试批次号正向追溯功能（从原材料到成品）
- [ ] 测试批次号反向追溯功能（从成品到原材料）
- [ ] 测试批次号状态管理功能（在库、已出库、已过期）
- [ ] 测试批次号有效期检查功能（自动标记过期批次）
- [ ] 测试批次号页面布局统一性

**验收标准：**
- ✅ 批次号CRUD功能正常
- ✅ 批次号自动生成正常（支持自定义规则）
- ✅ 批次号属性管理正常（生产日期、有效期、供应商等）
- ✅ 批次号与物料关联正常
- ✅ 批次号高级搜索可用（拼音搜索、批次号搜索）
- ✅ 批次号批量导入可用（Excel导入）
- ✅ 批次号批量导出可用（Excel导出）
- ✅ 批次号打印功能可用（支持二维码）
- ✅ 批次号二维码生成正常（用于扫码追溯）
- ✅ 批次号正向追溯正常（从原材料到成品）
- ✅ 批次号反向追溯正常（从成品到原材料）
- ✅ 批次号状态管理正常（在库、已出库、已过期）
- ✅ 批次号有效期检查正常（自动标记过期批次）
- ✅ 批次号页面布局统一

**Inngest工作流：**
- ✅ 必需：批次号有效期检查工作流（定时检查过期批次）
- ⚠️ 可选：批次号批量导入工作流（大数据量导入）

**预计时间：** 1.5周

---

## 7. 页面布局统一性规范（详细）

### 7.1 页面容器规范

**标准页面结构：**
```typescript
import { PageContainer } from '@ant-design/pro-components';

<PageContainer
  title="页面标题"
  breadcrumb={{
    items: [
      { path: '/', title: '首页' },
      { path: '/apps/kuaizhizao', title: '快智造' },
      { title: '工单管理' },
    ],
  }}
  extra={[
    <Button key="create" type="primary" icon={<PlusOutlined />} onClick={handleCreate}>
      新建
    </Button>,
    <Button key="import" icon={<UploadOutlined />} onClick={handleImport}>
      导入
    </Button>,
    <Button key="export" icon={<DownloadOutlined />} onClick={handleExport}>
      导出
    </Button>,
  ]}
>
  <UniTable
    // ...表格配置
  />
</PageContainer>
```

**页面容器要求：**
- ✅ 所有页面使用 `PageContainer` 组件
- ✅ 统一页面标题（左侧）
- ✅ 统一操作按钮位置（右上角）
- ✅ 统一面包屑导航
- ✅ 统一页面间距（24px）

### 7.2 表格配置规范

**标准表格配置：**
```typescript
<UniTable
  // 基础配置
  columns={columns}
  request={loadData}
  
  // 功能配置（符合中国用户习惯）
  showAdvancedSearch={true}     // 高级搜索（必需）
  showImport={true}             // 导入功能（必需）
  showExport={true}             // 导出功能（必需）
  showBatchDelete={true}        // 批量删除（可选）
  showRefresh={true}            // 刷新功能（必需）
  
  // 操作配置
  onCreate={handleCreate}       // 新建（Modal）
  onEdit={handleEdit}           // 编辑（Modal）
  onDetail={handleDetail}       // 详情（Drawer）
  onDelete={handleDelete}       // 删除（确认对话框）
/>
```

**表格操作规范：**
- ✅ 新建：使用Modal弹窗，表单使用统一布局
- ✅ 编辑：使用Modal弹窗，表单使用统一布局
- ✅ 详情：使用Drawer抽屉，只读展示
- ✅ 删除：使用确认对话框，支持批量删除
- ✅ 导入：使用UniSheet组件，支持Excel导入
- ✅ 导出：支持Excel导出，支持PDF导出

### 7.3 表单布局规范

**标准表单布局：**
```typescript
<ProForm
  layout="horizontal"           // 水平布局
  labelCol={{ span: 6 }}        // 标签宽度（6列）
  wrapperCol={{ span: 18 }}    // 输入框宽度（18列）
  grid={true}                    // 网格布局
  rowProps={{ gutter: 16 }}     // 间距（16px）
  submitter={{
    searchConfig: {
      submitText: '提交',
      resetText: '重置',
    },
  }}
>
  <ProFormText
    name="field1"
    label="字段1"
    rules={[{ required: true, message: '请输入字段1' }]}
    placeholder="请输入字段1"
  />
  {/* ...其他字段 */}
</ProForm>
```

**表单布局要求：**
- ✅ 统一使用ProForm组件
- ✅ 统一字段布局（水平布局，标签6列，输入框18列）
- ✅ 统一字段间距（16px）
- ✅ 统一必填标识（红色*号）
- ✅ 统一错误提示（中文提示）
- ✅ 统一占位符（中文占位符）

### 7.4 操作按钮规范

**标准操作按钮位置：**
- ✅ 页面右上角：新建、导入、导出、刷新（主要操作）
- ✅ 表格操作列：编辑、详情、删除（行操作）
- ✅ 表单底部：提交、取消（表单操作）

**操作按钮样式：**
- ✅ 主要操作：Primary按钮（蓝色，`type="primary"`）
- ✅ 次要操作：Default按钮（白色，`type="default"`）
- ✅ 危险操作：Danger按钮（红色，`danger={true}`）
- ✅ 统一图标：使用Ant Design图标

**操作按钮文本：**
- ✅ 新建：`新建` 或 `创建`
- ✅ 编辑：`编辑` 或 `修改`
- ✅ 删除：`删除`
- ✅ 详情：`详情` 或 `查看`
- ✅ 导入：`导入`
- ✅ 导出：`导出`
- ✅ 提交：`提交` 或 `保存`
- ✅ 取消：`取消` 或 `关闭`

---

## 8. 用户体验优化规范

### 8.1 搜索体验优化

**拼音搜索：**
- ✅ 所有搜索框支持拼音搜索
- ✅ 支持拼音首字母搜索（如：`gongdan` → `工单`）
- ✅ 支持拼音全拼搜索（如：`gongdan` → `工单`）
- ✅ 搜索提示友好（中文提示）

**快速筛选：**
- ✅ 支持快速筛选（常用筛选条件）
- ✅ 支持筛选条件保存
- ✅ 支持筛选条件组合（AND/OR）

### 8.2 导入导出体验优化

**Excel导入：**
- ✅ 支持Excel模板下载
- ✅ 支持Excel数据预览和编辑（UniSheet）
- ✅ 支持Excel数据验证（必填字段、数据类型等）
- ✅ 支持Excel错误提示（中文提示）
- ✅ 支持Excel导入进度显示

**Excel导出：**
- ✅ 支持Excel导出（支持中文）
- ✅ 支持Excel格式自定义（表头、样式等）
- ✅ 支持Excel大数据量导出（10万+记录）
- ✅ 支持Excel导出进度显示

### 8.3 移动端体验优化

**报工界面移动端优化：**
- ✅ 响应式布局（适配手机、平板）
- ✅ 大按钮设计（方便点击）
- ✅ 扫码功能（支持二维码、条形码）
- ✅ 语音输入（报工备注）
- ✅ 离线功能（网络不稳定场景）

### 8.4 实时数据体验优化

**实时数据推送：**
- ✅ WebSocket实时推送（延迟<100ms）
- ✅ 断线重连机制（网络不稳定场景）
- ✅ 数据更新提示（Toast提示）
- ✅ 数据更新动画（平滑过渡）

### 8.5 打印体验优化

**打印功能：**
- ✅ 支持打印模板自定义
- ✅ 支持打印预览
- ✅ 支持打印格式调整（页边距、字体等）
- ✅ 支持批量打印

---

## 9. 中国制造业实情优化

### 9.1 数据格式优化

**日期格式：**
- ✅ 支持多种日期格式（YYYY-MM-DD、YYYYMMDD等）
- ✅ 默认使用中文日期格式（2026年1月1日）

**数字格式：**
- ✅ 支持千分位分隔符（1,000）
- ✅ 支持小数位数控制（2位小数）

**编码格式：**
- ✅ 支持中文前缀（工单-、采购-等）
- ✅ 支持日期+序号格式（20260101001）

### 9.2 业务场景优化

**生产场景：**
- ✅ 车间工人使用手机/平板报工（移动端优化）
- ✅ 支持扫码功能（工单二维码、物料二维码）
- ✅ 支持离线功能（网络不稳定场景）
- ✅ 支持语音输入（报工备注）

**管理场景：**
- ✅ 支持实时看板（生产进度、设备状态）
- ✅ 支持数据大屏（生产监控大屏）
- ✅ 支持报表分析（生产报表、质量报表）
- ✅ 支持数据导出（Excel报表）

### 9.3 数据量优化

**大数据量支持：**
- ✅ 支持10万+记录查询（<2秒）
- ✅ 支持10万+记录导出（Excel导出）
- ✅ 支持10层+ BOM展开（<2秒）
- ✅ 支持1000+物料MRP运算（<30秒）

**数据实时性：**
- ✅ 生产数据实时更新（WebSocket，延迟<100ms）
- ✅ 库存数据实时更新（WebSocket，延迟<100ms）
- ✅ 看板数据实时更新（WebSocket，延迟<100ms）

---

## 10. 测试策略（优化版）

### 10.1 单元测试

**要求：**
- 每个功能点完成后立即编写单元测试
- 单元测试覆盖率>80%
- 使用pytest框架
- 测试用例使用中文描述

**测试文件结构：**
```
tests/
├── unit/
│   ├── services/
│   │   ├── test_work_order_service.py
│   │   └── ...
│   ├── api/
│   │   ├── test_work_orders.py
│   │   └── ...
│   └── models/
│       ├── test_work_order.py
│       └── ...
```

### 10.2 集成测试

**要求：**
- 每个功能模块完成后编写集成测试
- 测试API端到端流程
- 使用pytest + httpx
- 测试用例使用中文描述

**测试文件结构：**
```
tests/
├── integration/
│   ├── test_work_order_flow.py
│   ├── test_inventory_flow.py
│   └── ...
```

### 10.3 端到端测试

**要求：**
- 关键业务流程完成后编写端到端测试
- 测试完整业务流程
- 使用pytest + playwright（可选）
- 测试用例使用中文描述

**测试场景：**
- 工单创建→下达→报工→完工→入库
- 销售预测→MRP运算→工单生成
- 销售订单→LRP运算→工单生成

### 10.4 用户体验测试

**要求：**
- 每个功能点完成后进行用户体验测试
- 测试页面布局统一性
- 测试操作流程流畅性
- 测试移动端适配性
- 测试中文显示正确性

---

## 11. Inngest工作流设计（优化版）

### 11.1 工作流分类

#### 异步任务工作流
- **用途：** 处理耗时操作，避免阻塞API响应
- **示例：** MRP/LRP运算、报表生成、数据导入
- **特点：** 支持大数据量处理（10万+记录）

#### 定时任务工作流
- **用途：** 定时执行任务
- **示例：** 看板数据更新、库存盘点、报表调度
- **特点：** 支持自定义调度时间

#### 事件驱动工作流
- **用途：** 响应业务事件
- **示例：** 工单状态流转、库存更新、报工数据处理
- **特点：** 支持实时响应（延迟<100ms）

### 11.2 工作流设计原则

1. **幂等性：** 工作流必须支持重复执行
2. **可重试：** 工作流失败后可以重试（最多3次）
3. **可监控：** 工作流执行状态可监控
4. **可回滚：** 工作流失败后可以回滚
5. **租户隔离：** 工作流必须支持多租户隔离

### 11.3 工作流实现规范

**工作流函数命名：**
- `{功能}_workflow_function` - 主工作流
- `{功能}_action_workflow_function` - 动作工作流

**工作流注册：**
```python
from core.inngest.functions import register_workflow
from core.utils.inngest_tenant_isolation import with_tenant_isolation

@register_workflow
@with_tenant_isolation
async def work_order_status_workflow_function(event: InngestEvent):
    # 工作流逻辑
    pass
```

---

## 12. 开发流程（优化版）

### 12.1 功能点开发流程

1. **需求分析**
   - 明确功能点需求
   - 确定测试用例
   - 确定Inngest工作流需求
   - 确定页面布局要求
   - 确定用户体验要求

2. **设计**
   - 设计API接口
   - 设计数据模型
   - 设计工作流
   - 设计页面布局
   - 设计用户体验流程

3. **开发**
   - 实现后端API
   - 实现前端页面（使用统一布局）
   - 实现Inngest工作流（如需要）
   - 实现用户体验优化

4. **测试**
   - 编写单元测试
   - 编写集成测试
   - 执行测试用例
   - 进行用户体验测试

5. **验收**
   - 功能验收
   - 性能验收
   - 用户体验验收
   - 页面布局统一性验收

6. **文档**
   - 更新API文档（中文）
   - 更新用户手册（中文）
   - 更新开发文档（中文）

### 12.2 测试流程

1. **单元测试**
   - 功能点完成后立即编写
   - 覆盖率>80%
   - 所有测试通过
   - 测试用例使用中文描述

2. **集成测试**
   - 功能模块完成后编写
   - 测试API端到端流程
   - 所有测试通过
   - 测试用例使用中文描述

3. **端到端测试**
   - 关键业务流程完成后编写
   - 测试完整业务流程
   - 所有测试通过
   - 测试用例使用中文描述

4. **用户体验测试**
   - 每个功能点完成后进行
   - 测试页面布局统一性
   - 测试操作流程流畅性
   - 测试移动端适配性
   - 测试中文显示正确性

---

## 13. 质量保证（优化版）

### 13.1 代码质量

- ✅ 所有代码通过Ruff检查
- ✅ 所有代码通过MyPy类型检查
- ✅ 所有代码通过Black格式化
- ✅ 所有代码有文件头注释（中文）

### 13.2 功能质量

- ✅ 所有功能点有测试用例（中文描述）
- ✅ 所有测试用例通过
- ✅ 所有功能点有文档（中文）
- ✅ 所有功能点有验收标准

### 13.3 性能质量

- ✅ API响应时间<2秒
- ✅ 大数据量查询性能满足要求（10万+记录，<2秒）
- ✅ 并发用户支持50+
- ✅ 系统稳定性>99%
- ✅ WebSocket延迟<100ms

### 13.4 用户体验质量

- ✅ 页面布局统一（所有页面使用统一布局）
- ✅ 操作流程流畅（符合中国用户习惯）
- ✅ 移动端适配良好（报工界面等）
- ✅ 中文显示正确（所有页面中文显示正常）

---

## 14. 总结

### 14.1 功能点统计

**系统级功能点：** 15个
**快智造功能点：** 26个（新增：预警中心、成本管理、设备管理、人员效率管理、经营看板）
**主数据管理功能点：** 6个（包含：物料变体管理、物料批次号管理）
**总计：** 47个功能点

**新增功能点说明：**
- **预警中心**（M1.7）：统一预警管理，包括库存、交期、质量、设备、成本预警
- **成本管理**（M2.0）：成本核算、成本分析、成本预警，中小制造业企业核心需求
- **设备管理**（M2.6增强）：设备台账、保养计划、故障管理、设备预警
- **人员效率管理**（M3.0）：计件工资、工时统计、效率分析、绩效排名
- **经营看板**（M3.3）：关键指标监控、异常预警、经营趋势分析

**增强功能点说明：**
- **工单管理**（M1.3增强）：增加齐套料分析功能，工单下达前检查物料齐套情况
- **仓储管理**（M1.5增强）：增加齐套料分析功能，支持多工单批量分析

**增强功能点说明：**
- **工单管理**（M1.3增强）：增加齐套料分析功能，工单下达前检查物料齐套情况
- **仓储管理**（M1.5增强）：增加齐套料分析功能，支持多工单批量分析

### 14.2 测试用例统计

**单元测试：** 200+个（中文描述）
**集成测试：** 50+个（中文描述）
**端到端测试：** 10+个（中文描述）
**用户体验测试：** 39个功能点

### 14.3 Inngest工作流统计

**必需工作流：** 22个（新增：库存预警、成本核算、成本预警、设备保养提醒、设备故障预警、计件工资计算、人员效率统计、经营看板数据更新）
**可选工作流：** 8个
**总计：** 30个工作流

### 14.4 页面布局统一性

**统一页面容器：** 所有页面使用PageContainer
**统一表格配置：** 所有列表页面使用UniTable
**统一表单布局：** 所有表单页面使用统一布局
**统一操作按钮：** 所有操作按钮使用统一样式和位置

### 14.5 用户体验优化

**搜索体验：** 支持拼音搜索、快速筛选
**导入导出体验：** 支持Excel导入导出、模板下载
**移动端体验：** 报工界面移动端优化、扫码功能
**实时数据体验：** WebSocket实时推送、断线重连

### 14.6 中国制造业实情优化

**数据格式：** 支持中文日期格式、中文编码前缀
**业务场景：** 支持移动端报工、扫码功能、离线功能
**数据量：** 支持10万+记录查询、10层+ BOM展开
**数据实时性：** 支持实时数据推送（延迟<100ms）

### 14.7 中小制造业企业核心需求优化（新增）

**成本控制：** 
- ✅ 成本核算（材料、人工、费用）
- ✅ 成本分析（构成、趋势、对比）
- ✅ 成本预警（超预算、异常预警）

**库存管理：**
- ✅ 安全库存管理
- ✅ 库存预警（缺料、积压、过期）
- ✅ ABC分类管理

**设备管理：**
- ✅ 设备台账管理
- ✅ 设备保养计划
- ✅ 设备故障管理
- ✅ 设备预警（保养到期、故障预警）

**人员管理：**
- ✅ 计件工资管理
- ✅ 工时统计
- ✅ 人员效率分析
- ✅ 人员绩效排名

**预警管理：**
- ✅ 统一预警中心
- ✅ 多维度预警（库存、交期、质量、设备、成本）
- ✅ 预警消息推送（站内消息、短信、邮件）

**经营决策：**
- ✅ 经营看板（关键指标监控）
- ✅ 异常预警看板
- ✅ 经营趋势分析
- ✅ 对比分析（同期对比、目标对比）

---

**文档创建时间：** 2025-12-27  
**文档作者：** Luigi Lu  
**预计完成时间：** 2026-06-15  
**优化重点：** 页面布局统一性、用户体验优化、符合中国制造业实情

