# RiverEdge SaaS å¤šç»„ç»‡æ¡†æ¶ - Cursor Rules

## âš ï¸ æ ¸å¿ƒè§„åˆ™

### ç¯å¢ƒè¦æ±‚
1. **ç»ˆç«¯ç¯å¢ƒ**: ä¸¥ç¦ä½¿ç”¨CMDå’ŒPowerShellï¼Œå¿…é¡»ä½¿ç”¨Git Bashä½œä¸ºé»˜è®¤ç»ˆç«¯
2. **ç¼–ç è§„èŒƒ**: æ‰€æœ‰æ–‡ä»¶å’Œæ“ä½œå¿…é¡»ä½¿ç”¨UTF-8ç¼–ç 
3. **æ“ä½œå®‰å…¨**: æ‰€æœ‰æ“ä½œéƒ½éœ€è¦è€ƒè™‘å¤±è´¥åçš„å›é€€ç­–ç•¥å’Œæ¸…ç†æªæ–½
4. **æ‰§è¡ŒåŸåˆ™**: ä¸è¦è‡†æµ‹ç”¨æˆ·æƒ³æ³•ï¼Œåªæ‰§è¡Œç”¨æˆ·æ˜ç¡®æŒ‡å®šçš„æ“ä½œ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

RiverEdge æ˜¯åŸºäºå¤šç§Ÿæˆ· SaaS æ¶æ„çš„ä¼ä¸šçº§åº”ç”¨æ¡†æ¶ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»è®¾è®¡ï¼Œæ”¯æŒåŠ¨æ€åº”ç”¨ç®¡ç†å’Œæ’ä»¶åŒ–æ‰©å±•ã€‚

**æŠ€æœ¯æ ˆ**: Python 3.11+ (FastAPI) + React 18+ (TypeScript) + PostgreSQL + Redis

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### æ¶æ„åˆ†å±‚
- **å¹³å°çº§ (infra/)**: å¹³å°è¿è¥ç®¡ç†ï¼Œè¶…çº§ç®¡ç†å‘˜ä½¿ç”¨
- **ç³»ç»Ÿçº§ (core/)**: ç»„ç»‡ç³»ç»Ÿç®¡ç†ï¼Œç»„ç»‡ç®¡ç†å‘˜å’Œæ™®é€šç”¨æˆ·ä½¿ç”¨
- **åº”ç”¨çº§ (apps/)**: ä¸šåŠ¡åº”ç”¨åŠŸèƒ½ï¼Œä¸šåŠ¡ç”¨æˆ·ä½¿ç”¨

### å¼€å‘è§„èŒƒ
- **å‘½åç»Ÿä¸€**: éµå¾ªå±‚çº§åŒ–å‘½åè§„èŒƒ
- **æ³¨é‡Šå®Œæ•´**: ä¸­æ–‡æ³¨é‡Šï¼Œè§£é‡Š"ä¸ºä»€ä¹ˆ"è€Œé"æ˜¯ä»€ä¹ˆ"
- **é”™è¯¯ç»Ÿä¸€**: ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»å’Œç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼
- **ä»£ç è´¨é‡**: é€šè¿‡ESLintã€Ruffã€MyPyç­‰å·¥å…·ä¿è¯è´¨é‡

## ğŸ”§ åç«¯å¼€å‘è§„èŒƒ (Python)

### å‘½åè§„èŒƒ

#### ç›®å½•å’Œæ–‡ä»¶
```
# å¹³å°çº§ (infra/)
â”œâ”€â”€ api/                    # å¹³å°çº§ API è·¯ç”±
â”œâ”€â”€ models/                 # å¹³å°çº§æ•°æ®æ¨¡å‹
â”œâ”€â”€ schemas/                # å¹³å°çº§æ•°æ®éªŒè¯
â”œâ”€â”€ services/               # å¹³å°çº§ä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ domain/                 # å¹³å°çº§é¢†åŸŸé€»è¾‘
â””â”€â”€ config/                 # å¹³å°çº§é…ç½®

# ç³»ç»Ÿçº§ (core/)
â”œâ”€â”€ api/                    # ç³»ç»Ÿçº§ API è·¯ç”±
â”œâ”€â”€ models/                 # ç³»ç»Ÿçº§æ•°æ®æ¨¡å‹
â”œâ”€â”€ schemas/                # ç³»ç»Ÿçº§æ•°æ®éªŒè¯
â”œâ”€â”€ services/               # ç³»ç»Ÿçº§ä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ middleware/             # ç³»ç»Ÿçº§ä¸­é—´ä»¶
â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°

# åº”ç”¨çº§ (apps/)
â”œâ”€â”€ {app_code}/            # ä¸šåŠ¡åº”ç”¨
â”‚   â”œâ”€â”€ api/               # åº”ç”¨ API
â”‚   â”œâ”€â”€ models/            # åº”ç”¨æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/           # åº”ç”¨æ•°æ®éªŒè¯
â”‚   â””â”€â”€ services/          # åº”ç”¨ä¸šåŠ¡é€»è¾‘
```

#### å˜é‡å’Œå‡½æ•°
- **snake_case**: å‡½æ•°åã€å˜é‡åã€æ–¹æ³•å
- **PascalCase**: ç±»åã€å¼‚å¸¸ç±»å
- **UPPER_CASE**: å¸¸é‡
- **kebab-case**: URLè·¯å¾„ã€APIç«¯ç‚¹

#### ç¤ºä¾‹
```python
# âœ… æ­£ç¡®å‘½å
class UserService:
    def get_user_by_id(self, user_id: int) -> User:
        pass

    def create_user(self, user_data: dict) -> User:
        pass

# âŒ é”™è¯¯å‘½å
class userService:  # åº”è¯¥ PascalCase
    def GetUserById():  # åº”è¯¥ snake_case
        pass
```

### æ–‡ä»¶å¤´æ³¨é‡Šè§„èŒƒ

**æ¯ä¸ªPythonæ–‡ä»¶å¿…é¡»åŒ…å«æ–‡ä»¶å¤´æ³¨é‡Š**ï¼š

```python
"""
ç”¨æˆ·æ¨¡å‹æ¨¡å—

æä¾›ç”¨æˆ·æ•°æ®æ¨¡å‹å®šä¹‰ï¼ŒåŒ…æ‹¬ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€çŠ¶æ€ç®¡ç†ç­‰ã€‚

Author: Luigi Lu
Date: 2025-12-26  # ä½¿ç”¨ç³»ç»Ÿå½“å‰æ—¥æœŸ
"""

from tortoise.models import Model
from tortoise import fields
```

### é”™è¯¯å¤„ç†è§„èŒƒ

#### ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»
```python
from core.exceptions import ValidationError, NotFoundError

# âœ… æ­£ç¡®ä½¿ç”¨
def get_user(user_id: int):
    user = await User.get_or_none(id=user_id)
    if not user:
        raise NotFoundError("ç”¨æˆ·ä¸å­˜åœ¨")
    return user

# âŒ é¿å…ç›´æ¥ä½¿ç”¨ HTTPException
def get_user_wrong(user_id: int):
    user = await User.get_or_none(id=user_id)
    if not user:
        raise HTTPException(status_code=404, detail="ç”¨æˆ·ä¸å­˜åœ¨")
```

#### ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼
```json
{
  "code": 404,
  "message": "ç”¨æˆ·ä¸å­˜åœ¨",
  "detail": "è¯·æ±‚çš„ç”¨æˆ·ID: 123 ä¸å­˜åœ¨"
}
```

## ğŸ¨ å‰ç«¯å¼€å‘è§„èŒƒ (TypeScript/React)

### å‘½åè§„èŒƒ

#### ç»„ä»¶å’Œæ–‡ä»¶
- **PascalCase**: Reactç»„ä»¶ã€TypeScriptç±»å‹ã€æ¥å£
- **camelCase**: å˜é‡ã€å‡½æ•°ã€æ–¹æ³•ã€å±æ€§
- **kebab-case**: æ–‡ä»¶åã€ç›®å½•åã€URLè·¯å¾„

#### ç¤ºä¾‹
```typescript
// âœ… æ­£ç¡®å‘½å
interface UserProfile {
  userId: number;
  userName: string;
}

const UserManagement: React.FC = () => {
  const [userList, setUserList] = useState<UserProfile[]>([]);

  const handleUserUpdate = (userId: number) => {
    // å¤„ç†ç”¨æˆ·æ›´æ–°é€»è¾‘
  };

  return <div>User Management Component</div>;
};

// âŒ é”™è¯¯å‘½å
interface userProfile {  // åº”è¯¥ PascalCase
  userid: number;        // åº”è¯¥ camelCase
}

const usermanagement = () => {  // åº”è¯¥ PascalCase
  const handleuserupdate = () => {  // åº”è¯¥ camelCase
  };
};
```

### å›¾æ ‡ä½¿ç”¨è§„èŒƒ

æœ¬é¡¹ç›®**ä»…ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªå›¾æ ‡åº“**ï¼Œç¦æ­¢å¼•å…¥ react-icons æˆ–å…¶ä»–å›¾æ ‡åº“ï¼š

1. **@ant-design/icons**
   - ç”¨äºï¼šä¸ antd / Pro Components é…å¥—çš„å›¾æ ‡ï¼ˆå¦‚ ProTableã€ProForm æ‰€éœ€çš„å›¾æ ‡ï¼‰
   - ç¤ºä¾‹ï¼š`UserOutlined`, `SettingOutlined`, `PlusOutlined`

2. **lucide-react**
   - ç”¨äºï¼šé€šç”¨ä¸šåŠ¡å›¾æ ‡ï¼Œé£æ ¼ç»Ÿä¸€ã€å›¾æ ‡ä¸°å¯Œ
   - ç¤ºä¾‹ï¼š`User`, `Settings`, `Plus`, `ChevronDown`

**è§„åˆ™**ï¼š
- æ–°ä»£ç **å¿…é¡»**ä»ä¸Šè¿°ä¸¤ä¸ªåº“ä¸­é€‰æ‹©å›¾æ ‡
- ä¼˜å…ˆä½¿ç”¨ `lucide-react`ï¼ˆé£æ ¼æ›´ç»Ÿä¸€ï¼‰ï¼›è‹¥ antd/Pro ç»„ä»¶å¼ºä¾èµ– `@ant-design/icons` åˆ™ä½¿ç”¨åè€…
- å­˜é‡ react-icons å¼•ç”¨å¯åœ¨é‡æ„æ—¶é€æ­¥æ›¿æ¢ï¼Œä¸å¼ºåˆ¶ä¸€æ¬¡æ€§è¿ç§»

### é¡µé¢å¼€å‘æ ‡å‡†æ¨¡æ¿

#### åˆ—è¡¨é¡µé¢ç»“æ„
```typescript
// pages/{module}/list/index.tsx
const ListPage: React.FC = () => {
  const [modalVisible, setModalVisible] = useState(false);
  const [drawerVisible, setDrawerVisible] = useState(false);
  const [isEdit, setIsEdit] = useState(false);
  const [currentId, setCurrentId] = useState<number | null>(null);

  // æ–°å»º - ä½¿ç”¨ Modal
  const handleCreate = () => {
    setIsEdit(false);
    setCurrentId(null);
    setModalVisible(true);
    formRef.current?.resetFields();
  };

  // ç¼–è¾‘ - ä½¿ç”¨ Modal
  const handleEdit = async (keys: React.Key[]) => {
    if (keys.length === 1) {
      const id = Number(keys[0]);
      setIsEdit(true);
      setCurrentId(id);
      setModalVisible(true);
      // åŠ è½½æ•°æ®åˆ°è¡¨å•
      const data = await loadData(id);
      formRef.current?.setFieldsValue(data);
    }
  };

  // è¯¦æƒ…æŸ¥çœ‹ - ä½¿ç”¨ Drawer
  const handleDetail = async (keys: React.Key[]) => {
    if (keys.length === 1) {
      const id = Number(keys[0]);
      setCurrentId(id);
      setDrawerVisible(true);
    }
  };

  return (
    <>
      <UniTable
        onCreate={handleCreate}
        onEdit={handleEdit}
        onDetail={handleDetail}
        onDelete={handleDelete}
      />
      <Modal
        open={modalVisible}
        onCancel={() => setModalVisible(false)}
        title={isEdit ? "ç¼–è¾‘" : "æ–°å»º"}
      >
        <Form ref={formRef}>
          {/* è¡¨å•å†…å®¹ */}
        </Form>
      </Modal>
      <Drawer
        open={drawerVisible}
        onClose={() => setDrawerVisible(false)}
        title="è¯¦æƒ…"
      >
        {/* è¯¦æƒ…å†…å®¹ */}
      </Drawer>
    </>
  );
};
```

## ğŸ“ æ³¨é‡Šè§„èŒƒ

### åç«¯æ³¨é‡Š (Python)
```python
"""
ç”¨æˆ·æœåŠ¡æ¨¡å—

æä¾›ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ŒåŒ…æ‹¬ç”¨æˆ·åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚

Author: Luigi Lu
Date: 2025-12-26
"""

class UserService:
    """
    ç”¨æˆ·æœåŠ¡ç±»

    å¤„ç†ç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘
    """

    async def get_user_by_id(self, user_id: int) -> User:
        """
        æ ¹æ®ç”¨æˆ·IDè·å–ç”¨æˆ·ä¿¡æ¯

        Args:
            user_id: ç”¨æˆ·ID

        Returns:
            User: ç”¨æˆ·å¯¹è±¡

        Raises:
            NotFoundError: ç”¨æˆ·ä¸å­˜åœ¨æ—¶æŠ›å‡º
        """
        # è·å–ç”¨æˆ·ï¼Œå¦‚æœä¸å­˜åœ¨æŠ›å‡ºå¼‚å¸¸
        user = await User.get_or_none(id=user_id)
        if not user:
            raise NotFoundError(f"ç”¨æˆ·ä¸å­˜åœ¨: {user_id}")
        return user
```

### å‰ç«¯æ³¨é‡Š (TypeScript)
```typescript
/**
 * ç”¨æˆ·ç®¡ç†é¡µé¢
 *
 * æä¾›ç”¨æˆ·åˆ—è¡¨å±•ç¤ºã€æ–°å»ºã€ç¼–è¾‘ã€åˆ é™¤ç­‰åŠŸèƒ½
 *
 * @author Luigi Lu
 * @date 2025-12-26
 */

interface UserManagementProps {
  /** æ˜¯å¦æ˜¾ç¤ºé«˜çº§åŠŸèƒ½ */
  showAdvanced?: boolean;
}

const UserManagement: React.FC<UserManagementProps> = ({ showAdvanced = false }) => {
  // ç”¨æˆ·åˆ—è¡¨çŠ¶æ€
  const [userList, setUserList] = useState<User[]>([]);

  /**
   * å¤„ç†ç”¨æˆ·æ›´æ–°
   * @param userId ç”¨æˆ·ID
   * @param userData ç”¨æˆ·æ•°æ®
   */
  const handleUserUpdate = async (userId: number, userData: Partial<User>) => {
    try {
      await updateUser(userId, userData);
      message.success('ç”¨æˆ·æ›´æ–°æˆåŠŸ');
      // åˆ·æ–°ç”¨æˆ·åˆ—è¡¨
      await loadUserList();
    } catch (error) {
      message.error('ç”¨æˆ·æ›´æ–°å¤±è´¥');
      console.error('Update user error:', error);
    }
  };

  return (
    <div>
      {/* ç”¨æˆ·åˆ—è¡¨ */}
      <Table
        dataSource={userList}
        columns={columns}
        onEdit={handleUserUpdate}
      />
    </div>
  );
};
```

## ğŸ”„ Git å·¥ä½œæµè§„èŒƒ

### åˆ†æ”¯ç­–ç•¥
```
main (ç”Ÿäº§åˆ†æ”¯) â† release/*, hotfix/*
  â†‘
develop (å¼€å‘åˆ†æ”¯) â† feature/*, fix/*
```

### æäº¤ä¿¡æ¯æ ¼å¼ (Conventional Commits)
```
<type>(<scope>): <subject>

<body>

<footer>
```

#### æäº¤ç±»å‹
- **feat**: æ–°åŠŸèƒ½
- **fix**: Bugä¿®å¤
- **docs**: æ–‡æ¡£æ›´æ–°
- **style**: ä»£ç æ ¼å¼è°ƒæ•´
- **refactor**: ä»£ç é‡æ„
- **test**: æµ‹è¯•ç›¸å…³
- **chore**: æ„å»ºå·¥å…·æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

#### ç¤ºä¾‹
```bash
# âœ… æ­£ç¡®æ ¼å¼
feat(user): æ·»åŠ ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½

- å®ç°ç”¨æˆ·é‚®ç®±æ³¨å†Œ
- æ·»åŠ é‚®ç®±éªŒè¯åŠŸèƒ½
- æ›´æ–°ç”¨æˆ·æ¨¡å‹å­—æ®µ

Closes #123

# âŒ é”™è¯¯æ ¼å¼
æ·»åŠ ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
fix bug
update code
```

### åˆ†æ”¯å‘½åè§„èŒƒ
- `feature/user-registration`: åŠŸèƒ½åˆ†æ”¯
- `fix/login-validation`: ä¿®å¤åˆ†æ”¯
- `hotfix/security-patch`: çƒ­ä¿®å¤åˆ†æ”¯
- `release/v1.2.0`: å‘å¸ƒåˆ†æ”¯

## ğŸ› ï¸ ä»£ç è´¨é‡å·¥å…·

### åç«¯å·¥å…·é…ç½®
```toml
# pyproject.toml
[tool.ruff]
line-length = 100
target-version = "py311"

[tool.black]
line-length = 100
target-version = ['py311']

[tool.mypy]
python_version = "3.11"
```

### å‰ç«¯å·¥å…·é…ç½®
```json
// package.json
{
  "eslintConfig": {
    "extends": ["react-app", "@typescript-eslint/recommended"],
    "rules": {
      "@typescript-eslint/no-unused-vars": "error",
      "@typescript-eslint/explicit-function-return-type": "warn"
    }
  }
}
```

## âš ï¸ é‡è¦æé†’

### ä¸¥æ ¼éµå®ˆè§„èŒƒ
- **å‘½åè§„èŒƒ**: å¿…é¡»éµå¾ªå±‚çº§åŒ–å‘½åè§„åˆ™
- **æ³¨é‡Šè§„èŒƒ**: æ‰€æœ‰ä»£ç å¿…é¡»æœ‰å®Œæ•´ä¸­æ–‡æ³¨é‡Š
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»
- **Gitè§„èŒƒ**: å¿…é¡»ä½¿ç”¨è§„èŒƒçš„æäº¤ä¿¡æ¯æ ¼å¼

### å¼€å‘ç¯å¢ƒè¦æ±‚
- **Python**: 3.11+ (ç¦æ­¢ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬)
- **Node.js**: 22.0+
- **Git**: æœ€æ–°ç¨³å®šç‰ˆ
- **IDE**: VSCode with Python/TypeScript extensions

### è´¨é‡ä¿è¯
- **ä»£ç å®¡æŸ¥**: æ‰€æœ‰PRå¿…é¡»ç»è¿‡Code Review
- **æµ‹è¯•è¦†ç›–**: æ ¸å¿ƒåŠŸèƒ½å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- **CI/CD**: å¿…é¡»é€šè¿‡æ‰€æœ‰è‡ªåŠ¨åŒ–æ£€æŸ¥

---

**æœ€åæ›´æ–°**: 2025-12-26
