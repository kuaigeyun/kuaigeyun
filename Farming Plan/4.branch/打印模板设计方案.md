# RiverEdge SaaS å¤šç§Ÿæˆ·æ¡†æ¶ - æ‰“å°æ¨¡æ¿è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ éœ€æ±‚æ¦‚è¿°

åœ¨ **RiverEdge SaaS å¤šç§Ÿæˆ·æ¡†æ¶ (RiverEdge SaaS Multi-tenant Framework)** ä¸­å®ç°æ‰“å°æ¨¡æ¿è®¾è®¡åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ‰“å°æ¨¡æ¿ï¼Œæ”¯æŒæŠ¥è¡¨ã€å•æ®ã€æ ‡ç­¾ç­‰å¤šç§æ‰“å°åœºæ™¯ã€‚

## ğŸ” Ant Design Pro åŸç”Ÿæ–¹æ¡ˆ

### ç°çŠ¶

**Ant Design Pro æ²¡æœ‰ä¸“é—¨çš„æ‰“å°æ¨¡æ¿è®¾è®¡å™¨åŸç”Ÿç»„ä»¶**ï¼Œä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°åŸºç¡€æ‰“å°åŠŸèƒ½ï¼š

1. **æµè§ˆå™¨åŸç”Ÿæ‰“å°** (`window.print()`)
2. **CSS æ‰“å°æ ·å¼** (`@media print`)
3. **Ant Design ç»„ä»¶** æ„å»ºæ‰“å°å†…å®¹

### åŸºç¡€å®ç°æ–¹æ¡ˆ

#### æ–¹æ¡ˆä¸€ï¼šæµè§ˆå™¨åŸç”Ÿæ‰“å°ï¼ˆç®€å•åœºæ™¯ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- ç®€å•çš„æŠ¥è¡¨æ‰“å°
- å›ºå®šæ ¼å¼çš„æ‰“å°æ¨¡æ¿
- ä¸éœ€è¦å¤æ‚çš„æ‰“å°è®¾è®¡å™¨

**å®ç°æ–¹å¼**ï¼š

```tsx
import { Button, Table, Card } from 'antd';
import { PrinterOutlined } from '@ant-design/icons';

export default function PrintPage() {
  const handlePrint = () => {
    window.print();
  };

  return (
    <div className="print-page">
      {/* æ‰“å°æŒ‰é’®ï¼ˆæ‰“å°æ—¶éšè—ï¼‰ */}
      <div className="no-print">
        <Button 
          type="primary" 
          icon={<PrinterOutlined />}
          onClick={handlePrint}
        >
          æ‰“å°
        </Button>
      </div>

      {/* æ‰“å°å†…å®¹ */}
      <div className="print-content">
        <Card title="æŠ¥è¡¨æ ‡é¢˜">
          <Table
            dataSource={data}
            columns={columns}
            pagination={false}
          />
        </Card>
      </div>
    </div>
  );
}
```

**CSS æ‰“å°æ ·å¼**ï¼š

```css
/* æ‰“å°æ ·å¼ */
@media print {
  /* éšè—ä¸éœ€è¦æ‰“å°çš„å…ƒç´  */
  .no-print,
  .ant-layout-header,
  .ant-layout-sider,
  .ant-layout-footer,
  .ant-btn {
    display: none !important;
  }

  /* æ‰“å°å†…å®¹æ ·å¼ */
  .print-content {
    margin: 0;
    padding: 0;
    color: #000;
    background: #fff;
  }

  /* åˆ†é¡µæ§åˆ¶ */
  .print-page {
    page-break-after: always;
  }

  /* è¡¨æ ¼æ ·å¼ä¼˜åŒ– */
  .ant-table {
    font-size: 12px;
  }
}
```

## ğŸ¯ æ¨èæ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šreact-to-printï¼ˆæ¨èï¼Œç®€å•æ˜“ç”¨ï¼‰

**react-to-print** æ˜¯ä¸“é—¨ç”¨äº React çš„æ‰“å°åº“ï¼Œä¸ Ant Design å®Œç¾é›†æˆã€‚

#### ä¼˜åŠ¿
- âœ… è½»é‡çº§ï¼Œæ˜“äºä½¿ç”¨
- âœ… æ”¯æŒ React ç»„ä»¶æ‰“å°
- âœ… ä¸ Ant Design ç»„ä»¶å…¼å®¹
- âœ… æ”¯æŒæ‰“å°é¢„è§ˆ
- âœ… å¯è‡ªå®šä¹‰æ‰“å°æ ·å¼

#### å®‰è£…

```bash
npm install react-to-print
```

#### ä½¿ç”¨ç¤ºä¾‹

```tsx
import { useRef } from 'react';
import { useReactToPrint } from 'react-to-print';
import { Button, Table, Card } from 'antd';
import { PrinterOutlined } from '@ant-design/icons';

export default function PrintableReport() {
  const componentRef = useRef<HTMLDivElement>(null);

  const handlePrint = useReactToPrint({
    content: () => componentRef.current,
    documentTitle: 'æŠ¥è¡¨æ‰“å°',
    pageStyle: `
      @page {
        size: A4;
        margin: 20mm;
      }
      @media print {
        body {
          -webkit-print-color-adjust: exact;
        }
      }
    `,
  });

  return (
    <div>
      <div className="no-print">
        <Button 
          type="primary" 
          icon={<PrinterOutlined />}
          onClick={handlePrint}
        >
          æ‰“å°
        </Button>
      </div>

      <div ref={componentRef} className="print-content">
        <Card title="æŠ¥è¡¨æ ‡é¢˜">
          <Table
            dataSource={data}
            columns={columns}
            pagination={false}
          />
        </Card>
      </div>
    </div>
  );
}
```

### æ–¹æ¡ˆäºŒï¼šjsPDF + html2canvasï¼ˆPDF ç”Ÿæˆï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦ç”Ÿæˆ PDF æ–‡ä»¶
- éœ€è¦ç²¾ç¡®æ§åˆ¶æ‰“å°æ ¼å¼
- éœ€è¦ç¦»çº¿æ‰“å°

#### ä¼˜åŠ¿
- âœ… ç”Ÿæˆ PDF æ–‡ä»¶
- âœ… ç²¾ç¡®æ§åˆ¶æ ¼å¼
- âœ… æ”¯æŒå¤æ‚å¸ƒå±€
- âœ… å¯ä¸‹è½½ PDF

#### å®‰è£…

```bash
npm install jspdf html2canvas
```

#### ä½¿ç”¨ç¤ºä¾‹

```tsx
import { useRef } from 'react';
import jsPDF from 'jspdf';
import html2canvas from 'html2canvas';
import { Button } from 'antd';

export default function PDFReport() {
  const componentRef = useRef<HTMLDivElement>(null);

  const handlePrint = async () => {
    if (!componentRef.current) return;

    const canvas = await html2canvas(componentRef.current, {
      scale: 2,
      useCORS: true,
    });

    const imgData = canvas.toDataURL('image/png');
    const pdf = new jsPDF('p', 'mm', 'a4');
    const imgWidth = 210;
    const pageHeight = 295;
    const imgHeight = (canvas.height * imgWidth) / canvas.width;
    let heightLeft = imgHeight;

    let position = 0;

    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
    heightLeft -= pageHeight;

    while (heightLeft >= 0) {
      position = heightLeft - imgHeight;
      pdf.addPage();
      pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
      heightLeft -= pageHeight;
    }

    pdf.save('report.pdf');
  };

  return (
    <div>
      <Button onClick={handlePrint}>ç”Ÿæˆ PDF</Button>
      <div ref={componentRef}>
        {/* æ‰“å°å†…å®¹ */}
      </div>
    </div>
  );
}
```

### æ–¹æ¡ˆä¸‰ï¼š@ant-design/pro-editorï¼ˆè¡¨å•è®¾è®¡å™¨ï¼Œå¯æ‰©å±•ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦å¯è§†åŒ–è®¾è®¡æ‰“å°æ¨¡æ¿
- éœ€è¦æ‹–æ‹½å¼æ¨¡æ¿è®¾è®¡
- éœ€è¦ä¿å­˜å’Œå¤ç”¨æ¨¡æ¿

#### è¯´æ˜
- Pro Editor ä¸»è¦ç”¨äºè¡¨å•è®¾è®¡ï¼Œä½†å¯ä»¥æ‰©å±•ç”¨äºæ‰“å°æ¨¡æ¿è®¾è®¡
- éœ€è¦è‡ªå®šä¹‰å¼€å‘æ‰“å°æ¨¡æ¿è®¾è®¡å™¨

### æ–¹æ¡ˆå››ï¼šform-render + æ‰“å°ï¼ˆæ¨èï¼ŒåŸºäºé…ç½®ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦åŸºäºé…ç½®çš„æ‰“å°æ¨¡æ¿
- éœ€è¦åŠ¨æ€ç”Ÿæˆæ‰“å°å†…å®¹
- ä¸è¡¨å•è‡ªå®šä¹‰å­—æ®µç»“åˆ

#### å®ç°æ€è·¯
1. ä½¿ç”¨ form-render çš„ Schema å®šä¹‰æ‰“å°æ¨¡æ¿
2. ä½¿ç”¨ react-to-print è¿›è¡Œæ‰“å°
3. æ¨¡æ¿é…ç½®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­

```tsx
import { useRef } from 'react';
import { useReactToPrint } from 'react-to-print';
import FormRender from 'form-render';
import { Button } from 'antd';

export default function ConfigurablePrint() {
  const componentRef = useRef<HTMLDivElement>(null);
  const [template, setTemplate] = useState({});

  // ä»åç«¯è·å–æ‰“å°æ¨¡æ¿é…ç½®
  useEffect(() => {
    request('/api/print-template').then(setTemplate);
  }, []);

  const handlePrint = useReactToPrint({
    content: () => componentRef.current,
  });

  return (
    <div>
      <Button onClick={handlePrint}>æ‰“å°</Button>
      <div ref={componentRef}>
        <FormRender schema={template.schema} formData={template.data} />
      </div>
    </div>
  );
}
```

## ğŸ—ï¸ æ‰“å°æ¨¡æ¿è®¾è®¡å™¨æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šåŸºäº Ant Design ç»„ä»¶æ„å»ºï¼ˆæ¨èï¼‰

**å®ç°æ€è·¯**ï¼š
- ä½¿ç”¨ Ant Design ç»„ä»¶æ„å»ºæ‰“å°æ¨¡æ¿è®¾è®¡å™¨
- æ”¯æŒæ‹–æ‹½å¼è®¾è®¡
- æ¨¡æ¿é…ç½®å­˜å‚¨ä¸º JSON Schema

#### æ ¸å¿ƒåŠŸèƒ½

1. **æ¨¡æ¿è®¾è®¡å™¨ç•Œé¢**
   - å·¦ä¾§ï¼šç»„ä»¶åº“ï¼ˆæ–‡æœ¬ã€è¡¨æ ¼ã€å›¾ç‰‡ã€çº¿æ¡ç­‰ï¼‰
   - ä¸­é—´ï¼šè®¾è®¡ç”»å¸ƒ
   - å³ä¾§ï¼šå±æ€§é…ç½®é¢æ¿

2. **æ”¯æŒçš„ç»„ä»¶**
   - æ–‡æœ¬ç»„ä»¶
   - è¡¨æ ¼ç»„ä»¶
   - å›¾ç‰‡ç»„ä»¶
   - çº¿æ¡/åˆ†å‰²çº¿
   - äºŒç»´ç /æ¡å½¢ç 
   - æ—¥æœŸæ—¶é—´

3. **æ¨¡æ¿é…ç½®ç»“æ„**

```typescript
interface PrintTemplate {
  id: string;
  name: string;
  pageSize: 'A4' | 'A3' | 'Letter';
  orientation: 'portrait' | 'landscape';
  margin: {
    top: number;
    right: number;
    bottom: number;
    left: number;
  };
  elements: PrintElement[];
}

interface PrintElement {
  id: string;
  type: 'text' | 'table' | 'image' | 'line' | 'barcode';
  position: { x: number; y: number };
  size: { width: number; height: number };
  style: Record<string, any>;
  dataSource?: string; // æ•°æ®æºå­—æ®µ
}
```

### æ–¹æ¡ˆäºŒï¼šé›†æˆç¬¬ä¸‰æ–¹æ‰“å°è®¾è®¡å™¨

#### æ¨èåº“ï¼šreact-print-nbï¼ˆä¸æ¨èï¼Œç»´æŠ¤ä¸æ´»è·ƒï¼‰

#### æ¨èåº“ï¼šè‡ªå®šä¹‰å¼€å‘ï¼ˆæ¨èï¼‰

åŸºäº Ant Design ç»„ä»¶å’Œ react-dndï¼ˆæ‹–æ‹½ï¼‰å¼€å‘è‡ªå®šä¹‰æ‰“å°æ¨¡æ¿è®¾è®¡å™¨ã€‚

## ğŸ“Š MES ç³»ç»Ÿæ‰“å°åœºæ™¯

### å¸¸è§æ‰“å°éœ€æ±‚

1. **ç”Ÿäº§å·¥å•æ‰“å°**
   - å·¥å•ä¿¡æ¯
   - äº§å“ä¿¡æ¯
   - å·¥è‰ºè·¯çº¿
   - è´¨é‡è¦æ±‚

2. **è´¨é‡æ£€éªŒæŠ¥å‘Š**
   - æ£€éªŒé¡¹ç›®
   - æ£€éªŒç»“æœ
   - åˆæ ¼åˆ¤å®š
   - ç­¾åæ 

3. **è®¾å¤‡æ ‡ç­¾æ‰“å°**
   - è®¾å¤‡ä¿¡æ¯
   - äºŒç»´ç 
   - æ¡å½¢ç 

4. **å…¥åº“å•/å‡ºåº“å•**
   - å•æ®ä¿¡æ¯
   - ç‰©æ–™æ¸…å•
   - ç­¾åæ 

5. **æŠ¥è¡¨æ‰“å°**
   - ç”Ÿäº§æŠ¥è¡¨
   - è´¨é‡æŠ¥è¡¨
   - è®¾å¤‡æŠ¥è¡¨

## ğŸ› ï¸ æ¨èæŠ€æœ¯æ–¹æ¡ˆ

### å‰ç«¯æ–¹æ¡ˆ

**æ–¹æ¡ˆä¸€ï¼šreact-to-printï¼ˆæ¨èï¼‰**
- ç®€å•æ˜“ç”¨
- ä¸ Ant Design å®Œç¾é›†æˆ
- æ”¯æŒæ‰“å°é¢„è§ˆ
- é€‚åˆå¤§éƒ¨åˆ†æ‰“å°åœºæ™¯

**æ–¹æ¡ˆäºŒï¼šjsPDF + html2canvasï¼ˆPDF ç”Ÿæˆï¼‰**
- ç”Ÿæˆ PDF æ–‡ä»¶
- ç²¾ç¡®æ§åˆ¶æ ¼å¼
- é€‚åˆéœ€è¦ PDF æ–‡ä»¶çš„åœºæ™¯

**æ–¹æ¡ˆä¸‰ï¼šè‡ªå®šä¹‰æ‰“å°æ¨¡æ¿è®¾è®¡å™¨**
- åŸºäº Ant Design ç»„ä»¶
- ä½¿ç”¨ react-dnd å®ç°æ‹–æ‹½
- æ¨¡æ¿é…ç½®å­˜å‚¨ä¸º JSON

### åç«¯æ–¹æ¡ˆ

**æ¨¡æ¿å­˜å‚¨**ï¼š
- ä½¿ç”¨ PostgreSQL JSONB å­˜å‚¨æ¨¡æ¿é…ç½®
- ä½¿ç”¨ Pydantic éªŒè¯æ¨¡æ¿ç»“æ„

**æ¨¡æ¿ç®¡ç† API**ï¼š
- åˆ›å»ºæ¨¡æ¿
- æ›´æ–°æ¨¡æ¿
- åˆ é™¤æ¨¡æ¿
- è·å–æ¨¡æ¿åˆ—è¡¨
- é¢„è§ˆæ¨¡æ¿

## ğŸ“ å®æ–½å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ‰“å°åŠŸèƒ½

1. ä½¿ç”¨ `react-to-print` å®ç°åŸºç¡€æ‰“å°
2. ä½¿ç”¨ CSS `@media print` ä¼˜åŒ–æ‰“å°æ ·å¼
3. å®ç°å¸¸ç”¨æ‰“å°æ¨¡æ¿ï¼ˆå·¥å•ã€æŠ¥è¡¨ç­‰ï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šæ¨¡æ¿ç®¡ç†

1. å®ç°æ¨¡æ¿é…ç½®å­˜å‚¨
2. å®ç°æ¨¡æ¿ CRUD æ¥å£
3. å®ç°æ¨¡æ¿é¢„è§ˆåŠŸèƒ½

### ç¬¬ä¸‰é˜¶æ®µï¼šå¯è§†åŒ–è®¾è®¡å™¨ï¼ˆå¯é€‰ï¼‰

1. å¼€å‘æ‹–æ‹½å¼æ¨¡æ¿è®¾è®¡å™¨
2. æ”¯æŒç»„ä»¶åº“å’Œå±æ€§é…ç½®
3. å®ç°æ¨¡æ¿ä¿å­˜å’Œå¤ç”¨

## âœ… æ€»ç»“

1. **Ant Design Pro æ²¡æœ‰åŸç”Ÿæ‰“å°æ¨¡æ¿è®¾è®¡å™¨**
2. **æ¨èæ–¹æ¡ˆ**ï¼š
   - ç®€å•åœºæ™¯ï¼š`react-to-print` + CSS æ‰“å°æ ·å¼
   - PDF ç”Ÿæˆï¼š`jsPDF` + `html2canvas`
   - æ¨¡æ¿è®¾è®¡å™¨ï¼šåŸºäº Ant Design ç»„ä»¶è‡ªå®šä¹‰å¼€å‘
3. **æŠ€æœ¯æ ˆç»Ÿä¸€**ï¼šå…¨éƒ¨ä½¿ç”¨ React ç”Ÿæ€ï¼Œä¸ç°æœ‰æŠ€æœ¯æ ˆä¸€è‡´
4. **å®æ–½å»ºè®®**ï¼šä»åŸºç¡€æ‰“å°åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥å®Œå–„æ¨¡æ¿ç®¡ç†åŠŸèƒ½

