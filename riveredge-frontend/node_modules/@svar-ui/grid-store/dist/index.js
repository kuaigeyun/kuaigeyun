var F=new Date().valueOf(),W=()=>F++;function U(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const o in e){const t=r[o],i=e[o];if(!k(t,i))return!1}return!0}function k(r,e){if(typeof r=="number"||typeof r=="string"||typeof r=="boolean"||r===null)return r===e;if(typeof r!=typeof e||(r===null||e===null)&&r!==e||r instanceof Date&&e instanceof Date&&r.getTime()!==e.getTime())return!1;if(typeof r=="object")if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;for(let o=r.length-1;o>=0;o--)if(!k(r[o],e[o]))return!1;return!0}else return U(r,e);return r===e}function I(r){if(typeof r!="object"||r===null)return r;if(r instanceof Date)return new Date(r);if(r instanceof Array)return r.map(I);const e={};for(const o in r)e[o]=I(r[o]);return e}var D=2,K=class{constructor(r){r&&(this._writable=r.writable,this._async=r.async),this._values={},this._state={}}setState(r,e=0){const o={};return this._wrapProperties(r,this._state,this._values,"",o,e),o}getState(){return this._values}getReactive(){return this._state}_wrapProperties(r,e,o,t,i,s){for(const a in r){const n=e[a],l=o[a],c=r[a];if(n&&(l===c&&typeof c!="object"||c instanceof Date&&l instanceof Date&&l.getTime()===c.getTime()))continue;const d=t+(t?".":"")+a;n?(n.__parse(c,d,i,s)&&(o[a]=c),s&D?i[d]=n.__trigger:n.__trigger()):(c&&c.__reactive?e[a]=this._wrapNested(c,c,d,i):e[a]=this._wrapWritable(c),o[a]=c),i[d]=i[d]||null}}_wrapNested(r,e,o,t){const i=this._wrapWritable(r);return this._wrapProperties(r,i,e,o,t,0),i.__parse=(s,a,n,l)=>(this._wrapProperties(s,i,e,a,n,l),!1),i}_wrapWritable(r){const e=[],o=function(){for(let t=0;t<e.length;t++)e[t](r)};return{subscribe:t=>(e.push(t),this._async?setTimeout(t,1,r):t(r),()=>{const i=e.indexOf(t);i>=0&&e.splice(i,1)}),__trigger:()=>{e.length&&(this._async?setTimeout(o,1):o())},__parse:function(t){return r=t,!0}}}},B=class{constructor(r,e,o,t){typeof r=="function"?this._setter=r:this._setter=r.setState.bind(r),this._routes=e,this._parsers=o,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(i=>{i.in.forEach(s=>{const a=this._triggers.get(s)||[];a.push(i),this._triggers.set(s,a)}),i.out.forEach(s=>{const a=this._sources.get(s)||{};i.in.forEach(n=>a[n]=!0),this._sources.set(s,a)})}),this._routes.forEach(i=>{i.length=Math.max(...i.in.map(s=>H(s,this._sources,1)))}),this._bus=t}init(r){const e={};for(const o in r)if(this._prev[o]!==r[o]){const t=this._parsers[o];e[o]=t?t(r[o]):r[o]}this._prev=this._prev?{...this._prev,...r}:{...r},this.setState(e),this._bus&&this._bus.exec("init-state",e)}setStateAsync(r){const e=this._setter(r,D);return this._async?Object.assign(this._async.signals,e):this._async={signals:e,timer:setTimeout(this._applyState.bind(this),1)},e}_applyState(){const r=this._async;if(r){this._async=null,this._triggerUpdates(r.signals,[]);for(const e in r.signals){const o=r.signals[e];o&&o()}}}setState(r,e=[]){const o=this._setter(r);return this._triggerUpdates(o,e),o}_triggerUpdates(r,e){const o=Object.keys(r),t=!e.length;e=e||[];for(let i=0;i<o.length;i++){const s=o[i],a=this._triggers.get(s);a&&a.forEach(n=>{e.indexOf(n)==-1&&e.push(n)})}t&&this._execNext(e)}_execNext(r){for(;r.length;){r.sort((o,t)=>o.length<t.length?1:-1);const e=r[r.length-1];r.splice(r.length-1),e.exec(r)}}};function H(r,e,o){const t=e.get(r);if(!t)return o;const i=Object.keys(t).map(s=>H(s,e,o+1));return Math.max(...i)}var X=class{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(r,e,o){let t=this._handlers[r];t?o&&o.intercept?t.unshift(e):t.push(e):t=this._handlers[r]=[e],o&&o.tag&&this._tag.set(e,o.tag)}intercept(r,e,o){this.on(r,e,{...o,intercept:!0})}detach(r){for(const e in this._handlers){const o=this._handlers[e];for(let t=o.length-1;t>=0;t--)this._tag.get(o[t])===r&&o.splice(t,1)}}async exec(r,e){const o=this._handlers[r];if(o)for(let t=0;t<o.length;t++){const i=o[t](e);if(i===!1||i&&i.then&&await i===!1)return}return this._nextHandler&&await this._nextHandler.exec(r,e),e}setNext(r){return this._nextHandler=r}};function q(r){return e=>e[r]}function Y(r){return(e,o)=>e[r]=o}function S(r,e){return(e.getter||q(e.id))(r)}function M(r,e,o){return(e.setter||Y(e.id))(r,o)}function Z(r){return r.filter(e=>!!e.editor).map(e=>{let o={key:e.id||W(),label:e.header};e.options&&(o.options=e.options);let t=e.editor;return typeof t=="function"&&(t=t()),typeof t=="object"?(o={...o,...t},o.comp=t.type):o.comp=t,o})}function P(r,e){const o=document.createElement("a");o.href=URL.createObjectURL(r),o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}function b(r,e){let o=S(r,e)??"";return e.template&&(o=e.template(o,r,e)),e.optionsMap&&(Array.isArray(o)?o=o.map(t=>e.optionsMap.get(t)):o=e.optionsMap.get(o)),typeof o>"u"?"":o+""}function G(r,e){const o=/\n|"|;|,/;let t="";const i=e.rows||`
`,s=e.cols||"	",a=r._columns,n=r.flatData;e.header!==!1&&a[0].header&&(t=z("header",a,t,s,i));for(let l=0;l<n.length;l++){const c=[];for(let d=0;d<a.length;d++){let h=b(n[l],a[d]);o.test(h)&&(h='"'+h.replace(/"/g,'""')+'"'),c.push(h)}t+=(t?i:"")+c.join(s)}return e.footer!==!1&&a[0].footer&&(t=z("footer",a,t,s,i)),t}function z(r,e,o,t,i){const s=/\n|"|;|,/;for(let a=0;a<e[0][r].length;a++){const n=[];for(let l=0;l<e.length;l++){let c=(e[l][r][a].text||"")+"";s.test(c)&&(c='"'+c.replace(/"/g,'""')+'"'),n.push(c)}o+=(o?i:"")+n.join(t)}return o}function J(r,e,o){const t=[],i=[],s=[];let a=[];const n=r._columns,l=r.flatData,c=r._sizes;for(const h of n)s.push({width:h.flexgrow?c.columnWidth:h.width});let d=0;e.header!==!1&&n[0].header&&(A("header",n,t,i,d,e,o),a=a.concat(c.headerRowHeights.map(h=>({height:h}))),d+=n[0].header.length);for(let h=0;h<l.length;h++){const u=[];for(let f=0;f<n.length;f++){const p=l[h],g=n[f],w=S(p,g)??"";let x=b(p,g),m;e.cellStyle&&(m=e.cellStyle(w,p,g)),e.cellTemplate&&(x=e.cellTemplate(w,p,g)??x);const y=L(x,2,m,o);u.push(y)}t.push(u),a.push({height:c.rowHeight})}return d+=l.length,e.footer!==!1&&n[0].footer&&(A("footer",n,t,i,d,e,o),a=a.concat(c.footerRowHeights.map(h=>({height:h})))),{cells:t,merged:i,rowSizes:a,colSizes:s,styles:o}}function A(r,e,o,t,i,s,a){for(let n=0;n<e[0][r].length;n++){const l=[];for(let c=0;c<e.length;c++){const d=e[c][r][n],h=d.colspan?d.colspan-1:0,u=d.rowspan?d.rowspan-1:0;(h||u)&&t.push({from:{row:n+i,column:c},to:{row:n+i+u,column:c+h}});let f=d.text??"",p;s.headerCellStyle&&(p=s.headerCellStyle(f,d,e[c],r)),s.headerCellTemplate&&(f=s.headerCellTemplate(f,d,e[c],r)??f);let g;r=="header"?n==e[0][r].length-1?g=1:g=0:n?g=4:g=3;const w=L(f,g,p,a);l.push(w)}o.push(l)}}function L(r,e,o,t){let i=e;if(r&&r instanceof Date&&(r=ee(r),o=o||{},o.format=o.format||"dd/mm/yyyy"),o){o={...t[e],...o};const s=t.findIndex(a=>k(a,o));s<0?(t.push(o),i=t.length-1):i=s}return{v:r+"",s:i}}function Q(r){const e={material:"#000000",willow:"#000000","willow-dark":"#ffffff"},o={material:"none",willow:"none","willow-dark":"#2a2b2d"},t={material:"#fafafb",willow:"#f2f3f7","willow-dark":"#20262b"},i={material:"0.5px solid #dfdfdf",willow:"0.5px solid #e6e6e6","willow-dark":"0.5px solid #384047"},s={material:"#dfdfdf",willow:"#e6e6e6","willow-dark":"#384047"},a=e[r],n="0.5px solid "+s[r],l={verticalAlign:"center",align:"left"},c={fontWeight:"bold",color:a,background:t[r],...l,borderBottom:n,borderRight:n};return{cell:{color:a,background:o[r],borderBottom:i[r],borderRight:i[r],...l},header:{...c},footer:{...c}}}function ee(r){return r?25569+(r.getTime()-r.getTimezoneOffset()*6e4)/(86400*1e3):null}const te="portrait",oe=100,ie="a4",se={a3:{width:11.7,height:16.5},a4:{width:8.27,height:11.7},letter:{width:8.5,height:11}};function re(r,e){const o=[];let t=[],i=0;const s=r.filter(n=>!n.hidden),a=ae(e);return s.forEach((n,l)=>{i+n.width<=a?(i+=n.width,t.push(n)):(t.length&&o.push(t),t=[n],i=n.width),l===s.length-1&&t.length&&o.push(t)}),o}function ne(r,e,o){const t=[];return r.forEach((i,s)=>{const a=i[e];for(let n=0;n<o.length;n++){t[n]||(t[n]=[]);const l={...a[n]};if(t[n][s]!==null){if(!s&&!l.rowspan&&!l.colspan){let c=1,d=r[s+c][e][n],h=l.width;for(;!d.rowspan&&!d.colspan;)c++,d=r[s+c][e][n],h+=d.width;l.colspan=c,l.width=h,l.height=o[n]}if(t[n].push(l),!l.collapsed&&l.colspan>1){let c=l.colspan-1;if(l.colspan+s>r.length){const d=l.colspan-(l.colspan+s-r.length);l.colspan=d,l.width=r.slice(s,s+c+1).reduce((h,u)=>h+u.width,0),d>1&&(c=d-1)}for(let d=0;d<c;d++)t[n].push(null)}if(l.rowspan>1){const c=l.rowspan;for(let d=1;d<c;d++)t[n+d]||(t[n+d]=[]),t[n+d].push(null)}}}if(i.collapsed)for(let n=0;n<t.length;n++){const l=t[n],c=l[s];if(c&&c.collapsed){if(l[s]=null,!n)break}else{const d=c||l.findLast(h=>h?.colspan>=1);d&&(d.colspan=d.colspan-1,d.width=d.width-i.width)}}}),t.map(i=>i.filter(s=>s&&s.colspan!==0))}function ae(r){const{mode:e,ppi:o,paper:t}=r,{width:i,height:s}=se[t];return le(e==="portrait"?i:s,o)}function le(r,e){return r*e}function ce(r={}){const{mode:e,ppi:o,paper:t}=r;return{mode:e||te,ppi:o||oe,paper:t||ie}}function de(r,e){return r.flexgrow?`min-width:${e}px;width:auto`:`width:${r.width}px; max-width:${r.width}px; height:${r.height}px`}function he(r,e,o){let t=r[o.id];if(o.filter.type==="richselect"&&t){const i=o.filter.config?.options||e.find(({id:s})=>s==o.id).options;i&&(t=i.find(({id:s})=>s==t).label)}return t??""}const N=["resize-column","hide-column","update-cell"],ue=["delete-row","update-row","update-cell"],fe=["move-item"],ge=["resize-column","move-item"];class pe{undo=[];redo=[];progress={};in;getState;setState;_previousValues={};constructor(e,o,t){this.in=e,this.getState=o,this.setState=t,this.setHandlers(),this.resetStateHistory()}getHandlers(){return{"add-row":{handler:e=>({action:"delete-row",data:{id:e.id},source:{action:"add-row",data:e}})},"delete-row":{handler:e=>{const{id:o}=e,{data:t}=this.getPrev(),i=t.findIndex(s=>s.id==o);return{action:"add-row",data:{id:o,row:t[i],before:i<t.length-1?t[i+1].id:void 0},source:{action:"delete-row",data:e}}}},"update-cell":{handler:e=>{const{id:o,column:t}=e,i=this.getRow(o),s=this.getColumn(t),a=S(i,s);return k(a,e.value)?null:{action:"update-cell",data:{id:o,column:t,value:a},source:{action:"update-cell",data:e}}}},"update-row":{handler:e=>{const{id:o,row:t}=e,i=this.getRow(o);for(const s in t)Object.keys(i).includes(s)||(i[s]=void 0);return{action:"update-row",data:{id:o,row:i},source:{action:"update-row",data:e}}}},"copy-row":{handler:e=>{const{id:o}=e,{data:t}=this.getState(),i=t.findIndex(a=>a.id==o),s=t[i];return{action:"delete-row",data:{id:o},source:{action:"add-row",data:{id:o,row:s,before:i<t.length-1?t[i+1].id:void 0}}}}},"resize-column":{handler:e=>{const{id:o,width:t}=e,i=this.getColumn(o),{_sizes:s}=this.getState();return{action:"resize-column",data:{id:o,width:i.width??s.columnWidth},source:{action:"resize-column",data:{id:o,width:t}}}}},"hide-column":{handler:e=>{const{id:o}=e,t=this.getColumn(o);return{action:"hide-column",data:{id:o,mode:t.hidden},source:{action:"hide-column",data:e}}}},"collapse-column":{handler:e=>{const{id:o,row:t,mode:i}=e;return{action:"collapse-column",data:{id:o,row:t,mode:typeof i=="boolean"?!i:i},source:{action:"collapse-column",data:e}}}},"move-item":{handler:e=>{const{id:o,target:t,mode:i}=e,{flatData:s}=this.getPrev(),a=s.findIndex(n=>n.id==o);return{action:"move-item",data:{id:o,target:s[a+(a?-1:1)].id,mode:a?"after":"before"},source:{action:"move-item",data:{id:o,target:t,mode:i}}}}},"open-row":{handler:e=>{const{id:o,nested:t}=e;return{action:"close-row",data:{id:o,nested:t},source:{action:"open-row",data:e}}}},"close-row":{handler:e=>{const{id:o,nested:t}=e;return{action:"open-row",data:{id:o,nested:t},source:{action:"close-row",data:e}}}}}}resetHistory(){this.undo=[],this.redo=[],this.progress={},this.resetStateHistory()}getPrev(){return this._previousValues}setHandlers(){const e=this.getHandlers();for(const o in e)this.in.intercept(o,t=>{if(!(t.eventSource==="undo"||t.eventSource==="redo"||t.skipUndo)){if(ge.includes(o)){(t.inProgress&&!this.progress[o]||typeof t.inProgress!="boolean")&&(fe.includes(o)&&this.setPrev("flatData"),N.includes(o)&&this.setPrev("columns")),this.progress[o]=t.inProgress;return}ue.includes(o)&&this.setPrev("data"),N.includes(o)&&this.setPrev("columns")}}),this.in.on(o,t=>{if(t.eventSource==="undo"||t.eventSource==="redo"||t.skipUndo||t.inProgress)return;const i=e[o].handler(t);i&&this.addToHistory(i)})}setPrev(e){this._previousValues[e]=I(this.getState()[e])}addToHistory(e){this.undo.push(e),this.redo=[],this.setStateHistory()}handleUndo(){if(!this.undo.length)return;const e=this.undo.pop();this.redo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"undo"}),this.setStateHistory()}handleRedo(){if(!this.redo.length)return;const e=this.redo.pop();this.undo.push({...e.source,source:e}),this.in.exec(e.action,{...e.data,eventSource:"redo"}),this.setStateHistory()}resetStateHistory(){this.setState({history:{undo:0,redo:0}})}setStateHistory(){this.setState({history:{undo:this.undo.length,redo:this.redo.length}})}getRow(e){const{data:o}=this.getPrev();return this.getState().tree?this.getTreeRow(o,e):o.find(t=>t.id==e)}getTreeRow(e,o){for(let t=0;t<e.length;t++){if(e[t].id==o)return e[t];if(e[t].data){const i=this.getTreeRow(e[t].data,o);if(i)return i}}return null}getColumn(e){const{columns:o}=this.getPrev();return o.find(t=>t.id==e)}}function we(){return{gen:1}}function O(){let r=!0;return r=!1,r}function $(r,e){return typeof r>"u"||r===null?-1:typeof e>"u"||e===null?1:r===e?0:r>e?1:-1}function me(r,e){return-$(r,e)}function xe(r,e){if(typeof e.sort=="function")return function(t,i){const s=e.sort(t,i);return r==="asc"?s:-s};const o=r==="asc"?$:me;return function(t,i){return o(S(t,e),S(i,e))}}function ye(r,e){if(!r||!r.length)return;const o=r.map(t=>{const i=e.find(s=>s.id==t.key);return xe(t.order,i)});return r.length===1?o[0]:function(t,i){for(let s=0;s<o.length;s++){const a=o[s](t,i);if(a!==0)return a}return 0}}const C=28,_e=20;function Se(){if(typeof document>"u")return"willow";const r=document.querySelector('[class^="wx"][class$="theme"]');return r?r.className.substring(3,r.className.length-6):"willow"}function R(r,e,o,t,i){const s=document.createElement("div"),a=document.createElement("div"),n=document.body;i=i?`${i}px`:"auto";let l,c;a.className=e,s.classList.add(`wx-${o}-theme`),s.style.cssText=`height:auto;position:absolute;top:0px;left:100px;overflow:hidden;width=${i};white-space:nowrap;`,s.appendChild(a),n.appendChild(s),typeof r!="object"&&(r=[r]);for(let d=0;d<r.length;d++){a.innerText=r[d]+"";const h=s.getBoundingClientRect(),u=Math.ceil(h.width)+(t&&t.length?t[d]:0),f=Math.ceil(h.height);l=Math.max(l||0,u),c=Math.max(c||0,f)}return s.remove(),{width:l,height:c}}function j(r,e,o,t,i){const s=[];for(let a=0;a<r.length;a++){const n=r[a][e],l=n.length;for(let c=0;c<l;c++){const{text:d,vertical:h,collapsed:u,rowspan:f,css:p}=n[c];if(!d){s[c]=Math.max(s[c]||0,t);continue}let g=0;if(h&&!u){let w=`wx-measure-cell-${e}`;if(w+=p?` ${p}`:"",g=R(d,w,i).width,(f>1||!n[c+1])&&o>c+1){const x=f||o-c,m=s.slice(c,c+x).reduce((y,_)=>y+_,0);if(m<g){const y=Math.ceil((g-m)/x);for(let _=c;_<c+x;_++)s[_]=(s[_]||t)+y}continue}}s[c]=Math.max(s[c]||t,g)}}return s}function be(r,e,o){const t=[],i=[];let s="wx-measure-cell-body";s+=r.css?` ${r.css}`:"";for(let a=0;a<e.length;a++){const n=e[a],l=b(n,r);l&&(t.push(l),r.treetoggle?i.push(e[a].$level*C+(e[a].$count?C:0)+(r.draggable?C:0)):r.draggable&&i.push(C))}return R(t,s,o,i).width}function ve(r,e){const o="wx-measure-cell-header",t=r.sort?_e:0;let i=r.header;if(typeof i=="string")return R(i,o,e).width+t;let s;Array.isArray(i)||(i=[i]);for(let a=0;a<i.length;a++){const n=i[a],l=typeof n=="string"?n:n.text,c=o+(typeof n=="string"?"":` ${n.css}`);let d=R(l,c,e).width;a===i.length-1&&(d+=t),s=Math.max(s||0,d)}return s}const ke={text:(r,e)=>r?r.toString().toLowerCase().indexOf(e.toLowerCase())!==-1:!e,richselect:(r,e)=>typeof e!="number"&&!e?!0:r==e};function Ce(r){return ke[r]}class Re extends K{in;_router;_branches;_xlsxWorker;_historyManager;constructor(e){super({writable:e,async:!1});const o={rowHeight:37,columnWidth:160,headerHeight:36,footerHeight:36};this._router=new B(super.setState.bind(this),[{in:["columns","sizes","_skin"],out:["_columns","_sizes"],exec:i=>{const{columns:s,sizes:a,_skin:n}=this.getState(),l=this.copyColumns(s),c=l.reduce((u,f)=>Math.max(f.header.length,u),0),d=l.reduce((u,f)=>Math.max(f.footer.length,u),0);l.forEach(this.setCollapsibleColumns);const h=this.normalizeSizes(l,a,c,d,n);for(let u=0;u<l.length;u++)this.normalizeColumns(l,u,"header",c,h),this.normalizeColumns(l,u,"footer",d,h);this.setState({_columns:l,_sizes:h},i)}},{in:["data","tree","_filterIds"],out:["flatData","_rowHeightFromData"],exec:i=>{const{data:s,tree:a,dynamic:n,_filterIds:l}=this.getState(),c=l&&new Set(l),d=a?this.flattenRows(s,[],l):c?s.filter(u=>c.has(u.id)):s,h=!n&&d.some(u=>u.rowHeight);this.setState({flatData:d,_rowHeightFromData:h},i)}}],{sizes:i=>({...o,...i})});const t=this.in=new X;t.on("close-editor",({ignore:i})=>{const{editor:s}=this.getState();s&&(i||t.exec("update-cell",s),this.setState({editor:null}))}),t.on("open-editor",({id:i,column:s})=>{let a=this.getState().editor;a&&t.exec("close-editor",{});const n=this.getRow(i),l=s?this.getColumn(s):this.getNextEditor(n);if(l?.editor){let c=l.editor;if(typeof c=="function"&&(c=c(n,l)),!c)return;a={column:l.id,id:i,value:S(n,l)??"",renderedValue:b(n,l)},typeof c=="object"&&c.config&&(a.config=c.config,c.config.options&&(a.options=c.config.options)),l.options&&!a.options&&(a.options=l.options),this.setState({editor:a})}}),t.on("editor",({value:i})=>{const s=this.getState().editor;s&&(s.value=i,this.setState({editor:s}))}),t.on("add-row",i=>{const s=this.getState();let{data:a}=s;const{select:n,_filterIds:l}=s,{row:c,before:d,after:h,select:u}=i;if(i.id=c.id=i.id||c.id||E(),d||h){const p=d||h,g=a.findIndex(w=>w.id===p);a=[...a],a.splice(g+(h?1:0),0,i.row)}else a=[...a,i.row];const f={data:a};l&&(f._filterIds=[...l,i.id]),this.setState(f),!(typeof u=="boolean"&&!u)&&(u||n)&&t.exec("select-row",{id:c.id,show:!0})}),t.on("delete-row",i=>{const{data:s,selectedRows:a,focusCell:n,editor:l}=this.getState(),{id:c}=i,d={data:s.filter(h=>h.id!==c)};this.isSelected(c)&&(d.selectedRows=a.filter(h=>h!==c)),l?.id==c&&(d.editor=null),this.setState(d),n?.row===c&&this.in.exec("focus-cell",{eventSource:"delete-row"})}),t.on("update-cell",i=>{const s=this.getState();let{data:a}=s;a=[...a];const{tree:n}=s,{id:l,column:c,value:d}=i,h=this.getColumn(c);if(n){const u={...this._branches[l]};M(u,h,d);const f=this.updateTreeRow(u);u.$parent===0&&(a=f)}else{const u=a.findIndex(p=>p.id==l),f={...a[u]};M(f,h,d),a[u]=f}this.setState({data:a})}),t.on("update-row",i=>{let{data:s}=this.getState();const{id:a,row:n}=i,l=s.findIndex(c=>c.id==a);s=[...s],s[l]={...s[l],...n},this.setState({data:s})}),t.on("select-row",({id:i,toggle:s,range:a,mode:n,show:l,column:c})=>{const d=this.getState(),{focusCell:h}=d;let{selectedRows:u}=d;if(u.length||(a=s=!1),a){const{data:f}=this.getState();let p=f.findIndex(w=>w.id==u[u.length-1]),g=f.findIndex(w=>w.id==i);p>g&&([p,g]=[g,p]),f.slice(p,g+1).forEach(w=>{u.indexOf(w.id)===-1&&u.push(w.id)})}else if(s&&this.isSelected(i)){if(n===!0)return;u=u.filter(f=>f!==i)}else if(s){if(n===!1)return;u.push(i)}else u=[i];this.setState({selectedRows:[...u]}),h?.row!==i&&this.in.exec("focus-cell",{eventSource:"select-row"}),l&&this.in.exec("scroll",{row:i,column:c})}),this.in.on("focus-cell",i=>{const{row:s,column:a,eventSource:n}=i,{_columns:l,split:c}=this.getState();s&&a?(this.setState({focusCell:{row:s,column:a}}),n!=="click"&&((!c.left||l.findIndex(d=>d.id==i.column)>=c.left)&&(!c.right||l.findIndex(d=>d.id==i.column)<l.length-c.right)?this.in.exec("scroll",{row:s,column:a}):this.in.exec("scroll",{row:s}))):this.setState({focusCell:null})}),t.on("resize-column",i=>{const{id:s,auto:a,maxRows:n,inProgress:l}=i;if(l===!1)return;let c=i.width||0;const d=[...this.getState().columns],h=d.find(u=>u.id==s);if(a){if(a=="data"||a===!0){const{flatData:u,_skin:f}=this.getState();let p=u.length;n&&(p=Math.min(n,p));const g=u.slice(0,p);c=be(h,g,f)}if(a=="header"||a===!0){const{_skin:u}=this.getState();c=Math.max(ve(h,u),c)}}h.width=Math.max(17,c),delete h.flexgrow,this.setState({columns:d})}),t.on("hide-column",i=>{const{id:s,mode:a}=i,n=[...this.getState().columns],l=n.find(d=>d.id==s),c=n.reduce((d,h)=>d+(h.hidden?0:1),0);!a||c>1?(l.hidden=!l.hidden,this.setState({columns:n})):i.skipUndo=!0}),t.on("sort-rows",i=>{const{key:s,add:a,sort:n}=i,l=this.getState(),{columns:c,data:d,tree:h}=l;if(n){const m=[...d];m.sort(n),this.setState({data:m});return}const{order:u="asc"}=i;let f=l.sortMarks;const p=Object.keys(f),g=p.length;!a||!g||g===1&&f[s]?f={[s]:{order:u}}:(g===1&&(f[p[0]]={...f[p[0]],index:0}),f={...f,[s]:{order:u,index:typeof a=="number"?a:f[s]?.index??g}});const w=Object.keys(f).sort((m,y)=>f[m].index-f[y].index).map(m=>({key:m,order:f[m].order}));this.setState({sortMarks:f});const x=ye(w,c);if(x){const m=[...d];h?this.sortTree(m,x):m.sort(x),this.setState({data:m})}}),t.on("filter-rows",i=>{const{value:s,key:a,filter:n}=i;if(!Object.keys(i).length){this.setState({filterValues:{},_filterIds:null});return}const l=this.getState(),{data:c,tree:d}=l;let h=l.filterValues;const u={};a&&(h={...h,[a]:s},u.filterValues=h);const f=n??this.createFilter(h);let p=[];d?p=this.filterTree(c,f,p):c.forEach(g=>{f(g)&&p.push(g.id)}),u._filterIds=p,this.setState(u)}),t.on("collapse-column",i=>{const{id:s,row:a,mode:n}=i,l=[...this.getState().columns],c=this.getColumn(s).header,d=Array.isArray(c)?c[a]:c;typeof d=="object"&&(d.collapsed=n??!d.collapsed,this.setState({columns:l}))}),t.on("move-item",i=>{const{id:s,inProgress:a}=i;let{target:n,mode:l="after"}=i;const{data:c,flatData:d,tree:h}=this.getState(),u=d.findIndex(g=>g.id==s);let f;if(l==="up"||l==="down"){if(l==="up"){if(u===0)return;f=u-1,l="before"}else if(l==="down"){if(u===d.length-1)return;f=u+1,l="after"}n=d[f]&&d[f].id}else f=d.findIndex(g=>g.id==n);if(u===-1||f===-1||a===!1)return;let p;h?p=this.moveItem(s,n,c,l):p=this.moveItem(s,n,c,l),this.setState({data:h?this.normalizeTreeRows(p):p})}),t.on("copy-row",i=>{const{id:s,target:a,mode:n="after"}=i,l=this.getState(),{flatData:c,_filterIds:d}=l;let{data:h}=l;const u=this.getRow(s);if(!u)return;const f={...u,id:E()};i.id=f.id;const p=c.findIndex(w=>w.id==a);if(p===-1)return;h.splice(p+(n==="after"?1:0),0,f),h=[...h];const g={data:h};d&&(g._filterIds=[...d,f.id]),this.setState(g)}),t.on("open-row",i=>{const{id:s,nested:a}=i;this.toggleBranch(s,!0,a)}),t.on("close-row",i=>{const{id:s,nested:a}=i;this.toggleBranch(s,!1,a)}),t.on("export-data",i=>new Promise((s,a)=>{const n=i.format||"csv",l=`${i.fileName||"data"}.${n}`;if(n=="csv"){const c=G(this.getState(),i.csv||{});i.download!==!1?P(new Blob(["\uFEFF"+c],{type:"text/csv"}),l):i.result=c,s(!0)}else if(n=="xlsx"){let c=i.excel?.styles;!c&&c!==!1&&(c=Q(this.getState()._skin));const d=c,h=d?[{...d.header},{...d.lastHeaderCell||d.header},{...d.cell},{...d.firstFooterCell||d.footer},{...d.footer}]:Array(5).fill({}),{cells:u,merged:f,rowSizes:p,colSizes:g,styles:w}=J(this.getState(),i.excel||{},h),x=i.cdn||"https://cdn.dhtmlx.com/libs/json2excel/1.3.2/worker.js";this.getXlsxWorker(x).then(m=>{m.onmessage=y=>{if(y.data.type=="ready"){const _=y.data.blob;i.download!==!1?P(_,l):i.result=_,s(!0)}},m.postMessage({type:"convert",data:{data:[{name:i.sheetName||"data",cells:u,cols:g,rows:p,merged:f}],styles:w}})})}else a()})),t.on("search-rows",i=>{const{search:s,columns:a}=i,n=this.searchRows(s,a);this.setState({search:{value:s,rows:n}})}),t.on("hotkey",({key:i,event:s,isInput:a})=>{switch(i){case"arrowup":{const{flatData:n,focusCell:l,select:c}=this.getState();if(s.preventDefault(),a)return;const d=l?l.column:this._getFirstVisibleColumn()?.id,h=l?this.getPrevRow(l.row)?.id:n[n.length-1]?.id;d&&h&&(this.in.exec("focus-cell",{row:h,column:d,eventSource:"key"}),c&&this.in.exec("select-row",{id:h}));break}case"arrowdown":{const{flatData:n,focusCell:l,select:c}=this.getState();if(s.preventDefault(),a)return;const d=l?l.column:this._getFirstVisibleColumn()?.id,h=l?this.getNextRow(l.row)?.id:n[0]?.id;d&&h&&(this.in.exec("focus-cell",{row:h,column:d,eventSource:"key"}),c&&this.in.exec("select-row",{id:h}));break}case"arrowright":{const{focusCell:n}=this.getState();if(a)return;if(s.preventDefault(),n){const l=this.getNextColumn(n.column,!0)?.id;l&&this.in.exec("focus-cell",{row:n.row,column:l,eventSource:"key"})}break}case"arrowleft":{const{focusCell:n}=this.getState();if(a)return;if(s.preventDefault(),n){const l=this.getPrevColumn(n.column,!0)?.id;l&&this.in.exec("focus-cell",{row:n.row,column:l,eventSource:"key"})}break}case"tab":{const{editor:n,focusCell:l,select:c}=this.getState();if(n){s.preventDefault();const d=n.column;let h=n.id,u=this.getNextEditor(this.getRow(h),this.getColumn(d));if(!u){const f=this.getNextRow(h);f&&(h=f.id,u=this.getNextEditor(f))}u&&(this.in.exec("open-editor",{id:h,column:u.id}),this.in.exec("focus-cell",{row:h,column:u.id,eventSource:"key"}),c&&!this.isSelected(h)&&this.in.exec("select-row",{id:h}))}else l&&this.in.exec("focus-cell",{eventSource:"key"});break}case"shift+tab":{const{editor:n,focusCell:l,select:c}=this.getState();if(n){s.preventDefault();const d=n.column;let h=n.id,u=this.getPrevEditor(this.getRow(h),this.getColumn(d));if(!u){const f=this.getPrevRow(h);f&&(h=f.id,u=this.getPrevEditor(f))}u&&(this.in.exec("open-editor",{id:h,column:u.id}),this.in.exec("focus-cell",{row:h,column:u.id,eventSource:"key"}),c&&!this.isSelected(h)&&this.in.exec("select-row",{id:h}))}else l&&this.in.exec("focus-cell",{eventSource:"key"});break}case"escape":{const{editor:n}=this.getState();n&&(this.in.exec("close-editor",{ignore:!0}),this.in.exec("focus-cell",{row:n.id,column:n.column,eventSource:"key"}));break}case"f2":{const{editor:n,focusCell:l}=this.getState();!n&&l&&this.in.exec("open-editor",{id:l.row,column:l.column});break}case"enter":{const{focusCell:n,tree:l}=this.getState();if(!a&&l&&n&&this.getColumn(n.column).treetoggle){const c=this.getRow(n.row);if(!c.data)return;this.in.exec(c.open?"close-row":"open-row",{id:n.row,nested:!0})}break}case"home":{const{editor:n,focusCell:l}=this.getState();if(!n&&l){s.preventDefault();const c=this._getFirstVisibleColumn()?.id;this.in.exec("focus-cell",{row:l.row,column:c,eventSource:"key"})}break}case"ctrl+home":{const{editor:n,focusCell:l,flatData:c,select:d}=this.getState();if(!n&&l){s.preventDefault();const h=c[0]?.id,u=this._getFirstVisibleColumn()?.id;h&&u&&(this.in.exec("focus-cell",{row:h,column:u,eventSource:"key"}),d&&!this.isSelected(h)&&this.in.exec("select-row",{id:h}))}break}case"end":{const{editor:n,focusCell:l}=this.getState();if(!n&&l){s.preventDefault();const c=this._getLastVisibleColumn()?.id,d=l.row;this.in.exec("focus-cell",{row:d,column:c,eventSource:"key"})}break}case"ctrl+end":{const{editor:n,focusCell:l,flatData:c,select:d}=this.getState();if(!n&&l){s.preventDefault();const h=c.at(-1).id,u=this._getLastVisibleColumn()?.id;h&&u&&(this.in.exec("focus-cell",{row:h,column:u,eventSource:"key"}),d&&!this.isSelected(h)&&this.in.exec("select-row",{id:h}))}break}case"ctrl+z":{this.in.exec("undo",{});break}case"ctrl+y":{this.in.exec("redo",{});break}}}),t.on("scroll",i=>{const{_columns:s,split:a,_sizes:n,flatData:l,dynamic:c,_rowHeightFromData:d}=this.getState();let h=-1,u=-1,f=0,p=0;if(i.column){h=0;const g=s.findIndex(w=>w.id==i.column);f=s[g].width;for(let w=a.left??0;w<g;w++){const x=s[w];x.hidden||(h+=x.width)}}if(i.row&&!c){const g=l.findIndex(w=>w.id==i.row);g>=0&&(d?(u=l.slice(0,g).reduce((w,x)=>w+(x.rowHeight||n.rowHeight),0),p=l[g].rowHeight):u=n.rowHeight*g)}this.setState({scroll:{top:u,left:h,width:f,height:p||n.rowHeight}})}),t.on("print",i=>{const s=ce(i);this.setState({_print:s}),this.setStateAsync({_print:null})}),t.on("undo",()=>{this._historyManager?.handleUndo()}),t.on("redo",()=>{this._historyManager?.handleRedo()}),this.initOnce()}getXlsxWorker(e){if(!this._xlsxWorker){const o=window.URL.createObjectURL(new Blob([`importScripts('${e}');`],{type:"text/javascript"}));this._xlsxWorker=new Promise(t=>{const i=new Worker(o);i.addEventListener("message",s=>{s.data.type==="init"&&t(i)})})}return this._xlsxWorker}initOnce(){const e={sortMarks:{},_filterIds:null,data:[],filterValues:{},scroll:null,editor:null,focusCell:null,_print:null,history:{undo:0,redo:0},search:null};this._router.init(e)}init(e){e.hasOwnProperty("_skin")&&!e._skin&&(e._skin=Se()),e.columns&&e.columns.forEach(o=>{o.options&&(o.optionsMap=new Map(o.options.map(t=>[t.id,t.label])))}),k(this.getState().data,e.data)||(e.tree?(this._branches={0:{data:e.data}},e.data=this.normalizeTreeRows(e.data)):e.data=this.normalizeRows(e.data),this.setState({_filterIds:null,filterValues:{},sortMarks:{},search:null}),this._historyManager&&this._historyManager.resetHistory()),O()&&(e.tree&&(e.undo=!1,e.reorder=!1),e.split?.right&&(e.split.right=0)),e.undo&&!this._historyManager&&(this._historyManager=new pe(this.in,this.getState.bind(this),this.setState.bind(this))),this._router.init({...e})}setState(e,o){return this._router.setState(e,o)}setStateAsync(e){this._router.setStateAsync(e)}getRow(e){const{tree:o}=this.getState();return o?this._branches[e]:this.getState().data.find(t=>t.id==e)}getRowIndex(e,o){return o||(o=this.getState().flatData),o.findIndex(t=>t.id==e)}getNextRow(e){const o=this.getState().flatData,t=this.getRowIndex(e,o);return o[t+1]}getPrevRow(e){const o=this.getState().flatData,t=this.getRowIndex(e,o);return o[t-1]}getColumn(e){return this.getState().columns.find(o=>o.id==e)}getNextColumn(e,o){const t=this.getState()._columns,i=t.findIndex(s=>s.id==e);return o?this._getFirstVisibleColumn(i+1):t[i+1]}getPrevColumn(e,o){const t=this.getState()._columns,i=t.findIndex(s=>s.id==e);return o?this._getLastVisibleColumn(i-1):t[i-1]}_getFirstVisibleColumn(e){const o=this.getState()._columns;let t=e??0;for(;t<o.length&&(o[t]?.hidden||o[t]?.collapsed);)t++;return o[t]}_getLastVisibleColumn(e){const o=this.getState()._columns;let t=e??o.length-1;for(;t<o.length&&(o[t]?.hidden||o[t]?.collapsed);)t--;return o[t]}isCellEditable(e,o){const{editor:t,hidden:i}=o;return!t||i?!1:typeof t=="function"?t(e,o):!0}getNextEditor(e,o){let t=this.getState().columns;if(o){const i=t.findIndex(s=>s.id==o.id);t=t.slice(i+1)}return t.find(i=>this.isCellEditable(e,i))}getPrevEditor(e,o){let t=this.getState().columns;if(o){const i=t.findLastIndex(s=>s.id==o.id);t=t.slice(0,i)}return t.findLast(i=>this.isCellEditable(e,i))}toggleBranch(e,o,t){let i=this._branches[e],{data:s}=this.getState();if(s=[...s],e!==0){i={...i,open:o};const a=this.updateTreeRow(i);i.$parent===0&&(s=a)}t&&i.data?.length&&i.data.forEach(a=>{const n=this.toggleKids(a,o,t);e===0&&(s=n)}),this.setState({data:s})}toggleKids(e,o,t){e={...e,open:o};const i=this.updateTreeRow(e);return t&&e.data?.length&&e.data.forEach(s=>{this.toggleKids(s,o,t)}),i}updateTreeRow(e){const o=e.id;this._branches[o]=e;const t=this._branches[e.$parent],i=t.data.findIndex(s=>s.id==o);return t.data=[...t.data],t.data[i]=e,t.data}isSelected(e){return this.getState().selectedRows.indexOf(e)!==-1}findAndRemove(e,o){for(let t=0;t<e.length;t++){if(e[t].id==o)return e.splice(t,1)[0];if(e[t].data){const i=[...e[t].data],s=this.findAndRemove(i,o);if(s)return e[t]={...e[t],data:i},s}}return null}insertItem(e,o,t,i){for(let s=0;s<e.length;s++){if(e[s].id==o){const a=e[s],n=i==="before"?s:s+1;if(a.data){if(i==="before"){const l=s>0?e[s-1]:null;return l?.data&&l.open?e[s-1]={...l,data:[...l.data,t]}:e.splice(n,0,t),!0}else if(a.open)return e[s]={...a,data:[t,...a.data]},!0}return e.splice(n,0,t),!0}if(e[s].data&&(e[s]={...e[s],data:[...e[s].data]},this.insertItem(e[s].data,o,t,i)))return!0}return!1}moveItem(e,o,t,i){const s=[...t],a=this.findAndRemove(s,e);return this.insertItem(s,o,a,i),s}copyColumns(e){const o=[];for(let t=0;t<e.length;t++){const i={...e[t]};this.copyHeaderFooter(i,"header"),this.copyHeaderFooter(i,"footer"),o[t]=i}return o}copyHeaderFooter(e,o){let t=e[o];t=Array.isArray(t)?[...t]:[t],t.forEach((i,s)=>{t[s]=typeof i=="string"?{text:i}:{...i}}),e[o]=t}setCollapsibleColumns(e,o,t){let i=e.header;for(let s=0;s<i.length;s++){const a=i[s];if(a.collapsible&&a.collapsed){if(a.collapsible!=="first"){e.collapsed=!0,e.width=36,a.vertical=!0;const l=i.length-s;i=i.slice(0,s+1),i[s].rowspan=l}const n=a.colspan;if(n){const l=i[s+1];let c=1;l&&l.colspan&&!l.collapsed&&(c=l.colspan);for(let d=c;d<n;d++){const h=t[o+d];h&&(h.hidden=!0)}}}}}normalizeColumns(e,o,t,i,s){const a=e[o];a.width||(a.width=a.flexgrow?17:s.columnWidth),a._colindex=o+1;const n=a[t],l=s[`${t}RowHeights`];for(let c=0;c<i;c++){const d=n[c];d.id=a.id,c===n.length-1&&(d.rowspan=d.rowspan?Math.min(d.rowspan,i-c):i-c);for(let h=1;h<d.rowspan;h++){n.splice(c+h,0,{_hidden:!0});for(let u=1;u<d.colspan;u++)e[o+u][t].splice(c+h,0,{})}if(d.rowspan){const h=(d.rowspan===i?l:l.slice(c,d.rowspan+c)).reduce((u,f)=>u+f,0);d.height=h,c+d.rowspan!=i&&d.height--}if(d.colspan){let h=a.width,u=a.flexgrow||0;const f=d.colspan;for(let p=1;p<f;p++){const g=e[o+p];g&&(g.hidden?d.colspan-=1:g.flexgrow?u+=g.flexgrow:h+=g.width||s.columnWidth),u?d.flexgrow=u:d.width=h}}else d.width=a.width,d.flexgrow=a.flexgrow;t==="header"&&d.filter&&typeof d.filter=="string"&&(d.filter={type:d.filter})}n.length>i&&(n.length=i),a[t]=n}normalizeRows(e){for(let o=0;o<e.length;o++)e[o].id||(e[o].id=E());return e}normalizeTreeRows(e,o,t){return e.forEach(i=>{i.id||(i.id=E()),i.$level=o||0,i.$parent=t||0,this._branches[i.id]=i,i.data&&(i.data.length?(i.$count=i.data.length,this.normalizeTreeRows(i.data,i.$level+1,i.id)):(delete i.data,delete i.$count,delete i.open))}),e}sortTree(e,o){e.sort(o),e.forEach(t=>{t.data&&this.sortTree(t.data,o)})}filterTree(e,o,t){return e.forEach(i=>{o(i)&&t.push(i.id),i.data&&this.filterTree(i.data,o,t)}),t}flattenRows(e,o,t){const i=o;return e.forEach(s=>{(!t||t.includes(s.id))&&i.push(s),s.data?.length&&s.open!==!1&&this.flattenRows(s.data,i,t)}),i}createFilter(e){const{_columns:o}=this.getState(),t=[];for(const i in e){const{config:s,type:a}=o.find(l=>l.id==i).header.find(l=>l.filter).filter,n=e[i];t.push(l=>s?.handler?s.handler(l[i],n):Ce(a)(l[i],n))}return i=>{for(let s=0;s<t.length;s++)if(!t[s](i))return!1;return!0}}searchRows(e,o){e=e.trim().toLowerCase();const t={};if(!e)return t;const{flatData:i,columns:s}=this.getState(),a=o?s.filter(n=>o[n.id]):s;return i.forEach(n=>{const l={};a.forEach(c=>{const d=b(n,c);String(d).toLowerCase().includes(e)&&(l[c.id]=!0)}),Object.keys(l).length&&(t[n.id]=l)}),t}normalizeSizes(e,o,t,i,s){const a=j(e,"header",t,o.headerHeight,s),n=j(e,"footer",i,o.footerHeight,s),l=a.reduce((d,h)=>d+h,0),c=n.reduce((d,h)=>d+h,0);return{...o,headerRowHeights:a,footerRowHeights:n,headerHeight:l,footerHeight:c}}}let Ee=new Date().valueOf();function E(){return"temp://"+Ee++}function Ie(r,e="data-id"){let o=r;for(!o.tagName&&r.target&&(o=r.target);o;){if(o.getAttribute&&o.getAttribute(e))return o;o=o.parentNode}return null}new Date().valueOf();var Te=class{constructor(){this.store=new Map}configure(r,e){this.node=e;for(const o in r)if(r[o]){const t=o.toLowerCase().replace(/[ ]/g,""),i=r[o];this.store.set(t,i)}}},v=[],De={subscribe:r=>{He();const e=new Te;return v.push(e),r(e),()=>{const o=v.findIndex(t=>t===e);o>=0&&v.splice(o,1)}}},V=!1;function He(){V||(V=!0,document.addEventListener("keydown",r=>{if(v.length&&(r.ctrlKey||r.altKey||r.metaKey||r.shiftKey||r.key.length>1||r.key===" ")){const e=[];r.ctrlKey&&e.push("ctrl"),r.altKey&&e.push("alt"),r.metaKey&&e.push("meta"),r.shiftKey&&e.push("shift");let o=r.code.replace("Key","").toLocaleLowerCase();r.key===" "&&(o="space"),e.push(o);const t=e.join("+");for(let i=v.length-1;i>=0;i--){const s=v[i],a=s.store.get(t)||s.store.get(o);a&&s.node.contains(r.target)&&a(r,{key:t,evKey:o})}}}))}const Me={tab:!0,"shift+tab":!0,arrowup:!0,arrowdown:!0,arrowright:!0,arrowleft:!0,enter:!0,escape:!0,f2:!0,home:!0,end:!0,"ctrl+home":!0,"ctrl+end":!0,"ctrl+z":!0,"ctrl+y":!0};function Pe(r,{keys:e,exec:o}){if(!e)return;function t(a){const n=a.target;return n.tagName==="INPUT"||n.tagName==="TEXTAREA"||Ie(n,"data-header-id")?.classList.contains("wx-filter")||!!n.closest(".wx-cell.wx-editor")}const i={};for(const a in e){const n=e[a];typeof n<"u"&&(typeof n=="function"?i[a]=n:n&&(i[a]=l=>{const c=t(l);o({key:a,event:l,isInput:c})}))}const s=De.subscribe(a=>{a.configure(i,r)});return{destroy:()=>{s()}}}function ze(r,e){let o=null;e.scroll.subscribe(t=>{if(!t||t===o)return;o=t;const{left:i,top:s,height:a,width:n}=t,l=e.getHeight(),c=e.getWidth(),d=e.getScrollMargin();if(s>=0){const h=r.scrollTop;s<h?r.scrollTop=s:s+a>h+l&&(r.scrollTop=s-l+a)}if(i>=0){const h=r.scrollLeft;i<h?r.scrollLeft=i:i+n>h+c-d&&(r.scrollLeft=i-c+n+d)}})}function T(r){return r.map(e=>{switch(e={...e},e.data&&(e.data=T(e.data)),e.items&&(e.data=T(e.items)),e.id){case"move-item:up":e.isDisabled=(o,t)=>Ae(o,t);break;case"move-item:down":e.isDisabled=(o,t)=>Le(o,t);break;case"undo":e.isDisabled=o=>!o.undo;break;case"redo":e.isDisabled=o=>!o.redo;break;case"paste-row":e.isDisabled=o=>!o._temp?.length;break}return e})}function Ae(r,e){return r.some(o=>e[0]?.id==o)}function Le(r,e){return r.some(o=>e[e.length-1]?.id==o)}const Ne=[{id:"add-row",comp:"button",icon:"wxi-plus",text:"New row",type:"primary"},{id:"open-editor",comp:"icon",icon:"wxi-edit",menuText:"Edit",text:"Edit"},{id:"delete-row",comp:"icon",icon:"wxi-delete",menuText:"Delete",text:"Delete"},{id:"copy-row",comp:"icon",icon:"wxi-content-copy",menuText:"Copy",text:"Copy"},{id:"cut-row",comp:"icon",icon:"wxi-content-cut",menuText:"Cut",text:"Cut"},{id:"paste-row",comp:"icon",icon:"wxi-content-paste",menuText:"Paste",text:"Paste"},{id:"move-item:up",comp:"icon",icon:"wxi-angle-up",menuText:"Move up",text:"Move up"},{id:"move-item:down",comp:"icon",icon:"wxi-angle-down",menuText:"Move down",text:"Move down"},{comp:"separator"},{id:"undo",comp:"icon",icon:"wxi-undo",menuText:"Undo",text:"Ctrl+Z"},{id:"redo",comp:"icon",icon:"wxi-redo",menuText:"Redo",text:"Ctrl+Y"}],Oe=[{id:"add-row:before",text:"Add before",icon:"wxi-table-row-plus-before"},{id:"add-row:after",text:"Add after",icon:"wxi-table-row-plus-after"},{id:"copy-row",text:"Copy",icon:"wxi-content-copy"},{id:"cut-row",text:"Cut",icon:"wxi-content-cut"},{id:"paste-row",text:"Paste",icon:"wxi-content-paste"},{id:"move-item:up",text:"Move up",icon:"wxi-angle-up"},{id:"move-item:down",text:"Move down",icon:"wxi-angle-down"},{comp:"separator"},{id:"delete-row",text:"Delete",icon:"wxi-delete-outline"}];function $e(r,e){const{selectedRows:o,data:t,focusCell:i}=r.getState();switch(e!=="paste-row"&&(r._temp=null),e){case"add-row":{o.length?o.forEach(s=>r.exec("add-row",{row:{},after:s})):r.exec("add-row",{row:{}});break}case"add-row:before":{o.forEach(s=>r.exec("add-row",{row:{},before:s}));break}case"add-row:after":{o.forEach(s=>r.exec("add-row",{row:{},after:s}));break}case"open-editor":{if(i&&o.includes(i.row)){const s=r.getColumn(i.column);r.exec("open-editor",{id:i.row,column:s.editor?i.column:void 0})}else r.exec("open-editor",{id:o[0]});break}case"copy-row":{o.forEach(s=>{r._temp||(r._temp=[]),r._temp.push({id:s,cut:!1})});break}case"cut-row":{o.forEach(s=>{r._temp||(r._temp=[]),r._temp.push({id:s,cut:!0})});break}case"paste-row":{r._temp?.length&&[...r._temp].sort((s,a)=>t.findIndex(n=>n.id==a.id)-t.findIndex(n=>n.id==s.id)).forEach((s,a)=>{o.forEach((n,l)=>{const c={id:s.id,target:n,mode:"after"};r.exec(s.cut?"move-item":"copy-row",c),s.cut||r.exec("select-row",{id:c.id,toggle:!!a||!!l})})});break}case"delete-row":o.forEach(s=>r.exec("delete-row",{id:s}));break;case"move-item:up":{[...o].sort((s,a)=>t.findIndex(n=>n.id==s)-t.findIndex(n=>n.id==a)).forEach(s=>{r.exec("move-item",{id:s,mode:"up"})});break}case"move-item:down":{[...o].sort((s,a)=>t.findIndex(n=>n.id==a)-t.findIndex(n=>n.id==s)).forEach(s=>{r.exec("move-item",{id:s,mode:"down"})});break}case"undo":r.exec("undo");break;case"redo":r.exec("redo");break}}export{Re as DataStore,T as assignChecks,Me as defaultHotkeys,Oe as defaultMenuOptions,Ne as defaultToolbarButtons,Z as getEditorConfig,ne as getHeaderFooterPrintColumns,de as getPrintCellStyle,re as getPrintColumns,he as getPrintFilterValue,b as getRenderValue,we as getStamp,S as getValue,$e as handleAction,Pe as hotkeys,O as isCommunity,ze as scrollTo};
