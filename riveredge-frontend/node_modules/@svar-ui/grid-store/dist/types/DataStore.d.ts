import { Store, EventBus } from "@wx/lib-state";
import type { TDataConfig, TWritableCreator, TID } from "@wx/lib-state";
import type { IColumn, IRenderColumn, IData, IDataConfig, IRow, TMethodsConfig, IExportOptions, TSortValue, IFilterValues, IPrintConfig } from "./types";
export default class DataStore extends Store<IData> {
    in: EventBus<TMethodsConfig, keyof TMethodsConfig>;
    private _router;
    private _branches;
    private _xlsxWorker;
    private _historyManager;
    constructor(w: TWritableCreator);
    private getXlsxWorker;
    initOnce(): void;
    init(state: Partial<IDataConfig>): void;
    setState(state: Partial<IData>, ctx?: TDataConfig): {
        [key: string]: () => void;
    };
    setStateAsync(state: Partial<IData>): void;
    getRow(id: TID): IRow;
    getRowIndex(id: TID, data?: any[]): number;
    getNextRow(id: TID): IRow;
    getPrevRow(id: TID): IRow;
    getColumn(id: TID): IColumn;
    getNextColumn(id: TID, visible?: boolean): IRenderColumn;
    getPrevColumn(id: TID, visible?: boolean): IRenderColumn;
    _getFirstVisibleColumn(index?: number): IRenderColumn;
    _getLastVisibleColumn(index?: number): IRenderColumn;
    isCellEditable(row: IRow, column: IColumn): boolean | import("./types").TEditorType | import("./types").IColumnEditor;
    getNextEditor(row: IRow, column?: IColumn): IColumn;
    getPrevEditor(row: IRow, column?: IColumn): IColumn;
    toggleBranch(id: TID, open: boolean, nested?: boolean): void;
    toggleKids(item: IRow, open: boolean, nested?: boolean): any;
    private updateTreeRow;
    private isSelected;
    private findAndRemove;
    private insertItem;
    private moveItem;
    private copyColumns;
    private copyHeaderFooter;
    private setCollapsibleColumns;
    private normalizeColumns;
    normalizeRows(data: IRow[]): IRow[];
    normalizeTreeRows(data: IRow[], level?: number, parent?: TID): IRow[];
    sortTree(data: any[], sorter: (a: TSortValue, b: TSortValue) => number): void;
    filterTree(data: IRow[], filter: (row: IRow) => boolean, filterIds: TID[]): TID[];
    flattenRows(data: IRow[], flatData: IRow[], filterIds: TID[]): IRow[];
    createFilter(filterValues: IFilterValues): (obj: any) => boolean;
    searchRows(search: string, columns?: {
        [key: TID]: boolean;
    }): {
        [key: string]: {
            [key: string]: boolean;
            [key: number]: boolean;
        };
        [key: number]: {
            [key: string]: boolean;
            [key: number]: boolean;
        };
    };
    private normalizeSizes;
}
interface ISkipUndoAction {
    skipUndo?: boolean;
}
type CombineTypes<T, N> = {
    [P in keyof T]: T[P] & N;
};
export type IDataMethodsConfig = CombineTypes<{
    ["update-cell"]: {
        id: TID;
        column: TID;
        value: string | number | Date;
        eventSource?: string;
    };
    ["add-row"]: {
        id?: TID;
        before?: TID;
        after?: TID;
        row: IRow;
        select?: boolean;
        eventSource?: string;
    };
    ["delete-row"]: {
        id: TID;
        eventSource?: string;
    };
    ["update-row"]: {
        id: TID;
        row: Record<string, any>;
        eventSource?: string;
    };
    ["select-row"]: {
        id: TID;
        toggle?: boolean;
        range?: boolean;
        mode?: boolean;
        show?: boolean;
        column?: TID;
    };
    ["resize-column"]: {
        id: TID;
        width?: number;
        auto?: boolean | "data" | "header";
        maxRows?: number;
        inProgress?: boolean;
        eventSource?: string;
    };
    ["hide-column"]: {
        id: TID;
        mode?: boolean;
        eventSource?: string;
    } & ISkipUndoAction;
    ["sort-rows"]: {
        key: string;
        order?: "asc" | "desc";
        add?: boolean | number;
        sort?: (a: IRow, b: IRow) => 1 | -1 | 0;
    };
    ["search-rows"]: {
        search: string;
        columns?: {
            [key: TID]: boolean;
        };
    };
    ["open-editor"]: {
        id: TID;
        column?: TID;
    };
    ["close-editor"]: {
        ignore?: boolean;
    };
    ["editor"]: {
        value: any;
    };
    ["filter-rows"]: {
        filter?: any;
        key?: string;
        value?: any;
    };
    ["collapse-column"]: {
        id: TID;
        row?: number;
        mode?: boolean;
        eventSource?: string;
    };
    ["move-item"]: {
        id: TID;
        target?: TID;
        mode?: "before" | "after" | "up" | "down";
        inProgress?: boolean;
        eventSource?: string;
    };
    ["copy-row"]: {
        id: TID;
        target?: TID;
        mode?: "before" | "after";
        eventSource?: string;
    };
    ["open-row"]: {
        id: TID;
        nested?: boolean;
        eventSource?: string;
    };
    ["close-row"]: {
        id: TID;
        nested?: boolean;
        eventSource?: string;
    };
    ["export-data"]: IExportOptions;
    ["scroll"]: {
        row?: TID;
        column?: TID;
    };
    ["hotkey"]: {
        key: string;
        event: any;
        isInput?: boolean;
    };
    ["focus-cell"]: {
        row?: TID;
        column?: TID;
        eventSource?: string;
    };
    ["print"]: IPrintConfig;
    ["undo"]: void;
    ["redo"]: void;
    ["request-data"]: {
        row: {
            start: number;
            end: number;
        };
    };
}, {
    [key: string]: any;
}>;
export {};
