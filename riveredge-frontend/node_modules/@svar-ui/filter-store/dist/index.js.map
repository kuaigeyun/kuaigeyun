{"version":3,"file":"index.js","sources":["../../node_modules/@wx/lib-state/dist/index.js","../src/filters.ts","../src/RulesTree.ts","../src/DataStore.ts","../src/helpers.ts"],"sourcesContent":["// src/helpers.ts\nvar iid = (/* @__PURE__ */ new Date()).valueOf();\nvar uid = () => iid++;\nfunction tempID() {\n  return \"temp://\" + iid++;\n}\nfunction isTempID(v) {\n  return typeof v === \"string\" && v.length === 20 && parseInt(v.substr(7)) > 1e12;\n}\nfunction isSameObject(left, right) {\n  if (Object.keys(left).length !== Object.keys(right).length) return false;\n  for (const key in right) {\n    const v = left[key];\n    const nv = right[key];\n    if (!isSame(v, nv)) return false;\n  }\n  return true;\n}\nfunction isSame(v, nv) {\n  const primitiveValue = typeof v === \"number\" || typeof v === \"string\" || typeof v === \"boolean\" || v === null;\n  if (primitiveValue) return v === nv;\n  if (typeof v !== typeof nv) return false;\n  if ((v === null || nv === null) && v !== nv) return false;\n  if (v instanceof Date && nv instanceof Date && v.getTime() !== nv.getTime())\n    return false;\n  if (typeof v === \"object\") {\n    if (Array.isArray(v) && Array.isArray(nv)) {\n      if (v.length !== nv.length) return false;\n      for (let i = v.length - 1; i >= 0; i--) {\n        if (!isSame(v[i], nv[i])) return false;\n      }\n      return true;\n    } else {\n      return isSameObject(v, nv);\n    }\n  }\n  return v === nv;\n}\nfunction deepCopy(obj) {\n  if (typeof obj !== \"object\") return obj;\n  if (obj === null) return obj;\n  if (obj instanceof Date) return new Date(obj);\n  if (obj instanceof Array) return obj.map(deepCopy);\n  const out = {};\n  for (const key in obj) {\n    out[key] = deepCopy(obj[key]);\n  }\n  return out;\n}\n\n// src/DataArray.ts\nvar _DataArray = class {\n  constructor(raw) {\n    this._data = raw;\n    this._pool = /* @__PURE__ */ new Map();\n    for (let i = 0; i < raw.length; i++) {\n      const obj = raw[i];\n      this._pool.set(obj.id, obj);\n    }\n  }\n  add(raw) {\n    raw = { id: uid(), ...raw };\n    this._data.push(raw);\n    this._pool.set(raw.id, raw);\n  }\n  update(id, raw) {\n    const index = this._data.findIndex((link) => link.id == id);\n    const old = this._data[index];\n    const updated = { ...old, ...raw };\n    this._data[index] = updated;\n    this._pool.set(updated.id, updated);\n  }\n  remove(id) {\n    this._data = this._data.filter((a) => a.id != id);\n    this._pool.delete(id);\n  }\n  filter(cb) {\n    this._data = this._data.filter((x) => {\n      const check = cb(x);\n      if (!check) this._pool.delete(x.id);\n      return check;\n    });\n  }\n  byId(id) {\n    return this._pool.get(id);\n  }\n  map(cb) {\n    return this._data.map(cb);\n  }\n  forEach(cb) {\n    this._data.forEach(cb);\n  }\n};\n\n// src/DataTree.ts\nvar DataTree = class {\n  constructor(raw) {\n    const top = {\n      id: 0,\n      $level: 0,\n      data: [],\n      parent: null\n    };\n    const items = /* @__PURE__ */ new Map();\n    items.set(0, top);\n    this._pool = items;\n    if (raw && raw.length) this.parse(raw, 0);\n  }\n  parse(raw, parent) {\n    const items = this._pool;\n    for (let i = 0; i < raw.length; i++) {\n      const obj = raw[i];\n      obj.parent = obj.parent || parent;\n      obj.data = null;\n      items.set(obj.id, obj);\n    }\n    for (let i = 0; i < raw.length; i++) {\n      const obj = raw[i];\n      const temp = items.get(obj.parent);\n      if (temp) {\n        if (!temp.data) temp.data = [];\n        temp.data.push(obj);\n      }\n    }\n    const top = items.get(parent);\n    this.setLevel(top, top.$level + 1, false);\n  }\n  add(raw, index) {\n    const parent = this._pool.get(raw.parent || 0);\n    raw.$level = parent.$level + 1;\n    this._pool.set(raw.id, raw);\n    if (parent.data) {\n      if (index === -1) parent.data = [...parent.data, raw];\n      else insertElement(parent, index, raw);\n    } else parent.data = [raw];\n  }\n  addAfter(raw, after) {\n    if (!after) {\n      return this.add(raw, -1);\n    }\n    const node = this.byId(after);\n    const parent = this.byId(node.parent);\n    const index = indexById(parent, node.id) + 1;\n    raw.parent = parent.id;\n    raw.$level = parent.$level + 1;\n    this.add(raw, index);\n  }\n  remove(id) {\n    const obj = this._pool.get(id);\n    this._remove(obj);\n    const parent = this._pool.get(obj.parent);\n    parent.data = parent.data.filter((a) => a.id != id);\n    this._clearBranch(parent);\n  }\n  _remove(obj) {\n    if (obj.data) {\n      obj.data.forEach((i) => this._remove(i));\n    }\n    this._pool.delete(obj.id);\n  }\n  update(id, values) {\n    let obj = this._pool.get(id);\n    const branch = this._pool.get(obj.parent);\n    const index = indexById(branch, obj.id);\n    obj = { ...obj, ...values };\n    if (branch && index >= 0) {\n      branch.data[index] = obj;\n      branch.data = [...branch.data];\n    }\n    this._pool.set(obj.id, obj);\n  }\n  move(id, mode, target) {\n    const now = this._pool.get(id);\n    const dropChild = mode === \"child\";\n    const tobj = this._pool.get(target);\n    const tLevel = tobj.$level + (dropChild ? 1 : 0);\n    if (!now || !tobj) return;\n    const parent = this._pool.get(now.parent);\n    const newParent = dropChild ? tobj : this._pool.get(tobj.parent);\n    if (!newParent.data) newParent.data = [];\n    const index = indexById(parent, now.id);\n    deleteElement(parent, index);\n    const newIndex = dropChild ? newParent.data.length : indexById(newParent, tobj.id) + (mode === \"after\" ? 1 : 0);\n    insertElement(newParent, newIndex, now);\n    if (parent.id === newParent.id && index === newIndex) return null;\n    now.parent = newParent.id;\n    if (now.$level !== tLevel) {\n      now.$level = tLevel;\n      this.setLevel(now, tLevel + 1, true);\n    }\n    this.update(now.id, now);\n    this._clearBranch(parent);\n  }\n  _clearBranch(obj) {\n    if (obj.data && !obj.data.length) {\n      if (obj.open) delete obj.open;\n      this.update(obj.id, { data: null });\n    }\n  }\n  toArray() {\n    const out = [];\n    const kids = this._pool.get(0).data;\n    if (kids) toArray(kids, out);\n    return out;\n  }\n  byId(id) {\n    return this._pool.get(id);\n  }\n  getBranch(id) {\n    return this._pool.get(id).data;\n  }\n  forEach(cb) {\n    this._pool.forEach((value, key) => {\n      if (key !== 0) cb(value);\n    });\n  }\n  eachChild(cb, parent) {\n    const p = this.byId(parent);\n    if (!p || !p.data) return;\n    p.data.forEach((child, index) => {\n      cb(this.byId(child.id), index);\n      this.eachChild(cb, child.id);\n    });\n  }\n  setLevel(root, level, copy) {\n    if (!root.data) return;\n    root.data = root.data.map((child) => {\n      if (copy) {\n        child = { ...child };\n        this._pool.set(child.id, child);\n      }\n      child.$level = level;\n      if (child.data) this.setLevel(child, level + 1, copy);\n      return child;\n    });\n  }\n};\nfunction toArray(line, out) {\n  line.forEach((a) => {\n    out.push(a);\n    if (a.open === true) {\n      toArray(a.data, out);\n    }\n  });\n}\nfunction deleteElement(obj, index) {\n  const newData = [...obj.data];\n  newData.splice(index, 1);\n  obj.data = newData;\n}\nfunction insertElement(obj, index, item) {\n  const newData = [...obj.data];\n  newData.splice(index, 0, item);\n  obj.data = newData;\n}\nfunction indexById(parentNode, id) {\n  return parentNode?.data.findIndex(\n    (child) => child.id === id\n  );\n}\n\n// src/Store.ts\nvar STORE_SET_SILENT = 2;\nvar Store = class {\n  constructor(config) {\n    if (config) {\n      this._writable = config.writable;\n      this._async = config.async;\n    }\n    this._values = {};\n    this._state = {};\n  }\n  setState(data, mode = 0) {\n    const signals = {};\n    this._wrapProperties(\n      data,\n      this._state,\n      this._values,\n      \"\",\n      signals,\n      mode\n    );\n    return signals;\n  }\n  getState() {\n    return this._values;\n  }\n  getReactive() {\n    return this._state;\n  }\n  _wrapProperties(data, state, values, parent, signals, mode) {\n    for (const key in data) {\n      const os = state[key];\n      const ov = values[key];\n      const nv = data[key];\n      if (os) {\n        if (ov === nv && typeof nv !== \"object\") continue;\n        if (nv instanceof Date) {\n          if (ov instanceof Date && ov.getTime() === nv.getTime()) continue;\n        }\n      }\n      const fullKey = parent + (parent ? \".\" : \"\") + key;\n      if (os) {\n        if (os.__parse(nv, fullKey, signals, mode)) values[key] = nv;\n        if (mode & STORE_SET_SILENT) signals[fullKey] = os.__trigger;\n        else os.__trigger();\n      } else {\n        if (nv && nv.__reactive) {\n          state[key] = this._wrapNested(nv, nv, fullKey, signals);\n        } else {\n          state[key] = this._wrapWritable(nv);\n        }\n        values[key] = nv;\n      }\n      signals[fullKey] = signals[fullKey] || null;\n    }\n  }\n  _wrapNested(data, values, fullKey, signals) {\n    const state = this._wrapWritable(data);\n    this._wrapProperties(data, state, values, fullKey, signals, 0);\n    state.__parse = (v, fullKey2, signals2, mode) => {\n      this._wrapProperties(v, state, values, fullKey2, signals2, mode);\n      return false;\n    };\n    return state;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _wrapWritable(val) {\n    const ss = [];\n    const __triggerSync = function() {\n      for (let i = 0; i < ss.length; i++) {\n        ss[i](val);\n      }\n    };\n    const __trigger = () => {\n      if (ss.length) {\n        if (this._async) setTimeout(__triggerSync, 1);\n        else __triggerSync();\n      }\n    };\n    const subscribe = (fn) => {\n      ss.push(fn);\n      if (this._async) setTimeout(fn, 1, val);\n      else fn(val);\n      return () => {\n        const i = ss.indexOf(fn);\n        if (i >= 0) ss.splice(i, 1);\n      };\n    };\n    const __parse = function(v) {\n      val = v;\n      return true;\n    };\n    return {\n      subscribe,\n      __trigger,\n      __parse\n    };\n  }\n};\nfunction markReactive(t, nested) {\n  Object.defineProperty(t, \"__reactive\", {\n    value: true,\n    enumerable: false,\n    writable: false\n  });\n  if (nested === true) {\n    for (const key in t) {\n      const sub = t[key];\n      if (typeof sub === \"object\" && sub !== null) {\n        markReactive(sub, true);\n      }\n    }\n  }\n  return t;\n}\n\n// src/DataRouter.ts\nvar DataRouter = class {\n  constructor(s, r, p, b) {\n    if (typeof s === \"function\") this._setter = s;\n    else this._setter = s.setState.bind(s);\n    this._routes = r;\n    this._parsers = p;\n    this._prev = {};\n    this._triggers = /* @__PURE__ */ new Map();\n    this._sources = /* @__PURE__ */ new Map();\n    this._routes.forEach((a) => {\n      a.in.forEach((k) => {\n        const arr = this._triggers.get(k) || [];\n        arr.push(a);\n        this._triggers.set(k, arr);\n      });\n      a.out.forEach((k) => {\n        const h = this._sources.get(k) || {};\n        a.in.forEach((i) => h[i] = true);\n        this._sources.set(k, h);\n      });\n    });\n    this._routes.forEach((a) => {\n      a.length = Math.max(\n        ...a.in.map((key) => _calckSize(key, this._sources, 1))\n      );\n    });\n    this._bus = b;\n  }\n  init(cfg) {\n    const next = {};\n    for (const key in cfg) {\n      if (this._prev[key] !== cfg[key]) {\n        const parser = this._parsers[key];\n        next[key] = parser ? parser(cfg[key]) : cfg[key];\n      }\n    }\n    this._prev = this._prev ? { ...this._prev, ...cfg } : { ...cfg };\n    this.setState(next);\n    if (this._bus) this._bus.exec(\"init-state\", next);\n  }\n  setStateAsync(updates) {\n    const signals = this._setter(updates, STORE_SET_SILENT);\n    if (this._async) {\n      Object.assign(this._async.signals, signals);\n    } else {\n      this._async = {\n        signals,\n        timer: setTimeout(this._applyState.bind(this), 1)\n      };\n    }\n    return signals;\n  }\n  _applyState() {\n    const obj = this._async;\n    if (!obj) return;\n    this._async = null;\n    this._triggerUpdates(obj.signals, []);\n    for (const key in obj.signals) {\n      const h = obj.signals[key];\n      if (h) h();\n    }\n  }\n  setState(updates, ctx = []) {\n    const signals = this._setter(updates);\n    this._triggerUpdates(signals, ctx);\n    return signals;\n  }\n  _triggerUpdates(signals, ctx) {\n    const keys = Object.keys(signals);\n    const needExec = !ctx.length;\n    ctx = ctx || [];\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const trgs = this._triggers.get(key);\n      if (trgs) {\n        trgs.forEach((a) => {\n          if (ctx.indexOf(a) == -1) {\n            ctx.push(a);\n          }\n        });\n      }\n    }\n    if (needExec) {\n      this._execNext(ctx);\n    }\n  }\n  _execNext(ctx) {\n    while (ctx.length) {\n      ctx.sort((a, b) => a.length < b.length ? 1 : -1);\n      const next = ctx[ctx.length - 1];\n      ctx.splice(ctx.length - 1);\n      next.exec(ctx);\n    }\n  }\n};\nfunction _calckSize(key, sources, prev) {\n  const next = sources.get(key);\n  if (!next) return prev;\n  const sizes = Object.keys(next).map((a) => _calckSize(a, sources, prev + 1));\n  return Math.max(...sizes);\n}\n\n// src/EventBus.ts\nvar EventBus = class {\n  constructor() {\n    this._nextHandler = null;\n    this._handlers = {};\n    this._tag = /* @__PURE__ */ new WeakMap();\n    this.exec = this.exec.bind(this);\n  }\n  on(name, handler, config) {\n    let prev = this._handlers[name];\n    if (!prev) {\n      prev = this._handlers[name] = [handler];\n    } else {\n      if (config && config.intercept) prev.unshift(handler);\n      else prev.push(handler);\n    }\n    if (config && config.tag) this._tag.set(handler, config.tag);\n  }\n  intercept(name, handler, config) {\n    this.on(name, handler, { ...config, intercept: true });\n  }\n  detach(tag) {\n    for (const key in this._handlers) {\n      const stack = this._handlers[key];\n      for (let i = stack.length - 1; i >= 0; i--) {\n        if (this._tag.get(stack[i]) === tag) {\n          stack.splice(i, 1);\n        }\n      }\n    }\n  }\n  async exec(name, ev) {\n    const stack = this._handlers[name];\n    if (stack) {\n      for (let i = 0; i < stack.length; i++) {\n        const res = stack[i](ev);\n        if (res === false) return;\n        if (res && res.then) {\n          const res2 = await res;\n          if (res2 === false) return;\n        }\n      }\n    }\n    if (this._nextHandler) await this._nextHandler.exec(name, ev);\n    return ev;\n  }\n  setNext(next) {\n    return this._nextHandler = next;\n  }\n};\n\n// src/EventResolver.ts\nvar EventResolver = class {\n  constructor(key) {\n    this._key = key;\n    this._nextHandler = null;\n    this.exec = this.exec.bind(this);\n  }\n  async exec(name, ev) {\n    if (ev && ev[this._key]) await ev[this._key](ev);\n    if (this._nextHandler) {\n      await this._nextHandler.exec(name, ev);\n    }\n    return ev;\n  }\n  setNext(next) {\n    return this._nextHandler = next;\n  }\n};\n\n// src/EventBusRouter.ts\nvar EventBusRouter = class {\n  constructor(dispatch) {\n    this._nextHandler = null;\n    this._dispatch = dispatch;\n    this.exec = this.exec.bind(this);\n  }\n  async exec(name, ev) {\n    this._dispatch(name, ev);\n    if (this._nextHandler) await this._nextHandler.exec(name, ev);\n    return ev;\n  }\n  setNext(next) {\n    return this._nextHandler = next;\n  }\n};\n\nexport { _DataArray as DataArray, DataRouter, DataTree, EventBus, EventBusRouter, EventResolver, Store, deepCopy, isSame, isTempID, markReactive, tempID, uid };\n//# sourceMappingURL=index.js.map\n//# sourceMappingURL=index.js.map","import type { TType, TFilterType } from \"./types.ts\";\n\nexport const NumberFilters = \"number\";\nexport const TextFilters = \"text\";\nexport const DateFilters = \"date\";\nexport const TupleFilters = \"tuple\";\n\nexport interface IFilterRule {\n\tid: TFilterType;\n\tlabel: string;\n\tshort?: string;\n\trange?: boolean;\n\ttype: TType[];\n\tdefault?: boolean;\n\thandler: (a: any, b: any) => boolean;\n}\n\nconst filters: IFilterRule[] = [\n\t{\n\t\tid: \"greater\",\n\t\tlabel: \"greater\",\n\t\tshort: \">\",\n\t\ttype: [NumberFilters, DateFilters, TupleFilters],\n\t\thandler: (a: any, b: any) => a > b,\n\t},\n\t{\n\t\tid: \"less\",\n\t\tlabel: \"less\",\n\t\tshort: \"<\",\n\t\ttype: [NumberFilters, DateFilters, TupleFilters],\n\t\thandler: (a: any, b: any) => a < b,\n\t},\n\t{\n\t\tid: \"greaterOrEqual\",\n\t\tlabel: \"greater or equal\",\n\t\tshort: \">=\",\n\t\ttype: [NumberFilters, DateFilters, TupleFilters],\n\t\thandler: (a: any, b: any) => a >= b,\n\t},\n\t{\n\t\tid: \"lessOrEqual\",\n\t\tlabel: \"less or equal\",\n\t\tshort: \"<=\",\n\t\ttype: [NumberFilters, DateFilters, TupleFilters],\n\t\thandler: (a: any, b: any) => a <= b,\n\t},\n\n\t{\n\t\tid: \"equal\",\n\t\tlabel: \"equal\",\n\t\tshort: \"=\",\n\t\ttype: [NumberFilters, TupleFilters],\n\t\thandler: (a: any, b: any) => a == b,\n\t},\n\t{\n\t\tid: \"equal\",\n\t\tlabel: \"equal\",\n\t\tshort: \"=\",\n\t\ttype: [TextFilters],\n\t\thandler: (a: any, b: any) => a.toLowerCase() === b.toLowerCase(),\n\t},\n\t{\n\t\tid: \"equal\",\n\t\tlabel: \"equal\",\n\t\tshort: \"=\",\n\t\tdefault: true,\n\t\ttype: [DateFilters],\n\t\thandler: (a: any, b: any) => {\n\t\t\tif (!a || !b) return false;\n\t\t\treturn a.valueOf() === b.valueOf();\n\t\t},\n\t},\n\n\t{\n\t\tid: \"notEqual\",\n\t\tlabel: \"not equal\",\n\t\tshort: \"!=\",\n\t\ttype: [NumberFilters, TupleFilters],\n\t\thandler: (a: any, b: any) => a != b,\n\t},\n\t{\n\t\tid: \"notEqual\",\n\t\tlabel: \"not equal\",\n\t\tshort: \"!=\",\n\t\ttype: [TextFilters],\n\t\thandler: (a: any, b: any) => a.toLowerCase() !== b.toLowerCase(),\n\t},\n\t{\n\t\tid: \"notEqual\",\n\t\tlabel: \"not equal\",\n\t\tshort: \"!=\",\n\t\ttype: [DateFilters],\n\t\thandler: (a: any, b: any) => {\n\t\t\tif (!a || !b) return true;\n\t\t\treturn a.valueOf() !== b.valueOf();\n\t\t},\n\t},\n\n\t{\n\t\tid: \"contains\",\n\t\tlabel: \"contains\",\n\t\tdefault: true,\n\t\ttype: [NumberFilters, TextFilters],\n\t\thandler: (a: any, b: any) =>\n\t\t\ta.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !==\n\t\t\t-1,\n\t},\n\t{\n\t\tid: \"notContains\",\n\t\tlabel: \"not contains\",\n\t\ttype: [NumberFilters, TextFilters],\n\t\thandler: (a: any, b: any) =>\n\t\t\ta.toString().toLowerCase().indexOf(b.toString().toLowerCase()) ===\n\t\t\t-1,\n\t},\n\n\t{\n\t\tid: \"beginsWith\",\n\t\tlabel: \"begins with\",\n\t\ttype: [NumberFilters, TextFilters],\n\t\thandler: (a: any, b: any) => {\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t\treturn a.lastIndexOf(b, 0) === 0;\n\t\t},\n\t},\n\t{\n\t\tid: \"notBeginsWith\",\n\t\tlabel: \"not begins with\",\n\t\ttype: [NumberFilters, TextFilters],\n\t\thandler: (a: any, b: any) => {\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t\treturn a.lastIndexOf(b, 0) !== 0;\n\t\t},\n\t},\n\t{\n\t\tid: \"endsWith\",\n\t\tlabel: \"ends with\",\n\t\ttype: [NumberFilters, TextFilters],\n\t\thandler: (a: any, b: any) => {\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t\treturn a.indexOf(b, a.length - b.length) !== -1;\n\t\t},\n\t},\n\t{\n\t\tid: \"notEndsWith\",\n\t\tlabel: \"not ends with\",\n\t\ttype: [NumberFilters, TextFilters],\n\t\thandler: (a: any, b: any) => {\n\t\t\ta = a.toString().toLowerCase();\n\t\t\tb = b.toString().toLowerCase();\n\t\t\treturn a.indexOf(b, a.length - b.length) === -1;\n\t\t},\n\t},\n\n\t{\n\t\tid: \"between\",\n\t\tlabel: \"between\",\n\t\trange: true,\n\t\ttype: [DateFilters],\n\t\thandler: (a: any, b: any) =>\n\t\t\t(!b.start || a > b.start) && (!b.end || a < b.end),\n\t},\n\t{\n\t\tid: \"notBetween\",\n\t\tlabel: \"not between\",\n\t\trange: true,\n\t\ttype: [DateFilters],\n\t\thandler: (a: any, b: any) =>\n\t\t\t!b.start || a <= b.start || !b.end || a >= b.end,\n\t},\n];\n\nexport function getFilters(type: TType): IFilterRule[] {\n\tif (typeof type === \"undefined\") return filters;\n\treturn filters.filter(a => a.type.indexOf(type) !== -1);\n}\n\nexport function getFilter(id: TFilterType, type: TType): IFilterRule {\n\ttype = type || TextFilters;\n\tlet matches = filters.filter(f => f.id === id);\n\tif (matches.length > 1)\n\t\tmatches = matches.filter(f => f.type.indexOf(type) !== -1);\n\treturn matches[0];\n}\n","import { DataTree, uid } from \"@wx/lib-state\";\nimport type { TID } from \"@wx/lib-state\";\nimport type { IFilter, IFilterSet, IDataFilter } from \"./types\";\nimport {\n\tgetFilter,\n\tNumberFilters,\n\tDateFilters,\n\tTextFilters,\n\tTupleFilters,\n} from \"./filters\";\n\nexport default class RulesTree extends DataTree<IDataFilter> {\n\tconstructor(data: IFilter) {\n\t\tsuper();\n\t\tthis.parseRules(data);\n\t}\n\tgetRoot() {\n\t\treturn this.getBranch(0)[0];\n\t}\n\tparseRules(v: IFilter) {\n\t\tthis.parse(prepareData(v), 0);\n\t}\n\tremove(id: TID) {\n\t\tlet obj = this.byId(id);\n\t\tsuper.remove(id);\n\n\t\t// delete all empty parents\n\t\twhile (obj.parent) {\n\t\t\tobj = this.byId(obj.parent);\n\t\t\tif (obj.parent && !obj.data) {\n\t\t\t\tsuper.remove(obj.id);\n\t\t\t}\n\t\t}\n\t}\n\tserialize(): IFilterSet {\n\t\tconst top = this.getBranch(0)[0];\n\t\treturn serializeBranch(top) as IFilterSet;\n\t}\n}\n\nfunction prepareData(v: IFilter): IDataFilter[] {\n\tconst out: IDataFilter[] = [];\n\tprepareDataInner([v], 0, out);\n\treturn out;\n}\nfunction prepareDataInner(\n\tv: (IFilter | IFilterSet)[],\n\tparent: TID,\n\tout: IDataFilter[]\n) {\n\tv.forEach(a => {\n\t\tconst b: IDataFilter = { ...a, parent, id: uid(), $level: 0 };\n\t\tout.push(b);\n\n\t\tif ((a as IFilterSet).rules)\n\t\t\tprepareDataInner((a as IFilterSet).rules, b.id, out);\n\t});\n}\n\nfunction serializeBranch(top: IDataFilter): IFilter | IFilterSet {\n\tif (top.data && top.data.length) {\n\t\treturn {\n\t\t\tglue: top.glue,\n\t\t\trules: top.data.map(serializeBranch).filter(r => r !== null),\n\t\t};\n\t} else {\n\t\tconst out: IFilter = {\n\t\t\tfield: top.field,\n\t\t};\n\t\tif (top.filter) {\n\t\t\tout.filter = top.filter;\n\t\t\tout.value = top.value;\n\t\t\tout.type = top.type;\n\t\t}\n\n\t\tif (top.includes) out.includes = [...top.includes];\n\t\tif (top.predicate) out.predicate = top.predicate;\n\n\t\tif (top.filter && (!top.includes || !top.includes.length)) {\n\t\t\tconst filter = getFilter(top.filter, top.type);\n\t\t\tif (!isValidFilter(top.value, filter.type)) return null;\n\t\t}\n\n\t\treturn out;\n\t}\n}\n\nconst validators: { [key: string]: (value: any) => boolean } = {\n\t[NumberFilters]: isNumber,\n\t[DateFilters]: isDate,\n\t[TextFilters]: () => true,\n\t[TupleFilters]: () => true,\n};\n\nfunction isValidFilter(value: any, type: string[]): boolean {\n\tfor (let i = 0; i < type.length; i++) {\n\t\tif (validators[type[i]](value)) return true;\n\t}\n\treturn false;\n}\n\nfunction isNumber(value: any): boolean {\n\treturn !isNaN(parseFloat(value));\n}\n\nfunction isDate(value: any): boolean {\n\treturn value && (value.start || value) instanceof Date;\n}\n","import { Store, EventBus, DataRouter, uid } from \"@wx/lib-state\";\nimport type { TDataConfig, TWritableCreator, TID } from \"@wx/lib-state\";\nimport RulesTree from \"./RulesTree\";\n\nimport type {\n\tIData,\n\tIDataConfig,\n\tTMethodsConfig,\n\tIFilter,\n\tIFilterSet,\n\tIDataFilter,\n\tIField,\n\tTOptions,\n} from \"./types\";\nimport { getFilters } from \"./filters\";\n\nexport default class DataStore extends Store<IData> {\n\tpublic in: EventBus<IDataMethodsConfig, keyof IDataMethodsConfig>;\n\tprivate _router: DataRouter<IData, IDataConfig, IDataMethodsConfig>;\n\n\tconstructor(w: TWritableCreator) {\n\t\tsuper({ writable: w, async: false });\n\n\t\tconst inBus = (this.in = new EventBus());\n\n\t\tthis._router = new DataRouter(\n\t\t\tsuper.setState.bind(this),\n\t\t\t// data recalculation dependencies\n\t\t\t[],\n\t\t\t// data initializers\n\t\t\t{\n\t\t\t\tvalue: (v: IFilter) => new RulesTree(v),\n\t\t\t}\n\t\t);\n\n\t\tinBus.on(\"edit-rule\", ({ id }: TMethodsConfig[\"edit-rule\"]) => {\n\t\t\tconst { value, _editor: editor } = this.getState();\n\t\t\tif (editor && (!id || id != editor.id)) {\n\t\t\t\tconst obj = value.byId(editor.id);\n\n\t\t\t\tif (obj.$temp || (!obj.includes && !obj.value)) {\n\t\t\t\t\tvalue.remove(editor.id);\n\t\t\t\t\tthis.setState({ value });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (id) {\n\t\t\t\tthis.setState({ _editor: { id } });\n\t\t\t} else {\n\t\t\t\tthis.setState({ _editor: null });\n\t\t\t}\n\t\t});\n\n\t\tinBus.on(\"delete-rule\", ({ id }: TMethodsConfig[\"delete-rule\"]) => {\n\t\t\tconst { value } = this.getState();\n\t\t\tif (!value.byId(id)) return;\n\t\t\tvalue.remove(id);\n\n\t\t\tthis.onChange(value);\n\t\t\tthis.setState({ value });\n\t\t});\n\n\t\tinBus.on(\n\t\t\t\"add-rule\",\n\t\t\t({ after, rule, edit }: TMethodsConfig[\"add-rule\"]) => {\n\t\t\t\tconst { value } = this.getState();\n\n\t\t\t\tif (!after && !rule.parent)\n\t\t\t\t\trule.parent = value.getBranch(0)[0].id;\n\n\t\t\t\tvalue.addAfter(this._fixRule(rule), after);\n\t\t\t\tthis.setState({ value });\n\n\t\t\t\tif (edit) inBus.exec(\"edit-rule\", { id: rule.id });\n\t\t\t}\n\t\t);\n\n\t\tinBus.on(\n\t\t\t\"add-group\",\n\t\t\t({ after, rule, edit }: TMethodsConfig[\"add-group\"]) => {\n\t\t\t\tconst { value } = this.getState();\n\n\t\t\t\tconst parent = { id: uid(), glue: \"and\" } as IDataFilter;\n\t\t\t\tvalue.addAfter(parent, after);\n\n\t\t\t\trule = this._fixRule(rule);\n\t\t\t\trule.parent = parent.id;\n\t\t\t\tvalue.add(rule, 0);\n\n\t\t\t\tthis.setState({ value });\n\n\t\t\t\tif (edit) inBus.exec(\"edit-rule\", { id: rule.id });\n\t\t\t}\n\t\t);\n\n\t\tinBus.on(\"toggle-glue\", ({ id }: TMethodsConfig[\"toggle-glue\"]) => {\n\t\t\tconst { value } = this.getState();\n\t\t\tvalue.update(id, {\n\t\t\t\tglue: value.byId(id).glue === \"and\" ? \"or\" : \"and\",\n\t\t\t});\n\n\t\t\tthis.onChange(value);\n\t\t\tthis.setState({ value });\n\t\t});\n\n\t\tinBus.on(\n\t\t\t\"update-rule\",\n\t\t\t({ id, rule }: TMethodsConfig[\"update-rule\"]) => {\n\t\t\t\tconst { value } = this.getState();\n\t\t\t\trule.$temp = false;\n\t\t\t\tvalue.update(id, rule);\n\n\t\t\t\tthis.onChange(value);\n\t\t\t\tthis.setState({ value });\n\t\t\t}\n\t\t);\n\t}\n\n\tonChange(data: RulesTree) {\n\t\tconst value = data.serialize();\n\t\tthis.in.exec(\"change\", { value });\n\t}\n\n\tinit(state: Partial<IDataConfig>) {\n\t\tstate.value = this.normalizeValue(state.value, state.fields);\n\t\tstate.options = this.normalizeOptions(state.options);\n\t\tthis._router.init({ _editor: null, ...state });\n\t}\n\n\tsetState(state: Partial<IData>, ctx?: TDataConfig) {\n\t\treturn this._router.setState(state, ctx);\n\t}\n\n\tgetValue() {\n\t\treturn this.getState().value.serialize();\n\t}\n\n\tprivate normalizeOptions(options: TOptions) {\n\t\tif (typeof options === \"function\") return options;\n\t\tif (options && typeof options === \"object\")\n\t\t\treturn (field: any) => options[field] || [];\n\n\t\treturn null;\n\t}\n\n\tprivate normalizeValue(value: IFilterSet, fields: IField[]): IFilterSet {\n\t\tconst normalized: IFilterSet = {\n\t\t\tglue: value.glue || \"and\",\n\t\t\trules: value.rules\n\t\t\t\t? value.rules.map((rule: IFilter | IFilterSet) => {\n\t\t\t\t\t\tif ((rule as IFilter).field) {\n\t\t\t\t\t\t\tconst fRule = rule as IFilter;\n\t\t\t\t\t\t\tconst out: IFilter = { ...fRule };\n\n\t\t\t\t\t\t\tif (!out.type || !out.predicate) {\n\t\t\t\t\t\t\t\tconst field = fields.find(\n\t\t\t\t\t\t\t\t\tf => f.id === fRule.field\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tout.type = fRule.type ?? field.type;\n\t\t\t\t\t\t\t\tif (field.predicate)\n\t\t\t\t\t\t\t\t\tout.predicate = field.predicate;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tout.includes = fRule.includes\n\t\t\t\t\t\t\t\t? [...fRule.includes]\n\t\t\t\t\t\t\t\t: [];\n\t\t\t\t\t\t\tout.filter =\n\t\t\t\t\t\t\t\tfRule.filter ??\n\t\t\t\t\t\t\t\tgetFilters(out.type).find(a => a.default).id;\n\n\t\t\t\t\t\t\treturn out;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((rule as IFilterSet).rules)\n\t\t\t\t\t\t\treturn this.normalizeValue(\n\t\t\t\t\t\t\t\trule as IFilterSet,\n\t\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\treturn rule;\n\t\t\t\t\t})\n\t\t\t\t: [],\n\t\t};\n\n\t\treturn normalized;\n\t}\n\n\tprivate _fixRule(obj: IDataFilter) {\n\t\tconst { fields } = this.getState();\n\n\t\tobj.id = obj.id || uid();\n\t\tif (!obj.field) obj.field = fields[0].id;\n\t\tconst f = fields.find(({ id }) => id === obj.field);\n\n\t\tif (!obj.filter) {\n\t\t\tobj.filter = getFilters(f.type).find(a => a.default).id;\n\t\t\tobj.type = f.type;\n\t\t\tobj.value = \"\";\n\t\t}\n\t\tif (!obj.predicate) {\n\t\t\tconst predicate = fields.find(f => f.id === obj.field).predicate;\n\t\t\tif (predicate) obj.predicate = predicate;\n\t\t}\n\t\tif (!obj.includes) obj.includes = [];\n\t\treturn obj;\n\t}\n}\n\ntype CombineTypes<T, N> = {\n\t[P in keyof T]: T[P] & N;\n};\n\nexport type IDataMethodsConfig = CombineTypes<\n\t{\n\t\t[\"add-rule\"]: { rule: IDataFilter; edit?: boolean; after?: TID };\n\t\t[\"add-group\"]: { rule: IDataFilter; edit?: boolean; after?: TID };\n\t\t[\"edit-rule\"]: { id?: TID };\n\t\t[\"update-rule\"]: { id: TID; rule: IDataFilter };\n\t\t[\"delete-rule\"]: { id: TID };\n\t\t[\"toggle-glue\"]: { id: TID };\n\t\t[\"change-rule\"]: { id: TID; rule: IDataFilter };\n\t\t[\"change\"]: { value: IFilterSet };\n\t},\n\t{\n\t\t[key: string]: any;\n\t}\n>;\n","import type {\n\tIFilter,\n\tIFilterSet,\n\tIDataHash,\n\tIField,\n\tTFilterType,\n} from \"./types\";\nimport { getFilter } from \"./filters\";\n\nexport type ArrayFilterFunction = (value: any[]) => any[];\n\nexport type LocatorConfig = {\n\tpredicate?: string;\n\tsort?: boolean;\n\ttype?: string;\n};\nexport type OptionsMap = { [key: string]: any[] };\nexport type FilterFunction = (value: any) => boolean;\n\nexport interface FilterOptions {\n\torNull?: boolean;\n}\n\ntype PredicateFunction = (value: any) => any;\ntype PredicateMap = { [key: string]: PredicateFunction };\n\nconst same = (v: any) => v;\nconst sortNumbers = (a: number, b: number) => a - b;\n\nconst predicates: PredicateMap = {\n\tmonth: (v: Date) => v.getMonth(),\n\tyear: (v: Date) => v.getFullYear(),\n};\n\nfunction orGroup(filters: FilterFunction[]): FilterFunction {\n\treturn v => {\n\t\tfor (let i = 0; i < filters.length; i++) {\n\t\t\tif (filters[i](v)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n}\n\nfunction andGroup(filters: FilterFunction[]): FilterFunction {\n\treturn v => {\n\t\tfor (let i = 0; i < filters.length; i++) {\n\t\t\tif (!filters[i](v)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n}\n\nconst group = {\n\tor: orGroup,\n\tand: andGroup,\n};\n\nexport function createArrayFilter(\n\tcfg: IFilterSet,\n\topts?: FilterOptions\n): ArrayFilterFunction {\n\tconst f = createFilter(cfg, { orNull: true });\n\tif (f === null) {\n\t\treturn opts && opts.orNull ? null : a => a;\n\t} else {\n\t\treturn a => a.filter(f);\n\t}\n}\n\nexport function createFilter(\n\tcfg: IFilterSet,\n\topts?: FilterOptions\n): FilterFunction {\n\tlet filters: any[] = [];\n\n\tif (cfg && cfg.rules) {\n\t\tcfg.rules.forEach(rule => {\n\t\t\tif ((rule as IFilterSet).rules) {\n\t\t\t\tfilters.push(createFilter(rule as IFilterSet));\n\t\t\t} else {\n\t\t\t\tfilters.push(createFilterBlock(rule as IFilter));\n\t\t\t}\n\t\t});\n\n\t\tfilters = filters.filter(a => a !== null);\n\t}\n\n\tif (!filters.length) {\n\t\treturn opts && opts.orNull ? null : () => true;\n\t}\n\n\treturn group[cfg.glue || \"and\"](filters);\n}\n\nfunction createFilterBlock(cfg: IFilter): FilterFunction {\n\tconst pd = predicates[cfg.predicate] || same;\n\tif (cfg.includes && cfg.includes.length) {\n\t\t// filter by list of values\n\t\treturn (value: any) => {\n\t\t\t// FIXME - we can optimize this by using hashmap\n\t\t\treturn cfg.includes.includes(pd(value[cfg.field]));\n\t\t};\n\t} else if (cfg.filter) {\n\t\t// filter by condition\n\t\tconst check = getFilter(cfg.filter, cfg.type).handler;\n\t\treturn (value: any) => {\n\t\t\treturn check(pd(value[cfg.field]), cfg.value);\n\t\t};\n\t}\n\n\treturn null;\n}\n\nexport function createFilterRule(\n\tfields: IField[],\n\tfilter: TFilterType,\n\tvalue: string\n): IFilterSet {\n\tif (!value) return null;\n\tconst rules: IFilter[] = fields.map(field => {\n\t\treturn {\n\t\t\tfield: field.id,\n\t\t\ttype: field.type || \"text\",\n\t\t\tfilter,\n\t\t\tvalue,\n\t\t};\n\t});\n\n\treturn {\n\t\tglue: \"or\",\n\t\trules,\n\t};\n}\n\nexport function getOptions(\n\tdata: IDataHash<any>[],\n\tfield: string,\n\tcfg?: LocatorConfig\n) {\n\tconst o: Set<any> = new Set();\n\tconst out: any[] = [];\n\tconst locator = cfg && cfg.predicate ? predicates[cfg.predicate] : same;\n\n\tdata.forEach(item => {\n\t\tconst v = locator(item[field]);\n\t\tif (v || v === 0) {\n\t\t\tif (!o.has(v)) {\n\t\t\t\to.add(v);\n\t\t\t\tout.push(v);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (!cfg || cfg.sort !== false) {\n\t\tlet sort;\n\n\t\tif (cfg)\n\t\t\tsort =\n\t\t\t\tcfg.sort ||\n\t\t\t\t(cfg.type === \"date\" || cfg.type === \"number\"\n\t\t\t\t\t? sortNumbers\n\t\t\t\t\t: null);\n\t\telse if (out.length) {\n\t\t\tif (typeof out[0] === \"number\" || out[0] instanceof Date)\n\t\t\t\tsort = sortNumbers;\n\t\t}\n\n\t\tif (typeof sort === \"function\") out.sort(sort);\n\t\telse out.sort();\n\t}\n\n\treturn out;\n}\n\nexport function getOptionsMap(\n\tdata: IDataHash<any>[],\n\tcfg?: Partial<IField>[]\n): OptionsMap {\n\tconst out = {};\n\tif (!cfg && !data.length) return out;\n\n\tif (!cfg) {\n\t\tcfg = [];\n\t\tfor (const key in data[0]) {\n\t\t\tcfg.push({ id: key });\n\t\t}\n\t}\n\n\tcfg.forEach(field => {\n\t\tObject.defineProperty(out, field.id, {\n\t\t\tget: () => getOptions(data, field.id.toString(), field),\n\t\t});\n\t});\n\n\treturn out;\n}\n"],"names":["iid","uid","DataTree","raw","top","items","parent","i","obj","temp","index","insertElement","after","node","indexById","id","a","values","branch","mode","target","now","dropChild","tobj","tLevel","newParent","deleteElement","newIndex","out","kids","toArray","cb","value","key","p","child","root","level","copy","line","newData","item","parentNode","STORE_SET_SILENT","Store","config","data","signals","state","os","ov","nv","fullKey","v","fullKey2","signals2","val","ss","__triggerSync","fn","DataRouter","s","r","b","k","arr","h","_calckSize","cfg","next","parser","updates","ctx","keys","needExec","trgs","sources","prev","sizes","EventBus","name","handler","tag","stack","ev","res","NumberFilters","TextFilters","DateFilters","TupleFilters","filters","label","short","type","toLowerCase","default","valueOf","toString","indexOf","lastIndexOf","length","range","start","end","getFilters","filter","getFilter","matches","f","RulesTree","constructor","parseRules","getRoot","getBranch","parse","prepareData","remove","byId","serialize","serializeBranch","prepareDataInner","forEach","$level","push","rules","glue","map","field","includes","predicate","isValidFilter","validators","isNumber","isDate","isNaN","parseFloat","Date","DataStore","in","_router","w","writable","async","inBus","setState","bind","on","_editor","editor","getState","$temp","onChange","rule","edit","addAfter","_fixRule","exec","add","update","init","normalizeValue","fields","options","normalizeOptions","getValue","fRule","find","same","sortNumbers","predicates","month","getMonth","year","getFullYear","orGroup","andGroup","group","or","and","createArrayFilter","opts","createFilter","orNull","createFilterBlock","pd","check","createFilterRule","getOptions","o","Set","locator","has","sort","getOptionsMap","Object","defineProperty","get"],"mappings":"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","x_google_ignoreList":[0]}