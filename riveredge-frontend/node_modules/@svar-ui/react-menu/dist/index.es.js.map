{"version":3,"file":"index.es.js","sources":["../src/helpers/index.js","../src/components/MenuOption.jsx","../src/components/Menu.jsx","../src/components/ActionMenu.jsx","../src/components/MenuBar.jsx","../src/components/DropDownMenu.jsx","../src/components/ContextMenu.jsx"],"sourcesContent":["export function walkData(data, cb) {\n  data.forEach((a) => {\n    cb(a);\n    if (a.data && a.data.length) walkData(a.data, cb);\n  });\n}\n\nexport function mapData(data, cb) {\n  return data.map((a) => {\n    const out = cb(a);\n    if (a.data && a.data.length) out.data = mapData(a.data, cb);\n    return out;\n  });\n}\n\nexport function filterMenu(data, cb) {\n  const out = [];\n  data.forEach((a) => {\n    if (a.data) {\n      const sub = filterMenu(a.data, cb);\n      if (sub.length) out.push({ ...a, data: sub });\n    } else {\n      if (cb(a)) out.push(a);\n    }\n  });\n\n  return out;\n}\n\nlet uid = 1;\nexport function prepareMenuData(data) {\n  return mapData(data, (a) => {\n    // [deprecated] option.type to be deprecated in 3.0\n    const opt = { ...a, id: a.id || uid++ };\n    if (opt.type) opt.comp = opt.type;\n    return opt;\n  });\n}\n\nconst handlers = {};\nexport function getItemHandler(type) {\n  return handlers[type] || type;\n}\nexport function registerMenuItem(type, handler) {\n  handlers[type] = handler;\n}\n","import { useMemo, useRef, useCallback } from 'react';\nimport { getItemHandler } from '../helpers';\nimport './MenuOption.css';\n\nfunction MenuOption({ onClick, onShow, option }) {\n  const element = useRef(null);\n\n  const onHover = useCallback(() => {\n    onShow(option.data ? option.id : false, element.current);\n  }, [onShow, option]);\n\n  const SubComponent = useMemo(() => {\n    return option && option.comp ? getItemHandler(option.comp) : null;\n  }, [option]);\n\n  return (\n    <div\n      ref={element}\n      className={`wx-cDCz9rZQ wx-option ${option.css || ''} ${option.disabled ? 'wx-disabled' : ''}`}\n      data-id={option.id}\n      onMouseEnter={onHover}\n      onClick={onClick}\n    >\n      {option.icon ? (\n        <i className={`wx-cDCz9rZQ wx-icon ${option.icon}`}></i>\n      ) : null}\n      {option.comp ? (\n        SubComponent ? (\n          <SubComponent item={option} option={option} />\n        ) : null\n      ) : (\n        <span className=\"wx-cDCz9rZQ wx-value\"> {option.text} </span>\n      )}\n      {option.subtext ? (\n        <span className=\"wx-cDCz9rZQ wx-subtext\">{option.subtext}</span>\n      ) : null}\n      {option.data ? (\n        <i className=\"wx-cDCz9rZQ wx-sub-icon wxi-angle-right\"></i>\n      ) : null}\n    </div>\n  );\n}\n\nexport default MenuOption;\n","import {\n  Fragment,\n  useState,\n  useEffect,\n  useMemo,\n  useRef,\n  useCallback,\n} from 'react';\nimport { clickOutside, calculatePosition } from '@svar-ui/lib-dom';\nimport MenuOption from './MenuOption.jsx';\nimport { prepareMenuData } from '../helpers';\nimport './Menu.css';\n\nfunction Menu({\n  options,\n  left = 0,\n  top = 0,\n  at = 'bottom',\n  parent = null,\n  mount = null,\n  context = null,\n  css = '',\n  onClick,\n}) {\n  const [x, setX] = useState(-10000);\n  const [y, setY] = useState(-10000);\n  const [z, setZ] = useState(20);\n  const [width, setWidth] = useState();\n\n  const selfRef = useRef(null);\n  const [showSub, setShowSub] = useState(false);\n  const [activeOption, setActiveOption] = useState(null);\n\n  const updatePosition = useCallback(() => {\n    const result = calculatePosition(selfRef.current, parent, at, left, top);\n    if (result) {\n      setX(result.x);\n      setY(result.y);\n      setZ(result.z);\n      setWidth(result.width);\n    }\n  }, [parent, at, left, top]);\n\n  useEffect(() => {\n    if (mount) mount(updatePosition);\n  }, []);\n\n  const onLeave = useCallback(() => {\n    setShowSub(false);\n  }, []);\n\n  const cancel = useCallback(() => {\n    // [deprecated] action will be deprecated in 3.0\n    onClick && onClick({ action: null, option: null });\n  }, [onClick]);\n\n  const onShow = useCallback((id, el) => {\n    setShowSub(id);\n    setActiveOption(el);\n  }, []);\n\n  const finalOptions = useMemo(() => prepareMenuData(options), [options]);\n\n  useEffect(() => {\n    updatePosition();\n  }, [parent, updatePosition]);\n\n  useEffect(() => {\n    if (!selfRef.current) return;\n    return clickOutside(selfRef.current, { callback: cancel, modal: true })\n      .destroy;\n  }, [cancel]);\n\n  return (\n    <div\n      ref={selfRef}\n      data-wx-menu=\"true\"\n      className={`wx-XMmAGqVx wx-menu ${css}`}\n      style={{\n        position: 'absolute',\n        top: y + 'px',\n        left: x + 'px',\n        width: width,\n        zIndex: z,\n      }}\n      onMouseLeave={onLeave}\n    >\n      {finalOptions.map((option) => (\n        <Fragment key={option.id}>\n          {option.comp === 'separator' ? (\n            <div className=\"wx-XMmAGqVx wx-separator\"></div>\n          ) : (\n            <MenuOption\n              option={option}\n              onShow={onShow}\n              onClick={(ev) => {\n                if (!option.data && !ev.defaultPrevented) {\n                  // [deprecated] action will be deprecated in 3.0\n                  const pack = { context, action: option, option, event: ev };\n                  if (option.handler) option.handler(pack);\n                  onClick && onClick(pack);\n                  ev.stopPropagation();\n                }\n              }}\n            />\n          )}\n          {option.data && showSub === option.id ? (\n            <Menu\n              css={css}\n              options={option.data}\n              at=\"right-overlap\"\n              parent={activeOption}\n              context={context}\n              onClick={onClick}\n            />\n          ) : null}\n        </Fragment>\n      ))}\n    </div>\n  );\n}\n\nexport default Menu;\n","import {\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useState,\n} from 'react';\nimport { Portal } from '@svar-ui/react-core';\nimport { id } from '@svar-ui/lib-dom';\nimport Menu from './Menu.jsx';\nimport { filterMenu } from '../helpers';\n\nconst ActionMenu = forwardRef(function ActionMenu(props, ref) {\n  const {\n    options,\n    at = 'bottom',\n    resolver = null,\n    dataKey = 'contextId',\n    filter = null,\n    css = '',\n    children,\n    onClick,\n  } = props;\n\n  const [item, setItem] = useState(null);\n  const [parent, setParent] = useState(null);\n  const [left, setLeft] = useState(0);\n  const [top, setTop] = useState(0);\n\n  const filteredOptions = useMemo(() => {\n    if (item !== null && filter) {\n      return filterMenu(options, (v) => filter(v, item));\n    }\n    return options;\n  }, [item, filter, options]);\n\n  const handleClick = useCallback(\n    (ev) => {\n      setParent(null);\n      if (onClick) onClick(ev);\n    },\n    [onClick],\n  );\n\n  const getDataAttr = useCallback((node, name) => {\n    let v = null;\n    while (node && node.dataset && !v) {\n      v = node.dataset[name];\n      node = node.parentNode;\n    }\n    return v ? id(v) : null;\n  }, []);\n\n  const show = useCallback(\n    (ev, obj) => {\n      if (!ev) {\n        setParent(null);\n        return;\n      }\n\n      if (ev.defaultPrevented) return;\n\n      const target = ev.target;\n      if (target && target.dataset && target.dataset.menuIgnore) return;\n\n      setLeft(ev.clientX + 1);\n      setTop(ev.clientY + 1);\n\n      let nextItem =\n        typeof obj !== 'undefined' ? obj : getDataAttr(target, dataKey);\n      if (resolver) {\n        nextItem = resolver(nextItem, ev);\n        if (!nextItem) return;\n      }\n\n      setItem(nextItem);\n      setParent(target);\n\n      ev.preventDefault();\n    },\n    [dataKey, getDataAttr, resolver],\n  );\n\n  useImperativeHandle(ref, () => ({ show }), [show]);\n\n  return (\n    <>\n      {children ? (\n        <span onClick={show} data-menu-ignore=\"true\">\n          {typeof children === 'function' ? children() : children}\n        </span>\n      ) : null}\n\n      {parent ? (\n        <Portal>\n          <Menu\n            key={parent}\n            css={css}\n            at={at}\n            top={top}\n            left={left}\n            parent={parent}\n            context={item}\n            onClick={handleClick}\n            options={filteredOptions}\n          />\n        </Portal>\n      ) : null}\n    </>\n  );\n});\n\nexport default ActionMenu;\n","import { useMemo, useState, useRef } from 'react';\nimport ActionMenu from './ActionMenu.jsx';\nimport { prepareMenuData } from '../helpers';\nimport './MenuBar.css';\n\nfunction MenuBar(props) {\n  const { css = '', menuCss = '', options, onClick } = props;\n\n  const finalOptions = useMemo(() => prepareMenuData(options), [options]);\n\n  const [active, setActive] = useState(false);\n  const [menuOptions, setMenuOptions] = useState([]);\n\n  const menu = useRef(null);\n\n  function doClick(ev) {\n    setActive(null);\n    onClick && onClick(ev);\n  }\n\n  function setMenu(ev, option, trigger) {\n    // if the option has a submenu, show it and enable hover mode\n    if (option.data && option.data.length) {\n      if (active && trigger) {\n        // second click on option with submenu disables hover mode\n        setActive(null);\n      } else {\n        setMenuOptions(option.data);\n        setActive(option.id);\n        menu.current.show(ev, option);\n      }\n    } else {\n      // hide the submenu\n      menu.current.show(null);\n      // if it was the click action, dispatch it and end hover mode\n      if (trigger) {\n        // [deprecated] action will be deprecated in 3.0\n        onClick && onClick({ action: option, option });\n        setActive(null);\n      } else {\n        // do not remove active flag, to preserve the hover mode\n        setActive(-1);\n      }\n    }\n  }\n\n  function onHover(ev, option) {\n    if (active) setMenu(ev, option);\n  }\n\n  return (\n    <>\n      <div className={`wx-UfhPCLL4 wx-menubar ${css}`}>\n        {finalOptions.map((option) => (\n          <button\n            key={option.id}\n            className={`wx-UfhPCLL4 wx-option ${active === option.id ? 'wx-active' : ''} ${option.disabled ? 'wx-disabled' : ''}`}\n            onMouseEnter={(ev) => onHover(ev, option)}\n            onClick={(ev) => setMenu(ev, option, true)}\n          >\n            {option.text}\n          </button>\n        ))}\n      </div>\n\n      <ActionMenu\n        css={menuCss}\n        onClick={doClick}\n        options={menuOptions}\n        ref={menu}\n      />\n    </>\n  );\n}\n\nexport default MenuBar;\n","import {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal } from '@svar-ui/react-core';\nimport Menu from './Menu.jsx';\n\nconst DropDownMenu = forwardRef(function DropDownMenu(props, ref) {\n  const { options, at = 'bottom', css = '', children, onClick } = props;\n\n  const [parent, setParent] = useState(null);\n\n  function handleClick(ev) {\n    setParent(null);\n    onClick && onClick(ev);\n  }\n\n  const show = useCallback((ev) => {\n    setParent(ev.target);\n    ev.preventDefault();\n  }, []);\n\n  useImperativeHandle(ref, () => ({ show }), [show]);\n\n  function showAt(ev) {\n    let target = ev.target;\n    while (!target.dataset.menuIgnore) {\n      setParent(target);\n      target = target.parentNode;\n    }\n  }\n\n  const parentKeyRef = useRef(0);\n  const lastParentRef = useRef(parent);\n  useEffect(() => {\n    if (lastParentRef.current !== parent) {\n      parentKeyRef.current += 1;\n      lastParentRef.current = parent;\n    }\n  }, [parent]);\n\n  return (\n    <>\n      <span onClick={showAt} data-menu-ignore=\"true\">\n        {children}\n      </span>\n      {parent ? (\n        <Portal>\n          <Menu\n            key={parentKeyRef.current}\n            css={css}\n            at={at}\n            parent={parent}\n            options={options}\n            onClick={handleClick}\n          />\n        </Portal>\n      ) : null}\n    </>\n  );\n});\n\nexport default DropDownMenu;\n","import { forwardRef, useRef, useCallback, useImperativeHandle } from 'react';\nimport ActionMenu from './ActionMenu.jsx';\n\nconst ContextMenu = forwardRef(function ContextMenu(props, ref) {\n  const {\n    options,\n    at = 'bottom',\n    resolver = null,\n    dataKey = 'contextId',\n    filter = null,\n    css = '',\n    children,\n    onClick,\n  } = props;\n\n  const menu = useRef(null);\n\n  const show = useCallback((ev, obj) => {\n    menu.current.show(ev, obj);\n  }, []);\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      show,\n    }),\n    [show],\n  );\n\n  return (\n    <>\n      {children ? (\n        <span onContextMenu={show} data-menu-ignore=\"true\">\n          {children}\n        </span>\n      ) : null}\n\n      <ActionMenu\n        css={css}\n        at={at}\n        options={options}\n        resolver={resolver}\n        dataKey={dataKey}\n        filter={filter}\n        ref={menu}\n        onClick={onClick}\n      />\n    </>\n  );\n});\n\nexport default ContextMenu;\n"],"names":["mapData","data","cb","a","out","filterMenu","sub","uid","prepareMenuData","opt","handlers","getItemHandler","type","registerMenuItem","handler","MenuOption","onClick","onShow","option","element","useRef","onHover","useCallback","SubComponent","useMemo","jsxs","jsx","Menu","options","left","top","at","parent","mount","context","css","x","setX","useState","y","setY","z","setZ","width","setWidth","selfRef","showSub","setShowSub","activeOption","setActiveOption","updatePosition","result","calculatePosition","useEffect","onLeave","cancel","id","el","finalOptions","clickOutside","Fragment","ev","pack","ActionMenu","forwardRef","props","ref","resolver","dataKey","filter","children","item","setItem","setParent","setLeft","setTop","filteredOptions","v","handleClick","getDataAttr","node","name","show","obj","target","nextItem","useImperativeHandle","Portal","MenuBar","menuCss","active","setActive","menuOptions","setMenuOptions","menu","doClick","setMenu","trigger","DropDownMenu","showAt","parentKeyRef","lastParentRef","ContextMenu"],"mappings":"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"}