"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("react/jsx-runtime"),o=require("react"),Y=require("@svar-ui/react-core"),Ye=require("@svar-ui/grid-locales"),vt=require("@svar-ui/lib-state"),z=require("@svar-ui/grid-store"),L=require("@svar-ui/lib-react"),J=require("@svar-ui/lib-dom"),_e=require("@svar-ui/react-menu"),Rt=require("@svar-ui/react-toolbar"),ee=o.createContext(null);function jt(n,e){const t=new ResizeObserver(l=>{requestAnimationFrame(()=>e(l[0].contentRect))});return t.observe(n.parentNode),{destroy(){t.disconnect()}}}const ot=5,Mt=700;function Et(n){return J.id(n.getAttribute("data-id"))}function $e(n){const e=n.getBoundingClientRect(),t=document.body,l=e.top+t.scrollTop-t.clientTop||0,f=e.left+t.scrollLeft-t.clientLeft||0;return{y:Math.round(l),x:Math.round(f),width:n.offsetWidth,height:n.offsetHeight}}function Xe(n,e){const t=$e(e);return{x:n.clientX-t.x,y:n.clientY-t.y}}function Nt(n,e){const t=e.current;let l=null,f,m,d=!1,C=!1;const u=document.createElement("DIV");u.className="wx-drag-zone",u.setAttribute("tabindex",-1);function x(){clearTimeout(f),f=null}function h(a){const T=J.locate(a);T&&(l={container:u,sourceNode:a.target,from:Et(T),pos:Xe(a,n)},m=l.pos,c(a))}function c(a){if(!l)return;const T=l.pos=Xe(a,n);if(!d){if(!C&&!a?.target?.getAttribute("draggable-data")&&Math.abs(m.x-T.x)<ot&&Math.abs(m.y-T.y)<ot)return;if(M(a)===!1)return R()}if(C){const X=window.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft,G=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop;l.targetNode=document.elementFromPoint(a.pageX-X,a.pageY-G)}else l.targetNode=a.target;t.move&&t.move(a,l),u.style.left=-(l.offset?l.offset.x:0)+"px",u.style.top=l.pos.y+(l.offset?l.offset.y:0)+"px"}function S(a){u.parentNode&&u.parentNode.removeChild(u),u.innerHTML="",d&&t.end&&t.end(a,l),l=m=null,R()}function N(a){t.getReorder&&!t.getReorder()||a.button===0&&(E(a),window.addEventListener("mousemove",v),window.addEventListener("mouseup",i),h(a))}function v(a){c(a)}function i(a){S(a)}function b(a){if(t.getReorder&&!t.getReorder())return;f=setTimeout(()=>{C=!0,h(a.touches[0])},Mt),E(a);function T(){f&&x(),a.target.removeEventListener("touchmove",g),a.target.removeEventListener("touchend",T),S(a)}a.target.addEventListener("touchmove",g),a.target.addEventListener("touchend",T),n.addEventListener("contextmenu",w)}function g(a){d?(a.preventDefault(),c(a.touches[0])):f&&x()}function w(a){if(d||f)return a.preventDefault(),!1}function y(a){a.preventDefault()}function E(a){if(!t.getDraggableInfo)return;const{hasDraggable:T}=t.getDraggableInfo();(!T||a.target.getAttribute("draggable-data"))&&(document.body.style.userSelect="none",document.body.style.webkitUserSelect="none")}function M(a){if(d=!0,t.start){if(t.start(a,l)===!1)return!1;n.appendChild(u),document.body.style.cursor="move"}}function R(a){d=C=!1,document.body.style.cursor="",document.body.style.userSelect="",document.body.style.webkitUserSelect="",window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",i),a&&(n.removeEventListener("mousedown",N),n.removeEventListener("touchstart",b),n.removeEventListener("dragstart",y))}return n.addEventListener("mousedown",N),n.addEventListener("touchstart",b),n.addEventListener("dragstart",y),{destroy(){R(!0)}}}const Dt=.004;function kt(){return{dirX:0,dirY:0,scrollSpeedFactor:1}}function Lt(n,e,t,l){const{node:f,left:m,top:d,bottom:C,sense:u,xScroll:x,yScroll:h}=l,c=Xe(n,f);t.scrollState||(t.scrollState=kt());let S=0,N=0;c.x<m+u?S=-1:c.x>e.width-u&&(S=1),c.y<d+Math.round(u/2)?N=-1:c.y>e.height-C-Math.round(u/2)&&(N=1),(t.scrollState.dirX!==S||t.scrollState.dirY!==N)&&(it(t),t.scrollState.dirX=S,t.scrollState.dirY=N),(x&&t.scrollState.dirX!==0||h&&t.scrollState.dirY!==0)&&Tt(t,l,{x:t.scrollState.dirX,y:t.scrollState.dirY})}function Tt(n,e,t){n.autoScrollTimer||(n.autoScrollTimer=setTimeout(()=>{n.activeAutoScroll=setInterval(Ht,15,n,e,t)},250))}function it(n){n.scrollSpeedFactor=1,n.autoScrollTimer&&(n.autoScrollTimer=clearTimeout(n.autoScrollTimer),n.activeAutoScroll=clearInterval(n.activeAutoScroll))}function Ht(n,e,t){const{x:l,y:f}=t;n.scrollSpeedFactor+=Dt,l!==0&&At(n,e,l),f!==0&&$t(n,e,f)}function $t(n,e,t){const l=e.node.scrollTop;ct(l+Math.round(e.sense/3)*n.scrollSpeedFactor*t,"scrollTop",e)}function At(n,e,t){const l=e.node.scrollLeft;ct(l+Math.round(e.sense/3)*n.scrollSpeedFactor*t,"scrollLeft",e)}function ct(n,e,t){t.node[e]=n}function Ae(n,e,t,l,f,m){const d={};return n&&(d.width=`${n}px`,d.minWidth=`${n}px`),e&&(d.flexGrow=e),m&&(d.height=`${m}px`),t&&(d.position="sticky",t.left&&(d.left=`${l}px`),t.right&&(d.right=`${f}px`)),d}function at(n,e,t){let l="";if(n.fixed)for(const f in n.fixed)l+=n.fixed[f]===-1?"wx-shadow ":"wx-fixed ";return l+=e.rowspan>1?"wx-rowspan ":"",l+=e.colspan>1?"wx-colspan ":"",l+=e.vertical?"wx-vertical ":"",l+=t?t(n)+" ":"",l}function It(n){const{row:e,column:t,cellStyle:l=null,columnStyle:f=null,children:m}=n,[d,C]=L.useWritableProp(n.focusable),u=o.useContext(ee),x=L.useStore(u,"focusCell"),h=L.useStore(u,"search"),c=L.useStore(u,"reorder"),S=o.useMemo(()=>h?.rows[e.id]&&h.rows[e.id][t.id],[h,e.id,t.id]),N=o.useMemo(()=>Ae(t.width,t.flexgrow,t.fixed,t.left,t.right),[t.width,t.flexgrow,t.fixed,t.left,t.right]);function v(R,a){let T="wx-cell";return T+=t.fixed?" "+(t.fixed===-1?"wx-shadow":"wx-fixed"):"",T+=R?" "+R(t):"",T+=a?" "+a(e,t):"",T+=t.treetoggle?" wx-tree-cell":"",T}const i=o.useMemo(()=>v(f,l),[f,l,t,e]),b=o.useMemo(()=>typeof t.draggable=="function"?t.draggable(e,t)!==!1:t.draggable,[t,e]),g=o.useRef(null);o.useEffect(()=>{g.current&&d&&x?.row===e.id&&x?.column===t.id&&g.current.focus()},[x,d,e.id,t.id]);const w=o.useCallback(()=>{d&&!x&&u.exec("focus-cell",{row:e.id,column:t.id,eventSource:"focus"})},[u,d,x,e.id,t.id]);o.useEffect(()=>()=>{d&&x&&(u.exec("focus-cell",{eventSource:"destroy"}),C(!1))},[u,C]);function y(R){const a=new RegExp(`(${h.value.trim()})`,"gi");return String(R).split(a).map(X=>({text:X,highlight:a.test(X)}))}const E=o.useMemo(()=>{const R=t.fixed&&t.fixed.left===-1||t.fixed.right===-1,a=t.fixed&&t.fixed.right;return[i,R?"wx-shadow":"",a?"wx-fixed-right":""].filter(Boolean).join(" ")},[i,t]),M=t.cell;return r.jsxs("div",{className:"wx-TSCaXsGV "+E,ref:g,onFocus:w,style:N,"data-row-id":e.id,"data-col-id":t.id,tabIndex:d?"0":"-1",role:"gridcell","aria-colindex":t._colindex,"aria-readonly":t.editor?void 0:!0,children:[c&&t.draggable?b?r.jsx("i",{"draggable-data":"true",className:"wx-TSCaXsGV wx-draggable wxi-drag"}):r.jsx("i",{className:"wx-TSCaXsGV wx-draggable-stub"}):null,t.treetoggle?r.jsxs(r.Fragment,{children:[r.jsx("span",{style:{marginLeft:`${e.$level*28}px`}}),e.$count?r.jsx("i",{"data-action":"toggle-row",className:`wx-TSCaXsGV wx-table-tree-toggle wxi-menu-${e.open!==!1?"down":"right"}`}):null]}):null,M?r.jsx(M,{api:u,row:e,column:t,onAction:({action:R,data:a})=>u.exec(R,a)}):m?m():S?r.jsx("span",{children:y(z.getRenderValue(e,t)).map(({highlight:R,text:a},T)=>R?r.jsx("mark",{className:"wx-TSCaXsGV wx-search",children:a},T):r.jsx("span",{children:a},T))}):z.getRenderValue(e,t)]})}function st(n,e){let t,l;function f(C){t=C.clientX,n.style.opacity=1,document.body.style.cursor="ew-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",m),window.addEventListener("mouseup",d),e&&e.down&&e.down(n)}function m(C){l=C.clientX-t,e&&e.move&&e.move(l)}function d(){n.style.opacity="",document.body.style.cursor="",document.body.style.userSelect="",e&&e.up&&e.up(l),window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",d)}return n.addEventListener("mousedown",f),{destroy(){n.removeEventListener("mousedown",f)}}}function Vt({filter:n,column:e,action:t,filterValue:l}){function f({value:m}){t({value:m,key:e.id})}return r.jsx(Y.Text,{...n.config??{},value:l,onChange:f})}function zt({filter:n,column:e,action:t,filterValue:l}){const f=o.useContext(ee),m=L.useStore(f,"flatData"),d=o.useMemo(()=>n?.config?.options||e?.options||u(),[n,e,m]),C=o.useMemo(()=>n?.config?.template,[n]);function u(){const c=[];return m.forEach(S=>{const N=z.getValue(S,e);c.includes(N)||c.push(N)}),c.map(S=>({id:S,label:S}))}function x({value:c}){t({value:c,key:e.id})}function h(c){c.key!=="Tab"&&c.preventDefault()}return r.jsx("div",{style:{width:"100%"},onKeyDown:h,children:r.jsx(Y.RichSelect,{placeholder:"",clear:!0,...n?.config??{},options:d,value:l,onChange:x,children:c=>C?C(c):c.label})})}const Ot={text:Vt,richselect:zt};function Pt({filter:n,column:e}){const t=o.useContext(ee),l=L.useStore(t,"filterValues");function f(d){t.exec("filter-rows",d)}const m=o.useMemo(()=>Ot[n.type],[n.type]);return r.jsx(m,{filter:n,column:e,action:f,filterValue:l[e.id]})}function Kt(n){const{cell:e,column:t,row:l,lastRow:f,sortRow:m,columnStyle:d,bodyHeight:C,hasSplit:u}=n,x=o.useContext(ee),h=L.useStore(x,"sortMarks"),c=o.useMemo(()=>h?h[t.id]:void 0,[h,t.id]),S=o.useRef(),N=o.useCallback(k=>{S.current=e.flexgrow?k.parentNode.clientWidth:e.width},[e.flexgrow,e.width]),v=o.useCallback((k,H)=>{x.exec("resize-column",{id:e.id,width:Math.max(1,(S.current||0)+k),inProgress:H})},[x,e.id]),i=o.useCallback(k=>v(k,!0),[v]),b=o.useCallback(k=>v(k,!1),[v]),g=o.useCallback(k=>{if(!t.sort||e.filter)return;let H=c?.order;H&&(H=H==="asc"?"desc":"asc"),x.exec("sort-rows",{key:e.id,add:k.ctrlKey,order:H})},[x,e.id,e.filter,t.sort,c?.order]),w=o.useCallback(k=>{k&&k.stopPropagation(),x.exec("collapse-column",{id:e.id,row:l})},[x,e.id,l]),y=o.useCallback(k=>{k.key==="Enter"&&w()},[w]),E=o.useCallback(k=>{k.key==="Enter"&&!e.filter&&g(k)},[g,e.filter]),M=o.useMemo(()=>e.collapsed&&t.collapsed,[e.collapsed,t.collapsed]),R=o.useMemo(()=>M&&!u&&e.collapsible!=="header",[M,u,e.collapsible]),a=o.useMemo(()=>R?{top:-C/2,position:"absolute"}:{},[R,C]),T=o.useMemo(()=>Ae(e.width,e.flexgrow,t.fixed,t.left,e.right??t.right,e.height+(M&&R?C:0)),[e.width,e.flexgrow,t.fixed,t.left,e.right,t.right,e.height,M,R,C]),X=o.useMemo(()=>at(t,e,d),[t,e,d]),G=o.useCallback(()=>Object.fromEntries(Object.entries(e).filter(([k])=>k!=="cell")),[e]),Q=`wx-cell ${X} ${e.css||""} wx-collapsed`,I=["wx-cell",X,e.css||"",e.filter?"wx-filter":"",t.fixed&&t.fixed.right?"wx-fixed-right":""].filter(Boolean).join(" "),W=o.useRef(null);return o.useEffect(()=>{const k=W.current;if(!k)return;const H=st(k,{down:N,move:i,up:b});return()=>{typeof H=="function"&&H()}},[N,i,b,st]),M?r.jsx("div",{className:"wx-RsQD74qC "+Q,style:T,role:"button","aria-label":`Expand column ${e.text||""}`,"aria-expanded":!e.collapsed,tabIndex:0,onKeyDown:y,onClick:w,"data-header-id":t.id,children:r.jsx("div",{className:"wx-RsQD74qC wx-text",style:a,children:e.text||""})}):r.jsxs("div",{className:"wx-RsQD74qC "+I,style:T,onClick:g,"data-header-id":t.id,tabIndex:!e._hidden&&t.sort&&!e.filter?0:void 0,role:"columnheader","aria-colindex":e._colindex,"aria-colspan":e.colspan>1?e.colspan:void 0,"aria-rowspan":e.rowspan>1?e.rowspan:void 0,"aria-sort":!c?.order||e.filter?"none":c?.order==="asc"?"ascending":"descending",onKeyDown:E,children:[e.collapsible?r.jsx("div",{className:"wx-RsQD74qC wx-collapse",role:"button","aria-label":e.collapsed?"Expand column":"Collapse column","aria-expanded":!e.collapsed,tabIndex:0,onKeyDown:y,onClick:w,children:r.jsx("i",{className:`wx-RsQD74qC wxi-angle-${e.collapsed?"down":"right"}`})}):null,e.cell?(()=>{const k=e.cell;return r.jsx(k,{api:x,cell:G(),column:t,row:l,onAction:({action:H,data:ve})=>x.exec(H,ve)})})():e.filter?r.jsx(Pt,{filter:e.filter,column:t}):r.jsx("div",{className:"wx-RsQD74qC wx-text",children:e.text||""}),t.resize&&f&&!e._hidden?r.jsx("div",{className:"wx-RsQD74qC wx-grip",role:"presentation","aria-label":"Resize column",ref:W,onClick:k=>k.stopPropagation(),children:r.jsx("div",{})}):null,m?r.jsx("div",{className:"wx-RsQD74qC wx-sort",children:c?r.jsxs(r.Fragment,{children:[typeof c.index<"u"?r.jsx("div",{className:"wx-RsQD74qC wx-order",children:c.index+1}):null,r.jsx("i",{className:`wx-RsQD74qC wxi-arrow-${c.order==="asc"?"up":"down"}`})]}):null}):null]})}function Ft({cell:n,column:e,row:t,columnStyle:l}){const f=o.useContext(ee),m=o.useMemo(()=>Ae(n?.width,n?.flexgrow,e?.fixed,e?.left,n?.right??e?.right,n?.height),[n?.width,n?.flexgrow,e?.fixed,e?.left,n?.right,e?.right,n?.height]),d=o.useMemo(()=>at(e,n,l),[e,n,l]),C=o.useCallback(()=>Object.fromEntries(Object.entries(n||{}).filter(([x])=>x!=="cell")),[n]),u=`wx-6Sdi3Dfd wx-cell ${d||""} ${n?.css||""}`+(e?.fixed&&e?.fixed.right?" wx-fixed-right":"");return r.jsx("div",{className:u,style:m,children:!e?.collapsed&&!n?.collapsed?n?.cell?o.createElement(n.cell,{api:f,cell:C(),column:e,row:t,onAction:({action:x,data:h})=>f.exec(x,h)}):r.jsx("div",{className:"wx-6Sdi3Dfd wx-text",children:n?.text||""}):null})}function rt({deltaLeft:n,contentWidth:e,columns:t,type:l="header",columnStyle:f,bodyHeight:m}){const d=o.useContext(ee),C=L.useStore(d,"_sizes"),u=L.useStore(d,"split"),x=o.useMemo(()=>C?.[`${l}RowHeights`],[C,l]),h=o.useMemo(()=>{let i=[];if(t&&t.length){const b=t[0][l].length;for(let g=0;g<b;g++){let w=0;i.push([]),t.forEach((y,E)=>{const M={...y[l][g]};if(w||i[g].push(M),M.colspan>1){if(w=M.colspan-1,!z.isCommunity()&&y.right){let R=y.right;for(let a=1;a<M.colspan;a++)R-=t[E+a].width;M.right=R}}else w&&w--})}}return i},[t,l]),c=o.useMemo(()=>u?.left||u?.right,[u]);function S(i){return t.find(b=>b.id===i)}function N(i,b){let g=b;return i.rowspan&&(g+=i.rowspan-1),g===h.length-1}function v(i,b,g){if(!g.sort)return!1;for(let w=h.length-1;w>=0;w--){const y=g.header[w];if(!y.filter&&!y._hidden)return b===w}return N(i,b)}return r.jsx("div",{className:`wx-sAsPVaUK wx-${l}`,style:{paddingLeft:`${n}px`,width:`${e}px`},role:"rowgroup",children:h.map((i,b)=>r.jsx("div",{className:l==="header"?"wx-sAsPVaUK wx-h-row":"wx-sAsPVaUK wx-f-row",style:{height:`${x?.[b]}px`,display:"flex"},role:"row",children:i.map(g=>{const w=S(g.id);return l==="header"?r.jsx(Kt,{cell:g,columnStyle:f,column:w,row:b,lastRow:N(g,b),bodyHeight:m,sortRow:v(g,b,w),hasSplit:c},g.id):r.jsx(Ft,{cell:g,columnStyle:f,column:S(g.id),row:b},g.id)})},b))})}function Wt({overlay:n}){const e=o.useContext(ee);function t(f){return typeof f=="function"}const l=n;return r.jsx("div",{className:"wx-1ty666CQ wx-overlay",children:t(n)?r.jsx(l,{onAction:({action:f,data:m})=>e.exec(f,m)}):n})}function qt(n){const{actions:e,editor:t}=n,[l,f]=o.useState(t?.value||""),m=o.useRef(null);o.useEffect(()=>{m.current&&m.current.focus()},[]);function d(){m.current&&(f(m.current.value),e.updateValue(m.current.value))}function C({key:u}){u==="Enter"&&e.save()}return r.jsx("input",{className:"wx-e7Ao5ejY wx-text",onInput:d,onKeyDown:C,ref:m,type:"text",value:l})}function _t({actions:n,editor:e,onAction:t}){const[l,f]=o.useState(e?.value),[m,d]=o.useState(e?.renderedValue),[C,u]=o.useState(e?.options||[]),x=o.useMemo(()=>e?.config?.template,[e]),h=o.useMemo(()=>e?.config?.cell,[e]),c=o.useMemo(()=>(C||[]).findIndex(w=>w.id===l),[C,l]),S=o.useRef(null),N=o.useRef(null),v=o.useCallback(w=>{S.current=w.navigate,N.current=w.keydown,S.current(c)},[c,S]),i=o.useCallback(w=>{const y=w?.target?.value??"";d(y);const E=y?(e?.options||[]).filter(M=>(M.label||"").toLowerCase().includes(y.toLowerCase())):e?.options||[];u(E),E.length?S.current(-1/0):S.current(null)},[e]),b=o.useRef(null);o.useEffect(()=>{b.current&&b.current.focus()},[]),o.useEffect(()=>{f(e?.value),d(e?.renderedValue),u(e?.options||[])},[e]);const g=o.useCallback(({id:w})=>{n.updateValue(w),n.save()},[n]);return r.jsxs(r.Fragment,{children:[r.jsx("input",{className:"wx-0UYfSd1x wx-input",ref:b,value:m??"",onChange:i,onKeyDown:w=>N.current?N.current(w,c):void 0}),r.jsx(Y.SuggestDropdown,{items:C,onReady:v,onSelect:g,children:({option:w})=>{if(x)return x(w);if(h){const y=h;return r.jsx(y,{data:w,onAction:t})}else return w.label}})]})}function Xt({actions:n,editor:e,onAction:t}){const[l]=o.useState(()=>e.value||new Date),[f]=o.useState(()=>e.config?.template),[m]=o.useState(()=>e.config?.cell);function d({value:u}){n.updateValue(u),n.save()}const C=o.useRef(null);return o.useEffect(()=>{C.current&&C.current.focus(),typeof window<"u"&&window.getSelection&&window.getSelection().removeAllRanges()},[]),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"wx-lNWNYUb6 wx-value",ref:C,tabIndex:0,onClick:()=>n.cancel(),onKeyDown:u=>u.preventDefault(),children:f?f(l):m?(()=>{const u=m;return r.jsx(u,{data:e.value,onAction:t})})():r.jsx("span",{className:"wx-lNWNYUb6 wx-text",children:e.renderedValue})}),r.jsx(Y.Dropdown,{width:"auto",children:r.jsx(Y.Calendar,{value:l,onChange:d,buttons:e.config?.buttons})})]})}function Yt(n){const{actions:e,editor:t}=n,l=n.onAction??n.onaction,f=t.config||{},[m]=o.useState(t.options.find(i=>i.id===t.value)),[d]=o.useState(t.value),[C]=o.useState(t.options),u=o.useMemo(()=>C.findIndex(i=>i.id===d),[C,d]);function x({id:i}){e.updateValue(i),e.save()}let h;const[c,S]=o.useState();function N(i){h=i.navigate,S(()=>i.keydown),h(u)}const v=o.useRef(null);return o.useEffect(()=>{v.current&&v.current.focus(),typeof window<"u"&&window.getSelection&&window.getSelection().removeAllRanges()},[]),r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:v,className:"wx-ywGRk611 wx-value",tabIndex:0,onClick:()=>e.cancel(),onKeyDown:i=>{c(i,u),i.preventDefault()},children:f.template?f.template(m):f.cell?(()=>{const i=f.cell;return r.jsx(i,{data:m,onAction:l})})():r.jsx("span",{className:"wx-ywGRk611 wx-text",children:t.renderedValue})}),r.jsx(Y.SuggestDropdown,{items:C,onReady:N,onSelect:x,children:({option:i})=>f.template?f.template(i):f.cell?(()=>{const b=f.cell;return r.jsx(b,{data:i,onAction:l})})():i.label})]})}const Bt={text:qt,combo:_t,datepicker:Xt,richselect:Yt};function Gt({column:n,row:e}){const t=o.useContext(ee),l=L.useStore(t,"editor"),f=o.useCallback((v,i)=>{t.exec("close-editor",{ignore:v}),i&&t.exec("focus-cell",{...i,eventSource:"click"})},[t]),m=o.useCallback(v=>{const i=v?null:{row:l?.id,column:l?.column};f(!1,i)},[l,f]),d=o.useCallback(()=>{f(!0,{row:l?.id,column:l?.column})},[l,f]),C=o.useCallback(v=>{t.exec("editor",{value:v})},[t]),u=o.useCallback(v=>{v.key==="Enter"&&l&&d()},[l,d]),x=o.useMemo(()=>Ae(n.width,n.flexgrow,n.fixed,n.left,n.right),[n.width,n.flexgrow,n.fixed,n.left,n.right]),h=o.useMemo(()=>{let v=n.editor;typeof v=="function"&&(v=v(e,n));let i=typeof v=="string"?v:v.type;return Bt[i]},[n,e]),c=o.useRef(null);o.useEffect(()=>{if(!c.current)return;const v=J.clickOutside(c.current,()=>m(!0));return()=>{typeof v=="function"&&v()}},[m]),o.useEffect(()=>{c.current&&typeof x=="string"&&c.current.setAttribute("style",x)},[x]);const S=typeof e.$parent<"u"?"gridcell":"cell",N=typeof e.$parent<"u"?!n.editor:void 0;return r.jsx("div",{className:"wx-8l724t2g wx-cell wx-editor",ref:c,style:typeof x=="object"&&x!==null?x:void 0,role:S,"aria-readonly":N,tabIndex:-1,onClick:v=>v.stopPropagation(),onDoubleClick:v=>v.stopPropagation(),onKeyDown:u,children:h?r.jsx(h,{editor:l,actions:{save:m,cancel:d,updateValue:C},onAction:({action:v,data:i})=>t.exec(v,i)}):null})}function lt(n){const{columns:e,type:t,columnStyle:l}=n,f=o.useContext(ee),{filterValues:m,_columns:d,_sizes:C}=f.getState();function u(x){return l?" "+l(x):""}return r.jsx(r.Fragment,{children:e.map((x,h)=>r.jsx("tr",{children:x.map(c=>{const S=d.find(i=>i.id==c.id),N=`wx-print-cell-${t}${u(S)}${c.filter?" wx-print-cell-filter":""}${c.vertical?" wx-vertical":""}`,v=c.cell;return r.jsx("th",{style:L.styleObject(z.getPrintCellStyle(c,C.columnWidth)),className:"wx-Gy81xq2u "+N,rowSpan:c.rowspan,colSpan:c.colspan,children:v?r.jsx(v,{api:f,cell:Object.fromEntries(Object.entries(c).filter(([i])=>i!=="cell")),column:S,row:h}):c.filter?r.jsx("div",{className:"wx-Gy81xq2u wx-print-filter",children:z.getPrintFilterValue(m,d,c)}):r.jsx("div",{className:"wx-Gy81xq2u wx-text",children:c.text??""})},c.id)})},h))})}function Ut(n){const{columns:e,rowStyle:t,columnStyle:l,cellStyle:f,header:m,footer:d,reorder:C}=n,u=o.useContext(ee),{flatData:x,_sizes:h}=u.getState(),c=m&&z.getHeaderFooterPrintColumns(e,"header",h.headerRowHeights),S=d&&z.getHeaderFooterPrintColumns(e,"footer",h.footerRowHeights);function N(i,b){let g="";return g+=l?" "+l(b):"",g+=f?" "+f(i,b):"",g}function v(i,b){return typeof b.draggable=="function"?b.draggable(i,b)!==!1:b.draggable}return r.jsxs("table",{className:`wx-8NTMLH0z wx-print-grid ${e.some(i=>i.flexgrow)?"wx-flex-columns":""}`,children:[m?r.jsx("thead",{children:r.jsx(lt,{columns:c,type:"header",columnStyle:l})}):null,r.jsx("tbody",{children:x.map((i,b)=>r.jsx("tr",{className:"wx-8NTMLH0z wx-row"+(t?" "+t(i):""),style:{height:`${i.rowHeight||h.rowHeight}px`},children:e.map(g=>g.collapsed?null:r.jsxs("td",{className:`wx-8NTMLH0z wx-print-cell wx-cell ${N(i,g)}`,style:L.styleObject(z.getPrintCellStyle(g,h.columnWidth)),children:[C&&g.draggable?r.jsx("span",{className:"wx-8NTMLH0z wx-print-draggable",children:v(i,g)?r.jsx("i",{className:"wx-8NTMLH0z wxi-drag"}):null}):null,g.treetoggle?r.jsxs(r.Fragment,{children:[r.jsx("span",{style:{marginLeft:i.$level*28+"px"}}),i.$count?r.jsx("i",{className:`wx-8NTMLH0z wx-print-grid-tree-toggle wxi-menu-${i.open!==!1?"down":"right"}`}):null]}):null,g.cell?(()=>{const w=g.cell;return r.jsx(w,{api:u,row:i,column:g})})():r.jsx("span",{children:z.getRenderValue(i,g)})]},g.id))},b))}),d?r.jsx("tfoot",{children:r.jsx(lt,{columns:S,type:"footer",columnStyle:l})}):null]})}function Qt(n){const{config:e,...t}=n,l=o.useContext(ee),{_skin:f,_columns:m}=l.getState(),d=o.useMemo(()=>z.getPrintColumns(m,e),[]),C=o.useRef(null);return o.useEffect(()=>{const u=document.body;u.classList.add("wx-print");const x=C.current;if(!x)return;const h=x.cloneNode(!0);u.appendChild(h);const c=`@media print { @page { size: ${e.paper} ${e.mode}; }`,S=document.createElement("style");S.setAttribute("type","text/css"),S.setAttribute("media","print"),document.getElementsByTagName("head")[0].appendChild(S),S.appendChild(document.createTextNode(c)),window.print(),S.remove(),u.classList.remove("wx-print"),h.remove()},[]),r.jsx("div",{className:`wx-4zwCKA7C wx-${f}-theme wx-print-container`,ref:C,children:d.map((u,x)=>r.jsx("div",{className:"wx-4zwCKA7C wx-print-grid-wrapper",children:r.jsx(Ut,{columns:u,...t})},x))})}function Zt(n){const{header:e,footer:t,overlay:l,multiselect:f,onreorder:m,rowStyle:d,columnStyle:C,cellStyle:u,autoRowHeight:x,resize:h,clientWidth:c,clientHeight:S,responsiveLevel:N,hotkeys:v}=n,i=o.useContext(ee),b=L.useStore(i,"dynamic"),g=L.useStore(i,"_columns"),w=L.useStore(i,"flatData"),y=L.useStore(i,"split"),E=L.useStore(i,"_sizes"),[M,R]=L.useStoreWithCounter(i,"selectedRows"),a=L.useStore(i,"select"),T=L.useStore(i,"editor"),X=L.useStore(i,"tree"),G=L.useStore(i,"focusCell"),Q=L.useStore(i,"_print"),I=L.useStore(i,"undo"),W=L.useStore(i,"reorder"),k=L.useStore(i,"_rowHeightFromData"),[H,ve]=o.useState(0);o.useEffect(()=>{ve(mt())},[]);const[pe,Ie]=o.useState(0),[ue,Re]=o.useState(0),re=o.useMemo(()=>(g||[]).some(s=>!s.hidden&&s.flexgrow),[g]),O=o.useMemo(()=>E?.rowHeight||0,[E]),U=o.useRef(null),[je,we]=o.useState(null),[de,me]=o.useState(null),Z=o.useMemo(()=>{let s=[],p=0;return y&&y.left&&(s=(g||[]).slice(0,y.left).filter(j=>!j.hidden).map(j=>({...j})),s.forEach(j=>{j.fixed={left:1},j.left=p,p+=j.width}),s.length&&(s[s.length-1].fixed={left:-1})),{columns:s,width:p}},[y,g]),P=o.useMemo(()=>{let s=[],p=0;if(y&&y.right){s=(g||[]).slice(y.right*-1).filter(j=>!j.hidden).map(j=>({...j}));for(let j=s.length-1;j>=0;j--){const $=s[j];$.fixed={right:1},$.right=p,p+=$.width}s.length&&(s[0].fixed={right:-1})}return{columns:s,width:p}},[y,g]),q=o.useMemo(()=>{const s=(g||[]).slice(y?.left||0,(g||[]).length-(y?.right??0)).filter(p=>!p.hidden);return s.forEach(p=>{p.fixed=0}),s},[g,y]),V=o.useMemo(()=>(g||[]).reduce((s,p)=>(p.hidden||(s+=p.width),s),0),[g]),le=1;function Ne(s,p,j){let $=p,K=s;if(q.length){let A=q.length;for(let D=s;D>=0;D--)q[D][j].forEach(B=>{B.colspan>1&&D>s-B.colspan&&D<A&&(A=D)});if(A!==q.length&&A<s){for(let D=A;D<s;D++)$-=q[D].width;K=A}}return{index:K,delta:$}}const te=o.useMemo(()=>{let s,p,j;const $=pe,K=pe+(c||0);let A=0,D=0,F=0,B=0;q.forEach((ae,Se)=>{$>F&&(A=Se,B=F),F=F+ae.width,K>F&&(D=Se+le)});const se={header:0,footer:0};for(let ae=D;ae>=A;ae--)["header","footer"].forEach(Se=>{q[ae]&&q[ae][Se].forEach(St=>{const qe=St.colspan;if(qe&&qe>1){const nt=qe-(D-ae+1);nt>0&&(se[Se]=Math.max(se[Se],nt))}})});const _=Ne(A,B,"header"),oe=Ne(A,B,"footer"),We=_.delta,Ee=_.index,Te=oe.delta,He=oe.index;return re&&V>(c||0)?s=p=j=[...Z.columns,...q,...P.columns]:(s=[...Z.columns,...q.slice(A,D+1),...P.columns],p=[...Z.columns,...q.slice(Ee,D+se.header+1),...P.columns],j=[...Z.columns,...q.slice(He,D+se.footer+1),...P.columns]),{data:s||[],header:p||[],footer:j||[],d:B,df:Te,dh:We}},[q,Z,P,pe,c,re,V]),xe=o.useMemo(()=>e&&E?.headerHeight||0,[e,E]),he=o.useMemo(()=>t&&E?.footerHeight||0,[t,E]),fe=o.useMemo(()=>c&&S?V>=c:!1,[c,S,V]),be=o.useMemo(()=>(S||0)-xe-he-(fe?H:0),[S,xe,he,fe,H]),Be=o.useMemo(()=>Math.ceil((be||0)/(O||1))+1,[be,O]),Ve=o.useRef([]),[Ge,ut]=o.useState(0),[Ue,dt]=o.useState(void 0),ne=o.useMemo(()=>{let s=0,p=0;const j=2;if(x){let A=ue;for(;A>0;)A-=Ve.current[s]||O,s++;p=ue-A;for(let D=Math.max(0,s-j-1);D<s;D++)p-=Ve.current[s-D]||O;s=Math.max(0,s-j)}else{if(k){let A=0,D=0;for(let _=0;_<(w||[]).length;_++){const oe=w[_].rowHeight||O;if(D+oe>ue){A=_;break}D+=oe}s=Math.max(0,A-j);for(let _=0;_<s;_++)p+=w[_].rowHeight||O;let F=0,B=0;for(let _=A+1;_<(w||[]).length;_++){const oe=w[_].rowHeight||O;if(F++,B+oe>be)break;B+=oe}const se=Math.min(b?b.rowCount:(w||[]).length,A+F+j);return{d:p,start:s,end:se}}s=Math.floor(ue/(O||1)),s=Math.max(0,s-j),p=s*(O||0)}const $=b?b.rowCount:(w||[]).length,K=Math.min($,s+(Be||0)+j);return{d:p,start:s,end:K}},[x,k,ue,O,b,w,Be,be]),ze=o.useMemo(()=>{const s=b?b.rowCount:(w||[]).length;if(x)return Ge+ne.d+(s-(Ue||0))*(O||0);if(!k)return s*(O||0);let p=0;for(let j=0;j<s;j++)p+=w[j]?.rowHeight||O;return p},[b,w,O,x,k,Ge,ne.d,Ue]),ie=o.useMemo(()=>c&&S?ze+xe+he>=S-(V>=(c||0)?H:0):!1,[c,S,ze,xe,he,V,H]),ge=o.useMemo(()=>re&&V<=(c||0)?(c||0)-0-(ie?H:0):V,[re,V,c,ie,H,fe]),Oe=o.useMemo(()=>re&&V<=(c||0)?c||0:ge<(c||0)?V+(ie?H:0):-1,[re,V,c,ge,ie,H]),Pe=o.useRef({});o.useEffect(()=>{if(b&&(Pe.current.start!==ne.start||Pe.current.end!==ne.end)){const{start:s,end:p}=ne;Pe.current={start:s,end:p},i&&i.exec&&i.exec("request-data",{row:{start:s,end:p}})}},[b,ne,i]);const ce=o.useMemo(()=>b?w||[]:(w||[]).slice(ne.start,ne.end),[b,w,ne]),Me=o.useMemo(()=>(M||[]).filter(s=>(ce||[]).some(p=>p.id===s)),[R,ce]),Ke=o.useMemo(()=>ne.start,[ne.start]),ft=o.useCallback(s=>{Re(s.target.scrollTop),Ie(s.target.scrollLeft)},[]),xt=o.useCallback(s=>{s.shiftKey&&s.preventDefault(),U.current&&U.current.focus&&U.current.focus()},[]),Qe=o.useCallback(()=>!!(g||[]).find(s=>!!s.draggable),[g]),Fe=o.useRef(null),ye=o.useRef(null),ht=o.useRef({dblclick:(s,p)=>{const j={id:s,column:J.locateAttr(p,"data-col-id")};i.exec("open-editor",j)},click:(s,p)=>{if(Fe.current)return;const j=J.locateAttr(p,"data-col-id");if(G?.id!==s&&i.exec("focus-cell",{row:s,column:j,eventSource:"click"}),a===!1)return;const $=f&&p.ctrlKey,K=f&&p.shiftKey;($||M.length>1||!M.includes(s))&&i.exec("select-row",{id:s,toggle:$,range:K})},"toggle-row":s=>{const p=i.getRow(s);i.exec(p.open!==!1?"close-row":"open-row",{id:s})},"ignore-click":()=>!1}),De=o.useMemo(()=>({top:xe,bottom:he,left:Z.width,xScroll:fe,yScroll:ie,sense:x&&de?de.offsetHeight:Math.max(E?.rowHeight||0,40),node:U.current&&U.current.firstElementChild}),[xe,he,Z.width,fe,ie,x,de,E]);function gt(s,p){const{container:j,sourceNode:$,from:K}=p;if(Qe()&&!$.getAttribute("draggable-data"))return!1;we(K),i.getRow(K).open&&i.exec("close-row",{id:K,nested:!0});const D=J.locate($,"data-id"),F=D.cloneNode(!0);F.classList.remove("wx-selected"),F.querySelectorAll("[tabindex]").forEach(oe=>oe.setAttribute("tabindex","-1")),j.appendChild(F),me(F);const B=pe-te.d,se=ie?H:0;j.style.width=Math.min((c||0)-se,re&&V<=(c||0)?ge:ge-se)+B+"px";const _=$e(D);p.offset={x:B,y:-Math.round(_.height/2)},ye.current||(ye.current=s.clientY)}function pt(s,p){const{from:j}=p,$=p.pos,K=$e(U.current);$.x=K.x;const A=De.top;if($.y<A)$.y=A;else{const D=K.height-(fe&&H>0?H:Math.round(De.sense/2))-De.bottom;$.y>D&&($.y=D)}if(U.current.contains(p.targetNode)){const D=J.locate(p.targetNode,"data-id"),F=J.id(D?.getAttribute("data-id"));if(F&&F!==j){p.to=F;const B=x?de?.offsetHeight:E?.rowHeight;if(de&&(ue===0||$.y>A+B-1)){const se=D.getBoundingClientRect(),oe=$e(de).y,We=se.y,Ee=oe>We?-1:1,Te=Ee===1?"after":"before",He=Math.abs(i.getRowIndex(j)-i.getRowIndex(F)),ae=He!==1?Te==="before"?"after":"before":Te;if(He===1&&(Ee===-1&&s.clientY>ye.current||Ee===1&&s.clientY<ye.current))return;ye.current=s.clientY,i.exec("move-item",{id:j,target:F,mode:ae,inProgress:!0})}}m&&m({event:s,context:p})}Lt(s,K,p,De)}function wt(s,p){const{from:j,to:$}=p;i.exec("move-item",{id:j,target:$,inProgress:!1}),Fe.current=setTimeout(()=>{Fe.current=0},1),we(null),me(null),ye.current=null,it(p)}function mt(){const s=document.createElement("div");s.style.cssText="position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;",document.body.appendChild(s);const p=s.offsetWidth-s.clientWidth;return document.body.removeChild(s),p}const bt=o.useMemo(()=>Oe>0?{width:`${Oe}px`}:void 0,[Oe]),Ze=o.useRef(null);function yt(){Promise.resolve().then(()=>{let s=0,p=Ke;const j=Ze.current;j&&(Array.from(j.children).forEach(($,K)=>{Ve.current[Ke+K]=$.offsetHeight,s+=$.offsetHeight,p++}),ut(s),dt(p))})}o.useEffect(()=>{ce&&x&&yt()},[ce,x,Ke]);let[Ce,ke]=o.useState();o.useEffect(()=>{if(G&&(!a||!Me.length||Me.includes(G.row)))ke({...G});else if(ce.length&&te.data.length){if(!Ce||Me.length&&!Me.includes(Ce.row)||ce.findIndex(s=>s.id==Ce.row)===-1||te.data.findIndex(s=>s.id==Ce.column&&!s.collapsed)===-1){const s=Me[0]||ce[0].id,p=te.data.findIndex(j=>!j.collapsed);ke(p!==-1?{row:s,column:te.data[p].id}:null)}}else ke(null)},[G]);const Je=o.useRef(null);o.useEffect(()=>{const s=U.current;if(!s)return;const p=jt(s,h);return()=>{typeof p=="function"&&p()}},[h]);const et=o.useRef({});Object.assign(et.current,{start:gt,move:pt,end:wt,getReorder:()=>W,getDraggableInfo:()=>({hasDraggable:Qe()})}),o.useEffect(()=>{const s=U.current;return s?Nt(s,et).destroy:void 0},[W,U.current]),o.useEffect(()=>{const s=U.current;return s?z.hotkeys(s,{keys:v!==!1&&{...z.defaultHotkeys,"ctrl+z":I,"ctrl+y":I,...v},exec:j=>i.exec("hotkey",j)}).destroy:void 0},[i,I,v]);const Le=o.useRef({scroll:i.getReactiveState().scroll});Le.current.getWidth=()=>(c||0)-(ie?H:0),Le.current.getHeight=()=>be,Le.current.getScrollMargin=()=>Z.width+P.width,o.useEffect(()=>{z.scrollTo(Je.current,Le.current)},[]);const tt=o.useRef(null);o.useEffect(()=>{const s=tt.current;if(!s)return;const p=[];return p.push(J.clickOutside(s,()=>i.exec("focus-cell",{eventSource:"click"})).destroy),p.push(L.delegateClick(s,ht.current)),()=>p.forEach(j=>j())},[]);const Ct=`wx-grid ${N?`wx-responsive-${N}`:""}`;return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"wx-4VuBwK2D "+Ct,style:{"--header-height":`${xe}px`,"--footer-height":`${he}px`,"--split-left-width":`${Z.width}px`,"--split-right-width":`${P.width}px`},children:r.jsx("div",{ref:U,className:"wx-4VuBwK2D wx-table-box",style:bt,role:X?"treegrid":"grid","aria-colcount":te.data.length,"aria-rowcount":ce.length,"aria-multiselectable":X&&f?!0:void 0,tabIndex:-1,children:r.jsxs("div",{ref:Je,className:"wx-4VuBwK2D wx-scroll",style:{overflowX:fe?"scroll":"hidden",overflowY:ie?"scroll":"hidden"},onScroll:ft,children:[e?r.jsx("div",{className:"wx-4VuBwK2D wx-header-wrapper",children:r.jsx(rt,{contentWidth:ge,deltaLeft:te.dh,columns:te.header,columnStyle:C,bodyHeight:be-+t})}):null,r.jsxs("div",{ref:tt,className:"wx-4VuBwK2D wx-body",style:{width:`${ge}px`,height:`${ze}px`},onMouseDown:s=>xt(s),children:[l?r.jsx(Wt,{overlay:l}):null,r.jsx("div",{ref:Ze,className:"wx-4VuBwK2D wx-data",style:{paddingTop:`${ne.d}px`,paddingLeft:`${te.d}px`},children:ce.map((s,p)=>{const j=M.indexOf(s.id)!==-1,$=je===s.id,K="wx-row"+(x?" wx-autoheight":"")+(d?" "+d(s):"")+(j?" wx-selected":"")+($?" wx-inactive":""),A=x?{minHeight:`${s.rowHeight||O}px`}:{height:`${s.rowHeight||O}px`};return r.jsx("div",{className:"wx-4VuBwK2D "+K,"data-id":s.id,"data-context-id":s.id,style:A,role:"row","aria-rowindex":p,"aria-expanded":s.open,"aria-level":X?s.$level+1:void 0,"aria-selected":X?j:void 0,tabIndex:-1,children:te.data.map(D=>D.collapsed?r.jsx("div",{className:"wx-4VuBwK2D wx-cell wx-collapsed"},D.id):T?.id===s.id&&T.column==D.id?r.jsx(Gt,{row:s,column:D},D.id):r.jsx(It,{row:s,column:D,columnStyle:C,cellStyle:u,reorder:W,focusable:Ce?.row===s.id&&Ce?.column==D.id},D.id))},s.id)})})]}),t&&(w||[]).length?r.jsx(rt,{type:"footer",contentWidth:ge,deltaLeft:te.df,columns:te.footer,columnStyle:C}):null]})})}),Q?r.jsx(Qt,{config:Q,rowStyle:d,columnStyle:C,cellStyle:u,header:e,footer:t,reorder:W}):null]})}const Jt=n=>n.split("-").map(e=>e?e.charAt(0).toUpperCase()+e.slice(1):"").join(""),en=o.forwardRef(function({data:e=[],columns:t=[],rowStyle:l=null,columnStyle:f=null,cellStyle:m=null,selectedRows:d,select:C=!0,multiselect:u=!1,header:x=!0,footer:h=!1,dynamic:c=null,overlay:S=null,reorder:N=!1,onReorder:v=null,autoRowHeight:i=!1,sizes:b,split:g,tree:w=!1,autoConfig:y=!1,init:E=null,responsive:M=null,sortMarks:R,undo:a=!1,hotkeys:T=null,...X},G){const Q=o.useRef();Q.current=X;const I=o.useMemo(()=>new z.DataStore(L.writable),[]),W=o.useMemo(()=>I.in,[I]),k=o.useRef(null);k.current===null&&(k.current=new vt.EventBusRouter((P,q)=>{const V="on"+Jt(P);Q.current&&Q.current[V]&&Q.current[V](q)}),W.setNext(k.current));const H=o.useMemo(()=>({getState:I.getState.bind(I),getReactiveState:I.getReactive.bind(I),getStores:()=>({data:I}),exec:W.exec,setNext:P=>(k.current=k.current.setNext(P),k.current),intercept:W.intercept.bind(W),on:W.on.bind(W),detach:W.detach.bind(W),getRow:I.getRow.bind(I),getRowIndex:I.getRowIndex.bind(I),getColumn:I.getColumn.bind(I)}),[I,W]),[ve,pe]=o.useState(0),[Ie,ue]=o.useState(0),[Re,re]=o.useState(null),[O,U]=o.useState(null),je=o.useMemo(()=>{if(y&&!t.length&&e.length){const P=e[0],q=[];for(let V in P)if(V!=="id"&&V[0]!=="$"){let le={id:V,header:V[0].toUpperCase()+V.slice(1)};typeof y=="object"&&(le={...le,...y}),q.push(le)}return q}return(O&&O.columns)??t},[y,t,e,O]),we=o.useMemo(()=>(O&&O.sizes)??b,[O,b]),de=o.useCallback(P=>{if(pe(P.width),ue(P.height),M){const V=Object.keys(M).map(Number).sort((le,Ne)=>le-Ne).find(le=>P.width<=le)??null;V!==Re&&(U(M[V]),re(V))}},[M,Re]),me=o.useContext(Y.context.theme),Z=o.useRef(0);return o.useEffect(()=>{if(!Z.current)E&&E(H);else{const P=I.getState();I.init({data:e,columns:je,split:g||P.split,sizes:we||P.sizes,selectedRows:d||P.selectedRows,dynamic:c,tree:w,sortMarks:R||P.sortMarks,undo:a,reorder:N,_skin:me,_select:C})}Z.current++},[I,e,je,g,we,d,c,w,R,a,N,me,C,E,H]),Z.current===0&&I.init({data:e,columns:je,split:g||{left:0},sizes:we||{},selectedRows:d||[],dynamic:c,tree:w,sortMarks:R||{},undo:a,reorder:N,_skin:me,select:C}),o.useImperativeHandle(G,()=>({...H}),[H]),r.jsx(ee.Provider,{value:H,children:r.jsx(Y.Locale,{words:Ye.en,optional:!0,children:r.jsx(Zt,{header:x,footer:h,overlay:S,rowStyle:l,columnStyle:f,cellStyle:m,onReorder:v,multiselect:u,autoRowHeight:i,clientWidth:ve,clientHeight:Ie,responsiveLevel:Re,resize:de,hotkeys:T})})})});function tn({item:n}){return r.jsxs("div",{tabIndex:-1,role:"menuitem","aria-label":n.hidden?`Show ${n.text} column`:`Hide ${n.text} column`,children:[r.jsx("div",{className:"wx-v13lZxja wx-icon"+(n.hidden?" wx-hidden":""),children:r.jsx("i",{className:"wx-v13lZxja wxi-eye"})}),r.jsx("span",{children:n.text})]})}function nn({columns:n=null,api:e,children:t}){o.useEffect(()=>{_e.registerMenuItem("table-header",tn)},[]);function l(u){for(let x=u.header.length-1;x>=0;x--){const h=u.header[x].text;if(h)return h}return u.id}function f(u){const x=u.action;x&&e.exec("hide-column",{id:x.id,mode:!x.hidden})}function m(u){return u}const d=L.useStoreLater(e,"_columns"),C=o.useMemo(()=>{if(e){const u=Array.isArray(d)?d:[];return(n?u.filter(h=>n[h.id]):u).map(h=>{const c=l(h);return{id:h.id,text:c,type:"table-header",hidden:h.hidden}})}else return[]},[e,n,d]);return r.jsx(_e.ContextMenu,{dataKey:"headerId",options:C,onClick:f,at:"point",resolver:m,children:typeof t=="function"?t():t})}function on(n){const{content:e=null,api:t,children:l}=n,f=o.useRef(null),m=o.useRef(null),[d,C]=o.useState(),[u,x]=o.useState(),[h,c]=o.useState();function S(y){for(;y;){if(y.getAttribute){const E=y.getAttribute("data-row-id"),M=y.getAttribute("data-col-id");if(E&&t&&M){const R=t.getColumn(M);return{id:E,col:R,target:y}}}y=y.parentNode}return{id:null,col:null,target:null}}o.useEffect(()=>{const y=m.current;if(y&&d&&h){let E=y.getBoundingClientRect(),M=h.left,R=h.top;E.right>=d.right&&(M=d.width-E.width-5),E.bottom>=d.bottom&&(R=h.top-(E.bottom-d.bottom+2)),(M!==h.left||R!==h.top)&&c({...h,left:M,top:R})}},[d,h]);const N=o.useRef(),v=300,i=y=>{clearTimeout(N.current),N.current=setTimeout(()=>{y()},v)};function b(y){const{id:E,target:M,col:R}=S(y.target);if(c(null),!E){clearTimeout(N.current);return}const a=y.clientX;i(()=>{let T="";if(E){const k=g(E);x(k),T=w(R,k)}const X=M.getBoundingClientRect(),G=f.current;if(!G)return;const Q=G.getBoundingClientRect();C(Q);const I=X.top+X.height-Q.top,W=a-Q.left;c({top:I,left:W,col:R,text:T})})}function g(y){return t.getRow(y)}function w(y,E){return E=E||u,typeof y.tooltip=="function"?y.tooltip(E):z.getRenderValue(E,y)||""}return r.jsxs("div",{className:"wx-RYccULtD wx-area",ref:f,onMouseMove:b,children:[h&&h.col.tooltip!==!1&&(e||h.text)?r.jsx("div",{className:"wx-RYccULtD tooltip",role:"alert",tabIndex:0,ref:m,style:{top:h.top+"px",left:h.left+"px"},children:e?r.jsx(e,{data:u}):h.text}):null,l]})}function sn({api:n,options:e=[...z.defaultMenuOptions],at:t="point",resolver:l,dataKey:f,filter:m,css:d,children:C,handler:u,onClick:x}){const h=o.useContext(Y.context.i18n),c=o.useMemo(()=>h?h.getGroup("grid"):J.locale(Ye.en).getGroup("grid"),[h]),S=L.useStoreLater(n,"selectedRows"),N=L.useStoreLater(n,"data"),v=L.useStoreLater(n,"reorder"),i=o.useMemo(()=>{const R=E(e),a=z.assignChecks(R);return b(a),a},[e,v,N]);function b(R){R.forEach(a=>{a.text&&(a.text=c(a.text)),a.subtext&&(a.subtext=c(a.subtext)),a.data&&(a.data=b(a.data))})}const g=o.useMemo(()=>{const R=[];return i.forEach(a=>{switch(a.id){case"move-item:up":case"move-item:down":case"paste-row":{if(!a.isDisabled||!n){R.push(a);return}const T=a.isDisabled(a.id==="paste-row"?n:S,N);R.push({...a,disabled:T});break}default:{R.push(a);break}}}),R},[i,S,N,n]);function w(R){return S.includes(R)||n.exec("select-row",{id:R}),R}const y=R=>{const a=R.action;a&&z.handleAction(n,a.id),x&&x(R)};function E(R){return v?R:R.filter(({id:a})=>!(a==="move-item:up"||a==="move-item:down"))}const M=l!==void 0?l:w;return r.jsx(_e.ContextMenu,{css:`wx-KKGLK8TH wx-table-menu ${d}`,at:t,dataKey:f,handler:u,options:g,resolver:M,filter:m,onClick:y,children:C})}function rn({api:n,items:e=[...z.defaultToolbarButtons],onClick:t,...l}){const m=o.useContext(Y.context.i18n)?.getGroup("grid")||J.locale(Ye.en).getGroup("grid"),d=L.useStoreLater(n,"selectedRows"),C=L.useStoreLater(n,"data"),u=L.useStoreLater(n,"history"),x=L.useStoreLater(n,"reorder"),h=L.useStoreLater(n,"undo"),c=["open-editor","delete-row","copy-row","cut-row","paste-row","move-item:up","move-item:down"],S=["undo","redo"],N=o.useMemo(()=>{const b=w(e),g=z.assignChecks(b);return y(g),g;function w(E){return h&&x?E:E.filter(({id:M})=>!(!h&&(M==="undo"||M==="redo")||!x&&(M==="move-item:up"||M==="move-item:down")))}function y(E){E.forEach(M=>{M.text&&(M.text=m(M.text)),M.menuText&&(M.menuText=m(M.menuText)),M.items&&(M.items=y(M.items))})}},[e,h,x,m]),v=o.useMemo(()=>{const b=[],g=d?.length;return N.forEach(w=>{const y=w.id;if(y==="add-row")b.push(w);else if(c.includes(y)){if(!g)return;b.push({...w,disabled:w.isDisabled&&w.isDisabled(y==="paste-row"?n:d,C)})}else S.includes(y)?b.push({...w,disabled:w.isDisabled(u)}):b.push(w)}),b},[N,d,C,u,n,c,S]),i=b=>{const g=b.item;g&&z.handleAction(n,g.id),t&&t(b)};return r.jsx(Rt.Toolbar,{items:v,onClick:i,...l})}function ln({fonts:n=!0,children:e}){return e?r.jsx(Y.Material,{fonts:n,children:e}):r.jsx(Y.Material,{fonts:n})}function cn({fonts:n=!0,children:e}){return e?r.jsx(Y.Willow,{fonts:n,children:e}):r.jsx(Y.Willow,{fonts:n})}function an({fonts:n=!0,children:e}){return e?r.jsx(Y.WillowDark,{fonts:n,children:e}):r.jsx(Y.WillowDark,{fonts:n})}J.setEnv(J.env);Object.defineProperty(exports,"defaultMenuOptions",{enumerable:!0,get:()=>z.defaultMenuOptions});Object.defineProperty(exports,"defaultToolbarButtons",{enumerable:!0,get:()=>z.defaultToolbarButtons});Object.defineProperty(exports,"getEditorConfig",{enumerable:!0,get:()=>z.getEditorConfig});exports.ContextMenu=sn;exports.Grid=en;exports.HeaderMenu=nn;exports.Material=ln;exports.Toolbar=rn;exports.Tooltip=on;exports.Willow=cn;exports.WillowDark=an;
//# sourceMappingURL=index.cjs.map
