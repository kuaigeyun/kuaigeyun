(function(_0x50c129,_0x55a3e5){const _0x4c34c4=_0x1da9,_0x4591c4=_0x50c129();while(!![]){try{const _0x1623e6=-parseInt(_0x4c34c4(0x12f))/0x1*(parseInt(_0x4c34c4(0x1b0))/0x2)+-parseInt(_0x4c34c4(0xf7))/0x3*(-parseInt(_0x4c34c4(0x188))/0x4)+-parseInt(_0x4c34c4(0x1c3))/0x5*(-parseInt(_0x4c34c4(0x145))/0x6)+-parseInt(_0x4c34c4(0x1b9))/0x7+-parseInt(_0x4c34c4(0x1bb))/0x8+-parseInt(_0x4c34c4(0x14e))/0x9*(parseInt(_0x4c34c4(0x11b))/0xa)+parseInt(_0x4c34c4(0x165))/0xb;if(_0x1623e6===_0x55a3e5)break;else _0x4591c4['push'](_0x4591c4['shift']());}catch(_0x2f3fba){_0x4591c4['push'](_0x4591c4['shift']());}}}(_0x1564,0xe66e7),function(_0xd39d41,_0x3194fa){const _0x37a205=_0x1da9;typeof exports==_0x37a205(0x109)&&typeof module<'u'?_0x3194fa(exports,require('@univerjs/core'),require('@univerjs-pro/collaboration'),require('@univerjs-pro/collaboration-client'),require('@univerjs/design'),require('react'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/sheets'),require('@univerjs-pro/edit-history-viewer'),require('@univerjs-pro/license'),require('@univerjs-pro/sheets-chart'),require('@univerjs-pro/sheets-chart-ui'),require('@univerjs-pro/sheets-pivot'),require('@univerjs-pro/sheets-sparkline'),require('@univerjs-pro/sheets-sparkline-ui'),require('@univerjs/data-validation'),require('@univerjs/docs'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs/drawing-ui'),require('@univerjs/engine-formula'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/rpc'),require('@univerjs/sheets-conditional-formatting'),require('@univerjs/sheets-conditional-formatting-ui'),require('@univerjs/sheets-data-validation'),require('@univerjs/sheets-data-validation-ui'),require('@univerjs/sheets-drawing'),require('@univerjs/sheets-drawing-ui'),require('@univerjs/sheets-filter'),require('@univerjs/sheets-filter-ui'),require('@univerjs/sheets-formula'),require('@univerjs/sheets-formula-ui'),require('@univerjs/sheets-hyper-link'),require('@univerjs/sheets-hyper-link-ui'),require('@univerjs/sheets-numfmt'),require('@univerjs/sheets-ui')):typeof define==_0x37a205(0x1c5)&&define[_0x37a205(0x196)]?define([_0x37a205(0x1ea),'@univerjs/core',_0x37a205(0xf5),_0x37a205(0x102),'@univerjs/design',_0x37a205(0x19b),'@univerjs/ui',_0x37a205(0x204),_0x37a205(0x211),'@univerjs-pro/edit-history-viewer','@univerjs-pro/license',_0x37a205(0x125),'@univerjs-pro/sheets-chart-ui','@univerjs-pro/sheets-pivot',_0x37a205(0x1fe),_0x37a205(0x172),_0x37a205(0x139),_0x37a205(0x148),'@univerjs/docs-ui','@univerjs/drawing',_0x37a205(0x192),_0x37a205(0x110),_0x37a205(0x138),_0x37a205(0xfb),'@univerjs/rpc',_0x37a205(0x115),_0x37a205(0x137),_0x37a205(0x107),_0x37a205(0x1cd),_0x37a205(0x1a1),_0x37a205(0x14a),_0x37a205(0x1a9),'@univerjs/sheets-filter-ui',_0x37a205(0x1d0),_0x37a205(0x1c0),'@univerjs/sheets-hyper-link','@univerjs/sheets-hyper-link-ui','@univerjs/sheets-numfmt',_0x37a205(0x133)],_0x3194fa):(_0xd39d41=typeof globalThis<'u'?globalThis:_0xd39d41||self,_0x3194fa(_0xd39d41[_0x37a205(0x1cf)]={},_0xd39d41[_0x37a205(0x1f7)],_0xd39d41[_0x37a205(0x1c8)],_0xd39d41['UniverProCollaborationClient'],_0xd39d41['UniverDesign'],_0xd39d41[_0x37a205(0xfd)],_0xd39d41[_0x37a205(0x1e6)],_0xd39d41[_0x37a205(0x204)],_0xd39d41[_0x37a205(0x12c)],_0xd39d41['UniverProEditHistoryViewer'],_0xd39d41[_0x37a205(0x198)],_0xd39d41[_0x37a205(0x1ac)],_0xd39d41[_0x37a205(0x12a)],_0xd39d41[_0x37a205(0x205)],_0xd39d41[_0x37a205(0x187)],_0xd39d41['UniverProSheetsSparklineUi'],_0xd39d41['UniverDataValidation'],_0xd39d41['UniverDocs'],_0xd39d41[_0x37a205(0x1f8)],_0xd39d41[_0x37a205(0x1b8)],_0xd39d41[_0x37a205(0x1dc)],_0xd39d41[_0x37a205(0x17b)],_0xd39d41[_0x37a205(0x17e)],_0xd39d41[_0x37a205(0x118)],_0xd39d41['UniverRpc'],_0xd39d41['UniverSheetsConditionalFormatting'],_0xd39d41[_0x37a205(0x140)],_0xd39d41[_0x37a205(0x180)],_0xd39d41[_0x37a205(0x121)],_0xd39d41[_0x37a205(0x201)],_0xd39d41[_0x37a205(0x113)],_0xd39d41[_0x37a205(0x149)],_0xd39d41[_0x37a205(0x101)],_0xd39d41[_0x37a205(0x189)],_0xd39d41[_0x37a205(0x130)],_0xd39d41[_0x37a205(0x11f)],_0xd39d41[_0x37a205(0x1ca)],_0xd39d41['UniverSheetsNumfmt'],_0xd39d41[_0x37a205(0x17a)]));}(this,function(_0xd454b2,_0x4f7a23,_0x45ae20,_0x4fd6c9,_0x25e92e,_0x299054,_0x57b175,_0x28e36b,_0x4e4203,_0x41f8e7,_0x45569d,_0x204db8,_0x9f9cbd,_0x46db27,_0x15958a,_0x3496a9,_0x4b74c4,_0x927d93,_0x11fa0a,_0x32b69c,_0x3f6896,_0x540990,_0x5521ec,_0x17379e,_0x8cab20,_0x26d8f2,_0x442aa7,_0x1ecb2d,_0xc06005,_0x4c74a5,_0x53bb41,_0x3d0894,_0x29d15c,_0x220ea1,_0x5efb11,_0x3dc081,_0x9a6dba,_0x332790,_0x19421e){'use strict';const _0x1cc33a=_0x1da9;var _0x1be822=Object[_0x1cc33a(0x1c7)],_0x21a196=(_0x208a7e,_0x3a35ba,_0x5a77be)=>_0x3a35ba in _0x208a7e?_0x1be822(_0x208a7e,_0x3a35ba,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x5a77be}):_0x208a7e[_0x3a35ba]=_0x5a77be,_0x234bfc=(_0x4c3b98,_0xb5c054,_0x3a30c5)=>_0x21a196(_0x4c3b98,typeof _0xb5c054!='symbol'?_0xb5c054+'':_0xb5c054,_0x3a30c5),_0x2d551b;const _0x1f3100=_0x1cc33a(0x185),_0x195639={};function _0x270c3e({ref:_0x521498,..._0x4b941b}){const _0x174528=_0x1cc33a,{icon:_0x9c74ce,id:_0x125cb2,className:_0x358a65,extend:_0x130ff2,..._0x222f27}=_0x4b941b,_0x3dd22f=('univerjs-icon\x20univerjs-icon-'+_0x125cb2+'\x20'+(_0x358a65||''))[_0x174528(0x203)](),_0x6e994c=_0x299054[_0x174528(0x143)]('_'+_0x42fb33());return _0x1ed162(_0x9c74ce,''+_0x125cb2,{'defIds':_0x9c74ce[_0x174528(0x117)],'idSuffix':_0x6e994c[_0x174528(0x1e2)]},{'ref':_0x521498,'className':_0x3dd22f,..._0x222f27},_0x130ff2);}function _0x1ed162(_0x545745,_0x22f52f,_0x376c27,_0xc5beb9,_0x2c6554){const _0x1e06ba=_0x1cc33a;return _0x299054[_0x1e06ba(0x1e9)](_0x545745['tag'],{'key':_0x22f52f,..._0x237c60(_0x545745,_0x376c27,_0x2c6554),..._0xc5beb9},(_0x3a7414(_0x545745,_0x376c27)[_0x1e06ba(0x10b)]||[])[_0x1e06ba(0x1f3)]((_0x1bf8b7,_0x2deab1)=>_0x1ed162(_0x1bf8b7,_0x22f52f+'-'+_0x545745[_0x1e06ba(0x19f)]+'-'+_0x2deab1,_0x376c27,void 0x0,_0x2c6554)));}function _0x237c60(_0x73e422,_0x55bbdc,_0x1c5f90){const _0x24fb16=_0x1cc33a,_0x432631={..._0x73e422[_0x24fb16(0x10f)]};_0x1c5f90!=null&&_0x1c5f90[_0x24fb16(0x1c4)]&&_0x432631[_0x24fb16(0x1e0)]==='colorChannel1'&&(_0x432631[_0x24fb16(0x1e0)]=_0x1c5f90[_0x24fb16(0x1c4)]),_0x73e422[_0x24fb16(0x19f)]===_0x24fb16(0x209)&&_0x432631['id']&&(_0x432631['id']=_0x432631['id']+_0x55bbdc[_0x24fb16(0x147)]),Object[_0x24fb16(0xf6)](_0x432631)[_0x24fb16(0x191)](([_0x5430b0,_0x33ad79])=>{const _0x164f16=_0x24fb16;_0x5430b0==='mask'&&typeof _0x33ad79==_0x164f16(0x12d)&&(_0x432631[_0x5430b0]=_0x33ad79[_0x164f16(0x1f9)](/url\(#(.*)\)/,_0x164f16(0x1b1)+_0x55bbdc[_0x164f16(0x147)]+')'));});const {defIds:_0x26c997}=_0x55bbdc;return!_0x26c997||_0x26c997['length']===0x0||(_0x73e422['tag']===_0x24fb16(0x175)&&_0x432631[_0x24fb16(0x1a8)]&&(_0x432631['xlink:href']=_0x432631[_0x24fb16(0x1a8)]+_0x55bbdc[_0x24fb16(0x147)]),Object[_0x24fb16(0xf6)](_0x432631)['forEach'](([_0x274d98,_0xa1d2a9])=>{const _0x1698c3=_0x24fb16;typeof _0xa1d2a9==_0x1698c3(0x12d)&&(_0x432631[_0x274d98]=_0xa1d2a9[_0x1698c3(0x1f9)](/url\(#(.*)\)/,_0x1698c3(0x1b1)+_0x55bbdc['idSuffix']+')'));})),_0x432631;}function _0x3a7414(_0x5a32c4,_0x180c44){const _0xfbac85=_0x1cc33a;var _0x3fdc04;const {defIds:_0xfdf399}=_0x180c44;return!_0xfdf399||_0xfdf399[_0xfbac85(0x1ef)]===0x0?_0x5a32c4:_0x5a32c4[_0xfbac85(0x19f)]===_0xfbac85(0x1f6)&&((_0x3fdc04=_0x5a32c4[_0xfbac85(0x10b)])!=null&&_0x3fdc04['length'])?{..._0x5a32c4,'children':_0x5a32c4[_0xfbac85(0x10b)]['map'](_0x1df760=>typeof _0x1df760[_0xfbac85(0x10f)]['id']==_0xfbac85(0x12d)&&_0xfdf399&&_0xfdf399[_0xfbac85(0x1de)](_0x1df760[_0xfbac85(0x10f)]['id'])?{..._0x1df760,'attrs':{..._0x1df760[_0xfbac85(0x10f)],'id':_0x1df760[_0xfbac85(0x10f)]['id']+_0x180c44[_0xfbac85(0x147)]}}:_0x1df760)}:_0x5a32c4;}function _0x42fb33(){const _0x5bc3b1=_0x1cc33a;return Math[_0x5bc3b1(0x16f)]()[_0x5bc3b1(0x142)](0x24)['substring'](0x2,0x8);}_0x270c3e[_0x1cc33a(0x13f)]='UniverIcon';const _0x51a162={'tag':_0x1cc33a(0x13d),'attrs':{'xmlns':_0x1cc33a(0x1d8),'fill':_0x1cc33a(0x156),'viewBox':'0\x200\x2016\x2016','width':_0x1cc33a(0x11e),'height':_0x1cc33a(0x11e)},'children':[{'tag':'g','attrs':{'fill':_0x1cc33a(0x1a6),'clipPath':'url(#history-icon_clip0_907_281)'},'children':[{'tag':_0x1cc33a(0x1f0),'attrs':{'d':_0x1cc33a(0x1b6)}},{'tag':_0x1cc33a(0x1f0),'attrs':{'d':_0x1cc33a(0x164)}}]},{'tag':_0x1cc33a(0x1f6),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x1cc33a(0x1d2)},'children':[{'tag':_0x1cc33a(0x1f0),'attrs':{'fill':_0x1cc33a(0x123),'d':_0x1cc33a(0x105)}}]}]}],'defIds':[_0x1cc33a(0x1d2)]},_0x43e4eb=_0x299054['forwardRef'](function(_0x2e84b4,_0x5d424e){const _0x3fd0ef=_0x1cc33a;return _0x299054[_0x3fd0ef(0x1e9)](_0x270c3e,Object[_0x3fd0ef(0x20d)]({},_0x2e84b4,{'id':_0x3fd0ef(0x166),'ref':_0x5d424e,'icon':_0x51a162}));});_0x43e4eb[_0x1cc33a(0x13f)]=_0x1cc33a(0x126);var _0x4233ab=Object[_0x1cc33a(0x10a)],_0x2340c9=(_0x5d3cc1,_0x390e1f,_0x377ad2,_0x283457)=>{for(var _0x5d4098=_0x283457>0x1?void 0x0:_0x283457?_0x4233ab(_0x390e1f,_0x377ad2):_0x390e1f,_0x2c7b76=_0x5d3cc1['length']-0x1,_0xca5e4d;_0x2c7b76>=0x0;_0x2c7b76--)(_0xca5e4d=_0x5d3cc1[_0x2c7b76])&&(_0x5d4098=_0xca5e4d(_0x5d4098)||_0x5d4098);return _0x5d4098;},_0x5061e3=(_0xb0c1af,_0x395962)=>(_0x544a10,_0x272883)=>_0x395962(_0x544a10,_0x272883,_0xb0c1af);const _0x211308=_0x1cc33a(0x152),_0x587b8b=_0x1cc33a(0x1da),_0x1f0749=_0x1cc33a(0x1aa);_0xd454b2[_0x1cc33a(0x16a)]=class extends _0x4f7a23[_0x1cc33a(0x104)]{constructor(_0x254502,_0x11f861,_0x307a9b,_0x3e9e49,_0x40c992,_0x17a168,_0x50cf2a,_0x194f5c,_0x3e259b,_0x13342e){const _0x3f914c=_0x1cc33a;super(),_0x234bfc(this,_0x3f914c(0xf3),new _0x28e36b['BehaviorSubject'](null)),_0x234bfc(this,'historyUniver$',this[_0x3f914c(0xf3)][_0x3f914c(0x1fb)]()),_0x234bfc(this,'_disposableCollection',new _0x4f7a23[(_0x3f914c(0x1ff))]()),_0x234bfc(this,'_pluginMap',new Map()),(this['_localeService']=_0x254502,this[_0x3f914c(0x10e)]=_0x11f861,this[_0x3f914c(0x144)]=_0x307a9b,this[_0x3f914c(0x14d)]=_0x3e9e49,this[_0x3f914c(0x177)]=_0x40c992,this[_0x3f914c(0x1d5)]=_0x17a168,this[_0x3f914c(0x1a3)]=_0x50cf2a,this[_0x3f914c(0x15c)]=_0x194f5c,this[_0x3f914c(0x17d)]=_0x3e259b,this[_0x3f914c(0x128)]=_0x13342e,this['_init']());}get[_0x1cc33a(0x1cc)](){const _0x49900e=_0x1cc33a;return this[_0x49900e(0xf3)][_0x49900e(0xf2)];}['_init'](){const _0x136e2a=_0x1cc33a;this[_0x136e2a(0x1b5)](),this[_0x136e2a(0x1d6)]();}['_initContainer'](){const _0x5a0358=_0x1cc33a;var _0x333f4b;const _0x371bfb=(_0x333f4b=this[_0x5a0358(0x144)][_0x5a0358(0x13e)](_0x587b8b))!=null?_0x333f4b:_0x211308,_0x17a442=document[_0x5a0358(0x114)](_0x371bfb);if(!_0x17a442)return;const _0x4fbac2=document[_0x5a0358(0x1e9)](_0x5a0358(0x190));_0x4fbac2['id']=_0x1f0749,_0x4fbac2['dataset'][_0x5a0358(0x18d)]='history-container',_0x4fbac2[_0x5a0358(0x1b7)]['position']=_0x5a0358(0x19a),_0x4fbac2[_0x5a0358(0x1b7)]['top']='0',_0x4fbac2[_0x5a0358(0x1b7)][_0x5a0358(0x18e)]='0',_0x4fbac2[_0x5a0358(0x1b7)][_0x5a0358(0x20f)]='100%',_0x4fbac2['style'][_0x5a0358(0x17f)]=_0x5a0358(0x1b3),_0x4fbac2[_0x5a0358(0x1b7)][_0x5a0358(0x157)]=_0x5a0358(0x10d),_0x4fbac2[_0x5a0358(0x1b7)][_0x5a0358(0x15e)]='none',_0x17a442[_0x5a0358(0x168)](_0x4fbac2);}[_0x1cc33a(0x1d6)](){const _0x2fe06e=_0x1cc33a;var _0x4c542e;[[_0x5521ec[_0x2fe06e(0x1a0)]],[_0x57b175[_0x2fe06e(0x183)],{'container':_0x1f0749,'header':!0x0,'toolbar':!0x1,'footer':!0x0,'contextMenu':!0x1,'override':[[_0x57b175[_0x2fe06e(0x1ab)],null]]}],[_0x17379e[_0x2fe06e(0x15a)]],[_0x32b69c['UniverDrawingPlugin'],{'override':[[_0x32b69c['IImageIoService'],null]]}],[_0x927d93[_0x2fe06e(0x174)],{'hasScroll':!0x1}],[_0x11fa0a[_0x2fe06e(0x186)]],[_0x332790[_0x2fe06e(0x1c2)]],[_0x4e4203[_0x2fe06e(0x154)],{'notExecuteFormula':!0x0}],[_0x19421e[_0x2fe06e(0x1c9)]],[_0x220ea1[_0x2fe06e(0x1b4)]],[_0x5efb11[_0x2fe06e(0x14f)]],[_0x45ae20['UniverCollaborationPlugin']],[_0x3d0894[_0x2fe06e(0x131)]],[_0x29d15c[_0x2fe06e(0x1ad)]],[_0x26d8f2[_0x2fe06e(0x1ba)]],[_0x442aa7['UniverSheetsConditionalFormattingUIPlugin']],[_0x3dc081['UniverSheetsHyperLinkPlugin']],[_0x9a6dba[_0x2fe06e(0x212)]],[_0x4b74c4[_0x2fe06e(0x1a4)]],[_0x1ecb2d[_0x2fe06e(0x1ed)]],[_0xc06005[_0x2fe06e(0x129)]],[_0x540990[_0x2fe06e(0x1ee)],{'notExecuteFormula':!0x0}],[_0x8cab20['UniverRPCMainThreadPlugin'],{'workerURL':_0x2fe06e(0x1d7)}],[_0x3f6896['UniverDrawingUIPlugin']],[_0x4c74a5[_0x2fe06e(0x179)]],[_0x53bb41[_0x2fe06e(0x170)]],[_0x15958a[_0x2fe06e(0x1c6)]],[_0x3496a9['UniverSheetSparklineUIPlugin']],[_0x204db8['UniverSheetsChartPlugin']],[_0x9f9cbd['UniverSheetsChartUIPlugin']],[_0x46db27[_0x2fe06e(0x1cb)],{'notExecuteFormula':!0x0}],[_0x41f8e7[_0x2fe06e(0x169)],{'historyListServerUrl':(_0x4c542e=this[_0x2fe06e(0x144)][_0x2fe06e(0x13e)](_0x1f3100))==null?void 0x0:_0x4c542e['historyListServerUrl']}]][_0x2fe06e(0x191)](([_0x2e8a86,_0x15cd86])=>this[_0x2fe06e(0x18c)](_0x2e8a86,_0x15cd86));}[_0x1cc33a(0x1a2)](){const _0x50c38a=_0x1cc33a;super['dispose'](),this[_0x50c38a(0x15b)](),this[_0x50c38a(0x151)][_0x50c38a(0x10c)]();}[_0x1cc33a(0x18c)](_0x312716,_0x246b26,_0x58a71c){const _0x33aa4a=_0x1cc33a;if(this[_0x33aa4a(0x151)]['has'](_0x312716[_0x33aa4a(0x11c)])&&!_0x58a71c)throw new Error(_0x33aa4a(0x16b)+_0x312716[_0x33aa4a(0x11c)]+'\x20has\x20been\x20registered.');this[_0x33aa4a(0x151)][_0x33aa4a(0xfe)](_0x312716[_0x33aa4a(0x11c)],[_0x312716,_0x246b26]);}[_0x1cc33a(0x176)](){const _0x2829a3=_0x1cc33a;return Array[_0x2829a3(0x1df)](this[_0x2829a3(0x151)][_0x2829a3(0x108)]());}[_0x1cc33a(0x171)](_0x5a2a45){const _0x3af7a0=_0x1cc33a,_0x3d5fce=document[_0x3af7a0(0x114)](_0x1f0749);_0x3d5fce&&(_0x3d5fce[_0x3af7a0(0x1b7)][_0x3af7a0(0x15e)]='block',this[_0x3af7a0(0x1d3)](_0x5a2a45,_0x1f0749));}[_0x1cc33a(0x15b)](){const _0x3615c3=_0x1cc33a;var _0x4de344;this[_0x3615c3(0x18b)][_0x3615c3(0x1a2)](),(_0x4de344=this[_0x3615c3(0x1cc)])==null||_0x4de344[_0x3615c3(0x1a2)](),this[_0x3615c3(0xf3)][_0x3615c3(0x134)](null);const _0x130bf6=document['getElementById'](_0x1f0749);_0x130bf6&&(_0x130bf6['style'][_0x3615c3(0x15e)]=_0x3615c3(0x156));}[_0x1cc33a(0x1d3)](_0x2e3433,_0xed58ac){const _0x267565=_0x1cc33a;if(this['historyUniver'])return;const _0x306e29=new _0x4f7a23[(_0x267565(0x1fc))]({'locales':{[this[_0x267565(0x1db)][_0x267565(0x1c1)]()]:this['_localeService'][_0x267565(0x1bf)]()},'override':[[_0x4f7a23[_0x267565(0x119)],{'useClass':_0x4fd6c9[_0x267565(0x1a7)]}]]}),_0x130469=_0x306e29[_0x267565(0x178)]();this[_0x267565(0x15d)](this['_themeService']['darkMode$']['subscribe'](_0x504de4=>{const _0x2dd251=_0x267565;_0x130469[_0x2dd251(0x213)](_0x4f7a23['ThemeService'])['setDarkMode'](_0x504de4);})),this[_0x267565(0x15d)](this[_0x267565(0x128)][_0x267565(0x20a)][_0x267565(0x20e)](_0x20e086=>{const _0x67969a=_0x267565;_0x130469['get'](_0x4f7a23[_0x67969a(0x1e5)])[_0x67969a(0x1f4)](_0x20e086);})),_0x130469[_0x267565(0x213)](_0x4f7a23[_0x267565(0x111)])[_0x267565(0x206)](this['_localeService'][_0x267565(0x1c1)]()),_0x130469[_0x267565(0x213)](_0x4f7a23['IConfigService'])[_0x267565(0x1f5)](_0x4fd6c9[_0x267565(0x160)],this[_0x267565(0x144)][_0x267565(0x13e)](_0x4fd6c9[_0x267565(0x160)]));const _0x4ed32c=this['_configService'][_0x267565(0x13e)](_0x45569d[_0x267565(0x1f1)]);_0x4ed32c&&_0x306e29[_0x267565(0x18c)](_0x45569d[_0x267565(0x184)],{'license':_0x4ed32c['ls']}),this[_0x267565(0x151)][_0x267565(0x191)](([_0x4cb0ea,_0x127da1])=>{_0x306e29['registerPlugin'](_0x4cb0ea,_0x127da1);}),_0x130469[_0x267565(0x1ae)](_0x380eef=>{this['_initListener'](_0x380eef,_0x2e3433);}),this[_0x267565(0xf3)][_0x267565(0x134)](_0x306e29);const _0x1d2113=_0x130469[_0x267565(0x213)](_0x41f8e7[_0x267565(0x159)]),_0x3a27ce=this[_0x267565(0x16e)](_0x2e3433);_0x1d2113[_0x267565(0x181)](_0x2e3433,_0xed58ac,_0x3a27ce);}['_initListener'](_0x4088f4,_0x4b3951){const _0x5cb247=_0x1cc33a,_0x1509cc=_0x4088f4[_0x5cb247(0x213)](_0x41f8e7[_0x5cb247(0x159)]);this['_disposableCollection'][_0x5cb247(0x100)](_0x1509cc[_0x5cb247(0x1ce)]['subscribe'](_0x51b59e=>{const _0x2d7d4f=_0x5cb247;switch(_0x51b59e){case _0x41f8e7[_0x2d7d4f(0xf4)][_0x2d7d4f(0x182)]:this[_0x2d7d4f(0x15c)]['closeAll'](),this[_0x2d7d4f(0x17d)][_0x2d7d4f(0x167)]();break;case _0x41f8e7[_0x2d7d4f(0xf4)][_0x2d7d4f(0x19e)]:this[_0x2d7d4f(0x15b)]();break;case _0x41f8e7[_0x2d7d4f(0xf4)][_0x2d7d4f(0x120)]:this['unMountHistoryContent'](),this[_0x2d7d4f(0x177)][_0x2d7d4f(0x1f2)]({'content':this[_0x2d7d4f(0x1db)]['t']('editHistory.panel.listFetchError'),'type':_0x25e92e[_0x2d7d4f(0x136)][_0x2d7d4f(0x120)],'duration':0xbb8});break;}})),this[_0x5cb247(0x18b)]['add'](_0x1509cc[_0x5cb247(0x14b)]['subscribe'](async _0x3ebe48=>{const _0x2b085f=_0x5cb247;_0x3ebe48&&this[_0x2b085f(0x14d)][_0x2b085f(0x202)](_0x45ae20[_0x2b085f(0x1d9)]['id'],{'unitId':_0x4b3951,'revision':_0x3ebe48});}));}['_checkCanRevert'](_0x4e33e3){const _0x428909=_0x1cc33a,_0x14723e=this['_univerInstanceService'][_0x428909(0x17c)](_0x4e33e3)[_0x428909(0x1d1)]()[_0x428909(0x1f3)](_0x2c2db2=>_0x2c2db2['getSheetId']()),_0x273fe6=new _0x4e4203[(_0x428909(0x12b))](_0x4e33e3)['id'],_0x4dc7b7=_0x14723e['map'](_0x2e8778=>new _0x4e4203['WorksheetEditPermission'](_0x4e33e3,_0x2e8778)['id']),_0x116c90=_0x14723e[_0x428909(0x1f3)](_0x47df3e=>this[_0x428909(0x1a3)][_0x428909(0x1d4)](_0x4e33e3,_0x47df3e)[_0x428909(0x1f3)](_0x2c40d1=>new _0x4e4203['RangeProtectionPermissionEditPoint'](_0x4e33e3,_0x47df3e,_0x2c40d1[_0x428909(0xf8)])['id']))[_0x428909(0x150)](),_0x3d1f10=new _0x4e4203[(_0x428909(0x141))](_0x4e33e3)['id'];return this['_permissionService'][_0x428909(0x135)]([_0x273fe6,..._0x4dc7b7,..._0x116c90,_0x3d1f10])['every'](_0x5adff7=>!!_0x5adff7['value']);}},_0xd454b2[_0x1cc33a(0x16a)]=_0x2340c9([_0x5061e3(0x0,_0x4f7a23[_0x1cc33a(0x208)](_0x4f7a23[_0x1cc33a(0x111)])),_0x5061e3(0x1,_0x4f7a23['IUniverInstanceService']),_0x5061e3(0x2,_0x4f7a23[_0x1cc33a(0x158)]),_0x5061e3(0x3,_0x4f7a23['ICommandService']),_0x5061e3(0x4,_0x57b175['IMessageService']),_0x5061e3(0x5,_0x4f7a23[_0x1cc33a(0x1e4)]),_0x5061e3(0x6,_0x4f7a23[_0x1cc33a(0x208)](_0x4e4203[_0x1cc33a(0x16d)])),_0x5061e3(0x7,_0x4f7a23['Inject'](_0x57b175[_0x1cc33a(0x1ab)])),_0x5061e3(0x8,_0x4f7a23[_0x1cc33a(0x208)](_0x57b175[_0x1cc33a(0x15f)])),_0x5061e3(0x9,_0x4f7a23[_0x1cc33a(0x208)](_0x4f7a23['ThemeService']))],_0xd454b2[_0x1cc33a(0x16a)]);const _0x541058={'id':_0x1cc33a(0x127),'type':_0x4f7a23[_0x1cc33a(0x155)]['OPERATION'],'handler':_0x4c705c=>{const _0x5e75bc=_0x1cc33a,_0x1bb045=_0x4c705c[_0x5e75bc(0x213)](_0xd454b2['HistoryLoaderService']),_0x49018a=_0x4c705c['get'](_0x4f7a23[_0x5e75bc(0x146)]),{unitId:_0x5d2710}=_0x4e4203['getSheetCommandTarget'](_0x49018a)||{};return _0x5d2710?(_0x1bb045['mountHistoryContent'](_0x5d2710),!0x0):!0x1;}};function _0x337d83(_0x371aed){const _0x32731a=_0x1cc33a;return{'id':_0x541058['id'],'type':_0x57b175[_0x32731a(0x197)]['BUTTON'],'icon':'HistoryIcon','tooltip':_0x32731a(0x1bc),'hidden$':_0x57b175[_0x32731a(0x1ec)](_0x371aed,_0x4f7a23['UniverInstanceType'][_0x32731a(0x1fd)]),'disabled$':_0x19421e['getCurrentRangeDisable$'](_0x371aed,{'workbookTypes':[_0x4e4203['WorkbookEditablePermission'],_0x4e4203[_0x32731a(0xff)]],'worksheetTypes':[],'rangeTypes':[]})};}const _0x28c5aa={[_0x57b175['RibbonStartGroup'][_0x1cc33a(0x13b)]]:{[_0x541058['id']]:{'order':0.2,'menuItemFactory':_0x337d83}}};var _0x57e9d4=Object[_0x1cc33a(0x10a)],_0x17202f=(_0xf3ca48,_0x8ffc9,_0x53c543,_0x13f334)=>{const _0x277750=_0x1cc33a;for(var _0x2618a6=_0x13f334>0x1?void 0x0:_0x13f334?_0x57e9d4(_0x8ffc9,_0x53c543):_0x8ffc9,_0x5a36b6=_0xf3ca48[_0x277750(0x1ef)]-0x1,_0xde9a9c;_0x5a36b6>=0x0;_0x5a36b6--)(_0xde9a9c=_0xf3ca48[_0x5a36b6])&&(_0x2618a6=_0xde9a9c(_0x2618a6)||_0x2618a6);return _0x2618a6;},_0x800dd2=(_0x437852,_0x256265)=>(_0xaa6b32,_0x3c584f)=>_0x256265(_0xaa6b32,_0x3c584f,_0x437852);let _0x5df7e5=class extends _0x4f7a23[_0x1cc33a(0xf9)]{constructor(_0x5da410,_0xf60c64,_0xbacf4,_0xa2e12d,_0x6732a0,_0x598e47,_0x596fed,_0x4f78a8){const _0x1f822e=_0x1cc33a;super(),_0x234bfc(this,_0x1f822e(0xfc),null),(this[_0x1f822e(0x14d)]=_0x5da410,this[_0x1f822e(0x1af)]=_0xf60c64,this[_0x1f822e(0x153)]=_0xbacf4,this[_0x1f822e(0x106)]=_0xa2e12d,this[_0x1f822e(0x1db)]=_0x6732a0,this[_0x1f822e(0x177)]=_0x598e47,this[_0x1f822e(0x1bd)]=_0x596fed,this[_0x1f822e(0x195)]=_0x4f78a8,this[_0x1f822e(0x103)]());}['_init'](){const _0x1e76dc=_0x1cc33a;[_0x541058][_0x1e76dc(0x191)](_0x15d999=>this[_0x1e76dc(0x15d)](_0x4f7a23[_0x1e76dc(0x116)](this[_0x1e76dc(0x14d)][_0x1e76dc(0x11d)](_0x15d999)))),this['disposeWithMe'](this[_0x1e76dc(0x153)][_0x1e76dc(0x12e)](_0x1e76dc(0x126),_0x43e4eb)),this[_0x1e76dc(0x1af)]['mergeMenu'](_0x28c5aa),this[_0x1e76dc(0x15d)](this[_0x1e76dc(0x14d)][_0x1e76dc(0x1e7)](_0x583bcd=>{const _0x478da7=_0x1e76dc;if(_0x583bcd['id']===_0x45ae20['RevertRevisionMutation']['id']){this[_0x478da7(0x177)][_0x478da7(0x1f2)]({'content':this[_0x478da7(0x1db)]['t'](_0x478da7(0x122)),'type':_0x25e92e[_0x478da7(0x136)][_0x478da7(0x132)],'duration':0x1388});const {unitId:_0x301e32}=_0x583bcd['params'],_0x105cac=this[_0x478da7(0x1bd)]['getCollabEntity'](_0x301e32),_0x32620a=_0x28e36b[_0x478da7(0x112)]([_0x105cac[_0x478da7(0x16c)]['event$'],_0x105cac[_0x478da7(0xfa)]])[_0x478da7(0x20e)](async([_0x232216,_0x4d7d2b])=>{const _0x1a88cf=_0x478da7;var _0x2caffe;_0x232216[_0x1a88cf(0x20c)]===_0x45ae20['CollaborationEvent'][_0x1a88cf(0x193)]&&(_0x4d7d2b==null?void 0x0:_0x4d7d2b['status'])===_0x4fd6c9['CollaborationStatus'][_0x1a88cf(0x14c)]&&_0x232216[_0x1a88cf(0x11a)]['mutations']['some'](_0x385cb6=>_0x385cb6['id']===_0x45ae20[_0x1a88cf(0x1d9)]['id'])&&(this[_0x1a88cf(0x106)][_0x1a88cf(0x15b)](),_0x32620a[_0x1a88cf(0x207)](),this[_0x1a88cf(0xfc)]&&clearTimeout(this[_0x1a88cf(0xfc)]),await((_0x2caffe=this[_0x1a88cf(0x195)])==null?void 0x0:_0x2caffe[_0x1a88cf(0x1e3)]()),setTimeout(()=>window['location'][_0x1a88cf(0x13a)]()));});this['_revertErrorTimer']=setTimeout(()=>{const _0x37cd1c=_0x478da7;_0x32620a[_0x37cd1c(0x207)](),this[_0x37cd1c(0x177)][_0x37cd1c(0x1f2)]({'content':this[_0x37cd1c(0x1db)]['t']('editHistory.panel.revertFailed'),'type':_0x25e92e['MessageType'][_0x37cd1c(0x120)],'duration':0xbb8});},0x1388);}}));}};_0x5df7e5=_0x17202f([_0x800dd2(0x0,_0x4f7a23[_0x1cc33a(0x1b2)]),_0x800dd2(0x1,_0x57b175[_0x1cc33a(0x1fa)]),_0x800dd2(0x2,_0x4f7a23[_0x1cc33a(0x208)](_0x57b175[_0x1cc33a(0x1dd)])),_0x800dd2(0x3,_0x4f7a23['Inject'](_0xd454b2[_0x1cc33a(0x16a)])),_0x800dd2(0x4,_0x4f7a23[_0x1cc33a(0x208)](_0x4f7a23[_0x1cc33a(0x111)])),_0x800dd2(0x5,_0x57b175[_0x1cc33a(0x173)]),_0x800dd2(0x6,_0x4f7a23['Inject'](_0x4fd6c9[_0x1cc33a(0x194)])),_0x800dd2(0x7,_0x4fd6c9[_0x1cc33a(0x161)])],_0x5df7e5);var _0x1f3c9c=Object[_0x1cc33a(0x10a)],_0xdbd658=(_0x2bc08e,_0x2bc541,_0x46ce57,_0x3e2f6b)=>{const _0x515480=_0x1cc33a;for(var _0x147818=_0x3e2f6b>0x1?void 0x0:_0x3e2f6b?_0x1f3c9c(_0x2bc541,_0x46ce57):_0x2bc541,_0x4f3242=_0x2bc08e[_0x515480(0x1ef)]-0x1,_0x3a947c;_0x4f3242>=0x0;_0x4f3242--)(_0x3a947c=_0x2bc08e[_0x4f3242])&&(_0x147818=_0x3a947c(_0x147818)||_0x147818);return _0x147818;},_0x354010=(_0x4c0f70,_0x1d163c)=>(_0x34ef58,_0x4d51d4)=>_0x1d163c(_0x34ef58,_0x4d51d4,_0x4c0f70);const _0x253d98=_0x1cc33a(0x19d);_0xd454b2[_0x1cc33a(0x1eb)]=(_0x2d551b=class extends _0x4f7a23[_0x1cc33a(0x18a)]{constructor(_0x377a63=_0x195639,_0x37d40a,_0x4fad27){const _0x160126=_0x1cc33a;super(),this[_0x160126(0x19c)]=_0x377a63,this[_0x160126(0x163)]=_0x37d40a,this[_0x160126(0x144)]=_0x4fad27;const {menu:_0x2ad84e,..._0x1405d7}=_0x4f7a23[_0x160126(0x1e1)]({},_0x195639,this['_config']);_0x2ad84e&&this['_configService'][_0x160126(0x1f5)](_0x160126(0x200),_0x2ad84e,{'merge':!0x0}),this[_0x160126(0x144)][_0x160126(0x1f5)](_0x1f3100,_0x1405d7),this[_0x160126(0x19c)][_0x160126(0x20b)]&&this[_0x160126(0x144)][_0x160126(0x1f5)](_0x587b8b,this[_0x160126(0x19c)][_0x160126(0x20b)]);}[_0x1cc33a(0x210)](){const _0x10a959=_0x1cc33a;[[_0xd454b2[_0x10a959(0x16a)]],[_0x5df7e5]][_0x10a959(0x191)](_0x49196a=>this[_0x10a959(0x163)][_0x10a959(0x100)](_0x49196a));}[_0x1cc33a(0x1a5)](){const _0x3e5228=_0x1cc33a;this[_0x3e5228(0x163)][_0x3e5228(0x213)](_0x5df7e5);}},_0x234bfc(_0x2d551b,_0x1cc33a(0x162),_0x4f7a23[_0x1cc33a(0x124)][_0x1cc33a(0x1e8)]),_0x234bfc(_0x2d551b,'pluginName',_0x253d98),_0x2d551b),_0xd454b2[_0x1cc33a(0x1eb)]=_0xdbd658([_0x354010(0x1,_0x4f7a23['Inject'](_0x4f7a23[_0x1cc33a(0x13c)])),_0x354010(0x2,_0x4f7a23[_0x1cc33a(0x158)])],_0xd454b2[_0x1cc33a(0x1eb)]),_0xd454b2[_0x1cc33a(0x199)]=_0x587b8b,_0xd454b2['UNIVER_HISTORY_CONTAINER_ID']=_0x1f0749,Object[_0x1cc33a(0x1c7)](_0xd454b2,Symbol[_0x1cc33a(0x1be)],{'value':_0x1cc33a(0x18f)});}));function _0x1da9(_0x1b0ee7,_0x3a3d4b){_0x1b0ee7=_0x1b0ee7-0xf2;const _0x15648d=_0x1564();let _0x1da986=_0x15648d[_0x1b0ee7];return _0x1da986;}function _0x1564(){const _0x39311d=['trim','rxjs','UniverProSheetsPivot','setLocale','unsubscribe','Inject','mask','currentTheme$','univerContainerId','eventID','assign','subscribe','width','onStarting','@univerjs/sheets','UniverSheetsHyperLinkUIPlugin','get','value','_historyUniver$','HistoryModeStatus','@univerjs-pro/collaboration','entries','3iboGew','permissionId','RxDisposable','state$','@univerjs/network','_revertErrorTimer','React','set','WorkbookViewHistoryPermission','add','UniverSheetsFilterUi','@univerjs-pro/collaboration-client','_init','Disposable','M0\x200H16V16H0z','_historyManagerService','@univerjs/sheets-data-validation','values','object','getOwnPropertyDescriptor','children','clear','1000','_univerInstanceService','attrs','@univerjs/engine-formula','LocaleService','combineLatest','UniverSheetsDrawingUi','getElementById','@univerjs/sheets-conditional-formatting','toDisposable','defIds','UniverNetwork','IAuthzIoService','data','860ZnVsyV','pluginName','registerCommand','1em','UniverSheetsHyperLink','Error','UniverSheetsDataValidationUi','editHistory.panel.reverting','white','UniverInstanceType','@univerjs-pro/sheets-chart','HistoryIcon','univer.operation.toggle-edit-history','_themeService','UniverSheetsDataValidationUIPlugin','UniverProSheetsChartUi','WorkbookEditablePermission','UniverSheets','string','register','123995iZPaYJ','UniverSheetsFormulaUi','UniverSheetsFilterPlugin','Loading','@univerjs/sheets-ui','next','composePermission','MessageType','@univerjs/sheets-conditional-formatting-ui','@univerjs/engine-render','@univerjs/data-validation','reload','OTHERS','Injector','svg','getConfig','displayName','UniverSheetsConditionalFormattingUi','WorkbookRecoverHistoryPermission','toString','useRef','_configService','7731282gclpfw','IUniverInstanceService','idSuffix','@univerjs/docs','UniverSheetsFilter','@univerjs/sheets-drawing-ui','revertRevision$','SYNCED','_commandService','15327KhFgbO','UniverSheetsFormulaUIPlugin','flat','_pluginMap','univer-container','_componentManager','UniverSheetsPlugin','CommandType','none','zIndex','IConfigService','HistoryManagerService','UniverNetworkPlugin','unMountHistoryContent','_dialogService','disposeWithMe','display','ISidebarService','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','ILocalCacheService','type','_injector','M8.28291\x205.16293C8.28295\x204.83156\x208.01435\x204.5629\x207.68298\x204.56287C7.35161\x204.56283\x207.08295\x204.83143\x207.08291\x205.1628L7.08252\x208.63494C7.0825\x208.79881\x207.1495\x208.95555\x207.26796\x209.06877L9.70073\x2011.3939C9.94029\x2011.6228\x2010.3201\x2011.6142\x2010.549\x2011.3747C10.778\x2011.1351\x2010.7694\x2010.7553\x2010.5298\x2010.5263L8.28255\x208.37852L8.28291\x205.16293Z','28865683JabeUT','history-icon','close','appendChild','UniverEditHistoryViewerPlugin','HistoryLoaderService','[HistoryLoaderService]:\x20Plugin\x20','session','RangeProtectionRuleModel','_checkCanRevert','random','UniverSheetsDrawingUIPlugin','mountHistoryContent','@univerjs-pro/sheets-sparkline-ui','IMessageService','UniverDocsPlugin','use','getAllPlugins','_messageService','__getInjector','UniverSheetsDrawingPlugin','UniverSheetsUi','UniverEngineFormula','getUnit','_sidebarService','UniverEngineRender','height','UniverSheetsDataValidation','triggerLoadVersions','Entered','UniverUIPlugin','UniverLicensePlugin','edit-history-loader.config','UniverDocsUIPlugin','UniverProSheetsSparkline','5158476VKfCxU','UniverSheetsFormula','Plugin','_disposableCollection','registerPlugin','uComp','left','Module','div','forEach','@univerjs/drawing-ui','CHANGESET_ACK','CollaborationController','_localCacheService','amd','MenuItemType','UniverProLicense','UNIVER_CONTAINER_ID_KEY','absolute','react','_config','UNIVER_EDIT_HISTORY_LOADER_PLUGIN','Exited','tag','UniverRenderEnginePlugin','@univerjs/sheets-drawing','dispose','_selectionProtectionRuleModel','UniverDataValidationPlugin','onSteady','currentColor','AuthzIoHttpService','xlink:href','@univerjs/sheets-filter','univer-history-container','IDialogService','UniverProSheetsChart','UniverSheetsFilterUIPlugin','invoke','_menuManagerService','24iXDMmn','url(#$1','ICommandService','100%','UniverSheetsFormulaPlugin','_initContainer','M4.45388\x204.14989H3.52896C4.61144\x202.8939\x206.21319\x202.0999\x207.9999\x202.0999C11.2584\x202.0999\x2013.8999\x204.74142\x2013.8999\x207.9999C13.8999\x2011.2584\x2011.2584\x2013.8999\x207.9999\x2013.8999C4.74142\x2013.8999\x202.0999\x2011.2584\x202.0999\x207.9999C2.0999\x207.66853\x201.83127\x207.3999\x201.4999\x207.3999C1.16853\x207.3999\x200.899902\x207.66853\x200.899902\x207.9999C0.899902\x2011.9211\x204.07868\x2015.0999\x207.9999\x2015.0999C11.9211\x2015.0999\x2015.0999\x2011.9211\x2015.0999\x207.9999C15.0999\x204.07868\x2011.9211\x200.899902\x207.9999\x200.899902C5.88709\x200.899902\x203.9903\x201.82298\x202.69023\x203.28636V2.38625C2.69023\x202.05488\x202.42161\x201.78625\x202.09023\x201.78625C1.75886\x201.78625\x201.49023\x202.05488\x201.49023\x202.38625V4.74989C1.49023\x205.08126\x201.75886\x205.34989\x202.09023\x205.34989H4.45388C4.78525\x205.34989\x205.05388\x205.08126\x205.05388\x204.74989C5.05388\x204.41851\x204.78525\x204.14989\x204.45388\x204.14989Z','style','UniverDrawing','8305220SnEYSg','UniverSheetsConditionalFormattingPlugin','11500912rYRVtm','editHistory.panel.title','_collaborationController','toStringTag','getLocales','@univerjs/sheets-formula-ui','getCurrentLocale','UniverSheetsNumfmtPlugin','5lwIYtu','colorChannel1','function','UniverSheetSparklinePlugin','defineProperty','UniverProCollaboration','UniverSheetsUIPlugin','UniverSheetsHyperLinkUi','UniverSheetsPivotTablePlugin','historyUniver','@univerjs/sheets-data-validation-ui','status$','UniverProEditHistoryLoader','@univerjs/sheets-formula','getSheets','history-icon_clip0_907_281','_initUniver','getSubunitRuleList','_permissionService','_initPlugins','./worker.js','http://www.w3.org/2000/svg','RevertRevisionMutation','UNIVER_CONTAINER_ID','_localeService','UniverDrawingUi','ComponentManager','includes','from','fill','merge','current','exhaustSavingTask','IPermissionService','ThemeService','UniverUi','onCommandExecuted','UNIVER_UNKNOWN','createElement','exports','UniverEditHistoryLoaderPlugin','getMenuHiddenObservable','UniverSheetsDataValidationPlugin','UniverFormulaEnginePlugin','length','path','LS_CONFIG_KEY','show','map','setTheme','setConfig','defs','UniverCore','UniverDocsUi','replace','IMenuManagerService','asObservable','Univer','UNIVER_SHEET','@univerjs-pro/sheets-sparkline','DisposableCollection','menu','UniverSheetsDrawing','executeCommand'];_0x1564=function(){return _0x39311d;};return _0x1564();}