'use strict';const _0x2c37fe=_0x11a1;(function(_0xaff18e,_0x4f1ac2){const _0x575422=_0x11a1,_0x437104=_0xaff18e();while(!![]){try{const _0x20694d=-parseInt(_0x575422(0x110))/0x1*(-parseInt(_0x575422(0x100))/0x2)+parseInt(_0x575422(0x138))/0x3+-parseInt(_0x575422(0xf1))/0x4+-parseInt(_0x575422(0x91))/0x5+-parseInt(_0x575422(0x12b))/0x6+parseInt(_0x575422(0x7e))/0x7*(parseInt(_0x575422(0x13f))/0x8)+-parseInt(_0x575422(0x154))/0x9;if(_0x20694d===_0x4f1ac2)break;else _0x437104['push'](_0x437104['shift']());}catch(_0x4b6b14){_0x437104['push'](_0x437104['shift']());}}}(_0xbf2a,0x96b1d));var j=Object[_0x2c37fe(0xd2)],F=(_0x289fc4,_0x152b3e,_0x26661)=>_0x152b3e in _0x289fc4?j(_0x289fc4,_0x152b3e,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x26661}):_0x289fc4[_0x152b3e]=_0x26661,_=(_0x1d0f36,_0x179774,_0x1575b3)=>F(_0x1d0f36,typeof _0x179774!='symbol'?_0x179774+'':_0x179774,_0x1575b3);Object[_0x2c37fe(0xd2)](exports,Symbol[_0x2c37fe(0xf5)],{'value':'Module'});const o=require('@univerjs/core'),I=require('@univerjs-pro/collaboration'),f=require('@univerjs-pro/collaboration-client'),P=require('@univerjs/design'),U=require('react'),h=require('@univerjs/ui'),T=require('rxjs'),d=require('@univerjs/sheets'),m=require('@univerjs-pro/edit-history-viewer'),H=require('@univerjs-pro/license'),x=require('@univerjs-pro/sheets-chart'),A=require('@univerjs-pro/sheets-chart-ui'),V=require('@univerjs-pro/sheets-pivot'),G=require('@univerjs-pro/sheets-sparkline'),W=require('@univerjs-pro/sheets-sparkline-ui'),Y=require('@univerjs/data-validation'),B=require('@univerjs/docs'),K=require('@univerjs/docs-ui'),L=require('@univerjs/drawing'),z=require('@univerjs/drawing-ui'),Z=require('@univerjs/engine-formula'),J=require('@univerjs/engine-render'),Q=require('@univerjs/network'),X=require('@univerjs/rpc'),ee=require('@univerjs/sheets-conditional-formatting'),ie=require('@univerjs/sheets-conditional-formatting-ui'),te=require('@univerjs/sheets-data-validation'),re=require('@univerjs/sheets-data-validation-ui'),ne=require('@univerjs/sheets-drawing'),se=require('@univerjs/sheets-drawing-ui'),oe=require('@univerjs/sheets-filter'),ae=require('@univerjs/sheets-filter-ui'),ce=require('@univerjs/sheets-formula'),le=require('@univerjs/sheets-formula-ui'),ue=require('@univerjs/sheets-hyper-link'),he=require('@univerjs/sheets-hyper-link-ui'),ge=require('@univerjs/sheets-numfmt'),w=require('@univerjs/sheets-ui'),O=_0x2c37fe(0xed),R={};function _0xbf2a(){const _0x58953f=['M0\x200H16V16H0z','merge','RxDisposable','BehaviorSubject','UniverDocsPlugin','closeAll','100%','UniverDrawingPlugin','WorksheetEditPermission','every','UniverEditHistoryLoaderPlugin','UniverSheetsPlugin','attrs','UNIVER_EDIT_HISTORY_LOADER_PLUGIN','getElementById','IAuthzIoService','getCurrentLocale','status','add','_collaborationController','_initUniver','UniverSheetSparklinePlugin','UNIVER_CONTAINER_ID','assign','show','url(#$1','1000','getSheetCommandTarget','IDialogService','mountHistoryContent','xlink:href','AuthzIoHttpService','_initListener','idSuffix','clear','CommandType','UniverSheetsFormulaUIPlugin','asObservable','_initPlugins','CollaborationEvent','univer-container','dispose','setDarkMode','_pluginMap','HistoryManagerService','HistoryModeStatus','UniverFormulaEnginePlugin','_disposableCollection','_revertErrorTimer','executeCommand','length','forwardRef','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','exhaustSavingTask','UNIVER_SHEET','editHistory.panel.listFetchError','flat','tag','defineProperty','_selectionProtectionRuleModel','_checkCanRevert','getOwnPropertyDescriptor','_messageService','register','Exited','registerPlugin','next','mask','UniverLicensePlugin','WorkbookEditablePermission','UniverSheetsFilterUIPlugin','fill','location','zIndex','svg','colorChannel1','WorkbookRecoverHistoryPermission','IConfigService','editHistory.panel.revertFailed','1em','./worker.js','ThemeService','has','session','close','edit-history-loader.config','Injector','position','toString','640144iEENuV','Entered','invoke','width','toStringTag','revertRevision$','block','RevertRevisionMutation','currentTheme$','path','onCommandExecuted','UniverSheetSparklineUIPlugin','CollaborationController','Loading','appendChild','264578qSwBFV','UniverIcon','_univerInstanceService','unsubscribe','_componentManager','history-container','use','_historyUniver$','[HistoryLoaderService]:\x20Plugin\x20','UniverDataValidationPlugin','disposeWithMe','defs','subscribe','_sidebarService','IPermissionService','UniverSheetsHyperLinkUIPlugin','9lxCzRG','univerContainerId','UniverEditHistoryViewerPlugin','Plugin','forEach','absolute','entries','string','LocaleService','IUniverInstanceService','history-icon','UniverSheetsHyperLinkPlugin','M8.28291\x205.16293C8.28295\x204.83156\x208.01435\x204.5629\x207.68298\x204.56287C7.35161\x204.56283\x207.08295\x204.83143\x207.08291\x205.1628L7.08252\x208.63494C7.0825\x208.79881\x207.1495\x208.95555\x207.26796\x209.06877L9.70073\x2011.3939C9.94029\x2011.6228\x2010.3201\x2011.6142\x2010.549\x2011.3747C10.778\x2011.1351\x2010.7694\x2010.7553\x2010.5298\x2010.5263L8.28255\x208.37852L8.28291\x205.16293Z','eventID','triggerLoadVersions','SYNCED','_injector','value','set','UniverSheetsFormulaPlugin','reload','_init','UniverSheetsDataValidationPlugin','_menuManagerService','Inject','values','HistoryLoaderService','5145000QtVkIt','_themeService','state$','UniverNetworkPlugin','darkMode$','UniverRenderEnginePlugin','status$','from','_initContainer','left','none','LS_CONFIG_KEY','OTHERS','2065539nBWeMS','unMountHistoryContent','getCollabEntity','pluginName','OPERATION','univer-history-container','history-icon_clip0_907_281','160hSgdHJ','RibbonStartGroup','_dialogService','0\x200\x2016\x2016','mergeMenu','getMenuHiddenObservable','trim','UNIVER_CONTAINER_ID_KEY','substring','BUTTON','map','display','getAllPlugins','createElement','params','UniverSheetsConditionalFormattingUIPlugin','getLocales','UniverSheetsFilterPlugin','children','editHistory.panel.reverting','UniverUIPlugin','1840356PwCvak','HistoryIcon','url(#history-icon_clip0_907_281)','UniverSheetsChartUIPlugin','UniverSheetsChartPlugin','_localCacheService','useRef','IMessageService','onStarting','ISidebarService','ICommandService','toDisposable','IImageIoService','UniverDrawingUIPlugin','getUnit','UniverSheetsPivotTablePlugin','composePermission','getConfig','get','WorkbookViewHistoryPermission','style','permissionId','_commandService','univerjs-icon\x20univerjs-icon-','_config','displayName','34496vwguRm','clipPath','onSteady','MessageType','ILocalCacheService','MenuItemType','_configService','replace','UniverSheetsNumfmtPlugin','top','Error','random','setLocale','historyUniver','_permissionService','_localeService','height','IMenuManagerService','UniverRPCMainThreadPlugin','692045cSMgRB','setTheme','UniverInstanceType','dataset','setConfig','getSubunitRuleList','white'];_0xbf2a=function(){return _0x58953f;};return _0xbf2a();}function k({ref:_0x2c51e4,..._0x16ca53}){const _0x37d7b7=_0x2c37fe,{icon:_0x31b2b2,id:_0x2a9475,className:_0x5509d5,extend:_0x4e648c,..._0x15a9a9}=_0x16ca53,_0x684924=(_0x37d7b7(0x7b)+_0x2a9475+'\x20'+(_0x5509d5||''))[_0x37d7b7(0x145)](),_0xa81fe8=U[_0x37d7b7(0x15a)]('_'+_e());return D(_0x31b2b2,''+_0x2a9475,{'defIds':_0x31b2b2['defIds'],'idSuffix':_0xa81fe8['current']},{'ref':_0x2c51e4,'className':_0x684924,..._0x15a9a9},_0x4e648c);}function D(_0x396939,_0x86f6ed,_0x24a7f4,_0x1b9352,_0x2c7dd9){const _0x12779f=_0x2c37fe;return U[_0x12779f(0x14c)](_0x396939['tag'],{'key':_0x86f6ed,...ve(_0x396939,_0x24a7f4,_0x2c7dd9),..._0x1b9352},(de(_0x396939,_0x24a7f4)[_0x12779f(0x151)]||[])[_0x12779f(0x149)]((_0x1c284b,_0x5a684f)=>D(_0x1c284b,_0x86f6ed+'-'+_0x396939[_0x12779f(0xd1)]+'-'+_0x5a684f,_0x24a7f4,void 0x0,_0x2c7dd9)));}function ve(_0x3ee7c9,_0x3e76de,_0x3f44d1){const _0xcd47a3=_0x2c37fe,_0x2aefae={..._0x3ee7c9['attrs']};_0x3f44d1!=null&&_0x3f44d1['colorChannel1']&&_0x2aefae['fill']===_0xcd47a3(0xe3)&&(_0x2aefae[_0xcd47a3(0xdf)]=_0x3f44d1['colorChannel1']),_0x3ee7c9[_0xcd47a3(0xd1)]==='mask'&&_0x2aefae['id']&&(_0x2aefae['id']=_0x2aefae['id']+_0x3e76de[_0xcd47a3(0xb9)]),Object[_0xcd47a3(0x116)](_0x2aefae)[_0xcd47a3(0x114)](([_0x44eb19,_0x1e3549])=>{const _0x318f3a=_0xcd47a3;_0x44eb19===_0x318f3a(0xdb)&&typeof _0x1e3549==_0x318f3a(0x117)&&(_0x2aefae[_0x44eb19]=_0x1e3549[_0x318f3a(0x85)](/url\(#(.*)\)/,_0x318f3a(0xb1)+_0x3e76de[_0x318f3a(0xb9)]+')'));});const {defIds:_0x458c03}=_0x3e76de;return!_0x458c03||_0x458c03[_0xcd47a3(0xca)]===0x0||(_0x3ee7c9['tag']===_0xcd47a3(0x106)&&_0x2aefae[_0xcd47a3(0xb6)]&&(_0x2aefae[_0xcd47a3(0xb6)]=_0x2aefae[_0xcd47a3(0xb6)]+_0x3e76de[_0xcd47a3(0xb9)]),Object[_0xcd47a3(0x116)](_0x2aefae)['forEach'](([_0x2ea2b2,_0x57865d])=>{const _0x4af2e9=_0xcd47a3;typeof _0x57865d=='string'&&(_0x2aefae[_0x2ea2b2]=_0x57865d[_0x4af2e9(0x85)](/url\(#(.*)\)/,_0x4af2e9(0xb1)+_0x3e76de[_0x4af2e9(0xb9)]+')'));})),_0x2aefae;}function de(_0x53f176,_0x4b993){const _0x342b98=_0x2c37fe;var _0x1a8d36;const {defIds:_0x151618}=_0x4b993;return!_0x151618||_0x151618[_0x342b98(0xca)]===0x0?_0x53f176:_0x53f176['tag']===_0x342b98(0x10b)&&((_0x1a8d36=_0x53f176[_0x342b98(0x151)])!=null&&_0x1a8d36[_0x342b98(0xca)])?{..._0x53f176,'children':_0x53f176['children'][_0x342b98(0x149)](_0x16ef90=>typeof _0x16ef90[_0x342b98(0xa4)]['id']==_0x342b98(0x117)&&_0x151618&&_0x151618['includes'](_0x16ef90['attrs']['id'])?{..._0x16ef90,'attrs':{..._0x16ef90[_0x342b98(0xa4)],'id':_0x16ef90[_0x342b98(0xa4)]['id']+_0x4b993[_0x342b98(0xb9)]}}:_0x16ef90)}:_0x53f176;}function _e(){const _0x57b8fc=_0x2c37fe;return Math[_0x57b8fc(0x89)]()[_0x57b8fc(0xf0)](0x24)[_0x57b8fc(0x147)](0x2,0x8);}k['displayName']=_0x2c37fe(0x101);const Se={'tag':_0x2c37fe(0xe2),'attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':_0x2c37fe(0x135),'viewBox':_0x2c37fe(0x142),'width':_0x2c37fe(0xe7),'height':'1em'},'children':[{'tag':'g','attrs':{'fill':'currentColor','clipPath':_0x2c37fe(0x156)},'children':[{'tag':_0x2c37fe(0xfa),'attrs':{'d':'M4.45388\x204.14989H3.52896C4.61144\x202.8939\x206.21319\x202.0999\x207.9999\x202.0999C11.2584\x202.0999\x2013.8999\x204.74142\x2013.8999\x207.9999C13.8999\x2011.2584\x2011.2584\x2013.8999\x207.9999\x2013.8999C4.74142\x2013.8999\x202.0999\x2011.2584\x202.0999\x207.9999C2.0999\x207.66853\x201.83127\x207.3999\x201.4999\x207.3999C1.16853\x207.3999\x200.899902\x207.66853\x200.899902\x207.9999C0.899902\x2011.9211\x204.07868\x2015.0999\x207.9999\x2015.0999C11.9211\x2015.0999\x2015.0999\x2011.9211\x2015.0999\x207.9999C15.0999\x204.07868\x2011.9211\x200.899902\x207.9999\x200.899902C5.88709\x200.899902\x203.9903\x201.82298\x202.69023\x203.28636V2.38625C2.69023\x202.05488\x202.42161\x201.78625\x202.09023\x201.78625C1.75886\x201.78625\x201.49023\x202.05488\x201.49023\x202.38625V4.74989C1.49023\x205.08126\x201.75886\x205.34989\x202.09023\x205.34989H4.45388C4.78525\x205.34989\x205.05388\x205.08126\x205.05388\x204.74989C5.05388\x204.41851\x204.78525\x204.14989\x204.45388\x204.14989Z'}},{'tag':_0x2c37fe(0xfa),'attrs':{'d':_0x2c37fe(0x11c)}}]},{'tag':_0x2c37fe(0x10b),'attrs':{},'children':[{'tag':_0x2c37fe(0x7f),'attrs':{'id':_0x2c37fe(0x13e)},'children':[{'tag':'path','attrs':{'fill':_0x2c37fe(0x97),'d':_0x2c37fe(0x98)}}]}]}],'defIds':[_0x2c37fe(0x13e)]},q=U[_0x2c37fe(0xcb)](function(_0x172091,_0x30eedb){const _0x17e535=_0x2c37fe;return U[_0x17e535(0x14c)](k,Object[_0x17e535(0xaf)]({},_0x172091,{'id':_0x17e535(0x11a),'ref':_0x30eedb,'icon':Se}));});q[_0x2c37fe(0x7d)]=_0x2c37fe(0x155);var me=Object[_0x2c37fe(0xd5)],ye=(_0x3d64cc,_0x48f719,_0x5469fd,_0x418332)=>{const _0x40b463=_0x2c37fe;for(var _0x58e6b3=_0x418332>0x1?void 0x0:_0x418332?me(_0x48f719,_0x5469fd):_0x48f719,_0x163f5a=_0x3d64cc[_0x40b463(0xca)]-0x1,_0x3d0cea;_0x163f5a>=0x0;_0x163f5a--)(_0x3d0cea=_0x3d64cc[_0x163f5a])&&(_0x58e6b3=_0x3d0cea(_0x58e6b3)||_0x58e6b3);return _0x58e6b3;},g=(_0x32eecb,_0x4e97bf)=>(_0x194ce8,_0x452d24)=>_0x4e97bf(_0x194ce8,_0x452d24,_0x32eecb);const fe=_0x2c37fe(0xc0),b=_0x2c37fe(0xae),y=_0x2c37fe(0x13d);function _0x11a1(_0x410ccc,_0x2a89ad){_0x410ccc=_0x410ccc-0x6d;const _0xbf2a6e=_0xbf2a();let _0x11a199=_0xbf2a6e[_0x410ccc];return _0x11a199;}exports[_0x2c37fe(0x12a)]=class extends o['Disposable']{constructor(_0x63f1cc,_0x15bb6e,_0x2ff78c,_0x37e65e,_0x2d444d,_0x462e3d,_0xd298c3,_0x46b389,_0x322ef7,_0x5421fb){const _0x342883=_0x2c37fe;super(),_(this,_0x342883(0x107),new T[(_0x342883(0x9b))](null)),_(this,'historyUniver$',this[_0x342883(0x107)][_0x342883(0xbd)]()),_(this,_0x342883(0xc7),new o['DisposableCollection']()),_(this,_0x342883(0xc3),new Map()),(this[_0x342883(0x8d)]=_0x63f1cc,this[_0x342883(0x102)]=_0x15bb6e,this[_0x342883(0x84)]=_0x2ff78c,this[_0x342883(0x7a)]=_0x37e65e,this[_0x342883(0xd6)]=_0x2d444d,this['_permissionService']=_0x462e3d,this[_0x342883(0xd3)]=_0xd298c3,this[_0x342883(0x141)]=_0x46b389,this[_0x342883(0x10d)]=_0x322ef7,this[_0x342883(0x12c)]=_0x5421fb,this[_0x342883(0x125)]());}get[_0x2c37fe(0x8b)](){const _0x1f41c1=_0x2c37fe;return this[_0x1f41c1(0x107)][_0x1f41c1(0x121)];}[_0x2c37fe(0x125)](){const _0x41360f=_0x2c37fe;this['_initContainer'](),this[_0x41360f(0xbe)]();}[_0x2c37fe(0x133)](){const _0x41df4b=_0x2c37fe;var _0x261ba7;const _0x484d59=(_0x261ba7=this[_0x41df4b(0x84)]['getConfig'](b))!=null?_0x261ba7:fe,_0x2fc774=document['getElementById'](_0x484d59);if(!_0x2fc774)return;const _0x54f355=document['createElement']('div');_0x54f355['id']=y,_0x54f355[_0x41df4b(0x94)]['uComp']=_0x41df4b(0x105),_0x54f355['style'][_0x41df4b(0xef)]=_0x41df4b(0x115),_0x54f355[_0x41df4b(0x78)][_0x41df4b(0x87)]='0',_0x54f355[_0x41df4b(0x78)][_0x41df4b(0x134)]='0',_0x54f355[_0x41df4b(0x78)][_0x41df4b(0xf4)]='100%',_0x54f355[_0x41df4b(0x78)][_0x41df4b(0x8e)]=_0x41df4b(0x9e),_0x54f355['style'][_0x41df4b(0xe1)]=_0x41df4b(0xb2),_0x54f355[_0x41df4b(0x78)][_0x41df4b(0x14a)]=_0x41df4b(0x135),_0x2fc774[_0x41df4b(0xff)](_0x54f355);}['_initPlugins'](){const _0x3e5b5f=_0x2c37fe;var _0x33568a;[[J[_0x3e5b5f(0x130)]],[h[_0x3e5b5f(0x153)],{'container':y,'header':!0x0,'toolbar':!0x1,'footer':!0x0,'contextMenu':!0x1,'override':[[h[_0x3e5b5f(0xb4)],null]]}],[Q[_0x3e5b5f(0x12e)]],[L[_0x3e5b5f(0x9f)],{'override':[[L[_0x3e5b5f(0x70)],null]]}],[B[_0x3e5b5f(0x9c)],{'hasScroll':!0x1}],[K['UniverDocsUIPlugin']],[ge[_0x3e5b5f(0x86)]],[d[_0x3e5b5f(0xa3)],{'notExecuteFormula':!0x0}],[w['UniverSheetsUIPlugin']],[ce[_0x3e5b5f(0x123)]],[le[_0x3e5b5f(0xbc)]],[I['UniverCollaborationPlugin']],[oe[_0x3e5b5f(0x150)]],[ae[_0x3e5b5f(0xde)]],[ee['UniverSheetsConditionalFormattingPlugin']],[ie[_0x3e5b5f(0x14e)]],[ue[_0x3e5b5f(0x11b)]],[he[_0x3e5b5f(0x10f)]],[Y[_0x3e5b5f(0x109)]],[te[_0x3e5b5f(0x126)]],[re['UniverSheetsDataValidationUIPlugin']],[Z[_0x3e5b5f(0xc6)],{'notExecuteFormula':!0x0}],[X[_0x3e5b5f(0x90)],{'workerURL':_0x3e5b5f(0xe8)}],[z[_0x3e5b5f(0x71)]],[ne['UniverSheetsDrawingPlugin']],[se['UniverSheetsDrawingUIPlugin']],[G[_0x3e5b5f(0xad)]],[W[_0x3e5b5f(0xfc)]],[x[_0x3e5b5f(0x158)]],[A[_0x3e5b5f(0x157)]],[V[_0x3e5b5f(0x73)],{'notExecuteFormula':!0x0}],[m[_0x3e5b5f(0x112)],{'historyListServerUrl':(_0x33568a=this[_0x3e5b5f(0x84)]['getConfig'](O))==null?void 0x0:_0x33568a['historyListServerUrl']}]][_0x3e5b5f(0x114)](([_0x40787b,_0x36e69d])=>this['registerPlugin'](_0x40787b,_0x36e69d));}[_0x2c37fe(0xc1)](){const _0x180cb1=_0x2c37fe;super[_0x180cb1(0xc1)](),this[_0x180cb1(0x139)](),this[_0x180cb1(0xc3)][_0x180cb1(0xba)]();}['registerPlugin'](_0x269fdc,_0x10b7c8,_0x2c632b){const _0x528564=_0x2c37fe;if(this[_0x528564(0xc3)][_0x528564(0xea)](_0x269fdc['pluginName'])&&!_0x2c632b)throw new Error(_0x528564(0x108)+_0x269fdc['pluginName']+'\x20has\x20been\x20registered.');this[_0x528564(0xc3)][_0x528564(0x122)](_0x269fdc['pluginName'],[_0x269fdc,_0x10b7c8]);}[_0x2c37fe(0x14b)](){const _0x450f20=_0x2c37fe;return Array[_0x450f20(0x132)](this['_pluginMap'][_0x450f20(0x129)]());}[_0x2c37fe(0xb5)](_0x229a62){const _0x543be5=_0x2c37fe,_0x41d2aa=document['getElementById'](y);_0x41d2aa&&(_0x41d2aa[_0x543be5(0x78)][_0x543be5(0x14a)]=_0x543be5(0xf7),this[_0x543be5(0xac)](_0x229a62,y));}['unMountHistoryContent'](){const _0x220911=_0x2c37fe;var _0x22f3bf;this[_0x220911(0xc7)][_0x220911(0xc1)](),(_0x22f3bf=this['historyUniver'])==null||_0x22f3bf['dispose'](),this[_0x220911(0x107)][_0x220911(0xda)](null);const _0x1cd972=document[_0x220911(0xa6)](y);_0x1cd972&&(_0x1cd972[_0x220911(0x78)][_0x220911(0x14a)]='none');}['_initUniver'](_0x1e0663,_0xb42223){const _0x4538c2=_0x2c37fe;if(this[_0x4538c2(0x8b)])return;const _0x43969f=new o['Univer']({'locales':{[this['_localeService'][_0x4538c2(0xa8)]()]:this['_localeService'][_0x4538c2(0x14f)]()},'override':[[o[_0x4538c2(0xa7)],{'useClass':f[_0x4538c2(0xb7)]}]]}),_0x197659=_0x43969f['__getInjector']();this[_0x4538c2(0x10a)](this[_0x4538c2(0x12c)][_0x4538c2(0x12f)][_0x4538c2(0x10c)](_0x89997a=>{const _0x576e46=_0x4538c2;_0x197659[_0x576e46(0x76)](o[_0x576e46(0xe9)])[_0x576e46(0xc2)](_0x89997a);})),this[_0x4538c2(0x10a)](this[_0x4538c2(0x12c)][_0x4538c2(0xf9)][_0x4538c2(0x10c)](_0x30a41d=>{const _0x363e07=_0x4538c2;_0x197659[_0x363e07(0x76)](o[_0x363e07(0xe9)])[_0x363e07(0x92)](_0x30a41d);})),_0x197659['get'](o['LocaleService'])[_0x4538c2(0x8a)](this[_0x4538c2(0x8d)][_0x4538c2(0xa8)]()),_0x197659[_0x4538c2(0x76)](o[_0x4538c2(0xe5)])[_0x4538c2(0x95)](f[_0x4538c2(0xcc)],this['_configService']['getConfig'](f[_0x4538c2(0xcc)]));const _0x5ba552=this[_0x4538c2(0x84)][_0x4538c2(0x75)](H[_0x4538c2(0x136)]);_0x5ba552&&_0x43969f[_0x4538c2(0xd9)](H[_0x4538c2(0xdc)],{'license':_0x5ba552['ls']}),this[_0x4538c2(0xc3)]['forEach'](([_0x170464,_0x239251])=>{const _0x40b248=_0x4538c2;_0x43969f[_0x40b248(0xd9)](_0x170464,_0x239251);}),_0x197659[_0x4538c2(0xf3)](_0x17d383=>{const _0x5a3402=_0x4538c2;this[_0x5a3402(0xb8)](_0x17d383,_0x1e0663);}),this[_0x4538c2(0x107)]['next'](_0x43969f);const _0x57bbc8=_0x197659['get'](m[_0x4538c2(0xc4)]),_0x50c7db=this[_0x4538c2(0xd4)](_0x1e0663);_0x57bbc8[_0x4538c2(0x11e)](_0x1e0663,_0xb42223,_0x50c7db);}[_0x2c37fe(0xb8)](_0x1cd1df,_0x3e68fb){const _0x52916b=_0x2c37fe,_0x2def8f=_0x1cd1df[_0x52916b(0x76)](m[_0x52916b(0xc4)]);this['_disposableCollection'][_0x52916b(0xaa)](_0x2def8f[_0x52916b(0x131)]['subscribe'](_0x3ea36f=>{const _0x21786f=_0x52916b;switch(_0x3ea36f){case m[_0x21786f(0xc5)][_0x21786f(0xf2)]:this['_dialogService'][_0x21786f(0x9d)](),this['_sidebarService'][_0x21786f(0xec)]();break;case m[_0x21786f(0xc5)][_0x21786f(0xd8)]:this[_0x21786f(0x139)]();break;case m[_0x21786f(0xc5)][_0x21786f(0x88)]:this[_0x21786f(0x139)](),this['_messageService'][_0x21786f(0xb0)]({'content':this[_0x21786f(0x8d)]['t'](_0x21786f(0xcf)),'type':P[_0x21786f(0x81)][_0x21786f(0x88)],'duration':0xbb8});break;}})),this[_0x52916b(0xc7)][_0x52916b(0xaa)](_0x2def8f[_0x52916b(0xf6)][_0x52916b(0x10c)](async _0x5b208f=>{const _0x5ae2d1=_0x52916b;_0x5b208f&&this[_0x5ae2d1(0x7a)][_0x5ae2d1(0xc9)](I[_0x5ae2d1(0xf8)]['id'],{'unitId':_0x3e68fb,'revision':_0x5b208f});}));}['_checkCanRevert'](_0x906ae2){const _0x5782c0=_0x2c37fe,_0x509ad7=this['_univerInstanceService'][_0x5782c0(0x72)](_0x906ae2)['getSheets']()['map'](_0x41f7e9=>_0x41f7e9['getSheetId']()),_0x24a817=new d[(_0x5782c0(0xdd))](_0x906ae2)['id'],_0x49c46d=_0x509ad7[_0x5782c0(0x149)](_0xe8c0f4=>new d[(_0x5782c0(0xa0))](_0x906ae2,_0xe8c0f4)['id']),_0x3a6366=_0x509ad7[_0x5782c0(0x149)](_0x5a3f32=>this['_selectionProtectionRuleModel'][_0x5782c0(0x96)](_0x906ae2,_0x5a3f32)['map'](_0xd65088=>new d['RangeProtectionPermissionEditPoint'](_0x906ae2,_0x5a3f32,_0xd65088[_0x5782c0(0x79)])['id']))[_0x5782c0(0xd0)](),_0x446788=new d[(_0x5782c0(0xe4))](_0x906ae2)['id'];return this[_0x5782c0(0x8c)][_0x5782c0(0x74)]([_0x24a817,..._0x49c46d,..._0x3a6366,_0x446788])[_0x5782c0(0xa1)](_0x32eba8=>!!_0x32eba8[_0x5782c0(0x121)]);}},exports[_0x2c37fe(0x12a)]=ye([g(0x0,o[_0x2c37fe(0x128)](o[_0x2c37fe(0x118)])),g(0x1,o[_0x2c37fe(0x119)]),g(0x2,o['IConfigService']),g(0x3,o['ICommandService']),g(0x4,h[_0x2c37fe(0x15b)]),g(0x5,o[_0x2c37fe(0x10e)]),g(0x6,o[_0x2c37fe(0x128)](d['RangeProtectionRuleModel'])),g(0x7,o['Inject'](h[_0x2c37fe(0xb4)])),g(0x8,o[_0x2c37fe(0x128)](h[_0x2c37fe(0x6d)])),g(0x9,o[_0x2c37fe(0x128)](o[_0x2c37fe(0xe9)]))],exports[_0x2c37fe(0x12a)]);const M={'id':'univer.operation.toggle-edit-history','type':o[_0x2c37fe(0xbb)][_0x2c37fe(0x13c)],'handler':_0xb9ac79=>{const _0x1f60a6=_0x2c37fe,_0x4ed483=_0xb9ac79[_0x1f60a6(0x76)](exports[_0x1f60a6(0x12a)]),_0x530d4b=_0xb9ac79['get'](o['IUniverInstanceService']),{unitId:_0x574a99}=d[_0x1f60a6(0xb3)](_0x530d4b)||{};return _0x574a99?(_0x4ed483['mountHistoryContent'](_0x574a99),!0x0):!0x1;}};function pe(_0x4c94f0){const _0x6d0db4=_0x2c37fe;return{'id':M['id'],'type':h[_0x6d0db4(0x83)][_0x6d0db4(0x148)],'icon':'HistoryIcon','tooltip':'editHistory.panel.title','hidden$':h[_0x6d0db4(0x144)](_0x4c94f0,o[_0x6d0db4(0x93)][_0x6d0db4(0xce)]),'disabled$':w['getCurrentRangeDisable$'](_0x4c94f0,{'workbookTypes':[d[_0x6d0db4(0xdd)],d[_0x6d0db4(0x77)]],'worksheetTypes':[],'rangeTypes':[]})};}const Ie={[h[_0x2c37fe(0x140)][_0x2c37fe(0x137)]]:{[M['id']]:{'order':0.2,'menuItemFactory':pe}}};var Ce=Object['getOwnPropertyDescriptor'],Ue=(_0x39391c,_0x42f996,_0x3c41f3,_0x564405)=>{for(var _0x3f2b75=_0x564405>0x1?void 0x0:_0x564405?Ce(_0x42f996,_0x3c41f3):_0x42f996,_0x44e486=_0x39391c['length']-0x1,_0x561202;_0x44e486>=0x0;_0x44e486--)(_0x561202=_0x39391c[_0x44e486])&&(_0x3f2b75=_0x561202(_0x3f2b75)||_0x3f2b75);return _0x3f2b75;},S=(_0x5ab6bc,_0x1423f6)=>(_0x55e7e4,_0x96f9ed)=>_0x1423f6(_0x55e7e4,_0x96f9ed,_0x5ab6bc);let E=class extends o[_0x2c37fe(0x9a)]{constructor(_0x56fc90,_0x61b6a2,_0x319aff,_0x453a49,_0x541aac,_0x201743,_0x37d46a,_0x286fd7){const _0xd6864b=_0x2c37fe;super(),_(this,_0xd6864b(0xc8),null),(this[_0xd6864b(0x7a)]=_0x56fc90,this[_0xd6864b(0x127)]=_0x61b6a2,this[_0xd6864b(0x104)]=_0x319aff,this['_historyManagerService']=_0x453a49,this[_0xd6864b(0x8d)]=_0x541aac,this[_0xd6864b(0xd6)]=_0x201743,this[_0xd6864b(0xab)]=_0x37d46a,this[_0xd6864b(0x159)]=_0x286fd7,this[_0xd6864b(0x125)]());}[_0x2c37fe(0x125)](){const _0x4d3152=_0x2c37fe;[M]['forEach'](_0x15962d=>this[_0x4d3152(0x10a)](o[_0x4d3152(0x6f)](this[_0x4d3152(0x7a)]['registerCommand'](_0x15962d)))),this[_0x4d3152(0x10a)](this[_0x4d3152(0x104)][_0x4d3152(0xd7)](_0x4d3152(0x155),q)),this[_0x4d3152(0x127)][_0x4d3152(0x143)](Ie),this[_0x4d3152(0x10a)](this[_0x4d3152(0x7a)][_0x4d3152(0xfb)](_0x4acd21=>{const _0x46640c=_0x4d3152;if(_0x4acd21['id']===I[_0x46640c(0xf8)]['id']){this[_0x46640c(0xd6)][_0x46640c(0xb0)]({'content':this[_0x46640c(0x8d)]['t'](_0x46640c(0x152)),'type':P[_0x46640c(0x81)][_0x46640c(0xfe)],'duration':0x1388});const {unitId:_0x44b32e}=_0x4acd21[_0x46640c(0x14d)],_0xc0b741=this['_collaborationController'][_0x46640c(0x13a)](_0x44b32e),_0x2bf146=T['combineLatest']([_0xc0b741[_0x46640c(0xeb)]['event$'],_0xc0b741[_0x46640c(0x12d)]])[_0x46640c(0x10c)](async([_0x2cd01f,_0x14d3b7])=>{const _0x19c699=_0x46640c;var _0x161949;_0x2cd01f[_0x19c699(0x11d)]===I[_0x19c699(0xbf)]['CHANGESET_ACK']&&(_0x14d3b7==null?void 0x0:_0x14d3b7[_0x19c699(0xa9)])===f['CollaborationStatus'][_0x19c699(0x11f)]&&_0x2cd01f['data']['mutations']['some'](_0x473137=>_0x473137['id']===I[_0x19c699(0xf8)]['id'])&&(this['_historyManagerService'][_0x19c699(0x139)](),_0x2bf146[_0x19c699(0x103)](),this[_0x19c699(0xc8)]&&clearTimeout(this['_revertErrorTimer']),await((_0x161949=this['_localCacheService'])==null?void 0x0:_0x161949[_0x19c699(0xcd)]()),setTimeout(()=>window[_0x19c699(0xe0)][_0x19c699(0x124)]()));});this[_0x46640c(0xc8)]=setTimeout(()=>{const _0x37253f=_0x46640c;_0x2bf146[_0x37253f(0x103)](),this[_0x37253f(0xd6)][_0x37253f(0xb0)]({'content':this['_localeService']['t'](_0x37253f(0xe6)),'type':P['MessageType'][_0x37253f(0x88)],'duration':0xbb8});},0x1388);}}));}};E=Ue([S(0x0,o[_0x2c37fe(0x6e)]),S(0x1,h[_0x2c37fe(0x8f)]),S(0x2,o[_0x2c37fe(0x128)](h['ComponentManager'])),S(0x3,o[_0x2c37fe(0x128)](exports[_0x2c37fe(0x12a)])),S(0x4,o[_0x2c37fe(0x128)](o['LocaleService'])),S(0x5,h[_0x2c37fe(0x15b)]),S(0x6,o['Inject'](f[_0x2c37fe(0xfd)])),S(0x7,f[_0x2c37fe(0x82)])],E);var Ee=Object[_0x2c37fe(0xd5)],Pe=(_0x38bde6,_0x2190d6,_0x54771d,_0x3054eb)=>{const _0x52b6eb=_0x2c37fe;for(var _0x28d719=_0x3054eb>0x1?void 0x0:_0x3054eb?Ee(_0x2190d6,_0x54771d):_0x2190d6,_0x1a42ad=_0x38bde6[_0x52b6eb(0xca)]-0x1,_0x37c8b3;_0x1a42ad>=0x0;_0x1a42ad--)(_0x37c8b3=_0x38bde6[_0x1a42ad])&&(_0x28d719=_0x37c8b3(_0x28d719)||_0x28d719);return _0x28d719;},N=(_0x1299cf,_0xe06621)=>(_0x4f6e81,_0xef8f7f)=>_0xe06621(_0x4f6e81,_0xef8f7f,_0x1299cf);const be=_0x2c37fe(0xa5);var C;exports['UniverEditHistoryLoaderPlugin']=(C=class extends o[_0x2c37fe(0x113)]{constructor(_0xd7198f=R,_0x1b3f8c,_0x88420c){const _0x4ffca9=_0x2c37fe;super(),this[_0x4ffca9(0x7c)]=_0xd7198f,this[_0x4ffca9(0x120)]=_0x1b3f8c,this['_configService']=_0x88420c;const {menu:_0x587eb8,..._0x4eee17}=o[_0x4ffca9(0x99)]({},R,this[_0x4ffca9(0x7c)]);_0x587eb8&&this['_configService'][_0x4ffca9(0x95)]('menu',_0x587eb8,{'merge':!0x0}),this[_0x4ffca9(0x84)][_0x4ffca9(0x95)](O,_0x4eee17),this['_config']['univerContainerId']&&this['_configService'][_0x4ffca9(0x95)](b,this[_0x4ffca9(0x7c)][_0x4ffca9(0x111)]);}[_0x2c37fe(0x15c)](){const _0x1d93d9=_0x2c37fe;[[exports['HistoryLoaderService']],[E]][_0x1d93d9(0x114)](_0x2bfa6b=>this[_0x1d93d9(0x120)][_0x1d93d9(0xaa)](_0x2bfa6b));}[_0x2c37fe(0x80)](){const _0x2aea47=_0x2c37fe;this[_0x2aea47(0x120)]['get'](E);}},_(C,'type',o[_0x2c37fe(0x93)]['UNIVER_UNKNOWN']),_(C,_0x2c37fe(0x13b),be),C),exports['UniverEditHistoryLoaderPlugin']=Pe([N(0x1,o[_0x2c37fe(0x128)](o[_0x2c37fe(0xee)])),N(0x2,o[_0x2c37fe(0xe5)])],exports[_0x2c37fe(0xa2)]),exports[_0x2c37fe(0x146)]=b,exports['UNIVER_HISTORY_CONTAINER_ID']=y;