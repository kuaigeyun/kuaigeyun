'use strict';const _0x58c229=_0x1cc3;(function(_0x3c51d0,_0x1cd6fd){const _0x489b0f=_0x1cc3,_0x41b69f=_0x3c51d0();while(!![]){try{const _0x1b9677=parseInt(_0x489b0f(0x2b9))/0x1+-parseInt(_0x489b0f(0x36a))/0x2+parseInt(_0x489b0f(0x223))/0x3*(parseInt(_0x489b0f(0x3a0))/0x4)+-parseInt(_0x489b0f(0x244))/0x5+parseInt(_0x489b0f(0x337))/0x6+parseInt(_0x489b0f(0x2d5))/0x7+-parseInt(_0x489b0f(0x10e))/0x8;if(_0x1b9677===_0x1cd6fd)break;else _0x41b69f['push'](_0x41b69f['shift']());}catch(_0x2af1c0){_0x41b69f['push'](_0x41b69f['shift']());}}}(_0x52e6,0x68f47));var Fo=Object[_0x58c229(0x129)],Ro=(_0x1996f8,_0x5e52dc,_0x16d6b8)=>_0x5e52dc in _0x1996f8?Fo(_0x1996f8,_0x5e52dc,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x16d6b8}):_0x1996f8[_0x5e52dc]=_0x16d6b8,x=(_0x16b161,_0x1f3d2d,_0x3ba3fc)=>Ro(_0x16b161,typeof _0x1f3d2d!=_0x58c229(0x1e2)?_0x1f3d2d+'':_0x1f3d2d,_0x3ba3fc);Object[_0x58c229(0x129)](exports,Symbol['toStringTag'],{'value':_0x58c229(0x392)});const m=require('@univerjs-pro/engine-pivot'),v=require('@univerjs/core'),ve=require('@univerjs/engine-formula'),V=require('@univerjs/sheets'),ge=require('rxjs'),ue=require('@univerjs-pro/license'),Ot=require('@univerjs/sheets-filter'),wo=require('@univerjs/rpc'),Ne=require('@univerjs/engine-render'),Gt=Number['parseInt'](0x6933d6ed),_o=0x10,It=0x1,Ct='SHEET_PIVOT_TABLE_PLUGIN',Re=0x1,Do='rgb(240,241,243)',Uo=_0x58c229(0x23f),Ze=_0x58c229(0x298),Eo=_0x58c229(0x210),No=_0x58c229(0x210),Vo=_0x58c229(0x2de),xo=_0x58c229(0x31f),Oo=_0x58c229(0x2c2),Ao=_0x58c229(0x21b),ko='#1d32e9',Bo=_0x58c229(0x2c2),jo=_0x58c229(0x34b),Lo=0xe,Go=0x6;var Mt=(_0x165a68=>(_0x165a68[_0x58c229(0x381)]=_0x58c229(0x1b2),_0x165a68[_0x58c229(0x1da)]='new',_0x165a68))(Mt||{});const $t={'sheets-pivot':{'blankValue':'','otherValue':'','columnName':'','subTotalText':'','grandTotalText':'','valueText':'','averageName':'','countName':'','countNumsName':'','maxName':'','minName':'','productName':'','stdDevName':'','stdDevpName':'','sumName':'','varName':'','varpName':'','value':'','blank':'','other':'','subTotal':'','grandTotal':'','emptyPivot':{'filter':'','row':'','column':'','values':''},'dateGroup':{'year':'','month':'','day':'','hour':'','minute':'','quarter':'','monthDate':'','yearQuarter':'','yearMonth':'','yearMonthDate':''},'cellDateGroupDisplay':{'minute':'','hour':'','hourMinute':'','date':'','month':'','monthDate':'','quarter':'','year':'','yearMonth':'','yearMonthDate':'','yearQuarter':''}}},$o=0x1e,Te={'b':{'s':0x1,'cl':{'rgb':Ze}},'l':{'s':0x1,'cl':{'rgb':Ze}},'r':{'s':0x1,'cl':{'rgb':Ze}},'t':{'s':0x1,'cl':{'rgb':Ze}}},z={'bg':{'rgb':Do},'ht':0x2,'vt':0x2,'tb':0x1},_={'bg':{'rgb':Uo},'ht':0x2,'vt':0x2,'tb':0x1},oe={'rowStyle':{'bg':{'rgb':jo},'bd':Te,'bl':0x1,'vt':0x2},'colStyle':{'bg':{'rgb':ko},'bd':null,'cl':{'rgb':Bo},'bl':0x1,'vt':0x2},'subTotalStyle':{'bd':Te,'bg':{'rgb':Ao},'vt':0x2},'cornerStyle':{'bd':Te,'bg':{'rgb':Vo},'bl':0x1,'vt':0x2},'pageStyle':{'bd':Te,'bg':{'rgb':Eo},'vt':0x2},'leafStyle':{'bd':Te,'bg':{'rgb':No},'vt':0x2},'grandTotal':{'bd':null,'bg':{'rgb':xo},'cl':{'rgb':Oo},'bl':0x1,'vt':0x2},'dataStyle':{'bd':Te,'vt':0x2}};function Wo(_0x503f16,_0x1fa749,_0x5095d3){const _0xdf3280=_0x58c229,_0x535e68=_0x503f16[_0xdf3280(0x15b)](v['LocaleService']),_0x96cdad=_0x5095d3[_0xdf3280(0x25b)]('_');switch(_0x1fa749){case m['PivotDateGroupFieldDateTypeEnum'][_0xdf3280(0x36e)]:return _0x535e68['t']('sheets-pivot.cellDateGroupDisplay.year',..._0x96cdad);case m[_0xdf3280(0x1ef)][_0xdf3280(0x33e)]:return _0x535e68['t'](_0xdf3280(0x235),..._0x96cdad);case m['PivotDateGroupFieldDateTypeEnum'][_0xdf3280(0x1de)]:return _0x535e68['t'](_0xdf3280(0x368),..._0x96cdad);case m[_0xdf3280(0x1ef)]['HourMinute']:return _0x535e68['t'](_0xdf3280(0x39d),..._0x96cdad);case m['PivotDateGroupFieldDateTypeEnum'][_0xdf3280(0x285)]:return _0x535e68['t']('sheets-pivot.cellDateGroupDisplay.date',..._0x96cdad);case m[_0xdf3280(0x1ef)][_0xdf3280(0x172)]:return _0x535e68['t'](_0xdf3280(0x3f9),..._0x96cdad);case m['PivotDateGroupFieldDateTypeEnum']['Quarter']:return _0x535e68['t'](_0xdf3280(0x419),..._0x96cdad);case m[_0xdf3280(0x1ef)][_0xdf3280(0x137)]:return _0x535e68['t'](_0xdf3280(0x269),..._0x96cdad);case m[_0xdf3280(0x1ef)]['YearMonthDate']:return _0x535e68['t'](_0xdf3280(0x144),..._0x96cdad);case m[_0xdf3280(0x1ef)][_0xdf3280(0x3c9)]:return _0x535e68['t'](_0xdf3280(0x34e),..._0x96cdad);}return'';}const Ve=(_0x63cadb,_0x4ed460,_0x619426,_0x15495c)=>{const _0x385ae3=_0x58c229;let _0x35e6cb;const _0x33c62c=_0x63cadb[_0x385ae3(0x15b)](v[_0x385ae3(0x185)])['getCurrentUnitForType'](v[_0x385ae3(0x232)][_0x385ae3(0x2cb)]);if(!_0x33c62c)return null;const _0x9a67be=_0x33c62c[_0x385ae3(0x3f1)]();let _0x200c5d;if(_0x619426&&(_0x200c5d=_0x9a67be[_0x385ae3(0x258)](_0x619426)),_0x4ed460!=null&&_0x4ed460['v']||(_0x4ed460==null?void 0x0:_0x4ed460['v'])===0x0){_0x35e6cb||(_0x35e6cb={});const _0x53a689=Wt(_0x4ed460['v']);typeof _0x53a689==_0x385ae3(0x38d)?_0x35e6cb['t']=v[_0x385ae3(0x2a8)][_0x385ae3(0x112)]:typeof _0x53a689==_0x385ae3(0x268)&&(_0x35e6cb['t']=v[_0x385ae3(0x2a8)][_0x385ae3(0x2cf)]),_0x35e6cb['v']=_0x53a689;}if((_0x4ed460!=null&&_0x4ed460['i']||(_0x4ed460==null?void 0x0:_0x4ed460['i'])===0x0)&&(_0x35e6cb||(_0x35e6cb={}),_0x35e6cb['fi']=_0x4ed460['i']),_0x4ed460!=null&&_0x4ed460['s']&&(_0x35e6cb||(_0x35e6cb={}),_0x35e6cb['pbt']=_0x4ed460['s']),_0x619426&&(_0x35e6cb||(_0x35e6cb={}),_0x35e6cb['s']=_0x200c5d),_0x15495c&&_0x35e6cb!=null&&_0x35e6cb['v']&&_0x35e6cb['pbt']!==m[_0x385ae3(0x26b)][_0x385ae3(0x16f)]&&_0x35e6cb[_0x385ae3(0x3db)]!==m[_0x385ae3(0x26b)][_0x385ae3(0x390)]){const _0x7b03b3=String(_0x35e6cb['v']),{dateType:_0x581021}=_0x15495c;_0x35e6cb['v']=Wo(_0x63cadb,_0x581021,_0x7b03b3),_0x35e6cb['t']=v['CellValueType'][_0x385ae3(0x2cf)];}return _0x35e6cb;},Jo=(_0x22870b,_0x1fac38,_0x19692c,_0x295c66)=>{const _0x51309e=_0x58c229;var _0xc312dd,_0x22b7c6,_0x1d4eab,_0x59aa1b,_0x51f030,_0x3999d8,_0x4f4150,_0x4beaee,_0x564a80,_0x493d19,_0x34e6a9,_0x42a5d2,_0x2187c9,_0x3a9ea3;const _0x3e2a3b=_0x19692c[_0x51309e(0x18b)],{cornerView:_0x2d66b6,rowView:_0x1a3f1e,colView:_0x42f6df,dataView:_0x292ec5,pageView:_0x2b6b81,formatMap:_0x46c467,groupInfo:_0x4b751d}=_0x1fac38,{row:_0x2c0c68,col:_0x3bdc6b}=_0x3e2a3b,_0x265bea=new v[(_0x51309e(0x342))](),_0x3e62f9={},_0x2e30c4={},_0x545e46={},_0x1bec5e={},_0x57e125={};let _0x4ce7f7=_0x2c0c68,_0x54d299=_0x3bdc6b;Object['keys'](_0x2b6b81[_0x51309e(0x1bb)])[_0x51309e(0x124)](_0x4cf868=>{const _0x1ad6a5=_0x51309e;Object[_0x1ad6a5(0x284)](_0x2b6b81[_0x1ad6a5(0x1bb)][Number(_0x4cf868)])['forEach'](_0x510551=>{const _0x15544d=_0x1ad6a5,_0x40c911={..._0x2b6b81[_0x15544d(0x1bb)][Number(_0x4cf868)][Number(_0x510551)]};_0x265bea[_0x15544d(0x258)](Number(_0x4cf868)+_0x4ce7f7,Number(_0x510551)+_0x54d299,Ve(_0x22870b,_0x40c911,oe[_0x15544d(0x222)]));});});const _0x3ae3fc=Object[_0x51309e(0x284)](_0x2b6b81['data'])[_0x51309e(0x3ca)];_0x4ce7f7+=_0x3ae3fc+(_0x3ae3fc?Re:0x0);const _0x2f6e5b=_0x2d66b6[_0x51309e(0x3ef)](),_0x2b01e8=_0x2d66b6[_0x51309e(0x215)]();for(let _0x4f8eee=0x0;_0x4f8eee<_0x2f6e5b;_0x4f8eee++)for(let _0x573ee6=0x0;_0x573ee6<_0x2b01e8;_0x573ee6++){const _0x19ce86={...(_0x22b7c6=(_0xc312dd=_0x2d66b6['data'])==null?void 0x0:_0xc312dd[_0x4f8eee])==null?void 0x0:_0x22b7c6[_0x573ee6]};_0x19ce86&&((_0x1d4eab=_0x1a3f1e['headerMap'][_0x573ee6])!=null&&_0x1d4eab[_0x51309e(0x353)])&&_0x573ee6===_0x2b01e8-0x1&&_0x4f8eee===_0x2f6e5b-0x1&&(_0x19ce86['v']=''+_0x295c66[_0x51309e(0x2ce)]),_0x265bea[_0x51309e(0x258)](_0x4f8eee+_0x4ce7f7,_0x573ee6+_0x54d299,Ve(_0x22870b,_0x19ce86,oe['cornerStyle']));}for(let _0xc4d5f3=0x0;_0xc4d5f3<_0x2d66b6[_0x51309e(0x3c5)][_0x51309e(0x3ca)];_0xc4d5f3++)_0x2d66b6[_0x51309e(0x3c5)][_0xc4d5f3]&&(_0x545e46[''+(_0xc4d5f3+_0x54d299)]=_0x2d66b6['info'][_0xc4d5f3]);_0x54d299+=_0x2b01e8;const _0x17b190=_0x42f6df[_0x51309e(0x2a2)],_0x26fd4f=_0x42f6df[_0x51309e(0x27c)]()>=0x0?_0x42f6df[_0x51309e(0x27c)]()+0x1:0x0,_0x40c015=_0x42f6df[_0x51309e(0x2f4)]()>=0x0?_0x42f6df[_0x51309e(0x2f4)]()+0x1:0x0;for(let _0x2c2f9b=0x0;_0x2c2f9b<_0x40c015;_0x2c2f9b++){for(let _0x536cc5=0x0;_0x536cc5<_0x26fd4f;_0x536cc5++){const _0x4feac0={...(_0x51f030=(_0x59aa1b=_0x42f6df[_0x51309e(0x1bb)])==null?void 0x0:_0x59aa1b[_0x536cc5])==null?void 0x0:_0x51f030[_0x2c2f9b]},_0x38e932=(_0x3999d8=_0x17b190[_0x536cc5])==null?void 0x0:_0x3999d8['tableFieldId'],_0x1ef4c2=_0x46c467[_0x38e932],_0x39d771=_0x4b751d[_0x38e932];_0x4feac0&&(_0x4feac0['v']=Me(_0x4feac0,_0x536cc5===0x0&&((_0x4f4150=_0x42f6df[_0x51309e(0x1ac)](_0x2c2f9b+0x1))==null?void 0x0:_0x4f4150[_0x51309e(0x353)]),_0x1ef4c2,_0x295c66));let _0x1a19f6;_0x1ef4c2?_0x1a19f6={...oe[_0x51309e(0x1d9)],'n':{'pattern':_0x1ef4c2}}:_0x1a19f6={...oe[_0x51309e(0x1d9)]},_0x265bea[_0x51309e(0x258)](_0x536cc5+_0x4ce7f7,_0x2c2f9b+_0x54d299,Ve(_0x22870b,_0x4feac0,_0x1a19f6,_0x39d771));}_0x42f6df[_0x51309e(0x3c5)][_0x2c2f9b]&&(_0x2e30c4[''+(_0x2c2f9b+_0x54d299)]=_0x42f6df[_0x51309e(0x3c5)][_0x2c2f9b]),_0x42f6df[_0x51309e(0x2a2)][_0x2c2f9b+0x1]&&(_0x57e125[''+(_0x2c2f9b+_0x4ce7f7+0x1)]=_0x42f6df[_0x51309e(0x2a2)][_0x2c2f9b+0x1]);}_0x4ce7f7+=_0x2f6e5b;const _0x5c80b0=_0x1a3f1e['headerMap'],_0x3b6e4c=_0x1a3f1e[_0x51309e(0x27c)]()>=0x0?_0x1a3f1e['getLastRow']()+0x1:0x0,_0x50796c=_0x1a3f1e[_0x51309e(0x2f4)]()>=0x0?_0x1a3f1e['getLastCol']()+0x1:0x0;for(let _0xe71617=0x0;_0xe71617<_0x3b6e4c;_0xe71617++){for(let _0x3d6296=0x0;_0x3d6296<_0x50796c;_0x3d6296++){const _0x35b133={...(_0x564a80=(_0x4beaee=_0x1a3f1e[_0x51309e(0x1bb)])==null?void 0x0:_0x4beaee[_0xe71617])==null?void 0x0:_0x564a80[_0x3d6296]},_0x3c975e=(_0x493d19=_0x5c80b0[_0x3d6296])==null?void 0x0:_0x493d19[_0x51309e(0x2b7)],_0x397a83=_0x46c467[_0x3c975e],_0x214e1b=_0x4b751d[_0x3c975e];_0x35b133&&(_0x35b133['v']=Me(_0x35b133,!0x1,_0x397a83,_0x295c66));let _0x3c423e;_0x1a3f1e['info'][_0xe71617][_0x51309e(0x12a)]===_0x1a3f1e[_0x51309e(0x215)]()?_0x3c423e=oe[_0x51309e(0x262)]:_0x1a3f1e[_0x51309e(0x3c5)][_0xe71617][_0x51309e(0x2d0)]?_0x3c423e=_0x1a3f1e[_0x51309e(0x3c5)][_0xe71617][_0x51309e(0x12a)]===0x0?oe[_0x51309e(0x115)]:oe[_0x51309e(0x1a4)]:_0x3c423e=oe['rowStyle'],_0x397a83&&(_0x3c423e={..._0x3c423e,'n':{'pattern':_0x397a83}}),_0x265bea['setValue'](_0xe71617+_0x4ce7f7,_0x3d6296+_0x3bdc6b,Ve(_0x22870b,_0x35b133,_0x3c423e,_0x214e1b));}_0x1a3f1e['info'][_0xe71617]&&(_0x3e62f9[''+(_0xe71617+_0x4ce7f7)]=_0x1a3f1e[_0x51309e(0x3c5)][_0xe71617]),_0x1a3f1e[_0x51309e(0x2a2)][_0xe71617]&&(_0x1bec5e[''+(_0xe71617+_0x3bdc6b)]=_0x1a3f1e[_0x51309e(0x2a2)][_0xe71617]);}const _0x58ff98=_0x292ec5[_0x51309e(0x3ef)](),_0x299280=_0x292ec5[_0x51309e(0x215)]();for(let _0x8f8537=0x0;_0x8f8537<_0x58ff98;_0x8f8537++)for(let _0x1d5b42=0x0;_0x1d5b42<_0x299280;_0x1d5b42++){const _0x3f29db={...(_0x42a5d2=(_0x34e6a9=_0x292ec5[_0x51309e(0x1bb)])==null?void 0x0:_0x34e6a9[_0x8f8537])==null?void 0x0:_0x42a5d2[_0x1d5b42]};let _0x4efbfc;_0x1a3f1e[_0x51309e(0x3c5)][_0x8f8537][_0x51309e(0x2d0)]?_0x4efbfc=_0x1a3f1e[_0x51309e(0x3c5)][_0x8f8537][_0x51309e(0x12a)]===0x0?oe['grandTotal']:oe['subTotalStyle']:_0x4efbfc=oe[_0x51309e(0x322)];const _0x1c473e=_0x1a3f1e[_0x51309e(0x3c5)][_0x8f8537][_0x51309e(0x1a7)],_0x5ed428=_0x42f6df[_0x51309e(0x3c5)][_0x1d5b42][_0x51309e(0x1a7)],_0x519910=Math[_0x51309e(0x3cb)](_0x1c473e,_0x5ed428),_0x1771d2=_0x19692c['fieldsConfig']['valueFields'][_0x51309e(0x3bb)]();let _0x279ba0='';_0x519910<0x0?_0x279ba0=(_0x2187c9=_0x1771d2[0x0])!=null?_0x2187c9:'':_0x279ba0=(_0x3a9ea3=_0x1771d2[_0x519910])!=null?_0x3a9ea3:'';const _0x4c6fce=_0x46c467[_0x279ba0];_0x4c6fce&&(_0x4efbfc={..._0x4efbfc,'n':{'pattern':_0x4c6fce}}),_0x265bea[_0x51309e(0x258)](_0x8f8537+_0x4ce7f7,_0x1d5b42+_0x54d299,Ve(_0x22870b,_0x3f29db,_0x4efbfc));}return{'valueMatrix':_0x265bea,'rowInfo':_0x3e62f9,'colInfo':_0x2e30c4,'cornerInfo':_0x545e46,'rowHeaderMap':_0x1bec5e,'colHeaderMap':_0x57e125};};function Me(_0x38eb4c,_0x214cf2,_0x34849d,_0x5a00ad){const _0x4f9f56=_0x58c229;let _0x553db2=_0x38eb4c['v'];_0x214cf2&&(_0x553db2=''+_0x5a00ad[_0x4f9f56(0x2ce)]);const _0x24c30d=_0x38eb4c['t']&&(_0x38eb4c['t']&m['PivotViewCellValueTypeEnum'][_0x4f9f56(0x39a)])>0x0;_0x24c30d&&(_0x553db2=''+_0x5a00ad[_0x4f9f56(0x3ff)]);const _0x175591=_0x38eb4c['t']&&(_0x38eb4c['t']&m['PivotViewCellValueTypeEnum'][_0x4f9f56(0x189)])>0x0;if(_0x175591&&(_0x553db2=''+_0x5a00ad[_0x4f9f56(0x286)]),_0x38eb4c['s']===m[_0x4f9f56(0x26b)][_0x4f9f56(0x390)]){let _0x24eba2=_0x553db2,_0x2941a6='';m['isPrefixValue'](_0x553db2)&&(_0x24eba2=_0x553db2[_0x4f9f56(0x37c)],_0x2941a6=_0x553db2['value']);const _0x1a9dfc=_0x34849d&&!_0x24c30d&&!_0x175591?v[_0x4f9f56(0x21d)]['format'](_0x34849d,Number(_0x24eba2)):_0x24eba2;_0x2941a6?_0x553db2=_0x1a9dfc+'\x20'+_0x2941a6:_0x553db2=_0x1a9dfc+'\x20'+_0x5a00ad[_0x4f9f56(0x3e3)];}else _0x38eb4c['s']===m[_0x4f9f56(0x26b)][_0x4f9f56(0x16f)]&&(_0x553db2=_0x553db2+'\x20'+_0x5a00ad[_0x4f9f56(0x28d)]);return _0x553db2;}function Wt(_0x544cae){const _0x40096=_0x58c229;if(m[_0x40096(0x343)](_0x544cae)){const {errorType:_0xdbc5d0}=_0x544cae;switch(_0xdbc5d0){case m[_0x40096(0x2ae)]['Div0']:return ve['ErrorType'][_0x40096(0x3f6)];case m[_0x40096(0x2ae)]['NotNumber']:return ve[_0x40096(0x3d2)]['NUM'];case m[_0x40096(0x2ae)][_0x40096(0x22b)]:return ve[_0x40096(0x3d2)]['NAME'];case m[_0x40096(0x2ae)]['NotName']:return ve[_0x40096(0x3d2)]['NAME'];case m[_0x40096(0x2ae)]['BadReference']:return ve['ErrorType'][_0x40096(0x398)];}}return _0x544cae;}function ne(_0x368bfa,_0x3fabc4,_0x33cfcd=!0x1,_0x367391=!0x1){const _0x2ba4ff=_0x58c229,{data:_0x25b0a3}=_0x3fabc4,_0x1476d1=_0x3fabc4['getRowCount'](),_0x2320d5=_0x3fabc4[_0x2ba4ff(0x215)]();if(_0x1476d1<=0x0||_0x2320d5<=0x0)return[];const _0x2060d9=_0x3fabc4['getLastCol'](),_0x1b1ec9=_0x3fabc4[_0x2ba4ff(0x27c)](),_0x33fb43=_0x367391?_0x1b1ec9>=0x0?_0x1b1ec9+0x1:0x0:_0x1476d1,_0x305961=_0x367391?_0x2060d9>=0x0?_0x2060d9+0x1:0x0:_0x2320d5,{row:_0x4de144,col:_0x3f968b}=_0x368bfa,_0x3a3d0d=_0x4de144,_0x143092=_0x3f968b;if(_0x33cfcd){const _0x2c58a3=[];for(const [_0x558d57,_0x939a1c]of Object['entries'](_0x25b0a3))for(const [_0x2aea94,_0x3686d0]of Object[_0x2ba4ff(0x15f)](_0x939a1c))_0x2c58a3['push'](v['cellToRange'](_0x3a3d0d+Number(_0x558d57),_0x143092+Number(_0x2aea94)));return _0x2c58a3;}else{const _0x5d796d=_0x367391?_0x33fb43>0x0?0x1:0x0:0x1,_0x417b88=_0x367391?_0x305961>0x0?0x1:0x0:0x1,_0x4d3b5e=_0x4de144+_0x33fb43-_0x5d796d,_0xc7b343=_0x3f968b+_0x305961-_0x417b88;return[{'startRow':_0x3a3d0d,'startColumn':_0x143092,'endRow':_0x4d3b5e,'endColumn':_0xc7b343}];}}const q='SHEET_PIVOT_IN_MAIN_THREAD',bt=_0x58c229(0x2b0);var k=(_0x49adeb=>(_0x49adeb['Filter']=_0x58c229(0x1d0),_0x49adeb[_0x58c229(0x3b7)]=_0x58c229(0x227),_0x49adeb[_0x58c229(0x363)]=_0x58c229(0x259),_0x49adeb['AddPivotTableWithConfig']=_0x58c229(0x1bf),_0x49adeb[_0x58c229(0x3b9)]='addPivotTable',_0x49adeb['MovePivotField']=_0x58c229(0x2c4),_0x49adeb[_0x58c229(0x206)]=_0x58c229(0x3fa),_0x49adeb[_0x58c229(0x27e)]=_0x58c229(0x147),_0x49adeb['SetPivotFilter']=_0x58c229(0x163),_0x49adeb[_0x58c229(0x250)]='setPivotSort',_0x49adeb['SetPivotSetting']='setPivotSetting',_0x49adeb[_0x58c229(0x1e3)]=_0x58c229(0x1c9),_0x49adeb['UpdateValuePosition']=_0x58c229(0x1c7),_0x49adeb[_0x58c229(0x1b7)]='drillDown',_0x49adeb[_0x58c229(0x32b)]=_0x58c229(0x3b6),_0x49adeb['SetPivotTableConfig']=_0x58c229(0x2f7),_0x49adeb[_0x58c229(0x38c)]=_0x58c229(0x1ed),_0x49adeb))(k||{});const qo={'sheets-pivot.blankValue':_0x58c229(0x182),'sheets-pivot.columnName':_0x58c229(0x3cf),'sheets-pivot.subTotalText':_0x58c229(0x339),'sheets-pivot.grandTotalText':_0x58c229(0x2ff),'sheets-pivot.valueText':'Value','sheets-pivot.averageName':'Average\x20of\x20','sheets-pivot.countName':_0x58c229(0x23b),'sheets-pivot.countNumsName':_0x58c229(0x23b),'sheets-pivot.maxName':_0x58c229(0x2fb),'sheets-pivot.minName':_0x58c229(0x3d0),'sheets-pivot.productName':_0x58c229(0x1fb),'sheets-pivot.stdDevName':_0x58c229(0x3c4),'sheets-pivot.stdDevpName':_0x58c229(0x165),'sheets-pivot.sumName':_0x58c229(0x292),'sheets-pivot.varName':_0x58c229(0x162),'sheets-pivot.varpName':_0x58c229(0x2a1),'sheets-pivot.subTotal':_0x58c229(0x390),'sheets-pivot.grandTotal':_0x58c229(0x2ff),'sheets-pivot.value':_0x58c229(0x193),'sheets-pivot.blank':_0x58c229(0x39a),'sheets-pivot.other':'other','sheets-pivot.emptyPivot.filter':_0x58c229(0x3c0),'sheets-pivot.emptyPivot.row':'Row','sheets-pivot.emptyPivot.column':_0x58c229(0x2df),'sheets-pivot.emptyPivot.values':_0x58c229(0x12e)},At={'undos':[],'redos':[],'preUndos':[],'preRedos':[]},re=v[_0x58c229(0x3d9)](_0x58c229(0x1f2)),Jt=v[_0x58c229(0x257)](_0x58c229(0x10c));var Pe=(_0x3aae44=>(_0x3aae44[_0x58c229(0x289)]=_0x58c229(0x289),_0x3aae44['delete']=_0x58c229(0x3f7),_0x3aae44['update']=_0x58c229(0x17c),_0x3aae44))(Pe||{}),j=(_0x2ec8b3=>(_0x2ec8b3[_0x58c229(0x1af)]=_0x58c229(0x289),_0x2ec8b3[_0x58c229(0x393)]='set',_0x2ec8b3[_0x58c229(0x414)]='delete',_0x2ec8b3))(j||{});const Ft={'type':v[_0x58c229(0x3b4)]['MUTATION'],'id':_0x58c229(0x1f0),'handler':()=>!0x0},Rt={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x380),'handler':()=>!0x0},ot={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x1e7),'handler':()=>!0x0},wt={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x2a7),'handler':()=>!0x0},_t={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x246),'handler':()=>!0x0};var Ko=Object[_0x58c229(0x21f)],Ho=(_0x584a7e,_0x2128e1,_0x4ddbc4,_0x36b5a8)=>{const _0x5dfd22=_0x58c229;for(var _0x2bd24f=_0x36b5a8>0x1?void 0x0:_0x36b5a8?Ko(_0x2128e1,_0x4ddbc4):_0x2128e1,_0x5d0964=_0x584a7e[_0x5dfd22(0x3ca)]-0x1,_0x4434cd;_0x5d0964>=0x0;_0x5d0964--)(_0x4434cd=_0x584a7e[_0x5d0964])&&(_0x2bd24f=_0x4434cd(_0x2bd24f)||_0x2bd24f);return _0x2bd24f;},Yo=(_0x3eb832,_0x41b7e8)=>(_0x28b415,_0x128541)=>_0x41b7e8(_0x28b415,_0x128541,_0x3eb832);exports[_0x58c229(0x2a4)]=class extends v[_0x58c229(0x351)]{constructor(_0x23dc05){const _0x26cd16=_0x58c229;super(),x(this,'_requestResolvers',new Map()),this[_0x26cd16(0x37b)]=_0x23dc05;}[_0x58c229(0x117)](_0x54c387){const _0x11c2e4=_0x58c229,{version:_0x4ff383}=_0x54c387,_0x58b5bd=this[_0x11c2e4(0x110)][_0x11c2e4(0x15b)](_0x4ff383);_0x58b5bd&&(_0x58b5bd(_0x54c387),this[_0x11c2e4(0x110)][_0x11c2e4(0x3f7)](_0x4ff383));}['getPivotDisplayConfig'](_0x1611c3){return new Promise((_0x18c2cb,_0x1ef5bf)=>{const _0x2b5514=_0x1cc3,_0x138832=this[_0x2b5514(0x228)]();this['_requestResolvers'][_0x2b5514(0x1db)](_0x138832,_0x18c2cb),this[_0x2b5514(0x37b)][_0x2b5514(0x3aa)](Ft['id'],{'version':_0x138832,..._0x1611c3},{'onlyLocal':!0x0});});}[_0x58c229(0x228)](){const _0x504d99=_0x58c229;return Math['random']()['toString'](0x24)[_0x504d99(0x2d6)](0x2,0x10);}},exports[_0x58c229(0x2a4)]=Ho([Yo(0x0,v['Inject'](v[_0x58c229(0x341)]))],exports['SheetsPivotRPCService']);const qt={0x0:'G',0x1:'f',0x2:'u',0x3:'J',0x4:'p',0x5:'a',0x6:'9',0x7:'s',0x8:'b',0x9:'T','o':'0','v':'1','Y':'2','L':'3','M':'4','t':'5','s':'6','w':'7','E':'8','F':'c','a':'d','R':'e','h':'g','D':'h','p':'i','n':'j','l':'k','x':'l','B':'m','i':'n','d':'o','P':'q','f':'r','U':'t','y':'v','j':'w','V':'x','Q':'y','b':'z','S':'A','q':'B','g':'C','G':'D','C':'E','e':'F','A':'H','r':'I','H':'K','Z':'L','I':'M','T':'N','J':'O','k':'P','m':'Q','u':'R','N':'S','z':'U','W':'V','K':'W','X':'X','c':'Y','O':'Z'},Kt=_0x58c229(0x28b),Qo=_0x49ea63=>{const _0xfbc8c4=_0x58c229;var _0x293dcc;return((_0x293dcc=_0x49ea63['body'])==null?void 0x0:_0x293dcc['dataStream'][_0xfbc8c4(0x2a5)](/\r\n$/,''))||'';};class zo extends m[_0x58c229(0x1f1)]{constructor(_0x8a7e44,_0x2a3ab5){const _0x3ee11a=_0x58c229;super(),x(this,_0x3ee11a(0x361),{}),x(this,_0x3ee11a(0x245)),x(this,_0x3ee11a(0x166)),(this[_0x3ee11a(0x245)]=_0x2a3ab5,this['_host']=_0x8a7e44);}[_0x58c229(0x2d9)](){const _0x3098c0=_0x58c229;for(const _0xaad3fb in this['dataFields']){const _0x399a0e=this['dataFields'][_0xaad3fb],_0x18414e=_0x399a0e[_0x3098c0(0x1d3)]();this['rangeKeyMap'][_0x18414e]=_0x399a0e['getId']();}}['getAutoDisplayNameFunction'](){const _0x478cba=_0x58c229,_0xd16d9=this[_0x478cba(0x166)];return an[_0x478cba(0x32e)](_0xd16d9);}[_0x58c229(0x26e)](_0x1b5be7){const _0x97c32a=_0x58c229,_0x4d9ce8=this[_0x97c32a(0x265)][_0x1b5be7][_0x97c32a(0x293)];delete this['dataFields'][_0x1b5be7],delete this[_0x97c32a(0x361)][_0x4d9ce8];}[_0x58c229(0x260)](_0x3e3827){const _0x729a30=_0x58c229;this['dataFields'][_0x3e3827[_0x729a30(0x2ba)]()]=_0x3e3827;}[_0x58c229(0x20d)](_0x17cca1){const _0x11d4fb=_0x58c229;var _0x35f188,_0x572f82;const _0xd36e64=this[_0x11d4fb(0x166)][_0x11d4fb(0x1dd)](_0x17cca1);if(_0xd36e64){const {unitId:_0x255344,subUnitId:_0x466dd3}=_0xd36e64,_0xf0632c=(_0x35f188=this['_host'][_0x11d4fb(0x338)](_0x255344,_0x466dd3,_0x17cca1))==null?void 0x0:_0x35f188[_0x11d4fb(0x141)];this[_0x11d4fb(0x166)]['broadcastCollectionChange']({'token':_0x17cca1,'type':Pe['delete'],'dataRangeInfo':_0xf0632c});}(_0x572f82=this[_0x11d4fb(0x2af)](_0x17cca1))==null||_0x572f82['dispose'](),delete this[_0x11d4fb(0x255)][_0x17cca1];}[_0x58c229(0x1d3)](_0x53ff06,_0x3c7c4c){const {sheetName:_0x5e9b1a,unitId:_0x566d21,range:_0x24308c}=_0x53ff06,{startRow:_0x3b60eb,endRow:_0x5d703a}=_0x24308c;return ve['serializeRangeWithSpreadsheet'](_0x566d21,_0x5e9b1a,{'startRow':_0x3b60eb,'endRow':_0x5d703a,'startColumn':_0x3c7c4c,'endColumn':_0x3c7c4c});}[_0x58c229(0x113)](_0x2e5011){const _0x551df6=_0x58c229;return this[_0x551df6(0x265)][this[_0x551df6(0x361)][_0x2e5011]];}[_0x58c229(0x13b)](_0x45e883,_0x40f31c){const _0xa3ecee=_0x58c229;this[_0xa3ecee(0x361)][_0x45e883]=_0x40f31c;}[_0x58c229(0x1d8)](_0x2469ae,_0x9ccc49){const _0x19dbad=_0x58c229;this[_0x19dbad(0x361)][_0x9ccc49]=this['rangeKeyMap'][_0x2469ae],delete this[_0x19dbad(0x361)][_0x2469ae];}[_0x58c229(0x325)](_0x1d791d,_0x1a511c,_0x5c2217,_0x2839b8){const _0x41ab97=_0x58c229,_0x5a04fc=new m[(_0x41ab97(0x367))](this);_0x5a04fc[_0x41ab97(0x2b2)](_0x1a511c);const _0x529549=[];let _0x25d6db=0x0;for(const _0x2ea5f0 of _0x5a04fc[_0x41ab97(0x126)]){const _0x3446ac=this['getRangeKey'](_0x5c2217,_0x25d6db),_0x48ed9f=this[_0x41ab97(0x265)][_0x2ea5f0];_0x48ed9f&&(_0x48ed9f[_0x41ab97(0x293)]=_0x3446ac,this['setRangeKeyMap'](_0x3446ac,_0x2ea5f0),_0x529549[_0x41ab97(0x2c5)]({'index':_0x25d6db,'dataField':_0x48ed9f})),_0x25d6db++;}return this[_0x41ab97(0x183)](_0x1d791d,_0x5a04fc,_0x5c2217,_0x2839b8),{'collection':_0x5a04fc,'updateDataFieldList':_0x529549};}[_0x58c229(0x352)](_0x323b2f,_0x358029){const _0x2dc100=_0x58c229;return _0x323b2f['rangeType']===v[_0x2dc100(0x3ed)][_0x2dc100(0x1f5)]?{'startRow':0x0,'startColumn':_0x323b2f[_0x2dc100(0x1b3)],'endRow':_0x358029['getRowCount']()-0x1,'endColumn':_0x323b2f['endColumn']}:{'startRow':_0x323b2f['startRow'],'startColumn':_0x323b2f[_0x2dc100(0x1b3)],'endRow':_0x323b2f[_0x2dc100(0x12d)],'endColumn':_0x323b2f[_0x2dc100(0x1ea)]};}[_0x58c229(0x1c5)](_0x3abc97){const _0x5db2b9=_0x58c229,{sheetName:_0x2e6fd9,range:_0x460bbc}=_0x3abc97,_0x2bd114=this[_0x5db2b9(0x245)]['getCurrentUnitForType'](v[_0x5db2b9(0x232)][_0x5db2b9(0x2cb)]),_0x245dbf=_0x2bd114['getSheetBySheetName'](_0x2e6fd9),_0x135571=_0x245dbf['getCellMatrix'](),{startColumn:_0x1b74b8,startRow:_0x274aee,endColumn:_0x9ab1a2}=this[_0x5db2b9(0x352)](_0x460bbc,_0x245dbf),_0x57a83b=_0x2bd114[_0x5db2b9(0x3f1)](),_0x226e47=new m[(_0x5db2b9(0x367))](this);_0x226e47[_0x5db2b9(0x196)](_0x3abc97);const _0x414e13=[],_0x1eee9d={};for(let _0x22f2b3=_0x1b74b8;_0x22f2b3<=_0x9ab1a2;_0x22f2b3++){const _0x30533a=_0x135571[_0x5db2b9(0x2d8)](_0x274aee,_0x22f2b3),_0x4a9310=this[_0x5db2b9(0x1d3)](_0x3abc97,_0x22f2b3),_0x1a1236=this[_0x5db2b9(0x113)](_0x4a9310);if(_0x1a1236)_0x226e47[_0x5db2b9(0x3e1)](_0x1a1236['getId'](),_0x1a1236[_0x5db2b9(0x173)]());else{const _0x5cb19d=this[_0x5db2b9(0x175)]();let _0x4a3ebf=this[_0x5db2b9(0x243)](_0x30533a,_0x57a83b,_0x1eee9d);m[_0x5db2b9(0x277)](_0x4a3ebf)&&(_0x4a3ebf=v[_0x5db2b9(0x21d)][_0x5db2b9(0x194)](_0x4a3ebf['f'],Number(_0x4a3ebf['v'])));const _0x542b7e=this[_0x5db2b9(0x41a)](_0x4a3ebf,_0x22f2b3),_0x571672=new m[(_0x5db2b9(0x27b))](_0x5cb19d,_0x542b7e,m[_0x5db2b9(0x2da)](0x3));_0x571672[_0x5db2b9(0x293)]=_0x4a9310,this[_0x5db2b9(0x265)][_0x5cb19d]=_0x571672,_0x226e47['addField'](_0x5cb19d,_0x542b7e),_0x414e13[_0x5db2b9(0x2c5)]({'index':_0x22f2b3,'dataField':_0x571672});}}return{'updateDataFieldList':_0x414e13,'collection':_0x226e47};}[_0x58c229(0x3c6)](_0x4f5238){const _0x29d9fd=_0x58c229;return this[_0x29d9fd(0x166)]['getTextInfo']()['sheets-pivot.columnName']+'\x20'+v[_0x29d9fd(0x357)](_0x4f5238);}[_0x58c229(0x41a)](_0x12f96d,_0x11fcf8){const _0x16396a=_0x58c229;return _0x12f96d==null||_0x12f96d===''?this[_0x16396a(0x3c6)](_0x11fcf8):String(_0x12f96d);}[_0x58c229(0x2af)](_0x1e4c83){const _0x277c9f=_0x58c229;return this[_0x277c9f(0x255)][_0x1e4c83];}['addCollection'](_0xfa3c0a,_0x47f969,_0x4c3bde,_0x347dac){const _0xad10ef=_0x58c229;this[_0xad10ef(0x255)][_0xfa3c0a]=_0x47f969,_0x47f969[_0xad10ef(0x196)](_0x4c3bde),this[_0xad10ef(0x166)]['broadcastCollectionChange']({'token':_0xfa3c0a,'type':Pe[_0xad10ef(0x289)],'dataRangeInfo':_0x4c3bde,'targetCellInfo':_0x347dac});}['handleMoveRange'](_0x929ecc,_0x5bbf96){const _0x4d71a2=_0x58c229,_0x51fa23=this[_0x4d71a2(0x2af)](_0x929ecc),_0xb8fcd7=_0x51fa23[_0x4d71a2(0x29c)]();let _0x144267=0x0;for(const _0x46d25c of _0xb8fcd7){const _0x4a2bd6=_0x51fa23[_0x4d71a2(0x356)](_0x46d25c),_0x120c3b=this['getRangeKey'](_0x5bbf96,_0x144267);this[_0x4d71a2(0x1d8)](_0x4a2bd6['rangeKey'],_0x120c3b),_0x144267++;}}[_0x58c229(0x201)](){return{'runtimeCellData':{},'dirtyRanges':{}};}[_0x58c229(0x1c2)](_0x155730,_0x4525fa){const _0x1b7ae0=_0x58c229;if(this[_0x1b7ae0(0x2af)](_0x155730)){const _0x1bdff0=this['getRangeKeyList'](_0x4525fa),_0x4de05c=[];for(const _0x1c19da of _0x1bdff0)this[_0x1b7ae0(0x361)][_0x1c19da]!==void 0x0&&_0x4de05c[_0x1b7ae0(0x2c5)](this['rangeKeyMap'][_0x1c19da]);const _0x1a8867=this[_0x1b7ae0(0x1fe)](_0x155730),_0x259657=[],_0x7b2acd=new Set(_0x4de05c);for(const _0x1d565c of _0x1a8867)_0x7b2acd['has'](_0x1d565c)||_0x259657[_0x1b7ae0(0x2c5)](_0x1d565c);return _0x259657;}}[_0x58c229(0x1ee)](_0x78d4bd,_0x28d3f5,_0x1ec0cc,_0x3902dc,_0x2e3a98){const _0x1f3a0d=_0x58c229;return _0x28d3f5&&_0x28d3f5[_0x1f3a0d(0x2d8)](_0x3902dc,_0x2e3a98)?_0x28d3f5['getValue'](_0x3902dc,_0x2e3a98):_0x1ec0cc&&_0x1ec0cc[_0x1f3a0d(0x2d8)](_0x3902dc,_0x2e3a98)?_0x1ec0cc[_0x1f3a0d(0x2d8)](_0x3902dc,_0x2e3a98):_0x78d4bd[_0x1f3a0d(0x2d8)](_0x3902dc,_0x2e3a98);}[_0x58c229(0x33a)](_0x46e0c4,_0x2e03f5,_0x8208,_0x48e135){const _0x1a4ede=_0x58c229,_0x5f1a68=this[_0x1a4ede(0x265)][_0x46e0c4];if(!_0x5f1a68)return;const {subUnitId:_0x709429,range:_0x2df306,unitId:_0x2a622b}=_0x2e03f5,_0x4c7c3f=this['_univerInstanceService'][_0x1a4ede(0x2cc)](_0x2a622b);if(!_0x4c7c3f){console[_0x1a4ede(0x159)](_0x1a4ede(0x152));return;}const _0x58bc57=_0x4c7c3f[_0x1a4ede(0x3a8)](_0x709429),_0x4c1a29=_0x58bc57[_0x1a4ede(0x280)](),{arrayFormulaCellDataMatrix:_0x1c60e7,unitDataMatrix:_0x19b72c}=_0x48e135||{},{startRow:_0x1bfa33,startColumn:_0xa6e333,endRow:_0x4a6f2f}=this[_0x1a4ede(0x352)](_0x2df306,_0x58bc57);_0x5f1a68[_0x1a4ede(0x3bc)]();const _0x48e81e=_0x4c7c3f['getStyles'](),_0x440b38={},_0x3dc70a=this[_0x1a4ede(0x1ee)](_0x4c1a29,_0x1c60e7,_0x19b72c,_0x1bfa33,_0xa6e333+_0x8208);let _0x566bf5=this[_0x1a4ede(0x243)](_0x3dc70a,_0x48e81e,_0x440b38);m[_0x1a4ede(0x277)](_0x566bf5)&&(_0x566bf5=v[_0x1a4ede(0x21d)][_0x1a4ede(0x194)](_0x566bf5['f'],Number(_0x566bf5['v'])));const _0x48e3f6=this[_0x1a4ede(0x41a)](_0x566bf5,_0xa6e333+_0x8208);_0x5f1a68[_0x1a4ede(0x323)](_0x48e3f6);for(let _0x52b23c=_0x1bfa33+0x1;_0x52b23c<=_0x4a6f2f;_0x52b23c++){const _0x3d257d=this[_0x1a4ede(0x1ee)](_0x4c1a29,_0x1c60e7,_0x19b72c,_0x52b23c,_0xa6e333+_0x8208);_0x5f1a68['addRecord'](this[_0x1a4ede(0x243)](_0x3d257d,_0x48e81e,_0x440b38),_0x52b23c-0x1-_0x1bfa33);}}['refreshData'](_0x39c231,_0x385a3a,_0x4385ea){const _0x794f89=_0x58c229,{subUnitId:_0x94cd5b,range:_0x3eba18,unitId:_0x4f21f2}=_0x4385ea,_0x272d87=this['_univerInstanceService'][_0x794f89(0x2cc)](_0x4f21f2);if(!_0x272d87){console[_0x794f89(0x159)]('workbook\x20is\x20not\x20found');return;}const _0x49f0e7=_0x272d87[_0x794f89(0x3a8)](_0x94cd5b),_0x58fcd5=_0x49f0e7['getCellMatrix'](),{startRow:_0x52cb3d,startColumn:_0x158d12,endRow:_0x221c12}=this[_0x794f89(0x352)](_0x3eba18,_0x49f0e7),_0x5522f7=_0x272d87[_0x794f89(0x3f1)](),_0x3526e6={};for(const {dataField:_0x4a8893,index:_0x10c67d}of _0x385a3a){_0x4a8893[_0x794f89(0x3bc)]();const _0x56c19=this[_0x794f89(0x1ee)](_0x58fcd5,void 0x0,void 0x0,_0x52cb3d,_0x158d12+_0x10c67d);let _0x238645=this[_0x794f89(0x243)](_0x56c19,_0x5522f7,_0x3526e6);m[_0x794f89(0x277)](_0x238645)&&(_0x238645=v[_0x794f89(0x21d)][_0x794f89(0x194)](_0x238645['f'],Number(_0x238645['v'])));const _0x5ca3aa=this['uniqueDataFieldName'](_0x238645,_0x158d12+_0x10c67d);_0x4a8893['setName'](_0x5ca3aa);}_0x39c231['updateAllDisplayName']();for(let _0x54ebab=_0x52cb3d+0x1;_0x54ebab<=_0x221c12;_0x54ebab++)for(const {index:_0x353d05,dataField:_0x31b882}of _0x385a3a){const _0x1c222e=_0x58fcd5['getValue'](_0x54ebab,_0x158d12+_0x353d05);_0x31b882[_0x794f89(0x3ae)](this[_0x794f89(0x243)](_0x1c222e,_0x5522f7,_0x3526e6),_0x54ebab-0x1-_0x52cb3d);}_0x39c231[_0x794f89(0x34f)](_0x221c12-_0x52cb3d);}[_0x58c229(0x24b)](_0x198bf2){const _0x594df7=_0x58c229,{range:_0x56eca8}=_0x198bf2,{startColumn:_0x105e35,endColumn:_0x27caa1}=_0x56eca8,_0x73f0c7=[];for(let _0x465ce9=_0x105e35;_0x465ce9<=_0x27caa1;_0x465ce9++)_0x73f0c7[_0x594df7(0x2c5)](this['getRangeKey'](_0x198bf2,_0x465ce9));return _0x73f0c7;}[_0x58c229(0x243)](_0x89076f,_0x30f6c6,_0x40d39b){const _0x1de11a=_0x58c229;if(_0x89076f){const {s:_0x3c008d,v:_0x34e227,t:_0x33cb6,p:_0x32a1a1}=_0x89076f;if(_0x32a1a1)return Qo(_0x32a1a1);const _0x577fb6=_0x30f6c6[_0x1de11a(0x15b)](_0x3c008d);if(_0x577fb6&&_0x33cb6===v[_0x1de11a(0x2a8)][_0x1de11a(0x112)]&&_0x577fb6['n']){const {pattern:_0x314030}=_0x577fb6['n'];_0x40d39b[_0x314030]||(_0x40d39b[_0x314030]=v[_0x1de11a(0x21d)]['getFormatInfo'](_0x314030));const _0xc97973=_0x40d39b[_0x314030],_0x210841=_0xc97973['isDate'];if(_0xc97973[_0x1de11a(0x203)])return String(_0x34e227);if(_0x210841)return{'v':_0x34e227,'f':_0x314030};}if(_0x33cb6===v['CellValueType']['NUMBER'])return Number(_0x34e227);if(_0x33cb6===v['CellValueType'][_0x1de11a(0x2cf)]||_0x33cb6===v['CellValueType'][_0x1de11a(0x30c)])return String(_0x34e227);if(_0x33cb6===void 0x0){const _0x24ef32=Number(_0x34e227);if(!Number['isNaN'](_0x24ef32)&&String(_0x24ef32)===_0x34e227)return _0x24ef32;}return _0x34e227!=null?_0x34e227:null;}else return null;}['getRangeData'](_0x3c7163){const _0x15fbb2=_0x58c229,{sheetName:_0x2f30d1,range:_0x37b4bc,unitId:_0xb87e98}=_0x3c7163,_0x30ff03=this['_univerInstanceService'][_0x15fbb2(0x2cc)](_0xb87e98);if(!_0x30ff03)return console[_0x15fbb2(0x159)](_0x15fbb2(0x152)),{'header':[],'data':[]};const _0x53772a=_0x30ff03[_0x15fbb2(0x36f)](_0x2f30d1),_0x30457a=_0x53772a[_0x15fbb2(0x280)](),{startRow:_0x202de2,startColumn:_0x56aa10,endRow:_0x180e60,endColumn:_0x4684db}=this['getRangeStartEndInfo'](_0x37b4bc,_0x53772a),_0x7026c7=_0x30ff03[_0x15fbb2(0x3f1)](),_0x162316=[],_0x33e8ef=[],_0x22837f={};for(let _0x356eff=_0x202de2;_0x356eff<=_0x180e60;_0x356eff++){const _0x47a073=[];for(let _0x1a1772=_0x56aa10;_0x1a1772<=_0x4684db;_0x1a1772++){const _0x21d957=_0x30457a[_0x15fbb2(0x2d8)](_0x356eff,_0x1a1772);_0x356eff===_0x202de2?_0x162316[_0x15fbb2(0x2c5)](_0x21d957==null?null:String(_0x21d957['v'])):_0x47a073[_0x15fbb2(0x2c5)](this[_0x15fbb2(0x243)](_0x21d957,_0x7026c7,_0x22837f));}_0x33e8ef['push'](_0x47a073);}return{'header':_0x162316,'data':_0x33e8ef};}[_0x58c229(0x128)](){const _0x53a2a7=_0x58c229;return super[_0x53a2a7(0x128)]();}[_0x58c229(0x2b2)](_0x531fb1){const _0x3271d5=_0x58c229;super[_0x3271d5(0x2b2)](_0x531fb1),this[_0x3271d5(0x2d9)]();}['dispose'](){const _0x349f49=_0x58c229;super[_0x349f49(0x33d)](),this[_0x349f49(0x361)]={},this['_host']=null;}}const Xo=_0xc4a82=>{const _0x3719c9=_0x58c229,{targetCellInfo:_0x10fe05}=_0xc4a82,{matrixCache:_0x1c830c,rangesCache:_0x188f06}=Ht({'filter':_0x3719c9(0x3c0),'row':_0x3719c9(0x388),'column':'Column','values':_0x3719c9(0x12e)},_0x10fe05),_0x2ff21b=new v[(_0x3719c9(0x342))]();return _0x1c830c[_0x3719c9(0x407)]((_0x5dfa17,_0x2ec676,_0x2c754b)=>{const _0x3f76c5=_0x3719c9;_0x2ff21b[_0x3f76c5(0x258)](_0x5dfa17,_0x2ec676,_0x2c754b);}),{'matrix':_0x2ff21b,'rangesCache':_0x188f06};},xe=_0x1b5d6b=>{const _0x2587e1=_0x58c229;let _0x1d50ae;if(_0x1b5d6b!=null&&_0x1b5d6b['v']||(_0x1b5d6b==null?void 0x0:_0x1b5d6b['v'])===0x0){_0x1d50ae||(_0x1d50ae={});const _0x4d3cad=Wt(_0x1b5d6b['v']);typeof _0x4d3cad==_0x2587e1(0x38d)?_0x1d50ae['t']=v[_0x2587e1(0x2a8)][_0x2587e1(0x112)]:typeof _0x4d3cad==_0x2587e1(0x268)&&(_0x1d50ae['t']=v['CellValueType']['STRING']),_0x1d50ae['v']=_0x4d3cad;}return _0x1d50ae;},Zo=(_0x104d08,_0x15ce0f,_0xd87423)=>{const _0x490dd2=_0x58c229;var _0x17987a,_0x1c2b4,_0xc563b5,_0x46b8fb,_0x66064e,_0x4f20ac,_0x298b7e,_0x35ba01,_0x41495c,_0x143cce,_0x24a521,_0x4369ab;const {cornerView:_0x364794,rowView:_0x249a5a,colView:_0x1fd8c6,dataView:_0x3335b6,pageView:_0x3d3531,formatMap:_0x2d4664}=_0x104d08,{row:_0x5d3baa,col:_0x37c904}=_0x15ce0f,_0x35c7ee=new v[(_0x490dd2(0x342))]();let _0xbe33ad=_0x5d3baa,_0x1dafa1=_0x37c904;Object[_0x490dd2(0x284)](_0x3d3531[_0x490dd2(0x1bb)])[_0x490dd2(0x124)](_0x12273d=>{const _0x55657f=_0x490dd2;Object[_0x55657f(0x284)](_0x3d3531[_0x55657f(0x1bb)][Number(_0x12273d)])[_0x55657f(0x124)](_0x13d482=>{const _0x4099be=_0x55657f,_0x468866={..._0x3d3531[_0x4099be(0x1bb)][Number(_0x12273d)][Number(_0x13d482)]};_0x35c7ee[_0x4099be(0x258)](Number(_0x12273d)+_0xbe33ad,Number(_0x13d482)+_0x1dafa1,xe(_0x468866));});});const _0x1ddf6a=Object[_0x490dd2(0x284)](_0x3d3531[_0x490dd2(0x1bb)])[_0x490dd2(0x3ca)];_0xbe33ad+=_0x1ddf6a+(_0x1ddf6a?Re:0x0);const _0x178cfa=_0x364794[_0x490dd2(0x3ef)](),_0x592a7b=_0x364794[_0x490dd2(0x215)]();for(let _0x2f457e=0x0;_0x2f457e<_0x178cfa;_0x2f457e++)for(let _0x413ca3=0x0;_0x413ca3<_0x592a7b;_0x413ca3++){const _0x406885={...(_0x1c2b4=(_0x17987a=_0x364794['data'])==null?void 0x0:_0x17987a[_0x2f457e])==null?void 0x0:_0x1c2b4[_0x413ca3]};_0x406885&&((_0xc563b5=_0x249a5a[_0x490dd2(0x2a2)][_0x413ca3])!=null&&_0xc563b5[_0x490dd2(0x353)])&&_0x413ca3===_0x592a7b-0x1&&_0x2f457e===_0x178cfa-0x1&&(_0x406885['v']=''+_0xd87423[_0x490dd2(0x2ce)]),_0x35c7ee[_0x490dd2(0x258)](_0x2f457e+_0xbe33ad,_0x413ca3+_0x1dafa1,xe(_0x406885));}_0x1dafa1+=_0x592a7b;const _0x1d88e7=_0x1fd8c6[_0x490dd2(0x2a2)],_0x3020c5=_0x1fd8c6[_0x490dd2(0x27c)]()>=0x0?_0x1fd8c6[_0x490dd2(0x27c)]()+0x1:0x0,_0x4d066b=_0x1fd8c6['getLastCol']()>=0x0?_0x1fd8c6[_0x490dd2(0x2f4)]()+0x1:0x0;for(let _0xeec007=0x0;_0xeec007<_0x4d066b;_0xeec007++)for(let _0x2e95b9=0x0;_0x2e95b9<_0x3020c5;_0x2e95b9++){const _0x1346dc={...(_0x66064e=(_0x46b8fb=_0x1fd8c6[_0x490dd2(0x1bb)])==null?void 0x0:_0x46b8fb[_0xeec007])==null?void 0x0:_0x66064e[_0x2e95b9]},_0x45b5b3=(_0x4f20ac=_0x1d88e7[_0xeec007])==null?void 0x0:_0x4f20ac[_0x490dd2(0x2b7)],_0x3c728b=_0x2d4664[_0x45b5b3];_0x1346dc&&(_0x1346dc['v']=Me(_0x1346dc,_0xeec007===0x0&&((_0x298b7e=_0x1fd8c6['getHeaderMapItem'](_0x2e95b9+0x1))==null?void 0x0:_0x298b7e[_0x490dd2(0x353)]),_0x3c728b,_0xd87423)),_0x35c7ee[_0x490dd2(0x258)](_0xeec007+_0xbe33ad,_0x2e95b9+_0x1dafa1,xe(_0x1346dc));}_0xbe33ad+=_0x178cfa;const _0x50d859=_0x249a5a[_0x490dd2(0x2a2)],_0x37ee49=_0x249a5a[_0x490dd2(0x27c)]()>=0x0?_0x249a5a[_0x490dd2(0x27c)]()+0x1:0x0,_0x59c047=_0x249a5a['getLastCol']()>=0x0?_0x249a5a[_0x490dd2(0x2f4)]()+0x1:0x0;for(let _0x57b2cc=0x0;_0x57b2cc<_0x37ee49;_0x57b2cc++)for(let _0xa13656=0x0;_0xa13656<_0x59c047;_0xa13656++){const _0x26a05b={...(_0x41495c=(_0x35ba01=_0x249a5a[_0x490dd2(0x1bb)])==null?void 0x0:_0x35ba01[_0x57b2cc])==null?void 0x0:_0x41495c[_0xa13656]},_0x3beebe=(_0x143cce=_0x50d859[_0xa13656])==null?void 0x0:_0x143cce[_0x490dd2(0x2b7)],_0xea6985=_0x2d4664[_0x3beebe];_0x26a05b&&(_0x26a05b['v']=Me(_0x26a05b,!0x1,_0xea6985,_0xd87423)),_0x35c7ee['setValue'](_0x57b2cc+_0xbe33ad,_0xa13656+_0x37c904,xe(_0x26a05b));}const _0x44b4ae=_0x3335b6[_0x490dd2(0x3ef)](),_0x497b27=_0x3335b6[_0x490dd2(0x215)]();for(let _0x530266=0x0;_0x530266<_0x44b4ae;_0x530266++)for(let _0x34b939=0x0;_0x34b939<_0x497b27;_0x34b939++){const _0x4c196b={...(_0x4369ab=(_0x24a521=_0x3335b6[_0x490dd2(0x1bb)])==null?void 0x0:_0x24a521[_0x530266])==null?void 0x0:_0x4369ab[_0x34b939]};_0x35c7ee[_0x490dd2(0x258)](_0x530266+_0xbe33ad,_0x34b939+_0x1dafa1,xe(_0x4c196b));}return _0x35c7ee;},en=_0x279e59=>{const _0x58db87=_0x58c229,{view:_0x5b2568,targetCellInfo:_0x2dc697,isEmpty:_0x5c81e8,textInfo:_0x8f8c06}=_0x279e59;if(_0x5c81e8)return Xo(_0x279e59);const {pageView:_0x4496cc,cornerView:_0x51d520,rowView:_0x3f92f5,colView:_0x592b7a,dataView:_0x3b907e}=_0x5b2568,_0xa9e3cb=ne(_0x2dc697,_0x4496cc,!0x0),_0x31144f=_0x4496cc['lastRow']>=0x0?_0x4496cc[_0x58db87(0x217)]+0x1:0x0,_0x5bf6ab=_0x51d520[_0x58db87(0x3ef)](),_0x115f1d=_0x51d520[_0x58db87(0x215)](),_0x179c7d=_0xa9e3cb[_0x58db87(0x3ca)]>0x0?Re:0x0,_0x8bd3c7=ne({'row':_0x2dc697[_0x58db87(0x1d4)]+_0x31144f+_0x179c7d,'col':_0x2dc697[_0x58db87(0x178)]},_0x51d520,!0x1,!0x1),_0x4a2413=ne({'row':_0x2dc697[_0x58db87(0x1d4)]+_0x31144f+_0x179c7d+_0x5bf6ab,'col':_0x2dc697[_0x58db87(0x178)]},_0x3f92f5,!0x1,!0x0),_0x14aeb2=ne({'row':_0x2dc697['row']+_0x31144f+_0x179c7d,'col':_0x2dc697[_0x58db87(0x178)]+_0x115f1d},_0x592b7a,!0x1,!0x0),_0x1cf2dd=ne({'row':_0x2dc697[_0x58db87(0x1d4)]+_0x31144f+_0x179c7d+_0x5bf6ab,'col':_0x2dc697['col']+_0x115f1d},_0x3b907e,!0x1,!0x1),_0x324ccc={'rowRanges':_0x4a2413,'colRanges':_0x14aeb2,'cornerRanges':_0x8bd3c7,'dataRanges':_0x1cf2dd,'pageRanges':_0xa9e3cb};return{'matrix':Zo(_0x5b2568,_0x2dc697,_0x8f8c06),'rangesCache':_0x324ccc};};function _0x1cc3(_0x400911,_0x554bf5){_0x400911=_0x400911-0x10c;const _0x52e67c=_0x52e6();let _0x1cc3a8=_0x52e67c[_0x400911];return _0x1cc3a8;}var tn=Object[_0x58c229(0x21f)],on=(_0x6062e,_0x145812,_0x763535,_0x1adc32)=>{const _0x1e5b0e=_0x58c229;for(var _0x27af1e=_0x1adc32>0x1?void 0x0:_0x1adc32?tn(_0x145812,_0x763535):_0x145812,_0x5e054c=_0x6062e[_0x1e5b0e(0x3ca)]-0x1,_0x42933f;_0x5e054c>=0x0;_0x5e054c--)(_0x42933f=_0x6062e[_0x5e054c])&&(_0x27af1e=_0x42933f(_0x27af1e)||_0x27af1e);return _0x27af1e;},Oe=(_0xe483b8,_0x1203d3)=>(_0x46da8f,_0x4a361c)=>_0x1203d3(_0x46da8f,_0x4a361c,_0xe483b8);exports[_0x58c229(0x297)]=class extends v[_0x58c229(0x351)]{constructor(_0x1f6e09,_0x29523e,_0x3b839a,_0x15e33a,_0x33d105){const _0x37e670=_0x58c229;super(),x(this,_0x37e670(0x123),new Map()),x(this,_0x37e670(0x2a9),new Map()),x(this,'_viewData',new Map()),x(this,_0x37e670(0x318)),x(this,_0x37e670(0x35b),new ge[(_0x37e670(0x2c9))]()),x(this,_0x37e670(0x418),this[_0x37e670(0x35b)][_0x37e670(0x2cd)]()),x(this,_0x37e670(0x12b),new ge[(_0x37e670(0x2c9))]()),x(this,_0x37e670(0x2e5),this[_0x37e670(0x12b)]['asObservable']()),x(this,_0x37e670(0x1aa),new ge['Subject']()),x(this,_0x37e670(0x191),this[_0x37e670(0x1aa)][_0x37e670(0x2cd)]()),x(this,_0x37e670(0x346),new Map()),x(this,_0x37e670(0x316),[]),x(this,'_queryingMap',new Map()),(this[_0x37e670(0x20c)]=_0x1f6e09,this[_0x37e670(0x245)]=_0x29523e,this[_0x37e670(0x1e4)]=_0x3b839a,this[_0x37e670(0x37b)]=_0x15e33a,this[_0x37e670(0x22a)]=_0x33d105,this[_0x37e670(0x1b5)]());}[_0x58c229(0x15c)](){const _0x1e48a6=_0x58c229;return this[_0x1e48a6(0x318)]?this[_0x1e48a6(0x318)]:qo;}[_0x58c229(0x24e)](_0x5bbf16){this['_textInfo']=_0x5bbf16;}[_0x58c229(0x2ad)](_0x403c0f){const _0x186005=_0x58c229;var _0x5e4ae1;const {from:_0x1f7c3c,to:_0x276b84,unitId:_0x5bd0cd,fromRange:_0x3c7ca2,toRange:_0x327dc3}=_0x403c0f;if(_0x1f7c3c&&_0x276b84){const _0x9d451=this[_0x186005(0x34d)](_0x5bd0cd),_0x3e6d1a=this[_0x186005(0x123)][_0x186005(0x15b)](_0x5bd0cd),_0x406416=(_0x5e4ae1=this[_0x186005(0x245)]['getUnit'](_0x5bd0cd))==null?void 0x0:_0x5e4ae1[_0x186005(0x3a8)](_0x276b84[_0x186005(0x2f1)]);if(!_0x3e6d1a||!_0x406416)return;const _0x3cf63d=_0x406416==null?void 0x0:_0x406416[_0x186005(0x173)]();for(const [_0x14321,_0x1e79ab]of _0x3e6d1a['entries']())for(const [_0x54e66d,_0x2a2dbb]of _0x1e79ab['entries']()){const {sourceRangeInfo:_0x28fe21}=_0x2a2dbb;if(_0x28fe21[_0x186005(0x204)]===_0x5bd0cd&&_0x28fe21[_0x186005(0x2f1)]===_0x1f7c3c[_0x186005(0x2f1)]&&v[_0x186005(0x22f)][_0x186005(0x273)](_0x3c7ca2,_0x28fe21['range'])){const _0x2e3288={'row':_0x28fe21[_0x186005(0x13a)]['startRow']-_0x3c7ca2[_0x186005(0x1fd)],'col':_0x28fe21[_0x186005(0x13a)][_0x186005(0x1b3)]-_0x3c7ca2['startColumn']},_0x65560={'unitId':_0x5bd0cd,'subUnitId':_0x276b84[_0x186005(0x2f1)],'sheetName':_0x3cf63d,'range':{'startRow':_0x327dc3[_0x186005(0x1fd)]+_0x2e3288[_0x186005(0x1d4)],'endRow':_0x327dc3[_0x186005(0x1fd)]+_0x2e3288['row']+_0x28fe21[_0x186005(0x13a)][_0x186005(0x12d)]-_0x28fe21[_0x186005(0x13a)][_0x186005(0x1fd)],'startColumn':_0x327dc3[_0x186005(0x1b3)]+_0x2e3288[_0x186005(0x178)],'endColumn':_0x327dc3[_0x186005(0x1b3)]+_0x2e3288[_0x186005(0x178)]+_0x28fe21['range'][_0x186005(0x1ea)]-_0x28fe21[_0x186005(0x13a)][_0x186005(0x1b3)]}};_0x9d451['handleMoveRange'](_0x54e66d,_0x65560);const _0x3bfd5a={..._0x2a2dbb,'sourceRangeInfo':_0x65560};this['_updateModelCache'](_0x5bd0cd,_0x276b84[_0x186005(0x2f1)],_0x54e66d,_0x3bfd5a),this[_0x186005(0x28e)]({'unitId':_0x5bd0cd,'token':_0x54e66d,'type':Pe[_0x186005(0x17c)],'oldSourceRangeInfo':_0x28fe21,'dataRangeInfo':_0x65560,'targetCellInfo':_0x2a2dbb[_0x186005(0x18b)]}),this[_0x186005(0x202)]({'unitId':_0x5bd0cd,'subUnitId':_0x276b84['subUnitId'],'oldSubUnitId':_0x14321,'pivotTableId':_0x54e66d,'pivotTableConfig':_0x3bfd5a,'collectionConfig':_0x9d451[_0x186005(0x128)]()});}}}}[_0x58c229(0x28e)](_0xd06c14){const _0x2ea6d3=_0x58c229;this[_0x2ea6d3(0x35b)]['next'](_0xd06c14);}[_0x58c229(0x34d)](_0x554e99){const _0x48c21b=_0x58c229;let _0x330f5e=this[_0x48c21b(0x346)][_0x48c21b(0x15b)](_0x554e99);return _0x330f5e||(_0x330f5e=new zo(this,this[_0x48c21b(0x245)]),this[_0x48c21b(0x346)][_0x48c21b(0x1db)](_0x554e99,_0x330f5e)),_0x330f5e;}[_0x58c229(0x2af)](_0x24a224,_0x4220b9){const _0x4f3a58=_0x58c229;return this[_0x4f3a58(0x34d)](_0x24a224)[_0x4f3a58(0x255)][_0x4220b9];}['getUpdateRangeDeleteIds'](_0x3bb1cc,_0x802bc9,_0x1531bf){const _0x2a2947=_0x58c229;return this[_0x2a2947(0x34d)](_0x3bb1cc)['getUpdateRangeDeleteIds'](_0x802bc9,_0x1531bf);}[_0x58c229(0x294)](_0x12685b,_0x12cb69){const _0xa21153=_0x58c229;let _0x535abc=this[_0xa21153(0x123)]['get'](_0x12685b);_0x535abc||(_0x535abc=new Map(),this[_0xa21153(0x123)][_0xa21153(0x1db)](_0x12685b,_0x535abc));let _0x558fb5=_0x535abc[_0xa21153(0x15b)](_0x12cb69);return _0x558fb5||(_0x558fb5=new Map(),_0x535abc['set'](_0x12cb69,_0x558fb5)),_0x558fb5;}[_0x58c229(0x3f8)](_0x33581f,_0x508728,_0x128c56,_0x244687){const _0x28df48=_0x58c229;this[_0x28df48(0x294)](_0x33581f,_0x508728)[_0x28df48(0x1db)](_0x128c56,_0x244687);}[_0x58c229(0x321)](_0x23b2d3,_0x4719a4,_0x1c949f){const _0x420b4e=_0x58c229;var _0x81f683,_0x4bc2f9,_0xae213e,_0x53d029;((_0x4bc2f9=(_0x81f683=this[_0x420b4e(0x123)][_0x420b4e(0x15b)](_0x23b2d3))==null?void 0x0:_0x81f683[_0x420b4e(0x15b)](_0x4719a4))==null?void 0x0:_0x4bc2f9['get'](_0x1c949f))&&((_0x53d029=(_0xae213e=this['_model'][_0x420b4e(0x15b)](_0x23b2d3))==null?void 0x0:_0xae213e[_0x420b4e(0x15b)](_0x4719a4))==null||_0x53d029[_0x420b4e(0x3f7)](_0x1c949f));}[_0x58c229(0x3c7)](_0x202e7b,_0x3f6f3f){const _0x455300=_0x58c229;this[_0x455300(0x2a9)][_0x455300(0x1db)](_0x202e7b,_0x3f6f3f);}['_deletePivotTableInstanceCache'](_0x69a633){const _0x1d9533=_0x58c229;this['_pivotTableInstanceCache'][_0x1d9533(0x3f7)](_0x69a633);}[_0x58c229(0x151)](_0x34b7da,_0x24fd92){const _0x1bc8d1=_0x58c229;let _0x151826=this[_0x1bc8d1(0x184)][_0x1bc8d1(0x15b)](_0x34b7da);_0x151826||(_0x151826=new Map(),this[_0x1bc8d1(0x184)][_0x1bc8d1(0x1db)](_0x34b7da,_0x151826));let _0x1e7c8a=_0x151826[_0x1bc8d1(0x15b)](_0x24fd92);return _0x1e7c8a||(_0x1e7c8a=new Map(),_0x151826[_0x1bc8d1(0x1db)](_0x24fd92,_0x1e7c8a)),_0x1e7c8a;}[_0x58c229(0x202)](_0xe38dad){const _0xe41aec=_0x58c229,{unitId:_0x294d0b,subUnitId:_0xe94309,pivotTableId:_0x50d1fc,pivotTableConfig:_0x212679,collectionConfig:_0x3aa618}=_0xe38dad,_0x492ae5={'unitId':_0x294d0b,'subUnitId':_0xe94309,'oldSubUnitId':_0xe94309,'pivotTableId':_0x50d1fc,'pivotTableConfig':_0x212679,'collectionConfig':_0x3aa618};this[_0xe41aec(0x37b)][_0xe41aec(0x3aa)](wt['id'],_0x492ae5,{'onlyLocal':!0x0});}[_0x58c229(0x1cd)](_0x1a26a4,_0x2c8394,_0x11cdac,_0x5a1be1,_0x420a5a,_0x22c445,_0x1df65d,_0x56c963=!0x1){const _0x445729=_0x58c229;var _0x35ad3f;this['_commandService'][_0x445729(0x3aa)](ot['id'],{'single':{'unitId':_0x1a26a4,'subUnitId':_0x2c8394,'type':_0x11cdac,'pivotTableId':_0x5a1be1,'view':_0x420a5a,'pivotConfig':_0x22c445},'collectionConfig':{[_0x1a26a4]:_0x1df65d}},{'onlyLocal':!0x0});const _0x505ae3=!!((_0x35ad3f=this[_0x445729(0x1a5)](_0x5a1be1))!=null&&_0x35ad3f[_0x445729(0x301)]()),_0x359fbb=this[_0x445729(0x338)](_0x1a26a4,_0x2c8394,_0x5a1be1);_0x359fbb&&this[_0x445729(0x248)]({'view':_0x420a5a,'pivotTableId':_0x5a1be1,'textInfo':this[_0x445729(0x15c)](),'isEmpty':_0x505ae3,'targetCellInfo':_0x359fbb[_0x445729(0x18b)]},_0x56c963);}[_0x58c229(0x248)](_0x3bc7ae,_0x3f4ac9){const _0x153e5e=_0x58c229,{targetCellInfo:_0xb0f8b4,pivotTableId:_0x272788}=_0x3bc7ae,{unitId:_0x46d382,subUnitId:_0x1a928c}=_0xb0f8b4,_0x4c66f3=this[_0x153e5e(0x151)](_0x46d382,_0x1a928c),_0x2cd444=_0x4c66f3[_0x153e5e(0x15b)](_0x272788);let _0x2dbc6e,_0x432200;_0x2cd444&&(_0x2dbc6e=_0x2cd444['rangeCache'],_0x432200=_0x2cd444[_0x153e5e(0x231)]);const {rangesCache:_0x38260a,matrix:_0x1361d5}=en(_0x3bc7ae);_0x4c66f3[_0x153e5e(0x1db)](_0x272788,{'rangeCache':_0x38260a,'matrix':_0x1361d5,'oldMatrix':_0x432200,'oldRangeCache':_0x2dbc6e}),_0x3f4ac9||this[_0x153e5e(0x12b)][_0x153e5e(0x3f0)]({'unitId':_0x46d382,'subUnitId':_0x1a928c,'pivotTableId':_0x272788});}[_0x58c229(0x373)](_0x278585,_0x2001d6,_0x14c425,_0x9e1b,_0x18f4ce){const _0x32aaf6=_0x58c229;this['_updateModelCache'](_0x278585,_0x2001d6,_0x14c425,_0x18f4ce),this[_0x32aaf6(0x3c7)](_0x14c425,_0x9e1b);}[_0x58c229(0x2fe)](_0x2a8172,_0x51b354,_0x4ca7f8){const _0x13604d=_0x58c229,_0x264c18=this['getDataFieldManager'](_0x2a8172);_0x264c18['getNoUsedDataFieldIds'](_0x4ca7f8)['forEach'](_0x22bca7=>{_0x264c18['deleteDataField'](_0x22bca7);}),this[_0x13604d(0x32f)](_0x2a8172,_0x4ca7f8),this[_0x13604d(0x321)](_0x2a8172,_0x51b354,_0x4ca7f8),this['_deletePivotTableInstanceCache'](_0x4ca7f8);}['setPivotTable'](_0xb19f11,_0x5bf643,_0x5bdff5,_0x32f8f3){const _0x28ac3c=_0x58c229;this[_0x28ac3c(0x3f8)](_0xb19f11,_0x5bf643,_0x5bdff5,_0x32f8f3);}['getPivotTableConfig'](_0x2b4e4,_0x3e09c5,_0x454db9){const _0xffd205=_0x58c229;var _0x1977cf,_0x14393a;const _0xc5a01f=(_0x14393a=(_0x1977cf=this[_0xffd205(0x123)][_0xffd205(0x15b)](_0x2b4e4))==null?void 0x0:_0x1977cf[_0xffd205(0x15b)](_0x3e09c5))==null?void 0x0:_0x14393a[_0xffd205(0x15b)](_0x454db9);if(_0xc5a01f)return _0xc5a01f;}['getPivotTableModelConfig'](_0x22431e,_0xc3e3cb,_0x432736){const _0xd0b3fc=_0x58c229;var _0x49e378,_0x4ac6f3;const _0x34f5d3=(_0x4ac6f3=(_0x49e378=this[_0xd0b3fc(0x123)][_0xd0b3fc(0x15b)](_0x22431e))==null?void 0x0:_0x49e378[_0xd0b3fc(0x15b)](_0xc3e3cb))==null?void 0x0:_0x4ac6f3[_0xd0b3fc(0x15b)](_0x432736);if(_0x34f5d3)return _0x34f5d3['fieldsConfig'];}['getPivotTableInstance'](_0x8dbc4f){const _0x58ba22=_0x58c229;return this[_0x58ba22(0x2a9)][_0x58ba22(0x15b)](_0x8dbc4f);}[_0x58c229(0x264)](_0x38e9ad){const _0x38421a=_0x58c229;this[_0x38421a(0x123)][_0x38421a(0x3f7)](_0x38e9ad);const _0x1d4448=this[_0x38421a(0x346)][_0x38421a(0x15b)](_0x38e9ad);_0x1d4448&&(_0x1d4448[_0x38421a(0x33d)](),this[_0x38421a(0x346)][_0x38421a(0x3f7)](_0x38e9ad)),this[_0x38421a(0x184)][_0x38421a(0x3f7)](_0x38e9ad),this[_0x38421a(0x316)]['forEach'](_0x2cd029=>{const _0x4c88fd=_0x38421a;_0x2cd029[_0x4c88fd(0x264)](_0x38e9ad);});}[_0x58c229(0x325)](_0x3e4dd2,_0x2aa2ce,_0x134b28,_0x502276){const _0x274452=_0x58c229;return this[_0x274452(0x34d)](_0x134b28[_0x274452(0x204)])[_0x274452(0x325)](_0x3e4dd2,_0x2aa2ce,_0x134b28,_0x502276);}[_0x58c229(0x1c5)](_0x3db4a3){const _0x3f7fd9=_0x58c229;return this[_0x3f7fd9(0x34d)](_0x3db4a3[_0x3f7fd9(0x204)])[_0x3f7fd9(0x1c5)](_0x3db4a3);}['refreshData'](_0x5d14b1,_0x4f4d4b,_0x5a5b27){const _0x43b118=_0x58c229;this[_0x43b118(0x34d)](_0x5a5b27[_0x43b118(0x204)])[_0x43b118(0x3a9)](_0x5d14b1,_0x4f4d4b,_0x5a5b27);}[_0x58c229(0x40a)](_0x1a087b,_0x50cafe){const _0x3219c8=_0x58c229;this[_0x3219c8(0x34d)](_0x1a087b)[_0x3219c8(0x26e)](_0x50cafe);}['removeCollections'](_0x54bcf9,_0x33d660){const _0x266d28=_0x58c229;this['getDataFieldManager'](_0x54bcf9)[_0x266d28(0x20d)](_0x33d660);}[_0x58c229(0x135)](_0x9af42d,_0x46e090){const _0x511850=_0x58c229;var _0x3836f5;return(_0x3836f5=this[_0x511850(0x123)]['get'](_0x9af42d))==null?void 0x0:_0x3836f5['get'](_0x46e090);}[_0x58c229(0x1dd)](_0x18f6e0){const _0x1654dd=_0x58c229;for(const [_0x59d811,_0x4e810b]of this[_0x1654dd(0x123)][_0x1654dd(0x15f)]())for(const [_0x3b1595,_0x2e6d28]of _0x4e810b['entries']())if(_0x2e6d28[_0x1654dd(0x38f)](_0x18f6e0))return{'unitId':_0x59d811,'subUnitId':_0x3b1595};return null;}[_0x58c229(0x36b)](_0x2be963,_0x1a48ac,_0x385006,_0x16bc0e){const _0x556f11=_0x58c229,_0x180787=this['_ensureViewDataMap'](_0x2be963,_0x1a48ac);_0x16bc0e?_0x180787['set'](_0x385006,_0x16bc0e):_0x180787[_0x556f11(0x3f7)](_0x385006),this[_0x556f11(0x12b)][_0x556f11(0x3f0)]({'unitId':_0x2be963,'subUnitId':_0x1a48ac,'pivotTableId':_0x385006});}['dispose'](){super['dispose']();}['getViewData'](_0x35c20d,_0x57c18a,_0x497fd5){const _0x5142ed=_0x58c229;var _0x378821,_0x36e6af;const _0xa4e4a4=(_0x36e6af=(_0x378821=this[_0x5142ed(0x184)][_0x5142ed(0x15b)](_0x35c20d))==null?void 0x0:_0x378821[_0x5142ed(0x15b)](_0x57c18a))==null?void 0x0:_0x36e6af[_0x5142ed(0x15b)](_0x497fd5);return _0xa4e4a4||null;}['addDirtyPivotTable'](_0x5bd983){const _0x4ccaf1=_0x58c229;this[_0x4ccaf1(0x27f)](_0x5bd983);}[_0x58c229(0x27f)](_0x1f6f92){const _0x1a0d21=_0x58c229,{token:_0x1e6029,unitId:_0x1fc326,subUnitId:_0x321e52}=_0x1f6f92,_0x373ac5=_0x1fc326+'-'+_0x321e52+'-'+_0x1e6029;this[_0x1a0d21(0x3d7)][_0x1a0d21(0x15b)](_0x373ac5)&&clearTimeout(this[_0x1a0d21(0x3d7)][_0x1a0d21(0x15b)](_0x373ac5));const _0x37ef89=setTimeout(()=>{const _0x1ddb19=_0x1a0d21;this[_0x1ddb19(0x303)](_0x1f6f92),this['_queryingMap'][_0x1ddb19(0x3f7)](_0x373ac5);},$o);this['_queryingMap']['set'](_0x373ac5,_0x37ef89);}[_0x58c229(0x303)](_0x4a9273){const _0xfd0b2a=_0x58c229,{unitId:_0x396fb7,subUnitId:_0x3e9c5d,token:_0x1666c4,type:_0x2575e6,pivotConfig:_0x192d47}=_0x4a9273,_0x3b6adc=this[_0xfd0b2a(0x1a5)](_0x1666c4),_0x3e2f6f=_0x3b6adc==null?void 0x0:_0x3b6adc['query'](),_0x4f8a7e=_0x192d47!=null?_0x192d47:this[_0xfd0b2a(0x338)](_0x396fb7,_0x3e9c5d,_0x1666c4);_0x4f8a7e&&(_0x4f8a7e[_0xfd0b2a(0x301)]=!!(_0x3b6adc!=null&&_0x3b6adc[_0xfd0b2a(0x301)]())),(_0x3e2f6f||_0x2575e6===j[_0xfd0b2a(0x414)])&&this[_0xfd0b2a(0x1cd)](_0x396fb7,_0x3e9c5d,_0x2575e6,_0x1666c4,_0x3e2f6f,_0x4f8a7e,this[_0xfd0b2a(0x34d)](_0x396fb7)[_0xfd0b2a(0x128)]());}['toJSON'](_0xe930bd){const _0xc9ff10=_0x58c229,_0xb4d343={'dataFieldManagerConfig':{},'pivotTableConfigs':{}};if(this[_0xc9ff10(0x34d)](_0xe930bd)&&(_0xb4d343[_0xc9ff10(0x306)][_0xe930bd]=this[_0xc9ff10(0x34d)](_0xe930bd)[_0xc9ff10(0x128)]()),this[_0xc9ff10(0x123)][_0xc9ff10(0x15b)](_0xe930bd)){_0xb4d343[_0xc9ff10(0x119)][_0xe930bd]={};const _0x4fdd93=this[_0xc9ff10(0x123)][_0xc9ff10(0x15b)](_0xe930bd);_0x4fdd93!=null&&_0x4fdd93[_0xc9ff10(0x290)]&&[..._0x4fdd93[_0xc9ff10(0x284)]()][_0xc9ff10(0x124)](_0x2332e9=>{const _0x49c094=_0xc9ff10,_0x19f575=_0x4fdd93[_0x49c094(0x15b)](_0x2332e9);_0x19f575!=null&&_0x19f575[_0x49c094(0x290)]&&(_0xb4d343[_0x49c094(0x119)][_0xe930bd][_0x2332e9]={},[..._0x19f575[_0x49c094(0x284)]()]['forEach'](_0x352efa=>{const _0x4951d3=_0x49c094,_0x3d16b5=_0x19f575[_0x4951d3(0x15b)](_0x352efa);_0x3d16b5&&(_0xb4d343[_0x4951d3(0x119)][_0xe930bd][_0x2332e9][_0x352efa]=_0x3d16b5);}));});}return _0xb4d343;}[_0x58c229(0x2b2)](_0x11687){const _0x5053cd=_0x58c229;var _0xabbb7e;const {dataFieldManagerConfig:_0x586736,pivotTableConfigs:_0xee57bd}=_0x11687;_0x586736&&Object[_0x5053cd(0x284)](_0x586736)[_0x5053cd(0x124)](_0x1b9629=>{const _0x3de70d=_0x5053cd;this[_0x3de70d(0x34d)](_0x1b9629)[_0x3de70d(0x2b2)](_0x586736[_0x1b9629]);});const _0x21e08c=[];if(_0xee57bd){const _0x59d73d=(_0xabbb7e=this['_injector']['get'](v[_0x5053cd(0x1ab)])['getConfig'](ue[_0x5053cd(0x41c)]))!=null?_0xabbb7e:{},{ls:_0x1d9e38,pbk:_0x199de0}=_0x59d73d,_0x45dc47=St(It,_0x1d9e38,_0x199de0)[_0x5053cd(0x374)];Object[_0x5053cd(0x284)](_0xee57bd)[_0x5053cd(0x124)](_0x319a8f=>{const _0x47fdc7=_0x5053cd;let _0x3bbffc=0x0;const _0x3ca783=_0xee57bd[_0x319a8f];Object[_0x47fdc7(0x284)](_0x3ca783)[_0x47fdc7(0x124)](_0x1de417=>{const _0x3229e2=_0x47fdc7,_0x4ee355=_0x3ca783[_0x1de417];Object[_0x3229e2(0x284)](_0x4ee355)[_0x3229e2(0x124)](_0x67c1f4=>{const _0x404863=_0x3229e2,_0x5ec1a2=_0x4ee355[_0x67c1f4];if(_0x5ec1a2){if(_0x3bbffc>=_0x45dc47)return;_0x3bbffc++;const _0x64cbf4=this['getDataFieldManager'](_0x319a8f),_0x5bdcc4=_0x64cbf4[_0x404863(0x255)][_0x67c1f4],_0xf79dd4=_0x5bdcc4[_0x404863(0x29c)]();let _0x5ce95f=0x0;const _0x3d99d1=[];for(const _0x4ab504 of _0xf79dd4){const _0x58057e=_0x5bdcc4['getFieldById'](_0x4ab504);if(m[_0x404863(0x11c)](_0x58057e)){const _0x225cfd=_0x58057e['getOriginFieldId'](),_0xe86932=_0x5bdcc4[_0x404863(0x356)](_0x225cfd);_0xe86932&&_0x3d99d1[_0x404863(0x2c5)]([_0x58057e,_0xe86932]);continue;}_0x64cbf4[_0x404863(0x33a)](_0x4ab504,_0x5ec1a2[_0x404863(0x141)],_0x5ce95f),_0x5ce95f++;}_0x3d99d1[_0x404863(0x124)](([_0x4cbc2b,_0x20a6b3])=>{const _0xffa5a2=_0x404863;_0x4cbc2b[_0xffa5a2(0x406)](_0x20a6b3);});const _0x4b3b06=new m[(_0x404863(0x3e9))](_0x5bdcc4);_0x4b3b06[_0x404863(0x2b2)](_0x5ec1a2[_0x404863(0x35c)]),this['addPivotTable'](_0x319a8f,_0x1de417,_0x67c1f4,_0x4b3b06,_0x5ec1a2);const _0x426026=_0x4b3b06[_0x404863(0x25e)]();_0x21e08c[_0x404863(0x2c5)]({'unitId':_0x319a8f,'subUnitId':_0x1de417,'pivotTableId':_0x67c1f4,'view':_0x426026[_0x404863(0x128)](),'pivotConfig':_0x5ec1a2,'type':j[_0x404863(0x1af)]});const _0x4be146=!!_0x4b3b06[_0x404863(0x301)](),_0x444a14={'view':_0x426026,'pivotTableId':_0x67c1f4,'textInfo':this[_0x404863(0x15c)](),'isEmpty':_0x4be146,'targetCellInfo':_0x5ec1a2['targetCellInfo']};this['updateViewData'](_0x444a14,!0x1);}});});});}_0x586736&&Object[_0x5053cd(0x284)](_0x586736)[_0x5053cd(0x124)](_0x4ad5b9=>{const _0x8efcc0=_0x5053cd,_0x3fa026=this['getDataFieldManager'](_0x4ad5b9);this[_0x8efcc0(0x1aa)][_0x8efcc0(0x3f0)](_0x3fa026[_0x8efcc0(0x255)]);}),this[_0x5053cd(0x37b)][_0x5053cd(0x3aa)](ot['id'],{'batch':_0x21e08c,'collectionConfig':_0x586736},{'onlyLocal':!0x0});}['_initSnapshot'](){const _0x15f4d7=_0x58c229;this[_0x15f4d7(0x17a)](this[_0x15f4d7(0x22a)][_0x15f4d7(0x200)]({'toJson':_0x1c6a44=>JSON['stringify'](this[_0x15f4d7(0x128)](_0x1c6a44)),'parseJson':_0x10307f=>{const _0x1ee986=_0x15f4d7;if(!_0x10307f)return{};try{return JSON[_0x1ee986(0x2b6)](_0x10307f);}catch{return{};}},'businesses':[v['UniverInstanceType']['UNIVER_SHEET']],'pluginName':Ct,'onLoad':(_0x21b3c5,_0x1ff00a)=>{const _0x1e0a6f=_0x15f4d7;this[_0x1e0a6f(0x2b2)](_0x1ff00a);},'onUnLoad':_0x357af9=>{this['deleteUnitId'](_0x357af9);}}));}},exports[_0x58c229(0x297)]=on([Oe(0x0,v[_0x58c229(0x198)](v[_0x58c229(0x3ee)])),Oe(0x1,v['IUniverInstanceService']),Oe(0x2,v['Inject'](v[_0x58c229(0x39e)])),Oe(0x3,v[_0x58c229(0x341)]),Oe(0x4,v['Inject'](v[_0x58c229(0x300)]))],exports[_0x58c229(0x297)]);const nn={0x0:{0x0:{'v':'filter','s':z}},0x2:{0x1:{'v':'','s':z},0x2:{'v':'','s':z},0x3:{'v':_0x58c229(0x174),'s':z},0x4:{'v':'','s':z},0x5:{'v':'','s':z}},0x3:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0x4:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0x5:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0x6:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0x7:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0x8:{0x0:{'v':'row','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'values','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0x9:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0xa:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0xb:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0xc:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}},0xd:{0x0:{'v':'','s':z},0x1:{'v':'','s':_},0x2:{'v':'','s':_},0x3:{'v':'','s':_},0x4:{'v':'','s':_},0x5:{'v':'','s':_}}},Tt={'rowRanges':[{'startRow':0x3,'endRow':0xd,'startColumn':0x0,'endColumn':0x0}],'colRanges':[{'startRow':0x2,'endRow':0x2,'startColumn':0x1,'endColumn':0x5}],'dataRanges':[{'startRow':0x3,'endRow':0xd,'startColumn':0x1,'endColumn':0x5}],'pageRanges':[{'startRow':0x0,'endRow':0x0,'startColumn':0x0,'endColumn':0x0}],'cornerRanges':[]},Ht=(_0x230474,_0x1ccda8)=>{const _0x299767=_0x58c229,_0x2dfc74=new v['ObjectMatrix'](),_0x59fbf2=new v[(_0x299767(0x342))](nn),{row:_0x2a71a3,col:_0x47215e}=_0x1ccda8;_0x59fbf2[_0x299767(0x407)]((_0x1a1f96,_0xef133a,_0xe7a37f)=>{const _0x4350be=_0x299767;let _0x561962='';_0xe7a37f['v']===_0x4350be(0x1d0)?_0x561962=_0x230474['filter']:_0xe7a37f['v']===_0x4350be(0x1d4)?_0x561962=_0x230474[_0x4350be(0x1d4)]:_0xe7a37f['v']===_0x4350be(0x174)?_0x561962=_0x230474[_0x4350be(0x174)]:_0xe7a37f['v']==='values'&&(_0x561962=_0x230474['values']),_0x2dfc74[_0x4350be(0x258)](_0x1a1f96+_0x2a71a3,_0xef133a+_0x47215e,{..._0xe7a37f,'v':_0x561962});});const _0x1d60e4=v[_0x299767(0x271)]['deepClone'](Tt);return Object[_0x299767(0x284)](Tt)[_0x299767(0x124)](_0x52c889=>{const _0x153dbd=_0x299767;_0x1d60e4[_0x52c889]=Tt[_0x52c889][_0x153dbd(0x14c)](_0x409206=>({..._0x409206,'startRow':_0x409206[_0x153dbd(0x1fd)]+_0x2a71a3,'endRow':_0x409206[_0x153dbd(0x12d)]+_0x2a71a3,'startColumn':_0x409206['startColumn']+_0x47215e,'endColumn':_0x409206[_0x153dbd(0x1ea)]+_0x47215e}));}),{'matrixCache':_0x2dfc74,'rangesCache':_0x1d60e4};};function an(_0x1a3ee0,_0x2b9548){const _0x5e70aa=_0x58c229;let _0xcd5072='';const _0x25f6b8=this[_0x5e70aa(0x15c)]();switch(_0x2b9548){case m['PivotSubtotalTypeEnum']['average']:_0xcd5072=_0x25f6b8[_0x5e70aa(0x2aa)]+_0x1a3ee0;break;case m['PivotSubtotalTypeEnum'][_0x5e70aa(0x374)]:_0xcd5072=_0x25f6b8['sheets-pivot.countName']+_0x1a3ee0;break;case m[_0x5e70aa(0x1ad)][_0x5e70aa(0x1ba)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x3fc)]+_0x1a3ee0;break;case m['PivotSubtotalTypeEnum'][_0x5e70aa(0x3cb)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x15e)]+_0x1a3ee0;break;case m['PivotSubtotalTypeEnum'][_0x5e70aa(0x3ad)]:_0xcd5072=_0x25f6b8['sheets-pivot.minName']+_0x1a3ee0;break;case m[_0x5e70aa(0x1ad)][_0x5e70aa(0x19d)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x1ec)]+_0x1a3ee0;break;case m[_0x5e70aa(0x1ad)][_0x5e70aa(0x14b)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x278)]+_0x1a3ee0;break;case m[_0x5e70aa(0x1ad)]['stdDevp']:_0xcd5072=_0x25f6b8[_0x5e70aa(0x2b5)]+_0x1a3ee0;break;case m[_0x5e70aa(0x1ad)][_0x5e70aa(0x1d2)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x20f)]+_0x1a3ee0;break;case m[_0x5e70aa(0x1ad)][_0x5e70aa(0x3bd)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x3ea)]+_0x1a3ee0;break;case m['PivotSubtotalTypeEnum'][_0x5e70aa(0x320)]:_0xcd5072=_0x25f6b8[_0x5e70aa(0x169)]+_0x1a3ee0;break;default:_0xcd5072=_0x1a3ee0;break;}return _0xcd5072;}function Yt(_0x1add83,_0x5c36d1,_0x4bc5e8,_0x4d3f07,_0x2ea9b0){const _0x32608e=_0x58c229;var _0x5a6f81,_0x382d85,_0x4344db,_0x25113e,_0x1bb1fa;const _0x3a39f8=v[_0x32608e(0x15d)](_0x1add83,_0x5c36d1),{rangesInfo:_0x76cade,areaInfo:_0x19f447,headerMap:_0x546b53}=_0x2ea9b0;if(!_0x76cade||!_0x19f447||!_0x546b53)return;const _0x45e9c7=Object[_0x32608e(0x284)](_0x76cade)['find'](_0x1b25e1=>_0x76cade[_0x1b25e1][_0x32608e(0x160)](_0x2f0499=>v[_0x32608e(0x22f)]['contains'](_0x2f0499,_0x3a39f8))),_0x578091=_0x19f447;let _0x2bf3c1,_0x2e14ce,_0x1047c1;if(_0x45e9c7==='rowRanges')_0x2bf3c1=(_0x5a6f81=_0x578091==null?void 0x0:_0x578091['rowInfo'])==null?void 0x0:_0x5a6f81[_0x1add83],_0x2e14ce=(_0x382d85=_0x546b53==null?void 0x0:_0x546b53[_0x32608e(0x275)])==null?void 0x0:_0x382d85[_0x5c36d1],_0x1047c1=_0x2e14ce==null?void 0x0:_0x2e14ce['tableFieldId'];else{if(_0x45e9c7===_0x32608e(0x11a))_0x2bf3c1=(_0x4344db=_0x578091==null?void 0x0:_0x578091['colInfo'])==null?void 0x0:_0x4344db[_0x5c36d1],_0x2e14ce=(_0x25113e=_0x546b53[_0x32608e(0x3e5)])==null?void 0x0:_0x25113e[_0x1add83+0x1+_0x5c36d1-_0x76cade['colRanges'][0x0][_0x32608e(0x1b3)]],_0x1047c1=_0x2e14ce==null?void 0x0:_0x2e14ce[_0x32608e(0x2b7)];else{if(_0x45e9c7==='cornerRanges')_0x2bf3c1=(_0x1bb1fa=_0x578091==null?void 0x0:_0x578091[_0x32608e(0x1cf)])==null?void 0x0:_0x1bb1fa[_0x5c36d1],_0x1047c1=_0x2bf3c1==null?void 0x0:_0x2bf3c1[_0x32608e(0x2b7)];else{if(_0x45e9c7==='pageRanges'){const _0x145237=_0x4bc5e8==null?void 0x0:_0x4bc5e8['fi'];_0x145237!==void 0x0&&(_0x1047c1=_0x4d3f07[_0x32608e(0x153)](_0x145237));}}}}return{'filterId':_0x1047c1,'info':_0x2bf3c1,'data':_0x4bc5e8,'headerInfo':_0x2e14ce};}function Qt(_0x502651,_0x201a55,_0xf3e5fa){const _0x42d336=_0x58c229,_0x2ccebc=_0x502651[_0x42d336(0x1c8)],_0x4cc748=_0x2ccebc[_0x42d336(0x29c)](),_0x5417da=new Set();_0x502651[_0x42d336(0x2ab)](_0x4dfd68=>{const _0x184da0=_0x42d336;_0x5417da[_0x184da0(0x289)](_0x4dfd68['dataFieldId']);});const _0x4c099a=_0x4cc748[_0x42d336(0x14c)](_0x40476f=>{const _0x25d1f3=_0x42d336,_0x466da8=_0x2ccebc[_0x25d1f3(0x356)](_0x40476f);return{'checked':_0x5417da[_0x25d1f3(0x38f)](_0x40476f),'dataFieldId':_0x466da8['id'],'id':_0x466da8['id'],'name':_0x2ccebc[_0x25d1f3(0x309)](_0x466da8['id']),'type':_0x466da8['getFieldDataType'](),'pivotTableId':_0x201a55};}),_0x389479=[];_0x502651[_0x42d336(0x18c)](m[_0x42d336(0x403)][_0x42d336(0x388)],_0x4a8214=>{const _0x2f5f96=_0x42d336;_0x389479[_0x2f5f96(0x2c5)]({'dataFieldId':_0x4a8214[_0x2f5f96(0x40e)],'tableFieldId':_0x4a8214[_0x2f5f96(0x2ba)](),'displayName':_0x4a8214['getDisplayName']()});});const _0x51c92b=[];_0x502651['iterateFieldByArea'](m[_0x42d336(0x403)][_0x42d336(0x2df)],_0x259fe1=>{const _0x1a2125=_0x42d336;_0x51c92b[_0x1a2125(0x2c5)]({'dataFieldId':_0x259fe1['dataFieldId'],'tableFieldId':_0x259fe1[_0x1a2125(0x2ba)](),'displayName':_0x259fe1[_0x1a2125(0x309)]()});});const _0x3900b3=[];if(_0x502651['iterateFieldByArea'](m['PivotTableFiledAreaEnum']['Value'],_0x64d783=>{const _0x361a2f=_0x42d336;_0x3900b3[_0x361a2f(0x2c5)]({'dataFieldId':_0x64d783[_0x361a2f(0x40e)],'tableFieldId':_0x64d783[_0x361a2f(0x2ba)](),'displayName':_0x64d783[_0x361a2f(0x309)](),'format':_0x64d783[_0x361a2f(0x312)](),'subTotalType':_0x64d783[_0x361a2f(0x19e)]()});}),_0x3900b3[_0x42d336(0x3ca)]>0x1){const _0x2ccef2=_0x502651['getValueIndex']();(_0x502651[_0x42d336(0x3c8)]()?_0x51c92b:_0x389479)['splice'](_0x2ccef2,0x0,{'dataFieldId':'','tableFieldId':_0x42d336(0x383),'displayName':'Value'});}const _0x3cf34f=[];_0x502651[_0x42d336(0x18c)](m[_0x42d336(0x403)][_0x42d336(0x3c0)],_0x1a2832=>{const _0x599066=_0x42d336;_0x3cf34f[_0x599066(0x2c5)]({'dataFieldId':_0x1a2832[_0x599066(0x40e)],'tableFieldId':_0x1a2832[_0x599066(0x2ba)](),'displayName':_0x1a2832[_0x599066(0x309)]()});});const _0x1eea85=_0xf3e5fa[_0x42d336(0x141)];return{'sourceList':_0x4c099a,'sourceRange':_0x1eea85,'rowFields':_0x389479,'columnFields':_0x51c92b,'valueFields':_0x3900b3,'filterFields':_0x3cf34f,'positionInfo':_0xf3e5fa['targetCellInfo']};}function Dt(_0x4c00dd,_0x91116f,_0x43cd9e='',_0x37cb34={}){const _0x3c462f=_0x58c229,_0x5c4afa=_0x4c00dd[_0x3c462f(0x15b)](v[_0x3c462f(0x2f8)]);for(const _0x468910 in _0x91116f)if(Object[_0x3c462f(0x1be)][_0x3c462f(0x1c6)][_0x3c462f(0x3e0)](_0x91116f,_0x468910)){const _0x22500e=_0x43cd9e?_0x43cd9e+'.'+_0x468910:_0x468910;typeof _0x91116f[_0x468910]==_0x3c462f(0x120)&&_0x91116f[_0x468910]!==null&&!Array[_0x3c462f(0x164)](_0x91116f[_0x468910])?Dt(_0x4c00dd,_0x91116f[_0x468910],_0x22500e,_0x37cb34):_0x37cb34[_0x22500e]=_0x5c4afa['t'](_0x22500e);}return _0x37cb34;}const nt=_0x5c2205=>{const _0x3dd431=_0x58c229;if(!_0x5c2205)return[];const {rowRanges:_0x3a589a,colRanges:_0x5d792f,cornerRanges:_0x49a48f,dataRanges:_0x3dec76,pageRanges:_0x16a1c6}=_0x5c2205,_0x2535bd=[..._0x5d792f,..._0x3a589a,..._0x3dec76,..._0x49a48f][_0x3dd431(0x1d0)](_0x566d4a=>_0x566d4a[_0x3dd431(0x1fd)]>=0x0&&_0x566d4a[_0x3dd431(0x1b3)]>=0x0&&_0x566d4a[_0x3dd431(0x12d)]>=0x0&&_0x566d4a[_0x3dd431(0x1ea)]>=0x0);let _0x1f7c6b=Number['MAX_SAFE_INTEGER'],_0x3da609=Number[_0x3dd431(0x2e1)],_0x5bf7b6=Number['MAX_SAFE_INTEGER'],_0x58d3c0=Number['MIN_SAFE_INTEGER'];for(let _0x3cb55f=0x0;_0x3cb55f<_0x2535bd[_0x3dd431(0x3ca)];_0x3cb55f++)_0x1f7c6b=Math[_0x3dd431(0x3ad)](_0x1f7c6b,_0x2535bd[_0x3cb55f][_0x3dd431(0x1fd)]),_0x3da609=Math[_0x3dd431(0x3cb)](_0x3da609,_0x2535bd[_0x3cb55f]['endRow']),_0x5bf7b6=Math[_0x3dd431(0x3ad)](_0x5bf7b6,_0x2535bd[_0x3cb55f][_0x3dd431(0x1b3)]),_0x58d3c0=Math['max'](_0x58d3c0,_0x2535bd[_0x3cb55f]['endColumn']);return[..._0x16a1c6,{'startRow':_0x1f7c6b,'endRow':_0x3da609,'startColumn':_0x5bf7b6,'endColumn':_0x58d3c0}];};function sn(_0x3e403f,_0x2f7516){const _0x4df28a=_0x58c229,_0x51a45=_0x2f7516[_0x4df28a(0x192)][_0x4df28a(0x350)],{pivotTableId:_0x600e2b,unitId:_0x7ebce6,subUnitId:_0x446721}=_0x2f7516;if(!_0x51a45)return;const _0xf7412e=_0x3e403f[_0x4df28a(0x15b)](exports[_0x4df28a(0x297)]),_0x28c175=_0xf7412e[_0x4df28a(0x1a5)](_0x600e2b),_0x5ca177=_0xf7412e[_0x4df28a(0x338)](_0x7ebce6,_0x446721,_0x600e2b);if(!_0x28c175||!_0x5ca177)return;const _0x5f36be=_0x28c175[_0x4df28a(0x16c)](_0x51a45[_0x4df28a(0x31c)]);if(!(_0x5f36be!=null&&_0x5f36be[_0x4df28a(0x3ca)]))return;const _0xb346ca=_0x5ca177[_0x4df28a(0x141)],{unitId:_0x262458,subUnitId:_0x4d2a29,range:_0x1b9f08}=_0xb346ca;let _0x199c8f=0x0;const _0x2f2dca=_0x28c175['dataFieldsCollection'][_0x4df28a(0x29c)]()['reduce']((_0x5e9451,_0x31e4f3)=>{const _0x57e9cd=_0x4df28a;var _0x4374d0;const _0x3ac70d=(_0x4374d0=_0x28c175[_0x57e9cd(0x304)](_0x31e4f3))==null?void 0x0:_0x4374d0[_0x57e9cd(0x179)]();return _0x3ac70d&&(_0x5e9451[String(_0x199c8f)]=_0x3ac70d),_0x199c8f++,_0x5e9451;},{});return{'indexes':_0x5f36be,'range':_0x1b9f08,'sourceUnitId':_0x262458,'sourceSubUnitId':_0x4d2a29,'formatMap':_0x2f2dca};}function Ut(_0x1e6b0f,_0x20cd46){const _0x9ee0b6=_0x58c229;if(!_0x1e6b0f||!_0x20cd46)return!0x0;const _0x23dcf0=ue[_0x9ee0b6(0x1ca)](Kt,qt),_0x4cf087=new Function(_0x9ee0b6(0x1c1)+_0x23dcf0)()(_0x1e6b0f,_0x20cd46)['message'],_0x5f3077=ue[_0x9ee0b6(0x2e3)](_0x4cf087,'sf',Gt);return!((_0x4cf087==null?void 0x0:_0x4cf087['rt'])===ue[_0x9ee0b6(0x197)][_0x9ee0b6(0x411)]&&!_0x5f3077);}function St(_0x5b4fdb,_0x157cc8,_0x51594e){const _0x4ec9a6=_0x58c229,_0x26c447={'count':_0x5b4fdb,'timeValid':!0x1};if(!_0x157cc8||!_0x51594e)return _0x26c447;const _0x480d97=ue['unshiftString'](Kt,qt),_0x3c66de=new Function(_0x4ec9a6(0x1c1)+_0x480d97)()(_0x157cc8,_0x51594e);if(_0x3c66de!=null&&_0x3c66de['valid']){const _0x59cc8a=_0x3c66de['message'],_0x3d9147=ue[_0x4ec9a6(0x2e3)](_0x59cc8a,'sf',Gt);return{'count':ue[_0x4ec9a6(0x2ca)](_0x59cc8a,_0x3d9147,'ptn',_0x5b4fdb,_0x5b4fdb,0x0),'timeValid':_0x3d9147};}return _0x26c447;}function Et(_0x247da4,_0x49a5f6,_0x204042,_0x5500c1){const _0x216367=_0x58c229,_0x219054={'subUnitId':_0x204042,'unitId':_0x49a5f6,'cellValue':V[_0x216367(0x40f)](_0x5500c1)},_0x1afc05=V[_0x216367(0x118)](_0x247da4,_0x219054);let _0x1b9cd5=!0x1;return new v[(_0x216367(0x342))](_0x1afc05['cellValue'])[_0x216367(0x407)]((_0x16a8ca,_0x4146a3,_0x250847)=>{const _0x267605=_0x216367;if(!_0x1b9cd5&&_0x250847&&(_0x250847[_0x267605(0x377)]||_0x250847['f']||_0x250847['p']||_0x250847['s']||_0x250847['si']||_0x250847['t']||_0x250847['v']))return _0x1b9cd5=!0x0,!0x1;}),{'setRangeValueUndoMutation':{'id':V['SetRangeValuesMutation']['id'],'params':_0x1afc05},'setRangeValueRedoMutation':{'id':V[_0x216367(0x3f2)]['id'],'params':_0x219054},'shouldClear':_0x1b9cd5};}function zt(_0x469fa4){const {row:_0x1c7f00,col:_0xa18f0}=_0x469fa4,_0x2dbb35={'startRow':_0x1c7f00,'endRow':_0x1c7f00,'startColumn':_0xa18f0,'endColumn':_0xa18f0},_0x4e13bd={'startRow':_0x1c7f00+0x2,'endRow':_0x1c7f00+0xe,'startColumn':_0xa18f0,'endColumn':_0xa18f0+0x6};return[_0x2dbb35,_0x4e13bd];}function rn(_0x1a1458,_0x2908f5,_0x579741){const _0x320602=_0x58c229,{cornerView:_0x80c8dd,rowView:_0x24a8a3,colView:_0x12c98f,pageView:_0x19988d}=_0x1a1458,{row:_0x12c754,col:_0x307cf1}=_0x2908f5;if(_0x579741)return{'rowCount':Lo+_0x12c754,'colCount':Go+_0x307cf1};const _0x31ee4f=_0x19988d[_0x320602(0x217)]>-0x1?_0x19988d[_0x320602(0x217)]+0x1:0x0,_0xe96bf6=_0x19988d[_0x320602(0x13f)]>-0x1?_0x19988d[_0x320602(0x13f)]:0x0,_0x118fbc=_0x12c754+_0x31ee4f+(_0x31ee4f?0x1:0x0)+_0x80c8dd[_0x320602(0x394)]+_0x24a8a3['rowCount'],_0x4c317d=_0x307cf1+_0xe96bf6,_0x18da48=_0x307cf1+_0x80c8dd[_0x320602(0x2dd)]+_0x12c98f[_0x320602(0x2dd)],_0x5efc79=Math[_0x320602(0x3cb)](_0x4c317d,_0x18da48);return{'rowCount':_0x118fbc,'colCount':_0x5efc79};}function de(_0x37be09,_0x24e843,_0x4d173f,_0x8cf76){const _0x32b4c4=_0x58c229,{row:_0x2d8fdd,col:_0x379c6b,unitId:_0x52116d,subUnitId:_0x110568}=_0x4d173f,_0x22d86c=rn(_0x24e843,{'row':_0x2d8fdd,'col':_0x379c6b},_0x8cf76),_0x18aba8=_0x37be09[_0x32b4c4(0x15b)](v[_0x32b4c4(0x185)]),_0x32999b=V[_0x32b4c4(0x41b)](_0x18aba8,{'unitId':_0x52116d,'subUnitId':_0x110568}),_0x3a39ff=[],_0x5afc48=[];if(!_0x32999b)return{'undos':_0x5afc48,'redos':_0x3a39ff};const {worksheet:_0xb35410}=_0x32999b,_0x54020a=_0xb35410[_0x32b4c4(0x3ef)](),_0x5c8529=_0xb35410[_0x32b4c4(0x315)]();return _0x54020a<_0x22d86c[_0x32b4c4(0x394)]&&(_0x3a39ff[_0x32b4c4(0x2c5)]({'id':V[_0x32b4c4(0x396)]['id'],'params':{'unitId':_0x52116d,'subUnitId':_0x110568,'range':{'startRow':_0x54020a,'endRow':_0x22d86c[_0x32b4c4(0x394)]-0x1,'startColumn':0x0,'endColumn':_0x5c8529-0x1}}}),_0x5afc48['push']({'id':V['RemoveRowMutation']['id'],'params':{'unitId':_0x52116d,'subUnitId':_0x110568,'range':{'startRow':_0x54020a,'endRow':_0x22d86c[_0x32b4c4(0x394)]-0x1,'startColumn':0x0,'endColumn':_0x5c8529-0x1}}})),_0x5c8529<_0x22d86c[_0x32b4c4(0x2dd)]&&(_0x3a39ff['push']({'id':V['InsertColMutation']['id'],'params':{'unitId':_0x52116d,'subUnitId':_0x110568,'range':{'startRow':0x0,'endRow':_0x54020a-0x1,'startColumn':_0x5c8529,'endColumn':_0x22d86c['colCount']-0x1}}}),_0x5afc48[_0x32b4c4(0x2c5)]({'id':V['RemoveColMutation']['id'],'params':{'unitId':_0x52116d,'subUnitId':_0x110568,'range':{'startRow':0x0,'endRow':_0x54020a-0x1,'startColumn':_0x5c8529,'endColumn':_0x22d86c['colCount']-0x1}}})),{'undos':_0x5afc48,'redos':_0x3a39ff};}function ln(_0x3e042e){const _0x55cec9=_0x58c229;let _0x279458=0x0;for(let _0x4d1c79=0x0;_0x4d1c79<_0x3e042e[_0x55cec9(0x3ca)];_0x4d1c79++){const _0x41819a=_0x3e042e[_0x55cec9(0x359)](_0x4d1c79);_0x41819a>=0x4e00&&_0x41819a<=0x9fff||_0x41819a>=0x3000&&_0x41819a<=0x303f||_0x41819a>=0xff00&&_0x41819a<=0xffef?_0x279458+=0x2:_0x279458+=0x1;}return _0x279458;}function kt(_0x14b510,_0x15ba7b,_0x2c547a,_0x46a85d){const _0x27859b=_0x58c229;var _0x13914c,_0x1a1da4,_0x557dcb,_0x56e8a9;const {rowCount:_0x1c1a16,colCount:_0x7b05c3,headerMap:_0x4729bd}=_0x14b510,_0xa50580=0x64,_0x15000a=Math['min'](_0x1c1a16,_0xa50580),_0x10298c=Math[_0x27859b(0x3ad)](_0x7b05c3,_0xa50580);let _0x4f937b='',_0x15f260=0x0;for(let _0x348e1c=0x0;_0x348e1c<_0x15000a;_0x348e1c++)for(let _0xc3be7f=0x0;_0xc3be7f<_0x10298c;_0xc3be7f++){const _0x18f1a2={...(_0x1a1da4=(_0x13914c=_0x14b510['data'])==null?void 0x0:_0x13914c[_0x348e1c])==null?void 0x0:_0x1a1da4[_0xc3be7f]},_0x2242eb=(_0x557dcb=_0x4729bd[_0x348e1c])==null?void 0x0:_0x557dcb[_0x27859b(0x2b7)],_0x1d943c=_0x46a85d[_0x2242eb];let _0x28fef9=_0x14b510[_0x27859b(0x2d8)](_0x348e1c,_0xc3be7f);if(_0x18f1a2){const _0x395362=_0x2c547a?_0xc3be7f===0x0&&((_0x56e8a9=_0x14b510[_0x27859b(0x1ac)](_0xc3be7f+0x1))==null?void 0x0:_0x56e8a9[_0x27859b(0x353)]):!0x1;_0x28fef9=Me(_0x18f1a2,_0x395362,_0x1d943c,_0x15ba7b);}if(_0x28fef9!==void 0x0){const _0x5f418c=ln(String(_0x28fef9));_0x15f260<_0x5f418c&&(_0x4f937b=String(_0x28fef9),_0x15f260=_0x5f418c);}}return _0x4f937b;}function dn(_0x52a88f){const _0x38490e=_0x58c229,{rowCount:_0x41a709,colCount:_0x33de73}=_0x52a88f;let _0x2890a6='',_0x48bba3=0x0;for(let _0x2e0db0=_0x41a709-0x1;_0x2e0db0>0x0&&_0x2e0db0>_0x41a709-0x3;_0x2e0db0--)for(let _0x267e9c=0x0;_0x267e9c<_0x33de73;_0x267e9c++){const _0x3c339d=_0x52a88f[_0x38490e(0x2d8)](_0x2e0db0,_0x267e9c);if(_0x3c339d!==void 0x0){const _0x21d732=String(_0x3c339d)[_0x38490e(0x3ca)];_0x48bba3<_0x21d732&&(_0x2890a6=String(_0x3c339d),_0x48bba3=_0x21d732);}}return _0x2890a6;}function cn(_0x468bcc){const _0x3b2ab4=_0x58c229,{rowCount:_0x41313e,colCount:_0x1c6ca6}=_0x468bcc;let _0x2c4f20='',_0x9fcff9=0x0;for(let _0x3361c9=0x0;_0x3361c9<_0x41313e;_0x3361c9++)for(let _0x52cd1d=0x0;_0x52cd1d<_0x1c6ca6;_0x52cd1d++){const _0x4f4f67=_0x468bcc[_0x3b2ab4(0x2d8)](_0x3361c9,_0x52cd1d);if(_0x4f4f67!==void 0x0){const _0x1792be=String(_0x4f4f67)['length'];_0x9fcff9<_0x1792be&&(_0x2c4f20=String(_0x4f4f67),_0x9fcff9=_0x1792be);}}return _0x2c4f20;}function un(_0x3a2c41,_0x1e1cfe){const _0xdbfd85=_0x58c229,{rowFields:_0x515ca9,columnFields:_0x2f985d,valueFields:_0x2acd41,filterFields:_0x155827,dimension:_0x3c07be,measure:_0x490888}=_0x1e1cfe;for(const _0x5e7864 of _0x515ca9){const _0x2881b7=_0x3c07be[_0x5e7864];_0x2881b7&&_0x3a2c41[_0xdbfd85(0x304)](_0x2881b7[_0xdbfd85(0x40e)])&&(_0x3a2c41[_0xdbfd85(0x335)](_0x2881b7['dataFieldId'],m[_0xdbfd85(0x403)][_0xdbfd85(0x388)],void 0x0,_0x5e7864),_0x2881b7[_0xdbfd85(0x1fc)]&&_0x3a2c41[_0xdbfd85(0x32a)](_0x2881b7['id'],_0x2881b7[_0xdbfd85(0x1fc)]),_0x2881b7[_0xdbfd85(0x3b1)]&&_0x3a2c41[_0xdbfd85(0x247)](_0x2881b7['id'],_0x2881b7[_0xdbfd85(0x3b1)]),_0x2881b7['filterInfo']&&_0x3a2c41['setLabelFilterInfo'](_0x2881b7['id'],_0x2881b7[_0xdbfd85(0x3fe)]));}for(const _0x36a159 of _0x2f985d){const _0x7d8fdd=_0x3c07be[_0x36a159];_0x7d8fdd&&_0x3a2c41['getDataFieldByDataFieldId'](_0x7d8fdd['dataFieldId'])&&(_0x3a2c41[_0xdbfd85(0x335)](_0x7d8fdd[_0xdbfd85(0x40e)],m[_0xdbfd85(0x403)][_0xdbfd85(0x2df)],void 0x0,_0x36a159),_0x7d8fdd['sortInfo']&&_0x3a2c41[_0xdbfd85(0x247)](_0x7d8fdd['id'],_0x7d8fdd['sortInfo']),_0x7d8fdd[_0xdbfd85(0x3fe)]&&_0x3a2c41['setLabelFilterInfo'](_0x7d8fdd['id'],_0x7d8fdd[_0xdbfd85(0x3fe)]),_0x7d8fdd[_0xdbfd85(0x1fc)]&&_0x3a2c41['renameField'](_0x7d8fdd['id'],_0x7d8fdd[_0xdbfd85(0x1fc)]));}for(const _0xf0156c of _0x155827){const _0x2ad7d3=_0x3c07be[_0xf0156c];_0x2ad7d3&&_0x3a2c41[_0xdbfd85(0x304)](_0x2ad7d3['dataFieldId'])&&(_0x3a2c41[_0xdbfd85(0x335)](_0x2ad7d3['dataFieldId'],m[_0xdbfd85(0x403)][_0xdbfd85(0x3c0)],void 0x0,_0xf0156c),_0x2ad7d3['sortInfo']&&_0x3a2c41['setSortInfo'](_0x2ad7d3['id'],_0x2ad7d3[_0xdbfd85(0x3b1)]),_0x2ad7d3[_0xdbfd85(0x3fe)]&&_0x3a2c41['setLabelFilterInfo'](_0x2ad7d3['id'],_0x2ad7d3[_0xdbfd85(0x3fe)]),_0x2ad7d3[_0xdbfd85(0x1fc)]&&_0x3a2c41[_0xdbfd85(0x32a)](_0x2ad7d3['id'],_0x2ad7d3[_0xdbfd85(0x1fc)]));}for(const _0x4256e6 of _0x2acd41){const _0x65e2fb=_0x490888[_0x4256e6];_0x65e2fb&&_0x3a2c41[_0xdbfd85(0x304)](_0x65e2fb[_0xdbfd85(0x40e)])&&(_0x3a2c41[_0xdbfd85(0x335)](_0x65e2fb[_0xdbfd85(0x40e)],m['PivotTableFiledAreaEnum']['Value'],void 0x0,_0x4256e6),_0x65e2fb[_0xdbfd85(0x145)]!==void 0x0&&_0x3a2c41[_0xdbfd85(0x22d)](_0x4256e6,_0x65e2fb[_0xdbfd85(0x145)]),_0x65e2fb[_0xdbfd85(0x194)]&&_0x3a2c41['setFieldFormat'](_0x4256e6,_0x65e2fb[_0xdbfd85(0x194)]),_0x65e2fb[_0xdbfd85(0x1fc)]&&_0x3a2c41[_0xdbfd85(0x32a)](_0x65e2fb['id'],_0x65e2fb['displayName']));}const _0x188b06=_0x1e1cfe[_0xdbfd85(0x2bd)];for(const {fieldId:_0x197291,filterInfo:_0x159093}of _0x188b06)_0x3a2c41[_0xdbfd85(0x150)](_0x197291,_0x159093);}function fn(_0x21e66f,_0x50ba11){const _0xd1f84=_0x58c229,_0x471603=[];_0x50ba11===m[_0xd1f84(0x403)][_0xd1f84(0x388)]&&_0x21e66f[_0xd1f84(0x18c)](m[_0xd1f84(0x403)][_0xd1f84(0x388)],_0x3cb15c=>{const _0x324acb=_0xd1f84;_0x471603[_0x324acb(0x2c5)](_0x3cb15c[_0x324acb(0x2ba)]());}),_0x50ba11===m[_0xd1f84(0x403)][_0xd1f84(0x2df)]&&_0x21e66f[_0xd1f84(0x18c)](m['PivotTableFiledAreaEnum'][_0xd1f84(0x2df)],_0x427d61=>{const _0x216cf5=_0xd1f84;_0x471603[_0x216cf5(0x2c5)](_0x427d61[_0x216cf5(0x2ba)]());}),_0x50ba11===m['PivotTableFiledAreaEnum'][_0xd1f84(0x3c0)]&&_0x21e66f[_0xd1f84(0x18c)](m[_0xd1f84(0x403)][_0xd1f84(0x3c0)],_0x5b7aee=>{const _0xef51ab=_0xd1f84;_0x471603['push'](_0x5b7aee[_0xef51ab(0x2ba)]());}),_0x50ba11===m['PivotTableFiledAreaEnum']['Value']&&_0x21e66f['iterateFieldByArea'](m[_0xd1f84(0x403)][_0xd1f84(0x187)],_0x82be2e=>{const _0x1bad4f=_0xd1f84;_0x471603['push'](_0x82be2e[_0x1bad4f(0x2ba)]());}),_0x50ba11===void 0x0&&_0x21e66f['iterateField'](_0x226e4a=>{const _0x4cfa5c=_0xd1f84;_0x471603[_0x4cfa5c(0x2c5)](_0x226e4a['getId']());});const _0x27a822=_0x471603[_0xd1f84(0x3ca)];for(let _0x52b2fd=_0x27a822-0x1;_0x52b2fd>=0x0;_0x52b2fd--)_0x21e66f['removeField'](_0x471603[_0x52b2fd]);const _0x3149fe=_0x21e66f['getValueFilterInfos']();for(const _0x1793bd in _0x3149fe)_0x21e66f[_0xd1f84(0x30d)](_0x1793bd);}function vn(_0x578209,_0x15f221){const _0x3de310=_0x58c229,_0x37ce4b=new Date(m['excelDateToUnixMilliseconds'](_0x15f221)),_0x29b438=new Date(m[_0x3de310(0x242)](_0x578209)),_0x143a33=_0x37ce4b[_0x3de310(0x29e)](),_0x253926=_0x29b438['getFullYear'](),_0x5ba70e=_0x37ce4b[_0x3de310(0x1d1)](),_0x189e7a=_0x29b438[_0x3de310(0x1d1)](),_0x3dbec8=_0x37ce4b[_0x3de310(0x212)](),_0x1baeda=_0x29b438[_0x3de310(0x212)](),_0x1c6cd5=_0x143a33===_0x253926,_0x474a4c=_0x1c6cd5&&_0x5ba70e===_0x189e7a;return _0x1c6cd5&&_0x474a4c&&!(_0x474a4c&&_0x3dbec8===_0x1baeda)?m[_0x3de310(0x1ef)][_0x3de310(0x37e)]:_0x1c6cd5&&!_0x474a4c?m['PivotDateGroupFieldDateTypeEnum'][_0x3de310(0x137)]:m[_0x3de310(0x1ef)][_0x3de310(0x36e)];}function Xt(_0x445aec,_0x5a3da){const _0x3d7616=_0x58c229,_0x938748=_0x445aec[_0x3d7616(0x15b)](exports[_0x3d7616(0x297)])['getTextInfo']();let _0x515d03='';switch(_0x5a3da){case m['PivotDateGroupFieldDateTypeEnum'][_0x3d7616(0x37e)]:_0x515d03=_0x938748[_0x3d7616(0x238)];break;case m[_0x3d7616(0x1ef)][_0x3d7616(0x137)]:_0x515d03=_0x938748[_0x3d7616(0x401)];break;case m[_0x3d7616(0x1ef)][_0x3d7616(0x36e)]:_0x515d03=_0x938748['sheets-pivot.dateGroup.year'];break;case m[_0x3d7616(0x1ef)]['Month']:_0x515d03=_0x938748[_0x3d7616(0x12f)];break;case m[_0x3d7616(0x1ef)][_0x3d7616(0x180)]:_0x515d03=_0x938748[_0x3d7616(0x382)];break;case m['PivotDateGroupFieldDateTypeEnum'][_0x3d7616(0x285)]:_0x515d03=_0x938748[_0x3d7616(0x3af)];break;case m['PivotDateGroupFieldDateTypeEnum']['HourMinute']:_0x515d03=_0x938748[_0x3d7616(0x37f)];break;case m[_0x3d7616(0x1ef)][_0x3d7616(0x1de)]:_0x515d03=_0x938748[_0x3d7616(0x2e4)];break;case m[_0x3d7616(0x1ef)][_0x3d7616(0x33e)]:_0x515d03=_0x938748[_0x3d7616(0x39f)];break;case m['PivotDateGroupFieldDateTypeEnum'][_0x3d7616(0x296)]:_0x515d03=_0x938748['sheets-pivot.dateGroup.monthDate'];break;case m[_0x3d7616(0x1ef)][_0x3d7616(0x3c9)]:_0x515d03=_0x938748['sheets-pivot.dateGroup.yearQuarter'];break;default:_0x515d03='';break;}return _0x515d03;}const Nt=_0x58c229(0x3ba),Bt={};var gn=Object['getOwnPropertyDescriptor'],hn=(_0x3536ee,_0x42c6ed,_0x2d3c97,_0x28a2af)=>{const _0x4c9deb=_0x58c229;for(var _0x5bd3e8=_0x28a2af>0x1?void 0x0:_0x28a2af?gn(_0x42c6ed,_0x2d3c97):_0x42c6ed,_0x441357=_0x3536ee[_0x4c9deb(0x3ca)]-0x1,_0x419e2d;_0x441357>=0x0;_0x441357--)(_0x419e2d=_0x3536ee[_0x441357])&&(_0x5bd3e8=_0x419e2d(_0x5bd3e8)||_0x5bd3e8);return _0x5bd3e8;},Ae=(_0x3c9366,_0x582a51)=>(_0x36f4fb,_0x5676b3)=>_0x582a51(_0x36f4fb,_0x5676b3,_0x3c9366);exports[_0x58c229(0x416)]=class extends v['Disposable']{constructor(_0x5e3fc8,_0x34db3b,_0x282829,_0x2b2370,_0x56fe86){const _0x468688=_0x58c229;super(),x(this,'_model',new Map()),x(this,_0x468688(0x391),new Map()),x(this,_0x468688(0x14d),new Map()),x(this,'_pivotTableMatrixInfo',new Map()),x(this,_0x468688(0x131),new ge[(_0x468688(0x2c9))]()),x(this,_0x468688(0x22c),new ge[(_0x468688(0x2c9))]()),x(this,_0x468688(0x136),this['_pivotInitCompleted$'][_0x468688(0x2cd)]()),x(this,'_pivotConfigChange$',new ge[(_0x468688(0x2c9))]()),x(this,_0x468688(0x249),this[_0x468688(0x1f8)][_0x468688(0x2cd)]()),x(this,'_textInfo',{}),x(this,'configVersion$',this['_configVersion$']['asObservable']()),(this[_0x468688(0x20c)]=_0x5e3fc8,this[_0x468688(0x37b)]=_0x34db3b,this[_0x468688(0x245)]=_0x282829,this[_0x468688(0x22a)]=_0x2b2370,this[_0x468688(0x35a)]=_0x56fe86,this[_0x468688(0x3ec)](),this[_0x468688(0x138)]());const _0xff8a0=this[_0x468688(0x35a)]['getConfig'](Nt);(_0xff8a0==null?void 0x0:_0xff8a0[_0x468688(0x3a7)])===!0x0&&this[_0x468688(0x1b5)]();}[_0x58c229(0x138)](){const _0x3464d8=_0x58c229;this[_0x3464d8(0x17a)](this[_0x3464d8(0x245)][_0x3464d8(0x2c6)](v['UniverInstanceType'][_0x3464d8(0x2cb)])[_0x3464d8(0x1c3)](_0x18dd9e=>{const _0x488a71=_0x3464d8;this['deleteUnitId'](_0x18dd9e[_0x488a71(0x385)]());}));}[_0x58c229(0x3ce)](){const _0x4a4e24=_0x58c229;this[_0x4a4e24(0x22c)][_0x4a4e24(0x3f0)](!0x0);}[_0x58c229(0x3ec)](){const _0x2721a5=_0x58c229,_0x324d1e=Dt(this[_0x2721a5(0x20c)],$t,'',{});this[_0x2721a5(0x318)]=_0x324d1e,this['_commandService']['executeCommand'](_t['id'],{'textInfo':_0x324d1e},{'onlyLocal':!0x0});}[_0x58c229(0x15c)](){const _0x3390c1=_0x58c229;return this[_0x3390c1(0x318)];}[_0x58c229(0x295)](_0x2b9ba6,_0x1b9598,_0x211a7c,_0x3c7158,_0x17cdeb){const _0x3a1911=_0x58c229;this[_0x3a1911(0x142)](_0x2b9ba6,_0x1b9598,_0x211a7c,_0x3c7158),this[_0x3a1911(0x236)](_0x2b9ba6,_0x1b9598,_0x211a7c,_0x17cdeb);}[_0x58c229(0x338)](_0xfff81c,_0x156e39,_0x2b56d2){const _0x5c744b=_0x58c229;var _0x499b73;const _0x3cf416=(_0x499b73=this[_0x5c744b(0x123)][_0x5c744b(0x15b)](_0xfff81c))==null?void 0x0:_0x499b73[_0x5c744b(0x15b)](_0x156e39);if(_0x3cf416)return _0x3cf416['get'](_0x2b56d2);}[_0x58c229(0x2e2)](_0x31d3c9,_0x271ca6){const _0x23c984=_0x58c229,_0x432590=this[_0x23c984(0x123)][_0x23c984(0x15b)](_0x31d3c9);if(_0x432590){for(const [_0x1781a0,_0x473c30]of _0x432590['entries']())for(const [_0x10d3cc,_0x291e8e]of _0x473c30[_0x23c984(0x15f)]())if(_0x10d3cc===_0x271ca6)return _0x291e8e[_0x23c984(0x18b)];}}[_0x58c229(0x1dd)](_0x15692d,_0x569574,_0x274896){const _0x132065=_0x58c229,_0x1a95b9=this[_0x132065(0x338)](_0x15692d,_0x569574,_0x274896);return _0x1a95b9==null?void 0x0:_0x1a95b9['targetCellInfo'];}[_0x58c229(0x135)](_0x2f8333,_0x3fd34d){const _0x364b9e=_0x58c229;var _0x5f59de;return(_0x5f59de=this[_0x364b9e(0x123)]['get'](_0x2f8333))==null?void 0x0:_0x5f59de[_0x364b9e(0x15b)](_0x3fd34d);}[_0x58c229(0x253)](_0x254e01,_0x22c77b,_0x4e868a,_0x375fee){const _0x6c023e=_0x58c229,_0x422501=this['_ensurePivotMap'](_0x254e01,_0x22c77b);_0x375fee?_0x422501[_0x6c023e(0x1db)](_0x4e868a,_0x375fee):_0x422501[_0x6c023e(0x3f7)](_0x4e868a),this[_0x6c023e(0x1f8)][_0x6c023e(0x3f0)]({'unitId':_0x254e01,'subUnitId':_0x22c77b,'pivotTableId':_0x4e868a,'pivotTableConfig':_0x375fee});}['getCollection'](_0x19a5cb,_0x5f56b5){const _0x118c79=_0x58c229;var _0x2c83ee;return(_0x2c83ee=this[_0x118c79(0x391)]['get'](_0x19a5cb))==null?void 0x0:_0x2c83ee[_0x118c79(0x255)][_0x5f56b5];}[_0x58c229(0x3c1)](_0x5ea93b,_0x2a1a96){const _0x1c9a87=_0x58c229;this[_0x1c9a87(0x391)][_0x1c9a87(0x1db)](_0x5ea93b,_0x2a1a96),this[_0x1c9a87(0x131)][_0x1c9a87(0x3f0)](Math[_0x1c9a87(0x3b2)]());}['_ensurePivotMap'](_0xba1027,_0x2611bf){const _0x41e08e=_0x58c229;let _0x2da1be=this['_model'][_0x41e08e(0x15b)](_0xba1027);_0x2da1be||(_0x2da1be=new Map(),this[_0x41e08e(0x123)][_0x41e08e(0x1db)](_0xba1027,_0x2da1be));let _0x127b88=_0x2da1be['get'](_0x2611bf);return _0x127b88||(_0x127b88=new Map(),_0x2da1be[_0x41e08e(0x1db)](_0x2611bf,_0x127b88)),_0x127b88;}[_0x58c229(0x283)](_0x55468b,_0x409f91){const _0x36c72e=_0x58c229;let _0x1c2847=this['_pivotTableRangeInfo']['get'](_0x55468b);_0x1c2847||(_0x1c2847=new Map(),this['_pivotTableRangeInfo'][_0x36c72e(0x1db)](_0x55468b,_0x1c2847));let _0x5523cd=_0x1c2847['get'](_0x409f91);return _0x5523cd||(_0x5523cd=new Map(),_0x1c2847[_0x36c72e(0x1db)](_0x409f91,_0x5523cd)),_0x5523cd;}[_0x58c229(0x3be)](_0x42ca2a,_0x4050){const _0x4111e7=_0x58c229;let _0x1ff2e9=this[_0x4111e7(0x1f4)][_0x4111e7(0x15b)](_0x42ca2a);_0x1ff2e9||(_0x1ff2e9=new Map(),this['_pivotTableMatrixInfo'][_0x4111e7(0x1db)](_0x42ca2a,_0x1ff2e9));let _0x1bc09a=_0x1ff2e9[_0x4111e7(0x15b)](_0x4050);return _0x1bc09a||(_0x1bc09a=new Map(),_0x1ff2e9[_0x4111e7(0x1db)](_0x4050,_0x1bc09a)),_0x1bc09a;}[_0x58c229(0x236)](_0x4246b1,_0x2bec9e,_0x718de3,_0x558c9c){const _0x3446e5=_0x58c229;var _0x30a01a;const _0x44ab9c=this['_ensurePivotTableRangeInfo'](_0x4246b1,_0x2bec9e),_0x2e9d37=(_0x30a01a=_0x44ab9c[_0x3446e5(0x15b)](_0x718de3))==null?void 0x0:_0x30a01a[_0x3446e5(0x364)];_0x44ab9c['set'](_0x718de3,{'oldRangeInfo':_0x2e9d37,'rangeInfo':_0x558c9c});}[_0x58c229(0x142)](_0x1bc25b,_0x4a7d1e,_0xbd9672,_0x13ab14){const _0x513ae8=_0x58c229;var _0x155315;const _0x4fd971=this[_0x513ae8(0x3be)](_0x1bc25b,_0x4a7d1e),_0x303fac=(_0x155315=_0x4fd971[_0x513ae8(0x15b)](_0xbd9672))==null?void 0x0:_0x155315['oldMatrix'];_0x4fd971['set'](_0xbd9672,{'oldMatrix':_0x303fac,'matrix':_0x13ab14});}[_0x58c229(0x360)](_0x75ee6e,_0x16dd5d,_0x216b99){const _0x298d3c=_0x58c229;var _0x4c8b2f,_0x368b19;return(_0x368b19=(_0x4c8b2f=this[_0x298d3c(0x14d)][_0x298d3c(0x15b)](_0x75ee6e))==null?void 0x0:_0x4c8b2f[_0x298d3c(0x15b)](_0x16dd5d))==null?void 0x0:_0x368b19[_0x298d3c(0x15b)](_0x216b99);}['getPivotTableMatrixInfo'](_0x1b5c2c,_0x4a9c5e,_0x71df5c){const _0x50fd5c=_0x58c229;var _0x516885,_0x59038c;return(_0x59038c=(_0x516885=this[_0x50fd5c(0x1f4)][_0x50fd5c(0x15b)](_0x1b5c2c))==null?void 0x0:_0x516885['get'](_0x4a9c5e))==null?void 0x0:_0x59038c[_0x50fd5c(0x15b)](_0x71df5c);}['deleteUnitId'](_0x3356c2){const _0x3fed7a=_0x58c229;this[_0x3fed7a(0x123)]['delete'](_0x3356c2),this[_0x3fed7a(0x391)][_0x3fed7a(0x3f7)](_0x3356c2);}['_toJSON'](_0xa03ee3){const _0x124057=_0x58c229,_0x1658fe={'dataFieldManagerConfig':{},'pivotTableConfigs':{}};if(this[_0x124057(0x391)]['get'](_0xa03ee3)&&(_0x1658fe[_0x124057(0x306)][_0xa03ee3]=this[_0x124057(0x391)]['get'](_0xa03ee3)),this[_0x124057(0x123)][_0x124057(0x15b)](_0xa03ee3)){_0x1658fe['pivotTableConfigs'][_0xa03ee3]={};const _0x1fc1c8=this[_0x124057(0x123)]['get'](_0xa03ee3);_0x1fc1c8!=null&&_0x1fc1c8['size']&&[..._0x1fc1c8[_0x124057(0x284)]()][_0x124057(0x124)](_0x1afaf5=>{const _0x106fad=_0x124057,_0xa43e=_0x1fc1c8[_0x106fad(0x15b)](_0x1afaf5);_0xa43e!=null&&_0xa43e[_0x106fad(0x290)]&&(_0x1658fe[_0x106fad(0x119)][_0xa03ee3][_0x1afaf5]={},[..._0xa43e[_0x106fad(0x284)]()]['forEach'](_0x2227fc=>{const _0x2da7fa=_0x106fad,_0x20b6eb=_0xa43e[_0x2da7fa(0x15b)](_0x2227fc);_0x20b6eb&&(_0x1658fe[_0x2da7fa(0x119)][_0xa03ee3][_0x1afaf5][_0x2227fc]=_0x20b6eb);}));});}return _0x1658fe;}[_0x58c229(0x1b5)](){const _0x20c5c9=_0x58c229;this[_0x20c5c9(0x17a)](this[_0x20c5c9(0x22a)][_0x20c5c9(0x200)]({'toJson':_0x3bdc55=>JSON['stringify'](this[_0x20c5c9(0x211)](_0x3bdc55)),'parseJson':_0x3ac045=>({}),'businesses':[v['UniverInstanceType']['UNIVER_SHEET']],'pluginName':Ct,'onLoad':(_0x5f19a9,_0x22e8bd)=>{},'onUnLoad':_0x4ed223=>{const _0x1e6d03=_0x20c5c9;this[_0x1e6d03(0x264)](_0x4ed223);}}));}},exports[_0x58c229(0x416)]=hn([Ae(0x0,v['Inject'](v[_0x58c229(0x3ee)])),Ae(0x1,v[_0x58c229(0x198)](v[_0x58c229(0x341)])),Ae(0x2,v[_0x58c229(0x198)](v[_0x58c229(0x185)])),Ae(0x3,v[_0x58c229(0x198)](v[_0x58c229(0x300)])),Ae(0x4,v[_0x58c229(0x198)](v[_0x58c229(0x1ab)]))],exports[_0x58c229(0x416)]);var pn=Object[_0x58c229(0x21f)],mn=(_0x230788,_0x3e5d97,_0x1f36d0,_0x1ca736)=>{for(var _0x28f595=_0x1ca736>0x1?void 0x0:_0x1ca736?pn(_0x3e5d97,_0x1f36d0):_0x3e5d97,_0x141dee=_0x230788['length']-0x1,_0x4f675a;_0x141dee>=0x0;_0x141dee--)(_0x4f675a=_0x230788[_0x141dee])&&(_0x28f595=_0x4f675a(_0x28f595)||_0x28f595);return _0x28f595;},ke=(_0xe705ab,_0x281814)=>(_0x590b7b,_0x144ed4)=>_0x281814(_0x590b7b,_0x144ed4,_0xe705ab);exports[_0x58c229(0x330)]=class extends v[_0x58c229(0x351)]{constructor(_0x3b1613,_0x39e469,_0x2f3512,_0x3b7633,_0x431099){const _0x3ad942=_0x58c229;super(),x(this,_0x3ad942(0x1a6),new Map()),x(this,'_pivotRenderValueMatrixCache',new Map()),x(this,_0x3ad942(0x22e),new ge[(_0x3ad942(0x2c9))]()),x(this,_0x3ad942(0x18a),this['_markDirty$']['asObservable']()),x(this,'_viewUpdate$',new ge[(_0x3ad942(0x2c9))]()),x(this,_0x3ad942(0x355),this[_0x3ad942(0x31b)][_0x3ad942(0x2cd)]()),x(this,'_textInfo'),(this[_0x3ad942(0x2f9)]=_0x3b1613,this[_0x3ad942(0x20c)]=_0x39e469,this[_0x3ad942(0x372)]=_0x2f3512,this[_0x3ad942(0x245)]=_0x3b7633,this[_0x3ad942(0x263)]=_0x431099,this[_0x3ad942(0x3ec)](),this[_0x3ad942(0x138)]());}[_0x58c229(0x138)](){const _0x5d6e41=_0x58c229;this[_0x5d6e41(0x17a)](this['_univerInstanceService'][_0x5d6e41(0x2c6)](v[_0x5d6e41(0x232)][_0x5d6e41(0x2cb)])[_0x5d6e41(0x1c3)](_0x3fc411=>{const _0x745329=_0x5d6e41;this[_0x745329(0x264)](_0x3fc411['getUnitId']());}));}['_initLocale'](){const _0xc3f7b1=_0x58c229;this['_textInfo']=Dt(this[_0xc3f7b1(0x20c)],$t,'',{});}['updateRenderCache'](_0x4eee28){const _0x48ec2b=_0x58c229,{view:_0x375130,unitId:_0x2bbf6a,subUnitId:_0x26dd1e,pivotTableId:_0x55fe23,type:_0x2be78c}=_0x4eee28,_0xf58bcb=this['_sheetsPivotTableConfigModel'][_0x48ec2b(0x338)](_0x2bbf6a,_0x26dd1e,_0x55fe23);if(!_0x375130||!_0xf58bcb||_0x2be78c===j['Delete'])return;const {pageView:_0x24e78c,cornerView:_0x54f451,rowView:_0x34c0e4,colView:_0x52bf8f,dataView:_0x5e8337}=_0x375130,_0x28eb75=_0xf58bcb[_0x48ec2b(0x18b)],_0x1b8e68=_0xf58bcb['isEmpty'],_0x355b6f=this['_ensurePivotItemRenderValueMatrixCache'](_0x2bbf6a,_0x26dd1e),_0x2557b5=this[_0x48ec2b(0x125)](_0x2bbf6a,_0x26dd1e,_0x55fe23);if(_0x1b8e68)return this[_0x48ec2b(0x291)](_0x4eee28,_0x355b6f,_0x28eb75,_0x2557b5);{const _0xf0ecaf=ne(_0x28eb75,_0x24e78c,!0x0),_0x2e6f01=_0x24e78c[_0x48ec2b(0x217)]>=0x0?_0x24e78c['lastRow']+0x1:0x0,_0x2e1951=_0x54f451['getRowCount'](),_0x5e43e3=_0x54f451['getColCount'](),_0x114048=_0xf0ecaf['length']>0x0?Re:0x0,_0x440fe2=ne({'row':_0x28eb75[_0x48ec2b(0x1d4)]+_0x2e6f01+_0x114048,'col':_0x28eb75['col']},_0x54f451,!0x1,!0x1),_0x26bcc6=ne({'row':_0x28eb75[_0x48ec2b(0x1d4)]+_0x2e6f01+_0x114048+_0x2e1951,'col':_0x28eb75['col']},_0x34c0e4,!0x1,!0x0),_0xf834e5=ne({'row':_0x28eb75['row']+_0x2e6f01+_0x114048,'col':_0x28eb75[_0x48ec2b(0x178)]+_0x5e43e3},_0x52bf8f,!0x1,!0x0),_0x3591b3=ne({'row':_0x28eb75['row']+_0x2e6f01+_0x114048+_0x2e1951,'col':_0x28eb75[_0x48ec2b(0x178)]+_0x5e43e3},_0x5e8337,!0x1,!0x1);_0x2557b5[_0x48ec2b(0x3d3)]={'rowRanges':_0x26bcc6,'colRanges':_0xf834e5,'cornerRanges':_0x440fe2,'dataRanges':_0x3591b3,'pageRanges':_0xf0ecaf};const _0x145ae2=Jo(this['_injector'],_0x375130,_0xf58bcb,this['_textInfo']),{valueMatrix:_0x300726,rowInfo:_0xcb9810,colInfo:_0x5506b9,cornerInfo:_0x5d6c95,rowHeaderMap:_0x4dd2b7,colHeaderMap:_0x526d63}=_0x145ae2;return _0x2557b5[_0x48ec2b(0x116)]={'rowInfo':_0xcb9810,'colInfo':_0x5506b9,'cornerInfo':_0x5d6c95},_0x2557b5['headerMap']={'rowHeaderMap':_0x4dd2b7,'colHeaderMap':_0x526d63},_0x300726['forEach']((_0x2dcf03,_0x29651a)=>{const _0x52911f=_0x48ec2b;Object[_0x52911f(0x284)](_0x29651a)[_0x52911f(0x124)](_0x4797a8=>{const _0x1bb1d5=_0x52911f,_0x300412=+_0x4797a8,_0x511988=_0x300726[_0x1bb1d5(0x2d8)](_0x2dcf03,_0x300412);_0x355b6f[_0x1bb1d5(0x258)](_0x2dcf03,_0x300412,_0x511988);});}),this[_0x48ec2b(0x31b)]['next']({'unitId':_0x2bbf6a,'subUnitId':_0x26dd1e,'valueMatrix':_0x355b6f,'rangesCache':_0x2557b5[_0x48ec2b(0x3d3)],'pivotTableId':_0x55fe23,'type':_0x4eee28[_0x48ec2b(0x1df)]}),this[_0x48ec2b(0x372)]['updateViewInfo'](_0x2bbf6a,_0x26dd1e,_0x55fe23,_0x355b6f,_0x2557b5[_0x48ec2b(0x3d3)]),this[_0x48ec2b(0x263)][_0x48ec2b(0x2a3)](_0x2bbf6a,_0x26dd1e,bt,this[_0x48ec2b(0x2c3)](_0x2557b5[_0x48ec2b(0x3d3)],_0x55fe23)),{'rangeCache':_0x2557b5['rangesInfo'],'matrix':_0x355b6f};}}['_updateRenderEmptyCache'](_0x3ee408,_0x14e201,_0x181508,_0x4e9e63){const _0x620dc=_0x58c229,_0x2e32e3=this[_0x620dc(0x2f9)]['t'],{unitId:_0x379449,subUnitId:_0x2003b8,pivotTableId:_0xfd7b25}=_0x3ee408,_0xbbfccc={'filter':_0x2e32e3(_0x620dc(0x1b6)),'row':_0x2e32e3(_0x620dc(0x30e)),'column':_0x2e32e3(_0x620dc(0x241)),'values':_0x2e32e3('sheets-pivot.emptyPivot.values')},{matrixCache:_0x4d05d2,rangesCache:_0x30e665}=Ht(_0xbbfccc,_0x181508);return _0x4d05d2['forValue']((_0x816948,_0x444f4c,_0x459b5c)=>{const _0x66f90e=_0x620dc;_0x14e201[_0x66f90e(0x258)](_0x816948,_0x444f4c,_0x459b5c);}),_0x4e9e63[_0x620dc(0x3d3)]=_0x30e665,this[_0x620dc(0x31b)][_0x620dc(0x3f0)]({'unitId':_0x379449,'subUnitId':_0x2003b8,'valueMatrix':_0x14e201,'rangesCache':_0x30e665,'pivotTableId':_0xfd7b25,'type':_0x3ee408[_0x620dc(0x1df)],'isEmpty':!0x0}),this['_sheetsPivotTableConfigModel'][_0x620dc(0x295)](_0x379449,_0x2003b8,_0xfd7b25,_0x14e201,_0x30e665),this[_0x620dc(0x263)][_0x620dc(0x2a3)](_0x379449,_0x2003b8,bt,this['_createExclusiveRange'](_0x30e665,_0xfd7b25)),{'rangeCache':_0x4e9e63[_0x620dc(0x3d3)],'matrix':_0x14e201};}[_0x58c229(0x2c3)](_0x1ac464,_0x7b99d1){const _0x98d88c=_0x58c229,_0x46db24=[],_0x42c90a=nt(_0x1ac464);for(const _0x63d49c of _0x42c90a)_0x46db24[_0x98d88c(0x2c5)]({'groupId':_0x7b99d1,'range':_0x63d49c});return _0x46db24;}[_0x58c229(0x218)](_0x19ac38){const _0x2685a8=_0x58c229;var _0x5bebd4,_0x524239,_0x1a5bba,_0x333b7f;const {pivotTableId:_0xe11345,unitId:_0x39b0e4,subUnitId:_0xd5e9e}=_0x19ac38;if(!_0xe11345||!_0x39b0e4||!_0xd5e9e)return;const _0x381fdb=this[_0x2685a8(0x410)](_0x39b0e4,_0xd5e9e),_0x2893cd=(_0x524239=(_0x5bebd4=this[_0x2685a8(0x1a6)][_0x2685a8(0x15b)](_0x39b0e4))==null?void 0x0:_0x5bebd4[_0x2685a8(0x15b)](_0xd5e9e))==null?void 0x0:_0x524239['get'](_0xe11345);if(_0x2893cd!=null&&_0x2893cd[_0x2685a8(0x3d3)]){for(const _0x593a0 of Object[_0x2685a8(0x284)](_0x2893cd[_0x2685a8(0x3d3)]))_0x2893cd['rangesInfo'][_0x593a0][_0x2685a8(0x124)](_0x178812=>{const _0x4b8fa4=_0x2685a8;for(let _0x188c38=_0x178812[_0x4b8fa4(0x1fd)];_0x188c38<=_0x178812[_0x4b8fa4(0x12d)];_0x188c38++)for(let _0x3bf3d8=_0x178812['startColumn'];_0x3bf3d8<=_0x178812[_0x4b8fa4(0x1ea)];_0x3bf3d8++)_0x381fdb[_0x4b8fa4(0x121)](_0x188c38,_0x3bf3d8);});}_0x2893cd&&((_0x333b7f=(_0x1a5bba=this[_0x2685a8(0x1a6)][_0x2685a8(0x15b)](_0x39b0e4))==null?void 0x0:_0x1a5bba[_0x2685a8(0x15b)](_0xd5e9e))==null||_0x333b7f[_0x2685a8(0x3f7)](_0xe11345)),this[_0x2685a8(0x31b)][_0x2685a8(0x3f0)]({'unitId':_0x39b0e4,'subUnitId':_0xd5e9e,'valueMatrix':_0x381fdb,'pivotTableId':_0xe11345,'rangesCache':void 0x0,'type':_0x19ac38['type']}),this[_0x2685a8(0x263)]['clearExclusiveRangesByGroupId'](_0x39b0e4,_0xd5e9e,bt,_0xe11345);}[_0x58c229(0x125)](_0xb54d88,_0x4e5576,_0x522acc){const _0x2d7609=_0x58c229;var _0x164110,_0x22a1d1,_0x527e85,_0x562d21,_0x14b9c9,_0x383d48;return this[_0x2d7609(0x1a6)]['has'](_0xb54d88)||this['_pivotRenderInfoCache']['set'](_0xb54d88,new Map()),(_0x164110=this['_pivotRenderInfoCache'][_0x2d7609(0x15b)](_0xb54d88))!=null&&_0x164110['has'](_0x4e5576)||(_0x22a1d1=this[_0x2d7609(0x1a6)]['get'](_0xb54d88))==null||_0x22a1d1['set'](_0x4e5576,new Map()),(_0x562d21=(_0x527e85=this['_pivotRenderInfoCache'][_0x2d7609(0x15b)](_0xb54d88))==null?void 0x0:_0x527e85[_0x2d7609(0x15b)](_0x4e5576))!=null&&_0x562d21['has'](_0x522acc)||(_0x383d48=(_0x14b9c9=this['_pivotRenderInfoCache'][_0x2d7609(0x15b)](_0xb54d88))==null?void 0x0:_0x14b9c9[_0x2d7609(0x15b)](_0x4e5576))==null||_0x383d48['set'](_0x522acc,{}),this[_0x2d7609(0x1a6)][_0x2d7609(0x15b)](_0xb54d88)[_0x2d7609(0x15b)](_0x4e5576)[_0x2d7609(0x15b)](_0x522acc);}[_0x58c229(0x410)](_0x2a1777,_0x554e43){const _0x2a6dd9=_0x58c229;var _0x1ccc7d,_0xc5631f;return this[_0x2a6dd9(0x417)]['has'](_0x2a1777)||this['_pivotRenderValueMatrixCache'][_0x2a6dd9(0x1db)](_0x2a1777,new Map()),(_0x1ccc7d=this[_0x2a6dd9(0x417)][_0x2a6dd9(0x15b)](_0x2a1777))!=null&&_0x1ccc7d[_0x2a6dd9(0x38f)](_0x554e43)||(_0xc5631f=this[_0x2a6dd9(0x417)][_0x2a6dd9(0x15b)](_0x2a1777))==null||_0xc5631f[_0x2a6dd9(0x1db)](_0x554e43,new v['ObjectMatrix']()),this[_0x2a6dd9(0x417)][_0x2a6dd9(0x15b)](_0x2a1777)[_0x2a6dd9(0x15b)](_0x554e43);}['getPivotTableCellData'](_0x2ac269,_0x2702c0,_0x2d1f9a,_0x5f2e94){const _0x580d2e=_0x58c229;var _0x153cb6,_0xd620f5;const _0x500925=(_0xd620f5=(_0x153cb6=this[_0x580d2e(0x417)][_0x580d2e(0x15b)](_0x2ac269))==null?void 0x0:_0x153cb6[_0x580d2e(0x15b)](_0x2702c0))==null?void 0x0:_0xd620f5[_0x580d2e(0x2d8)](_0x2d1f9a,_0x5f2e94);if(_0x500925!=null)return _0x500925;}[_0x58c229(0x282)](_0x20a6d3,_0x1fd674,_0x16ace4,_0x5bb0f5){const _0x2e6aaf=_0x58c229;var _0x9be454;const _0x1b0d7e=v[_0x2e6aaf(0x15d)](_0x16ace4,_0x5bb0f5),_0x3fcc20=(_0x9be454=this['_pivotRenderInfoCache'][_0x2e6aaf(0x15b)](_0x20a6d3))==null?void 0x0:_0x9be454[_0x2e6aaf(0x15b)](_0x1fd674);return _0x3fcc20?Array[_0x2e6aaf(0x305)](_0x3fcc20[_0x2e6aaf(0x284)]())[_0x2e6aaf(0x308)](_0x41144c=>{const _0x485214=_0x2e6aaf,_0x31db8f=_0x3fcc20[_0x485214(0x15b)](_0x41144c),_0x2c1e33=_0x31db8f==null?void 0x0:_0x31db8f[_0x485214(0x3d3)];return _0x2c1e33?Object[_0x485214(0x284)](_0x2c1e33)[_0x485214(0x160)](_0x2f3d85=>_0x2c1e33[_0x2f3d85][_0x485214(0x160)](_0x5af5ef=>v[_0x485214(0x22f)]['contains'](_0x5af5ef,_0x1b0d7e))):!0x1;}):void 0x0;}[_0x58c229(0x14f)](_0x4a7644,_0x30db74,_0x5006a7){const _0xc187af=_0x58c229;var _0x665380;const _0x14cc72=(_0x665380=this[_0xc187af(0x1a6)]['get'](_0x4a7644))==null?void 0x0:_0x665380[_0xc187af(0x15b)](_0x30db74),_0x1b80c2=[];return _0x14cc72&&Array[_0xc187af(0x305)](_0x14cc72['keys']())['forEach'](_0x4d0ac7=>{const _0x1788da=_0xc187af,_0x23e652=_0x14cc72[_0x1788da(0x15b)](_0x4d0ac7),_0x26aeec=_0x23e652==null?void 0x0:_0x23e652[_0x1788da(0x3d3)];if(_0x26aeec)for(const _0x4b1061 of Object['values'](_0x26aeec)){let _0x3b5ee7=!0x1;for(const _0x1cca1c of _0x4b1061)if(v[_0x1788da(0x22f)][_0x1788da(0x10f)](_0x1cca1c,_0x5006a7)){_0x1b80c2[_0x1788da(0x2c5)](_0x4d0ac7),_0x3b5ee7=!0x0;break;}if(_0x3b5ee7)break;}}),_0x1b80c2;}[_0x58c229(0x29b)](_0x2700ee,_0x5ea9d7){const _0xa85651=_0x58c229;var _0x3ce412,_0xb66452;return(_0xb66452=(_0x3ce412=this['_pivotRenderValueMatrixCache'][_0xa85651(0x15b)](_0x2700ee))==null?void 0x0:_0x3ce412[_0xa85651(0x15b)](_0x5ea9d7))!=null?_0xb66452:new v['ObjectMatrix']();}[_0x58c229(0x266)](_0x32c2dc,_0x37cce5){const _0x13961f=_0x58c229;var _0x35340b;return(_0x35340b=this['_pivotRenderInfoCache'][_0x13961f(0x15b)](_0x32c2dc))==null?void 0x0:_0x35340b[_0x13961f(0x15b)](_0x37cce5);}['getPivotItemRenderInfoCache'](_0x139a63,_0x522def,_0x295916){const _0x259c55=_0x58c229;var _0x370509,_0x1690f4;return(_0x1690f4=(_0x370509=this[_0x259c55(0x1a6)][_0x259c55(0x15b)](_0x139a63))==null?void 0x0:_0x370509['get'](_0x522def))==null?void 0x0:_0x1690f4[_0x259c55(0x15b)](_0x295916);}[_0x58c229(0x264)](_0x52c5f5){const _0x5737fd=_0x58c229;this[_0x5737fd(0x1a6)]['delete'](_0x52c5f5),this[_0x5737fd(0x417)][_0x5737fd(0x3f7)](_0x52c5f5);}['markDirty'](_0x1494eb,_0xfc53f0){const _0x533186=_0x58c229;this['_markDirty$'][_0x533186(0x3f0)]({'unitId':_0x1494eb,'subUnitId':_0xfc53f0});}},exports[_0x58c229(0x330)]=mn([ke(0x0,v[_0x58c229(0x198)](v['LocaleService'])),ke(0x1,v[_0x58c229(0x198)](v[_0x58c229(0x3ee)])),ke(0x2,v['Inject'](exports['SheetsPivotTableConfigModel'])),ke(0x3,v[_0x58c229(0x198)](v[_0x58c229(0x185)])),ke(0x4,v[_0x58c229(0x198)](V[_0x58c229(0x2c7)]))],exports[_0x58c229(0x330)]);var In=Object[_0x58c229(0x21f)],Cn=(_0x42d94e,_0x8bc3ef,_0x47b6d9,_0x32d20c)=>{const _0x216ea1=_0x58c229;for(var _0x1b5b9a=_0x32d20c>0x1?void 0x0:_0x32d20c?In(_0x8bc3ef,_0x47b6d9):_0x8bc3ef,_0x3a842d=_0x42d94e[_0x216ea1(0x3ca)]-0x1,_0x48d8e3;_0x3a842d>=0x0;_0x3a842d--)(_0x48d8e3=_0x42d94e[_0x3a842d])&&(_0x1b5b9a=_0x48d8e3(_0x1b5b9a)||_0x1b5b9a);return _0x1b5b9a;},jt=(_0x204d36,_0x36f4e5)=>(_0x513a1d,_0x2f9bec)=>_0x36f4e5(_0x513a1d,_0x2f9bec,_0x204d36);exports['SheetsPivotTableService']=class extends v[_0x58c229(0x351)]{constructor(_0x1c5dcd,_0x25b523){const _0x45c780=_0x58c229;super(),x(this,_0x45c780(0x32c),new v['AsyncInterceptorManager']({'PIVOT_PERFORM_CHECK':re})),x(this,_0x45c780(0x3fd),new v[(_0x45c780(0x18e))]({'PIVOT_MUTATION_GENERATE':Jt})),(this[_0x45c780(0x239)]=_0x1c5dcd,this[_0x45c780(0x1b4)]=_0x25b523,this[_0x45c780(0x38a)]());}['_init'](){this['_initViewModelBySheetInterceptor']();}[_0x58c229(0x23d)](_0x24d745){const _0x1a4289=_0x58c229;return this[_0x1a4289(0x32c)][_0x1a4289(0x2ee)](re)(!0x1,_0x24d745);}['_initViewModelBySheetInterceptor'](){const _0x3a535b=_0x58c229;this[_0x3a535b(0x17a)](this[_0x3a535b(0x239)]['intercept'](V[_0x3a535b(0x2d1)]['CELL_CONTENT'],{'priority':0xc8,'effect':v[_0x3a535b(0x404)][_0x3a535b(0x187)]|v[_0x3a535b(0x404)][_0x3a535b(0x375)],'handler':(_0x1a6ffd,_0x11ec70,_0x150115)=>{const _0x42762=_0x3a535b,{row:_0x1cad0f,col:_0x314053,unitId:_0x846312,subUnitId:_0x8ebcfa,workbook:_0x29e1cf}=_0x11ec70,_0x4cd1bd=this[_0x42762(0x1b4)][_0x42762(0x327)](_0x846312,_0x8ebcfa,_0x1cad0f,_0x314053);if(!_0x4cd1bd)return _0x150115(_0x1a6ffd);const _0x4b0d71={..._0x1a6ffd};(_0x4cd1bd['v']||_0x4cd1bd['v']===0x0)&&(_0x4b0d71['v']=_0x4cd1bd['v']),_0x4cd1bd['t']&&(_0x4b0d71['t']=_0x4cd1bd['t']);const _0x26c909=(typeof(_0x1a6ffd==null?void 0x0:_0x1a6ffd['s'])==_0x42762(0x268)?_0x29e1cf[_0x42762(0x3f1)]()[_0x42762(0x15b)](_0x1a6ffd==null?void 0x0:_0x1a6ffd['s']):_0x1a6ffd==null?void 0x0:_0x1a6ffd['s'])||{},_0x5ac723=_0x29e1cf['getStyles']()[_0x42762(0x15b)](_0x4cd1bd['s']),_0x5b2293={..._0x5ac723,..._0x26c909};_0x5ac723!=null&&_0x5ac723['n']&&(_0x5b2293['n']=_0x5ac723['n']);const _0x1c1d76=_0x29e1cf[_0x42762(0x3f1)]()['setValue'](_0x5b2293);return _0x4b0d71['s']=_0x1c1d76,(_0x4cd1bd[_0x42762(0x3db)]===m[_0x42762(0x26b)][_0x42762(0x127)]||_0x4cd1bd[_0x42762(0x3db)]===m['PivotCellStyleTypeEnum'][_0x42762(0x319)])&&(_0x4b0d71[_0x42762(0x188)]={},_0x4b0d71[_0x42762(0x188)][_0x42762(0x371)]=_o),_0x150115(_0x4b0d71);}}));}},exports[_0x58c229(0x1ce)]=Cn([jt(0x0,v[_0x58c229(0x198)](V['SheetInterceptorService'])),jt(0x1,v[_0x58c229(0x198)](exports['SheetsPivotTableAdaptorModel']))],exports[_0x58c229(0x1ce)]);const Zt={'id':_0x58c229(0x195),'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'handler':(_0x9498e5,_0x1aec78)=>{const _0x4bb66b=_0x58c229;if(!_0x1aec78)return!0x1;if(!!_0x9498e5['get'](v['IConfigService'])[_0x4bb66b(0x17f)](q))return!0x0;const {pivotTableId:_0x18006c,fieldJSON:_0x24fedd,unitId:_0x6f580b,subUnitId:_0x1e98b1}=_0x1aec78;let _0x37541b;const {dataFieldType:_0x4b0713,id:_0x4c6cc6,name:_0x1f856e,hexCode:_0x2fbc53,originalFieldId:_0x2729e0}=_0x24fedd;if(_0x4b0713===m['PivotDataFieldTypeEnum'][_0x4bb66b(0x3eb)]&&(_0x37541b=new m[(_0x4bb66b(0x26c))](_0x4c6cc6,_0x1f856e,_0x2fbc53,_0x2729e0)),!_0x37541b)return!0x1;const _0x3a40c1=_0x9498e5[_0x4bb66b(0x15b)](exports[_0x4bb66b(0x297)]),_0x45af5e=_0x3a40c1[_0x4bb66b(0x34d)](_0x6f580b),_0x3586b8=_0x45af5e[_0x4bb66b(0x2af)](_0x18006c);_0x45af5e[_0x4bb66b(0x260)](_0x37541b),_0x3586b8['addField'](_0x37541b[_0x4bb66b(0x2ba)](),_0x37541b[_0x4bb66b(0x173)]());const _0x4303d1=_0x3586b8[_0x4bb66b(0x356)](_0x37541b['getOriginFieldId']());_0x4303d1&&_0x37541b['refreshGroupField'](_0x4303d1);const _0x41904f=_0x3a40c1[_0x4bb66b(0x338)](_0x6f580b,_0x1e98b1,_0x18006c);return _0x3a40c1[_0x4bb66b(0x288)]({'unitId':_0x6f580b,'subUnitId':_0x1e98b1,'token':_0x18006c,'type':j['Set'],'pivotConfig':_0x41904f}),!0x0;}},eo={'id':'sheet.mutation.remove-group-collection','type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'handler':(_0x3da529,_0x135eeb)=>{const _0x2e6f5b=_0x58c229;if(!_0x135eeb)return!0x1;if(!!_0x3da529[_0x2e6f5b(0x15b)](v[_0x2e6f5b(0x1ab)])[_0x2e6f5b(0x17f)](q))return!0x0;const {pivotTableId:_0x2675a1,dataFieldId:_0x3358b3,unitId:_0x2ecb26,subUnitId:_0x2bb7f8}=_0x135eeb,_0x361b97=_0x3da529[_0x2e6f5b(0x15b)](exports[_0x2e6f5b(0x297)]),_0x52f1cb=_0x361b97[_0x2e6f5b(0x34d)](_0x2ecb26);_0x52f1cb[_0x2e6f5b(0x2af)](_0x2675a1)[_0x2e6f5b(0x26f)](_0x3358b3);let _0x2f22bd=!0x0;for(const _0x1ce75d in _0x52f1cb[_0x2e6f5b(0x255)])if(_0x52f1cb[_0x2e6f5b(0x255)][_0x1ce75d][_0x2e6f5b(0x29c)]()[_0x2e6f5b(0x2fa)](_0x3358b3)){_0x2f22bd=!0x1;break;}_0x2f22bd&&_0x52f1cb[_0x2e6f5b(0x26e)](_0x3358b3);const _0x4c2656=_0x361b97[_0x2e6f5b(0x338)](_0x2ecb26,_0x2bb7f8,_0x2675a1);return _0x361b97[_0x2e6f5b(0x288)]({'unitId':_0x2ecb26,'subUnitId':_0x2bb7f8,'token':_0x2675a1,'type':j[_0x2e6f5b(0x393)],'pivotConfig':_0x4c2656}),!0x0;}};function Ke(_0x9912e8,_0x2cf321){const _0x3b48e1=_0x58c229;switch(_0x2cf321){case m[_0x3b48e1(0x403)][_0x3b48e1(0x187)]:return _0x9912e8['valueFields'];case m['PivotTableFiledAreaEnum']['Filter']:return _0x9912e8[_0x3b48e1(0x287)];case m['PivotTableFiledAreaEnum'][_0x3b48e1(0x388)]:return _0x9912e8[_0x3b48e1(0x332)];case m[_0x3b48e1(0x403)][_0x3b48e1(0x2df)]:return _0x9912e8[_0x3b48e1(0x11e)];default:return[];}}function be(_0x5eaf10,_0x172a29){const _0x448720=_0x58c229;return _0x5eaf10['measure'][_0x172a29]||_0x5eaf10[_0x448720(0x347)][_0x172a29];}function Sn(_0x1d1149,_0x937a0b){const _0x7fa0a=_0x58c229,{area:_0x2133ad,fieldJson:_0x29430c,index:_0x4d8d1d}=_0x937a0b;_0x2133ad===m[_0x7fa0a(0x403)][_0x7fa0a(0x187)]?_0x1d1149[_0x7fa0a(0x1f3)][_0x29430c['id']]=_0x29430c:_0x1d1149[_0x7fa0a(0x347)][_0x29430c['id']]=_0x29430c,Ke(_0x1d1149,_0x2133ad)['splice'](_0x4d8d1d,0x0,_0x29430c['id']);}function Pn(_0x584b4e,_0x42f083){const _0x4a6333=_0x58c229,{area:_0x5436fb,fieldId:_0x427899,index:_0x96a034}=_0x42f083;_0x5436fb===m[_0x4a6333(0x403)]['Value']?delete _0x584b4e[_0x4a6333(0x1f3)][_0x427899]:delete _0x584b4e['dimension'][_0x427899],Ke(_0x584b4e,_0x5436fb)[_0x4a6333(0x149)](_0x96a034,0x1);}function bn(_0x384136,_0x21a7cf){const {fieldId:_0x34a5e9,name:_0x36ddff}=_0x21a7cf,_0x18a559=be(_0x384136,_0x34a5e9);_0x18a559&&(_0x18a559['displayName']=_0x36ddff);}function Tn(_0x5c2488,_0x5328f4){const _0x5afce8=_0x58c229,{fieldId:_0x2414a6,collapse:_0x3c86b0,item:_0x14f0f7}=_0x5328f4;_0x14f0f7!==void 0x0?(_0x5c2488[_0x5afce8(0x3bf)][_0x2414a6]=_0x5c2488['collapseInfo'][_0x2414a6]||{},_0x5c2488[_0x5afce8(0x3bf)][_0x2414a6][_0x14f0f7]=_0x3c86b0):_0x5c2488[_0x5afce8(0x3bf)][_0x2414a6]=_0x3c86b0;}function yn(_0x432900,_0x48c1c8){const {fieldId:_0x3c62a9,format:_0x12fb4b}=_0x48c1c8,_0x5bc2c2=be(_0x432900,_0x3c62a9);_0x5bc2c2&&(_0x5bc2c2['format']=_0x12fb4b);}function Mn(_0x596fdd,_0x3b669e){const _0x59d002=_0x58c229,{fieldId:_0x40107c,filterInfo:_0x50b840}=_0x3b669e,_0x398f06=be(_0x596fdd,_0x40107c);_0x398f06&&(_0x398f06[_0x59d002(0x3fe)]=_0x50b840);}function Fn(_0x2453e6,_0x4dbe58){const _0x31e9bd=_0x58c229,{fieldId:_0x218723,filterInfo:_0x1306ac}=_0x4dbe58,_0x4feef2=_0x2453e6['valueFilter'][_0x31e9bd(0x1d0)](_0x281c80=>_0x281c80[_0x31e9bd(0x2ac)]!==_0x218723);_0x1306ac&&_0x4feef2[_0x31e9bd(0x2c5)]({'fieldId':_0x218723,'filterInfo':_0x1306ac}),_0x2453e6[_0x31e9bd(0x2bd)]=_0x4feef2;}function Rn(_0x2c83f7,_0x17f0ba){const _0x3747db=_0x58c229,{fieldId:_0x547acc,subtotalType:_0x5eb7dc}=_0x17f0ba,_0x3076b6=be(_0x2c83f7,_0x547acc);_0x3076b6&&(_0x3076b6[_0x3747db(0x145)]=_0x5eb7dc);}function wn(_0x2cb07e,_0x12b7c9){const _0x366d79=_0x58c229,{fieldId:_0x537bc5,oldArea:_0x7fc531,area:_0x41a544,oldIndex:_0x1dc0c9,index:_0x4d5229}=_0x12b7c9,_0x4d95ba=_0x7fc531!==m[_0x366d79(0x403)][_0x366d79(0x187)]&&_0x41a544===m['PivotTableFiledAreaEnum'][_0x366d79(0x187)],_0x502324=_0x7fc531===m['PivotTableFiledAreaEnum'][_0x366d79(0x187)]&&_0x41a544!==m[_0x366d79(0x403)]['Value'];if(_0x4d95ba||_0x502324){const _0x2f5a8d=be(_0x2cb07e,_0x537bc5);_0x2f5a8d&&(_0x4d95ba?(delete _0x2cb07e[_0x366d79(0x347)][_0x537bc5],_0x2cb07e[_0x366d79(0x1f3)][_0x537bc5]=_0x2f5a8d):(delete _0x2cb07e[_0x366d79(0x1f3)][_0x537bc5],_0x2cb07e[_0x366d79(0x347)][_0x537bc5]=_0x2f5a8d));}const _0x2d8097=Ke(_0x2cb07e,_0x7fc531),_0x692510=Ke(_0x2cb07e,_0x41a544);_0x2d8097[_0x366d79(0x149)](_0x1dc0c9,0x1),_0x692510[_0x366d79(0x149)](_0x4d5229,0x0,_0x537bc5);}function _n(_0x8481e0,_0x39e09d){const _0x1226e2=_0x58c229,{valuePosition:_0x3c9ab7,index:_0x635259}=_0x39e09d;_0x8481e0[_0x1226e2(0x3a3)]=_0x3c9ab7,_0x8481e0[_0x1226e2(0x1a7)]=_0x635259;}function Dn(_0x3aeb87,_0x4442b5){const _0x557e4e=_0x58c229,{tableFieldId:_0xced2,sourceName:_0xbfa466,dataFieldId:_0x21dffb}=_0x4442b5,_0x5e5445=be(_0x3aeb87,_0xced2);_0x5e5445&&(_0x5e5445[_0x557e4e(0x1e1)]=_0xbfa466,_0x5e5445[_0x557e4e(0x40e)]=_0x21dffb);}function _0x52e6(){const _0x8648e7=['getId','ResetPivotFieldsConfigCommand','getRefRangeMutationsByMoveRange','valueFilter','pushUndoRedo','getGroupFieldsInfoByIds','sheet.command.set-pivot-collapse','AddPivotTableWithConfigCommand','#FFFFFF','_createExclusiveRange','movePivotField','push','getTypeOfUnitDisposed$','IExclusiveRangeService','registerSyncingMutations','Subject','getSheetFeatureLimit','UNIVER_SHEET','getUnit','asObservable','sheets-pivot.value','STRING','isBottomTotal','INTERCEPTOR_POINT','getFilterInfo','getMatrixFromRunTimeData','unionPivotViewRange','3060554tYjkLW','substring','DEFAULT_WORKSHEET_ROW_COUNT','getValue','initDataRanges','generateHexNumber','collectionConfig','SetOptions','colCount','#eceeff','Column','DataSyncPrimaryController','MIN_SAFE_INTEGER','getTargetByPivotTableId','isFeatureAuthorizedWithinTime','sheets-pivot.dateGroup.hour','viewData$','sheet.mutation.update-pivot-table-source-range','getCurrentSelections','MovePivotFieldCommand','updateFieldSourceInfo','sheet.mutation.pivot-update-field-source-info','registerCallbackWithEvent','sheet.command.move-pivot-table','onStarting','fetchThroughAsyncInterceptors','getEmptyPivotRanges','SheetInterceptorService','subUnitId','slice','_sheetsPivotTableService','getLastCol','setFieldFormat','SetFilterInfo','setPivotTableConfig','LocaleService','_localeService','includes','Max\x20of\x20','COMMAND','sheet.mutation.set-pivot-field-subtotal-type','removePivotTable','Grand\x20Total','IResourceManagerService','isEmpty','sheet.mutation.set-pivot-format','queryDirtyPivotTable','getDataFieldByDataFieldId','from','dataFieldManagerConfig','fields','find','getDisplayName','dateType','RemoveField','FORCE_STRING','removeValueFilterInfo','sheets-pivot.emptyPivot.row','MoveRangeCommand','getFieldFormat','versions','getFormat','pivotTableIndexConfig','setSourceName','getColumnCount','needSameDeleteModel','createValueField','_textInfo','Expand','_globalComputedStartHelpFunc','_viewUpdate$','tuple','generateRandomId','defaultThemeStyle','#1d32e9','varp','_deleteModelCache','dataStyle','setName','sheet.command.set-pivot-fields-config','addCollectionByJSON','registerDirtyService','getPivotTableCellData','getFieldListByArea','_globalSubject','renameField','SetValuePivotFilter','asyncInterceptor','UpdateFieldPosition','bind','removeCollections','SheetsPivotTableAdaptorModel','getViewData','rowFields','setDirty','_initPivotTextInfo','addFieldWithSourceId','PositionType','1258854BweRfb','getPivotTableConfig','Total','refreshDataField','sheet.mutation.set-pivot-collapse','UpdateSource','dispose','Minute','sheet.mutation.pivot-update-field-position','setConfig','ICommandService','ObjectMatrix','isErrorValue','getPivotItemRenderInfoCache','_refRangeService','_dataFieldManagerCollection','dimension','sheet.command.update-pivot-table-source-range','node','sheets.tabs.sheet','#e6ebfb','getAutoDisplayNameFunction','getDataFieldManager','sheets-pivot.cellDateGroupDisplay.yearQuarter','setDataRecordCount','drillDown','Disposable','getRangeStartEndInfo','isValue','updateAllDisplayName','viewUpdate$','getFieldById','numberToABC','SetPivotSetting','charCodeAt','_configService','_collectionChange$','fieldsConfig','RemoveSheetCommand','setDateType','SetPivotCollapseCommand','getPivotTableRangeInfo','rangeKeyMap','CustomCommandExecutionError','AddPivotField','oldRangeInfo','_featureCalculationManagerService','PivotDrillDownCommand','FieldsCollection','sheets-pivot.cellDateGroupDisplay.hour','sheet.command.move-pivot-field','454388tyndrl','sideEffectUpdateWorkerCache','setLabelFilterInfo','PivotDisplayDataType','Year','getSheetBySheetName','SetWorksheetActiveOperation','leftOffset','_sheetsPivotTableConfigModel','addPivotTable','count','Style','sheet.command.set-pivot-field-setting','custom','width','onQueryEnd','startCollectChangeset','_commandService','prefix','RemoveSheetsFilterMutation','YearMonthDate','sheets-pivot.dateGroup.hourMinute','sheet.mutation.send-pivot-data-local','Existing','sheets-pivot.dateGroup.quarter','PivotMultipleValueId','sheet.command.update-date-group','getUnitId','getValueIndex','stringify','Row','_initConfig','_init','getPivotTableModelConfig','ResetPivotTable','number','SetWorksheetColWidthMutation','has','Subtotal','_collectionConfigModel','Module','Set','rowCount','SetPivotFilter','InsertRowMutation','_initCommandInterceptListener','REF','InsertSheetMutation','blank','getFieldPositionInfoById','SetPivotPositionMutation','sheets-pivot.cellDateGroupDisplay.hourMinute','LifecycleService','sheets-pivot.dateGroup.minute','291404xxFKsE','AddPivotTableMutation','IUndoRedoService','valuePosition','sheet.mutation.add-pivot-table','transFromCellValue','RenameField','notExecuteFormula','getSheetBySheetId','refreshData','executeCommand','merge','iterateFieldDim','min','addRecord','sheets-pivot.dateGroup.date','Optional','sortInfo','random','_sheetsPivotDataSourceModel','CommandType','UpdateFieldPositionMutation','setValuePivotFilter','Panel','sheet.command.update-pivot-value-position','AddPivotTable','sheets-pivot.config','concat','reset','var','_ensurePivotTableMatrixInfo','collapseInfo','Filter','updateCollectionConfig','updateRenderCache','setPivotSetting','StdDev\x20of\x20','info','_getAutoName','_updatePivotTableInstanceCache','isColMultiMeasure','YearQuarter','length','max','options','SetPivotValueFilterCommand','setPivotInitCompleted','Column\x20','Min\x20of\x20','SetSheetsFilterRangeMutation','ErrorType','rangesInfo','MoveRangeMutation','removeField','unshift','_queryingMap','MovePivotField','createAsyncInterceptorKey','foreach','pbt','FontCache','originTargetInfo','None','UpdatePivotTableSourceRangeCommand','call','addField','forRow','sheets-pivot.subTotal','SetValueFilter','colHeaderMap','getFieldCountByArea','fetchThroughInterceptors','textInfo','PivotTable','sheets-pivot.varName','dateGroupField','_initLocale','RANGE_TYPE','Injector','getRowCount','next','getStyles','SetRangeValuesMutation','_sheetsSelectionsService','getDataFieldItemInfo','SetPivotOptionMutation','DIV_BY_ZERO','delete','_updateModelCache','sheets-pivot.cellDateGroupDisplay.month','removePivotField','sheet.command.remove-pivot-field','sheets-pivot.countNumsName','interceptor','filterInfo','sheets-pivot.blank','sheet.command.set-pivot-filter','sheets-pivot.dateGroup.yearMonth','sheet.command.add-pivot-table-with-config','PivotTableFiledAreaEnum','InterceptorEffectEnum','interceptCommand','refreshGroupField','forValue','getMatrix','sheet.command.set-pivot-sort','removeDataField','limit\x20pivot','pivotTableId','sheet.mutation.set-pivot-value-filter','dataFieldId','generateNullCell','_ensurePivotItemRenderValueMatrixCache','NO_COMMERCIAL','SetPivotFieldFormatMutation','\x20-\x20','Delete','getAdjustRangesPosition','SheetsPivotTableConfigModel','_pivotRenderValueMatrixCache','collectionChange$','sheets-pivot.cellDateGroupDisplay.quarter','uniqueDataFieldName','getSheetCommandTarget','LS_CONFIG_KEY','generateMutationsByRanges','getSourceName','pivotMutationGenerate','PivotFilterTypeEnum','7042792shdbVr','intersects','_requestResolvers','SetFieldFormat','NUMBER','getDataFieldByRangeKey','generateNewSheetName','grandTotal','areaInfo','handleAsyncResponse','SetRangeValuesUndoMutationFactory','pivotTableConfigs','colRanges','registerRefRange','isBaseGroupField','UpdatePivotFieldSourceInfoMutation','columnFields','PivotTableOperationEnum','object','realDeleteValue','AddPivotTableCommand','_model','forEach','_ensurePivotItemRenderInfoCache','fieldIds','Collapse','toJSON','defineProperty','level','_viewData$','getInterceptPoints','endRow','Values','sheets-pivot.dateGroup.month','getOriginFieldId','_configVersion$','SetCollapse','SetSortInfo','onQueryStart','getSubUnitPivotConfigs','pivotInitCompleted$','YearMonth','_initUnitDisposed','dataRangeInfo','range','setRangeKeyMap','DEFAULT_PIVOT_NUMBER','sequenceExecute','getSheetId','lastCol','register','sourceRangeInfo','updatePivotTableMatrixInfo','_onRefRangeChange','sheets-pivot.cellDateGroupDisplay.yearMonthDate','subtotal','PivotTableValuePositionEnum','setPivotCollapse','getAutoFitColumnsMutations','splice','getFieldInfo','stdDev','map','_pivotTableRangeInfo','updateDataFieldsCollection','getIntersectsPivotTable','setValueFilterInfo','_ensureViewDataMap','workbook\x20is\x20not\x20found','getFilterFieldIdByIndex','triggerDirtyFeature','SetPivotSubtotalTypeMutation','setPivotSort','_config','sheet.command.add-pivot-table','error','SHEETS_PIVOT_PLUGIN_CONFIG_KEY','get','getTextInfo','cellToRange','sheets-pivot.maxName','entries','some','batch','Var\x20of\x20','setPivotFilter','isArray','StdDevp\x20of\x20','_host','getSheets','removeValueFilterInfoByValueFieldId','sheets-pivot.varpName','BehaviorSubject','UpdateValuePositionMutation','getIndexesByPathStr','RefRangeService','removeSourceRangeChange','GrandTotal','createLabelField','getValuePosition','Month','getName','column','createDataFieldId','PivotTableChangeTypeEnum','_activeDirtyManagerService','col','getformat','disposeWithMe','_initRegisterCommand','update','handleSourceRangeChange','remove','getConfig','Quarter','addPivotTableWithConfig','(Blank)','addCollection','_viewData','IUniverInstanceService','RemovePivotTableMutation','Value','fontRenderExtension','other','markDirty$','targetCellInfo','iterateFieldByArea','undos','InterceptorManager','filterId','getPivotInfoByLicense','fieldsCollectionChange$','params','value','format','sheet.mutation.add-group-collection','setRange','ReleaseType','Inject','values','_dataSyncPrimaryController','setCollapse','RemoveSheetMutation','product','getSubtotal','getColumnWidth','PivotView','UniverLicensePlugin','GlobalConfig','ClearSelectionAllCommand','subTotalStyle','getPivotTableInstance','_pivotRenderInfoCache','valueIndex','SetPivotFieldsConfigCommand','registerCommand','_fieldsCollectionChange$','IConfigService','getHeaderMapItem','PivotSubtotalTypeEnum','SetPivotCollapseMutation','Add','endCollectChangeset','ManualFilter','existing','startColumn','_sheetsPivotTableAdaptorModel','_initSnapshot','sheets-pivot.emptyPivot.filter','DrillDown','getCellRaw','disposableCollection','countNums','data','getDataFieldId','name','prototype','AddPivotTableWithConfig','pluginName','return\x20','getUpdateRangeDeleteIds','subscribe','setOptions','createCollectionWithDataRange','hasOwnProperty','updateValuePosition','dataFieldsCollection','updatePivotSource','unshiftString','_refRangeHandle','_initClearSelectionCommandInterceptor','updateView','SheetsPivotTableService','cornerInfo','filter','getMonth','sum','getRangeKey','row','sheet.mutation.set-pivot-position','isDateGroupField','setPivotTable','updateRangeKeyMap','colStyle','New','set','UpdateValuePosition','getTargetByPivotId','Hour','type','PivotCallbackEnum','sourceName','symbol','UpdatePivotSource','_lifecycleService','getAutoDisplayName','getTextSize','sheet.mutation.send-pivot-view-local','sheet.operation.pivot-table-view-formula-mark-dirty','RenamePivotFieldMutation','endColumn','paths','sheets-pivot.productName','resetPivotTable','getMatrixValue','PivotDateGroupFieldDateTypeEnum','sheet.mutation.get-pivot-data-local','DataFieldManager','pivotPerformCheck','measure','_pivotTableMatrixInfo','COLUMN','sheet.mutation.set-pivot-filter','document','_pivotConfigChange$','getPivotTableInfo','redos','Product\x20of\x20','displayName','startRow','getNoUsedDataFieldIds','PivotDataFieldDataTypeEnum','registerPluginResource','getPivotDirtyViewInfo','updateConfig','isText','unitId','SetPivotTableConfig','RemovePivotField','getCurrentUnitForType','hasField','MUTATION','generateSetRangeValueMutations','originalFieldId','_injector','removeCollectionImp','mergeWorksheetSnapshotWithDefault','sheets-pivot.sumName','#f4f4f5','_toJSON','getDate','_globalComputedEndHelpFunc','updateFieldPosition','getColCount','token','lastRow','clearRenderCache','RemovePivotFieldCommand','sheet.mutation.remove-pivot-field','#e6ebfa','AddPivotFieldCommand','numfmt','_globalComputingSrv','getOwnPropertyDescriptor','_initGlobalComputed','DisposableCollection','pageStyle','9xWtDdz','version','sheet.command.add-pivot-field','intercept','panel','_generateUniqueVersion','IActiveDirtyManagerService','_resourceManagerService','NotFunction','_pivotInitCompleted$','setSubtotalType','_markDirty$','Rectangle','setRangeValueRedoMutation','matrix','UniverInstanceType','getDirtyInfo','getPivotDisplayConfig','sheets-pivot.cellDateGroupDisplay.minute','updatePivotTableRangeInfo','rangeType','sheets-pivot.dateGroup.yearMonthDate','_sheetInterceptorService','UniverSheetsPivotTablePlugin','Count\x20of\x20','setDisplayName','getPivotPerformCheck','_initDataSendListener','rgb(255,255,255)','minDate','sheets-pivot.emptyPivot.column','excelDateToUnixMilliseconds','adjustSheetCellData','350265ALivCn','_univerInstanceService','sheet.mutation.send-init-pivot-text-local','setSortInfo','updateViewData','pivotConfigChange$','getActiveSheet','getRangeKeyList','rowRanges','SheetsSelectionsService','setTextInfo','canUsePivot','SetPivotSort','_getPivotAppliedRanges','Range','updateConfigCache','sheet.command.reset-pivot-fields-config','collections','NORMAL','createInterceptorKey','setValue','addPivotField','PivotTableViewDirtyMarkOperation','split','sheetName','formJSON','query','_initPivotDataGetListener','addDataFieldWithoutUnitInfo','_initRemoveSheetCommandInterceptor','leafStyle','_exclusiveRangeService','deleteUnitId','dataFields','getSubUnitPivotRenderCache','onCommandExecuted','string','sheets-pivot.cellDateGroupDisplay.yearMonth','ClearSelectionContentCommand','PivotCellStyleTypeEnum','DateGroupField','getSortInfo','deleteDataField','deleteField','pushComputingStatusSubject','Tools','_subjectCollectionChange','contains','floor','rowHeaderMap','MovePivotTableCommand','isDateValue','sheets-pivot.stdDevName','SetPivotSortCommand','getFieldDataType','DataField','getLastRow','InsertSheetUndoMutationFactory','SetPivotCollapse','updateDirtyPivotTable','getCellMatrix','result','getPivotTableIdByCell','_ensurePivotTableRangeInfo','keys','Date','sheets-pivot.other','filterFields','addDirtyPivotTable','add','resetArea','12iFUpdi\x20aRFfQ4Updi(xpFRi7R,\x20428xpFHRQ)\x20{\x20\x20\x20\x20UfQ\x20{\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20xpFRi7Rri1dk5fUSff5Q\x20=\x20xpFRi7R.74xpU(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20dfphpiIR775hR\x20=\x203NJT.45f7R(5Ud8(xpFRi7Rri1dk5fUSff5Q[Y]));\x20\x20\x20\x20\x20\x20\x20\x20p1\x20(!dfphpiIR775hR.2a)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20dfphpiIR775hR.2a\x20=\x20T2B8Rf(xpFRi7Rri1dk5fUSff5Q[M]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20p7KdflRf\x20=\x20UQ4Rd1\x20KdflRf0xd85xNFd4R\x20!==\x20\x272iaR1piRa\x27\x20&&\x207Rx1\x20pi7U5iFRd1\x20KdflRf0xd85xNFd4R;\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20p7qfdj7Rf\x20=\x20UQ4Rd1\x20jpiadj\x20!==\x20\x272iaR1piRa\x27\x20&&\x20UQ4Rd1\x20jpiadj.xdF5Updi\x20!==\x20\x272iaR1piRa\x27;\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20FdiURVU\x20=\x20p7KdflRf\x20?\x207Rx1\x20:\x20(p7qfdj7Rf\x20?\x20jpiadj\x20:\x20hxd85x9Dp7);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20BR775hRKdfa\x20=\x20FdiURVU.__q57RsM__.45f7R(xpFRi7Rri1dk5fUSff5Q[Y]);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20BR775hR\x20=\x20FdiURVU.__ARV__.7Ufpihp1Q(BR775hRKdfa);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x207phi5U2fRKdfa\x20=\x20FdiURVU.__q57RsM__.45f7R(xpFRi7Rri1dk5fUSff5Q[L]);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x207phi5U2fR\x20=\x20FdiURVU.__ARV__.7Ufpihp1Q(7phi5U2fRKdfa);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x207phiW5xpa\x20=\x20FdiURVU.__yRfp1Q__(7phi5U2fR,\x20BR775hR,\x20428xpFHRQ);\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20adB5pi\x20=\x20dfphpiIR775hR.aB;\x20\x20\x20\x20\x20\x20\x20\x2012iFUpdi\x20p7GdB5piI5UFDpih(dk5UURfi,\x20dAd7U)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x2045UURfi\x20=\x20dk5UURfi.fR4x5FR(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20Dd7U\x20=\x20dAd7U.fR4x5FR(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x2045UURfik5fU7\x20=\x2045UURfi.74xpU(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20Dd7Uk5fU7\x20=\x20Dd7U.74xpU(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p1\x20(!45UURfi.piFx2aR7(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20fRU2fi\x2045UURfi\x20===\x20Dd7U;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p1\x20(45UURfik5fU7.xRihUD\x20<\x20Y\x20||\x2045UURfik5fU7[o]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20fRU2fi\x2015x7R;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x2045UURfiN211pV\x20=\x2045UURfik5fU7.7xpFR(v).ndpi(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20Dd7UN211pV\x20=\x20Dd7Uk5fU7.7xpFR(-45UURfik5fU7.xRihUD\x20+\x20v).ndpi(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20fRU2fi\x2045UURfiN211pV\x20===\x20Dd7UN211pV;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20xRU\x20adB5piW5xpa\x20=\x2015x7R;\x20\x20\x20\x20\x20\x20\x20\x20p1\x20(p7qfdj7Rf)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20adB5piW5xpa\x20=\x20(adB5pi\x20&&\x20adB5pi.xRihUD)\x20?\x20adB5pi.7dBR((aBrURB)\x20=>\x20p7GdB5piI5UFDpih(aBrURB,\x20xdF5Updi.Dd7Ui5BR))\x20:\x20Uf2R;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p1\x20(xdF5Updi.Dd7Ui5BR\x20===\x20\x27xdF5xDd7U\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20adB5piW5xpa\x20=\x20Uf2R;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20}\x20Rx7R\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20adB5piW5xpa\x20=\x20Uf2R;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20Fdi7U\x20y5xpa\x20=\x207phiW5xpa\x20&&\x20adB5piW5xpa;\x20\x20\x20\x20\x20\x20\x20\x20fRU2fi\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20y5xpa,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20BR775hR:\x20dfphpiIR775hR,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20F5UFD\x20(Rffdf)\x20{\x20\x20\x20\x20\x20\x20\x20\x20fRU2fi\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20y5xpa:\x2015x7R,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20BR775hR:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','single','sheets-pivot.grandTotal','broadcastCollectionChange','sheet.command.pivot-drill-down','size','_updateRenderEmptyCache','Sum\x20of\x20','rangeKey','_ensurePivotMap','updateViewInfo','MonthDate','SheetsPivotDataSourceModel','#b2b2b2','InsertSheetCommand','sheet.mutation.add-pivot-field','getSubUnitPivotMatrix','getFieldIds','sheet.mutation.update-date-group','getFullYear','sheet.mutation.rename-pivot-field','getInsertRowColMutations','Varp\x20of\x20','headerMap','addExclusiveRange','SheetsPivotRPCService','replace','UpdateDateGroupCommand','sheet.mutation.send-pivot-config-local','CellValueType','_pivotTableInstanceCache','sheets-pivot.averageName','iterateField','fieldId','handleMoveRange','PivotErrorTypeEnum','getCollection','SHEET_PIVOT_EXCLUSIVE_ID','getDataFieldByTableId','fromJSON','RemovePivotFieldMutation','BLANK_PLACEHOLDER','sheets-pivot.stdDevpName','parse','tableFieldId','getTableFieldById','741907WhcQZV'];_0x52e6=function(){return _0x8648e7;};return _0x52e6();}function Un(_0x3267f9,_0x4763a2){const _0x1b35c5=_0x58c229,{fieldId:_0x324092,sortInfo:_0x29f4ab}=_0x4763a2,_0x3e9a65=be(_0x3267f9,_0x324092);_0x3e9a65&&(_0x3e9a65[_0x1b35c5(0x3b1)]=_0x29f4ab);}function En(_0x501f3a,_0x542a78){const _0x11a1bb=_0x58c229,{options:_0x1c8ef9}=_0x542a78;_0x501f3a[_0x11a1bb(0x3cc)]={..._0x501f3a[_0x11a1bb(0x3cc)],..._0x1c8ef9};}const it={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x29a),'handler'(_0x46d39c,_0x79cedb){const _0x266c6c=_0x58c229;if(!_0x79cedb)return!0x1;if(!!_0x46d39c[_0x266c6c(0x15b)](v['IConfigService'])[_0x266c6c(0x17f)](q))return!0x0;const _0x9a16fd=_0x46d39c['get'](exports[_0x266c6c(0x297)]),{pivotTableId:_0x1ac31f,fieldJson:_0x26eea1,area:_0xb161e3,index:_0x69e583,unitId:_0x10095b,subUnitId:_0x11d32a}=_0x79cedb,_0x176fad=_0x9a16fd[_0x266c6c(0x1a5)](_0x1ac31f);if(!_0x176fad)return!0x1;let _0x39b7d4;_0xb161e3===m[_0x266c6c(0x403)][_0x266c6c(0x187)]?_0x39b7d4=m[_0x266c6c(0x317)](_0x26eea1):_0x39b7d4=m[_0x266c6c(0x170)](_0x26eea1),_0x176fad[_0x266c6c(0x3e1)](_0x39b7d4,_0xb161e3,_0x69e583);const _0x430cf3=_0x9a16fd[_0x266c6c(0x38b)](_0x10095b,_0x11d32a,_0x1ac31f);Sn(_0x430cf3,_0x79cedb);const _0x35049a=_0x9a16fd['getPivotTableConfig'](_0x10095b,_0x11d32a,_0x1ac31f);return _0x9a16fd[_0x266c6c(0x288)]({'unitId':_0x10095b,'subUnitId':_0x11d32a,'token':_0x1ac31f,'type':j[_0x266c6c(0x393)],'pivotConfig':_0x35049a}),!0x0;}},at={'type':v[_0x58c229(0x3b4)]['MUTATION'],'id':_0x58c229(0x21a),'handler'(_0x50fd07,_0x2b59dd){const _0x3b7ae6=_0x58c229;if(!_0x2b59dd)return!0x1;if(!!_0x50fd07[_0x3b7ae6(0x15b)](v[_0x3b7ae6(0x1ab)])[_0x3b7ae6(0x17f)](q))return!0x0;const _0x2ab0a9=_0x50fd07[_0x3b7ae6(0x15b)](exports[_0x3b7ae6(0x297)]),{pivotTableId:_0x25ea55,fieldId:_0xe7b2d2,unitId:_0x44d84b,subUnitId:_0x350ffa}=_0x2b59dd,_0x2717a9=_0x2ab0a9['getPivotTableInstance'](_0x25ea55);if(!_0x2717a9)return!0x1;_0x2717a9['removeField'](_0xe7b2d2);const _0x44b7ee=_0x2ab0a9[_0x3b7ae6(0x38b)](_0x44d84b,_0x350ffa,_0x25ea55);Pn(_0x44b7ee,_0x2b59dd);const _0x10f3d7=_0x2ab0a9[_0x3b7ae6(0x338)](_0x44d84b,_0x350ffa,_0x25ea55);return _0x2ab0a9[_0x3b7ae6(0x288)]({'unitId':_0x44d84b,'subUnitId':_0x350ffa,'token':_0x25ea55,'type':j['Set'],'pivotConfig':_0x10f3d7}),!0x0;}},st={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x29f),'handler'(_0x5756ee,_0x2c3f91){const _0x4c8416=_0x58c229;if(!_0x2c3f91)return!0x1;if(!!_0x5756ee[_0x4c8416(0x15b)](v['IConfigService'])[_0x4c8416(0x17f)](q))return!0x0;const _0x2e7587=_0x5756ee[_0x4c8416(0x15b)](exports[_0x4c8416(0x297)]),{unitId:_0x5cb4d6,subUnitId:_0x596e1f,pivotTableId:_0x112e1f,fieldId:_0x326d7a,name:_0xea5a}=_0x2c3f91,_0x41cbdd=_0x2e7587[_0x4c8416(0x1a5)](_0x112e1f);if(!_0x41cbdd)return!0x1;_0x41cbdd['renameField'](_0x326d7a,_0xea5a);const _0x7f670=_0x2e7587['getPivotTableModelConfig'](_0x5cb4d6,_0x596e1f,_0x112e1f);return bn(_0x7f670,_0x2c3f91),_0x2e7587['addDirtyPivotTable']({'unitId':_0x5cb4d6,'subUnitId':_0x596e1f,'token':_0x112e1f,'type':j['Set']}),!0x0;}},rt={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x33b),'handler'(_0x23aef0,_0x2a73e6){const _0x4422ae=_0x58c229;if(!_0x2a73e6)return!0x1;if(!!_0x23aef0[_0x4422ae(0x15b)](v[_0x4422ae(0x1ab)])[_0x4422ae(0x17f)](q))return!0x0;const _0x1b7e08=_0x23aef0[_0x4422ae(0x15b)](exports[_0x4422ae(0x297)]),{unitId:_0x216e74,subUnitId:_0x3dd49d,pivotTableId:_0x2c7927,fieldId:_0xd68505,collapse:_0x38da78,item:_0x43d813}=_0x2a73e6,_0x4e6ac5=_0x1b7e08[_0x4422ae(0x1a5)](_0x2c7927);if(!_0x4e6ac5)return!0x1;_0x4e6ac5[_0x4422ae(0x19b)](_0xd68505,_0x38da78,_0x43d813);const _0x4cacde=_0x1b7e08[_0x4422ae(0x38b)](_0x216e74,_0x3dd49d,_0x2c7927);return Tn(_0x4cacde,_0x2a73e6),_0x1b7e08[_0x4422ae(0x288)]({'unitId':_0x216e74,'subUnitId':_0x3dd49d,'token':_0x2c7927,'type':j[_0x4422ae(0x393)]}),!0x0;}},lt={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x302),'handler'(_0xd7e343,_0x204b4a){const _0x2176f5=_0x58c229;if(!_0x204b4a)return!0x1;if(!!_0xd7e343[_0x2176f5(0x15b)](v[_0x2176f5(0x1ab)])['getConfig'](q))return!0x0;const _0x1e66df=_0xd7e343[_0x2176f5(0x15b)](exports['SheetsPivotDataSourceModel']),{unitId:_0x300639,subUnitId:_0x4cea50,pivotTableId:_0x211c60,fieldId:_0x6a8c53,format:_0x592d46}=_0x204b4a,_0x26e0d1=_0x1e66df[_0x2176f5(0x1a5)](_0x211c60);if(!_0x26e0d1)return!0x1;_0x26e0d1[_0x2176f5(0x2f5)](_0x6a8c53,_0x592d46);const _0x3d68d6=_0x1e66df[_0x2176f5(0x38b)](_0x300639,_0x4cea50,_0x211c60);return yn(_0x3d68d6,_0x204b4a),_0x1e66df[_0x2176f5(0x288)]({'unitId':_0x300639,'subUnitId':_0x4cea50,'token':_0x211c60,'type':j['Set']}),!0x0;}},dt={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x1f6),'handler'(_0x2fd35b,_0x2d34fd){const _0x44381c=_0x58c229;if(!_0x2d34fd)return!0x1;if(!!_0x2fd35b[_0x44381c(0x15b)](v[_0x44381c(0x1ab)])['getConfig'](q))return!0x0;const _0x59c53c=_0x2fd35b[_0x44381c(0x15b)](exports[_0x44381c(0x297)]),{unitId:_0x5b9aac,subUnitId:_0x23defc,pivotTableId:_0x1c33f4,fieldId:_0x23d2f4,filterInfo:_0x30a673}=_0x2d34fd,_0x430e17=_0x59c53c[_0x44381c(0x1a5)](_0x1c33f4);if(!_0x430e17)return!0x1;_0x430e17[_0x44381c(0x36c)](_0x23d2f4,_0x30a673);const _0x24407b=_0x59c53c[_0x44381c(0x38b)](_0x5b9aac,_0x23defc,_0x1c33f4);return Mn(_0x24407b,_0x2d34fd),_0x59c53c[_0x44381c(0x288)]({'unitId':_0x5b9aac,'subUnitId':_0x23defc,'token':_0x1c33f4,'type':j[_0x44381c(0x393)]}),!0x0;}},ct={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':'sheet.mutation.set-pivot-option','handler'(_0x23a1cf,_0x52bf81){const _0x51d610=_0x58c229;if(!_0x52bf81)return!0x1;if(!!_0x23a1cf[_0x51d610(0x15b)](v[_0x51d610(0x1ab)])[_0x51d610(0x17f)](q))return!0x0;const _0x2e142d=_0x23a1cf['get'](exports[_0x51d610(0x297)]),{unitId:_0x19f36e,subUnitId:_0x4dc458,pivotTableId:_0x5cdd26,options:_0x2bff87}=_0x52bf81,_0x343e1e=_0x2e142d[_0x51d610(0x1a5)](_0x5cdd26);if(!_0x343e1e)return!0x1;_0x343e1e[_0x51d610(0x1c4)](_0x2bff87);const _0x4b06bd=_0x2e142d[_0x51d610(0x38b)](_0x19f36e,_0x4dc458,_0x5cdd26);return En(_0x4b06bd,_0x52bf81),_0x2e142d['addDirtyPivotTable']({'unitId':_0x19f36e,'subUnitId':_0x4dc458,'token':_0x5cdd26,'type':j[_0x51d610(0x393)]}),!0x0;}},ut={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':'sheet.mutation.set-pivot-sort-info','handler'(_0x35602f,_0x56aeb0){const _0x2ff36b=_0x58c229;if(!_0x56aeb0)return!0x1;if(!!_0x35602f[_0x2ff36b(0x15b)](v[_0x2ff36b(0x1ab)])['getConfig'](q))return!0x0;const _0x56dff2=_0x35602f[_0x2ff36b(0x15b)](exports[_0x2ff36b(0x297)]),{unitId:_0x1a3568,subUnitId:_0x141e2a,pivotTableId:_0x568aac,sortInfo:_0x610778,fieldId:_0xa634c8}=_0x56aeb0,_0x58a9f3=_0x56dff2[_0x2ff36b(0x1a5)](_0x568aac);if(!_0x58a9f3)return!0x1;_0x58a9f3[_0x2ff36b(0x247)](_0xa634c8,_0x610778);const _0x1bfa19=_0x56dff2[_0x2ff36b(0x38b)](_0x1a3568,_0x141e2a,_0x568aac);return Un(_0x1bfa19,_0x56aeb0),_0x56dff2[_0x2ff36b(0x288)]({'unitId':_0x1a3568,'subUnitId':_0x141e2a,'token':_0x568aac,'type':j[_0x2ff36b(0x393)]}),!0x0;}},ft={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x2fd),'handler'(_0x20bf2c,_0x265e2f){const _0x1a8f9c=_0x58c229;if(!_0x265e2f)return!0x1;if(!!_0x20bf2c['get'](v[_0x1a8f9c(0x1ab)])[_0x1a8f9c(0x17f)](q))return!0x0;const _0x495828=_0x20bf2c['get'](exports['SheetsPivotDataSourceModel']),{unitId:_0x64a053,subUnitId:_0x104913,pivotTableId:_0x4386c2,fieldId:_0x528430,subtotalType:_0x1f56b4}=_0x265e2f,_0x193689=_0x495828[_0x1a8f9c(0x1a5)](_0x4386c2);if(!_0x193689)return!0x1;_0x193689[_0x1a8f9c(0x22d)](_0x528430,_0x1f56b4);const _0x7a7868=_0x495828[_0x1a8f9c(0x38b)](_0x64a053,_0x104913,_0x4386c2);return Rn(_0x7a7868,_0x265e2f),_0x495828[_0x1a8f9c(0x288)]({'unitId':_0x64a053,'subUnitId':_0x104913,'token':_0x4386c2,'type':j['Set']}),!0x0;}},vt={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x40d),'handler'(_0x12b1a8,_0x27aae8){const _0x2cc113=_0x58c229;if(!_0x27aae8)return!0x1;if(!!_0x12b1a8[_0x2cc113(0x15b)](v[_0x2cc113(0x1ab)])[_0x2cc113(0x17f)](q))return!0x0;const _0x1c39f8=_0x12b1a8[_0x2cc113(0x15b)](exports[_0x2cc113(0x297)]),{unitId:_0x165a43,subUnitId:_0x4c9ab7,pivotTableId:_0x236883,fieldId:_0x702b3b,filterInfo:_0x3a12f6}=_0x27aae8,_0x40705c=_0x1c39f8['getPivotTableInstance'](_0x236883);if(!_0x40705c)return!0x1;_0x40705c['setValueFilterInfo'](_0x702b3b,_0x3a12f6);const _0x2c11c6=_0x1c39f8[_0x2cc113(0x38b)](_0x165a43,_0x4c9ab7,_0x236883);return Fn(_0x2c11c6,_0x27aae8),_0x1c39f8[_0x2cc113(0x288)]({'unitId':_0x165a43,'subUnitId':_0x4c9ab7,'token':_0x236883,'type':j[_0x2cc113(0x393)]}),!0x0;}},gt={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x33f),'handler'(_0x4dd310,_0x55c0c4){const _0x255286=_0x58c229;if(!_0x55c0c4)return!0x1;if(!!_0x4dd310['get'](v[_0x255286(0x1ab)])[_0x255286(0x17f)](q))return!0x0;const _0x515384=_0x4dd310[_0x255286(0x15b)](exports[_0x255286(0x297)]),{unitId:_0x464ec9,subUnitId:_0x5bad71,pivotTableId:_0xe01c,area:_0x544717,index:_0x2ecf49,fieldId:_0x4a4c23}=_0x55c0c4,_0x469d97=_0x515384[_0x255286(0x1a5)](_0xe01c);if(!_0x469d97)return!0x1;_0x469d97[_0x255286(0x214)](_0x4a4c23,_0x544717,_0x2ecf49);const _0x523a0e=_0x515384[_0x255286(0x38b)](_0x464ec9,_0x5bad71,_0xe01c);return wn(_0x523a0e,_0x55c0c4),_0x515384[_0x255286(0x288)]({'unitId':_0x464ec9,'subUnitId':_0x5bad71,'token':_0xe01c,'type':j[_0x255286(0x393)]}),!0x0;}},ht={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x2ea),'handler'(_0x124e6c,_0x74c083){const _0x88d30a=_0x58c229;if(!_0x74c083)return!0x1;if(!!_0x124e6c[_0x88d30a(0x15b)](v[_0x88d30a(0x1ab)])[_0x88d30a(0x17f)](q))return!0x0;const _0x9f6ada=_0x124e6c[_0x88d30a(0x15b)](exports['SheetsPivotDataSourceModel']),{unitId:_0x269df0,subUnitId:_0x37e7cd,pivotTableId:_0xc0f69,sourceName:_0x140259,dataFieldId:_0xf48229,tableFieldId:_0x1da232}=_0x74c083,_0x5a8935=_0x9f6ada['getPivotTableInstance'](_0xc0f69);if(!_0x5a8935)return!0x1;_0x5a8935[_0x88d30a(0x2e9)](_0x1da232,_0x140259,_0xf48229);const _0x215eaf=_0x9f6ada['getPivotTableModelConfig'](_0x269df0,_0x37e7cd,_0xc0f69);return Dn(_0x215eaf,_0x74c083),_0x9f6ada['addDirtyPivotTable']({'unitId':_0x269df0,'subUnitId':_0x37e7cd,'token':_0xc0f69,'type':j['Set']}),!0x0;}},pt={'type':v['CommandType'][_0x58c229(0x209)],'id':'sheet.mutation.pivot-update-value-position','handler'(_0x9dd330,_0x30b4cd){const _0x1138cd=_0x58c229;if(!_0x30b4cd)return!0x1;if(!!_0x9dd330[_0x1138cd(0x15b)](v[_0x1138cd(0x1ab)])[_0x1138cd(0x17f)](q))return!0x0;const _0x1e6db1=_0x9dd330['get'](exports[_0x1138cd(0x297)]),{unitId:_0x28a3f9,subUnitId:_0x3120c6,pivotTableId:_0x581711,valuePosition:_0x54ef28,index:_0x3e01ef}=_0x30b4cd,_0x3073ba=_0x1e6db1[_0x1138cd(0x1a5)](_0x581711);if(!_0x3073ba)return!0x1;_0x3073ba['updateValuePosition'](_0x54ef28,_0x3e01ef);const _0x23f352=_0x1e6db1[_0x1138cd(0x38b)](_0x28a3f9,_0x3120c6,_0x581711);return _n(_0x23f352,_0x30b4cd),_0x1e6db1[_0x1138cd(0x288)]({'unitId':_0x28a3f9,'subUnitId':_0x3120c6,'token':_0x581711,'type':j[_0x1138cd(0x393)]}),!0x0;}};function ae(_0x19116c,_0x2884ab,_0x54e86a){const _0x38acad=_0x58c229,{pivotTableId:_0x25876a,unitId:_0xca3c09,subUnitId:_0x4ef242}=_0x2884ab,_0x4581e9=[],_0x3c7f65=[];for(const _0x3e86c9 of _0x54e86a)switch(_0x3e86c9[_0x38acad(0x1df)]){case m['PivotTableChangeTypeEnum']['AddField']:{const {fieldJson:_0x2503fb,area:_0x2fd595,index:_0x44d39e}=_0x3e86c9,_0x484f87={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldJson':_0x2503fb,'area':_0x2fd595,'index':_0x44d39e},_0x4a5eb1={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x2503fb['id'],'area':_0x2fd595,'index':_0x44d39e};_0x4581e9[_0x38acad(0x2c5)]({'id':it['id'],'params':_0x484f87}),_0x3c7f65['unshift']({'id':at['id'],'params':_0x4a5eb1});}break;case m[_0x38acad(0x176)]['SetSubtotalType']:{const {fieldId:_0x4f067b,newSubtotalType:_0x69b390,oldSubtotalType:_0x5931fc}=_0x3e86c9,_0x3880df={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x4f067b,'subtotalType':_0x69b390};_0x4581e9['push']({'id':ft['id'],'params':_0x3880df});const _0x4edcaf={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x4f067b,'subtotalType':_0x5931fc};_0x3c7f65['unshift']({'id':ft['id'],'params':_0x4edcaf});}break;case m['PivotTableChangeTypeEnum'][_0x38acad(0x30b)]:{const {fieldId:_0x3a69d1,fieldJson:_0x53b7db,area:_0x58fbba,index:_0x35ae6d}=_0x3e86c9,_0x44f196={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x3a69d1,'index':_0x35ae6d,'area':_0x58fbba};_0x4581e9[_0x38acad(0x2c5)]({'id':at['id'],'params':_0x44f196});const _0x35cef5={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldJson':_0x53b7db,'area':_0x58fbba,'index':_0x35ae6d};_0x3c7f65[_0x38acad(0x3d6)]({'id':it['id'],'params':_0x35cef5});}break;case m['PivotTableChangeTypeEnum'][_0x38acad(0x3a6)]:{const {fieldId:_0x46ba97,oldName:_0x5e4b99,newName:_0x25548e}=_0x3e86c9,_0x5411e8={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x46ba97,'name':_0x25548e};_0x4581e9[_0x38acad(0x2c5)]({'id':st['id'],'params':_0x5411e8});const _0x2ab238={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x46ba97,'name':_0x5e4b99};_0x3c7f65['unshift']({'id':st['id'],'params':_0x2ab238});}break;case m[_0x38acad(0x176)][_0x38acad(0x2f6)]:{const {fieldId:_0x392476,oldFilterInfo:_0x379a22,newFilterInfo:_0x3b2337}=_0x3e86c9,_0x145890={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x392476,'filterInfo':_0x3b2337};_0x4581e9[_0x38acad(0x2c5)]({'id':dt['id'],'params':_0x145890});const _0x2a7c9d={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x392476,'filterInfo':_0x379a22};_0x3c7f65[_0x38acad(0x3d6)]({'id':dt['id'],'params':_0x2a7c9d});}break;case m[_0x38acad(0x176)][_0x38acad(0x133)]:{const {fieldId:_0xc9593a,oldSortInfo:_0xd55348,newSortInfo:_0xa9fc0a}=_0x3e86c9,_0x13868c={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0xc9593a,'sortInfo':_0xa9fc0a};_0x4581e9['push']({'id':ut['id'],'params':_0x13868c});const _0x18b6e2={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0xc9593a,'sortInfo':_0xd55348};_0x3c7f65['unshift']({'id':ut['id'],'params':_0x18b6e2});}break;case m['PivotTableChangeTypeEnum'][_0x38acad(0x2dc)]:{const {oldOptions:_0x43b92f,newOptions:_0x8fbae1}=_0x3e86c9,_0x70d8d3={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'options':_0x8fbae1};_0x4581e9[_0x38acad(0x2c5)]({'id':ct['id'],'params':_0x70d8d3});const _0x28dc53={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'options':_0x43b92f};_0x3c7f65['unshift']({'id':ct['id'],'params':_0x28dc53});}break;case m[_0x38acad(0x176)][_0x38acad(0x32d)]:{const {oldArea:_0x44a503,newArea:_0xf3bf33,oldIndex:_0x273809,newIndex:_0xf4efc7,fieldId:_0x199f74}=_0x3e86c9,_0x13cdd8={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x199f74,'area':_0xf3bf33,'index':_0xf4efc7,'oldArea':_0x44a503,'oldIndex':_0x273809};_0x4581e9['push']({'id':gt['id'],'params':_0x13cdd8});const _0x21f167={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x199f74,'area':_0x44a503,'index':_0x273809,'oldArea':_0xf3bf33,'oldIndex':_0xf4efc7};_0x3c7f65['unshift']({'id':gt['id'],'params':_0x21f167});}break;case m[_0x38acad(0x176)]['UpdateValuePosition']:{const {oldValuePosition:_0x537857,newValuePosition:_0xccca36,oldIndex:_0x3eccd8,newIndex:_0x3fd123}=_0x3e86c9,_0x15eabf={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'valuePosition':_0xccca36,'index':_0x3fd123};_0x4581e9[_0x38acad(0x2c5)]({'id':pt['id'],'params':_0x15eabf});const _0x4e6e44={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'valuePosition':_0x537857,'index':_0x3eccd8};_0x3c7f65[_0x38acad(0x3d6)]({'id':pt['id'],'params':_0x4e6e44});}break;case m[_0x38acad(0x176)][_0x38acad(0x132)]:{const {fieldId:_0x4afa67,collapse:_0x58083b,item:_0x1c40f2}=_0x3e86c9,_0x439f06={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x4afa67,'collapse':_0x58083b,'item':_0x1c40f2};_0x4581e9[_0x38acad(0x2c5)]({'id':rt['id'],'params':_0x439f06});const _0x13e81f={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x4afa67,'collapse':!_0x58083b,'item':_0x1c40f2};_0x3c7f65[_0x38acad(0x3d6)]({'id':rt['id'],'params':_0x13e81f});}break;case m[_0x38acad(0x176)][_0x38acad(0x111)]:{const {newFormat:_0x11c9f8,oldFormat:_0x544b29,fieldId:_0x5f2524}=_0x3e86c9,_0x4307da={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x5f2524,'format':_0x11c9f8};_0x4581e9[_0x38acad(0x2c5)]({'id':lt['id'],'params':_0x4307da});const _0x3a085b={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x5f2524,'format':_0x544b29};_0x3c7f65[_0x38acad(0x3d6)]({'id':lt['id'],'params':_0x3a085b});}break;case m[_0x38acad(0x176)][_0x38acad(0x33c)]:{const {tableFieldId:_0x167dd1,oldSourceName:_0x15172e,newSourceName:_0x24c0fb,oldDataFieldId:_0x3c047d,newDataFieldId:_0x3b7298}=_0x3e86c9,_0x440e02={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'tableFieldId':_0x167dd1,'sourceName':_0x24c0fb,'dataFieldId':_0x3b7298};_0x4581e9[_0x38acad(0x2c5)]({'id':ht['id'],'params':_0x440e02});const _0x10cf47={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'tableFieldId':_0x167dd1,'sourceName':_0x15172e,'dataFieldId':_0x3c047d};_0x3c7f65[_0x38acad(0x3d6)]({'id':ht['id'],'params':_0x10cf47});}break;case m['PivotTableChangeTypeEnum'][_0x38acad(0x3e4)]:{const {fieldId:_0x2a8589,filterInfo:_0xc8115,oldFilterInfo:_0xc6a70a}=_0x3e86c9,_0x14873f={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x2a8589,'filterInfo':_0xc8115};_0x4581e9['push']({'id':vt['id'],'params':_0x14873f});const _0x4b55b1={'unitId':_0xca3c09,'subUnitId':_0x4ef242,'pivotTableId':_0x25876a,'fieldId':_0x2a8589,'filterInfo':_0xc6a70a};_0x3c7f65['unshift']({'id':vt['id'],'params':_0x4b55b1});}}return{'redos':_0x4581e9,'undos':_0x3c7f65};}function fe(_0x280681,_0x56b5ad){const _0x3c59c7=_0x58c229;var _0x7eaa98;const _0x356b1c=_0x280681[_0x3c59c7(0x15b)](exports[_0x3c59c7(0x1ce)]),{cellInfo:_0x2baea3,view:_0x2e5083,isEmpty:_0x531c5d}=_0x56b5ad;return(_0x7eaa98=_0x356b1c[_0x3c59c7(0x3fd)][_0x3c59c7(0x3e7)](Jt)(At,{'cellInfo':_0x2baea3,'view':_0x2e5083,'isEmpty':_0x531c5d}))!=null?_0x7eaa98:At;}const to={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':_0x58c229(0x225),async 'handler'(_0x55a6f3,_0x1ec298){const _0x44a482=_0x58c229;if(!_0x1ec298)return!0x1;const _0x146dcd=_0x55a6f3[_0x44a482(0x15b)](v[_0x44a482(0x341)]),_0x93540c=_0x55a6f3[_0x44a482(0x15b)](exports[_0x44a482(0x2a4)]),_0x131b34=_0x55a6f3[_0x44a482(0x15b)](v['IUndoRedoService']),{pivotTableId:_0x5b4fd2,dataFieldId:_0x257000,fieldArea:_0x3de8eb,index:_0x52b299,unitId:_0x42ad46,subUnitId:_0x533805}=_0x1ec298,_0xd31cdd=(await _0x93540c[_0x44a482(0x234)]({'unitId':_0x42ad46,'subUnitId':_0x533805,'pivotTableId':_0x5b4fd2,'params':{'type':k[_0x44a482(0x363)],'addPivotField':{'dataFieldId':_0x257000,'fieldArea':_0x3de8eb,'index':_0x52b299}}}))[_0x44a482(0x281)]['addPivotField'];if(!_0xd31cdd)return!0x1;const {view:_0x4d700f,changesets:_0x702b24,isEmpty:_0x3ca3d0,pivotTableConfig:_0x316aba,shouldBeAddedGroupJSON:_0x415431}=_0xd31cdd,_0x34b879=_0x316aba[_0x44a482(0x18b)],_0x134802=new m[(_0x44a482(0x1a0))]();_0x134802[_0x44a482(0x25d)](_0x4d700f);const _0x39f024={'cellInfo':_0x34b879,'view':_0x134802,'isEmpty':_0x3ca3d0};if(!await _0x55a6f3[_0x44a482(0x15b)](exports[_0x44a482(0x1ce)])['asyncInterceptor'][_0x44a482(0x2ee)](re)(!0x0,_0x39f024))return!0x1;const _0x4495c3=de(_0x55a6f3,_0x134802,_0x34b879,_0x3ca3d0),_0x17e02f=fe(_0x55a6f3,_0x39f024),{undos:_0x2adb1c,redos:_0x2c17b3}=ae(_0x146dcd,{'pivotTableId':_0x5b4fd2,'unitId':_0x42ad46,'subUnitId':_0x533805},_0x702b24);return _0x415431&&(_0x2c17b3[_0x44a482(0x3d6)]({'id':Zt['id'],'params':{'pivotTableId':_0x5b4fd2,'fieldJSON':_0x415431,'unitId':_0x42ad46,'subUnitId':_0x533805}}),_0x2adb1c[_0x44a482(0x2c5)]({'id':eo['id'],'params':{'pivotTableId':_0x5b4fd2,'dataFieldId':_0x415431['id'],'unitId':_0x42ad46,'subUnitId':_0x533805}})),v[_0x44a482(0x13d)]([..._0x4495c3[_0x44a482(0x1fa)],..._0x17e02f[_0x44a482(0x1fa)],..._0x2c17b3],_0x146dcd),_0x131b34['pushUndoRedo']({'unitID':_0x42ad46,'redoMutations':[..._0x4495c3['redos'],..._0x17e02f['redos'],..._0x2c17b3],'undoMutations':[..._0x4495c3['undos'],..._0x17e02f['undos'],..._0x2adb1c]}),!0x0;}},Nn=()=>typeof process<'u'&&process[_0x58c229(0x311)]!=null&&process[_0x58c229(0x311)][_0x58c229(0x349)]!=null,we={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x3a4),'handler'(_0x164320,_0x36ff40){const _0x371028=_0x58c229;var _0x24a934;if(!_0x36ff40)return!0x1;const _0x3db1c5=_0x164320[_0x371028(0x15b)](v[_0x371028(0x1ab)]);if(!!_0x3db1c5[_0x371028(0x17f)](q))return!0x0;const _0x119279=_0x164320[_0x371028(0x15b)](v[_0x371028(0x185)]),_0x9ac881=_0x164320[_0x371028(0x15b)](exports[_0x371028(0x297)]),{pivotTableId:_0x2c12ba,pivotTableConfig:_0x1b1bfe,collectionConfig:_0x5d1f36,unitId:_0x3e0ea4,subUnitId:_0x10fd23}=_0x36ff40,{sourceRangeInfo:_0x20bf1d,fieldsConfig:_0x5c3716,targetCellInfo:_0x51e88a}=_0x1b1bfe,_0x634c6f=_0x119279['getUnit'](_0x3e0ea4);if(!_0x634c6f||!_0x634c6f[_0x371028(0x3a8)](_0x10fd23))return!0x1;if(!Nn()){let _0x3d4ab0=0x0;_0x634c6f[_0x371028(0x167)]()[_0x371028(0x124)](_0x470121=>{const _0x430d30=_0x371028;var _0x14886a,_0x486809;_0x3d4ab0+=(_0x486809=(_0x14886a=_0x9ac881['getSubUnitPivotConfigs'](_0x3e0ea4,_0x470121[_0x430d30(0x13e)]()))==null?void 0x0:_0x14886a[_0x430d30(0x290)])!=null?_0x486809:0x0;});const _0x38b523=(_0x24a934=_0x3db1c5[_0x371028(0x17f)](ue['LS_CONFIG_KEY']))!=null?_0x24a934:{},{ls:_0x2d80f6,pbk:_0x3c6de8}=_0x38b523;if(!Ut(_0x2d80f6,_0x3c6de8))throw new v[(_0x371028(0x362))](_0x371028(0x40b));const _0x1a0985=St(It,_0x2d80f6,_0x3c6de8)[_0x371028(0x374)];if(_0x3d4ab0>=_0x1a0985)throw new v[(_0x371028(0x362))](_0x371028(0x40b));}if(!_0x5d1f36||!_0x5c3716)return!0x1;const {collection:_0x37dba8,updateDataFieldList:_0xff9dab}=_0x9ac881['addCollectionByJSON'](_0x2c12ba,_0x5d1f36,_0x20bf1d,_0x51e88a);_0x9ac881['refreshData'](_0x37dba8,_0xff9dab,_0x20bf1d);const _0x4d8e11=new m[(_0x371028(0x3e9))](_0x37dba8,void 0x0,_0x2c12ba);_0x4d8e11[_0x371028(0x2b2)](_0x5c3716);const _0x5ba645=JSON[_0x371028(0x2b6)](JSON[_0x371028(0x387)](_0x1b1bfe));return _0x9ac881[_0x371028(0x373)](_0x3e0ea4,_0x10fd23,_0x2c12ba,_0x4d8e11,_0x5ba645),_0x9ac881[_0x371028(0x288)]({'unitId':_0x3e0ea4,'subUnitId':_0x10fd23,'token':_0x2c12ba,'type':j['Add'],'pivotConfig':_0x5ba645}),!0x0;}},oo={'type':v['CommandType']['COMMAND'],'id':_0x58c229(0x402),async 'handler'(_0x341ced,_0x19dabe){const _0x8706cc=_0x58c229;if(!_0x19dabe)return!0x1;const {sourceDataInfo:_0x4bfe0f,pivotTableConfig:_0x62e82}=_0x19dabe;if(!_0x4bfe0f||!_0x62e82)return!0x1;const {unitId:_0x2ef507,subUnitId:_0x4958d9,range:_0x3ae35f}=_0x4bfe0f,_0xca6619=_0x341ced[_0x8706cc(0x15b)](v[_0x8706cc(0x185)]),_0x4a62c2=_0x341ced['get'](exports[_0x8706cc(0x2a4)]),_0xdf52ee=_0x341ced[_0x8706cc(0x15b)](v[_0x8706cc(0x2f8)]),_0x8b3e6=_0x341ced[_0x8706cc(0x15b)](v[_0x8706cc(0x341)]),_0x4e2d5b=_0xca6619[_0x8706cc(0x2cc)](_0x2ef507);if(!_0x4e2d5b)return!0x1;const _0x59b241=_0x4e2d5b['getSheetBySheetId'](_0x4958d9);if(!_0x59b241)return!0x1;const _0x31305e=m[_0x8706cc(0x2da)](0x8),_0x5e7279=_0x3ae35f||{'startRow':0x0,'startColumn':0x0,'endRow':_0x59b241['getRowCount']()-0x1,'endColumn':_0x59b241[_0x8706cc(0x315)]()-0x1};_0x5e7279[_0x8706cc(0x237)]=v[_0x8706cc(0x3ed)][_0x8706cc(0x256)];const _0x47efc7=(await _0x4a62c2['getPivotDisplayConfig']({'unitId':_0x2ef507,'subUnitId':_0x4958d9,'pivotTableId':_0x31305e,'params':{'type':k[_0x8706cc(0x1bf)],'addPivotTableWithConfig':{'sourceRangeInfo':{'unitId':_0x2ef507,'sheetName':_0x59b241[_0x8706cc(0x173)](),'subUnitId':_0x4958d9,'range':_0x5e7279},'pivotTableId':_0x31305e,'pivotTableIndexConfig':_0x62e82}}}))[_0x8706cc(0x281)]['addPivotTableWithConfig'];if(!_0x47efc7)return!0x1;const {isEmpty:_0x6b1c65,fieldsConfig:_0x2d2d8f,collectionConfig:_0x490288,changesets:_0x5f1713}=_0x47efc7,_0x2ef195=_0x4e2d5b['getSheets']()[_0x8706cc(0x3ca)],_0x42d39c=v[_0x8706cc(0x20e)]({'rowCount':_0x59b241[_0x8706cc(0x3ef)]()-0x1,'columnCount':_0x59b241[_0x8706cc(0x315)]()-0x1});_0x42d39c['id']=v[_0x8706cc(0x31d)](),_0x42d39c['name']=_0x4e2d5b[_0x8706cc(0x114)](''+_0xdf52ee['t'](_0x8706cc(0x34a)));const _0x403aa2={'index':_0x2ef195,'sheet':_0x42d39c,'unitId':_0x2ef507},{redos:_0x5a77f2}=ae(_0x8b3e6,{'pivotTableId':_0x31305e,'unitId':_0x2ef507,'subUnitId':_0x42d39c['id']},_0x5f1713),_0x378685=[{'id':V[_0x8706cc(0x299)]['id'],'params':_0x403aa2},{'id':we['id'],'params':{'unitId':_0x2ef507,'subUnitId':_0x42d39c['id'],'pivotTableId':_0x31305e,'pivotTableConfig':{'isEmpty':_0x6b1c65,'fieldsConfig':_0x2d2d8f,'targetCellInfo':{'row':0x0,'col':0x0,'unitId':_0x2ef507,'subUnitId':_0x42d39c['id']},'sourceRangeInfo':{'subUnitId':_0x4958d9,'unitId':_0x2ef507,'range':_0x5e7279,'sheetName':_0x59b241[_0x8706cc(0x173)]()}},'collectionConfig':_0x490288}},..._0x5a77f2];return v[_0x8706cc(0x13d)](_0x378685,_0x8b3e6),!0x0;}},Ye={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':'sheet.mutation.remove-pivot-table','handler'(_0x46d3e3,_0x59984e){const _0x448060=_0x58c229;if(!_0x59984e)return!0x1;if(!!_0x46d3e3[_0x448060(0x15b)](v[_0x448060(0x1ab)])[_0x448060(0x17f)](q))return!0x0;const {pivotTableId:_0x14f20a,unitId:_0x216658,subUnitId:_0x4cabfc}=_0x59984e,_0x2cd696=_0x46d3e3[_0x448060(0x15b)](exports['SheetsPivotDataSourceModel']);return _0x2cd696[_0x448060(0x338)](_0x216658,_0x4cabfc,_0x14f20a)?(_0x2cd696[_0x448060(0x288)]({'unitId':_0x216658,'subUnitId':_0x4cabfc,'token':_0x14f20a,'type':j['Delete']}),_0x2cd696[_0x448060(0x2fe)](_0x216658,_0x4cabfc,_0x14f20a),!0x0):!0x1;}},no={'type':v[_0x58c229(0x3b4)]['COMMAND'],'id':_0x58c229(0x158),async 'handler'(_0xb31d8f,_0x200914){const _0x1e0ea0=_0x58c229;var _0x36ea66,_0x3cf694;const _0xcc3ddd=_0xb31d8f['get'](v[_0x1e0ea0(0x341)]),_0x284268=_0xb31d8f[_0x1e0ea0(0x15b)](v['IUniverInstanceService']),_0x5daf6f=_0xb31d8f['get'](v[_0x1e0ea0(0x2f8)]),_0x47d698=_0xb31d8f['get'](exports[_0x1e0ea0(0x2a4)]),_0x5a49f7=_0xb31d8f['get'](v[_0x1e0ea0(0x3a2)]),_0x20d2e8=_0xb31d8f[_0x1e0ea0(0x15b)](exports[_0x1e0ea0(0x416)]),_0x1b4719=_0xb31d8f[_0x1e0ea0(0x15b)](v['IConfigService']);if(!_0x200914)return!0x1;const {pivotTableConfig:_0x2b0a5e,positionType:_0x459a17}=_0x200914,{targetCellInfo:_0x38a327,sourceRangeInfo:_0xd5d708}=_0x2b0a5e,{unitId:_0x20d526,subUnitId:_0x128a59}=_0x38a327,_0x242611=_0x284268['getUnit'](_0x20d526);if(!_0x242611)return!0x1;let _0x437b9b=0x0;_0x242611[_0x1e0ea0(0x167)]()['forEach'](_0x5ab668=>{const _0x2a5eb2=_0x1e0ea0;var _0x3cf5e9,_0x1e6e02;_0x437b9b+=(_0x1e6e02=(_0x3cf5e9=_0x20d2e8[_0x2a5eb2(0x135)](_0x20d526,_0x5ab668[_0x2a5eb2(0x13e)]()))==null?void 0x0:_0x3cf5e9[_0x2a5eb2(0x290)])!=null?_0x1e6e02:0x0;});const _0x5568ef=(_0x36ea66=_0x1b4719['getConfig'](ue[_0x1e0ea0(0x41c)]))!=null?_0x36ea66:{},{ls:_0x24d0ae,pbk:_0x273903}=_0x5568ef;if(!Ut(_0x24d0ae,_0x273903))return!0x1;const _0x1bce6c=St(It,_0x24d0ae,_0x273903)[_0x1e0ea0(0x374)];if(_0x437b9b>=_0x1bce6c)return!0x1;const _0x19f545=_0x200914[_0x1e0ea0(0x40c)]||m['generateHexNumber'](0x8),_0x56c845=(await _0x47d698[_0x1e0ea0(0x234)]({'unitId':_0x20d526,'subUnitId':_0x128a59,'pivotTableId':_0x19f545,'params':{'type':k[_0x1e0ea0(0x3b9)],'addPivotTable':{'sourceRangeInfo':_0xd5d708,'pivotTableId':_0x19f545}}}))[_0x1e0ea0(0x281)][_0x1e0ea0(0x373)];if(!_0x56c845)return!0x1;const {view:_0xab3123,isEmpty:_0x385bf4,fieldsConfig:_0x36e488,collectionConfig:_0x561d96}=_0x56c845,_0x27b762=[],_0x508e89=[];if(_0x459a17===Mt[_0x1e0ea0(0x1da)]){const _0x506bdb=_0x242611[_0x1e0ea0(0x167)]()[_0x1e0ea0(0x3ca)],_0x23a65e=v[_0x1e0ea0(0x20e)]({});_0x23a65e['id']=_0x2b0a5e[_0x1e0ea0(0x18b)][_0x1e0ea0(0x2f1)],_0x23a65e[_0x1e0ea0(0x1bd)]=(_0x3cf694=_0x2b0a5e['targetCellInfo']['sheetName'])!=null?_0x3cf694:_0x242611['generateNewSheetName'](''+_0x5daf6f['t']('sheets.tabs.sheet'));const _0x129a50={'index':_0x506bdb,'sheet':_0x23a65e,'unitId':_0x20d526},_0x3ca07e=V[_0x1e0ea0(0x27d)](_0xb31d8f,_0x129a50);_0x27b762[_0x1e0ea0(0x2c5)]({'id':V[_0x1e0ea0(0x19c)]['id'],'params':_0x3ca07e}),_0x508e89[_0x1e0ea0(0x2c5)]({'id':V[_0x1e0ea0(0x399)]['id'],'params':_0x129a50});}else{if(!_0x242611[_0x1e0ea0(0x3a8)](_0x128a59))return!0x1;const _0x3d19fb=de(_0xb31d8f,new m[(_0x1e0ea0(0x1a0))](),_0x38a327,!0x0);_0x508e89['push'](..._0x3d19fb[_0x1e0ea0(0x1fa)]),_0x27b762[_0x1e0ea0(0x2c5)](..._0x3d19fb[_0x1e0ea0(0x18d)]);const _0xbf7ef8={'cellInfo':_0x38a327,'view':_0xab3123,'isEmpty':_0x385bf4};if(!await _0xb31d8f[_0x1e0ea0(0x15b)](exports['SheetsPivotTableService'])[_0x1e0ea0(0x32c)]['fetchThroughAsyncInterceptors'](re)(!0x0,_0xbf7ef8))return!0x1;const _0x4010dc=fe(_0xb31d8f,_0xbf7ef8);_0x508e89['push'](..._0x4010dc[_0x1e0ea0(0x1fa)]),_0x27b762['push'](..._0x4010dc[_0x1e0ea0(0x18d)]);}return _0x508e89[_0x1e0ea0(0x2c5)]({'id':we['id'],'params':{'unitId':_0x38a327['unitId'],'subUnitId':_0x38a327[_0x1e0ea0(0x2f1)],'pivotTableId':_0x19f545,'pivotTableConfig':{'targetCellInfo':_0x38a327,'sourceRangeInfo':_0xd5d708,'fieldsConfig':_0x36e488},'collectionConfig':_0x561d96}}),_0x27b762[_0x1e0ea0(0x3d6)]({'id':Ye['id'],'params':{'unitId':_0x20d526,'subUnitId':_0x128a59,'pivotTableId':_0x19f545}}),v[_0x1e0ea0(0x13d)](_0x508e89,_0xcc3ddd)&&_0x5a49f7[_0x1e0ea0(0x2be)]({'unitID':_0x20d526,'undoMutations':_0x27b762,'redoMutations':_0x508e89}),!0x0;}},io={'type':v['CommandType'][_0x58c229(0x2fc)],'id':_0x58c229(0x369),async 'handler'(_0xd550f1,_0xde3830){const _0x3f4b47=_0x58c229;if(!_0xde3830)return!0x1;const _0x3680f5=_0xd550f1[_0x3f4b47(0x15b)](v[_0x3f4b47(0x341)]),_0xbbcd8e=_0xd550f1[_0x3f4b47(0x15b)](exports['SheetsPivotRPCService']),_0x57d40d=_0xd550f1['get'](v['IUndoRedoService']),{pivotTableId:_0x49e44e,fieldId:_0x33a511,area:_0x3886bc,index:_0x20446e,unitId:_0x54a15c,subUnitId:_0x510e01}=_0xde3830,_0x8e4cf0=(await _0xbbcd8e[_0x3f4b47(0x234)]({'unitId':_0x54a15c,'subUnitId':_0x510e01,'pivotTableId':_0x49e44e,'params':{'type':k['MovePivotField'],'movePivotField':{'fieldId':_0x33a511,'area':_0x3886bc,'index':_0x20446e}}}))['result'][_0x3f4b47(0x2c4)];if(!_0x8e4cf0)return!0x1;const {changesets:_0x31e12f,view:_0x255e30,isEmpty:_0xda7d07,pivotTableConfig:_0x343d2b}=_0x8e4cf0,_0x2383bb=_0x343d2b[_0x3f4b47(0x18b)],_0x5f3b95=new m[(_0x3f4b47(0x1a0))]();_0x5f3b95['formJSON'](_0x255e30);const _0x15337a={'cellInfo':_0x2383bb,'view':_0x5f3b95,'isEmpty':_0xda7d07};if(!await _0xd550f1['get'](exports[_0x3f4b47(0x1ce)])[_0x3f4b47(0x32c)][_0x3f4b47(0x2ee)](re)(!0x0,_0x15337a))return!0x1;const _0x127acc=de(_0xd550f1,_0x5f3b95,_0x2383bb,_0xda7d07),_0x22c87c=fe(_0xd550f1,_0x15337a),{redos:_0x3cd360,undos:_0x2dbcdd}=ae(_0x3680f5,{'pivotTableId':_0x49e44e,'unitId':_0x54a15c,'subUnitId':_0x510e01},_0x31e12f);return v[_0x3f4b47(0x13d)]([..._0x127acc['redos'],..._0x22c87c[_0x3f4b47(0x1fa)],..._0x3cd360],_0x3680f5),_0x57d40d[_0x3f4b47(0x2be)]({'unitID':_0x54a15c,'redoMutations':[..._0x127acc[_0x3f4b47(0x1fa)],..._0x22c87c[_0x3f4b47(0x1fa)],..._0x3cd360],'undoMutations':[..._0x127acc[_0x3f4b47(0x18d)],..._0x22c87c['undos'],..._0x2dbcdd]}),!0x0;}},Fe={'type':v['CommandType'][_0x58c229(0x209)],'id':_0x58c229(0x1d5),'handler'(_0x24a584,_0x1f9999){const _0x5e70bd=_0x58c229;if(!_0x1f9999)return!0x1;if(!!_0x24a584[_0x5e70bd(0x15b)](v[_0x5e70bd(0x1ab)])[_0x5e70bd(0x17f)](q))return!0x0;const {pivotTableId:_0x16e951,targetCellPosition:_0x3d82c9,unitId:_0x58f2b4,subUnitId:_0x412a50}=_0x1f9999,_0x5216be=_0x24a584[_0x5e70bd(0x15b)](exports['SheetsPivotDataSourceModel']);if(!_0x5216be[_0x5e70bd(0x1a5)](_0x1f9999[_0x5e70bd(0x40c)]))return!0x1;const _0xc27f58=_0x5216be[_0x5e70bd(0x1dd)](_0x16e951);if(!_0xc27f58)return!0x1;const _0xd07b78=_0x5216be[_0x5e70bd(0x2af)](_0xc27f58['unitId'],_0x1f9999[_0x5e70bd(0x40c)]);if(!_0xd07b78)return!0x1;const _0x22b37b=_0x5216be[_0x5e70bd(0x338)](_0xc27f58[_0x5e70bd(0x204)],_0xc27f58[_0x5e70bd(0x2f1)],_0x16e951);if(!_0x22b37b)return!0x1;const _0x43d878=v['Tools']['deepClone'](_0x22b37b);_0x43d878[_0x5e70bd(0x18b)]={'unitId':_0x58f2b4,'subUnitId':_0x412a50,'row':_0x3d82c9[_0x5e70bd(0x1d4)],'col':_0x3d82c9[_0x5e70bd(0x178)]};const _0x418118=_0xd07b78[_0x5e70bd(0x128)]();if(_0xc27f58['subUnitId']===_0x412a50&&_0xc27f58['unitId']===_0x58f2b4)_0x5216be[_0x5e70bd(0x1d7)](_0x58f2b4,_0x412a50,_0x16e951,_0x43d878),_0x5216be[_0x5e70bd(0x288)]({'unitId':_0x58f2b4,'subUnitId':_0x412a50,'token':_0x16e951,'type':j['Set']});else{_0x5216be[_0x5e70bd(0x288)]({'unitId':_0xc27f58[_0x5e70bd(0x204)],'subUnitId':_0xc27f58[_0x5e70bd(0x2f1)],'token':_0x16e951,'type':j[_0x5e70bd(0x414)]}),_0x5216be['removePivotTable'](_0xc27f58[_0x5e70bd(0x204)],_0xc27f58['subUnitId'],_0x16e951);const _0x55820b=_0x5216be[_0x5e70bd(0x325)](_0x16e951,_0x418118,_0x22b37b[_0x5e70bd(0x141)],_0x43d878[_0x5e70bd(0x18b)]),_0x33dd12=new m[(_0x5e70bd(0x3e9))](_0x55820b['collection'],void 0x0,_0x16e951);_0x33dd12[_0x5e70bd(0x2b2)](_0x43d878[_0x5e70bd(0x35c)]),_0x5216be['addPivotTable'](_0x58f2b4,_0x412a50,_0x16e951,_0x33dd12,_0x43d878),_0x5216be[_0x5e70bd(0x288)]({'unitId':_0x58f2b4,'subUnitId':_0x412a50,'token':_0x16e951,'type':j[_0x5e70bd(0x1af)],'pivotConfig':_0x43d878});}return!0x0;}},ao={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':_0x58c229(0x2ec),'handler':(_0x3d518a,_0x44fdf0)=>{const _0x4cb326=_0x58c229,_0x1f909a=_0x3d518a[_0x4cb326(0x15b)](v[_0x4cb326(0x341)]),_0x493393=_0x3d518a[_0x4cb326(0x15b)](v[_0x4cb326(0x3a2)]),_0xadfef8=_0x3d518a['get'](exports['SheetsPivotTableConfigModel']),_0x1f8b67=_0x3d518a[_0x4cb326(0x15b)](v[_0x4cb326(0x185)]);if(!_0x44fdf0)return!0x1;const _0x5a9681=V['getSheetCommandTarget'](_0x1f8b67);if(!_0x5a9681)return!0x1;const {unitId:_0x2d25d1,subUnitId:_0x4a418e,workbook:_0x1dd5f9}=_0x5a9681,_0x21a499=_0xadfef8[_0x4cb326(0x338)](_0x44fdf0[_0x4cb326(0x3dd)][_0x4cb326(0x204)],_0x44fdf0[_0x4cb326(0x3dd)][_0x4cb326(0x2f1)],_0x44fdf0[_0x4cb326(0x40c)]);if(!_0x21a499)return!0x1;const _0x3c31bf=_0x1dd5f9[_0x4cb326(0x3a8)](_0x44fdf0[_0x4cb326(0x18b)][_0x4cb326(0x2f1)]);if(!_0x3c31bf)throw new Error('[Pivot\x20Table]:\x20Target\x20sheet\x20is\x20not\x20valid');const _0x4da846=_0x3c31bf[_0x4cb326(0x3ef)](),_0x2cea31=_0x3c31bf[_0x4cb326(0x315)]();if(_0x44fdf0[_0x4cb326(0x18b)][_0x4cb326(0x1d4)]>_0x4da846||_0x44fdf0['targetCellInfo'][_0x4cb326(0x178)]>_0x2cea31)throw new Error('[Pivot\x20Table]:\x20Target\x20cell\x20is\x20out\x20of\x20range');const _0x288ead=[{'id':Fe['id'],'params':{'unitId':_0x2d25d1,'subUnitId':_0x44fdf0['targetCellInfo'][_0x4cb326(0x2f1)],'pivotTableId':_0x44fdf0[_0x4cb326(0x40c)],'targetCellPosition':{'row':_0x44fdf0[_0x4cb326(0x18b)][_0x4cb326(0x1d4)],'col':_0x44fdf0[_0x4cb326(0x18b)][_0x4cb326(0x178)]}}}],_0x123812=[{'id':Fe['id'],'params':{'unitId':_0x2d25d1,'subUnitId':_0x4a418e,'pivotTableId':_0x44fdf0[_0x4cb326(0x40c)],'targetCellPosition':{'row':_0x21a499[_0x4cb326(0x18b)][_0x4cb326(0x1d4)],'col':_0x21a499[_0x4cb326(0x18b)][_0x4cb326(0x178)]}}}];return v[_0x4cb326(0x13d)](_0x288ead,_0x1f909a)&&_0x493393['pushUndoRedo']({'unitID':_0x2d25d1,'undoMutations':_0x123812,'redoMutations':_0x288ead}),!0x0;}},so={'type':v[_0x58c229(0x3b4)]['COMMAND'],'id':_0x58c229(0x28f),async 'handler'(_0x1db273,_0x180c85){const _0x45e026=_0x58c229;var _0x113c47;if(!_0x180c85)return!0x1;const _0xadbf76=_0x1db273[_0x45e026(0x15b)](v[_0x45e026(0x185)]),_0x414ff9=V[_0x45e026(0x41b)](_0xadbf76);if(!_0x414ff9)return!0x1;const {unitId:_0x29a60a,subUnitId:_0x478da3,workbook:_0x330eba}=_0x414ff9,{row:_0x310e41,col:_0x5d16dd}=_0x180c85,_0x192554=_0x1db273[_0x45e026(0x15b)](exports['SheetsPivotTableAdaptorModel']),_0x247ded=_0x192554[_0x45e026(0x282)](_0x29a60a,_0x478da3,_0x310e41,_0x5d16dd);if(!_0x247ded)return!0x1;const _0xaec43a=(_0x113c47=_0x192554[_0x45e026(0x344)](_0x29a60a,_0x478da3,_0x247ded))==null?void 0x0:_0x113c47[_0x45e026(0x116)];if(!_0xaec43a)return!0x1;const _0x1c68e1=_0x1db273['get'](exports['SheetsPivotTableConfigModel'])[_0x45e026(0x338)](_0x29a60a,_0x478da3,_0x247ded);if(!_0x1c68e1)return!0x1;const {rowInfo:_0x3c6870,colInfo:_0x364fe5}=_0xaec43a,_0x14e365=_0x3c6870[_0x310e41][_0x45e026(0x1eb)],_0x5ad8d4=_0x364fe5[_0x5d16dd]['paths'],_0x1b7b2a=_0x3c6870[_0x310e41][_0x45e026(0x12a)],_0x2b258d=_0x364fe5[_0x5d16dd][_0x45e026(0x12a)],_0x4edb3f=_0x14e365[_0x45e026(0x3bb)](_0x5ad8d4),_0x998c6f=_0x1c68e1[_0x45e026(0x35c)][_0x45e026(0x332)][_0x45e026(0x2f2)](0x0,_0x1b7b2a),_0x40ad23=_0x1c68e1[_0x45e026(0x35c)][_0x45e026(0x11e)][_0x45e026(0x2f2)](0x0,_0x2b258d),_0x542283=_0x998c6f[_0x45e026(0x3bb)](_0x40ad23),_0x50c93a=_0x4edb3f[_0x45e026(0x14c)]((_0x23186a,_0x17b1c3)=>[_0x23186a,_0x542283[_0x17b1c3]]),_0x20ab82=(await _0x1db273['get'](exports['SheetsPivotRPCService'])[_0x45e026(0x234)]({'unitId':_0x29a60a,'subUnitId':_0x478da3,'pivotTableId':_0x247ded,'params':{'type':k[_0x45e026(0x1b7)],'drillDown':{'tuple':_0x50c93a}}}))[_0x45e026(0x281)][_0x45e026(0x350)];if(!_0x20ab82)return!0x1;const {indexes:_0x33f761,range:_0x43ae5f,sourceUnitId:_0x557254,sourceSubUnitId:_0x2e9e96,formatMap:_0x570c16}=_0x20ab82,{startRow:_0x4cd3fc,endRow:_0x2d938f,startColumn:_0x276121,endColumn:_0x310b90}=_0x43ae5f,_0x48aa2f=new v[(_0x45e026(0x342))](),_0x322b0b=_0x2d938f-_0x4cd3fc,_0x235533=_0x310b90-_0x276121,_0x184709={},_0x31b4b8=V[_0x45e026(0x41b)](_0xadbf76,{'unitId':_0x557254,'subUnitId':_0x2e9e96});if(!_0x31b4b8)return!0x1;const _0x4506f0=oe[_0x45e026(0x1d9)],_0x529d2e=oe['subTotalStyle'],_0x14b0c4=oe[_0x45e026(0x1a4)],_0x1f7eb7=_0x330eba[_0x45e026(0x3f1)]()[_0x45e026(0x258)](_0x4506f0),_0x57dedb=_0x330eba[_0x45e026(0x3f1)]()[_0x45e026(0x258)](_0x529d2e),_0x33b994=_0x330eba[_0x45e026(0x3f1)]()[_0x45e026(0x258)](_0x14b0c4),{worksheet:_0x109c0a}=_0x31b4b8;let _0x3be101=0x0;const _0xb9e4ce=0x1;_0x33f761[_0x45e026(0x124)](_0x442215=>{const _0x5e376e=_0x45e026;for(let _0x203e94=0x0;_0x203e94<=_0x310b90-_0x276121;_0x203e94++)_0x48aa2f[_0x5e376e(0x258)](_0x3be101,_0x203e94,_0x109c0a[_0x5e376e(0x1b8)](_0x442215+_0x43ae5f[_0x5e376e(0x1fd)]+_0xb9e4ce,_0x203e94));_0x3be101++;});for(let _0x5969cc=_0x276121;_0x5969cc<=_0x310b90;_0x5969cc++){const _0xf72adf=_0x109c0a[_0x45e026(0x1b8)](_0x4cd3fc,_0x5969cc);_0x184709[_0x4cd3fc]||(_0x184709[_0x4cd3fc]={}),_0x184709[_0x4cd3fc][_0x5969cc]={..._0xf72adf,'s':_0x1f7eb7};}let _0x3a9def=0x1;const _0x194e13={},_0x188464={};_0x48aa2f[_0x45e026(0x3e2)]((_0x5c46a6,_0xfb5e6b)=>{_0xfb5e6b['forEach'](_0x12949e=>{const _0x244323=_0x1cc3,_0x25f8b9=_0x48aa2f['getValue'](_0x5c46a6,_0x12949e);if(_0x184709[_0x3a9def]||(_0x184709[_0x3a9def]={}),_0x184709[_0x3a9def][_0x12949e]={..._0x25f8b9,'s':_0x3a9def%0x2===0x0?_0x33b994:_0x57dedb},_0x570c16[_0x12949e]&&_0x5c46a6>=0x0){const _0x20bfb9=_0x3a9def%0x2===0x0;let _0xf2cbe8=_0x20bfb9?_0x188464[_0x12949e]:_0x194e13[_0x12949e];_0xf2cbe8||(_0xf2cbe8=_0x330eba['getStyles']()[_0x244323(0x258)]({..._0x20bfb9?_0x14b0c4:_0x529d2e,'n':{'pattern':_0x570c16[_0x12949e]}}),_0x20bfb9?_0x188464[_0x12949e]=_0xf2cbe8:_0x194e13[_0x12949e]=_0xf2cbe8),_0x184709[_0x3a9def][_0x12949e]['s']=_0xf2cbe8;}}),_0x3a9def++;});const _0xd1ed88=new v[(_0x45e026(0x342))](_0x184709),_0x1e6f6a={};_0xd1ed88[_0x45e026(0x407)]((_0x5188fd,_0xfd544b,_0x2991db)=>{_0x1e6f6a[_0x5188fd]||(_0x1e6f6a[_0x5188fd]={}),_0x1e6f6a[_0x5188fd][_0xfd544b]={'s':null,'f':null,'si':null,'p':null,'v':null,'t':null,'custom':null};});const _0x301a63=[],_0x11e07b=[],_0x4732d6=_0x330eba[_0x45e026(0x167)]()[_0x45e026(0x3ca)],_0x14526f=v[_0x45e026(0x20e)]({'rowCount':Math[_0x45e026(0x3cb)](v[_0x45e026(0x2d7)],_0x322b0b+0xa),'columnCount':Math[_0x45e026(0x3cb)](v['DEFAULT_WORKSHEET_COLUMN_COUNT'],_0x235533+0x5)}),_0xd21abf=_0x1db273[_0x45e026(0x15b)](v[_0x45e026(0x2f8)]);_0x14526f['id']=v[_0x45e026(0x31d)](),_0x14526f[_0x45e026(0x1bd)]=_0x330eba[_0x45e026(0x114)](''+_0xd21abf['t'](_0x45e026(0x34a)));const _0x570762={'index':_0x4732d6,'sheet':_0x14526f,'unitId':_0x29a60a},_0x34cb93=V[_0x45e026(0x27d)](_0x1db273,_0x570762);_0x11e07b[_0x45e026(0x2c5)]({'id':V[_0x45e026(0x399)]['id'],'params':_0x570762}),_0x301a63[_0x45e026(0x2c5)]({'id':V[_0x45e026(0x19c)]['id'],'params':_0x34cb93}),_0x11e07b[_0x45e026(0x2c5)]({'id':V[_0x45e026(0x3f2)]['id'],'params':{'unitId':_0x29a60a,'subUnitId':_0x14526f['id'],'cellValue':_0x184709}}),_0x301a63['unshift']({'id':V[_0x45e026(0x3f2)]['id'],'params':{'unitId':_0x29a60a,'subUnitId':_0x14526f['id'],'cellValue':_0x1e6f6a}});const _0xe8ce1e={'startRow':0x0,'startColumn':0x0,'endRow':_0x3a9def-0x1,'endColumn':_0x310b90};_0x11e07b['push']({'id':Ot[_0x45e026(0x3d1)]['id'],'params':{'unitId':_0x29a60a,'subUnitId':_0x14526f['id'],'range':_0xe8ce1e}}),_0x301a63[_0x45e026(0x3d6)]({'id':Ot[_0x45e026(0x37d)]['id'],'params':{'unitId':_0x29a60a,'subUnitId':_0x14526f['id']}});const _0x58b364=_0x1db273[_0x45e026(0x15b)](v[_0x45e026(0x341)]);return v[_0x45e026(0x13d)](_0x11e07b,_0x58b364)&&_0x1db273[_0x45e026(0x15b)](v[_0x45e026(0x3a2)])[_0x45e026(0x2be)]({'unitID':_0x29a60a,'undoMutations':_0x301a63,'redoMutations':_0x11e07b}),!0x0;}},ro={'type':v[_0x58c229(0x3b4)]['COMMAND'],'id':_0x58c229(0x3fb),async 'handler'(_0x2299d1,_0x5dabb7){const _0x58d738=_0x58c229;if(!_0x5dabb7)return!0x1;const _0x3557cb=_0x2299d1[_0x58d738(0x15b)](v[_0x58d738(0x341)]),_0x73a1f8=_0x2299d1[_0x58d738(0x15b)](exports[_0x58d738(0x2a4)]),_0xec8fd6=_0x2299d1[_0x58d738(0x15b)](v[_0x58d738(0x3a2)]),{pivotTableId:_0x29efbc,fieldIds:_0x363c20,unitId:_0x2d85da,subUnitId:_0x8282da}=_0x5dabb7,_0x3625f4=(await _0x73a1f8['getPivotDisplayConfig']({'unitId':_0x2d85da,'subUnitId':_0x8282da,'pivotTableId':_0x29efbc,'params':{'type':k[_0x58d738(0x206)],'removePivotField':{'fieldIds':_0x363c20}}}))['result'][_0x58d738(0x3fa)];if(!_0x3625f4)return!0x1;const {view:_0x136445,changesets:_0x1c12dd,isEmpty:_0x4a59f6,pivotTableConfig:_0x4d9a7e}=_0x3625f4,_0x2e5519=_0x4d9a7e[_0x58d738(0x18b)],_0x5776b3=new m['PivotView']();_0x5776b3['formJSON'](_0x136445);const _0x108c8c={'cellInfo':_0x2e5519,'view':_0x5776b3,'isEmpty':_0x4a59f6};if(!await _0x2299d1[_0x58d738(0x15b)](exports[_0x58d738(0x1ce)])[_0x58d738(0x32c)][_0x58d738(0x2ee)](re)(!0x0,_0x108c8c))return!0x1;const _0x50a1d0=de(_0x2299d1,_0x5776b3,_0x2e5519,_0x4a59f6),_0x5cb58f=fe(_0x2299d1,_0x108c8c),{redos:_0x5c42a0,undos:_0x4515ed}=ae(_0x3557cb,{'pivotTableId':_0x29efbc,'unitId':_0x2d85da,'subUnitId':_0x8282da},_0x1c12dd);return v[_0x58d738(0x13d)]([..._0x50a1d0['redos'],..._0x5cb58f[_0x58d738(0x1fa)],..._0x5c42a0],_0x3557cb),_0xec8fd6[_0x58d738(0x2be)]({'unitID':_0x2d85da,'redoMutations':[..._0x50a1d0[_0x58d738(0x1fa)],..._0x5cb58f[_0x58d738(0x1fa)],..._0x5c42a0],'undoMutations':[..._0x50a1d0[_0x58d738(0x18d)],..._0x5cb58f[_0x58d738(0x18d)],..._0x4515ed]}),!0x0;}},lo={'type':v[_0x58c229(0x3b4)]['COMMAND'],'id':_0x58c229(0x254),async 'handler'(_0x1fab64,_0x285463){const _0x3f0253=_0x58c229;if(!_0x285463)return!0x1;const _0x16bba0=_0x1fab64['get'](v[_0x3f0253(0x341)]),_0x2c2a95=_0x1fab64[_0x3f0253(0x15b)](v['IUndoRedoService']),_0x2dec3c=_0x1fab64['get'](exports['SheetsPivotRPCService']),{resetArea:_0x427ecb,pivotTableId:_0x6716ee,unitId:_0x112c85,subUnitId:_0x3caa36}=_0x285463,_0x4417a4=(await _0x2dec3c['getPivotDisplayConfig']({'unitId':_0x112c85,'subUnitId':_0x3caa36,'pivotTableId':_0x6716ee,'params':{'type':k[_0x3f0253(0x38c)],'resetPivotTable':{'pivotTableId':_0x6716ee,'resetArea':_0x427ecb}}}))[_0x3f0253(0x281)][_0x3f0253(0x1ed)];if(!_0x4417a4)return!0x1;const {changesets:_0x39708c}=_0x4417a4,{redos:_0x27ec8a,undos:_0x553077}=ae(_0x16bba0,{'pivotTableId':_0x6716ee,'unitId':_0x112c85,'subUnitId':_0x3caa36},_0x39708c);return v['sequenceExecute'](_0x27ec8a,_0x16bba0),_0x2c2a95['pushUndoRedo']({'unitID':_0x112c85,'redoMutations':_0x27ec8a,'undoMutations':_0x553077}),!0x0;}},co={'type':v[_0x58c229(0x3b4)]['COMMAND'],'id':_0x58c229(0x2c0),async 'handler'(_0x512387,_0x4a13dd){const _0x9d6bb4=_0x58c229,_0x1dedea=_0x512387['get'](v[_0x9d6bb4(0x341)]),_0xc8ff12=_0x512387['get'](exports[_0x9d6bb4(0x2a4)]),_0x58986b=_0x512387[_0x9d6bb4(0x15b)](exports[_0x9d6bb4(0x330)]),_0x411acc=_0x512387['get'](v[_0x9d6bb4(0x185)]),_0x2d421a=_0x512387[_0x9d6bb4(0x15b)](v[_0x9d6bb4(0x2f8)]),_0x515e67=_0x512387[_0x9d6bb4(0x15b)](v[_0x9d6bb4(0x3a2)]);if(!_0x4a13dd)return!0x1;const {unitId:_0x3d7b5e,subUnitId:_0x3060cb,row:_0x2fe189,col:_0x1157ac,collapse:_0x476e8e}=_0x4a13dd,_0x54131d=_0x411acc[_0x9d6bb4(0x2cc)](_0x3d7b5e);if(!_0x54131d||!_0x54131d[_0x9d6bb4(0x3a8)](_0x3060cb))return!0x1;const _0x47e6cd=_0x58986b[_0x9d6bb4(0x282)](_0x3d7b5e,_0x3060cb,_0x2fe189,_0x1157ac);if(!_0x47e6cd)return!0x1;const _0x391fc8=_0x58986b[_0x9d6bb4(0x344)](_0x3d7b5e,_0x3060cb,_0x47e6cd);if(!_0x391fc8)return!0x1;const _0x24d4be=v[_0x9d6bb4(0x15d)](_0x2fe189,_0x1157ac),{rangesInfo:_0x5cf69d,areaInfo:_0x431b50,headerMap:_0x38aadc}=_0x391fc8;if(!_0x5cf69d||!_0x431b50||!_0x38aadc)return!0x1;const _0x3d4bab=Object[_0x9d6bb4(0x284)](_0x5cf69d)[_0x9d6bb4(0x308)](_0x1dc151=>_0x5cf69d[_0x1dc151][_0x9d6bb4(0x160)](_0x227e6c=>v[_0x9d6bb4(0x22f)][_0x9d6bb4(0x273)](_0x227e6c,_0x24d4be)));let _0x29b601;_0x3d4bab===_0x9d6bb4(0x24c)?_0x29b601=_0x38aadc[_0x9d6bb4(0x275)][_0x1157ac]:_0x3d4bab===_0x9d6bb4(0x11a)&&(_0x29b601=_0x38aadc[_0x9d6bb4(0x3e5)][_0x2fe189]);const _0x910b5e=_0x29b601==null?void 0x0:_0x29b601['tableFieldId'],_0x48df0b=_0x58986b['getPivotTableCellData'](_0x3d7b5e,_0x3060cb,_0x2fe189,_0x1157ac);let _0x4a99ed=_0x48df0b==null?void 0x0:_0x48df0b['v'];if(_0x4a99ed===_0x2d421a['t']('sheets-pivot.blank')&&(_0x4a99ed=m[_0x9d6bb4(0x1a2)][_0x9d6bb4(0x2b4)]),_0x4a99ed==null||!_0x47e6cd||!_0x910b5e)return!0x1;const _0x1ab206=await _0xc8ff12[_0x9d6bb4(0x234)]({'unitId':_0x3d7b5e,'subUnitId':_0x3060cb,'pivotTableId':_0x47e6cd,'params':{'type':k['SetPivotCollapse'],'setPivotCollapse':{'tableFieldId':_0x910b5e,'collapse':_0x476e8e,'item':_0x4a99ed}}}),_0x13ef78=_0x1ab206==null?void 0x0:_0x1ab206['result'][_0x9d6bb4(0x147)];if(!_0x13ef78)return!0x1;const {view:_0x5c9380,pivotTableConfig:_0x3d7278,isEmpty:_0x2b39a3,changesets:_0x146d15}=_0x13ef78,_0x4c9461=new m[(_0x9d6bb4(0x1a0))]();_0x4c9461[_0x9d6bb4(0x25d)](_0x5c9380);const _0x3ac231=_0x3d7278[_0x9d6bb4(0x18b)],_0x4d36de={'cellInfo':_0x3ac231,'view':_0x4c9461,'isEmpty':_0x2b39a3};if(!await _0x512387[_0x9d6bb4(0x15b)](exports[_0x9d6bb4(0x1ce)])['asyncInterceptor']['fetchThroughAsyncInterceptors'](re)(!0x0,_0x4d36de))return!0x1;const _0x33f997=de(_0x512387,_0x4c9461,_0x3ac231,_0x2b39a3),_0xe0e3ea=fe(_0x512387,_0x4d36de),{redos:_0x2aff0a,undos:_0x4c53e5}=ae(_0x1dedea,{'pivotTableId':_0x47e6cd,'unitId':_0x3d7b5e,'subUnitId':_0x3060cb},_0x146d15);return v[_0x9d6bb4(0x13d)]([..._0x33f997[_0x9d6bb4(0x1fa)],..._0xe0e3ea['redos'],..._0x2aff0a],_0x1dedea),_0x515e67[_0x9d6bb4(0x2be)]({'unitID':_0x3d7b5e,'redoMutations':[..._0x33f997[_0x9d6bb4(0x1fa)],..._0xe0e3ea['redos'],..._0x2aff0a],'undoMutations':[..._0x33f997[_0x9d6bb4(0x18d)],..._0xe0e3ea[_0x9d6bb4(0x18d)],..._0x4c53e5]}),!0x0;}},uo={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':_0x58c229(0x324),async 'handler'(_0xab315f,_0x1929fa){const _0x2cca2c=_0x58c229;if(!_0x1929fa)return!0x1;const _0x3b6271=_0xab315f['get'](v[_0x2cca2c(0x341)]),_0x8574f6=_0xab315f[_0x2cca2c(0x15b)](v[_0x2cca2c(0x3a2)]),_0x49b8a9=_0xab315f[_0x2cca2c(0x15b)](exports[_0x2cca2c(0x2a4)]),{pivotTableConfig:_0x259861,pivotTableId:_0x3d41e5,unitId:_0x52b1d9,subUnitId:_0x499fca}=_0x1929fa,_0x2e1057=(await _0x49b8a9[_0x2cca2c(0x234)]({'unitId':_0x52b1d9,'subUnitId':_0x499fca,'pivotTableId':_0x3d41e5,'params':{'type':k[_0x2cca2c(0x205)],'setPivotTableConfig':{'pivotTableId':_0x3d41e5,'pivotTableConfig':_0x259861}}}))[_0x2cca2c(0x281)][_0x2cca2c(0x2f7)];if(!_0x2e1057)return!0x1;const {changesets:_0x2c783f}=_0x2e1057,{redos:_0x6cb2a1,undos:_0x507228}=ae(_0x3b6271,{'pivotTableId':_0x3d41e5,'unitId':_0x52b1d9,'subUnitId':_0x499fca},_0x2c783f);return v[_0x2cca2c(0x13d)](_0x6cb2a1,_0x3b6271),_0x8574f6[_0x2cca2c(0x2be)]({'unitID':_0x52b1d9,'redoMutations':_0x6cb2a1,'undoMutations':_0x507228}),!0x0;}},fo={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':_0x58c229(0x400),async 'handler'(_0x3090bb,_0x571aa1){const _0x12a358=_0x58c229;if(!_0x571aa1)return!0x1;const _0x26932e=_0x3090bb[_0x12a358(0x15b)](v['ICommandService']),{pivotTableId:_0x1f4c26,tableFieldId:_0x110fd3,items:_0x35a734,unitId:_0x1bb96b,subUnitId:_0x559e91,isAll:_0x15ddb7}=_0x571aa1,_0xb3a630=_0x3090bb[_0x12a358(0x15b)](exports[_0x12a358(0x2a4)]),_0xb08b83=_0x3090bb['get'](v[_0x12a358(0x3a2)]),_0x493aea=(await _0xb3a630[_0x12a358(0x234)]({'unitId':_0x1bb96b,'subUnitId':_0x559e91,'pivotTableId':_0x1f4c26,'params':{'type':k[_0x12a358(0x395)],'setPivotFilter':{'tableFieldId':_0x110fd3,'items':_0x35a734,'isAll':_0x15ddb7}}}))[_0x12a358(0x281)][_0x12a358(0x163)];if(!_0x493aea)return!0x1;const {changesets:_0x3b6f22,pivotTableConfig:_0x397b52,isEmpty:_0x36ed90,view:_0x2c6530}=_0x493aea,_0x25d8ec=_0x397b52[_0x12a358(0x18b)],_0x3181d7=new m['PivotView']();_0x3181d7[_0x12a358(0x25d)](_0x2c6530);const _0x42aff1={'cellInfo':_0x25d8ec,'view':_0x3181d7,'isEmpty':_0x36ed90};if(!await _0x3090bb[_0x12a358(0x15b)](exports['SheetsPivotTableService'])[_0x12a358(0x32c)][_0x12a358(0x2ee)](re)(!0x0,_0x42aff1))return!0x1;const _0x5e0ccb=de(_0x3090bb,_0x3181d7,_0x25d8ec,_0x36ed90),_0x16cdce=fe(_0x3090bb,_0x42aff1),{undos:_0x30c6de,redos:_0x57f6b8}=ae(_0x26932e,{'pivotTableId':_0x1f4c26,'unitId':_0x1bb96b,'subUnitId':_0x559e91},_0x3b6f22);return v[_0x12a358(0x13d)]([..._0x5e0ccb[_0x12a358(0x1fa)],..._0x16cdce['redos'],..._0x57f6b8],_0x26932e),_0xb08b83[_0x12a358(0x2be)]({'unitID':_0x1bb96b,'redoMutations':[..._0x5e0ccb[_0x12a358(0x1fa)],..._0x16cdce[_0x12a358(0x1fa)],..._0x57f6b8],'undoMutations':[..._0x5e0ccb[_0x12a358(0x18d)],..._0x16cdce[_0x12a358(0x18d)],..._0x30c6de]}),!0x0;}},vo={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':_0x58c229(0x409),async 'handler'(_0x540b6f,_0x438b61){const _0x707cd4=_0x58c229;if(!_0x438b61)return!0x1;const _0x594bb3=_0x540b6f[_0x707cd4(0x15b)](v[_0x707cd4(0x341)]),_0x6bcd78=_0x540b6f[_0x707cd4(0x15b)](v[_0x707cd4(0x3a2)]),_0x2ec3fd=_0x540b6f[_0x707cd4(0x15b)](exports['SheetsPivotRPCService']),{info:_0x3a06e8,tableFieldId:_0x5b9107,pivotTableId:_0x16ebd6,unitId:_0x29c5b0,subUnitId:_0x41ac05}=_0x438b61,_0x1834e8=(await _0x2ec3fd[_0x707cd4(0x234)]({'unitId':_0x29c5b0,'subUnitId':_0x41ac05,'pivotTableId':_0x16ebd6,'params':{'type':k[_0x707cd4(0x250)],'setPivotSort':{'tableFieldId':_0x5b9107,'info':_0x3a06e8}}}))['result']['setPivotSort'];if(!_0x1834e8)return!0x1;const {changesets:_0x17c1fd}=_0x1834e8,{redos:_0x79c17f,undos:_0xad7fd4}=ae(_0x594bb3,{'pivotTableId':_0x16ebd6,'unitId':_0x29c5b0,'subUnitId':_0x41ac05},_0x17c1fd);return v[_0x707cd4(0x13d)](_0x79c17f,_0x594bb3),_0x6bcd78['pushUndoRedo']({'unitID':_0x29c5b0,'redoMutations':_0x79c17f,'undoMutations':_0xad7fd4}),!0x0;}},go={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':'sheet.command.set-pivot-value-filter',async 'handler'(_0x2f5ed6,_0x4f71be){const _0x3886ee=_0x58c229;if(!_0x4f71be)return!0x1;const _0x1c90bc=_0x2f5ed6['get'](v[_0x3886ee(0x341)]),{pivotTableId:_0x5bb99d,fieldId:_0x5800e4,valueFilterInfo:_0x122418,unitId:_0x4369f1,subUnitId:_0x2b4dac}=_0x4f71be,_0x15dd9c=_0x2f5ed6[_0x3886ee(0x15b)](exports[_0x3886ee(0x2a4)]),_0x449222=_0x2f5ed6[_0x3886ee(0x15b)](v[_0x3886ee(0x3a2)]),_0x2c7917=(await _0x15dd9c[_0x3886ee(0x234)]({'unitId':_0x4369f1,'subUnitId':_0x2b4dac,'pivotTableId':_0x5bb99d,'params':{'type':k[_0x3886ee(0x32b)],'setValuePivotFilter':{'tableFieldId':_0x5800e4,'filterInfo':_0x122418}}}))[_0x3886ee(0x281)][_0x3886ee(0x3b6)];if(!_0x2c7917)return!0x1;const {changesets:_0x4f1c9d,pivotTableConfig:_0x5aec3e,isEmpty:_0x21ca62,view:_0x47494f}=_0x2c7917,_0x12530b=_0x5aec3e[_0x3886ee(0x18b)],_0xf60a5=new m[(_0x3886ee(0x1a0))]();_0xf60a5[_0x3886ee(0x25d)](_0x47494f);const _0x249b17={'cellInfo':_0x12530b,'view':_0xf60a5,'isEmpty':_0x21ca62};if(!await _0x2f5ed6[_0x3886ee(0x15b)](exports[_0x3886ee(0x1ce)])[_0x3886ee(0x32c)]['fetchThroughAsyncInterceptors'](re)(!0x0,_0x249b17))return!0x1;const _0x119b08=de(_0x2f5ed6,_0xf60a5,_0x12530b,_0x21ca62),_0xa3c181=fe(_0x2f5ed6,_0x249b17),{undos:_0x2e6d7c,redos:_0x3359a2}=ae(_0x1c90bc,{'pivotTableId':_0x5bb99d,'unitId':_0x4369f1,'subUnitId':_0x2b4dac},_0x4f1c9d);return v[_0x3886ee(0x13d)]([..._0x119b08['redos'],..._0xa3c181['redos'],..._0x3359a2],_0x1c90bc),_0x449222[_0x3886ee(0x2be)]({'unitID':_0x4369f1,'redoMutations':[..._0x119b08[_0x3886ee(0x1fa)],..._0xa3c181['redos'],..._0x3359a2],'undoMutations':[..._0x119b08['undos'],..._0xa3c181[_0x3886ee(0x18d)],..._0x2e6d7c]}),!0x0;}},yt={'id':_0x58c229(0x29d),'type':v[_0x58c229(0x3b4)]['MUTATION'],'handler':(_0x51ec7b,_0x4589fc)=>{const _0x32c2b9=_0x58c229;if(!_0x4589fc)return!0x1;if(!!_0x51ec7b['get'](v[_0x32c2b9(0x1ab)])[_0x32c2b9(0x17f)](q))return!0x0;const {unitId:_0x23b7c7,subUnitId:_0x3df8f,pivotTableId:_0x6bf49,tableFieldId:_0x2ef2e9,dateType:_0x2140e8}=_0x4589fc,_0x50a2e0=_0x51ec7b['get'](exports[_0x32c2b9(0x297)]),_0x49f612=_0x50a2e0[_0x32c2b9(0x1a5)](_0x6bf49);if(!_0x49f612)return!0x1;const _0x5f56fb=_0x49f612[_0x32c2b9(0x2b1)](_0x2ef2e9);if(!_0x5f56fb)return!0x1;const _0x8dad85=_0x5f56fb[_0x32c2b9(0x130)](),_0x31f150=_0x49f612[_0x32c2b9(0x304)](_0x8dad85),_0x399d91=(_0x31f150==null?void 0x0:_0x31f150[_0x32c2b9(0x173)]())+'\x20'+Xt(_0x51ec7b,_0x2140e8);_0x50a2e0[_0x32c2b9(0x2af)](_0x23b7c7,_0x6bf49)[_0x32c2b9(0x23c)](_0x5f56fb['id'],_0x399d91);const _0x35034e=_0x49f612[_0x32c2b9(0x2b8)](_0x2ef2e9);if(!_0x35034e)return!0x1;_0x49f612[_0x32c2b9(0x32a)](_0x35034e[_0x32c2b9(0x2ba)](),_0x399d91),_0x5f56fb[_0x32c2b9(0x35e)](_0x2140e8);const _0x1308e4=_0x50a2e0['getPivotTableConfig'](_0x23b7c7,_0x3df8f,_0x6bf49);return _0x50a2e0[_0x32c2b9(0x288)]({'unitId':_0x23b7c7,'subUnitId':_0x3df8f,'token':_0x6bf49,'type':j[_0x32c2b9(0x393)],'pivotConfig':_0x1308e4}),!0x0;}},ho={'id':_0x58c229(0x384),'type':v['CommandType']['COMMAND'],'handler':(_0x50affd,_0x38f9bf)=>{const _0x5b9cab=_0x58c229;if(!_0x38f9bf)return!0x1;const _0xaa16a9=_0x50affd[_0x5b9cab(0x15b)](v[_0x5b9cab(0x3a2)]),{unitId:_0x79c202,subUnitId:_0x4a09c0,pivotTableId:_0x731ad6,tableFieldId:_0x5a73bf}=_0x38f9bf,_0x3ee163=[],_0x3f5268=[],_0x3bdc33=_0x50affd[_0x5b9cab(0x15b)](exports[_0x5b9cab(0x416)]),_0x2f89bf=_0x3bdc33[_0x5b9cab(0x2af)](_0x79c202,_0x731ad6),_0x2d8753=_0x3bdc33['getPivotTableConfig'](_0x79c202,_0x4a09c0,_0x731ad6);if(!(_0x2d8753!=null&&_0x2d8753['fieldsConfig'][_0x5b9cab(0x347)]))return!0x1;const _0x1c74fb=Object[_0x5b9cab(0x199)](_0x2d8753[_0x5b9cab(0x35c)]['dimension'])[_0x5b9cab(0x308)](_0x1b633a=>_0x1b633a['id']===_0x5a73bf);if(!_0x1c74fb)return!0x1;const _0x3081d2=_0x1c74fb['dataFieldId'];if(!(_0x2f89bf!=null&&_0x2f89bf['fields']))return!0x1;const _0x7e9d3c=Object['values'](_0x2f89bf==null?void 0x0:_0x2f89bf[_0x5b9cab(0x307)])[_0x5b9cab(0x308)](_0x328d4e=>_0x328d4e['id']===_0x3081d2);if(!_0x7e9d3c)return!0x1;m['isDateGroupFieldJSON'](_0x7e9d3c)&&_0x3ee163[_0x5b9cab(0x2c5)]({'id':yt['id'],'params':{..._0x38f9bf,'dateType':_0x7e9d3c[_0x5b9cab(0x30a)]}}),_0x3f5268[_0x5b9cab(0x2c5)]({'id':yt['id'],'params':{..._0x38f9bf}});const _0xf4b6ff=_0x50affd[_0x5b9cab(0x15b)](v[_0x5b9cab(0x341)]);return v[_0x5b9cab(0x13d)](_0x3f5268,_0xf4b6ff)&&_0xaa16a9[_0x5b9cab(0x2be)]({'unitID':_0x79c202,'undoMutations':_0x3ee163,'redoMutations':_0x3f5268}),!0x0;}},po={'type':v[_0x58c229(0x3b4)]['COMMAND'],'id':_0x58c229(0x376),async 'handler'(_0x5c657e,_0x36353e){const _0x2be82f=_0x58c229;if(!_0x36353e)return!0x1;const _0xaf2386=_0x5c657e[_0x2be82f(0x15b)](v[_0x2be82f(0x341)]),_0x660a96=_0x5c657e[_0x2be82f(0x15b)](v[_0x2be82f(0x3a2)]),_0x45ddfd=_0x5c657e[_0x2be82f(0x15b)](exports[_0x2be82f(0x2a4)]),{displayName:_0x555f28,subtotalType:_0x1a365a,format:_0x568d80,tableFieldId:_0x5dd124,pivotTableId:_0x41cf7a,unitId:_0x529f46,subUnitId:_0xa21803}=_0x36353e,_0x5db5e6=(await _0x45ddfd['getPivotDisplayConfig']({'unitId':_0x529f46,'subUnitId':_0xa21803,'pivotTableId':_0x41cf7a,'params':{'type':k[_0x2be82f(0x358)],'setPivotSetting':{'tableFieldId':_0x5dd124,'displayName':_0x555f28,'subtotalType':_0x1a365a,'format':_0x568d80}}}))[_0x2be82f(0x281)][_0x2be82f(0x3c3)];if(!_0x5db5e6)return!0x1;const {changesets:_0x39a29f,view:_0x556b10,pivotTableConfig:_0x537c71,isEmpty:_0x329118}=_0x5db5e6,_0x1adf1b=_0x537c71[_0x2be82f(0x18b)],_0x9cea09=new m[(_0x2be82f(0x1a0))]();_0x9cea09[_0x2be82f(0x25d)](_0x556b10);const _0x3b5a66={'cellInfo':_0x1adf1b,'view':_0x9cea09,'isEmpty':_0x329118};if(!await _0x5c657e['get'](exports[_0x2be82f(0x1ce)])[_0x2be82f(0x32c)]['fetchThroughAsyncInterceptors'](re)(!0x0,_0x3b5a66))return!0x1;const _0x1a99d7=de(_0x5c657e,_0x9cea09,_0x1adf1b,_0x329118),_0x4bcecd=fe(_0x5c657e,_0x3b5a66),{undos:_0x128caf,redos:_0x14a410}=ae(_0xaf2386,{'pivotTableId':_0x41cf7a,'unitId':_0x529f46,'subUnitId':_0xa21803},_0x39a29f);return v['sequenceExecute']([..._0x1a99d7[_0x2be82f(0x1fa)],..._0x4bcecd[_0x2be82f(0x1fa)],..._0x14a410],_0xaf2386),_0x660a96[_0x2be82f(0x2be)]({'unitID':_0x529f46,'redoMutations':[..._0x1a99d7[_0x2be82f(0x1fa)],..._0x4bcecd[_0x2be82f(0x1fa)],..._0x14a410],'undoMutations':[..._0x1a99d7[_0x2be82f(0x18d)],..._0x4bcecd['undos'],..._0x128caf]}),!0x0;}},mt={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x2e6),'handler'(_0x422500,_0x43e090){const _0x3fc513=_0x58c229;if(!_0x43e090)return!0x1;if(!!_0x422500[_0x3fc513(0x15b)](v[_0x3fc513(0x1ab)])[_0x3fc513(0x17f)](q))return!0x0;const _0x3a1041=_0x422500[_0x3fc513(0x15b)](exports[_0x3fc513(0x297)]),{pivotTableId:_0x405bd5,deleteIds:_0x5f0004,collectionJSON:_0x351e44,dataRangeInfo:_0x181665,unitId:_0x1a5c95,subUnitId:_0x4cc0ac}=_0x43e090,_0x5f0a99=_0x3a1041[_0x3fc513(0x1a5)](_0x405bd5),_0x14f7ec=_0x3a1041[_0x3fc513(0x338)](_0x1a5c95,_0x4cc0ac,_0x405bd5);if(!_0x5f0a99||!_0x14f7ec)return!0x1;const {collection:_0xb691fd,updateDataFieldList:_0x56cef4}=_0x3a1041[_0x3fc513(0x325)](_0x405bd5,_0x351e44,_0x181665,_0x14f7ec[_0x3fc513(0x18b)]);_0x3a1041[_0x3fc513(0x3a9)](_0xb691fd,_0x56cef4,_0x181665),_0x5f0a99[_0x3fc513(0x14e)](_0xb691fd);for(const _0x8ea900 of _0x5f0004)_0x3a1041[_0x3fc513(0x40a)](_0x181665[_0x3fc513(0x204)],_0x8ea900);const _0x2fd138=_0x3a1041[_0x3fc513(0x338)](_0x1a5c95,_0x4cc0ac,_0x405bd5);return _0x2fd138['sourceRangeInfo']=JSON['parse'](JSON[_0x3fc513(0x387)](_0x181665)),_0x3a1041[_0x3fc513(0x288)]({'unitId':_0x1a5c95,'subUnitId':_0x4cc0ac,'token':_0x405bd5,'type':j['Set']}),!0x0;}},mo={'type':v[_0x58c229(0x3b4)][_0x58c229(0x2fc)],'id':_0x58c229(0x348),async 'handler'(_0x4aafae,_0x2d73a6){const _0x55dba3=_0x58c229,_0x5451e9=_0x4aafae[_0x55dba3(0x15b)](v['ICommandService']),_0x436ce6=_0x4aafae[_0x55dba3(0x15b)](exports['SheetsPivotRPCService']),_0x2134b9=_0x4aafae[_0x55dba3(0x15b)](v[_0x55dba3(0x3a2)]);if(!_0x2d73a6)return!0x1;const {token:_0x5867fe,dataRangeInfo:_0xac9f09,unitId:_0x4e323d,subUnitId:_0x566ed0}=_0x2d73a6,_0x1d75d5=[],_0x40f4a4=[],_0x5e643c=(await _0x436ce6[_0x55dba3(0x234)]({'unitId':_0x4e323d,'subUnitId':_0x566ed0,'pivotTableId':_0x5867fe,'params':{'type':k[_0x55dba3(0x1e3)],'updatePivotSource':{'dataRangeInfo':_0xac9f09,'unitId':_0x4e323d,'subUnitId':_0x566ed0}}}))[_0x55dba3(0x281)][_0x55dba3(0x1c9)];if(!_0x5e643c)return!0x1;const {changesets:_0x13b606,deleteIds:_0x56cb74,collectionConfig:_0x139ccf,oldCollectionConfig:_0x7bb056,view:_0xc46599,isEmpty:_0x50301d,pivotTableConfig:_0x1a9d13}=_0x5e643c;_0x40f4a4['push']({'id':mt['id'],'params':{'pivotTableId':_0x5867fe,'deleteIds':_0x56cb74,'collectionJSON':_0x139ccf,'dataRangeInfo':_0xac9f09,'unitId':_0x4e323d,'subUnitId':_0x566ed0}}),_0x1d75d5[_0x55dba3(0x3d6)]({'id':mt['id'],'params':{'pivotTableId':_0x5867fe,'deleteIds':[],'collectionJSON':_0x7bb056,'dataRangeInfo':_0x1a9d13['sourceRangeInfo'],'unitId':_0x4e323d,'subUnitId':_0x566ed0}});const _0xbba031=_0x1a9d13[_0x55dba3(0x18b)],_0x37d3a7=new m['PivotView']();_0x37d3a7[_0x55dba3(0x25d)](_0xc46599);const _0x57dec4={'cellInfo':_0xbba031,'view':_0x37d3a7,'isEmpty':_0x50301d};if(!await _0x4aafae['get'](exports[_0x55dba3(0x1ce)])[_0x55dba3(0x32c)][_0x55dba3(0x2ee)](re)(!0x0,_0x57dec4))return!0x1;const _0x1ece54=de(_0x4aafae,_0x37d3a7,_0xbba031,_0x50301d),_0xa3ee37=fe(_0x4aafae,_0x57dec4),{undos:_0x2d3af1,redos:_0x1a5e7b}=ae(_0x5451e9,{'pivotTableId':_0x5867fe,'unitId':_0x4e323d,'subUnitId':_0x566ed0},_0x13b606);return v[_0x55dba3(0x13d)]([..._0x1ece54['redos'],..._0xa3ee37[_0x55dba3(0x1fa)],..._0x40f4a4,..._0x2d3af1],_0x5451e9),_0x2134b9[_0x55dba3(0x2be)]({'unitID':_0x4e323d,'redoMutations':[..._0x1ece54[_0x55dba3(0x1fa)],..._0xa3ee37['redos'],..._0x40f4a4,..._0x2d3af1],'undoMutations':[..._0x1ece54[_0x55dba3(0x18d)],..._0xa3ee37[_0x55dba3(0x18d)],..._0x1d75d5,..._0x1a5e7b]}),!0x0;}},Io={'type':v['CommandType'][_0x58c229(0x2fc)],'id':_0x58c229(0x3b8),async 'handler'(_0x2219cb,_0x447672){const _0x21b4e2=_0x58c229;if(!_0x447672)return!0x1;const _0x5f2151=_0x2219cb[_0x21b4e2(0x15b)](v['ICommandService']),_0x3d23f8=_0x2219cb[_0x21b4e2(0x15b)](exports[_0x21b4e2(0x2a4)]),_0x5563ef=_0x2219cb[_0x21b4e2(0x15b)](v[_0x21b4e2(0x185)]),_0x2afa10=_0x2219cb[_0x21b4e2(0x15b)](v['IUndoRedoService']),{pivotTableId:_0x279d3b,position:_0x2c67c7,index:_0x1b4658}=_0x447672,_0x21de61=V[_0x21b4e2(0x41b)](_0x5563ef);if(!_0x21de61)return!0x1;const {unitId:_0x50324e,subUnitId:_0xd395e}=_0x21de61,_0x516d75=(await _0x3d23f8[_0x21b4e2(0x234)]({'unitId':_0x50324e,'subUnitId':_0xd395e,'pivotTableId':_0x279d3b,'params':{'type':k[_0x21b4e2(0x1dc)],'updateValuePosition':{'position':_0x2c67c7,'index':_0x1b4658}}}))['result'][_0x21b4e2(0x1c7)];if(!_0x516d75)return!0x1;const {changesets:_0x6f4865,view:_0x208933,isEmpty:_0x425ed6,pivotTableConfig:_0x5dd3ac}=_0x516d75,_0x8e24d5=_0x5dd3ac[_0x21b4e2(0x18b)],_0x3d9e9f=new m[(_0x21b4e2(0x1a0))]();_0x3d9e9f[_0x21b4e2(0x25d)](_0x208933);const _0x1e2d3f=_0x2219cb[_0x21b4e2(0x15b)](exports[_0x21b4e2(0x1ce)]),_0x158b93={'cellInfo':_0x8e24d5,'view':_0x3d9e9f,'isEmpty':_0x425ed6};if(!await _0x1e2d3f[_0x21b4e2(0x32c)]['fetchThroughAsyncInterceptors'](re)(!0x0,_0x158b93))return!0x1;const _0x5b7926=de(_0x2219cb,_0x3d9e9f,_0x8e24d5,_0x425ed6),_0x592b4b=fe(_0x2219cb,_0x158b93),{undos:_0x25ced3,redos:_0x5f3382}=ae(_0x5f2151,{'pivotTableId':_0x279d3b,'unitId':_0x50324e,'subUnitId':_0xd395e},_0x6f4865);return v[_0x21b4e2(0x13d)]([..._0x5b7926[_0x21b4e2(0x1fa)],..._0x592b4b[_0x21b4e2(0x1fa)],..._0x5f3382],_0x5f2151),_0x2afa10['pushUndoRedo']({'unitID':_0x50324e,'redoMutations':[..._0x5b7926[_0x21b4e2(0x1fa)],..._0x592b4b[_0x21b4e2(0x1fa)],..._0x5f3382],'undoMutations':[..._0x5b7926['undos'],..._0x592b4b[_0x21b4e2(0x18d)],..._0x25ced3]}),!0x0;}},He={'type':v[_0x58c229(0x3b4)][_0x58c229(0x209)],'id':_0x58c229(0x1e8),'handler'(){return!0x0;}};var Vn=Object['getOwnPropertyDescriptor'],xn=(_0xa053b,_0x594bbd,_0x23efb3,_0x199aec)=>{const _0x48d6ef=_0x58c229;for(var _0x401b82=_0x199aec>0x1?void 0x0:_0x199aec?Vn(_0x594bbd,_0x23efb3):_0x594bbd,_0x330ac5=_0xa053b[_0x48d6ef(0x3ca)]-0x1,_0x39c46f;_0x330ac5>=0x0;_0x330ac5--)(_0x39c46f=_0xa053b[_0x330ac5])&&(_0x401b82=_0x39c46f(_0x401b82)||_0x401b82);return _0x401b82;},Be=(_0x5b4779,_0x1f1156)=>(_0x256d0f,_0x31638e)=>_0x1f1156(_0x256d0f,_0x31638e,_0x5b4779);const On=()=>({'runtimeCellData':{},'dirtyRanges':{}}),An=(_0x45babb,_0x2d7175,_0xb125ef)=>{const _0x28d16f=_0x58c229,_0x36fa86=_0x45babb[_0x28d16f(0x1c8)];_0x45babb[_0x28d16f(0x3ac)](_0x246620=>{const _0x5c7d35=_0x28d16f,_0x4f8a8e=_0x246620[_0x5c7d35(0x2ba)](),_0x728e2b=_0x246620['getDataFieldId'](),_0x560c5a=_0x246620[_0x5c7d35(0x41e)](),_0x467341=_0x246620[_0x5c7d35(0x309)]();_0x2d7175[_0x728e2b]&&_0x2d7175[_0x728e2b]===_0x467341&&_0x560c5a===_0x467341&&(_0x45babb[_0x5c7d35(0x32a)](_0x4f8a8e,_0x36fa86['getDisplayName'](_0x728e2b)),_0x246620[_0x5c7d35(0x314)](_0x36fa86[_0x5c7d35(0x309)](_0x728e2b)));}),_0x45babb['iterateFieldByArea'](m[_0x28d16f(0x403)]['Value'],_0x1b80e0=>{const _0x4cda28=_0x28d16f,_0x18b1ae=_0x1b80e0[_0x4cda28(0x2ba)](),_0xe4eaaf=_0x1b80e0[_0x4cda28(0x1bc)](),_0x4088d5=_0x1b80e0['getSourceName'](),_0x589659=_0x1b80e0[_0x4cda28(0x309)](),_0x10917a=_0x1b80e0[_0x4cda28(0x19e)](),_0x8d3793=_0xb125ef(_0x4088d5,_0x10917a);_0x2d7175[_0xe4eaaf]&&_0x2d7175[_0xe4eaaf]===_0x4088d5&&_0x8d3793===_0x589659&&(_0x45babb[_0x4cda28(0x32a)](_0x18b1ae,_0xb125ef(_0x36fa86[_0x4cda28(0x309)](_0xe4eaaf),_0x10917a)),_0x1b80e0['setSourceName'](_0x36fa86[_0x4cda28(0x309)](_0xe4eaaf)));});},kn=(_0x1aada2,_0x2ead0a,_0x17915c)=>{const _0x5ab748=_0x58c229;var _0x5052f8,_0x35e0c7;const {arrayFormulaCellData:_0xb367de,unitData:_0xc32a06}=_0x2ead0a,{unitId:_0x290f72,subUnitId:_0x12e8dc}=_0x17915c,_0x3759ac=_0x17915c[_0x5ab748(0x13a)],{startColumn:_0x6632a8,endColumn:_0x3ac943}=_0x3759ac,_0x1c03fd=(_0x5052f8=_0xb367de==null?void 0x0:_0xb367de[_0x290f72])==null?void 0x0:_0x5052f8[_0x12e8dc],_0x3fc3c2=(_0x35e0c7=_0xc32a06==null?void 0x0:_0xc32a06[_0x290f72])==null?void 0x0:_0x35e0c7[_0x12e8dc],_0x51c8d1=new Set(),_0x1ee657=_0x3ac943-_0x6632a8+0x1,{dirtyRanges:_0x4f95f2}=_0x1aada2;if(_0x4f95f2)for(const {range:_0x2cb46f,sheetId:_0x32bfe4,unitId:_0x439d2c}of _0x4f95f2){if(_0x32bfe4!==_0x12e8dc||_0x290f72!==_0x439d2c)continue;const _0x435102=v[_0x5ab748(0x22f)]['getIntersects'](_0x2cb46f,_0x3759ac);if(_0x435102){const {startColumn:_0x29d7fe,endColumn:_0x3dbaf8}=_0x435102;for(let _0x541590=_0x29d7fe;_0x541590<=_0x3dbaf8;_0x541590++)_0x51c8d1[_0x5ab748(0x289)](_0x541590);}}if(_0x51c8d1[_0x5ab748(0x290)]===_0x1ee657||_0x51c8d1['size']===_0x1ee657)return Array[_0x5ab748(0x305)](_0x51c8d1);if(_0x3fc3c2){const _0x496c5a=_0x3fc3c2[_0x5ab748(0x408)](),_0x4d84bf=Object[_0x5ab748(0x284)](_0x496c5a);for(const _0xd30ea0 of _0x4d84bf){const _0x3c97d0=Number(_0xd30ea0),_0xb938bd=_0x496c5a[_0x3c97d0];if(_0x51c8d1[_0x5ab748(0x290)]===_0x1ee657)break;for(const _0x195b42 in _0xb938bd){const _0x17c6a8=Number(_0x195b42);_0x17c6a8<_0x6632a8||_0x17c6a8>_0x3ac943||_0x51c8d1['add'](_0x17c6a8);}}}if(_0x1c03fd){const _0x40b006=_0x1c03fd['getMatrix'](),_0x583ad6=Object[_0x5ab748(0x284)](_0x40b006);for(const _0x234a1e of _0x583ad6){const _0x294eb6=Number(_0x234a1e),_0x165e44=_0x40b006[_0x294eb6];if(_0x51c8d1[_0x5ab748(0x290)]===_0x1ee657)break;for(const _0x4b708d in _0x165e44){const _0x4be7ac=Number(_0x4b708d);_0x4be7ac<_0x6632a8||_0x4be7ac>_0x3ac943||_0x51c8d1[_0x5ab748(0x289)](_0x4be7ac);}}}return Array[_0x5ab748(0x305)](_0x51c8d1);},Bn=_0x5d40af=>{const _0x4f06bc=_0x58c229,_0x2bb339=new Set(),_0x3b10a2=[];for(const _0x31894c of _0x5d40af){const _0x3af00a=_0x31894c[_0x4f06bc(0x1fd)]+','+_0x31894c[_0x4f06bc(0x12d)]+','+_0x31894c[_0x4f06bc(0x1b3)]+','+_0x31894c['endColumn'];_0x2bb339[_0x4f06bc(0x38f)](_0x3af00a)||(_0x2bb339[_0x4f06bc(0x289)](_0x3af00a),_0x3b10a2['push'](_0x31894c));}return _0x3b10a2;};let Le=class extends v[_0x58c229(0x351)]{constructor(_0x498204,_0x11559f,_0x505b89,_0x11c26c,_0x167f49){const _0x1739e2=_0x58c229;super(),x(this,_0x1739e2(0x329),new ge[(_0x1739e2(0x16a))](!0x0)),x(this,_0x1739e2(0x31a),_0x340a8b=>{const _0x175159=_0x1739e2;this[_0x175159(0x329)]['next'](!0x1);}),x(this,_0x1739e2(0x213),_0x3054b5=>{const _0x426d23=_0x1739e2;this[_0x426d23(0x329)]['next'](!0x0);}),(this[_0x1739e2(0x3b3)]=_0x498204,this[_0x1739e2(0x365)]=_0x11559f,this['_commandService']=_0x505b89,this['_globalComputingSrv']=_0x11c26c,this[_0x1739e2(0x20c)]=_0x167f49,this[_0x1739e2(0x38a)](),this[_0x1739e2(0x25f)]());}[_0x58c229(0x38a)](){const _0x4997f3=_0x58c229;this['_subjectCollectionChange'](),this['_subjectViewChange'](),this[_0x4997f3(0x334)](),this['_subjectFieldsCollectionChange']();}[_0x58c229(0x220)](){const _0x436dbb=_0x58c229;this[_0x436dbb(0x21e)][_0x436dbb(0x270)](this['_globalSubject']),m[_0x436dbb(0x3e9)][_0x436dbb(0x2eb)](m['PivotCallbackEnum'][_0x436dbb(0x134)],this[_0x436dbb(0x31a)]),m[_0x436dbb(0x3e9)][_0x436dbb(0x2eb)](m[_0x436dbb(0x1e0)][_0x436dbb(0x379)],this[_0x436dbb(0x213)]);}[_0x58c229(0x25f)](){const _0x1bd0ff=_0x58c229;this[_0x1bd0ff(0x17a)](this['_commandService'][_0x1bd0ff(0x267)](_0xee78ef=>{const _0x5b82c7=_0x1bd0ff;_0xee78ef['id']===V[_0x5b82c7(0x3d4)]['id']&&this['_sheetsPivotDataSourceModel']['handleMoveRange'](_0xee78ef['params']);})),this[_0x1bd0ff(0x17a)](this[_0x1bd0ff(0x37b)][_0x1bd0ff(0x267)](_0x8d129b=>{const _0x3ae8cf=_0x1bd0ff;if(_0x8d129b['id']!==Ft['id'])return;const _0x24e6f8=_0x8d129b[_0x3ae8cf(0x192)],{unitId:_0x243e4c,subUnitId:_0x38e641,pivotTableId:_0x4b3481}=_0x24e6f8,_0x2c4e50=_0x24e6f8[_0x3ae8cf(0x192)]['type'],_0x171099={};switch(_0x2c4e50){case k[_0x3ae8cf(0x3c0)]:{const _0x34ccde=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x1d0)];if(!_0x34ccde)return;const {row:_0x52a359,col:_0x4ee70e,cellData:_0x909ff8,pivotItemRenderInfoCache:_0x34c3fa,tableFieldId:_0x541efb}=_0x34ccde,_0x585d3b=this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x1a5)](_0x24e6f8['pivotTableId']);if(!_0x585d3b||!_0x34c3fa)return;if(_0x541efb){const _0x4834e7=_0x585d3b[_0x3ae8cf(0x2b1)](_0x541efb);if(!_0x4834e7)return;_0x171099[_0x3ae8cf(0x1d0)]={..._0x585d3b[_0x3ae8cf(0x3f4)](_0x4834e7),'tableFieldId':_0x541efb,'pivotTableId':_0x24e6f8['pivotTableId'],'filterInfo':_0x585d3b[_0x3ae8cf(0x2d2)](_0x541efb),'sortInfo':_0x585d3b['getSortInfo'](_0x541efb),'format':_0x585d3b['getFieldFormat'](_0x541efb)};}else{const _0x20227f=Yt(_0x52a359,_0x4ee70e,_0x909ff8,_0x585d3b,_0x34c3fa),_0x3caf84=_0x20227f==null?void 0x0:_0x20227f[_0x3ae8cf(0x18f)];if(!_0x3caf84)return;const _0x138ebd=_0x585d3b[_0x3ae8cf(0x2b1)](_0x3caf84);if(!_0x138ebd)return;_0x171099[_0x3ae8cf(0x1d0)]={..._0x585d3b[_0x3ae8cf(0x3f4)](_0x138ebd),'tableFieldId':_0x3caf84,'pivotTableId':_0x24e6f8['pivotTableId'],'filterInfo':_0x585d3b[_0x3ae8cf(0x2d2)](_0x3caf84),'sortInfo':_0x585d3b[_0x3ae8cf(0x26d)](_0x3caf84),'format':_0x585d3b[_0x3ae8cf(0x310)](_0x3caf84)};}}break;case k['Panel']:{const _0x301281=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x227)];if(!_0x301281)return;const {pivotTableId:_0xe8941e}=_0x301281,_0x1c15a0=this['_sheetsPivotDataSourceModel']['getPivotTableInstance'](_0xe8941e);if(!_0x1c15a0)return;const _0x57afec=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0xe8941e),_0x3a8fbf=Qt(_0x1c15a0,_0xe8941e,_0x57afec);_0x171099[_0x3ae8cf(0x227)]=_0x3a8fbf;}break;case k[_0x3ae8cf(0x363)]:{const _0x318edf=this[_0x3ae8cf(0x3b3)]['getPivotTableInstance'](_0x4b3481),_0x1315ec=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x34d)](_0x243e4c),_0x403b60=_0x1315ec[_0x3ae8cf(0x2af)](_0x4b3481);let _0x521bd1=null;const _0x4b83b9=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481),_0x54517f=_0x24e6f8['params'][_0x3ae8cf(0x259)];if(!_0x318edf||!_0x4b83b9||!_0x54517f)return!0x1;const {dataFieldId:_0x5bb10e,fieldArea:_0x1b8d85,index:_0x21e43f}=_0x54517f;_0x318edf[_0x3ae8cf(0x37a)]();const _0x4ab180=_0x318edf[_0x3ae8cf(0x335)](_0x5bb10e,_0x1b8d85,_0x21e43f);if(_0x4ab180&&_0x1b8d85===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x187)]){const _0x3b1abf=_0x4ab180[_0x3ae8cf(0x2ba)](),_0x31a253=_0x318edf['getDataFieldByTableId'](_0x3b1abf);if(_0x31a253){const _0x4145d0=_0x31a253==null?void 0x0:_0x31a253['getFieldDataType']();_0x318edf['setSubtotalType'](_0x4ab180[_0x3ae8cf(0x2ba)](),_0x4145d0===m[_0x3ae8cf(0x1ff)][_0x3ae8cf(0x38d)]?m[_0x3ae8cf(0x1ad)][_0x3ae8cf(0x1d2)]:m[_0x3ae8cf(0x1ad)][_0x3ae8cf(0x374)]);}const _0x329e07=_0x318edf[_0x3ae8cf(0x386)](),_0x895800=_0x318edf['getValuePosition'](),_0x1cd7b6=_0x318edf[_0x3ae8cf(0x3e6)](m[_0x3ae8cf(0x403)][_0x3ae8cf(0x187)]);if(_0x329e07===-0x1&&_0x1cd7b6>0x1){const _0x182dd4=_0x895800===m['PivotTableValuePositionEnum'][_0x3ae8cf(0x3de)]?m[_0x3ae8cf(0x146)][_0x3ae8cf(0x2df)]:_0x895800,_0x3698d5=_0x182dd4===m[_0x3ae8cf(0x146)][_0x3ae8cf(0x388)]?m[_0x3ae8cf(0x403)]['Row']:m[_0x3ae8cf(0x403)][_0x3ae8cf(0x2df)];_0x318edf[_0x3ae8cf(0x1c7)](_0x182dd4,_0x318edf['getFieldCountByArea'](_0x3698d5));}}else{if(_0x4ab180&&(_0x1b8d85===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x388)]||_0x1b8d85===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x2df)])){const _0x3b8863=_0x4ab180['getId'](),_0x26e1de=_0x318edf[_0x3ae8cf(0x2b1)](_0x3b8863);if(_0x26e1de&&(_0x26e1de==null?void 0x0:_0x26e1de[_0x3ae8cf(0x27a)]())===m['PivotDataFieldDataTypeEnum']['date']){const _0x3cb117=_0x26e1de[_0x3ae8cf(0x179)]();if(_0x3cb117&&_0x318edf[_0x3ae8cf(0x2f5)](_0x4ab180[_0x3ae8cf(0x2ba)](),_0x3cb117),!_0x403b60[_0x3ae8cf(0x29c)]()[_0x3ae8cf(0x160)](_0xa9674a=>{const _0x5cc52b=_0x3ae8cf,_0x29cd66=_0x403b60['getFieldById'](_0xa9674a);return m[_0x5cc52b(0x1d6)](_0x29cd66)?_0x29cd66[_0x5cc52b(0x14a)]()[_0x5cc52b(0x20b)]===_0x5bb10e:!0x1;})){const _0x7309e1=_0x1315ec[_0x3ae8cf(0x175)](),_0x141d28=vn(_0x26e1de['maxDate'],_0x26e1de[_0x3ae8cf(0x240)]),_0x4e920e=_0x26e1de[_0x3ae8cf(0x173)]()+_0x3ae8cf(0x413)+Xt(this['_injector'],_0x141d28),_0x4ccf12=new m[(_0x3ae8cf(0x26c))](_0x7309e1,_0x4e920e,m['generateHexNumber'](0x3),_0x26e1de[_0x3ae8cf(0x2ba)](),_0x141d28);_0x1315ec[_0x3ae8cf(0x260)](_0x4ccf12),_0x403b60[_0x3ae8cf(0x3e1)](_0x7309e1,_0x4e920e),_0x318edf[_0x3ae8cf(0x335)](_0x7309e1,_0x1b8d85,(_0x21e43f!=null?_0x21e43f:0x0)+0x1),_0x521bd1=_0x4ccf12;}}}}const _0x1d1cd6=_0x318edf['isEmpty'](),_0x513101=_0x318edf[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)]();let _0x21a814;if(_0x521bd1){_0x21a814=_0x521bd1[_0x3ae8cf(0x128)]();const _0x4be2a4=_0x521bd1[_0x3ae8cf(0x2ba)]();_0x403b60[_0x3ae8cf(0x26f)](_0x4be2a4);let _0x2a0323=!0x0;for(const _0x26d9af in _0x1315ec[_0x3ae8cf(0x255)])if(_0x1315ec[_0x3ae8cf(0x255)][_0x26d9af]['getFieldIds']()['includes'](_0x4be2a4)){_0x2a0323=!0x1;break;}_0x2a0323&&_0x1315ec[_0x3ae8cf(0x26e)](_0x4be2a4);}const _0x34ece6=_0x318edf[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x259)]={'view':_0x513101,'changesets':_0x34ece6,'isEmpty':_0x1d1cd6,'pivotTableConfig':_0x4b83b9,'shouldBeAddedGroupJSON':_0x21a814};}break;case k[_0x3ae8cf(0x3b9)]:{const _0x103b65=_0x24e6f8['params']['addPivotTable'];if(!_0x103b65)return;const _0x4088a1=_0x103b65[_0x3ae8cf(0x141)],_0x10b4b2=_0x103b65[_0x3ae8cf(0x40c)],{collection:_0x3251ff}=this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x1c5)]({'unitId':_0x4088a1[_0x3ae8cf(0x204)],'sheetName':_0x4088a1[_0x3ae8cf(0x25c)],'subUnitId':_0x4088a1[_0x3ae8cf(0x2f1)],'range':_0x4088a1[_0x3ae8cf(0x13a)]}),_0x5a49e1=new m[(_0x3ae8cf(0x3e9))](_0x3251ff,void 0x0,_0x10b4b2),_0xa0f23=_0x5a49e1[_0x3ae8cf(0x25e)](),_0x44adbd=_0x5a49e1[_0x3ae8cf(0x128)](),_0xc020b1=_0x3251ff[_0x3ae8cf(0x128)]();_0x171099['addPivotTable']={'view':_0xa0f23,'fieldsConfig':_0x44adbd,'collectionConfig':_0xc020b1,'isEmpty':_0x5a49e1[_0x3ae8cf(0x301)]()};}break;case k[_0x3ae8cf(0x3d8)]:{const _0x5238aa=_0x24e6f8['params']['movePivotField'];if(!_0x5238aa)return;const {fieldId:_0x386958,area:_0x3e8923,index:_0x4a5e2c}=_0x5238aa,_0xaa809e=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0xaa809e)return;const _0x2e77a4=this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x1a5)](_0x4b3481);if(!_0x2e77a4)return;_0x2e77a4[_0x3ae8cf(0x37a)]();const {area:_0x113f09,index:_0x4f59ec}=_0x2e77a4[_0x3ae8cf(0x39b)](_0x386958);if(_0x2e77a4[_0x3ae8cf(0x214)](_0x386958,_0x3e8923,_0x4a5e2c),_0x3e8923===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x187)]&&_0x2e77a4[_0x3ae8cf(0x2b8)](_0x386958)[_0x3ae8cf(0x19e)]()===void 0x0){const _0x575ede=_0x2e77a4[_0x3ae8cf(0x2b8)](_0x386958);if(_0x575ede&&_0x575ede[_0x3ae8cf(0x19e)]()===void 0x0){const _0x4bd81e=_0x2e77a4['getDataFieldByTableId'](_0x386958);if(_0x4bd81e){const _0x2e997d=_0x4bd81e==null?void 0x0:_0x4bd81e[_0x3ae8cf(0x27a)]();_0x2e77a4[_0x3ae8cf(0x22d)](_0x386958,_0x2e997d===m[_0x3ae8cf(0x1ff)]['number']?m['PivotSubtotalTypeEnum'][_0x3ae8cf(0x1d2)]:m[_0x3ae8cf(0x1ad)][_0x3ae8cf(0x374)]);}}}const _0x5dfde8=_0x2e77a4[_0x3ae8cf(0x171)](),_0x4eb410=_0x2e77a4[_0x3ae8cf(0x386)](),_0x39e356=_0x2e77a4[_0x3ae8cf(0x3e6)](m['PivotTableFiledAreaEnum'][_0x3ae8cf(0x187)])>0x1;if(_0x39e356&&_0x113f09===_0x3e8923&&(_0x3e8923===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x388)]&&_0x5dfde8===m['PivotTableValuePositionEnum'][_0x3ae8cf(0x388)]||_0x3e8923===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x2df)]&&_0x5dfde8===m[_0x3ae8cf(0x146)]['Column'])){let _0x28cfbc=_0x4eb410;_0x4f59ec<=_0x4eb410&&_0x28cfbc--,_0x4a5e2c<=_0x4eb410&&_0x28cfbc++,_0x2e77a4[_0x3ae8cf(0x1c7)](_0x5dfde8,_0x28cfbc);}else _0x39e356&&(_0x113f09===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x388)]&&_0x5dfde8===m['PivotTableValuePositionEnum']['Row']||_0x113f09===m['PivotTableFiledAreaEnum']['Column']&&_0x5dfde8===m[_0x3ae8cf(0x146)][_0x3ae8cf(0x2df)])&&_0x4eb410>=_0x4f59ec&&_0x2e77a4['updateValuePosition'](_0x5dfde8,_0x4eb410-0x1),_0x39e356&&(_0x3e8923===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x388)]&&_0x5dfde8===m[_0x3ae8cf(0x146)][_0x3ae8cf(0x388)]||_0x3e8923===m['PivotTableFiledAreaEnum'][_0x3ae8cf(0x2df)]&&_0x5dfde8===m['PivotTableValuePositionEnum'][_0x3ae8cf(0x2df)])&&_0x4eb410>=_0x4a5e2c&&_0x2e77a4[_0x3ae8cf(0x1c7)](_0x5dfde8,_0x4eb410+0x1);const _0x178d1f=_0x2e77a4[_0x3ae8cf(0x25e)](),_0x559a1f=_0x2e77a4[_0x3ae8cf(0x301)](),_0x5d0ef5=_0x2e77a4[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x2c4)]={'view':_0x178d1f[_0x3ae8cf(0x128)](),'changesets':_0x5d0ef5,'isEmpty':_0x559a1f,'pivotTableConfig':_0xaa809e};}break;case k[_0x3ae8cf(0x206)]:{const _0x40e79d=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x3fa)];if(!_0x40e79d)return;const _0x2f9528=_0x40e79d[_0x3ae8cf(0x126)],_0x4022aa=this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x4022aa)return!0x1;const _0x4b7fec=this[_0x3ae8cf(0x3b3)]['getPivotTableInstance'](_0x4b3481);if(!_0x4b7fec)return!0x1;_0x4b7fec[_0x3ae8cf(0x37a)]();for(const _0x7fbd36 of _0x2f9528){const {area:_0xe5d7d0}=_0x4b7fec[_0x3ae8cf(0x39b)](_0x7fbd36);_0xe5d7d0===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x187)]&&_0x4b7fec[_0x3ae8cf(0x168)](_0x7fbd36),(_0xe5d7d0===m[_0x3ae8cf(0x403)][_0x3ae8cf(0x388)]||_0xe5d7d0===m['PivotTableFiledAreaEnum'][_0x3ae8cf(0x2df)])&&_0x4b7fec['removeValueFilterInfo'](_0x7fbd36),_0x4b7fec[_0x3ae8cf(0x3d5)](_0x7fbd36);}const _0x359bbb=_0x4b7fec[_0x3ae8cf(0x301)](),_0x20659a=_0x4b7fec[_0x3ae8cf(0x25e)]()['toJSON'](),_0x3e6091=_0x4b7fec[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x3fa)]={'changesets':_0x3e6091,'pivotTableConfig':_0x4022aa,'isEmpty':_0x359bbb,'view':_0x20659a};}break;case k[_0x3ae8cf(0x395)]:{const _0x39fb14=_0x24e6f8['params'][_0x3ae8cf(0x163)];if(!_0x39fb14)return;const {tableFieldId:_0x51038a,items:_0x58a115,isAll:_0xaae57e}=_0x39fb14,_0x10f993=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1a5)](_0x4b3481),_0x3a3bff=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x10f993||!_0x3a3bff)return;_0x10f993['startCollectChangeset'](),_0x10f993[_0x3ae8cf(0x36c)](_0x51038a,{'type':m['PivotFilterTypeEnum']['ManualFilter'],'list':_0x58a115,'isAll':_0xaae57e});const _0x3ba276=_0x10f993[_0x3ae8cf(0x301)](),_0x2a037f=_0x10f993[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0xb804f5=_0x10f993['endCollectChangeset']();_0x171099[_0x3ae8cf(0x163)]={'view':_0x2a037f,'changesets':_0xb804f5,'isEmpty':_0x3ba276,'pivotTableConfig':_0x3a3bff};}break;case k['SetValuePivotFilter']:{const _0x48bd24=_0x24e6f8['params'][_0x3ae8cf(0x3b6)];if(!_0x48bd24)return;const {tableFieldId:_0x1320e8,filterInfo:_0x3663df}=_0x48bd24,_0x55b3ed=this[_0x3ae8cf(0x3b3)]['getPivotTableInstance'](_0x4b3481),_0x1e05ab=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x55b3ed||!_0x1e05ab)return;_0x55b3ed['startCollectChangeset'](),_0x55b3ed[_0x3ae8cf(0x150)](_0x1320e8,_0x3663df);const _0x14306c=_0x55b3ed[_0x3ae8cf(0x301)](),_0x1d7a3f=_0x55b3ed[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0x5cce4b=_0x55b3ed[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x3b6)]={'view':_0x1d7a3f,'changesets':_0x5cce4b,'isEmpty':_0x14306c,'pivotTableConfig':_0x1e05ab};}break;case k[_0x3ae8cf(0x250)]:{const _0x44f003=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x156)];if(!_0x44f003)return;const {tableFieldId:_0x1dfa17,info:_0x311cd4}=_0x44f003,_0x3f44de=this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x1a5)](_0x4b3481),_0x22b165=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x3f44de||!_0x22b165)return;_0x3f44de[_0x3ae8cf(0x37a)](),_0x3f44de[_0x3ae8cf(0x247)](_0x1dfa17,_0x311cd4);const _0x238bf2=_0x3f44de[_0x3ae8cf(0x301)](),_0x310ec9=_0x3f44de[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0xdb815a=_0x3f44de[_0x3ae8cf(0x1b0)]();_0x171099['setPivotSort']={'view':_0x310ec9,'changesets':_0xdb815a,'isEmpty':_0x238bf2,'pivotTableConfig':_0x22b165};}break;case k[_0x3ae8cf(0x358)]:{const _0x33b8a2=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x3c3)];if(!_0x33b8a2)return;const {tableFieldId:_0x805264,displayName:_0x172ab3,subtotalType:_0x25b6a1,format:_0x4ba0f4}=_0x33b8a2,_0x4895c6=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1a5)](_0x4b3481),_0x42e93f=this['_sheetsPivotDataSourceModel']['getPivotTableConfig'](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x4895c6||!_0x42e93f)return;_0x4895c6[_0x3ae8cf(0x37a)](),_0x172ab3!==void 0x0&&_0x4895c6[_0x3ae8cf(0x32a)](_0x805264,_0x172ab3),_0x25b6a1!==void 0x0&&_0x4895c6[_0x3ae8cf(0x22d)](_0x805264,_0x25b6a1),_0x4ba0f4!==void 0x0&&_0x4895c6['setFieldFormat'](_0x805264,_0x4ba0f4);const _0x45bef0=_0x4895c6[_0x3ae8cf(0x301)](),_0x2aaa84=_0x4895c6['query']()[_0x3ae8cf(0x128)](),_0x2049e2=_0x4895c6[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x3c3)]={'changesets':_0x2049e2,'pivotTableConfig':_0x42e93f,'isEmpty':_0x45bef0,'view':_0x2aaa84};}break;case k['UpdatePivotSource']:{const _0x5af354=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x1c9)];if(!_0x5af354)return;const {dataRangeInfo:_0x5b4138,unitId:_0x4b4c77,subUnitId:_0x5e2e15}=_0x5af354,_0x5eef40=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x4b4c77,_0x5e2e15,_0x4b3481),_0x24eaa5=this['_sheetsPivotDataSourceModel']['getPivotTableInstance'](_0x4b3481);if(!this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x2af)](_0x4b4c77,_0x4b3481)||!_0x24eaa5||!_0x5eef40)return;const _0x4d8d72=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1c2)](_0x4b4c77,_0x4b3481,_0x5b4138),_0x1eceef=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x2af)](_0x4b4c77,_0x4b3481)[_0x3ae8cf(0x128)](),{collection:_0x8cfc28}=this[_0x3ae8cf(0x3b3)]['createCollectionWithDataRange']({'unitId':_0x5b4138[_0x3ae8cf(0x204)],'sheetName':_0x5b4138[_0x3ae8cf(0x25c)],'subUnitId':_0x5b4138['subUnitId'],'range':_0x5b4138[_0x3ae8cf(0x13a)]}),_0x41e767=_0x8cfc28[_0x3ae8cf(0x128)]();_0x24eaa5[_0x3ae8cf(0x37a)]();const _0x308c98=this['_sheetsPivotDataSourceModel'][_0x3ae8cf(0x34d)](_0x4b4c77)['getAutoDisplayNameFunction']()||m[_0x3ae8cf(0x1e5)];_0x24eaa5[_0x3ae8cf(0x2ab)](_0x40e422=>{const _0x102639=_0x3ae8cf,_0x5c1430=_0x40e422[_0x102639(0x1bc)]();if(!_0x8cfc28[_0x102639(0x208)](_0x5c1430)){const _0x159901=_0x8cfc28['getDataFieldBySourceName'](_0x40e422[_0x102639(0x41e)]());if(_0x159901){_0x24eaa5['updateFieldSourceInfo'](_0x40e422['getId'](),_0x159901['getName'](),_0x159901[_0x102639(0x2ba)]());const {area:_0x6203be}=_0x24eaa5[_0x102639(0x39b)](_0x40e422[_0x102639(0x2ba)]());let _0x1744f4=_0x40e422[_0x102639(0x41e)]();const _0x4903af=_0x40e422[_0x102639(0x309)]();if(_0x6203be===m['PivotTableFiledAreaEnum']['Value']){const _0x11de49=_0x40e422[_0x102639(0x19e)]();_0x1744f4=_0x308c98(_0x159901[_0x102639(0x173)](),_0x11de49);}_0x4903af!==_0x1744f4&&_0x24eaa5[_0x102639(0x32a)](_0x40e422[_0x102639(0x2ba)](),_0x1744f4);}else _0x24eaa5[_0x102639(0x3d5)](_0x40e422[_0x102639(0x2ba)]());}});const _0xc52414=_0x24eaa5[_0x3ae8cf(0x301)](),_0x26ae69=_0x24eaa5[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0x2e8594=_0x24eaa5[_0x3ae8cf(0x1b0)]();_0x171099['updatePivotSource']={'view':_0x26ae69,'changesets':_0x2e8594,'isEmpty':_0xc52414,'pivotTableConfig':_0x5eef40,'collectionConfig':_0x41e767,'oldCollectionConfig':_0x1eceef,'deleteIds':_0x4d8d72};}break;case k['UpdateValuePosition']:{const _0x1b2f22=_0x24e6f8['params'][_0x3ae8cf(0x1c7)];if(!_0x1b2f22)return;const {position:_0x13299f,index:_0x535194}=_0x1b2f22,_0x1d1c07=this[_0x3ae8cf(0x3b3)]['getPivotTableConfig'](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x1d1c07)return!0x1;const _0x3d073f=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1a5)](_0x4b3481);if(!_0x3d073f)return!0x1;_0x3d073f[_0x3ae8cf(0x37a)](),_0x3d073f[_0x3ae8cf(0x1c7)](_0x13299f,_0x535194);const _0x4bd6f4=_0x3d073f['isEmpty'](),_0x3714d0=_0x3d073f[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0x262472=_0x3d073f[_0x3ae8cf(0x1b0)]();_0x171099['updateValuePosition']={'changesets':_0x262472,'pivotTableConfig':_0x1d1c07,'isEmpty':_0x4bd6f4,'view':_0x3714d0};}break;case k[_0x3ae8cf(0x27e)]:{const _0x35631a=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x147)];if(!_0x35631a)return;const {tableFieldId:_0x297c9d,collapse:_0x25914a,item:_0xe09c85}=_0x35631a,_0x123553=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1a5)](_0x4b3481),_0x4520db=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x123553||!_0x4520db)return;_0x123553[_0x3ae8cf(0x37a)](),_0x123553[_0x3ae8cf(0x19b)](_0x297c9d,_0x25914a,_0xe09c85);const _0x557786=_0x123553[_0x3ae8cf(0x301)](),_0x5e9b99=_0x123553[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0x4d5c2f=_0x123553[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x147)]={'view':_0x5e9b99,'isEmpty':_0x557786,'pivotTableConfig':_0x4520db,'changesets':_0x4d5c2f};}break;case k[_0x3ae8cf(0x205)]:{const _0x1e1649=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x2f7)];if(!_0x1e1649)return;const {pivotTableConfig:_0x59af8f}=_0x1e1649,_0x3c6814=this[_0x3ae8cf(0x3b3)]['getPivotTableInstance'](_0x4b3481),_0x43b95e=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x3c6814||!_0x43b95e)return;_0x3c6814['startCollectChangeset'](),un(_0x3c6814,_0x59af8f);const _0x410a0f=_0x3c6814[_0x3ae8cf(0x301)](),_0x33272e=_0x3c6814[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0x24971e=_0x3c6814['endCollectChangeset']();_0x171099[_0x3ae8cf(0x2f7)]={'view':_0x33272e,'isEmpty':_0x410a0f,'pivotTableConfig':{..._0x43b95e,'fieldsConfig':_0x3c6814[_0x3ae8cf(0x128)]()},'changesets':_0x24971e};}break;case k[_0x3ae8cf(0x38c)]:{const _0x399ac9=_0x24e6f8['params'][_0x3ae8cf(0x1ed)];if(!_0x399ac9)return;const _0x49153c=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1a5)](_0x4b3481),_0x4db3a4=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x338)](_0x243e4c,_0x38e641,_0x4b3481);if(!_0x49153c||!_0x4db3a4)return;_0x49153c['startCollectChangeset'](),fn(_0x49153c,_0x399ac9[_0x3ae8cf(0x28a)]);const _0xe51728=_0x49153c[_0x3ae8cf(0x25e)]()[_0x3ae8cf(0x128)](),_0x1503fe=_0x49153c[_0x3ae8cf(0x1b0)]();_0x171099[_0x3ae8cf(0x1ed)]={'view':_0xe51728,'isEmpty':!0x0,'pivotTableConfig':{..._0x4db3a4,'fieldsConfig':_0x49153c[_0x3ae8cf(0x128)]()},'changesets':_0x1503fe};}break;case k[_0x3ae8cf(0x1bf)]:{const _0x540260=_0x24e6f8[_0x3ae8cf(0x192)][_0x3ae8cf(0x181)];if(!_0x540260)return;const _0x38f994=_0x540260[_0x3ae8cf(0x141)],_0xded0b2=_0x540260[_0x3ae8cf(0x40c)],{collection:_0xdf73b3}=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x1c5)]({'unitId':_0x38f994['unitId'],'sheetName':_0x38f994[_0x3ae8cf(0x25c)],'subUnitId':_0x38f994[_0x3ae8cf(0x2f1)],'range':_0x38f994['range']}),_0x29dae7=new m[(_0x3ae8cf(0x3e9))](_0xdf73b3,void 0x0,_0xded0b2),_0x4ac393=_0xdf73b3[_0x3ae8cf(0x29c)](),{rows:_0x3040e2,columns:_0x2d0329,filters:_0x2651cf,values:_0x42e597}=_0x540260[_0x3ae8cf(0x313)];_0x29dae7[_0x3ae8cf(0x37a)]();for(const {field:_0x47dfb0,selectedItems:_0x51635b}of _0x3040e2||[]){const _0xe48ded=_0x4ac393[_0x47dfb0];if(_0xe48ded){const _0x1be382=_0x29dae7[_0x3ae8cf(0x335)](_0xe48ded,m[_0x3ae8cf(0x403)][_0x3ae8cf(0x388)]);_0x51635b&&_0x1be382&&_0x29dae7[_0x3ae8cf(0x36c)](_0x1be382[_0x3ae8cf(0x2ba)](),{'type':m['PivotFilterTypeEnum'][_0x3ae8cf(0x1b1)],'list':_0x51635b,'isAll':!0x1});}}for(const {field:_0x559eb3,selectedItems:_0x179db3}of _0x2d0329||[]){const _0x434694=_0x4ac393[_0x559eb3];if(_0x434694){const _0x2bef7e=_0x29dae7[_0x3ae8cf(0x335)](_0x434694,m['PivotTableFiledAreaEnum'][_0x3ae8cf(0x2df)]);_0x179db3&&_0x2bef7e&&_0x29dae7[_0x3ae8cf(0x36c)](_0x2bef7e[_0x3ae8cf(0x2ba)](),{'type':m[_0x3ae8cf(0x10d)][_0x3ae8cf(0x1b1)],'list':_0x179db3,'isAll':!0x1});}}for(const {field:_0x572f99,selectedItems:_0x9ad041}of _0x2651cf||[]){const _0x161151=_0x4ac393[_0x572f99];if(_0x161151){const _0x443cfb=_0x29dae7[_0x3ae8cf(0x335)](_0x161151,m[_0x3ae8cf(0x403)][_0x3ae8cf(0x3c0)]);_0x9ad041&&_0x443cfb&&_0x29dae7[_0x3ae8cf(0x36c)](_0x443cfb[_0x3ae8cf(0x2ba)](),{'type':m[_0x3ae8cf(0x10d)][_0x3ae8cf(0x1b1)],'list':_0x9ad041,'isAll':!0x1});}}for(const {field:_0x1cd07e,subTotalType:_0x2b3105,formatString:_0x4391cf}of _0x42e597||[]){const _0x3524b0=_0xdf73b3[_0x3ae8cf(0x356)](_0x4ac393[_0x1cd07e]);if(!_0x3524b0)continue;const _0xb49d01=_0x4ac393[_0x1cd07e];if(_0xb49d01){const _0x2a9128=_0x29dae7[_0x3ae8cf(0x335)](_0xb49d01,m[_0x3ae8cf(0x403)][_0x3ae8cf(0x187)]);if(_0x2a9128){if(_0x2b3105!==void 0x0){_0x29dae7['setSubtotalType'](_0x2a9128['getId'](),_0x2b3105);const _0x16f864=this[_0x3ae8cf(0x3b3)][_0x3ae8cf(0x34d)](_0x38f994[_0x3ae8cf(0x204)])[_0x3ae8cf(0x34c)]()||m[_0x3ae8cf(0x1e5)],_0x5b9896=_0xdf73b3[_0x3ae8cf(0x309)](_0xb49d01),_0x4dbc12=_0x16f864(_0x5b9896,_0x2b3105);_0x29dae7['renameField'](_0x2a9128[_0x3ae8cf(0x2ba)](),_0x4dbc12);}else{if(_0x3524b0){const _0x4d163a=_0x3524b0==null?void 0x0:_0x3524b0['getFieldDataType']();_0x29dae7[_0x3ae8cf(0x22d)](_0x2a9128[_0x3ae8cf(0x2ba)](),_0x4d163a===m[_0x3ae8cf(0x1ff)][_0x3ae8cf(0x38d)]?m[_0x3ae8cf(0x1ad)][_0x3ae8cf(0x1d2)]:m['PivotSubtotalTypeEnum'][_0x3ae8cf(0x374)]);}}_0x4391cf&&_0x29dae7[_0x3ae8cf(0x2f5)](_0x2a9128['getId'](),_0x4391cf);}}}const _0x5b1b89=_0x29dae7['query'](),_0x30339f=_0x29dae7[_0x3ae8cf(0x128)](),_0x9979c=_0x29dae7[_0x3ae8cf(0x301)](),_0x3441a4=_0x29dae7[_0x3ae8cf(0x1b0)](),_0x47f41e=_0xdf73b3[_0x3ae8cf(0x128)]();_0x171099[_0x3ae8cf(0x181)]={'view':_0x5b1b89,'fieldsConfig':_0x30339f,'collectionConfig':_0x47f41e,'isEmpty':_0x9979c,'changesets':_0x3441a4};}break;case k[_0x3ae8cf(0x1b7)]:{const _0x33483c=sn(this[_0x3ae8cf(0x20c)],_0x24e6f8);if(!_0x33483c)return;const {range:_0x28a484,sourceSubUnitId:_0x22c5a3,sourceUnitId:_0x2c2bd3,formatMap:_0x1ea2dd,indexes:_0x349b6b}=_0x33483c;_0x171099[_0x3ae8cf(0x350)]={'range':_0x28a484,'sourceSubUnitId':_0x22c5a3,'sourceUnitId':_0x2c2bd3,'formatMap':_0x1ea2dd,'indexes':_0x349b6b};}break;}this[_0x3ae8cf(0x37b)][_0x3ae8cf(0x3aa)](Rt['id'],{'version':_0x24e6f8[_0x3ae8cf(0x224)],'result':_0x171099},{'onlyLocal':!0x0});}));}[_0x58c229(0x334)](){const _0x59c1c5=_0x58c229;this[_0x59c1c5(0x17a)](this[_0x59c1c5(0x37b)][_0x59c1c5(0x267)](_0x324bfd=>{const _0xf249b5=_0x59c1c5;if(_0x324bfd['id']!==_t['id'])return;const _0x491210=_0x324bfd[_0xf249b5(0x192)];return this[_0xf249b5(0x3b3)]['setTextInfo'](_0x491210[_0xf249b5(0x3e8)]),!0x0;}));}[_0x58c229(0x272)](){const _0x3f06a0=_0x58c229;this[_0x3f06a0(0x3b3)][_0x3f06a0(0x418)][_0x3f06a0(0x1c3)](_0x17aa8a=>{const _0x2405a0=_0x3f06a0;switch(_0x17aa8a['type']){case Pe[_0x2405a0(0x289)]:_0x17aa8a[_0x2405a0(0x139)]&&_0x17aa8a[_0x2405a0(0x18b)]&&this['handleSourceRangeChange'](_0x17aa8a[_0x2405a0(0x216)],_0x17aa8a[_0x2405a0(0x139)],_0x17aa8a[_0x2405a0(0x18b)]);break;case Pe[_0x2405a0(0x3f7)]:{const {unitId:_0x3a33da,subUnitId:_0x229c34,token:_0x19b782}=_0x17aa8a;_0x3a33da&&_0x229c34&&_0x19b782&&this['removeSourceRangeChange'](_0x3a33da,_0x229c34,_0x19b782);}break;case Pe['update']:{const {token:_0x364f54,oldSourceRangeInfo:_0x1ffb00,dataRangeInfo:_0x20b821,targetCellInfo:_0xee6f8c}=_0x17aa8a,{unitId:_0x82b079,subUnitId:_0x146d3f}=_0x1ffb00||{};_0x82b079&&_0x146d3f&&_0x364f54&&this[_0x2405a0(0x16e)](_0x82b079,_0x146d3f,_0x364f54),_0x20b821&&_0xee6f8c&&this[_0x2405a0(0x17d)](_0x364f54,_0x20b821,_0xee6f8c);}break;}});}['_subjectFieldsCollectionChange'](){const _0x2a7fa5=_0x58c229;this['_sheetsPivotDataSourceModel'][_0x2a7fa5(0x191)][_0x2a7fa5(0x1c3)](_0x5d8992=>{const _0x587a77=_0x2a7fa5;Object['keys'](_0x5d8992)[_0x587a77(0x124)](_0x307c9e=>{const _0x20cbec=_0x587a77,_0x562ca1=this[_0x20cbec(0x3b3)][_0x20cbec(0x1dd)](_0x307c9e);if(_0x562ca1){const _0x5744d0=this[_0x20cbec(0x3b3)][_0x20cbec(0x338)](_0x562ca1==null?void 0x0:_0x562ca1['unitId'],_0x562ca1==null?void 0x0:_0x562ca1[_0x20cbec(0x2f1)],_0x307c9e);_0x5744d0&&(this['handleSourceRangeChange'](_0x307c9e,_0x5744d0['sourceRangeInfo'],_0x5744d0[_0x20cbec(0x18b)]),this[_0x20cbec(0x154)]([{'unitId':_0x562ca1[_0x20cbec(0x204)],'subUnitId':_0x562ca1[_0x20cbec(0x2f1)],'token':_0x307c9e}]));}});});}['_subjectViewChange'](){const _0x469ea0=_0x58c229;this[_0x469ea0(0x3b3)][_0x469ea0(0x2e5)][_0x469ea0(0x1c3)](_0x3d1a81=>{const _0x5bfae8=_0x469ea0,{unitId:_0x5ebdca,subUnitId:_0x26ae3b,pivotTableId:_0x42957e}=_0x3d1a81;_0x5ebdca&&_0x26ae3b&&_0x42957e&&this[_0x5bfae8(0x154)]([{'unitId':_0x5ebdca,'subUnitId':_0x26ae3b,'token':_0x42957e}]);});}['triggerDirtyFeature'](_0x55345e){const _0x2a8e53=_0x58c229,_0x396a33={};_0x55345e[_0x2a8e53(0x124)](_0x22e66e=>{var _0x4a0da1,_0x34ec5c;const {unitId:_0x1dcc0f,subUnitId:_0x1a098d,token:_0x350b65}=_0x22e66e;_0x396a33[_0x1dcc0f]=(_0x4a0da1=_0x396a33[_0x1dcc0f])!=null?_0x4a0da1:{},_0x396a33[_0x1dcc0f][_0x1a098d]=(_0x34ec5c=_0x396a33[_0x1dcc0f][_0x1a098d])!=null?_0x34ec5c:{},_0x396a33[_0x1dcc0f][_0x1a098d][_0x350b65]=!0x0;}),this[_0x2a8e53(0x37b)][_0x2a8e53(0x3aa)](He['id'],_0x396a33);}[_0x58c229(0x16e)](_0x485435,_0x162c7c,_0x185716){const _0xe7a8a=_0x58c229;this[_0xe7a8a(0x365)][_0xe7a8a(0x17e)](_0x485435,_0x162c7c,[_0x185716]);}[_0x58c229(0x17d)](_0x1cfe8c,_0x88741a,_0x195f73){const _0x2f74cc=_0x58c229,{unitId:_0xad218f,subUnitId:_0xd7bd96}=_0x88741a;this[_0x2f74cc(0x365)][_0x2f74cc(0x38f)](_0x195f73[_0x2f74cc(0x204)],_0x195f73[_0x2f74cc(0x2f1)],_0x1cfe8c)&&this[_0x2f74cc(0x16e)](_0xad218f,_0xd7bd96,_0x1cfe8c);const _0xb1ece7={'sheetId':_0xd7bd96,..._0x88741a};this[_0x2f74cc(0x365)][_0x2f74cc(0x140)](_0x195f73[_0x2f74cc(0x204)],_0x195f73[_0x2f74cc(0x2f1)],_0x1cfe8c,{'unitId':_0x195f73[_0x2f74cc(0x204)],'subUnitId':_0x195f73[_0x2f74cc(0x2f1)],'dependencyRanges':[_0xb1ece7],'getDirtyData':(_0x5b0b5d,_0x36268e)=>{const _0x185841=_0x2f74cc,_0x5bcb4a=this['_sheetsPivotDataSourceModel'],_0x3a3a53=_0x5bcb4a[_0x185841(0x1dd)](_0x1cfe8c);if(!_0x3a3a53)return On();const {unitId:_0x464720,subUnitId:_0xe0db69}=_0x3a3a53,_0x3a6cad=kn(_0x5b0b5d,_0x36268e,_0x88741a);if(_0x3a6cad['length']>0x0){const _0x25308f=_0x5bcb4a[_0x185841(0x2af)](_0xad218f,_0x1cfe8c),_0x2491c6=_0x25308f[_0x185841(0x29c)](),_0x190dec=this[_0x185841(0x2d3)](_0x88741a[_0x185841(0x204)],_0x88741a[_0x185841(0x2f1)],_0x36268e),_0x48a071={},_0x44fe76=this[_0x185841(0x3b3)]['getDataFieldManager'](_0x464720)[_0x185841(0x34c)]()||m['getAutoDisplayName'],_0x3aebe7=[];for(const _0x667232 of _0x3a6cad){const _0x298d4f=_0x667232-(_0x88741a[_0x185841(0x13a)][_0x185841(0x1b3)]||0x0),_0x3e0453=_0x2491c6[_0x298d4f];_0x3aebe7[_0x185841(0x2c5)](_0x3e0453),_0x48a071[_0x3e0453]=_0x25308f[_0x185841(0x356)](_0x3e0453)['getName'](),_0x5bcb4a[_0x185841(0x34d)](_0xad218f)[_0x185841(0x33a)](_0x3e0453,_0x88741a,_0x298d4f,_0x190dec);}_0x25308f[_0x185841(0x2bf)](_0x3aebe7)[_0x185841(0x124)](_0x46fba6=>{const _0x377e61=_0x185841,[_0x4b6a62,_0x2b3931]=_0x46fba6,_0x307c5a=_0x25308f[_0x377e61(0x356)](_0x4b6a62),_0x303b99=_0x25308f[_0x377e61(0x356)](_0x2b3931);_0x307c5a&&_0x303b99&&_0x307c5a[_0x377e61(0x406)](_0x303b99);}),_0x25308f[_0x185841(0x354)]();const _0x172337=_0x5bcb4a[_0x185841(0x1a5)](_0x1cfe8c);if(_0x172337){An(_0x172337,_0x48a071,_0x44fe76),_0x172337[_0x185841(0x333)](!0x0);const _0x2a14f6=_0x172337[_0x185841(0x25e)](),_0x492981=_0x5bcb4a[_0x185841(0x338)](_0x464720,_0xe0db69,_0x1cfe8c),_0x33e220=_0x5bcb4a[_0x185841(0x34d)](_0xad218f)['toJSON']();_0x5bcb4a[_0x185841(0x1cd)](_0x464720,_0xe0db69,j['Set'],_0x1cfe8c,_0x2a14f6,_0x492981,_0x33e220,!0x0);}}return this[_0x185841(0x233)](_0x464720,_0xe0db69,_0x1cfe8c);}});}['getMatrixFromRunTimeData'](_0x1c9287,_0x34129c,_0x929041){var _0xb5f4aa,_0xf59469;const {arrayFormulaCellData:_0x16ac08,unitData:_0x269c81}=_0x929041,_0x5ce2d6=(_0xb5f4aa=_0x16ac08==null?void 0x0:_0x16ac08[_0x1c9287])==null?void 0x0:_0xb5f4aa[_0x34129c],_0x543c57=(_0xf59469=_0x269c81==null?void 0x0:_0x269c81[_0x1c9287])==null?void 0x0:_0xf59469[_0x34129c];return{'arrayFormulaCellDataMatrix':_0x5ce2d6,'unitDataMatrix':_0x543c57};}[_0x58c229(0x233)](_0x2c87df,_0x3cc7fb,_0x20a543){const _0x36a049=_0x58c229,_0x3004f1=this[_0x36a049(0x3b3)][_0x36a049(0x331)](_0x2c87df,_0x3cc7fb,_0x20a543),_0x378fbb=[],_0x11abb7=new v['ObjectMatrix']();if(_0x3004f1){const {rangeCache:_0x20cfc5,matrix:_0x2d1a6f,oldRangeCache:_0x541290,oldMatrix:_0x4c2836}=_0x3004f1,_0x226526=nt(_0x541290),_0x1ab7d1=nt(_0x20cfc5);_0x378fbb[_0x36a049(0x2c5)](..._0x1ab7d1,..._0x226526),_0x4c2836&&_0x541290&&_0x226526[_0x36a049(0x124)](_0x2f305d=>{const _0x4addcb=_0x36a049;for(let _0x3ea614=_0x2f305d[_0x4addcb(0x1fd)];_0x3ea614<=_0x2f305d['endRow'];_0x3ea614++)for(let _0x487e50=_0x2f305d[_0x4addcb(0x1b3)];_0x487e50<=_0x2f305d['endColumn'];_0x487e50++)_0x11abb7[_0x4addcb(0x121)](_0x3ea614,_0x487e50);}),_0x2d1a6f&&_0x1ab7d1&&_0x1ab7d1[_0x36a049(0x124)](_0x56a782=>{const _0x3d8224=_0x36a049;for(let _0x4b1699=_0x56a782[_0x3d8224(0x1fd)];_0x4b1699<=_0x56a782[_0x3d8224(0x12d)];_0x4b1699++)for(let _0x386c76=_0x56a782['startColumn'];_0x386c76<=_0x56a782['endColumn'];_0x386c76++)_0x11abb7['setValue'](_0x4b1699,_0x386c76,_0x2d1a6f['getValue'](_0x4b1699,_0x386c76));});}const _0x3b57c9={};return _0x3b57c9[_0x2c87df]={[_0x3cc7fb]:Bn(_0x378fbb)},{'runtimeCellData':{[_0x2c87df]:{[_0x3cc7fb]:_0x11abb7}},'dirtyRanges':_0x3b57c9};}[_0x58c229(0x33d)](){}};Le=xn([Be(0x0,v[_0x58c229(0x198)](exports[_0x58c229(0x297)])),Be(0x1,v[_0x58c229(0x198)](ve['IFeatureCalculationManagerService'])),Be(0x2,v[_0x58c229(0x198)](v[_0x58c229(0x341)])),Be(0x3,v['Inject'](ve['GlobalComputingStatusService'])),Be(0x4,v[_0x58c229(0x198)](v[_0x58c229(0x3ee)]))],Le);var jn=Object[_0x58c229(0x21f)],Ln=(_0x5c7ad7,_0x3dd2b4,_0xf0a98c,_0x564748)=>{const _0x6e77e7=_0x58c229;for(var _0x5c90d7=_0x564748>0x1?void 0x0:_0x564748?jn(_0x3dd2b4,_0xf0a98c):_0x3dd2b4,_0x28d6a1=_0x5c7ad7[_0x6e77e7(0x3ca)]-0x1,_0x17e628;_0x28d6a1>=0x0;_0x28d6a1--)(_0x17e628=_0x5c7ad7[_0x28d6a1])&&(_0x5c90d7=_0x17e628(_0x5c90d7)||_0x5c90d7);return _0x5c90d7;},et=(_0x3ac95e,_0x56a726)=>(_0x3cb0b9,_0x3d8e1f)=>_0x56a726(_0x3cb0b9,_0x3d8e1f,_0x3ac95e);let Ge=class extends v[_0x58c229(0x351)]{constructor(_0x340de1,_0x499e3d,_0x38a5bc,_0xc3245a){const _0x42fecb=_0x58c229;super(),x(this,_0x42fecb(0x1b9),new v[(_0x42fecb(0x221))]()),(this[_0x42fecb(0x245)]=_0x340de1,this[_0x42fecb(0x239)]=_0x499e3d,this[_0x42fecb(0x3f3)]=_0x38a5bc,this[_0x42fecb(0x372)]=_0xc3245a,this[_0x42fecb(0x1cc)]());}[_0x58c229(0x1cc)](){const _0x1b7fb9=_0x58c229;this[_0x1b7fb9(0x17a)](this[_0x1b7fb9(0x239)][_0x1b7fb9(0x405)]({'getMutations':_0x3718a2=>{const _0x1989c3=_0x1b7fb9;if(_0x3718a2['id']===V[_0x1989c3(0x26a)]['id']||_0x3718a2['id']===V[_0x1989c3(0x1a3)]['id']){const _0x5b382=[],_0x2524b9=[],_0x390c50=this['_sheetsSelectionsService'][_0x1989c3(0x2e7)]()[_0x1989c3(0x14c)](_0x25417a=>_0x25417a['range']),_0x4a22cf=V[_0x1989c3(0x41b)](this[_0x1989c3(0x245)]);if(!_0x4a22cf)return{'redos':[],'undos':[]};const {unitId:_0x2aca06,subUnitId:_0x35956c}=_0x4a22cf,_0x59f70e={},_0x5068d4=this[_0x1989c3(0x372)][_0x1989c3(0x135)](_0x2aca06,_0x35956c);if(_0x5068d4!=null&&_0x5068d4['size'])for(const [_0x28480d,_0x71a55b]of _0x5068d4){const {unitId:_0x485035,subUnitId:_0x48b96c,row:_0x57bf9e,col:_0x4d24f9}=_0x71a55b['targetCellInfo'];_0x485035===_0x4a22cf[_0x1989c3(0x204)]&&_0x48b96c===_0x4a22cf[_0x1989c3(0x2f1)]&&(_0x59f70e[_0x57bf9e+'-'+_0x4d24f9]=_0x28480d);}return _0x390c50&&_0x4a22cf&&_0x390c50[_0x1989c3(0x124)](_0x580be8=>{const _0x5c406a=_0x1989c3;v[_0x5c406a(0x252)][_0x5c406a(0x3da)](_0x580be8,(_0x587596,_0x3f5aa6)=>{const _0x1f5678=_0x5c406a,_0xc693b2=_0x587596+'-'+_0x3f5aa6;if(_0x59f70e[_0xc693b2]){const _0x31c394=_0x59f70e[_0xc693b2];_0x5b382[_0x1f5678(0x2c5)]({'id':Ye['id'],'params':{'unitId':_0x2aca06,'subUnitId':_0x35956c,'pivotTableId':_0x31c394}});const _0x1462ec=this[_0x1f5678(0x372)]['getCollection'](_0x2aca06,_0x31c394),_0x2faac5=this[_0x1f5678(0x372)][_0x1f5678(0x338)](_0x2aca06,_0x35956c,_0x31c394);_0x2524b9['push']({'id':we['id'],'params':{'unitId':_0x2aca06,'subUnitId':_0x35956c,'pivotTableId':_0x31c394,'pivotTableConfig':_0x2faac5,'collectionConfig':_0x1462ec}});}});}),{'redos':_0x5b382,'undos':_0x2524b9};}return{'redos':[],'undos':[]};}}));}};Ge=Ln([et(0x0,v['IUniverInstanceService']),et(0x1,v[_0x58c229(0x198)](V[_0x58c229(0x2f0)])),et(0x2,v[_0x58c229(0x198)](V[_0x58c229(0x24d)])),et(0x3,v[_0x58c229(0x198)](exports['SheetsPivotTableConfigModel']))],Ge);var Gn=Object['getOwnPropertyDescriptor'],$n=(_0x2e0092,_0x41a7e3,_0x1b7f69,_0x41f337)=>{const _0xe13c17=_0x58c229;for(var _0x2698ac=_0x41f337>0x1?void 0x0:_0x41f337?Gn(_0x41a7e3,_0x1b7f69):_0x41a7e3,_0x266f44=_0x2e0092[_0xe13c17(0x3ca)]-0x1,_0x27ec28;_0x266f44>=0x0;_0x266f44--)(_0x27ec28=_0x2e0092[_0x266f44])&&(_0x2698ac=_0x27ec28(_0x2698ac)||_0x2698ac);return _0x2698ac;},je=(_0x5e667c,_0x17da02)=>(_0x198aca,_0x1a7e7b)=>_0x17da02(_0x198aca,_0x1a7e7b,_0x5e667c);let $e=class extends v['Disposable']{constructor(_0x2a4705,_0x3898c4,_0x507cee,_0x21f78c,_0x4ced72){const _0x7449ad=_0x58c229;super(),this[_0x7449ad(0x239)]=_0x2a4705,this[_0x7449ad(0x20c)]=_0x3898c4,this[_0x7449ad(0x245)]=_0x507cee,this[_0x7449ad(0x372)]=_0x21f78c,this[_0x7449ad(0x2f3)]=_0x4ced72,this[_0x7449ad(0x397)]();}[_0x58c229(0x251)](_0x5e173f,_0x33a04c,_0x19897b){const _0x27c6ba=_0x58c229,{pageView:_0x516fbf,cornerView:_0x2caca2,rowView:_0x38cd78,colView:_0x37aa4d,dataView:_0x25c9a1}=_0x33a04c,_0x5408f0=_0x5e173f;let _0x26e403;if(_0x19897b)_0x26e403=[...zt(_0x5408f0)];else{const _0xcb6221=ne(_0x5408f0,_0x516fbf,!0x0),_0x22803c=_0x516fbf[_0x27c6ba(0x217)]>=0x0?_0x516fbf[_0x27c6ba(0x217)]+0x1:0x0,_0x576adf=_0x2caca2[_0x27c6ba(0x394)],_0x2b0317=_0x2caca2[_0x27c6ba(0x2dd)],_0x5118c7=_0xcb6221[_0x27c6ba(0x3ca)]>0x0?Re:0x0,_0x4c3bd7=ne({'row':_0x5408f0[_0x27c6ba(0x1d4)]+_0x22803c+_0x5118c7,'col':_0x5408f0['col']},_0x2caca2,!0x1,!0x1),_0x256d3c=ne({'row':_0x5408f0[_0x27c6ba(0x1d4)]+_0x22803c+_0x5118c7+_0x576adf,'col':_0x5408f0['col']},_0x38cd78,!0x1,!0x0),_0x2098f3=ne({'row':_0x5408f0['row']+_0x22803c+_0x5118c7,'col':_0x5408f0[_0x27c6ba(0x178)]+_0x2b0317},_0x37aa4d,!0x1,!0x0),_0x391a1d=ne({'row':_0x5408f0[_0x27c6ba(0x1d4)]+_0x22803c+_0x5118c7+_0x576adf,'col':_0x5408f0[_0x27c6ba(0x178)]+_0x2b0317},_0x25c9a1,!0x1,!0x0);_0x26e403=[..._0xcb6221,..._0x4c3bd7,..._0x256d3c,..._0x2098f3,..._0x391a1d];}return _0x26e403;}[_0x58c229(0x397)](){const _0x308376=_0x58c229;this['disposeWithMe'](this[_0x308376(0x2f3)]['interceptor'][_0x308376(0x226)](this[_0x308376(0x2f3)][_0x308376(0x3fd)][_0x308376(0x12c)]()['PIVOT_MUTATION_GENERATE'],{'handler':(_0x1e5836,_0x449463)=>{const _0x28e212=_0x308376,{cellInfo:_0x4fef38,view:_0x3629cf,isEmpty:_0x49cf14}=_0x449463,_0x168c70=_0x4fef38,{unitId:_0x1891c0,subUnitId:_0x1dfe3e}=_0x168c70,_0x4fc894=this[_0x28e212(0x251)](_0x4fef38,_0x3629cf,_0x49cf14),_0x5c87cc=this[_0x28e212(0x239)][_0x28e212(0x41d)]({'unitId':_0x1891c0,'subUnitId':_0x1dfe3e,'ranges':_0x4fc894}),_0x2566c3=Et(this[_0x28e212(0x20c)],_0x1891c0,_0x1dfe3e,_0x4fc894);_0x2566c3['shouldClear']&&(_0x5c87cc[_0x28e212(0x1fa)][_0x28e212(0x2c5)](_0x2566c3['setRangeValueRedoMutation']),_0x5c87cc[_0x28e212(0x18d)][_0x28e212(0x2c5)](_0x2566c3['setRangeValueUndoMutation']));const _0x1bd944=this['getAutoFitColumnsMutations'](_0x3629cf,_0x4fef38);return _0x5c87cc[_0x28e212(0x1fa)][_0x28e212(0x2c5)](..._0x1bd944[_0x28e212(0x1fa)]),_0x5c87cc['undos'][_0x28e212(0x2c5)](..._0x1bd944[_0x28e212(0x18d)]),{'redos':_0x5c87cc[_0x28e212(0x1fa)],'undos':_0x5c87cc[_0x28e212(0x18d)]};}}));}[_0x58c229(0x148)](_0x2c02a5,_0x405756){const _0x56cb02=_0x58c229,{col:_0x5a65ea,unitId:_0x1c1acb,subUnitId:_0x119a24}=_0x405756,_0x39ab67=[],_0x459e6d=[],_0x2bbfff=V[_0x56cb02(0x41b)](this['_univerInstanceService'],{'unitId':_0x1c1acb,'subUnitId':_0x119a24});if(!_0x405756||!_0x2c02a5||!_0x2bbfff)return{'undos':_0x459e6d,'redos':_0x39ab67};const _0x3ae452=this['_sheetsPivotTableConfigModel'][_0x56cb02(0x15c)](),{colView:_0xf0f331,dataView:_0x26b0f1,cornerView:_0x38b1a5,rowView:_0x6f257c,formatMap:_0x480688}=_0x2c02a5,_0x1c907a=kt(_0xf0f331,_0x3ae452,!0x0,_0x480688),_0x435afd=kt(_0x6f257c,_0x3ae452,!0x1,_0x480688),_0x3a0c4f=dn(_0x26b0f1),_0x7d171a=cn(_0x38b1a5),{worksheet:_0x135779}=_0x2bbfff;if(typeof window<'u'&&window[_0x56cb02(0x1f7)]){const _0xf63df5=Ne['getFontStyleString']({...oe[_0x56cb02(0x1d9)]}),_0xe82410=Ne[_0x56cb02(0x3dc)][_0x56cb02(0x1e6)](_0x1c907a,_0xf63df5)[_0x56cb02(0x378)]+0x10,_0xc77d9f=Ne[_0x56cb02(0x3dc)]['getTextSize'](_0x3a0c4f,_0xf63df5)[_0x56cb02(0x378)],_0x2a1fa5=Math[_0x56cb02(0x274)](Math['max'](_0xe82410,_0xc77d9f))+0x10,_0x49f666=Math[_0x56cb02(0x274)](Ne['FontCache'][_0x56cb02(0x1e6)](_0x435afd,_0xf63df5)[_0x56cb02(0x378)]),_0x464694=Math[_0x56cb02(0x274)](Ne[_0x56cb02(0x3dc)]['getTextSize'](_0x7d171a,_0xf63df5)[_0x56cb02(0x378)]),_0xb180a7=Math['max'](_0x49f666,_0x464694,0x28)+0xc,_0x42f737=_0xf0f331[_0x56cb02(0x2dd)]+_0x38b1a5['colCount'],_0x54b8a1={},_0x42ea77={};for(let _0x57d0d5=_0x5a65ea;_0x57d0d5<_0x5a65ea+_0x42f737;_0x57d0d5++){const _0x292ed3=_0x135779[_0x56cb02(0x19f)](_0x57d0d5);_0x54b8a1[_0x57d0d5]=_0x292ed3,_0x57d0d5-_0x5a65ea<_0x38b1a5[_0x56cb02(0x2dd)]?_0x42ea77[_0x57d0d5-_0x5a65ea]=_0xb180a7:_0x42ea77[_0x57d0d5-_0x5a65ea]=_0x2a1fa5;}_0x39ab67['push']({'id':V['SetWorksheetColWidthMutation']['id'],'params':{'subUnitId':_0x119a24,'unitId':_0x1c1acb,'ranges':[{'startColumn':_0x5a65ea,'endColumn':_0x5a65ea+_0x42f737-0x1,'startRow':0x0,'endRow':_0x135779[_0x56cb02(0x3ef)]()-0x1}],'colWidth':_0x42ea77}}),_0x459e6d['push']({'id':V[_0x56cb02(0x38e)]['id'],'params':{'subUnitId':_0x119a24,'unitId':_0x1c1acb,'ranges':[{'startColumn':_0x5a65ea,'endColumn':_0x5a65ea+_0x42f737-0x1,'startRow':0x0,'endRow':_0x135779[_0x56cb02(0x3ef)]()-0x1}],'colWidth':_0x54b8a1}});}return{'undos':_0x459e6d,'redos':_0x39ab67};}};$e=$n([je(0x0,v[_0x58c229(0x198)](V['SheetInterceptorService'])),je(0x1,v[_0x58c229(0x198)](v[_0x58c229(0x3ee)])),je(0x2,v[_0x58c229(0x198)](v[_0x58c229(0x185)])),je(0x3,v[_0x58c229(0x198)](exports[_0x58c229(0x416)])),je(0x4,v[_0x58c229(0x198)](exports[_0x58c229(0x1ce)]))],$e);var Wn=Object['getOwnPropertyDescriptor'],Jn=(_0x1e7c09,_0x19ecdc,_0x3ef4c0,_0x2d6e2e)=>{for(var _0x6e2ef=_0x2d6e2e>0x1?void 0x0:_0x2d6e2e?Wn(_0x19ecdc,_0x3ef4c0):_0x19ecdc,_0x552fb3=_0x1e7c09['length']-0x1,_0x1a645d;_0x552fb3>=0x0;_0x552fb3--)(_0x1a645d=_0x1e7c09[_0x552fb3])&&(_0x6e2ef=_0x1a645d(_0x6e2ef)||_0x6e2ef);return _0x6e2ef;},Se=(_0x5e9d5d,_0x502c1d)=>(_0x1a8aa5,_0x8700ba)=>_0x502c1d(_0x1a8aa5,_0x8700ba,_0x5e9d5d);let We=class extends v[_0x58c229(0x351)]{constructor(_0x5b16c5,_0x1c88a0,_0x25afdf,_0x362dfe,_0x578321,_0x3fcf62,_0x408efd){const _0x1915c9=_0x58c229;super(),x(this,_0x1915c9(0x1b9),new v[(_0x1915c9(0x221))]()),(this[_0x1915c9(0x20c)]=_0x5b16c5,this[_0x1915c9(0x345)]=_0x1c88a0,this['_commandService']=_0x25afdf,this['_univerInstanceService']=_0x362dfe,this[_0x1915c9(0x372)]=_0x578321,this[_0x1915c9(0x1b4)]=_0x3fcf62,this[_0x1915c9(0x239)]=_0x408efd,this[_0x1915c9(0x143)]());}[_0x58c229(0x143)](){const _0x53e627=_0x58c229,_0x197def=(_0x538cd8,_0x339514)=>{const _0x1ec3de=_0x1cc3,_0x5d72b5=this['_univerInstanceService']['getCurrentUnitForType'](v[_0x1ec3de(0x232)]['UNIVER_SHEET']);if(!_0x5d72b5||!(_0x5d72b5==null?void 0x0:_0x5d72b5[_0x1ec3de(0x3a8)](_0x339514)))return;this[_0x1ec3de(0x1b9)][_0x1ec3de(0x33d)]();const _0x57dde1=_0x3ff931=>this[_0x1ec3de(0x1cb)](_0x3ff931,_0x538cd8,_0x339514),_0x554ad8=this[_0x1ec3de(0x372)][_0x1ec3de(0x135)](_0x538cd8,_0x339514);if(!(_0x554ad8!=null&&_0x554ad8[_0x1ec3de(0x290)]))return;Array[_0x1ec3de(0x305)](_0x554ad8[_0x1ec3de(0x199)]())[_0x1ec3de(0x14c)](_0x287ffb=>{const _0x2c2ac4=_0x1ec3de,{row:_0x496b3f,col:_0x1e03de}=_0x287ffb[_0x2c2ac4(0x18b)];return v[_0x2c2ac4(0x15d)](_0x496b3f,_0x1e03de);})[_0x1ec3de(0x124)](_0xee4df0=>{const _0x1f43a7=_0x1ec3de;this['disposableCollection'][_0x1f43a7(0x289)](this[_0x1f43a7(0x345)][_0x1f43a7(0x11b)](_0xee4df0,_0x57dde1,_0x538cd8,_0x339514));});},_0x135bfa=()=>{const _0x4e2e82=_0x1cc3,_0x1a56f1=this[_0x4e2e82(0x245)][_0x4e2e82(0x207)](v[_0x4e2e82(0x232)][_0x4e2e82(0x2cb)]);if(_0x1a56f1){const _0x4bcc6e=_0x1a56f1[_0x4e2e82(0x24a)]();if(!_0x4bcc6e)return;_0x197def(_0x1a56f1[_0x4e2e82(0x385)](),_0x4bcc6e[_0x4e2e82(0x13e)]());}};this['disposeWithMe'](this[_0x53e627(0x37b)][_0x53e627(0x267)](_0x506ba4=>{const _0x334725=_0x53e627;if(_0x506ba4['id']===V[_0x334725(0x370)]['id']){const _0x191fc0=_0x506ba4['params'],_0x20dc4=_0x191fc0[_0x334725(0x2f1)],_0x295481=_0x191fc0[_0x334725(0x204)];if(!_0x20dc4||!_0x295481)return;_0x197def(_0x295481,_0x20dc4);}})),this[_0x53e627(0x17a)](this[_0x53e627(0x372)][_0x53e627(0x136)][_0x53e627(0x1c3)](_0x5c56ee=>{_0x5c56ee&&_0x135bfa();})),this['disposeWithMe'](this['_sheetsPivotTableConfigModel'][_0x53e627(0x249)][_0x53e627(0x1c3)](_0x15881e=>{const _0x172f3c=V['getSheetCommandTarget'](this['_univerInstanceService']);if(!_0x172f3c)return;const {unitId:_0x1941e3,subUnitId:_0x5a9739}=_0x172f3c,{unitId:_0x4d96e5,subUnitId:_0x269855}=_0x15881e;_0x1941e3!==_0x4d96e5||_0x5a9739!==_0x269855||_0x197def(_0x1941e3,_0x5a9739);})),_0x135bfa();}[_0x58c229(0x1cb)](_0x29a70a,_0x3850b0,_0x2b64f7){const _0x2cf8b1=_0x58c229;switch(_0x29a70a['id']){case V[_0x2cf8b1(0x30f)]['id']:return this[_0x2cf8b1(0x2bc)](_0x29a70a[_0x2cf8b1(0x192)],_0x3850b0,_0x2b64f7);}return{'redos':[],'undos':[]};}[_0x58c229(0x2bc)](_0x305730,_0xd76724,_0x12bdb8){const _0x2f7eda=_0x58c229,{fromRange:_0x300776,toRange:_0xd06537}=_0x305730,_0x535cc2=[],_0xded281=[],_0x9099ee=V[_0x2f7eda(0x41b)](this[_0x2f7eda(0x245)]);if(!_0x9099ee)return{'undos':_0xded281,'redos':_0x535cc2};if(_0xd76724!==_0x9099ee[_0x2f7eda(0x204)]||_0x12bdb8!==_0x9099ee[_0x2f7eda(0x2f1)])return{'undos':_0xded281,'redos':_0x535cc2};const _0x3e9ce4=this[_0x2f7eda(0x372)][_0x2f7eda(0x135)](_0xd76724,_0x12bdb8);if(_0x3e9ce4!=null&&_0x3e9ce4['size'])for(const [_0x3d5bcf,_0x1d5ea3]of _0x3e9ce4){const {unitId:_0x3d5745,subUnitId:_0x318852,row:_0x27ff5d,col:_0x43ecb7}=_0x1d5ea3[_0x2f7eda(0x18b)];if(_0x3d5745===_0x9099ee['unitId']&&_0x318852===_0x9099ee[_0x2f7eda(0x2f1)]){const _0x153907=v[_0x2f7eda(0x15d)](_0x27ff5d,_0x43ecb7);if(v[_0x2f7eda(0x22f)][_0x2f7eda(0x10f)](_0x153907,_0x300776)){const _0x4912ad=_0x27ff5d-_0x300776['startRow'],_0x5d5ad4=_0x43ecb7-_0x300776[_0x2f7eda(0x1b3)],_0x39f60e={'row':_0xd06537[_0x2f7eda(0x1fd)]+_0x4912ad,'col':_0xd06537[_0x2f7eda(0x1b3)]+_0x5d5ad4};_0x535cc2[_0x2f7eda(0x2c5)]({'id':Fe['id'],'params':{'unitId':_0x3d5745,'subUnitId':_0x318852,'pivotTableId':_0x3d5bcf,'targetCellPosition':_0x39f60e}}),_0xded281['push']({'id':Fe['id'],'params':{'unitId':_0x3d5745,'subUnitId':_0x318852,'pivotTableId':_0x3d5bcf,'targetCellPosition':{'row':_0x27ff5d,'col':_0x43ecb7}}});const _0x16a612=_0x39f60e['row']-_0x27ff5d,_0x35d0ef=_0x39f60e[_0x2f7eda(0x178)]-_0x43ecb7,_0x5adb90=[],_0x4b68da=this[_0x2f7eda(0x1b4)]['getPivotItemRenderInfoCache'](_0x3d5745,_0x318852,_0x3d5bcf),_0xa2d6be=_0x4b68da==null?void 0x0:_0x4b68da[_0x2f7eda(0x3d3)];if(_0xa2d6be){Object[_0x2f7eda(0x284)](_0xa2d6be)['forEach'](_0x6265f6=>{const _0x44535b=_0x2f7eda;_0xa2d6be[_0x6265f6][_0x44535b(0x124)](_0x5b9df5=>{const _0x4d8529=_0x44535b,_0x2190ec={..._0x5b9df5};_0x2190ec[_0x4d8529(0x1fd)]=_0x5b9df5['startRow']+_0x16a612,_0x2190ec['endRow']=_0x5b9df5[_0x4d8529(0x12d)]+_0x16a612,_0x2190ec[_0x4d8529(0x1b3)]=_0x5b9df5[_0x4d8529(0x1b3)]+_0x35d0ef,_0x2190ec[_0x4d8529(0x1ea)]=_0x5b9df5['endColumn']+_0x35d0ef,_0x5adb90[_0x4d8529(0x2c5)](_0x2190ec);});});const _0x6ced9f=this[_0x2f7eda(0x239)]['generateMutationsByRanges']({'unitId':_0x3d5745,'subUnitId':_0x318852,'ranges':_0x5adb90});_0x535cc2['push'](..._0x6ced9f[_0x2f7eda(0x1fa)]),_0xded281['push'](..._0x6ced9f[_0x2f7eda(0x18d)]);const _0x2bebd8=Et(this['_injector'],_0x3d5745,_0x318852,_0x5adb90);_0x2bebd8['shouldClear']&&(_0x535cc2[_0x2f7eda(0x2c5)](_0x2bebd8[_0x2f7eda(0x230)]),_0xded281['push'](_0x2bebd8['setRangeValueUndoMutation']));}}}}return{'redos':_0x535cc2,'undos':_0xded281};}};We=Jn([Se(0x0,v['Inject'](v[_0x58c229(0x3ee)])),Se(0x1,v[_0x58c229(0x198)](V[_0x58c229(0x16d)])),Se(0x2,v[_0x58c229(0x341)]),Se(0x3,v[_0x58c229(0x185)]),Se(0x4,v[_0x58c229(0x198)](exports['SheetsPivotTableConfigModel'])),Se(0x5,v[_0x58c229(0x198)](exports[_0x58c229(0x330)])),Se(0x6,v['Inject'](V[_0x58c229(0x2f0)]))],We);var qn=Object[_0x58c229(0x21f)],Kn=(_0x301745,_0x74b4a0,_0x238036,_0x49d39e)=>{const _0x42f043=_0x58c229;for(var _0x130f7d=_0x49d39e>0x1?void 0x0:_0x49d39e?qn(_0x74b4a0,_0x238036):_0x74b4a0,_0x2f669a=_0x301745[_0x42f043(0x3ca)]-0x1,_0x3d691a;_0x2f669a>=0x0;_0x2f669a--)(_0x3d691a=_0x301745[_0x2f669a])&&(_0x130f7d=_0x3d691a(_0x130f7d)||_0x130f7d);return _0x130f7d;},Lt=(_0x49c6eb,_0x571154)=>(_0x329f06,_0xd55c81)=>_0x571154(_0x329f06,_0xd55c81,_0x49c6eb);let Je=class extends v['Disposable']{constructor(_0x2f9e4f,_0x145ee5){const _0x18dcaf=_0x58c229;super(),this[_0x18dcaf(0x239)]=_0x2f9e4f,this[_0x18dcaf(0x372)]=_0x145ee5,this[_0x18dcaf(0x261)]();}[_0x58c229(0x261)](){const _0x53c73c=_0x58c229;this[_0x53c73c(0x17a)](this[_0x53c73c(0x239)][_0x53c73c(0x405)]({'getMutations':_0x5c68a3=>{const _0x5c89bb=_0x53c73c;if(_0x5c68a3['id']===V[_0x5c89bb(0x35d)]['id']){const _0x17de14=[],_0x235666=[],_0x12f474=_0x5c68a3['params'],{unitId:_0x564e1e,subUnitId:_0x748719}=_0x12f474;if(!_0x564e1e||!_0x748719)return{'undos':_0x235666,'redos':_0x17de14};const _0x37adaa=this['_sheetsPivotTableConfigModel'][_0x5c89bb(0x135)](_0x564e1e,_0x748719);if(_0x37adaa!=null&&_0x37adaa[_0x5c89bb(0x290)])for(const [_0x1c625e,_0x10b9e1]of _0x37adaa){_0x17de14['push']({'id':Ye['id'],'params':{'unitId':_0x564e1e,'subUnitId':_0x748719,'pivotTableId':_0x1c625e}});const _0x304c5d={...this[_0x5c89bb(0x372)][_0x5c89bb(0x2af)](_0x564e1e,_0x1c625e)};_0x235666[_0x5c89bb(0x2c5)]({'id':we['id'],'params':{'unitId':_0x564e1e,'subUnitId':_0x748719,'pivotTableId':_0x1c625e,'pivotTableConfig':_0x10b9e1,'collectionConfig':_0x304c5d}});}return{'redos':_0x17de14,'undos':_0x235666};}return{'redos':[],'undos':[]};}}));}};Je=Kn([Lt(0x0,v['Inject'](V[_0x58c229(0x2f0)])),Lt(0x1,v['Inject'](exports['SheetsPivotTableConfigModel']))],Je);var Hn=Object['getOwnPropertyDescriptor'],Yn=(_0x1a1a1f,_0x4fbe9a,_0x1f5ed0,_0x1a10e8)=>{for(var _0xad3dc9=_0x1a10e8>0x1?void 0x0:_0x1a10e8?Hn(_0x4fbe9a,_0x1f5ed0):_0x4fbe9a,_0xb5542f=_0x1a1a1f['length']-0x1,_0x1acad4;_0xb5542f>=0x0;_0xb5542f--)(_0x1acad4=_0x1a1a1f[_0xb5542f])&&(_0xad3dc9=_0x1acad4(_0xad3dc9)||_0xad3dc9);return _0xad3dc9;},ye=(_0x1ec636,_0x34b131)=>(_0x5c4c99,_0x1a6466)=>_0x34b131(_0x5c4c99,_0x1a6466,_0x1ec636);let qe=class extends v[_0x58c229(0x351)]{constructor(_0x2d6756,_0x4ca45e,_0x4a62cf,_0x42175c,_0x34a355,_0x4b37c8){const _0x31be97=_0x58c229;super(),this[_0x31be97(0x37b)]=_0x2d6756,this['_sheetsPivotRpcService']=_0x4ca45e,this[_0x31be97(0x1b4)]=_0x4a62cf,this[_0x31be97(0x372)]=_0x42175c,this[_0x31be97(0x245)]=_0x34a355,this[_0x31be97(0x177)]=_0x4b37c8,this['_initDataSendListener'](),this['registerDirtyService']();}[_0x58c229(0x23e)](){const _0x552b93=_0x58c229;this[_0x552b93(0x17a)](this[_0x552b93(0x37b)][_0x552b93(0x267)](_0x522e8a=>{const _0x30ca3d=_0x552b93;if(_0x522e8a['id']!==Rt['id'])return;const _0x5c0ce3=_0x522e8a[_0x30ca3d(0x192)];this['_sheetsPivotRpcService'][_0x30ca3d(0x117)](_0x5c0ce3);})),this[_0x552b93(0x17a)](this[_0x552b93(0x37b)][_0x552b93(0x267)](_0x419e95=>{const _0x1389d6=_0x552b93;if(_0x419e95['id']===wt['id']){const _0x36cb36=_0x419e95[_0x1389d6(0x192)];if(_0x36cb36){const {unitId:_0x57550f,subUnitId:_0x20673c,oldSubUnitId:_0x300095,pivotTableId:_0x2b29df,pivotTableConfig:_0x30cc3c,collectionConfig:_0x4ba4e1}=_0x36cb36;this[_0x1389d6(0x372)][_0x1389d6(0x253)](_0x57550f,_0x300095,_0x36cb36['pivotTableId'],null),this[_0x1389d6(0x372)]['updateConfigCache'](_0x57550f,_0x20673c,_0x2b29df,_0x30cc3c),this[_0x1389d6(0x372)][_0x1389d6(0x3c1)](_0x57550f,_0x4ba4e1);}}})),this['disposeWithMe'](this[_0x552b93(0x37b)][_0x552b93(0x267)](_0x15aed5=>{const _0x30d284=_0x552b93;if(_0x15aed5['id']!==ot['id'])return;const _0x4b33da=V[_0x30d284(0x41b)](this[_0x30d284(0x245)]);if(!_0x4b33da)return;const {unitId:_0x2da2d7,subUnitId:_0x3abb65}=_0x4b33da,_0x14fb69=_0x15aed5[_0x30d284(0x192)];if(_0x14fb69['collectionConfig']&&Object[_0x30d284(0x284)](_0x14fb69[_0x30d284(0x2db)])[_0x30d284(0x124)](_0x24db8c=>{const _0x47e67f=_0x30d284;var _0x5595f5;(_0x5595f5=_0x14fb69[_0x47e67f(0x2db)])!=null&&_0x5595f5[_0x24db8c]&&this[_0x47e67f(0x372)][_0x47e67f(0x3c1)](_0x24db8c,_0x14fb69[_0x47e67f(0x2db)][_0x24db8c]);}),_0x14fb69['single']){const _0xc6db9f=_0x14fb69[_0x30d284(0x28c)],{unitId:_0x330a97,subUnitId:_0x1d8071,view:_0x9be5f6,pivotTableId:_0x4f105b,type:_0x3c3b50,pivotConfig:_0x3ff54e}=_0xc6db9f;if(_0x3c3b50===j[_0x30d284(0x414)])this[_0x30d284(0x1b4)][_0x30d284(0x218)]({'unitId':_0x330a97,'subUnitId':_0x1d8071,'pivotTableId':_0x4f105b,'type':_0x3c3b50}),this[_0x30d284(0x372)]['updateConfigCache'](_0x330a97,_0x1d8071,_0x4f105b,null);else{const _0x5380de=new m[(_0x30d284(0x1a0))]();_0x5380de[_0x30d284(0x25d)](_0x9be5f6),this['_sheetsPivotTableConfigModel'][_0x30d284(0x253)](_0x330a97,_0x1d8071,_0x4f105b,_0x3ff54e),this[_0x30d284(0x1b4)][_0x30d284(0x218)]({'unitId':_0x330a97,'subUnitId':_0x1d8071,'pivotTableId':_0x4f105b,'type':_0x3c3b50,'view':_0x5380de}),this[_0x30d284(0x1b4)][_0x30d284(0x3c2)]({'unitId':_0x330a97,'subUnitId':_0x1d8071,'view':_0x5380de,'pivotTableId':_0x4f105b,'type':_0x3c3b50});}}else _0x14fb69[_0x30d284(0x161)]&&(_0x14fb69[_0x30d284(0x161)][_0x30d284(0x124)](_0x1792b5=>{const _0x23f9df=_0x30d284,{unitId:_0x4ea22f,subUnitId:_0x35590f,view:_0x1957de,pivotTableId:_0x24f6d9,type:_0x311ad8,pivotConfig:_0x71a065}=_0x1792b5,_0x41200f=new m['PivotView']();_0x41200f['formJSON'](_0x1957de),this[_0x23f9df(0x372)][_0x23f9df(0x253)](_0x4ea22f,_0x35590f,_0x24f6d9,_0x71a065),this[_0x23f9df(0x1b4)]['updateRenderCache']({'unitId':_0x4ea22f,'subUnitId':_0x35590f,'view':_0x41200f,'pivotTableId':_0x24f6d9,'type':_0x311ad8});}),this[_0x30d284(0x372)][_0x30d284(0x3ce)]());this[_0x30d284(0x1b4)]['markDirty'](_0x2da2d7,_0x3abb65);}));}[_0x58c229(0x326)](){const _0x2b9f11=_0x58c229;this[_0x2b9f11(0x177)][_0x2b9f11(0x140)](He['id'],{'commandId':He['id'],'getDirtyData'(_0x46d562){const _0x238bd1=_0x2b9f11;return{'dirtyUnitFeatureMap':_0x46d562[_0x238bd1(0x192)]};}});}};qe=Yn([ye(0x0,v[_0x58c229(0x198)](v['ICommandService'])),ye(0x1,v[_0x58c229(0x198)](exports['SheetsPivotRPCService'])),ye(0x2,v[_0x58c229(0x198)](exports[_0x58c229(0x330)])),ye(0x3,v['Inject'](exports[_0x58c229(0x416)])),ye(0x4,v['Inject'](v[_0x58c229(0x185)])),ye(0x5,ve[_0x58c229(0x229)])],qe);var Qn=Object[_0x58c229(0x129)],zn=Object['getOwnPropertyDescriptor'],Xn=(_0x4a3df0,_0x502de8,_0x4c9046)=>_0x502de8 in _0x4a3df0?Qn(_0x4a3df0,_0x502de8,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x4c9046}):_0x4a3df0[_0x502de8]=_0x4c9046,Zn=(_0x440be6,_0xb9402f,_0x49fcc9,_0x56b369)=>{const _0x105a7d=_0x58c229;for(var _0x1199d1=_0x56b369>0x1?void 0x0:_0x56b369?zn(_0xb9402f,_0x49fcc9):_0xb9402f,_0x142f6d=_0x440be6[_0x105a7d(0x3ca)]-0x1,_0xd1d8c5;_0x142f6d>=0x0;_0x142f6d--)(_0xd1d8c5=_0x440be6[_0x142f6d])&&(_0x1199d1=_0xd1d8c5(_0x1199d1)||_0x1199d1);return _0x1199d1;},tt=(_0x1ed236,_0x114f34)=>(_0x299701,_0x456fc3)=>_0x114f34(_0x299701,_0x456fc3,_0x1ed236),Co=(_0x4dd1fd,_0x312290,_0x39420b)=>Xn(_0x4dd1fd,typeof _0x312290!=_0x58c229(0x1e2)?_0x312290+'':_0x312290,_0x39420b);exports[_0x58c229(0x23a)]=class extends v['Plugin']{constructor(_0x8ef4d1=Bt,_0x1f7d46,_0x3361f3,_0x8bcf16,_0x274901){const _0x4c8007=_0x58c229;super(),this[_0x4c8007(0x157)]=_0x8ef4d1,this['_injector']=_0x1f7d46,this[_0x4c8007(0x37b)]=_0x3361f3,this[_0x4c8007(0x35a)]=_0x8bcf16,this[_0x4c8007(0x19a)]=_0x274901;const {..._0x4ade8f}=v[_0x4c8007(0x3ab)]({},Bt,this[_0x4c8007(0x157)]);this[_0x4c8007(0x35a)][_0x4c8007(0x340)](Nt,_0x4ade8f),this['_initRegisterCommand'](),this['_initConfig']();}[_0x58c229(0x389)](){const _0x38c0cd=_0x58c229;var _0x43b754;const _0x174bca=(_0x43b754=this[_0x38c0cd(0x157)])==null?void 0x0:_0x43b754[_0x38c0cd(0x3a7)];this['_configService'][_0x38c0cd(0x340)](q,_0x174bca===!0x0);}[_0x58c229(0x2ed)](){const _0x572bde=_0x58c229;var _0xce6653;let _0x36806b=[];const _0x3aa1e7=(_0xce6653=this[_0x572bde(0x157)])==null?void 0x0:_0xce6653[_0x572bde(0x3a7)];_0x3aa1e7===!0x0?_0x36806b=[[exports[_0x572bde(0x1ce)]],[exports[_0x572bde(0x2a4)]],[qe],[exports['SheetsPivotTableAdaptorModel']],[exports[_0x572bde(0x416)]],[Je],[Ge],[We],[$e]]:_0x3aa1e7===!0x1?_0x36806b=[[exports[_0x572bde(0x297)]],[Le]]:_0x3aa1e7===void 0x0&&(_0x36806b=[[exports['SheetsPivotDataSourceModel']],[Le],[exports[_0x572bde(0x1ce)]],[exports[_0x572bde(0x2a4)]],[qe],[exports[_0x572bde(0x330)]],[exports[_0x572bde(0x416)]],[Je],[Ge],[We],[$e]]),_0x36806b[_0x572bde(0x124)](_0x532f78=>this[_0x572bde(0x20c)][_0x572bde(0x289)](_0x532f78)),[Le,qe,exports[_0x572bde(0x1ce)],Ge,Je,We,$e][_0x572bde(0x124)](_0x46e676=>{const _0x2fa0df=_0x572bde;this[_0x2fa0df(0x20c)][_0x2fa0df(0x38f)](_0x46e676)&&this[_0x2fa0df(0x20c)]['get'](_0x46e676);});}[_0x58c229(0x17b)](){const _0x48a5d2=_0x58c229;[oo,no,to,io,ro,Io,ho,co,vo,fo,po,mo,ao,so,we,yt,Ye,it,Zt,eo,dt,at,st,rt,ut,ct,Fe,Ft,Rt,ot,gt,pt,ft,lt,_t,mt,ht,He,wt,go,vt,uo,lo][_0x48a5d2(0x124)](_0x17d219=>{const _0x3bd4e8=_0x48a5d2;var _0x1c2231;(_0x1c2231=this[_0x3bd4e8(0x19a)])==null||_0x1c2231[_0x3bd4e8(0x2c8)](_0x17d219),this[_0x3bd4e8(0x37b)][_0x3bd4e8(0x1a9)](_0x17d219);});}},Co(exports[_0x58c229(0x23a)],_0x58c229(0x1c0),Ct),Co(exports[_0x58c229(0x23a)],'type',v[_0x58c229(0x232)][_0x58c229(0x2cb)]),exports[_0x58c229(0x23a)]=Zn([v['DependentOn'](ue[_0x58c229(0x1a1)]),tt(0x1,v[_0x58c229(0x198)](v[_0x58c229(0x3ee)])),tt(0x2,v['Inject'](v[_0x58c229(0x341)])),tt(0x3,v['IConfigService']),tt(0x4,v[_0x58c229(0x3b0)](wo[_0x58c229(0x2e0)]))],exports['UniverSheetsPivotTablePlugin']),exports[_0x58c229(0x21c)]=to,exports['AddPivotFieldMutation']=it,exports[_0x58c229(0x122)]=no,exports[_0x58c229(0x3a1)]=we,exports[_0x58c229(0x2c1)]=oo,exports['BLANK_ROW_COUNT']=Re,exports[_0x58c229(0x13c)]=It,exports[_0x58c229(0x2e8)]=io,exports[_0x58c229(0x276)]=ao,exports[_0x58c229(0x36d)]=k,exports[_0x58c229(0x366)]=so,exports[_0x58c229(0x11f)]=j,exports[_0x58c229(0x25a)]=He,exports[_0x58c229(0x336)]=Mt,exports[_0x58c229(0x219)]=ro,exports[_0x58c229(0x2b3)]=at,exports[_0x58c229(0x186)]=Ye,exports[_0x58c229(0x1e9)]=st,exports[_0x58c229(0x2bb)]=lo,exports[_0x58c229(0x15a)]=Nt,exports['SHEET_PIVOT_TABLE_PLUGIN']=Ct,exports[_0x58c229(0x35f)]=co,exports[_0x58c229(0x1ae)]=rt,exports[_0x58c229(0x412)]=lt,exports[_0x58c229(0x1a8)]=uo,exports['SetPivotFilterCommand']=fo,exports['SetPivotFilterMutation']=dt,exports[_0x58c229(0x3f5)]=ct,exports[_0x58c229(0x39c)]=Fe,exports[_0x58c229(0x279)]=vo,exports['SetPivotSortMutation']=ut,exports[_0x58c229(0x155)]=ft,exports[_0x58c229(0x3cd)]=go,exports['SetPivotValueFilterMutation']=vt,exports[_0x58c229(0x2a6)]=ho,exports[_0x58c229(0x3b5)]=gt,exports['UpdatePivotFieldSettingCommand']=po,exports[_0x58c229(0x11d)]=ht,exports[_0x58c229(0x3df)]=mo,exports['UpdatePivotTableSourceRangeMutation']=mt,exports['UpdatePivotValuePositionCommand']=Io,exports[_0x58c229(0x16b)]=pt,exports['applyChangeSet']=ae,exports[_0x58c229(0x24f)]=Ut,exports[_0x58c229(0x31e)]=oe,exports[_0x58c229(0x20a)]=Et,exports[_0x58c229(0x415)]=ne,exports[_0x58c229(0x2ef)]=zt,exports[_0x58c229(0x328)]=Ke,exports[_0x58c229(0x2a0)]=de,exports['getPivotCellInfo']=Yt,exports[_0x58c229(0x190)]=St,exports[_0x58c229(0x1f9)]=Qt,exports[_0x58c229(0x3a5)]=Me,exports[_0x58c229(0x2d4)]=nt;