const _0x2cb6e4=_0x50cb;(function(_0x286bd4,_0x59be5a){const _0x27095e=_0x50cb,_0xa49db=_0x286bd4();while(!![]){try{const _0x11a32e=parseInt(_0x27095e(0x2f0))/0x1*(-parseInt(_0x27095e(0x356))/0x2)+-parseInt(_0x27095e(0x24b))/0x3+-parseInt(_0x27095e(0x2b5))/0x4+-parseInt(_0x27095e(0x2bc))/0x5+-parseInt(_0x27095e(0x2b9))/0x6*(parseInt(_0x27095e(0x307))/0x7)+parseInt(_0x27095e(0x26b))/0x8+parseInt(_0x27095e(0x31e))/0x9;if(_0x11a32e===_0x59be5a)break;else _0xa49db['push'](_0xa49db['shift']());}catch(_0x15cc60){_0xa49db['push'](_0xa49db['shift']());}}}(_0x148d,0x8934a));var xe=Object[_0x2cb6e4(0x23e)],Ae=(_0x1c9a8d,_0x1f5bbe,_0x2db5cd)=>_0x1f5bbe in _0x1c9a8d?xe(_0x1c9a8d,_0x1f5bbe,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x2db5cd}):_0x1c9a8d[_0x1f5bbe]=_0x2db5cd,c=(_0x1e7d87,_0xf19347,_0x5711c4)=>Ae(_0x1e7d87,typeof _0xf19347!=_0x2cb6e4(0x29f)?_0xf19347+'':_0xf19347,_0x5711c4);import{RevertRevisionMutation as _0x552bee,CreateUnitMutation as _0x48e5ca,ISnapshotServerService as _0x19371c,CompressMutationService as _0x4ada37,transformSnapshotToWorkbookData as _0x1efcef,ITransformService as _0x404d3b,parseProtocolChangeset as _0x557b83,isTransformMutationsSuccess as _0x582c81}from'@univerjs-pro/collaboration';import{SnapshotServerOverHTTPService as _0x31e1df,CollaborationImageIoService as _0x2a01f1}from'@univerjs-pro/collaboration-client';import{Disposable as _0x555e29,LocaleType as _0x5d1aa2,IUniverInstanceService as _0x381737,ICommandService as _0x241833,IConfigService as _0x32a9c2,Inject as _0x4aaff5,UniverInstanceType as _0x113232,LocaleService as _0x2d2eaf,IPermissionService as _0xbdfc78,Injector as _0x14f2b5,ObjectMatrix as _0x4abeaf,debounce as _0x5c6339,DisposableCollection as _0x15ce3c,toDisposable as _0x1fcd3d,DependentOn as _0x165f15,Plugin as _0x1587be,merge as _0x4eb917}from'@univerjs/core';import{IImageIoService as _0x5e004c}from'@univerjs/drawing';import{IRenderManagerService as _0x28ff8b,Vector2 as _0x394574,SHEET_VIEWPORT_KEY as _0x2bf945}from'@univerjs/engine-render';import{HTTPService as _0x391ae6,UniverNetworkPlugin as _0x4d145b}from'@univerjs/network';import{ICellEditorManagerService as _0x378ff3,SheetSkeletonManagerService as _0xf71e45,getCoordByCell as _0x4b40a2,getSheetObject as _0x1ec31a,UniverSheetsUIPlugin as _0x39b93f}from'@univerjs/sheets-ui';import{IMessageService as _0x964c74,IConfirmService as _0x2d9c9d,useDependency as _0x30b5c3,useObservable as _0xe37064,IUIPartsService as _0xfa5a57,BuiltInUIPart as _0x4c12ab,connectInjector as _0x3bdc12,ISidebarService as _0x52d5f4,ComponentManager as _0x2ccfa8,IDialogService as _0xdf2df3}from'@univerjs/ui';import{MessageType as _0x1a2dc5,clsx as _0x15693a,Button as _0x47226d,borderBottomClassName as _0x181437,Tooltip as _0x3fbb81}from'@univerjs/design';function _0x148d(){const _0x1a1578=['getUnitId','memberId','LOGIN_FAILED','YUUMI_UNABLE_LOAD_URL','concat','getUnitOnRev','LICENSE_IMPORT_SIZE_EXCEEDED','forValue','MOBILE_VERIFY_CODE_MISMATCH','loading-multi-icon','_status$','history-panel','currentVersion$','startColumn','_initRender','_init','getSeconds','Filter','_workbookDataCache','subType','value','loadSheet','LICENSE_EXPORT_SIZE_EXCEEDED','REDEMPTION_CODE_INACTIVE','TOO_MANY_REQUESTS','triggerRevert','unitId$','left','_getAPIPrefix','SetWorksheetStyle','flex','YUUMI_NO_CUBOID_FOR_QUESTION','assign','_combineRanges','_unitId$','fetchMissingChangesets','univer-flex\x20univer-h-12\x20univer-cursor-default\x20univer-items-center','getHours','APPLY_NON_SEQUENTIAL_REVISION','&lastLabel=','skeleton','univer-ml-2.5\x20univer-flex\x20univer-size-8\x20univer-cursor-pointer\x20univer-items-center\x20univer-justify-center\x20univer-rounded','some','_revertRevision$','versions','FloatImg','_localeService','revertRevision$','_createUnit','none','UNIVER_SLIDE','BackIcon','_openPanel','replace','code','ENTITLE_COUPON_USED_UP','_maskContainer','cellValue','width','center','univer-text-2xl\x20dark:!univer-text-white','rules','MoveSheet','triggerLoadVersions','MoveWorksheet','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-text-sm\x20univer-text-gray-600\x20dark:!univer-text-gray-200','split','COMPLETION_FINISHED','defineProperty','ranges','Loaded','name','absolute','_config','onStarting','reduce','canRevert','ENTITLE_CHAT_LIMIT_EXCEED','_getRangesByMutation','RecoverHistory','editHistory.panel.cancel','2863377MVlRRn','univer-text-sm\x20univer-leading-5\x20univer-text-gray-500\x20dark:!univer-text-gray-300','getDataRange','disposeWithMe','attrs','updatePermissionPoint','_injector','InsertHyperlink','getInterceptPoints','editHistory.panel.currentUser','DeleteColumn','univer-text-gray-500','UNIVER_SHEET','scrollEvent$','entered','REDEMPTION_INVALID_CODE','UNIVER_EDIT_HISTORY_VIEWER_PLUGIN','button','bottom','sheetId','ENTITLE_DUP_SUBSCRIPTION','currentVersionDiff$','CreateSheet','all','getDialogs$','fetchThroughInterceptors','Share','open','Exited','endColumn','YUUMI_ALL_TABLES_IS_INVALID','CONNECTOR_DATA_TOO_LARGE','2698960fDIKaN','UNDEFINED','restore-icon','_historyContainerId','span','InsertColumn','_removeDiffMarks','onRendered','loaded','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','xlink:href','History','row','blockMeta','univer-flex\x20univer-items-center\x20univer-gap-2.5\x20univer-py-1.5\x20univer-text-sm\x20univer-font-medium','versions$','commands','APPLY_DUPLICATED','flat','View','params','init','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_currentVersion$','display','_messageService','style','UNIVER_UNKNOWN','INVITE_CODE_ALREADY_BOUND','ViewHistory','_updateVersions','asObservable','current','Duplicate','position','APPLY_REJECT','registerComponent','_historyManagerService','editHistory.panel.revertDesc','_compressMutationService','userID','_permissionService','dateString','LICENSE_MAX_UNITS_EXCEEDED','editHistory.panel.revertConfirmText','YUUMI_URL_COL_OUT_OF_RANGE','rgba(58,\x2096,\x20247,\x200.20)','currentColor','getVersion','_fetching','rule','children','symbol','USER_IS_ANONYMOUS','UNIVER_PROJECT','Comment','pluginName','mask','editHistory.panel.listFetchError','subscribe','Error','_initPanel','path','REDEMPTION_USER_REDEEM_TIMES_EXCEED','historyListServerUrl','loadingState','PivotTable','user','date','RenameSheet','edit-history-viewer.config','YUUMI_SUBSCRIPTION_NOT_FOUND','EMAIL_HAS_BEEN_BOUND','next','3743852jVpEtA','M2.06678\x203.37926C2.0668\x201.94333\x203.23085\x200.779297\x204.66678\x200.779297H9.44256C10.1796\x200.779297\x2010.8821\x201.09213\x2011.3751\x201.63999L13.2659\x203.74079C13.6955\x204.21822\x2013.9333\x204.83779\x2013.9333\x205.4801V12.7126C13.9333\x2014.1486\x2012.7692\x2015.3126\x2011.3333\x2015.3126H4.66665C3.2307\x2015.3126\x202.06663\x2014.1486\x202.06665\x2012.7126L2.06678\x203.37926ZM4.66678\x201.9793C3.89359\x201.9793\x203.26679\x202.60609\x203.26678\x203.37928L3.26665\x2012.7126C3.26664\x2013.4858\x203.89344\x2014.1126\x204.66665\x2014.1126H11.3333C12.1065\x2014.1126\x2012.7333\x2013.4858\x2012.7333\x2012.7126V5.4801C12.7333\x205.44882\x2012.7322\x205.41764\x2012.7302\x205.3866H10.7985C9.91488\x205.3866\x209.19853\x204.67026\x209.19853\x203.78661V1.9793H4.66678ZM10.4832\x202.44275L12.0526\x204.1866H10.7985C10.5776\x204.1866\x2010.3985\x204.00752\x2010.3985\x203.78661V2.35649C10.4279\x202.38389\x2010.4561\x202.41266\x2010.4832\x202.44275Z','univer-flex\x20univer-size-6\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-text-gray-400\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-700','univer-h-15\x20univer-flex\x20univer-cursor-pointer\x20univer-flex-col\x20univer-justify-center\x20univer-gap-1\x20univer-rounded-md\x20univer-px-4\x20univer-py-1.5\x20univer-transition-colors\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-800','378678AcPUqV','EditExtraObject','_createMask','5087830MLwfSu','time','M8.79993\x2014.0166C8.79993\x2014.4585\x208.44176\x2014.8166\x207.99993\x2014.8166C4.23529\x2014.8166\x201.18345\x2011.7648\x201.18345\x208.00017C1.18345\x204.23554\x204.23529\x201.18369\x207.99993\x201.1837C11.7646\x201.1837\x2014.8164\x204.23554\x2014.8164\x208.00017C14.8164\x208.442\x2014.4582\x208.80017\x2014.0164\x208.80017C13.5746\x208.80017\x2013.2164\x208.442\x2013.2164\x208.00017C13.2164\x205.11919\x2010.8809\x202.7837\x207.99993\x202.7837C5.11895\x202.7837\x202.78345\x205.11919\x202.78345\x208.00017C2.78345\x2010.8812\x205.11895\x2013.2166\x207.99993\x2013.2166C8.44176\x2013.2166\x208.79993\x2013.5748\x208.79993\x2014.0166Z','M7.20007\x201.98384C7.20007\x201.54201\x207.55824\x201.18384\x208.00007\x201.18384C11.7647\x201.18384\x2014.8165\x204.23568\x2014.8165\x208.00032C14.8165\x2011.765\x2011.7647\x2014.8168\x208.00007\x2014.8168C4.23543\x2014.8168\x201.18359\x2011.765\x201.18359\x208.00032C1.18359\x207.55849\x201.54177\x207.20031\x201.98359\x207.20031C2.42542\x207.20031\x202.78359\x207.55849\x202.78359\x208.00032C2.78359\x2010.8813\x205.11909\x2013.2168\x208.00007\x2013.2168C10.8811\x2013.2168\x2013.2165\x2010.8813\x2013.2165\x208.00032C13.2165\x205.11933\x2010.8811\x202.78384\x208.00007\x202.78384C7.55824\x202.78384\x207.20007\x202.42567\x207.20007\x201.98384Z','editHistory.info.loading','/universer-api/history','INVALID_INVITE_CODE','ViemRwHgtClWdt','evenodd','SelectProtectedCells','DeleteWorksheet','editHistory.action.revertSheetSuffix','CreatePermissionObject','_cellEditorManagerService','PY_RUNTIME_SCRIPT_ERROR','editHistory.panel.title','action','_transformService','padStart','CHANGESET_REVISION_CONFILICT','_univerInstanceService','getVpScrollXYInfoByPosToVp','getOwnPropertyDescriptor','YUUMI_ASYNCIO_CANCELLED','command','ManageCollaborator','ENTITLE_USE_COUPON_NOT_1ST_TRADE','Copy','/list?length=20','_currentVersionDiff$','getMember','M7.41252\x2010.6196C7.64683\x2010.3852\x207.64683\x2010.0053\x207.41252\x209.77103L6.77012\x209.12863H9.67836C9.89927\x209.12863\x2010.0784\x209.30772\x2010.0784\x209.52863V11.1953C10.0784\x2011.5267\x2010.347\x2011.7953\x2010.6784\x2011.7953C11.0097\x2011.7953\x2011.2784\x2011.5267\x2011.2784\x2011.1953V9.52863C11.2784\x208.64497\x2010.562\x207.92863\x209.67836\x207.92863H6.77012L7.41252\x207.28623C7.64683\x207.05191\x207.64683\x206.67201\x207.41252\x206.4377C7.1782\x206.20338\x206.79831\x206.20338\x206.56399\x206.4377L4.89732\x208.10437C4.66301\x208.33868\x204.66301\x208.71858\x204.89732\x208.95289L6.56399\x2010.6196C6.79831\x2010.8539\x207.1782\x2010.8539\x207.41252\x2010.6196Z','AUTHORIZE_CODE_ILLEGAL','find','editHistory.panel.confirm','editHistory.header.revert','_uiPartsService','ERROR_AGAIN','CreateWorksheet','m1Prime','values','_extractRanges','clear','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','ENSURE_SNAPSHOT_EXECUTION','InsertRow','_sidebarDisposable','zIndex','now','executeCommand','url(#$1','createTime','1mHdjYv','onSteady','INVITE_CODE_REQUIRED','set','DeleteSheet','loading','univer-flex\x20univer-h-7\x20univer-w-full\x20univer-items-center\x20univer-justify-center','getConfig','_dialogOptions$','editHistory.panel.unknownUser','PAYMENT_CHANNEL_NOT_SUPPORT','endRevision','editSheet','back-icon','INVITE_CODE_HAS_BEEN_UES','MOBILE_HAS_BEEN_BOUND','push','http://www.w3.org/2000/svg','editHistory.action.etc','subUnitId','_members','univer-ml-2\x20univer-flex\x20univer-h-5\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-border\x20univer-border-primary-600\x20univer-bg-primary-50\x20univer-px-1.5\x20univer-text-xs\x20univer-text-primary-600','restore-icon_clip0_1247_2','84KfkAqo','data','div','#0B9EFB','toString','range','DeleteRow','confirm','univer-m-auto\x20univer-animate-spin','CopySheet','addProtection','REDEMPTION_CODE_NOT_STARTED','defIds','append','substring','mutations','_getActiveSubUnitId','showMask','_versions$','show','_lastLabel','setDV','SetRowStyle','39529665YTHUeJ','length','register','entities','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','_configService','_sheetSkeletonManagerService','_initActiveSwitch','CURRENT_STATUS_CANNOT_OPERATE','_sheetPermissionInitController','SetCellStyle','REDEMPTION_CODE_FULLY_REDEEMED','workbook','_historyFetchService','parse','DATA_SOURCE_TOO_LARGE','_componentManager','insertSheet','hideMask','Init','YUUMI_TABLE_NOT_FOUND_IN_UNIT','history-mask','INTERNAL_ERROR','Loading','dispose','UNAUTHENTICATED','endRow','has','HideSheet','interceptor','.univer-app-container-content','_versionDiffService','_loadingState$','ENTITLE_INVALID_COUPON_CODE','getAncestorScale','tag','editHistory.action.revertSheetPrefix','endRev','editHistory.panel.revertConfirm','LoadingMultiIcon','getCurrentVersion','_updateDiffMarks','ENTITLE_NEED_BILLING_ADDRESS','_commandService','Sort','idSuffix','WECHAT_HAS_BEEN_BOUND','colorChannel1','SetColumnStyle','backgroundColor','top','loadMoreVersions','justifyContent','setFrozen','_diffRangesMap','addObjects','1004434wIULfc','VIRTUAL_VERSION_NOW','startRow','getCellPositionByOffset','defs','sheet','ENTITLE_COUPON_EXPIRED','_snapshotServerService','Info','0\x200\x2016\x2016','url(#restore-icon_clip0_1247_2)','_getSheetObject','get','YUUMI_CONNECTOR_URL_NOT_FOUND','LICENSE_DISTRO_REJECTED','LOGIN_TOKEN_PROCESSING_FAILED','add','fill','filter','NOT_FOUND','_maskElement','getCurrentLocale','ENTITLE_INSUFFICIENT_QUOTA','registerRenderModule','ENTITLE_REPORT_LIMIT_EXCEED','_canRevert','Edit',':\x20(','_initMaskContainer','univerjs-icon\x20univerjs-icon-','status','map','trim','_diffs','includes','ALREADY_EXISTS','hasCommand','Export','_transformMutationByOrder','_context','svg','then','rect','ZH_CN','deleteProtection','disposeUnit','HideWorksheet','SNAPSHOT_HAS_BEEN_REMOVED','RenameWorksheet','EMAIL_VERIFY_CODE_MISMATCH','REDEMPTION_USER_NOT_ELIGIBLE','loadingState$','FromArray','column','ensureVersion','toISOString','permissionPointUpdate$','users','error','string','use','anonymous','displayName','getRelativeToViewportCoord','_renderManagerService','1em','focusUnit','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','getElementById','setValue','close','setFilter','height','_httpService','PERMISSION_DENIED','currentVersion','UNRECOGNIZED','YUUMI_AI_RUN_FAILED','ViewFilter','_hasMore','active','APPLY_PERMISSION_DENIED','recoverTime','HEADER','setCF','INVALID_ARGUMENT','EditWorksheetCell','_lastPointer','Today','pipe','onMouseMove','SetCellValue','getVersions','univer-flex\x20univer-h-6\x20univer-w-full\x20univer-justify-between','blocks','isArray','block','getMinutes','forEach','unitId','entries','SNAPSHOT_INVALID_SNAPSHOT','userId','refreshRangeProtectPermission','YUUMI_RATE_OVER_LIMIT','Print','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','exited','transformMutations','REDEMPTION_CODE_HAS_BEEN_CREATED'];_0x148d=function(){return _0x1a1578;};return _0x148d();}import{InsertSheetMutation as _0x314f47,RemoveSheetMutation as _0x2a8524,SetFrozenMutation as _0x4265c6,AddWorksheetProtectionMutation as _0x501852,AddRangeProtectionMutation as _0x156471,DeleteRangeProtectionMutation as _0x140c01,DeleteWorksheetProtectionMutation as _0x295ca5,SheetPermissionInitController as _0x43210a,WorkbookEditablePermission as _0x27b647,WorkbookRenameSheetPermission as _0x248c0b,WorkbookMoveSheetPermission as _0x26339d,WorkbookHideSheetPermission as _0x12bf61,SetWorksheetHideMutation as _0x475e4e,SetRangeValuesMutation as _0x31d683,SetRangeProtectionMutation as _0x55ea74,ReorderRangeMutation as _0x393e31,RemoveNumfmtMutation as _0x29833f,SetNumfmtMutation as _0x4b3887,MoveColsMutation as _0x3743c6,MoveRowsMutation as _0x388f9b,MoveRangeMutation as _0x36eed8,InsertColMutation as _0xe46a58,InsertRowMutation as _0x179536,AddWorksheetMergeMutation as _0x42495d,RangeMergeUtil as _0x56d55d,findAllRectangle as _0x398609,SetWorksheetActiveOperation as _0x58ed03}from'@univerjs/sheets';import{BehaviorSubject as _0x2c8b5b,combineLatest as _0x1dc938,switchMap as _0x5553c3,map as _0x32acdf,of as _0x20a5f7,debounceTime as _0x1d2b6d,Subject as _0x19ef2a}from'rxjs';import{InsertSheetsChartMutation as _0x154edf}from'@univerjs-pro/sheets-chart';import{AddSheetSparklineMutation as _0xce0579}from'@univerjs-pro/sheets-sparkline';import{AddDataValidationMutation as _0x5abfc9,UpdateDataValidationMutation as _0x36440a}from'@univerjs/data-validation';import{SetConditionalRuleMutation as _0x8be438,AddConditionalRuleMutation as _0x399d6e}from'@univerjs/sheets-conditional-formatting';import{SetSheetsFilterRangeMutation as _0x1073da}from'@univerjs/sheets-filter';import{jsxs as _0x4f314f,jsx as _0x30c25d}from'react/jsx-runtime';import{useRef as _0x1f51c9,createElement as _0x33de19,forwardRef as _0x21d9e4,useCallback as _0x511d34,useState as _0x25215d,Fragment as _0x41b79c}from'react';import{SheetCollabCursorShape as _0x447436}from'@univerjs-pro/collaboration-client-ui';const be=_0x2cb6e4(0x2b1),le={};var is=Object[_0x2cb6e4(0x2d2)],ns=(_0x5abf86,_0x4b57d1,_0x1d4f63,_0x20fd9e)=>{const _0x473685=_0x2cb6e4;for(var _0x133de6=_0x20fd9e>0x1?void 0x0:_0x20fd9e?is(_0x4b57d1,_0x1d4f63):_0x4b57d1,_0x16374f=_0x5abf86[_0x473685(0x31f)]-0x1,_0x279ae2;_0x16374f>=0x0;_0x16374f--)(_0x279ae2=_0x5abf86[_0x16374f])&&(_0x133de6=_0x279ae2(_0x133de6)||_0x133de6);return _0x133de6;},rs=(_0x586229,_0x3dff5e)=>(_0x5ceff3,_0x526549)=>_0x3dff5e(_0x5ceff3,_0x526549,_0x586229);let H=class extends _0x555e29{constructor(_0x134592){const _0x1a8f28=_0x2cb6e4;super(),this['_cellEditorManagerService']=_0x134592,this[_0x1a8f28(0x209)]();}['_init'](){const _0x2af054=_0x2cb6e4;this[_0x2af054(0x24e)](this['_cellEditorManagerService']['state$'][_0x2af054(0x2a6)](_0xd40cf5=>{const _0x4c4d11=_0x2af054;_0xd40cf5!=null&&_0xd40cf5[_0x4c4d11(0x31a)]&&this[_0x4c4d11(0x2c9)]['setState']({'show':!0x1});}));}};H=ns([rs(0x0,_0x378ff3)],H);var W=(_0x93d74b=>(_0x93d74b[_0x93d74b[_0x2cb6e4(0x26c)]=0x0]=_0x2cb6e4(0x26c),_0x93d74b[_0x93d74b['OK']=0x1]='OK',_0x93d74b[_0x93d74b[_0x2cb6e4(0x334)]=0x2]=_0x2cb6e4(0x334),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1d6)]=0x3]=_0x2cb6e4(0x1d6),_0x93d74b[_0x93d74b[_0x2cb6e4(0x19f)]=0x4]=_0x2cb6e4(0x19f),_0x93d74b[_0x93d74b[_0x2cb6e4(0x337)]=0x5]=_0x2cb6e4(0x337),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1af)]=0x6]=_0x2cb6e4(0x1af),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1e1)]=0x7]=_0x2cb6e4(0x1e1),_0x93d74b[_0x93d74b[_0x2cb6e4(0x212)]=0x8]='TOO_MANY_REQUESTS',_0x93d74b[_0x93d74b['COMPLETION_FINISHED']=0x9]=_0x2cb6e4(0x23d),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1fc)]=0xa]='LOGIN_FAILED',_0x93d74b[_0x93d74b[_0x2cb6e4(0x202)]=0xb]=_0x2cb6e4(0x202),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2e7)]=0xc]='MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0x93d74b[_0x93d74b[_0x2cb6e4(0x1bd)]=0xd]=_0x2cb6e4(0x1bd),_0x93d74b[_0x93d74b[_0x2cb6e4(0x322)]=0xe]=_0x2cb6e4(0x322),_0x93d74b[_0x93d74b['AUTHORIZE_CODE_ILLEGAL']=0xf]=_0x2cb6e4(0x2dc),_0x93d74b[_0x93d74b[_0x2cb6e4(0x19b)]=0x10]=_0x2cb6e4(0x19b),_0x93d74b[_0x93d74b[_0x2cb6e4(0x326)]=0x64]=_0x2cb6e4(0x326),_0x93d74b[_0x93d74b['ERROR_AGAIN']=0x65]=_0x2cb6e4(0x2e1),_0x93d74b[_0x93d74b['USER_NOT_FOUND']=0xc9]='USER_NOT_FOUND',_0x93d74b[_0x93d74b[_0x2cb6e4(0x2a0)]=0xca]=_0x2cb6e4(0x2a0),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2cf)]=0x1389]='CHANGESET_REVISION_CONFILICT',_0x93d74b[_0x93d74b[_0x2cb6e4(0x1f1)]=0x1771]=_0x2cb6e4(0x1f1),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1bb)]=0x1772]=_0x2cb6e4(0x1bb),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2e8)]=0x1773]=_0x2cb6e4(0x2e8),_0x93d74b[_0x93d74b[_0x2cb6e4(0x28e)]=0x1b59]='APPLY_REJECT',_0x93d74b[_0x93d74b[_0x2cb6e4(0x220)]=0x1b5a]='APPLY_NON_SEQUENTIAL_REVISION',_0x93d74b[_0x93d74b['APPLY_REVISION_CONFILICT']=0x1b5b]='APPLY_REVISION_CONFILICT',_0x93d74b[_0x93d74b[_0x2cb6e4(0x1dd)]=0x1b5c]=_0x2cb6e4(0x1dd),_0x93d74b[_0x93d74b[_0x2cb6e4(0x27c)]=0x1b5d]=_0x2cb6e4(0x27c),_0x93d74b[_0x93d74b[_0x2cb6e4(0x26a)]=0x1f41]=_0x2cb6e4(0x26a),_0x93d74b[_0x93d74b['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]=_0x2cb6e4(0x296),_0x93d74b[_0x93d74b[_0x2cb6e4(0x274)]=0x232a]=_0x2cb6e4(0x274),_0x93d74b[_0x93d74b[_0x2cb6e4(0x200)]=0x232b]=_0x2cb6e4(0x200),_0x93d74b[_0x93d74b['LICENSE_EXPORT_SIZE_EXCEEDED']=0x232c]=_0x2cb6e4(0x210),_0x93d74b[_0x93d74b['LICENSE_DISTRO_REJECTED']=0x232d]=_0x2cb6e4(0x19a),_0x93d74b[_0x93d74b['YUUMI_UNABLE_LOAD_URL']=0x2711]=_0x2cb6e4(0x1fd),_0x93d74b[_0x93d74b[_0x2cb6e4(0x298)]=0x2712]=_0x2cb6e4(0x298),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1f4)]=0x2713]=_0x2cb6e4(0x1f4),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2b2)]=0x2714]=_0x2cb6e4(0x2b2),_0x93d74b[_0x93d74b[_0x2cb6e4(0x219)]=0x271a]=_0x2cb6e4(0x219),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2d3)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0x93d74b[_0x93d74b[_0x2cb6e4(0x332)]=0x271c]=_0x2cb6e4(0x332),_0x93d74b[_0x93d74b[_0x2cb6e4(0x269)]=0x271d]='YUUMI_ALL_TABLES_IS_INVALID',_0x93d74b[_0x93d74b[_0x2cb6e4(0x1f6)]=0x271e]=_0x2cb6e4(0x1f6),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1d9)]=0x271f]=_0x2cb6e4(0x1d9),_0x93d74b[_0x93d74b[_0x2cb6e4(0x199)]=0x2720]=_0x2cb6e4(0x199),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2ca)]=0x2af9]=_0x2cb6e4(0x2ca),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2fe)]=0x2ee1]=_0x2cb6e4(0x2fe),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2c2)]=0x2ee2]=_0x2cb6e4(0x2c2),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2f2)]=0x2ee3]=_0x2cb6e4(0x2f2),_0x93d74b[_0x93d74b['USER_NOT_INVITED_CODE']=0x2ee4]='USER_NOT_INVITED_CODE',_0x93d74b[_0x93d74b[_0x2cb6e4(0x287)]=0x2ee5]='INVITE_CODE_ALREADY_BOUND',_0x93d74b[_0x93d74b[_0x2cb6e4(0x34c)]=0x32c9]='WECHAT_HAS_BEEN_BOUND',_0x93d74b[_0x93d74b[_0x2cb6e4(0x2ff)]=0x32ca]=_0x2cb6e4(0x2ff),_0x93d74b[_0x93d74b['EMAIL_HAS_BEEN_BOUND']=0x32cb]=_0x2cb6e4(0x2b3),_0x93d74b[_0x93d74b[_0x2cb6e4(0x281)]=0x36b1]='ENTITLE_CAN_NOT_BUY_LOWER_OTP',_0x93d74b[_0x93d74b[_0x2cb6e4(0x1cf)]=0x36b2]=_0x2cb6e4(0x1cf),_0x93d74b[_0x93d74b['ENTITLE_DUP_SUBSCRIPTION']=0x36b3]=_0x2cb6e4(0x25f),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2fa)]=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0x93d74b[_0x93d74b['ENTITLE_INVALID_COUPON_CODE']=0x36b5]=_0x2cb6e4(0x33f),_0x93d74b[_0x93d74b['ENTITLE_COUPON_EXPIRED']=0x36b6]=_0x2cb6e4(0x35c),_0x93d74b[_0x93d74b[_0x2cb6e4(0x231)]=0x36b7]=_0x2cb6e4(0x231),_0x93d74b[_0x93d74b['ENTITLE_USE_COUPON_NOT_1ST_TRADE']=0x36b8]=_0x2cb6e4(0x2d6),_0x93d74b[_0x93d74b[_0x2cb6e4(0x247)]=0x3715]='ENTITLE_CHAT_LIMIT_EXCEED',_0x93d74b[_0x93d74b['ENTITLE_REPORT_LIMIT_EXCEED']=0x3716]=_0x2cb6e4(0x1a4),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1a2)]=0x3717]=_0x2cb6e4(0x1a2),_0x93d74b[_0x93d74b[_0x2cb6e4(0x348)]=0x37dd]=_0x2cb6e4(0x348),_0x93d74b[_0x93d74b[_0x2cb6e4(0x25a)]=0x3a99]=_0x2cb6e4(0x25a),_0x93d74b[_0x93d74b['REDEMPTION_CODE_INACTIVE']=0x3a9a]=_0x2cb6e4(0x211),_0x93d74b[_0x93d74b[_0x2cb6e4(0x329)]=0x3a9b]=_0x2cb6e4(0x329),_0x93d74b[_0x93d74b[_0x2cb6e4(0x312)]=0x3a9c]='REDEMPTION_CODE_NOT_STARTED',_0x93d74b[_0x93d74b['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x2cb6e4(0x1be),_0x93d74b[_0x93d74b[_0x2cb6e4(0x2aa)]=0x3a9e]=_0x2cb6e4(0x2aa),_0x93d74b[_0x93d74b['REDEMPTION_CODE_HAS_BEEN_CREATED']=0x3a9f]=_0x2cb6e4(0x1f9),_0x93d74b[_0x93d74b['DATA_SOURCE_TOO_LARGE']=0x3e81]=_0x2cb6e4(0x32d),_0x93d74b[_0x93d74b[_0x2cb6e4(0x1d8)]=-0x1]='UNRECOGNIZED',_0x93d74b))(W||{}),x=(_0x558f80=>(_0x558f80[_0x558f80['UNIVER_UNKNOWN']=0x0]=_0x2cb6e4(0x286),_0x558f80[_0x558f80['UNIVER_DOC']=0x1]='UNIVER_DOC',_0x558f80[_0x558f80[_0x2cb6e4(0x257)]=0x2]=_0x2cb6e4(0x257),_0x558f80[_0x558f80[_0x2cb6e4(0x22c)]=0x3]='UNIVER_SLIDE',_0x558f80[_0x558f80[_0x2cb6e4(0x2a1)]=0x4]=_0x2cb6e4(0x2a1),_0x558f80[_0x558f80[_0x2cb6e4(0x1d8)]=-0x1]=_0x2cb6e4(0x1d8),_0x558f80))(x||{}),D=(_0x51e234=>(_0x51e234[_0x51e234[_0x2cb6e4(0x27e)]=0x0]=_0x2cb6e4(0x27e),_0x51e234[_0x51e234[_0x2cb6e4(0x1a6)]=0x1]=_0x2cb6e4(0x1a6),_0x51e234[_0x51e234[_0x2cb6e4(0x2d5)]=0x2]='ManageCollaborator',_0x51e234[_0x51e234[_0x2cb6e4(0x1f5)]=0x3]='Print',_0x51e234[_0x51e234[_0x2cb6e4(0x28c)]=0x4]='Duplicate',_0x51e234[_0x51e234[_0x2cb6e4(0x2a2)]=0x5]=_0x2cb6e4(0x2a2),_0x51e234[_0x51e234[_0x2cb6e4(0x2d7)]=0x6]='Copy',_0x51e234[_0x51e234[_0x2cb6e4(0x265)]=0x7]=_0x2cb6e4(0x265),_0x51e234[_0x51e234[_0x2cb6e4(0x1b1)]=0x8]=_0x2cb6e4(0x1b1),_0x51e234[_0x51e234['MoveWorksheet']=0x9]=_0x2cb6e4(0x23a),_0x51e234[_0x51e234[_0x2cb6e4(0x2c6)]=0xa]=_0x2cb6e4(0x2c6),_0x51e234[_0x51e234['HideWorksheet']=0xb]=_0x2cb6e4(0x1ba),_0x51e234[_0x51e234['RenameWorksheet']=0xc]=_0x2cb6e4(0x1bc),_0x51e234[_0x51e234[_0x2cb6e4(0x2e2)]=0xd]=_0x2cb6e4(0x2e2),_0x51e234[_0x51e234[_0x2cb6e4(0x217)]=0xe]=_0x2cb6e4(0x217),_0x51e234[_0x51e234[_0x2cb6e4(0x1e2)]=0xf]='EditWorksheetCell',_0x51e234[_0x51e234[_0x2cb6e4(0x252)]=0x10]=_0x2cb6e4(0x252),_0x51e234[_0x51e234[_0x2cb6e4(0x34a)]=0x11]=_0x2cb6e4(0x34a),_0x51e234[_0x51e234[_0x2cb6e4(0x20b)]=0x12]=_0x2cb6e4(0x20b),_0x51e234[_0x51e234['PivotTable']=0x13]=_0x2cb6e4(0x2ad),_0x51e234[_0x51e234[_0x2cb6e4(0x227)]=0x14]=_0x2cb6e4(0x227),_0x51e234[_0x51e234['History']=0x15]=_0x2cb6e4(0x276),_0x51e234[_0x51e234['RwHgtClWdt']=0x16]='RwHgtClWdt',_0x51e234[_0x51e234[_0x2cb6e4(0x2c3)]=0x17]='ViemRwHgtClWdt',_0x51e234[_0x51e234[_0x2cb6e4(0x1da)]=0x18]='ViewFilter',_0x51e234[_0x51e234[_0x2cb6e4(0x238)]=0x19]=_0x2cb6e4(0x238),_0x51e234[_0x51e234['DeleteSheet']=0x1a]=_0x2cb6e4(0x2f4),_0x51e234[_0x51e234[_0x2cb6e4(0x33a)]=0x1b]=_0x2cb6e4(0x33a),_0x51e234[_0x51e234[_0x2cb6e4(0x310)]=0x1c]=_0x2cb6e4(0x310),_0x51e234[_0x51e234[_0x2cb6e4(0x2b0)]=0x1d]=_0x2cb6e4(0x2b0),_0x51e234[_0x51e234[_0x2cb6e4(0x261)]=0x1e]=_0x2cb6e4(0x261),_0x51e234[_0x51e234[_0x2cb6e4(0x2c5)]=0x1f]='SelectProtectedCells',_0x51e234[_0x51e234['SelectUnProtectedCells']=0x20]='SelectUnProtectedCells',_0x51e234[_0x51e234[_0x2cb6e4(0x328)]=0x21]=_0x2cb6e4(0x328),_0x51e234[_0x51e234[_0x2cb6e4(0x1e7)]=0x22]=_0x2cb6e4(0x1e7),_0x51e234[_0x51e234[_0x2cb6e4(0x31d)]=0x23]='SetRowStyle',_0x51e234[_0x51e234['SetColumnStyle']=0x24]=_0x2cb6e4(0x34e),_0x51e234[_0x51e234[_0x2cb6e4(0x2e9)]=0x25]=_0x2cb6e4(0x2e9),_0x51e234[_0x51e234[_0x2cb6e4(0x270)]=0x26]='InsertColumn',_0x51e234[_0x51e234[_0x2cb6e4(0x30d)]=0x27]=_0x2cb6e4(0x30d),_0x51e234[_0x51e234[_0x2cb6e4(0x255)]=0x28]='DeleteColumn',_0x51e234[_0x51e234[_0x2cb6e4(0x2ba)]=0x29]='EditExtraObject',_0x51e234[_0x51e234['Delete']=0x2a]='Delete',_0x51e234[_0x51e234[_0x2cb6e4(0x249)]=0x2b]=_0x2cb6e4(0x249),_0x51e234[_0x51e234[_0x2cb6e4(0x288)]=0x2c]=_0x2cb6e4(0x288),_0x51e234[_0x51e234[_0x2cb6e4(0x2c8)]=0x2d]=_0x2cb6e4(0x2c8),_0x51e234[_0x51e234[_0x2cb6e4(0x1d8)]=-0x1]=_0x2cb6e4(0x1d8),_0x51e234))(D||{});function _0x50cb(_0xedf58e,_0xe747ef){_0xedf58e=_0xedf58e-0x193;const _0x148d25=_0x148d();let _0x50cb45=_0x148d25[_0xedf58e];return _0x50cb45;}function as(_0x59c6ba){const _0x6937d2=_0x2cb6e4;return!!(_0x59c6ba&&_0x59c6ba[_0x6937d2(0x230)]&&_0x59c6ba[_0x6937d2(0x230)]!==W['OK']&&_0x59c6ba[_0x6937d2(0x230)]!=='OK');}const ie=(_0x22314b,_0x57adac)=>{const _0x3de710=_0x2cb6e4;if(!_0x22314b)return{'date':'','time':''};const _0x57febc=new Date(_0x22314b),_0x372440=_0x57febc[_0x3de710(0x1c3)]()['split']('T')[0x0];switch(_0x57adac){case _0x5d1aa2[_0x3de710(0x1b7)]:return{'date':J(_0x372440,_0x57adac),'time':_0x57febc[_0x3de710(0x21f)]()+':'+String(_0x57febc[_0x3de710(0x1ed)]())[_0x3de710(0x2ce)](0x2,'0')+':'+String(_0x57febc[_0x3de710(0x20a)]())['padStart'](0x2,'0')};default:return{'date':J(_0x372440,_0x57adac),'time':_0x57febc['getHours']()+':'+_0x57febc['getMinutes']()+':'+_0x57febc[_0x3de710(0x20a)]()};}},os=(_0x59bf95,_0xcd9081)=>{const _0x2b8a1e=_0x2cb6e4,_0x576352=_0x59bf95[_0x2b8a1e(0x2ae)]||_0xcd9081['t'](_0x2b8a1e(0x2f9));if(_0x59bf95['commands'][_0x2b8a1e(0x224)](_0x540539=>_0x540539===_0x552bee['id'])&&_0x59bf95[_0x2b8a1e(0x1de)]){const _0x9c7d8d=ie(_0x59bf95[_0x2b8a1e(0x1de)],_0xcd9081[_0x2b8a1e(0x1a1)]()),_0x39daa0=_0x9c7d8d['date']+'\x20'+_0x9c7d8d[_0x2b8a1e(0x2bd)];return _0x576352+'\x20'+_0xcd9081['t'](_0x2b8a1e(0x342))+'\x20'+_0x39daa0+'\x20'+_0xcd9081['t'](_0x2b8a1e(0x2c7));}const _0x4585d5=_s(_0x59bf95),_0x371d6c=_0x4585d5['length']===0x1?_0xcd9081['t'](_0x4585d5[0x0]):''+_0xcd9081['t'](_0x4585d5[0x0])+_0xcd9081['t'](_0x2b8a1e(0x302));return _0x576352+'\x20'+_0x371d6c;};function _s(_0x2408c5){const _0x418bb5=_0x2cb6e4;if(_0x2408c5[_0x418bb5(0x27b)][_0x418bb5(0x31f)]===0x0)return[''];const _0x39c82a='editHistory.action.',_0x174c99=_0x39c82a+_0x418bb5(0x2fc),_0x2f44f0=[{'id':_0x48e5ca['id'],'action':_0x39c82a+'createSheet'},{'id':_0x552bee['id'],'action':_0x39c82a+'revertSheet'},{'id':_0x314f47['id'],'action':_0x39c82a+_0x418bb5(0x32f)},{'id':_0x2a8524['id'],'action':_0x39c82a+'removeSheet'},{'id':_0x4265c6['id'],'action':_0x39c82a+_0x418bb5(0x353)},{'id':_0x1073da['id'],'action':_0x39c82a+_0x418bb5(0x1d3)},{'id':_0x5abfc9['id'],'action':_0x39c82a+'setDV'},{'id':_0x36440a['id'],'action':_0x39c82a+_0x418bb5(0x31c)},{'id':_0x8be438['id'],'action':_0x39c82a+_0x418bb5(0x1e0)},{'id':_0x399d6e['id'],'action':_0x39c82a+_0x418bb5(0x1e0)},{'id':_0x501852['id'],'action':_0x39c82a+_0x418bb5(0x311)},{'id':_0x156471['id'],'action':_0x39c82a+'addProtection'},{'id':_0xce0579['id'],'action':_0x39c82a+'addSparkline'},{'id':_0x154edf['id'],'action':_0x39c82a+'insertChart'},{'id':_0x140c01['id'],'action':_0x39c82a+_0x418bb5(0x1b8)},{'id':_0x295ca5['id'],'action':_0x39c82a+_0x418bb5(0x1b8)}][_0x418bb5(0x19e)](_0x503c29=>_0x2408c5[_0x418bb5(0x27b)][_0x418bb5(0x1ae)](_0x503c29['id']));return _0x2f44f0!=null&&_0x2f44f0[_0x418bb5(0x31f)]?_0x2f44f0['map'](_0x8321b2=>_0x8321b2[_0x418bb5(0x2cc)]):[_0x174c99];}function J(_0x2d0e13,_0x1834bb){const _0x6961b3=_0x2cb6e4,[_0x35730e,_0x280bd6,_0x1ed049]=new Date()[_0x6961b3(0x1c3)]()['split']('T')[0x0][_0x6961b3(0x23c)]('-'),[_0xe1f42b,_0x3b05cc,_0x2cee5e]=_0x2d0e13[_0x6961b3(0x23c)]('-'),_0x6a6aa4=_0x35730e===_0xe1f42b&&_0x280bd6===_0x3b05cc&&_0x1ed049===_0x2cee5e;let _0x4314c8='',_0x51b381='',_0x31a7e7='';switch(_0x1834bb){case _0x5d1aa2[_0x6961b3(0x1b7)]:return _0x6a6aa4?'今天':(_0x4314c8=_0x35730e===_0xe1f42b?'':_0xe1f42b+'年',_0x51b381=_0x3b05cc+'月',_0x31a7e7=_0x2cee5e+'日',''+_0x4314c8+_0x51b381+_0x31a7e7);default:return _0x6a6aa4?_0x6961b3(0x1e4):(_0x4314c8=_0x35730e===_0xe1f42b?'':_0xe1f42b+'-',_0x51b381=_0x3b05cc+'-',_0x31a7e7=''+_0x2cee5e,''+_0x4314c8+_0x51b381+_0x31a7e7);}}function cs(_0x97e502){const _0xc1d988=_0x2cb6e4;return _0x97e502?_0x97e502[_0xc1d988(0x245)]((_0x430010,_0x35e740)=>{const _0x345564=_0xc1d988,_0x1d50fc=new Date(_0x35e740[_0x345564(0x2bd)])[_0x345564(0x1c3)]()[_0x345564(0x23c)]('T')[0x0];return _0x430010['length']>0x0&&_0x430010[_0x430010[_0x345564(0x31f)]-0x1][_0x345564(0x295)]===_0x1d50fc?_0x430010[_0x430010[_0x345564(0x31f)]-0x1][_0x345564(0x226)][_0x345564(0x300)](_0x35e740):_0x430010[_0x345564(0x300)]({'dateString':_0x1d50fc,'versions':[_0x35e740]}),_0x430010;},[]):[];}var ls=Object['getOwnPropertyDescriptor'],us=(_0x3de2b2,_0x5d2fb6,_0x2fbb19,_0x26b3af)=>{const _0x191b6c=_0x2cb6e4;for(var _0x3014c2=_0x26b3af>0x1?void 0x0:_0x26b3af?ls(_0x5d2fb6,_0x2fbb19):_0x5d2fb6,_0x283ad0=_0x3de2b2[_0x191b6c(0x31f)]-0x1,_0x31e730;_0x283ad0>=0x0;_0x283ad0--)(_0x31e730=_0x3de2b2[_0x283ad0])&&(_0x3014c2=_0x31e730(_0x3014c2)||_0x3014c2);return _0x3014c2;},R=(_0x29951d,_0x581687)=>(_0x383fea,_0x10107b)=>_0x581687(_0x383fea,_0x10107b,_0x29951d);const hs=_0x2cb6e4(0x2c1);let A=class extends _0x555e29{constructor(_0x43b9e5,_0x1ab710,_0x2dbf81,_0x5c9a8c,_0x176db2,_0x494145,_0x1ce79e){const _0x32613e=_0x2cb6e4;super(),c(this,_0x32613e(0x20c),new Map()),(this[_0x32613e(0x193)]=_0x43b9e5,this['_univerInstanceService']=_0x1ab710,this[_0x32613e(0x349)]=_0x2dbf81,this[_0x32613e(0x323)]=_0x5c9a8c,this[_0x32613e(0x1d5)]=_0x176db2,this[_0x32613e(0x292)]=_0x494145,this[_0x32613e(0x327)]=_0x1ce79e);}['dispose'](){const _0x4236e4=_0x2cb6e4;this['_workbookDataCache'][_0x4236e4(0x2e6)](),super['dispose']();}async[_0x2cb6e4(0x1e8)](_0x47df6c,_0x11088c){const _0x5ea28b=_0x2cb6e4,_0x1c5107=this[_0x5ea28b(0x216)]()+'/'+_0x47df6c+_0x5ea28b(0x2d8)+(_0x11088c?_0x5ea28b(0x221)+_0x11088c:'');try{const _0x1cc02c=(await this[_0x5ea28b(0x1d5)]['get'](_0x1c5107))['body'];if(_0x1cc02c&&_0x1cc02c[_0x5ea28b(0x1c6)]&&_0x1cc02c[_0x5ea28b(0x1c6)][_0x5ea28b(0x230)]===W['OK']){const {hasMore:_0x1ee022,lastLabel:_0x196a01}=_0x1cc02c,_0x10e58b=Is(_0x1cc02c),_0x434a55=_0x1cc02c[_0x5ea28b(0x321)][_0x5ea28b(0x1c5)];return{'hasMore':_0x1ee022,'lastLabel':_0x196a01,'versions':_0x10e58b,'members':_0x434a55};}}catch(_0x2daf5f){console[_0x5ea28b(0x1c6)](_0x2daf5f);}return null;}[_0x2cb6e4(0x216)](){const _0x206f47=_0x2cb6e4;var _0x1fda72;const _0x3f7333=this[_0x206f47(0x323)][_0x206f47(0x2f7)](be);return(_0x1fda72=_0x3f7333==null?void 0x0:_0x3f7333[_0x206f47(0x2ab)])!=null?_0x1fda72:hs;}async[_0x2cb6e4(0x20f)](_0x3f0891,_0xaf0833,_0x654e37){const _0x4fe727=_0x2cb6e4;var _0xe0f308,_0x5b5ba3;_0x654e37===void 0x0&&(_0x654e37={}),this[_0x4fe727(0x20c)][_0x4fe727(0x339)](_0x3f0891)||this[_0x4fe727(0x20c)][_0x4fe727(0x2f3)](_0x3f0891,new Map());const {snapshot:_0x47a2e6,changesets:_0x5ec0bc,error:_0xe153d8}=await this[_0x4fe727(0x193)][_0x4fe727(0x1ff)](_0x654e37,{'unitID':_0x3f0891,'type':x[_0x4fe727(0x257)],'revision':_0xaf0833});if(as(_0xe153d8)||!_0x47a2e6||!_0x47a2e6[_0x4fe727(0x32a)])throw new Error('[HistoryFetchService]:\x20request\x20snapshot\x20error!');const _0x3b52bb=(_0xe0f308=_0x5ec0bc==null?void 0x0:_0x5ec0bc[_0x4fe727(0x31f)])!=null?_0xe0f308:0x0;if(_0xaf0833!==0x0&&_0x47a2e6['rev']+_0x3b52bb!==_0xaf0833)throw new Error('[HistoryFetchService]:\x20wrong\x20rev\x20from\x20the\x20server!');const {workbook:_0x1bd416}=_0x47a2e6,_0x2a9ef4=_0x1bd416[_0x4fe727(0x278)]?Object['entries'](_0x1bd416[_0x4fe727(0x278)])[_0x4fe727(0x1ab)](([_0xe9f019,_0x4074d1])=>{const _0x13e968=_0x4fe727;var _0xbd0a6f,_0x10721b;return(_0x10721b=(_0xbd0a6f=_0x4074d1[_0x13e968(0x1ea)])==null?void 0x0:_0xbd0a6f[_0x13e968(0x1ab)](_0x262c1e=>_0x262c1e))!=null?_0x10721b:[];})[_0x4fe727(0x27d)]():[],_0x482d1c=(await Promise[_0x4fe727(0x262)](_0x2a9ef4[_0x4fe727(0x1ab)](_0x2c1b1f=>this['_snapshotServerService']['getDeserializedSheetBlock'](_0x654e37,{'unitID':_0x3f0891,'type':x[_0x4fe727(0x257)],'blockID':_0x2c1b1f})[_0x4fe727(0x1b5)](_0x16afce=>_0x16afce[_0x4fe727(0x1ec)]))))['filter'](_0x430e51=>!!_0x430e51),_0xbe0ad1=_0x1efcef(_0x47a2e6,_0x482d1c,_0x654e37);return(_0x5b5ba3=this[_0x4fe727(0x20c)]['get'](_0x3f0891))==null||_0x5b5ba3[_0x4fe727(0x2f3)](_0xaf0833,{'workbook':_0xbe0ad1}),new Promise(_0x89a27b=>{const _0x2dc5c0=_0x4fe727,_0x549745=this[_0x2dc5c0(0x2d0)]['getCurrentUnitForType'](_0x113232[_0x2dc5c0(0x257)]);_0x549745?(this[_0x2dc5c0(0x2d0)][_0x2dc5c0(0x1b9)](_0x549745['getUnitId']()),setTimeout(()=>{const _0x4396c7=_0x2dc5c0;this[_0x4396c7(0x22a)](_0xbe0ad1,_0x5ec0bc),this[_0x4396c7(0x327)][_0x4396c7(0x1f3)](),_0x89a27b(!0x0);},0x0)):(this[_0x2dc5c0(0x22a)](_0xbe0ad1,_0x5ec0bc),_0x89a27b(!0x0));});}['_createUnit'](_0x202bb1,_0x2c6191){const _0x160eef=_0x2cb6e4,_0x10724f=this[_0x160eef(0x2d0)]['createUnit'](_0x113232['UNIVER_SHEET'],_0x202bb1);this['_univerInstanceService'][_0x160eef(0x1ce)](_0x10724f[_0x160eef(0x1fa)]());const _0x188f09=this[_0x160eef(0x292)][_0x160eef(0x33b)][_0x160eef(0x264)](this['_compressMutationService']['interceptor'][_0x160eef(0x253)]()['COMPRESS_MUTATION_APPLY']);return _0x2c6191==null||_0x2c6191[_0x160eef(0x1ee)](_0x38e99a=>{const _0x48c2e4=_0x160eef,_0x55efb9=_0x38e99a[_0x48c2e4(0x316)][_0x48c2e4(0x1ab)](_0x4e6c7d=>({'id':_0x4e6c7d['id'],'params':JSON[_0x48c2e4(0x32c)](_0x4e6c7d[_0x48c2e4(0x308)])}));({..._0x38e99a,'mutations':_0x188f09(_0x55efb9,null)||_0x55efb9}[_0x48c2e4(0x316)][_0x48c2e4(0x1ee)](_0x3c3cfd=>{const _0x17eca4=_0x48c2e4;this['_commandService'][_0x17eca4(0x1b0)](_0x3c3cfd['id'])&&this[_0x17eca4(0x349)]['syncExecuteCommand'](_0x3c3cfd['id'],_0x3c3cfd[_0x17eca4(0x27f)]);}));}),_0x10724f;}};A=us([R(0x0,_0x19371c),R(0x1,_0x381737),R(0x2,_0x241833),R(0x3,_0x32a9c2),R(0x4,_0x4aaff5(_0x391ae6)),R(0x5,_0x4aaff5(_0x4ada37)),R(0x6,_0x4aaff5(_0x43210a))],A);function Is(_0x8fc9b9){const _0x4600dd=_0x2cb6e4;var _0x549334,_0x5eca27;const _0x366ddb=[],{entities:_0x3abccb,historyIds:_0xa497c5}=_0x8fc9b9,{datas:_0x2ffffe,users:_0x1fcf58}=_0x3abccb;for(const _0xbe45d9 of _0xa497c5)if(_0x2ffffe[_0xbe45d9]){const _0x165c4f=!!((_0x549334=_0x1fcf58[_0x2ffffe[_0xbe45d9][_0x4600dd(0x1f2)]])!=null&&_0x549334[_0x4600dd(0x1c9)]);_0x366ddb[_0x4600dd(0x300)]({'unitId':_0x2ffffe[_0xbe45d9][_0x4600dd(0x1ef)],'user':_0x165c4f?'':((_0x5eca27=_0x1fcf58==null?void 0x0:_0x1fcf58[_0x2ffffe[_0xbe45d9][_0x4600dd(0x1f2)]])==null?void 0x0:_0x5eca27[_0x4600dd(0x241)])||'','isAnonymous':_0x165c4f,'id':_0xbe45d9,'time':_0x2ffffe[_0xbe45d9][_0x4600dd(0x2ef)]?Number(_0x2ffffe[_0xbe45d9]['createTime']):void 0x0,'commands':_0x2ffffe[_0xbe45d9][_0x4600dd(0x2d4)],'startRev':Number(_0x2ffffe[_0xbe45d9]['startRevision']),'endRev':Number(_0x2ffffe[_0xbe45d9][_0x4600dd(0x2fb)]),'recoverTime':_0x2ffffe[_0xbe45d9][_0x4600dd(0x1de)]?Number(_0x2ffffe[_0xbe45d9][_0x4600dd(0x1de)]):void 0x0});}return _0x366ddb;}var ds=Object[_0x2cb6e4(0x2d2)],vs=(_0x39338d,_0x56d539,_0x388420,_0x1df1c5)=>{const _0x1bf8c8=_0x2cb6e4;for(var _0x1af921=_0x1df1c5>0x1?void 0x0:_0x1df1c5?ds(_0x56d539,_0x388420):_0x56d539,_0x5d4f8e=_0x39338d[_0x1bf8c8(0x31f)]-0x1,_0x282caa;_0x5d4f8e>=0x0;_0x5d4f8e--)(_0x282caa=_0x39338d[_0x5d4f8e])&&(_0x1af921=_0x282caa(_0x1af921)||_0x1af921);return _0x1af921;},U=(_0x478528,_0x27f5e4)=>(_0x20cf9d,_0xce2ab3)=>_0x27f5e4(_0x20cf9d,_0xce2ab3,_0x478528),ne=(_0x2c4f1a=>(_0x2c4f1a['Entered']=_0x2cb6e4(0x259),_0x2c4f1a[_0x2cb6e4(0x267)]=_0x2cb6e4(0x1f7),_0x2c4f1a[_0x2cb6e4(0x2a7)]=_0x2cb6e4(0x1c6),_0x2c4f1a))(ne||{}),C=(_0x323aec=>(_0x323aec[_0x2cb6e4(0x331)]='init',_0x323aec[_0x2cb6e4(0x335)]='loading',_0x323aec[_0x2cb6e4(0x240)]='loaded',_0x323aec))(C||{});const Es=_0x2cb6e4(0x357);let g=class extends _0x555e29{constructor(_0x3ecb11,_0x2a5698,_0x1845ff,_0x4eb5e3){const _0xa52591=_0x2cb6e4;super(),c(this,_0xa52591(0x319),new _0x2c8b5b([])),c(this,_0xa52591(0x27a),this['_versions$']['asObservable']()),c(this,'_currentVersion$',new _0x2c8b5b('')),c(this,_0xa52591(0x206),this[_0xa52591(0x282)][_0xa52591(0x28a)]()),c(this,_0xa52591(0x204),new _0x2c8b5b(_0xa52591(0x259))),c(this,'status$',this[_0xa52591(0x204)][_0xa52591(0x28a)]()),c(this,_0xa52591(0x225),new _0x2c8b5b(0x0)),c(this,_0xa52591(0x229),this[_0xa52591(0x225)]['asObservable']()),c(this,_0xa52591(0x21c),new _0x2c8b5b('')),c(this,_0xa52591(0x214),this[_0xa52591(0x21c)][_0xa52591(0x28a)]()),c(this,'_fetching',!0x1),c(this,_0xa52591(0x33e),new _0x2c8b5b(_0xa52591(0x280))),c(this,'loadingState$',this[_0xa52591(0x33e)]['asObservable']()),c(this,_0xa52591(0x31b),null),c(this,_0xa52591(0x1db),!0x0),c(this,_0xa52591(0x304),new Map()),c(this,'_historyContainerId'),c(this,_0xa52591(0x232)),c(this,_0xa52591(0x1a0)),c(this,'_canRevert',!0x1),(this[_0xa52591(0x284)]=_0x3ecb11,this['_confirmService']=_0x2a5698,this[_0xa52591(0x228)]=_0x1845ff,this[_0xa52591(0x32b)]=_0x4eb5e3);}async[_0x2cb6e4(0x239)](_0x25d30b,_0x3b7be8,_0x61972){const _0x5b8797=_0x2cb6e4;this[_0x5b8797(0x26e)]=_0x3b7be8,this[_0x5b8797(0x1a5)]=_0x61972,this['_unitId$']['next'](_0x25d30b),this['_fetching']=!0x0;const _0x20e616=await this[_0x5b8797(0x32b)][_0x5b8797(0x1e8)](_0x25d30b);if(this['_fetching']=!0x1,_0x20e616){const {versions:_0x2e4c69,lastLabel:_0x429a9e,hasMore:_0x2e1a03,members:_0x302f78}=_0x20e616;_0x2e4c69[_0x5b8797(0x31f)]===0x0&&_0x2e4c69[_0x5b8797(0x300)]({'unitId':_0x25d30b,'id':Es,'startRev':0x1,'endRev':0x0,'time':Date[_0x5b8797(0x2ec)](),'user':this[_0x5b8797(0x228)]['t'](_0x5b8797(0x254)),'commands':[],'isAnonymous':!0x1}),this['_updateVersions'](_0x2e4c69,_0x2e1a03,_0x429a9e,_0x302f78),this[_0x5b8797(0x282)]['next'](_0x2e4c69[0x0]['id']);}else this[_0x5b8797(0x204)][_0x5b8797(0x2b4)]('error');}async[_0x2cb6e4(0x351)](){const _0x1fc1b4=_0x2cb6e4;if(!this[_0x1fc1b4(0x31b)]||!this['_hasMore']||this[_0x1fc1b4(0x29c)])return!0x1;this[_0x1fc1b4(0x29c)]=!0x0;const _0x30038b=await this[_0x1fc1b4(0x32b)][_0x1fc1b4(0x1e8)](this[_0x1fc1b4(0x1ef)],this[_0x1fc1b4(0x31b)]);if(this[_0x1fc1b4(0x29c)]=!0x1,_0x30038b){const {versions:_0x1c2c32,lastLabel:_0x54f81d,hasMore:_0x43e01d,members:_0x1ca361}=_0x30038b;this['_updateVersions'](_0x1c2c32,_0x43e01d,_0x54f81d,_0x1ca361);}else this['_messageService'][_0x1fc1b4(0x31a)]({'content':this[_0x1fc1b4(0x228)]['t'](_0x1fc1b4(0x2a5)),'type':_0x1a2dc5[_0x1fc1b4(0x2a7)],'duration':0xbb8});return!0x0;}async['triggerLoadSheet'](_0x54fb42){const _0x13f49e=_0x2cb6e4;var _0x39d5ff;const _0x474c48=(_0x39d5ff=this['_versions$']['value'])==null?void 0x0:_0x39d5ff[_0x13f49e(0x2dd)](_0x1fbb42=>_0x1fbb42['id']===_0x54fb42),{endRev:_0x196160}=_0x474c48||{};_0x196160||_0x196160===0x0?(this[_0x13f49e(0x33e)][_0x13f49e(0x2b4)](_0x13f49e(0x2f5)),await this['_historyFetchService'][_0x13f49e(0x20f)](this[_0x13f49e(0x1ef)],_0x196160),this['_loadingState$'][_0x13f49e(0x2b4)](_0x13f49e(0x273))):this[_0x13f49e(0x204)][_0x13f49e(0x2b4)](_0x13f49e(0x1c6));}async['triggerRevert'](_0x3c41c7){const _0x315f47=_0x2cb6e4,_0x41a2c3=_0x3c41c7?this[_0x315f47(0x29b)](_0x3c41c7):this[_0x315f47(0x346)]();if(!_0x41a2c3)return;const _0x2bdcf6=_0x41a2c3[_0x315f47(0x343)],_0x19e598=ie(_0x41a2c3[_0x315f47(0x2bd)],this[_0x315f47(0x228)]['getCurrentLocale']());await this['_confirmService'][_0x315f47(0x30e)]({'id':'confirm-revert-revision','title':{'title':this['_localeService']['t'](_0x315f47(0x344))},'children':{'title':this['_localeService']['t'](_0x315f47(0x297))+_0x315f47(0x1a7)+_0x19e598[_0x315f47(0x2af)]+'\x20'+_0x19e598[_0x315f47(0x2bd)]+')'},'cancelText':this[_0x315f47(0x228)]['t'](_0x315f47(0x24a)),'confirmText':this[_0x315f47(0x228)]['t'](_0x315f47(0x2de))})&&this['_revertRevision$'][_0x315f47(0x2b4)](_0x2bdcf6);}[_0x2cb6e4(0x289)](_0x283fd9,_0x3b64c2,_0x3a882d,_0x40fbd6){const _0x578356=_0x2cb6e4;this[_0x578356(0x319)]['next'](this[_0x578356(0x319)][_0x578356(0x20e)][_0x578356(0x1fe)](_0x283fd9)),this[_0x578356(0x1db)]=_0x3b64c2,this[_0x578356(0x31b)]=_0x3a882d,_0x40fbd6&&Object['keys'](_0x40fbd6)[_0x578356(0x1ee)](_0x44a3c6=>this[_0x578356(0x304)][_0x578356(0x2f3)](_0x44a3c6,_0x40fbd6[_0x44a3c6]));}['getCurrentVersion'](){const _0x28ab16=_0x2cb6e4;return this[_0x28ab16(0x29b)](this[_0x28ab16(0x282)]['value']);}[_0x2cb6e4(0x29b)](_0x55e678){const _0xa50ae0=_0x2cb6e4;var _0x4de08e;return(_0x4de08e=this[_0xa50ae0(0x319)][_0xa50ae0(0x20e)])==null?void 0x0:_0x4de08e[_0xa50ae0(0x2dd)](_0x5efe3e=>_0x5efe3e['id']===_0x55e678);}[_0x2cb6e4(0x2da)](_0x534b95){const _0x3df7f5=_0x2cb6e4;return this[_0x3df7f5(0x304)][_0x3df7f5(0x198)](_0x534b95);}[_0x2cb6e4(0x2bb)](){const _0x4e2014=_0x2cb6e4;this[_0x4e2014(0x1a0)]=document['createElement'](_0x4e2014(0x309)),this[_0x4e2014(0x1a0)]['className']=_0x4e2014(0x333),this['_maskElement'][_0x4e2014(0x285)][_0x4e2014(0x28d)]=_0x4e2014(0x242),this['_maskElement'][_0x4e2014(0x285)][_0x4e2014(0x350)]='0',this[_0x4e2014(0x1a0)][_0x4e2014(0x285)][_0x4e2014(0x215)]='0',this[_0x4e2014(0x1a0)]['style'][_0x4e2014(0x234)]='100%',this[_0x4e2014(0x1a0)][_0x4e2014(0x285)][_0x4e2014(0x1d4)]='100%',this[_0x4e2014(0x1a0)][_0x4e2014(0x285)][_0x4e2014(0x34f)]='rgba(225,\x20225,\x20225,\x200.5)',this['_maskElement'][_0x4e2014(0x285)]['color']='white',this[_0x4e2014(0x1a0)][_0x4e2014(0x285)][_0x4e2014(0x283)]=_0x4e2014(0x218),this['_maskElement'][_0x4e2014(0x285)][_0x4e2014(0x352)]=_0x4e2014(0x235),this['_maskElement'][_0x4e2014(0x285)][_0x4e2014(0x2eb)]='1000',this['_maskElement']['style']['display']=_0x4e2014(0x22b),this[_0x4e2014(0x232)][_0x4e2014(0x314)](this[_0x4e2014(0x1a0)]);}[_0x2cb6e4(0x1a8)](){const _0x2805d8=_0x2cb6e4;var _0x44b164;const _0x2259f3=(_0x44b164=document[_0x2805d8(0x1d0)](this[_0x2805d8(0x26e)]))==null?void 0x0:_0x44b164['querySelector'](_0x2805d8(0x33c));_0x2259f3&&(this[_0x2805d8(0x232)]=_0x2259f3,this[_0x2805d8(0x2bb)]());}['showMask'](){const _0x509f10=_0x2cb6e4;this[_0x509f10(0x232)]||this[_0x509f10(0x1a8)](),this[_0x509f10(0x1a0)]&&(this[_0x509f10(0x1a0)][_0x509f10(0x285)][_0x509f10(0x283)]='flex');}[_0x2cb6e4(0x330)](){const _0x50b4d0=_0x2cb6e4;this[_0x50b4d0(0x1a0)]&&(this[_0x50b4d0(0x1a0)][_0x50b4d0(0x285)][_0x50b4d0(0x283)]='none');}set[_0x2cb6e4(0x1aa)](_0x29e53a){const _0x458ec8=_0x2cb6e4;this[_0x458ec8(0x204)][_0x458ec8(0x2b4)](_0x29e53a);}set['currentVersion'](_0x119cb0){const _0x4ffa9f=_0x2cb6e4;_0x119cb0!==this[_0x4ffa9f(0x282)][_0x4ffa9f(0x20e)]&&this[_0x4ffa9f(0x282)][_0x4ffa9f(0x2b4)](_0x119cb0);}get[_0x2cb6e4(0x1d7)](){const _0x1a7ee6=_0x2cb6e4;return this[_0x1a7ee6(0x282)][_0x1a7ee6(0x20e)];}set[_0x2cb6e4(0x1ef)](_0x51b523){const _0x5ceaa8=_0x2cb6e4;this[_0x5ceaa8(0x21c)][_0x5ceaa8(0x2b4)](_0x51b523);}get[_0x2cb6e4(0x1ef)](){const _0xcb756c=_0x2cb6e4;return this[_0xcb756c(0x21c)][_0xcb756c(0x20e)];}get[_0x2cb6e4(0x246)](){const _0xe63a24=_0x2cb6e4;return this[_0xe63a24(0x1a5)];}get[_0x2cb6e4(0x2ac)](){const _0x3f2622=_0x2cb6e4;return this[_0x3f2622(0x33e)][_0x3f2622(0x20e)];}};g=vs([U(0x0,_0x964c74),U(0x1,_0x2d9c9d),U(0x2,_0x4aaff5(_0x2d2eaf)),U(0x3,_0x4aaff5(A))],g);function j({ref:_0x57ca5a,..._0x49c90a}){const _0x32f8b9=_0x2cb6e4,{icon:_0xb67fc5,id:_0x260074,className:_0x2eb131,extend:_0x576bdb,..._0xa82959}=_0x49c90a,_0x510a17=(_0x32f8b9(0x1a9)+_0x260074+'\x20'+(_0x2eb131||''))[_0x32f8b9(0x1ac)](),_0x5312c7=_0x1f51c9('_'+fs());return Le(_0xb67fc5,''+_0x260074,{'defIds':_0xb67fc5[_0x32f8b9(0x313)],'idSuffix':_0x5312c7[_0x32f8b9(0x28b)]},{'ref':_0x57ca5a,'className':_0x510a17,..._0xa82959},_0x576bdb);}function Le(_0x16718a,_0xd1b087,_0x31a72d,_0x4eec81,_0x9a52fe){const _0x53ed26=_0x2cb6e4;return _0x33de19(_0x16718a[_0x53ed26(0x341)],{'key':_0xd1b087,...Ss(_0x16718a,_0x31a72d,_0x9a52fe),..._0x4eec81},(ms(_0x16718a,_0x31a72d)['children']||[])[_0x53ed26(0x1ab)]((_0x2f5aa3,_0x214028)=>Le(_0x2f5aa3,_0xd1b087+'-'+_0x16718a[_0x53ed26(0x341)]+'-'+_0x214028,_0x31a72d,void 0x0,_0x9a52fe)));}function Ss(_0x295914,_0x2326e9,_0x1ccec0){const _0x83a378=_0x2cb6e4,_0x51301a={..._0x295914[_0x83a378(0x24f)]};_0x1ccec0!=null&&_0x1ccec0[_0x83a378(0x34d)]&&_0x51301a['fill']==='colorChannel1'&&(_0x51301a[_0x83a378(0x19d)]=_0x1ccec0['colorChannel1']),_0x295914[_0x83a378(0x341)]===_0x83a378(0x2a4)&&_0x51301a['id']&&(_0x51301a['id']=_0x51301a['id']+_0x2326e9['idSuffix']),Object[_0x83a378(0x1f0)](_0x51301a)[_0x83a378(0x1ee)](([_0x5d7003,_0x5ef89f])=>{const _0x2dda0f=_0x83a378;_0x5d7003===_0x2dda0f(0x2a4)&&typeof _0x5ef89f=='string'&&(_0x51301a[_0x5d7003]=_0x5ef89f[_0x2dda0f(0x22f)](/url\(#(.*)\)/,_0x2dda0f(0x2ee)+_0x2326e9[_0x2dda0f(0x34b)]+')'));});const {defIds:_0x2592ba}=_0x2326e9;return!_0x2592ba||_0x2592ba['length']===0x0||(_0x295914[_0x83a378(0x341)]===_0x83a378(0x1c8)&&_0x51301a[_0x83a378(0x275)]&&(_0x51301a['xlink:href']=_0x51301a['xlink:href']+_0x2326e9[_0x83a378(0x34b)]),Object['entries'](_0x51301a)['forEach'](([_0xac7bbb,_0xa04fb6])=>{const _0x4b062f=_0x83a378;typeof _0xa04fb6==_0x4b062f(0x1c7)&&(_0x51301a[_0xac7bbb]=_0xa04fb6[_0x4b062f(0x22f)](/url\(#(.*)\)/,_0x4b062f(0x2ee)+_0x2326e9['idSuffix']+')'));})),_0x51301a;}function ms(_0x344922,_0x2e601a){const _0x302b3b=_0x2cb6e4;var _0x1d08ec;const {defIds:_0x4b474f}=_0x2e601a;return!_0x4b474f||_0x4b474f['length']===0x0?_0x344922:_0x344922[_0x302b3b(0x341)]===_0x302b3b(0x35a)&&((_0x1d08ec=_0x344922['children'])!=null&&_0x1d08ec[_0x302b3b(0x31f)])?{..._0x344922,'children':_0x344922[_0x302b3b(0x29e)][_0x302b3b(0x1ab)](_0x383ff0=>typeof _0x383ff0['attrs']['id']==_0x302b3b(0x1c7)&&_0x4b474f&&_0x4b474f['includes'](_0x383ff0[_0x302b3b(0x24f)]['id'])?{..._0x383ff0,'attrs':{..._0x383ff0[_0x302b3b(0x24f)],'id':_0x383ff0[_0x302b3b(0x24f)]['id']+_0x2e601a[_0x302b3b(0x34b)]}}:_0x383ff0)}:_0x344922;}function fs(){const _0x3da9de=_0x2cb6e4;return Math['random']()[_0x3da9de(0x30b)](0x24)[_0x3da9de(0x315)](0x2,0x8);}j['displayName']='UniverIcon';const gs={'tag':'svg','attrs':{'xmlns':_0x2cb6e4(0x301),'fill':'none','viewBox':_0x2cb6e4(0x195),'width':_0x2cb6e4(0x1cd),'height':_0x2cb6e4(0x1cd)},'children':[{'tag':_0x2cb6e4(0x2a9),'attrs':{'fill':_0x2cb6e4(0x29a),'d':'M6.42416\x204.42417C6.65847\x204.18985\x206.65847\x203.80995\x206.42416\x203.57564C6.18984\x203.34132\x205.80994\x203.34132\x205.57563\x203.57564L1.57564\x207.57564C1.34132\x207.80995\x201.34132\x208.18985\x201.57564\x208.42417L5.57563\x2012.4242C5.80994\x2012.6585\x206.18984\x2012.6585\x206.42416\x2012.4242C6.65847\x2012.1899\x206.65847\x2011.81\x206.42416\x2011.5756L3.44843\x208.5999H14C14.3314\x208.5999\x2014.6\x208.33127\x2014.6\x207.9999C14.6\x207.66853\x2014.3314\x207.3999\x2014\x207.3999H3.44843L6.42416\x204.42417Z'}}]},Ce=_0x21d9e4(function(_0x46d3c1,_0x196a65){const _0x53b5ec=_0x2cb6e4;return _0x33de19(j,Object['assign']({},_0x46d3c1,{'id':_0x53b5ec(0x2fd),'ref':_0x196a65,'icon':gs}));});Ce[_0x2cb6e4(0x1ca)]=_0x2cb6e4(0x22d);const ps={'tag':_0x2cb6e4(0x1b4),'attrs':{'xmlns':_0x2cb6e4(0x301),'fill':_0x2cb6e4(0x22b),'viewBox':'0\x200\x2016\x2017','width':_0x2cb6e4(0x1cd),'height':_0x2cb6e4(0x1cd)},'children':[{'tag':'g','attrs':{'fill':_0x2cb6e4(0x29a),'clipPath':_0x2cb6e4(0x196)},'children':[{'tag':_0x2cb6e4(0x2a9),'attrs':{'d':_0x2cb6e4(0x2db)}},{'tag':_0x2cb6e4(0x2a9),'attrs':{'d':_0x2cb6e4(0x2b6),'fillRule':_0x2cb6e4(0x2c4),'clipRule':'evenodd'}}]},{'tag':_0x2cb6e4(0x35a),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x2cb6e4(0x306)},'children':[{'tag':_0x2cb6e4(0x1b6),'attrs':{'width':0x10,'height':0x10,'y':0.05,'fill':'white','rx':0x4}}]}]}],'defIds':[_0x2cb6e4(0x306)]},ye=_0x21d9e4(function(_0xc646f1,_0x1f6c4a){const _0x306871=_0x2cb6e4;return _0x33de19(j,Object[_0x306871(0x21a)]({},_0xc646f1,{'id':_0x306871(0x26d),'ref':_0x1f6c4a,'icon':ps}));});ye[_0x2cb6e4(0x1ca)]='RestoreIcon';const Ns={'tag':_0x2cb6e4(0x1b4),'attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':_0x2cb6e4(0x22b),'viewBox':_0x2cb6e4(0x195),'width':_0x2cb6e4(0x1cd),'height':_0x2cb6e4(0x1cd)},'children':[{'tag':_0x2cb6e4(0x2a9),'attrs':{'fill':_0x2cb6e4(0x30a),'d':_0x2cb6e4(0x2be),'fillOpacity':0.2,'fillRule':_0x2cb6e4(0x2c4),'clipRule':_0x2cb6e4(0x2c4)}},{'tag':_0x2cb6e4(0x2a9),'attrs':{'fill':_0x2cb6e4(0x30a),'d':_0x2cb6e4(0x2bf),'fillRule':_0x2cb6e4(0x2c4),'clipRule':_0x2cb6e4(0x2c4)}}]},re=_0x21d9e4(function(_0x5622c7,_0x27727e){const _0x559295=_0x2cb6e4;return _0x33de19(j,Object[_0x559295(0x21a)]({},_0x5622c7,{'id':_0x559295(0x203),'ref':_0x27727e,'icon':Ns}));});re[_0x2cb6e4(0x1ca)]=_0x2cb6e4(0x345);function Os(){const _0xf35341=_0x2cb6e4;var _0x808a94;const _0x12dd50=_0x30b5c3(g),_0x549ce7=_0x30b5c3(_0x2d2eaf),_0x13cd58=_0x511d34(()=>{const _0x2ddc75=_0x50cb;_0x12dd50['status']=ne[_0x2ddc75(0x267)];},[_0x12dd50]),_0x46843c=_0x511d34(()=>{_0x12dd50['triggerRevert']();},[_0x12dd50]),_0xb26f09=_0xe37064(_0x12dd50['currentVersion$']),_0x426eb2=_0xe37064(_0x12dd50['versions$']),_0x513c5c=_0xb26f09===((_0x808a94=_0x426eb2==null?void 0x0:_0x426eb2[0x0])==null?void 0x0:_0x808a94['id']),_0x322015=_0xb26f09!==''&&!_0x513c5c&&_0x12dd50[_0xf35341(0x246)];return _0x4f314f(_0xf35341(0x309),{'className':_0x15693a(_0xf35341(0x21e),_0x181437),'children':[_0x30c25d('a',{'className':_0xf35341(0x223),'role':_0xf35341(0x25c),'onClick':_0x13cd58,'children':_0x30c25d(Ce,{'className':_0xf35341(0x236)})}),_0x30c25d(_0xf35341(0x309),{'className':'univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-justify-center','children':_0x322015&&_0x30c25d(_0x47226d,{'variant':'primary','onClick':_0x46843c,'children':_0x549ce7['t'](_0xf35341(0x2df))})})]});}var Rs=Object[_0x2cb6e4(0x2d2)],Ts=(_0x15c157,_0x3eab25,_0xf46904,_0x35bcb0)=>{for(var _0x17b9a7=_0x35bcb0>0x1?void 0x0:_0x35bcb0?Rs(_0x3eab25,_0xf46904):_0x3eab25,_0x2e92c4=_0x15c157['length']-0x1,_0x588ee7;_0x2e92c4>=0x0;_0x2e92c4--)(_0x588ee7=_0x15c157[_0x2e92c4])&&(_0x17b9a7=_0x588ee7(_0x17b9a7)||_0x17b9a7);return _0x17b9a7;},M=(_0x114d39,_0x466c8e)=>(_0x456f84,_0x350fef)=>_0x466c8e(_0x456f84,_0x350fef,_0x114d39);let F=class extends _0x555e29{constructor(_0x3343ee,_0x430747,_0x19d9b9,_0x22cd3a,_0x4f0af6,_0x1c2406){const _0x1f626f=_0x2cb6e4;super(),this[_0x1f626f(0x294)]=_0x3343ee,this[_0x1f626f(0x2e0)]=_0x430747,this[_0x1f626f(0x284)]=_0x19d9b9,this[_0x1f626f(0x228)]=_0x22cd3a,this[_0x1f626f(0x290)]=_0x4f0af6,this['_injector']=_0x1c2406,this[_0x1f626f(0x209)]();}[_0x2cb6e4(0x209)](){const _0x3a33cc=_0x2cb6e4;this['disposeWithMe'](this[_0x3a33cc(0x290)][_0x3a33cc(0x206)]['subscribe'](_0x365662=>{_0x365662&&this['_historyManagerService']['triggerLoadSheet'](_0x365662);})),this[_0x3a33cc(0x24e)](this[_0x3a33cc(0x294)][_0x3a33cc(0x1c4)][_0x3a33cc(0x2a6)](_0x2e05e9=>{const _0x3bc5b5=_0x3a33cc,_0x24cf8a=this[_0x3bc5b5(0x290)]['unitId'];_0x24cf8a&&(_0x2e05e9[_0x3bc5b5(0x20d)]===D[_0x3bc5b5(0x1a6)]&&_0x2e05e9[_0x3bc5b5(0x20e)]===!0x0&&this[_0x3bc5b5(0x294)][_0x3bc5b5(0x250)](new _0x27b647(_0x24cf8a)['id'],!0x1),_0x2e05e9['subType']===D['RenameSheet']&&_0x2e05e9[_0x3bc5b5(0x20e)]===!0x0&&this[_0x3bc5b5(0x294)][_0x3bc5b5(0x250)](new _0x248c0b(_0x24cf8a)['id'],!0x1),_0x2e05e9['subType']===D[_0x3bc5b5(0x238)]&&_0x2e05e9[_0x3bc5b5(0x20e)]===!0x0&&this[_0x3bc5b5(0x294)][_0x3bc5b5(0x250)](new _0x26339d(_0x24cf8a)['id'],!0x1),_0x2e05e9[_0x3bc5b5(0x20d)]===D[_0x3bc5b5(0x33a)]&&_0x2e05e9[_0x3bc5b5(0x20e)]===!0x0&&this['_permissionService'][_0x3bc5b5(0x250)](new _0x12bf61(_0x24cf8a)['id'],!0x1),_0x2e05e9[_0x3bc5b5(0x20d)]===D[_0x3bc5b5(0x2a2)]&&_0x2e05e9[_0x3bc5b5(0x20e)]===!0x0&&this[_0x3bc5b5(0x294)][_0x3bc5b5(0x250)](new _0x27b647(_0x24cf8a)['id'],!0x1),_0x2e05e9[_0x3bc5b5(0x20d)]===D[_0x3bc5b5(0x227)]&&_0x2e05e9[_0x3bc5b5(0x20e)]===!0x0&&this[_0x3bc5b5(0x294)][_0x3bc5b5(0x250)](new _0x27b647(_0x24cf8a)['id'],!0x1));})),this[_0x3a33cc(0x24e)](this[_0x3a33cc(0x2e0)][_0x3a33cc(0x28f)](_0x4c12ab[_0x3a33cc(0x1df)],()=>_0x3bdc12(Os,this[_0x3a33cc(0x251)]))),this[_0x3a33cc(0x24e)](this[_0x3a33cc(0x290)][_0x3a33cc(0x1bf)][_0x3a33cc(0x2a6)](_0x1f4350=>{const _0x572f10=_0x3a33cc;_0x1f4350===C[_0x572f10(0x335)]&&(this['_historyManagerService'][_0x572f10(0x318)](),this[_0x572f10(0x284)]['show']({'type':_0x1a2dc5[_0x572f10(0x194)],'content':this[_0x572f10(0x228)]['t'](_0x572f10(0x2c0))})),_0x1f4350===C[_0x572f10(0x240)]&&this[_0x572f10(0x290)]['hideMask']();}));}};F=Ts([M(0x0,_0xbdfc78),M(0x1,_0xfa5a57),M(0x2,_0x964c74),M(0x3,_0x4aaff5(_0x2d2eaf)),M(0x4,_0x4aaff5(g)),M(0x5,_0x4aaff5(_0x14f2b5))],F);var Ds=Object[_0x2cb6e4(0x2d2)],Ms=(_0x35c941,_0x264487,_0x3c8357,_0x3e740c)=>{const _0x5822c2=_0x2cb6e4;for(var _0x2b1d1=_0x3e740c>0x1?void 0x0:_0x3e740c?Ds(_0x264487,_0x3c8357):_0x264487,_0x2c8dc4=_0x35c941[_0x5822c2(0x31f)]-0x1,_0xa9c725;_0x2c8dc4>=0x0;_0x2c8dc4--)(_0xa9c725=_0x35c941[_0x2c8dc4])&&(_0x2b1d1=_0xa9c725(_0x2b1d1)||_0x2b1d1);return _0x2b1d1;},Z=(_0x4d76b6,_0x517b13)=>(_0x4e332e,_0x2799d5)=>_0x517b13(_0x4e332e,_0x2799d5,_0x4d76b6);let w=class extends _0x555e29{constructor(_0x22a0d2,_0x3223d4,_0x1cd484){const _0x436a2f=_0x2cb6e4;super(),c(this,'_diffRangesMap',new Map()),c(this,_0x436a2f(0x2d9),new _0x2c8b5b({'ranges':new Map(),'active':null})),c(this,_0x436a2f(0x260),this[_0x436a2f(0x2d9)][_0x436a2f(0x28a)]()),(this[_0x436a2f(0x290)]=_0x22a0d2,this[_0x436a2f(0x2cd)]=_0x3223d4,this['_snapshotServerService']=_0x1cd484,this[_0x436a2f(0x209)]());}[_0x2cb6e4(0x209)](){const _0xee0739=_0x2cb6e4;this[_0xee0739(0x354)]=new Map(),this[_0xee0739(0x24e)](this[_0xee0739(0x290)][_0xee0739(0x214)]['subscribe'](_0x39ae88=>{const _0x49a065=_0xee0739;_0x39ae88&&!this['_diffRangesMap']['has'](_0x39ae88)&&this[_0x49a065(0x354)]['set'](_0x39ae88,new Map());})),this['disposeWithMe'](this[_0xee0739(0x290)]['currentVersion$']['subscribe'](async _0x3a945c=>{const _0x158492=_0xee0739;var _0x475776;_0x3a945c&&(await this[_0x158492(0x1c2)](_0x3a945c),this[_0x158492(0x2d9)][_0x158492(0x2b4)](((_0x475776=this[_0x158492(0x354)][_0x158492(0x198)](this[_0x158492(0x290)]['unitId']))==null?void 0x0:_0x475776[_0x158492(0x198)](_0x3a945c))||{'ranges':new Map(),'active':null}));}));}async[_0x2cb6e4(0x1c2)](_0x1d83c9){const _0xeb8b89=_0x2cb6e4;var _0x34cc66,_0x1153d0;const _0x2fd01e=this['_historyManagerService'][_0xeb8b89(0x29b)](_0x1d83c9),_0x12f485=this[_0xeb8b89(0x290)][_0xeb8b89(0x1ef)];if(!_0x2fd01e||!_0x12f485)return;const _0x50a667=this[_0xeb8b89(0x354)][_0xeb8b89(0x198)](_0x12f485);if(_0x50a667||this[_0xeb8b89(0x354)]['set'](_0x12f485,new Map()),(_0x34cc66=this['_diffRangesMap']['get'](_0x12f485))!=null&&_0x34cc66[_0xeb8b89(0x339)](_0x2fd01e['id']))return;const {startRev:_0x316166,endRev:_0x48f899}=_0x2fd01e;if(_0x316166===0x1){_0x50a667['set'](_0x2fd01e['id'],{'ranges':new Map(),'active':null});return;}const _0x581f0e=_0x316166-0x1,_0x5120d6=_0x48f899,_0xf87703=await this['_snapshotServerService'][_0xeb8b89(0x21d)]({},{'unitID':_0x12f485,'from':_0x581f0e,'to':_0x5120d6,'type':x[_0xeb8b89(0x257)]});if(((_0x1153d0=_0xf87703[_0xeb8b89(0x1c6)])==null?void 0x0:_0x1153d0[_0xeb8b89(0x230)])===W['OK']){const _0x484f8a=_0xf87703['changesets'][_0xeb8b89(0x1ab)](_0xaabf62=>((_0xaabf62['mutations']===null||_0xaabf62[_0xeb8b89(0x316)]===void 0x0)&&(_0xaabf62['mutations']=[]),_0x557b83(_0xaabf62)))[_0xeb8b89(0x1ab)](_0x3500c6=>_0x3500c6[_0xeb8b89(0x316)]['map'](_0x364ffe=>({..._0x364ffe,'params':{..._0x364ffe[_0xeb8b89(0x27f)],'memberId':_0x3500c6[_0xeb8b89(0x293)]}})))[_0xeb8b89(0x27d)](),_0x54477f=this[_0xeb8b89(0x1b2)](_0x484f8a),_0x486216=this[_0xeb8b89(0x317)](_0x484f8a),_0x396646=this[_0xeb8b89(0x2e5)](_0x54477f);_0x50a667['set'](_0x2fd01e['id'],{'ranges':_0x396646,'active':_0x486216});}}['_transformMutationByOrder'](_0x13d701){const _0x1bdfda=_0x2cb6e4;let _0x1dc5ac=[];for(let _0x5de09c=0x0;_0x5de09c<_0x13d701[_0x1bdfda(0x31f)];_0x5de09c++){const _0x2cfb41=_0x13d701[_0x5de09c];if(_0x1dc5ac[_0x1bdfda(0x300)](_0x2cfb41),_0x5de09c!==_0x13d701[_0x1bdfda(0x31f)]-0x1){const _0x5e85e5=_0x13d701[_0x5de09c+0x1],_0x2784e3=this[_0x1bdfda(0x2cd)][_0x1bdfda(0x1f8)](_0x1dc5ac,[_0x5e85e5]);_0x582c81(_0x2784e3)?_0x1dc5ac=_0x2784e3[_0x1bdfda(0x2e3)]:_0x1dc5ac=[];}}return _0x1dc5ac;}[_0x2cb6e4(0x317)](_0x4a7617){const _0x3ce105=_0x2cb6e4;let _0x149c3f=[];return _0x4a7617[_0x3ce105(0x1ee)](_0x251106=>{const _0x53371c=_0x3ce105;if(_0x251106['id']===_0x314f47['id']){const _0x1a3ea5=_0x251106[_0x53371c(0x27f)];_0x149c3f['push'](_0x1a3ea5[_0x53371c(0x35b)]['id']);}else{if(_0x251106['id']===_0x2a8524['id']){const _0x33e93d=_0x251106[_0x53371c(0x27f)];_0x149c3f[_0x53371c(0x31f)]>0x0&&(_0x149c3f=_0x149c3f['filter'](_0x104a5d=>_0x104a5d!==_0x33e93d[_0x53371c(0x303)]));}else{if(_0x251106['id']===_0x475e4e['id']){const _0x15ff1c=_0x251106[_0x53371c(0x27f)];_0x15ff1c['hidden']?_0x149c3f=_0x149c3f[_0x53371c(0x19e)](_0x17efd7=>_0x17efd7!==_0x15ff1c[_0x53371c(0x303)]):_0x149c3f['push'](_0x15ff1c[_0x53371c(0x303)]);}else{const _0x34b030=_0x251106[_0x53371c(0x27f)];_0x34b030[_0x53371c(0x303)]&&_0x149c3f[_0x53371c(0x300)](_0x34b030['subUnitId']);}}}}),_0x149c3f[_0x3ce105(0x31f)]>0x0?_0x149c3f[_0x149c3f[_0x3ce105(0x31f)]-0x1]:null;}['_extractRanges'](_0xab4c80){const _0x3589f1=_0x2cb6e4,_0x9389e0=new Map();return _0xab4c80[_0x3589f1(0x1ee)](_0x206985=>{const _0x57db97=_0x3589f1;var _0x2c5232,_0x47d6be;const _0xcda171=(_0x2c5232=_0x206985[_0x57db97(0x27f)])==null?void 0x0:_0x2c5232[_0x57db97(0x1fb)];if(_0xcda171){_0x9389e0['has'](_0xcda171)||_0x9389e0['set'](_0xcda171,[]);const _0x446a30=this[_0x57db97(0x248)](_0x206985);(_0x47d6be=_0x9389e0[_0x57db97(0x198)](_0xcda171))==null||_0x47d6be[_0x57db97(0x300)](..._0x446a30);}}),_0x9389e0[_0x3589f1(0x1ee)]((_0x325aa6,_0x36aeeb)=>{_0x9389e0['set'](_0x36aeeb,this['_combineRanges'](_0x325aa6));}),_0x9389e0;}[_0x2cb6e4(0x248)](_0x14bab9){const _0x3f2e3c=_0x2cb6e4;switch(_0x14bab9['id']){case _0x156471['id']:{const _0x58d6db=_0x14bab9[_0x3f2e3c(0x27f)];return _0x58d6db[_0x3f2e3c(0x237)][_0x3f2e3c(0x1ab)](_0x4ac851=>_0x4ac851[_0x3f2e3c(0x23f)]['map'](_0x5ef410=>({'range':_0x5ef410,'unitId':_0x58d6db[_0x3f2e3c(0x1ef)],'subUnitId':_0x58d6db[_0x3f2e3c(0x303)]})))[_0x3f2e3c(0x27d)]();}case _0x42495d['id']:{const _0x53af77=_0x14bab9[_0x3f2e3c(0x27f)];return _0x53af77[_0x3f2e3c(0x23f)][_0x3f2e3c(0x1ab)](_0x3b01b5=>({'range':_0x3b01b5,'unitId':_0x53af77[_0x3f2e3c(0x1ef)],'subUnitId':_0x53af77[_0x3f2e3c(0x303)]}));}case _0x179536['id']:{const _0x40917b=_0x14bab9['params'];return[{'range':_0x40917b[_0x3f2e3c(0x30c)],'unitId':_0x40917b['unitId'],'subUnitId':_0x40917b[_0x3f2e3c(0x303)]}];}case _0xe46a58['id']:{const _0x5b6a24=_0x14bab9[_0x3f2e3c(0x27f)];return[{'range':_0x5b6a24[_0x3f2e3c(0x30c)],'unitId':_0x5b6a24[_0x3f2e3c(0x1ef)],'subUnitId':_0x5b6a24[_0x3f2e3c(0x303)]}];}case _0x36eed8['id']:{const _0x795ca1=_0x14bab9[_0x3f2e3c(0x27f)],{from:_0x4731c6,to:_0x1e8e1a,unitId:_0x5f3ba9}=_0x795ca1;return[{'range':ue(_0x4731c6[_0x3f2e3c(0x20e)]),'unitId':_0x5f3ba9,'subUnitId':_0x4731c6['subUnitId']},{'range':ue(_0x1e8e1a[_0x3f2e3c(0x20e)]),'unitId':_0x5f3ba9,'subUnitId':_0x1e8e1a[_0x3f2e3c(0x303)]}];}case _0x388f9b['id']:{const _0x5a142a=_0x14bab9[_0x3f2e3c(0x27f)],{unitId:_0x45caf0,subUnitId:_0x77c3fb,sourceRange:_0x4c47e8,targetRange:_0x2b12b4}=_0x5a142a,_0x3e581e=_0x4c47e8['endRow']-_0x4c47e8['startRow']+0x1;return[{'range':_0x2b12b4[_0x3f2e3c(0x358)]<=_0x4c47e8['startRow']?_0x2b12b4:{..._0x2b12b4,'startRow':_0x2b12b4[_0x3f2e3c(0x358)]-_0x3e581e,'endRow':_0x2b12b4[_0x3f2e3c(0x338)]-_0x3e581e},'unitId':_0x45caf0,'subUnitId':_0x77c3fb}];}case _0x3743c6['id']:{const _0x539e0f=_0x14bab9[_0x3f2e3c(0x27f)],{unitId:_0x24a58a,subUnitId:_0x1ebc3e,sourceRange:_0x1421f8,targetRange:_0x40302c}=_0x539e0f,_0x12efd6=_0x1421f8[_0x3f2e3c(0x268)]-_0x1421f8[_0x3f2e3c(0x207)]+0x1;return[{'range':_0x40302c['startColumn']<=_0x1421f8['startColumn']?_0x40302c:{..._0x40302c,'startColumn':_0x40302c[_0x3f2e3c(0x207)]-_0x12efd6,'endColumn':_0x40302c[_0x3f2e3c(0x268)]-_0x12efd6},'unitId':_0x24a58a,'subUnitId':_0x1ebc3e}];}case _0x4b3887['id']:{const _0x41c8c5=_0x14bab9[_0x3f2e3c(0x27f)],{values:_0x1ca0f1,unitId:_0x80a1a,subUnitId:_0x582796}=_0x41c8c5;return Object[_0x3f2e3c(0x2e4)](_0x1ca0f1)['map'](_0x14e430=>_0x14e430[_0x3f2e3c(0x23f)][_0x3f2e3c(0x1ab)](_0xbfd605=>({'range':_0xbfd605,'unitId':_0x80a1a,'subUnitId':_0x582796})))[_0x3f2e3c(0x27d)]();}case _0x29833f['id']:{const _0x19b8ce=_0x14bab9[_0x3f2e3c(0x27f)],{ranges:_0x1aa7bc,unitId:_0x1b54f2,subUnitId:_0x3b610c}=_0x19b8ce;return _0x1aa7bc['map'](_0x4ac080=>({'range':_0x4ac080,'unitId':_0x1b54f2,'subUnitId':_0x3b610c}));}case _0x393e31['id']:{const _0x3ce6de=_0x14bab9[_0x3f2e3c(0x27f)],{unitId:_0x8b9430,subUnitId:_0x3fa866,range:_0x2c00e7}=_0x3ce6de;return[{'range':_0x2c00e7,'unitId':_0x8b9430,'subUnitId':_0x3fa866}];}case _0x55ea74['id']:{const _0x48dad=_0x14bab9[_0x3f2e3c(0x27f)];return _0x48dad[_0x3f2e3c(0x29d)][_0x3f2e3c(0x23f)][_0x3f2e3c(0x1ab)](_0x3a4bc0=>({'range':_0x3a4bc0,'unitId':_0x48dad[_0x3f2e3c(0x1ef)],'subUnitId':_0x48dad['subUnitId']}));}case _0x31d683['id']:{const _0x49f36a=_0x14bab9[_0x3f2e3c(0x27f)];return _0x49f36a[_0x3f2e3c(0x233)]?Ps(_0x49f36a[_0x3f2e3c(0x233)])[_0x3f2e3c(0x1ab)](_0xc158e9=>({'range':_0xc158e9,'unitId':_0x49f36a[_0x3f2e3c(0x1ef)],'subUnitId':_0x49f36a[_0x3f2e3c(0x303)]})):[];}case _0x1073da['id']:{const _0x6147c8=_0x14bab9[_0x3f2e3c(0x27f)];return[{'range':_0x6147c8[_0x3f2e3c(0x30c)],'unitId':_0x6147c8['unitId'],'subUnitId':_0x6147c8[_0x3f2e3c(0x303)]}];}case _0x5abfc9['id']:{const _0x30cb05=_0x14bab9[_0x3f2e3c(0x27f)];return(Array[_0x3f2e3c(0x1eb)](_0x30cb05[_0x3f2e3c(0x29d)])?_0x30cb05[_0x3f2e3c(0x29d)]:[_0x30cb05[_0x3f2e3c(0x29d)]])[_0x3f2e3c(0x1ab)](_0x325896=>_0x325896[_0x3f2e3c(0x23f)][_0x3f2e3c(0x1ab)](_0x5e25d3=>({'range':_0x5e25d3,'unitId':_0x30cb05[_0x3f2e3c(0x1ef)],'subUnitId':_0x30cb05[_0x3f2e3c(0x303)]})))[_0x3f2e3c(0x27d)]();}case _0x8be438['id']:{const _0x328bd1=_0x14bab9[_0x3f2e3c(0x27f)];return _0x328bd1['rule'][_0x3f2e3c(0x23f)][_0x3f2e3c(0x1ab)](_0x1c23af=>({'range':_0x1c23af,'unitId':_0x328bd1[_0x3f2e3c(0x1ef)],'subUnitId':_0x328bd1[_0x3f2e3c(0x303)]}));}default:return[];}}[_0x2cb6e4(0x21b)](_0x5d8401){const _0x51d7b5=_0x2cb6e4;if(_0x5d8401[_0x51d7b5(0x31f)]<=0x1)return _0x5d8401;const _0x4510d1=new Map();return _0x5d8401[_0x51d7b5(0x1ee)](_0x3fb72a=>{const _0x263e27=_0x51d7b5;var _0x4ce7f8;const {unitId:_0xf1b382,subUnitId:_0x134eb9}=_0x3fb72a,_0x3fa8b0=_0xf1b382+'-'+_0x134eb9;_0x4510d1[_0x263e27(0x339)](_0x3fa8b0)?(_0x4ce7f8=_0x4510d1[_0x263e27(0x198)](_0x3fa8b0))==null||_0x4ce7f8[_0x263e27(0x300)](_0x3fb72a):_0x4510d1[_0x263e27(0x2f3)](_0x3fa8b0,[_0x3fb72a]);}),Array['from'](_0x4510d1[_0x51d7b5(0x2e4)]())[_0x51d7b5(0x1ab)](_0x3cce09=>new _0x56d55d()[_0x51d7b5(0x19c)](..._0x3cce09['map'](_0x293a88=>_0x293a88['range']))['merge']()[_0x51d7b5(0x1ab)](_0xbe490f=>({'range':_0xbe490f,'unitId':_0x3cce09[0x0][_0x51d7b5(0x1ef)],'subUnitId':_0x3cce09[0x0]['subUnitId']})))[_0x51d7b5(0x27d)]();}};w=Ms([Z(0x0,_0x4aaff5(g)),Z(0x1,_0x404d3b),Z(0x2,_0x19371c)],w);function ue(_0x4f166e){const _0xadc124=_0x2cb6e4;return new _0x4abeaf(_0x4f166e)[_0xadc124(0x24d)]();}function Ps(_0x10a485){const _0x1056d5=_0x2cb6e4,_0x5e6796=new _0x4abeaf(_0x10a485),_0xbf70d7=new _0x4abeaf();return _0x5e6796[_0x1056d5(0x201)]((_0x12c03b,_0x53114c)=>{const _0x14e3d2=_0x1056d5;_0xbf70d7[_0x14e3d2(0x1d1)](_0x12c03b,_0x53114c,0x1);}),_0x398609(_0xbf70d7);}var bs=Object[_0x2cb6e4(0x2d2)],Ls=(_0x1a9a17,_0x105481,_0x1948c8,_0xc1868f)=>{const _0x3f8c32=_0x2cb6e4;for(var _0x1f5424=_0xc1868f>0x1?void 0x0:_0xc1868f?bs(_0x105481,_0x1948c8):_0x105481,_0x26a7af=_0x1a9a17[_0x3f8c32(0x31f)]-0x1,_0x14be9f;_0x26a7af>=0x0;_0x26a7af--)(_0x14be9f=_0x1a9a17[_0x26a7af])&&(_0x1f5424=_0x14be9f(_0x1f5424)||_0x1f5424);return _0x1f5424;},P=(_0x1e53b2,_0x25f255)=>(_0x469cd8,_0x5db6af)=>_0x25f255(_0x469cd8,_0x5db6af,_0x1e53b2);let q=class extends _0x555e29{constructor(_0x3eb02f,_0x3bf600,_0x19087e,_0x52cbee,_0x3b9553,_0x1c0fb2,_0x39affa){const _0x36bf0e=_0x2cb6e4;super(),c(this,'_diffs',new Set()),c(this,_0x36bf0e(0x1e3),null),(this[_0x36bf0e(0x1b3)]=_0x3eb02f,this['_historyManagerService']=_0x3bf600,this[_0x36bf0e(0x33d)]=_0x19087e,this[_0x36bf0e(0x2d0)]=_0x52cbee,this[_0x36bf0e(0x1cc)]=_0x3b9553,this['_sheetSkeletonManagerService']=_0x1c0fb2,this[_0x36bf0e(0x349)]=_0x39affa,this[_0x36bf0e(0x209)]());}[_0x2cb6e4(0x209)](){const _0x38649a=_0x2cb6e4;this['_initRender'](),this[_0x38649a(0x325)]();}[_0x2cb6e4(0x208)](){const _0x1073a3=_0x2cb6e4;this[_0x1073a3(0x24e)](_0x1dc938([this[_0x1073a3(0x290)]['loadingState$'],this['_sheetSkeletonManagerService']['currentSkeleton$']])[_0x1073a3(0x1e5)](_0x5553c3(([_0x7a5fd7,_0xeb08f4])=>{const _0x40b29e=_0x1073a3;if(_0x7a5fd7===C[_0x40b29e(0x240)]&&_0xeb08f4){const _0x581d04=_0xeb08f4[_0x40b29e(0x25e)];return this[_0x40b29e(0x33d)][_0x40b29e(0x260)]['pipe'](_0x32acdf(_0x464ac3=>{const _0x4e2efc=_0x40b29e,_0x2cca10=new Map();return _0x464ac3[_0x4e2efc(0x23f)][_0x4e2efc(0x1ee)]((_0x502da8,_0xe7d46a)=>{const _0x55d81e=_0x4e2efc,_0x3019bf=_0x502da8[_0x55d81e(0x19e)](_0x187391=>_0x187391[_0x55d81e(0x303)]===_0x581d04);_0x2cca10[_0x55d81e(0x2f3)](_0xe7d46a,_0x3019bf);}),{'skeleton':_0xeb08f4,'diffs':_0x2cca10};}));}return _0x20a5f7({'skeleton':null,'diffs':new Map()});}))['subscribe'](({skeleton:_0x37ede0,diffs:_0x4904ec})=>{const _0x3850b8=_0x1073a3;this[_0x3850b8(0x271)](),_0x37ede0&&this['_updateDiffMarks'](_0x37ede0,_0x4904ec);})),this[_0x1073a3(0x24e)](this[_0x1073a3(0x324)]['currentSkeleton$'][_0x1073a3(0x2a6)](_0x223b28=>{const _0x258545=_0x1073a3;if(_0x223b28==null)return;const {skeleton:_0x31eb82}=_0x223b28,{scene:_0x55c6fe}=this[_0x258545(0x1b3)];_0x55c6fe['onPointerMove$']['subscribeEvent'](_0x5c6339(_0x228f6c=>{const _0x476738=_0x258545;var _0x5213da,_0x20a02b;const {offsetX:_0x5dfc14,offsetY:_0x51055c}=_0x228f6c,{x:_0x54d7de,y:_0x4bc9fa}=_0x55c6fe[_0x476738(0x1cb)](_0x394574['FromArray']([_0x5dfc14,_0x51055c])),{scaleX:_0x39cf93,scaleY:_0x88e0db}=_0x55c6fe[_0x476738(0x340)](),_0x2063d7=_0x55c6fe['getViewport'](_0x2bf945['VIEW_MAIN']),_0x5b2782=_0x55c6fe[_0x476738(0x2d1)](_0x394574[_0x476738(0x1c0)]([_0x54d7de,_0x4bc9fa]),_0x2063d7),_0x4bc430=_0x31eb82[_0x476738(0x359)](_0x5dfc14,_0x51055c,_0x39cf93,_0x88e0db,_0x5b2782);((_0x5213da=this[_0x476738(0x1e3)])==null?void 0x0:_0x5213da[_0x476738(0x1c1)])===_0x4bc430[_0x476738(0x1c1)]&&((_0x20a02b=this[_0x476738(0x1e3)])==null?void 0x0:_0x20a02b[_0x476738(0x277)])===_0x4bc430['row']||this[_0x476738(0x1ad)][_0x476738(0x1ee)](_0x59b413=>{const _0x3ae8ed=_0x476738;_0x59b413[_0x3ae8ed(0x1e6)](_0x4bc430);});},0x64));}));}[_0x2cb6e4(0x325)](){const _0x5f1bf0=_0x2cb6e4;this['disposeWithMe'](this[_0x5f1bf0(0x290)]['loadingState$']['subscribe'](_0x3a87a9=>{const _0x5d9c82=_0x5f1bf0,_0x2e4523=new _0x15ce3c();return _0x3a87a9===C[_0x5d9c82(0x240)]&&(_0x2e4523[_0x5d9c82(0x336)](),_0x2e4523[_0x5d9c82(0x19c)](this[_0x5d9c82(0x33d)][_0x5d9c82(0x260)]['subscribe'](_0x5e09b2=>{const _0x55c80e=_0x5d9c82;_0x5e09b2[_0x55c80e(0x1dc)]&&this[_0x55c80e(0x349)][_0x55c80e(0x2ed)](_0x58ed03['id'],{'unitId':this[_0x55c80e(0x1b3)][_0x55c80e(0x1ef)],'subUnitId':_0x5e09b2[_0x55c80e(0x1dc)]});}))),()=>_0x2e4523[_0x5d9c82(0x336)]();}));}[_0x2cb6e4(0x347)](_0x4c68f7,_0x53cf1c){const _0x4f701b=_0x2cb6e4;var _0x39d8f5;const _0x12557d=(_0x39d8f5=this[_0x4f701b(0x324)]['getCurrent']())==null?void 0x0:_0x39d8f5[_0x4f701b(0x222)];if(!_0x12557d)return;this['_diffs'][_0x4f701b(0x1ee)](_0x9a38d0=>{_0x9a38d0['makeDirty']();});const {scene:_0x4976b3}=this[_0x4f701b(0x1b3)],_0x25f1c7=Array['from'](_0x53cf1c['keys']())[_0x4f701b(0x1ab)](_0x245dda=>_0x53cf1c[_0x4f701b(0x198)](_0x245dda)['map'](_0x2c7d36=>{const _0xf41665=_0x4f701b;var _0x5856b5;const {range:_0x4670e1,subUnitId:_0x4e7d79,unitId:_0x85a127}=_0x2c7d36,{startColumn:_0x4930c3,startRow:_0x1e7221,endColumn:_0x59fdb1,endRow:_0x28c474}=_0x4670e1,_0x37de38=_0x4b40a2(_0x1e7221,_0x4930c3,_0x4976b3,_0x12557d),_0x4aebfd=_0x4b40a2(_0x28c474,_0x59fdb1,_0x4976b3,_0x12557d),{columnHeaderHeightAndMarginTop:_0xa739e6}=_0x12557d,{startX:_0x2bba89,startY:_0x420535}=_0x37de38,{endX:_0x4fd960,endY:_0xb98ae8}=_0x4aebfd,_0x35cac1=_0x4fd960-_0x2bba89,_0x28b391=_0xb98ae8-_0x420535,_0x5d154c={'labelPosition':_0x420535-_0xa739e6>=0x14?'top':_0xf41665(0x25d),'sheetID':_0x4e7d79,'range':_0x4670e1,'color':_0xf41665(0x299),'fillAfterStrokeEnabled':!0x0,'backgroundColor':_0xf41665(0x299),'name':((_0x5856b5=this[_0xf41665(0x290)][_0xf41665(0x2da)](_0x245dda))==null?void 0x0:_0x5856b5[_0xf41665(0x241)])||'','selection':_0x85a127+'-'+_0x4e7d79+'-'+_0x4670e1[_0xf41665(0x207)]+'-'+_0x4670e1[_0xf41665(0x358)]+'-'+_0x4670e1[_0xf41665(0x268)]+'-'+_0x4670e1['endRow'],'left':_0x2bba89,'top':_0x420535,'width':_0x35cac1,'height':_0x28b391,'evented':!0x1,'zIndex':0x1};return new _0x447436('',_0x5d154c);}))[_0x4f701b(0x27d)]();_0x4976b3[_0x4f701b(0x355)](_0x25f1c7,0x1),this[_0x4f701b(0x1ad)]=new Set(_0x25f1c7);}['_removeDiffMarks'](){const _0x377079=_0x2cb6e4;var _0x4c86b3;(_0x4c86b3=this['_diffs'])==null||_0x4c86b3[_0x377079(0x1ee)](_0x518627=>_0x518627[_0x377079(0x336)]());}[_0x2cb6e4(0x197)](){const _0x2da711=_0x2cb6e4;return _0x1ec31a(this['_univerInstanceService'],this[_0x2da711(0x1cc)]);}};q=Ls([P(0x1,_0x4aaff5(g)),P(0x2,_0x4aaff5(w)),P(0x3,_0x381737),P(0x4,_0x28ff8b),P(0x5,_0x4aaff5(_0xf71e45)),P(0x6,_0x241833)],q);function Cs(){const _0x5da8d7=_0x2cb6e4,_0x1b526e=_0x30b5c3(g),_0x5de8eb=_0xe37064(_0x1b526e[_0x5da8d7(0x27a)]),[_0x320cab,_0x36820c]=_0x25215d(!0x1),_0x5257ea=cs(_0x5de8eb);return _0x5de8eb?_0x30c25d(_0x5da8d7(0x309),{'className':'univer-overflow-hidden','children':_0x4f314f(_0x5da8d7(0x309),{'className':'univer-h-full\x20univer-space-y-2\x20univer-overflow-auto\x20univer-pb-4','children':[_0x5257ea[_0x5da8d7(0x1ab)]((_0x219ac1,_0x11d984)=>_0x4f314f(_0x41b79c,{'children':[_0x30c25d(Us,{'date':_0x219ac1[_0x5da8d7(0x295)]}),_0x219ac1[_0x5da8d7(0x226)][_0x5da8d7(0x1ab)]((_0x3cadf0,_0x2f0fb8)=>_0x30c25d($s,{'index':[_0x11d984,_0x2f0fb8],'item':_0x3cadf0},_0x11d984+'-'+_0x2f0fb8))]},_0x219ac1[_0x5da8d7(0x295)])),_0x320cab&&_0x30c25d(ys,{})]})}):_0x30c25d(ws,{});}function ys(){const _0xccbcd4=_0x2cb6e4;return _0x30c25d(_0xccbcd4(0x309),{'className':_0xccbcd4(0x2f6),'children':_0x30c25d(re,{'className':'univer-animate-spin'})});}function ws(){const _0x2d29e4=_0x2cb6e4;return _0x30c25d(_0x2d29e4(0x309),{'className':'univer-flex\x20univer-items-center\x20univer-justify-center','children':_0x30c25d(_0x2d29e4(0x26f),{'className':_0x2d29e4(0x256),'children':_0x30c25d(re,{'className':_0x2d29e4(0x30f)})})});}function Us(_0x40c36e){const _0x503c36=_0x2cb6e4,_0x3d3fe9=_0x30b5c3(_0x2d2eaf),{date:_0x1b50e0}=_0x40c36e;return _0x30c25d('div',{'className':_0x503c36(0x279),'children':J(_0x1b50e0,_0x3d3fe9[_0x503c36(0x1a1)]())});}function $s(_0xf43d59){const _0x270a64=_0x2cb6e4,{item:_0x52a4ee,index:_0x4ed006}=_0xf43d59,{time:_0x18d0f0,user:_0x46808d}=_0x52a4ee,[_0x56146a,_0xea1345]=_0x4ed006,_0x2255c2=_0x30b5c3(g),_0x3f6560=_0xe37064(_0x2255c2[_0x270a64(0x206)],'',!0x0)===_0x52a4ee['id'],_0x37dab7=_0x56146a===0x0&&_0xea1345===0x0,_0x56f4c0=!_0x37dab7&&_0x2255c2[_0x270a64(0x246)],_0x280ed9=_0x30b5c3(_0x2d2eaf),_0x3aafad=_0x280ed9['getCurrentLocale'](),_0x25fe66=ie(_0x18d0f0,_0x3aafad),_0x11a82c=_0x280ed9['t']('editHistory.panel.currentVersion'),_0x365054=_0x511d34(_0x55a6af=>{const _0x1a4a31=_0x270a64;_0x2255c2[_0x1a4a31(0x2ac)]!==C['Loading']&&(_0x2255c2['currentVersion']=_0x55a6af);},[_0x2255c2]),_0x4df526=_0x511d34(_0x373c98=>{const _0xf651df=_0x270a64;_0x2255c2[_0xf651df(0x213)](_0x373c98);},[_0x2255c2]);return _0x4f314f(_0x270a64(0x309),{'className':_0x15693a(_0x270a64(0x2b8),{'univer-bg-gray-50\x20dark:!univer-bg-gray-900':_0x3f6560}),'onClick':()=>_0x365054(_0x52a4ee['id']),'children':[_0x4f314f(_0x270a64(0x309),{'className':_0x270a64(0x1e9),'children':[_0x4f314f(_0x270a64(0x309),{'className':_0x270a64(0x23b),'children':[_0x30c25d(_0x270a64(0x26f),{'children':_0x25fe66[_0x270a64(0x2bd)]}),_0x37dab7&&_0x30c25d(_0x270a64(0x26f),{'className':_0x270a64(0x305),'children':_0x11a82c})]}),_0x30c25d(_0x270a64(0x309),{'children':_0x56f4c0&&_0x30c25d(_0x3fbb81,{'title':_0x280ed9['t'](_0x270a64(0x291)),'children':_0x30c25d(_0x270a64(0x309),{'onClick':_0xafe2a3=>{_0xafe2a3['stopPropagation'](),_0x4df526(_0x52a4ee['id']);},'className':_0x270a64(0x2b7),'children':_0x30c25d(ye,{})})})})]}),_0x30c25d(_0x270a64(0x309),{'className':_0x270a64(0x24c),'children':os(_0x52a4ee,_0x280ed9)})]});}var Vs=Object['getOwnPropertyDescriptor'],ks=(_0x59855d,_0x138bc1,_0xd04ba8,_0x533e63)=>{const _0x375230=_0x2cb6e4;for(var _0x2b9be9=_0x533e63>0x1?void 0x0:_0x533e63?Vs(_0x138bc1,_0xd04ba8):_0x138bc1,_0x4ee0e5=_0x59855d[_0x375230(0x31f)]-0x1,_0x505edd;_0x4ee0e5>=0x0;_0x4ee0e5--)(_0x505edd=_0x59855d[_0x4ee0e5])&&(_0x2b9be9=_0x505edd(_0x2b9be9)||_0x2b9be9);return _0x2b9be9;},$=(_0xf7a3aa,_0x8a14ad)=>(_0x45af2b,_0x17df1f)=>_0x8a14ad(_0x45af2b,_0x17df1f,_0xf7a3aa);const he=_0x2cb6e4(0x205);let Y=class extends _0x555e29{constructor(_0x14bef3,_0x473c5e,_0x2ba5f8,_0x38b475){const _0x1757ee=_0x2cb6e4;super(),c(this,'_sidebarDisposable',null),(this['_sidebarService']=_0x14bef3,this[_0x1757ee(0x32e)]=_0x473c5e,this[_0x1757ee(0x228)]=_0x2ba5f8,this[_0x1757ee(0x290)]=_0x38b475,this[_0x1757ee(0x209)]());}['_init'](){const _0x49dcda=_0x2cb6e4;this['_initPanel'](),this[_0x49dcda(0x22e)]();}['_openPanel'](){const _0xa8f842=_0x2cb6e4;if(this[_0xa8f842(0x2ea)])return;const _0x561a7a={'header':{'title':this[_0xa8f842(0x228)]['t'](_0xa8f842(0x2cb))},'children':{'label':he},'onClose':()=>{const _0x3fceca=_0xa8f842;this[_0x3fceca(0x2ea)]=null,this[_0x3fceca(0x290)]['status']=ne['Exited'];}};this[_0xa8f842(0x2ea)]=this['_sidebarService']['open']({..._0x561a7a});}[_0x2cb6e4(0x2a8)](){const _0x501cf0=_0x2cb6e4;this[_0x501cf0(0x24e)](this['_componentManager'][_0x501cf0(0x320)](he,Cs)),this['disposeWithMe'](this['_sidebarService'][_0x501cf0(0x258)]['pipe'](_0x1d2b6d(0x64))['subscribe'](_0x57b9e1=>{const _0x190eb3=_0x501cf0,{target:_0x2c05c5}=_0x57b9e1||{};if(_0x2c05c5){const {scrollTop:_0x3f410c,scrollHeight:_0x39beee,clientHeight:_0xbacb48}=_0x2c05c5;_0x3f410c+_0xbacb48>=_0x39beee-0x5&&this[_0x190eb3(0x290)][_0x190eb3(0x351)]();}}));}};Y=ks([$(0x0,_0x52d5f4),$(0x1,_0x4aaff5(_0x2ccfa8)),$(0x2,_0x4aaff5(_0x2d2eaf)),$(0x3,_0x4aaff5(g))],Y);class Hs extends _0x555e29{constructor(){const _0x334771=_0x2cb6e4;super(),c(this,_0x334771(0x2f8),new _0x19ef2a());}[_0x2cb6e4(0x266)](){return _0x1fcd3d(()=>{});}[_0x2cb6e4(0x1d2)](){}['closeAll'](_0x4cb33d){}[_0x2cb6e4(0x263)](){const _0x253c89=_0x2cb6e4;return this[_0x253c89(0x2f8)]['asObservable']();}}var xs=Object['defineProperty'],As=Object[_0x2cb6e4(0x2d2)],Fs=(_0x281391,_0x2c7e4c,_0x110fe6)=>_0x2c7e4c in _0x281391?xs(_0x281391,_0x2c7e4c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x110fe6}):_0x281391[_0x2c7e4c]=_0x110fe6,Ys=(_0x1ebce6,_0x6d3336,_0x386977,_0x3c9830)=>{const _0x23af40=_0x2cb6e4;for(var _0x39b06c=_0x3c9830>0x1?void 0x0:_0x3c9830?As(_0x6d3336,_0x386977):_0x6d3336,_0x1c4daa=_0x1ebce6[_0x23af40(0x31f)]-0x1,_0x364793;_0x1c4daa>=0x0;_0x1c4daa--)(_0x364793=_0x1ebce6[_0x1c4daa])&&(_0x39b06c=_0x364793(_0x39b06c)||_0x39b06c);return _0x39b06c;},K=(_0x5798b3,_0x2b0692)=>(_0x26d84c,_0x5e7d5e)=>_0x2b0692(_0x26d84c,_0x5e7d5e,_0x5798b3),Bs=(_0x314457,_0x3336df,_0x4f74ef)=>Fs(_0x314457,_0x3336df+'',_0x4f74ef);const Ws=_0x2cb6e4(0x25b);let ee=class extends _0x1587be{constructor(_0x3ac152=le,_0x4ea3ce,_0x209ec5,_0x749210){const _0x163b36=_0x2cb6e4;super(),this['_config']=_0x3ac152,this[_0x163b36(0x251)]=_0x4ea3ce,this['_renderManagerService']=_0x209ec5,this[_0x163b36(0x323)]=_0x749210;const {..._0x3e4e7a}=_0x4eb917({},le,this[_0x163b36(0x243)]);this[_0x163b36(0x323)]['setConfig'](be,_0x3e4e7a);}[_0x2cb6e4(0x244)](){const _0x420830=_0x2cb6e4;[[g],[F],[w],[A],[Y],[H],[_0x19371c,{'useClass':_0x31e1df}],[_0xdf2df3,{'useClass':Hs}],[_0x5e004c,{'useClass':_0x2a01f1}]][_0x420830(0x1ee)](_0x506dc9=>this[_0x420830(0x251)]['add'](_0x506dc9)),this['_injector'][_0x420830(0x198)](F);}[_0x2cb6e4(0x272)](){const _0x52ac4b=_0x2cb6e4;[[q]][_0x52ac4b(0x1ee)](_0x44079f=>{const _0x42f87d=_0x52ac4b;this[_0x42f87d(0x24e)](this['_renderManagerService'][_0x42f87d(0x1a3)](_0x113232[_0x42f87d(0x257)],_0x44079f));}),this['_injector'][_0x52ac4b(0x198)](H),this[_0x52ac4b(0x251)][_0x52ac4b(0x198)](Y);}[_0x2cb6e4(0x2f1)](){const _0x4e7bbd=_0x2cb6e4;this['_injector'][_0x4e7bbd(0x198)](w);}};Bs(ee,_0x2cb6e4(0x2a3),Ws),ee=Ys([_0x165f15(_0x39b93f,_0x4d145b),K(0x1,_0x4aaff5(_0x14f2b5)),K(0x2,_0x28ff8b),K(0x3,_0x32a9c2)],ee);export{g as HistoryManagerService,ne as HistoryModeStatus,ee as UniverEditHistoryViewerPlugin};