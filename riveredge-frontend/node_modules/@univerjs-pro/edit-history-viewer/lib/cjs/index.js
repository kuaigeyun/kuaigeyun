'use strict';const _0x4df7f0=_0x37ff;(function(_0x32f2ad,_0xcea8e1){const _0x33a7aa=_0x37ff,_0x31dd52=_0x32f2ad();while(!![]){try{const _0x25c40e=parseInt(_0x33a7aa(0x14c))/0x1+-parseInt(_0x33a7aa(0x320))/0x2*(parseInt(_0x33a7aa(0x162))/0x3)+-parseInt(_0x33a7aa(0x25f))/0x4*(-parseInt(_0x33a7aa(0x2b5))/0x5)+-parseInt(_0x33a7aa(0x243))/0x6+parseInt(_0x33a7aa(0x234))/0x7*(parseInt(_0x33a7aa(0x369))/0x8)+-parseInt(_0x33a7aa(0x1fa))/0x9*(-parseInt(_0x33a7aa(0x2c0))/0xa)+parseInt(_0x33a7aa(0x2f5))/0xb*(-parseInt(_0x33a7aa(0x34d))/0xc);if(_0x25c40e===_0xcea8e1)break;else _0x31dd52['push'](_0x31dd52['shift']());}catch(_0x4bc3ec){_0x31dd52['push'](_0x31dd52['shift']());}}}(_0x1a99,0xc29b4));var me=Object[_0x4df7f0(0x2d0)],fe=(_0x2aa52e,_0x455e4e,_0x2d43c6)=>_0x455e4e in _0x2aa52e?me(_0x2aa52e,_0x455e4e,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x2d43c6}):_0x2aa52e[_0x455e4e]=_0x2d43c6,u=(_0x28fda9,_0x44facd,_0x201151)=>fe(_0x28fda9,typeof _0x44facd!=_0x4df7f0(0x2f3)?_0x44facd+'':_0x44facd,_0x201151);Object[_0x4df7f0(0x2d0)](exports,Symbol[_0x4df7f0(0x1a1)],{'value':_0x4df7f0(0x2e9)});const R=require('@univerjs-pro/collaboration'),ie=require('@univerjs-pro/collaboration-client'),_=require('@univerjs/core'),pe=require('@univerjs/drawing'),U=require('@univerjs/engine-render'),oe=require('@univerjs/network'),C=require('@univerjs/sheets-ui'),d=require('@univerjs/ui'),P=require('@univerjs/design'),l=require('@univerjs/sheets'),N=require('rxjs'),Ne=require('@univerjs-pro/sheets-chart'),Oe=require('@univerjs-pro/sheets-sparkline'),Z=require('@univerjs/data-validation'),K=require('@univerjs/sheets-conditional-formatting'),ce=require('@univerjs/sheets-filter'),h=require('react/jsx-runtime'),p=require('react'),Re=require('@univerjs-pro/collaboration-client-ui'),_e='edit-history-viewer.config',ne={};var Me=Object[_0x4df7f0(0x1da)],De=(_0x402d90,_0x112ecf,_0x5a83ed,_0x4a34ce)=>{const _0x40ab0f=_0x4df7f0;for(var _0x5b059f=_0x4a34ce>0x1?void 0x0:_0x4a34ce?Me(_0x112ecf,_0x5a83ed):_0x112ecf,_0x1d8570=_0x402d90[_0x40ab0f(0x2db)]-0x1,_0x4b8b4f;_0x1d8570>=0x0;_0x1d8570--)(_0x4b8b4f=_0x402d90[_0x1d8570])&&(_0x5b059f=_0x4b8b4f(_0x5b059f)||_0x5b059f);return _0x5b059f;},Te=(_0x54dc57,_0x40f972)=>(_0x44d081,_0x29fdf5)=>_0x40f972(_0x44d081,_0x29fdf5,_0x54dc57);let k=class extends _[_0x4df7f0(0x2d5)]{constructor(_0x3dc6e7){const _0x37fae9=_0x4df7f0;super(),this[_0x37fae9(0x346)]=_0x3dc6e7,this['_init']();}[_0x4df7f0(0x313)](){const _0x5f465e=_0x4df7f0;this[_0x5f465e(0x223)](this[_0x5f465e(0x346)][_0x5f465e(0x21f)][_0x5f465e(0x16f)](_0x50e224=>{const _0x310a72=_0x5f465e;_0x50e224!=null&&_0x50e224[_0x310a72(0x308)]&&this[_0x310a72(0x346)][_0x310a72(0x2ad)]({'show':!0x1});}));}};k=De([Te(0x0,C['ICellEditorManagerService'])],k);var F=(_0x66844a=>(_0x66844a[_0x66844a[_0x4df7f0(0x2be)]=0x0]=_0x4df7f0(0x2be),_0x66844a[_0x66844a['OK']=0x1]='OK',_0x66844a[_0x66844a['INTERNAL_ERROR']=0x2]=_0x4df7f0(0x1ea),_0x66844a[_0x66844a[_0x4df7f0(0x2e0)]=0x3]=_0x4df7f0(0x2e0),_0x66844a[_0x66844a[_0x4df7f0(0x261)]=0x4]=_0x4df7f0(0x261),_0x66844a[_0x66844a[_0x4df7f0(0x2e5)]=0x5]='UNAUTHENTICATED',_0x66844a[_0x66844a[_0x4df7f0(0x1d0)]=0x6]=_0x4df7f0(0x1d0),_0x66844a[_0x66844a[_0x4df7f0(0x282)]=0x7]=_0x4df7f0(0x282),_0x66844a[_0x66844a['TOO_MANY_REQUESTS']=0x8]=_0x4df7f0(0x205),_0x66844a[_0x66844a[_0x4df7f0(0x337)]=0x9]=_0x4df7f0(0x337),_0x66844a[_0x66844a[_0x4df7f0(0x32a)]=0xa]=_0x4df7f0(0x32a),_0x66844a[_0x66844a[_0x4df7f0(0x30a)]=0xb]='MOBILE_VERIFY_CODE_MISMATCH',_0x66844a[_0x66844a[_0x4df7f0(0x1f5)]=0xc]=_0x4df7f0(0x1f5),_0x66844a[_0x66844a['EMAIL_VERIFY_CODE_MISMATCH']=0xd]=_0x4df7f0(0x1bc),_0x66844a[_0x66844a['EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED']=0xe]=_0x4df7f0(0x356),_0x66844a[_0x66844a['AUTHORIZE_CODE_ILLEGAL']=0xf]=_0x4df7f0(0x172),_0x66844a[_0x66844a[_0x4df7f0(0x1ed)]=0x10]='LOGIN_TOKEN_PROCESSING_FAILED',_0x66844a[_0x66844a['CURRENT_STATUS_CANNOT_OPERATE']=0x64]=_0x4df7f0(0x333),_0x66844a[_0x66844a['ERROR_AGAIN']=0x65]=_0x4df7f0(0x227),_0x66844a[_0x66844a[_0x4df7f0(0x257)]=0xc9]=_0x4df7f0(0x257),_0x66844a[_0x66844a[_0x4df7f0(0x200)]=0xca]='USER_IS_ANONYMOUS',_0x66844a[_0x66844a[_0x4df7f0(0x297)]=0x1389]=_0x4df7f0(0x297),_0x66844a[_0x66844a[_0x4df7f0(0x183)]=0x1771]='SNAPSHOT_INVALID_SNAPSHOT',_0x66844a[_0x66844a[_0x4df7f0(0x154)]=0x1772]=_0x4df7f0(0x154),_0x66844a[_0x66844a[_0x4df7f0(0x334)]=0x1773]=_0x4df7f0(0x334),_0x66844a[_0x66844a['APPLY_REJECT']=0x1b59]=_0x4df7f0(0x2ac),_0x66844a[_0x66844a[_0x4df7f0(0x30b)]=0x1b5a]=_0x4df7f0(0x30b),_0x66844a[_0x66844a['APPLY_REVISION_CONFILICT']=0x1b5b]=_0x4df7f0(0x28b),_0x66844a[_0x66844a[_0x4df7f0(0x250)]=0x1b5c]=_0x4df7f0(0x250),_0x66844a[_0x66844a[_0x4df7f0(0x14e)]=0x1b5d]=_0x4df7f0(0x14e),_0x66844a[_0x66844a[_0x4df7f0(0x251)]=0x1f41]=_0x4df7f0(0x251),_0x66844a[_0x66844a[_0x4df7f0(0x25c)]=0x2329]=_0x4df7f0(0x25c),_0x66844a[_0x66844a[_0x4df7f0(0x167)]=0x232a]='LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED',_0x66844a[_0x66844a[_0x4df7f0(0x219)]=0x232b]=_0x4df7f0(0x219),_0x66844a[_0x66844a['LICENSE_EXPORT_SIZE_EXCEEDED']=0x232c]=_0x4df7f0(0x2bd),_0x66844a[_0x66844a[_0x4df7f0(0x25e)]=0x232d]='LICENSE_DISTRO_REJECTED',_0x66844a[_0x66844a['YUUMI_UNABLE_LOAD_URL']=0x2711]=_0x4df7f0(0x33b),_0x66844a[_0x66844a[_0x4df7f0(0x311)]=0x2712]=_0x4df7f0(0x311),_0x66844a[_0x66844a[_0x4df7f0(0x214)]=0x2713]=_0x4df7f0(0x214),_0x66844a[_0x66844a[_0x4df7f0(0x1cb)]=0x2714]=_0x4df7f0(0x1cb),_0x66844a[_0x66844a[_0x4df7f0(0x275)]=0x271a]=_0x4df7f0(0x275),_0x66844a[_0x66844a[_0x4df7f0(0x272)]=0x271b]=_0x4df7f0(0x272),_0x66844a[_0x66844a[_0x4df7f0(0x2b1)]=0x271c]=_0x4df7f0(0x2b1),_0x66844a[_0x66844a[_0x4df7f0(0x318)]=0x271d]='YUUMI_ALL_TABLES_IS_INVALID',_0x66844a[_0x66844a[_0x4df7f0(0x362)]=0x271e]=_0x4df7f0(0x362),_0x66844a[_0x66844a[_0x4df7f0(0x164)]=0x271f]=_0x4df7f0(0x164),_0x66844a[_0x66844a[_0x4df7f0(0x1b0)]=0x2720]=_0x4df7f0(0x1b0),_0x66844a[_0x66844a[_0x4df7f0(0x2c6)]=0x2af9]=_0x4df7f0(0x2c6),_0x66844a[_0x66844a[_0x4df7f0(0x2df)]=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0x66844a[_0x66844a[_0x4df7f0(0x2d1)]=0x2ee2]=_0x4df7f0(0x2d1),_0x66844a[_0x66844a[_0x4df7f0(0x260)]=0x2ee3]=_0x4df7f0(0x260),_0x66844a[_0x66844a[_0x4df7f0(0x20b)]=0x2ee4]=_0x4df7f0(0x20b),_0x66844a[_0x66844a[_0x4df7f0(0x23d)]=0x2ee5]=_0x4df7f0(0x23d),_0x66844a[_0x66844a[_0x4df7f0(0x325)]=0x32c9]='WECHAT_HAS_BEEN_BOUND',_0x66844a[_0x66844a[_0x4df7f0(0x1ee)]=0x32ca]='MOBILE_HAS_BEEN_BOUND',_0x66844a[_0x66844a['EMAIL_HAS_BEEN_BOUND']=0x32cb]=_0x4df7f0(0x2d9),_0x66844a[_0x66844a[_0x4df7f0(0x357)]=0x36b1]=_0x4df7f0(0x357),_0x66844a[_0x66844a[_0x4df7f0(0x1e5)]=0x36b2]='ENTITLE_UPDOWN_GRADE_NOT_SUPPORT',_0x66844a[_0x66844a[_0x4df7f0(0x215)]=0x36b3]=_0x4df7f0(0x215),_0x66844a[_0x66844a['PAYMENT_CHANNEL_NOT_SUPPORT']=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0x66844a[_0x66844a['ENTITLE_INVALID_COUPON_CODE']=0x36b5]='ENTITLE_INVALID_COUPON_CODE',_0x66844a[_0x66844a[_0x4df7f0(0x1ad)]=0x36b6]=_0x4df7f0(0x1ad),_0x66844a[_0x66844a[_0x4df7f0(0x327)]=0x36b7]=_0x4df7f0(0x327),_0x66844a[_0x66844a[_0x4df7f0(0x239)]=0x36b8]='ENTITLE_USE_COUPON_NOT_1ST_TRADE',_0x66844a[_0x66844a['ENTITLE_CHAT_LIMIT_EXCEED']=0x3715]=_0x4df7f0(0x26c),_0x66844a[_0x66844a[_0x4df7f0(0x1c0)]=0x3716]=_0x4df7f0(0x1c0),_0x66844a[_0x66844a['ENTITLE_INSUFFICIENT_QUOTA']=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0x66844a[_0x66844a['ENTITLE_NEED_BILLING_ADDRESS']=0x37dd]='ENTITLE_NEED_BILLING_ADDRESS',_0x66844a[_0x66844a[_0x4df7f0(0x283)]=0x3a99]=_0x4df7f0(0x283),_0x66844a[_0x66844a[_0x4df7f0(0x166)]=0x3a9a]=_0x4df7f0(0x166),_0x66844a[_0x66844a[_0x4df7f0(0x329)]=0x3a9b]='REDEMPTION_CODE_FULLY_REDEEMED',_0x66844a[_0x66844a[_0x4df7f0(0x1f3)]=0x3a9c]=_0x4df7f0(0x1f3),_0x66844a[_0x66844a[_0x4df7f0(0x229)]=0x3a9d]=_0x4df7f0(0x229),_0x66844a[_0x66844a[_0x4df7f0(0x29e)]=0x3a9e]=_0x4df7f0(0x29e),_0x66844a[_0x66844a['REDEMPTION_CODE_HAS_BEEN_CREATED']=0x3a9f]=_0x4df7f0(0x1d5),_0x66844a[_0x66844a[_0x4df7f0(0x296)]=0x3e81]=_0x4df7f0(0x296),_0x66844a[_0x66844a['UNRECOGNIZED']=-0x1]=_0x4df7f0(0x1fc),_0x66844a))(F||{}),H=(_0x19c064=>(_0x19c064[_0x19c064[_0x4df7f0(0x2c2)]=0x0]=_0x4df7f0(0x2c2),_0x19c064[_0x19c064[_0x4df7f0(0x2cb)]=0x1]=_0x4df7f0(0x2cb),_0x19c064[_0x19c064['UNIVER_SHEET']=0x2]=_0x4df7f0(0x156),_0x19c064[_0x19c064[_0x4df7f0(0x199)]=0x3]=_0x4df7f0(0x199),_0x19c064[_0x19c064[_0x4df7f0(0x1f6)]=0x4]=_0x4df7f0(0x1f6),_0x19c064[_0x19c064[_0x4df7f0(0x1fc)]=-0x1]='UNRECOGNIZED',_0x19c064))(H||{}),b=(_0x156f6f=>(_0x156f6f[_0x156f6f[_0x4df7f0(0x34a)]=0x0]=_0x4df7f0(0x34a),_0x156f6f[_0x156f6f['Edit']=0x1]=_0x4df7f0(0x2a7),_0x156f6f[_0x156f6f[_0x4df7f0(0x28e)]=0x2]=_0x4df7f0(0x28e),_0x156f6f[_0x156f6f['Print']=0x3]=_0x4df7f0(0x29b),_0x156f6f[_0x156f6f[_0x4df7f0(0x2aa)]=0x4]=_0x4df7f0(0x2aa),_0x156f6f[_0x156f6f[_0x4df7f0(0x309)]=0x5]=_0x4df7f0(0x309),_0x156f6f[_0x156f6f[_0x4df7f0(0x26d)]=0x6]=_0x4df7f0(0x26d),_0x156f6f[_0x156f6f[_0x4df7f0(0x339)]=0x7]='Share',_0x156f6f[_0x156f6f[_0x4df7f0(0x2d8)]=0x8]=_0x4df7f0(0x2d8),_0x156f6f[_0x156f6f[_0x4df7f0(0x242)]=0x9]='MoveWorksheet',_0x156f6f[_0x156f6f['DeleteWorksheet']=0xa]=_0x4df7f0(0x2ee),_0x156f6f[_0x156f6f[_0x4df7f0(0x21a)]=0xb]=_0x4df7f0(0x21a),_0x156f6f[_0x156f6f[_0x4df7f0(0x2d2)]=0xc]=_0x4df7f0(0x2d2),_0x156f6f[_0x156f6f[_0x4df7f0(0x349)]=0xd]=_0x4df7f0(0x349),_0x156f6f[_0x156f6f[_0x4df7f0(0x235)]=0xe]='SetWorksheetStyle',_0x156f6f[_0x156f6f['EditWorksheetCell']=0xf]=_0x4df7f0(0x1c2),_0x156f6f[_0x156f6f[_0x4df7f0(0x34f)]=0x10]='InsertHyperlink',_0x156f6f[_0x156f6f['Sort']=0x11]=_0x4df7f0(0x1d8),_0x156f6f[_0x156f6f[_0x4df7f0(0x1fe)]=0x12]=_0x4df7f0(0x1fe),_0x156f6f[_0x156f6f['PivotTable']=0x13]=_0x4df7f0(0x1a6),_0x156f6f[_0x156f6f[_0x4df7f0(0x312)]=0x14]='FloatImg',_0x156f6f[_0x156f6f['History']=0x15]=_0x4df7f0(0x2a2),_0x156f6f[_0x156f6f[_0x4df7f0(0x2f1)]=0x16]='RwHgtClWdt',_0x156f6f[_0x156f6f[_0x4df7f0(0x16c)]=0x17]=_0x4df7f0(0x16c),_0x156f6f[_0x156f6f['ViewFilter']=0x18]=_0x4df7f0(0x19e),_0x156f6f[_0x156f6f[_0x4df7f0(0x1ab)]=0x19]=_0x4df7f0(0x1ab),_0x156f6f[_0x156f6f[_0x4df7f0(0x26e)]=0x1a]=_0x4df7f0(0x26e),_0x156f6f[_0x156f6f[_0x4df7f0(0x303)]=0x1b]=_0x4df7f0(0x303),_0x156f6f[_0x156f6f[_0x4df7f0(0x25a)]=0x1c]='CopySheet',_0x156f6f[_0x156f6f['RenameSheet']=0x1d]=_0x4df7f0(0x290),_0x156f6f[_0x156f6f[_0x4df7f0(0x269)]=0x1e]=_0x4df7f0(0x269),_0x156f6f[_0x156f6f['SelectProtectedCells']=0x1f]=_0x4df7f0(0x267),_0x156f6f[_0x156f6f[_0x4df7f0(0x273)]=0x20]=_0x4df7f0(0x273),_0x156f6f[_0x156f6f['SetCellStyle']=0x21]=_0x4df7f0(0x2fb),_0x156f6f[_0x156f6f[_0x4df7f0(0x270)]=0x22]='SetCellValue',_0x156f6f[_0x156f6f[_0x4df7f0(0x1ef)]=0x23]=_0x4df7f0(0x1ef),_0x156f6f[_0x156f6f[_0x4df7f0(0x18c)]=0x24]=_0x4df7f0(0x18c),_0x156f6f[_0x156f6f[_0x4df7f0(0x23a)]=0x25]=_0x4df7f0(0x23a),_0x156f6f[_0x156f6f[_0x4df7f0(0x194)]=0x26]=_0x4df7f0(0x194),_0x156f6f[_0x156f6f[_0x4df7f0(0x2ed)]=0x27]='DeleteRow',_0x156f6f[_0x156f6f[_0x4df7f0(0x1f1)]=0x28]='DeleteColumn',_0x156f6f[_0x156f6f[_0x4df7f0(0x1e1)]=0x29]='EditExtraObject',_0x156f6f[_0x156f6f[_0x4df7f0(0x202)]=0x2a]=_0x4df7f0(0x202),_0x156f6f[_0x156f6f[_0x4df7f0(0x1d3)]=0x2b]='RecoverHistory',_0x156f6f[_0x156f6f[_0x4df7f0(0x2d7)]=0x2c]=_0x4df7f0(0x2d7),_0x156f6f[_0x156f6f['CreatePermissionObject']=0x2d]='CreatePermissionObject',_0x156f6f[_0x156f6f[_0x4df7f0(0x1fc)]=-0x1]='UNRECOGNIZED',_0x156f6f))(b||{});function be(_0x225bab){const _0x46bfcc=_0x4df7f0;return!!(_0x225bab&&_0x225bab[_0x46bfcc(0x15f)]&&_0x225bab[_0x46bfcc(0x15f)]!==F['OK']&&_0x225bab[_0x46bfcc(0x15f)]!=='OK');}const J=(_0xef8a21,_0x341a41)=>{const _0x2b0c86=_0x4df7f0;if(!_0xef8a21)return{'date':'','time':''};const _0x1d06fe=new Date(_0xef8a21),_0x439db4=_0x1d06fe[_0x2b0c86(0x181)]()[_0x2b0c86(0x224)]('T')[0x0];switch(_0x341a41){case _[_0x2b0c86(0x2da)][_0x2b0c86(0x16d)]:return{'date':Q(_0x439db4,_0x341a41),'time':_0x1d06fe[_0x2b0c86(0x217)]()+':'+String(_0x1d06fe[_0x2b0c86(0x212)]())['padStart'](0x2,'0')+':'+String(_0x1d06fe[_0x2b0c86(0x2ca)]())[_0x2b0c86(0x33e)](0x2,'0')};default:return{'date':Q(_0x439db4,_0x341a41),'time':_0x1d06fe['getHours']()+':'+_0x1d06fe[_0x2b0c86(0x212)]()+':'+_0x1d06fe['getSeconds']()};}},Pe=(_0x128dcd,_0xbf5009)=>{const _0x135da8=_0x4df7f0,_0xc5e1d0=_0x128dcd[_0x135da8(0x302)]||_0xbf5009['t'](_0x135da8(0x34e));if(_0x128dcd['commands']['some'](_0x18819c=>_0x18819c===R[_0x135da8(0x31a)]['id'])&&_0x128dcd[_0x135da8(0x263)]){const _0xb9b2a1=J(_0x128dcd[_0x135da8(0x263)],_0xbf5009[_0x135da8(0x1eb)]()),_0x3501ff=_0xb9b2a1[_0x135da8(0x1e2)]+'\x20'+_0xb9b2a1[_0x135da8(0x14d)];return _0xc5e1d0+'\x20'+_0xbf5009['t'](_0x135da8(0x2e4))+'\x20'+_0x3501ff+'\x20'+_0xbf5009['t'](_0x135da8(0x26b));}const _0x10d392=Le(_0x128dcd),_0x275d2f=_0x10d392[_0x135da8(0x2db)]===0x1?_0xbf5009['t'](_0x10d392[0x0]):''+_0xbf5009['t'](_0x10d392[0x0])+_0xbf5009['t'](_0x135da8(0x266));return _0xc5e1d0+'\x20'+_0x275d2f;};function Le(_0x8b0e15){const _0x2b9e98=_0x4df7f0;if(_0x8b0e15['commands']['length']===0x0)return[''];const _0x463d3e='editHistory.action.',_0x96732b=_0x463d3e+'editSheet',_0x2a0790=[{'id':R[_0x2b9e98(0x22d)]['id'],'action':_0x463d3e+'createSheet'},{'id':R[_0x2b9e98(0x31a)]['id'],'action':_0x463d3e+_0x2b9e98(0x2ba)},{'id':l[_0x2b9e98(0x330)]['id'],'action':_0x463d3e+_0x2b9e98(0x2cc)},{'id':l[_0x2b9e98(0x1b2)]['id'],'action':_0x463d3e+'removeSheet'},{'id':l[_0x2b9e98(0x22c)]['id'],'action':_0x463d3e+'setFrozen'},{'id':ce[_0x2b9e98(0x36f)]['id'],'action':_0x463d3e+'setFilter'},{'id':Z[_0x2b9e98(0x18d)]['id'],'action':_0x463d3e+'setDV'},{'id':Z['UpdateDataValidationMutation']['id'],'action':_0x463d3e+_0x2b9e98(0x2f0)},{'id':K[_0x2b9e98(0x226)]['id'],'action':_0x463d3e+_0x2b9e98(0x35a)},{'id':K[_0x2b9e98(0x2e1)]['id'],'action':_0x463d3e+_0x2b9e98(0x35a)},{'id':l[_0x2b9e98(0x301)]['id'],'action':_0x463d3e+_0x2b9e98(0x274)},{'id':l[_0x2b9e98(0x2b4)]['id'],'action':_0x463d3e+_0x2b9e98(0x274)},{'id':Oe[_0x2b9e98(0x2a1)]['id'],'action':_0x463d3e+'addSparkline'},{'id':Ne['InsertSheetsChartMutation']['id'],'action':_0x463d3e+_0x2b9e98(0x2fe)},{'id':l[_0x2b9e98(0x26a)]['id'],'action':_0x463d3e+'deleteProtection'},{'id':l[_0x2b9e98(0x2b8)]['id'],'action':_0x463d3e+'deleteProtection'}][_0x2b9e98(0x2ce)](_0x5a77cf=>_0x8b0e15[_0x2b9e98(0x15a)][_0x2b9e98(0x33d)](_0x5a77cf['id']));return _0x2a0790!=null&&_0x2a0790[_0x2b9e98(0x2db)]?_0x2a0790['map'](_0x2935d7=>_0x2935d7[_0x2b9e98(0x192)]):[_0x96732b];}function Q(_0x23d831,_0x144a00){const _0x1e66be=_0x4df7f0,[_0xcea076,_0x349e0b,_0x803f9a]=new Date()[_0x1e66be(0x181)]()[_0x1e66be(0x224)]('T')[0x0][_0x1e66be(0x224)]('-'),[_0x2a84d6,_0x1e4b15,_0x2c1c89]=_0x23d831['split']('-'),_0x472b11=_0xcea076===_0x2a84d6&&_0x349e0b===_0x1e4b15&&_0x803f9a===_0x2c1c89;let _0x3da503='',_0x5ece63='',_0x531104='';switch(_0x144a00){case _[_0x1e66be(0x2da)]['ZH_CN']:return _0x472b11?'今天':(_0x3da503=_0xcea076===_0x2a84d6?'':_0x2a84d6+'年',_0x5ece63=_0x1e4b15+'月',_0x531104=_0x2c1c89+'日',''+_0x3da503+_0x5ece63+_0x531104);default:return _0x472b11?'Today':(_0x3da503=_0xcea076===_0x2a84d6?'':_0x2a84d6+'-',_0x5ece63=_0x1e4b15+'-',_0x531104=''+_0x2c1c89,''+_0x3da503+_0x5ece63+_0x531104);}}function ye(_0x1d582a){const _0x24314b=_0x4df7f0;return _0x1d582a?_0x1d582a[_0x24314b(0x150)]((_0x1a02dd,_0x2a857d)=>{const _0x55cc80=_0x24314b,_0x1cd64b=new Date(_0x2a857d['time'])[_0x55cc80(0x181)]()[_0x55cc80(0x224)]('T')[0x0];return _0x1a02dd[_0x55cc80(0x2db)]>0x0&&_0x1a02dd[_0x1a02dd[_0x55cc80(0x2db)]-0x1][_0x55cc80(0x16b)]===_0x1cd64b?_0x1a02dd[_0x1a02dd[_0x55cc80(0x2db)]-0x1][_0x55cc80(0x1e0)]['push'](_0x2a857d):_0x1a02dd['push']({'dateString':_0x1cd64b,'versions':[_0x2a857d]}),_0x1a02dd;},[]):[];}var Ce=Object['getOwnPropertyDescriptor'],we=(_0x4b77f3,_0x4d4c40,_0xc1cbcb,_0x3ebff7)=>{const _0x1c33f6=_0x4df7f0;for(var _0x5b3a0d=_0x3ebff7>0x1?void 0x0:_0x3ebff7?Ce(_0x4d4c40,_0xc1cbcb):_0x4d4c40,_0x11cef4=_0x4b77f3[_0x1c33f6(0x2db)]-0x1,_0x50802b;_0x11cef4>=0x0;_0x11cef4--)(_0x50802b=_0x4b77f3[_0x11cef4])&&(_0x5b3a0d=_0x50802b(_0x5b3a0d)||_0x5b3a0d);return _0x5b3a0d;},T=(_0x2fee44,_0x79b5b6)=>(_0x449fb2,_0x4106f7)=>_0x79b5b6(_0x449fb2,_0x4106f7,_0x2fee44);const Ue='/universer-api/history';let A=class extends _['Disposable']{constructor(_0x24f580,_0x1911de,_0x3ba4c1,_0x516ea2,_0xe08139,_0x5bc73c,_0x4d795e){const _0x45d1bf=_0x4df7f0;super(),u(this,_0x45d1bf(0x291),new Map()),(this[_0x45d1bf(0x1a3)]=_0x24f580,this[_0x45d1bf(0x231)]=_0x1911de,this[_0x45d1bf(0x2cf)]=_0x3ba4c1,this['_configService']=_0x516ea2,this[_0x45d1bf(0x321)]=_0xe08139,this[_0x45d1bf(0x1ce)]=_0x5bc73c,this[_0x45d1bf(0x364)]=_0x4d795e);}[_0x4df7f0(0x1f2)](){this['_workbookDataCache']['clear'](),super['dispose']();}async['getVersions'](_0x3bf7ca,_0x37c698){const _0x2cbb1a=_0x4df7f0,_0x5c4a80=this[_0x2cbb1a(0x18e)]()+'/'+_0x3bf7ca+_0x2cbb1a(0x2bc)+(_0x37c698?_0x2cbb1a(0x310)+_0x37c698:'');try{const _0x29cb14=(await this[_0x2cbb1a(0x321)][_0x2cbb1a(0x2c7)](_0x5c4a80))[_0x2cbb1a(0x2a6)];if(_0x29cb14&&_0x29cb14[_0x2cbb1a(0x15d)]&&_0x29cb14['error'][_0x2cbb1a(0x15f)]===F['OK']){const {hasMore:_0x2efadb,lastLabel:_0x22eca3}=_0x29cb14,_0x2f3a61=$e(_0x29cb14),_0x2fddc3=_0x29cb14[_0x2cbb1a(0x201)]['users'];return{'hasMore':_0x2efadb,'lastLabel':_0x22eca3,'versions':_0x2f3a61,'members':_0x2fddc3};}}catch(_0x2b1417){console[_0x2cbb1a(0x15d)](_0x2b1417);}return null;}[_0x4df7f0(0x18e)](){const _0x1eae29=_0x4df7f0;var _0x494d84;const _0x49af25=this[_0x1eae29(0x1dc)][_0x1eae29(0x1a4)](_e);return(_0x494d84=_0x49af25==null?void 0x0:_0x49af25[_0x1eae29(0x2a3)])!=null?_0x494d84:Ue;}async[_0x4df7f0(0x1b3)](_0x1d67c5,_0x562d0e,_0x17f2f6){const _0x1dab9a=_0x4df7f0;var _0x5ef5c6,_0xf0b64c;_0x17f2f6===void 0x0&&(_0x17f2f6={}),this['_workbookDataCache'][_0x1dab9a(0x2f9)](_0x1d67c5)||this['_workbookDataCache']['set'](_0x1d67c5,new Map());const {snapshot:_0x2d3e02,changesets:_0x4fddcb,error:_0x8bbe70}=await this[_0x1dab9a(0x1a3)]['getUnitOnRev'](_0x17f2f6,{'unitID':_0x1d67c5,'type':H[_0x1dab9a(0x156)],'revision':_0x562d0e});if(be(_0x8bbe70)||!_0x2d3e02||!_0x2d3e02[_0x1dab9a(0x294)])throw new Error('[HistoryFetchService]:\x20request\x20snapshot\x20error!');const _0x234fad=(_0x5ef5c6=_0x4fddcb==null?void 0x0:_0x4fddcb['length'])!=null?_0x5ef5c6:0x0;if(_0x562d0e!==0x0&&_0x2d3e02['rev']+_0x234fad!==_0x562d0e)throw new Error(_0x1dab9a(0x247));const {workbook:_0x5437cc}=_0x2d3e02,_0x533739=_0x5437cc[_0x1dab9a(0x280)]?Object[_0x1dab9a(0x317)](_0x5437cc[_0x1dab9a(0x280)])['map'](([_0xe11dc,_0x23f95f])=>{const _0x380caa=_0x1dab9a;var _0x42e73a,_0x17a17a;return(_0x17a17a=(_0x42e73a=_0x23f95f[_0x380caa(0x27a)])==null?void 0x0:_0x42e73a['map'](_0x230dd0=>_0x230dd0))!=null?_0x17a17a:[];})[_0x1dab9a(0x2f7)]():[],_0x5a3e64=(await Promise[_0x1dab9a(0x1b1)](_0x533739[_0x1dab9a(0x16a)](_0x2bfd8d=>this['_snapshotServerService'][_0x1dab9a(0x258)](_0x17f2f6,{'unitID':_0x1d67c5,'type':H[_0x1dab9a(0x156)],'blockID':_0x2bfd8d})[_0x1dab9a(0x17d)](_0x53e866=>_0x53e866['block']))))[_0x1dab9a(0x2ce)](_0x384762=>!!_0x384762),_0x196b03=R[_0x1dab9a(0x32f)](_0x2d3e02,_0x5a3e64,_0x17f2f6);return(_0xf0b64c=this[_0x1dab9a(0x291)][_0x1dab9a(0x2c7)](_0x1d67c5))==null||_0xf0b64c[_0x1dab9a(0x367)](_0x562d0e,{'workbook':_0x196b03}),new Promise(_0xdef9a5=>{const _0x2c9a8d=_0x1dab9a,_0x46d262=this['_univerInstanceService'][_0x2c9a8d(0x363)](_['UniverInstanceType']['UNIVER_SHEET']);_0x46d262?(this['_univerInstanceService'][_0x2c9a8d(0x265)](_0x46d262[_0x2c9a8d(0x27f)]()),setTimeout(()=>{const _0x2b8162=_0x2c9a8d;this[_0x2b8162(0x195)](_0x196b03,_0x4fddcb),this[_0x2b8162(0x364)][_0x2b8162(0x2ec)](),_0xdef9a5(!0x0);},0x0)):(this[_0x2c9a8d(0x195)](_0x196b03,_0x4fddcb),_0xdef9a5(!0x0));});}['_createUnit'](_0x4ad77e,_0x239a02){const _0x54e225=_0x4df7f0,_0x57d05d=this['_univerInstanceService'][_0x54e225(0x36e)](_[_0x54e225(0x1ff)][_0x54e225(0x156)],_0x4ad77e);this['_univerInstanceService'][_0x54e225(0x31f)](_0x57d05d[_0x54e225(0x27f)]());const _0x558eb0=this[_0x54e225(0x1ce)]['interceptor'][_0x54e225(0x2f2)](this[_0x54e225(0x1ce)][_0x54e225(0x19f)]['getInterceptPoints']()['COMPRESS_MUTATION_APPLY']);return _0x239a02==null||_0x239a02['forEach'](_0x60efab=>{const _0x4054d1=_0x54e225,_0x570514=_0x60efab[_0x4054d1(0x23b)][_0x4054d1(0x16a)](_0x4b5e69=>({'id':_0x4b5e69['id'],'params':JSON[_0x4054d1(0x2bf)](_0x4b5e69['data'])}));({..._0x60efab,'mutations':_0x558eb0(_0x570514,null)||_0x570514}['mutations'][_0x4054d1(0x29a)](_0x567cd6=>{const _0x45d1b3=_0x4054d1;this['_commandService'][_0x45d1b3(0x213)](_0x567cd6['id'])&&this[_0x45d1b3(0x2cf)][_0x45d1b3(0x218)](_0x567cd6['id'],_0x567cd6[_0x45d1b3(0x1aa)]);}));}),_0x57d05d;}};A=we([T(0x0,R[_0x4df7f0(0x2f4)]),T(0x1,_[_0x4df7f0(0x152)]),T(0x2,_['ICommandService']),T(0x3,_[_0x4df7f0(0x158)]),T(0x4,_[_0x4df7f0(0x336)](oe[_0x4df7f0(0x279)])),T(0x5,_['Inject'](R[_0x4df7f0(0x249)])),T(0x6,_[_0x4df7f0(0x336)](l[_0x4df7f0(0x295)]))],A);function $e(_0x4dd18c){const _0x426928=_0x4df7f0;var _0x45e38d,_0x293a50;const _0x2fd139=[],{entities:_0x4c239c,historyIds:_0x478313}=_0x4dd18c,{datas:_0x516149,users:_0x239f65}=_0x4c239c;for(const _0x179d51 of _0x478313)if(_0x516149[_0x179d51]){const _0x3ba9ba=!!((_0x45e38d=_0x239f65[_0x516149[_0x179d51]['userId']])!=null&&_0x45e38d[_0x426928(0x1b7)]);_0x2fd139[_0x426928(0x28c)]({'unitId':_0x516149[_0x179d51][_0x426928(0x1cd)],'user':_0x3ba9ba?'':((_0x293a50=_0x239f65==null?void 0x0:_0x239f65[_0x516149[_0x179d51][_0x426928(0x24a)]])==null?void 0x0:_0x293a50['name'])||'','isAnonymous':_0x3ba9ba,'id':_0x179d51,'time':_0x516149[_0x179d51][_0x426928(0x27b)]?Number(_0x516149[_0x179d51]['createTime']):void 0x0,'commands':_0x516149[_0x179d51]['command'],'startRev':Number(_0x516149[_0x179d51][_0x426928(0x366)]),'endRev':Number(_0x516149[_0x179d51][_0x426928(0x254)]),'recoverTime':_0x516149[_0x179d51][_0x426928(0x263)]?Number(_0x516149[_0x179d51][_0x426928(0x263)]):void 0x0});}return _0x2fd139;}var Ve=Object[_0x4df7f0(0x1da)],xe=(_0x30fdc3,_0x161157,_0x35c1be,_0x47d73e)=>{const _0x5624b6=_0x4df7f0;for(var _0x5c6f37=_0x47d73e>0x1?void 0x0:_0x47d73e?Ve(_0x161157,_0x35c1be):_0x161157,_0x1b44b5=_0x30fdc3[_0x5624b6(0x2db)]-0x1,_0xe69ac6;_0x1b44b5>=0x0;_0x1b44b5--)(_0xe69ac6=_0x30fdc3[_0x1b44b5])&&(_0x5c6f37=_0xe69ac6(_0x5c6f37)||_0x5c6f37);return _0x5c6f37;},V=(_0x447849,_0x4f07a9)=>(_0x42304f,_0x55e09e)=>_0x4f07a9(_0x42304f,_0x55e09e,_0x447849),Y=(_0x4fdeb1=>(_0x4fdeb1['Entered']=_0x4df7f0(0x216),_0x4fdeb1[_0x4df7f0(0x33c)]=_0x4df7f0(0x371),_0x4fdeb1[_0x4df7f0(0x268)]='error',_0x4fdeb1))(Y||{}),w=(_0x34e5ea=>(_0x34e5ea[_0x4df7f0(0x196)]='init',_0x34e5ea[_0x4df7f0(0x2fa)]=_0x4df7f0(0x236),_0x34e5ea[_0x4df7f0(0x353)]=_0x4df7f0(0x1bd),_0x34e5ea))(w||{});const ke=_0x4df7f0(0x2fd);exports[_0x4df7f0(0x1c4)]=class extends _[_0x4df7f0(0x2d5)]{constructor(_0x4107f6,_0x244bba,_0x2b4612,_0x362c85){const _0x20c955=_0x4df7f0;super(),u(this,_0x20c955(0x220),new N['BehaviorSubject']([])),u(this,'versions$',this[_0x20c955(0x220)][_0x20c955(0x22b)]()),u(this,'_currentVersion$',new N[(_0x20c955(0x305))]('')),u(this,_0x20c955(0x233),this[_0x20c955(0x1c8)]['asObservable']()),u(this,_0x20c955(0x2a5),new N[(_0x20c955(0x305))](_0x20c955(0x216))),u(this,_0x20c955(0x1f9),this['_status$'][_0x20c955(0x22b)]()),u(this,_0x20c955(0x2e6),new N['BehaviorSubject'](0x0)),u(this,_0x20c955(0x253),this[_0x20c955(0x2e6)][_0x20c955(0x22b)]()),u(this,_0x20c955(0x2d6),new N[(_0x20c955(0x305))]('')),u(this,_0x20c955(0x18b),this['_unitId$'][_0x20c955(0x22b)]()),u(this,'_fetching',!0x1),u(this,_0x20c955(0x19c),new N['BehaviorSubject'](_0x20c955(0x1a9))),u(this,_0x20c955(0x21c),this['_loadingState$'][_0x20c955(0x22b)]()),u(this,_0x20c955(0x211),null),u(this,_0x20c955(0x324),!0x0),u(this,_0x20c955(0x343),new Map()),u(this,'_historyContainerId'),u(this,'_maskContainer'),u(this,_0x20c955(0x1b9)),u(this,_0x20c955(0x1be),!0x1),(this['_messageService']=_0x4107f6,this['_confirmService']=_0x244bba,this[_0x20c955(0x2e7)]=_0x2b4612,this[_0x20c955(0x171)]=_0x362c85);}async[_0x4df7f0(0x29d)](_0xcf2fa3,_0x5e7941,_0x60bb34){const _0x49e1dd=_0x4df7f0;this['_historyContainerId']=_0x5e7941,this[_0x49e1dd(0x1be)]=_0x60bb34,this[_0x49e1dd(0x2d6)][_0x49e1dd(0x352)](_0xcf2fa3),this[_0x49e1dd(0x2a4)]=!0x0;const _0x5bdd78=await this['_historyFetchService'][_0x49e1dd(0x159)](_0xcf2fa3);if(this[_0x49e1dd(0x2a4)]=!0x1,_0x5bdd78){const {versions:_0x50ecfa,lastLabel:_0x173b97,hasMore:_0x243aee,members:_0x324046}=_0x5bdd78;_0x50ecfa[_0x49e1dd(0x2db)]===0x0&&_0x50ecfa[_0x49e1dd(0x28c)]({'unitId':_0xcf2fa3,'id':ke,'startRev':0x1,'endRev':0x0,'time':Date[_0x49e1dd(0x276)](),'user':this[_0x49e1dd(0x2e7)]['t'](_0x49e1dd(0x31d)),'commands':[],'isAnonymous':!0x1}),this[_0x49e1dd(0x180)](_0x50ecfa,_0x243aee,_0x173b97,_0x324046),this[_0x49e1dd(0x1c8)][_0x49e1dd(0x352)](_0x50ecfa[0x0]['id']);}else this['_status$'][_0x49e1dd(0x352)](_0x49e1dd(0x15d));}async[_0x4df7f0(0x14b)](){const _0x51ad2e=_0x4df7f0;if(!this[_0x51ad2e(0x211)]||!this[_0x51ad2e(0x324)]||this[_0x51ad2e(0x2a4)])return!0x1;this['_fetching']=!0x0;const _0x5882d1=await this[_0x51ad2e(0x171)][_0x51ad2e(0x159)](this[_0x51ad2e(0x1cd)],this[_0x51ad2e(0x211)]);if(this[_0x51ad2e(0x2a4)]=!0x1,_0x5882d1){const {versions:_0x419234,lastLabel:_0x5cc53e,hasMore:_0x26a62f,members:_0x24017e}=_0x5882d1;this[_0x51ad2e(0x180)](_0x419234,_0x26a62f,_0x5cc53e,_0x24017e);}else this['_messageService'][_0x51ad2e(0x308)]({'content':this[_0x51ad2e(0x2e7)]['t'](_0x51ad2e(0x326)),'type':P[_0x51ad2e(0x147)][_0x51ad2e(0x268)],'duration':0xbb8});return!0x0;}async['triggerLoadSheet'](_0x47d75b){const _0x1014cf=_0x4df7f0;var _0x25cfa0;const _0x2b18cc=(_0x25cfa0=this[_0x1014cf(0x220)]['value'])==null?void 0x0:_0x25cfa0[_0x1014cf(0x2b7)](_0x40afaf=>_0x40afaf['id']===_0x47d75b),{endRev:_0xea532d}=_0x2b18cc||{};_0xea532d||_0xea532d===0x0?(this[_0x1014cf(0x19c)][_0x1014cf(0x352)]('loading'),await this[_0x1014cf(0x171)][_0x1014cf(0x1b3)](this[_0x1014cf(0x1cd)],_0xea532d),this[_0x1014cf(0x19c)]['next'](_0x1014cf(0x1bd))):this[_0x1014cf(0x2a5)][_0x1014cf(0x352)](_0x1014cf(0x15d));}async[_0x4df7f0(0x20c)](_0xa83035){const _0x1b5e36=_0x4df7f0,_0x2abe7a=_0xa83035?this['getVersion'](_0xa83035):this[_0x1b5e36(0x27d)]();if(!_0x2abe7a)return;const _0x401a86=_0x2abe7a[_0x1b5e36(0x221)],_0x90f23c=J(_0x2abe7a['time'],this[_0x1b5e36(0x2e7)][_0x1b5e36(0x1eb)]());await this[_0x1b5e36(0x160)][_0x1b5e36(0x1bb)]({'id':_0x1b5e36(0x304),'title':{'title':this[_0x1b5e36(0x2e7)]['t'](_0x1b5e36(0x358))},'children':{'title':this['_localeService']['t'](_0x1b5e36(0x30c))+_0x1b5e36(0x14f)+_0x90f23c[_0x1b5e36(0x1e2)]+'\x20'+_0x90f23c[_0x1b5e36(0x14d)]+')'},'cancelText':this[_0x1b5e36(0x2e7)]['t'](_0x1b5e36(0x186)),'confirmText':this[_0x1b5e36(0x2e7)]['t'](_0x1b5e36(0x1ba))})&&this['_revertRevision$'][_0x1b5e36(0x352)](_0x401a86);}[_0x4df7f0(0x180)](_0x24ba7a,_0xeb88a8,_0x487ad1,_0x2f4708){const _0x1981fe=_0x4df7f0;this[_0x1981fe(0x220)][_0x1981fe(0x352)](this['_versions$']['value']['concat'](_0x24ba7a)),this[_0x1981fe(0x324)]=_0xeb88a8,this[_0x1981fe(0x211)]=_0x487ad1,_0x2f4708&&Object[_0x1981fe(0x1d7)](_0x2f4708)['forEach'](_0x43231a=>this[_0x1981fe(0x343)]['set'](_0x43231a,_0x2f4708[_0x43231a]));}[_0x4df7f0(0x27d)](){const _0x57d6a8=_0x4df7f0;return this['getVersion'](this[_0x57d6a8(0x1c8)][_0x57d6a8(0x228)]);}['getVersion'](_0x2416ae){const _0x3497a6=_0x4df7f0;var _0x190781;return(_0x190781=this['_versions$'][_0x3497a6(0x228)])==null?void 0x0:_0x190781[_0x3497a6(0x2b7)](_0x56aac6=>_0x56aac6['id']===_0x2416ae);}[_0x4df7f0(0x1f4)](_0x21d8b3){const _0xeaaa55=_0x4df7f0;return this[_0xeaaa55(0x343)][_0xeaaa55(0x2c7)](_0x21d8b3);}['_createMask'](){const _0x5516b1=_0x4df7f0;this['_maskElement']=document[_0x5516b1(0x18f)](_0x5516b1(0x20e)),this[_0x5516b1(0x1b9)][_0x5516b1(0x28d)]=_0x5516b1(0x2b2),this['_maskElement'][_0x5516b1(0x1b6)][_0x5516b1(0x259)]=_0x5516b1(0x256),this[_0x5516b1(0x1b9)]['style'][_0x5516b1(0x2e3)]='0',this['_maskElement'][_0x5516b1(0x1b6)][_0x5516b1(0x148)]='0',this[_0x5516b1(0x1b9)][_0x5516b1(0x1b6)][_0x5516b1(0x1e9)]=_0x5516b1(0x27c),this[_0x5516b1(0x1b9)][_0x5516b1(0x1b6)][_0x5516b1(0x348)]=_0x5516b1(0x27c),this['_maskElement'][_0x5516b1(0x1b6)][_0x5516b1(0x2f6)]=_0x5516b1(0x230),this[_0x5516b1(0x1b9)][_0x5516b1(0x1b6)][_0x5516b1(0x36a)]=_0x5516b1(0x1e7),this[_0x5516b1(0x1b9)][_0x5516b1(0x1b6)][_0x5516b1(0x1ae)]='flex',this['_maskElement'][_0x5516b1(0x1b6)][_0x5516b1(0x2ab)]=_0x5516b1(0x20a),this[_0x5516b1(0x1b9)][_0x5516b1(0x1b6)][_0x5516b1(0x22e)]=_0x5516b1(0x163),this[_0x5516b1(0x1b9)][_0x5516b1(0x1b6)][_0x5516b1(0x1ae)]=_0x5516b1(0x370),this[_0x5516b1(0x331)][_0x5516b1(0x351)](this[_0x5516b1(0x1b9)]);}[_0x4df7f0(0x20d)](){const _0x24f522=_0x4df7f0;var _0x30c7e5;const _0x5ecb79=(_0x30c7e5=document['getElementById'](this[_0x24f522(0x149)]))==null?void 0x0:_0x30c7e5[_0x24f522(0x173)](_0x24f522(0x2c5));_0x5ecb79&&(this['_maskContainer']=_0x5ecb79,this[_0x24f522(0x1cc)]());}[_0x4df7f0(0x232)](){const _0x4b10ee=_0x4df7f0;this[_0x4b10ee(0x331)]||this[_0x4b10ee(0x20d)](),this[_0x4b10ee(0x1b9)]&&(this[_0x4b10ee(0x1b9)][_0x4b10ee(0x1b6)]['display']=_0x4b10ee(0x2ef));}[_0x4df7f0(0x368)](){const _0x1fb2d2=_0x4df7f0;this[_0x1fb2d2(0x1b9)]&&(this[_0x1fb2d2(0x1b9)][_0x1fb2d2(0x1b6)]['display']=_0x1fb2d2(0x370));}set[_0x4df7f0(0x161)](_0x5b8f6e){const _0x26436e=_0x4df7f0;this[_0x26436e(0x2a5)]['next'](_0x5b8f6e);}set[_0x4df7f0(0x271)](_0x591dea){const _0x1c97e8=_0x4df7f0;_0x591dea!==this['_currentVersion$'][_0x1c97e8(0x228)]&&this[_0x1c97e8(0x1c8)][_0x1c97e8(0x352)](_0x591dea);}get[_0x4df7f0(0x271)](){const _0x1ffdb7=_0x4df7f0;return this[_0x1ffdb7(0x1c8)][_0x1ffdb7(0x228)];}set['unitId'](_0x3c1ff4){const _0x337721=_0x4df7f0;this[_0x337721(0x2d6)][_0x337721(0x352)](_0x3c1ff4);}get['unitId'](){const _0x29b24a=_0x4df7f0;return this[_0x29b24a(0x2d6)][_0x29b24a(0x228)];}get[_0x4df7f0(0x1de)](){const _0x1c2e3c=_0x4df7f0;return this[_0x1c2e3c(0x1be)];}get[_0x4df7f0(0x2ae)](){const _0x499f07=_0x4df7f0;return this[_0x499f07(0x19c)]['value'];}},exports[_0x4df7f0(0x1c4)]=xe([V(0x0,d[_0x4df7f0(0x1e8)]),V(0x1,d[_0x4df7f0(0x299)]),V(0x2,_[_0x4df7f0(0x336)](_[_0x4df7f0(0x206)])),V(0x3,_[_0x4df7f0(0x336)](A))],exports['HistoryManagerService']);function W({ref:_0x5aa19b,..._0x256b4c}){const _0x56f3db=_0x4df7f0,{icon:_0x4ced56,id:_0x545fa1,className:_0x4e74f6,extend:_0x325702,..._0x1ef6f9}=_0x256b4c,_0x29b196=('univerjs-icon\x20univerjs-icon-'+_0x545fa1+'\x20'+(_0x4e74f6||''))[_0x56f3db(0x322)](),_0x483c3e=p[_0x56f3db(0x255)]('_'+je());return le(_0x4ced56,''+_0x545fa1,{'defIds':_0x4ced56[_0x56f3db(0x153)],'idSuffix':_0x483c3e[_0x56f3db(0x359)]},{'ref':_0x5aa19b,'className':_0x29b196,..._0x1ef6f9},_0x325702);}function le(_0x4986ca,_0x27cc4f,_0x7ee91d,_0x17955c,_0x26c327){const _0x3b28e8=_0x4df7f0;return p[_0x3b28e8(0x18f)](_0x4986ca[_0x3b28e8(0x1b4)],{'key':_0x27cc4f,...He(_0x4986ca,_0x7ee91d,_0x26c327),..._0x17955c},(Ae(_0x4986ca,_0x7ee91d)[_0x3b28e8(0x174)]||[])['map']((_0x35cc9a,_0x20be0a)=>le(_0x35cc9a,_0x27cc4f+'-'+_0x4986ca[_0x3b28e8(0x1b4)]+'-'+_0x20be0a,_0x7ee91d,void 0x0,_0x26c327)));}function _0x1a99(){const _0x1e7bcf=['top','editHistory.action.revertSheetPrefix','UNAUTHENTICATED','_revertRevision$','_localeService','Vector2','Module','univer-h-15\x20univer-flex\x20univer-cursor-pointer\x20univer-flex-col\x20univer-justify-center\x20univer-gap-1\x20univer-rounded-md\x20univer-px-4\x20univer-py-1.5\x20univer-transition-colors\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-800','IUIPartsService','refreshRangeProtectPermission','DeleteRow','DeleteWorksheet','flex','setDV','RwHgtClWdt','fetchThroughInterceptors','symbol','ISnapshotServerService','11eFmuDf','backgroundColor','flat','_currentVersionDiff$','has','Loading','SetCellStyle','_dialogOptions$','VIRTUAL_VERSION_NOW','insertChart','_getRangesByMutation','jsxs','AddWorksheetProtectionMutation','user','HideSheet','confirm-revert-revision','BehaviorSubject','versions$','editHistory.info.loading','show','Comment','MOBILE_VERIFY_CODE_MISMATCH','APPLY_NON_SEQUENTIAL_REVISION','editHistory.panel.revertConfirmText','1em','InsertColMutation','idSuffix','&lastLabel=','YUUMI_URL_COL_OUT_OF_RANGE','FloatImg','_init','range','assign','IDialogService','entries','YUUMI_ALL_TABLES_IS_INVALID','rgba(58,\x2096,\x20247,\x200.20)','RevertRevisionMutation','_transformService','RestoreIcon','editHistory.panel.currentUser','HEADER','focusUnit','2OFvMdy','_httpService','trim','substring','_hasMore','WECHAT_HAS_BEEN_BOUND','editHistory.panel.listFetchError','ENTITLE_COUPON_USED_UP','RangeMergeUtil','REDEMPTION_CODE_FULLY_REDEEMED','LOGIN_FAILED','_historyManagerService','clipPath','clsx','replace','transformSnapshotToWorkbookData','InsertSheetMutation','_maskContainer','connectInjector','CURRENT_STATUS_CANNOT_OPERATE','ENSURE_SNAPSHOT_EXECUTION','active','Inject','COMPLETION_FINISHED','m1Prime','Share','M8.79993\x2014.0166C8.79993\x2014.4585\x208.44176\x2014.8166\x207.99993\x2014.8166C4.23529\x2014.8166\x201.18345\x2011.7648\x201.18345\x208.00017C1.18345\x204.23554\x204.23529\x201.18369\x207.99993\x201.1837C11.7646\x201.1837\x2014.8164\x204.23554\x2014.8164\x208.00017C14.8164\x208.442\x2014.4582\x208.80017\x2014.0164\x208.80017C13.5746\x208.80017\x2013.2164\x208.442\x2013.2164\x208.00017C13.2164\x205.11919\x2010.8809\x202.7837\x207.99993\x202.7837C5.11895\x202.7837\x202.78345\x205.11919\x202.78345\x208.00017C2.78345\x2010.8812\x205.11895\x2013.2166\x207.99993\x2013.2166C8.44176\x2013.2166\x208.79993\x2013.5748\x208.79993\x2014.0166Z','YUUMI_UNABLE_LOAD_URL','Exited','includes','padStart','#0B9EFB','xlink:href','loading-multi-icon','_sheetSkeletonManagerService','_members','SHEET_VIEWPORT_KEY','_messageService','_cellEditorManagerService','attrs','height','CreateWorksheet','View','makeDirty','stopPropagation','2764068CFyEAo','editHistory.panel.unknownUser','InsertHyperlink','setValue','append','next','Loaded','useObservable','url(#$1','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','ENTITLE_CAN_NOT_BUY_LOWER_OTP','editHistory.panel.revertConfirm','current','setCF','_diffRangesMap','ensureVersion','evenodd','CollaborationImageIoService','combineLatest','VIEW_MAIN','mask','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','getCurrentUnitForType','_sheetPermissionInitController','_context','startRevision','set','hideMask','3944RCzttb','color','jsx','M7.20007\x201.98384C7.20007\x201.54201\x207.55824\x201.18384\x208.00007\x201.18384C11.7647\x201.18384\x2014.8165\x204.23568\x2014.8165\x208.00032C14.8165\x2011.765\x2011.7647\x2014.8168\x208.00007\x2014.8168C4.23543\x2014.8168\x201.18359\x2011.765\x201.18359\x208.00032C1.18359\x207.55849\x201.54177\x207.20031\x201.98359\x207.20031C2.42542\x207.20031\x202.78359\x207.55849\x202.78359\x208.00032C2.78359\x2010.8813\x205.11909\x2013.2168\x208.00007\x2013.2168C10.8811\x2013.2168\x2013.2165\x2010.8813\x2013.2165\x208.00032C13.2165\x205.11933\x2010.8811\x202.78384\x208.00007\x202.78384C7.55824\x202.78384\x207.20007\x202.42567\x207.20007\x201.98384Z','useState','createUnit','SetSheetsFilterRangeMutation','none','exited','path','univer-flex\x20univer-items-center\x20univer-gap-2.5\x20univer-py-1.5\x20univer-text-sm\x20univer-font-medium','MessageType','left','_historyContainerId','SheetCollabCursorShape','loadMoreVersions','412293LiFrXd','time','APPLY_DUPLICATED',':\x20(','reduce','_lastPointer','IUniverInstanceService','defIds','SNAPSHOT_HAS_BEEN_REMOVED','defs','UNIVER_SHEET','SetRangeValuesMutation','IConfigService','getVersions','commands','closeAll','_extractRanges','error','row','code','_confirmService','status','4023501ekRVHO','1000','YUUMI_AI_RUN_FAILED','univer-ml-2.5\x20univer-flex\x20univer-size-8\x20univer-cursor-pointer\x20univer-items-center\x20univer-justify-center\x20univer-rounded','REDEMPTION_CODE_INACTIVE','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','UniverIcon','column','map','dateString','ViemRwHgtClWdt','ZH_CN','_initPanel','subscribe','MoveRangeMutation','_historyFetchService','AUTHORIZE_CODE_ILLEGAL','querySelector','children','editHistory.panel.revertDesc','hidden','url(#restore-icon_clip0_1247_2)','useCallback','SetWorksheetActiveOperation','cellValue','getViewport','rule','then','UniverEditHistoryViewerPlugin','_initRender','_updateVersions','toISOString','onMouseMove','SNAPSHOT_INVALID_SNAPSHOT','isArray','onPointerMove$','editHistory.panel.cancel','currentVersionDiff$','isTransformMutationsSuccess','subUnitId','Info','unitId$','SetColumnStyle','AddDataValidationMutation','_getAPIPrefix','createElement','colorChannel1','_getActiveSubUnitId','action','ObjectMatrix','InsertColumn','_createUnit','Init','onSteady','_combineRanges','UNIVER_SLIDE','_initActiveSwitch','univer-ml-2\x20univer-flex\x20univer-h-5\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-border\x20univer-border-primary-600\x20univer-bg-primary-50\x20univer-px-1.5\x20univer-text-xs\x20univer-text-primary-600','_loadingState$','_renderManagerService','ViewFilter','interceptor','WorkbookRenameSheetPermission','toStringTag','_permissionService','_snapshotServerService','getConfig','_removeDiffMarks','PivotTable','pipe','Tooltip','init','params','MoveSheet','getCellPositionByOffset','ENTITLE_COUPON_EXPIRED','display','DependentOn','YUUMI_CONNECTOR_URL_NOT_FOUND','all','RemoveSheetMutation','loadSheet','tag','getAncestorScale','style','anonymous','sheetId','_maskElement','editHistory.panel.confirm','confirm','EMAIL_VERIFY_CODE_MISMATCH','loaded','_canRevert','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-text-sm\x20univer-text-gray-600\x20dark:!univer-text-gray-200','ENTITLE_REPORT_LIMIT_EXCEED','merge','EditWorksheetCell','currentColor','HistoryManagerService','from','changesets','ICommandService','_currentVersion$','http://www.w3.org/2000/svg','displayName','YUUMI_SUBSCRIPTION_NOT_FOUND','_createMask','unitId','_compressMutationService','span','ALREADY_EXISTS','Plugin','debounce','RecoverHistory','univer-text-2xl\x20dark:!univer-text-white','REDEMPTION_CODE_HAS_BEEN_CREATED','executeCommand','keys','Sort','0\x200\x2016\x2016','getOwnPropertyDescriptor','add','_configService','ReorderRangeMutation','canRevert','forValue','versions','EditExtraObject','date','updatePermissionPoint','_updateDiffMarks','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','univer-flex\x20univer-flex-1\x20univer-items-center\x20univer-justify-center','white','IMessageService','width','INTERNAL_ERROR','getCurrentLocale','toDisposable','LOGIN_TOKEN_PROCESSING_FAILED','MOBILE_HAS_BEEN_BOUND','SetRowStyle','MoveColsMutation','DeleteColumn','dispose','REDEMPTION_CODE_NOT_STARTED','getMember','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','UNIVER_PROJECT','onRendered','_injector','status$','360BgpGRm','register','UNRECOGNIZED','WorkbookHideSheetPermission','Filter','UniverInstanceType','USER_IS_ANONYMOUS','entities','Delete','random','univer-m-auto\x20univer-animate-spin','TOO_MANY_REQUESTS','LocaleService','ITransformService','svg','registerRenderModule','center','USER_NOT_INVITED_CODE','triggerRevert','_initMaskContainer','div','_uiPartsService','Subject','_lastLabel','getMinutes','hasCommand','YUUMI_RATE_OVER_LIMIT','ENTITLE_DUP_SUBSCRIPTION','entered','getHours','syncExecuteCommand','LICENSE_IMPORT_SIZE_EXCEEDED','HideWorksheet','univer-text-gray-500','loadingState$','values','_sidebarService','state$','_versions$','endRev','sheet','disposeWithMe','split','setConfig','SetConditionalRuleMutation','ERROR_AGAIN','value','REDEMPTION_USER_NOT_ELIGIBLE','transformMutations','asObservable','SetFrozenMutation','CreateUnitMutation','zIndex','endColumn','rgba(225,\x20225,\x20225,\x200.5)','_univerInstanceService','showMask','currentVersion$','623pWoCec','SetWorksheetStyle','loading','univer-animate-spin','currentSkeleton$','ENTITLE_USE_COUPON_NOT_1ST_TRADE','InsertRow','mutations','Injector','INVITE_CODE_ALREADY_BOUND','fill','univer-text-sm\x20univer-leading-5\x20univer-text-gray-500\x20dark:!univer-text-gray-300','getVpScrollXYInfoByPosToVp','_openPanel','MoveWorksheet','3021900qThyuP','endRow','getRelativeToViewportCoord','univer-h-full\x20univer-space-y-2\x20univer-overflow-auto\x20univer-pb-4','[HistoryFetchService]:\x20wrong\x20rev\x20from\x20the\x20server!','startColumn','CompressMutationService','userId','univer-overflow-hidden','Button','Fragment','_diffs','_sidebarDisposable','APPLY_PERMISSION_DENIED','CONNECTOR_DATA_TOO_LARGE','FromArray','revertRevision$','endRevision','useRef','absolute','USER_NOT_FOUND','getDeserializedSheetBlock','position','CopySheet','ranges','LICENSE_MAX_UNITS_EXCEEDED','getCoordByCell','LICENSE_DISTRO_REJECTED','8ThFAsD','INVITE_CODE_REQUIRED','NOT_FOUND','ISidebarService','recoverTime','editHistory.panel.title','disposeUnit','editHistory.action.etc','SelectProtectedCells','Error','CreateSheet','DeleteRangeProtectionMutation','editHistory.action.revertSheetSuffix','ENTITLE_CHAT_LIMIT_EXCEED','Copy','DeleteSheet','memberId','SetCellValue','currentVersion','YUUMI_ASYNCIO_CANCELLED','SelectUnProtectedCells','addProtection','YUUMI_NO_CUBOID_FOR_QUESTION','now','permissionPointUpdate$','univer-flex\x20univer-items-center\x20univer-justify-center','HTTPService','blocks','createTime','100%','getCurrentVersion','IPermissionService','getUnitId','blockMeta','_componentManager','INVALID_ARGUMENT','REDEMPTION_INVALID_CODE','string','LoadingMultiIcon','restore-icon','forwardRef','registerComponent','triggerLoadSheet','IImageIoService','APPLY_REVISION_CONFILICT','push','className','ManageCollaborator','DisposableCollection','RenameSheet','_workbookDataCache','M6.42416\x204.42417C6.65847\x204.18985\x206.65847\x203.80995\x206.42416\x203.57564C6.18984\x203.34132\x205.80994\x203.34132\x205.57563\x203.57564L1.57564\x207.57564C1.34132\x207.80995\x201.34132\x208.18985\x201.57564\x208.42417L5.57563\x2012.4242C5.80994\x2012.6585\x206.18984\x2012.6585\x206.42416\x2012.4242C6.65847\x2012.1899\x206.65847\x2011.81\x206.42416\x2011.5756L3.44843\x208.5999H14C14.3314\x208.5999\x2014.6\x208.33127\x2014.6\x207.9999C14.6\x207.66853\x2014.3314\x207.3999\x2014\x207.3999H3.44843L6.42416\x204.42417Z','pluginName','workbook','SheetPermissionInitController','DATA_SOURCE_TOO_LARGE','CHANGESET_REVISION_CONFILICT','addObjects','IConfirmService','forEach','Print','SetWorksheetHideMutation','triggerLoadVersions','REDEMPTION_USER_REDEEM_TIMES_EXCEED','onStarting','userID','AddSheetSparklineMutation','History','historyListServerUrl','_fetching','_status$','body','Edit','bottom','restore-icon_clip0_1247_2','Duplicate','justifyContent','APPLY_REJECT','setState','loadingState','getSheetObject','use','YUUMI_TABLE_NOT_FOUND_IN_UNIT','history-mask','subType','AddRangeProtectionMutation','2123935GRyEcH','univer-flex\x20univer-size-6\x20univer-items-center\x20univer-justify-center\x20univer-rounded\x20univer-text-gray-400\x20hover:univer-bg-gray-100\x20dark:hover:!univer-bg-gray-700','find','DeleteWorksheetProtectionMutation','MoveRowsMutation','revertSheet','WorkbookMoveSheetPermission','/list?length=20','LICENSE_EXPORT_SIZE_EXCEEDED','UNDEFINED','parse','391630mUQKzF','fetchMissingChangesets','UNIVER_UNKNOWN','univer-flex\x20univer-h-12\x20univer-cursor-default\x20univer-items-center','_config','.univer-app-container-content','PY_RUNTIME_SCRIPT_ERROR','get','WorkbookEditablePermission','editHistory.header.revert','getSeconds','UNIVER_DOC','insertSheet','scrollEvent$','filter','_commandService','defineProperty','INVALID_INVITE_CODE','RenameWorksheet','startRow','_transformMutationByOrder','Disposable','_unitId$','ViewHistory','Export','EMAIL_HAS_BEEN_BOUND','LocaleType','length','useDependency','_versionDiffService','RemoveNumfmtMutation','INVITE_CODE_HAS_BEEN_UES','PERMISSION_DENIED','AddConditionalRuleMutation','SetNumfmtMutation'];_0x1a99=function(){return _0x1e7bcf;};return _0x1a99();}function He(_0x3a9dca,_0x1c4c2d,_0x2136a8){const _0x3ee31e=_0x4df7f0,_0x1d1020={..._0x3a9dca[_0x3ee31e(0x347)]};_0x2136a8!=null&&_0x2136a8[_0x3ee31e(0x190)]&&_0x1d1020[_0x3ee31e(0x23e)]===_0x3ee31e(0x190)&&(_0x1d1020['fill']=_0x2136a8['colorChannel1']),_0x3a9dca[_0x3ee31e(0x1b4)]===_0x3ee31e(0x361)&&_0x1d1020['id']&&(_0x1d1020['id']=_0x1d1020['id']+_0x1c4c2d[_0x3ee31e(0x30f)]),Object[_0x3ee31e(0x317)](_0x1d1020)[_0x3ee31e(0x29a)](([_0x2d3d61,_0x1c859b])=>{const _0x473fae=_0x3ee31e;_0x2d3d61===_0x473fae(0x361)&&typeof _0x1c859b=='string'&&(_0x1d1020[_0x2d3d61]=_0x1c859b[_0x473fae(0x32e)](/url\(#(.*)\)/,_0x473fae(0x355)+_0x1c4c2d[_0x473fae(0x30f)]+')'));});const {defIds:_0x21d4c2}=_0x1c4c2d;return!_0x21d4c2||_0x21d4c2['length']===0x0||(_0x3a9dca[_0x3ee31e(0x1b4)]===_0x3ee31e(0x2b0)&&_0x1d1020['xlink:href']&&(_0x1d1020[_0x3ee31e(0x340)]=_0x1d1020['xlink:href']+_0x1c4c2d[_0x3ee31e(0x30f)]),Object[_0x3ee31e(0x317)](_0x1d1020)[_0x3ee31e(0x29a)](([_0x1cad8e,_0x38f09c])=>{const _0x27f7c6=_0x3ee31e;typeof _0x38f09c=='string'&&(_0x1d1020[_0x1cad8e]=_0x38f09c[_0x27f7c6(0x32e)](/url\(#(.*)\)/,_0x27f7c6(0x355)+_0x1c4c2d[_0x27f7c6(0x30f)]+')'));})),_0x1d1020;}function Ae(_0x136588,_0x22b5db){const _0x273b9c=_0x4df7f0;var _0x20882c;const {defIds:_0x384271}=_0x22b5db;return!_0x384271||_0x384271['length']===0x0?_0x136588:_0x136588[_0x273b9c(0x1b4)]===_0x273b9c(0x155)&&((_0x20882c=_0x136588['children'])!=null&&_0x20882c[_0x273b9c(0x2db)])?{..._0x136588,'children':_0x136588[_0x273b9c(0x174)][_0x273b9c(0x16a)](_0x16c637=>typeof _0x16c637[_0x273b9c(0x347)]['id']==_0x273b9c(0x284)&&_0x384271&&_0x384271['includes'](_0x16c637[_0x273b9c(0x347)]['id'])?{..._0x16c637,'attrs':{..._0x16c637['attrs'],'id':_0x16c637[_0x273b9c(0x347)]['id']+_0x22b5db['idSuffix']}}:_0x16c637)}:_0x136588;}function _0x37ff(_0x27f987,_0x5818af){_0x27f987=_0x27f987-0x147;const _0x1a99d9=_0x1a99();let _0x37ff8c=_0x1a99d9[_0x27f987];return _0x37ff8c;}function je(){const _0x14300f=_0x4df7f0;return Math[_0x14300f(0x203)]()['toString'](0x24)[_0x14300f(0x323)](0x2,0x8);}W[_0x4df7f0(0x1ca)]=_0x4df7f0(0x168);const Be={'tag':'svg','attrs':{'xmlns':_0x4df7f0(0x1c9),'fill':_0x4df7f0(0x370),'viewBox':_0x4df7f0(0x1d9),'width':_0x4df7f0(0x30d),'height':'1em'},'children':[{'tag':'path','attrs':{'fill':'currentColor','d':_0x4df7f0(0x292)}}]},ue=p['forwardRef'](function(_0x2e622e,_0x1d552e){const _0x17422a=_0x4df7f0;return p[_0x17422a(0x18f)](W,Object[_0x17422a(0x315)]({},_0x2e622e,{'id':'back-icon','ref':_0x1d552e,'icon':Be}));});ue[_0x4df7f0(0x1ca)]='BackIcon';const Fe={'tag':_0x4df7f0(0x208),'attrs':{'xmlns':_0x4df7f0(0x1c9),'fill':'none','viewBox':'0\x200\x2016\x2017','width':_0x4df7f0(0x30d),'height':_0x4df7f0(0x30d)},'children':[{'tag':'g','attrs':{'fill':_0x4df7f0(0x1c3),'clipPath':_0x4df7f0(0x177)},'children':[{'tag':'path','attrs':{'d':'M7.41252\x2010.6196C7.64683\x2010.3852\x207.64683\x2010.0053\x207.41252\x209.77103L6.77012\x209.12863H9.67836C9.89927\x209.12863\x2010.0784\x209.30772\x2010.0784\x209.52863V11.1953C10.0784\x2011.5267\x2010.347\x2011.7953\x2010.6784\x2011.7953C11.0097\x2011.7953\x2011.2784\x2011.5267\x2011.2784\x2011.1953V9.52863C11.2784\x208.64497\x2010.562\x207.92863\x209.67836\x207.92863H6.77012L7.41252\x207.28623C7.64683\x207.05191\x207.64683\x206.67201\x207.41252\x206.4377C7.1782\x206.20338\x206.79831\x206.20338\x206.56399\x206.4377L4.89732\x208.10437C4.66301\x208.33868\x204.66301\x208.71858\x204.89732\x208.95289L6.56399\x2010.6196C6.79831\x2010.8539\x207.1782\x2010.8539\x207.41252\x2010.6196Z'}},{'tag':_0x4df7f0(0x372),'attrs':{'d':'M2.06678\x203.37926C2.0668\x201.94333\x203.23085\x200.779297\x204.66678\x200.779297H9.44256C10.1796\x200.779297\x2010.8821\x201.09213\x2011.3751\x201.63999L13.2659\x203.74079C13.6955\x204.21822\x2013.9333\x204.83779\x2013.9333\x205.4801V12.7126C13.9333\x2014.1486\x2012.7692\x2015.3126\x2011.3333\x2015.3126H4.66665C3.2307\x2015.3126\x202.06663\x2014.1486\x202.06665\x2012.7126L2.06678\x203.37926ZM4.66678\x201.9793C3.89359\x201.9793\x203.26679\x202.60609\x203.26678\x203.37928L3.26665\x2012.7126C3.26664\x2013.4858\x203.89344\x2014.1126\x204.66665\x2014.1126H11.3333C12.1065\x2014.1126\x2012.7333\x2013.4858\x2012.7333\x2012.7126V5.4801C12.7333\x205.44882\x2012.7322\x205.41764\x2012.7302\x205.3866H10.7985C9.91488\x205.3866\x209.19853\x204.67026\x209.19853\x203.78661V1.9793H4.66678ZM10.4832\x202.44275L12.0526\x204.1866H10.7985C10.5776\x204.1866\x2010.3985\x204.00752\x2010.3985\x203.78661V2.35649C10.4279\x202.38389\x2010.4561\x202.41266\x2010.4832\x202.44275Z','fillRule':_0x4df7f0(0x35d),'clipRule':_0x4df7f0(0x35d)}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x4df7f0(0x32c),'attrs':{'id':_0x4df7f0(0x2a9)},'children':[{'tag':'rect','attrs':{'width':0x10,'height':0x10,'y':0.05,'fill':'white','rx':0x4}}]}]}],'defIds':['restore-icon_clip0_1247_2']},he=p[_0x4df7f0(0x287)](function(_0x414233,_0x1f2c64){const _0x199830=_0x4df7f0;return p[_0x199830(0x18f)](W,Object[_0x199830(0x315)]({},_0x414233,{'id':_0x199830(0x286),'ref':_0x1f2c64,'icon':Fe}));});he[_0x4df7f0(0x1ca)]=_0x4df7f0(0x31c);const Ye={'tag':_0x4df7f0(0x208),'attrs':{'xmlns':_0x4df7f0(0x1c9),'fill':_0x4df7f0(0x370),'viewBox':'0\x200\x2016\x2016','width':'1em','height':_0x4df7f0(0x30d)},'children':[{'tag':'path','attrs':{'fill':'#0B9EFB','d':_0x4df7f0(0x33a),'fillOpacity':0.2,'fillRule':_0x4df7f0(0x35d),'clipRule':_0x4df7f0(0x35d)}},{'tag':'path','attrs':{'fill':_0x4df7f0(0x33f),'d':_0x4df7f0(0x36c),'fillRule':_0x4df7f0(0x35d),'clipRule':_0x4df7f0(0x35d)}}]},ee=p['forwardRef'](function(_0x31008f,_0x263f8d){const _0x333df6=_0x4df7f0;return p[_0x333df6(0x18f)](W,Object[_0x333df6(0x315)]({},_0x31008f,{'id':_0x333df6(0x341),'ref':_0x263f8d,'icon':Ye}));});ee[_0x4df7f0(0x1ca)]=_0x4df7f0(0x285);function We(){const _0x2fb14e=_0x4df7f0;var _0xf76117;const _0x10be8a=d[_0x2fb14e(0x2dc)](exports[_0x2fb14e(0x1c4)]),_0x3b26b4=d['useDependency'](_[_0x2fb14e(0x206)]),_0x10d4a2=p['useCallback'](()=>{const _0x4bd600=_0x2fb14e;_0x10be8a[_0x4bd600(0x161)]=Y['Exited'];},[_0x10be8a]),_0x2e456a=p[_0x2fb14e(0x178)](()=>{const _0xc33d4f=_0x2fb14e;_0x10be8a[_0xc33d4f(0x20c)]();},[_0x10be8a]),_0x465db9=d[_0x2fb14e(0x354)](_0x10be8a['currentVersion$']),_0x5cbce4=d[_0x2fb14e(0x354)](_0x10be8a[_0x2fb14e(0x306)]),_0xcf2a73=_0x465db9===((_0xf76117=_0x5cbce4==null?void 0x0:_0x5cbce4[0x0])==null?void 0x0:_0xf76117['id']),_0x16e795=_0x465db9!==''&&!_0xcf2a73&&_0x10be8a['canRevert'];return h[_0x2fb14e(0x300)](_0x2fb14e(0x20e),{'className':P[_0x2fb14e(0x32d)](_0x2fb14e(0x2c3),P['borderBottomClassName']),'children':[h['jsx']('a',{'className':_0x2fb14e(0x165),'role':'button','onClick':_0x10d4a2,'children':h['jsx'](ue,{'className':_0x2fb14e(0x1d4)})}),h[_0x2fb14e(0x36b)]('div',{'className':_0x2fb14e(0x1e6),'children':_0x16e795&&h[_0x2fb14e(0x36b)](P[_0x2fb14e(0x24c)],{'variant':'primary','onClick':_0x2e456a,'children':_0x3b26b4['t'](_0x2fb14e(0x2c9))})})]});}var Xe=Object[_0x4df7f0(0x1da)],Ge=(_0x733be9,_0x542635,_0x3b7627,_0x2ad4f0)=>{const _0x419f4d=_0x4df7f0;for(var _0x2ae353=_0x2ad4f0>0x1?void 0x0:_0x2ad4f0?Xe(_0x542635,_0x3b7627):_0x542635,_0x462698=_0x733be9[_0x419f4d(0x2db)]-0x1,_0x8b7a35;_0x462698>=0x0;_0x462698--)(_0x8b7a35=_0x733be9[_0x462698])&&(_0x2ae353=_0x8b7a35(_0x2ae353)||_0x2ae353);return _0x2ae353;},L=(_0x279998,_0x379e7e)=>(_0x1ba3a5,_0x34b6bc)=>_0x379e7e(_0x1ba3a5,_0x34b6bc,_0x279998);let j=class extends _['Disposable']{constructor(_0x45bef6,_0x20581e,_0x41acc8,_0x36c035,_0x1cdcd8,_0x14c51b){const _0x486983=_0x4df7f0;super(),this['_permissionService']=_0x45bef6,this[_0x486983(0x20f)]=_0x20581e,this[_0x486983(0x345)]=_0x41acc8,this[_0x486983(0x2e7)]=_0x36c035,this[_0x486983(0x32b)]=_0x1cdcd8,this['_injector']=_0x14c51b,this[_0x486983(0x313)]();}['_init'](){const _0x2cc0c8=_0x4df7f0;this['disposeWithMe'](this[_0x2cc0c8(0x32b)]['currentVersion$'][_0x2cc0c8(0x16f)](_0x23f4b7=>{const _0x1c62ec=_0x2cc0c8;_0x23f4b7&&this[_0x1c62ec(0x32b)][_0x1c62ec(0x289)](_0x23f4b7);})),this['disposeWithMe'](this[_0x2cc0c8(0x1a2)][_0x2cc0c8(0x277)][_0x2cc0c8(0x16f)](_0x172d1d=>{const _0x2ea5f0=_0x2cc0c8,_0x12e6c7=this[_0x2ea5f0(0x32b)][_0x2ea5f0(0x1cd)];_0x12e6c7&&(_0x172d1d[_0x2ea5f0(0x2b3)]===b[_0x2ea5f0(0x2a7)]&&_0x172d1d[_0x2ea5f0(0x228)]===!0x0&&this[_0x2ea5f0(0x1a2)][_0x2ea5f0(0x1e3)](new l['WorkbookEditablePermission'](_0x12e6c7)['id'],!0x1),_0x172d1d[_0x2ea5f0(0x2b3)]===b[_0x2ea5f0(0x290)]&&_0x172d1d[_0x2ea5f0(0x228)]===!0x0&&this[_0x2ea5f0(0x1a2)][_0x2ea5f0(0x1e3)](new l[(_0x2ea5f0(0x1a0))](_0x12e6c7)['id'],!0x1),_0x172d1d[_0x2ea5f0(0x2b3)]===b[_0x2ea5f0(0x1ab)]&&_0x172d1d[_0x2ea5f0(0x228)]===!0x0&&this[_0x2ea5f0(0x1a2)]['updatePermissionPoint'](new l[(_0x2ea5f0(0x2bb))](_0x12e6c7)['id'],!0x1),_0x172d1d[_0x2ea5f0(0x2b3)]===b[_0x2ea5f0(0x303)]&&_0x172d1d[_0x2ea5f0(0x228)]===!0x0&&this['_permissionService'][_0x2ea5f0(0x1e3)](new l[(_0x2ea5f0(0x1fd))](_0x12e6c7)['id'],!0x1),_0x172d1d[_0x2ea5f0(0x2b3)]===b[_0x2ea5f0(0x309)]&&_0x172d1d[_0x2ea5f0(0x228)]===!0x0&&this[_0x2ea5f0(0x1a2)][_0x2ea5f0(0x1e3)](new l['WorkbookEditablePermission'](_0x12e6c7)['id'],!0x1),_0x172d1d['subType']===b['FloatImg']&&_0x172d1d['value']===!0x0&&this[_0x2ea5f0(0x1a2)]['updatePermissionPoint'](new l[(_0x2ea5f0(0x2c8))](_0x12e6c7)['id'],!0x1));})),this[_0x2cc0c8(0x223)](this[_0x2cc0c8(0x20f)][_0x2cc0c8(0x288)](d['BuiltInUIPart'][_0x2cc0c8(0x31e)],()=>d[_0x2cc0c8(0x332)](We,this[_0x2cc0c8(0x1f8)]))),this[_0x2cc0c8(0x223)](this[_0x2cc0c8(0x32b)][_0x2cc0c8(0x21c)][_0x2cc0c8(0x16f)](_0x3d5179=>{const _0x1ec68b=_0x2cc0c8;_0x3d5179===w['Loading']&&(this[_0x1ec68b(0x32b)][_0x1ec68b(0x232)](),this['_messageService'][_0x1ec68b(0x308)]({'type':P[_0x1ec68b(0x147)][_0x1ec68b(0x18a)],'content':this['_localeService']['t'](_0x1ec68b(0x307))})),_0x3d5179===w[_0x1ec68b(0x353)]&&this[_0x1ec68b(0x32b)][_0x1ec68b(0x368)]();}));}};j=Ge([L(0x0,_[_0x4df7f0(0x27e)]),L(0x1,d[_0x4df7f0(0x2eb)]),L(0x2,d[_0x4df7f0(0x1e8)]),L(0x3,_[_0x4df7f0(0x336)](_[_0x4df7f0(0x206)])),L(0x4,_[_0x4df7f0(0x336)](exports[_0x4df7f0(0x1c4)])),L(0x5,_[_0x4df7f0(0x336)](_[_0x4df7f0(0x23c)]))],j);var qe=Object[_0x4df7f0(0x1da)],Ze=(_0x561562,_0x2d427b,_0x556aca,_0x57f199)=>{const _0x168584=_0x4df7f0;for(var _0x4687af=_0x57f199>0x1?void 0x0:_0x57f199?qe(_0x2d427b,_0x556aca):_0x2d427b,_0x1f0994=_0x561562[_0x168584(0x2db)]-0x1,_0x25bae0;_0x1f0994>=0x0;_0x1f0994--)(_0x25bae0=_0x561562[_0x1f0994])&&(_0x4687af=_0x25bae0(_0x4687af)||_0x4687af);return _0x4687af;},G=(_0x2901f9,_0x140bad)=>(_0x53ba32,_0x57a4c6)=>_0x140bad(_0x53ba32,_0x57a4c6,_0x2901f9);let $=class extends _['Disposable']{constructor(_0x2af92b,_0x430198,_0x388ba2){const _0x40d9e0=_0x4df7f0;super(),u(this,_0x40d9e0(0x35b),new Map()),u(this,_0x40d9e0(0x2f8),new N['BehaviorSubject']({'ranges':new Map(),'active':null})),u(this,_0x40d9e0(0x187),this[_0x40d9e0(0x2f8)][_0x40d9e0(0x22b)]()),(this['_historyManagerService']=_0x2af92b,this[_0x40d9e0(0x31b)]=_0x430198,this[_0x40d9e0(0x1a3)]=_0x388ba2,this[_0x40d9e0(0x313)]());}[_0x4df7f0(0x313)](){const _0x14e153=_0x4df7f0;this[_0x14e153(0x35b)]=new Map(),this[_0x14e153(0x223)](this[_0x14e153(0x32b)][_0x14e153(0x18b)][_0x14e153(0x16f)](_0x1b8e83=>{const _0x4bcf51=_0x14e153;_0x1b8e83&&!this[_0x4bcf51(0x35b)][_0x4bcf51(0x2f9)](_0x1b8e83)&&this[_0x4bcf51(0x35b)][_0x4bcf51(0x367)](_0x1b8e83,new Map());})),this['disposeWithMe'](this['_historyManagerService']['currentVersion$'][_0x14e153(0x16f)](async _0x212f72=>{const _0x1ee448=_0x14e153;var _0x109487;_0x212f72&&(await this[_0x1ee448(0x35c)](_0x212f72),this[_0x1ee448(0x2f8)][_0x1ee448(0x352)](((_0x109487=this[_0x1ee448(0x35b)]['get'](this['_historyManagerService'][_0x1ee448(0x1cd)]))==null?void 0x0:_0x109487[_0x1ee448(0x2c7)](_0x212f72))||{'ranges':new Map(),'active':null}));}));}async['ensureVersion'](_0x3e7c5f){const _0x4e322f=_0x4df7f0;var _0x591cd7,_0x1395fb;const _0x21a983=this[_0x4e322f(0x32b)]['getVersion'](_0x3e7c5f),_0x3a7e37=this[_0x4e322f(0x32b)][_0x4e322f(0x1cd)];if(!_0x21a983||!_0x3a7e37)return;const _0x31ce20=this[_0x4e322f(0x35b)][_0x4e322f(0x2c7)](_0x3a7e37);if(_0x31ce20||this[_0x4e322f(0x35b)][_0x4e322f(0x367)](_0x3a7e37,new Map()),(_0x591cd7=this[_0x4e322f(0x35b)]['get'](_0x3a7e37))!=null&&_0x591cd7['has'](_0x21a983['id']))return;const {startRev:_0x1e81a9,endRev:_0x528f4c}=_0x21a983;if(_0x1e81a9===0x1){_0x31ce20[_0x4e322f(0x367)](_0x21a983['id'],{'ranges':new Map(),'active':null});return;}const _0x175ffc=_0x1e81a9-0x1,_0x42f8a1=_0x528f4c,_0x41067d=await this[_0x4e322f(0x1a3)][_0x4e322f(0x2c1)]({},{'unitID':_0x3a7e37,'from':_0x175ffc,'to':_0x42f8a1,'type':H['UNIVER_SHEET']});if(((_0x1395fb=_0x41067d['error'])==null?void 0x0:_0x1395fb[_0x4e322f(0x15f)])===F['OK']){const _0x126ac9=_0x41067d[_0x4e322f(0x1c6)][_0x4e322f(0x16a)](_0x36e18e=>((_0x36e18e[_0x4e322f(0x23b)]===null||_0x36e18e[_0x4e322f(0x23b)]===void 0x0)&&(_0x36e18e[_0x4e322f(0x23b)]=[]),R['parseProtocolChangeset'](_0x36e18e)))[_0x4e322f(0x16a)](_0x5244c5=>_0x5244c5[_0x4e322f(0x23b)][_0x4e322f(0x16a)](_0x2f277e=>({..._0x2f277e,'params':{..._0x2f277e['params'],'memberId':_0x5244c5[_0x4e322f(0x2a0)]}})))['flat'](),_0x6758bc=this['_transformMutationByOrder'](_0x126ac9),_0x4afbef=this[_0x4e322f(0x191)](_0x126ac9),_0x3baefd=this[_0x4e322f(0x15c)](_0x6758bc);_0x31ce20[_0x4e322f(0x367)](_0x21a983['id'],{'ranges':_0x3baefd,'active':_0x4afbef});}}[_0x4df7f0(0x2d4)](_0x5e7d6b){const _0x268365=_0x4df7f0;let _0x27eaca=[];for(let _0x3aa264=0x0;_0x3aa264<_0x5e7d6b[_0x268365(0x2db)];_0x3aa264++){const _0xab312f=_0x5e7d6b[_0x3aa264];if(_0x27eaca[_0x268365(0x28c)](_0xab312f),_0x3aa264!==_0x5e7d6b[_0x268365(0x2db)]-0x1){const _0x4e1c86=_0x5e7d6b[_0x3aa264+0x1],_0x5b894c=this['_transformService'][_0x268365(0x22a)](_0x27eaca,[_0x4e1c86]);R[_0x268365(0x188)](_0x5b894c)?_0x27eaca=_0x5b894c[_0x268365(0x338)]:_0x27eaca=[];}}return _0x27eaca;}[_0x4df7f0(0x191)](_0x29a83f){const _0x148902=_0x4df7f0;let _0x55e589=[];return _0x29a83f[_0x148902(0x29a)](_0x40e841=>{const _0x257466=_0x148902;if(_0x40e841['id']===l['InsertSheetMutation']['id']){const _0x2b53b6=_0x40e841['params'];_0x55e589[_0x257466(0x28c)](_0x2b53b6[_0x257466(0x222)]['id']);}else{if(_0x40e841['id']===l['RemoveSheetMutation']['id']){const _0xb1b278=_0x40e841['params'];_0x55e589[_0x257466(0x2db)]>0x0&&(_0x55e589=_0x55e589['filter'](_0x44526b=>_0x44526b!==_0xb1b278[_0x257466(0x189)]));}else{if(_0x40e841['id']===l[_0x257466(0x29c)]['id']){const _0x4bd234=_0x40e841[_0x257466(0x1aa)];_0x4bd234[_0x257466(0x176)]?_0x55e589=_0x55e589[_0x257466(0x2ce)](_0x2b4782=>_0x2b4782!==_0x4bd234[_0x257466(0x189)]):_0x55e589[_0x257466(0x28c)](_0x4bd234[_0x257466(0x189)]);}else{const _0x4cbcd6=_0x40e841[_0x257466(0x1aa)];_0x4cbcd6['subUnitId']&&_0x55e589['push'](_0x4cbcd6[_0x257466(0x189)]);}}}}),_0x55e589[_0x148902(0x2db)]>0x0?_0x55e589[_0x55e589[_0x148902(0x2db)]-0x1]:null;}[_0x4df7f0(0x15c)](_0x77ffbe){const _0x110456=_0x4df7f0,_0xf33629=new Map();return _0x77ffbe[_0x110456(0x29a)](_0x59643a=>{const _0x18b93c=_0x110456;var _0x2db9d4,_0x4c9b2b;const _0x3a6288=(_0x2db9d4=_0x59643a[_0x18b93c(0x1aa)])==null?void 0x0:_0x2db9d4[_0x18b93c(0x26f)];if(_0x3a6288){_0xf33629[_0x18b93c(0x2f9)](_0x3a6288)||_0xf33629[_0x18b93c(0x367)](_0x3a6288,[]);const _0x61b27a=this[_0x18b93c(0x2ff)](_0x59643a);(_0x4c9b2b=_0xf33629[_0x18b93c(0x2c7)](_0x3a6288))==null||_0x4c9b2b[_0x18b93c(0x28c)](..._0x61b27a);}}),_0xf33629[_0x110456(0x29a)]((_0x32c4a1,_0x3b31cd)=>{const _0x4243c1=_0x110456;_0xf33629['set'](_0x3b31cd,this[_0x4243c1(0x198)](_0x32c4a1));}),_0xf33629;}[_0x4df7f0(0x2ff)](_0x44b679){const _0xc666d4=_0x4df7f0;switch(_0x44b679['id']){case l[_0xc666d4(0x2b4)]['id']:{const _0xc08cd8=_0x44b679[_0xc666d4(0x1aa)];return _0xc08cd8['rules'][_0xc666d4(0x16a)](_0x1b224b=>_0x1b224b[_0xc666d4(0x25b)][_0xc666d4(0x16a)](_0x431e13=>({'range':_0x431e13,'unitId':_0xc08cd8[_0xc666d4(0x1cd)],'subUnitId':_0xc08cd8[_0xc666d4(0x189)]})))[_0xc666d4(0x2f7)]();}case l['AddWorksheetMergeMutation']['id']:{const _0x4581dc=_0x44b679[_0xc666d4(0x1aa)];return _0x4581dc['ranges'][_0xc666d4(0x16a)](_0x53c56c=>({'range':_0x53c56c,'unitId':_0x4581dc[_0xc666d4(0x1cd)],'subUnitId':_0x4581dc[_0xc666d4(0x189)]}));}case l['InsertRowMutation']['id']:{const _0x60be17=_0x44b679[_0xc666d4(0x1aa)];return[{'range':_0x60be17[_0xc666d4(0x314)],'unitId':_0x60be17[_0xc666d4(0x1cd)],'subUnitId':_0x60be17[_0xc666d4(0x189)]}];}case l[_0xc666d4(0x30e)]['id']:{const _0x494ca2=_0x44b679[_0xc666d4(0x1aa)];return[{'range':_0x494ca2[_0xc666d4(0x314)],'unitId':_0x494ca2[_0xc666d4(0x1cd)],'subUnitId':_0x494ca2['subUnitId']}];}case l[_0xc666d4(0x170)]['id']:{const _0x1933bc=_0x44b679['params'],{from:_0xd8909c,to:_0x1488db,unitId:_0xbbcb2a}=_0x1933bc;return[{'range':re(_0xd8909c[_0xc666d4(0x228)]),'unitId':_0xbbcb2a,'subUnitId':_0xd8909c['subUnitId']},{'range':re(_0x1488db[_0xc666d4(0x228)]),'unitId':_0xbbcb2a,'subUnitId':_0x1488db['subUnitId']}];}case l[_0xc666d4(0x2b9)]['id']:{const _0x36d16a=_0x44b679[_0xc666d4(0x1aa)],{unitId:_0x33f36f,subUnitId:_0x452d93,sourceRange:_0xa1835e,targetRange:_0x37b887}=_0x36d16a,_0x5cd099=_0xa1835e[_0xc666d4(0x244)]-_0xa1835e[_0xc666d4(0x2d3)]+0x1;return[{'range':_0x37b887[_0xc666d4(0x2d3)]<=_0xa1835e[_0xc666d4(0x2d3)]?_0x37b887:{..._0x37b887,'startRow':_0x37b887[_0xc666d4(0x2d3)]-_0x5cd099,'endRow':_0x37b887[_0xc666d4(0x244)]-_0x5cd099},'unitId':_0x33f36f,'subUnitId':_0x452d93}];}case l[_0xc666d4(0x1f0)]['id']:{const _0x3040e2=_0x44b679[_0xc666d4(0x1aa)],{unitId:_0x15e7d2,subUnitId:_0x5495e2,sourceRange:_0x14217b,targetRange:_0x3b85b6}=_0x3040e2,_0x27db9d=_0x14217b[_0xc666d4(0x22f)]-_0x14217b['startColumn']+0x1;return[{'range':_0x3b85b6['startColumn']<=_0x14217b[_0xc666d4(0x248)]?_0x3b85b6:{..._0x3b85b6,'startColumn':_0x3b85b6['startColumn']-_0x27db9d,'endColumn':_0x3b85b6['endColumn']-_0x27db9d},'unitId':_0x15e7d2,'subUnitId':_0x5495e2}];}case l[_0xc666d4(0x2e2)]['id']:{const _0x1566dc=_0x44b679['params'],{values:_0x2e007a,unitId:_0x51ad9c,subUnitId:_0x246d68}=_0x1566dc;return Object[_0xc666d4(0x21d)](_0x2e007a)['map'](_0x2236fb=>_0x2236fb[_0xc666d4(0x25b)]['map'](_0x33db85=>({'range':_0x33db85,'unitId':_0x51ad9c,'subUnitId':_0x246d68})))['flat']();}case l[_0xc666d4(0x2de)]['id']:{const _0x14cb0a=_0x44b679[_0xc666d4(0x1aa)],{ranges:_0x58a09a,unitId:_0x136b4e,subUnitId:_0x44893c}=_0x14cb0a;return _0x58a09a[_0xc666d4(0x16a)](_0x3b99dc=>({'range':_0x3b99dc,'unitId':_0x136b4e,'subUnitId':_0x44893c}));}case l[_0xc666d4(0x1dd)]['id']:{const _0x1c9de0=_0x44b679[_0xc666d4(0x1aa)],{unitId:_0x989dde,subUnitId:_0x469579,range:_0x4b64e2}=_0x1c9de0;return[{'range':_0x4b64e2,'unitId':_0x989dde,'subUnitId':_0x469579}];}case l['SetRangeProtectionMutation']['id']:{const _0x14b871=_0x44b679[_0xc666d4(0x1aa)];return _0x14b871[_0xc666d4(0x17c)][_0xc666d4(0x25b)]['map'](_0x25f8a9=>({'range':_0x25f8a9,'unitId':_0x14b871[_0xc666d4(0x1cd)],'subUnitId':_0x14b871[_0xc666d4(0x189)]}));}case l[_0xc666d4(0x157)]['id']:{const _0x4cc724=_0x44b679['params'];return _0x4cc724[_0xc666d4(0x17a)]?Ke(_0x4cc724[_0xc666d4(0x17a)])[_0xc666d4(0x16a)](_0x1507ad=>({'range':_0x1507ad,'unitId':_0x4cc724[_0xc666d4(0x1cd)],'subUnitId':_0x4cc724[_0xc666d4(0x189)]})):[];}case ce['SetSheetsFilterRangeMutation']['id']:{const _0xd83871=_0x44b679['params'];return[{'range':_0xd83871[_0xc666d4(0x314)],'unitId':_0xd83871[_0xc666d4(0x1cd)],'subUnitId':_0xd83871[_0xc666d4(0x189)]}];}case Z['AddDataValidationMutation']['id']:{const _0x5b19d1=_0x44b679['params'];return(Array[_0xc666d4(0x184)](_0x5b19d1['rule'])?_0x5b19d1[_0xc666d4(0x17c)]:[_0x5b19d1['rule']])[_0xc666d4(0x16a)](_0x3c2b1c=>_0x3c2b1c[_0xc666d4(0x25b)][_0xc666d4(0x16a)](_0x16d8a5=>({'range':_0x16d8a5,'unitId':_0x5b19d1['unitId'],'subUnitId':_0x5b19d1[_0xc666d4(0x189)]})))['flat']();}case K[_0xc666d4(0x226)]['id']:{const _0x3f8874=_0x44b679[_0xc666d4(0x1aa)];return _0x3f8874[_0xc666d4(0x17c)][_0xc666d4(0x25b)][_0xc666d4(0x16a)](_0xbb1922=>({'range':_0xbb1922,'unitId':_0x3f8874[_0xc666d4(0x1cd)],'subUnitId':_0x3f8874[_0xc666d4(0x189)]}));}default:return[];}}[_0x4df7f0(0x198)](_0x4d679a){const _0x26a744=_0x4df7f0;if(_0x4d679a[_0x26a744(0x2db)]<=0x1)return _0x4d679a;const _0x407eb3=new Map();return _0x4d679a[_0x26a744(0x29a)](_0x417b8a=>{const _0x4a97b7=_0x26a744;var _0x290200;const {unitId:_0x4f8d89,subUnitId:_0x3f56a5}=_0x417b8a,_0x559891=_0x4f8d89+'-'+_0x3f56a5;_0x407eb3[_0x4a97b7(0x2f9)](_0x559891)?(_0x290200=_0x407eb3[_0x4a97b7(0x2c7)](_0x559891))==null||_0x290200[_0x4a97b7(0x28c)](_0x417b8a):_0x407eb3['set'](_0x559891,[_0x417b8a]);}),Array[_0x26a744(0x1c5)](_0x407eb3[_0x26a744(0x21d)]())['map'](_0xe132cd=>new l[(_0x26a744(0x328))]()[_0x26a744(0x1db)](..._0xe132cd[_0x26a744(0x16a)](_0x5ea0cf=>_0x5ea0cf[_0x26a744(0x314)]))[_0x26a744(0x1c1)]()[_0x26a744(0x16a)](_0x592c92=>({'range':_0x592c92,'unitId':_0xe132cd[0x0][_0x26a744(0x1cd)],'subUnitId':_0xe132cd[0x0][_0x26a744(0x189)]})))[_0x26a744(0x2f7)]();}};$=Ze([G(0x0,_[_0x4df7f0(0x336)](exports[_0x4df7f0(0x1c4)])),G(0x1,R[_0x4df7f0(0x207)]),G(0x2,R['ISnapshotServerService'])],$);function re(_0x392f00){const _0x588a66=_0x4df7f0;return new _[(_0x588a66(0x193))](_0x392f00)['getDataRange']();}function Ke(_0x2bf775){const _0x3ea7fd=_0x4df7f0,_0xd927cd=new _[(_0x3ea7fd(0x193))](_0x2bf775),_0x5e76b7=new _[(_0x3ea7fd(0x193))]();return _0xd927cd[_0x3ea7fd(0x1df)]((_0x4249cc,_0x10b3cc)=>{const _0x2a23d3=_0x3ea7fd;_0x5e76b7[_0x2a23d3(0x350)](_0x4249cc,_0x10b3cc,0x1);}),l['findAllRectangle'](_0x5e76b7);}var Qe=Object[_0x4df7f0(0x1da)],ze=(_0x45b218,_0x3f827a,_0x4d6626,_0x564ea1)=>{const _0x4bd674=_0x4df7f0;for(var _0x2850bb=_0x564ea1>0x1?void 0x0:_0x564ea1?Qe(_0x3f827a,_0x4d6626):_0x3f827a,_0x1454d1=_0x45b218[_0x4bd674(0x2db)]-0x1,_0x4d8fbc;_0x1454d1>=0x0;_0x1454d1--)(_0x4d8fbc=_0x45b218[_0x1454d1])&&(_0x2850bb=_0x4d8fbc(_0x2850bb)||_0x2850bb);return _0x2850bb;},y=(_0x2ad535,_0x59c97f)=>(_0x89bef2,_0x57d80c)=>_0x59c97f(_0x89bef2,_0x57d80c,_0x2ad535);let z=class extends _[_0x4df7f0(0x2d5)]{constructor(_0x34c94c,_0x2b5c4e,_0x401369,_0x5c9e79,_0x3ec7f9,_0x4d8002,_0x451323){const _0x479eed=_0x4df7f0;super(),u(this,_0x479eed(0x24e),new Set()),u(this,'_lastPointer',null),(this[_0x479eed(0x365)]=_0x34c94c,this[_0x479eed(0x32b)]=_0x2b5c4e,this[_0x479eed(0x2dd)]=_0x401369,this['_univerInstanceService']=_0x5c9e79,this[_0x479eed(0x19d)]=_0x3ec7f9,this[_0x479eed(0x342)]=_0x4d8002,this[_0x479eed(0x2cf)]=_0x451323,this[_0x479eed(0x313)]());}[_0x4df7f0(0x313)](){const _0x165d48=_0x4df7f0;this[_0x165d48(0x17f)](),this[_0x165d48(0x19a)]();}[_0x4df7f0(0x17f)](){const _0x1fea46=_0x4df7f0;this[_0x1fea46(0x223)](N[_0x1fea46(0x35f)]([this['_historyManagerService'][_0x1fea46(0x21c)],this['_sheetSkeletonManagerService'][_0x1fea46(0x238)]])[_0x1fea46(0x1a7)](N['switchMap'](([_0x10a36c,_0x53d85d])=>{const _0x4d64e1=_0x1fea46;if(_0x10a36c===w[_0x4d64e1(0x353)]&&_0x53d85d){const _0x185a63=_0x53d85d[_0x4d64e1(0x1b8)];return this[_0x4d64e1(0x2dd)]['currentVersionDiff$'][_0x4d64e1(0x1a7)](N[_0x4d64e1(0x16a)](_0x2b806d=>{const _0x4ebd96=_0x4d64e1,_0x589f5d=new Map();return _0x2b806d[_0x4ebd96(0x25b)]['forEach']((_0x2fb70c,_0x251b40)=>{const _0xa8933d=_0x4ebd96,_0x409e31=_0x2fb70c[_0xa8933d(0x2ce)](_0x1ced1b=>_0x1ced1b[_0xa8933d(0x189)]===_0x185a63);_0x589f5d[_0xa8933d(0x367)](_0x251b40,_0x409e31);}),{'skeleton':_0x53d85d,'diffs':_0x589f5d};}));}return N['of']({'skeleton':null,'diffs':new Map()});}))['subscribe'](({skeleton:_0x342293,diffs:_0x529e61})=>{const _0x48f531=_0x1fea46;this['_removeDiffMarks'](),_0x342293&&this[_0x48f531(0x1e4)](_0x342293,_0x529e61);})),this[_0x1fea46(0x223)](this['_sheetSkeletonManagerService'][_0x1fea46(0x238)][_0x1fea46(0x16f)](_0x43d425=>{const _0x3e4c08=_0x1fea46;if(_0x43d425==null)return;const {skeleton:_0x7b5d9a}=_0x43d425,{scene:_0x583bb3}=this[_0x3e4c08(0x365)];_0x583bb3[_0x3e4c08(0x185)]['subscribeEvent'](_[_0x3e4c08(0x1d2)](_0x1c5530=>{const _0x100994=_0x3e4c08;var _0x246825,_0x429a8e;const {offsetX:_0x136c36,offsetY:_0x5cf72c}=_0x1c5530,{x:_0xe07009,y:_0x12cc3a}=_0x583bb3[_0x100994(0x245)](U['Vector2'][_0x100994(0x252)]([_0x136c36,_0x5cf72c])),{scaleX:_0x20a8bd,scaleY:_0x33988b}=_0x583bb3[_0x100994(0x1b5)](),_0x2e029e=_0x583bb3[_0x100994(0x17b)](U[_0x100994(0x344)][_0x100994(0x360)]),_0x3b69db=_0x583bb3[_0x100994(0x240)](U[_0x100994(0x2e8)]['FromArray']([_0xe07009,_0x12cc3a]),_0x2e029e),_0xff63e1=_0x7b5d9a[_0x100994(0x1ac)](_0x136c36,_0x5cf72c,_0x20a8bd,_0x33988b,_0x3b69db);((_0x246825=this[_0x100994(0x151)])==null?void 0x0:_0x246825[_0x100994(0x169)])===_0xff63e1[_0x100994(0x169)]&&((_0x429a8e=this[_0x100994(0x151)])==null?void 0x0:_0x429a8e[_0x100994(0x15e)])===_0xff63e1[_0x100994(0x15e)]||this[_0x100994(0x24e)][_0x100994(0x29a)](_0xad2eeb=>{const _0x585a9a=_0x100994;_0xad2eeb[_0x585a9a(0x182)](_0xff63e1);});},0x64));}));}[_0x4df7f0(0x19a)](){const _0x1fe45e=_0x4df7f0;this['disposeWithMe'](this[_0x1fe45e(0x32b)]['loadingState$'][_0x1fe45e(0x16f)](_0x3992c5=>{const _0x405a54=_0x1fe45e,_0x1b666e=new _[(_0x405a54(0x28f))]();return _0x3992c5===w[_0x405a54(0x353)]&&(_0x1b666e[_0x405a54(0x1f2)](),_0x1b666e[_0x405a54(0x1db)](this[_0x405a54(0x2dd)][_0x405a54(0x187)][_0x405a54(0x16f)](_0x373a2a=>{const _0x342a00=_0x405a54;_0x373a2a['active']&&this['_commandService'][_0x342a00(0x1d6)](l[_0x342a00(0x179)]['id'],{'unitId':this[_0x342a00(0x365)][_0x342a00(0x1cd)],'subUnitId':_0x373a2a[_0x342a00(0x335)]});}))),()=>_0x1b666e[_0x405a54(0x1f2)]();}));}[_0x4df7f0(0x1e4)](_0x272de0,_0x19642e){const _0x4faaf8=_0x4df7f0;var _0x2c2b46;const _0x2cb3dc=(_0x2c2b46=this[_0x4faaf8(0x342)]['getCurrent']())==null?void 0x0:_0x2c2b46['skeleton'];if(!_0x2cb3dc)return;this[_0x4faaf8(0x24e)]['forEach'](_0x5a3bcd=>{const _0x5762f4=_0x4faaf8;_0x5a3bcd[_0x5762f4(0x34b)]();});const {scene:_0x4cfb2e}=this[_0x4faaf8(0x365)],_0x4b8c50=Array['from'](_0x19642e['keys']())[_0x4faaf8(0x16a)](_0x3633a2=>_0x19642e['get'](_0x3633a2)[_0x4faaf8(0x16a)](_0x4ff67=>{const _0x1d2cee=_0x4faaf8;var _0x2c4c7e;const {range:_0x35d241,subUnitId:_0x1634c8,unitId:_0x476b34}=_0x4ff67,{startColumn:_0x1b4052,startRow:_0x329fd9,endColumn:_0x4e8c15,endRow:_0x365972}=_0x35d241,_0x45d8ba=C['getCoordByCell'](_0x329fd9,_0x1b4052,_0x4cfb2e,_0x2cb3dc),_0xc52f45=C[_0x1d2cee(0x25d)](_0x365972,_0x4e8c15,_0x4cfb2e,_0x2cb3dc),{columnHeaderHeightAndMarginTop:_0x540333}=_0x2cb3dc,{startX:_0x11858d,startY:_0x14df31}=_0x45d8ba,{endX:_0x54bf05,endY:_0x243881}=_0xc52f45,_0xea1024=_0x54bf05-_0x11858d,_0x4543dc=_0x243881-_0x14df31,_0x4dfbc7={'labelPosition':_0x14df31-_0x540333>=0x14?'top':_0x1d2cee(0x2a8),'sheetID':_0x1634c8,'range':_0x35d241,'color':_0x1d2cee(0x319),'fillAfterStrokeEnabled':!0x0,'backgroundColor':_0x1d2cee(0x319),'name':((_0x2c4c7e=this[_0x1d2cee(0x32b)]['getMember'](_0x3633a2))==null?void 0x0:_0x2c4c7e['name'])||'','selection':_0x476b34+'-'+_0x1634c8+'-'+_0x35d241[_0x1d2cee(0x248)]+'-'+_0x35d241['startRow']+'-'+_0x35d241['endColumn']+'-'+_0x35d241[_0x1d2cee(0x244)],'left':_0x11858d,'top':_0x14df31,'width':_0xea1024,'height':_0x4543dc,'evented':!0x1,'zIndex':0x1};return new Re[(_0x1d2cee(0x14a))]('',_0x4dfbc7);}))[_0x4faaf8(0x2f7)]();_0x4cfb2e[_0x4faaf8(0x298)](_0x4b8c50,0x1),this[_0x4faaf8(0x24e)]=new Set(_0x4b8c50);}[_0x4df7f0(0x1a5)](){const _0x398e97=_0x4df7f0;var _0x38a2ea;(_0x38a2ea=this[_0x398e97(0x24e)])==null||_0x38a2ea['forEach'](_0x565486=>_0x565486[_0x398e97(0x1f2)]());}['_getSheetObject'](){const _0x3907a1=_0x4df7f0;return C[_0x3907a1(0x2af)](this['_univerInstanceService'],this[_0x3907a1(0x19d)]);}};z=ze([y(0x1,_[_0x4df7f0(0x336)](exports[_0x4df7f0(0x1c4)])),y(0x2,_['Inject']($)),y(0x3,_[_0x4df7f0(0x152)]),y(0x4,U['IRenderManagerService']),y(0x5,_['Inject'](C['SheetSkeletonManagerService'])),y(0x6,_[_0x4df7f0(0x1c7)])],z);function Je(){const _0x1f1775=_0x4df7f0,_0x5e2b67=d[_0x1f1775(0x2dc)](exports[_0x1f1775(0x1c4)]),_0x17c7a1=d[_0x1f1775(0x354)](_0x5e2b67[_0x1f1775(0x306)]),[_0x9e57cf,_0x2a070c]=p[_0x1f1775(0x36d)](!0x1),_0x15bc90=ye(_0x17c7a1);return _0x17c7a1?h[_0x1f1775(0x36b)](_0x1f1775(0x20e),{'className':_0x1f1775(0x24b),'children':h[_0x1f1775(0x300)](_0x1f1775(0x20e),{'className':_0x1f1775(0x246),'children':[_0x15bc90[_0x1f1775(0x16a)]((_0x358908,_0x47380b)=>h[_0x1f1775(0x300)](p[_0x1f1775(0x24d)],{'children':[h[_0x1f1775(0x36b)](st,{'date':_0x358908[_0x1f1775(0x16b)]}),_0x358908['versions'][_0x1f1775(0x16a)]((_0xc6cfef,_0x28fc8c)=>h[_0x1f1775(0x36b)](it,{'index':[_0x47380b,_0x28fc8c],'item':_0xc6cfef},_0x47380b+'-'+_0x28fc8c))]},_0x358908[_0x1f1775(0x16b)])),_0x9e57cf&&h[_0x1f1775(0x36b)](et,{})]})}):h[_0x1f1775(0x36b)](tt,{});}function et(){const _0x58ebaf=_0x4df7f0;return h[_0x58ebaf(0x36b)](_0x58ebaf(0x20e),{'className':'univer-flex\x20univer-h-7\x20univer-w-full\x20univer-items-center\x20univer-justify-center','children':h['jsx'](ee,{'className':_0x58ebaf(0x237)})});}function tt(){const _0x3535c4=_0x4df7f0;return h[_0x3535c4(0x36b)](_0x3535c4(0x20e),{'className':_0x3535c4(0x278),'children':h[_0x3535c4(0x36b)]('span',{'className':_0x3535c4(0x21b),'children':h['jsx'](ee,{'className':_0x3535c4(0x204)})})});}function st(_0x918011){const _0x2e91fd=_0x4df7f0,_0x334cac=d[_0x2e91fd(0x2dc)](_[_0x2e91fd(0x206)]),{date:_0x4939d8}=_0x918011;return h['jsx']('div',{'className':_0x2e91fd(0x373),'children':Q(_0x4939d8,_0x334cac[_0x2e91fd(0x1eb)]())});}function it(_0x2d3364){const _0x46feff=_0x4df7f0,{item:_0x20d366,index:_0x5487ef}=_0x2d3364,{time:_0x265f44,user:_0x4fe6d0}=_0x20d366,[_0x3a7c52,_0x255341]=_0x5487ef,_0x13896a=d[_0x46feff(0x2dc)](exports[_0x46feff(0x1c4)]),_0x510660=d[_0x46feff(0x354)](_0x13896a[_0x46feff(0x233)],'',!0x0)===_0x20d366['id'],_0xdc4f6d=_0x3a7c52===0x0&&_0x255341===0x0,_0x38277e=!_0xdc4f6d&&_0x13896a[_0x46feff(0x1de)],_0x547eb3=d[_0x46feff(0x2dc)](_[_0x46feff(0x206)]),_0x17a94a=_0x547eb3[_0x46feff(0x1eb)](),_0x1bbc92=J(_0x265f44,_0x17a94a),_0x5e7ed6=_0x547eb3['t']('editHistory.panel.currentVersion'),_0x223c7c=p['useCallback'](_0x5c3814=>{const _0x4e9a0b=_0x46feff;_0x13896a['loadingState']!==w[_0x4e9a0b(0x2fa)]&&(_0x13896a[_0x4e9a0b(0x271)]=_0x5c3814);},[_0x13896a]),_0x1a9407=p['useCallback'](_0x2871a7=>{const _0x1341b4=_0x46feff;_0x13896a[_0x1341b4(0x20c)](_0x2871a7);},[_0x13896a]);return h[_0x46feff(0x300)](_0x46feff(0x20e),{'className':P[_0x46feff(0x32d)](_0x46feff(0x2ea),{'univer-bg-gray-50\x20dark:!univer-bg-gray-900':_0x510660}),'onClick':()=>_0x223c7c(_0x20d366['id']),'children':[h[_0x46feff(0x300)](_0x46feff(0x20e),{'className':'univer-flex\x20univer-h-6\x20univer-w-full\x20univer-justify-between','children':[h['jsxs'](_0x46feff(0x20e),{'className':_0x46feff(0x1bf),'children':[h[_0x46feff(0x36b)](_0x46feff(0x1cf),{'children':_0x1bbc92['time']}),_0xdc4f6d&&h[_0x46feff(0x36b)]('span',{'className':_0x46feff(0x19b),'children':_0x5e7ed6})]}),h[_0x46feff(0x36b)](_0x46feff(0x20e),{'children':_0x38277e&&h[_0x46feff(0x36b)](P[_0x46feff(0x1a8)],{'title':_0x547eb3['t'](_0x46feff(0x175)),'children':h[_0x46feff(0x36b)](_0x46feff(0x20e),{'onClick':_0x3a54f0=>{const _0x40437a=_0x46feff;_0x3a54f0[_0x40437a(0x34c)](),_0x1a9407(_0x20d366['id']);},'className':_0x46feff(0x2b6),'children':h[_0x46feff(0x36b)](he,{})})})})]}),h[_0x46feff(0x36b)]('div',{'className':_0x46feff(0x23f),'children':Pe(_0x20d366,_0x547eb3)})]});}var nt=Object['getOwnPropertyDescriptor'],rt=(_0x5f1e18,_0x1ca310,_0x15fff7,_0xa2dedb)=>{for(var _0x648779=_0xa2dedb>0x1?void 0x0:_0xa2dedb?nt(_0x1ca310,_0x15fff7):_0x1ca310,_0x2d5525=_0x5f1e18['length']-0x1,_0x2fc85d;_0x2d5525>=0x0;_0x2d5525--)(_0x2fc85d=_0x5f1e18[_0x2d5525])&&(_0x648779=_0x2fc85d(_0x648779)||_0x648779);return _0x648779;},x=(_0x521956,_0x4b404d)=>(_0x3524f8,_0x3f050f)=>_0x4b404d(_0x3524f8,_0x3f050f,_0x521956);const ae='history-panel';let B=class extends _['Disposable']{constructor(_0x15a433,_0x2b22b2,_0x2f1157,_0x4ec813){const _0x36676f=_0x4df7f0;super(),u(this,_0x36676f(0x24f),null),(this['_sidebarService']=_0x15a433,this[_0x36676f(0x281)]=_0x2b22b2,this[_0x36676f(0x2e7)]=_0x2f1157,this[_0x36676f(0x32b)]=_0x4ec813,this[_0x36676f(0x313)]());}[_0x4df7f0(0x313)](){const _0x45d714=_0x4df7f0;this[_0x45d714(0x16e)](),this[_0x45d714(0x241)]();}[_0x4df7f0(0x241)](){const _0x5c19af=_0x4df7f0;if(this[_0x5c19af(0x24f)])return;const _0x30e174={'header':{'title':this[_0x5c19af(0x2e7)]['t'](_0x5c19af(0x264))},'children':{'label':ae},'onClose':()=>{const _0x490764=_0x5c19af;this[_0x490764(0x24f)]=null,this[_0x490764(0x32b)][_0x490764(0x161)]=Y[_0x490764(0x33c)];}};this[_0x5c19af(0x24f)]=this[_0x5c19af(0x21e)]['open']({..._0x30e174});}[_0x4df7f0(0x16e)](){const _0x23044e=_0x4df7f0;this[_0x23044e(0x223)](this['_componentManager'][_0x23044e(0x1fb)](ae,Je)),this[_0x23044e(0x223)](this[_0x23044e(0x21e)][_0x23044e(0x2cd)][_0x23044e(0x1a7)](N['debounceTime'](0x64))[_0x23044e(0x16f)](_0x24eaba=>{const _0x4867bf=_0x23044e,{target:_0x24979a}=_0x24eaba||{};if(_0x24979a){const {scrollTop:_0x220d4b,scrollHeight:_0x5758b4,clientHeight:_0xeebe99}=_0x24979a;_0x220d4b+_0xeebe99>=_0x5758b4-0x5&&this[_0x4867bf(0x32b)][_0x4867bf(0x14b)]();}}));}};B=rt([x(0x0,d[_0x4df7f0(0x262)]),x(0x1,_[_0x4df7f0(0x336)](d['ComponentManager'])),x(0x2,_[_0x4df7f0(0x336)](_[_0x4df7f0(0x206)])),x(0x3,_[_0x4df7f0(0x336)](exports[_0x4df7f0(0x1c4)]))],B);class at extends _['Disposable']{constructor(){const _0x368129=_0x4df7f0;super(),u(this,_0x368129(0x2fc),new N[(_0x368129(0x210))]());}['open'](){const _0x573029=_0x4df7f0;return _[_0x573029(0x1ec)](()=>{});}['close'](){}[_0x4df7f0(0x15b)](_0x586428){}['getDialogs$'](){const _0x22e09e=_0x4df7f0;return this[_0x22e09e(0x2fc)][_0x22e09e(0x22b)]();}}var ot=Object[_0x4df7f0(0x2d0)],ct=Object[_0x4df7f0(0x1da)],_t=(_0x3ad0cc,_0x3411f6,_0x37a7f3)=>_0x3411f6 in _0x3ad0cc?ot(_0x3ad0cc,_0x3411f6,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x37a7f3}):_0x3ad0cc[_0x3411f6]=_0x37a7f3,lt=(_0x4dae72,_0x39389a,_0x5257e1,_0x5bf482)=>{for(var _0x1e52d7=_0x5bf482>0x1?void 0x0:_0x5bf482?ct(_0x39389a,_0x5257e1):_0x39389a,_0x41982d=_0x4dae72['length']-0x1,_0x36204b;_0x41982d>=0x0;_0x41982d--)(_0x36204b=_0x4dae72[_0x41982d])&&(_0x1e52d7=_0x36204b(_0x1e52d7)||_0x1e52d7);return _0x1e52d7;},q=(_0x465a28,_0x198405)=>(_0x41c99a,_0x1c1bed)=>_0x198405(_0x41c99a,_0x1c1bed,_0x465a28),ut=(_0xa258ce,_0x26258a,_0x52c68d)=>_t(_0xa258ce,_0x26258a+'',_0x52c68d);const ht='UNIVER_EDIT_HISTORY_VIEWER_PLUGIN';exports[_0x4df7f0(0x17e)]=class extends _[_0x4df7f0(0x1d1)]{constructor(_0xfa3122=ne,_0x3dc9df,_0x3de56d,_0x335096){const _0x51e06f=_0x4df7f0;super(),this[_0x51e06f(0x2c4)]=_0xfa3122,this[_0x51e06f(0x1f8)]=_0x3dc9df,this[_0x51e06f(0x19d)]=_0x3de56d,this[_0x51e06f(0x1dc)]=_0x335096;const {..._0x4334d1}=_['merge']({},ne,this[_0x51e06f(0x2c4)]);this[_0x51e06f(0x1dc)][_0x51e06f(0x225)](_e,_0x4334d1);}[_0x4df7f0(0x29f)](){const _0x542cc2=_0x4df7f0;[[exports['HistoryManagerService']],[j],[$],[A],[B],[k],[R[_0x542cc2(0x2f4)],{'useClass':ie['SnapshotServerOverHTTPService']}],[d[_0x542cc2(0x316)],{'useClass':at}],[pe[_0x542cc2(0x28a)],{'useClass':ie[_0x542cc2(0x35e)]}]][_0x542cc2(0x29a)](_0x47f57c=>this[_0x542cc2(0x1f8)][_0x542cc2(0x1db)](_0x47f57c)),this[_0x542cc2(0x1f8)][_0x542cc2(0x2c7)](j);}[_0x4df7f0(0x1f7)](){const _0x50d569=_0x4df7f0;[[z]][_0x50d569(0x29a)](_0x506f23=>{const _0x38668b=_0x50d569;this['disposeWithMe'](this[_0x38668b(0x19d)][_0x38668b(0x209)](_['UniverInstanceType'][_0x38668b(0x156)],_0x506f23));}),this[_0x50d569(0x1f8)][_0x50d569(0x2c7)](k),this[_0x50d569(0x1f8)][_0x50d569(0x2c7)](B);}[_0x4df7f0(0x197)](){const _0x30b569=_0x4df7f0;this['_injector'][_0x30b569(0x2c7)]($);}},ut(exports['UniverEditHistoryViewerPlugin'],_0x4df7f0(0x293),ht),exports[_0x4df7f0(0x17e)]=lt([_[_0x4df7f0(0x1af)](C['UniverSheetsUIPlugin'],oe['UniverNetworkPlugin']),q(0x1,_['Inject'](_[_0x4df7f0(0x23c)])),q(0x2,U['IRenderManagerService']),q(0x3,_[_0x4df7f0(0x158)])],exports[_0x4df7f0(0x17e)]),exports['HistoryModeStatus']=Y;