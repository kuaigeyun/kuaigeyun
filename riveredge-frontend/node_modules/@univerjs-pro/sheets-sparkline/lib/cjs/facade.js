'use strict';const _0xa7103c=_0x70f5;(function(_0x1e43b0,_0x3e22fb){const _0x4bc0d5=_0x70f5,_0x4804a1=_0x1e43b0();while(!![]){try{const _0x5ef6c4=parseInt(_0x4bc0d5(0x1f2))/0x1+parseInt(_0x4bc0d5(0x1eb))/0x2+parseInt(_0x4bc0d5(0x1db))/0x3*(-parseInt(_0x4bc0d5(0x20d))/0x4)+-parseInt(_0x4bc0d5(0x21d))/0x5+-parseInt(_0x4bc0d5(0x1ef))/0x6*(parseInt(_0x4bc0d5(0x220))/0x7)+parseInt(_0x4bc0d5(0x203))/0x8*(parseInt(_0x4bc0d5(0x21e))/0x9)+parseInt(_0x4bc0d5(0x200))/0xa*(parseInt(_0x4bc0d5(0x204))/0xb);if(_0x5ef6c4===_0x3e22fb)break;else _0x4804a1['push'](_0x4804a1['shift']());}catch(_0x435ef9){_0x4804a1['push'](_0x4804a1['shift']());}}}(_0x4645,0x9dbdd));Object[_0xa7103c(0x1e0)](exports,Symbol['toStringTag'],{'value':_0xa7103c(0x202)});const s=require('@univerjs-pro/sheets-sparkline'),c=require('@univerjs/core'),M=require('@univerjs/sheets/facade'),k=require('@univerjs/core/facade'),U=require('@univerjs/sheets');var x=Object[_0xa7103c(0x222)],R=(_0x27a796,_0x45000e,_0x4558b8,_0x5ca920)=>{const _0x17bae7=_0xa7103c;for(var _0x2ed70=_0x5ca920>0x1?void 0x0:_0x5ca920?x(_0x45000e,_0x4558b8):_0x45000e,_0x2495a3=_0x27a796[_0x17bae7(0x215)]-0x1,_0x20d88b;_0x2495a3>=0x0;_0x2495a3--)(_0x20d88b=_0x27a796[_0x2495a3])&&(_0x2ed70=_0x20d88b(_0x2ed70)||_0x2ed70);return _0x2ed70;},B=(_0x2a15e3,_0x367627)=>(_0x5d0bb2,_0xeadea8)=>_0x367627(_0x5d0bb2,_0xeadea8,_0x2a15e3);function _0x4645(){const _0xcb1bed=['FUniver','_groupId','getSubUnitSparkline','FWorksheet','startColumn','getActiveWorkbook','ICommandService','SparklineDataSourceModel','group','cancel','330830nxGQBv','params','forEach','from','14490ipNecD','unComposeSparkline','getSparklineGroupByCell','1103706DXEpIy','SetSheetSparklineCommand','addSparkline','extend','range','getSparkline','getAllSubSparkline','FEnum','_unitId','_initialize','get','map','filter','SheetSparklineChanged','1170uXmPXQ','FEventName','Module','8niPOTg','110363KrpwTM','FSparkline','getUnitId','item','Tools','changeDataSource','getSparklineByCell','getSparklineCache','_row','4111472RsVWTh','removeSparklineGroup','executeCommand','getActiveSheet','RemoveSheetSparklineCommand','deepClone','Inject','_injector','length','_workbook','onCommandExecuted','_col','AddSheetSparklineCommand','startRow','removeSparkline','groupId','2465725gKBMZN','7276275ZYppWL','composeSparkline','3143DhesMW','syncExecuteCommand','getOwnPropertyDescriptor','SheetsSelectionsService','_commandService','isChangeDataSource','getId','Event','ranges','_subUnitId','matrix','getSheetId','FSparklineGroup','3RFclkN','_worksheet','getSparklineById','Injector','SparklineTypeEnum','defineProperty'];_0x4645=function(){return _0xcb1bed;};return _0x4645();}exports[_0xa7103c(0x205)]=class{constructor(_0x40d7c7,_0x57059d,_0x5d5b93,_0x2d0c6e,_0xf88e52,_0x5cd25b){const _0x21ebb1=_0xa7103c;this['_unitId']=_0x40d7c7,this[_0x21ebb1(0x229)]=_0x57059d,this[_0x21ebb1(0x1e2)]=_0x5d5b93,this[_0x21ebb1(0x20c)]=_0x2d0c6e,this[_0x21ebb1(0x218)]=_0xf88e52,this[_0x21ebb1(0x214)]=_0x5cd25b;}[_0xa7103c(0x209)](_0x16bf4c,_0x1d96da){const _0x345a05=_0xa7103c,_0x51701c=this[_0x345a05(0x214)][_0x345a05(0x1fc)](s['SparklineDataSourceModel']),_0x160b87=this[_0x345a05(0x214)]['get'](c['ICommandService']),_0x30af3b=_0x51701c[_0x345a05(0x1dd)](this[_0x345a05(0x1fa)],this[_0x345a05(0x229)],this[_0x345a05(0x1e2)]);if(!_0x30af3b)return;const _0x340211={'config':_0x30af3b,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x345a05(0x1e2)],'resetType':_0x345a05(0x207),'sourceRanges':[_0x16bf4c],'targetRanges':[_0x1d96da],'primary':{'startRow':this['_row'],'startColumn':this['_col'],'endRow':this['_row'],'endColumn':this[_0x345a05(0x218)],'actualRow':this['_row'],'actualColumn':this[_0x345a05(0x218)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x160b87[_0x345a05(0x221)](s[_0x345a05(0x1f3)]['id'],_0x340211),this[_0x345a05(0x20c)]=_0x1d96da[_0x345a05(0x21a)],this[_0x345a05(0x218)]=_0x1d96da[_0x345a05(0x1e5)],this;}[_0xa7103c(0x21b)](){const _0x5344c4=_0xa7103c,_0x247088=this[_0x5344c4(0x214)][_0x5344c4(0x1fc)](c[_0x5344c4(0x1e7)]),_0x5ab21f={'isSingle':!0x0,'ranges':[{'startRow':this['_row'],'startColumn':this[_0x5344c4(0x218)],'endRow':this['_row'],'endColumn':this[_0x5344c4(0x218)]}]};_0x247088[_0x5344c4(0x221)](s['RemoveSheetSparklineCommand']['id'],_0x5ab21f);}},exports[_0xa7103c(0x205)]=R([B(0x5,c[_0xa7103c(0x213)](c[_0xa7103c(0x1de)]))],exports['FSparkline']);function _0x70f5(_0x2719b4,_0x57b348){_0x2719b4=_0x2719b4-0x1d9;const _0x4645bf=_0x4645();let _0x70f50a=_0x4645bf[_0x2719b4];return _0x70f50a;}var P=Object[_0xa7103c(0x222)],G=(_0x502b1d,_0x1fcb1b,_0x4b832a,_0x5bb648)=>{const _0x58cd34=_0xa7103c;for(var _0x5146f8=_0x5bb648>0x1?void 0x0:_0x5bb648?P(_0x1fcb1b,_0x4b832a):_0x1fcb1b,_0x29efbe=_0x502b1d[_0x58cd34(0x215)]-0x1,_0x294764;_0x29efbe>=0x0;_0x29efbe--)(_0x294764=_0x502b1d[_0x29efbe])&&(_0x5146f8=_0x294764(_0x5146f8)||_0x5146f8);return _0x5146f8;},O=(_0x399fc5,_0x23d3f5)=>(_0x5e383c,_0x493ee0)=>_0x23d3f5(_0x5e383c,_0x493ee0,_0x399fc5);exports[_0xa7103c(0x1da)]=class{constructor(_0x4cc17f,_0x570804,_0x1b9d32,_0x512a90,_0x3a5cd9,_0x49e38f){const _0xbed2ad=_0xa7103c;this[_0xbed2ad(0x1fa)]=_0x4cc17f,this['_subUnitId']=_0x570804,this[_0xbed2ad(0x1e2)]=_0x1b9d32,this['_row']=_0x512a90,this['_col']=_0x3a5cd9,this[_0xbed2ad(0x214)]=_0x49e38f;}[_0xa7103c(0x209)](_0x4c2635,_0xf06d4a){const _0x5f4d8a=_0xa7103c,_0x5eba52=this[_0x5f4d8a(0x214)]['get'](s['SparklineDataSourceModel']),_0x337ef6=this[_0x5f4d8a(0x214)][_0x5f4d8a(0x1fc)](c[_0x5f4d8a(0x1e7)]),_0x24ddf9=_0x5eba52['getSparklineById'](this['_unitId'],this[_0x5f4d8a(0x229)],this[_0x5f4d8a(0x1e2)]);if(!_0x24ddf9)return;const _0x430b2a={'config':_0x24ddf9,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x5f4d8a(0x1e2)],'resetType':_0x5f4d8a(0x1e9),'sourceRanges':_0x4c2635,'targetRanges':_0xf06d4a,'primary':{'startRow':this[_0x5f4d8a(0x20c)],'startColumn':this[_0x5f4d8a(0x218)],'endRow':this[_0x5f4d8a(0x20c)],'endColumn':this[_0x5f4d8a(0x218)],'actualRow':this[_0x5f4d8a(0x20c)],'actualColumn':this[_0x5f4d8a(0x218)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x337ef6[_0x5f4d8a(0x221)](s[_0x5f4d8a(0x1f3)]['id'],_0x430b2a),this[_0x5f4d8a(0x20c)]=_0xf06d4a[0x0][_0x5f4d8a(0x21a)],this[_0x5f4d8a(0x218)]=_0xf06d4a[0x0][_0x5f4d8a(0x1e5)],this;}[_0xa7103c(0x20e)](){const _0x1c98ed=_0xa7103c,_0x538ba1=this[_0x1c98ed(0x214)][_0x1c98ed(0x1fc)](c['ICommandService']),_0x19994e={'isSingle':!0x1,'ranges':[{'startRow':this[_0x1c98ed(0x20c)],'startColumn':this[_0x1c98ed(0x218)],'endRow':this[_0x1c98ed(0x20c)],'endColumn':this['_col']}]};_0x538ba1['syncExecuteCommand'](s[_0x1c98ed(0x211)]['id'],_0x19994e);}['setConfig'](_0x30ca72){const _0xa8ec72=_0xa7103c,_0x55197d=this[_0xa8ec72(0x214)][_0xa8ec72(0x1fc)](s[_0xa8ec72(0x1e8)])[_0xa8ec72(0x1dd)](this[_0xa8ec72(0x1fa)],this['_subUnitId'],this[_0xa8ec72(0x1e2)]);if(_0x55197d){const _0x1eeb79={'config':{'config':_0x30ca72,'sparklines':_0x55197d['sparklines']},'isChangeDataSource':!0x1};this[_0xa8ec72(0x214)][_0xa8ec72(0x1fc)](c[_0xa8ec72(0x1e7)])[_0xa8ec72(0x221)](s[_0xa8ec72(0x1f3)]['id'],_0x1eeb79);}return this;}},exports[_0xa7103c(0x1da)]=G([O(0x5,c['Inject'](c[_0xa7103c(0x1de)]))],exports[_0xa7103c(0x1da)]);class T extends M[_0xa7103c(0x1e4)]{[_0xa7103c(0x1f4)](_0x39b8a7,_0x59546f,_0x506650){const _0x1c1439=_0xa7103c;if(this['_commandService']['syncExecuteCommand'](s[_0x1c1439(0x219)]['id'],{'sourceRanges':_0x39b8a7,'targetRanges':_0x59546f,'targetInfo':{'unitId':this[_0x1c1439(0x216)][_0x1c1439(0x206)](),'subUnitId':this[_0x1c1439(0x1dc)]['getSheetId']()},'config':{'type':_0x506650}})){const {startRow:_0x4b2083,startColumn:_0x347343}=_0x59546f[0x0];return this[_0x1c1439(0x20a)](_0x4b2083,_0x347343);}}[_0xa7103c(0x1f8)](){const _0x424172=_0xa7103c;return this[_0x424172(0x214)][_0x424172(0x1fc)](s['SparklineDataSourceModel'])[_0x424172(0x1e3)](this[_0x424172(0x216)]['getUnitId'](),this[_0x424172(0x1dc)][_0x424172(0x1d9)]());}[_0xa7103c(0x21f)](_0x40e88e){const _0x2d4b4a=_0xa7103c,_0x297b31=this[_0x2d4b4a(0x214)][_0x2d4b4a(0x1fc)](s['SparklineDataSourceModel']);let _0xde946d;for(let _0xb4bbf5=0x0;_0xb4bbf5<_0x40e88e['length'];_0xb4bbf5++){const _0x50c141=_0x40e88e[_0xb4bbf5],{startRow:_0x382fcf,endRow:_0x3ad6cd,startColumn:_0x20fb57,endColumn:_0x54beed}=_0x50c141;for(let _0x47d926=_0x382fcf;_0x47d926<=_0x3ad6cd;_0x47d926++)for(let _0x1d47ac=_0x20fb57;_0x1d47ac<=_0x54beed;_0x1d47ac++){const _0x5d58fa=_0x297b31[_0x2d4b4a(0x1f7)](this['_workbook'][_0x2d4b4a(0x206)](),this['_worksheet'][_0x2d4b4a(0x1d9)](),_0x47d926,_0x1d47ac);if(_0x5d58fa){const _0x2be8a4=_0x297b31[_0x2d4b4a(0x1dd)](this['_workbook']['getUnitId'](),this[_0x2d4b4a(0x1dc)][_0x2d4b4a(0x1d9)](),_0x5d58fa);if(_0x2be8a4){_0xde946d=c['Tools'][_0x2d4b4a(0x212)](_0x2be8a4);break;}}}}_0xde946d&&this[_0x2d4b4a(0x224)][_0x2d4b4a(0x20f)](s[_0x2d4b4a(0x1f3)]['id'],{'ranges':_0x40e88e,'combine':!0x0,'config':_0xde946d,'isChangeDataSource':!0x1});}[_0xa7103c(0x1f0)](_0x3fdab1){const _0x4b7bdb=_0xa7103c,_0x45b27c=this[_0x4b7bdb(0x214)][_0x4b7bdb(0x1fc)](s[_0x4b7bdb(0x1e8)]);let _0x5118af;for(let _0x94f61b=0x0;_0x94f61b<_0x3fdab1[_0x4b7bdb(0x215)];_0x94f61b++){const _0x47b1b9=_0x3fdab1[_0x94f61b],{startRow:_0x2cdda5,endRow:_0x1b0a4b,startColumn:_0x5ef797,endColumn:_0x1afd23}=_0x47b1b9;for(let _0x37ab4a=_0x2cdda5;_0x37ab4a<=_0x1b0a4b;_0x37ab4a++)for(let _0x237ca6=_0x5ef797;_0x237ca6<=_0x1afd23;_0x237ca6++){const _0x5bfc1e=_0x45b27c['getSparkline'](this[_0x4b7bdb(0x216)][_0x4b7bdb(0x206)](),this[_0x4b7bdb(0x1dc)]['getSheetId'](),_0x37ab4a,_0x237ca6);if(_0x5bfc1e){const _0x274ccd=_0x45b27c[_0x4b7bdb(0x1dd)](this['_workbook'][_0x4b7bdb(0x206)](),this[_0x4b7bdb(0x1dc)][_0x4b7bdb(0x1d9)](),_0x5bfc1e);if(_0x274ccd){_0x5118af=c[_0x4b7bdb(0x208)][_0x4b7bdb(0x212)](_0x274ccd);break;}}}}_0x5118af||this[_0x4b7bdb(0x224)][_0x4b7bdb(0x20f)](s[_0x4b7bdb(0x1f3)]['id'],{'ranges':_0x3fdab1,'unCombine':!0x0,'config':_0x5118af,'isChangeDataSource':!0x1});}['getSparklineByCell'](_0x5490b2,_0x3f6fcc){const _0x3272a4=_0xa7103c,_0x190e6f=this[_0x3272a4(0x214)][_0x3272a4(0x1fc)](s[_0x3272a4(0x1e8)]),_0x56be23=this[_0x3272a4(0x216)]['getUnitId'](),_0x33d947=this[_0x3272a4(0x1dc)][_0x3272a4(0x1d9)](),_0xff8452=_0x190e6f[_0x3272a4(0x1f7)](_0x56be23,_0x33d947,_0x5490b2,_0x3f6fcc);if(_0xff8452)return this[_0x3272a4(0x214)]['createInstance'](exports['FSparkline'],_0x56be23,_0x33d947,_0xff8452,_0x5490b2,_0x3f6fcc);}[_0xa7103c(0x1f1)](_0x49936e,_0x1c4455){const _0x2d684e=_0xa7103c,_0x505f63=this[_0x2d684e(0x214)][_0x2d684e(0x1fc)](s['SparklineDataSourceModel']),_0x37ce87=this[_0x2d684e(0x216)][_0x2d684e(0x206)](),_0x24311f=this[_0x2d684e(0x1dc)]['getSheetId'](),_0x5ebab3=_0x505f63[_0x2d684e(0x1f7)](_0x37ce87,_0x24311f,_0x49936e,_0x1c4455);if(_0x5ebab3)return this[_0x2d684e(0x214)]['createInstance'](exports[_0x2d684e(0x1da)],_0x37ce87,_0x24311f,_0x5ebab3,_0x49936e,_0x1c4455);}}M[_0xa7103c(0x1e4)]['extend'](T);class A extends k[_0xa7103c(0x1f9)]{get[_0xa7103c(0x1df)](){const _0xa647cd=_0xa7103c;return s[_0xa647cd(0x1df)];}}k[_0xa7103c(0x1f9)][_0xa7103c(0x1f5)](A);class q extends k[_0xa7103c(0x201)]{get[_0xa7103c(0x1ff)](){return'SheetSparklineChanged';}}k['FEventName'][_0xa7103c(0x1f5)](q);class W extends k[_0xa7103c(0x1e1)]{[_0xa7103c(0x1fb)](_0x5f33a1){const _0x1eb824=_0xa7103c,_0x1e5d1f=_0x5f33a1['get'](c[_0x1eb824(0x1e7)]);this['registerEventHandler'](this[_0x1eb824(0x227)][_0x1eb824(0x1ff)],()=>_0x1e5d1f[_0x1eb824(0x217)](_0x1b57aa=>{const _0x5b4c3b=_0x1eb824;var _0x5259d5,_0x116243;if(_0x1b57aa['id']===s[_0x5b4c3b(0x1f3)]['id']){const _0x476a67=_0x1b57aa[_0x5b4c3b(0x1ec)];if(!_0x476a67[_0x5b4c3b(0x225)]){const _0xa76ab9=this[_0x5b4c3b(0x1e6)](),_0x34ceb7=_0xa76ab9==null?void 0x0:_0xa76ab9[_0x5b4c3b(0x210)]();if(!_0xa76ab9||!_0x34ceb7)return;const _0xd40a2d=_0xa76ab9[_0x5b4c3b(0x226)](),_0x26d0a7=_0x34ceb7[_0x5b4c3b(0x1d9)](),_0x215def=this[_0x5b4c3b(0x214)][_0x5b4c3b(0x1fc)](U[_0x5b4c3b(0x223)]),_0x4d8cd8=this[_0x5b4c3b(0x214)]['get'](s['SparklineDataSourceModel']),_0x556b98=(_0x5259d5=_0x476a67==null?void 0x0:_0x476a67[_0x5b4c3b(0x228)])!=null?_0x5259d5:_0x215def['getCurrentSelections']()[_0x5b4c3b(0x1fd)](_0x293997=>_0x293997[_0x5b4c3b(0x1f6)]),_0x92513=(_0x116243=_0x4d8cd8[_0x5b4c3b(0x20b)]()['sparklineAnchorMap'][_0x5b4c3b(0x1fc)](_0xd40a2d))==null?void 0x0:_0x116243[_0x5b4c3b(0x1fc)](_0x26d0a7),_0x1789d2=new Set();_0x556b98[_0x5b4c3b(0x1ed)](_0x137901=>{const _0x30915b=_0x5b4c3b;var _0xc5281f;const {startRow:_0x4c4174,endRow:_0x3c5e88,startColumn:_0x52bf0f,endColumn:_0x33b909}=_0x137901;for(let _0x42b446=_0x4c4174;_0x42b446<=_0x3c5e88;_0x42b446++)for(let _0x3b170e=_0x52bf0f;_0x3b170e<=_0x33b909;_0x3b170e++){const _0x556c25=(_0xc5281f=_0x92513==null?void 0x0:_0x92513[_0x30915b(0x22a)]['getValue'](_0x42b446,_0x3b170e))==null?void 0x0:_0xc5281f[_0x30915b(0x21c)];_0x556c25&&_0x1789d2['add'](_0x556c25);}});const _0x474089=Array[_0x5b4c3b(0x1ee)](_0x1789d2)['map'](_0x5d1ab3=>_0x4d8cd8[_0x5b4c3b(0x1dd)](_0xd40a2d,_0x26d0a7,_0x5d1ab3))[_0x5b4c3b(0x1fe)](_0x5f348c=>!!_0x5f348c),_0x5199d8={'workbook':_0xa76ab9,'worksheet':_0x34ceb7,'sparklines':_0x474089};if(this['fireEvent'](this['Event'][_0x5b4c3b(0x1ff)],_0x5199d8),_0x5199d8[_0x5b4c3b(0x1ea)])throw new Error('Sheet\x20create\x20canceled\x20by\x20facade\x20api.');}}}));}}k[_0xa7103c(0x1e1)][_0xa7103c(0x1f5)](W);