'use strict';const _0x333cc0=_0x9fcb;(function(_0xd79dc3,_0x28d6f2){const _0x2fcfb7=_0x9fcb,_0xc656fb=_0xd79dc3();while(!![]){try{const _0x2792ae=parseInt(_0x2fcfb7(0x23c))/0x1+parseInt(_0x2fcfb7(0x1f9))/0x2+parseInt(_0x2fcfb7(0x1fb))/0x3*(-parseInt(_0x2fcfb7(0x232))/0x4)+parseInt(_0x2fcfb7(0x26f))/0x5+-parseInt(_0x2fcfb7(0x27d))/0x6*(-parseInt(_0x2fcfb7(0x20f))/0x7)+-parseInt(_0x2fcfb7(0x256))/0x8+-parseInt(_0x2fcfb7(0x24c))/0x9*(parseInt(_0x2fcfb7(0x1e5))/0xa);if(_0x2792ae===_0x28d6f2)break;else _0xc656fb['push'](_0xc656fb['shift']());}catch(_0x2014c5){_0xc656fb['push'](_0xc656fb['shift']());}}}(_0x2e20,0x6d0e4));var xe=Object[_0x333cc0(0x2b1)],Ne=(_0x477b4c,_0x5714e7,_0xcb9d7b)=>_0x5714e7 in _0x477b4c?xe(_0x477b4c,_0x5714e7,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xcb9d7b}):_0x477b4c[_0x5714e7]=_0xcb9d7b,J=(_0xef1ee6,_0x508214,_0x5e7dd3)=>Ne(_0xef1ee6,typeof _0x508214!='symbol'?_0x508214+'':_0x508214,_0x5e7dd3);Object[_0x333cc0(0x2b1)](exports,Symbol['toStringTag'],{'value':'Module'});function _0x9fcb(_0xc1bdc4,_0x9d7f6c){_0xc1bdc4=_0xc1bdc4-0x1df;const _0x2e202d=_0x2e20();let _0x9fcb82=_0x2e202d[_0xc1bdc4];return _0x9fcb82;}const l=require('@univerjs/core'),_=require('@univerjs/sheets'),Ue=require('rxjs'),je=require('@univerjs-pro/license');function ke(_0x5c0a73,_0x2c24e2){const _0x1e8331=_0x333cc0,_0x477374=new l[(_0x1e8331(0x29b))](),_0x219567=[],_0x4a7c99=_0x5c0a73[_0x1e8331(0x26e)]>0x1;let _0x3dfdec=0x0,_0x17d8d7=0x0;for(const _0x1a6d61 of _0x5c0a73)_0x3dfdec+=_0x1a6d61[_0x1e8331(0x29a)]-_0x1a6d61[_0x1e8331(0x2b5)]+0x1,_0x17d8d7+=_0x1a6d61[_0x1e8331(0x220)]-_0x1a6d61['startColumn']+0x1;for(const _0x1167e1 of _0x2c24e2)for(let _0x3f3f03=_0x1167e1[_0x1e8331(0x2b5)];_0x3f3f03<=_0x1167e1[_0x1e8331(0x29a)];_0x3f3f03++)for(let _0x362c30=_0x1167e1[_0x1e8331(0x1fc)];_0x362c30<=_0x1167e1[_0x1e8331(0x220)];_0x362c30++)_0x219567['push']({'row':_0x3f3f03,'column':_0x362c30});if(_0x219567[_0x1e8331(0x26e)]===_0x3dfdec)_0x4a7c99?_0x219567[_0x1e8331(0x226)]((_0x41bc6f,_0xe12179)=>{const _0x31f51b=_0x1e8331,_0x1e5c1e=_0x5c0a73[_0xe12179],_0x291441={'startRow':_0x1e5c1e[_0x31f51b(0x2b5)],'startColumn':_0x1e5c1e[_0x31f51b(0x1fc)],'endRow':_0x1e5c1e[_0x31f51b(0x2b5)],'endColumn':_0x1e5c1e[_0x31f51b(0x220)]};_0x477374[_0x31f51b(0x246)](_0x41bc6f[_0x31f51b(0x2c6)],_0x41bc6f[_0x31f51b(0x276)],_0x291441);}):_0x219567['forEach']((_0x4e7f9b,_0x31ee35)=>{const _0x2b8e87=_0x1e8331,_0x529eed=_0x5c0a73[0x0],_0x3c007a={'startRow':_0x529eed[_0x2b8e87(0x2b5)]+_0x31ee35,'startColumn':_0x529eed['startColumn'],'endRow':_0x529eed[_0x2b8e87(0x2b5)]+_0x31ee35,'endColumn':_0x529eed[_0x2b8e87(0x220)]};_0x477374[_0x2b8e87(0x246)](_0x4e7f9b['row'],_0x4e7f9b[_0x2b8e87(0x276)],_0x3c007a);});else{if(_0x219567[_0x1e8331(0x26e)]===_0x17d8d7)_0x4a7c99?_0x219567[_0x1e8331(0x226)]((_0x57080c,_0x334dad)=>{const _0x4d1097=_0x1e8331,_0x1ed5d5=_0x5c0a73[_0x334dad],_0x33c10a={'startRow':_0x1ed5d5[_0x4d1097(0x2b5)],'startColumn':_0x1ed5d5[_0x4d1097(0x1fc)],'endRow':_0x1ed5d5[_0x4d1097(0x29a)],'endColumn':_0x1ed5d5[_0x4d1097(0x1fc)]};_0x477374[_0x4d1097(0x246)](_0x57080c[_0x4d1097(0x2c6)],_0x57080c[_0x4d1097(0x276)],_0x33c10a);}):_0x219567[_0x1e8331(0x226)]((_0x4deb1f,_0x19bb37)=>{const _0x3c87c2=_0x1e8331,_0x52e391=_0x5c0a73[0x0],_0x37043f={'startRow':_0x52e391[_0x3c87c2(0x2b5)],'startColumn':_0x52e391[_0x3c87c2(0x1fc)]+_0x19bb37,'endRow':_0x52e391[_0x3c87c2(0x29a)],'endColumn':_0x52e391[_0x3c87c2(0x1fc)]+_0x19bb37};_0x477374[_0x3c87c2(0x246)](_0x4deb1f[_0x3c87c2(0x2c6)],_0x4deb1f[_0x3c87c2(0x276)],_0x37043f);});else{if(_0x219567[_0x1e8331(0x26e)]===_0x5c0a73['length'])_0x5c0a73[_0x1e8331(0x270)](_0x26e900=>!(_0x26e900['startRow']!==_0x26e900['endRow']&&_0x26e900[_0x1e8331(0x1fc)]!==_0x26e900[_0x1e8331(0x220)]))&&_0x219567[_0x1e8331(0x226)]((_0xd529a7,_0x3d66b4)=>{const _0xf0abdd=_0x1e8331,_0x22892f=_0x5c0a73[_0x3d66b4];_0x477374[_0xf0abdd(0x246)](_0xd529a7[_0xf0abdd(0x2c6)],_0xd529a7['column'],_0x22892f);});else throw new Error(_0x1e8331(0x23f));}}return _0x477374;}const me='SHEET_SPARKLINE_PLUGIN',he={'standard':[_0x333cc0(0x253),_0x333cc0(0x295)],'specialty':['rgb(49,106,246)',_0x333cc0(0x292)],'distinctive':[_0x333cc0(0x236),_0x333cc0(0x2c4)],'soft':[_0x333cc0(0x1ed),_0x333cc0(0x233)],'fresh':[_0x333cc0(0x2ac),'rgb(248,190,21)']},Pe=[_0x333cc0(0x24b),'firstPoint','lastPoint','lowPoint',_0x333cc0(0x21b),_0x333cc0(0x2be)];var Ce=(_0x1c4c1c=>(_0x1c4c1c['STANDARD']='standard',_0x1c4c1c['SPECIALTY']='specialty',_0x1c4c1c['DISTINCTIVE']=_0x333cc0(0x1e3),_0x1c4c1c[_0x333cc0(0x219)]='soft',_0x1c4c1c['FRESH']=_0x333cc0(0x263),_0x1c4c1c[_0x333cc0(0x2c3)]=_0x333cc0(0x299),_0x1c4c1c))(Ce||{}),Ae=(_0x58333a=>(_0x58333a[_0x58333a[_0x333cc0(0x200)]=0x1]='LINE_CHART',_0x58333a[_0x58333a[_0x333cc0(0x240)]=0x2]=_0x333cc0(0x240),_0x58333a[_0x58333a[_0x333cc0(0x2a1)]=0x3]=_0x333cc0(0x2a1),_0x58333a[_0x58333a[_0x333cc0(0x2b9)]=0x4]=_0x333cc0(0x2b9),_0x58333a))(Ae||{}),W=(_0x51f94e=>(_0x51f94e[_0x333cc0(0x1fa)]=_0x333cc0(0x25e),_0x51f94e['ZERO_VALUE']=_0x333cc0(0x1ee),_0x51f94e['CONNECT_WITH_LINE']='connect_with_line',_0x51f94e))(W||{}),re=(_0x28db32=>(_0x28db32[_0x28db32['SELF_EXTREMUM']=0x1]=_0x333cc0(0x227),_0x28db32[_0x28db32[_0x333cc0(0x250)]=0x2]='GROUP_EXTREMUM',_0x28db32[_0x28db32[_0x333cc0(0x201)]=0x3]=_0x333cc0(0x201),_0x28db32))(re||{}),Ge=Object[_0x333cc0(0x25b)],$e=(_0x43111b,_0x4e0fd3,_0x3efea9,_0x42013a)=>{for(var _0x1f5b42=_0x42013a>0x1?void 0x0:_0x42013a?Ge(_0x4e0fd3,_0x3efea9):_0x4e0fd3,_0x22c395=_0x43111b['length']-0x1,_0x187251;_0x22c395>=0x0;_0x22c395--)(_0x187251=_0x43111b[_0x22c395])&&(_0x1f5b42=_0x187251(_0x1f5b42)||_0x1f5b42);return _0x1f5b42;},Le=(_0xaf3a81,_0x27ff2a)=>(_0x7b66fd,_0x487c91)=>_0x27ff2a(_0x7b66fd,_0x487c91,_0xaf3a81);exports['SparklineDataSourceModel']=class extends l[_0x333cc0(0x215)]{constructor(_0x209156){const _0x8e556e=_0x333cc0;super(),J(this,_0x8e556e(0x2c2),new Map()),J(this,'_sparklineAnchorMap',new Map()),J(this,'_updateConfig$',new Ue['Subject']()),J(this,'updateConfig$',this[_0x8e556e(0x273)][_0x8e556e(0x207)]()),this['_univerInstanceService']=_0x209156;}['_ensureConfigMap'](_0x20c1b5,_0x4d989d){const _0x5675c5=_0x333cc0;let _0x2f7214=this[_0x5675c5(0x2c2)][_0x5675c5(0x28d)](_0x20c1b5);_0x2f7214||(_0x2f7214=new Map(),this[_0x5675c5(0x2c2)][_0x5675c5(0x231)](_0x20c1b5,_0x2f7214));let _0x9d489e=_0x2f7214[_0x5675c5(0x28d)](_0x4d989d);return _0x9d489e||(_0x9d489e=new Map(),_0x2f7214[_0x5675c5(0x231)](_0x4d989d,_0x9d489e)),_0x9d489e;}[_0x333cc0(0x261)](_0x28c3c0,_0x471bef){const _0x4f3aba=_0x333cc0;let _0x10a38c=this[_0x4f3aba(0x2a2)][_0x4f3aba(0x28d)](_0x28c3c0);_0x10a38c||(_0x10a38c=new Map(),this[_0x4f3aba(0x2a2)][_0x4f3aba(0x231)](_0x28c3c0,_0x10a38c));let _0x7dd377=_0x10a38c[_0x4f3aba(0x28d)](_0x471bef);return _0x7dd377||(_0x7dd377={'matrix':new l[(_0x4f3aba(0x29b))](),'extra':{}},_0x10a38c[_0x4f3aba(0x231)](_0x471bef,_0x7dd377)),_0x7dd377;}[_0x333cc0(0x218)](_0x44a385,_0x5b8a0b,_0xf03c39,_0x29cbc8='set'){const _0x50b972=_0x333cc0;var _0x5b5804,_0x31814e,_0x1b9ae0,_0x56e24f,_0x189746,_0x47d5ac,_0x45b762,_0x3b1ae2,_0xd7e310,_0x42045e,_0x165ddc,_0x1ebff3,_0x58b2e9;const _0x51dfce=(_0x31814e=(_0x5b5804=this['_sparklineModel']['get'](_0x44a385))==null?void 0x0:_0x5b5804[_0x50b972(0x28d)](_0x5b8a0b))==null?void 0x0:_0x31814e['get'](_0xf03c39);if(!_0x51dfce)return;const _0x46db90=_[_0x50b972(0x2b4)](this[_0x50b972(0x214)],{'unitId':_0x44a385,'subUnitId':_0x5b8a0b});if(!_0x46db90)return;const _0x1aa30f=this['_ensureAnchorMatrix'](_0x44a385,_0x5b8a0b),{extra:_0x4da0fe,matrix:_0x16bfbb}=_0x1aa30f,{worksheet:_0x1e8d60}=_0x46db90;let _0x44f63d=Number[_0x50b972(0x267)],_0x60ec44=Number['MAX_SAFE_INTEGER'];const _0x5e31ae=(_0x1b9ae0=_0x51dfce[_0x50b972(0x24a)][_0x50b972(0x2aa)])!=null?_0x1b9ae0:!0x1;_0x51dfce[_0x50b972(0x21a)][_0x50b972(0x2c9)]((_0x37fc3f,_0x3fbeb5,_0x5736ac)=>{const _0x6b35c1=_0x50b972;var _0x535006,_0x4a3137,_0x986524;const _0x5c7fcd=_0x5736ac;let _0x5f142a=Number[_0x6b35c1(0x267)],_0x3e9469=Number[_0x6b35c1(0x2ae)],_0x1f0ada=0x0,_0x46b44e=0x0;const _0x157ad5=[];if(!l[_0x6b35c1(0x245)](_0x5c7fcd))_0x16bfbb[_0x6b35c1(0x246)](_0x37fc3f,_0x3fbeb5,{'groupId':_0xf03c39,'data':[],'max':_0x5f142a,'min':_0x3e9469,'highIndex':_0x1f0ada,'lowIndex':_0x46b44e,'negativeIndexes':_0x157ad5});else{const _0x5c9217=[];for(let _0x4db175=_0x5c7fcd[_0x6b35c1(0x2b5)];_0x4db175<=_0x5c7fcd[_0x6b35c1(0x29a)];_0x4db175++){for(let _0x5681b1=_0x5c7fcd[_0x6b35c1(0x1fc)];_0x5681b1<=_0x5c7fcd[_0x6b35c1(0x220)];_0x5681b1++){const _0x59ad9e=_0x1e8d60[_0x6b35c1(0x1f4)](_0x4db175),_0x1b033e=_0x1e8d60[_0x6b35c1(0x211)](_0x5681b1);if(!_0x5e31ae&&(!_0x59ad9e||!_0x1b033e))continue;let _0x46cde0=0x0;const _0x365283=((_0x535006=_0x1e8d60[_0x6b35c1(0x2b6)](_0x4db175,_0x5681b1))==null?void 0x0:_0x535006['v'])!==void 0x0?_0x1e8d60[_0x6b35c1(0x2b6)](_0x4db175,_0x5681b1):_0x1e8d60['getCell'](_0x4db175,_0x5681b1);if(!_0x365283||_0x365283['v']===void 0x0||_0x365283['v']===null){const _0xd32458=(_0x4a3137=_0x51dfce[_0x6b35c1(0x24a)]['emptyShowAs'])!=null?_0x4a3137:W['SPACING'];_0xd32458===W[_0x6b35c1(0x2c7)]?_0x46cde0=0x0:_0xd32458===W[_0x6b35c1(0x1fa)]?_0x46cde0=_0x6b35c1(0x2a6):_0xd32458===W[_0x6b35c1(0x23a)]&&(_0x46cde0=_0x6b35c1(0x293));}else{if(_0x365283['t']===l[_0x6b35c1(0x27c)][_0x6b35c1(0x25d)]||_0x365283['t']===l['CellValueType'][_0x6b35c1(0x244)]){const _0x3b692f=(_0x986524=_0x51dfce[_0x6b35c1(0x24a)][_0x6b35c1(0x247)])!=null?_0x986524:W[_0x6b35c1(0x1fa)];_0x3b692f===W[_0x6b35c1(0x2c7)]?_0x46cde0=0x0:_0x3b692f===W[_0x6b35c1(0x1fa)]?_0x46cde0=_0x6b35c1(0x2a6):_0x3b692f===W['CONNECT_WITH_LINE']&&(_0x46cde0='u-connect');}else _0x365283['t']===l['CellValueType'][_0x6b35c1(0x2ba)]?_0x46cde0=_0x365283['v']?0x1:0x0:_0x365283['t']===l[_0x6b35c1(0x27c)][_0x6b35c1(0x230)]?_0x46cde0=Number(_0x365283['v']):_0x46cde0=_0x365283['v'];}if(_0x5c9217[_0x6b35c1(0x24f)](_0x46cde0),typeof _0x46cde0==_0x6b35c1(0x22a)){_0x5f142a=Math[_0x6b35c1(0x1f8)](_0x5f142a,_0x46cde0),_0x44f63d=Math['max'](_0x44f63d,_0x46cde0),_0x60ec44=Math['min'](_0x60ec44,_0x46cde0),_0x3e9469=Math['min'](_0x3e9469,_0x46cde0);const _0x405e93=typeof _0x5c9217[_0x1f0ada]==_0x6b35c1(0x22a)?Number(_0x5c9217[_0x1f0ada]):Number[_0x6b35c1(0x267)];_0x46cde0>_0x405e93&&(_0x1f0ada=_0x5c9217[_0x6b35c1(0x26e)]-0x1);const _0x200b51=typeof _0x5c9217[_0x46b44e]==_0x6b35c1(0x22a)?Number(_0x5c9217[_0x46b44e]):Number['MAX_SAFE_INTEGER'];_0x46cde0<_0x200b51&&(_0x46b44e=_0x5c9217[_0x6b35c1(0x26e)]-0x1),_0x46cde0<0x0&&_0x157ad5['push'](_0x5c9217['length']-0x1);}}_0x16bfbb[_0x6b35c1(0x246)](_0x37fc3f,_0x3fbeb5,{'groupId':_0xf03c39,'data':_0x5c9217,'max':_0x5f142a,'min':_0x3e9469,'highIndex':_0x1f0ada,'lowIndex':_0x46b44e,'negativeIndexes':_0x157ad5});}}});let _0x1d5d3e=_0x44f63d;((_0x56e24f=_0x51dfce[_0x50b972(0x24a)][_0x50b972(0x22b)])==null?void 0x0:_0x56e24f[_0x50b972(0x2ce)])===re[_0x50b972(0x201)]&&(_0x1d5d3e=(_0x47d5ac=(_0x189746=_0x51dfce[_0x50b972(0x24a)][_0x50b972(0x22b)])==null?void 0x0:_0x189746[_0x50b972(0x1e6)])!=null?_0x47d5ac:_0x44f63d);let _0xfe2a52=_0x60ec44;((_0x45b762=_0x51dfce['config'][_0x50b972(0x2a3)])==null?void 0x0:_0x45b762[_0x50b972(0x2ce)])===re['CUSTOM_EXTREMUM']&&(_0xfe2a52=(_0xd7e310=(_0x3b1ae2=_0x51dfce[_0x50b972(0x24a)]['extremumMin'])==null?void 0x0:_0x3b1ae2[_0x50b972(0x1e6)])!=null?_0xd7e310:_0x60ec44);const _0x40278b=(_0x42045e=_0x51dfce['config'][_0x50b972(0x260)])!=null?_0x42045e:Ce[_0x50b972(0x2b8)],_0x448f2a=(_0x58b2e9=(_0x1ebff3=_0x51dfce['config']['seriesColor'])!=null?_0x1ebff3:(_0x165ddc=he[_0x40278b])==null?void 0x0:_0x165ddc[0x0])!=null?_0x58b2e9:he[_0x50b972(0x26c)][0x0],_0x344d56=new l[(_0x50b972(0x21e))](_0x448f2a),_0x3cafb4=_0x344d56['setAlpha'](0.2)[_0x50b972(0x212)](),_0x270993=_0x344d56[_0x50b972(0x1df)](0.05)[_0x50b972(0x212)]();_0x4da0fe[_0xf03c39]={'groupMax':_0x44f63d,'groupMin':_0x60ec44,'showMax':_0x1d5d3e,'showMin':_0xfe2a52,'startGradient':_0x3cafb4,'endGradient':_0x270993},this[_0x50b972(0x273)][_0x50b972(0x2cb)]({'unitId':_0x44a385,'subUnitId':_0x5b8a0b,'groupId':_0xf03c39,'config':_0x51dfce,'type':_0x29cbc8});}[_0x333cc0(0x238)](_0x584190,_0x2244c7,_0x2e837a,_0x451e4d){const _0x2d5af9=_0x333cc0;this[_0x2d5af9(0x2d3)](_0x584190,_0x2244c7)['set'](_0x2e837a,_0x451e4d),this[_0x2d5af9(0x218)](_0x584190,_0x2244c7,_0x2e837a,_0x2d5af9(0x210));}[_0x333cc0(0x272)](_0x548e87,_0x597838,_0x42c1ef,_0xaab644){const _0x20614c=_0x333cc0;var _0x213a91;const _0x5aa752=(_0x213a91=this[_0x20614c(0x2c2)][_0x20614c(0x28d)](_0x548e87))==null?void 0x0:_0x213a91[_0x20614c(0x28d)](_0x597838);_0x42c1ef[_0x20614c(0x226)](_0x4524b7=>{const _0x593f40=_0x20614c;_0x5aa752!=null&&_0x5aa752[_0x593f40(0x2bf)](_0x4524b7)&&(_0x5aa752['set'](_0x4524b7,_0xaab644),this[_0x593f40(0x218)](_0x548e87,_0x597838,_0x4524b7));});}[_0x333cc0(0x286)](_0x4183d2,_0x42f85e,_0x2fc554){const _0x24b0ca=_0x333cc0;var _0x358cc7,_0x11b42e;const _0x3ec163=this['_sparklineModel']['get'](_0x4183d2);if(_0x3ec163){const _0x4c632d=_0x3ec163['get'](_0x42f85e);if(_0x4c632d){_0x4c632d[_0x24b0ca(0x29c)](_0x2fc554);const _0xf2ccff=(_0x358cc7=this[_0x24b0ca(0x2a2)][_0x24b0ca(0x28d)](_0x4183d2))==null?void 0x0:_0x358cc7[_0x24b0ca(0x28d)](_0x42f85e);(_0x11b42e=_0xf2ccff==null?void 0x0:_0xf2ccff[_0x24b0ca(0x26b)])==null||_0x11b42e[_0x24b0ca(0x2c9)]((_0x171877,_0x4516c6,_0x2d5b54)=>{const _0x34c8e1=_0x24b0ca;(_0x2d5b54==null?void 0x0:_0x2d5b54[_0x34c8e1(0x1f1)])===_0x2fc554&&(_0xf2ccff==null||_0xf2ccff[_0x34c8e1(0x26b)][_0x34c8e1(0x2a4)](_0x171877,_0x4516c6));}),this[_0x24b0ca(0x273)][_0x24b0ca(0x2cb)]({'unitId':_0x4183d2,'subUnitId':_0x42f85e,'groupId':_0x2fc554,'type':_0x24b0ca(0x2c5)}),_0x4c632d[_0x24b0ca(0x216)]===0x0&&_0x3ec163[_0x24b0ca(0x29c)](_0x42f85e);}}}['removePartSparkline'](_0x3c4d10,_0xe4c0e0,_0x34015f,_0x516268){const _0x5313a9=_0x333cc0;var _0x47757e,_0x44f080,_0x4d45b3,_0x325e84;const _0x4e3cd2=(_0x47757e=this[_0x5313a9(0x2a2)]['get'](_0x3c4d10))==null?void 0x0:_0x47757e[_0x5313a9(0x28d)](_0xe4c0e0),_0x37885c=_0x4e3cd2==null?void 0x0:_0x4e3cd2[_0x5313a9(0x26b)][_0x5313a9(0x2a8)](_0x34015f,_0x516268);if(_0x37885c){const {groupId:_0x551c21}=_0x37885c,_0x455e37=(_0x44f080=this['_sparklineModel']['get'](_0x3c4d10))==null?void 0x0:_0x44f080[_0x5313a9(0x28d)](_0xe4c0e0);(_0x4d45b3=_0x455e37==null?void 0x0:_0x455e37[_0x5313a9(0x28d)](_0x551c21))==null||_0x4d45b3[_0x5313a9(0x21a)][_0x5313a9(0x2a4)](_0x34015f,_0x516268),(_0x325e84=_0x455e37==null?void 0x0:_0x455e37[_0x5313a9(0x28d)](_0x551c21))!=null&&_0x325e84[_0x5313a9(0x21a)][_0x5313a9(0x22d)]()||_0x455e37==null||_0x455e37[_0x5313a9(0x29c)](_0x551c21),_0x4e3cd2==null||_0x4e3cd2[_0x5313a9(0x26b)][_0x5313a9(0x2a4)](_0x34015f,_0x516268),this[_0x5313a9(0x273)]['next']({'unitId':_0x3c4d10,'subUnitId':_0xe4c0e0,'groupId':_0x551c21,'type':_0x5313a9(0x2c5)});}}[_0x333cc0(0x1e0)](_0x4dcb62,_0x25ba14,_0x22f7ca){const _0x3f8007=_0x333cc0;var _0xc29f02,_0x1df40f,_0x251449,_0x37dba5;const _0x1fde0a=(_0x251449=(_0x1df40f=(_0xc29f02=this[_0x3f8007(0x2c2)][_0x3f8007(0x28d)](_0x4dcb62))==null?void 0x0:_0xc29f02[_0x3f8007(0x28d)](_0x25ba14))==null?void 0x0:_0x1df40f[_0x3f8007(0x28d)](_0x22f7ca))==null?void 0x0:_0x251449['sparklines'],_0x15fb0d=(_0x37dba5=this[_0x3f8007(0x2a2)]['get'](_0x4dcb62))==null?void 0x0:_0x37dba5[_0x3f8007(0x28d)](_0x25ba14);if(_0x1fde0a&&_0x15fb0d){const {matrix:_0x24c3d1,extra:_0x8f0073}=_0x15fb0d;_0x1fde0a[_0x3f8007(0x2c9)]((_0x26e86e,_0x3edcc0,_0x356f0a)=>{const _0x50f6c2=_0x3f8007;_0x24c3d1[_0x50f6c2(0x2a4)](_0x26e86e,_0x3edcc0);}),delete _0x8f0073[_0x22f7ca];}}[_0x333cc0(0x25f)](_0x7eb9df,_0x29e567){const _0x43a23b=_0x333cc0;var _0x2d5668;return(_0x2d5668=this[_0x43a23b(0x2c2)][_0x43a23b(0x28d)](_0x7eb9df))==null?void 0x0:_0x2d5668[_0x43a23b(0x28d)](_0x29e567);}['getSparklineById'](_0x40ee2c,_0x183ace,_0x4b86fd){const _0x462ab3=_0x333cc0;var _0x5113c7,_0x2abb25;return(_0x2abb25=(_0x5113c7=this[_0x462ab3(0x2c2)]['get'](_0x40ee2c))==null?void 0x0:_0x5113c7[_0x462ab3(0x28d)](_0x183ace))==null?void 0x0:_0x2abb25[_0x462ab3(0x28d)](_0x4b86fd);}[_0x333cc0(0x1ff)](_0x4210a2,_0x7d5610,_0x19e2be,_0x51923e){const _0x56c809=_0x333cc0;var _0x3de1e4,_0x48f16e,_0x58b6d2;return(_0x58b6d2=(_0x48f16e=(_0x3de1e4=this['_sparklineAnchorMap'][_0x56c809(0x28d)](_0x4210a2))==null?void 0x0:_0x3de1e4['get'](_0x7d5610))==null?void 0x0:_0x48f16e[_0x56c809(0x26b)]['getValue'](_0x19e2be,_0x51923e))==null?void 0x0:_0x58b6d2[_0x56c809(0x1f1)];}[_0x333cc0(0x2a0)](_0x55371d,_0x16dc55){const _0x342f13=_0x333cc0;var _0x451629;const _0x5a67a5=this[_0x342f13(0x261)](_0x55371d,_0x16dc55);_0x5a67a5['matrix'][_0x342f13(0x2c9)]((_0x5c0776,_0x74d73d)=>{_0x5a67a5['matrix']['realDeleteValue'](_0x5c0776,_0x74d73d);});const _0x44aa44=(_0x451629=this[_0x342f13(0x2c2)][_0x342f13(0x28d)](_0x55371d))==null?void 0x0:_0x451629[_0x342f13(0x28d)](_0x16dc55);if(_0x44aa44){for(const [_0x5afe86]of _0x44aa44)this['updateSparklineExtraNum'](_0x55371d,_0x16dc55,_0x5afe86);}}['getSparklineCache'](){const _0x42b295=_0x333cc0;return{'sparklineModel':this[_0x42b295(0x2c2)],'sparklineAnchorMap':this[_0x42b295(0x2a2)]};}[_0x333cc0(0x237)](_0x2da9cb){const _0x546361=_0x333cc0,_0x2ae8c0={};if(this[_0x546361(0x2c2)][_0x546361(0x2bf)](_0x2da9cb)){_0x2ae8c0[_0x2da9cb]={};const _0x4c33e8=this['_sparklineModel']['get'](_0x2da9cb);_0x4c33e8!=null&&_0x4c33e8[_0x546361(0x216)]&&Array[_0x546361(0x2cc)](_0x4c33e8[_0x546361(0x25c)]())[_0x546361(0x226)](_0x3d13fc=>{const _0x988479=_0x546361;_0x2ae8c0[_0x2da9cb][_0x3d13fc]={};const _0xf27dc9=_0x4c33e8[_0x988479(0x28d)](_0x3d13fc);_0xf27dc9!=null&&_0xf27dc9[_0x988479(0x216)]&&Array['from'](_0xf27dc9[_0x988479(0x25c)]())['forEach'](_0x499981=>{const _0x555cc1=_0x988479,_0x19b832=_0xf27dc9[_0x555cc1(0x28d)](_0x499981);_0x19b832&&(_0x2ae8c0[_0x2da9cb][_0x3d13fc][_0x499981]={'config':_0x19b832['config'],'sparklines':_0x19b832['sparklines'][_0x555cc1(0x242)]()});});});}return _0x2ae8c0;}[_0x333cc0(0x2bd)](_0x4bedc2){const _0x4f9cb6=_0x333cc0;if(!_0x4bedc2)return;Object[_0x4f9cb6(0x25c)](_0x4bedc2)[_0x4f9cb6(0x226)](_0x1fa0cb=>{const _0x31a683=_0x4f9cb6,_0x14c992=_0x4bedc2[_0x1fa0cb];_0x14c992&&Object[_0x31a683(0x25c)](_0x14c992)[_0x31a683(0x226)](_0x4d1301=>{const _0x31f78a=_0x31a683,_0x3fc3e6=_0x14c992[_0x4d1301];_0x3fc3e6&&Object['keys'](_0x3fc3e6)[_0x31f78a(0x226)](_0x4c896e=>{const _0x552ac7=_0x31f78a,_0x1f84c4=_0x3fc3e6[_0x4c896e];if(_0x1f84c4){const _0x3d2ed6={'config':_0x1f84c4[_0x552ac7(0x24a)],'sparklines':new l[(_0x552ac7(0x29b))](_0x1f84c4[_0x552ac7(0x21a)])};this[_0x552ac7(0x238)](_0x1fa0cb,_0x4d1301,_0x4c896e,_0x3d2ed6);}});});});}[_0x333cc0(0x1f2)](_0x56963a){const _0x2b37dd=_0x333cc0,_0x19da04=this[_0x2b37dd(0x2c2)][_0x2b37dd(0x28d)](_0x56963a);if(_0x19da04){for(const [_0x2fa950]of _0x19da04){const _0x41aee0=_0x19da04[_0x2b37dd(0x28d)](_0x2fa950);if(_0x41aee0){for(const [_0x16187d]of _0x41aee0)this[_0x2b37dd(0x1e0)](_0x56963a,_0x2fa950,_0x16187d);}}this[_0x2b37dd(0x2c2)]['delete'](_0x56963a);}}},exports['SparklineDataSourceModel']=$e([Le(0x0,l[_0x333cc0(0x271)](l[_0x333cc0(0x1ec)]))],exports[_0x333cc0(0x21d)]);const T={'id':'sheet.mutation.add-sparkline','type':l['CommandType'][_0x333cc0(0x228)],'handler':(_0x4f2a56,_0x1cde3d)=>{const _0xcc9b75=_0x333cc0;if(!_0x1cde3d)return!0x1;const {sparklineConfigMap:_0xd18a5a,unitId:_0x300ffc,subUnitId:_0x4fa9b2}=_0x1cde3d,_0x2ef2c3=_0x4f2a56[_0xcc9b75(0x28d)](exports[_0xcc9b75(0x21d)]);return Object[_0xcc9b75(0x1fe)](_0xd18a5a)['forEach'](([_0x5c3902,_0x3fdef0])=>{const _0x2a7989=_0xcc9b75,_0x491481={'config':_0x3fdef0['config'],'sparklines':new l[(_0x2a7989(0x29b))](_0x3fdef0[_0x2a7989(0x21a)])};_0x2ef2c3['addSparkline'](_0x300ffc,_0x4fa9b2,_0x5c3902,_0x491481);}),!0x0;}},O={'id':_0x333cc0(0x29d),'type':l['CommandType'][_0x333cc0(0x228)],'handler':(_0x56c694,_0x327cf8)=>{const _0xc1eb0d=_0x333cc0;if(!_0x327cf8)return!0x1;const {unitId:_0x2cfa1d,subUnitId:_0x43ae61,ranges:_0x4fd2ca,isSingle:_0x401042,groupIds:_0x5396cb}=_0x327cf8,_0x5668ad=_0x56c694[_0xc1eb0d(0x28d)](exports[_0xc1eb0d(0x21d)]);return _0x5396cb?(_0x5396cb[_0xc1eb0d(0x226)](_0x2e3004=>{const _0x1e6ba0=_0xc1eb0d;_0x5668ad[_0x1e6ba0(0x286)](_0x2cfa1d,_0x43ae61,_0x2e3004);}),!0x0):_0x4fd2ca?(_0x4fd2ca[_0xc1eb0d(0x226)](_0x2461d2=>{const _0x7e4700=_0xc1eb0d;l['Range'][_0x7e4700(0x217)](_0x2461d2,(_0x4e762f,_0x977b63)=>{const _0x3d521f=_0x7e4700,_0x574caa=_0x5668ad[_0x3d521f(0x1ff)](_0x2cfa1d,_0x43ae61,_0x4e762f,_0x977b63);_0x574caa&&(_0x401042?_0x5668ad[_0x3d521f(0x2a7)](_0x2cfa1d,_0x43ae61,_0x4e762f,_0x977b63):_0x5668ad[_0x3d521f(0x286)](_0x2cfa1d,_0x43ae61,_0x574caa));});}),!0x0):!0x1;}},be={'id':_0x333cc0(0x298),'type':l[_0x333cc0(0x29e)]['COMMAND'],'handler':(_0x41fd49,_0x40f90c)=>{const _0x2be85d=_0x333cc0;if(!_0x40f90c)return!0x1;const {sourceRanges:_0xaa4246,targetRanges:_0x5d4573,config:_0x477a93}=_0x40f90c,_0x1ff35a=_0x41fd49[_0x2be85d(0x28d)](l[_0x2be85d(0x296)]),_0x42987b='g_'+l[_0x2be85d(0x289)](0x6),_0x4d3a13=ke(_0xaa4246,_0x5d4573),_0x28f32e={'config':_0x477a93!=null?_0x477a93:{},'sparklines':_0x4d3a13['getMatrix']()},_0x5944c5=_0x41fd49['get'](l[_0x2be85d(0x1ec)]),_0x528595=_0x41fd49['get'](exports['SparklineDataSourceModel']),_0x22cc9d=_[_0x2be85d(0x2b4)](_0x5944c5);if(!_0x22cc9d)return!0x1;const {unitId:_0x1a11cd,subUnitId:_0x516354}=_0x22cc9d,_0x797f2b=_0x41fd49['get'](l[_0x2be85d(0x209)]),_0xe1d197=[],_0x3d255c=[],_0x1df28a={},_0x29b342={},_0x2c4664=new Set([_0x42987b]);_0x4d3a13[_0x2be85d(0x2c9)]((_0x308c58,_0x2a154a,_0x200640)=>{const _0x2cab9f=_0x2be85d,_0x5703a9=_0x528595[_0x2cab9f(0x1ff)](_0x1a11cd,_0x516354,_0x308c58,_0x2a154a);if(_0x5703a9){const _0x1b7450=_0x528595[_0x2cab9f(0x206)](_0x1a11cd,_0x516354,_0x5703a9);if(_0x1b7450){_0x2c4664[_0x2cab9f(0x210)](_0x5703a9);let _0x4c427e=_0x1df28a[_0x5703a9],_0x4fa550=_0x29b342[_0x5703a9];_0x4fa550||(_0x4fa550={'config':l[_0x2cab9f(0x28f)]['deepClone'](_0x1b7450[_0x2cab9f(0x24a)]),'sparklines':new l[(_0x2cab9f(0x29b))](_0x1b7450[_0x2cab9f(0x21a)][_0x2cab9f(0x268)]())},_0x29b342[_0x5703a9]=_0x4fa550),_0x4c427e||(_0x4c427e={'config':l[_0x2cab9f(0x28f)][_0x2cab9f(0x282)](_0x1b7450[_0x2cab9f(0x24a)]),'sparklines':_0x1b7450[_0x2cab9f(0x21a)][_0x2cab9f(0x268)]()},_0x1df28a[_0x5703a9]=_0x4c427e),_0x4fa550[_0x2cab9f(0x21a)][_0x2cab9f(0x2a4)](_0x308c58,_0x2a154a);}}});const _0x34bbec={};return Object['entries'](_0x29b342)[_0x2be85d(0x226)](([_0x572232,_0x40bf7c])=>{const _0xc53508=_0x2be85d;_0x40bf7c[_0xc53508(0x21a)][_0xc53508(0x297)]()&&(_0x34bbec[_0x572232]={'config':_0x40bf7c['config'],'sparklines':_0x40bf7c[_0xc53508(0x21a)]['clone']()});}),_0x34bbec[_0x42987b]=_0x28f32e,_0xe1d197[_0x2be85d(0x24f)]({'id':O['id'],'params':{'unitId':_0x1a11cd,'subUnitId':_0x516354,'groupIds':Array[_0x2be85d(0x2cc)](_0x2c4664),'isSingle':!0x1}}),_0x2c4664['size']>0x1&&(_0x3d255c[_0x2be85d(0x24f)]({'id':O['id'],'params':{'unitId':_0x1a11cd,'subUnitId':_0x516354,'groupIds':Array[_0x2be85d(0x2cc)](_0x2c4664),'isSingle':!0x1}}),_0xe1d197[_0x2be85d(0x24f)]({'id':T['id'],'params':{'unitId':_0x1a11cd,'subUnitId':_0x516354,'sparklineConfigMap':_0x1df28a}})),_0x3d255c[_0x2be85d(0x24f)]({'id':T['id'],'params':{'unitId':_0x1a11cd,'subUnitId':_0x516354,'sparklineConfigMap':_0x34bbec}}),l['sequenceExecute'](_0x3d255c,_0x797f2b),_0x1ff35a['pushUndoRedo']({'unitID':_0x1a11cd,'undoMutations':_0xe1d197,'redoMutations':_0x3d255c}),!0x0;}},De={'id':_0x333cc0(0x278),'type':l['CommandType'][_0x333cc0(0x2d6)],'handler':(_0x1ff5d8,_0x5ed98d)=>{const _0x3531d0=_0x333cc0;var _0x5a7eb9;const {isSingle:_0x3feb44=!0x0}=_0x5ed98d||{},_0x541984=_0x1ff5d8[_0x3531d0(0x28d)](l[_0x3531d0(0x209)]),_0x4baf8b=_0x1ff5d8[_0x3531d0(0x28d)](l[_0x3531d0(0x1ec)]),_0x3c3237=_0x1ff5d8[_0x3531d0(0x28d)](exports[_0x3531d0(0x21d)]),_0x2825bd=_0x1ff5d8[_0x3531d0(0x28d)](l['IUndoRedoService']),_0x53db24=_[_0x3531d0(0x2b4)](_0x4baf8b);if(!_0x53db24)return!0x1;const _0x23a8e0=_0x1ff5d8[_0x3531d0(0x28d)](_['SheetsSelectionsService']),_0x191405=(_0x5a7eb9=_0x5ed98d==null?void 0x0:_0x5ed98d[_0x3531d0(0x28a)])!=null?_0x5a7eb9:_0x23a8e0[_0x3531d0(0x285)]()[_0x3531d0(0x1f3)](_0x533e2c=>_0x533e2c[_0x3531d0(0x2c0)]),{unitId:_0xd7fa6b,subUnitId:_0x253cd1}=_0x53db24,_0x464d62=[],_0xd694e5=[];_0x464d62[_0x3531d0(0x24f)]({'id':O['id'],'params':{'unitId':_0xd7fa6b,'subUnitId':_0x253cd1,'ranges':_0x191405,'isSingle':_0x3feb44}});const _0x1de1ff=[],_0x52a6bc={};return _0x191405['forEach'](_0x415158=>{const _0x191317=_0x3531d0;l[_0x191317(0x20e)][_0x191317(0x217)](_0x415158,(_0x3be40a,_0x17780b)=>{const _0x2b8c7e=_0x191317,_0xaec311=_0x3c3237['getSparkline'](_0xd7fa6b,_0x253cd1,_0x3be40a,_0x17780b);if(_0xaec311){const _0x57f510=_0x3c3237[_0x2b8c7e(0x206)](_0xd7fa6b,_0x253cd1,_0xaec311);_0x57f510&&(_0x1de1ff['push'](_0xaec311),_0x52a6bc[_0xaec311]={'config':l['Tools'][_0x2b8c7e(0x282)](_0x57f510['config']),'sparklines':l['Tools']['deepClone'](_0x57f510['sparklines']['clone']())});}});}),_0xd694e5[_0x3531d0(0x24f)]({'id':O['id'],'params':{'unitId':_0xd7fa6b,'subUnitId':_0x253cd1,'groupIds':_0x1de1ff,'isSingle':!0x1}}),_0xd694e5[_0x3531d0(0x24f)]({'id':T['id'],'params':{'unitId':_0xd7fa6b,'subUnitId':_0x253cd1,'sparklineConfigMap':_0x52a6bc}}),l['sequenceExecute'](_0x464d62,_0x541984),_0x2825bd['pushUndoRedo']({'unitID':_0xd7fa6b,'undoMutations':_0xd694e5,'redoMutations':_0x464d62}),!0x0;}},ue={'id':_0x333cc0(0x1e1),'type':l[_0x333cc0(0x29e)][_0x333cc0(0x228)],'handler':(_0x3acdbf,_0x459cee)=>{const _0xde82fd=_0x333cc0;if(!_0x459cee)return!0x1;const {unitId:_0x313214,subUnitId:_0x4c74d5,groupIds:_0x4a3a48,config:_0x45f998}=_0x459cee,_0x36faee=_0x3acdbf['get'](exports[_0xde82fd(0x21d)]);return _0x4a3a48['forEach'](_0x2909ed=>{const _0x5e1671=_0xde82fd,_0x38f360=_0x36faee[_0x5e1671(0x206)](_0x313214,_0x4c74d5,_0x2909ed);if(_0x38f360){const _0x9d190b={'config':Object[_0x5e1671(0x203)]({},_0x38f360[_0x5e1671(0x24a)],_0x45f998[_0x5e1671(0x24a)]),'sparklines':new l['ObjectMatrix'](_0x38f360[_0x5e1671(0x21a)]['clone']())};_0x36faee[_0x5e1671(0x272)](_0x313214,_0x4c74d5,[_0x2909ed],_0x9d190b);}}),!0x0;}},Ee={'id':_0x333cc0(0x259),'type':l[_0x333cc0(0x29e)][_0x333cc0(0x2d6)],'handler':(_0x370c19,_0x96a777)=>{const _0x2eec0a=_0x333cc0;var _0x966eb8,_0x4e7871,_0x4cd751,_0x212c67;if(!_0x96a777)return!0x1;const _0x2ea2d3=_0x370c19[_0x2eec0a(0x28d)](l[_0x2eec0a(0x209)]),_0xeba999=_0x370c19['get'](_[_0x2eec0a(0x2af)]),_0x48b14c=_0x370c19[_0x2eec0a(0x28d)](exports[_0x2eec0a(0x21d)]),_0x999278=_0x370c19[_0x2eec0a(0x28d)](l[_0x2eec0a(0x1ec)]),_0x1557b7=_0x370c19['get'](l[_0x2eec0a(0x296)]),_0x55bca4=_['getSheetCommandTarget'](_0x999278);if(!_0x55bca4)return!0x1;const {unitId:_0x5f1598,subUnitId:_0x44593e}=_0x55bca4,_0x379ebe=(_0x966eb8=_0x96a777==null?void 0x0:_0x96a777[_0x2eec0a(0x28a)])!=null?_0x966eb8:_0xeba999['getCurrentSelections']()[_0x2eec0a(0x1f3)](_0x389362=>_0x389362[_0x2eec0a(0x2c0)]),_0x20ee89=(_0x4e7871=_0x48b14c[_0x2eec0a(0x283)]()[_0x2eec0a(0x1e7)][_0x2eec0a(0x28d)](_0x5f1598))==null?void 0x0:_0x4e7871['get'](_0x44593e),{isChangeDataSource:_0x347331,config:_0x16c1ec,combine:_0xac9b1,unCombine:_0x3f2b90}=_0x96a777;if(_0xac9b1){const _0x342272=[],_0x1c81e6=[];_0x342272['push']({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'ranges':_0x379ebe,'isSingle':!0x0}});const _0x4fd8ea='g_'+l['generateRandomId'](0x6),_0x270349=new l['ObjectMatrix'](),_0x40d2bb=(_0x4cd751=_0x48b14c[_0x2eec0a(0x283)]()['sparklineModel']['get'](_0x5f1598))==null?void 0x0:_0x4cd751[_0x2eec0a(0x28d)](_0x44593e),_0x27aff8=new Set([_0x4fd8ea]),_0x1da6b5={};return _0x379ebe[_0x2eec0a(0x226)](_0x317425=>{const _0x3f4840=_0x2eec0a;var _0x1e687d,_0x4c70d2;const {startRow:_0x891516,endRow:_0x295785,startColumn:_0x10936a,endColumn:_0x11c9b8}=_0x317425;for(let _0x27acd7=_0x891516;_0x27acd7<=_0x295785;_0x27acd7++)for(let _0x3ac761=_0x10936a;_0x3ac761<=_0x11c9b8;_0x3ac761++){const _0x1c931d=(_0x1e687d=_0x20ee89==null?void 0x0:_0x20ee89['matrix'][_0x3f4840(0x2a8)](_0x27acd7,_0x3ac761))==null?void 0x0:_0x1e687d[_0x3f4840(0x1f1)];if(_0x1c931d){_0x27aff8[_0x3f4840(0x210)](_0x1c931d);const _0x5175dc=_0x48b14c[_0x3f4840(0x206)](_0x5f1598,_0x44593e,_0x1c931d);_0x5175dc&&(_0x1da6b5[_0x1c931d]={'config':l[_0x3f4840(0x28f)][_0x3f4840(0x282)](_0x5175dc[_0x3f4840(0x24a)]),'sparklines':l['Tools']['deepClone'](_0x5175dc[_0x3f4840(0x21a)][_0x3f4840(0x268)]())});const _0xe510e9=(_0x4c70d2=_0x40d2bb==null?void 0x0:_0x40d2bb['get'](_0x1c931d))==null?void 0x0:_0x4c70d2['sparklines'][_0x3f4840(0x2a8)](_0x27acd7,_0x3ac761);_0xe510e9&&_0x270349['setValue'](_0x27acd7,_0x3ac761,_0xe510e9);}}}),_0x342272['push']({'id':T['id'],'params':{'sparklineConfigMap':{[_0x4fd8ea]:{'config':l[_0x2eec0a(0x28f)][_0x2eec0a(0x282)](_0x16c1ec[_0x2eec0a(0x24a)]),'sparklines':_0x270349[_0x2eec0a(0x242)]()}},'unitId':_0x5f1598,'subUnitId':_0x44593e}}),_0x1c81e6['push']({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'isSingle':!0x1,'groupIds':Array[_0x2eec0a(0x2cc)](_0x27aff8)}}),_0x1c81e6[_0x2eec0a(0x24f)]({'id':T['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'sparklineConfigMap':_0x1da6b5}}),l[_0x2eec0a(0x22e)](_0x342272,_0x2ea2d3),_0x1557b7['pushUndoRedo']({'unitID':_0x5f1598,'undoMutations':_0x1c81e6,'redoMutations':_0x342272}),!0x0;}else{if(_0x3f2b90){const _0x42bb3b=[],_0x323e75=[];_0x42bb3b['push']({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'ranges':_0x379ebe,'isSingle':!0x0}});const _0x14444f=(_0x212c67=_0x48b14c[_0x2eec0a(0x283)]()[_0x2eec0a(0x248)][_0x2eec0a(0x28d)](_0x5f1598))==null?void 0x0:_0x212c67[_0x2eec0a(0x28d)](_0x44593e),_0x2789c6={},_0x1ee60b=new Set(),_0x4c3802={};return _0x379ebe[_0x2eec0a(0x226)](_0x161576=>{const _0x429794=_0x2eec0a;var _0x110edf,_0x5d9b27;const {startRow:_0x290089,endRow:_0x31674d,startColumn:_0x851240,endColumn:_0x1f7296}=_0x161576;for(let _0x4c30fc=_0x290089;_0x4c30fc<=_0x31674d;_0x4c30fc++)for(let _0x3e26c7=_0x851240;_0x3e26c7<=_0x1f7296;_0x3e26c7++){const _0x4e5e6f=(_0x110edf=_0x20ee89==null?void 0x0:_0x20ee89[_0x429794(0x26b)]['getValue'](_0x4c30fc,_0x3e26c7))==null?void 0x0:_0x110edf[_0x429794(0x1f1)];if(_0x4e5e6f){const _0x2a24ce=new l['ObjectMatrix'](),_0x59f010='g_'+l[_0x429794(0x289)](0x6);_0x1ee60b['add'](_0x4e5e6f),_0x1ee60b['add'](_0x59f010);const _0x1f079a=_0x48b14c[_0x429794(0x206)](_0x5f1598,_0x44593e,_0x4e5e6f);_0x1f079a&&(_0x4c3802[_0x4e5e6f]={'config':l['Tools'][_0x429794(0x282)](_0x1f079a['config']),'sparklines':l[_0x429794(0x28f)]['deepClone'](_0x1f079a['sparklines'][_0x429794(0x268)]())});const _0x108e95=(_0x5d9b27=_0x14444f==null?void 0x0:_0x14444f[_0x429794(0x28d)](_0x4e5e6f))==null?void 0x0:_0x5d9b27['sparklines'][_0x429794(0x2a8)](_0x4c30fc,_0x3e26c7);_0x108e95&&_0x2a24ce[_0x429794(0x246)](_0x4c30fc,_0x3e26c7,_0x108e95),_0x2789c6[_0x59f010]={'sparklines':_0x2a24ce['getMatrix'](),'config':l[_0x429794(0x28f)][_0x429794(0x282)](_0x16c1ec[_0x429794(0x24a)])};}}}),_0x42bb3b[_0x2eec0a(0x24f)]({'id':T['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'sparklineConfigMap':_0x2789c6}}),_0x323e75[_0x2eec0a(0x24f)]({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'isSingle':!0x1,'groupIds':Array['from'](_0x1ee60b)}}),_0x323e75[_0x2eec0a(0x24f)]({'id':T['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'sparklineConfigMap':_0x4c3802}}),l[_0x2eec0a(0x22e)](_0x42bb3b,_0x2ea2d3),_0x1557b7[_0x2eec0a(0x20c)]({'unitID':_0x5f1598,'undoMutations':_0x323e75,'redoMutations':_0x42bb3b}),!0x0;}}if(_0x347331){const _0x8c2257=_0x96a777['changeDataSourceInfo'];if(!_0x8c2257)return!0x1;const {groupId:_0x5b23a3,sourceRanges:_0x17091a,targetRanges:_0x10829f,resetType:_0x21f4d7,primary:_0x4f1e0b}=_0x8c2257,_0x1a8ea8=[],_0x53a8c8=[];_0x1a8ea8['push']({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'ranges':_0x379ebe,'isSingle':!0x1,'groupIds':[_0x5b23a3]}}),_0x53a8c8['push']({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'ranges':_0x379ebe,'isSingle':!0x1,'groupIds':[_0x5b23a3]}});let _0x34e2e0;_0x21f4d7==='item'?(_0x34e2e0=new l['ObjectMatrix'](_0x16c1ec[_0x2eec0a(0x21a)][_0x2eec0a(0x268)]()),_0x34e2e0[_0x2eec0a(0x2a4)](_0x4f1e0b['actualRow'],_0x4f1e0b[_0x2eec0a(0x1e8)]),_0x34e2e0[_0x2eec0a(0x246)](_0x10829f[0x0][_0x2eec0a(0x2b5)],_0x10829f[0x0]['startColumn'],_0x17091a[0x0])):_0x34e2e0=ke(_0x17091a,_0x10829f);const _0xac0cc4={'config':l[_0x2eec0a(0x28f)][_0x2eec0a(0x282)](_0x16c1ec['config']),'sparklines':_0x34e2e0[_0x2eec0a(0x242)]()},_0x2de86b={'config':l[_0x2eec0a(0x28f)][_0x2eec0a(0x282)](_0x16c1ec[_0x2eec0a(0x24a)]),'sparklines':l[_0x2eec0a(0x28f)]['deepClone'](_0x16c1ec[_0x2eec0a(0x21a)][_0x2eec0a(0x268)]())};_0x1a8ea8[_0x2eec0a(0x24f)]({'id':T['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'sparklineConfigMap':{[_0x5b23a3]:_0xac0cc4}}}),_0x53a8c8[_0x2eec0a(0x24f)]({'id':T['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'sparklineConfigMap':{[_0x5b23a3]:_0x2de86b}}}),l[_0x2eec0a(0x22e)](_0x1a8ea8,_0x2ea2d3),_0x1557b7['pushUndoRedo']({'unitID':_0x5f1598,'undoMutations':_0x53a8c8,'redoMutations':_0x1a8ea8});}else{const _0x2f9987=[],_0x20e787=[],_0x189104=new Set(),_0x3bb8b4={};_0x379ebe[_0x2eec0a(0x226)](_0x2833af=>{const _0x50b607=_0x2eec0a;var _0x4995be;const {startRow:_0x4d5448,endRow:_0x57ebf,startColumn:_0x1aed4c,endColumn:_0x31a251}=_0x2833af;for(let _0x4c2a4b=_0x4d5448;_0x4c2a4b<=_0x57ebf;_0x4c2a4b++)for(let _0x550ba3=_0x1aed4c;_0x550ba3<=_0x31a251;_0x550ba3++){const _0x3c3353=(_0x4995be=_0x20ee89==null?void 0x0:_0x20ee89[_0x50b607(0x26b)][_0x50b607(0x2a8)](_0x4c2a4b,_0x550ba3))==null?void 0x0:_0x4995be['groupId'];if(_0x3c3353){_0x189104[_0x50b607(0x210)](_0x3c3353);const _0x182b30=_0x48b14c[_0x50b607(0x206)](_0x5f1598,_0x44593e,_0x3c3353);_0x182b30&&(_0x3bb8b4[_0x3c3353]={'config':l[_0x50b607(0x28f)][_0x50b607(0x282)](_0x182b30['config']),'sparklines':l[_0x50b607(0x28f)][_0x50b607(0x282)](_0x182b30[_0x50b607(0x21a)][_0x50b607(0x268)]())});}}}),_0x20e787[_0x2eec0a(0x24f)]({'id':ue['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'groupIds':Array['from'](_0x189104),'config':{'config':l[_0x2eec0a(0x28f)][_0x2eec0a(0x282)](_0x16c1ec['config']),'sparklines':_0x16c1ec['sparklines'][_0x2eec0a(0x242)]()}}}),_0x2f9987[_0x2eec0a(0x24f)]({'id':O['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'isSingle':!0x1,'groupIds':Array['from'](_0x189104)}}),_0x2f9987['push']({'id':T['id'],'params':{'unitId':_0x5f1598,'subUnitId':_0x44593e,'sparklineConfigMap':_0x3bb8b4}}),l[_0x2eec0a(0x22e)](_0x20e787,_0x2ea2d3),_0x1557b7[_0x2eec0a(0x20c)]({'unitID':_0x5f1598,'undoMutations':_0x2f9987,'redoMutations':_0x20e787});}return!0x0;}};var He=Object['getOwnPropertyDescriptor'],Be=(_0x2511bb,_0x227354,_0x570a36,_0xd55ed2)=>{for(var _0x514332=_0xd55ed2>0x1?void 0x0:_0xd55ed2?He(_0x227354,_0x570a36):_0x227354,_0x2f3192=_0x2511bb['length']-0x1,_0x53bdda;_0x2f3192>=0x0;_0x2f3192--)(_0x53bdda=_0x2511bb[_0x2f3192])&&(_0x514332=_0x53bdda(_0x514332)||_0x514332);return _0x514332;},te=(_0x5e6b79,_0x2c467d)=>(_0x5cceb0,_0x2dae88)=>_0x2c467d(_0x5cceb0,_0x2dae88,_0x5e6b79);let se=class extends l['Disposable']{constructor(_0x2d1a7e,_0x5289b4,_0x12275b,_0x1c1c26){const _0x42b1a5=_0x333cc0;super(),this[_0x42b1a5(0x2cd)]=_0x2d1a7e,this[_0x42b1a5(0x27b)]=_0x5289b4,this[_0x42b1a5(0x214)]=_0x12275b,this[_0x42b1a5(0x235)]=_0x1c1c26,this[_0x42b1a5(0x262)]();}[_0x333cc0(0x262)](){const _0x200475=_0x333cc0;this[_0x200475(0x243)](this[_0x200475(0x27b)][_0x200475(0x269)]({'getMutations':_0x688d9=>{const _0x275d7b=_0x200475,_0x1dd7fa=[],_0x4ef98c=[];if(_0x688d9['id']===_[_0x275d7b(0x22c)]['id']){const _0xdc57ef=_[_0x275d7b(0x2b4)](this[_0x275d7b(0x214)]);if(!_0xdc57ef)return{'redos':_0x1dd7fa,'undos':_0x4ef98c};const {unitId:_0x28dd15,subUnitId:_0x3e2607,worksheet:_0x37fed2}=_0xdc57ef,_0x53b491=this[_0x275d7b(0x235)][_0x275d7b(0x285)]()[_0x275d7b(0x1f3)](_0x54a005=>_0x54a005[_0x275d7b(0x2c0)]),_0x817a19=new Set(),_0x34f71b={},_0xa7df6={};_0x53b491[_0x275d7b(0x226)](_0x1d724e=>{l['Range']['foreach'](_0x1d724e,(_0x55174b,_0xe7ee00)=>{const _0x40f9e8=_0x9fcb,_0x5e8b1e=this[_0x40f9e8(0x2cd)][_0x40f9e8(0x1ff)](_0x28dd15,_0x3e2607,_0x55174b,_0xe7ee00);if(_0x5e8b1e&&!_0x817a19[_0x40f9e8(0x2bf)](_0x5e8b1e)){const _0x27e7c0=this[_0x40f9e8(0x2cd)]['getSparklineById'](_0x28dd15,_0x3e2607,_0x5e8b1e);_0x27e7c0&&(_0x817a19[_0x40f9e8(0x210)](_0x5e8b1e),_0x34f71b[_0x5e8b1e]={'config':l[_0x40f9e8(0x28f)][_0x40f9e8(0x282)](_0x27e7c0[_0x40f9e8(0x24a)]),'sparklines':l[_0x40f9e8(0x28f)][_0x40f9e8(0x282)](_0x27e7c0[_0x40f9e8(0x21a)][_0x40f9e8(0x268)]())},_0xa7df6[_0x5e8b1e]={'config':l[_0x40f9e8(0x28f)][_0x40f9e8(0x282)](_0x27e7c0[_0x40f9e8(0x24a)]),'sparklines':l[_0x40f9e8(0x28f)][_0x40f9e8(0x282)](_0x27e7c0[_0x40f9e8(0x21a)][_0x40f9e8(0x268)]())});}});}),Object[_0x275d7b(0x23d)](_0xa7df6)[_0x275d7b(0x226)](_0xb3aa98=>{const _0x325439=_0x275d7b,_0x57b895=_0xb3aa98[_0x325439(0x21a)];new l[(_0x325439(0x29b))](_0x57b895)['forValue']((_0x2d3a36,_0x13ff9c,_0x5c7fd6)=>{const _0x2295e3=_0x325439;_0x53b491['some'](_0x4df18b=>l[_0x2295e3(0x2b2)][_0x2295e3(0x1e9)](_0x4df18b,l[_0x2295e3(0x2d4)](_0x2d3a36,_0x13ff9c)))&&delete _0x57b895[_0x2d3a36][_0x13ff9c];});}),_0x1dd7fa[_0x275d7b(0x24f)]({'id':O['id'],'params':{'unitId':_0x28dd15,'subUnitId':_0x3e2607,'groupIds':Array['from'](_0x817a19),'isSingle':!0x1}}),_0x1dd7fa[_0x275d7b(0x24f)]({'id':T['id'],'params':{'unitId':_0x28dd15,'subUnitId':_0x3e2607,'sparklineConfigMap':_0xa7df6}}),_0x4ef98c[_0x275d7b(0x24f)]({'id':O['id'],'params':{'unitId':_0x28dd15,'subUnitId':_0x3e2607,'groupIds':Array[_0x275d7b(0x2cc)](_0x817a19),'isSingle':!0x1}}),_0x4ef98c['push']({'id':T['id'],'params':{'unitId':_0x28dd15,'subUnitId':_0x3e2607,'sparklineConfigMap':_0x34f71b}});}return{'redos':_0x1dd7fa,'undos':_0x4ef98c};}}));}};se=Be([te(0x0,l[_0x333cc0(0x271)](exports[_0x333cc0(0x21d)])),te(0x1,l[_0x333cc0(0x271)](_[_0x333cc0(0x27f)])),te(0x2,l[_0x333cc0(0x271)](l[_0x333cc0(0x1ec)])),te(0x3,l[_0x333cc0(0x271)](_[_0x333cc0(0x2af)]))],se);var We=Object['getOwnPropertyDescriptor'],Fe=(_0x14fc36,_0x11fcdf,_0x2d9749,_0x1ab785)=>{const _0x3e54d3=_0x333cc0;for(var _0x46cdd9=_0x1ab785>0x1?void 0x0:_0x1ab785?We(_0x11fcdf,_0x2d9749):_0x11fcdf,_0x2a1962=_0x14fc36[_0x3e54d3(0x26e)]-0x1,_0x3aeefa;_0x2a1962>=0x0;_0x2a1962--)(_0x3aeefa=_0x14fc36[_0x2a1962])&&(_0x46cdd9=_0x3aeefa(_0x46cdd9)||_0x46cdd9);return _0x46cdd9;},ge=(_0x216331,_0x5a75e8)=>(_0x25add4,_0x22e6a3)=>_0x5a75e8(_0x25add4,_0x22e6a3,_0x216331);let oe=class extends l[_0x333cc0(0x215)]{constructor(_0xfd9cc1,_0x2ad3e1,_0x31e3f0){const _0x585fb8=_0x333cc0;super(),this[_0x585fb8(0x1eb)]=_0xfd9cc1,this[_0x585fb8(0x2cd)]=_0x2ad3e1,this['_exclusiveRangeService']=_0x31e3f0,this[_0x585fb8(0x2cf)](),this[_0x585fb8(0x21c)]();}[_0x333cc0(0x2cf)](){const _0x55f9a2=_0x333cc0;this[_0x55f9a2(0x243)](this[_0x55f9a2(0x1eb)][_0x55f9a2(0x277)](_0x3960ff=>{const _0x5e342a=_0x55f9a2;if(_0x3960ff['id']===_[_0x5e342a(0x251)]['id']){const _0x46a10d=_0x3960ff[_0x5e342a(0x28b)],{cellValue:_0x23758d,unitId:_0x3bf194,subUnitId:_0x184063}=_0x46a10d,_0x4afb85=new l[(_0x5e342a(0x29b))](_0x23758d),_0x337843=new Set(),_0x145626=this[_0x5e342a(0x2cd)][_0x5e342a(0x25f)](_0x3bf194,_0x184063);if(!_0x145626)return;const _0x1ac088=Array[_0x5e342a(0x2cc)](_0x145626);_0x4afb85[_0x5e342a(0x2c9)]((_0xd89b29,_0x29f963,_0x4b9136)=>{const _0x146ac5=_0x5e342a,_0x42365d=l[_0x146ac5(0x2d4)](_0xd89b29,_0x29f963);for(let _0x1f1d4f=0x0;_0x1f1d4f<_0x1ac088[_0x146ac5(0x26e)];_0x1f1d4f++){const [_0x395142,_0x3d64df]=_0x1ac088[_0x1f1d4f],_0x3ba260=_0x337843[_0x146ac5(0x2bf)](_0x395142);_0x3ba260||_0x3d64df[_0x146ac5(0x21a)][_0x146ac5(0x2c9)]((_0x196b54,_0x16cd5a,_0x262e89)=>{const _0x7debfd=_0x146ac5,_0x5b90bb=_0x262e89;if(_0x5b90bb&&!_0x3ba260&&l[_0x7debfd(0x2b2)]['intersects'](_0x42365d,_0x5b90bb))return _0x337843[_0x7debfd(0x210)](_0x395142),!0x0;});}}),_0x337843[_0x5e342a(0x226)](_0x16ca31=>{const _0x3e96ce=_0x5e342a;this[_0x3e96ce(0x2cd)][_0x3e96ce(0x1e0)](_0x3bf194,_0x184063,_0x16ca31),this[_0x3e96ce(0x2cd)][_0x3e96ce(0x218)](_0x3bf194,_0x184063,_0x16ca31);});}else{if(_0x3960ff['id']===_[_0x5e342a(0x20b)]['id']){const _0x32e0cc=_0x3960ff[_0x5e342a(0x28b)],{range:_0x7f2f7b,unitId:_0x29415b,subUnitId:_0x5a15ea}=_0x32e0cc,_0x47261c=new Set(),_0x2e5468=this[_0x5e342a(0x2cd)][_0x5e342a(0x25f)](_0x29415b,_0x5a15ea);if(!_0x2e5468)return;const _0x1a734b=Array[_0x5e342a(0x2cc)](_0x2e5468);for(let _0x4f918a=0x0;_0x4f918a<_0x1a734b['length'];_0x4f918a++){const [_0x2af863,_0x4c86eb]=_0x1a734b[_0x4f918a],_0xba5be7=_0x47261c[_0x5e342a(0x2bf)](_0x2af863);_0xba5be7||_0x4c86eb[_0x5e342a(0x21a)]['forValue']((_0x5f4323,_0x72b584,_0x4534ac)=>{const _0x43ef6d=_0x5e342a,_0x1174ce=_0x4534ac;if(_0x1174ce&&!_0xba5be7&&l[_0x43ef6d(0x2b2)][_0x43ef6d(0x1e9)](_0x7f2f7b,_0x1174ce))return _0x47261c[_0x43ef6d(0x210)](_0x2af863),!0x0;});}_0x47261c[_0x5e342a(0x226)](_0x3a13e7=>{const _0x459f58=_0x5e342a;this[_0x459f58(0x2cd)][_0x459f58(0x1e0)](_0x29415b,_0x5a15ea,_0x3a13e7),this[_0x459f58(0x2cd)][_0x459f58(0x218)](_0x29415b,_0x5a15ea,_0x3a13e7);});}}}));}[_0x333cc0(0x21c)](){const _0x458e70=_0x333cc0;this['disposeWithMe'](this[_0x458e70(0x239)][_0x458e70(0x222)][_0x458e70(0x2bc)](_0xd938b8=>{const _0x44dce4=_0x458e70,{unitId:_0x49168e,subUnitId:_0x3d88e2,ranges:_0x37038c}=_0xd938b8,_0x1a8e5e=this[_0x44dce4(0x2cd)][_0x44dce4(0x25f)](_0x49168e,_0x3d88e2);if(!_0x1a8e5e)return;const _0x10a127=Array[_0x44dce4(0x2cc)](_0x1a8e5e),_0x3c0b18=new Set();for(let _0x4118fc=0x0;_0x4118fc<_0x10a127[_0x44dce4(0x26e)];_0x4118fc++){const [_0x4f254d,_0x9af2db]=_0x10a127[_0x4118fc],_0x1436e8=_0x3c0b18[_0x44dce4(0x2bf)](_0x4f254d);_0x1436e8||_0x9af2db[_0x44dce4(0x21a)]['forValue']((_0xae78fe,_0x554286,_0x12bad6)=>{const _0x5d28c5=_0x44dce4,_0x5b45ad=_0x12bad6;if(_0x5b45ad&&!_0x1436e8){for(const _0x58d4be of _0x37038c)if(l[_0x5d28c5(0x2b2)][_0x5d28c5(0x1e9)](_0x58d4be,_0x5b45ad)){_0x3c0b18[_0x5d28c5(0x210)](_0x4f254d);break;}}});}_0x3c0b18[_0x44dce4(0x226)](_0x111f9a=>{const _0x21763b=_0x44dce4;this[_0x21763b(0x2cd)][_0x21763b(0x1e0)](_0x49168e,_0x3d88e2,_0x111f9a),this[_0x21763b(0x2cd)][_0x21763b(0x218)](_0x49168e,_0x3d88e2,_0x111f9a);});}));}};oe=Fe([ge(0x0,l[_0x333cc0(0x271)](l[_0x333cc0(0x209)])),ge(0x1,l[_0x333cc0(0x271)](exports[_0x333cc0(0x21d)])),ge(0x2,l[_0x333cc0(0x271)](_['IExclusiveRangeService']))],oe);var Ke=Object[_0x333cc0(0x25b)],ze=(_0x5a1005,_0x7a57ef,_0x3f4f8d,_0x3155b3)=>{const _0x32ca5e=_0x333cc0;for(var _0x40623e=_0x3155b3>0x1?void 0x0:_0x3155b3?Ke(_0x7a57ef,_0x3f4f8d):_0x7a57ef,_0xba8a6d=_0x5a1005[_0x32ca5e(0x26e)]-0x1,_0xc2a862;_0xba8a6d>=0x0;_0xba8a6d--)(_0xc2a862=_0x5a1005[_0xba8a6d])&&(_0x40623e=_0xc2a862(_0x40623e)||_0x40623e);return _0x40623e;},ve=(_0x33b7ab,_0x2709f4)=>(_0x4ebce9,_0x3f3fd4)=>_0x2709f4(_0x4ebce9,_0x3f3fd4,_0x33b7ab);let ae=class extends l[_0x333cc0(0x215)]{constructor(_0x371773,_0x45b264){const _0x3880eb=_0x333cc0;super(),this[_0x3880eb(0x1eb)]=_0x371773,this[_0x3880eb(0x2cd)]=_0x45b264,this[_0x3880eb(0x1f6)]();}['_initHideRowColWithSparkline'](){const _0xd171fb=_0x333cc0;this[_0xd171fb(0x1eb)][_0xd171fb(0x277)](_0x5ca648=>{const _0x525f0e=_0xd171fb;if(_0x5ca648['id']===_[_0x525f0e(0x29f)]['id']||_0x5ca648['id']===_[_0x525f0e(0x2d0)]['id']||_0x5ca648['id']===_['SetRowVisibleMutation']['id']||_0x5ca648['id']===_[_0x525f0e(0x275)]['id']){const _0x18819d=_0x5ca648['params'],{ranges:_0x320cf2,unitId:_0xdb68f3,subUnitId:_0x3ca63f}=_0x18819d,_0x2f7de5=new Set(),_0x258b69=this[_0x525f0e(0x2cd)][_0x525f0e(0x25f)](_0xdb68f3,_0x3ca63f);if(!_0x258b69)return;const _0x2da415=Array[_0x525f0e(0x2cc)](_0x258b69);_0x320cf2[_0x525f0e(0x226)](_0x45c83b=>{const _0x4bd6d9=_0x525f0e;l['Range'][_0x4bd6d9(0x217)](_0x45c83b,(_0x2caa4c,_0x209647)=>{const _0x5a6bcd=_0x4bd6d9,_0x3e17e2=l[_0x5a6bcd(0x2d4)](_0x2caa4c,_0x209647);for(let _0xcb4b30=0x0;_0xcb4b30<_0x2da415[_0x5a6bcd(0x26e)];_0xcb4b30++){const [_0x31f586,_0x4abe27]=_0x2da415[_0xcb4b30],_0x591394=_0x2f7de5[_0x5a6bcd(0x2bf)](_0x31f586);_0x591394||_0x4abe27[_0x5a6bcd(0x21a)][_0x5a6bcd(0x2c9)]((_0x5a3f15,_0x326253,_0x8ad7eb)=>{const _0x4735ef=_0x5a6bcd,_0x58f17a=_0x8ad7eb;if(_0x58f17a&&!_0x591394&&l[_0x4735ef(0x2b2)]['intersects'](_0x3e17e2,_0x58f17a))return _0x2f7de5[_0x4735ef(0x210)](_0x31f586),!0x0;});}});}),_0x2f7de5[_0x525f0e(0x226)](_0x457cb6=>{const _0x4de5c4=_0x525f0e;this[_0x4de5c4(0x2cd)][_0x4de5c4(0x1e0)](_0xdb68f3,_0x3ca63f,_0x457cb6),this[_0x4de5c4(0x2cd)][_0x4de5c4(0x218)](_0xdb68f3,_0x3ca63f,_0x457cb6);});}});}};ae=ze([ve(0x0,l['Inject'](l[_0x333cc0(0x209)])),ve(0x1,l[_0x333cc0(0x271)](exports[_0x333cc0(0x21d)]))],ae);var Xe=Object[_0x333cc0(0x25b)],qe=(_0x3a6d67,_0x4bc68e,_0x4edf59,_0x4b332a)=>{const _0x260979=_0x333cc0;for(var _0x5370bd=_0x4b332a>0x1?void 0x0:_0x4b332a?Xe(_0x4bc68e,_0x4edf59):_0x4bc68e,_0x5051f1=_0x3a6d67[_0x260979(0x26e)]-0x1,_0x51fe6e;_0x5051f1>=0x0;_0x5051f1--)(_0x51fe6e=_0x3a6d67[_0x5051f1])&&(_0x5370bd=_0x51fe6e(_0x5370bd)||_0x5370bd);return _0x5370bd;},fe=(_0x58e81,_0x6614e3)=>(_0x2bf998,_0x5289a2)=>_0x6614e3(_0x2bf998,_0x5289a2,_0x58e81);let ie=class extends l['Disposable']{constructor(_0x3db293,_0x19e0b3,_0x3d6de3){const _0x3a30ad=_0x333cc0;super(),this[_0x3a30ad(0x1eb)]=_0x3db293,this[_0x3a30ad(0x27b)]=_0x19e0b3,this[_0x3a30ad(0x2cd)]=_0x3d6de3,this[_0x3a30ad(0x1e2)]();}[_0x333cc0(0x1e2)](){const _0xb64aeb=_0x333cc0;this[_0xb64aeb(0x243)](this[_0xb64aeb(0x27b)]['interceptCommand']({'getMutations':_0x2b5043=>{const _0x116f1c=_0xb64aeb,_0x3596fd=[],_0x1b52c7=[];if(_0x2b5043['id']===_[_0x116f1c(0x21f)]['id']){const _0x48f58a=_0x2b5043[_0x116f1c(0x28b)];if(!_0x48f58a)return{'redos':_0x3596fd,'undos':_0x1b52c7};const {unitId:_0x4054ba,subUnitId:_0x5d0fe0,ranges:_0x2a1bd2}=_0x48f58a,_0x537cc0=this[_0x116f1c(0x2cd)][_0x116f1c(0x25f)](_0x4054ba,_0x5d0fe0);if(!_0x537cc0)return{'redos':_0x3596fd,'undos':_0x1b52c7};const _0x139cf1={},_0x2349dc={},_0xa34b55=new Set();_0x2a1bd2[_0x116f1c(0x226)](_0x593225=>{const _0x2512c8=_0x593225['startRow'],_0x81e200=_0x593225['startColumn'];l['Range']['foreach'](_0x593225,(_0x52025c,_0x4a85a9)=>{const _0x1fe8cc=_0x9fcb,_0x38ef27=this[_0x1fe8cc(0x2cd)][_0x1fe8cc(0x1ff)](_0x4054ba,_0x5d0fe0,_0x52025c,_0x4a85a9);if(_0x38ef27&&!(_0x52025c===_0x2512c8&&_0x4a85a9===_0x81e200)){const _0x54cdbb=this[_0x1fe8cc(0x2cd)]['getSparklineById'](_0x4054ba,_0x5d0fe0,_0x38ef27);if(_0x54cdbb){_0xa34b55[_0x1fe8cc(0x210)](_0x38ef27);let _0x357b6c=_0x139cf1[_0x38ef27];_0x357b6c||(_0x357b6c={'config':l[_0x1fe8cc(0x28f)][_0x1fe8cc(0x282)](_0x54cdbb[_0x1fe8cc(0x24a)]),'sparklines':new l[(_0x1fe8cc(0x29b))](_0x54cdbb[_0x1fe8cc(0x21a)][_0x1fe8cc(0x268)]())},_0x139cf1[_0x38ef27]=_0x357b6c),_0x357b6c[_0x1fe8cc(0x21a)][_0x1fe8cc(0x2a4)](_0x52025c,_0x4a85a9),_0x2349dc[_0x38ef27]={'config':l['Tools'][_0x1fe8cc(0x282)](_0x54cdbb[_0x1fe8cc(0x24a)]),'sparklines':l[_0x1fe8cc(0x28f)][_0x1fe8cc(0x282)](_0x54cdbb[_0x1fe8cc(0x21a)][_0x1fe8cc(0x268)]())};}}});});for(const [_0xd82466,_0x30f221]of _0x537cc0){const _0x320ff8=_0x30f221[_0x116f1c(0x21a)];_0x320ff8[_0x116f1c(0x2c9)]((_0x56944a,_0x6b1b31,_0x4175c7)=>{const _0x5194d6=_0x116f1c;for(let _0x2ebf39=0x0;_0x2ebf39<_0x2a1bd2[_0x5194d6(0x26e)];_0x2ebf39++){const _0xf81cf2=_0x2a1bd2[_0x2ebf39];if(l['Rectangle'][_0x5194d6(0x1f5)](_0xf81cf2,_0x4175c7)){_0xa34b55['add'](_0xd82466);let _0x5e54e3=_0x139cf1[_0xd82466];_0x5e54e3||(_0x5e54e3={'config':l['Tools'][_0x5194d6(0x282)](_0x30f221[_0x5194d6(0x24a)]),'sparklines':new l[(_0x5194d6(0x29b))](_0x320ff8[_0x5194d6(0x268)]())},_0x139cf1[_0xd82466]=_0x5e54e3),_0x5e54e3['sparklines'][_0x5194d6(0x2a4)](_0x56944a,_0x6b1b31),_0x2349dc[_0xd82466]||(_0x2349dc[_0xd82466]={'config':l['Tools'][_0x5194d6(0x282)](_0x30f221[_0x5194d6(0x24a)]),'sparklines':l['Tools']['deepClone'](_0x320ff8[_0x5194d6(0x268)]())});}}});}const _0x39992d={};Object[_0x116f1c(0x1fe)](_0x139cf1)[_0x116f1c(0x226)](([_0x1f820d,_0x4a4a1c])=>{const _0x159acc=_0x116f1c;_0x4a4a1c[_0x159acc(0x21a)][_0x159acc(0x297)]()&&(_0x39992d[_0x1f820d]={'config':_0x4a4a1c[_0x159acc(0x24a)],'sparklines':_0x4a4a1c[_0x159acc(0x21a)][_0x159acc(0x268)]()});}),_0xa34b55[_0x116f1c(0x216)]&&(_0x3596fd[_0x116f1c(0x24f)]({'id':O['id'],'params':{'unitId':_0x4054ba,'subUnitId':_0x5d0fe0,'groupIds':Array[_0x116f1c(0x2cc)](_0xa34b55),'isSingle':!0x1}}),_0x1b52c7['push']({'id':O['id'],'params':{'unitId':_0x4054ba,'subUnitId':_0x5d0fe0,'groupIds':Array[_0x116f1c(0x2cc)](_0xa34b55),'isSingle':!0x1}}),_0x3596fd[_0x116f1c(0x24f)]({'id':T['id'],'params':{'unitId':_0x4054ba,'subUnitId':_0x5d0fe0,'sparklineConfigMap':_0x39992d}}),_0x1b52c7[_0x116f1c(0x24f)]({'id':T['id'],'params':{'unitId':_0x4054ba,'subUnitId':_0x5d0fe0,'sparklineConfigMap':_0x2349dc}}));}return{'redos':_0x3596fd,'undos':_0x1b52c7};}}));}};ie=qe([fe(0x0,l[_0x333cc0(0x271)](l[_0x333cc0(0x209)])),fe(0x1,l[_0x333cc0(0x271)](_[_0x333cc0(0x27f)])),fe(0x2,l['Inject'](exports[_0x333cc0(0x21d)]))],ie);var Ye=Object[_0x333cc0(0x25b)],Je=(_0xae1fb0,_0x13c555,_0x25e6e5,_0x4ccbc7)=>{const _0x1ecd28=_0x333cc0;for(var _0x22127b=_0x4ccbc7>0x1?void 0x0:_0x4ccbc7?Ye(_0x13c555,_0x25e6e5):_0x13c555,_0xd23ce1=_0xae1fb0[_0x1ecd28(0x26e)]-0x1,_0x15ab32;_0xd23ce1>=0x0;_0xd23ce1--)(_0x15ab32=_0xae1fb0[_0xd23ce1])&&(_0x22127b=_0x15ab32(_0x22127b)||_0x22127b);return _0x22127b;},ne=(_0x393f6a,_0x1dcbcf)=>(_0xdc208f,_0x2c871f)=>_0x1dcbcf(_0xdc208f,_0x2c871f,_0x393f6a);let le=class extends l['Disposable']{constructor(_0x1aeac6,_0x406a21,_0xbb8faa,_0x378f77){const _0x5ecd70=_0x333cc0;super(),J(this,'disposableCollection',new l[(_0x5ecd70(0x221))]()),(this[_0x5ecd70(0x1eb)]=_0x1aeac6,this[_0x5ecd70(0x20a)]=_0x406a21,this[_0x5ecd70(0x214)]=_0xbb8faa,this[_0x5ecd70(0x2cd)]=_0x378f77,this[_0x5ecd70(0x264)](),this[_0x5ecd70(0x223)]());}[_0x333cc0(0x264)](){const _0x1b5c5f=_0x333cc0,_0x2c6489=(_0x4183a7,_0x3b92f3)=>{const _0x21287e=_0x9fcb,_0x36202b=this[_0x21287e(0x214)]['getCurrentUnitForType'](l['UniverInstanceType'][_0x21287e(0x1f7)]);if(!_0x36202b||!(_0x36202b==null?void 0x0:_0x36202b[_0x21287e(0x2b0)](_0x3b92f3)))return;this[_0x21287e(0x2c1)]['dispose']();const _0x42b8d6=_0x3e6520=>this[_0x21287e(0x23b)](_0x3e6520,_0x4183a7,_0x3b92f3),_0x1c9a55=[],_0x4b5cf6=this[_0x21287e(0x2cd)]['getSubUnitSparkline'](_0x4183a7,_0x3b92f3);if(_0x4b5cf6){for(const [_0x39ffc9,_0x5de30b]of _0x4b5cf6)_0x5de30b[_0x21287e(0x21a)][_0x21287e(0x2c9)]((_0x192bd4,_0x30c4dc,_0x1d0fed)=>{const _0x33ac69=_0x21287e,_0x3479dc=l[_0x33ac69(0x2d4)](_0x192bd4,_0x30c4dc);_0x1c9a55[_0x33ac69(0x24f)](_0x3479dc);});_0x1c9a55[_0x21287e(0x226)](_0x5d4707=>{const _0x47246f=_0x21287e;this[_0x47246f(0x2c1)][_0x47246f(0x210)](this['_refRangeService'][_0x47246f(0x1ef)](_0x5d4707,_0x42b8d6,_0x4183a7,_0x3b92f3));});}};this[_0x1b5c5f(0x243)](this[_0x1b5c5f(0x1eb)][_0x1b5c5f(0x277)](_0x2ea2f2=>{const _0x536990=_0x1b5c5f;if(_0x2ea2f2['id']===_[_0x536990(0x258)]['id']){const _0x5dbc51=_0x2ea2f2['params'],_0x3c24f4=_0x5dbc51[_0x536990(0x234)],_0x4f7cb8=_0x5dbc51[_0x536990(0x287)];if(!_0x3c24f4||!_0x4f7cb8)return;_0x2c6489(_0x4f7cb8,_0x3c24f4);}if(_0x2ea2f2['id']===ue['id']||_0x2ea2f2['id']===T['id']){const _0x49dc35=_0x2ea2f2[_0x536990(0x28b)],_0x5ac2d1=_0x49dc35[_0x536990(0x234)],_0x4b7e08=_0x49dc35[_0x536990(0x287)];if(!_0x5ac2d1||!_0x4b7e08)return;_0x2c6489(_0x4b7e08,_0x5ac2d1);}}));}[_0x333cc0(0x23b)](_0x559871,_0x44a028,_0x288139){const _0x4777b4=_0x333cc0;switch(_0x559871['id']){case _[_0x4777b4(0x2b7)]['id']:return this[_0x4777b4(0x204)](_0x559871[_0x4777b4(0x28b)],_0x44a028,_0x288139);case _[_0x4777b4(0x2a9)]['id']:return this[_0x4777b4(0x229)](_0x559871[_0x4777b4(0x28b)],_0x44a028,_0x288139);}return{'redos':[],'undos':[]};}['_getRefRangeMutationsByDeleteRows'](_0xcff2c3,_0x2e150b,_0x1b8d61){const _0x3c3de8=_0x333cc0;var _0x3c0701,_0x1b91a7;const {range:_0x476130}=_0xcff2c3,_0x4bfd87=new Set(),_0x3a009e={},_0x43a673={},_0x2a747e=[],_0x51cea2=[],_0x2fd35b=[],_0x267ab7=[];if(!_['getSheetCommandTarget'](this[_0x3c3de8(0x214)],{'unitId':_0x2e150b,'subUnitId':_0x1b8d61}))return{'redos':_0x51cea2,'undos':_0x2a747e};const _0x3e5e02=this[_0x3c3de8(0x2cd)][_0x3c3de8(0x25f)](_0x2e150b,_0x1b8d61);if(!_0x3e5e02)return{'redos':_0x51cea2,'undos':_0x2a747e};if(!((_0x1b91a7=(_0x3c0701=this[_0x3c3de8(0x2cd)][_0x3c3de8(0x283)]()[_0x3c3de8(0x1e7)][_0x3c3de8(0x28d)](_0x2e150b))==null?void 0x0:_0x3c0701[_0x3c3de8(0x28d)](_0x1b8d61))==null?void 0x0:_0x1b91a7['matrix']))return{'redos':_0x51cea2,'undos':_0x2a747e};for(const [_0x31857d,_0x4c3d55]of _0x3e5e02){const _0x49f659=_0x4c3d55[_0x3c3de8(0x21a)];_0x49f659['forValue']((_0x21770f,_0xb6a1ff,_0x57abf7)=>{const _0xc94c40=_0x3c3de8;if(l[_0xc94c40(0x2b2)]['intersects'](_0x476130,_0x57abf7)){_0x4bfd87[_0xc94c40(0x210)](_0x31857d);let _0x1f4866=_0x43a673[_0x31857d];_0x1f4866||(_0x1f4866={'config':_0x4c3d55[_0xc94c40(0x24a)],'sparklines':_0x4c3d55[_0xc94c40(0x21a)]['clone']()},_0x43a673[_0x31857d]=_0x1f4866);let _0x1179e3=_0x3a009e[_0x31857d];_0x1179e3||(_0x1179e3={'config':_0x4c3d55[_0xc94c40(0x24a)],'sparklines':new l[(_0xc94c40(0x29b))](_0x4c3d55['sparklines'][_0xc94c40(0x268)]())},_0x3a009e[_0x31857d]=_0x1179e3);const _0x116963=_['adjustRangeOnMutation'](_0x57abf7,{'id':_[_0xc94c40(0x2ad)]['id'],'params':_0xcff2c3});_0x116963?_0x1179e3[_0xc94c40(0x21a)][_0xc94c40(0x246)](_0x21770f,_0xb6a1ff,_0x116963):_0x1179e3[_0xc94c40(0x21a)][_0xc94c40(0x246)](_0x21770f,_0xb6a1ff,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0xc94c40(0x22f)][_0xc94c40(0x26d)]});}}),_0x49f659[_0x3c3de8(0x2c9)]((_0x15e5a5,_0x2a7773,_0x14913f)=>{const _0xba3f80=_0x3c3de8;if(_0x15e5a5<=_0x476130[_0xba3f80(0x29a)]&&_0x15e5a5>=_0x476130[_0xba3f80(0x2b5)]){_0x4bfd87[_0xba3f80(0x210)](_0x31857d);let _0x180c38=_0x43a673[_0x31857d];_0x180c38||(_0x180c38={'config':_0x4c3d55[_0xba3f80(0x24a)],'sparklines':_0x4c3d55[_0xba3f80(0x21a)][_0xba3f80(0x268)]()},_0x43a673[_0x31857d]=_0x180c38);let _0x5d5955=_0x3a009e[_0x31857d];_0x5d5955||(_0x5d5955={'config':_0x4c3d55[_0xba3f80(0x24a)],'sparklines':new l[(_0xba3f80(0x29b))](_0x4c3d55['sparklines']['clone']())},_0x3a009e[_0x31857d]=_0x5d5955);}});}_0x267ab7[_0x3c3de8(0x24f)]({'id':O['id'],'params':{'unitId':_0x2e150b,'subUnitId':_0x1b8d61,'groupIds':Array[_0x3c3de8(0x2cc)](_0x4bfd87),'isSingle':!0x1}}),_0x2fd35b[_0x3c3de8(0x24f)]({'id':O['id'],'params':{'unitId':_0x2e150b,'subUnitId':_0x1b8d61,'groupIds':Array['from'](_0x4bfd87),'isSingle':!0x1}});const _0x476b09={};let _0xa3f4ba=!0x1;return Object[_0x3c3de8(0x1fe)](_0x3a009e)[_0x3c3de8(0x226)](([_0x3b1443,_0x4d25b9])=>{const _0x205c9b=_0x3c3de8;_0x4d25b9[_0x205c9b(0x21a)]['getSizeOf']()&&(_0xa3f4ba=!0x0,_0x4d25b9[_0x205c9b(0x21a)]['removeRows'](_0x476130[_0x205c9b(0x2b5)],_0x476130[_0x205c9b(0x29a)]-_0x476130[_0x205c9b(0x2b5)]+0x1),_0x476b09[_0x3b1443]={'config':_0x4d25b9['config'],'sparklines':_0x4d25b9[_0x205c9b(0x21a)]['clone']()});}),_0xa3f4ba&&_0x51cea2[_0x3c3de8(0x24f)]({'id':T['id'],'params':{'unitId':_0x2e150b,'subUnitId':_0x1b8d61,'sparklineConfigMap':_0x476b09}}),_0x2a747e[_0x3c3de8(0x24f)]({'id':T['id'],'params':{'unitId':_0x2e150b,'subUnitId':_0x1b8d61,'sparklineConfigMap':_0x43a673}}),{'redos':_0x51cea2,'undos':_0x2a747e,'preRedos':_0x2fd35b,'preUndos':_0x267ab7};}[_0x333cc0(0x204)](_0xa673dd,_0x3ccdd8,_0x31a482){const _0x4b0eef=_0x333cc0;var _0x14450a,_0x1bcee4;const {range:_0x218a4b}=_0xa673dd,_0x21a803=new Set(),_0x2bf04b={},_0x304a5c={},_0x3397c2=[],_0x1f060e=[],_0x5955e1=[],_0x4ae41b=[];if(!_[_0x4b0eef(0x2b4)](this[_0x4b0eef(0x214)],{'unitId':_0x3ccdd8,'subUnitId':_0x31a482}))return{'redos':_0x1f060e,'undos':_0x3397c2};const _0xbb530b=this[_0x4b0eef(0x2cd)][_0x4b0eef(0x25f)](_0x3ccdd8,_0x31a482);if(!_0xbb530b)return{'redos':_0x1f060e,'undos':_0x3397c2};if(!((_0x1bcee4=(_0x14450a=this[_0x4b0eef(0x2cd)]['getSparklineCache']()[_0x4b0eef(0x1e7)][_0x4b0eef(0x28d)](_0x3ccdd8))==null?void 0x0:_0x14450a[_0x4b0eef(0x28d)](_0x31a482))==null?void 0x0:_0x1bcee4[_0x4b0eef(0x26b)]))return{'redos':_0x1f060e,'undos':_0x3397c2};for(const [_0x3d3dc7,_0x5b84bb]of _0xbb530b){const _0x1e0580=_0x5b84bb[_0x4b0eef(0x21a)];_0x1e0580[_0x4b0eef(0x2c9)]((_0x22c1bf,_0x118183,_0x3d77c3)=>{const _0x5ad988=_0x4b0eef;if(l[_0x5ad988(0x2b2)][_0x5ad988(0x1e9)](_0x218a4b,_0x3d77c3)){_0x21a803[_0x5ad988(0x210)](_0x3d3dc7);let _0x3de476=_0x304a5c[_0x3d3dc7];_0x3de476||(_0x3de476={'config':_0x5b84bb[_0x5ad988(0x24a)],'sparklines':_0x5b84bb[_0x5ad988(0x21a)][_0x5ad988(0x268)]()},_0x304a5c[_0x3d3dc7]=_0x3de476);let _0x109f0f=_0x2bf04b[_0x3d3dc7];_0x109f0f||(_0x109f0f={'config':_0x5b84bb[_0x5ad988(0x24a)],'sparklines':new l[(_0x5ad988(0x29b))](_0x5b84bb[_0x5ad988(0x21a)][_0x5ad988(0x268)]())},_0x2bf04b[_0x3d3dc7]=_0x109f0f);const _0x448520=_[_0x5ad988(0x205)](_0x3d77c3,{'id':_['RemoveColMutation']['id'],'params':_0xa673dd});_0x448520?_0x109f0f['sparklines'][_0x5ad988(0x246)](_0x22c1bf,_0x118183,_0x448520):_0x109f0f[_0x5ad988(0x21a)][_0x5ad988(0x246)](_0x22c1bf,_0x118183,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l['RANGE_TYPE'][_0x5ad988(0x26d)]});}}),_0x1e0580[_0x4b0eef(0x2c9)]((_0x33c0f7,_0x50334d,_0x1b56fa)=>{const _0x447e06=_0x4b0eef;if(_0x50334d<=_0x218a4b[_0x447e06(0x220)]&&_0x50334d>=_0x218a4b[_0x447e06(0x1fc)]){_0x21a803[_0x447e06(0x210)](_0x3d3dc7);let _0x48e612=_0x304a5c[_0x3d3dc7];_0x48e612||(_0x48e612={'config':_0x5b84bb[_0x447e06(0x24a)],'sparklines':_0x5b84bb['sparklines']['clone']()},_0x304a5c[_0x3d3dc7]=_0x48e612);let _0x37f397=_0x2bf04b[_0x3d3dc7];_0x37f397||(_0x37f397={'config':_0x5b84bb[_0x447e06(0x24a)],'sparklines':new l['ObjectMatrix'](_0x5b84bb[_0x447e06(0x21a)][_0x447e06(0x268)]())},_0x2bf04b[_0x3d3dc7]=_0x37f397);}});}_0x4ae41b[_0x4b0eef(0x24f)]({'id':O['id'],'params':{'unitId':_0x3ccdd8,'subUnitId':_0x31a482,'groupIds':Array['from'](_0x21a803),'isSingle':!0x1}}),_0x5955e1['push']({'id':O['id'],'params':{'unitId':_0x3ccdd8,'subUnitId':_0x31a482,'groupIds':Array[_0x4b0eef(0x2cc)](_0x21a803),'isSingle':!0x1}});const _0x42a3eb={};let _0x2b589f=!0x1;return Object[_0x4b0eef(0x1fe)](_0x2bf04b)[_0x4b0eef(0x226)](([_0x15f08b,_0x10f970])=>{const _0x15b270=_0x4b0eef;_0x10f970[_0x15b270(0x21a)][_0x15b270(0x297)]()&&(_0x2b589f=!0x0,_0x10f970[_0x15b270(0x21a)][_0x15b270(0x224)](_0x218a4b['startColumn'],_0x218a4b[_0x15b270(0x220)]-_0x218a4b['startColumn']+0x1),_0x42a3eb[_0x15f08b]={'config':_0x10f970['config'],'sparklines':_0x10f970[_0x15b270(0x21a)][_0x15b270(0x268)]()});}),_0x2b589f&&_0x1f060e[_0x4b0eef(0x24f)]({'id':T['id'],'params':{'unitId':_0x3ccdd8,'subUnitId':_0x31a482,'sparklineConfigMap':_0x42a3eb}}),_0x3397c2['push']({'id':T['id'],'params':{'unitId':_0x3ccdd8,'subUnitId':_0x31a482,'sparklineConfigMap':_0x304a5c}}),{'redos':_0x1f060e,'undos':_0x3397c2,'preRedos':_0x5955e1,'preUndos':_0x4ae41b};}[_0x333cc0(0x223)](){const _0x29d5bb=_0x333cc0;this['disposeWithMe'](this[_0x29d5bb(0x1eb)]['onCommandExecuted'](_0x3deb94=>{const _0x1b4dcb=_0x29d5bb;if(_0x3deb94['id']===_[_0x1b4dcb(0x2d2)]['id']){const _0x14df3b=_0x3deb94['params'],{unitId:_0x16301e,subUnitId:_0x5f085f,range:_0x15edd0}=_0x14df3b,_0x54b48e=_0x15edd0[_0x1b4dcb(0x1fc)],_0x59fcbb=_0x15edd0['endColumn']-_0x15edd0[_0x1b4dcb(0x1fc)]+0x1,_0x10ecd4=this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x25f)](_0x16301e,_0x5f085f);if(!_0x10ecd4)return;for(const [_0x4d3f6d,_0x313222]of _0x10ecd4){this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x1e0)](_0x16301e,_0x5f085f,_0x4d3f6d);const _0x118024=_0x313222[_0x1b4dcb(0x21a)];_0x118024['forValue']((_0x4a9bef,_0x32d9ad,_0x5ad0cb)=>{const _0x1be7fd=_0x1b4dcb,_0x51d58f={..._0x5ad0cb};_0x54b48e<=_0x51d58f[_0x1be7fd(0x1fc)]?(_0x51d58f[_0x1be7fd(0x1fc)]+=_0x59fcbb,_0x51d58f['endColumn']+=_0x59fcbb):_0x54b48e>_0x51d58f['endColumn']||(_0x51d58f[_0x1be7fd(0x220)]+=_0x59fcbb),_0x118024[_0x1be7fd(0x246)](_0x4a9bef,_0x32d9ad,_0x51d58f);});const _0x49c9af=_0x118024[_0x1b4dcb(0x242)]();for(const _0xd07ea3 in _0x49c9af){const _0x58a641=_0x49c9af[Number(_0xd07ea3)];if(!_0x58a641)continue;const _0x41ad99=Object[_0x1b4dcb(0x25c)](_0x58a641)[_0x1b4dcb(0x1f3)](Number),_0x728198=Math[_0x1b4dcb(0x1f8)](..._0x41ad99);for(let _0x3fc2b9=_0x728198;_0x3fc2b9>=_0x54b48e;_0x3fc2b9--)_0x3fc2b9>=_0x54b48e&&_0x58a641[_0x3fc2b9]&&(_0x58a641[_0x3fc2b9+_0x59fcbb]=_0x58a641[_0x3fc2b9],delete _0x58a641[_0x3fc2b9]);}this['_sparklineDataSourceModel']['updateSparklineExtraNum'](_0x16301e,_0x5f085f,_0x4d3f6d);}}else{if(_0x3deb94['id']===_[_0x1b4dcb(0x27a)]['id']){const _0x435420=_0x3deb94['params'],{unitId:_0x342f80,subUnitId:_0x448288,range:_0x2a2131}=_0x435420,_0x3cd3b3=_0x2a2131[_0x1b4dcb(0x2b5)],_0x23e4bb=_0x2a2131[_0x1b4dcb(0x29a)]-_0x2a2131[_0x1b4dcb(0x2b5)]+0x1,_0x134c1c=this[_0x1b4dcb(0x2cd)]['getSubUnitSparkline'](_0x342f80,_0x448288);if(!_0x134c1c)return;for(const [_0x3189cb,_0x56ae15]of _0x134c1c){this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x1e0)](_0x342f80,_0x448288,_0x3189cb);const _0x4281ee=_0x56ae15[_0x1b4dcb(0x21a)];_0x4281ee[_0x1b4dcb(0x2c9)]((_0x2c7025,_0xf1946f,_0x1157ad)=>{const _0x167035=_0x1b4dcb,_0x24af11={..._0x1157ad};_0x3cd3b3<=_0x24af11['startRow']?(_0x24af11[_0x167035(0x2b5)]+=_0x23e4bb,_0x24af11[_0x167035(0x29a)]+=_0x23e4bb):_0x3cd3b3>_0x24af11[_0x167035(0x29a)]||(_0x24af11[_0x167035(0x29a)]+=_0x23e4bb),_0x4281ee[_0x167035(0x246)](_0x2c7025,_0xf1946f,_0x24af11);});const _0x2a2ca5=_0x4281ee[_0x1b4dcb(0x242)](),_0x1e92de=Object[_0x1b4dcb(0x25c)](_0x2a2ca5)[_0x1b4dcb(0x1f3)](Number),_0x57720e=Math[_0x1b4dcb(0x1f8)](..._0x1e92de);for(let _0x45b98e=_0x57720e;_0x45b98e>=_0x3cd3b3;_0x45b98e--)_0x45b98e>=_0x3cd3b3&&_0x2a2ca5[_0x45b98e]&&(_0x2a2ca5[_0x45b98e+_0x23e4bb]=_0x2a2ca5[_0x45b98e],delete _0x2a2ca5[_0x45b98e]);this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x218)](_0x342f80,_0x448288,_0x3189cb);}}else{if(_0x3deb94['id']===_[_0x1b4dcb(0x1fd)]['id']){const _0x20196c=_0x3deb94['params'],{range:_0x3132d8,unitId:_0x5c0848,subUnitId:_0x2c976f}=_0x20196c,_0x21bcee=this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x25f)](_0x5c0848,_0x2c976f);if(!_0x21bcee)return;for(const [_0x5b508a,_0x2130e7]of _0x21bcee){const _0x5523fd=_0x2130e7['sparklines'];_0x5523fd['forValue']((_0x1ac8e0,_0x129301,_0x45e374)=>{const _0x2fecfd=_0x1b4dcb,_0xcfa402=_[_0x2fecfd(0x205)](_0x45e374,_0x3deb94);_0xcfa402?_0x5523fd[_0x2fecfd(0x246)](_0x1ac8e0,_0x129301,_0xcfa402):_0x5523fd['setValue'](_0x1ac8e0,_0x129301,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l['RANGE_TYPE'][_0x2fecfd(0x26d)]});}),_0x5523fd[_0x1b4dcb(0x224)](_0x3132d8[_0x1b4dcb(0x1fc)],_0x3132d8[_0x1b4dcb(0x220)]-_0x3132d8[_0x1b4dcb(0x1fc)]+0x1);}this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x2a0)](_0x5c0848,_0x2c976f);}else{if(_0x3deb94['id']===_['RemoveRowMutation']['id']){const _0x4982fb=_0x3deb94[_0x1b4dcb(0x28b)],{range:_0x3ec3b7,unitId:_0x1a5fc5,subUnitId:_0x50a988}=_0x4982fb,_0x16630e=this[_0x1b4dcb(0x2cd)]['getSubUnitSparkline'](_0x1a5fc5,_0x50a988);if(!_0x16630e)return;for(const [_0x298222,_0x2078a4]of _0x16630e){const _0x370429=_0x2078a4[_0x1b4dcb(0x21a)];_0x370429[_0x1b4dcb(0x2c9)]((_0x3e8cd3,_0x22a5c3,_0x2de11f)=>{const _0x38e948=_0x1b4dcb,_0x1a02e9=_[_0x38e948(0x205)](_0x2de11f,_0x3deb94);_0x1a02e9?_0x370429[_0x38e948(0x246)](_0x3e8cd3,_0x22a5c3,_0x1a02e9):_0x370429[_0x38e948(0x246)](_0x3e8cd3,_0x22a5c3,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x38e948(0x22f)][_0x38e948(0x26d)]});}),_0x370429[_0x1b4dcb(0x28c)](_0x3ec3b7[_0x1b4dcb(0x2b5)],_0x3ec3b7[_0x1b4dcb(0x29a)]-_0x3ec3b7['startRow']+0x1);}this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x2a0)](_0x1a5fc5,_0x50a988);}else{if(_0x3deb94['id']===_[_0x1b4dcb(0x23e)]['id']){const _0x34e88e=_0x3deb94[_0x1b4dcb(0x28b)],{unitId:_0x2ec242,subUnitId:_0x9b25d0,sourceRange:_0x260c99,targetRange:_0x5bef67}=_0x34e88e,_0x2b760c=this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x25f)](_0x2ec242,_0x9b25d0);if(!_0x2b760c)return;for(const [_0x47e76e,_0x185013]of _0x2b760c){const _0x44e630=_0x185013[_0x1b4dcb(0x21a)];_0x44e630[_0x1b4dcb(0x2c9)]((_0x47473f,_0x490143,_0x2cf362)=>{const _0x568762=_0x1b4dcb,_0xcf13e8=_[_0x568762(0x205)](_0x2cf362,_0x3deb94);_0xcf13e8?_0x44e630['setValue'](_0x47473f,_0x490143,_0xcf13e8):_0x44e630[_0x568762(0x246)](_0x47473f,_0x490143,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x568762(0x22f)]['NORMAL']});}),_0x44e630['moveColumns'](_0x260c99[_0x1b4dcb(0x1fc)],_0x260c99[_0x1b4dcb(0x220)]-_0x260c99[_0x1b4dcb(0x1fc)]+0x1,_0x5bef67['startColumn']);}this['_sparklineDataSourceModel']['reBuildAnchorCache'](_0x2ec242,_0x9b25d0);}else{if(_0x3deb94['id']===_[_0x1b4dcb(0x280)]['id']){const _0x5ba189=_0x3deb94[_0x1b4dcb(0x28b)],{unitId:_0x2b8c32,subUnitId:_0x27f1b9,sourceRange:_0x272059,targetRange:_0x19585d}=_0x5ba189,_0x1dce0c=this['_sparklineDataSourceModel'][_0x1b4dcb(0x25f)](_0x2b8c32,_0x27f1b9);if(!_0x1dce0c)return;for(const [_0x29bf13,_0x42239f]of _0x1dce0c){const _0x157c07=_0x42239f[_0x1b4dcb(0x21a)];_0x157c07['forValue']((_0x1d4afa,_0xbfd685,_0x2789ed)=>{const _0x57ea77=_0x1b4dcb,_0x2c8982=_[_0x57ea77(0x205)](_0x2789ed,_0x3deb94);_0x2c8982?_0x157c07[_0x57ea77(0x246)](_0x1d4afa,_0xbfd685,_0x2c8982):_0x157c07[_0x57ea77(0x246)](_0x1d4afa,_0xbfd685,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':l[_0x57ea77(0x22f)]['NORMAL']});}),_0x157c07[_0x1b4dcb(0x255)](_0x272059[_0x1b4dcb(0x2b5)],_0x272059[_0x1b4dcb(0x29a)]-_0x272059[_0x1b4dcb(0x2b5)]+0x1,_0x19585d[_0x1b4dcb(0x2b5)]);}this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x2a0)](_0x2b8c32,_0x27f1b9);}else{if(_0x3deb94['id']===_['MoveRangeMutation']['id']){const _0x4b7fb2=_0x3deb94['params'],{fromRange:_0x39eabc,toRange:_0x430c18,unitId:_0x46d6b2,from:_0x3e7bac,to:_0x59075d}=_0x4b7fb2;if(_0x3e7bac[_0x1b4dcb(0x234)]!==_0x59075d[_0x1b4dcb(0x234)])return;const _0x215ecf=_0x3e7bac[_0x1b4dcb(0x234)],{startRow:_0x104dcf,endRow:_0x2acdab,startColumn:_0x3f6dd6,endColumn:_0x289df9}=_0x39eabc,{startRow:_0x1aaa33,startColumn:_0x67bcb2}=_0x430c18,_0x54e2b2=_0x1aaa33-_0x104dcf,_0x13942f=_0x67bcb2-_0x3f6dd6,_0x28bc97=this['_sparklineDataSourceModel'][_0x1b4dcb(0x25f)](_0x46d6b2,_0x215ecf);if(!(_0x28bc97!=null&&_0x28bc97['size']))return;for(let _0x10e2c3=_0x104dcf;_0x10e2c3<=_0x2acdab;_0x10e2c3++)for(let _0xb1a9bc=_0x3f6dd6;_0xb1a9bc<=_0x289df9;_0xb1a9bc++){const _0x5ee355=this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x1ff)](_0x46d6b2,_0x215ecf,_0x10e2c3,_0xb1a9bc);if(_0x5ee355){const _0xc8e265=this['_sparklineDataSourceModel']['getSparklineById'](_0x46d6b2,_0x215ecf,_0x5ee355);if(_0xc8e265){const _0x328196=_0xc8e265[_0x1b4dcb(0x21a)][_0x1b4dcb(0x2a8)](_0x10e2c3,_0xb1a9bc);_0x328196&&(_0xc8e265['sparklines'][_0x1b4dcb(0x246)](_0x10e2c3+_0x54e2b2,_0xb1a9bc+_0x13942f,_0x328196),_0xc8e265['sparklines'][_0x1b4dcb(0x2a4)](_0x10e2c3,_0xb1a9bc));}}}for(const [_0x15bb04,_0x4b80f8]of _0x28bc97){const _0x11da1e=_0x4b80f8['sparklines'];_0x11da1e['forValue']((_0x1914ef,_0x94127c,_0xe16249)=>{const _0xa29f19=_0x1b4dcb,_0x5212b2={..._0xe16249};l[_0xa29f19(0x2b2)][_0xa29f19(0x1f5)](_0x39eabc,_0xe16249)&&(_0x5212b2[_0xa29f19(0x2b5)]+=_0x54e2b2,_0x5212b2[_0xa29f19(0x29a)]+=_0x54e2b2,_0x5212b2[_0xa29f19(0x1fc)]+=_0x13942f,_0x5212b2[_0xa29f19(0x220)]+=_0x13942f),_0x11da1e[_0xa29f19(0x246)](_0x1914ef,_0x94127c,_0x5212b2);});}this[_0x1b4dcb(0x2cd)][_0x1b4dcb(0x2a0)](_0x46d6b2,_0x215ecf);}}}}}}}}));}};le=Je([ne(0x0,l['Inject'](l[_0x333cc0(0x209)])),ne(0x1,l[_0x333cc0(0x271)](_[_0x333cc0(0x213)])),ne(0x2,l['IUniverInstanceService']),ne(0x3,l[_0x333cc0(0x271)](exports['SparklineDataSourceModel']))],le);function _0x2e20(){const _0x48f5b2=['Injector','_commandService','IUniverInstanceService','rgb(80,102,248)','zero_value','registerRefRange','SetSheetSparklineMutation','groupId','deleteUnit','map','getRowVisible','contains','_initHideRowColWithSparkline','UNIVER_SHEET','max','509534zDGvCs','SPACING','471ySTmBO','startColumn','RemoveColMutation','entries','getSparkline','LINE_CHART','CUSTOM_EXTREMUM','UniverSheetSparklinePlugin','assign','_getRefRangeMutationsByDeleteCols','adjustRangeOnMutation','getSparklineById','asObservable','symbol','ICommandService','_refRangeService','ReorderRangeMutation','pushUndoRedo','_initDependencies','Range','30793atEAbj','add','getColVisible','toRgbString','RefRangeService','_univerInstanceService','Disposable','size','foreach','updateSparklineExtraNum','SOFT','sparklines','negativePoint','_initExclusiveRangeChange','SparklineDataSourceModel','ColorKit','AddWorksheetMergeCommand','endColumn','DisposableCollection','exclusiveRangesChange$','_initCorrectRangeWithSparkline','removeColumns','RemoveSheetSparklineCommand','forEach','SELF_EXTREMUM','MUTATION','_getRefRangeMutationsByDeleteRows','number','extremumMax','ClearSelectionAllCommand','hasValue','sequenceExecute','RANGE_TYPE','NUMBER','set','4468gMFxMN','rgb(244,104,249)','subUnitId','_sheetSelectionService','rgb(124,66,147)','toJSON','addSparkline','_exclusiveRangeService','CONNECT_WITH_LINE','refRangeHandle','689148WNOKFj','values','MoveColsMutation','Mismatch\x20between\x20the\x20number\x20of\x20target\x20cells\x20and\x20the\x20source\x20range\x20dimensions.','BAR_CHART','_config','getMatrix','disposeWithMe','FORCE_STRING','isValidRange','setValue','nonNumShowAs','sparklineModel','Plugin','config','highPoint','9muiprR','SparklineThemeMapping','getCurrentUnitOfType','push','GROUP_EXTREMUM','SetRangeValuesMutation','getSheetId','rgb(54,78,244)','SparklinePointsNames','moveRows','811768jsQvmt','DependentOn','SetWorksheetActivateCommand','sheet.command.set-sparkline','AddSheetSparklineMutation','getOwnPropertyDescriptor','keys','STRING','spacing','getSubUnitSparkline','themeType','_ensureAnchorMatrix','_initClearWithSparkline','fresh','_onRefRangeChange','parse','touchDependencies','MIN_SAFE_INTEGER','clone','interceptCommand','_initSheetChange','matrix','standard','NORMAL','length','662325beOjSR','every','Inject','setSparkline','_updateConfig$','SparklineTypeEnum','SetColVisibleMutation','column','onCommandExecuted','sheet.command.remove-sparkline','SparklineExtremumTypeEnum','InsertRowMutation','_sheetInterceptorService','CellValueType','426LILrpm','SparklineThemeTypeEnum','SheetInterceptorService','MoveRowsMutation','PLUGIN_NAME','deepClone','getSparklineCache','SpacialShowAsEnum','getCurrentSelections','removeSparkline','unitId','AddSheetSparklineCommand','generateRandomId','ranges','params','removeRows','get','SetSheetSparklineCommand','Tools','_resourceManagerService','_initRegisterCommand','rgb(30,177,189)','u-connect','registerCommand','rgb(236,100,169)','IUndoRedoService','getSizeOf','sheet.command.add-sparkline','custom','endRow','ObjectMatrix','delete','sheet.mutation.remove-sparkline','CommandType','SetRowHiddenMutation','reBuildAnchorCache','PROFIT_AND_LOSS_CHART','_sparklineAnchorMap','extremumMin','realDeleteValue','registerPluginResource','u-spacing','removePartSparkline','getValue','RemoveRowCommand','containHiddenCells','onReady','rgb(46,187,122)','RemoveRowMutation','MAX_SAFE_INTEGER','SheetsSelectionsService','getSheetBySheetId','defineProperty','Rectangle','_initSnapshot','getSheetCommandTarget','startRow','getCellRaw','RemoveColCommand','STANDARD','PIE_CHART','BOOLEAN','IResourceManagerService','subscribe','fromJSON','markersPoint','has','range','disposableCollection','_sparklineModel','CUSTOM','rgb(252,117,60)','remove','row','ZERO_VALUE','RemoveSheetCommand','forValue','stringify','next','from','_sparklineDataSourceModel','type','_initDataChangeListener','SetColHiddenMutation','_injector','InsertColMutation','_ensureConfigMap','cellToRange','RemoveSheetSparklineMutation','COMMAND','setAlpha','clearSparklineCache','sheet.mutation.set-sparkline','_initMergeWithSparkline','distinctive','UniverInstanceType','6651770wSuPdI','value','sparklineAnchorMap','actualColumn','intersects'];_0x2e20=function(){return _0x48f5b2;};return _0x2e20();}var Ze=Object['getOwnPropertyDescriptor'],Qe=(_0x37af67,_0x189528,_0x3f080f,_0x540b81)=>{const _0x34b0cf=_0x333cc0;for(var _0x2f75ee=_0x540b81>0x1?void 0x0:_0x540b81?Ze(_0x189528,_0x3f080f):_0x189528,_0x706c9f=_0x37af67[_0x34b0cf(0x26e)]-0x1,_0x42dc00;_0x706c9f>=0x0;_0x706c9f--)(_0x42dc00=_0x37af67[_0x706c9f])&&(_0x2f75ee=_0x42dc00(_0x2f75ee)||_0x2f75ee);return _0x2f75ee;},Se=(_0x56324f,_0x37827d)=>(_0x4e7b4c,_0x545ee0)=>_0x37827d(_0x4e7b4c,_0x545ee0,_0x56324f);let ce=class extends l['Disposable']{constructor(_0x5b5997,_0x3ec6af,_0x52f6a0){const _0x541c49=_0x333cc0;super(),this[_0x541c49(0x214)]=_0x5b5997,this[_0x541c49(0x27b)]=_0x3ec6af,this[_0x541c49(0x2cd)]=_0x52f6a0,this[_0x541c49(0x26a)]();}[_0x333cc0(0x26a)](){const _0x9025a7=_0x333cc0;this[_0x9025a7(0x243)](this[_0x9025a7(0x27b)][_0x9025a7(0x269)]({'getMutations':_0x104365=>{const _0x133979=_0x9025a7;var _0x47a375;if(_0x104365['id']===_[_0x133979(0x2c8)]['id']){const _0xf8a859=_0x104365[_0x133979(0x28b)],_0xc68b64=_0xf8a859[_0x133979(0x287)]||this[_0x133979(0x214)][_0x133979(0x24e)](l['UniverInstanceType']['UNIVER_SHEET'])['getUnitId'](),_0x526389=_0xf8a859[_0x133979(0x234)]||((_0x47a375=this['_univerInstanceService'][_0x133979(0x24e)](l[_0x133979(0x1e4)][_0x133979(0x1f7)])['getActiveSheet']())==null?void 0x0:_0x47a375[_0x133979(0x252)]());if(!_0xc68b64||!_0x526389)return{'redos':[],'undos':[]};const _0x1703d5=this[_0x133979(0x2cd)][_0x133979(0x25f)](_0xc68b64,_0x526389);if(!_0x1703d5)return{'redos':[],'undos':[]};const _0x422cb0=new Set(),_0x81d94e={};for(const [_0x8dacb,_0x483c76]of _0x1703d5)_0x422cb0[_0x133979(0x210)](_0x8dacb),_0x81d94e[_0x8dacb]={'config':l[_0x133979(0x28f)]['deepClone'](_0x483c76[_0x133979(0x24a)]),'sparklines':l[_0x133979(0x28f)][_0x133979(0x282)](_0x483c76['sparklines'][_0x133979(0x268)]())};if(_0x422cb0[_0x133979(0x216)])return{'redos':[{'id':O['id'],'params':{'unitId':_0xc68b64,'subUnitId':_0x526389,'groupIds':Array[_0x133979(0x2cc)](_0x422cb0),'isSingle':!0x1}}],'undos':[{'id':T['id'],'params':{'unitId':_0xc68b64,'subUnitId':_0x526389,'sparklineConfigMap':_0x81d94e}}]};}else{if(_0x104365['id']===_['CopySheetCommand']['id']){const _0x2eb32f=_0x104365[_0x133979(0x28b)],{unitId:_0x578f3c,subUnitId:_0x522f76,targetSubUnitId:_0xe0b7de}=_0x2eb32f;if(!_0x578f3c||!_0x522f76||!_0xe0b7de)return{'redos':[],'undos':[]};const _0x32debd=this[_0x133979(0x2cd)][_0x133979(0x25f)](_0x578f3c,_0x522f76);if(!_0x32debd)return{'redos':[],'undos':[]};const _0x316b8e=new Set(),_0x54d85b={};for(const [_0x208658,_0x55b59a]of _0x32debd){const _0x58082b='g_'+l['generateRandomId'](0x6);_0x316b8e[_0x133979(0x210)](_0x208658),_0x54d85b[_0x58082b]={'config':l[_0x133979(0x28f)][_0x133979(0x282)](_0x55b59a[_0x133979(0x24a)]),'sparklines':l[_0x133979(0x28f)]['deepClone'](_0x55b59a[_0x133979(0x21a)]['clone']())};}if(_0x316b8e[_0x133979(0x216)])return{'redos':[{'id':T['id'],'params':{'unitId':_0x578f3c,'subUnitId':_0xe0b7de,'sparklineConfigMap':_0x54d85b}}],'undos':[{'id':O['id'],'params':{'unitId':_0x578f3c,'subUnitId':_0xe0b7de,'groupIds':Array[_0x133979(0x2cc)](_0x316b8e),'isSingle':!0x1}}]};}}return{'redos':[],'undos':[]};}}));}};ce=Qe([Se(0x0,l['Inject'](l[_0x333cc0(0x1ec)])),Se(0x1,l[_0x333cc0(0x271)](_[_0x333cc0(0x27f)])),Se(0x2,l[_0x333cc0(0x271)](exports[_0x333cc0(0x21d)]))],ce);var et=Object[_0x333cc0(0x25b)],tt=(_0x4316d5,_0x23099c,_0x271f12,_0x148ebc)=>{const _0x2081b4=_0x333cc0;for(var _0x5f2993=_0x148ebc>0x1?void 0x0:_0x148ebc?et(_0x23099c,_0x271f12):_0x23099c,_0x6a07a4=_0x4316d5[_0x2081b4(0x26e)]-0x1,_0x151eaa;_0x6a07a4>=0x0;_0x6a07a4--)(_0x151eaa=_0x4316d5[_0x6a07a4])&&(_0x5f2993=_0x151eaa(_0x5f2993)||_0x5f2993);return _0x5f2993;},Ie=(_0x54a666,_0x3da2f8)=>(_0x48c04d,_0x3c3825)=>_0x3da2f8(_0x48c04d,_0x3c3825,_0x54a666);let de=class extends l[_0x333cc0(0x215)]{constructor(_0x5d68eb,_0x539c65){const _0x260ff2=_0x333cc0;super(),this[_0x260ff2(0x290)]=_0x5d68eb,this[_0x260ff2(0x2cd)]=_0x539c65,this[_0x260ff2(0x2b3)]();}[_0x333cc0(0x2b3)](){const _0x515cd1=_0x333cc0,_0x4a9010=_0x2a87d0=>{const _0x468152=_0x9fcb,_0x3db635=this[_0x468152(0x2cd)][_0x468152(0x237)](_0x2a87d0);return _0x3db635?JSON[_0x468152(0x2ca)](_0x3db635):'';},_0x5f1977=_0x5a7a98=>_0x5a7a98?JSON[_0x515cd1(0x265)](_0x5a7a98):{};this[_0x515cd1(0x243)](this['_resourceManagerService'][_0x515cd1(0x2a5)]({'toJson':_0x4a9010,'parseJson':_0x5f1977,'pluginName':me,'businesses':[l['UniverInstanceType'][_0x515cd1(0x1f7)]],'onLoad':(_0x26bcf1,_0x285e9a)=>{const _0x445108=_0x515cd1;this[_0x445108(0x2cd)][_0x445108(0x2bd)](_0x285e9a);},'onUnLoad':_0x2d287c=>{const _0x39646e=_0x515cd1;this[_0x39646e(0x2cd)][_0x39646e(0x1f2)](_0x2d287c);}}));}};de=tt([Ie(0x0,l[_0x333cc0(0x271)](l[_0x333cc0(0x2bb)])),Ie(0x1,l[_0x333cc0(0x271)](exports['SparklineDataSourceModel']))],de);var nt=Object['defineProperty'],rt=Object[_0x333cc0(0x25b)],st=(_0x13a6bd,_0x10cd72,_0x3dd4d5)=>_0x10cd72 in _0x13a6bd?nt(_0x13a6bd,_0x10cd72,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x3dd4d5}):_0x13a6bd[_0x10cd72]=_0x3dd4d5,ot=(_0x30bd63,_0x40637d,_0xc1c95a,_0xf71a6e)=>{const _0x18571e=_0x333cc0;for(var _0x109b23=_0xf71a6e>0x1?void 0x0:_0xf71a6e?rt(_0x40637d,_0xc1c95a):_0x40637d,_0x18e7bf=_0x30bd63[_0x18571e(0x26e)]-0x1,_0xb22271;_0x18e7bf>=0x0;_0x18e7bf--)(_0xb22271=_0x30bd63[_0x18e7bf])&&(_0x109b23=_0xb22271(_0x109b23)||_0x109b23);return _0x109b23;},we=(_0x180d2d,_0x24005e)=>(_0x11a40f,_0x67e5b1)=>_0x24005e(_0x11a40f,_0x67e5b1,_0x180d2d),Te=(_0x4e8c4f,_0x2cdcc2,_0x27b479)=>st(_0x4e8c4f,typeof _0x2cdcc2!=_0x333cc0(0x208)?_0x2cdcc2+'':_0x2cdcc2,_0x27b479);exports[_0x333cc0(0x202)]=class extends l[_0x333cc0(0x249)]{constructor(_0x34ecc4={},_0x3ee19c,_0x211ef2){const _0x2f55b3=_0x333cc0;super(),this[_0x2f55b3(0x241)]=_0x34ecc4,this[_0x2f55b3(0x2d1)]=_0x3ee19c,this[_0x2f55b3(0x1eb)]=_0x211ef2,this[_0x2f55b3(0x20d)](),this[_0x2f55b3(0x291)]();}['_initDependencies'](){const _0x18c74c=_0x333cc0;[[exports['SparklineDataSourceModel']],[oe],[ie],[se],[le],[ae],[ce],[de]][_0x18c74c(0x226)](_0x18b13c=>{const _0x47ec4c=_0x18c74c;this[_0x47ec4c(0x2d1)][_0x47ec4c(0x210)](_0x18b13c);}),l['touchDependencies'](this[_0x18c74c(0x2d1)],[[de]]);}[_0x333cc0(0x2ab)](){const _0x291dea=_0x333cc0;l[_0x291dea(0x266)](this['_injector'],[[oe],[ie],[se],[le],[ae],[ce]]);}[_0x333cc0(0x291)](){const _0x489011=_0x333cc0;[be,T,De,O,Ee,ue][_0x489011(0x226)](_0x3a3161=>this['_commandService'][_0x489011(0x294)](_0x3a3161));}},Te(exports['UniverSheetSparklinePlugin'],'pluginName',me),Te(exports[_0x333cc0(0x202)],_0x333cc0(0x2ce),l['UniverInstanceType']['UNIVER_SHEET']),exports[_0x333cc0(0x202)]=ot([l[_0x333cc0(0x257)](je['UniverLicensePlugin']),we(0x1,l[_0x333cc0(0x271)](l[_0x333cc0(0x1ea)])),we(0x2,l[_0x333cc0(0x271)](l[_0x333cc0(0x209)]))],exports[_0x333cc0(0x202)]),exports[_0x333cc0(0x288)]=be,exports[_0x333cc0(0x25a)]=T,exports[_0x333cc0(0x281)]=me,exports[_0x333cc0(0x225)]=De,exports[_0x333cc0(0x2d5)]=O,exports[_0x333cc0(0x28e)]=Ee,exports[_0x333cc0(0x1f0)]=ue,exports[_0x333cc0(0x284)]=W,exports[_0x333cc0(0x279)]=re,exports[_0x333cc0(0x254)]=Pe,exports[_0x333cc0(0x24d)]=he,exports[_0x333cc0(0x27e)]=Ce,exports[_0x333cc0(0x274)]=Ae,exports['getSparklinePlacement']=ke;