const _0x3632a4=_0x3c15;(function(_0x14c7c9,_0x3569d4){const _0x3bc123=_0x3c15,_0x4169e5=_0x14c7c9();while(!![]){try{const _0x567fd6=-parseInt(_0x3bc123(0x170))/0x1*(parseInt(_0x3bc123(0x194))/0x2)+parseInt(_0x3bc123(0x174))/0x3+parseInt(_0x3bc123(0x18f))/0x4+-parseInt(_0x3bc123(0x18a))/0x5+-parseInt(_0x3bc123(0x19f))/0x6*(parseInt(_0x3bc123(0x17f))/0x7)+-parseInt(_0x3bc123(0x193))/0x8+-parseInt(_0x3bc123(0x198))/0x9*(-parseInt(_0x3bc123(0x192))/0xa);if(_0x567fd6===_0x3569d4)break;else _0x4169e5['push'](_0x4169e5['shift']());}catch(_0x4c870d){_0x4169e5['push'](_0x4169e5['shift']());}}}(_0x148d,0x1cfca));import{SparklineDataSourceModel as _0x290d30,SetSheetSparklineCommand as _0x6b9ec6,RemoveSheetSparklineCommand as _0x586b8e,AddSheetSparklineCommand as _0x2f28ec,SparklineTypeEnum as _0x5135bc}from'@univerjs-pro/sheets-sparkline';import{Inject as _0x57d105,Injector as _0x101fdd,ICommandService as _0xc273ff,Tools as _0x314d3c}from'@univerjs/core';import{FWorksheet as _0x5f1afb}from'@univerjs/sheets/facade';import{FEnum as _0x2bbc9d,FEventName as _0x7a6c5,FUniver as _0xfa3d88}from'@univerjs/core/facade';import{SheetsSelectionsService as _0x3363ab}from'@univerjs/sheets';var z=Object[_0x3632a4(0x18b)],H=(_0x2bc58d,_0x3eecaf,_0x2638b1,_0x10b69e)=>{const _0x3df408=_0x3632a4;for(var _0x3e4790=_0x10b69e>0x1?void 0x0:_0x10b69e?z(_0x3eecaf,_0x2638b1):_0x3eecaf,_0x4e751b=_0x2bc58d[_0x3df408(0x171)]-0x1,_0x31d010;_0x4e751b>=0x0;_0x4e751b--)(_0x31d010=_0x2bc58d[_0x4e751b])&&(_0x3e4790=_0x31d010(_0x3e4790)||_0x3e4790);return _0x3e4790;},V=(_0x5b5c7c,_0x1bf79e)=>(_0x1f234e,_0x135fb6)=>_0x1bf79e(_0x1f234e,_0x135fb6,_0x5b5c7c);let C=class{constructor(_0x1c9310,_0x45f3ba,_0x2779cd,_0x11f2d2,_0x45f992,_0x176804){const _0x28846b=_0x3632a4;this[_0x28846b(0x178)]=_0x1c9310,this[_0x28846b(0x179)]=_0x45f3ba,this[_0x28846b(0x19c)]=_0x2779cd,this['_row']=_0x11f2d2,this[_0x28846b(0x16e)]=_0x45f992,this[_0x28846b(0x168)]=_0x176804;}[_0x3632a4(0x19e)](_0xf4fd6,_0x4f9869){const _0x383de7=_0x3632a4,_0xd93461=this[_0x383de7(0x168)][_0x383de7(0x19b)](_0x290d30),_0x50a814=this[_0x383de7(0x168)]['get'](_0xc273ff),_0x32be86=_0xd93461[_0x383de7(0x169)](this[_0x383de7(0x178)],this['_subUnitId'],this[_0x383de7(0x19c)]);if(!_0x32be86)return;const _0xf39445={'config':_0x32be86,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x383de7(0x19c)],'resetType':_0x383de7(0x191),'sourceRanges':[_0xf4fd6],'targetRanges':[_0x4f9869],'primary':{'startRow':this['_row'],'startColumn':this[_0x383de7(0x16e)],'endRow':this['_row'],'endColumn':this[_0x383de7(0x16e)],'actualRow':this[_0x383de7(0x176)],'actualColumn':this[_0x383de7(0x16e)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x50a814['syncExecuteCommand'](_0x6b9ec6['id'],_0xf39445),this[_0x383de7(0x176)]=_0x4f9869[_0x383de7(0x183)],this[_0x383de7(0x16e)]=_0x4f9869[_0x383de7(0x199)],this;}[_0x3632a4(0x185)](){const _0x84ba1c=_0x3632a4,_0x9d4e55=this[_0x84ba1c(0x168)][_0x84ba1c(0x19b)](_0xc273ff),_0x348d78={'isSingle':!0x0,'ranges':[{'startRow':this[_0x84ba1c(0x176)],'startColumn':this['_col'],'endRow':this[_0x84ba1c(0x176)],'endColumn':this[_0x84ba1c(0x16e)]}]};_0x9d4e55[_0x84ba1c(0x16a)](_0x586b8e['id'],_0x348d78);}};C=H([V(0x5,_0x57d105(_0x101fdd))],C);var q=Object['getOwnPropertyDescriptor'],J=(_0x6c1a43,_0x2bf34c,_0x2f51d3,_0x56983b)=>{const _0x5154b6=_0x3632a4;for(var _0x5ab1af=_0x56983b>0x1?void 0x0:_0x56983b?q(_0x2bf34c,_0x2f51d3):_0x2bf34c,_0x3189ba=_0x6c1a43[_0x5154b6(0x171)]-0x1,_0x5527d0;_0x3189ba>=0x0;_0x3189ba--)(_0x5527d0=_0x6c1a43[_0x3189ba])&&(_0x5ab1af=_0x5527d0(_0x5ab1af)||_0x5ab1af);return _0x5ab1af;},K=(_0x170faa,_0xc36da3)=>(_0x349247,_0x154147)=>_0xc36da3(_0x349247,_0x154147,_0x170faa);let w=class{constructor(_0x27060c,_0x489d2c,_0x2b35c8,_0x15ebef,_0x341f89,_0x363aee){const _0x38ed58=_0x3632a4;this['_unitId']=_0x27060c,this[_0x38ed58(0x179)]=_0x489d2c,this['_groupId']=_0x2b35c8,this[_0x38ed58(0x176)]=_0x15ebef,this[_0x38ed58(0x16e)]=_0x341f89,this[_0x38ed58(0x168)]=_0x363aee;}['changeDataSource'](_0x4bff9c,_0x2b7885){const _0x1e27bf=_0x3632a4,_0x12faea=this[_0x1e27bf(0x168)][_0x1e27bf(0x19b)](_0x290d30),_0x1a1075=this[_0x1e27bf(0x168)][_0x1e27bf(0x19b)](_0xc273ff),_0x28348c=_0x12faea[_0x1e27bf(0x169)](this[_0x1e27bf(0x178)],this[_0x1e27bf(0x179)],this['_groupId']);if(!_0x28348c)return;const _0x3491d5={'config':_0x28348c,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x1e27bf(0x19c)],'resetType':_0x1e27bf(0x173),'sourceRanges':_0x4bff9c,'targetRanges':_0x2b7885,'primary':{'startRow':this[_0x1e27bf(0x176)],'startColumn':this[_0x1e27bf(0x16e)],'endRow':this['_row'],'endColumn':this[_0x1e27bf(0x16e)],'actualRow':this[_0x1e27bf(0x176)],'actualColumn':this[_0x1e27bf(0x16e)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x1a1075[_0x1e27bf(0x16a)](_0x6b9ec6['id'],_0x3491d5),this[_0x1e27bf(0x176)]=_0x2b7885[0x0][_0x1e27bf(0x183)],this[_0x1e27bf(0x16e)]=_0x2b7885[0x0][_0x1e27bf(0x199)],this;}[_0x3632a4(0x165)](){const _0x4b4ae1=_0x3632a4,_0x4b69fe=this['_injector'][_0x4b4ae1(0x19b)](_0xc273ff),_0x4df7d3={'isSingle':!0x1,'ranges':[{'startRow':this[_0x4b4ae1(0x176)],'startColumn':this['_col'],'endRow':this['_row'],'endColumn':this['_col']}]};_0x4b69fe[_0x4b4ae1(0x16a)](_0x586b8e['id'],_0x4df7d3);}[_0x3632a4(0x184)](_0x504138){const _0xaa09e3=_0x3632a4,_0x38eac5=this[_0xaa09e3(0x168)][_0xaa09e3(0x19b)](_0x290d30)['getSparklineById'](this[_0xaa09e3(0x178)],this['_subUnitId'],this[_0xaa09e3(0x19c)]);if(_0x38eac5){const _0x549f04={'config':{'config':_0x504138,'sparklines':_0x38eac5['sparklines']},'isChangeDataSource':!0x1};this[_0xaa09e3(0x168)][_0xaa09e3(0x19b)](_0xc273ff)[_0xaa09e3(0x16a)](_0x6b9ec6['id'],_0x549f04);}return this;}};w=J([K(0x5,_0x57d105(_0x101fdd))],w);class L extends _0x5f1afb{[_0x3632a4(0x19d)](_0x4a8235,_0x24dc6b,_0x55394e){const _0x50e8c3=_0x3632a4;if(this[_0x50e8c3(0x166)][_0x50e8c3(0x16a)](_0x2f28ec['id'],{'sourceRanges':_0x4a8235,'targetRanges':_0x24dc6b,'targetInfo':{'unitId':this['_workbook'][_0x50e8c3(0x161)](),'subUnitId':this[_0x50e8c3(0x190)][_0x50e8c3(0x17e)]()},'config':{'type':_0x55394e}})){const {startRow:_0x514e6e,startColumn:_0x119685}=_0x24dc6b[0x0];return this['getSparklineByCell'](_0x514e6e,_0x119685);}}[_0x3632a4(0x177)](){const _0x2c9c9f=_0x3632a4;return this[_0x2c9c9f(0x168)]['get'](_0x290d30)['getSubUnitSparkline'](this[_0x2c9c9f(0x172)]['getUnitId'](),this[_0x2c9c9f(0x190)][_0x2c9c9f(0x17e)]());}[_0x3632a4(0x164)](_0x1c125f){const _0x522108=_0x3632a4,_0x4ef9a5=this['_injector'][_0x522108(0x19b)](_0x290d30);let _0x5d7b34;for(let _0x5ce62c=0x0;_0x5ce62c<_0x1c125f[_0x522108(0x171)];_0x5ce62c++){const _0x387916=_0x1c125f[_0x5ce62c],{startRow:_0x2fe4eb,endRow:_0xc08f41,startColumn:_0x4cdee4,endColumn:_0x15e77e}=_0x387916;for(let _0x554913=_0x2fe4eb;_0x554913<=_0xc08f41;_0x554913++)for(let _0x4d70c4=_0x4cdee4;_0x4d70c4<=_0x15e77e;_0x4d70c4++){const _0x4b09b8=_0x4ef9a5[_0x522108(0x17c)](this[_0x522108(0x172)]['getUnitId'](),this[_0x522108(0x190)][_0x522108(0x17e)](),_0x554913,_0x4d70c4);if(_0x4b09b8){const _0x47c87f=_0x4ef9a5[_0x522108(0x169)](this['_workbook'][_0x522108(0x161)](),this[_0x522108(0x190)][_0x522108(0x17e)](),_0x4b09b8);if(_0x47c87f){_0x5d7b34=_0x314d3c[_0x522108(0x18c)](_0x47c87f);break;}}}}_0x5d7b34&&this[_0x522108(0x166)][_0x522108(0x16d)](_0x6b9ec6['id'],{'ranges':_0x1c125f,'combine':!0x0,'config':_0x5d7b34,'isChangeDataSource':!0x1});}[_0x3632a4(0x182)](_0x1c7055){const _0x1cbff1=_0x3632a4,_0x213d30=this[_0x1cbff1(0x168)][_0x1cbff1(0x19b)](_0x290d30);let _0x4d5e37;for(let _0x40aa44=0x0;_0x40aa44<_0x1c7055[_0x1cbff1(0x171)];_0x40aa44++){const _0x14ebee=_0x1c7055[_0x40aa44],{startRow:_0x25860a,endRow:_0x56c688,startColumn:_0x63b5ea,endColumn:_0x32d49d}=_0x14ebee;for(let _0x1f6537=_0x25860a;_0x1f6537<=_0x56c688;_0x1f6537++)for(let _0x4e11e0=_0x63b5ea;_0x4e11e0<=_0x32d49d;_0x4e11e0++){const _0x41b357=_0x213d30[_0x1cbff1(0x17c)](this['_workbook']['getUnitId'](),this[_0x1cbff1(0x190)][_0x1cbff1(0x17e)](),_0x1f6537,_0x4e11e0);if(_0x41b357){const _0x43c0e6=_0x213d30[_0x1cbff1(0x169)](this['_workbook'][_0x1cbff1(0x161)](),this['_worksheet'][_0x1cbff1(0x17e)](),_0x41b357);if(_0x43c0e6){_0x4d5e37=_0x314d3c[_0x1cbff1(0x18c)](_0x43c0e6);break;}}}}_0x4d5e37||this[_0x1cbff1(0x166)][_0x1cbff1(0x16d)](_0x6b9ec6['id'],{'ranges':_0x1c7055,'unCombine':!0x0,'config':_0x4d5e37,'isChangeDataSource':!0x1});}[_0x3632a4(0x17d)](_0x270e6f,_0x3b5f39){const _0x38c498=_0x3632a4,_0x1e480a=this[_0x38c498(0x168)][_0x38c498(0x19b)](_0x290d30),_0x44ca34=this['_workbook']['getUnitId'](),_0x51f7bb=this['_worksheet'][_0x38c498(0x17e)](),_0x6b0e67=_0x1e480a['getSparkline'](_0x44ca34,_0x51f7bb,_0x270e6f,_0x3b5f39);if(_0x6b0e67)return this[_0x38c498(0x168)]['createInstance'](C,_0x44ca34,_0x51f7bb,_0x6b0e67,_0x270e6f,_0x3b5f39);}[_0x3632a4(0x188)](_0x9860be,_0x3c9e76){const _0x510224=_0x3632a4,_0x2a241f=this[_0x510224(0x168)][_0x510224(0x19b)](_0x290d30),_0x364859=this[_0x510224(0x172)][_0x510224(0x161)](),_0x598638=this[_0x510224(0x190)]['getSheetId'](),_0x2b6075=_0x2a241f[_0x510224(0x17c)](_0x364859,_0x598638,_0x9860be,_0x3c9e76);if(_0x2b6075)return this[_0x510224(0x168)][_0x510224(0x18e)](w,_0x364859,_0x598638,_0x2b6075,_0x9860be,_0x3c9e76);}}_0x5f1afb['extend'](L);function _0x148d(){const _0xf7d60d=['getAllSubSparkline','_unitId','_subUnitId','fireEvent','extend','getSparkline','getSparklineByCell','getSheetId','91dvdWZx','map','sparklineAnchorMap','unComposeSparkline','startRow','setConfig','removeSparkline','forEach','ranges','getSparklineGroupByCell','_initialize','28735TAGCMe','getOwnPropertyDescriptor','deepClone','add','createInstance','11576uSGgbK','_worksheet','item','126770ZRaPQZ','1041952PgCtTL','2SfDjwm','onCommandExecuted','getValue','params','243VSpaIn','startColumn','SparklineTypeEnum','get','_groupId','addSparkline','changeDataSource','37158jgpSky','getCurrentSelections','getUnitId','range','groupId','composeSparkline','removeSparklineGroup','_commandService','cancel','_injector','getSparklineById','syncExecuteCommand','SheetSparklineChanged','Event','executeCommand','_col','getSparklineCache','200149EtJQvs','length','_workbook','group','570618qbsvDl','isChangeDataSource','_row'];_0x148d=function(){return _0xf7d60d;};return _0x148d();}function _0x3c15(_0x527d4f,_0x28e4f6){_0x527d4f=_0x527d4f-0x160;const _0x148d84=_0x148d();let _0x3c1524=_0x148d84[_0x527d4f];return _0x3c1524;}class Q extends _0x2bbc9d{get[_0x3632a4(0x19a)](){return _0x5135bc;}}_0x2bbc9d[_0x3632a4(0x17b)](Q);class X extends _0x7a6c5{get[_0x3632a4(0x16b)](){const _0xa6017c=_0x3632a4;return _0xa6017c(0x16b);}}_0x7a6c5['extend'](X);class Y extends _0xfa3d88{[_0x3632a4(0x189)](_0x54eebe){const _0x2be940=_0x3632a4,_0x503ac2=_0x54eebe[_0x2be940(0x19b)](_0xc273ff);this['registerEventHandler'](this[_0x2be940(0x16c)][_0x2be940(0x16b)],()=>_0x503ac2[_0x2be940(0x195)](_0xd88e6f=>{const _0x1fe3a9=_0x2be940;var _0x2ac521,_0x448277;if(_0xd88e6f['id']===_0x6b9ec6['id']){const _0x578431=_0xd88e6f[_0x1fe3a9(0x197)];if(!_0x578431[_0x1fe3a9(0x175)]){const _0x53b082=this['getActiveWorkbook'](),_0x526b37=_0x53b082==null?void 0x0:_0x53b082['getActiveSheet']();if(!_0x53b082||!_0x526b37)return;const _0x2f2558=_0x53b082['getId'](),_0x2da5d2=_0x526b37['getSheetId'](),_0x46d079=this['_injector']['get'](_0x3363ab),_0x1c76b2=this['_injector']['get'](_0x290d30),_0x523131=(_0x2ac521=_0x578431==null?void 0x0:_0x578431[_0x1fe3a9(0x187)])!=null?_0x2ac521:_0x46d079[_0x1fe3a9(0x160)]()['map'](_0x3df4ec=>_0x3df4ec[_0x1fe3a9(0x162)]),_0xc24819=(_0x448277=_0x1c76b2[_0x1fe3a9(0x16f)]()[_0x1fe3a9(0x181)]['get'](_0x2f2558))==null?void 0x0:_0x448277[_0x1fe3a9(0x19b)](_0x2da5d2),_0x238e05=new Set();_0x523131[_0x1fe3a9(0x186)](_0x5d90a4=>{const _0x34465b=_0x1fe3a9;var _0xdbaacb;const {startRow:_0x35e4f8,endRow:_0x342449,startColumn:_0x314426,endColumn:_0x2e83de}=_0x5d90a4;for(let _0x4f3448=_0x35e4f8;_0x4f3448<=_0x342449;_0x4f3448++)for(let _0x55e2f4=_0x314426;_0x55e2f4<=_0x2e83de;_0x55e2f4++){const _0x1be475=(_0xdbaacb=_0xc24819==null?void 0x0:_0xc24819['matrix'][_0x34465b(0x196)](_0x4f3448,_0x55e2f4))==null?void 0x0:_0xdbaacb[_0x34465b(0x163)];_0x1be475&&_0x238e05[_0x34465b(0x18d)](_0x1be475);}});const _0x425569=Array['from'](_0x238e05)[_0x1fe3a9(0x180)](_0x4f53ab=>_0x1c76b2[_0x1fe3a9(0x169)](_0x2f2558,_0x2da5d2,_0x4f53ab))['filter'](_0x41daad=>!!_0x41daad),_0x589ef5={'workbook':_0x53b082,'worksheet':_0x526b37,'sparklines':_0x425569};if(this[_0x1fe3a9(0x17a)](this[_0x1fe3a9(0x16c)]['SheetSparklineChanged'],_0x589ef5),_0x589ef5[_0x1fe3a9(0x167)])throw new Error('Sheet\x20create\x20canceled\x20by\x20facade\x20api.');}}}));}}_0xfa3d88[_0x3632a4(0x17b)](Y);export{C as FSparkline,w as FSparklineGroup};