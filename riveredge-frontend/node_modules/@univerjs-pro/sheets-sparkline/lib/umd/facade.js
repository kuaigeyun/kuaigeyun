(function(_0x48230a,_0x206882){const _0x17e2da=_0x19e0,_0x1e9a97=_0x48230a();while(!![]){try{const _0x39ccf0=-parseInt(_0x17e2da(0x1b6))/0x1*(parseInt(_0x17e2da(0x1ef))/0x2)+parseInt(_0x17e2da(0x1a7))/0x3*(-parseInt(_0x17e2da(0x1cb))/0x4)+-parseInt(_0x17e2da(0x1dc))/0x5*(parseInt(_0x17e2da(0x1de))/0x6)+-parseInt(_0x17e2da(0x1a5))/0x7+parseInt(_0x17e2da(0x19b))/0x8+parseInt(_0x17e2da(0x1a8))/0x9*(-parseInt(_0x17e2da(0x1a4))/0xa)+parseInt(_0x17e2da(0x1c7))/0xb;if(_0x39ccf0===_0x206882)break;else _0x1e9a97['push'](_0x1e9a97['shift']());}catch(_0x4ced66){_0x1e9a97['push'](_0x1e9a97['shift']());}}}(_0x1769,0xa546b),function(_0x4ff819,_0xf458ce){const _0x422a1f=_0x19e0;typeof exports==_0x422a1f(0x1e3)&&typeof module<'u'?_0xf458ce(exports,require('@univerjs-pro/sheets-sparkline'),require('@univerjs/core'),require('@univerjs/sheets/facade'),require('@univerjs/core/facade'),require('@univerjs/sheets')):typeof define==_0x422a1f(0x1aa)&&define[_0x422a1f(0x1d5)]?define([_0x422a1f(0x1c1),_0x422a1f(0x1b8),_0x422a1f(0x1cf),_0x422a1f(0x1d4),_0x422a1f(0x1e2),_0x422a1f(0x1a0)],_0xf458ce):(_0x4ff819=typeof globalThis<'u'?globalThis:_0x4ff819||self,_0xf458ce(_0x4ff819[_0x422a1f(0x1b4)]={},_0x4ff819[_0x422a1f(0x1bb)],_0x4ff819[_0x422a1f(0x1ec)],_0x4ff819[_0x422a1f(0x1c0)],_0x4ff819[_0x422a1f(0x1a9)],_0x4ff819['UniverSheets']));}(this,function(_0x4683f7,_0x18f6d8,_0x3b3bca,_0x5c7e7f,_0x2a60a1,_0x5488f2){'use strict';const _0x59c838=_0x19e0;var _0x3d2413=Object[_0x59c838(0x1cc)],_0x20974a=(_0x452101,_0x25ee7f,_0x468c56,_0x971d66)=>{for(var _0x426a35=_0x971d66>0x1?void 0x0:_0x971d66?_0x3d2413(_0x25ee7f,_0x468c56):_0x25ee7f,_0x34814b=_0x452101['length']-0x1,_0x1896c4;_0x34814b>=0x0;_0x34814b--)(_0x1896c4=_0x452101[_0x34814b])&&(_0x426a35=_0x1896c4(_0x426a35)||_0x426a35);return _0x426a35;},_0x22fb4b=(_0x5e7135,_0x47abdf)=>(_0x234162,_0x385b18)=>_0x47abdf(_0x234162,_0x385b18,_0x5e7135);_0x4683f7[_0x59c838(0x1da)]=class{constructor(_0x9ebd91,_0x194f21,_0xb9436d,_0x20a787,_0x5734a4,_0xe5f190){const _0x571a95=_0x59c838;this['_unitId']=_0x9ebd91,this['_subUnitId']=_0x194f21,this[_0x571a95(0x1be)]=_0xb9436d,this[_0x571a95(0x1f1)]=_0x20a787,this[_0x571a95(0x1a1)]=_0x5734a4,this[_0x571a95(0x1e9)]=_0xe5f190;}[_0x59c838(0x1ce)](_0x569777,_0x4c518f){const _0x3e4975=_0x59c838,_0x5eab25=this[_0x3e4975(0x1e9)][_0x3e4975(0x1ed)](_0x18f6d8[_0x3e4975(0x1bf)]),_0x21a349=this['_injector'][_0x3e4975(0x1ed)](_0x3b3bca[_0x3e4975(0x1e7)]),_0xb860f8=_0x5eab25['getSparklineById'](this[_0x3e4975(0x1c6)],this[_0x3e4975(0x1d3)],this[_0x3e4975(0x1be)]);if(!_0xb860f8)return;const _0x39dcff={'config':_0xb860f8,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x3e4975(0x1be)],'resetType':_0x3e4975(0x1c2),'sourceRanges':[_0x569777],'targetRanges':[_0x4c518f],'primary':{'startRow':this[_0x3e4975(0x1f1)],'startColumn':this[_0x3e4975(0x1a1)],'endRow':this['_row'],'endColumn':this[_0x3e4975(0x1a1)],'actualRow':this[_0x3e4975(0x1f1)],'actualColumn':this[_0x3e4975(0x1a1)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x21a349['syncExecuteCommand'](_0x18f6d8[_0x3e4975(0x1d1)]['id'],_0x39dcff),this[_0x3e4975(0x1f1)]=_0x4c518f['startRow'],this[_0x3e4975(0x1a1)]=_0x4c518f[_0x3e4975(0x1d8)],this;}[_0x59c838(0x1c9)](){const _0xea4f16=_0x59c838,_0x12fbe4=this[_0xea4f16(0x1e9)]['get'](_0x3b3bca[_0xea4f16(0x1e7)]),_0x3607c9={'isSingle':!0x0,'ranges':[{'startRow':this[_0xea4f16(0x1f1)],'startColumn':this[_0xea4f16(0x1a1)],'endRow':this[_0xea4f16(0x1f1)],'endColumn':this['_col']}]};_0x12fbe4[_0xea4f16(0x1c5)](_0x18f6d8[_0xea4f16(0x1ad)]['id'],_0x3607c9);}},_0x4683f7['FSparkline']=_0x20974a([_0x22fb4b(0x5,_0x3b3bca[_0x59c838(0x1b7)](_0x3b3bca['Injector']))],_0x4683f7['FSparkline']);var _0x429a07=Object[_0x59c838(0x1cc)],_0x4e6aa8=(_0x1a4eee,_0xa0f242,_0x2af7fb,_0x41787e)=>{const _0x2f8d05=_0x59c838;for(var _0x44ca59=_0x41787e>0x1?void 0x0:_0x41787e?_0x429a07(_0xa0f242,_0x2af7fb):_0xa0f242,_0x241ff3=_0x1a4eee[_0x2f8d05(0x1c3)]-0x1,_0x2310b7;_0x241ff3>=0x0;_0x241ff3--)(_0x2310b7=_0x1a4eee[_0x241ff3])&&(_0x44ca59=_0x2310b7(_0x44ca59)||_0x44ca59);return _0x44ca59;},_0x1fcd6b=(_0x490855,_0x34c6bb)=>(_0x3caca2,_0x2a0e98)=>_0x34c6bb(_0x3caca2,_0x2a0e98,_0x490855);_0x4683f7[_0x59c838(0x1d0)]=class{constructor(_0x18c862,_0xcb8a33,_0x39cc9e,_0x11aa6b,_0x4acac5,_0x2ea4ec){const _0x24738d=_0x59c838;this[_0x24738d(0x1c6)]=_0x18c862,this[_0x24738d(0x1d3)]=_0xcb8a33,this[_0x24738d(0x1be)]=_0x39cc9e,this[_0x24738d(0x1f1)]=_0x11aa6b,this[_0x24738d(0x1a1)]=_0x4acac5,this[_0x24738d(0x1e9)]=_0x2ea4ec;}['changeDataSource'](_0x1c967c,_0x512e9a){const _0x236bdf=_0x59c838,_0x4e1a09=this['_injector']['get'](_0x18f6d8[_0x236bdf(0x1bf)]),_0x4f2f30=this[_0x236bdf(0x1e9)][_0x236bdf(0x1ed)](_0x3b3bca[_0x236bdf(0x1e7)]),_0x2df060=_0x4e1a09['getSparklineById'](this[_0x236bdf(0x1c6)],this[_0x236bdf(0x1d3)],this[_0x236bdf(0x1be)]);if(!_0x2df060)return;const _0x533c3e={'config':_0x2df060,'isChangeDataSource':!0x0,'changeDataSourceInfo':{'groupId':this[_0x236bdf(0x1be)],'resetType':'group','sourceRanges':_0x1c967c,'targetRanges':_0x512e9a,'primary':{'startRow':this[_0x236bdf(0x1f1)],'startColumn':this[_0x236bdf(0x1a1)],'endRow':this[_0x236bdf(0x1f1)],'endColumn':this[_0x236bdf(0x1a1)],'actualRow':this[_0x236bdf(0x1f1)],'actualColumn':this[_0x236bdf(0x1a1)],'isMerged':!0x1,'isMergedMainCell':!0x1}}};return _0x4f2f30['syncExecuteCommand'](_0x18f6d8[_0x236bdf(0x1d1)]['id'],_0x533c3e),this[_0x236bdf(0x1f1)]=_0x512e9a[0x0]['startRow'],this[_0x236bdf(0x1a1)]=_0x512e9a[0x0][_0x236bdf(0x1d8)],this;}[_0x59c838(0x1e1)](){const _0x2970ae=_0x59c838,_0x5784a1=this[_0x2970ae(0x1e9)][_0x2970ae(0x1ed)](_0x3b3bca['ICommandService']),_0x23c2d6={'isSingle':!0x1,'ranges':[{'startRow':this[_0x2970ae(0x1f1)],'startColumn':this['_col'],'endRow':this[_0x2970ae(0x1f1)],'endColumn':this[_0x2970ae(0x1a1)]}]};_0x5784a1['syncExecuteCommand'](_0x18f6d8[_0x2970ae(0x1ad)]['id'],_0x23c2d6);}[_0x59c838(0x1df)](_0x2dcaa0){const _0x32fb7e=_0x59c838,_0x4c0250=this[_0x32fb7e(0x1e9)][_0x32fb7e(0x1ed)](_0x18f6d8['SparklineDataSourceModel'])[_0x32fb7e(0x1ee)](this[_0x32fb7e(0x1c6)],this[_0x32fb7e(0x1d3)],this[_0x32fb7e(0x1be)]);if(_0x4c0250){const _0x3fae43={'config':{'config':_0x2dcaa0,'sparklines':_0x4c0250[_0x32fb7e(0x1d6)]},'isChangeDataSource':!0x1};this['_injector'][_0x32fb7e(0x1ed)](_0x3b3bca[_0x32fb7e(0x1e7)])[_0x32fb7e(0x1c5)](_0x18f6d8[_0x32fb7e(0x1d1)]['id'],_0x3fae43);}return this;}},_0x4683f7[_0x59c838(0x1d0)]=_0x4e6aa8([_0x1fcd6b(0x5,_0x3b3bca['Inject'](_0x3b3bca['Injector']))],_0x4683f7[_0x59c838(0x1d0)]);class _0x5220a8 extends _0x5c7e7f[_0x59c838(0x1d7)]{[_0x59c838(0x1ac)](_0x48b093,_0xd26665,_0xd897d4){const _0x268bf8=_0x59c838;if(this[_0x268bf8(0x1b9)]['syncExecuteCommand'](_0x18f6d8['AddSheetSparklineCommand']['id'],{'sourceRanges':_0x48b093,'targetRanges':_0xd26665,'targetInfo':{'unitId':this[_0x268bf8(0x196)][_0x268bf8(0x19f)](),'subUnitId':this[_0x268bf8(0x1cd)][_0x268bf8(0x1ab)]()},'config':{'type':_0xd897d4}})){const {startRow:_0x418620,startColumn:_0x4a8762}=_0xd26665[0x0];return this[_0x268bf8(0x1dd)](_0x418620,_0x4a8762);}}[_0x59c838(0x1c8)](){const _0x21d50a=_0x59c838;return this[_0x21d50a(0x1e9)][_0x21d50a(0x1ed)](_0x18f6d8[_0x21d50a(0x1bf)])[_0x21d50a(0x1db)](this['_workbook'][_0x21d50a(0x19f)](),this['_worksheet']['getSheetId']());}[_0x59c838(0x1bd)](_0x13d7da){const _0xf99ec7=_0x59c838,_0x7a9672=this[_0xf99ec7(0x1e9)][_0xf99ec7(0x1ed)](_0x18f6d8[_0xf99ec7(0x1bf)]);let _0x2e2037;for(let _0x4c4a80=0x0;_0x4c4a80<_0x13d7da[_0xf99ec7(0x1c3)];_0x4c4a80++){const _0x4b9d10=_0x13d7da[_0x4c4a80],{startRow:_0x2c6249,endRow:_0x547a08,startColumn:_0x5cdd52,endColumn:_0x1c829b}=_0x4b9d10;for(let _0x3271f8=_0x2c6249;_0x3271f8<=_0x547a08;_0x3271f8++)for(let _0x3170a1=_0x5cdd52;_0x3170a1<=_0x1c829b;_0x3170a1++){const _0x26f345=_0x7a9672[_0xf99ec7(0x1a2)](this[_0xf99ec7(0x196)][_0xf99ec7(0x19f)](),this[_0xf99ec7(0x1cd)][_0xf99ec7(0x1ab)](),_0x3271f8,_0x3170a1);if(_0x26f345){const _0x24b770=_0x7a9672[_0xf99ec7(0x1ee)](this[_0xf99ec7(0x196)][_0xf99ec7(0x19f)](),this[_0xf99ec7(0x1cd)][_0xf99ec7(0x1ab)](),_0x26f345);if(_0x24b770){_0x2e2037=_0x3b3bca[_0xf99ec7(0x1b0)][_0xf99ec7(0x19c)](_0x24b770);break;}}}}_0x2e2037&&this[_0xf99ec7(0x1b9)][_0xf99ec7(0x1b2)](_0x18f6d8[_0xf99ec7(0x1d1)]['id'],{'ranges':_0x13d7da,'combine':!0x0,'config':_0x2e2037,'isChangeDataSource':!0x1});}[_0x59c838(0x1e6)](_0x2fd0e9){const _0x14edcc=_0x59c838,_0x48c061=this[_0x14edcc(0x1e9)][_0x14edcc(0x1ed)](_0x18f6d8[_0x14edcc(0x1bf)]);let _0x320814;for(let _0x17744d=0x0;_0x17744d<_0x2fd0e9[_0x14edcc(0x1c3)];_0x17744d++){const _0x14ffb6=_0x2fd0e9[_0x17744d],{startRow:_0x5dfb6d,endRow:_0xedfed,startColumn:_0x1bb99e,endColumn:_0x42b63d}=_0x14ffb6;for(let _0x4dbde6=_0x5dfb6d;_0x4dbde6<=_0xedfed;_0x4dbde6++)for(let _0x1eb76d=_0x1bb99e;_0x1eb76d<=_0x42b63d;_0x1eb76d++){const _0x2f01b5=_0x48c061['getSparkline'](this['_workbook']['getUnitId'](),this[_0x14edcc(0x1cd)][_0x14edcc(0x1ab)](),_0x4dbde6,_0x1eb76d);if(_0x2f01b5){const _0x147c18=_0x48c061[_0x14edcc(0x1ee)](this[_0x14edcc(0x196)][_0x14edcc(0x19f)](),this[_0x14edcc(0x1cd)]['getSheetId'](),_0x2f01b5);if(_0x147c18){_0x320814=_0x3b3bca[_0x14edcc(0x1b0)][_0x14edcc(0x19c)](_0x147c18);break;}}}}_0x320814||this[_0x14edcc(0x1b9)][_0x14edcc(0x1b2)](_0x18f6d8['SetSheetSparklineCommand']['id'],{'ranges':_0x2fd0e9,'unCombine':!0x0,'config':_0x320814,'isChangeDataSource':!0x1});}[_0x59c838(0x1dd)](_0x2ed023,_0x134c9b){const _0x2f25f7=_0x59c838,_0x7872c6=this[_0x2f25f7(0x1e9)]['get'](_0x18f6d8[_0x2f25f7(0x1bf)]),_0x21b16f=this['_workbook']['getUnitId'](),_0x31b844=this[_0x2f25f7(0x1cd)][_0x2f25f7(0x1ab)](),_0x38004b=_0x7872c6['getSparkline'](_0x21b16f,_0x31b844,_0x2ed023,_0x134c9b);if(_0x38004b)return this[_0x2f25f7(0x1e9)][_0x2f25f7(0x1eb)](_0x4683f7['FSparkline'],_0x21b16f,_0x31b844,_0x38004b,_0x2ed023,_0x134c9b);}[_0x59c838(0x1a3)](_0x1b0949,_0x57a6d0){const _0xfff46=_0x59c838,_0x4d28b1=this[_0xfff46(0x1e9)][_0xfff46(0x1ed)](_0x18f6d8[_0xfff46(0x1bf)]),_0x513c09=this['_workbook'][_0xfff46(0x19f)](),_0x2f4e9a=this[_0xfff46(0x1cd)]['getSheetId'](),_0x12f925=_0x4d28b1[_0xfff46(0x1a2)](_0x513c09,_0x2f4e9a,_0x1b0949,_0x57a6d0);if(_0x12f925)return this[_0xfff46(0x1e9)]['createInstance'](_0x4683f7[_0xfff46(0x1d0)],_0x513c09,_0x2f4e9a,_0x12f925,_0x1b0949,_0x57a6d0);}}_0x5c7e7f[_0x59c838(0x1d7)][_0x59c838(0x1bc)](_0x5220a8);class _0x36b4e5 extends _0x2a60a1[_0x59c838(0x1e0)]{get[_0x59c838(0x1e4)](){const _0x3636a3=_0x59c838;return _0x18f6d8[_0x3636a3(0x1e4)];}}_0x2a60a1[_0x59c838(0x1e0)]['extend'](_0x36b4e5);class _0x4b5398 extends _0x2a60a1['FEventName']{get['SheetSparklineChanged'](){const _0x2d1c6c=_0x59c838;return _0x2d1c6c(0x199);}}_0x2a60a1[_0x59c838(0x1a6)][_0x59c838(0x1bc)](_0x4b5398);class _0x2d636b extends _0x2a60a1['FUniver']{['_initialize'](_0x21f993){const _0x1ccac2=_0x59c838,_0x108e07=_0x21f993[_0x1ccac2(0x1ed)](_0x3b3bca['ICommandService']);this[_0x1ccac2(0x1b1)](this[_0x1ccac2(0x1c4)][_0x1ccac2(0x199)],()=>_0x108e07[_0x1ccac2(0x1d2)](_0x2204c2=>{const _0x5f8e87=_0x1ccac2;var _0x347b11,_0x2737a0;if(_0x2204c2['id']===_0x18f6d8[_0x5f8e87(0x1d1)]['id']){const _0x89214f=_0x2204c2['params'];if(!_0x89214f['isChangeDataSource']){const _0x574093=this[_0x5f8e87(0x19a)](),_0x55378d=_0x574093==null?void 0x0:_0x574093['getActiveSheet']();if(!_0x574093||!_0x55378d)return;const _0x28c350=_0x574093[_0x5f8e87(0x19e)](),_0x327cca=_0x55378d[_0x5f8e87(0x1ab)](),_0x559e47=this[_0x5f8e87(0x1e9)][_0x5f8e87(0x1ed)](_0x5488f2[_0x5f8e87(0x1d9)]),_0x6b49d4=this['_injector']['get'](_0x18f6d8['SparklineDataSourceModel']),_0x33bb1e=(_0x347b11=_0x89214f==null?void 0x0:_0x89214f[_0x5f8e87(0x1f0)])!=null?_0x347b11:_0x559e47['getCurrentSelections']()[_0x5f8e87(0x1ba)](_0x190513=>_0x190513['range']),_0xf55233=(_0x2737a0=_0x6b49d4[_0x5f8e87(0x1e8)]()[_0x5f8e87(0x1af)][_0x5f8e87(0x1ed)](_0x28c350))==null?void 0x0:_0x2737a0['get'](_0x327cca),_0x2c26b1=new Set();_0x33bb1e['forEach'](_0x4acc00=>{const _0x3d890e=_0x5f8e87;var _0x24903e;const {startRow:_0xf6f178,endRow:_0x3bdea3,startColumn:_0x321d5a,endColumn:_0xc65f74}=_0x4acc00;for(let _0x1d3c9e=_0xf6f178;_0x1d3c9e<=_0x3bdea3;_0x1d3c9e++)for(let _0x30c071=_0x321d5a;_0x30c071<=_0xc65f74;_0x30c071++){const _0x4cb071=(_0x24903e=_0xf55233==null?void 0x0:_0xf55233['matrix'][_0x3d890e(0x1b3)](_0x1d3c9e,_0x30c071))==null?void 0x0:_0x24903e[_0x3d890e(0x1b5)];_0x4cb071&&_0x2c26b1['add'](_0x4cb071);}});const _0x7e95b7=Array['from'](_0x2c26b1)['map'](_0x48ef76=>_0x6b49d4[_0x5f8e87(0x1ee)](_0x28c350,_0x327cca,_0x48ef76))['filter'](_0x54963e=>!!_0x54963e),_0xe6f68f={'workbook':_0x574093,'worksheet':_0x55378d,'sparklines':_0x7e95b7};if(this[_0x5f8e87(0x1ca)](this[_0x5f8e87(0x1c4)]['SheetSparklineChanged'],_0xe6f68f),_0xe6f68f[_0x5f8e87(0x1ea)])throw new Error(_0x5f8e87(0x1e5));}}}));}}_0x2a60a1[_0x59c838(0x1ae)]['extend'](_0x2d636b),Object[_0x59c838(0x197)](_0x4683f7,Symbol[_0x59c838(0x198)],{'value':_0x59c838(0x19d)});}));function _0x19e0(_0x129b31,_0x336180){_0x129b31=_0x129b31-0x196;const _0x176919=_0x1769();let _0x19e09f=_0x176919[_0x129b31];return _0x19e09f;}function _0x1769(){const _0x4e9747=['removeSparklineGroup','@univerjs/core/facade','object','SparklineTypeEnum','Sheet\x20create\x20canceled\x20by\x20facade\x20api.','unComposeSparkline','ICommandService','getSparklineCache','_injector','cancel','createInstance','UniverCore','get','getSparklineById','858814MektYp','ranges','_row','_workbook','defineProperty','toStringTag','SheetSparklineChanged','getActiveWorkbook','3201496ykABWx','deepClone','Module','getId','getUnitId','@univerjs/sheets','_col','getSparkline','getSparklineGroupByCell','10wiLQks','830851BggjxL','FEventName','321EQmugd','9449577pOFmbv','UniverCoreFacade','function','getSheetId','addSparkline','RemoveSheetSparklineCommand','FUniver','sparklineAnchorMap','Tools','registerEventHandler','executeCommand','getValue','UniverProSheetsSparklineFacade','groupId','3BwWsbK','Inject','@univerjs-pro/sheets-sparkline','_commandService','map','UniverProSheetsSparkline','extend','composeSparkline','_groupId','SparklineDataSourceModel','UniverSheetsFacade','exports','item','length','Event','syncExecuteCommand','_unitId','44258170ICYIzq','getAllSubSparkline','removeSparkline','fireEvent','7644xjuNyW','getOwnPropertyDescriptor','_worksheet','changeDataSource','@univerjs/core','FSparklineGroup','SetSheetSparklineCommand','onCommandExecuted','_subUnitId','@univerjs/sheets/facade','amd','sparklines','FWorksheet','startColumn','SheetsSelectionsService','FSparkline','getSubUnitSparkline','42730vftsSD','getSparklineByCell','762qvkLNF','setConfig','FEnum'];_0x1769=function(){return _0x4e9747;};return _0x1769();}