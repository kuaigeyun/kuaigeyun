function _0x5592(){const _0x3e0d79=['_sparklineAnchorMap','SetColVisibleMutation','190100PQZaFS','getCurrentUnitOfType','Injector','UniverSheets','registerCommand','SPACING','clearSparklineCache','pushUndoRedo','getRowVisible','ReorderRangeMutation','value','values','_initExclusiveRangeChange','negativePoint','exports','CUSTOM_EXTREMUM','u-spacing','startColumn','SetSheetSparklineMutation','min','cellToRange','rgb(252,117,60)','markersPoint','sheet.command.remove-sparkline','sparklines','custom','PIE_CHART','getUnitId','getSheetId','registerRefRange','deepClone','SheetInterceptorService','_initMergeWithSparkline','asObservable','setValue','NORMAL','DisposableCollection','SPECIALTY','getSparkline','SparklineExtremumTypeEnum','onCommandExecuted','@univerjs/core','toJSON','unitId','_initSnapshot','sparklineModel','IUniverInstanceService','specialty','_injector','809328ioOQHH','addSparkline','rgb(124,66,147)','SpacialShowAsEnum','clone','amd','225NjyCue','disposeWithMe','RemoveRowCommand','getCurrentSelections','next','SELF_EXTREMUM','BAR_CHART','getOwnPropertyDescriptor','set','RANGE_TYPE','u-connect','delete','_resourceManagerService','forEach','themeType','RemoveSheetSparklineCommand','CommandType','sheet.mutation.set-sparkline','AddSheetSparklineMutation','size','soft','_getRefRangeMutationsByDeleteCols','UNIVER_SHEET','forValue','matrix','foreach','154oEQnNS','SheetsSelectionsService','_initCorrectRangeWithSparkline','lowPoint','map','_getRefRangeMutationsByDeleteRows','SetSheetSparklineCommand','actualRow','number','removeColumns','object','getSubUnitSparkline','connect_with_line','_initDataChangeListener','touchDependencies','interceptCommand','remove','SparklineThemeTypeEnum','_initHideRowColWithSparkline','defineProperty','SparklinePointsNames','RemoveRowMutation','_sheetSelectionService','push','1805886TOzBYo','UniverInstanceType','sheet.command.set-sparkline','rgb(30,177,189)','LINE_CHART','spacing','pluginName','sheet.mutation.remove-sparkline','1605457NmbBHk','8ghamiL','reBuildAnchorCache','updateConfig$','generateRandomId','228279kBSNqh','SetWorksheetActivateCommand','UniverCore','RemoveColCommand','removeRows','length','IUndoRedoService','removeSparkline','MoveRangeMutation','InsertColMutation','RemoveColMutation','_sparklineModel','sequenceExecute','endRow','@univerjs-pro/license','RemoveSheetCommand','seriesColor','range','MUTATION','PLUGIN_NAME','ranges','moveColumns','getSparklineCache','extremumMax','setSparkline','add','Tools','_sheetInterceptorService','_updateConfig$','1528fkJmAO','26334XUuwWo','_exclusiveRangeService','_sparklineDataSourceModel','rgb(46,187,122)','from','_initSheetChange','MAX_SAFE_INTEGER','_commandService','_ensureConfigMap','Rectangle','SparklineThemeMapping','ICommandService','getMatrix','getSizeOf','SHEET_SPARKLINE_PLUGIN','function','Disposable','MIN_SAFE_INTEGER','SparklineDataSourceModel','_onRefRangeChange','UniverProLicense','rxjs','getCurrentUnitForType','endColumn','ColorKit','registerPluginResource','Module','STANDARD','getSparklinePlacement','FRESH','exclusiveRangesChange$','ZERO_VALUE','CellValueType','_initRegisterCommand','COMMAND','intersects','firstPoint','DependentOn','getColVisible','SOFT','item','column','nonNumShowAs','IResourceManagerService','every','getCellRaw','symbol','_refRangeService','realDeleteValue','AddWorksheetMergeCommand','MoveRowsMutation','highPoint','extremumMin','contains','getSheetCommandTarget','updateSparklineExtraNum','config','max','Subject','getSheetBySheetId','startRow','getValue','UniverSheetSparklinePlugin','has','_univerInstanceService','adjustRangeOnMutation','getCell','distinctive','assign','sparklineAnchorMap','parse','_initClearWithSparkline','BOOLEAN','_ensureAnchorMatrix','SetRowHiddenMutation','params','rgb(248,190,21)','standard','removePartSparkline','get','keys','Range','disposableCollection','Inject','_initDependencies','subscribe','sheet.mutation.add-sparkline','IExclusiveRangeService','rgb(80,102,248)','RefRangeService','toRgbString','STRING','row','MoveColsMutation','CUSTOM','getActiveSheet','entries','rgb(54,78,244)','hasValue','stringify','NUMBER','ObjectMatrix','type','subUnitId','groupId','rgb(49,106,246)','toStringTag','getSparklineById','2868PhBOMW','GROUP_EXTREMUM','Plugin','rgb(236,100,169)','SetColHiddenMutation','deleteUnit','SetRowVisibleMutation','SparklineTypeEnum','CONNECT_WITH_LINE'];_0x5592=function(){return _0x3e0d79;};return _0x5592();}function _0xce16(_0x51da67,_0x2b7e48){_0x51da67=_0x51da67-0x182;const _0x5592e5=_0x5592();let _0xce1693=_0x5592e5[_0x51da67];return _0xce1693;}(function(_0x5bc5a8,_0x4f0df5){const _0x534e6a=_0xce16,_0xe856df=_0x5bc5a8();while(!![]){try{const _0x179c5a=parseInt(_0x534e6a(0x182))/0x1+parseInt(_0x534e6a(0x248))/0x2+-parseInt(_0x534e6a(0x20c))/0x3*(parseInt(_0x534e6a(0x19f))/0x4)+-parseInt(_0x534e6a(0x24e))/0x5*(-parseInt(_0x534e6a(0x1a0))/0x6)+-parseInt(_0x534e6a(0x288))/0x7*(-parseInt(_0x534e6a(0x289))/0x8)+-parseInt(_0x534e6a(0x280))/0x9+parseInt(_0x534e6a(0x217))/0xa*(-parseInt(_0x534e6a(0x268))/0xb);if(_0x179c5a===_0x4f0df5)break;else _0xe856df['push'](_0xe856df['shift']());}catch(_0x18f488){_0xe856df['push'](_0xe856df['shift']());}}}(_0x5592,0x379e5),function(_0x433b52,_0x32a1e5){const _0xa40803=_0xce16;typeof exports==_0xa40803(0x272)&&typeof module<'u'?_0x32a1e5(exports,require('@univerjs/core'),require('@univerjs/sheets'),require('rxjs'),require('@univerjs-pro/license')):typeof define==_0xa40803(0x1af)&&define[_0xa40803(0x24d)]?define([_0xa40803(0x225),_0xa40803(0x240),'@univerjs/sheets',_0xa40803(0x1b5),_0xa40803(0x190)],_0x32a1e5):(_0x433b52=typeof globalThis<'u'?globalThis:_0x433b52||self,_0x32a1e5(_0x433b52['UniverProSheetsSparkline']={},_0x433b52[_0xa40803(0x184)],_0x433b52[_0xa40803(0x21a)],_0x433b52[_0xa40803(0x1b5)],_0x433b52[_0xa40803(0x1b4)]));}(this,function(_0x12f13f,_0x381950,_0x3292ab,_0x39b1e3,_0x2e3fa5){'use strict';const _0x17e5c7=_0xce16;var _0x72809b=Object['defineProperty'],_0x29a823=(_0x622fb1,_0x2ed7f6,_0x443990)=>_0x2ed7f6 in _0x622fb1?_0x72809b(_0x622fb1,_0x2ed7f6,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x443990}):_0x622fb1[_0x2ed7f6]=_0x443990,_0x46cdd1=(_0x5458ac,_0x5cbba7,_0x33fbcd)=>_0x29a823(_0x5458ac,typeof _0x5cbba7!='symbol'?_0x5cbba7+'':_0x5cbba7,_0x33fbcd);function _0x492f8f(_0x4272ff,_0x4d2c24){const _0x9eaf3b=_0xce16,_0x5a9d8b=new _0x381950['ObjectMatrix'](),_0x4917a9=[],_0x574e65=_0x4272ff[_0x9eaf3b(0x187)]>0x1;let _0x13c402=0x0,_0x59a45e=0x0;for(const _0x1cb321 of _0x4272ff)_0x13c402+=_0x1cb321['endRow']-_0x1cb321[_0x9eaf3b(0x1dc)]+0x1,_0x59a45e+=_0x1cb321[_0x9eaf3b(0x1b7)]-_0x1cb321[_0x9eaf3b(0x228)]+0x1;for(const _0x5a9a9c of _0x4d2c24)for(let _0x37f86d=_0x5a9a9c['startRow'];_0x37f86d<=_0x5a9a9c[_0x9eaf3b(0x18f)];_0x37f86d++)for(let _0x546da1=_0x5a9a9c[_0x9eaf3b(0x228)];_0x546da1<=_0x5a9a9c[_0x9eaf3b(0x1b7)];_0x546da1++)_0x4917a9['push']({'row':_0x37f86d,'column':_0x546da1});if(_0x4917a9['length']===_0x13c402)_0x574e65?_0x4917a9['forEach']((_0x42093d,_0x3ac132)=>{const _0x13e652=_0x9eaf3b,_0x3301f4=_0x4272ff[_0x3ac132],_0xd02880={'startRow':_0x3301f4[_0x13e652(0x1dc)],'startColumn':_0x3301f4['startColumn'],'endRow':_0x3301f4['startRow'],'endColumn':_0x3301f4[_0x13e652(0x1b7)]};_0x5a9d8b['setValue'](_0x42093d[_0x13e652(0x1fc)],_0x42093d['column'],_0xd02880);}):_0x4917a9['forEach']((_0x2a344c,_0x39cb93)=>{const _0x367ac7=_0x9eaf3b,_0x5dec2a=_0x4272ff[0x0],_0x48194f={'startRow':_0x5dec2a[_0x367ac7(0x1dc)]+_0x39cb93,'startColumn':_0x5dec2a[_0x367ac7(0x228)],'endRow':_0x5dec2a['startRow']+_0x39cb93,'endColumn':_0x5dec2a['endColumn']};_0x5a9d8b[_0x367ac7(0x239)](_0x2a344c[_0x367ac7(0x1fc)],_0x2a344c[_0x367ac7(0x1c9)],_0x48194f);});else{if(_0x4917a9[_0x9eaf3b(0x187)]===_0x59a45e)_0x574e65?_0x4917a9[_0x9eaf3b(0x25b)]((_0x3124e7,_0x506c32)=>{const _0x485982=_0x9eaf3b,_0x5f1bb7=_0x4272ff[_0x506c32],_0x2c6a69={'startRow':_0x5f1bb7['startRow'],'startColumn':_0x5f1bb7[_0x485982(0x228)],'endRow':_0x5f1bb7[_0x485982(0x18f)],'endColumn':_0x5f1bb7[_0x485982(0x228)]};_0x5a9d8b[_0x485982(0x239)](_0x3124e7[_0x485982(0x1fc)],_0x3124e7[_0x485982(0x1c9)],_0x2c6a69);}):_0x4917a9[_0x9eaf3b(0x25b)]((_0x1584b6,_0x11756e)=>{const _0x250c02=_0x9eaf3b,_0x305f64=_0x4272ff[0x0],_0x4895fd={'startRow':_0x305f64['startRow'],'startColumn':_0x305f64[_0x250c02(0x228)]+_0x11756e,'endRow':_0x305f64['endRow'],'endColumn':_0x305f64[_0x250c02(0x228)]+_0x11756e};_0x5a9d8b[_0x250c02(0x239)](_0x1584b6[_0x250c02(0x1fc)],_0x1584b6['column'],_0x4895fd);});else{if(_0x4917a9['length']===_0x4272ff[_0x9eaf3b(0x187)])_0x4272ff[_0x9eaf3b(0x1cc)](_0x2e22ed=>!(_0x2e22ed[_0x9eaf3b(0x1dc)]!==_0x2e22ed[_0x9eaf3b(0x18f)]&&_0x2e22ed['startColumn']!==_0x2e22ed['endColumn']))&&_0x4917a9[_0x9eaf3b(0x25b)]((_0x5d6b00,_0x2eaf2e)=>{const _0x4d02c1=_0x9eaf3b,_0x56b341=_0x4272ff[_0x2eaf2e];_0x5a9d8b[_0x4d02c1(0x239)](_0x5d6b00[_0x4d02c1(0x1fc)],_0x5d6b00['column'],_0x56b341);});else throw new Error('Mismatch\x20between\x20the\x20number\x20of\x20target\x20cells\x20and\x20the\x20source\x20range\x20dimensions.');}}return _0x5a9d8b;}const _0x1ce7d7=_0x17e5c7(0x1ae),_0x4c4385={'standard':[_0x17e5c7(0x201),_0x17e5c7(0x20f)],'specialty':[_0x17e5c7(0x209),_0x17e5c7(0x283)],'distinctive':[_0x17e5c7(0x24a),_0x17e5c7(0x22c)],'soft':[_0x17e5c7(0x1f8),'rgb(244,104,249)'],'fresh':[_0x17e5c7(0x1a3),_0x17e5c7(0x1ec)]},_0x5efe20=[_0x17e5c7(0x1d3),_0x17e5c7(0x1c4),'lastPoint',_0x17e5c7(0x26b),_0x17e5c7(0x224),_0x17e5c7(0x22d)];var _0x5c3390=(_0x3eeb19=>(_0x3eeb19[_0x17e5c7(0x1bb)]=_0x17e5c7(0x1ed),_0x3eeb19[_0x17e5c7(0x23c)]=_0x17e5c7(0x246),_0x3eeb19['DISTINCTIVE']=_0x17e5c7(0x1e3),_0x3eeb19[_0x17e5c7(0x1c7)]=_0x17e5c7(0x262),_0x3eeb19[_0x17e5c7(0x1bd)]='fresh',_0x3eeb19[_0x17e5c7(0x1fe)]=_0x17e5c7(0x230),_0x3eeb19))(_0x5c3390||{}),_0x29b2e8=(_0x48de26=>(_0x48de26[_0x48de26['LINE_CHART']=0x1]=_0x17e5c7(0x284),_0x48de26[_0x48de26[_0x17e5c7(0x254)]=0x2]='BAR_CHART',_0x48de26[_0x48de26['PROFIT_AND_LOSS_CHART']=0x3]='PROFIT_AND_LOSS_CHART',_0x48de26[_0x48de26[_0x17e5c7(0x231)]=0x4]='PIE_CHART',_0x48de26))(_0x29b2e8||{}),_0x9eddd4=(_0x1f6656=>(_0x1f6656['SPACING']=_0x17e5c7(0x285),_0x1f6656[_0x17e5c7(0x1bf)]='zero_value',_0x1f6656['CONNECT_WITH_LINE']=_0x17e5c7(0x274),_0x1f6656))(_0x9eddd4||{}),_0x20e222=(_0x413560=>(_0x413560[_0x413560[_0x17e5c7(0x253)]=0x1]=_0x17e5c7(0x253),_0x413560[_0x413560[_0x17e5c7(0x20d)]=0x2]=_0x17e5c7(0x20d),_0x413560[_0x413560[_0x17e5c7(0x226)]=0x3]=_0x17e5c7(0x226),_0x413560))(_0x20e222||{}),_0x411f00=Object['getOwnPropertyDescriptor'],_0x1457a8=(_0xa7b38b,_0x133348,_0x378965,_0x69738d)=>{const _0x45aed5=_0x17e5c7;for(var _0x2907a6=_0x69738d>0x1?void 0x0:_0x69738d?_0x411f00(_0x133348,_0x378965):_0x133348,_0x5281a0=_0xa7b38b[_0x45aed5(0x187)]-0x1,_0x5d44b6;_0x5281a0>=0x0;_0x5281a0--)(_0x5d44b6=_0xa7b38b[_0x5281a0])&&(_0x2907a6=_0x5d44b6(_0x2907a6)||_0x2907a6);return _0x2907a6;},_0x6aea39=(_0x5b443b,_0x5b521a)=>(_0x2e1f7e,_0x1f1069)=>_0x5b521a(_0x2e1f7e,_0x1f1069,_0x5b443b);_0x12f13f[_0x17e5c7(0x1b2)]=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x29b163){const _0x2b58e2=_0x17e5c7;super(),_0x46cdd1(this,_0x2b58e2(0x18d),new Map()),_0x46cdd1(this,_0x2b58e2(0x215),new Map()),_0x46cdd1(this,_0x2b58e2(0x19e),new _0x39b1e3[(_0x2b58e2(0x1da))]()),_0x46cdd1(this,_0x2b58e2(0x28b),this[_0x2b58e2(0x19e)][_0x2b58e2(0x238)]()),this[_0x2b58e2(0x1e0)]=_0x29b163;}[_0x17e5c7(0x1a8)](_0x51c90e,_0x1de8a0){const _0x40b5be=_0x17e5c7;let _0x48f4c8=this[_0x40b5be(0x18d)][_0x40b5be(0x1ef)](_0x51c90e);_0x48f4c8||(_0x48f4c8=new Map(),this['_sparklineModel']['set'](_0x51c90e,_0x48f4c8));let _0xb46ae5=_0x48f4c8[_0x40b5be(0x1ef)](_0x1de8a0);return _0xb46ae5||(_0xb46ae5=new Map(),_0x48f4c8[_0x40b5be(0x256)](_0x1de8a0,_0xb46ae5)),_0xb46ae5;}[_0x17e5c7(0x1e9)](_0x30fdbb,_0xce5af0){const _0x19ca02=_0x17e5c7;let _0x3efbe7=this['_sparklineAnchorMap'][_0x19ca02(0x1ef)](_0x30fdbb);_0x3efbe7||(_0x3efbe7=new Map(),this[_0x19ca02(0x215)][_0x19ca02(0x256)](_0x30fdbb,_0x3efbe7));let _0x168086=_0x3efbe7['get'](_0xce5af0);return _0x168086||(_0x168086={'matrix':new _0x381950[(_0x19ca02(0x205))](),'extra':{}},_0x3efbe7[_0x19ca02(0x256)](_0xce5af0,_0x168086)),_0x168086;}[_0x17e5c7(0x1d7)](_0x5800d9,_0x2bba70,_0xa0d33a,_0x306095=_0x17e5c7(0x256)){const _0x1ce223=_0x17e5c7;var _0x4899a4,_0x144a10,_0x554e89,_0x92d2d,_0x35c336,_0x595a76,_0x2ed4ae,_0x1fd6eb,_0x4111c0,_0x10cbb3,_0x1d2534,_0x42fb3d,_0x477c2d;const _0x42343f=(_0x144a10=(_0x4899a4=this[_0x1ce223(0x18d)][_0x1ce223(0x1ef)](_0x5800d9))==null?void 0x0:_0x4899a4[_0x1ce223(0x1ef)](_0x2bba70))==null?void 0x0:_0x144a10['get'](_0xa0d33a);if(!_0x42343f)return;const _0x22402d=_0x3292ab['getSheetCommandTarget'](this[_0x1ce223(0x1e0)],{'unitId':_0x5800d9,'subUnitId':_0x2bba70});if(!_0x22402d)return;const _0x1d2aa1=this['_ensureAnchorMatrix'](_0x5800d9,_0x2bba70),{extra:_0x39b238,matrix:_0xd6584d}=_0x1d2aa1,{worksheet:_0x557359}=_0x22402d;let _0x513863=Number['MIN_SAFE_INTEGER'],_0x501d7a=Number[_0x1ce223(0x1a6)];const _0x3c9a93=(_0x554e89=_0x42343f[_0x1ce223(0x1d8)]['containHiddenCells'])!=null?_0x554e89:!0x1;_0x42343f['sparklines'][_0x1ce223(0x265)]((_0x5e8e63,_0x42d13e,_0x5ddd99)=>{const _0x13f693=_0x1ce223;var _0x113612,_0x36ac3b,_0x4935f3;const _0x22c554=_0x5ddd99;let _0x452b94=Number['MIN_SAFE_INTEGER'],_0x5020d5=Number[_0x13f693(0x1a6)],_0x30e6c=0x0,_0x4eb956=0x0;const _0x687d94=[];if(!_0x381950['isValidRange'](_0x22c554))_0xd6584d[_0x13f693(0x239)](_0x5e8e63,_0x42d13e,{'groupId':_0xa0d33a,'data':[],'max':_0x452b94,'min':_0x5020d5,'highIndex':_0x30e6c,'lowIndex':_0x4eb956,'negativeIndexes':_0x687d94});else{const _0x5285bb=[];for(let _0x1975c9=_0x22c554['startRow'];_0x1975c9<=_0x22c554[_0x13f693(0x18f)];_0x1975c9++){for(let _0x40d8f4=_0x22c554[_0x13f693(0x228)];_0x40d8f4<=_0x22c554[_0x13f693(0x1b7)];_0x40d8f4++){const _0x1b482c=_0x557359[_0x13f693(0x21f)](_0x1975c9),_0x4764f1=_0x557359[_0x13f693(0x1c6)](_0x40d8f4);if(!_0x3c9a93&&(!_0x1b482c||!_0x4764f1))continue;let _0x2ba216=0x0;const _0x3dbb44=((_0x113612=_0x557359[_0x13f693(0x1cd)](_0x1975c9,_0x40d8f4))==null?void 0x0:_0x113612['v'])!==void 0x0?_0x557359[_0x13f693(0x1cd)](_0x1975c9,_0x40d8f4):_0x557359[_0x13f693(0x1e2)](_0x1975c9,_0x40d8f4);if(!_0x3dbb44||_0x3dbb44['v']===void 0x0||_0x3dbb44['v']===null){const _0x4931d7=(_0x36ac3b=_0x42343f[_0x13f693(0x1d8)]['emptyShowAs'])!=null?_0x36ac3b:_0x9eddd4[_0x13f693(0x21c)];_0x4931d7===_0x9eddd4[_0x13f693(0x1bf)]?_0x2ba216=0x0:_0x4931d7===_0x9eddd4[_0x13f693(0x21c)]?_0x2ba216=_0x13f693(0x227):_0x4931d7===_0x9eddd4[_0x13f693(0x214)]&&(_0x2ba216='u-connect');}else{if(_0x3dbb44['t']===_0x381950['CellValueType'][_0x13f693(0x1fb)]||_0x3dbb44['t']===_0x381950[_0x13f693(0x1c0)]['FORCE_STRING']){const _0x5c595b=(_0x4935f3=_0x42343f[_0x13f693(0x1d8)][_0x13f693(0x1ca)])!=null?_0x4935f3:_0x9eddd4[_0x13f693(0x21c)];_0x5c595b===_0x9eddd4[_0x13f693(0x1bf)]?_0x2ba216=0x0:_0x5c595b===_0x9eddd4[_0x13f693(0x21c)]?_0x2ba216=_0x13f693(0x227):_0x5c595b===_0x9eddd4[_0x13f693(0x214)]&&(_0x2ba216=_0x13f693(0x258));}else _0x3dbb44['t']===_0x381950[_0x13f693(0x1c0)][_0x13f693(0x1e8)]?_0x2ba216=_0x3dbb44['v']?0x1:0x0:_0x3dbb44['t']===_0x381950[_0x13f693(0x1c0)][_0x13f693(0x204)]?_0x2ba216=Number(_0x3dbb44['v']):_0x2ba216=_0x3dbb44['v'];}if(_0x5285bb[_0x13f693(0x27f)](_0x2ba216),typeof _0x2ba216==_0x13f693(0x270)){_0x452b94=Math[_0x13f693(0x1d9)](_0x452b94,_0x2ba216),_0x513863=Math[_0x13f693(0x1d9)](_0x513863,_0x2ba216),_0x501d7a=Math[_0x13f693(0x22a)](_0x501d7a,_0x2ba216),_0x5020d5=Math['min'](_0x5020d5,_0x2ba216);const _0x318efd=typeof _0x5285bb[_0x30e6c]==_0x13f693(0x270)?Number(_0x5285bb[_0x30e6c]):Number[_0x13f693(0x1b1)];_0x2ba216>_0x318efd&&(_0x30e6c=_0x5285bb[_0x13f693(0x187)]-0x1);const _0x45e018=typeof _0x5285bb[_0x4eb956]==_0x13f693(0x270)?Number(_0x5285bb[_0x4eb956]):Number['MAX_SAFE_INTEGER'];_0x2ba216<_0x45e018&&(_0x4eb956=_0x5285bb[_0x13f693(0x187)]-0x1),_0x2ba216<0x0&&_0x687d94['push'](_0x5285bb['length']-0x1);}}_0xd6584d[_0x13f693(0x239)](_0x5e8e63,_0x42d13e,{'groupId':_0xa0d33a,'data':_0x5285bb,'max':_0x452b94,'min':_0x5020d5,'highIndex':_0x30e6c,'lowIndex':_0x4eb956,'negativeIndexes':_0x687d94});}}});let _0x12c28e=_0x513863;((_0x92d2d=_0x42343f[_0x1ce223(0x1d8)][_0x1ce223(0x199)])==null?void 0x0:_0x92d2d[_0x1ce223(0x206)])===_0x20e222[_0x1ce223(0x226)]&&(_0x12c28e=(_0x595a76=(_0x35c336=_0x42343f['config'][_0x1ce223(0x199)])==null?void 0x0:_0x35c336['value'])!=null?_0x595a76:_0x513863);let _0x167abb=_0x501d7a;((_0x2ed4ae=_0x42343f[_0x1ce223(0x1d8)][_0x1ce223(0x1d4)])==null?void 0x0:_0x2ed4ae[_0x1ce223(0x206)])===_0x20e222[_0x1ce223(0x226)]&&(_0x167abb=(_0x4111c0=(_0x1fd6eb=_0x42343f[_0x1ce223(0x1d8)][_0x1ce223(0x1d4)])==null?void 0x0:_0x1fd6eb[_0x1ce223(0x221)])!=null?_0x4111c0:_0x501d7a);const _0x48dc5c=(_0x10cbb3=_0x42343f[_0x1ce223(0x1d8)][_0x1ce223(0x25c)])!=null?_0x10cbb3:_0x5c3390[_0x1ce223(0x1bb)],_0x337734=(_0x477c2d=(_0x42fb3d=_0x42343f['config'][_0x1ce223(0x192)])!=null?_0x42fb3d:(_0x1d2534=_0x4c4385[_0x48dc5c])==null?void 0x0:_0x1d2534[0x0])!=null?_0x477c2d:_0x4c4385[_0x1ce223(0x1ed)][0x0],_0x422c64=new _0x381950[(_0x1ce223(0x1b8))](_0x337734),_0x24673d=_0x422c64['setAlpha'](0.2)['toRgbString'](),_0x9928b6=_0x422c64['setAlpha'](0.05)[_0x1ce223(0x1fa)]();_0x39b238[_0xa0d33a]={'groupMax':_0x513863,'groupMin':_0x501d7a,'showMax':_0x12c28e,'showMin':_0x167abb,'startGradient':_0x24673d,'endGradient':_0x9928b6},this[_0x1ce223(0x19e)][_0x1ce223(0x252)]({'unitId':_0x5800d9,'subUnitId':_0x2bba70,'groupId':_0xa0d33a,'config':_0x42343f,'type':_0x306095});}['addSparkline'](_0x4d3aa2,_0x1d0cc5,_0x593fb6,_0x53c458){const _0x3ebcb6=_0x17e5c7;this['_ensureConfigMap'](_0x4d3aa2,_0x1d0cc5)[_0x3ebcb6(0x256)](_0x593fb6,_0x53c458),this['updateSparklineExtraNum'](_0x4d3aa2,_0x1d0cc5,_0x593fb6,_0x3ebcb6(0x19b));}['setSparkline'](_0x571678,_0x45c4f9,_0x5b6f3d,_0x4ba221){const _0x37b62c=_0x17e5c7;var _0x1da9e9;const _0x50ed5c=(_0x1da9e9=this['_sparklineModel'][_0x37b62c(0x1ef)](_0x571678))==null?void 0x0:_0x1da9e9['get'](_0x45c4f9);_0x5b6f3d[_0x37b62c(0x25b)](_0x22e9c2=>{const _0x26d3fe=_0x37b62c;_0x50ed5c!=null&&_0x50ed5c[_0x26d3fe(0x1df)](_0x22e9c2)&&(_0x50ed5c[_0x26d3fe(0x256)](_0x22e9c2,_0x4ba221),this[_0x26d3fe(0x1d7)](_0x571678,_0x45c4f9,_0x22e9c2));});}[_0x17e5c7(0x189)](_0x3e4ed8,_0x54af9e,_0x4ee5b6){const _0x10cab3=_0x17e5c7;var _0x4e378c,_0x111c91;const _0x40bbd7=this['_sparklineModel'][_0x10cab3(0x1ef)](_0x3e4ed8);if(_0x40bbd7){const _0x2d20f8=_0x40bbd7[_0x10cab3(0x1ef)](_0x54af9e);if(_0x2d20f8){_0x2d20f8[_0x10cab3(0x259)](_0x4ee5b6);const _0xfe7032=(_0x4e378c=this[_0x10cab3(0x215)]['get'](_0x3e4ed8))==null?void 0x0:_0x4e378c[_0x10cab3(0x1ef)](_0x54af9e);(_0x111c91=_0xfe7032==null?void 0x0:_0xfe7032['matrix'])==null||_0x111c91['forValue']((_0x122d74,_0x3be8d0,_0x3ffaf9)=>{const _0x50d68b=_0x10cab3;(_0x3ffaf9==null?void 0x0:_0x3ffaf9[_0x50d68b(0x208)])===_0x4ee5b6&&(_0xfe7032==null||_0xfe7032[_0x50d68b(0x266)][_0x50d68b(0x1d0)](_0x122d74,_0x3be8d0));}),this[_0x10cab3(0x19e)]['next']({'unitId':_0x3e4ed8,'subUnitId':_0x54af9e,'groupId':_0x4ee5b6,'type':_0x10cab3(0x278)}),_0x2d20f8['size']===0x0&&_0x40bbd7['delete'](_0x54af9e);}}}[_0x17e5c7(0x1ee)](_0x4901dc,_0x52967a,_0x305dbc,_0x2bd506){const _0x5aee4a=_0x17e5c7;var _0x3476cc,_0x121ae8,_0x179aa9,_0x50f168;const _0x503f3e=(_0x3476cc=this['_sparklineAnchorMap'][_0x5aee4a(0x1ef)](_0x4901dc))==null?void 0x0:_0x3476cc[_0x5aee4a(0x1ef)](_0x52967a),_0x43612a=_0x503f3e==null?void 0x0:_0x503f3e[_0x5aee4a(0x266)][_0x5aee4a(0x1dd)](_0x305dbc,_0x2bd506);if(_0x43612a){const {groupId:_0x20206d}=_0x43612a,_0x673911=(_0x121ae8=this[_0x5aee4a(0x18d)][_0x5aee4a(0x1ef)](_0x4901dc))==null?void 0x0:_0x121ae8[_0x5aee4a(0x1ef)](_0x52967a);(_0x179aa9=_0x673911==null?void 0x0:_0x673911[_0x5aee4a(0x1ef)](_0x20206d))==null||_0x179aa9['sparklines'][_0x5aee4a(0x1d0)](_0x305dbc,_0x2bd506),(_0x50f168=_0x673911==null?void 0x0:_0x673911['get'](_0x20206d))!=null&&_0x50f168[_0x5aee4a(0x22f)][_0x5aee4a(0x202)]()||_0x673911==null||_0x673911[_0x5aee4a(0x259)](_0x20206d),_0x503f3e==null||_0x503f3e[_0x5aee4a(0x266)][_0x5aee4a(0x1d0)](_0x305dbc,_0x2bd506),this[_0x5aee4a(0x19e)]['next']({'unitId':_0x4901dc,'subUnitId':_0x52967a,'groupId':_0x20206d,'type':_0x5aee4a(0x278)});}}['clearSparklineCache'](_0x3edee8,_0x4302ee,_0x3a6a9d){const _0x30c1a5=_0x17e5c7;var _0x1c76fb,_0x44474f,_0x492d99,_0x980117;const _0x25d2a7=(_0x492d99=(_0x44474f=(_0x1c76fb=this[_0x30c1a5(0x18d)]['get'](_0x3edee8))==null?void 0x0:_0x1c76fb['get'](_0x4302ee))==null?void 0x0:_0x44474f['get'](_0x3a6a9d))==null?void 0x0:_0x492d99[_0x30c1a5(0x22f)],_0x932b61=(_0x980117=this[_0x30c1a5(0x215)]['get'](_0x3edee8))==null?void 0x0:_0x980117[_0x30c1a5(0x1ef)](_0x4302ee);if(_0x25d2a7&&_0x932b61){const {matrix:_0x394ee1,extra:_0x465977}=_0x932b61;_0x25d2a7[_0x30c1a5(0x265)]((_0xb15fbe,_0x504ae3,_0x468f72)=>{const _0x207bd5=_0x30c1a5;_0x394ee1[_0x207bd5(0x1d0)](_0xb15fbe,_0x504ae3);}),delete _0x465977[_0x3a6a9d];}}[_0x17e5c7(0x273)](_0x4d3433,_0x509468){const _0x55d269=_0x17e5c7;var _0x243081;return(_0x243081=this[_0x55d269(0x18d)]['get'](_0x4d3433))==null?void 0x0:_0x243081[_0x55d269(0x1ef)](_0x509468);}[_0x17e5c7(0x20b)](_0x42742c,_0x23c26a,_0x41ce9e){const _0x568e1f=_0x17e5c7;var _0x1c77b6,_0x20757f;return(_0x20757f=(_0x1c77b6=this[_0x568e1f(0x18d)][_0x568e1f(0x1ef)](_0x42742c))==null?void 0x0:_0x1c77b6[_0x568e1f(0x1ef)](_0x23c26a))==null?void 0x0:_0x20757f['get'](_0x41ce9e);}[_0x17e5c7(0x23d)](_0x23bd77,_0x31811c,_0x378f05,_0x21d55f){const _0x166bd2=_0x17e5c7;var _0xdfa4ea,_0xd303c1,_0x15a8e0;return(_0x15a8e0=(_0xd303c1=(_0xdfa4ea=this[_0x166bd2(0x215)][_0x166bd2(0x1ef)](_0x23bd77))==null?void 0x0:_0xdfa4ea[_0x166bd2(0x1ef)](_0x31811c))==null?void 0x0:_0xd303c1[_0x166bd2(0x266)][_0x166bd2(0x1dd)](_0x378f05,_0x21d55f))==null?void 0x0:_0x15a8e0['groupId'];}['reBuildAnchorCache'](_0x12baae,_0x236f13){const _0x1ec057=_0x17e5c7;var _0x291ca8;const _0x5f3f88=this['_ensureAnchorMatrix'](_0x12baae,_0x236f13);_0x5f3f88[_0x1ec057(0x266)][_0x1ec057(0x265)]((_0xd5cbf9,_0x2e5865)=>{const _0x55b906=_0x1ec057;_0x5f3f88['matrix'][_0x55b906(0x1d0)](_0xd5cbf9,_0x2e5865);});const _0x54de00=(_0x291ca8=this[_0x1ec057(0x18d)]['get'](_0x12baae))==null?void 0x0:_0x291ca8[_0x1ec057(0x1ef)](_0x236f13);if(_0x54de00){for(const [_0x41bf77]of _0x54de00)this[_0x1ec057(0x1d7)](_0x12baae,_0x236f13,_0x41bf77);}}[_0x17e5c7(0x198)](){const _0x13f640=_0x17e5c7;return{'sparklineModel':this['_sparklineModel'],'sparklineAnchorMap':this[_0x13f640(0x215)]};}['toJSON'](_0x4abad3){const _0x1cc2c9=_0x17e5c7,_0x3a8d56={};if(this['_sparklineModel'][_0x1cc2c9(0x1df)](_0x4abad3)){_0x3a8d56[_0x4abad3]={};const _0x25a4b6=this[_0x1cc2c9(0x18d)]['get'](_0x4abad3);_0x25a4b6!=null&&_0x25a4b6[_0x1cc2c9(0x261)]&&Array[_0x1cc2c9(0x1a4)](_0x25a4b6['keys']())['forEach'](_0x26d7ab=>{const _0x5f2f5b=_0x1cc2c9;_0x3a8d56[_0x4abad3][_0x26d7ab]={};const _0x3b962b=_0x25a4b6[_0x5f2f5b(0x1ef)](_0x26d7ab);_0x3b962b!=null&&_0x3b962b[_0x5f2f5b(0x261)]&&Array[_0x5f2f5b(0x1a4)](_0x3b962b['keys']())[_0x5f2f5b(0x25b)](_0x4de20c=>{const _0x3c1eee=_0x5f2f5b,_0x320ec4=_0x3b962b['get'](_0x4de20c);_0x320ec4&&(_0x3a8d56[_0x4abad3][_0x26d7ab][_0x4de20c]={'config':_0x320ec4[_0x3c1eee(0x1d8)],'sparklines':_0x320ec4[_0x3c1eee(0x22f)][_0x3c1eee(0x1ac)]()});});});}return _0x3a8d56;}['fromJSON'](_0x35a1dc){const _0x20c302=_0x17e5c7;if(!_0x35a1dc)return;Object[_0x20c302(0x1f0)](_0x35a1dc)[_0x20c302(0x25b)](_0x53414d=>{const _0x234164=_0x20c302,_0x4f074b=_0x35a1dc[_0x53414d];_0x4f074b&&Object[_0x234164(0x1f0)](_0x4f074b)['forEach'](_0x2ba9a8=>{const _0x2c16a8=_0x234164,_0x3404ff=_0x4f074b[_0x2ba9a8];_0x3404ff&&Object[_0x2c16a8(0x1f0)](_0x3404ff)[_0x2c16a8(0x25b)](_0x1f240a=>{const _0xb9743b=_0x2c16a8,_0x80891f=_0x3404ff[_0x1f240a];if(_0x80891f){const _0x45cbfe={'config':_0x80891f[_0xb9743b(0x1d8)],'sparklines':new _0x381950[(_0xb9743b(0x205))](_0x80891f[_0xb9743b(0x22f)])};this[_0xb9743b(0x249)](_0x53414d,_0x2ba9a8,_0x1f240a,_0x45cbfe);}});});});}[_0x17e5c7(0x211)](_0x59d554){const _0x3f3e2e=_0x17e5c7,_0x19c8a0=this[_0x3f3e2e(0x18d)][_0x3f3e2e(0x1ef)](_0x59d554);if(_0x19c8a0){for(const [_0x1ede9a]of _0x19c8a0){const _0x249729=_0x19c8a0['get'](_0x1ede9a);if(_0x249729){for(const [_0x5ec3a3]of _0x249729)this['clearSparklineCache'](_0x59d554,_0x1ede9a,_0x5ec3a3);}}this['_sparklineModel'][_0x3f3e2e(0x259)](_0x59d554);}}},_0x12f13f[_0x17e5c7(0x1b2)]=_0x1457a8([_0x6aea39(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x381950['IUniverInstanceService']))],_0x12f13f[_0x17e5c7(0x1b2)]);const _0x48e781={'id':_0x17e5c7(0x1f6),'type':_0x381950[_0x17e5c7(0x25e)][_0x17e5c7(0x194)],'handler':(_0x26374c,_0x2e77c9)=>{const _0x20f41f=_0x17e5c7;if(!_0x2e77c9)return!0x1;const {sparklineConfigMap:_0x425bdc,unitId:_0x55d02f,subUnitId:_0x5b98da}=_0x2e77c9,_0x4f9bb4=_0x26374c['get'](_0x12f13f[_0x20f41f(0x1b2)]);return Object['entries'](_0x425bdc)[_0x20f41f(0x25b)](([_0x11fe09,_0x363ce8])=>{const _0x450e2b=_0x20f41f,_0x1a363d={'config':_0x363ce8['config'],'sparklines':new _0x381950['ObjectMatrix'](_0x363ce8[_0x450e2b(0x22f)])};_0x4f9bb4[_0x450e2b(0x249)](_0x55d02f,_0x5b98da,_0x11fe09,_0x1a363d);}),!0x0;}},_0x5c63ad={'id':_0x17e5c7(0x287),'type':_0x381950[_0x17e5c7(0x25e)][_0x17e5c7(0x194)],'handler':(_0x5c8fa8,_0x59e5ad)=>{const _0x20762b=_0x17e5c7;if(!_0x59e5ad)return!0x1;const {unitId:_0x290787,subUnitId:_0x259dd1,ranges:_0x5cea52,isSingle:_0x27ae76,groupIds:_0x54b8de}=_0x59e5ad,_0x119324=_0x5c8fa8[_0x20762b(0x1ef)](_0x12f13f[_0x20762b(0x1b2)]);return _0x54b8de?(_0x54b8de[_0x20762b(0x25b)](_0x5ee8fb=>{_0x119324['removeSparkline'](_0x290787,_0x259dd1,_0x5ee8fb);}),!0x0):_0x5cea52?(_0x5cea52['forEach'](_0x2d0f80=>{const _0x2c2846=_0x20762b;_0x381950[_0x2c2846(0x1f1)]['foreach'](_0x2d0f80,(_0x4a2f44,_0x5c84be)=>{const _0x343a95=_0x2c2846,_0x85ff22=_0x119324[_0x343a95(0x23d)](_0x290787,_0x259dd1,_0x4a2f44,_0x5c84be);_0x85ff22&&(_0x27ae76?_0x119324['removePartSparkline'](_0x290787,_0x259dd1,_0x4a2f44,_0x5c84be):_0x119324[_0x343a95(0x189)](_0x290787,_0x259dd1,_0x85ff22));});}),!0x0):!0x1;}},_0x41f7c9={'id':'sheet.command.add-sparkline','type':_0x381950[_0x17e5c7(0x25e)]['COMMAND'],'handler':(_0x4ed739,_0x565192)=>{const _0x52703b=_0x17e5c7;if(!_0x565192)return!0x1;const {sourceRanges:_0x5418bd,targetRanges:_0x151f22,config:_0x105207}=_0x565192,_0x3be6d1=_0x4ed739[_0x52703b(0x1ef)](_0x381950[_0x52703b(0x188)]),_0x23046e='g_'+_0x381950[_0x52703b(0x28c)](0x6),_0x272cca=_0x492f8f(_0x5418bd,_0x151f22),_0x454b2a={'config':_0x105207!=null?_0x105207:{},'sparklines':_0x272cca[_0x52703b(0x1ac)]()},_0x11058a=_0x4ed739[_0x52703b(0x1ef)](_0x381950[_0x52703b(0x245)]),_0x5a8c64=_0x4ed739['get'](_0x12f13f[_0x52703b(0x1b2)]),_0x235d36=_0x3292ab[_0x52703b(0x1d6)](_0x11058a);if(!_0x235d36)return!0x1;const {unitId:_0x42c794,subUnitId:_0x4ec68f}=_0x235d36,_0x3447c9=_0x4ed739[_0x52703b(0x1ef)](_0x381950[_0x52703b(0x1ab)]),_0x42e753=[],_0x3211de=[],_0x3ba8d1={},_0x1e1ee0={},_0x5ca181=new Set([_0x23046e]);_0x272cca[_0x52703b(0x265)]((_0x53657d,_0x237070,_0x177453)=>{const _0xeab2f6=_0x52703b,_0x795b87=_0x5a8c64[_0xeab2f6(0x23d)](_0x42c794,_0x4ec68f,_0x53657d,_0x237070);if(_0x795b87){const _0x28529c=_0x5a8c64[_0xeab2f6(0x20b)](_0x42c794,_0x4ec68f,_0x795b87);if(_0x28529c){_0x5ca181['add'](_0x795b87);let _0x58dd27=_0x3ba8d1[_0x795b87],_0x5d9c57=_0x1e1ee0[_0x795b87];_0x5d9c57||(_0x5d9c57={'config':_0x381950[_0xeab2f6(0x19c)][_0xeab2f6(0x235)](_0x28529c[_0xeab2f6(0x1d8)]),'sparklines':new _0x381950[(_0xeab2f6(0x205))](_0x28529c[_0xeab2f6(0x22f)][_0xeab2f6(0x24c)]())},_0x1e1ee0[_0x795b87]=_0x5d9c57),_0x58dd27||(_0x58dd27={'config':_0x381950[_0xeab2f6(0x19c)][_0xeab2f6(0x235)](_0x28529c[_0xeab2f6(0x1d8)]),'sparklines':_0x28529c[_0xeab2f6(0x22f)][_0xeab2f6(0x24c)]()},_0x3ba8d1[_0x795b87]=_0x58dd27),_0x5d9c57['sparklines'][_0xeab2f6(0x1d0)](_0x53657d,_0x237070);}}});const _0x5bf7e4={};return Object[_0x52703b(0x200)](_0x1e1ee0)[_0x52703b(0x25b)](([_0x3bb05f,_0x3284fc])=>{const _0x301d41=_0x52703b;_0x3284fc[_0x301d41(0x22f)][_0x301d41(0x1ad)]()&&(_0x5bf7e4[_0x3bb05f]={'config':_0x3284fc[_0x301d41(0x1d8)],'sparklines':_0x3284fc[_0x301d41(0x22f)]['clone']()});}),_0x5bf7e4[_0x23046e]=_0x454b2a,_0x42e753['push']({'id':_0x5c63ad['id'],'params':{'unitId':_0x42c794,'subUnitId':_0x4ec68f,'groupIds':Array['from'](_0x5ca181),'isSingle':!0x1}}),_0x5ca181[_0x52703b(0x261)]>0x1&&(_0x3211de[_0x52703b(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x42c794,'subUnitId':_0x4ec68f,'groupIds':Array['from'](_0x5ca181),'isSingle':!0x1}}),_0x42e753['push']({'id':_0x48e781['id'],'params':{'unitId':_0x42c794,'subUnitId':_0x4ec68f,'sparklineConfigMap':_0x3ba8d1}})),_0x3211de[_0x52703b(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x42c794,'subUnitId':_0x4ec68f,'sparklineConfigMap':_0x5bf7e4}}),_0x381950[_0x52703b(0x18e)](_0x3211de,_0x3447c9),_0x3be6d1['pushUndoRedo']({'unitID':_0x42c794,'undoMutations':_0x42e753,'redoMutations':_0x3211de}),!0x0;}},_0x42a99c={'id':_0x17e5c7(0x22e),'type':_0x381950[_0x17e5c7(0x25e)]['COMMAND'],'handler':(_0x3de9b0,_0x2c779a)=>{const _0x1fc55b=_0x17e5c7;var _0x537e2d;const {isSingle:_0x11e2d3=!0x0}=_0x2c779a||{},_0x5f3782=_0x3de9b0[_0x1fc55b(0x1ef)](_0x381950['ICommandService']),_0x8a514d=_0x3de9b0[_0x1fc55b(0x1ef)](_0x381950[_0x1fc55b(0x245)]),_0x42157f=_0x3de9b0[_0x1fc55b(0x1ef)](_0x12f13f[_0x1fc55b(0x1b2)]),_0x5a0c95=_0x3de9b0[_0x1fc55b(0x1ef)](_0x381950[_0x1fc55b(0x188)]),_0xc76446=_0x3292ab[_0x1fc55b(0x1d6)](_0x8a514d);if(!_0xc76446)return!0x1;const _0x1ae4b2=_0x3de9b0[_0x1fc55b(0x1ef)](_0x3292ab[_0x1fc55b(0x269)]),_0x55c6f6=(_0x537e2d=_0x2c779a==null?void 0x0:_0x2c779a[_0x1fc55b(0x196)])!=null?_0x537e2d:_0x1ae4b2[_0x1fc55b(0x251)]()[_0x1fc55b(0x26c)](_0x13bd8e=>_0x13bd8e[_0x1fc55b(0x193)]),{unitId:_0x2ce6d8,subUnitId:_0x52fb1c}=_0xc76446,_0x3d1e58=[],_0x2f4c22=[];_0x3d1e58[_0x1fc55b(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x2ce6d8,'subUnitId':_0x52fb1c,'ranges':_0x55c6f6,'isSingle':_0x11e2d3}});const _0x109bb2=[],_0x4aa31e={};return _0x55c6f6[_0x1fc55b(0x25b)](_0x56fef8=>{_0x381950['Range']['foreach'](_0x56fef8,(_0x7536c1,_0x3b3e1e)=>{const _0x25b272=_0xce16,_0x28f7f1=_0x42157f['getSparkline'](_0x2ce6d8,_0x52fb1c,_0x7536c1,_0x3b3e1e);if(_0x28f7f1){const _0x537c0f=_0x42157f['getSparklineById'](_0x2ce6d8,_0x52fb1c,_0x28f7f1);_0x537c0f&&(_0x109bb2[_0x25b272(0x27f)](_0x28f7f1),_0x4aa31e[_0x28f7f1]={'config':_0x381950[_0x25b272(0x19c)]['deepClone'](_0x537c0f[_0x25b272(0x1d8)]),'sparklines':_0x381950[_0x25b272(0x19c)]['deepClone'](_0x537c0f[_0x25b272(0x22f)][_0x25b272(0x24c)]())});}});}),_0x2f4c22[_0x1fc55b(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x2ce6d8,'subUnitId':_0x52fb1c,'groupIds':_0x109bb2,'isSingle':!0x1}}),_0x2f4c22['push']({'id':_0x48e781['id'],'params':{'unitId':_0x2ce6d8,'subUnitId':_0x52fb1c,'sparklineConfigMap':_0x4aa31e}}),_0x381950[_0x1fc55b(0x18e)](_0x3d1e58,_0x5f3782),_0x5a0c95[_0x1fc55b(0x21e)]({'unitID':_0x2ce6d8,'undoMutations':_0x2f4c22,'redoMutations':_0x3d1e58}),!0x0;}},_0x3f022e={'id':_0x17e5c7(0x25f),'type':_0x381950[_0x17e5c7(0x25e)][_0x17e5c7(0x194)],'handler':(_0x2951f7,_0x1862f6)=>{const _0x1f5887=_0x17e5c7;if(!_0x1862f6)return!0x1;const {unitId:_0x388897,subUnitId:_0x417206,groupIds:_0x47a71b,config:_0x1cfccb}=_0x1862f6,_0x25d59a=_0x2951f7[_0x1f5887(0x1ef)](_0x12f13f['SparklineDataSourceModel']);return _0x47a71b[_0x1f5887(0x25b)](_0x2abc13=>{const _0x55c53f=_0x1f5887,_0x2b3b5c=_0x25d59a['getSparklineById'](_0x388897,_0x417206,_0x2abc13);if(_0x2b3b5c){const _0x5bae17={'config':Object[_0x55c53f(0x1e4)]({},_0x2b3b5c[_0x55c53f(0x1d8)],_0x1cfccb['config']),'sparklines':new _0x381950['ObjectMatrix'](_0x2b3b5c[_0x55c53f(0x22f)][_0x55c53f(0x24c)]())};_0x25d59a[_0x55c53f(0x19a)](_0x388897,_0x417206,[_0x2abc13],_0x5bae17);}}),!0x0;}},_0x24ae22={'id':_0x17e5c7(0x282),'type':_0x381950[_0x17e5c7(0x25e)][_0x17e5c7(0x1c2)],'handler':(_0x406a5e,_0x406b44)=>{const _0x1edab8=_0x17e5c7;var _0x5a991a,_0x31bceb,_0x32e5fa,_0x5a9231;if(!_0x406b44)return!0x1;const _0x538929=_0x406a5e[_0x1edab8(0x1ef)](_0x381950[_0x1edab8(0x1ab)]),_0x5c4a03=_0x406a5e[_0x1edab8(0x1ef)](_0x3292ab[_0x1edab8(0x269)]),_0x4c7cd1=_0x406a5e[_0x1edab8(0x1ef)](_0x12f13f['SparklineDataSourceModel']),_0x165549=_0x406a5e[_0x1edab8(0x1ef)](_0x381950[_0x1edab8(0x245)]),_0x4f03ad=_0x406a5e[_0x1edab8(0x1ef)](_0x381950[_0x1edab8(0x188)]),_0x551856=_0x3292ab[_0x1edab8(0x1d6)](_0x165549);if(!_0x551856)return!0x1;const {unitId:_0xb385cc,subUnitId:_0x2ead9b}=_0x551856,_0x18c86e=(_0x5a991a=_0x406b44==null?void 0x0:_0x406b44['ranges'])!=null?_0x5a991a:_0x5c4a03[_0x1edab8(0x251)]()[_0x1edab8(0x26c)](_0x333cc9=>_0x333cc9[_0x1edab8(0x193)]),_0x309dfa=(_0x31bceb=_0x4c7cd1['getSparklineCache']()[_0x1edab8(0x1e5)][_0x1edab8(0x1ef)](_0xb385cc))==null?void 0x0:_0x31bceb[_0x1edab8(0x1ef)](_0x2ead9b),{isChangeDataSource:_0xacc6e7,config:_0x3da3e8,combine:_0x54c27f,unCombine:_0x338152}=_0x406b44;if(_0x54c27f){const _0x32b24d=[],_0xbbdbb4=[];_0x32b24d['push']({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'ranges':_0x18c86e,'isSingle':!0x0}});const _0x4878cf='g_'+_0x381950['generateRandomId'](0x6),_0x5c7c3d=new _0x381950[(_0x1edab8(0x205))](),_0x34fe75=(_0x32e5fa=_0x4c7cd1[_0x1edab8(0x198)]()[_0x1edab8(0x244)][_0x1edab8(0x1ef)](_0xb385cc))==null?void 0x0:_0x32e5fa[_0x1edab8(0x1ef)](_0x2ead9b),_0x43e17a=new Set([_0x4878cf]),_0x201873={};return _0x18c86e[_0x1edab8(0x25b)](_0x54c590=>{const _0x1bd84f=_0x1edab8;var _0x3cf953,_0x5c8141;const {startRow:_0xf3b0d0,endRow:_0x170a1b,startColumn:_0x587fc6,endColumn:_0x30a0bd}=_0x54c590;for(let _0x2df3c8=_0xf3b0d0;_0x2df3c8<=_0x170a1b;_0x2df3c8++)for(let _0x26bcf1=_0x587fc6;_0x26bcf1<=_0x30a0bd;_0x26bcf1++){const _0x5a1080=(_0x3cf953=_0x309dfa==null?void 0x0:_0x309dfa[_0x1bd84f(0x266)][_0x1bd84f(0x1dd)](_0x2df3c8,_0x26bcf1))==null?void 0x0:_0x3cf953[_0x1bd84f(0x208)];if(_0x5a1080){_0x43e17a[_0x1bd84f(0x19b)](_0x5a1080);const _0x299c10=_0x4c7cd1[_0x1bd84f(0x20b)](_0xb385cc,_0x2ead9b,_0x5a1080);_0x299c10&&(_0x201873[_0x5a1080]={'config':_0x381950[_0x1bd84f(0x19c)]['deepClone'](_0x299c10[_0x1bd84f(0x1d8)]),'sparklines':_0x381950[_0x1bd84f(0x19c)][_0x1bd84f(0x235)](_0x299c10[_0x1bd84f(0x22f)]['clone']())});const _0x13706c=(_0x5c8141=_0x34fe75==null?void 0x0:_0x34fe75[_0x1bd84f(0x1ef)](_0x5a1080))==null?void 0x0:_0x5c8141[_0x1bd84f(0x22f)][_0x1bd84f(0x1dd)](_0x2df3c8,_0x26bcf1);_0x13706c&&_0x5c7c3d[_0x1bd84f(0x239)](_0x2df3c8,_0x26bcf1,_0x13706c);}}}),_0x32b24d[_0x1edab8(0x27f)]({'id':_0x48e781['id'],'params':{'sparklineConfigMap':{[_0x4878cf]:{'config':_0x381950['Tools'][_0x1edab8(0x235)](_0x3da3e8[_0x1edab8(0x1d8)]),'sparklines':_0x5c7c3d[_0x1edab8(0x1ac)]()}},'unitId':_0xb385cc,'subUnitId':_0x2ead9b}}),_0xbbdbb4[_0x1edab8(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'isSingle':!0x1,'groupIds':Array[_0x1edab8(0x1a4)](_0x43e17a)}}),_0xbbdbb4[_0x1edab8(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'sparklineConfigMap':_0x201873}}),_0x381950[_0x1edab8(0x18e)](_0x32b24d,_0x538929),_0x4f03ad['pushUndoRedo']({'unitID':_0xb385cc,'undoMutations':_0xbbdbb4,'redoMutations':_0x32b24d}),!0x0;}else{if(_0x338152){const _0x43a6af=[],_0x3c1db3=[];_0x43a6af[_0x1edab8(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'ranges':_0x18c86e,'isSingle':!0x0}});const _0x6ceb7d=(_0x5a9231=_0x4c7cd1['getSparklineCache']()[_0x1edab8(0x244)][_0x1edab8(0x1ef)](_0xb385cc))==null?void 0x0:_0x5a9231['get'](_0x2ead9b),_0x29f59b={},_0x388550=new Set(),_0x27a04e={};return _0x18c86e['forEach'](_0xb7ed83=>{const _0x5bffbe=_0x1edab8;var _0x3cebad,_0x15b5ce;const {startRow:_0x69ee84,endRow:_0x2041b9,startColumn:_0x1401a7,endColumn:_0x50ccdf}=_0xb7ed83;for(let _0x3ec58b=_0x69ee84;_0x3ec58b<=_0x2041b9;_0x3ec58b++)for(let _0x32c846=_0x1401a7;_0x32c846<=_0x50ccdf;_0x32c846++){const _0x271c87=(_0x3cebad=_0x309dfa==null?void 0x0:_0x309dfa[_0x5bffbe(0x266)]['getValue'](_0x3ec58b,_0x32c846))==null?void 0x0:_0x3cebad[_0x5bffbe(0x208)];if(_0x271c87){const _0x18af4e=new _0x381950['ObjectMatrix'](),_0x214697='g_'+_0x381950['generateRandomId'](0x6);_0x388550['add'](_0x271c87),_0x388550[_0x5bffbe(0x19b)](_0x214697);const _0x405c76=_0x4c7cd1[_0x5bffbe(0x20b)](_0xb385cc,_0x2ead9b,_0x271c87);_0x405c76&&(_0x27a04e[_0x271c87]={'config':_0x381950[_0x5bffbe(0x19c)][_0x5bffbe(0x235)](_0x405c76[_0x5bffbe(0x1d8)]),'sparklines':_0x381950[_0x5bffbe(0x19c)][_0x5bffbe(0x235)](_0x405c76[_0x5bffbe(0x22f)][_0x5bffbe(0x24c)]())});const _0x4f32cd=(_0x15b5ce=_0x6ceb7d==null?void 0x0:_0x6ceb7d[_0x5bffbe(0x1ef)](_0x271c87))==null?void 0x0:_0x15b5ce[_0x5bffbe(0x22f)][_0x5bffbe(0x1dd)](_0x3ec58b,_0x32c846);_0x4f32cd&&_0x18af4e[_0x5bffbe(0x239)](_0x3ec58b,_0x32c846,_0x4f32cd),_0x29f59b[_0x214697]={'sparklines':_0x18af4e[_0x5bffbe(0x1ac)](),'config':_0x381950[_0x5bffbe(0x19c)]['deepClone'](_0x3da3e8[_0x5bffbe(0x1d8)])};}}}),_0x43a6af['push']({'id':_0x48e781['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'sparklineConfigMap':_0x29f59b}}),_0x3c1db3['push']({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'isSingle':!0x1,'groupIds':Array['from'](_0x388550)}}),_0x3c1db3[_0x1edab8(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'sparklineConfigMap':_0x27a04e}}),_0x381950['sequenceExecute'](_0x43a6af,_0x538929),_0x4f03ad[_0x1edab8(0x21e)]({'unitID':_0xb385cc,'undoMutations':_0x3c1db3,'redoMutations':_0x43a6af}),!0x0;}}if(_0xacc6e7){const _0x43c514=_0x406b44['changeDataSourceInfo'];if(!_0x43c514)return!0x1;const {groupId:_0x2677fd,sourceRanges:_0x16d7b2,targetRanges:_0x56623a,resetType:_0x2c38f9,primary:_0x402763}=_0x43c514,_0x502832=[],_0x45adf0=[];_0x502832[_0x1edab8(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'ranges':_0x18c86e,'isSingle':!0x1,'groupIds':[_0x2677fd]}}),_0x45adf0[_0x1edab8(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'ranges':_0x18c86e,'isSingle':!0x1,'groupIds':[_0x2677fd]}});let _0x534209;_0x2c38f9===_0x1edab8(0x1c8)?(_0x534209=new _0x381950[(_0x1edab8(0x205))](_0x3da3e8[_0x1edab8(0x22f)][_0x1edab8(0x24c)]()),_0x534209['realDeleteValue'](_0x402763[_0x1edab8(0x26f)],_0x402763['actualColumn']),_0x534209[_0x1edab8(0x239)](_0x56623a[0x0][_0x1edab8(0x1dc)],_0x56623a[0x0][_0x1edab8(0x228)],_0x16d7b2[0x0])):_0x534209=_0x492f8f(_0x16d7b2,_0x56623a);const _0x2ba704={'config':_0x381950[_0x1edab8(0x19c)][_0x1edab8(0x235)](_0x3da3e8['config']),'sparklines':_0x534209[_0x1edab8(0x1ac)]()},_0x4ee5c8={'config':_0x381950[_0x1edab8(0x19c)][_0x1edab8(0x235)](_0x3da3e8['config']),'sparklines':_0x381950['Tools'][_0x1edab8(0x235)](_0x3da3e8[_0x1edab8(0x22f)]['clone']())};_0x502832[_0x1edab8(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'sparklineConfigMap':{[_0x2677fd]:_0x2ba704}}}),_0x45adf0[_0x1edab8(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'sparklineConfigMap':{[_0x2677fd]:_0x4ee5c8}}}),_0x381950[_0x1edab8(0x18e)](_0x502832,_0x538929),_0x4f03ad[_0x1edab8(0x21e)]({'unitID':_0xb385cc,'undoMutations':_0x45adf0,'redoMutations':_0x502832});}else{const _0x5433aa=[],_0x825519=[],_0x342e99=new Set(),_0x2901f4={};_0x18c86e['forEach'](_0x5683e5=>{const _0x28e752=_0x1edab8;var _0x320821;const {startRow:_0x510fd9,endRow:_0x361a57,startColumn:_0x3bf004,endColumn:_0x280ffc}=_0x5683e5;for(let _0x19c19d=_0x510fd9;_0x19c19d<=_0x361a57;_0x19c19d++)for(let _0x30d7df=_0x3bf004;_0x30d7df<=_0x280ffc;_0x30d7df++){const _0x18f5f0=(_0x320821=_0x309dfa==null?void 0x0:_0x309dfa['matrix'][_0x28e752(0x1dd)](_0x19c19d,_0x30d7df))==null?void 0x0:_0x320821['groupId'];if(_0x18f5f0){_0x342e99[_0x28e752(0x19b)](_0x18f5f0);const _0x4f3122=_0x4c7cd1[_0x28e752(0x20b)](_0xb385cc,_0x2ead9b,_0x18f5f0);_0x4f3122&&(_0x2901f4[_0x18f5f0]={'config':_0x381950[_0x28e752(0x19c)][_0x28e752(0x235)](_0x4f3122[_0x28e752(0x1d8)]),'sparklines':_0x381950[_0x28e752(0x19c)][_0x28e752(0x235)](_0x4f3122[_0x28e752(0x22f)][_0x28e752(0x24c)]())});}}}),_0x825519[_0x1edab8(0x27f)]({'id':_0x3f022e['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'groupIds':Array[_0x1edab8(0x1a4)](_0x342e99),'config':{'config':_0x381950['Tools']['deepClone'](_0x3da3e8[_0x1edab8(0x1d8)]),'sparklines':_0x3da3e8['sparklines'][_0x1edab8(0x1ac)]()}}}),_0x5433aa[_0x1edab8(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'isSingle':!0x1,'groupIds':Array[_0x1edab8(0x1a4)](_0x342e99)}}),_0x5433aa['push']({'id':_0x48e781['id'],'params':{'unitId':_0xb385cc,'subUnitId':_0x2ead9b,'sparklineConfigMap':_0x2901f4}}),_0x381950[_0x1edab8(0x18e)](_0x825519,_0x538929),_0x4f03ad[_0x1edab8(0x21e)]({'unitID':_0xb385cc,'undoMutations':_0x5433aa,'redoMutations':_0x825519});}return!0x0;}};var _0x41b955=Object[_0x17e5c7(0x255)],_0x16bcb5=(_0x486242,_0x4684bd,_0x8ba3a6,_0x1c0863)=>{const _0x358a60=_0x17e5c7;for(var _0x509765=_0x1c0863>0x1?void 0x0:_0x1c0863?_0x41b955(_0x4684bd,_0x8ba3a6):_0x4684bd,_0xd00d48=_0x486242[_0x358a60(0x187)]-0x1,_0x44bac9;_0xd00d48>=0x0;_0xd00d48--)(_0x44bac9=_0x486242[_0xd00d48])&&(_0x509765=_0x44bac9(_0x509765)||_0x509765);return _0x509765;},_0x2d2775=(_0x51b9c7,_0x134501)=>(_0x1610ea,_0x49a047)=>_0x134501(_0x1610ea,_0x49a047,_0x51b9c7);let _0x1eeded=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x59bc0b,_0x20406f,_0x3ab7a3,_0x3f4a35){const _0x4c5c15=_0x17e5c7;super(),this[_0x4c5c15(0x1a2)]=_0x59bc0b,this['_sheetInterceptorService']=_0x20406f,this['_univerInstanceService']=_0x3ab7a3,this[_0x4c5c15(0x27e)]=_0x3f4a35,this[_0x4c5c15(0x1e7)]();}[_0x17e5c7(0x1e7)](){const _0x381744=_0x17e5c7;this[_0x381744(0x24f)](this[_0x381744(0x19d)][_0x381744(0x277)]({'getMutations':_0xdf9bf=>{const _0x2f0781=_0x381744,_0x205be6=[],_0x3ec3a=[];if(_0xdf9bf['id']===_0x3292ab['ClearSelectionAllCommand']['id']){const _0x19a433=_0x3292ab[_0x2f0781(0x1d6)](this[_0x2f0781(0x1e0)]);if(!_0x19a433)return{'redos':_0x205be6,'undos':_0x3ec3a};const {unitId:_0x58db20,subUnitId:_0x321bae,worksheet:_0x25b910}=_0x19a433,_0x15b3ba=this['_sheetSelectionService'][_0x2f0781(0x251)]()[_0x2f0781(0x26c)](_0x2ebc5c=>_0x2ebc5c[_0x2f0781(0x193)]),_0x190b68=new Set(),_0xabeddd={},_0xd29855={};_0x15b3ba[_0x2f0781(0x25b)](_0x22a881=>{const _0x44177e=_0x2f0781;_0x381950[_0x44177e(0x1f1)][_0x44177e(0x267)](_0x22a881,(_0x1d8f37,_0x16d9d3)=>{const _0x74fee9=_0x44177e,_0x1859f7=this[_0x74fee9(0x1a2)][_0x74fee9(0x23d)](_0x58db20,_0x321bae,_0x1d8f37,_0x16d9d3);if(_0x1859f7&&!_0x190b68[_0x74fee9(0x1df)](_0x1859f7)){const _0x2b92ba=this[_0x74fee9(0x1a2)][_0x74fee9(0x20b)](_0x58db20,_0x321bae,_0x1859f7);_0x2b92ba&&(_0x190b68['add'](_0x1859f7),_0xabeddd[_0x1859f7]={'config':_0x381950[_0x74fee9(0x19c)][_0x74fee9(0x235)](_0x2b92ba[_0x74fee9(0x1d8)]),'sparklines':_0x381950[_0x74fee9(0x19c)][_0x74fee9(0x235)](_0x2b92ba['sparklines'][_0x74fee9(0x24c)]())},_0xd29855[_0x1859f7]={'config':_0x381950['Tools'][_0x74fee9(0x235)](_0x2b92ba[_0x74fee9(0x1d8)]),'sparklines':_0x381950[_0x74fee9(0x19c)][_0x74fee9(0x235)](_0x2b92ba[_0x74fee9(0x22f)]['clone']())});}});}),Object[_0x2f0781(0x222)](_0xd29855)[_0x2f0781(0x25b)](_0x60f3ac=>{const _0x3e0dcf=_0x2f0781,_0x4b3b84=_0x60f3ac['sparklines'];new _0x381950[(_0x3e0dcf(0x205))](_0x4b3b84)['forValue']((_0x2ca450,_0x352164,_0x5a762d)=>{const _0x57a688=_0x3e0dcf;_0x15b3ba['some'](_0x225730=>_0x381950[_0x57a688(0x1a9)][_0x57a688(0x1c3)](_0x225730,_0x381950[_0x57a688(0x22b)](_0x2ca450,_0x352164)))&&delete _0x4b3b84[_0x2ca450][_0x352164];});}),_0x205be6[_0x2f0781(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x58db20,'subUnitId':_0x321bae,'groupIds':Array[_0x2f0781(0x1a4)](_0x190b68),'isSingle':!0x1}}),_0x205be6[_0x2f0781(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x58db20,'subUnitId':_0x321bae,'sparklineConfigMap':_0xd29855}}),_0x3ec3a[_0x2f0781(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x58db20,'subUnitId':_0x321bae,'groupIds':Array[_0x2f0781(0x1a4)](_0x190b68),'isSingle':!0x1}}),_0x3ec3a[_0x2f0781(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x58db20,'subUnitId':_0x321bae,'sparklineConfigMap':_0xabeddd}});}return{'redos':_0x205be6,'undos':_0x3ec3a};}}));}};_0x1eeded=_0x16bcb5([_0x2d2775(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x12f13f[_0x17e5c7(0x1b2)])),_0x2d2775(0x1,_0x381950[_0x17e5c7(0x1f3)](_0x3292ab[_0x17e5c7(0x236)])),_0x2d2775(0x2,_0x381950[_0x17e5c7(0x1f3)](_0x381950['IUniverInstanceService'])),_0x2d2775(0x3,_0x381950[_0x17e5c7(0x1f3)](_0x3292ab[_0x17e5c7(0x269)]))],_0x1eeded);var _0x5f5ce4=Object[_0x17e5c7(0x255)],_0x203707=(_0x47b228,_0x1db1ff,_0x52fb5f,_0x443ec9)=>{const _0x589c3f=_0x17e5c7;for(var _0x4100f3=_0x443ec9>0x1?void 0x0:_0x443ec9?_0x5f5ce4(_0x1db1ff,_0x52fb5f):_0x1db1ff,_0x48601e=_0x47b228[_0x589c3f(0x187)]-0x1,_0x5b0af8;_0x48601e>=0x0;_0x48601e--)(_0x5b0af8=_0x47b228[_0x48601e])&&(_0x4100f3=_0x5b0af8(_0x4100f3)||_0x4100f3);return _0x4100f3;},_0x7fd324=(_0x7a5827,_0x5a0122)=>(_0x3d88c6,_0x26d35a)=>_0x5a0122(_0x3d88c6,_0x26d35a,_0x7a5827);let _0x5b6f8d=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x43701d,_0x17426b,_0x1ac6d0){const _0x131101=_0x17e5c7;super(),this[_0x131101(0x1a7)]=_0x43701d,this[_0x131101(0x1a2)]=_0x17426b,this[_0x131101(0x1a1)]=_0x1ac6d0,this[_0x131101(0x275)](),this[_0x131101(0x223)]();}[_0x17e5c7(0x275)](){const _0x1b313d=_0x17e5c7;this[_0x1b313d(0x24f)](this[_0x1b313d(0x1a7)]['onCommandExecuted'](_0x1e5ce9=>{const _0x538db3=_0x1b313d;if(_0x1e5ce9['id']===_0x3292ab['SetRangeValuesMutation']['id']){const _0x19bedc=_0x1e5ce9[_0x538db3(0x1eb)],{cellValue:_0x27624b,unitId:_0x10cb1a,subUnitId:_0xe1741d}=_0x19bedc,_0x15928c=new _0x381950['ObjectMatrix'](_0x27624b),_0x10269a=new Set(),_0x90743d=this[_0x538db3(0x1a2)]['getSubUnitSparkline'](_0x10cb1a,_0xe1741d);if(!_0x90743d)return;const _0x59e94c=Array[_0x538db3(0x1a4)](_0x90743d);_0x15928c[_0x538db3(0x265)]((_0x3a357a,_0x5a46d6,_0x304112)=>{const _0x3473e5=_0x538db3,_0x5c4823=_0x381950[_0x3473e5(0x22b)](_0x3a357a,_0x5a46d6);for(let _0x48c770=0x0;_0x48c770<_0x59e94c[_0x3473e5(0x187)];_0x48c770++){const [_0x27c086,_0x2f685f]=_0x59e94c[_0x48c770],_0x323c25=_0x10269a[_0x3473e5(0x1df)](_0x27c086);_0x323c25||_0x2f685f[_0x3473e5(0x22f)]['forValue']((_0x242e81,_0x10ac75,_0x4529c2)=>{const _0x787d3b=_0x3473e5,_0x5c9bef=_0x4529c2;if(_0x5c9bef&&!_0x323c25&&_0x381950['Rectangle']['intersects'](_0x5c4823,_0x5c9bef))return _0x10269a[_0x787d3b(0x19b)](_0x27c086),!0x0;});}}),_0x10269a[_0x538db3(0x25b)](_0x21c14a=>{const _0x38ce2f=_0x538db3;this[_0x38ce2f(0x1a2)]['clearSparklineCache'](_0x10cb1a,_0xe1741d,_0x21c14a),this['_sparklineDataSourceModel'][_0x38ce2f(0x1d7)](_0x10cb1a,_0xe1741d,_0x21c14a);});}else{if(_0x1e5ce9['id']===_0x3292ab[_0x538db3(0x220)]['id']){const _0x5b481f=_0x1e5ce9[_0x538db3(0x1eb)],{range:_0x4f4783,unitId:_0x1fe3ba,subUnitId:_0x3ba477}=_0x5b481f,_0x3e452b=new Set(),_0x787d17=this[_0x538db3(0x1a2)][_0x538db3(0x273)](_0x1fe3ba,_0x3ba477);if(!_0x787d17)return;const _0xbd8c26=Array[_0x538db3(0x1a4)](_0x787d17);for(let _0x7034d1=0x0;_0x7034d1<_0xbd8c26[_0x538db3(0x187)];_0x7034d1++){const [_0x6351e9,_0x49ffff]=_0xbd8c26[_0x7034d1],_0xa5fabf=_0x3e452b[_0x538db3(0x1df)](_0x6351e9);_0xa5fabf||_0x49ffff['sparklines'][_0x538db3(0x265)]((_0x4fcfc9,_0x2b7f4e,_0x43ebce)=>{const _0x4f8fb8=_0x538db3,_0x1ae84a=_0x43ebce;if(_0x1ae84a&&!_0xa5fabf&&_0x381950[_0x4f8fb8(0x1a9)][_0x4f8fb8(0x1c3)](_0x4f4783,_0x1ae84a))return _0x3e452b[_0x4f8fb8(0x19b)](_0x6351e9),!0x0;});}_0x3e452b['forEach'](_0x3c0682=>{const _0x358023=_0x538db3;this[_0x358023(0x1a2)][_0x358023(0x21d)](_0x1fe3ba,_0x3ba477,_0x3c0682),this[_0x358023(0x1a2)][_0x358023(0x1d7)](_0x1fe3ba,_0x3ba477,_0x3c0682);});}}}));}[_0x17e5c7(0x223)](){const _0x124fe9=_0x17e5c7;this[_0x124fe9(0x24f)](this['_exclusiveRangeService'][_0x124fe9(0x1be)][_0x124fe9(0x1f5)](_0x1a2a00=>{const _0x2bce8d=_0x124fe9,{unitId:_0x16c025,subUnitId:_0x309d02,ranges:_0x1058f0}=_0x1a2a00,_0x29d478=this[_0x2bce8d(0x1a2)][_0x2bce8d(0x273)](_0x16c025,_0x309d02);if(!_0x29d478)return;const _0x2d38a9=Array[_0x2bce8d(0x1a4)](_0x29d478),_0x399843=new Set();for(let _0xf5a84a=0x0;_0xf5a84a<_0x2d38a9[_0x2bce8d(0x187)];_0xf5a84a++){const [_0x30faac,_0xa1112d]=_0x2d38a9[_0xf5a84a],_0xf564c1=_0x399843['has'](_0x30faac);_0xf564c1||_0xa1112d[_0x2bce8d(0x22f)][_0x2bce8d(0x265)]((_0xefadd6,_0x9fcad,_0x2f00c3)=>{const _0x18ee79=_0x2bce8d,_0x2a5aed=_0x2f00c3;if(_0x2a5aed&&!_0xf564c1){for(const _0x480569 of _0x1058f0)if(_0x381950['Rectangle'][_0x18ee79(0x1c3)](_0x480569,_0x2a5aed)){_0x399843[_0x18ee79(0x19b)](_0x30faac);break;}}});}_0x399843[_0x2bce8d(0x25b)](_0x117ab2=>{const _0xa2343d=_0x2bce8d;this[_0xa2343d(0x1a2)][_0xa2343d(0x21d)](_0x16c025,_0x309d02,_0x117ab2),this[_0xa2343d(0x1a2)]['updateSparklineExtraNum'](_0x16c025,_0x309d02,_0x117ab2);});}));}};_0x5b6f8d=_0x203707([_0x7fd324(0x0,_0x381950['Inject'](_0x381950[_0x17e5c7(0x1ab)])),_0x7fd324(0x1,_0x381950['Inject'](_0x12f13f[_0x17e5c7(0x1b2)])),_0x7fd324(0x2,_0x381950[_0x17e5c7(0x1f3)](_0x3292ab[_0x17e5c7(0x1f7)]))],_0x5b6f8d);var _0x24a4da=Object[_0x17e5c7(0x255)],_0x52cbe5=(_0x3548b6,_0x3e5027,_0x29f324,_0x1d7daa)=>{const _0x571225=_0x17e5c7;for(var _0x5ab1ca=_0x1d7daa>0x1?void 0x0:_0x1d7daa?_0x24a4da(_0x3e5027,_0x29f324):_0x3e5027,_0x1cb755=_0x3548b6[_0x571225(0x187)]-0x1,_0xe62091;_0x1cb755>=0x0;_0x1cb755--)(_0xe62091=_0x3548b6[_0x1cb755])&&(_0x5ab1ca=_0xe62091(_0x5ab1ca)||_0x5ab1ca);return _0x5ab1ca;},_0x44b323=(_0x3d37f0,_0x4626d2)=>(_0xf2efb0,_0x1629eb)=>_0x4626d2(_0xf2efb0,_0x1629eb,_0x3d37f0);let _0x3ad5ac=class extends _0x381950['Disposable']{constructor(_0x29246f,_0x339af1){const _0x5a0f75=_0x17e5c7;super(),this[_0x5a0f75(0x1a7)]=_0x29246f,this[_0x5a0f75(0x1a2)]=_0x339af1,this[_0x5a0f75(0x27a)]();}[_0x17e5c7(0x27a)](){const _0x364f69=_0x17e5c7;this[_0x364f69(0x1a7)]['onCommandExecuted'](_0x3fa34b=>{const _0x43fd5f=_0x364f69;if(_0x3fa34b['id']===_0x3292ab[_0x43fd5f(0x1ea)]['id']||_0x3fa34b['id']===_0x3292ab[_0x43fd5f(0x210)]['id']||_0x3fa34b['id']===_0x3292ab[_0x43fd5f(0x212)]['id']||_0x3fa34b['id']===_0x3292ab[_0x43fd5f(0x216)]['id']){const _0x2aa309=_0x3fa34b[_0x43fd5f(0x1eb)],{ranges:_0x3d55c7,unitId:_0x5d249e,subUnitId:_0x51c04a}=_0x2aa309,_0x48e0a2=new Set(),_0x2f75ed=this['_sparklineDataSourceModel'][_0x43fd5f(0x273)](_0x5d249e,_0x51c04a);if(!_0x2f75ed)return;const _0x394ab6=Array['from'](_0x2f75ed);_0x3d55c7['forEach'](_0x1c2d84=>{const _0x38c1e7=_0x43fd5f;_0x381950[_0x38c1e7(0x1f1)][_0x38c1e7(0x267)](_0x1c2d84,(_0x1c4f79,_0xee701e)=>{const _0x3f381c=_0x38c1e7,_0x499299=_0x381950[_0x3f381c(0x22b)](_0x1c4f79,_0xee701e);for(let _0x363aea=0x0;_0x363aea<_0x394ab6['length'];_0x363aea++){const [_0x772e25,_0x2bd13b]=_0x394ab6[_0x363aea],_0x4f6e43=_0x48e0a2[_0x3f381c(0x1df)](_0x772e25);_0x4f6e43||_0x2bd13b['sparklines'][_0x3f381c(0x265)]((_0x204fec,_0x261e75,_0x5368e8)=>{const _0x495b71=_0x3f381c,_0x3448e1=_0x5368e8;if(_0x3448e1&&!_0x4f6e43&&_0x381950[_0x495b71(0x1a9)][_0x495b71(0x1c3)](_0x499299,_0x3448e1))return _0x48e0a2[_0x495b71(0x19b)](_0x772e25),!0x0;});}});}),_0x48e0a2[_0x43fd5f(0x25b)](_0x52a891=>{const _0x25fc63=_0x43fd5f;this[_0x25fc63(0x1a2)][_0x25fc63(0x21d)](_0x5d249e,_0x51c04a,_0x52a891),this[_0x25fc63(0x1a2)][_0x25fc63(0x1d7)](_0x5d249e,_0x51c04a,_0x52a891);});}});}};_0x3ad5ac=_0x52cbe5([_0x44b323(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x381950[_0x17e5c7(0x1ab)])),_0x44b323(0x1,_0x381950[_0x17e5c7(0x1f3)](_0x12f13f['SparklineDataSourceModel']))],_0x3ad5ac);var _0x344df2=Object['getOwnPropertyDescriptor'],_0x4e20f2=(_0x5a7948,_0x293837,_0xeaa27,_0x2eed78)=>{const _0x157c4b=_0x17e5c7;for(var _0x5d69ad=_0x2eed78>0x1?void 0x0:_0x2eed78?_0x344df2(_0x293837,_0xeaa27):_0x293837,_0x439b53=_0x5a7948[_0x157c4b(0x187)]-0x1,_0x4ddd79;_0x439b53>=0x0;_0x439b53--)(_0x4ddd79=_0x5a7948[_0x439b53])&&(_0x5d69ad=_0x4ddd79(_0x5d69ad)||_0x5d69ad);return _0x5d69ad;},_0x1505b8=(_0x35ddf5,_0x4e55b1)=>(_0x53e395,_0x2f393c)=>_0x4e55b1(_0x53e395,_0x2f393c,_0x35ddf5);let _0x27b93d=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x22e947,_0x340d26,_0x4c024d){const _0x1f8189=_0x17e5c7;super(),this[_0x1f8189(0x1a7)]=_0x22e947,this[_0x1f8189(0x19d)]=_0x340d26,this[_0x1f8189(0x1a2)]=_0x4c024d,this[_0x1f8189(0x237)]();}[_0x17e5c7(0x237)](){const _0x897046=_0x17e5c7;this['disposeWithMe'](this[_0x897046(0x19d)][_0x897046(0x277)]({'getMutations':_0x248643=>{const _0x4f994e=_0x897046,_0x4db068=[],_0x22e0cd=[];if(_0x248643['id']===_0x3292ab[_0x4f994e(0x1d1)]['id']){const _0x478621=_0x248643['params'];if(!_0x478621)return{'redos':_0x4db068,'undos':_0x22e0cd};const {unitId:_0x30107e,subUnitId:_0x28bf1b,ranges:_0x30fea7}=_0x478621,_0x352388=this['_sparklineDataSourceModel']['getSubUnitSparkline'](_0x30107e,_0x28bf1b);if(!_0x352388)return{'redos':_0x4db068,'undos':_0x22e0cd};const _0x21c22f={},_0x425674={},_0x5e73d6=new Set();_0x30fea7[_0x4f994e(0x25b)](_0x32c5e4=>{const _0x5afad1=_0x4f994e,_0x2b456f=_0x32c5e4[_0x5afad1(0x1dc)],_0x1fbc58=_0x32c5e4[_0x5afad1(0x228)];_0x381950[_0x5afad1(0x1f1)][_0x5afad1(0x267)](_0x32c5e4,(_0x485cf7,_0x310f94)=>{const _0x30818b=_0x5afad1,_0x197de6=this[_0x30818b(0x1a2)][_0x30818b(0x23d)](_0x30107e,_0x28bf1b,_0x485cf7,_0x310f94);if(_0x197de6&&!(_0x485cf7===_0x2b456f&&_0x310f94===_0x1fbc58)){const _0x34faca=this[_0x30818b(0x1a2)][_0x30818b(0x20b)](_0x30107e,_0x28bf1b,_0x197de6);if(_0x34faca){_0x5e73d6['add'](_0x197de6);let _0x2650d5=_0x21c22f[_0x197de6];_0x2650d5||(_0x2650d5={'config':_0x381950[_0x30818b(0x19c)][_0x30818b(0x235)](_0x34faca[_0x30818b(0x1d8)]),'sparklines':new _0x381950[(_0x30818b(0x205))](_0x34faca[_0x30818b(0x22f)][_0x30818b(0x24c)]())},_0x21c22f[_0x197de6]=_0x2650d5),_0x2650d5['sparklines'][_0x30818b(0x1d0)](_0x485cf7,_0x310f94),_0x425674[_0x197de6]={'config':_0x381950[_0x30818b(0x19c)][_0x30818b(0x235)](_0x34faca[_0x30818b(0x1d8)]),'sparklines':_0x381950['Tools']['deepClone'](_0x34faca[_0x30818b(0x22f)][_0x30818b(0x24c)]())};}}});});for(const [_0x1fdedb,_0x10757b]of _0x352388){const _0xa47799=_0x10757b[_0x4f994e(0x22f)];_0xa47799[_0x4f994e(0x265)]((_0x4ced28,_0x1b5e6b,_0x282a23)=>{const _0x255e29=_0x4f994e;for(let _0x3b8c68=0x0;_0x3b8c68<_0x30fea7[_0x255e29(0x187)];_0x3b8c68++){const _0x3f98f4=_0x30fea7[_0x3b8c68];if(_0x381950['Rectangle']['contains'](_0x3f98f4,_0x282a23)){_0x5e73d6[_0x255e29(0x19b)](_0x1fdedb);let _0x116093=_0x21c22f[_0x1fdedb];_0x116093||(_0x116093={'config':_0x381950[_0x255e29(0x19c)][_0x255e29(0x235)](_0x10757b[_0x255e29(0x1d8)]),'sparklines':new _0x381950[(_0x255e29(0x205))](_0xa47799[_0x255e29(0x24c)]())},_0x21c22f[_0x1fdedb]=_0x116093),_0x116093[_0x255e29(0x22f)]['realDeleteValue'](_0x4ced28,_0x1b5e6b),_0x425674[_0x1fdedb]||(_0x425674[_0x1fdedb]={'config':_0x381950[_0x255e29(0x19c)][_0x255e29(0x235)](_0x10757b[_0x255e29(0x1d8)]),'sparklines':_0x381950['Tools']['deepClone'](_0xa47799['clone']())});}}});}const _0x3657c4={};Object[_0x4f994e(0x200)](_0x21c22f)[_0x4f994e(0x25b)](([_0x41e7dc,_0x488f0b])=>{const _0x3ff22f=_0x4f994e;_0x488f0b['sparklines'][_0x3ff22f(0x1ad)]()&&(_0x3657c4[_0x41e7dc]={'config':_0x488f0b['config'],'sparklines':_0x488f0b[_0x3ff22f(0x22f)][_0x3ff22f(0x24c)]()});}),_0x5e73d6[_0x4f994e(0x261)]&&(_0x4db068[_0x4f994e(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x30107e,'subUnitId':_0x28bf1b,'groupIds':Array['from'](_0x5e73d6),'isSingle':!0x1}}),_0x22e0cd[_0x4f994e(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x30107e,'subUnitId':_0x28bf1b,'groupIds':Array[_0x4f994e(0x1a4)](_0x5e73d6),'isSingle':!0x1}}),_0x4db068[_0x4f994e(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x30107e,'subUnitId':_0x28bf1b,'sparklineConfigMap':_0x3657c4}}),_0x22e0cd[_0x4f994e(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x30107e,'subUnitId':_0x28bf1b,'sparklineConfigMap':_0x425674}}));}return{'redos':_0x4db068,'undos':_0x22e0cd};}}));}};_0x27b93d=_0x4e20f2([_0x1505b8(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x381950[_0x17e5c7(0x1ab)])),_0x1505b8(0x1,_0x381950[_0x17e5c7(0x1f3)](_0x3292ab[_0x17e5c7(0x236)])),_0x1505b8(0x2,_0x381950[_0x17e5c7(0x1f3)](_0x12f13f[_0x17e5c7(0x1b2)]))],_0x27b93d);var _0x187449=Object[_0x17e5c7(0x255)],_0x337475=(_0x372a69,_0x183292,_0x544101,_0x153e82)=>{const _0x4e2949=_0x17e5c7;for(var _0x31ed04=_0x153e82>0x1?void 0x0:_0x153e82?_0x187449(_0x183292,_0x544101):_0x183292,_0x4ad00d=_0x372a69[_0x4e2949(0x187)]-0x1,_0x5dba01;_0x4ad00d>=0x0;_0x4ad00d--)(_0x5dba01=_0x372a69[_0x4ad00d])&&(_0x31ed04=_0x5dba01(_0x31ed04)||_0x31ed04);return _0x31ed04;},_0x3875ff=(_0x4e49f8,_0x4c5c41)=>(_0x9a9fed,_0xe67e9d)=>_0x4c5c41(_0x9a9fed,_0xe67e9d,_0x4e49f8);let _0x559d6f=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x58f245,_0x105a12,_0x9fc237,_0x32c81e){const _0x44f310=_0x17e5c7;super(),_0x46cdd1(this,_0x44f310(0x1f2),new _0x381950[(_0x44f310(0x23b))]()),(this['_commandService']=_0x58f245,this['_refRangeService']=_0x105a12,this[_0x44f310(0x1e0)]=_0x9fc237,this[_0x44f310(0x1a2)]=_0x32c81e,this[_0x44f310(0x1b3)](),this[_0x44f310(0x26a)]());}['_onRefRangeChange'](){const _0x363e40=_0x17e5c7,_0x3fd2f3=(_0x45591a,_0x587990)=>{const _0x3ab665=_0xce16,_0x1a551f=this[_0x3ab665(0x1e0)][_0x3ab665(0x1b6)](_0x381950[_0x3ab665(0x281)]['UNIVER_SHEET']);if(!_0x1a551f||!(_0x1a551f==null?void 0x0:_0x1a551f[_0x3ab665(0x1db)](_0x587990)))return;this[_0x3ab665(0x1f2)]['dispose']();const _0x280a3b=_0x51ff10=>this['refRangeHandle'](_0x51ff10,_0x45591a,_0x587990),_0x3896f5=[],_0x25a337=this[_0x3ab665(0x1a2)][_0x3ab665(0x273)](_0x45591a,_0x587990);if(_0x25a337){for(const [_0x5c1dd2,_0x31d4e0]of _0x25a337)_0x31d4e0['sparklines']['forValue']((_0x1ebd39,_0x59eb70,_0x1a2ba7)=>{const _0x14f190=_0x3ab665,_0x5724fa=_0x381950[_0x14f190(0x22b)](_0x1ebd39,_0x59eb70);_0x3896f5[_0x14f190(0x27f)](_0x5724fa);});_0x3896f5[_0x3ab665(0x25b)](_0x406895=>{const _0x22e11b=_0x3ab665;this['disposableCollection']['add'](this[_0x22e11b(0x1cf)][_0x22e11b(0x234)](_0x406895,_0x280a3b,_0x45591a,_0x587990));});}};this[_0x363e40(0x24f)](this['_commandService'][_0x363e40(0x23f)](_0xcd40ca=>{const _0x13e5bb=_0x363e40;if(_0xcd40ca['id']===_0x3292ab[_0x13e5bb(0x183)]['id']){const _0x463534=_0xcd40ca[_0x13e5bb(0x1eb)],_0x4e4ce8=_0x463534['subUnitId'],_0x70501c=_0x463534[_0x13e5bb(0x242)];if(!_0x4e4ce8||!_0x70501c)return;_0x3fd2f3(_0x70501c,_0x4e4ce8);}if(_0xcd40ca['id']===_0x3f022e['id']||_0xcd40ca['id']===_0x48e781['id']){const _0x184df4=_0xcd40ca[_0x13e5bb(0x1eb)],_0x4ca479=_0x184df4['subUnitId'],_0x495099=_0x184df4['unitId'];if(!_0x4ca479||!_0x495099)return;_0x3fd2f3(_0x495099,_0x4ca479);}}));}['refRangeHandle'](_0x513105,_0x5f907,_0x52a353){const _0x2b0942=_0x17e5c7;switch(_0x513105['id']){case _0x3292ab[_0x2b0942(0x185)]['id']:return this['_getRefRangeMutationsByDeleteCols'](_0x513105[_0x2b0942(0x1eb)],_0x5f907,_0x52a353);case _0x3292ab[_0x2b0942(0x250)]['id']:return this[_0x2b0942(0x26d)](_0x513105[_0x2b0942(0x1eb)],_0x5f907,_0x52a353);}return{'redos':[],'undos':[]};}[_0x17e5c7(0x26d)](_0x58c713,_0x3b2585,_0x6a9ac7){const _0x1cefd7=_0x17e5c7;var _0x2029b5,_0x421e46;const {range:_0x27983b}=_0x58c713,_0x1d1020=new Set(),_0x3bc9b2={},_0xd614e={},_0x5bc455=[],_0x30d198=[],_0x46ca8b=[],_0xbeae58=[];if(!_0x3292ab[_0x1cefd7(0x1d6)](this[_0x1cefd7(0x1e0)],{'unitId':_0x3b2585,'subUnitId':_0x6a9ac7}))return{'redos':_0x30d198,'undos':_0x5bc455};const _0x1aa1eb=this[_0x1cefd7(0x1a2)][_0x1cefd7(0x273)](_0x3b2585,_0x6a9ac7);if(!_0x1aa1eb)return{'redos':_0x30d198,'undos':_0x5bc455};if(!((_0x421e46=(_0x2029b5=this[_0x1cefd7(0x1a2)][_0x1cefd7(0x198)]()['sparklineAnchorMap'][_0x1cefd7(0x1ef)](_0x3b2585))==null?void 0x0:_0x2029b5[_0x1cefd7(0x1ef)](_0x6a9ac7))==null?void 0x0:_0x421e46[_0x1cefd7(0x266)]))return{'redos':_0x30d198,'undos':_0x5bc455};for(const [_0x4c6220,_0x122fc1]of _0x1aa1eb){const _0xf337e1=_0x122fc1[_0x1cefd7(0x22f)];_0xf337e1['forValue']((_0x5e0929,_0x5f196d,_0x3a72b2)=>{const _0x5614b1=_0x1cefd7;if(_0x381950[_0x5614b1(0x1a9)][_0x5614b1(0x1c3)](_0x27983b,_0x3a72b2)){_0x1d1020[_0x5614b1(0x19b)](_0x4c6220);let _0x34d0a3=_0xd614e[_0x4c6220];_0x34d0a3||(_0x34d0a3={'config':_0x122fc1['config'],'sparklines':_0x122fc1[_0x5614b1(0x22f)][_0x5614b1(0x24c)]()},_0xd614e[_0x4c6220]=_0x34d0a3);let _0x2f9bf6=_0x3bc9b2[_0x4c6220];_0x2f9bf6||(_0x2f9bf6={'config':_0x122fc1[_0x5614b1(0x1d8)],'sparklines':new _0x381950['ObjectMatrix'](_0x122fc1[_0x5614b1(0x22f)][_0x5614b1(0x24c)]())},_0x3bc9b2[_0x4c6220]=_0x2f9bf6);const _0x266e7b=_0x3292ab['adjustRangeOnMutation'](_0x3a72b2,{'id':_0x3292ab[_0x5614b1(0x27d)]['id'],'params':_0x58c713});_0x266e7b?_0x2f9bf6[_0x5614b1(0x22f)][_0x5614b1(0x239)](_0x5e0929,_0x5f196d,_0x266e7b):_0x2f9bf6['sparklines']['setValue'](_0x5e0929,_0x5f196d,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x381950['RANGE_TYPE'][_0x5614b1(0x23a)]});}}),_0xf337e1[_0x1cefd7(0x265)]((_0x2077aa,_0x234e1b,_0x3fa05a)=>{const _0x4fe8f6=_0x1cefd7;if(_0x2077aa<=_0x27983b[_0x4fe8f6(0x18f)]&&_0x2077aa>=_0x27983b[_0x4fe8f6(0x1dc)]){_0x1d1020[_0x4fe8f6(0x19b)](_0x4c6220);let _0x2045bc=_0xd614e[_0x4c6220];_0x2045bc||(_0x2045bc={'config':_0x122fc1['config'],'sparklines':_0x122fc1[_0x4fe8f6(0x22f)][_0x4fe8f6(0x24c)]()},_0xd614e[_0x4c6220]=_0x2045bc);let _0x5e2c60=_0x3bc9b2[_0x4c6220];_0x5e2c60||(_0x5e2c60={'config':_0x122fc1[_0x4fe8f6(0x1d8)],'sparklines':new _0x381950[(_0x4fe8f6(0x205))](_0x122fc1[_0x4fe8f6(0x22f)][_0x4fe8f6(0x24c)]())},_0x3bc9b2[_0x4c6220]=_0x5e2c60);}});}_0xbeae58[_0x1cefd7(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x3b2585,'subUnitId':_0x6a9ac7,'groupIds':Array[_0x1cefd7(0x1a4)](_0x1d1020),'isSingle':!0x1}}),_0x46ca8b[_0x1cefd7(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0x3b2585,'subUnitId':_0x6a9ac7,'groupIds':Array[_0x1cefd7(0x1a4)](_0x1d1020),'isSingle':!0x1}});const _0x10bff2={};let _0x480ed2=!0x1;return Object[_0x1cefd7(0x200)](_0x3bc9b2)[_0x1cefd7(0x25b)](([_0x3b8424,_0x2cd8c1])=>{const _0x45b7f2=_0x1cefd7;_0x2cd8c1[_0x45b7f2(0x22f)]['getSizeOf']()&&(_0x480ed2=!0x0,_0x2cd8c1[_0x45b7f2(0x22f)][_0x45b7f2(0x186)](_0x27983b[_0x45b7f2(0x1dc)],_0x27983b[_0x45b7f2(0x18f)]-_0x27983b['startRow']+0x1),_0x10bff2[_0x3b8424]={'config':_0x2cd8c1[_0x45b7f2(0x1d8)],'sparklines':_0x2cd8c1[_0x45b7f2(0x22f)][_0x45b7f2(0x24c)]()});}),_0x480ed2&&_0x30d198[_0x1cefd7(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x3b2585,'subUnitId':_0x6a9ac7,'sparklineConfigMap':_0x10bff2}}),_0x5bc455[_0x1cefd7(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0x3b2585,'subUnitId':_0x6a9ac7,'sparklineConfigMap':_0xd614e}}),{'redos':_0x30d198,'undos':_0x5bc455,'preRedos':_0x46ca8b,'preUndos':_0xbeae58};}[_0x17e5c7(0x263)](_0x1dbaed,_0xd2ee7,_0xe753fb){const _0xe87191=_0x17e5c7;var _0x15f0e4,_0x1622d9;const {range:_0x213f24}=_0x1dbaed,_0x2c0686=new Set(),_0x346a21={},_0x1ee9c9={},_0x4e93f5=[],_0x3eee6e=[],_0x48c007=[],_0x227910=[];if(!_0x3292ab['getSheetCommandTarget'](this[_0xe87191(0x1e0)],{'unitId':_0xd2ee7,'subUnitId':_0xe753fb}))return{'redos':_0x3eee6e,'undos':_0x4e93f5};const _0x5a7c50=this[_0xe87191(0x1a2)][_0xe87191(0x273)](_0xd2ee7,_0xe753fb);if(!_0x5a7c50)return{'redos':_0x3eee6e,'undos':_0x4e93f5};if(!((_0x1622d9=(_0x15f0e4=this['_sparklineDataSourceModel']['getSparklineCache']()['sparklineAnchorMap']['get'](_0xd2ee7))==null?void 0x0:_0x15f0e4[_0xe87191(0x1ef)](_0xe753fb))==null?void 0x0:_0x1622d9[_0xe87191(0x266)]))return{'redos':_0x3eee6e,'undos':_0x4e93f5};for(const [_0x2b5898,_0x66f37e]of _0x5a7c50){const _0x47cd88=_0x66f37e[_0xe87191(0x22f)];_0x47cd88[_0xe87191(0x265)]((_0x2e9c10,_0x4700d7,_0x444c92)=>{const _0x5171b6=_0xe87191;if(_0x381950[_0x5171b6(0x1a9)][_0x5171b6(0x1c3)](_0x213f24,_0x444c92)){_0x2c0686[_0x5171b6(0x19b)](_0x2b5898);let _0x453958=_0x1ee9c9[_0x2b5898];_0x453958||(_0x453958={'config':_0x66f37e[_0x5171b6(0x1d8)],'sparklines':_0x66f37e[_0x5171b6(0x22f)][_0x5171b6(0x24c)]()},_0x1ee9c9[_0x2b5898]=_0x453958);let _0x773c5c=_0x346a21[_0x2b5898];_0x773c5c||(_0x773c5c={'config':_0x66f37e[_0x5171b6(0x1d8)],'sparklines':new _0x381950[(_0x5171b6(0x205))](_0x66f37e[_0x5171b6(0x22f)]['clone']())},_0x346a21[_0x2b5898]=_0x773c5c);const _0x5784bb=_0x3292ab[_0x5171b6(0x1e1)](_0x444c92,{'id':_0x3292ab[_0x5171b6(0x18c)]['id'],'params':_0x1dbaed});_0x5784bb?_0x773c5c[_0x5171b6(0x22f)]['setValue'](_0x2e9c10,_0x4700d7,_0x5784bb):_0x773c5c['sparklines']['setValue'](_0x2e9c10,_0x4700d7,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x381950['RANGE_TYPE'][_0x5171b6(0x23a)]});}}),_0x47cd88[_0xe87191(0x265)]((_0x3543ed,_0x1da5cc,_0xd299ad)=>{const _0x513181=_0xe87191;if(_0x1da5cc<=_0x213f24[_0x513181(0x1b7)]&&_0x1da5cc>=_0x213f24[_0x513181(0x228)]){_0x2c0686[_0x513181(0x19b)](_0x2b5898);let _0x549542=_0x1ee9c9[_0x2b5898];_0x549542||(_0x549542={'config':_0x66f37e[_0x513181(0x1d8)],'sparklines':_0x66f37e[_0x513181(0x22f)]['clone']()},_0x1ee9c9[_0x2b5898]=_0x549542);let _0x45e866=_0x346a21[_0x2b5898];_0x45e866||(_0x45e866={'config':_0x66f37e[_0x513181(0x1d8)],'sparklines':new _0x381950['ObjectMatrix'](_0x66f37e[_0x513181(0x22f)][_0x513181(0x24c)]())},_0x346a21[_0x2b5898]=_0x45e866);}});}_0x227910[_0xe87191(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xd2ee7,'subUnitId':_0xe753fb,'groupIds':Array[_0xe87191(0x1a4)](_0x2c0686),'isSingle':!0x1}}),_0x48c007[_0xe87191(0x27f)]({'id':_0x5c63ad['id'],'params':{'unitId':_0xd2ee7,'subUnitId':_0xe753fb,'groupIds':Array[_0xe87191(0x1a4)](_0x2c0686),'isSingle':!0x1}});const _0x4804b6={};let _0x5bd437=!0x1;return Object[_0xe87191(0x200)](_0x346a21)[_0xe87191(0x25b)](([_0x5ca50b,_0x5aa005])=>{const _0x455460=_0xe87191;_0x5aa005[_0x455460(0x22f)][_0x455460(0x1ad)]()&&(_0x5bd437=!0x0,_0x5aa005[_0x455460(0x22f)][_0x455460(0x271)](_0x213f24['startColumn'],_0x213f24[_0x455460(0x1b7)]-_0x213f24['startColumn']+0x1),_0x4804b6[_0x5ca50b]={'config':_0x5aa005['config'],'sparklines':_0x5aa005[_0x455460(0x22f)][_0x455460(0x24c)]()});}),_0x5bd437&&_0x3eee6e[_0xe87191(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0xd2ee7,'subUnitId':_0xe753fb,'sparklineConfigMap':_0x4804b6}}),_0x4e93f5[_0xe87191(0x27f)]({'id':_0x48e781['id'],'params':{'unitId':_0xd2ee7,'subUnitId':_0xe753fb,'sparklineConfigMap':_0x1ee9c9}}),{'redos':_0x3eee6e,'undos':_0x4e93f5,'preRedos':_0x48c007,'preUndos':_0x227910};}[_0x17e5c7(0x26a)](){const _0x4aba44=_0x17e5c7;this[_0x4aba44(0x24f)](this[_0x4aba44(0x1a7)][_0x4aba44(0x23f)](_0x3394d5=>{const _0x5d49a4=_0x4aba44;if(_0x3394d5['id']===_0x3292ab[_0x5d49a4(0x18b)]['id']){const _0x3f58d5=_0x3394d5[_0x5d49a4(0x1eb)],{unitId:_0x7c767f,subUnitId:_0x4c69f2,range:_0x30e056}=_0x3f58d5,_0x4f1433=_0x30e056[_0x5d49a4(0x228)],_0x3ad109=_0x30e056[_0x5d49a4(0x1b7)]-_0x30e056['startColumn']+0x1,_0x334c78=this[_0x5d49a4(0x1a2)][_0x5d49a4(0x273)](_0x7c767f,_0x4c69f2);if(!_0x334c78)return;for(const [_0x3ead4d,_0x51b7f6]of _0x334c78){this[_0x5d49a4(0x1a2)][_0x5d49a4(0x21d)](_0x7c767f,_0x4c69f2,_0x3ead4d);const _0x3d6cba=_0x51b7f6[_0x5d49a4(0x22f)];_0x3d6cba[_0x5d49a4(0x265)]((_0x472eef,_0x316845,_0x305432)=>{const _0x5b9ed4=_0x5d49a4,_0x3bbf03={..._0x305432};_0x4f1433<=_0x3bbf03[_0x5b9ed4(0x228)]?(_0x3bbf03[_0x5b9ed4(0x228)]+=_0x3ad109,_0x3bbf03[_0x5b9ed4(0x1b7)]+=_0x3ad109):_0x4f1433>_0x3bbf03[_0x5b9ed4(0x1b7)]||(_0x3bbf03['endColumn']+=_0x3ad109),_0x3d6cba['setValue'](_0x472eef,_0x316845,_0x3bbf03);});const _0xb64067=_0x3d6cba[_0x5d49a4(0x1ac)]();for(const _0x1353d7 in _0xb64067){const _0x4ec00c=_0xb64067[Number(_0x1353d7)];if(!_0x4ec00c)continue;const _0x3f8acb=Object[_0x5d49a4(0x1f0)](_0x4ec00c)['map'](Number),_0x1848ca=Math[_0x5d49a4(0x1d9)](..._0x3f8acb);for(let _0x27040b=_0x1848ca;_0x27040b>=_0x4f1433;_0x27040b--)_0x27040b>=_0x4f1433&&_0x4ec00c[_0x27040b]&&(_0x4ec00c[_0x27040b+_0x3ad109]=_0x4ec00c[_0x27040b],delete _0x4ec00c[_0x27040b]);}this[_0x5d49a4(0x1a2)][_0x5d49a4(0x1d7)](_0x7c767f,_0x4c69f2,_0x3ead4d);}}else{if(_0x3394d5['id']===_0x3292ab['InsertRowMutation']['id']){const _0x2d4e95=_0x3394d5[_0x5d49a4(0x1eb)],{unitId:_0xef31ed,subUnitId:_0x54dedc,range:_0x1074e8}=_0x2d4e95,_0x41f6ac=_0x1074e8[_0x5d49a4(0x1dc)],_0x4d746e=_0x1074e8['endRow']-_0x1074e8[_0x5d49a4(0x1dc)]+0x1,_0x10a430=this[_0x5d49a4(0x1a2)][_0x5d49a4(0x273)](_0xef31ed,_0x54dedc);if(!_0x10a430)return;for(const [_0x427863,_0x37a8e2]of _0x10a430){this['_sparklineDataSourceModel']['clearSparklineCache'](_0xef31ed,_0x54dedc,_0x427863);const _0x6124=_0x37a8e2[_0x5d49a4(0x22f)];_0x6124[_0x5d49a4(0x265)]((_0x12e699,_0x12c3c4,_0x47d2db)=>{const _0x2279a3=_0x5d49a4,_0x15505d={..._0x47d2db};_0x41f6ac<=_0x15505d[_0x2279a3(0x1dc)]?(_0x15505d[_0x2279a3(0x1dc)]+=_0x4d746e,_0x15505d[_0x2279a3(0x18f)]+=_0x4d746e):_0x41f6ac>_0x15505d[_0x2279a3(0x18f)]||(_0x15505d[_0x2279a3(0x18f)]+=_0x4d746e),_0x6124[_0x2279a3(0x239)](_0x12e699,_0x12c3c4,_0x15505d);});const _0x3d0a6e=_0x6124[_0x5d49a4(0x1ac)](),_0x1db670=Object[_0x5d49a4(0x1f0)](_0x3d0a6e)[_0x5d49a4(0x26c)](Number),_0x37b1b0=Math[_0x5d49a4(0x1d9)](..._0x1db670);for(let _0x2a4d81=_0x37b1b0;_0x2a4d81>=_0x41f6ac;_0x2a4d81--)_0x2a4d81>=_0x41f6ac&&_0x3d0a6e[_0x2a4d81]&&(_0x3d0a6e[_0x2a4d81+_0x4d746e]=_0x3d0a6e[_0x2a4d81],delete _0x3d0a6e[_0x2a4d81]);this['_sparklineDataSourceModel']['updateSparklineExtraNum'](_0xef31ed,_0x54dedc,_0x427863);}}else{if(_0x3394d5['id']===_0x3292ab['RemoveColMutation']['id']){const _0x586b8c=_0x3394d5[_0x5d49a4(0x1eb)],{range:_0x80aa27,unitId:_0xe28c15,subUnitId:_0x5215b6}=_0x586b8c,_0x4603ff=this[_0x5d49a4(0x1a2)][_0x5d49a4(0x273)](_0xe28c15,_0x5215b6);if(!_0x4603ff)return;for(const [_0x87865,_0x55d2c1]of _0x4603ff){const _0x512738=_0x55d2c1[_0x5d49a4(0x22f)];_0x512738[_0x5d49a4(0x265)]((_0x2f93bc,_0x2e532e,_0x3a1246)=>{const _0xa865b2=_0x5d49a4,_0x544900=_0x3292ab[_0xa865b2(0x1e1)](_0x3a1246,_0x3394d5);_0x544900?_0x512738[_0xa865b2(0x239)](_0x2f93bc,_0x2e532e,_0x544900):_0x512738[_0xa865b2(0x239)](_0x2f93bc,_0x2e532e,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x381950[_0xa865b2(0x257)][_0xa865b2(0x23a)]});}),_0x512738['removeColumns'](_0x80aa27[_0x5d49a4(0x228)],_0x80aa27[_0x5d49a4(0x1b7)]-_0x80aa27[_0x5d49a4(0x228)]+0x1);}this[_0x5d49a4(0x1a2)]['reBuildAnchorCache'](_0xe28c15,_0x5215b6);}else{if(_0x3394d5['id']===_0x3292ab[_0x5d49a4(0x27d)]['id']){const _0xe3a70e=_0x3394d5['params'],{range:_0x539f33,unitId:_0x4db521,subUnitId:_0x5e65b0}=_0xe3a70e,_0xc74dcd=this[_0x5d49a4(0x1a2)][_0x5d49a4(0x273)](_0x4db521,_0x5e65b0);if(!_0xc74dcd)return;for(const [_0x31cd6b,_0x27218b]of _0xc74dcd){const _0x1073c5=_0x27218b[_0x5d49a4(0x22f)];_0x1073c5['forValue']((_0x5907cd,_0x103e85,_0x11be70)=>{const _0x50d08b=_0x5d49a4,_0x2da3aa=_0x3292ab[_0x50d08b(0x1e1)](_0x11be70,_0x3394d5);_0x2da3aa?_0x1073c5[_0x50d08b(0x239)](_0x5907cd,_0x103e85,_0x2da3aa):_0x1073c5['setValue'](_0x5907cd,_0x103e85,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x381950[_0x50d08b(0x257)][_0x50d08b(0x23a)]});}),_0x1073c5[_0x5d49a4(0x186)](_0x539f33[_0x5d49a4(0x1dc)],_0x539f33[_0x5d49a4(0x18f)]-_0x539f33['startRow']+0x1);}this[_0x5d49a4(0x1a2)][_0x5d49a4(0x28a)](_0x4db521,_0x5e65b0);}else{if(_0x3394d5['id']===_0x3292ab[_0x5d49a4(0x1fd)]['id']){const _0x5ae7a7=_0x3394d5[_0x5d49a4(0x1eb)],{unitId:_0x16d50b,subUnitId:_0x7aa5fe,sourceRange:_0x35c9d4,targetRange:_0x18ef13}=_0x5ae7a7,_0x457a87=this[_0x5d49a4(0x1a2)]['getSubUnitSparkline'](_0x16d50b,_0x7aa5fe);if(!_0x457a87)return;for(const [_0x1847f0,_0x178660]of _0x457a87){const _0x2c0af3=_0x178660[_0x5d49a4(0x22f)];_0x2c0af3[_0x5d49a4(0x265)]((_0x5cb402,_0x34a6a9,_0x129bd5)=>{const _0x3987bb=_0x5d49a4,_0x10373a=_0x3292ab[_0x3987bb(0x1e1)](_0x129bd5,_0x3394d5);_0x10373a?_0x2c0af3['setValue'](_0x5cb402,_0x34a6a9,_0x10373a):_0x2c0af3[_0x3987bb(0x239)](_0x5cb402,_0x34a6a9,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x381950[_0x3987bb(0x257)][_0x3987bb(0x23a)]});}),_0x2c0af3[_0x5d49a4(0x197)](_0x35c9d4['startColumn'],_0x35c9d4['endColumn']-_0x35c9d4[_0x5d49a4(0x228)]+0x1,_0x18ef13[_0x5d49a4(0x228)]);}this[_0x5d49a4(0x1a2)][_0x5d49a4(0x28a)](_0x16d50b,_0x7aa5fe);}else{if(_0x3394d5['id']===_0x3292ab[_0x5d49a4(0x1d2)]['id']){const _0x337e1a=_0x3394d5[_0x5d49a4(0x1eb)],{unitId:_0x2fa599,subUnitId:_0x74ed14,sourceRange:_0x33ca27,targetRange:_0x2e46df}=_0x337e1a,_0x2123ab=this[_0x5d49a4(0x1a2)][_0x5d49a4(0x273)](_0x2fa599,_0x74ed14);if(!_0x2123ab)return;for(const [_0x187650,_0x2fb26f]of _0x2123ab){const _0x28a7f3=_0x2fb26f['sparklines'];_0x28a7f3[_0x5d49a4(0x265)]((_0x2ac2e0,_0x4a9c90,_0x318eaa)=>{const _0x58d521=_0x5d49a4,_0x174850=_0x3292ab['adjustRangeOnMutation'](_0x318eaa,_0x3394d5);_0x174850?_0x28a7f3['setValue'](_0x2ac2e0,_0x4a9c90,_0x174850):_0x28a7f3['setValue'](_0x2ac2e0,_0x4a9c90,{'startRow':-0x270f,'endRow':-0x270f,'startColumn':-0x270f,'endColumn':-0x270f,'rangeType':_0x381950[_0x58d521(0x257)][_0x58d521(0x23a)]});}),_0x28a7f3['moveRows'](_0x33ca27[_0x5d49a4(0x1dc)],_0x33ca27[_0x5d49a4(0x18f)]-_0x33ca27[_0x5d49a4(0x1dc)]+0x1,_0x2e46df[_0x5d49a4(0x1dc)]);}this[_0x5d49a4(0x1a2)][_0x5d49a4(0x28a)](_0x2fa599,_0x74ed14);}else{if(_0x3394d5['id']===_0x3292ab[_0x5d49a4(0x18a)]['id']){const _0xa4dd42=_0x3394d5[_0x5d49a4(0x1eb)],{fromRange:_0x31a1e9,toRange:_0x297d31,unitId:_0x3ba046,from:_0x43a030,to:_0x5a4c85}=_0xa4dd42;if(_0x43a030[_0x5d49a4(0x207)]!==_0x5a4c85[_0x5d49a4(0x207)])return;const _0x3291e0=_0x43a030['subUnitId'],{startRow:_0x4f2c0b,endRow:_0x4b2ed9,startColumn:_0x4c59af,endColumn:_0x1c3f55}=_0x31a1e9,{startRow:_0x50a183,startColumn:_0x484c1a}=_0x297d31,_0xe092c2=_0x50a183-_0x4f2c0b,_0x14d42d=_0x484c1a-_0x4c59af,_0x5a7848=this[_0x5d49a4(0x1a2)][_0x5d49a4(0x273)](_0x3ba046,_0x3291e0);if(!(_0x5a7848!=null&&_0x5a7848[_0x5d49a4(0x261)]))return;for(let _0x465e5c=_0x4f2c0b;_0x465e5c<=_0x4b2ed9;_0x465e5c++)for(let _0x59257f=_0x4c59af;_0x59257f<=_0x1c3f55;_0x59257f++){const _0x266a19=this['_sparklineDataSourceModel'][_0x5d49a4(0x23d)](_0x3ba046,_0x3291e0,_0x465e5c,_0x59257f);if(_0x266a19){const _0x806a21=this['_sparklineDataSourceModel'][_0x5d49a4(0x20b)](_0x3ba046,_0x3291e0,_0x266a19);if(_0x806a21){const _0xa172aa=_0x806a21[_0x5d49a4(0x22f)][_0x5d49a4(0x1dd)](_0x465e5c,_0x59257f);_0xa172aa&&(_0x806a21[_0x5d49a4(0x22f)][_0x5d49a4(0x239)](_0x465e5c+_0xe092c2,_0x59257f+_0x14d42d,_0xa172aa),_0x806a21[_0x5d49a4(0x22f)][_0x5d49a4(0x1d0)](_0x465e5c,_0x59257f));}}}for(const [_0x2271d6,_0x329fe8]of _0x5a7848){const _0x1476d6=_0x329fe8[_0x5d49a4(0x22f)];_0x1476d6['forValue']((_0x1f41d7,_0xa0c4fe,_0x44ac49)=>{const _0x4811cb=_0x5d49a4,_0x126598={..._0x44ac49};_0x381950[_0x4811cb(0x1a9)][_0x4811cb(0x1d5)](_0x31a1e9,_0x44ac49)&&(_0x126598[_0x4811cb(0x1dc)]+=_0xe092c2,_0x126598['endRow']+=_0xe092c2,_0x126598[_0x4811cb(0x228)]+=_0x14d42d,_0x126598['endColumn']+=_0x14d42d),_0x1476d6[_0x4811cb(0x239)](_0x1f41d7,_0xa0c4fe,_0x126598);});}this[_0x5d49a4(0x1a2)][_0x5d49a4(0x28a)](_0x3ba046,_0x3291e0);}}}}}}}}));}};_0x559d6f=_0x337475([_0x3875ff(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x381950['ICommandService'])),_0x3875ff(0x1,_0x381950[_0x17e5c7(0x1f3)](_0x3292ab[_0x17e5c7(0x1f9)])),_0x3875ff(0x2,_0x381950[_0x17e5c7(0x245)]),_0x3875ff(0x3,_0x381950[_0x17e5c7(0x1f3)](_0x12f13f[_0x17e5c7(0x1b2)]))],_0x559d6f);var _0x42ed5a=Object[_0x17e5c7(0x255)],_0x157e5d=(_0x20de56,_0x975f2a,_0x33ffaa,_0x315add)=>{const _0x32ca64=_0x17e5c7;for(var _0x4741bf=_0x315add>0x1?void 0x0:_0x315add?_0x42ed5a(_0x975f2a,_0x33ffaa):_0x975f2a,_0x360b1f=_0x20de56[_0x32ca64(0x187)]-0x1,_0x200a27;_0x360b1f>=0x0;_0x360b1f--)(_0x200a27=_0x20de56[_0x360b1f])&&(_0x4741bf=_0x200a27(_0x4741bf)||_0x4741bf);return _0x4741bf;},_0x2cd89d=(_0x33074b,_0x5943bc)=>(_0x5e672b,_0x386d6f)=>_0x5943bc(_0x5e672b,_0x386d6f,_0x33074b);let _0xc46346=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x20040a,_0x54fd04,_0x3394ef){const _0x53bd98=_0x17e5c7;super(),this['_univerInstanceService']=_0x20040a,this[_0x53bd98(0x19d)]=_0x54fd04,this[_0x53bd98(0x1a2)]=_0x3394ef,this[_0x53bd98(0x1a5)]();}[_0x17e5c7(0x1a5)](){const _0x388a63=_0x17e5c7;this[_0x388a63(0x24f)](this['_sheetInterceptorService']['interceptCommand']({'getMutations':_0x119332=>{const _0x145a28=_0x388a63;var _0x92ddd0;if(_0x119332['id']===_0x3292ab[_0x145a28(0x191)]['id']){const _0x42343d=_0x119332[_0x145a28(0x1eb)],_0x15b3be=_0x42343d['unitId']||this['_univerInstanceService'][_0x145a28(0x218)](_0x381950[_0x145a28(0x281)][_0x145a28(0x264)])[_0x145a28(0x232)](),_0x1c8ba5=_0x42343d[_0x145a28(0x207)]||((_0x92ddd0=this[_0x145a28(0x1e0)][_0x145a28(0x218)](_0x381950[_0x145a28(0x281)][_0x145a28(0x264)])[_0x145a28(0x1ff)]())==null?void 0x0:_0x92ddd0[_0x145a28(0x233)]());if(!_0x15b3be||!_0x1c8ba5)return{'redos':[],'undos':[]};const _0x44cdd3=this[_0x145a28(0x1a2)][_0x145a28(0x273)](_0x15b3be,_0x1c8ba5);if(!_0x44cdd3)return{'redos':[],'undos':[]};const _0x328ba5=new Set(),_0x42317c={};for(const [_0x52a007,_0x347b40]of _0x44cdd3)_0x328ba5[_0x145a28(0x19b)](_0x52a007),_0x42317c[_0x52a007]={'config':_0x381950['Tools'][_0x145a28(0x235)](_0x347b40[_0x145a28(0x1d8)]),'sparklines':_0x381950['Tools'][_0x145a28(0x235)](_0x347b40['sparklines'][_0x145a28(0x24c)]())};if(_0x328ba5['size'])return{'redos':[{'id':_0x5c63ad['id'],'params':{'unitId':_0x15b3be,'subUnitId':_0x1c8ba5,'groupIds':Array[_0x145a28(0x1a4)](_0x328ba5),'isSingle':!0x1}}],'undos':[{'id':_0x48e781['id'],'params':{'unitId':_0x15b3be,'subUnitId':_0x1c8ba5,'sparklineConfigMap':_0x42317c}}]};}else{if(_0x119332['id']===_0x3292ab['CopySheetCommand']['id']){const _0xbe669a=_0x119332['params'],{unitId:_0xf87530,subUnitId:_0x5410f9,targetSubUnitId:_0x24e71d}=_0xbe669a;if(!_0xf87530||!_0x5410f9||!_0x24e71d)return{'redos':[],'undos':[]};const _0x484e3c=this[_0x145a28(0x1a2)]['getSubUnitSparkline'](_0xf87530,_0x5410f9);if(!_0x484e3c)return{'redos':[],'undos':[]};const _0x4b549f=new Set(),_0x55a3cf={};for(const [_0x332127,_0xf085ea]of _0x484e3c){const _0x4a1a20='g_'+_0x381950[_0x145a28(0x28c)](0x6);_0x4b549f['add'](_0x332127),_0x55a3cf[_0x4a1a20]={'config':_0x381950['Tools'][_0x145a28(0x235)](_0xf085ea['config']),'sparklines':_0x381950['Tools'][_0x145a28(0x235)](_0xf085ea['sparklines'][_0x145a28(0x24c)]())};}if(_0x4b549f[_0x145a28(0x261)])return{'redos':[{'id':_0x48e781['id'],'params':{'unitId':_0xf87530,'subUnitId':_0x24e71d,'sparklineConfigMap':_0x55a3cf}}],'undos':[{'id':_0x5c63ad['id'],'params':{'unitId':_0xf87530,'subUnitId':_0x24e71d,'groupIds':Array[_0x145a28(0x1a4)](_0x4b549f),'isSingle':!0x1}}]};}}return{'redos':[],'undos':[]};}}));}};_0xc46346=_0x157e5d([_0x2cd89d(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x381950[_0x17e5c7(0x245)])),_0x2cd89d(0x1,_0x381950['Inject'](_0x3292ab[_0x17e5c7(0x236)])),_0x2cd89d(0x2,_0x381950[_0x17e5c7(0x1f3)](_0x12f13f['SparklineDataSourceModel']))],_0xc46346);var _0x5439cf=Object[_0x17e5c7(0x255)],_0x4c1b4e=(_0x4f3900,_0x10ba2,_0x357ddd,_0x47a026)=>{for(var _0x169cde=_0x47a026>0x1?void 0x0:_0x47a026?_0x5439cf(_0x10ba2,_0x357ddd):_0x10ba2,_0x32e05b=_0x4f3900['length']-0x1,_0x1e8514;_0x32e05b>=0x0;_0x32e05b--)(_0x1e8514=_0x4f3900[_0x32e05b])&&(_0x169cde=_0x1e8514(_0x169cde)||_0x169cde);return _0x169cde;},_0x2b117c=(_0x836419,_0x3594e3)=>(_0x4ddb48,_0x5663f9)=>_0x3594e3(_0x4ddb48,_0x5663f9,_0x836419);let _0x3bd2fc=class extends _0x381950[_0x17e5c7(0x1b0)]{constructor(_0x53eb8d,_0x529ab4){const _0x488eeb=_0x17e5c7;super(),this[_0x488eeb(0x25a)]=_0x53eb8d,this[_0x488eeb(0x1a2)]=_0x529ab4,this[_0x488eeb(0x243)]();}['_initSnapshot'](){const _0x575d8e=_0x17e5c7,_0x35ab8d=_0xb6db34=>{const _0xc11786=_0xce16,_0x3714a6=this[_0xc11786(0x1a2)][_0xc11786(0x241)](_0xb6db34);return _0x3714a6?JSON[_0xc11786(0x203)](_0x3714a6):'';},_0x54b57f=_0x5ab7d2=>_0x5ab7d2?JSON[_0x575d8e(0x1e6)](_0x5ab7d2):{};this[_0x575d8e(0x24f)](this[_0x575d8e(0x25a)][_0x575d8e(0x1b9)]({'toJson':_0x35ab8d,'parseJson':_0x54b57f,'pluginName':_0x1ce7d7,'businesses':[_0x381950[_0x575d8e(0x281)]['UNIVER_SHEET']],'onLoad':(_0x41505c,_0x22753c)=>{const _0x5acd70=_0x575d8e;this[_0x5acd70(0x1a2)]['fromJSON'](_0x22753c);},'onUnLoad':_0x2b23ca=>{this['_sparklineDataSourceModel']['deleteUnit'](_0x2b23ca);}}));}};_0x3bd2fc=_0x4c1b4e([_0x2b117c(0x0,_0x381950[_0x17e5c7(0x1f3)](_0x381950[_0x17e5c7(0x1cb)])),_0x2b117c(0x1,_0x381950[_0x17e5c7(0x1f3)](_0x12f13f[_0x17e5c7(0x1b2)]))],_0x3bd2fc);var _0x583f14=Object[_0x17e5c7(0x27b)],_0x2759d4=Object[_0x17e5c7(0x255)],_0x1642b2=(_0x5aa3aa,_0x547125,_0x19f517)=>_0x547125 in _0x5aa3aa?_0x583f14(_0x5aa3aa,_0x547125,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x19f517}):_0x5aa3aa[_0x547125]=_0x19f517,_0x102094=(_0x3b5303,_0x56c9e4,_0x29a7e8,_0x4b4688)=>{const _0x5f05ba=_0x17e5c7;for(var _0x117676=_0x4b4688>0x1?void 0x0:_0x4b4688?_0x2759d4(_0x56c9e4,_0x29a7e8):_0x56c9e4,_0xfc8c8a=_0x3b5303[_0x5f05ba(0x187)]-0x1,_0x1d5568;_0xfc8c8a>=0x0;_0xfc8c8a--)(_0x1d5568=_0x3b5303[_0xfc8c8a])&&(_0x117676=_0x1d5568(_0x117676)||_0x117676);return _0x117676;},_0x4a9cfe=(_0x3a1268,_0x488151)=>(_0x7cd01d,_0x25860d)=>_0x488151(_0x7cd01d,_0x25860d,_0x3a1268),_0x3e5a4c=(_0x2babb8,_0x12f7e9,_0x34e3b5)=>_0x1642b2(_0x2babb8,typeof _0x12f7e9!=_0x17e5c7(0x1ce)?_0x12f7e9+'':_0x12f7e9,_0x34e3b5);_0x12f13f[_0x17e5c7(0x1de)]=class extends _0x381950[_0x17e5c7(0x20e)]{constructor(_0x441d1a={},_0x5ac5d8,_0x4aeed5){const _0x2acc95=_0x17e5c7;super(),this['_config']=_0x441d1a,this[_0x2acc95(0x247)]=_0x5ac5d8,this['_commandService']=_0x4aeed5,this[_0x2acc95(0x1f4)](),this[_0x2acc95(0x1c1)]();}[_0x17e5c7(0x1f4)](){const _0x9ccbef=_0x17e5c7;[[_0x12f13f[_0x9ccbef(0x1b2)]],[_0x5b6f8d],[_0x27b93d],[_0x1eeded],[_0x559d6f],[_0x3ad5ac],[_0xc46346],[_0x3bd2fc]][_0x9ccbef(0x25b)](_0x5614ea=>{const _0x5635e5=_0x9ccbef;this['_injector'][_0x5635e5(0x19b)](_0x5614ea);}),_0x381950[_0x9ccbef(0x276)](this[_0x9ccbef(0x247)],[[_0x3bd2fc]]);}['onReady'](){const _0x337cef=_0x17e5c7;_0x381950[_0x337cef(0x276)](this['_injector'],[[_0x5b6f8d],[_0x27b93d],[_0x1eeded],[_0x559d6f],[_0x3ad5ac],[_0xc46346]]);}[_0x17e5c7(0x1c1)](){const _0x5ac3f2=_0x17e5c7;[_0x41f7c9,_0x48e781,_0x42a99c,_0x5c63ad,_0x24ae22,_0x3f022e]['forEach'](_0xe24d1b=>this[_0x5ac3f2(0x1a7)][_0x5ac3f2(0x21b)](_0xe24d1b));}},_0x3e5a4c(_0x12f13f['UniverSheetSparklinePlugin'],_0x17e5c7(0x286),_0x1ce7d7),_0x3e5a4c(_0x12f13f['UniverSheetSparklinePlugin'],'type',_0x381950['UniverInstanceType']['UNIVER_SHEET']),_0x12f13f[_0x17e5c7(0x1de)]=_0x102094([_0x381950[_0x17e5c7(0x1c5)](_0x2e3fa5['UniverLicensePlugin']),_0x4a9cfe(0x1,_0x381950['Inject'](_0x381950[_0x17e5c7(0x219)])),_0x4a9cfe(0x2,_0x381950[_0x17e5c7(0x1f3)](_0x381950[_0x17e5c7(0x1ab)]))],_0x12f13f[_0x17e5c7(0x1de)]),_0x12f13f['AddSheetSparklineCommand']=_0x41f7c9,_0x12f13f[_0x17e5c7(0x260)]=_0x48e781,_0x12f13f[_0x17e5c7(0x195)]=_0x1ce7d7,_0x12f13f[_0x17e5c7(0x25d)]=_0x42a99c,_0x12f13f['RemoveSheetSparklineMutation']=_0x5c63ad,_0x12f13f[_0x17e5c7(0x26e)]=_0x24ae22,_0x12f13f[_0x17e5c7(0x229)]=_0x3f022e,_0x12f13f[_0x17e5c7(0x24b)]=_0x9eddd4,_0x12f13f[_0x17e5c7(0x23e)]=_0x20e222,_0x12f13f[_0x17e5c7(0x27c)]=_0x5efe20,_0x12f13f[_0x17e5c7(0x1aa)]=_0x4c4385,_0x12f13f[_0x17e5c7(0x279)]=_0x5c3390,_0x12f13f[_0x17e5c7(0x213)]=_0x29b2e8,_0x12f13f[_0x17e5c7(0x1bc)]=_0x492f8f,Object[_0x17e5c7(0x27b)](_0x12f13f,Symbol[_0x17e5c7(0x20a)],{'value':_0x17e5c7(0x1ba)});}));