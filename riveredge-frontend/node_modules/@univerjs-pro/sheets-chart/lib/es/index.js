const _0x7612c1=_0xac47;(function(_0x231218,_0x34d747){const _0x4f5dfd=_0xac47,_0x4ed2f3=_0x231218();while(!![]){try{const _0x4fd4b8=-parseInt(_0x4f5dfd(0x197))/0x1*(-parseInt(_0x4f5dfd(0x1b0))/0x2)+parseInt(_0x4f5dfd(0x151))/0x3*(-parseInt(_0x4f5dfd(0x195))/0x4)+parseInt(_0x4f5dfd(0x1e8))/0x5+-parseInt(_0x4f5dfd(0x1be))/0x6+-parseInt(_0x4f5dfd(0x1a7))/0x7+parseInt(_0x4f5dfd(0x16a))/0x8*(-parseInt(_0x4f5dfd(0x1cc))/0x9)+parseInt(_0x4f5dfd(0x1c0))/0xa*(parseInt(_0x4f5dfd(0x1ba))/0xb);if(_0x4fd4b8===_0x34d747)break;else _0x4ed2f3['push'](_0x4ed2f3['shift']());}catch(_0x3dc203){_0x4ed2f3['push'](_0x4ed2f3['shift']());}}}(_0x56d1,0x4ee2a));var me=Object[_0x7612c1(0x1c6)],Se=(_0x428b47,_0x3b9c5f,_0x4448fe)=>_0x3b9c5f in _0x428b47?me(_0x428b47,_0x3b9c5f,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x4448fe}):_0x428b47[_0x3b9c5f]=_0x4448fe,C=(_0x3f2a2d,_0x2b6baf,_0x33ee72)=>Se(_0x3f2a2d,typeof _0x2b6baf!=_0x7612c1(0x1ce)?_0x2b6baf+'':_0x2b6baf,_0x33ee72);import{ChartSourceDataTypeEnum as _0x663ac2,ChartDataSource as _0x2aa060,ChartModel as _0x37b302,CHART_DEBOUNCE_TIME as _0x2ac538,buildChartData as _0x2d43c4,findHeaderOperator as _0x45a9c5,findCategoryOperator as _0x29b67f,findSeriesOperator as _0x2f2071,pieSeriesFilterOperator as _0xc9ebc6,ChartTypeBits as _0x84097c,DataOrientation as _0x4c2a49,registerChartThemeService as _0x1f567b,registerWordCloudChartMakImageService as _0x50e291}from'@univerjs-pro/engine-chart';import{CellValueType as _0x318b31,numfmt as _0x24ff2a,DEFAULT_NUMBER_FORMAT as _0x2a842a,ObjectMatrix as _0x4c5894,Range as _0x2a756e,LocaleService as _0x307788,Inject as _0x8f8176,Injector as _0x44259b,Disposable as _0x4c90fe,IResourceManagerService as _0x108b93,IUniverInstanceService as _0x258c84,ICommandService as _0x5953c0,generateRandomId as _0x373f37,Rectangle as _0x1ee031,UniverInstanceType as _0x30dcb8,CommandType as _0x461e0d,IUndoRedoService as _0x559a9e,IConfigService as _0x1e77bf,Plugin as _0x1306e5,merge as _0x4d94bd,touchDependencies as _0x58b571}from'@univerjs/core';import{BehaviorSubject as _0x29d76c,filter as _0x2fd3ae,combineLatest as _0x56145a,debounceTime as _0x38ec3d,map as _0x54cac2,distinctUntilChanged as _0x35bc62,Subject as _0x14404f}from'rxjs';import{RefRangeService as _0x3e5eb,SetRangeValuesMutation as _0x5139ab,ReorderRangeMutation as _0x48e0e0,RemoveColMutation as _0x2cb884,RemoveRowMutation as _0x542d15}from'@univerjs/sheets';import{LS_CONFIG_KEY as _0x345759,unshiftString as _0x4d1cf1,isFeatureAuthorizedWithinTime as _0x15da3d,getSheetFeatureLimit as _0x2a53be}from'@univerjs-pro/license';const ne='TRUE',re='FALSE',Fe=_0x42fbf0=>{const _0x389d2a=_0x7612c1;var _0x120a49;return((_0x120a49=_0x42fbf0[_0x389d2a(0x1a4)])==null?void 0x0:_0x120a49[_0x389d2a(0x147)][_0x389d2a(0x1e1)](/\r\n$/,''))||'';};function q(_0x1c0184,_0x59e26b,_0x223b9a){const _0x5bff04=_0x7612c1;var _0x42bbce,_0x3f04e1,_0x29a97a;if(_0x1c0184){const {v:_0x24ce18,t:_0x3f6cda,p:_0x19abe0,s:_0x12ba05}=_0x1c0184;if(_0x19abe0)return{'v':null,'t':_0x663ac2['Null']};if(_0x3f6cda===_0x318b31[_0x5bff04(0x162)]){const _0x51c225=_0x59e26b[_0x5bff04(0x1c1)](_0x12ba05);if(_0x51c225&&_0x51c225['n']){const {pattern:_0x28e80a}=_0x51c225['n'];_0x28e80a&&!_0x223b9a[_0x28e80a]&&(_0x223b9a[_0x28e80a]=_0x24ff2a[_0x5bff04(0x184)](_0x28e80a));const _0x4df04a=_0x223b9a[_0x28e80a];if(_0x4df04a&&_0x4df04a[_0x5bff04(0x1d1)])return typeof _0x24ce18==_0x5bff04(0x18e)?{'v':Number(_0x24ce18),'t':_0x663ac2[_0x5bff04(0x159)]}:{'v':(_0x42bbce=_0x24ff2a[_0x5bff04(0x180)](_0x24ce18))==null?void 0x0:_0x42bbce['v'],'t':_0x663ac2[_0x5bff04(0x159)]};if(_0x24ce18==null)return{'v':null,'t':_0x663ac2[_0x5bff04(0x1c9)]};if(_0x28e80a!==_0x2a842a&&_0x4df04a)return{'v':(_0x29a97a=(_0x3f04e1=_0x24ff2a[_0x5bff04(0x19e)](_0x24ce18))==null?void 0x0:_0x3f04e1['v'])!=null?_0x29a97a:Number(_0x24ce18),'t':_0x663ac2[_0x5bff04(0x162)]};}return{'v':Number(_0x24ce18),'t':_0x663ac2[_0x5bff04(0x162)]};}else{if(_0x3f6cda===_0x318b31['FORCE_STRING'])return{'v':String(_0x24ce18),'t':_0x663ac2['STRING']};{const _0x13004a=Number(_0x24ce18);return _0x13004a===_0x24ce18?{'v':_0x13004a,'t':_0x663ac2[_0x5bff04(0x162)]}:_0x24ce18==null?{'v':null,'t':_0x663ac2['Null']}:{'v':String(_0x24ce18),'t':_0x663ac2['STRING']};}}}return{'v':null,'t':_0x663ac2['Null']};}function Ve(_0x424395,_0x513958,_0x133441,_0xad65f8,_0xfa4e4e,_0xc60f4a){const _0x30edbf=_0x7612c1,{startRow:_0x7eef69,startColumn:_0x23fb29,endColumn:_0x268e9d,endRow:_0x125051}=_0x424395,_0x333a43={};if(_0x7eef69===_0x125051)for(let _0xd5f7c9=_0x23fb29;_0xd5f7c9<=_0x268e9d;_0xd5f7c9++){const _0x4c2184=_0x513958[_0x30edbf(0x17b)](_0x7eef69,_0xd5f7c9),{v:_0xe50b6f,t:_0x71e3ac}=q(_0x4c2184,_0xc60f4a,_0x333a43);_0xad65f8[_0x30edbf(0x1d8)](_0xd5f7c9,_0x133441,_0xe50b6f),_0xfa4e4e[_0x30edbf(0x1d8)](_0xd5f7c9,_0x133441,_0x71e3ac);}if(_0x23fb29===_0x268e9d)for(let _0x126b53=_0x7eef69;_0x126b53<=_0x125051;_0x126b53++){const _0x544495=_0x513958[_0x30edbf(0x17b)](_0x126b53,_0x23fb29),{v:_0x36b713,t:_0x6eb910}=q(_0x544495,_0xc60f4a,_0x333a43);_0xad65f8[_0x30edbf(0x1d8)](_0x133441,_0x126b53,_0x36b713),_0xfa4e4e[_0x30edbf(0x1d8)](_0x133441,_0x126b53,_0x6eb910);}}function x(_0x21bd7a,_0x38a95a,_0x577585){const _0x4b35b7=_0x7612c1;if(_0x21bd7a){const {v:_0x4644fb,t:_0x2f727b,p:_0x4822f6,s:_0x1020b2}=_0x21bd7a;if(_0x4822f6)return{'v':Fe(_0x4822f6),'t':_0x663ac2[_0x4b35b7(0x1d0)]};if((_0x2f727b===_0x318b31['FORCE_STRING']||_0x2f727b===_0x318b31[_0x4b35b7(0x1d0)])&&_0x4644fb!==void 0x0&&_0x4644fb!==null)return{'v':String(_0x4644fb),'t':_0x663ac2['STRING']};if(_0x2f727b===_0x318b31['BOOLEAN'])return{'v':_0x4644fb?ne:re,'t':_0x663ac2[_0x4b35b7(0x1e9)]};if(_0x2f727b===_0x318b31[_0x4b35b7(0x162)]){const _0x21743d=_0x38a95a['get'](_0x1020b2);if(_0x21743d&&_0x21743d['n']){const {pattern:_0x476e20}=_0x21743d['n'];if(_0x476e20&&!_0x577585[_0x476e20]&&(_0x577585[_0x476e20]=_0x24ff2a[_0x4b35b7(0x184)](_0x476e20)),_0x577585[_0x476e20]&&(_0x577585[_0x476e20]=_0x24ff2a[_0x4b35b7(0x184)](_0x476e20),_0x577585[_0x476e20][_0x4b35b7(0x1d1)]))return{'v':String(_0x4644fb),'t':_0x663ac2[_0x4b35b7(0x159)]};}return{'v':String(_0x4644fb),'t':_0x663ac2[_0x4b35b7(0x162)]};}else return typeof _0x4644fb==='boolean'?{'v':_0x4644fb?ne:re,'t':_0x663ac2['BOOLEAN']}:{'v':_0x4644fb==null?'':String(_0x4644fb),'t':_0x663ac2[_0x4b35b7(0x1d0)]};}return{'v':'','t':_0x663ac2[_0x4b35b7(0x1d0)]};}class Ge extends _0x2aa060{constructor(_0x1e3c23,_0x4a32a4){const _0x3214f6=_0x7612c1;super(),C(this,_0x3214f6(0x19c)),C(this,_0x3214f6(0x1f4)),this[_0x3214f6(0x18c)]=_0x1e3c23;const _0x59be38=_0x4a32a4['isRowDirection']!==void 0x0?_0x4a32a4[_0x3214f6(0x1b7)]:!0x0;this[_0x3214f6(0x19c)]=new _0x29d76c({..._0x4a32a4,'isRowDirection':_0x59be38}),this[_0x3214f6(0x1cf)]=new _0x29d76c({'dimensions':[],'source':[]}),this[_0x3214f6(0x1cb)]=this[_0x3214f6(0x1a6)][_0x3214f6(0x1d9)](),this[_0x3214f6(0x158)]=this[_0x3214f6(0x1cf)]['asObservable'](),this['rangeInfo$']=this[_0x3214f6(0x19c)][_0x3214f6(0x1d9)](),this['_init']();}['getRangeInfo'](){const _0x529782=_0x7612c1;return this[_0x529782(0x19c)][_0x529782(0x1af)]();}['setRangeInfo'](_0x35b127){const _0x540ae5=_0x7612c1;this['_rangeInfo$'][_0x540ae5(0x1d5)](_0x35b127),this['_data$'][_0x540ae5(0x1d5)](this[_0x540ae5(0x19b)]()),this[_0x540ae5(0x1a6)][_0x540ae5(0x1d5)](this['canSwitchOrient']());}[_0x7612c1(0x1a3)](_0x56c26e){const _0x316b11=_0x7612c1;this[_0x316b11(0x1a6)][_0x316b11(0x1d5)](_0x56c26e);}[_0x7612c1(0x1e6)](){return!0x0;}['updateRangeInfo'](){}[_0x7612c1(0x1de)](){}[_0x7612c1(0x19b)](){const _0x3e6591=_0x7612c1,{rangeInfo:_0x50398c,isRowDirection:_0x3d51d5}=this['getRangeInfo'](),_0x4e224f=this['_univerInstanceService'],{unitId:_0x3d4317,subUnitId:_0x50ef69,range:_0x386590}=_0x50398c,_0x3717fc=_0x4e224f[_0x3e6591(0x1e2)](_0x3d4317);if(!_0x3717fc)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x3e53b4=_0x3717fc[_0x3e6591(0x149)](_0x50ef69);if(!_0x3e53b4)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x316def=[],_0x114fd5=[],_0x54226d=[],_0x52a523=[],_0x2273fc=_0x3717fc[_0x3e6591(0x1eb)](),_0x4e50ef={};if(_0x386590['startColumn']===-0x1||_0x386590[_0x3e6591(0x18d)]===-0x1)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0x3ceb14=_0x2a756e['transformRange'](_0x386590,_0x3e53b4),{startColumn:_0x11a87b,startRow:_0x29ad72,endColumn:_0x55bc97,endRow:_0x406e4c}=_0x3ceb14;if(_0x3d51d5){for(let _0x4533a3=_0x11a87b;_0x4533a3<=_0x55bc97;_0x4533a3++){const _0x2014aa=_0x3e53b4['getCell'](_0x29ad72,_0x4533a3),{v:_0x1fa083,t:_0x3bf816}=x(_0x2014aa,_0x2273fc,_0x4e50ef);_0x316def[_0x3e6591(0x155)](_0x1fa083),_0x114fd5[_0x3e6591(0x155)](_0x3bf816);}for(let _0xb6fa33=_0x29ad72+0x1;_0xb6fa33<=_0x406e4c;_0xb6fa33++){const _0x3918be=[],_0x2d1cfc=[];for(let _0x15d63d=_0x11a87b;_0x15d63d<=_0x55bc97;_0x15d63d++){const _0x13bd13=_0x3e53b4['getCell'](_0xb6fa33,_0x15d63d),{v:_0x3500b2,t:_0x16d1f0}=_0x15d63d===_0x11a87b?x(_0x13bd13,_0x2273fc,_0x4e50ef):q(_0x13bd13,_0x2273fc,_0x4e50ef);_0x3918be[_0x3e6591(0x155)](_0x3500b2),_0x2d1cfc[_0x3e6591(0x155)](_0x16d1f0);}_0x54226d[_0x3e6591(0x155)](_0x3918be),_0x52a523['push'](_0x2d1cfc);}}else{for(let _0x49eb94=_0x29ad72;_0x49eb94<=_0x406e4c;_0x49eb94++){const _0x45fca6=_0x3e53b4[_0x3e6591(0x17b)](_0x49eb94,_0x11a87b),{v:_0x2e144e,t:_0x331011}=x(_0x45fca6,_0x2273fc,_0x4e50ef);_0x316def[_0x3e6591(0x155)](_0x2e144e),_0x114fd5['push'](_0x331011);}for(let _0x1f1c7a=_0x11a87b+0x1;_0x1f1c7a<=_0x55bc97;_0x1f1c7a++){const _0x14d4e5=[];for(let _0x40b853=_0x29ad72;_0x40b853<=_0x406e4c;_0x40b853++){const _0x4b2518=_0x3e53b4[_0x3e6591(0x17b)](_0x40b853,_0x1f1c7a),{v:_0x342686,t:_0x5e9ff8}=_0x40b853===_0x29ad72?x(_0x4b2518,_0x2273fc,_0x4e50ef):q(_0x4b2518,_0x2273fc,_0x4e50ef);_0x14d4e5[_0x3e6591(0x155)](_0x342686);}_0x54226d[_0x3e6591(0x155)](_0x14d4e5);}}return{'dimensions':_0x316def,'source':_0x54226d,'dimensionsType':_0x114fd5,'sourceType':_0x52a523};}}class ge extends _0x2aa060{constructor(_0x28d57c,_0xd9af64){const _0x4c27d9=_0x7612c1;super(),C(this,_0x4c27d9(0x19c)),C(this,_0x4c27d9(0x1f4)),(this[_0x4c27d9(0x18c)]=_0x28d57c,this[_0x4c27d9(0x19c)]=new _0x29d76c(_0xd9af64));}[_0x7612c1(0x1e6)](){return!0x1;}[_0x7612c1(0x15b)](){const _0x402b02=_0x7612c1;return this[_0x402b02(0x19c)][_0x402b02(0x1af)]();}['setOrient'](_0x41a35d){const _0x4c2077=_0x7612c1;this[_0x4c2077(0x1a6)][_0x4c2077(0x1d5)](_0x41a35d);}[_0x7612c1(0x1c7)](_0x272b01){const _0x30277d=_0x7612c1;this['_rangeInfo$'][_0x30277d(0x1d5)](_0x272b01);}[_0x7612c1(0x1c8)](){}['watchRange'](){}[_0x7612c1(0x19b)](){const _0x452455=_0x7612c1,_0x598cc9=this[_0x452455(0x15b)](),_0x5577b4=this[_0x452455(0x18c)],_0x1796da=[],_0x17f084=[],_0x1f6a03={};for(const [_0x2c4ddd]of _0x598cc9){const {unitId:_0x3b4f14,subUnitId:_0x1ea96c,range:_0x2d4e39}=_0x2c4ddd,_0x8ec4=_0x5577b4[_0x452455(0x1e2)](_0x3b4f14);if(!_0x8ec4)return{'dimensions':[],'source':[]};const _0x337913=_0x8ec4['getSheetBySheetId'](_0x1ea96c);if(!_0x337913)return{'dimensions':[],'source':[]};const _0x3f00fb=_0x8ec4['getStyles'](),{v:_0x1f0aed,t:_0x583b25}=x(_0x337913[_0x452455(0x17b)](_0x2d4e39[_0x452455(0x18d)],_0x2d4e39[_0x452455(0x14b)]),_0x3f00fb,_0x1f6a03);_0x1796da['push'](_0x1f0aed),_0x17f084[_0x452455(0x155)](_0x583b25);}let _0xcac7bf=0x0;const _0x2e8bb1=new _0x4c5894(),_0x1edcaf=new _0x4c5894();for(const [,_0x1218f8]of _0x598cc9){const {unitId:_0x2e261f,subUnitId:_0x2918f6,range:_0x5efb2a}=_0x1218f8,_0x405e77=_0x5577b4[_0x452455(0x1e2)](_0x2e261f);if(!_0x405e77)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};const _0xe1fb0=_0x405e77[_0x452455(0x149)](_0x2918f6);if(!_0xe1fb0)return{'dimensions':[],'source':[],'dimensionsType':[],'sourceType':[]};Ve(_0x5efb2a,_0xe1fb0,_0xcac7bf,_0x2e8bb1,_0x1edcaf,_0x405e77[_0x452455(0x1eb)]()),_0xcac7bf++;}const _0x486feb=_0x2e8bb1[_0x452455(0x1ae)](),_0x528c09=_0x1edcaf[_0x452455(0x1ae)]();return{'dimensions':_0x1796da,'source':_0x486feb,'dimensionsType':_0x17f084,'sourceType':_0x528c09};}}function ze(_0x3683a0,_0x2ebf99){const _0xbb6df4=_0x7612c1;return Array[_0xbb6df4(0x188)](_0x2ebf99)?new ge(_0x3683a0,_0x2ebf99):new Ge(_0x3683a0,_0x2ebf99);}function It(_0x26da36,_0x10b9ce,_0x59eb4a){const _0x4a03fa=_0x7612c1,_0x51b01a=[];for(let _0x42cf6b=0x0;_0x42cf6b<_0x26da36[_0x4a03fa(0x187)];_0x42cf6b++)_0x51b01a[_0x4a03fa(0x155)](_0x26da36[_0x42cf6b][_0x10b9ce]);return _0x51b01a;}class Je extends _0x37b302{get[_0x7612c1(0x161)](){const _0x41851a=_0x7612c1;return this[_0x41851a(0x1a0)];}constructor(_0x4169d7,_0x2d2127,_0x5607a8){const _0xf8a6a2=_0x7612c1;super(_0x4169d7,_0x2d2127,_0x5607a8),this[_0xf8a6a2(0x153)]();}[_0x7612c1(0x153)](){const _0x390c3e=_0x7612c1;var _0x26c0e6;const _0x406e6a=this[_0x390c3e(0x1e3)]()[_0x390c3e(0x1c1)](_0x307788);(_0x26c0e6=this[_0x390c3e(0x1b6)])==null||_0x26c0e6[_0x390c3e(0x152)]();const {data$:_0x273402,rangeInfo$:_0x5971d7}=this[_0x390c3e(0x1a0)],_0x40e8b1=_0x273402[_0x390c3e(0x1ab)](_0x2fd3ae(_0x1d7375=>{const {dimensions:_0x4d0356,source:_0x3f40c7}=_0x1d7375;return!(!_0x4d0356||!_0x3f40c7);})),_0x5732bc=_0x56145a([_0x40e8b1,this[_0x390c3e(0x1f2)],this[_0x390c3e(0x1ca)]])[_0x390c3e(0x1ab)](_0x38ec3d(_0x2ac538),_0x54cac2(([_0x2a9ffb,_0x5f406b,_0x424678])=>[_0x2a9ffb,_0x5f406b,_0x424678]));this[_0x390c3e(0x1b6)]=_0x56145a([this[_0x390c3e(0x1db)]['pipe'](_0x35bc62()),_0x5732bc,_0x5971d7])['pipe'](_0x2fd3ae(([_0x3ca1dc])=>!!_0x3ca1dc),_0x38ec3d(_0x2ac538))[_0x390c3e(0x169)](([_0xa81d7a,[_0x379d7f,_0x284be8],_0x236bb4])=>{const _0x585aec=_0x390c3e;if(_0x379d7f[_0x585aec(0x1d3)][_0x585aec(0x187)]<=0x0||_0x379d7f[_0x585aec(0x1a8)]['length']<=0x0){this[_0x585aec(0x168)][_0x585aec(0x1d5)]({'type':this[_0x585aec(0x150)],'category':void 0x0,'maxValue':-0x1/0x0,'minValue':0x1/0x0,'series':[]});return;}const _0x246826=Array[_0x585aec(0x188)](_0x236bb4)?!0x1:!!_0x236bb4['isRowDirection'],_0x4e0ab3=_0x2d43c4(_0x379d7f,_0x284be8,_0xa81d7a,_0x246826,_0x406e6a);this[_0x585aec(0x168)][_0x585aec(0x1d5)]({'type':_0xa81d7a,'headers':_0x284be8[_0x585aec(0x15c)],'category':_0x4e0ab3[_0x585aec(0x17d)],'series':_0x4e0ab3[_0x585aec(0x1b3)],'maxValue':_0x4e0ab3[_0x585aec(0x1c5)],'minValue':_0x4e0ab3[_0x585aec(0x15f)],'bubble':_0x4e0ab3[_0x585aec(0x17a)],'relationData':_0x4e0ab3['relationData'],'sankeyData':_0x4e0ab3[_0x585aec(0x14e)],'heatmapData':_0x4e0ab3[_0x585aec(0x1f7)]});}),this['disposeWithMe'](this[_0x390c3e(0x1b6)]);}[_0x7612c1(0x190)](){const _0x2bae5d=_0x7612c1;super[_0x2bae5d(0x190)](),this[_0x2bae5d(0x16f)]['complete'](),this['_context$'][_0x2bae5d(0x196)](),this[_0x2bae5d(0x168)][_0x2bae5d(0x196)](),this['_style$']['complete']();}}var We=Object[_0x7612c1(0x1a2)],Qe=(_0x44ea25,_0x5a2528,_0x19b9a8,_0x41b9c3)=>{const _0x57805e=_0x7612c1;for(var _0x26dd68=_0x41b9c3>0x1?void 0x0:_0x41b9c3?We(_0x5a2528,_0x19b9a8):_0x5a2528,_0x56c61e=_0x44ea25[_0x57805e(0x187)]-0x1,_0x261705;_0x56c61e>=0x0;_0x56c61e--)(_0x261705=_0x44ea25[_0x56c61e])&&(_0x26dd68=_0x261705(_0x26dd68)||_0x26dd68);return _0x26dd68;},Ze=(_0x2956f9,_0x56d084)=>(_0x3f95f2,_0x28d8e9)=>_0x56d084(_0x3f95f2,_0x28d8e9,_0x2956f9);let H=class extends _0x4c90fe{constructor(_0x33e961){const _0x1dad9f=_0x7612c1;super(),C(this,_0x1dad9f(0x1ad),new _0x29d76c(null)),C(this,'activeChartModel$',this[_0x1dad9f(0x1ad)][_0x1dad9f(0x1d9)]()),C(this,_0x1dad9f(0x173),new Map()),C(this,_0x1dad9f(0x1f6),new Set()),C(this,'_chartModelAdded$',new _0x14404f()),C(this,'chartModelAdded$',this['_chartModelAdded$'][_0x1dad9f(0x1d9)]()),C(this,_0x1dad9f(0x1ef),new _0x14404f()),C(this,_0x1dad9f(0x174),this[_0x1dad9f(0x1ef)]['asObservable']()),this['_injector']=_0x33e961;}get[_0x7612c1(0x164)](){const _0x375228=_0x7612c1;return this[_0x375228(0x1ad)]['getValue']();}[_0x7612c1(0x1cd)](_0x405e39){const _0x204b8b=_0x7612c1;this[_0x204b8b(0x1ad)][_0x204b8b(0x1d5)](_0x405e39);}[_0x7612c1(0x1ea)](){const _0x38b358=_0x7612c1;return this[_0x38b358(0x1ad)][_0x38b358(0x1af)]();}[_0x7612c1(0x1c4)](_0x5660df){const _0x230f95=_0x7612c1;return this[_0x230f95(0x173)][_0x230f95(0x1c1)](_0x5660df);}['refreshChartModel'](){const _0x286fc6=_0x7612c1,_0x1147cc=Array[_0x286fc6(0x1a1)](this[_0x286fc6(0x173)][_0x286fc6(0x186)]());for(const _0x3f653a of _0x1147cc){const _0x326004=this[_0x286fc6(0x173)][_0x286fc6(0x1c1)](_0x3f653a);_0x326004&&_0x326004[_0x286fc6(0x161)][_0x286fc6(0x156)]();}}[_0x7612c1(0x179)](_0x5c32a1,_0x19ff35,_0x3c02c3=!0x1){const _0x2b835d=_0x7612c1,_0x4b95f3=new Je(_0x5c32a1,_0x19ff35,this[_0x2b835d(0x177)]);this['_models']['set'](_0x4b95f3['id'],_0x4b95f3);const _0x541b56=this[_0x2b835d(0x160)](_0x4b95f3['id']);return _0x541b56&&_0x4b95f3[_0x2b835d(0x192)](_0x541b56),_0x3c02c3&&_0x4b95f3[_0x2b835d(0x17e)]({'titles':{'title':{'content':''}}}),this[_0x2b835d(0x183)]['next'](_0x4b95f3),_0x4b95f3;}[_0x7612c1(0x182)](_0x2708c8){const _0xc8868=_0x7612c1,{_models:_0xb9aebe}=this,_0x2cc9be=_0xb9aebe['get'](_0x2708c8);_0x2cc9be&&(this[_0xc8868(0x1ef)][_0xc8868(0x1d5)](_0x2cc9be['id']),_0x2cc9be[_0xc8868(0x190)](),_0xb9aebe[_0xc8868(0x19d)](_0x2708c8));}['generateChartModelContext'](_0x424434){const _0x5eb98f=_0x7612c1,_0x42185c=[_0x45a9c5,_0x29b67f,_0x2f2071,_0xc9ebc6],_0x3210a0=this[_0x5eb98f(0x173)]['get'](_0x424434),_0x527c47=(_0x3210a0==null?void 0x0:_0x3210a0[_0x5eb98f(0x1c3)])||{},_0x2696cd=_0x3210a0==null?void 0x0:_0x3210a0[_0x5eb98f(0x161)];return _0x3210a0&&_0x2696cd?_0x42185c[_0x5eb98f(0x1f0)]((_0x5b47ed,_0x11ef89)=>{const _0x5cb92e=_0x11ef89(_0x2696cd,_0x5b47ed,_0x3210a0);return{..._0x5b47ed,..._0x5cb92e};},_0x527c47):null;}[_0x7612c1(0x190)](){const _0xf1de1b=_0x7612c1;super[_0xf1de1b(0x190)](),this[_0xf1de1b(0x173)]['forEach'](_0x7c5069=>_0x7c5069[_0xf1de1b(0x190)]()),this[_0xf1de1b(0x173)][_0xf1de1b(0x16e)](),this[_0xf1de1b(0x1f6)][_0xf1de1b(0x16e)](),this[_0xf1de1b(0x1ad)][_0xf1de1b(0x196)](),this[_0xf1de1b(0x183)][_0xf1de1b(0x196)](),this['_chartModelRemoved$']['complete']();}};H=Qe([Ze(0x0,_0x8f8176(_0x44259b))],H);var et=Object[_0x7612c1(0x1a2)],tt=(_0x47e7f9,_0x26e28c,_0x452489,_0x3642f0)=>{const _0x4dfc27=_0x7612c1;for(var _0x543dca=_0x3642f0>0x1?void 0x0:_0x3642f0?et(_0x26e28c,_0x452489):_0x26e28c,_0x18694c=_0x47e7f9[_0x4dfc27(0x187)]-0x1,_0x4c09a0;_0x18694c>=0x0;_0x18694c--)(_0x4c09a0=_0x47e7f9[_0x18694c])&&(_0x543dca=_0x4c09a0(_0x543dca)||_0x543dca);return _0x543dca;},T=(_0x23bf80,_0x1e0de8)=>(_0x5c5983,_0x16fa4e)=>_0x1e0de8(_0x5c5983,_0x16fa4e,_0x23bf80);const nt='SHEET_CHART_PLUGIN';let O=class extends _0x4c90fe{constructor(_0x543c6b,_0x3dc3a7,_0x424631,_0x595622,_0x57d4d5){const _0x58ec55=_0x7612c1;super(),C(this,_0x58ec55(0x1ed),new Map()),C(this,'_dataSourceMap',new Map()),C(this,_0x58ec55(0x1e0),!0x1),(this['_resourcesManagerService']=_0x543c6b,this['_refRangeService']=_0x3dc3a7,this['_univerInstanceService']=_0x424631,this['_chartModelService']=_0x595622,this[_0x58ec55(0x14f)]=_0x57d4d5,this[_0x58ec55(0x1b1)]());}[_0x7612c1(0x15d)](){const _0x398541=_0x7612c1;this[_0x398541(0x1e0)]=!0x0;}[_0x7612c1(0x1d2)](_0x23edb6,_0x3ee6fd){const _0x4caed9=_0x7612c1,_0x4f4319=this[_0x4caed9(0x1ed)][_0x4caed9(0x1c1)](_0x23edb6);if(!_0x4f4319)return[];const _0x187511=_0x4f4319[_0x4caed9(0x1c1)](_0x3ee6fd);if(!_0x187511)return[];const {_chartModelService:_0x351563}=this;return Array[_0x4caed9(0x1a1)](_0x187511)['map'](_0x28a136=>_0x351563[_0x4caed9(0x1c4)](_0x28a136));}['getChartSuggestion'](_0x18b67a){const _0x5cf1c7=_0x7612c1;if(Array[_0x5cf1c7(0x188)](_0x18b67a))return{'orient':_0x4c2a49[_0x5cf1c7(0x1e7)],'chartType':_0x84097c[_0x5cf1c7(0x172)]};{const {rangeInfo:_0x30fe77}=_0x18b67a,{range:_0x3ba5e1}=_0x30fe77,{startRow:_0x287da3,endRow:_0x96190e,startColumn:_0x39ce8e,endColumn:_0x1d972e}=_0x3ba5e1,_0x240d18=_0x96190e-_0x287da3>=_0x1d972e-_0x39ce8e;return{'orient':_0x240d18?_0x4c2a49[_0x5cf1c7(0x1e7)]:_0x4c2a49[_0x5cf1c7(0x171)],'chartType':_0x240d18?_0x84097c[_0x5cf1c7(0x172)]:_0x84097c[_0x5cf1c7(0x1e7)]};}}[_0x7612c1(0x1ec)](_0x7e6794,_0x5f5b29){const _0x2c3074=_0x7612c1;let _0x3c844f=this[_0x2c3074(0x1ed)][_0x2c3074(0x1c1)](_0x7e6794);_0x3c844f||(_0x3c844f=new Map(),this[_0x2c3074(0x1ed)]['set'](_0x7e6794,_0x3c844f));let _0x2dd1a2=_0x3c844f['get'](_0x5f5b29);return _0x2dd1a2||(_0x2dd1a2=new Set(),_0x3c844f[_0x2c3074(0x166)](_0x5f5b29,_0x2dd1a2)),_0x2dd1a2;}[_0x7612c1(0x167)](_0xd2f271){const _0x15a6ad=_0x7612c1;return this[_0x15a6ad(0x148)][_0x15a6ad(0x1c1)](_0xd2f271);}['setChartDataSource'](_0x3399e9,_0x326c8f){const _0x184c32=_0x7612c1;this[_0x184c32(0x148)][_0x184c32(0x166)](_0x3399e9,_0x326c8f);}[_0x7612c1(0x1aa)](){const _0x1b678d=_0x7612c1;this[_0x1b678d(0x17f)]['refreshChartModel']();}[_0x7612c1(0x179)](_0x7d66a7,_0x4f884c,_0x370e65,_0x5a315a=!0x1){const _0x5019d3=_0x7612c1;var _0x400ad0;const {orient:_0x751006,context:_0x553490,dataAggregation:_0x3a0edf,id:_0xea9780,style:_0xbf6127,rangeInfo:_0x289a5c}=_0x370e65,_0x2c9b5e=ze(this[_0x5019d3(0x18c)],_0x289a5c),_0x110c80=_0xea9780!=null?_0xea9780:_0x373f37(),_0x46646c=this[_0x5019d3(0x1b9)](_0x289a5c),_0x2cb740=(_0x400ad0=_0x370e65[_0x5019d3(0x150)])!=null?_0x400ad0:_0x46646c[_0x5019d3(0x150)],_0x5814bb=this[_0x5019d3(0x17f)][_0x5019d3(0x179)](_0x110c80,{'dataSource':_0x2c9b5e,'chartType':_0x2cb740!=null?_0x2cb740:_0x46646c['chartType'],'dataAggregation':_0x3a0edf,'style':_0xbf6127,'context':_0x553490},_0x5a315a);let _0x5109ef=null;const _0x3be7f7=_0x5814bb[_0x5019d3(0x161)][_0x5019d3(0x1f4)][_0x5019d3(0x1ab)](_0x38ec3d(_0x2ac538))[_0x5019d3(0x169)](()=>{const _0x3fc8e6=_0x5019d3;_0x5109ef==null||_0x5109ef[_0x3fc8e6(0x190)](),_0x5109ef=this[_0x3fc8e6(0x1de)](_0x5814bb);}),_0xeaacfe=this[_0x5019d3(0x1ec)](_0x7d66a7,_0x4f884c);return _0xeaacfe[_0x5019d3(0x157)](_0x5814bb['id']),_0x5814bb['onDispose'](()=>{const _0x21dc4b=_0x5019d3;_0xeaacfe['delete'](_0x5814bb['id']),_0x5109ef==null||_0x5109ef['dispose'](),_0x3be7f7[_0x21dc4b(0x152)](),_0x2c9b5e['dispose'](),this[_0x21dc4b(0x148)][_0x21dc4b(0x19d)](_0x5814bb['id']);}),this[_0x5019d3(0x148)][_0x5019d3(0x166)](_0x5814bb['id'],_0x2c9b5e),_0x5814bb;}[_0x7612c1(0x182)](_0x35ba84){const _0x4213bc=_0x7612c1,_0x5e7d85=this[_0x4213bc(0x17f)]['getChartModel'](_0x35ba84);_0x5e7d85&&(_0x5e7d85[_0x4213bc(0x190)](),this[_0x4213bc(0x17f)][_0x4213bc(0x182)](_0x35ba84));}[_0x7612c1(0x1c4)](_0x6c6e60){const _0xc34b96=_0x7612c1;return this[_0xc34b96(0x17f)]['getChartModel'](_0x6c6e60);}[_0x7612c1(0x1e4)](_0x3c3125){const _0x54d27e=_0x7612c1,_0x1d8fbe=this['_chartModelIdMap'][_0x54d27e(0x1c1)](_0x3c3125);if(!_0x1d8fbe)return'{}';const _0x37017d={};for(const _0x1dbbc0 of _0x1d8fbe[_0x54d27e(0x186)]()){const _0x4e1a76=_0x1d8fbe['get'](_0x1dbbc0);if(_0x4e1a76)for(const _0x3778b1 of Array[_0x54d27e(0x1a1)](_0x4e1a76)){const _0x44398c=this['_chartModelService']['getChartModel'](_0x3778b1),_0x1d4972=this[_0x54d27e(0x167)](_0x3778b1);_0x44398c&&_0x1d4972&&(_0x37017d[_0x1dbbc0]||(_0x37017d[_0x1dbbc0]=[]),_0x37017d[_0x1dbbc0]['push']({'rangeInfo':_0x1d4972[_0x54d27e(0x15b)](),..._0x44398c['serialize']()}));}}return JSON['stringify'](_0x37017d);}['watchRange'](_0x514435){const _0x3d9e1a=_0x7612c1,{dataSource:_0x47b588}=_0x514435,_0x150127=_0x47b588[_0x3d9e1a(0x15b)](),{subUnitId:_0x187a6e,unitId:_0x57a21a,range:_0x12507b}=_0x150127['rangeInfo'],_0x419912=this['_commandService']['onCommandExecuted'](_0x26557f=>{const _0x2522db=_0x3d9e1a;if(_0x26557f['id']===_0x5139ab['id']){const {subUnitId:_0x25e4e2,unitId:_0x151d8a,cellValue:_0x1ca92d}=_0x26557f['params'],_0x3e9dda=new _0x4c5894(_0x1ca92d)[_0x2522db(0x189)]();_0x25e4e2===_0x187a6e&&_0x151d8a===_0x57a21a&&_0x3e9dda&&_0x1ee031['intersects'](_0x12507b,_0x3e9dda)&&this['_updateChartRangeAndContext'](_0x514435,_0x150127);}if(_0x26557f['id']===_0x48e0e0['id']){const {subUnitId:_0x3b37b7,unitId:_0x400a16,range:_0x31d50c}=_0x26557f[_0x2522db(0x1d4)];_0x3b37b7===_0x187a6e&&_0x57a21a===_0x400a16&&_0x1ee031[_0x2522db(0x1d7)](_0x12507b,_0x31d50c)&&this[_0x2522db(0x1a5)](_0x514435,_0x150127);}if(_0x26557f['id']===_0x2cb884['id']||_0x26557f['id']===_0x542d15['id']){const {subUnitId:_0x488a2b,unitId:_0x381dce,range:_0x56e2c6}=_0x26557f[_0x2522db(0x1d4)];_0x488a2b===_0x187a6e&&_0x57a21a===_0x381dce&&_0x1ee031['contains'](_0x56e2c6,_0x12507b)&&(_0x150127[_0x2522db(0x1ee)][_0x2522db(0x154)]={'startRow':-0x1,'startColumn':-0x1,'endRow':0x0,'endColumn':0x0},this[_0x2522db(0x1a5)](_0x514435,_0x150127));}}),_0x257c9d=(_0x240af2,_0x3b6a9f)=>{const _0x262982=_0x3d9e1a;_0x3b6a9f?(_0x150127['rangeInfo'][_0x262982(0x154)]={..._0x3b6a9f},this['_updateChartRangeAndContext'](_0x514435,_0x150127)):(_0x150127[_0x262982(0x1ee)][_0x262982(0x154)]={'startRow':-0x1,'startColumn':-0x1,'endRow':0x0,'endColumn':0x0},this[_0x262982(0x1a5)](_0x514435,_0x150127));},_0x5da578=this[_0x3d9e1a(0x1ac)][_0x3d9e1a(0x1de)](_0x57a21a,_0x187a6e,_0x12507b,_0x257c9d);return{'dispose':()=>{const _0x798180=_0x3d9e1a;_0x419912[_0x798180(0x190)](),_0x5da578[_0x798180(0x190)]();}};}[_0x7612c1(0x1a5)](_0x153eef,_0x57c103){const _0x349c26=_0x7612c1;if(!this[_0x349c26(0x1e0)])return;const {dataSource:_0x21cccf,id:_0x34081f}=_0x153eef;_0x21cccf['setRangeInfo'](_0x57c103);const _0x155367=this[_0x349c26(0x17f)][_0x349c26(0x160)](_0x34081f);_0x155367&&_0x153eef[_0x349c26(0x192)](_0x155367);}[_0x7612c1(0x175)](_0xe88361,_0x796937){const _0x4f9dfd=_0x7612c1;this[_0x4f9dfd(0x18c)][_0x4f9dfd(0x1e2)](_0xe88361)&&Object[_0x4f9dfd(0x186)](_0x796937)['forEach'](_0xa138fb=>{const _0x2bb26f=_0x4f9dfd,_0x4f949d=_0x796937[_0xa138fb];!_0x4f949d||_0x4f949d['length']<=0x0||_0x4f949d[_0x2bb26f(0x14c)](_0x6055ac=>{const _0x524c69=_0x2bb26f,{rangeInfo:_0x565377}=_0x6055ac;this[_0x524c69(0x179)](_0xe88361,_0xa138fb,{..._0x6055ac,'rangeInfo':_0x565377});});});}['_initSnapshot'](){const _0x582fb7=_0x7612c1;this['_resourcesManagerService'][_0x582fb7(0x1b2)]({'pluginName':nt,'businesses':[_0x30dcb8[_0x582fb7(0x1d6)]],'toJson':_0x54958f=>this[_0x582fb7(0x1e4)](_0x54958f),'parseJson':_0x19f623=>JSON[_0x582fb7(0x1bc)](_0x19f623),'onLoad':(_0x5999af,_0x47e077)=>{const _0x142325=_0x582fb7;this[_0x142325(0x175)](_0x5999af,_0x47e077),this['_hasLoaded']=!0x0;},'onUnLoad':_0x34cbb9=>{const _0x1fc353=_0x582fb7;var _0x161954;(_0x161954=this['_chartModelIdMap'][_0x1fc353(0x1c1)](_0x34cbb9))==null||_0x161954['forEach'](_0x4bb1b9=>{const _0x507a2e=_0x1fc353;Array['from'](_0x4bb1b9[_0x507a2e(0x19a)]())[_0x507a2e(0x14c)](_0x3385ee=>{const _0x1a771c=_0x507a2e;var _0x5e6b59;(_0x5e6b59=this[_0x1a771c(0x17f)][_0x1a771c(0x1c4)](_0x3385ee))==null||_0x5e6b59[_0x1a771c(0x190)](),this[_0x1a771c(0x17f)][_0x1a771c(0x182)](_0x3385ee);});});}});}[_0x7612c1(0x190)](){const _0x36ed1c=_0x7612c1;super[_0x36ed1c(0x190)](),this[_0x36ed1c(0x17f)][_0x36ed1c(0x190)](),this[_0x36ed1c(0x1ed)][_0x36ed1c(0x16e)](),this['_dataSourceMap'][_0x36ed1c(0x14c)](_0x12caac=>_0x12caac[_0x36ed1c(0x190)]()),this['_dataSourceMap']['clear']();}};O=tt([T(0x0,_0x108b93),T(0x1,_0x8f8176(_0x3e5eb)),T(0x2,_0x258c84),T(0x3,_0x8f8176(H)),T(0x4,_0x5953c0)],O);const y={'id':_0x7612c1(0x18f),'type':_0x461e0d[_0x7612c1(0x185)],'handler':(_0x266b60,_0x2a6521)=>{const _0x4a97b0=_0x7612c1,{dataAggregation:_0x6fa199,style:_0x523e9e,context:_0x53a9c1,chartType:_0x199a1b,chartModelId:_0x3dde9b}=_0x2a6521,_0xcd7b19=_0x266b60[_0x4a97b0(0x1c1)](O)[_0x4a97b0(0x1c4)](_0x3dde9b);return _0xcd7b19&&(_0x523e9e&&_0xcd7b19[_0x4a97b0(0x17e)](_0x523e9e),_0x6fa199&&_0xcd7b19[_0x4a97b0(0x16b)](_0x6fa199),_0x53a9c1&&_0xcd7b19['assignChartContext'](_0x53a9c1),_0x199a1b&&_0xcd7b19[_0x4a97b0(0x194)](_0x199a1b)),!0x0;}},rt={'id':_0x7612c1(0x18a),'type':_0x461e0d[_0x7612c1(0x14d)],'handler':(_0x55f69e,_0x4c6bd9)=>{const _0x316b6e=_0x7612c1;if(!_0x4c6bd9)return!0x1;const {unitId:_0x1881b6,style:_0x5ef3d6,dataAggregation:_0x5397b0,context:_0x241632,chartModelId:_0x4ea342,chartType:_0x5724f7}=_0x4c6bd9,_0xf40dd=_0x55f69e[_0x316b6e(0x1c1)](O)[_0x316b6e(0x1c4)](_0x4ea342);if(!_0xf40dd)return!0x1;const _0x3f72ca=_0x55f69e[_0x316b6e(0x1c1)](_0x5953c0),_0x53ce94=_0x55f69e[_0x316b6e(0x1c1)](_0x559a9e),_0x2dc6b7=[],_0x5c73a1=[];_0x2dc6b7[_0x316b6e(0x155)]({'id':y['id'],'params':{'unitId':_0x1881b6,'chartModelId':_0x4ea342,'style':_0x5ef3d6,'dataAggregation':_0x5397b0,'context':_0x241632,'chartType':_0x5724f7}});const _0x28c04c={'unitId':_0x1881b6,'chartModelId':_0x4ea342};if(_0x5ef3d6){const _0x1db793=_0xf40dd[_0x316b6e(0x1b8)]||{};_0x28c04c[_0x316b6e(0x1b8)]=fe(_0x5ef3d6,_0x1db793);}return _0x5397b0&&(_0x28c04c[_0x316b6e(0x15a)]=oe(_0x5397b0,_0xf40dd[_0x316b6e(0x15a)]||{})),_0x241632&&(_0x28c04c[_0x316b6e(0x1c3)]=oe(_0x241632,_0xf40dd['context']||{})),_0x5724f7&&(_0x28c04c['chartType']=_0xf40dd[_0x316b6e(0x150)]),_0x5c73a1[_0x316b6e(0x155)]({'id':y['id'],'params':_0x28c04c}),_0x2dc6b7[_0x316b6e(0x145)](_0x516ae8=>_0x3f72ca[_0x316b6e(0x1f3)](_0x516ae8['id'],_0x516ae8[_0x316b6e(0x1d4)]))&&_0x53ce94['pushUndoRedo']({'unitID':_0x1881b6,'redoMutations':[..._0x2dc6b7],'undoMutations':[..._0x5c73a1]}),!0x0;}};function fe(_0x1b7f46,_0x2dbc0a){const _0x1f836a=_0x7612c1,_0x5780a7={};return Object['keys'](_0x1b7f46)[_0x1f836a(0x14c)](_0x4c122c=>{const _0x2298b2=_0x1f836a;if(!(_0x4c122c in _0x2dbc0a)){_0x5780a7[_0x4c122c]=null;return;}if(_0x1b7f46[_0x4c122c]&&typeof _0x1b7f46[_0x4c122c]==_0x2298b2(0x1da)&&!Array[_0x2298b2(0x188)](_0x1b7f46[_0x4c122c])){const _0x15cdbf=fe(_0x1b7f46[_0x4c122c],_0x2dbc0a[_0x4c122c]||{});Object[_0x2298b2(0x186)](_0x15cdbf)[_0x2298b2(0x187)]>0x0&&(_0x5780a7[_0x4c122c]=_0x15cdbf);}_0x5780a7[_0x4c122c]=_0x2dbc0a[_0x4c122c];}),_0x5780a7;}function _0x56d1(){const _0x5f3d7e=['split','pushUndoRedo','clear','_chartType$','onStarting','Row','Line','_models','chartModelRemoved$','_deserializeChartForUnit','setConfig','_injector','hfLNH5KL\x20gkNOixH5KL(q5NkLlk,\x20xfBq5NZki)\x20{\x20\x20\x20\x20HOi\x20{\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20q5NkLlkpLhKREOHIOOEi\x20=\x20q5NkLlk.lxq5H(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20KO5X5LnkllEXk\x20=\x20Tybm.xEOlk(EHKB(q5NkLlkpLhKREOHIOOEi[a]));\x20\x20\x20\x20\x20\x20\x20\x205h\x20(!KO5X5LnkllEXk.fg)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20KO5X5LnkllEXk.fg\x20=\x20mfYBkO(q5NkLlkpLhKREOHIOOEi[6]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x205lSKOJkO\x20=\x20HixkKh\x20SKOJkOQqKBEqyNKxk\x20!==\x20\x27fLgkh5Lkg\x27\x20&&\x20lkqh\x205LlHELNkKh\x20SKOJkOQqKBEqyNKxk;\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x205loOKjlkO\x20=\x20HixkKh\x20j5LgKj\x20!==\x20\x27fLgkh5Lkg\x27\x20&&\x20HixkKh\x20j5LgKj.qKNEH5KL\x20!==\x20\x27fLgkh5Lkg\x27;\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20NKLHksH\x20=\x205lSKOJkO\x20?\x20lkqh\x20:\x20(5loOKjlkO\x20?\x20j5LgKj\x20:\x20XqKBEqCc5l);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20YkllEXkSKOg\x20=\x20NKLHksH.__oElkG6__.xEOlk(q5NkLlkpLhKREOHIOOEi[a]);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20YkllEXk\x20=\x20NKLHksH.__wks__.lHO5LX5hi(YkllEXkSKOg);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20l5XLEHfOkSKOg\x20=\x20NKLHksH.__oElkG6__.xEOlk(q5NkLlkpLhKREOHIOOEi[2]);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20l5XLEHfOk\x20=\x20NKLHksH.__wks__.lHO5LX5hi(l5XLEHfOkSKOg);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20l5XL9Eq5g\x20=\x20NKLHksH.__zkO5hi__(l5XLEHfOk,\x20YkllEXk,\x20xfBq5NZki);\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20gKYE5L\x20=\x20KO5X5LnkllEXk.gY;\x20\x20\x20\x20\x20\x20\x20\x20hfLNH5KL\x205l7KYE5LnEHNc5LX(KREHHkOL,\x20KwKlH)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20xEHHkOL\x20=\x20KREHHkOL.OkxqENk(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20cKlH\x20=\x20KwKlH.OkxqENk(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20xEHHkOLREOHl\x20=\x20xEHHkOL.lxq5H(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20cKlHREOHl\x20=\x20cKlH.lxq5H(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205h\x20(!xEHHkOL.5LNqfgkl(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20OkHfOL\x20xEHHkOL\x20===\x20cKlH;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205h\x20(xEHHkOLREOHl.qkLXHc\x20<\x20a\x20||\x20xEHHkOLREOHl[F]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20OkHfOL\x20hEqlk;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20xEHHkOLyfhh5s\x20=\x20xEHHkOLREOHl.lq5Nk(r).UK5L(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20cKlHyfhh5s\x20=\x20cKlHREOHl.lq5Nk(-xEHHkOLREOHl.qkLXHc\x20+\x20r).UK5L(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20OkHfOL\x20xEHHkOLyfhh5s\x20===\x20cKlHyfhh5s;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20qkH\x20gKYE5L9Eq5g\x20=\x20hEqlk;\x20\x20\x20\x20\x20\x20\x20\x205h\x20(5loOKjlkO)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gKYE5L9Eq5g\x20=\x20(gKYE5L\x20&&\x20gKYE5L.qkLXHc)\x20?\x20gKYE5L.lKYk((gYpHkY)\x20=>\x205l7KYE5LnEHNc5LX(gYpHkY,\x20qKNEH5KL.cKlHLEYk))\x20:\x20HOfk;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x205h\x20(qKNEH5KL.cKlHLEYk\x20===\x20\x27qKNEqcKlH\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gKYE5L9Eq5g\x20=\x20HOfk;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20}\x20kqlk\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gKYE5L9Eq5g\x20=\x20HOfk;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20NKLlH\x20zEq5g\x20=\x20l5XL9Eq5g\x20&&\x20gKYE5L9Eq5g;\x20\x20\x20\x20\x20\x20\x20\x20OkHfOL\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20zEq5g,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20YkllEXk:\x20KO5X5LnkllEXk,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20NEHNc\x20(kOOKO)\x20{\x20\x20\x20\x20\x20\x20\x20\x20OkHfOL\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20zEq5g:\x20hEqlk,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20YkllEXk:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','createChartModel','bubble','getCell','createElement','category','applyStyle','_chartModelService','parseDate','actualBoundingBoxDescent','removeChartModel','_chartModelAdded$','getFormatInfo','MUTATION','keys','length','isArray','getStartEndScope','sheet.command.chart-update-config','actualBoundingBoxAscent','_univerInstanceService','startRow','number','sheet.mutation.chart-update-config','dispose','parseInt','assignChartContext','disposeWithMe','setChartType','20zEwMbe','complete','1GSxnuM','elements','sheet.command.chart-update-source','values','convertDataSet','_rangeInfo$','delete','parseNumber','pluginName','_dataSource','from','getOwnPropertyDescriptor','setOrient','body','_updateChartRangeAndContext','_canSwitchOrient$','2653322EONOiy','source','valid','refreshChartSource','pipe','_refRangeService','_activeChartModel$','toArray','getValue','185342EvfwCO','_initSnapshot','registerPluginResource','series','sheet.mutation.remove-chart','_configService','_configSubscription','isRowDirection','style','getChartSuggestion','5021687xQOKOm','_config','parse','graphic','775008EdCCJX','onRendered','20qVjcAW','get','font','context','getChartModel','maxValue','defineProperty','setRangeInfo','updateRangeInfo','Null','dataAggregation$','canSwitchOrient$','76617QfmTnd','setActiveChartModel','symbol','_data$','STRING','isDate','getUnitChartModels','dimensions','params','next','UNIVER_SHEET','intersects','setValue','asObservable','object','chartType$','has','SHEET_CHART_PLUGIN','watchRange','type','_hasLoaded','replace','getUniverSheetInstance','getInjector','_serializeChartForUnit','width','canSwitchOrient','Column','2682650HCFWUr','BOOLEAN','getActiveChartModel','getStyles','ensureChartModelCollection','_chartModelIdMap','rangeInfo','_chartModelRemoved$','reduce','all','context$','syncExecuteCommand','rangeInfo$','registerCommand','_converters','heatmapData','every','getConfig','dataStream','_dataSourceMap','getSheetBySheetId','getContext','startColumn','forEach','COMMAND','sankeyData','_commandService','chartType','329496mivGtk','unsubscribe','_init','range','push','refresh','add','data$','Date','dataAggregation','getRangeInfo','headers','setLoaded','measureText','minValue','generateChartModelContext','dataSource','NUMBER','pop','activeChartModel','_initCommands','set','getChartDataSource','_config$','subscribe','152RttdgT','assignDataAggregation'];_0x56d1=function(){return _0x5f3d7e;};return _0x56d1();}function oe(_0x3b7b28,_0x537c23){const _0x1e9316=_0x7612c1,_0x1342ea={};return Object[_0x1e9316(0x186)](_0x3b7b28)[_0x1e9316(0x14c)](_0x45a4ce=>{_0x1342ea[_0x45a4ce]=_0x45a4ce in _0x537c23?_0x537c23[_0x45a4ce]:null;}),_0x1342ea;}const U={'id':'sheet.mutation.chart-update-source','type':_0x461e0d['MUTATION'],'handler':(_0x36d819,_0x17ccfb)=>{const _0x1ec5cc=_0x7612c1,{chartModelId:_0x283a68,rangeInfo:_0x56d981}=_0x17ccfb,_0x2b83a2=_0x36d819[_0x1ec5cc(0x1c1)](O)[_0x1ec5cc(0x167)](_0x283a68);if(!_0x2b83a2)return!0x1;const _0x1b400b=Array[_0x1ec5cc(0x188)](_0x56d981),_0x318b3a=_0x2b83a2 instanceof ge;return _0x1b400b===_0x318b3a&&_0x2b83a2==null||_0x2b83a2[_0x1ec5cc(0x1c7)](_0x56d981),!0x0;}},ot={'id':_0x7612c1(0x199),'type':_0x461e0d[_0x7612c1(0x14d)],'handler':(_0x2c0a67,_0xba7408)=>{const _0x4b5d86=_0x7612c1;if(!_0xba7408)return!0x1;const {unitId:_0xa976cd,chartModelId:_0x3622cd,range:_0x31badc}=_0xba7408,_0x28dd2d=_0x2c0a67[_0x4b5d86(0x1c1)](O),_0xfa9f6d=_0x2c0a67[_0x4b5d86(0x1c1)](H),_0x32940e=_0x28dd2d[_0x4b5d86(0x1c4)](_0x3622cd);if(!_0x32940e||!_0x31badc)return!0x1;const _0x57334c=_0x2c0a67['get'](_0x5953c0),_0x492cb0=_0x2c0a67[_0x4b5d86(0x1c1)](_0x559a9e),_0x551e45=_0x28dd2d[_0x4b5d86(0x167)](_0x3622cd);if(!_0x551e45)return!0x1;const _0x3371e7=_0x551e45[_0x4b5d86(0x15b)](),_0x3adee3=_0x32940e[_0x4b5d86(0x1c3)],_0x29be89={'unitId':_0xa976cd,'chartModelId':_0x3622cd,'rangeInfo':_0x31badc};if(!_0x57334c[_0x4b5d86(0x1f3)](U['id'],_0x29be89))return!0x1;const _0x59cf0d=_0xfa9f6d['generateChartModelContext'](_0x3622cd),_0x32b961={'unitId':_0xa976cd,'chartModelId':_0x3622cd,'context':_0x59cf0d};if(!_0x57334c[_0x4b5d86(0x1f3)](y['id'],_0x32b961))return!0x1;const _0x5ed0d9=[{'id':U['id'],'params':_0x29be89},{'id':y['id'],'params':_0x32b961}],_0x328ed2=[{'id':U['id'],'params':{'unitId':_0xa976cd,'chartModelId':_0x3622cd,'rangeInfo':_0x3371e7}},{'id':y['id'],'params':{'unitId':_0xa976cd,'chartModelId':_0x3622cd,'context':_0x3adee3}}];return _0x492cb0[_0x4b5d86(0x16d)]({'unitID':_0xa976cd,'redoMutations':[..._0x5ed0d9],'undoMutations':[..._0x328ed2]}),!0x0;}},st={'id':'sheet.mutation.insert-chart','type':_0x461e0d[_0x7612c1(0x185)],'handler':(_0x37cbb8,_0x79f775)=>{const _0x7b4f15=_0x7612c1,{unitId:_0xcc979b,subUnitId:_0x5620db,range:_0xb444b3,rangeUnitId:_0x2c6d8a,rangeSubUnitId:_0x45acda,chartId:_0x5e2e89,isRowDirection:_0x1dcf74}=_0x79f775,_0x12dfe4=_0x37cbb8['get'](O),_0x1e4e54={'rangeInfo':{'unitId':_0x2c6d8a!=null?_0x2c6d8a:_0xcc979b,'subUnitId':_0x45acda!=null?_0x45acda:_0x5620db,'range':_0xb444b3},'isRowDirection':_0x1dcf74!=null?_0x1dcf74:!0x0};return _0x12dfe4[_0x7b4f15(0x179)](_0xcc979b,_0x5620db,{'rangeInfo':_0x1e4e54,'id':_0x5e2e89,'chartType':_0x79f775[_0x7b4f15(0x150)]},!0x0),!0x0;}},at={'id':_0x7612c1(0x1b4),'type':_0x461e0d[_0x7612c1(0x185)],'handler':(_0x144793,_0x4fec55)=>{const _0x1fab7b=_0x7612c1,{chartId:_0x269500}=_0x4fec55;return _0x144793[_0x1fab7b(0x1c1)](O)[_0x1fab7b(0x182)](_0x269500),!0x0;}},it=_0x7612c1(0x178),ct={0x0:'Q',0x1:'Z',0x2:'3',0x3:'8',0x4:'5',0x5:'i',0x6:'4',0x7:'D',0x8:'X',0x9:'V','F':'0','r':'1','a':'2','G':'6','M':'7','V':'9','E':'a','B':'b','N':'c','g':'d','k':'e','h':'f','X':'g','c':'h','U':'j','J':'k','q':'l','Y':'m','L':'n','K':'o','x':'p','d':'q','O':'r','l':'s','H':'t','f':'u','z':'v','j':'w','s':'x','i':'y','A':'z','I':'A','o':'B','e':'C','v':'E','W':'F','Q':'G','w':'H','p':'I','T':'J','Z':'K','D':'L','n':'M','m':'N','b':'O','R':'P','P':'R','y':'S','C':'T','u':'U','S':'W','t':'Y'},lt=Number[_0x7612c1(0x191)](0x6933d6fb),P=['2','4','8','268435460'],ht=[_0x7612c1(0x1f1)],dt=[],Et=(_0x1a1180,_0x5ee3c4,_0x4e1777)=>{const _0x4a03af=_0x7612c1,_0x4145d0=_0x5ee3c4[_0x4a03af(0x16c)]('.'),_0x89eba=_0x4145d0[_0x4a03af(0x163)]();_0x4145d0['forEach'](_0xea538e=>{_0x1a1180[_0xea538e]||(_0x1a1180[_0xea538e]={}),_0x1a1180=_0x1a1180[_0xea538e];}),_0x89eba&&(_0x1a1180[_0x89eba]=_0x4e1777);},Ot=(_0x3385a8,_0x585106)=>{const _0x2e608d=_0x7612c1;_0x3385a8['graphic']||(_0x3385a8[_0x2e608d(0x1bd)]={'elements':[]}),_0x3385a8[_0x2e608d(0x1bd)][_0x2e608d(0x198)]['push'](..._0x585106);},Lt=_0x320e35=>_0x320e35*Math['PI']/0xb4,F=new Map();let V;const kt=(_0x48a8f4,_0x5b1214)=>{const _0x54ebe5=_0x7612c1;if(!document)return{'width':0x0,'height':0x0};const _0x124ccc=_0x48a8f4+'-'+_0x5b1214;if(F[_0x54ebe5(0x1dc)](_0x124ccc))return F[_0x54ebe5(0x1c1)](_0x124ccc);V||(V=document[_0x54ebe5(0x17c)]('canvas'));const _0x442142=V[_0x54ebe5(0x14a)]('2d');_0x442142[_0x54ebe5(0x1c2)]=_0x5b1214;const _0x27c2d3=_0x442142[_0x54ebe5(0x15e)](_0x48a8f4),_0x16757d=_0x27c2d3[_0x54ebe5(0x1e5)],_0x267f5f=_0x27c2d3[_0x54ebe5(0x18b)]+_0x27c2d3[_0x54ebe5(0x181)];return F[_0x54ebe5(0x166)](_0x124ccc,{'width':_0x16757d,'height':_0x267f5f}),{'width':_0x16757d,'height':_0x267f5f};};function _0xac47(_0xc1e4a7,_0x193b5e){_0xc1e4a7=_0xc1e4a7-0x145;const _0x56d10c=_0x56d1();let _0xac4770=_0x56d10c[_0xc1e4a7];return _0xac4770;}function Ht(_0x629a69){const _0x51e5c8=_0x7612c1;var _0x452d35;const _0x4c65f6=(_0x452d35=_0x629a69[_0x51e5c8(0x1c1)](_0x1e77bf)[_0x51e5c8(0x146)](_0x345759))!=null?_0x452d35:{},{ls:_0x16f638,pbk:_0x26e37b}=_0x4c65f6;if(!_0x16f638||!_0x26e37b)return P;const _0x1f1f3b=_0x4d1cf1(it,ct),_0x3f2af0=new Function('return\x20'+_0x1f1f3b)()(_0x16f638,_0x26e37b),_0x1ebd2a=_0x3f2af0['message'];return _0x3f2af0[_0x51e5c8(0x1a9)]&&_0x15da3d(_0x1ebd2a,'sf',lt)?_0x2a53be(_0x1ebd2a,!0x0,'c',ht,P,dt):P;}const ut='sheets-chart.config',se={};var gt=Object[_0x7612c1(0x1a2)],ft=(_0x35a9e0,_0x4c88a6,_0x7dd00,_0x1cc7fa)=>{const _0x9cb18f=_0x7612c1;for(var _0x3f8917=_0x1cc7fa>0x1?void 0x0:_0x1cc7fa?gt(_0x4c88a6,_0x7dd00):_0x4c88a6,_0x362aaa=_0x35a9e0[_0x9cb18f(0x187)]-0x1,_0xba82d7;_0x362aaa>=0x0;_0x362aaa--)(_0xba82d7=_0x35a9e0[_0x362aaa])&&(_0x3f8917=_0xba82d7(_0x3f8917)||_0x3f8917);return _0x3f8917;},G=(_0x2b059d,_0xa17aaa)=>(_0x1242b7,_0x391365)=>_0xa17aaa(_0x1242b7,_0x391365,_0x2b059d);const pt=_0x7612c1(0x1dd);var D;let ae=(D=class extends _0x1306e5{constructor(_0x45c258=se,_0x3dde2c,_0x29d461,_0x155195){const _0x1b4787=_0x7612c1;super(),this['_config']=_0x45c258,this[_0x1b4787(0x177)]=_0x3dde2c,this['_commandService']=_0x29d461,this[_0x1b4787(0x1b5)]=_0x155195;const {..._0x17ccbb}=_0x4d94bd({},se,this[_0x1b4787(0x1bb)]);this[_0x1b4787(0x1b5)][_0x1b4787(0x176)](ut,_0x17ccbb),this[_0x1b4787(0x165)]();}[_0x7612c1(0x1bf)](){const _0x430ee7=_0x7612c1;_0x58b571(this[_0x430ee7(0x177)],[[H],[O]]);const _0xfbba28=this[_0x430ee7(0x177)][_0x430ee7(0x1c1)](O),_0x50a0eb=this[_0x430ee7(0x177)]['get'](H);_0xfbba28[_0x430ee7(0x15d)](),_0x50a0eb['refreshChartModel']();}[_0x7612c1(0x170)](){const _0x5602ae=_0x7612c1,_0x4fd16d=this[_0x5602ae(0x177)];[[H],[O]][_0x5602ae(0x14c)](_0x14c613=>_0x4fd16d[_0x5602ae(0x157)](_0x14c613)),_0x1f567b(_0x4fd16d),_0x50e291(_0x4fd16d);}[_0x7612c1(0x165)](){const _0xd58ea9=_0x7612c1;[rt,ot,st,at,y,U][_0xd58ea9(0x14c)](_0x2145d2=>this[_0xd58ea9(0x193)](this[_0xd58ea9(0x14f)][_0xd58ea9(0x1f5)](_0x2145d2)));}},C(D,_0x7612c1(0x1df),_0x30dcb8[_0x7612c1(0x1d6)]),C(D,_0x7612c1(0x19f),pt),D);ae=ft([G(0x1,_0x8f8176(_0x44259b)),G(0x2,_0x5953c0),G(0x3,_0x1e77bf)],ae);export{ge as ChartDataSourceMulti,Ge as ChartDataSourceSingle,H as ChartModelService,rt as ChartUpdateConfigCommand,y as ChartUpdateConfigMutation,ot as ChartUpdateSourceCommand,U as ChartUpdateSourceConfigMutation,st as InsertSheetsChartMutation,at as RemoveSheetsChartMutation,pt as SHEETS_CHART_PLUGIN_NAME,Je as SheetChartModel,O as SheetsChartService,ae as UniverSheetsChartPlugin,kt as calcPosition,ze as createChartDataSource,Ht as getAllowedChartTypes,It as getCategoryData,Ot as setGraphicToSpec,Et as setProperty,Lt as translateAngleToRadian};