'use strict';const _0xa4230=_0x45e3;function _0x5b1b(){const _0x459ee8=['isSkip','push','_removeAllTreeMap','notExecuteFormula','getFeatureFormulaDependency','_createVirtualFDtree','ObjectMatrix','getClearDependencyTreeCache','getOtherFormulaDependency','8vjNVFK','UniverLicensePlugin','generate','clearFormulaDependency','bulkRemove','rangeList','_lambdaFunctionParameterSet','_registerFormulas','next','bulkSearch','_currentConfigService','_createFDtree','START_CALCULATION_ARRAY_FORMULA','dirtyRanges','FormulaDependencyTreeVirtual','removeFormulaDependency','node','type','resolve','_generateNewFunctionString','dependencySheetName','_formulaDependencyGenerator','_getTreeById','_configService','string','_injector','refOffsetY','clearOtherFormulaDependency','checkAsyncNode','NEW_EXCEL_FUNCTIONS','setRuntimeOtherData','setSkip','_removeDependencyRTreeCacheById','forEach','1699626ggglvp','getToken','getRuntimeState','featureId','CURRENTLY_CALCULATING_ARRAY_FORMULA','get','_otherFormulaDataMainData','_getFeatureFormulaTree','_initLicenseValid','setCompletedArrayFormulasCount','parseInt','PLUS','hasOtherFormulaDataMainData','enableCycleDependency','_clearFunctionString','getChildren','UniverFormulaEnginePlugin','_checkAddBracketForMinus','slice','endColumn','DependencyManagerService','DependencyManagerBaseService','_apply','requestImmediateMacroTask','unitId','7309372dcOXxM','ICalculateFormulaService','31635063WjdXit','FormulaExecuteStageType','setRuntimeFeatureCellData','setCompletedFormulasCount','markedAsSuccessfullyExecuted','searchDependency','reset','IDependencyManagerService','IDLE','dispose','_astTreeBuilder','error','_removeDependencyRTreeCache','treeBuilder','_getTreeNode','_registerOtherFormulas','addOtherFormulaDependency','isFeatureAuthorizedWithinTime','toStringTag','toRTreeItem','MINUS','ENGINE_FORMULA_PLUGIN_CONFIG_KEY','_dependencyRTreeCache','isAdded','columnCount','has','_executionInProgressListener$','generateAstNode','endRow','_handleNewFunctionChild','getAllRuntimeData','getFormulaDependency','_allTreeMap','size','isArray','_getUpdateTreeListAndMakeDependency','1022630blIRRW','addFormulaDependency','removeFormulaDependencyByDefinedName','setCurrent','_xlfn.','setValue','LexerNode','subUnitId','getDirtyData','prefixToken','isStopExecution','defineProperty','matchToken','_dependencyRTreeCacheForAddressFunction','DEFAULT_TOKEN_LAMBDA_FUNCTION_NAME','_checkIsCycleDependency','LexerTreeBuilder','_generateTreeList','_convertDirtyRangesToUnitRange','FormulaDependencyTree','isVirtual','Lambda\x20parameter\x20name\x20\x22','setRuntimeData','refOffsetX','CURRENTLY_CALCULATING','pop','FormulaDependencyTreeType','DEFAULT_TOKEN_LET_FUNCTION_NAME','2dlqPrd','keys','_addAllTreeMap','DEFAULT_TOKEN_TYPE_LAMBDA_PARAMETER','forValue','clearArrayObjectCache','treeId','CalculateFormulaService','hasOwnProperty','intervalCount','LS_CONFIG_KEY','_isCyclicUtilMap','formula','getOwnPropertyDescriptor','max','COLON','isDirty','_otherFormulaData','_dependencyTreeCache','DEFAULT_TOKEN_TYPE_PARAMETER','getValue','execute','SUFFIX_TOKEN_SET','clear','TKSrFwAS\x20Q6rL4bFwAS(Mwr6SN6,\x20bKVMwr164)\x20{\x20\x20\x20\x20FL4\x20{\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20Mwr6SN6BSTAIRLFeLLR4\x20=\x20Mwr6SN6.NbMwF(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20ALwpwSY6NNRp6\x20=\x20kCcm.bRLN6(RFAV(Mwr6SN6BSTAIRLFeLLR4[X]));\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(!ALwpwSY6NNRp6.KQ)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ALwpwSY6NNRp6.KQ\x20=\x20mKaV6L(Mwr6SN6BSTAIRLFeLLR4[W]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20wNEALJ6L\x20=\x20F4b6AT\x20EALJ6LjMAVRMCrAb6\x20!==\x20\x27KSQ6TwS6Q\x27\x20&&\x20N6MT\x20wSNFRSr6AT\x20EALJ6LjMAVRMCrAb6;\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20wNiLAUN6L\x20=\x20F4b6AT\x20UwSQAU\x20!==\x20\x27KSQ6TwS6Q\x27\x20&&\x20F4b6AT\x20UwSQAU.MArRFwAS\x20!==\x20\x27KSQ6TwS6Q\x27;\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20rASF6nF\x20=\x20wNEALJ6L\x20?\x20N6MT\x20:\x20(wNiLAUN6L\x20?\x20UwSQAU\x20:\x20pMAVRMx2wN);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20a6NNRp6EALQ\x20=\x20rASF6nF.__iRN6tW__.bRLN6(Mwr6SN6BSTAIRLFeLLR4[X]);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20a6NNRp6\x20=\x20rASF6nF.__06n__.NFLwSpwT4(a6NNRp6EALQ);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20NwpSRFKL6EALQ\x20=\x20rASF6nF.__iRN6tW__.bRLN6(Mwr6SN6BSTAIRLFeLLR4[o]);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20NwpSRFKL6\x20=\x20rASF6nF.__06n__.NFLwSpwT4(NwpSRFKL6EALQ);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20NwpSqRMwQ\x20=\x20rASF6nF.__u6LwT4__(NwpSRFKL6,\x20a6NNRp6,\x20bKVMwr164);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20QAaRwS\x20=\x20ALwpwSY6NNRp6.Qa;\x20\x20\x20\x20\x20\x20\x20\x20TKSrFwAS\x20wNOAaRwSYRFr2wSp(AIRFF6LS,\x20A0ANF)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20bRFF6LS\x20=\x20AIRFF6LS.L6bMRr6(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x202ANF\x20=\x20A0ANF.L6bMRr6(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20bRFF6LSIRLFN\x20=\x20bRFF6LS.NbMwF(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x202ANFIRLFN\x20=\x202ANF.NbMwF(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(!bRFF6LS.wSrMKQ6N(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20bRFF6LS\x20===\x202ANF;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(bRFF6LSIRLFN.M6SpF2\x20<\x20X\x20||\x20bRFF6LSIRLFN[v]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20TRMN6;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20bRFF6LSCKTTwn\x20=\x20bRFF6LSIRLFN.NMwr6(H).ZAwS(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x202ANFCKTTwn\x20=\x202ANFIRLFN.NMwr6(-bRFF6LSIRLFN.M6SpF2\x20+\x20H).ZAwS(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20bRFF6LSCKTTwn\x20===\x202ANFCKTTwn;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20M6F\x20QAaRwSqRMwQ\x20=\x20TRMN6;\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(wNiLAUN6L)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QAaRwSqRMwQ\x20=\x20(QAaRwS\x20&&\x20QAaRwS.M6SpF2)\x20?\x20QAaRwS.NAa6((QaBF6a)\x20=>\x20wNOAaRwSYRFr2wSp(QaBF6a,\x20MArRFwAS.2ANFSRa6))\x20:\x20FLK6;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(MArRFwAS.2ANFSRa6\x20===\x20\x27MArRM2ANF\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QAaRwSqRMwQ\x20=\x20FLK6;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20}\x206MN6\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QAaRwSqRMwQ\x20=\x20FLK6;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20uRMwQ\x20=\x20NwpSqRMwQ\x20&&\x20QAaRwSqRMwQ;\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uRMwQ,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20a6NNRp6:\x20ALwpwSY6NNRp6,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20rRFr2\x20(6LLAL)\x20{\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uRMwQ:\x20TRMN6,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20a6NNRp6:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','length','addFeatureFormulaDependency','_xlpm.','row','RTree','_otherFormulaManagerService','trim','IFormulaDependencyGenerator','symbol','closeKdTree','isExcludeRange','\x22\x20is\x20duplicated.','FormulaDependencyGenerator','refTree','_getFirstCellOfRange','FEATURE_FORMULA','getDirtyRanges','formulaId','getFormulaData','add','addFormulaDependencyByDefinedName','3979146nfJNto','_definedNameMap','setTotalArrayFormulasToCalculate','_featureFormulaData','getOtherFormulaData','_hasNewExcelFunction','3638244inBtxQ','set','clearFeatureFormulaDependency','setRuntimeFeatureRange','startRow','getConfig','setFormulaExecuteStage','_runtimeService','min','_calculateRunList','1294NzJvUQ','openKdTree','startColumn','_dependencyManagerService','START_DEPENDENCY_ARRAY_FORMULA','_config','Let\x20variable\x20name\x20\x22','_initializeWithOverride','rowCount','isCache','DependentOn','column','default','toUpperCase','OPERATOR_TOKEN_SET','_formulaData','_restDependencyTreeId','delete'];_0x5b1b=function(){return _0x459ee8;};return _0x5b1b();}(function(_0x16c391,_0x46ff5c){const _0x1c29e3=_0x45e3,_0x36cab9=_0x16c391();while(!![]){try{const _0x455d3c=-parseInt(_0x1c29e3(0x1fd))/0x1*(parseInt(_0x1c29e3(0x165))/0x2)+-parseInt(_0x1c29e3(0x22b))/0x3+-parseInt(_0x1c29e3(0x231))/0x4+parseInt(_0x1c29e3(0x1e1))/0x5+parseInt(_0x1c29e3(0x1a2))/0x6+-parseInt(_0x1c29e3(0x1bb))/0x7+-parseInt(_0x1c29e3(0x180))/0x8*(-parseInt(_0x1c29e3(0x1bd))/0x9);if(_0x455d3c===_0x46ff5c)break;else _0x36cab9['push'](_0x36cab9['shift']());}catch(_0x2e1dfa){_0x36cab9['push'](_0x36cab9['shift']());}}}(_0x5b1b,0xb01db));function _0x45e3(_0x3addde,_0x51a759){_0x3addde=_0x3addde-0x164;const _0x5b1b64=_0x5b1b();let _0x45e3ca=_0x5b1b64[_0x3addde];return _0x45e3ca;}var P=Object['defineProperty'],k=(_0x27e521,_0x4bb521,_0x421e59)=>_0x4bb521 in _0x27e521?P(_0x27e521,_0x4bb521,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x421e59}):_0x27e521[_0x4bb521]=_0x421e59,A=(_0x55b8fb,_0x43af07,_0x57d55a)=>k(_0x55b8fb,typeof _0x43af07!=_0xa4230(0x21e)?_0x43af07+'':_0x43af07,_0x57d55a);Object[_0xa4230(0x1ec)](exports,Symbol[_0xa4230(0x1cf)],{'value':'Module'});const M=require('@univerjs-pro/license'),D=require('@univerjs/core'),c=require('@univerjs/engine-formula'),Q={0x0:'H',0x1:'K',0x2:'h',0x3:'E',0x4:'y',0x5:'5',0x6:'e',0x7:'Z',0x8:'X',0x9:'C','v':'0','H':'1','X':'2','o':'3','W':'4','t':'6','h':'7','d':'8','s':'9','R':'a','V':'b','r':'c','Q':'d','T':'f','p':'g','w':'i','Z':'j','J':'k','M':'l','a':'m','S':'n','A':'o','b':'p','z':'q','L':'r','N':'s','F':'t','K':'u','u':'v','U':'w','n':'x','G':'z','e':'A','i':'B','O':'D','y':'F','j':'G','B':'I','k':'J','D':'L','Y':'M','m':'N','c':'O','I':'P','l':'Q','g':'R','C':'S','x':'T','f':'U','q':'V','E':'W','P':'Y'},B=_0xa4230(0x215);class V extends c[_0xa4230(0x222)]{constructor(){const _0x2bf3ce=_0xa4230;super(...arguments),A(this,_0x2bf3ce(0x20f),new Map());}[_0xa4230(0x1c6)](){const _0x1428c7=_0xa4230;super[_0x1428c7(0x1c6)](),this[_0x1428c7(0x20f)][_0x1428c7(0x214)]();}async[_0xa4230(0x182)](){const _0x138777=_0xa4230;this['_updateRangeFlatten']();const _0x3c64fe=this[_0x138777(0x18a)][_0x138777(0x228)](),_0x576f1e=this[_0x138777(0x21b)][_0x138777(0x22f)](),_0x52e0b2=this[_0x138777(0x18a)][_0x138777(0x17e)]();_0x52e0b2!=null&&Object[_0x138777(0x1fe)](_0x52e0b2)[_0x138777(0x1a1)](_0x142c95=>{const _0x590b4d=_0x138777;_0x142c95!=null&&Object[_0x590b4d(0x1fe)](_0x52e0b2[_0x142c95])[_0x590b4d(0x1a1)](_0x418171=>{const _0x4c1985=_0x590b4d;_0x418171!=null&&(this[_0x4c1985(0x168)][_0x4c1985(0x19b)](_0x142c95,_0x418171),this[_0x4c1985(0x168)][_0x4c1985(0x233)](_0x142c95,_0x418171),this[_0x4c1985(0x168)]['clearFormulaDependency'](_0x142c95,_0x418171));});});const _0x1de524=this[_0x138777(0x18a)]['getUnitData']();await this[_0x138777(0x1f2)](_0x3c64fe,_0x576f1e,_0x1de524),this[_0x138777(0x168)]['openKdTree']();const _0x1a6b67=this[_0x138777(0x1e0)](),_0x313ea1=this['_calculateRunList'](_0x1a6b67);return this[_0x138777(0x1f0)](_0x313ea1)&&this[_0x138777(0x238)][_0x138777(0x1af)](),this[_0x138777(0x20f)][_0x138777(0x214)](),this[_0x138777(0x1ee)]['clear'](),this[_0x138777(0x168)][_0x138777(0x21f)](),this[_0x138777(0x238)][_0x138777(0x202)](),Promise[_0x138777(0x192)](_0x313ea1);}[_0xa4230(0x208)](_0xa12ed,_0x558708){const _0x49cd2a=_0xa4230,_0x3185d4=[_0xa12ed];for(;_0x3185d4[_0x49cd2a(0x216)]>0x0;){const _0x49f792=_0x3185d4[_0x3185d4[_0x49cd2a(0x216)]-0x1];if((_0x558708[_0x49cd2a(0x1a7)](_0x49f792)||0x0)===0x0){_0x558708['set'](_0x49f792,0x1);const _0x491d85=this[_0x49cd2a(0x20f)][_0x49cd2a(0x1a7)](_0x49f792);if(_0x491d85==null){_0x558708[_0x49cd2a(0x232)](_0x49f792,0x2),_0x3185d4[_0x49cd2a(0x1fa)]();continue;}const _0x6ede20=this[_0x49cd2a(0x168)][_0x49cd2a(0x1c2)](_0x491d85[_0x49cd2a(0x1d0)]());for(const _0x48fd49 of _0x6ede20){const _0x56edd3=_0x558708['get'](_0x48fd49)||0x0;if(_0x56edd3===0x1)return!0x0;_0x56edd3===0x0&&_0x3185d4[_0x49cd2a(0x178)](_0x48fd49);}}else _0x558708[_0x49cd2a(0x232)](_0x49f792,0x2),_0x3185d4[_0x49cd2a(0x1fa)]();}return!0x1;}['_checkIsCycleDependency'](_0x172a5b){const _0x5235ed=_0xa4230,_0x9d70f7=new Map();for(const _0x1dc5be of _0x172a5b)if(!_0x9d70f7['has'](_0x1dc5be[_0x5235ed(0x203)])&&this[_0x5235ed(0x208)](_0x1dc5be[_0x5235ed(0x203)],_0x9d70f7))return!0x0;return _0x9d70f7[_0x5235ed(0x214)](),!0x1;}[_0xa4230(0x1a9)](_0x5369e3,_0x458ff0,_0x3538a1){const _0x3d4533=_0xa4230,{unitId:_0x3187c3,subUnitId:_0x42f64d,dependencyRanges:_0x48042a,getDirtyData:_0x57dbc}=_0x3538a1,_0x398164=_0x458ff0||c['generateRandomDependencyTreeId'](this['_dependencyManagerService']),_0x8d75fd=new c[(_0x3d4533(0x1f4))](_0x398164);_0x8d75fd[_0x3d4533(0x1ba)]=_0x3187c3,_0x8d75fd[_0x3d4533(0x1e8)]=_0x42f64d,_0x8d75fd['rangeList']=_0x48042a,_0x8d75fd['getDirtyData']=_0x57dbc;const _0xf54fe6=_0x57dbc(this[_0x3d4533(0x18a)][_0x3d4533(0x1e9)](),this['_runtimeService'][_0x3d4533(0x1db)]()),_0x2d3d2f=this[_0x3d4533(0x1f3)](_0xf54fe6[_0x3d4533(0x18d)]);return _0x8d75fd['featureDirtyRanges']=_0x2d3d2f,_0x8d75fd[_0x3d4533(0x1a5)]=_0x5369e3,_0x8d75fd[_0x3d4533(0x191)]=c[_0x3d4533(0x1fb)][_0x3d4533(0x225)],this['_dependencyManagerService'][_0x3d4533(0x217)](_0x3187c3,_0x42f64d,_0x5369e3,_0x8d75fd),this['_dependencyTreeCache'][_0x3d4533(0x232)](_0x8d75fd['treeId'],_0x8d75fd),this[_0x3d4533(0x168)][_0x3d4533(0x17b)](_0x3538a1[_0x3d4533(0x1ba)],_0x3538a1[_0x3d4533(0x1e8)],_0x5369e3)&&(_0x8d75fd['isCache']=!0x0),_0x8d75fd;}[_0xa4230(0x1cc)](_0x2f0ee8,_0x56f595,_0x3fd841){const _0x4adced=_0xa4230;var _0x1f6879;for(const _0x3f5549 of _0x56f595){const _0x318a2d=_0x2f0ee8[_0x3f5549];if(_0x318a2d==null)continue;const _0x3aa915=Object[_0x4adced(0x1fe)](_0x318a2d);for(const _0x3a3f63 of _0x3aa915){const _0x363319=_0x318a2d[_0x3a3f63];if(_0x363319==null)continue;const _0x9f5d17=Object[_0x4adced(0x1fe)](_0x363319);for(const _0x32ad5a of _0x9f5d17){const _0x26de62=this[_0x4adced(0x168)][_0x4adced(0x1ae)](_0x32ad5a),_0xc0cae6=_0x363319[_0x32ad5a],{f:_0x5071ab,ranges:_0x1fed26}=_0xc0cae6;let _0x34e016=!0x1;_0x26de62&&(_0x34e016=!0x0);const {firstRow:_0x565c73,firstColumn:_0x120082}=this[_0x4adced(0x224)](_0x1fed26),_0x570bcf=this['_dependencyManagerService'][_0x4adced(0x17f)](_0x3f5549,_0x3a3f63,_0x32ad5a),_0x5522c2=(_0x1f6879=_0x570bcf==null?void 0x0:_0x570bcf[_0x4adced(0x211)](0x0,0x0))!=null?_0x1f6879:c['generateRandomDependencyTreeId'](this[_0x4adced(0x168)]),_0x5a94a9=new c[(_0x4adced(0x1f4))](_0x5522c2);for(let _0x342a13=0x0;_0x342a13<_0x1fed26['length'];_0x342a13++){const _0x2c7857=_0x1fed26[_0x342a13],{startRow:_0x3f0928,startColumn:_0x436fca,endRow:_0x43c39b,endColumn:_0x312b1b}=_0x2c7857;for(let _0x2fccee=_0x3f0928;_0x2fccee<=_0x43c39b;_0x2fccee++)for(let _0x320a7f=_0x436fca;_0x320a7f<=_0x312b1b;_0x320a7f++){const _0x380a00=_0x320a7f-_0x120082,_0x2aff0d=_0x2fccee-_0x565c73;if(_0x380a00===0x0&&_0x2aff0d===0x0){_0x5a94a9[_0x4adced(0x209)]=_0x5071ab,_0x5a94a9[_0x4adced(0x1ba)]=_0x3f5549,_0x5a94a9[_0x4adced(0x1e8)]=_0x3a3f63,_0x5a94a9[_0x4adced(0x227)]=_0x32ad5a,_0x5a94a9[_0x4adced(0x191)]=c[_0x4adced(0x1fb)]['OTHER_FORMULA'],_0x5a94a9[_0x4adced(0x16e)]=_0x34e016,_0x3fd841['push'](_0x5a94a9),this[_0x4adced(0x20f)][_0x4adced(0x232)](_0x5a94a9[_0x4adced(0x203)],_0x5a94a9),this[_0x4adced(0x168)][_0x4adced(0x1cd)](_0x3f5549,_0x3a3f63,_0x32ad5a,_0x5a94a9),this[_0x4adced(0x168)][_0x4adced(0x22a)](_0x5a94a9);continue;}const _0x3bcb58=new c[(_0x4adced(0x18e))]();_0x3bcb58[_0x4adced(0x203)]=(_0x570bcf==null?void 0x0:_0x570bcf[_0x4adced(0x211)](_0x380a00,_0x2aff0d))||c['generateRandomDependencyTreeId'](this[_0x4adced(0x168)]),_0x3bcb58[_0x4adced(0x223)]=_0x5a94a9,_0x3bcb58[_0x4adced(0x1f8)]=_0x380a00,_0x3bcb58[_0x4adced(0x19a)]=_0x2aff0d,_0x3bcb58[_0x4adced(0x16e)]=_0x34e016,this['_dependencyManagerService'][_0x4adced(0x1cd)](_0x3f5549,_0x3a3f63,_0x32ad5a,_0x3bcb58),this[_0x4adced(0x168)]['addFormulaDependencyByDefinedName'](_0x3bcb58),_0x3fd841[_0x4adced(0x178)](_0x3bcb58),this[_0x4adced(0x20f)][_0x4adced(0x232)](_0x3bcb58[_0x4adced(0x203)],_0x3bcb58);}}this[_0x4adced(0x168)]['addOtherFormulaDependencyMainData'](_0x32ad5a);}}}}[_0xa4230(0x187)](_0x1a47ab,_0x39b6fc,_0x4fb762,_0x51c2a1){const _0x645f45=_0xa4230;for(const _0x55acca of _0x1a47ab){const _0x45ae58=_0x39b6fc[_0x55acca];if(_0x45ae58==null)continue;const _0x45cd20=Object[_0x645f45(0x1fe)](_0x45ae58);for(const _0x3c3d65 of _0x45cd20){const _0x4d31bd=new D['ObjectMatrix'](_0x45ae58[_0x3c3d65]||{}),_0x21fb13=new Map();_0x4d31bd['forValue']((_0x30c46f,_0x19b0c8,_0x52d1ce)=>{const _0x98de68=_0x645f45;if(_0x52d1ce==null)return!0x0;const {x:_0x2a523f=0x0,y:_0xbbc7ba=0x0,si:_0x19a83a}=_0x52d1ce;if(!(_0x2a523f===0x0&&_0xbbc7ba===0x0&&_0x19a83a!=null))return!0x0;const _0x14733e=this[_0x98de68(0x18b)](_0x55acca,_0x3c3d65,_0x30c46f,_0x19b0c8,_0x4fb762,_0x52d1ce),_0x4dc98f=this[_0x98de68(0x168)]['getFormulaDependency'](_0x55acca,_0x3c3d65,_0x30c46f,_0x19b0c8);_0x4dc98f!=null?_0x14733e['treeId']=_0x4dc98f:(this[_0x98de68(0x168)][_0x98de68(0x1e2)](_0x55acca,_0x3c3d65,_0x30c46f,_0x19b0c8,_0x14733e),this['_dependencyManagerService'][_0x98de68(0x22a)](_0x14733e)),_0x21fb13[_0x98de68(0x232)](_0x19a83a,_0x14733e),_0x51c2a1[_0x98de68(0x178)](_0x14733e),this[_0x98de68(0x20f)][_0x98de68(0x232)](_0x14733e['treeId'],_0x14733e);}),_0x4d31bd['forValue']((_0x41e507,_0x55dbb6,_0x3acf96)=>{const _0x3cbbde=_0x645f45;if(_0x3acf96==null)return!0x0;const {x:_0x5dbcdf=0x0,y:_0x41b3f2=0x0,si:_0x4ae078}=_0x3acf96;if(_0x5dbcdf===0x0&&_0x41b3f2===0x0&&_0x4ae078!=null)return!0x0;let _0x6e2509;if(_0x4ae078&&_0x21fb13[_0x3cbbde(0x1d6)](_0x4ae078)){const _0x571219=_0x21fb13[_0x3cbbde(0x1a7)](_0x4ae078);_0x6e2509=this[_0x3cbbde(0x17c)](_0x571219,_0x3acf96);}else _0x6e2509=this[_0x3cbbde(0x18b)](_0x55acca,_0x3c3d65,_0x41e507,_0x55dbb6,_0x4fb762,_0x3acf96);const _0x3790c3=this[_0x3cbbde(0x168)][_0x3cbbde(0x1dc)](_0x55acca,_0x3c3d65,_0x41e507,_0x55dbb6);_0x3790c3!=null?_0x6e2509['treeId']=_0x3790c3:(this[_0x3cbbde(0x168)][_0x3cbbde(0x1e2)](_0x55acca,_0x3c3d65,_0x41e507,_0x55dbb6,_0x6e2509),this['_dependencyManagerService'][_0x3cbbde(0x22a)](_0x6e2509)),_0x51c2a1[_0x3cbbde(0x178)](_0x6e2509),this[_0x3cbbde(0x20f)][_0x3cbbde(0x232)](_0x6e2509[_0x3cbbde(0x203)],_0x6e2509);}),_0x21fb13['clear']();}}}[_0xa4230(0x18b)](_0x46d94c,_0x864472,_0x378869,_0x81a1be,_0x2aa32f,_0x332dc7){const _0x256363=_0xa4230,{f:_0x2a27d7,x:_0x500da2=0x0,y:_0x6c49db=0x0}=_0x332dc7,_0x46f562=new c[(_0x256363(0x1f4))](c['generateRandomDependencyTreeId'](this['_dependencyManagerService'])),_0x14f579=_0x2aa32f[_0x46d94c][_0x864472];return _0x46f562[_0x256363(0x209)]=_0x2a27d7,_0x46f562[_0x256363(0x1ba)]=_0x46d94c,_0x46f562['subUnitId']=_0x864472,_0x46f562[_0x256363(0x219)]=_0x378869,_0x46f562[_0x256363(0x170)]=_0x81a1be,_0x46f562[_0x256363(0x16d)]=_0x14f579['rowCount'],_0x46f562['columnCount']=_0x14f579[_0x256363(0x1d5)],_0x46f562;}[_0xa4230(0x1e0)](){const _0x3601b2=_0xa4230,_0x34eeae=[],_0x217b38=new Set(),_0x8dd5d8=this[_0x3601b2(0x18a)]['isForceCalculate'](),_0x2d9c1a=this[_0x3601b2(0x18a)][_0x3601b2(0x226)](),_0x18ff50=this[_0x3601b2(0x168)][_0x3601b2(0x1c2)](_0x2d9c1a),_0x24bcf6=this[_0x3601b2(0x1ee)][_0x3601b2(0x189)](_0x2d9c1a);for(const _0x4ff8a4 of _0x24bcf6)_0x18ff50[_0x3601b2(0x229)](_0x4ff8a4);for(const [_0x52f46c,_0x2eeb40]of this[_0x3601b2(0x20f)])(_0x8dd5d8||_0x2eeb40[_0x3601b2(0x20d)]||_0x2eeb40[_0x3601b2(0x194)](this['_currentConfigService']['getDirtyNameMap']())||_0x18ff50[_0x3601b2(0x1d6)](_0x52f46c)&&!_0x2eeb40[_0x3601b2(0x220)](this[_0x3601b2(0x18a)]['getExcludedRange']()))&&!_0x217b38[_0x3601b2(0x1d6)](_0x52f46c)&&(_0x34eeae[_0x3601b2(0x178)](_0x2eeb40),_0x217b38[_0x3601b2(0x229)](_0x52f46c));for(const [_0x427836,_0x4b9cdf]of this[_0x3601b2(0x20f)])_0x4b9cdf[_0x3601b2(0x1f5)]||(_0x4b9cdf['rangeList']['length']=0x0);return _0x34eeae;}[_0xa4230(0x196)](_0x5c9a31){const _0x30268d=_0xa4230;return this[_0x30268d(0x20f)][_0x30268d(0x1a7)](_0x5c9a31);}[_0xa4230(0x1cb)](_0x200b7d){const _0xcd9868=_0xa4230;return c[_0xcd9868(0x1d8)](_0x200b7d[_0xcd9868(0x1ba)],_0x200b7d[_0xcd9868(0x209)],this['_lexer'],this[_0xcd9868(0x1c7)],this[_0xcd9868(0x18a)]);}*['_traverse'](_0x43715e,_0x5998f9){const _0x3f6020=_0xa4230,_0x49abd5=_0x43715e,_0x540d88=new Set();for(;_0x49abd5[_0x3f6020(0x216)]>0x0;){const _0x275c3a=_0x49abd5[_0x3f6020(0x1fa)]();if(_0x540d88[_0x3f6020(0x214)](),_0x275c3a===void 0x0||_0x275c3a[_0x3f6020(0x177)]())continue;if(_0x275c3a['isAdded']()){yield _0x275c3a,_0x275c3a[_0x3f6020(0x19f)](),_0x5998f9[_0x3f6020(0x229)](_0x275c3a['treeId']);continue;}const _0x235a83=this[_0x3f6020(0x168)][_0x3f6020(0x1c2)](_0x275c3a[_0x3f6020(0x1d0)](),_0x5998f9),_0x3ac9ef=this[_0x3f6020(0x1ee)]['bulkSearch'](_0x275c3a[_0x3f6020(0x1d0)](),_0x5998f9);for(const _0x3ec7db of _0x3ac9ef)_0x235a83[_0x3f6020(0x229)](_0x3ec7db);for(const _0x3348b7 of _0x235a83){const _0x445bf1=this[_0x3f6020(0x20f)][_0x3f6020(0x1a7)](_0x3348b7);if(!_0x445bf1)throw new Error('ParentDependencyTree\x20object\x20is\x20null');_0x445bf1[_0x3f6020(0x1d4)]()||_0x275c3a[_0x3f6020(0x177)]()||_0x540d88[_0x3f6020(0x229)](_0x445bf1);}if(_0x235a83[_0x3f6020(0x214)](),_0x540d88[_0x3f6020(0x1de)]===0x0)yield _0x275c3a,_0x275c3a[_0x3f6020(0x19f)](),_0x5998f9[_0x3f6020(0x229)](_0x275c3a['treeId']);else{_0x275c3a['setAdded'](),_0x49abd5['push'](_0x275c3a);for(const _0x12a771 of _0x540d88)_0x49abd5[_0x3f6020(0x178)](_0x12a771);}}_0x49abd5[_0x3f6020(0x216)]=0x0,_0x540d88[_0x3f6020(0x214)]();}[_0xa4230(0x164)](_0x4c91ee){const _0x345f24=_0xa4230,_0xf70626=[],_0x5a21f1=new Set();for(const _0x56e002 of this['_traverse'](_0x4c91ee,_0x5a21f1))_0xf70626[_0x345f24(0x178)](_0x56e002);return _0xf70626;}}class Y extends c[_0xa4230(0x1f1)]{constructor(){super(...arguments),A(this,'_hasNewExcelFunction',!0x1),A(this,'_lambdaFunctionParameterSet',new Set());}['getNewFormulaWithPrefix'](_0x202cb5,_0x997d81){const _0x5b570b=_0xa4230,_0x4015bc=this[_0x5b570b(0x1ca)](_0x202cb5,!0x1);if(!_0x4015bc||_0x4015bc===c['ErrorType']['VALUE']||Array[_0x5b570b(0x1df)](_0x4015bc))return null;const _0xd0f3c6=[];return this[_0x5b570b(0x230)]=!0x1,this['_generateNewFunctionString'](_0x4015bc,_0xd0f3c6,_0x997d81),this[_0x5b570b(0x230)]?'='+_0xd0f3c6['join'](''):null;}[_0xa4230(0x193)](_0x109b67,_0x4738c6,_0x5c48e2){const _0xd3bb68=_0xa4230,_0x22f41f=_0x109b67[_0xd3bb68(0x1a3)](),_0x361321=_0x22f41f[_0xd3bb68(0x21c)](),_0x5b6743=_0x361321[_0xd3bb68(0x172)](),_0x183613=this['_clearFunctionString'](_0x5b6743),_0x12ced4=_0x5c48e2(_0x183613);let _0xd1a1ea=0x0;_0x22f41f===c['DEFAULT_TOKEN_TYPE_ROOT']?_0xd1a1ea=0x3:_0x22f41f===c[_0xd3bb68(0x210)]?_0xd1a1ea=0x4:_0x22f41f===c[_0xd3bb68(0x200)]?_0xd1a1ea=0x5:c[_0xd3bb68(0x19d)][_0xd3bb68(0x1d6)](_0x183613)?(_0x4738c6[_0xd3bb68(0x178)](_0xd3bb68(0x1e5)+_0x361321),this['_hasNewExcelFunction']=!0x0):_0x5b6743===c[_0xd3bb68(0x1ef)]?(_0x4738c6['push'](_0xd3bb68(0x1e5)+_0x361321),this[_0xd3bb68(0x230)]=!0x0,_0xd1a1ea=0x2):_0x5b6743===c[_0xd3bb68(0x1fc)]?(_0x4738c6[_0xd3bb68(0x178)](_0xd3bb68(0x1e5)+_0x361321),this[_0xd3bb68(0x230)]=!0x0,_0xd1a1ea=0x1):_0x5b6743===c[_0xd3bb68(0x1ed)][_0xd3bb68(0x20c)]?_0xd1a1ea=0x8:c[_0xd3bb68(0x213)][_0xd3bb68(0x1d6)](_0x5b6743)?_0xd1a1ea=0x7:_0x5b6743===c['prefixToken'][_0xd3bb68(0x1d1)]?(this['_checkAddBracketForMinus'](_0x109b67)&&(_0xd1a1ea=0x9),_0x4738c6['push'](_0x22f41f)):(_0x4738c6['push'](_0x22f41f),_0xd1a1ea=0xa),_0x12ced4?(_0xd1a1ea!==0x2&&_0xd1a1ea!==0x1&&(_0xd1a1ea=0x6),_0x4738c6[_0xd3bb68(0x178)]('(')):_0xd1a1ea===0x9&&_0x4738c6[_0xd3bb68(0x178)]('(');const _0x2ed424=_0x109b67['getChildren'](),_0x4da15b=_0x2ed424[_0xd3bb68(0x216)];if(_0xd1a1ea===0x2){const _0xd822ed=_0x2ed424[0x0];let _0x580a60=0x0;_0xd822ed instanceof c[_0xd3bb68(0x1e7)]&&_0xd822ed[_0xd3bb68(0x1a3)]()===c[_0xd3bb68(0x200)]&&(_0x580a60=0x1);for(let _0x494827=_0x580a60;_0x494827<_0x4da15b-0x1;_0x494827++){const _0x464041=_0x2ed424[_0x494827];if(_0x464041 instanceof c['LexerNode']){const _0x15f7cf=_0x464041[_0xd3bb68(0x1b1)]()[0x0];typeof _0x15f7cf=='string'&&(this[_0xd3bb68(0x186)][_0xd3bb68(0x1d6)](_0x15f7cf)&&console[_0xd3bb68(0x1c8)](_0xd3bb68(0x1f6)+_0x15f7cf+'\x22\x20is\x20duplicated.'),this[_0xd3bb68(0x186)][_0xd3bb68(0x229)](_0x15f7cf),_0x4738c6[_0xd3bb68(0x178)](_0xd3bb68(0x218)+_0x15f7cf),this[_0xd3bb68(0x230)]=!0x0);}_0x4738c6['push'](',');}this['_handleNewFunctionChild'](_0x2ed424[_0x4da15b-0x1],_0x4738c6,_0x5c48e2),_0x580a60===0x1&&(_0x4738c6[_0xd3bb68(0x178)](')'),_0x4738c6[_0xd3bb68(0x178)]('('),this['_generateNewFunctionString'](_0xd822ed,_0x4738c6,_0x5c48e2)),_0x4738c6[_0xd3bb68(0x178)](')');return;}else{if(_0xd1a1ea===0x1){for(let _0x24d30c=0x0;_0x24d30c<_0x4da15b-0x1;_0x24d30c++){const _0x5455a8=_0x2ed424[_0x24d30c];if(_0x5455a8 instanceof c[_0xd3bb68(0x1e7)]&&_0x24d30c%0x2===0x0){const _0x309300=_0x5455a8[_0xd3bb68(0x1b1)]()[0x0];if(typeof _0x309300==_0xd3bb68(0x198)){this[_0xd3bb68(0x186)]['has'](_0x309300)&&console[_0xd3bb68(0x1c8)](_0xd3bb68(0x16b)+_0x309300+_0xd3bb68(0x221)),this[_0xd3bb68(0x186)][_0xd3bb68(0x229)](_0x309300),_0x4738c6[_0xd3bb68(0x178)](_0xd3bb68(0x218)+_0x309300),this[_0xd3bb68(0x230)]=!0x0,_0x4738c6[_0xd3bb68(0x178)](',');continue;}}if(this[_0xd3bb68(0x1da)](_0x5455a8,_0x4738c6,_0x5c48e2),_0x5455a8 instanceof c[_0xd3bb68(0x1e7)]){const _0xd3a244=_0x2ed424[_0x24d30c+0x1];_0xd3a244&&_0xd3a244 instanceof c[_0xd3bb68(0x1e7)]&&_0x4738c6[_0xd3bb68(0x178)](',');}}this[_0xd3bb68(0x1da)](_0x2ed424[_0x4da15b-0x1],_0x4738c6,_0x5c48e2),_0x4738c6[_0xd3bb68(0x178)](')');return;}else{if(_0xd1a1ea===0x8){const _0x5af88d=_0x2ed424[0x0],_0x33d151=_0x2ed424[0x1];this[_0xd3bb68(0x1da)](_0x5af88d,_0x4738c6,_0x5c48e2),_0x4738c6['push'](_0x22f41f),this['_handleNewFunctionChild'](_0x33d151,_0x4738c6,_0x5c48e2);return;}}}for(let _0x33c1a5=0x0;_0x33c1a5<_0x4da15b;_0x33c1a5++){const _0xb02f36=_0x2ed424[_0x33c1a5];if(this[_0xd3bb68(0x1da)](_0xb02f36,_0x4738c6,_0x5c48e2),_0xb02f36 instanceof c['LexerNode']){const _0x4cd7cc=_0x2ed424[_0x33c1a5+0x1];_0x4cd7cc&&_0x4cd7cc instanceof c[_0xd3bb68(0x1e7)]&&_0x4738c6[_0xd3bb68(0x178)](',');}}_0xd1a1ea===0x7&&_0x4738c6[_0xd3bb68(0x178)](_0x22f41f),(_0x12ced4||_0xd1a1ea===0x9)&&_0x4738c6[_0xd3bb68(0x178)](')');}[_0xa4230(0x1da)](_0x6dd172,_0xa433d4,_0x14cff0){const _0x2105df=_0xa4230;_0x6dd172 instanceof c[_0x2105df(0x1e7)]?this['_generateNewFunctionString'](_0x6dd172,_0xa433d4,_0x14cff0):this[_0x2105df(0x186)]['has'](_0x6dd172)?(_0xa433d4[_0x2105df(0x178)]('_xlpm.'+_0x6dd172),this[_0x2105df(0x230)]=!0x0):_0xa433d4['push'](_0x6dd172);}[_0xa4230(0x1b0)](_0x20f664){const _0x4cf78=_0xa4230;let _0x32889a=_0x20f664[_0x4cf78(0x21c)]();if(!_0x32889a)return _0x32889a;const _0x51b129=_0x32889a[0x0];if((_0x51b129===c[_0x4cf78(0x1ea)]['AT']||_0x51b129===c[_0x4cf78(0x1ea)][_0x4cf78(0x1d1)]||_0x51b129===c[_0x4cf78(0x1ea)][_0x4cf78(0x1ad)])&&(_0x32889a=_0x32889a[_0x4cf78(0x1b4)](0x1)),!_0x32889a)return _0x32889a;const _0x4b9d76=_0x32889a[_0x32889a[_0x4cf78(0x216)]-0x1];return c[_0x4cf78(0x213)][_0x4cf78(0x1d6)](_0x4b9d76)&&(_0x32889a=_0x32889a[_0x4cf78(0x1b4)](0x0,-0x1)),_0x32889a;}[_0xa4230(0x1b3)](_0x4e0872){const _0x4db839=_0xa4230,_0x2de969=_0x4e0872[_0x4db839(0x1b1)]()[0x0];if(!_0x2de969||!(_0x2de969 instanceof c[_0x4db839(0x1e7)])||_0x4e0872['getChildren']()[_0x4db839(0x216)]>0x1)return!0x1;const _0x59dfb9=_0x2de969[_0x4db839(0x1b1)](),_0x3e52ec=_0x59dfb9[_0x4db839(0x216)];if(_0x3e52ec===0x1)return!0x1;for(let _0x1d4e89=0x0;_0x1d4e89<_0x3e52ec;_0x1d4e89++){const _0x347807=_0x59dfb9[_0x1d4e89];if(!(_0x347807 instanceof c[_0x4db839(0x1e7)])&&c[_0x4db839(0x173)]['has'](_0x347807))return!0x0;}return!0x1;}}class j extends c[_0xa4230(0x204)]{async[_0xa4230(0x1b8)](_0x8234a2=!0x1){const _0x423cec=_0xa4230;_0x8234a2?this[_0x423cec(0x238)][_0x423cec(0x237)](c[_0x423cec(0x1be)][_0x423cec(0x169)]):this[_0x423cec(0x238)][_0x423cec(0x237)](c['FormulaExecuteStageType']['START_DEPENDENCY']),this[_0x423cec(0x1d7)][_0x423cec(0x188)](this[_0x423cec(0x238)][_0x423cec(0x1a4)]());const _0x1a284f=await this[_0x423cec(0x195)][_0x423cec(0x182)](),_0x31293d=this['_interpreter'];_0x8234a2?(this[_0x423cec(0x238)]['setFormulaExecuteStage'](c['FormulaExecuteStageType'][_0x423cec(0x18c)]),this[_0x423cec(0x238)][_0x423cec(0x22d)](_0x1a284f[_0x423cec(0x216)])):(this[_0x423cec(0x238)][_0x423cec(0x237)](c['FormulaExecuteStageType']['START_CALCULATION']),this[_0x423cec(0x238)]['setTotalFormulasToCalculate'](_0x1a284f[_0x423cec(0x216)])),this[_0x423cec(0x1d7)][_0x423cec(0x188)](this[_0x423cec(0x238)][_0x423cec(0x1a4)]());let _0x2a085f=[];const _0x4d231c=this[_0x423cec(0x197)][_0x423cec(0x236)](c[_0x423cec(0x1d2)]),_0x49a8ac=(_0x4d231c==null?void 0x0:_0x4d231c[_0x423cec(0x206)])||c['DEFAULT_INTERVAL_COUNT'];let _0x28ded7=0x0;const _0x3ac719=_0x1a284f[_0x423cec(0x216)];for(;_0x1a284f[_0x423cec(0x216)]>0x0;){const _0xba400c=_0x1a284f[_0x423cec(0x1fa)](),_0xa44cd3=c[_0x423cec(0x1d8)](_0xba400c[_0x423cec(0x1ba)],_0xba400c[_0x423cec(0x209)],this['_lexer'],this[_0x423cec(0x1c7)],this[_0x423cec(0x18a)]),_0x310356={'node':_0xa44cd3,'refOffsetX':_0xba400c[_0x423cec(0x1f8)],'refOffsetY':_0xba400c[_0x423cec(0x19a)]},_0x3ffaaa=_0xba400c['getDirtyData'];if(_0x28ded7%_0x49a8ac===0x0&&(await new Promise(_0x2aca83=>{const _0x564794=_0x423cec,_0x49e914=D[_0x564794(0x1b9)](_0x2aca83);_0x2a085f[_0x564794(0x178)](_0x49e914);}),_0x8234a2?(this[_0x423cec(0x238)][_0x423cec(0x237)](c[_0x423cec(0x1be)][_0x423cec(0x1a6)]),this[_0x423cec(0x238)][_0x423cec(0x1ab)](_0x28ded7+0x1)):(this[_0x423cec(0x238)][_0x423cec(0x237)](c['FormulaExecuteStageType'][_0x423cec(0x1f9)]),this[_0x423cec(0x238)][_0x423cec(0x1c0)](_0x28ded7+0x1)),this[_0x423cec(0x1d7)][_0x423cec(0x188)](this[_0x423cec(0x238)][_0x423cec(0x1a4)]()),this[_0x423cec(0x238)][_0x423cec(0x1eb)]()||_0x310356==null&&_0x3ffaaa==null)){this['_runtimeService'][_0x423cec(0x237)](c[_0x423cec(0x1be)][_0x423cec(0x1c5)]),this[_0x423cec(0x238)]['markedAsStopFunctionsExecuted'](),this['_executionCompleteListener$'][_0x423cec(0x188)](this[_0x423cec(0x238)][_0x423cec(0x1db)]());return;}this[_0x423cec(0x238)][_0x423cec(0x1e4)](_0xba400c[_0x423cec(0x219)],_0xba400c[_0x423cec(0x170)],_0xba400c['rowCount'],_0xba400c[_0x423cec(0x1d5)],_0xba400c['subUnitId'],_0xba400c[_0x423cec(0x1ba)]);let _0x46549c;if(_0x3ffaaa!=null&&_0xba400c['featureId']!=null){const {runtimeCellData:_0x43bb1e,dirtyRanges:_0x3d6857}=_0x3ffaaa(this['_currentConfigService'][_0x423cec(0x1e9)](),this[_0x423cec(0x238)][_0x423cec(0x1db)]());this[_0x423cec(0x238)][_0x423cec(0x1bf)](_0xba400c[_0x423cec(0x1a5)],_0x43bb1e),this[_0x423cec(0x238)][_0x423cec(0x234)](_0xba400c[_0x423cec(0x1a5)],_0x3d6857);}else _0x310356!=null&&(_0x31293d[_0x423cec(0x19c)](_0x310356[_0x423cec(0x190)])?_0x46549c=await _0x31293d['executeAsync'](_0x310356):_0x46549c=_0x31293d[_0x423cec(0x212)](_0x310356),_0xba400c[_0x423cec(0x227)]!=null?this[_0x423cec(0x238)][_0x423cec(0x19e)](_0xba400c[_0x423cec(0x227)],_0xba400c['refOffsetX'],_0xba400c[_0x423cec(0x19a)],_0x46549c):this[_0x423cec(0x238)][_0x423cec(0x1f7)](_0x46549c));_0xa44cd3['resetCalculationState'](),_0x28ded7++;}return _0x2a085f[_0x423cec(0x1a1)](_0x3e050a=>_0x3e050a()),_0x2a085f=[],_0x3ac719>0x0?this[_0x423cec(0x238)][_0x423cec(0x1c1)]():_0x8234a2||this[_0x423cec(0x238)]['markedAsNoFunctionsExecuted'](),this[_0x423cec(0x238)][_0x423cec(0x1db)]();}}class G extends c[_0xa4230(0x1b7)]{constructor(){const _0x2aea58=_0xa4230;super(...arguments),A(this,_0x2aea58(0x1dd),new Map()),A(this,_0x2aea58(0x1d3),new D[(_0x2aea58(0x21a))](!0x0));}[_0xa4230(0x1c3)](){const _0x1119d8=_0xa4230;this[_0x1119d8(0x20e)]['clear'](),this[_0x1119d8(0x22e)][_0x1119d8(0x214)](),this[_0x1119d8(0x174)][_0x1119d8(0x214)](),this[_0x1119d8(0x1d3)][_0x1119d8(0x214)](),this[_0x1119d8(0x1dd)][_0x1119d8(0x214)](),this[_0x1119d8(0x175)](),this['_otherFormulaDataMainData'][_0x1119d8(0x214)]();}[_0xa4230(0x1cd)](_0x41b2dc,_0x29e3cc,_0x1cb71c,_0x13e503){const _0x3e2723=_0xa4230;this[_0x3e2723(0x20e)][_0x3e2723(0x1d6)](_0x41b2dc)||this[_0x3e2723(0x20e)]['set'](_0x41b2dc,new Map());const _0x458fdf=this[_0x3e2723(0x20e)]['get'](_0x41b2dc);_0x458fdf[_0x3e2723(0x1d6)](_0x29e3cc)||_0x458fdf['set'](_0x29e3cc,new Map());const _0x12d6bd=_0x458fdf[_0x3e2723(0x1a7)](_0x29e3cc);_0x12d6bd[_0x3e2723(0x1d6)](_0x1cb71c)||_0x12d6bd['set'](_0x1cb71c,new D['ObjectMatrix']()),_0x12d6bd[_0x3e2723(0x1a7)](_0x1cb71c)[_0x3e2723(0x1e6)](_0x13e503['refOffsetX'],_0x13e503[_0x3e2723(0x19a)],_0x13e503['treeId']);}['removeOtherFormulaDependency'](_0x3078a1,_0x4a3892,_0x3638ea){const _0x185e1c=_0xa4230,_0x1fc4c7=this[_0x185e1c(0x20e)]['get'](_0x3078a1);if(_0x1fc4c7&&_0x1fc4c7[_0x185e1c(0x1d6)](_0x4a3892)){const _0x251ccd=_0x1fc4c7[_0x185e1c(0x1a7)](_0x4a3892);_0x3638ea[_0x185e1c(0x1a1)](_0x535b21=>{const _0x2b8547=_0x185e1c,_0x48dbd5=_0x251ccd[_0x2b8547(0x1a7)](_0x535b21);_0x48dbd5!=null&&(_0x48dbd5[_0x2b8547(0x201)]((_0x5b62c0,_0x2de82e,_0x5c81f5)=>{const _0x1d1518=_0x2b8547;this['_removeDependencyRTreeCache'](_0x5c81f5),this[_0x1d1518(0x179)](_0x5c81f5);}),_0x251ccd[_0x2b8547(0x176)](_0x535b21),this[_0x2b8547(0x1a8)][_0x2b8547(0x176)](_0x535b21));}),_0x251ccd[_0x185e1c(0x1de)]===0x0&&_0x1fc4c7[_0x185e1c(0x176)](_0x4a3892),_0x1fc4c7[_0x185e1c(0x1de)]===0x0&&this['_otherFormulaData'][_0x185e1c(0x176)](_0x3078a1);}}['clearOtherFormulaDependency'](_0x18bb1d,_0x158efc){const _0x49eda4=_0xa4230,_0x53e359=this[_0x49eda4(0x20e)]['get'](_0x18bb1d);if(_0x158efc&&_0x53e359&&_0x53e359[_0x49eda4(0x1d6)](_0x158efc)){const _0x2e9a47=_0x53e359[_0x49eda4(0x1a7)](_0x158efc);this[_0x49eda4(0x1a0)](_0x18bb1d,_0x158efc);for(const _0x5a431c of _0x2e9a47[_0x49eda4(0x1fe)]()){const _0x24119a=_0x2e9a47[_0x49eda4(0x1a7)](_0x5a431c);_0x24119a!=null&&(_0x24119a[_0x49eda4(0x201)]((_0x2bce19,_0x4a43b4,_0x4bde23)=>{const _0x57b728=_0x49eda4;this[_0x57b728(0x1dd)][_0x57b728(0x1a7)](_0x4bde23)&&this['_removeAllTreeMap'](_0x4bde23);}),this['_otherFormulaDataMainData'][_0x49eda4(0x176)](_0x5a431c));}_0x2e9a47[_0x49eda4(0x214)]();}else{if(_0x53e359){for(const _0x577b72 of _0x53e359[_0x49eda4(0x1fe)]()){const _0x521922=_0x53e359[_0x49eda4(0x1a7)](_0x577b72);this['_removeDependencyRTreeCacheById'](_0x18bb1d,_0x577b72);for(const _0x41bbcf of _0x521922[_0x49eda4(0x1fe)]()){const _0x2d5786=_0x521922['get'](_0x41bbcf);_0x2d5786!=null&&(_0x2d5786[_0x49eda4(0x201)]((_0x1417b6,_0x38aeea,_0x19e13c)=>{const _0x1cad2a=_0x49eda4;this[_0x1cad2a(0x1dd)][_0x1cad2a(0x1a7)](_0x19e13c)&&this['_removeAllTreeMap'](_0x19e13c);}),this[_0x49eda4(0x1a8)][_0x49eda4(0x176)](_0x41bbcf));}}this[_0x49eda4(0x20e)][_0x49eda4(0x176)](_0x18bb1d);}}}[_0xa4230(0x217)](_0x42de56,_0xefe30d,_0x5c1844,_0x28eb8c){const _0x91c334=_0xa4230;this['_featureFormulaData'][_0x91c334(0x1d6)](_0x42de56)||this[_0x91c334(0x22e)]['set'](_0x42de56,new Map());const _0xaf20bc=this[_0x91c334(0x22e)]['get'](_0x42de56);_0xaf20bc['has'](_0xefe30d)||_0xaf20bc[_0x91c334(0x232)](_0xefe30d,new Map()),_0xaf20bc['get'](_0xefe30d)[_0x91c334(0x232)](_0x5c1844,_0x28eb8c[_0x91c334(0x203)]);}['removeFeatureFormulaDependency'](_0x41db7d,_0x48ab9f,_0x15bc60){const _0x18ac50=_0xa4230,_0x529f7a=this[_0x18ac50(0x22e)]['get'](_0x41db7d);if(_0x529f7a&&_0x529f7a[_0x18ac50(0x1d6)](_0x48ab9f)){const _0x1e7e25=_0x529f7a[_0x18ac50(0x1a7)](_0x48ab9f);_0x15bc60[_0x18ac50(0x1a1)](_0xadd819=>{const _0x225e30=_0x18ac50,_0x9f2cca=_0x1e7e25[_0x225e30(0x1a7)](_0xadd819);_0x9f2cca!=null&&(this['_removeDependencyRTreeCache'](_0x9f2cca),_0x1e7e25['delete'](_0xadd819),this['_removeAllTreeMap'](_0x9f2cca));});}}[_0xa4230(0x233)](_0x155226,_0x598f1f){const _0x49eec9=_0xa4230,_0x4bb398=this['_featureFormulaData'][_0x49eec9(0x1a7)](_0x155226);if(_0x598f1f&&_0x4bb398&&_0x4bb398[_0x49eec9(0x1d6)](_0x598f1f)){const _0xf7881f=_0x4bb398[_0x49eec9(0x1a7)](_0x598f1f);this[_0x49eec9(0x1a0)](_0x155226,_0x598f1f),_0xf7881f[_0x49eec9(0x1a1)](_0x725bcd=>{const _0x30c875=_0x49eec9;_0x725bcd!=null&&this[_0x30c875(0x179)](_0x725bcd);}),_0xf7881f[_0x49eec9(0x214)]();}else _0x4bb398&&(_0x4bb398['forEach']((_0x3a7a18,_0x334954)=>{const _0x7aa0a8=_0x49eec9;this[_0x7aa0a8(0x1a0)](_0x155226,_0x334954),_0x3a7a18[_0x7aa0a8(0x1a1)](_0x187e2b=>{const _0x4ab3d8=_0x7aa0a8;_0x187e2b!=null&&this[_0x4ab3d8(0x179)](_0x187e2b);});}),this[_0x49eec9(0x22e)]['delete'](_0x155226));}['addFormulaDependency'](_0x1e2b2d,_0x15b060,_0x1bbcfa,_0x3005fc,_0x44b81e){const _0x3b8ea5=_0xa4230;this[_0x3b8ea5(0x174)][_0x3b8ea5(0x1d6)](_0x1e2b2d)||this[_0x3b8ea5(0x174)][_0x3b8ea5(0x232)](_0x1e2b2d,new Map());const _0x351dac=this['_formulaData']['get'](_0x1e2b2d);_0x351dac[_0x3b8ea5(0x1d6)](_0x15b060)||_0x351dac[_0x3b8ea5(0x232)](_0x15b060,new D[(_0x3b8ea5(0x17d))]()),_0x351dac['get'](_0x15b060)[_0x3b8ea5(0x1e6)](_0x1bbcfa,_0x3005fc,_0x44b81e[_0x3b8ea5(0x203)]);}[_0xa4230(0x18f)](_0x113176,_0xaf77f5,_0x97546c,_0x4a4739){const _0x1ac979=_0xa4230,_0x171e6b=this[_0x1ac979(0x174)][_0x1ac979(0x1a7)](_0x113176);if(_0x171e6b&&_0x171e6b[_0x1ac979(0x1d6)](_0xaf77f5)){const _0x5e4f6e=_0x171e6b['get'](_0xaf77f5),_0xb11c80=_0x5e4f6e[_0x1ac979(0x211)](_0x97546c,_0x4a4739);if(_0xb11c80==null)return;this[_0x1ac979(0x1c9)](_0xb11c80),_0x5e4f6e['realDeleteValue'](_0x97546c,_0x4a4739),this['_removeAllTreeMap'](_0xb11c80);}}[_0xa4230(0x183)](_0x577429,_0x5c3701){const _0x19af66=_0xa4230,_0x22d07d=this[_0x19af66(0x174)]['get'](_0x577429);if(_0x5c3701&&_0x22d07d&&_0x22d07d[_0x19af66(0x1d6)](_0x5c3701)){const _0x4ee85a=_0x22d07d[_0x19af66(0x1a7)](_0x5c3701);this[_0x19af66(0x1a0)](_0x577429,_0x5c3701),_0x4ee85a[_0x19af66(0x201)]((_0x2669bd,_0x376b06,_0x29f979)=>{const _0x16cf96=_0x19af66;if(_0x29f979==null)return!0x0;this[_0x16cf96(0x179)](_0x29f979);}),_0x4ee85a[_0x19af66(0x1c3)]();}else _0x22d07d&&(_0x22d07d['forEach']((_0x2e65a6,_0x41d2a6)=>{const _0x482d5d=_0x19af66;this[_0x482d5d(0x1a0)](_0x577429,_0x41d2a6),_0x2e65a6[_0x482d5d(0x201)]((_0x4c6d56,_0x222a68,_0x21105f)=>{const _0x5ba897=_0x482d5d;if(_0x21105f==null)return!0x0;this[_0x5ba897(0x179)](_0x21105f);});}),this['_formulaData']['delete'](_0x577429));}[_0xa4230(0x1c9)](_0x2195b3){const _0x36b9e2=_0xa4230;if(_0x2195b3==null)return;const _0x1a878e=this['_allTreeMap']['get'](_0x2195b3);if(_0x1a878e){const _0x47fd63=[];for(const [_0xa8da36,_0x4b1f3c]of _0x1a878e)for(const [_0x1d0786,_0x55a73d]of _0x4b1f3c)_0x47fd63[_0x36b9e2(0x178)]({'unitId':_0xa8da36,'sheetId':_0x1d0786,'range':_0x55a73d,'id':_0x2195b3});this['_dependencyRTreeCache'][_0x36b9e2(0x184)](_0x47fd63);}}[_0xa4230(0x1e3)](_0x2197da,_0x310407){const _0x5048ef=_0xa4230,_0x3ec926=this[_0x5048ef(0x22c)][_0x5048ef(0x1a7)](_0x2197da);if(_0x3ec926){const _0x36b88c=_0x3ec926[_0x5048ef(0x1a7)](_0x310407);if(_0x36b88c){for(const _0x132a45 of _0x36b88c)this['_removeDependencyRTreeCache'](_0x132a45),this['_removeAllTreeMap'](_0x132a45);_0x36b88c[_0x5048ef(0x214)]();}}}[_0xa4230(0x166)](){const _0x2a9f9a=_0xa4230;this['_dependencyRTreeCache'][_0x2a9f9a(0x166)]();}[_0xa4230(0x21f)](){const _0x416f6f=_0xa4230;this['_dependencyRTreeCache'][_0x416f6f(0x21f)]();}[_0xa4230(0x179)](_0x503f1e){const _0x27738b=_0xa4230;_0x503f1e!=null&&this[_0x27738b(0x1dd)][_0x27738b(0x176)](_0x503f1e);}[_0xa4230(0x1ff)](_0x3735df){const _0x2b9fb5=_0xa4230;var _0x1268b9,_0x2bcda3;const _0x15f5cc=_0x3735df[_0x2b9fb5(0x185)];let _0x380067=this['_allTreeMap']['get'](_0x3735df['treeId']);for(let _0x5092ac=0x0;_0x5092ac<_0x15f5cc[_0x2b9fb5(0x216)];_0x5092ac++){const _0xc00ad7=_0x15f5cc[_0x5092ac];let {unitId:_0x4113cd,sheetId:_0x47979c,range:_0x4f2150}=_0xc00ad7;_0x380067||(_0x380067=new Map(),this['_allTreeMap'][_0x2b9fb5(0x232)](_0x3735df[_0x2b9fb5(0x203)],_0x380067)),_0x380067[_0x2b9fb5(0x1d6)](_0x4113cd)||_0x380067[_0x2b9fb5(0x232)](_0x4113cd,new Map());const _0x1ad76b=(_0x1268b9=_0x380067==null?void 0x0:_0x380067[_0x2b9fb5(0x1a7)](_0x4113cd))==null?void 0x0:_0x1268b9['get'](_0x47979c);_0x1ad76b&&(_0x4f2150={'startRow':Math[_0x2b9fb5(0x239)](_0x4f2150['startRow'],_0x1ad76b[_0x2b9fb5(0x235)]),'startColumn':Math['min'](_0x4f2150[_0x2b9fb5(0x167)],_0x1ad76b[_0x2b9fb5(0x167)]),'endRow':Math[_0x2b9fb5(0x20b)](_0x4f2150['endRow'],_0x1ad76b[_0x2b9fb5(0x1d9)]),'endColumn':Math[_0x2b9fb5(0x20b)](_0x4f2150[_0x2b9fb5(0x1b5)],_0x1ad76b['endColumn'])}),(_0x2bcda3=_0x380067[_0x2b9fb5(0x1a7)](_0x4113cd))==null||_0x2bcda3['set'](_0x47979c,_0x4f2150);}}}var W=Object[_0xa4230(0x20a)],$=(_0x4aa92c,_0x304aad,_0xcf5c05,_0x3bcc08)=>{const _0xccae1e=_0xa4230;for(var _0x79dc27=_0x3bcc08>0x1?void 0x0:_0x3bcc08?W(_0x304aad,_0xcf5c05):_0x304aad,_0x22679e=_0x4aa92c[_0xccae1e(0x216)]-0x1,_0x55d19d;_0x22679e>=0x0;_0x22679e--)(_0x55d19d=_0x4aa92c[_0x22679e])&&(_0x79dc27=_0x55d19d(_0x79dc27)||_0x79dc27);return _0x79dc27;};const q=Number[_0xa4230(0x1ac)](0x6933d6d1);exports['UniverProFormulaEnginePlugin']=class extends c[_0xa4230(0x1b2)]{[_0xa4230(0x16c)](){const _0x4a4188=_0xa4230;var _0x5d8947,_0x5238e8;this[_0x4a4188(0x1aa)]()?(this['_injector']['add']([c[_0x4a4188(0x1f1)],{'useClass':Y}]),(_0x5d8947=this[_0x4a4188(0x16a)])!=null&&_0x5d8947['notExecuteFormula']||[[c[_0x4a4188(0x1bc)],{'useClass':j}],[c[_0x4a4188(0x1c4)],{'useClass':G}],[c[_0x4a4188(0x21d)],{'useClass':V}]]['forEach'](_0x901e4a=>this[_0x4a4188(0x199)]['add'](_0x901e4a))):(this[_0x4a4188(0x199)][_0x4a4188(0x229)]([c['LexerTreeBuilder'],{'useClass':c[_0x4a4188(0x1f1)]}]),(_0x5238e8=this[_0x4a4188(0x16a)])!=null&&_0x5238e8[_0x4a4188(0x17a)]||[[c[_0x4a4188(0x1bc)],{'useClass':c[_0x4a4188(0x204)]}],[c[_0x4a4188(0x1c4)],{'useClass':c[_0x4a4188(0x1b6)]}],[c[_0x4a4188(0x21d)],{'useClass':c[_0x4a4188(0x222)]}]][_0x4a4188(0x1a1)](_0x59ed02=>this['_injector'][_0x4a4188(0x229)](_0x59ed02)));}['_initLicenseValid'](){const _0x15928f=_0xa4230;var _0x246dc1;const _0x2bd930=(_0x246dc1=this[_0x15928f(0x197)]['getConfig'](M[_0x15928f(0x207)]))!=null?_0x246dc1:{},{ls:_0x538081,pbk:_0x3c08dc}=_0x2bd930;if(!_0x538081||!_0x3c08dc)return!0x1;const _0x2df30b=M['unshiftString'](B,Q),_0xc2676c=new Function('return\x20'+_0x2df30b)()(_0x538081,_0x3c08dc),_0x5b43d4=_0xc2676c['message'];return _0xc2676c['valid']&&M[_0x15928f(0x1ce)](_0x5b43d4,'sf',q)?M['getSheetFeatureLimit'](_0x5b43d4,!0x0,'a',!0x0,!0x1,!0x1):!0x1;}},exports['UniverProFormulaEnginePlugin']=$([D[_0xa4230(0x16f)](M[_0xa4230(0x181)])],exports['UniverProFormulaEnginePlugin']),Object[_0xa4230(0x1fe)](c)[_0xa4230(0x1a1)](_0x5f1c58=>{const _0x2e7b7f=_0xa4230;_0x5f1c58!==_0x2e7b7f(0x171)&&!Object['prototype'][_0x2e7b7f(0x205)]['call'](exports,_0x5f1c58)&&Object[_0x2e7b7f(0x1ec)](exports,_0x5f1c58,{'enumerable':!0x0,'get':()=>c[_0x5f1c58]});});