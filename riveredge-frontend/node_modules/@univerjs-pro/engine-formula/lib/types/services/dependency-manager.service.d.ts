import { IRange, Nullable, RTree } from '@univerjs/core';
import { FormulaDependencyTree, IFormulaDependencyTree, DependencyManagerBaseService } from '@univerjs/engine-formula';
export declare class DependencyManagerProService extends DependencyManagerBaseService {
    protected _allTreeMap: Map<number, Map<string, Map<string, IRange>>>;
    protected _dependencyRTreeCache: RTree;
    reset(): void;
    addOtherFormulaDependency(unitId: string, sheetId: string, formulaId: string, dependencyTree: IFormulaDependencyTree): void;
    removeOtherFormulaDependency(unitId: string, sheetId: string, formulaIds: string[]): void;
    clearOtherFormulaDependency(unitId: string, sheetId?: string): void;
    addFeatureFormulaDependency(unitId: string, sheetId: string, featureId: string, dependencyTree: FormulaDependencyTree): void;
    removeFeatureFormulaDependency(unitId: string, sheetId: string, featureIds: string[]): void;
    clearFeatureFormulaDependency(unitId: string, sheetId?: string): void;
    addFormulaDependency(unitId: string, sheetId: string, row: number, column: number, dependencyTree: IFormulaDependencyTree): void;
    removeFormulaDependency(unitId: string, sheetId: string, row: number, column: number): void;
    clearFormulaDependency(unitId: string, sheetId?: string): void;
    private _removeDependencyRTreeCache;
    removeFormulaDependencyByDefinedName(unitId: string, definedName: string): void;
    openKdTree(): void;
    closeKdTree(): void;
    protected _removeAllTreeMap(treeId: Nullable<number>): void;
    protected _addAllTreeMap(tree: IFormulaDependencyTree): void;
}
