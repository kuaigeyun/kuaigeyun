import { Nullable } from '@univerjs/core';
import { IFeatureCalculationManagerParam, IFormulaData, IFormulaDataItem, IFormulaDependencyTree, IOtherFormulaData, IUnitData, FormulaDependencyGenerator, FormulaDependencyTree, FormulaDependencyTreeVirtual } from '@univerjs/engine-formula';
export declare class FormulaDependencyProGenerator extends FormulaDependencyGenerator {
    protected _dependencyTreeCache: Map<number, IFormulaDependencyTree>;
    dispose(): void;
    generate(): Promise<(FormulaDependencyTree | FormulaDependencyTreeVirtual)[]>;
    private _isCyclicUtilMap;
    protected _checkIsCycleDependency(treeList: IFormulaDependencyTree[]): boolean;
    protected _getFeatureFormulaTree(featureId: string, treeId: Nullable<number>, params: IFeatureCalculationManagerParam): FormulaDependencyTree;
    protected _registerOtherFormulas(otherFormulaData: IOtherFormulaData, otherFormulaDataKeys: string[], treeList: IFormulaDependencyTree[]): void;
    protected _registerFormulas(formulaDataKeys: string[], formulaData: IFormulaData, unitData: IUnitData, treeList: IFormulaDependencyTree[]): void;
    protected _createFDtree(unitId: string, sheetId: string, row: number, column: number, unitData: IUnitData, formulaDataItem: IFormulaDataItem): FormulaDependencyTree;
    /**
     * Build a formula dependency tree based on the dependency relationships.
     * @param treeList
     */
    protected _getUpdateTreeListAndMakeDependency(): IFormulaDependencyTree[];
    protected _getTreeById(treeId: number): IFormulaDependencyTree | undefined;
    protected _getTreeNode(tree: IFormulaDependencyTree): import('@univerjs/engine-formula/engine/ast-node/ast-root-node.js').AstRootNode;
    private _traverse;
    protected _calculateRunList(treeList: IFormulaDependencyTree[]): (FormulaDependencyTree | FormulaDependencyTreeVirtual)[];
}
