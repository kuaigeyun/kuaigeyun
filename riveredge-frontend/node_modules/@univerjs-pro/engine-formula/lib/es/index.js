const _0x3259a6=_0x5e04;(function(_0x44fc07,_0x49c56f){const _0x124663=_0x5e04,_0x140e9d=_0x44fc07();while(!![]){try{const _0x20632f=-parseInt(_0x124663(0x10a))/0x1*(-parseInt(_0x124663(0x9c))/0x2)+parseInt(_0x124663(0x12f))/0x3+-parseInt(_0x124663(0xba))/0x4+-parseInt(_0x124663(0xc3))/0x5*(-parseInt(_0x124663(0xc8))/0x6)+-parseInt(_0x124663(0xe5))/0x7*(-parseInt(_0x124663(0xce))/0x8)+parseInt(_0x124663(0xb8))/0x9+-parseInt(_0x124663(0x11f))/0xa;if(_0x20632f===_0x49c56f)break;else _0x140e9d['push'](_0x140e9d['shift']());}catch(_0x1c404e){_0x140e9d['push'](_0x140e9d['shift']());}}}(_0x37c2,0x9cf9f));var J=Object[_0x3259a6(0xa1)],Z=(_0x4874b0,_0x4afea2,_0x7abc6)=>_0x4afea2 in _0x4874b0?J(_0x4874b0,_0x4afea2,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x7abc6}):_0x4874b0[_0x4afea2]=_0x7abc6,M=(_0x2903e2,_0x3c41fc,_0x4d8124)=>Z(_0x2903e2,typeof _0x3c41fc!=_0x3259a6(0x117)?_0x3c41fc+'':_0x3c41fc,_0x4d8124);import{UniverLicensePlugin as _0x2f7436,LS_CONFIG_KEY as _0x2ac5af,unshiftString as _0x53284f,isFeatureAuthorizedWithinTime as _0x7d5d24,getSheetFeatureLimit as _0x167def}from'@univerjs-pro/license';import{ObjectMatrix as _0x57fc3a,requestImmediateMacroTask as _0x1d2584,RTree as _0x3b1e60,DependentOn as _0x36d96b}from'@univerjs/core';import{FormulaDependencyGenerator as _0x2a7356,generateRandomDependencyTreeId as _0x38f211,FormulaDependencyTree as _0x561522,FormulaDependencyTreeType as _0x585145,FormulaDependencyTreeVirtual as _0x346ec2,generateAstNode as _0x2069fc,LexerTreeBuilder as _0x5c6d37,ErrorType as _0x57e381,DEFAULT_TOKEN_TYPE_ROOT as _0x471653,DEFAULT_TOKEN_TYPE_PARAMETER as _0x1e9497,DEFAULT_TOKEN_TYPE_LAMBDA_PARAMETER as _0x22e0bc,NEW_EXCEL_FUNCTIONS as _0x3d9dbe,DEFAULT_TOKEN_LAMBDA_FUNCTION_NAME as _0x459a6a,DEFAULT_TOKEN_LET_FUNCTION_NAME as _0x2805d1,matchToken as _0xc58be3,SUFFIX_TOKEN_SET as _0x1de32f,prefixToken as _0x5428c8,LexerNode as _0x5a420f,OPERATOR_TOKEN_SET as _0x3623aa,CalculateFormulaService as _0x4278fd,FormulaExecuteStageType as _0x2f0386,ENGINE_FORMULA_PLUGIN_CONFIG_KEY as _0x3fb7d4,DEFAULT_INTERVAL_COUNT as _0x4660ca,DependencyManagerBaseService as _0x4cab92,UniverFormulaEnginePlugin as _0x41e239,ICalculateFormulaService as _0x439801,IDependencyManagerService as _0x54930a,IFormulaDependencyGenerator as _0xad1b7b,DependencyManagerService as _0x44198a}from'@univerjs/engine-formula';function _0x5e04(_0x1e49da,_0x4b3ffb){_0x1e49da=_0x1e49da-0x93;const _0x37c27c=_0x37c2();let _0x5e043a=_0x37c27c[_0x1e49da];return _0x5e043a;}export*from'@univerjs/engine-formula';const Ae={0x0:'H',0x1:'K',0x2:'h',0x3:'E',0x4:'y',0x5:'5',0x6:'e',0x7:'Z',0x8:'X',0x9:'C','v':'0','H':'1','X':'2','o':'3','W':'4','t':'6','h':'7','d':'8','s':'9','R':'a','V':'b','r':'c','Q':'d','T':'f','p':'g','w':'i','Z':'j','J':'k','M':'l','a':'m','S':'n','A':'o','b':'p','z':'q','L':'r','N':'s','F':'t','K':'u','u':'v','U':'w','n':'x','G':'z','e':'A','i':'B','O':'D','y':'F','j':'G','B':'I','k':'J','D':'L','Y':'M','m':'N','c':'O','I':'P','l':'Q','g':'R','C':'S','x':'T','f':'U','q':'V','E':'W','P':'Y'},Ne=_0x3259a6(0xd8);class ye extends _0x2a7356{constructor(){super(...arguments),M(this,'_dependencyTreeCache',new Map());}[_0x3259a6(0x9a)](){const _0x3c44c9=_0x3259a6;super['dispose'](),this[_0x3c44c9(0xa8)][_0x3c44c9(0x134)]();}async[_0x3259a6(0xea)](){const _0x1a48c2=_0x3259a6;this[_0x1a48c2(0x11c)]();const _0x1f5c34=this[_0x1a48c2(0xb0)]['getFormulaData'](),_0x222cb0=this[_0x1a48c2(0xb3)][_0x1a48c2(0x13a)](),_0x20de78=this[_0x1a48c2(0xb0)]['getClearDependencyTreeCache']();_0x20de78!=null&&Object[_0x1a48c2(0xe4)](_0x20de78)['forEach'](_0x34062d=>{const _0x504e30=_0x1a48c2;_0x34062d!=null&&Object[_0x504e30(0xe4)](_0x20de78[_0x34062d])['forEach'](_0x3a1583=>{const _0x5d55f3=_0x504e30;_0x3a1583!=null&&(this[_0x5d55f3(0x123)][_0x5d55f3(0xc5)](_0x34062d,_0x3a1583),this[_0x5d55f3(0x123)]['clearFeatureFormulaDependency'](_0x34062d,_0x3a1583),this[_0x5d55f3(0x123)]['clearFormulaDependency'](_0x34062d,_0x3a1583));});});const _0x4b13bc=this['_currentConfigService'][_0x1a48c2(0x140)]();await this[_0x1a48c2(0xfe)](_0x1f5c34,_0x222cb0,_0x4b13bc),this[_0x1a48c2(0x123)]['openKdTree']();const _0x3995d8=this[_0x1a48c2(0x135)](),_0x20bf40=this['_calculateRunList'](_0x3995d8);return this[_0x1a48c2(0x104)](_0x20bf40)&&this['_runtimeService'][_0x1a48c2(0xd7)](),this[_0x1a48c2(0xa8)][_0x1a48c2(0x134)](),this['_dependencyRTreeCacheForAddressFunction']['clear'](),this[_0x1a48c2(0x123)][_0x1a48c2(0xa7)](),this[_0x1a48c2(0x118)][_0x1a48c2(0xe8)](),Promise[_0x1a48c2(0xe1)](_0x20bf40);}[_0x3259a6(0x10b)](_0x575258,_0x4fdec5){const _0x5f4dfa=_0x3259a6,_0x141899=[_0x575258];for(;_0x141899['length']>0x0;){const _0x42329f=_0x141899[_0x141899[_0x5f4dfa(0xe6)]-0x1];if((_0x4fdec5[_0x5f4dfa(0xe3)](_0x42329f)||0x0)===0x0){_0x4fdec5[_0x5f4dfa(0xf4)](_0x42329f,0x1);const _0x1014cb=this[_0x5f4dfa(0xa8)]['get'](_0x42329f);if(_0x1014cb==null){_0x4fdec5[_0x5f4dfa(0xf4)](_0x42329f,0x2),_0x141899[_0x5f4dfa(0xf2)]();continue;}const _0x38e62b=this[_0x5f4dfa(0x123)][_0x5f4dfa(0x13f)](_0x1014cb[_0x5f4dfa(0xf8)]());for(const _0x5d5b99 of _0x38e62b){const _0x1a9a08=_0x4fdec5['get'](_0x5d5b99)||0x0;if(_0x1a9a08===0x1)return!0x0;_0x1a9a08===0x0&&_0x141899[_0x5f4dfa(0xb4)](_0x5d5b99);}}else _0x4fdec5[_0x5f4dfa(0xf4)](_0x42329f,0x2),_0x141899[_0x5f4dfa(0xf2)]();}return!0x1;}[_0x3259a6(0x104)](_0x54bdff){const _0x3c2985=_0x3259a6,_0xf8dc5d=new Map();for(const _0x353581 of _0x54bdff)if(!_0xf8dc5d['has'](_0x353581[_0x3c2985(0x145)])&&this[_0x3c2985(0x10b)](_0x353581[_0x3c2985(0x145)],_0xf8dc5d))return!0x0;return _0xf8dc5d['clear'](),!0x1;}[_0x3259a6(0x13d)](_0x487c2f,_0x1dcb15,_0x2fdd53){const _0x3b3484=_0x3259a6,{unitId:_0x3a663f,subUnitId:_0x16ae4c,dependencyRanges:_0x2ede2c,getDirtyData:_0x5a64a0}=_0x2fdd53,_0x4341e7=_0x1dcb15||_0x38f211(this[_0x3b3484(0x123)]),_0x1158c6=new _0x561522(_0x4341e7);_0x1158c6['unitId']=_0x3a663f,_0x1158c6['subUnitId']=_0x16ae4c,_0x1158c6['rangeList']=_0x2ede2c,_0x1158c6[_0x3b3484(0x10d)]=_0x5a64a0;const _0x119434=_0x5a64a0(this['_currentConfigService']['getDirtyData'](),this[_0x3b3484(0x118)][_0x3b3484(0x144)]()),_0x2dd4cb=this[_0x3b3484(0x129)](_0x119434[_0x3b3484(0x11d)]);return _0x1158c6['featureDirtyRanges']=_0x2dd4cb,_0x1158c6[_0x3b3484(0x131)]=_0x487c2f,_0x1158c6[_0x3b3484(0x128)]=_0x585145[_0x3b3484(0x103)],this[_0x3b3484(0x123)][_0x3b3484(0x9d)](_0x3a663f,_0x16ae4c,_0x487c2f,_0x1158c6),this['_dependencyTreeCache'][_0x3b3484(0xf4)](_0x1158c6['treeId'],_0x1158c6),this[_0x3b3484(0x123)]['getFeatureFormulaDependency'](_0x2fdd53[_0x3b3484(0xaf)],_0x2fdd53[_0x3b3484(0xd5)],_0x487c2f)&&(_0x1158c6['isCache']=!0x0),_0x1158c6;}[_0x3259a6(0xac)](_0x9005b2,_0x5f45e5,_0x4e7c9a){const _0x386cc2=_0x3259a6;var _0x543646;for(const _0x4846a1 of _0x5f45e5){const _0x5caf81=_0x9005b2[_0x4846a1];if(_0x5caf81==null)continue;const _0x2fcb0d=Object[_0x386cc2(0xe4)](_0x5caf81);for(const _0x4650fb of _0x2fcb0d){const _0x2d5ef5=_0x5caf81[_0x4650fb];if(_0x2d5ef5==null)continue;const _0x374b36=Object[_0x386cc2(0xe4)](_0x2d5ef5);for(const _0x5633dd of _0x374b36){const _0x52529b=this[_0x386cc2(0x123)][_0x386cc2(0x125)](_0x5633dd),_0x4c7c81=_0x2d5ef5[_0x5633dd],{f:_0x3abe41,ranges:_0x26d246}=_0x4c7c81;let _0x18034e=!0x1;_0x52529b&&(_0x18034e=!0x0);const {firstRow:_0x25b3ea,firstColumn:_0x18a7dd}=this[_0x386cc2(0x132)](_0x26d246),_0xa6c7aa=this[_0x386cc2(0x123)][_0x386cc2(0x133)](_0x4846a1,_0x4650fb,_0x5633dd),_0x4a506c=(_0x543646=_0xa6c7aa==null?void 0x0:_0xa6c7aa[_0x386cc2(0x142)](0x0,0x0))!=null?_0x543646:_0x38f211(this[_0x386cc2(0x123)]),_0x3f358a=new _0x561522(_0x4a506c);for(let _0x1f7ad1=0x0;_0x1f7ad1<_0x26d246[_0x386cc2(0xe6)];_0x1f7ad1++){const _0x5a380e=_0x26d246[_0x1f7ad1],{startRow:_0x1d75db,startColumn:_0x12d5da,endRow:_0x5dae2d,endColumn:_0x3e8331}=_0x5a380e;for(let _0x4f8b8b=_0x1d75db;_0x4f8b8b<=_0x5dae2d;_0x4f8b8b++)for(let _0x1d7109=_0x12d5da;_0x1d7109<=_0x3e8331;_0x1d7109++){const _0x5110f9=_0x1d7109-_0x18a7dd,_0x9c310b=_0x4f8b8b-_0x25b3ea;if(_0x5110f9===0x0&&_0x9c310b===0x0){_0x3f358a[_0x386cc2(0x12e)]=_0x3abe41,_0x3f358a['unitId']=_0x4846a1,_0x3f358a[_0x386cc2(0xd5)]=_0x4650fb,_0x3f358a[_0x386cc2(0xc9)]=_0x5633dd,_0x3f358a['type']=_0x585145[_0x386cc2(0x115)],_0x3f358a[_0x386cc2(0x106)]=_0x18034e,_0x4e7c9a[_0x386cc2(0xb4)](_0x3f358a),this['_dependencyTreeCache'][_0x386cc2(0xf4)](_0x3f358a[_0x386cc2(0x145)],_0x3f358a),this[_0x386cc2(0x123)][_0x386cc2(0x146)](_0x4846a1,_0x4650fb,_0x5633dd,_0x3f358a),this[_0x386cc2(0x123)][_0x386cc2(0xf3)](_0x3f358a);continue;}const _0x3d03ab=new _0x346ec2();_0x3d03ab['treeId']=(_0xa6c7aa==null?void 0x0:_0xa6c7aa[_0x386cc2(0x142)](_0x5110f9,_0x9c310b))||_0x38f211(this[_0x386cc2(0x123)]),_0x3d03ab['refTree']=_0x3f358a,_0x3d03ab[_0x386cc2(0x130)]=_0x5110f9,_0x3d03ab[_0x386cc2(0xf1)]=_0x9c310b,_0x3d03ab[_0x386cc2(0x106)]=_0x18034e,this[_0x386cc2(0x123)][_0x386cc2(0x146)](_0x4846a1,_0x4650fb,_0x5633dd,_0x3d03ab),this[_0x386cc2(0x123)][_0x386cc2(0xf3)](_0x3d03ab),_0x4e7c9a[_0x386cc2(0xb4)](_0x3d03ab),this[_0x386cc2(0xa8)][_0x386cc2(0xf4)](_0x3d03ab[_0x386cc2(0x145)],_0x3d03ab);}}this[_0x386cc2(0x123)][_0x386cc2(0xa0)](_0x5633dd);}}}}[_0x3259a6(0xd3)](_0x17d6f4,_0x3a12f3,_0x39a481,_0x25c7fb){const _0x2753aa=_0x3259a6;for(const _0x175d6d of _0x17d6f4){const _0x21390e=_0x3a12f3[_0x175d6d];if(_0x21390e==null)continue;const _0x20094a=Object['keys'](_0x21390e);for(const _0x8a36d7 of _0x20094a){const _0x5d5da4=new _0x57fc3a(_0x21390e[_0x8a36d7]||{}),_0x2560c1=new Map();_0x5d5da4[_0x2753aa(0x108)]((_0x5cd1dc,_0x5ae941,_0x223dee)=>{const _0x3251a6=_0x2753aa;if(_0x223dee==null)return!0x0;const {x:_0x31782c=0x0,y:_0x4b30b4=0x0,si:_0x26c6f1}=_0x223dee;if(!(_0x31782c===0x0&&_0x4b30b4===0x0&&_0x26c6f1!=null))return!0x0;const _0x5584f=this['_createFDtree'](_0x175d6d,_0x8a36d7,_0x5cd1dc,_0x5ae941,_0x39a481,_0x223dee),_0x27daea=this['_dependencyManagerService']['getFormulaDependency'](_0x175d6d,_0x8a36d7,_0x5cd1dc,_0x5ae941);_0x27daea!=null?_0x5584f[_0x3251a6(0x145)]=_0x27daea:(this[_0x3251a6(0x123)][_0x3251a6(0x12c)](_0x175d6d,_0x8a36d7,_0x5cd1dc,_0x5ae941,_0x5584f),this['_dependencyManagerService'][_0x3251a6(0xf3)](_0x5584f)),_0x2560c1['set'](_0x26c6f1,_0x5584f),_0x25c7fb[_0x3251a6(0xb4)](_0x5584f),this['_dependencyTreeCache'][_0x3251a6(0xf4)](_0x5584f['treeId'],_0x5584f);}),_0x5d5da4[_0x2753aa(0x108)]((_0xd89eb9,_0x47d29b,_0x23387a)=>{const _0x4a42f4=_0x2753aa;if(_0x23387a==null)return!0x0;const {x:_0x59165d=0x0,y:_0x1aefab=0x0,si:_0x246da2}=_0x23387a;if(_0x59165d===0x0&&_0x1aefab===0x0&&_0x246da2!=null)return!0x0;let _0x2de06a;if(_0x246da2&&_0x2560c1['has'](_0x246da2)){const _0x5d7736=_0x2560c1[_0x4a42f4(0xe3)](_0x246da2);_0x2de06a=this['_createVirtualFDtree'](_0x5d7736,_0x23387a);}else _0x2de06a=this[_0x4a42f4(0x10f)](_0x175d6d,_0x8a36d7,_0xd89eb9,_0x47d29b,_0x39a481,_0x23387a);const _0xa286f1=this[_0x4a42f4(0x123)][_0x4a42f4(0xd1)](_0x175d6d,_0x8a36d7,_0xd89eb9,_0x47d29b);_0xa286f1!=null?_0x2de06a[_0x4a42f4(0x145)]=_0xa286f1:(this[_0x4a42f4(0x123)][_0x4a42f4(0x12c)](_0x175d6d,_0x8a36d7,_0xd89eb9,_0x47d29b,_0x2de06a),this[_0x4a42f4(0x123)][_0x4a42f4(0xf3)](_0x2de06a)),_0x25c7fb[_0x4a42f4(0xb4)](_0x2de06a),this[_0x4a42f4(0xa8)][_0x4a42f4(0xf4)](_0x2de06a['treeId'],_0x2de06a);}),_0x2560c1[_0x2753aa(0x134)]();}}}[_0x3259a6(0x10f)](_0x506e4a,_0x49a187,_0x5ebab3,_0x1ade1e,_0xcec449,_0x46a77e){const _0x8e7bba=_0x3259a6,{f:_0x1e5322,x:_0x5228ff=0x0,y:_0x1f8d78=0x0}=_0x46a77e,_0x32ff8d=new _0x561522(_0x38f211(this[_0x8e7bba(0x123)])),_0x41c2ac=_0xcec449[_0x506e4a][_0x49a187];return _0x32ff8d['formula']=_0x1e5322,_0x32ff8d[_0x8e7bba(0xaf)]=_0x506e4a,_0x32ff8d[_0x8e7bba(0xd5)]=_0x49a187,_0x32ff8d['row']=_0x5ebab3,_0x32ff8d[_0x8e7bba(0x9f)]=_0x1ade1e,_0x32ff8d[_0x8e7bba(0xfb)]=_0x41c2ac[_0x8e7bba(0xfb)],_0x32ff8d[_0x8e7bba(0x10e)]=_0x41c2ac['columnCount'],_0x32ff8d;}[_0x3259a6(0x135)](){const _0x591bed=_0x3259a6,_0x36b2f2=[],_0x4b6fca=new Set(),_0xced6a1=this[_0x591bed(0xb0)][_0x591bed(0xca)](),_0x529179=this[_0x591bed(0xb0)]['getDirtyRanges'](),_0x144681=this[_0x591bed(0x123)]['searchDependency'](_0x529179),_0x1a2210=this[_0x591bed(0x138)]['bulkSearch'](_0x529179);for(const _0x30179 of _0x1a2210)_0x144681['add'](_0x30179);for(const [_0x333929,_0x45cc25]of this[_0x591bed(0xa8)])(_0xced6a1||_0x45cc25[_0x591bed(0x95)]||_0x45cc25[_0x591bed(0xd2)](this[_0x591bed(0xb0)]['getDirtyNameMap']())||_0x144681[_0x591bed(0xa3)](_0x333929)&&!_0x45cc25[_0x591bed(0x12d)](this['_currentConfigService']['getExcludedRange']()))&&!_0x4b6fca[_0x591bed(0xa3)](_0x333929)&&(_0x36b2f2[_0x591bed(0xb4)](_0x45cc25),_0x4b6fca[_0x591bed(0xd0)](_0x333929));for(const [_0xfd32e7,_0x36e8ca]of this[_0x591bed(0xa8)])_0x36e8ca[_0x591bed(0xae)]||(_0x36e8ca['rangeList']['length']=0x0);return _0x36b2f2;}[_0x3259a6(0x121)](_0x143a6b){const _0x4e35c3=_0x3259a6;return this[_0x4e35c3(0xa8)][_0x4e35c3(0xe3)](_0x143a6b);}[_0x3259a6(0x111)](_0x2369d7){const _0x3059ce=_0x3259a6;return _0x2069fc(_0x2369d7[_0x3059ce(0xaf)],_0x2369d7[_0x3059ce(0x12e)],this[_0x3059ce(0x124)],this[_0x3059ce(0x122)],this[_0x3059ce(0xb0)]);}*['_traverse'](_0x3f6bd3,_0x287eb8){const _0x1421f8=_0x3259a6,_0x2e387a=_0x3f6bd3,_0x51750f=new Set();for(;_0x2e387a[_0x1421f8(0xe6)]>0x0;){const _0x256e13=_0x2e387a[_0x1421f8(0xf2)]();if(_0x51750f['clear'](),_0x256e13===void 0x0||_0x256e13['isSkip']())continue;if(_0x256e13[_0x1421f8(0xc6)]()){yield _0x256e13,_0x256e13[_0x1421f8(0x12a)](),_0x287eb8[_0x1421f8(0xd0)](_0x256e13['treeId']);continue;}const _0x538195=this['_dependencyManagerService'][_0x1421f8(0x13f)](_0x256e13[_0x1421f8(0xf8)](),_0x287eb8),_0x519ac4=this[_0x1421f8(0x138)][_0x1421f8(0xf5)](_0x256e13[_0x1421f8(0xf8)](),_0x287eb8);for(const _0x330fd0 of _0x519ac4)_0x538195[_0x1421f8(0xd0)](_0x330fd0);for(const _0x1ae0f5 of _0x538195){const _0x1c57d3=this[_0x1421f8(0xa8)]['get'](_0x1ae0f5);if(!_0x1c57d3)throw new Error(_0x1421f8(0xad));_0x1c57d3[_0x1421f8(0xc6)]()||_0x256e13['isSkip']()||_0x51750f[_0x1421f8(0xd0)](_0x1c57d3);}if(_0x538195[_0x1421f8(0x134)](),_0x51750f['size']===0x0)yield _0x256e13,_0x256e13[_0x1421f8(0x12a)](),_0x287eb8[_0x1421f8(0xd0)](_0x256e13['treeId']);else{_0x256e13[_0x1421f8(0xdb)](),_0x2e387a[_0x1421f8(0xb4)](_0x256e13);for(const _0x4d9bf1 of _0x51750f)_0x2e387a[_0x1421f8(0xb4)](_0x4d9bf1);}}_0x2e387a[_0x1421f8(0xe6)]=0x0,_0x51750f[_0x1421f8(0x134)]();}[_0x3259a6(0x109)](_0x53a8e2){const _0x39f097=_0x3259a6,_0x3ef2b8=[],_0x100d9d=new Set();for(const _0x26d15c of this[_0x39f097(0xe0)](_0x53a8e2,_0x100d9d))_0x3ef2b8['push'](_0x26d15c);return _0x3ef2b8;}}class Me extends _0x5c6d37{constructor(){const _0x1c649a=_0x3259a6;super(...arguments),M(this,_0x1c649a(0xd6),!0x1),M(this,_0x1c649a(0x93),new Set());}['getNewFormulaWithPrefix'](_0x435ee9,_0x342362){const _0x1a00b1=_0x3259a6,_0x1305ac=this[_0x1a00b1(0x9b)](_0x435ee9,!0x1);if(!_0x1305ac||_0x1305ac===_0x57e381[_0x1a00b1(0xcc)]||Array[_0x1a00b1(0x105)](_0x1305ac))return null;const _0xc097ad=[];return this[_0x1a00b1(0xd6)]=!0x1,this[_0x1a00b1(0x139)](_0x1305ac,_0xc097ad,_0x342362),this[_0x1a00b1(0xd6)]?'='+_0xc097ad[_0x1a00b1(0x11e)](''):null;}[_0x3259a6(0x139)](_0x4cca30,_0x349f76,_0x1704a1){const _0x3b76f7=_0x3259a6,_0x1fbeba=_0x4cca30[_0x3b76f7(0xef)](),_0x3a8acc=_0x1fbeba[_0x3b76f7(0xd4)](),_0x5346f6=_0x3a8acc[_0x3b76f7(0x98)](),_0xc41a84=this['_clearFunctionString'](_0x5346f6),_0x5d498d=_0x1704a1(_0xc41a84);let _0x144a64=0x0;_0x1fbeba===_0x471653?_0x144a64=0x3:_0x1fbeba===_0x1e9497?_0x144a64=0x4:_0x1fbeba===_0x22e0bc?_0x144a64=0x5:_0x3d9dbe[_0x3b76f7(0xa3)](_0xc41a84)?(_0x349f76[_0x3b76f7(0xb4)](_0x3b76f7(0xdc)+_0x3a8acc),this['_hasNewExcelFunction']=!0x0):_0x5346f6===_0x459a6a?(_0x349f76[_0x3b76f7(0xb4)](_0x3b76f7(0xdc)+_0x3a8acc),this['_hasNewExcelFunction']=!0x0,_0x144a64=0x2):_0x5346f6===_0x2805d1?(_0x349f76[_0x3b76f7(0xb4)](_0x3b76f7(0xdc)+_0x3a8acc),this[_0x3b76f7(0xd6)]=!0x0,_0x144a64=0x1):_0x5346f6===_0xc58be3[_0x3b76f7(0xe7)]?_0x144a64=0x8:_0x1de32f[_0x3b76f7(0xa3)](_0x5346f6)?_0x144a64=0x7:_0x5346f6===_0x5428c8[_0x3b76f7(0x97)]?(this[_0x3b76f7(0xaa)](_0x4cca30)&&(_0x144a64=0x9),_0x349f76[_0x3b76f7(0xb4)](_0x1fbeba)):(_0x349f76[_0x3b76f7(0xb4)](_0x1fbeba),_0x144a64=0xa),_0x5d498d?(_0x144a64!==0x2&&_0x144a64!==0x1&&(_0x144a64=0x6),_0x349f76[_0x3b76f7(0xb4)]('(')):_0x144a64===0x9&&_0x349f76[_0x3b76f7(0xb4)]('(');const _0x1af218=_0x4cca30['getChildren'](),_0x257c72=_0x1af218[_0x3b76f7(0xe6)];if(_0x144a64===0x2){const _0x113a85=_0x1af218[0x0];let _0x3893fc=0x0;_0x113a85 instanceof _0x5a420f&&_0x113a85['getToken']()===_0x22e0bc&&(_0x3893fc=0x1);for(let _0x35c53b=_0x3893fc;_0x35c53b<_0x257c72-0x1;_0x35c53b++){const _0x33693e=_0x1af218[_0x35c53b];if(_0x33693e instanceof _0x5a420f){const _0x5500d2=_0x33693e[_0x3b76f7(0x112)]()[0x0];typeof _0x5500d2=='string'&&(this['_lambdaFunctionParameterSet'][_0x3b76f7(0xa3)](_0x5500d2)&&console[_0x3b76f7(0xbc)](_0x3b76f7(0xa5)+_0x5500d2+_0x3b76f7(0xc1)),this[_0x3b76f7(0x93)][_0x3b76f7(0xd0)](_0x5500d2),_0x349f76[_0x3b76f7(0xb4)](_0x3b76f7(0xf7)+_0x5500d2),this[_0x3b76f7(0xd6)]=!0x0);}_0x349f76[_0x3b76f7(0xb4)](',');}this[_0x3b76f7(0x119)](_0x1af218[_0x257c72-0x1],_0x349f76,_0x1704a1),_0x3893fc===0x1&&(_0x349f76[_0x3b76f7(0xb4)](')'),_0x349f76[_0x3b76f7(0xb4)]('('),this[_0x3b76f7(0x139)](_0x113a85,_0x349f76,_0x1704a1)),_0x349f76['push'](')');return;}else{if(_0x144a64===0x1){for(let _0x355055=0x0;_0x355055<_0x257c72-0x1;_0x355055++){const _0x7bd757=_0x1af218[_0x355055];if(_0x7bd757 instanceof _0x5a420f&&_0x355055%0x2===0x0){const _0x298e0c=_0x7bd757['getChildren']()[0x0];if(typeof _0x298e0c==_0x3b76f7(0xf9)){this['_lambdaFunctionParameterSet']['has'](_0x298e0c)&&console['error'](_0x3b76f7(0xb9)+_0x298e0c+_0x3b76f7(0xc1)),this[_0x3b76f7(0x93)]['add'](_0x298e0c),_0x349f76[_0x3b76f7(0xb4)]('_xlpm.'+_0x298e0c),this[_0x3b76f7(0xd6)]=!0x0,_0x349f76['push'](',');continue;}}if(this[_0x3b76f7(0x119)](_0x7bd757,_0x349f76,_0x1704a1),_0x7bd757 instanceof _0x5a420f){const _0x56ae35=_0x1af218[_0x355055+0x1];_0x56ae35&&_0x56ae35 instanceof _0x5a420f&&_0x349f76[_0x3b76f7(0xb4)](',');}}this[_0x3b76f7(0x119)](_0x1af218[_0x257c72-0x1],_0x349f76,_0x1704a1),_0x349f76[_0x3b76f7(0xb4)](')');return;}else{if(_0x144a64===0x8){const _0x53f583=_0x1af218[0x0],_0x2017d6=_0x1af218[0x1];this[_0x3b76f7(0x119)](_0x53f583,_0x349f76,_0x1704a1),_0x349f76[_0x3b76f7(0xb4)](_0x1fbeba),this[_0x3b76f7(0x119)](_0x2017d6,_0x349f76,_0x1704a1);return;}}}for(let _0x5d8834=0x0;_0x5d8834<_0x257c72;_0x5d8834++){const _0x54b87a=_0x1af218[_0x5d8834];if(this[_0x3b76f7(0x119)](_0x54b87a,_0x349f76,_0x1704a1),_0x54b87a instanceof _0x5a420f){const _0x159567=_0x1af218[_0x5d8834+0x1];_0x159567&&_0x159567 instanceof _0x5a420f&&_0x349f76[_0x3b76f7(0xb4)](',');}}_0x144a64===0x7&&_0x349f76[_0x3b76f7(0xb4)](_0x1fbeba),(_0x5d498d||_0x144a64===0x9)&&_0x349f76[_0x3b76f7(0xb4)](')');}['_handleNewFunctionChild'](_0x5660b7,_0x3e3f57,_0x3e0655){const _0x17257e=_0x3259a6;_0x5660b7 instanceof _0x5a420f?this['_generateNewFunctionString'](_0x5660b7,_0x3e3f57,_0x3e0655):this['_lambdaFunctionParameterSet'][_0x17257e(0xa3)](_0x5660b7)?(_0x3e3f57[_0x17257e(0xb4)]('_xlpm.'+_0x5660b7),this[_0x17257e(0xd6)]=!0x0):_0x3e3f57[_0x17257e(0xb4)](_0x5660b7);}[_0x3259a6(0x101)](_0x4253e2){const _0x387f5e=_0x3259a6;let _0x538913=_0x4253e2[_0x387f5e(0xd4)]();if(!_0x538913)return _0x538913;const _0x2436a9=_0x538913[0x0];if((_0x2436a9===_0x5428c8['AT']||_0x2436a9===_0x5428c8[_0x387f5e(0x97)]||_0x2436a9===_0x5428c8[_0x387f5e(0x147)])&&(_0x538913=_0x538913[_0x387f5e(0xfa)](0x1)),!_0x538913)return _0x538913;const _0x8de3f7=_0x538913[_0x538913['length']-0x1];return _0x1de32f[_0x387f5e(0xa3)](_0x8de3f7)&&(_0x538913=_0x538913[_0x387f5e(0xfa)](0x0,-0x1)),_0x538913;}[_0x3259a6(0xaa)](_0x52f087){const _0x577b2d=_0x3259a6,_0xc845b4=_0x52f087[_0x577b2d(0x112)]()[0x0];if(!_0xc845b4||!(_0xc845b4 instanceof _0x5a420f)||_0x52f087[_0x577b2d(0x112)]()[_0x577b2d(0xe6)]>0x1)return!0x1;const _0x56ca67=_0xc845b4['getChildren'](),_0x27d0c2=_0x56ca67[_0x577b2d(0xe6)];if(_0x27d0c2===0x1)return!0x1;for(let _0xeca8bd=0x0;_0xeca8bd<_0x27d0c2;_0xeca8bd++){const _0x59f340=_0x56ca67[_0xeca8bd];if(!(_0x59f340 instanceof _0x5a420f)&&_0x3623aa['has'](_0x59f340))return!0x0;}return!0x1;}}class De extends _0x4278fd{async['_apply'](_0x2e53d1=!0x1){const _0x284f9b=_0x3259a6;_0x2e53d1?this[_0x284f9b(0x118)]['setFormulaExecuteStage'](_0x2f0386[_0x284f9b(0xbe)]):this['_runtimeService'][_0x284f9b(0x13b)](_0x2f0386[_0x284f9b(0xcf)]),this[_0x284f9b(0xdf)][_0x284f9b(0xed)](this[_0x284f9b(0x118)]['getRuntimeState']());const _0x3cf2bb=await this[_0x284f9b(0x116)][_0x284f9b(0xea)](),_0x5532ed=this['_interpreter'];_0x2e53d1?(this['_runtimeService'][_0x284f9b(0x13b)](_0x2f0386['START_CALCULATION_ARRAY_FORMULA']),this['_runtimeService'][_0x284f9b(0x13e)](_0x3cf2bb[_0x284f9b(0xe6)])):(this[_0x284f9b(0x118)][_0x284f9b(0x13b)](_0x2f0386['START_CALCULATION']),this[_0x284f9b(0x118)]['setTotalFormulasToCalculate'](_0x3cf2bb['length'])),this[_0x284f9b(0xdf)][_0x284f9b(0xed)](this[_0x284f9b(0x118)][_0x284f9b(0xb7)]());let _0x5afa0f=[];const _0x372e25=this[_0x284f9b(0xd9)]['getConfig'](_0x3fb7d4),_0x2ea178=(_0x372e25==null?void 0x0:_0x372e25[_0x284f9b(0xf6)])||_0x4660ca;let _0xb22103=0x0;const _0x5cae57=_0x3cf2bb['length'];for(;_0x3cf2bb[_0x284f9b(0xe6)]>0x0;){const _0x3c02ac=_0x3cf2bb['pop'](),_0x581a99=_0x2069fc(_0x3c02ac[_0x284f9b(0xaf)],_0x3c02ac[_0x284f9b(0x12e)],this[_0x284f9b(0x124)],this[_0x284f9b(0x122)],this['_currentConfigService']),_0x1ab38c={'node':_0x581a99,'refOffsetX':_0x3c02ac[_0x284f9b(0x130)],'refOffsetY':_0x3c02ac[_0x284f9b(0xf1)]},_0x5acd4f=_0x3c02ac['getDirtyData'];if(_0xb22103%_0x2ea178===0x0&&(await new Promise(_0x482989=>{const _0x1d8ca1=_0x284f9b,_0xed1c94=_0x1d2584(_0x482989);_0x5afa0f[_0x1d8ca1(0xb4)](_0xed1c94);}),_0x2e53d1?(this[_0x284f9b(0x118)]['setFormulaExecuteStage'](_0x2f0386[_0x284f9b(0xa2)]),this[_0x284f9b(0x118)][_0x284f9b(0xc0)](_0xb22103+0x1)):(this[_0x284f9b(0x118)]['setFormulaExecuteStage'](_0x2f0386[_0x284f9b(0x10c)]),this[_0x284f9b(0x118)][_0x284f9b(0x127)](_0xb22103+0x1)),this[_0x284f9b(0xdf)][_0x284f9b(0xed)](this[_0x284f9b(0x118)][_0x284f9b(0xb7)]()),this[_0x284f9b(0x118)]['isStopExecution']()||_0x1ab38c==null&&_0x5acd4f==null)){this[_0x284f9b(0x118)]['setFormulaExecuteStage'](_0x2f0386[_0x284f9b(0x11a)]),this[_0x284f9b(0x118)][_0x284f9b(0xda)](),this[_0x284f9b(0xc4)][_0x284f9b(0xed)](this[_0x284f9b(0x118)][_0x284f9b(0x144)]());return;}this[_0x284f9b(0x118)][_0x284f9b(0x120)](_0x3c02ac[_0x284f9b(0x113)],_0x3c02ac['column'],_0x3c02ac[_0x284f9b(0xfb)],_0x3c02ac[_0x284f9b(0x10e)],_0x3c02ac['subUnitId'],_0x3c02ac[_0x284f9b(0xaf)]);let _0x53a4a6;if(_0x5acd4f!=null&&_0x3c02ac[_0x284f9b(0x131)]!=null){const {runtimeCellData:_0x26d932,dirtyRanges:_0x28113c}=_0x5acd4f(this[_0x284f9b(0xb0)][_0x284f9b(0x10d)](),this['_runtimeService'][_0x284f9b(0x144)]());this[_0x284f9b(0x118)][_0x284f9b(0x107)](_0x3c02ac[_0x284f9b(0x131)],_0x26d932),this[_0x284f9b(0x118)][_0x284f9b(0xcb)](_0x3c02ac[_0x284f9b(0x131)],_0x28113c);}else _0x1ab38c!=null&&(_0x5532ed[_0x284f9b(0xcd)](_0x1ab38c[_0x284f9b(0x96)])?_0x53a4a6=await _0x5532ed[_0x284f9b(0x136)](_0x1ab38c):_0x53a4a6=_0x5532ed['execute'](_0x1ab38c),_0x3c02ac[_0x284f9b(0xc9)]!=null?this[_0x284f9b(0x118)][_0x284f9b(0xe9)](_0x3c02ac['formulaId'],_0x3c02ac[_0x284f9b(0x130)],_0x3c02ac[_0x284f9b(0xf1)],_0x53a4a6):this[_0x284f9b(0x118)]['setRuntimeData'](_0x53a4a6));_0x581a99[_0x284f9b(0x102)](),_0xb22103++;}return _0x5afa0f[_0x284f9b(0xee)](_0x592bfc=>_0x592bfc()),_0x5afa0f=[],_0x5cae57>0x0?this[_0x284f9b(0x118)][_0x284f9b(0x11b)]():_0x2e53d1||this[_0x284f9b(0x118)]['markedAsNoFunctionsExecuted'](),this['_runtimeService'][_0x284f9b(0x144)]();}}class we extends _0x4cab92{constructor(){const _0x5a532d=_0x3259a6;super(...arguments),M(this,_0x5a532d(0x137),new Map()),M(this,_0x5a532d(0xb6),new _0x3b1e60(!0x0));}[_0x3259a6(0x12b)](){const _0x40a45a=_0x3259a6;this[_0x40a45a(0x100)][_0x40a45a(0x134)](),this['_featureFormulaData'][_0x40a45a(0x134)](),this[_0x40a45a(0xe2)][_0x40a45a(0x134)](),this[_0x40a45a(0xb6)][_0x40a45a(0x134)](),this['_allTreeMap'][_0x40a45a(0x134)](),this[_0x40a45a(0x110)](),this[_0x40a45a(0xb5)][_0x40a45a(0x134)]();}[_0x3259a6(0x146)](_0xf6763,_0x49446c,_0x515704,_0x23daee){const _0x1b5eab=_0x3259a6;this[_0x1b5eab(0x100)][_0x1b5eab(0xa3)](_0xf6763)||this[_0x1b5eab(0x100)][_0x1b5eab(0xf4)](_0xf6763,new Map());const _0x567126=this['_otherFormulaData'][_0x1b5eab(0xe3)](_0xf6763);_0x567126[_0x1b5eab(0xa3)](_0x49446c)||_0x567126[_0x1b5eab(0xf4)](_0x49446c,new Map());const _0x2172ff=_0x567126[_0x1b5eab(0xe3)](_0x49446c);_0x2172ff[_0x1b5eab(0xa3)](_0x515704)||_0x2172ff[_0x1b5eab(0xf4)](_0x515704,new _0x57fc3a()),_0x2172ff[_0x1b5eab(0xe3)](_0x515704)[_0x1b5eab(0xde)](_0x23daee[_0x1b5eab(0x130)],_0x23daee[_0x1b5eab(0xf1)],_0x23daee[_0x1b5eab(0x145)]);}[_0x3259a6(0xab)](_0x39141f,_0x4efed0,_0x1fb813){const _0x4332c4=_0x3259a6,_0x3c5bbe=this[_0x4332c4(0x100)]['get'](_0x39141f);if(_0x3c5bbe&&_0x3c5bbe[_0x4332c4(0xa3)](_0x4efed0)){const _0x1053ef=_0x3c5bbe[_0x4332c4(0xe3)](_0x4efed0);_0x1fb813[_0x4332c4(0xee)](_0x286afb=>{const _0x426e23=_0x4332c4,_0xf20ab6=_0x1053ef[_0x426e23(0xe3)](_0x286afb);_0xf20ab6!=null&&(_0xf20ab6[_0x426e23(0x108)]((_0x2164a2,_0x585c5a,_0x3737ef)=>{const _0x540756=_0x426e23;this[_0x540756(0xa9)](_0x3737ef),this[_0x540756(0x143)](_0x3737ef);}),_0x1053ef[_0x426e23(0xfc)](_0x286afb),this[_0x426e23(0xb5)]['delete'](_0x286afb));}),_0x1053ef[_0x4332c4(0xb2)]===0x0&&_0x3c5bbe[_0x4332c4(0xfc)](_0x4efed0),_0x3c5bbe['size']===0x0&&this['_otherFormulaData'][_0x4332c4(0xfc)](_0x39141f);}}[_0x3259a6(0xc5)](_0x1a0de4,_0x4d8c56){const _0x52f392=_0x3259a6,_0x28476f=this[_0x52f392(0x100)]['get'](_0x1a0de4);if(_0x4d8c56&&_0x28476f&&_0x28476f['has'](_0x4d8c56)){const _0x128943=_0x28476f['get'](_0x4d8c56);this[_0x52f392(0x126)](_0x1a0de4,_0x4d8c56);for(const _0x2a64e1 of _0x128943[_0x52f392(0xe4)]()){const _0x49f2ed=_0x128943['get'](_0x2a64e1);_0x49f2ed!=null&&(_0x49f2ed['forValue']((_0xd6bc92,_0x509c4d,_0x40c828)=>{const _0x504384=_0x52f392;this['_allTreeMap'][_0x504384(0xe3)](_0x40c828)&&this[_0x504384(0x143)](_0x40c828);}),this[_0x52f392(0xb5)][_0x52f392(0xfc)](_0x2a64e1));}_0x128943[_0x52f392(0x134)]();}else{if(_0x28476f){for(const _0x39f6a1 of _0x28476f[_0x52f392(0xe4)]()){const _0x21d21e=_0x28476f['get'](_0x39f6a1);this[_0x52f392(0x126)](_0x1a0de4,_0x39f6a1);for(const _0x47d087 of _0x21d21e[_0x52f392(0xe4)]()){const _0x2544af=_0x21d21e['get'](_0x47d087);_0x2544af!=null&&(_0x2544af[_0x52f392(0x108)]((_0x4d6c23,_0x56c5da,_0x2e7067)=>{const _0x249dcd=_0x52f392;this[_0x249dcd(0x137)][_0x249dcd(0xe3)](_0x2e7067)&&this[_0x249dcd(0x143)](_0x2e7067);}),this[_0x52f392(0xb5)]['delete'](_0x47d087));}}this[_0x52f392(0x100)]['delete'](_0x1a0de4);}}}[_0x3259a6(0x9d)](_0x3ce82b,_0x396728,_0x3f23a6,_0x1a88d0){const _0x438cf1=_0x3259a6;this[_0x438cf1(0x13c)][_0x438cf1(0xa3)](_0x3ce82b)||this[_0x438cf1(0x13c)][_0x438cf1(0xf4)](_0x3ce82b,new Map());const _0x384a63=this[_0x438cf1(0x13c)][_0x438cf1(0xe3)](_0x3ce82b);_0x384a63[_0x438cf1(0xa3)](_0x396728)||_0x384a63[_0x438cf1(0xf4)](_0x396728,new Map()),_0x384a63[_0x438cf1(0xe3)](_0x396728)['set'](_0x3f23a6,_0x1a88d0[_0x438cf1(0x145)]);}[_0x3259a6(0xa4)](_0x32aefd,_0x4459fa,_0x4897dd){const _0x59972e=_0x3259a6,_0x5a5a3c=this[_0x59972e(0x13c)][_0x59972e(0xe3)](_0x32aefd);if(_0x5a5a3c&&_0x5a5a3c[_0x59972e(0xa3)](_0x4459fa)){const _0x5bf73b=_0x5a5a3c[_0x59972e(0xe3)](_0x4459fa);_0x4897dd[_0x59972e(0xee)](_0x55fc6f=>{const _0x5eaa34=_0x59972e,_0x425820=_0x5bf73b[_0x5eaa34(0xe3)](_0x55fc6f);_0x425820!=null&&(this['_removeDependencyRTreeCache'](_0x425820),_0x5bf73b[_0x5eaa34(0xfc)](_0x55fc6f),this[_0x5eaa34(0x143)](_0x425820));});}}['clearFeatureFormulaDependency'](_0x36205b,_0x2b6cbe){const _0x28ea4d=_0x3259a6,_0x3d513a=this[_0x28ea4d(0x13c)][_0x28ea4d(0xe3)](_0x36205b);if(_0x2b6cbe&&_0x3d513a&&_0x3d513a[_0x28ea4d(0xa3)](_0x2b6cbe)){const _0x2e043a=_0x3d513a['get'](_0x2b6cbe);this['_removeDependencyRTreeCacheById'](_0x36205b,_0x2b6cbe),_0x2e043a[_0x28ea4d(0xee)](_0x5f2a49=>{const _0x3cb256=_0x28ea4d;_0x5f2a49!=null&&this[_0x3cb256(0x143)](_0x5f2a49);}),_0x2e043a[_0x28ea4d(0x134)]();}else _0x3d513a&&(_0x3d513a[_0x28ea4d(0xee)]((_0x11a2cb,_0x367f9e)=>{const _0x341532=_0x28ea4d;this[_0x341532(0x126)](_0x36205b,_0x367f9e),_0x11a2cb[_0x341532(0xee)](_0x1719e5=>{const _0x3b2f56=_0x341532;_0x1719e5!=null&&this[_0x3b2f56(0x143)](_0x1719e5);});}),this[_0x28ea4d(0x13c)][_0x28ea4d(0xfc)](_0x36205b));}[_0x3259a6(0x12c)](_0x2d626e,_0x42de36,_0x2de8dc,_0x25df03,_0x531e66){const _0x24f670=_0x3259a6;this[_0x24f670(0xe2)][_0x24f670(0xa3)](_0x2d626e)||this[_0x24f670(0xe2)][_0x24f670(0xf4)](_0x2d626e,new Map());const _0x4970e0=this['_formulaData'][_0x24f670(0xe3)](_0x2d626e);_0x4970e0[_0x24f670(0xa3)](_0x42de36)||_0x4970e0[_0x24f670(0xf4)](_0x42de36,new _0x57fc3a()),_0x4970e0['get'](_0x42de36)[_0x24f670(0xde)](_0x2de8dc,_0x25df03,_0x531e66['treeId']);}[_0x3259a6(0xeb)](_0xd16d48,_0x1cb9af,_0x25213c,_0x2c7a64){const _0x1d59b4=_0x3259a6,_0x57f082=this[_0x1d59b4(0xe2)][_0x1d59b4(0xe3)](_0xd16d48);if(_0x57f082&&_0x57f082['has'](_0x1cb9af)){const _0xed6c6f=_0x57f082[_0x1d59b4(0xe3)](_0x1cb9af),_0x55d034=_0xed6c6f[_0x1d59b4(0x142)](_0x25213c,_0x2c7a64);if(_0x55d034==null)return;this[_0x1d59b4(0xa9)](_0x55d034),_0xed6c6f['realDeleteValue'](_0x25213c,_0x2c7a64),this[_0x1d59b4(0x143)](_0x55d034);}}[_0x3259a6(0xf0)](_0x4f24cd,_0x20d472){const _0x4d3b41=_0x3259a6,_0x5b5b5b=this['_formulaData'][_0x4d3b41(0xe3)](_0x4f24cd);if(_0x20d472&&_0x5b5b5b&&_0x5b5b5b[_0x4d3b41(0xa3)](_0x20d472)){const _0x3b3aa9=_0x5b5b5b[_0x4d3b41(0xe3)](_0x20d472);this[_0x4d3b41(0x126)](_0x4f24cd,_0x20d472),_0x3b3aa9[_0x4d3b41(0x108)]((_0xaf6dd8,_0x388540,_0x89009e)=>{const _0x1bd183=_0x4d3b41;if(_0x89009e==null)return!0x0;this[_0x1bd183(0x143)](_0x89009e);}),_0x3b3aa9['reset']();}else _0x5b5b5b&&(_0x5b5b5b[_0x4d3b41(0xee)]((_0x52ebf6,_0x472af2)=>{const _0x479438=_0x4d3b41;this[_0x479438(0x126)](_0x4f24cd,_0x472af2),_0x52ebf6[_0x479438(0x108)]((_0x22ced6,_0x42f08d,_0x3c7832)=>{const _0x4493e5=_0x479438;if(_0x3c7832==null)return!0x0;this[_0x4493e5(0x143)](_0x3c7832);});}),this[_0x4d3b41(0xe2)]['delete'](_0x4f24cd));}[_0x3259a6(0xa9)](_0x1bc090){const _0xd7472=_0x3259a6;if(_0x1bc090==null)return;const _0x26075f=this[_0xd7472(0x137)][_0xd7472(0xe3)](_0x1bc090);if(_0x26075f){const _0x276100=[];for(const [_0x3d29ac,_0x172cb5]of _0x26075f)for(const [_0x373bff,_0x413696]of _0x172cb5)_0x276100[_0xd7472(0xb4)]({'unitId':_0x3d29ac,'sheetId':_0x373bff,'range':_0x413696,'id':_0x1bc090});this[_0xd7472(0xb6)]['bulkRemove'](_0x276100);}}[_0x3259a6(0xc7)](_0x103da3,_0x376006){const _0x5b3181=_0x3259a6,_0x32a8e1=this[_0x5b3181(0xbf)][_0x5b3181(0xe3)](_0x103da3);if(_0x32a8e1){const _0x155a81=_0x32a8e1[_0x5b3181(0xe3)](_0x376006);if(_0x155a81){for(const _0x10b916 of _0x155a81)this[_0x5b3181(0xa9)](_0x10b916),this[_0x5b3181(0x143)](_0x10b916);_0x155a81['clear']();}}}[_0x3259a6(0xb1)](){const _0x454d97=_0x3259a6;this[_0x454d97(0xb6)][_0x454d97(0xb1)]();}[_0x3259a6(0xa7)](){const _0x301e9b=_0x3259a6;this[_0x301e9b(0xb6)][_0x301e9b(0xa7)]();}[_0x3259a6(0x143)](_0x34c442){_0x34c442!=null&&this['_allTreeMap']['delete'](_0x34c442);}[_0x3259a6(0x99)](_0x4c4760){const _0x16930d=_0x3259a6;var _0xa98acb,_0x166831;const _0xe633ec=_0x4c4760[_0x16930d(0xec)];let _0x34a3e5=this[_0x16930d(0x137)][_0x16930d(0xe3)](_0x4c4760['treeId']);for(let _0x2e954d=0x0;_0x2e954d<_0xe633ec[_0x16930d(0xe6)];_0x2e954d++){const _0x107c71=_0xe633ec[_0x2e954d];let {unitId:_0x32a10c,sheetId:_0x483312,range:_0x3917d7}=_0x107c71;_0x34a3e5||(_0x34a3e5=new Map(),this[_0x16930d(0x137)][_0x16930d(0xf4)](_0x4c4760[_0x16930d(0x145)],_0x34a3e5)),_0x34a3e5[_0x16930d(0xa3)](_0x32a10c)||_0x34a3e5[_0x16930d(0xf4)](_0x32a10c,new Map());const _0xbacd7a=(_0xa98acb=_0x34a3e5==null?void 0x0:_0x34a3e5[_0x16930d(0xe3)](_0x32a10c))==null?void 0x0:_0xa98acb['get'](_0x483312);_0xbacd7a&&(_0x3917d7={'startRow':Math['min'](_0x3917d7[_0x16930d(0x9e)],_0xbacd7a[_0x16930d(0x9e)]),'startColumn':Math['min'](_0x3917d7[_0x16930d(0xfd)],_0xbacd7a['startColumn']),'endRow':Math['max'](_0x3917d7['endRow'],_0xbacd7a['endRow']),'endColumn':Math[_0x16930d(0xbb)](_0x3917d7[_0x16930d(0xbd)],_0xbacd7a['endColumn'])}),(_0x166831=_0x34a3e5['get'](_0x32a10c))==null||_0x166831['set'](_0x483312,_0x3917d7);}}}var Ce=Object['getOwnPropertyDescriptor'],Le=(_0x35a4f7,_0x1fa2a5,_0x13b4fb,_0x4274c4)=>{const _0x6139d9=_0x3259a6;for(var _0x3435cc=_0x4274c4>0x1?void 0x0:_0x4274c4?Ce(_0x1fa2a5,_0x13b4fb):_0x1fa2a5,_0x19293d=_0x35a4f7[_0x6139d9(0xe6)]-0x1,_0x55e6fb;_0x19293d>=0x0;_0x19293d--)(_0x55e6fb=_0x35a4f7[_0x19293d])&&(_0x3435cc=_0x55e6fb(_0x3435cc)||_0x3435cc);return _0x3435cc;};const ve=Number[_0x3259a6(0x114)](0x6933d6d1);let V=class extends _0x41e239{[_0x3259a6(0xdd)](){const _0x3fcf90=_0x3259a6;var _0x5c0c23,_0x17e5e0;this[_0x3fcf90(0xc2)]()?(this[_0x3fcf90(0x94)]['add']([_0x5c6d37,{'useClass':Me}]),(_0x5c0c23=this[_0x3fcf90(0x141)])!=null&&_0x5c0c23['notExecuteFormula']||[[_0x439801,{'useClass':De}],[_0x54930a,{'useClass':we}],[_0xad1b7b,{'useClass':ye}]][_0x3fcf90(0xee)](_0x51e167=>this['_injector'][_0x3fcf90(0xd0)](_0x51e167))):(this[_0x3fcf90(0x94)]['add']([_0x5c6d37,{'useClass':_0x5c6d37}]),(_0x17e5e0=this[_0x3fcf90(0x141)])!=null&&_0x17e5e0['notExecuteFormula']||[[_0x439801,{'useClass':_0x4278fd}],[_0x54930a,{'useClass':_0x44198a}],[_0xad1b7b,{'useClass':_0x2a7356}]][_0x3fcf90(0xee)](_0x3c3177=>this[_0x3fcf90(0x94)]['add'](_0x3c3177)));}['_initLicenseValid'](){const _0x4445d1=_0x3259a6;var _0x604d75;const _0x55e9b8=(_0x604d75=this[_0x4445d1(0xd9)]['getConfig'](_0x2ac5af))!=null?_0x604d75:{},{ls:_0x444465,pbk:_0x13be61}=_0x55e9b8;if(!_0x444465||!_0x13be61)return!0x1;const _0x52c2e2=_0x53284f(Ne,Ae),_0x12da91=new Function(_0x4445d1(0xff)+_0x52c2e2)()(_0x444465,_0x13be61),_0x2af235=_0x12da91[_0x4445d1(0xa6)];return _0x12da91['valid']&&_0x7d5d24(_0x2af235,'sf',ve)?_0x167def(_0x2af235,!0x0,'a',!0x0,!0x1,!0x1):!0x1;}};function _0x37c2(){const _0x3e8c78=['next','forEach','getToken','clearFormulaDependency','refOffsetY','pop','addFormulaDependencyByDefinedName','set','bulkSearch','intervalCount','_xlpm.','toRTreeItem','string','slice','rowCount','delete','startColumn','_generateTreeList','return\x20','_otherFormulaData','_clearFunctionString','resetCalculationState','FEATURE_FORMULA','_checkIsCycleDependency','isArray','isCache','setRuntimeFeatureCellData','forValue','_calculateRunList','602373maRdhE','_isCyclicUtilMap','CURRENTLY_CALCULATING','getDirtyData','columnCount','_createFDtree','_restDependencyTreeId','_getTreeNode','getChildren','row','parseInt','OTHER_FORMULA','_formulaDependencyGenerator','symbol','_runtimeService','_handleNewFunctionChild','IDLE','markedAsSuccessfullyExecuted','_updateRangeFlatten','dirtyRanges','join','19750370WpAbkw','setCurrent','_getTreeById','_astTreeBuilder','_dependencyManagerService','_lexer','hasOtherFormulaDataMainData','_removeDependencyRTreeCacheById','setCompletedFormulasCount','type','_convertDirtyRangesToUnitRange','setSkip','reset','addFormulaDependency','isExcludeRange','formula','2277072OcfYEy','refOffsetX','featureId','_getFirstCellOfRange','getOtherFormulaDependency','clear','_getUpdateTreeListAndMakeDependency','executeAsync','_allTreeMap','_dependencyRTreeCacheForAddressFunction','_generateNewFunctionString','getOtherFormulaData','setFormulaExecuteStage','_featureFormulaData','_getFeatureFormulaTree','setTotalArrayFormulasToCalculate','searchDependency','getUnitData','_config','getValue','_removeAllTreeMap','getAllRuntimeData','treeId','addOtherFormulaDependency','PLUS','_lambdaFunctionParameterSet','_injector','isDirty','node','MINUS','toUpperCase','_addAllTreeMap','dispose','treeBuilder','2ileWRK','addFeatureFormulaDependency','startRow','column','addOtherFormulaDependencyMainData','defineProperty','CURRENTLY_CALCULATING_ARRAY_FORMULA','has','removeFeatureFormulaDependency','Lambda\x20parameter\x20name\x20\x22','message','closeKdTree','_dependencyTreeCache','_removeDependencyRTreeCache','_checkAddBracketForMinus','removeOtherFormulaDependency','_registerOtherFormulas','ParentDependencyTree\x20object\x20is\x20null','isVirtual','unitId','_currentConfigService','openKdTree','size','_otherFormulaManagerService','push','_otherFormulaDataMainData','_dependencyRTreeCache','getRuntimeState','7715052agEmst','Let\x20variable\x20name\x20\x22','4209356XjvWkq','max','error','endColumn','START_DEPENDENCY_ARRAY_FORMULA','_definedNameMap','setCompletedArrayFormulasCount','\x22\x20is\x20duplicated.','_initLicenseValid','103895zkQbaE','_executionCompleteListener$','clearOtherFormulaDependency','isAdded','removeFormulaDependencyByDefinedName','258RiYatg','formulaId','isForceCalculate','setRuntimeFeatureRange','VALUE','checkAsyncNode','952gqgMhd','START_DEPENDENCY','add','getFormulaDependency','dependencySheetName','_registerFormulas','trim','subUnitId','_hasNewExcelFunction','enableCycleDependency','TKSrFwAS\x20Q6rL4bFwAS(Mwr6SN6,\x20bKVMwr164)\x20{\x20\x20\x20\x20FL4\x20{\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20Mwr6SN6BSTAIRLFeLLR4\x20=\x20Mwr6SN6.NbMwF(\x27-\x27);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20ALwpwSY6NNRp6\x20=\x20kCcm.bRLN6(RFAV(Mwr6SN6BSTAIRLFeLLR4[X]));\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(!ALwpwSY6NNRp6.KQ)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ALwpwSY6NNRp6.KQ\x20=\x20mKaV6L(Mwr6SN6BSTAIRLFeLLR4[W]);\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20wNEALJ6L\x20=\x20F4b6AT\x20EALJ6LjMAVRMCrAb6\x20!==\x20\x27KSQ6TwS6Q\x27\x20&&\x20N6MT\x20wSNFRSr6AT\x20EALJ6LjMAVRMCrAb6;\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20wNiLAUN6L\x20=\x20F4b6AT\x20UwSQAU\x20!==\x20\x27KSQ6TwS6Q\x27\x20&&\x20F4b6AT\x20UwSQAU.MArRFwAS\x20!==\x20\x27KSQ6TwS6Q\x27;\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20rASF6nF\x20=\x20wNEALJ6L\x20?\x20N6MT\x20:\x20(wNiLAUN6L\x20?\x20UwSQAU\x20:\x20pMAVRMx2wN);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20a6NNRp6EALQ\x20=\x20rASF6nF.__iRN6tW__.bRLN6(Mwr6SN6BSTAIRLFeLLR4[X]);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20a6NNRp6\x20=\x20rASF6nF.__06n__.NFLwSpwT4(a6NNRp6EALQ);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20NwpSRFKL6EALQ\x20=\x20rASF6nF.__iRN6tW__.bRLN6(Mwr6SN6BSTAIRLFeLLR4[o]);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20NwpSRFKL6\x20=\x20rASF6nF.__06n__.NFLwSpwT4(NwpSRFKL6EALQ);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20NwpSqRMwQ\x20=\x20rASF6nF.__u6LwT4__(NwpSRFKL6,\x20a6NNRp6,\x20bKVMwr164);\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20QAaRwS\x20=\x20ALwpwSY6NNRp6.Qa;\x20\x20\x20\x20\x20\x20\x20\x20TKSrFwAS\x20wNOAaRwSYRFr2wSp(AIRFF6LS,\x20A0ANF)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20bRFF6LS\x20=\x20AIRFF6LS.L6bMRr6(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x202ANF\x20=\x20A0ANF.L6bMRr6(/^.+/,\x20\x27\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20bRFF6LSIRLFN\x20=\x20bRFF6LS.NbMwF(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x202ANFIRLFN\x20=\x202ANF.NbMwF(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(!bRFF6LS.wSrMKQ6N(\x27*\x27))\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20bRFF6LS\x20===\x202ANF;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(bRFF6LSIRLFN.M6SpF2\x20<\x20X\x20||\x20bRFF6LSIRLFN[v]\x20!==\x20\x27*\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20TRMN6;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20bRFF6LSCKTTwn\x20=\x20bRFF6LSIRLFN.NMwr6(H).ZAwS(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x202ANFCKTTwn\x20=\x202ANFIRLFN.NMwr6(-bRFF6LSIRLFN.M6SpF2\x20+\x20H).ZAwS(\x27.\x27);\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20bRFF6LSCKTTwn\x20===\x202ANFCKTTwn;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20M6F\x20QAaRwSqRMwQ\x20=\x20TRMN6;\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(wNiLAUN6L)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QAaRwSqRMwQ\x20=\x20(QAaRwS\x20&&\x20QAaRwS.M6SpF2)\x20?\x20QAaRwS.NAa6((QaBF6a)\x20=>\x20wNOAaRwSYRFr2wSp(QaBF6a,\x20MArRFwAS.2ANFSRa6))\x20:\x20FLK6;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20wT\x20(MArRFwAS.2ANFSRa6\x20===\x20\x27MArRM2ANF\x27)\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QAaRwSqRMwQ\x20=\x20FLK6;\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20}\x206MN6\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20QAaRwSqRMwQ\x20=\x20FLK6;\x20\x20\x20\x20\x20\x20\x20\x20}\x20\x20\x20\x20\x20\x20\x20\x20rASNF\x20uRMwQ\x20=\x20NwpSqRMwQ\x20&&\x20QAaRwSqRMwQ;\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uRMwQ,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20a6NNRp6:\x20ALwpwSY6NNRp6,\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}\x20rRFr2\x20(6LLAL)\x20{\x20\x20\x20\x20\x20\x20\x20\x20L6FKLS\x20{\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20uRMwQ:\x20TRMN6,\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20a6NNRp6:\x20{},\x20\x20\x20\x20\x20\x20\x20\x20};\x20\x20\x20\x20}}','_configService','markedAsStopFunctionsExecuted','setAdded','_xlfn.','_initializeWithOverride','setValue','_executionInProgressListener$','_traverse','resolve','_formulaData','get','keys','32837EQsQwo','length','COLON','clearArrayObjectCache','setRuntimeOtherData','generate','removeFormulaDependency','rangeList'];_0x37c2=function(){return _0x3e8c78;};return _0x37c2();}V=Le([_0x36d96b(_0x2f7436)],V);export{V as UniverProFormulaEnginePlugin};