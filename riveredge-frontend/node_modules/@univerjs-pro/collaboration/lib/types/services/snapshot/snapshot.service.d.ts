import { DocumentDataModel, IDocumentData, IWorkbookData, Workbook, ICommandService, IResourceManagerService, IUniverInstanceService } from '@univerjs/core';
import { ICopyFileMetaRequest, ICopyFileMetaResponse, IFetchMissingChangesetsRequest, IFetchMissingChangesetsResponse, IGetDeserializedSheetBlockResponse, IGetLatestCsReqIdBySidRequest, IGetLatestCsReqIdBySidResponse, IGetResourcesRequest, IGetResourcesResponse, IGetSheetBlockRequest, IGetSheetBlockResponse, IGetUnitOnRevRequest, IGetUnitOnRevResponse, ISaveChangesetRequest, ISaveChangesetResponse, ISaveSheetBlockRequest, ISaveSheetBlockResponse, ISaveSnapshotRequest, ISaveSnapshotResponse } from '@univerjs/protocol';
import { ILogContext } from '../../utils';
import { CompressMutationService } from '../compress-mutation/compress-mutation-service';
import { RevisionService } from '../rev/rev.service';
/**
 * It provides implementations for server side controllers to load or save
 * or load snapshots. This service should be implemented by the host environment.
 * And it shouldn't contain any business logic.
 */
export declare const ISnapshotServerService: import('@wendellhu/redi').IdentifierDecorator<ISnapshotServerService>;
export interface ISnapshotServerService {
    /** Load snapshot from a database. */
    getUnitOnRev: (context: ILogContext, params: IGetUnitOnRevRequest) => Promise<IGetUnitOnRevResponse>;
    /** Load sheet block from a database. */
    getSheetBlock: (context: ILogContext, params: IGetSheetBlockRequest) => Promise<IGetSheetBlockResponse>;
    getDeserializedSheetBlock: (context: ILogContext, params: IGetSheetBlockRequest) => Promise<IGetDeserializedSheetBlockResponse>;
    /** Fetch missing changeset */
    fetchMissingChangesets: (context: ILogContext, params: IFetchMissingChangesetsRequest) => Promise<IFetchMissingChangesetsResponse>;
    getResourcesRequest: (context: ILogContext, params: IGetResourcesRequest) => Promise<IGetResourcesResponse>;
    /** Save snapshot to a database. */
    saveSnapshot: (context: ILogContext, params: ISaveSnapshotRequest) => Promise<ISaveSnapshotResponse>;
    /** update snapshot to the database. */
    updateSnapshot: (context: ILogContext, params: ISaveSnapshotRequest) => Promise<ISaveSnapshotResponse>;
    /** Save sheet block to a database. */
    saveSheetBlock: (context: ILogContext, params: ISaveSheetBlockRequest) => Promise<ISaveSheetBlockResponse>;
    /** Save changeset to a database. */
    saveChangeset: (context: ILogContext, params: ISaveChangesetRequest) => Promise<ISaveChangesetResponse>;
    copyFileMeta: (context: ILogContext, params: ICopyFileMetaRequest) => Promise<ICopyFileMetaResponse>;
    getLatestCsReqIdBySid: (context: ILogContext, params: IGetLatestCsReqIdBySidRequest) => Promise<IGetLatestCsReqIdBySidResponse>;
}
/**
 * The service provides methods to load snapshots from the snapshot server.
 */
export declare class SnapshotService {
    private readonly _revisionService;
    private readonly _univerInstanceService;
    private readonly _snapshotServerService;
    private readonly _commandService;
    private _compressMutationService;
    private _resourceManagerService;
    constructor(_revisionService: RevisionService, _univerInstanceService: IUniverInstanceService, _snapshotServerService: ISnapshotServerService, _commandService: ICommandService, _compressMutationService: CompressMutationService, _resourceManagerService: IResourceManagerService);
    loadSheet(unitId: string, rev: number, context?: ILogContext): Promise<Workbook>;
    loadDoc(unitID: string, rev: number, context?: ILogContext): Promise<DocumentDataModel>;
    saveSheet(_context: ILogContext, workbook: Workbook): IWorkbookData;
    saveDoc(_context: ILogContext, document: DocumentDataModel): IDocumentData;
}
