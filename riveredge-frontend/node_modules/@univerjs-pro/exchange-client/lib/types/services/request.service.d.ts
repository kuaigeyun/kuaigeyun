import { IDisposable, IConfigService } from '@univerjs/core';
import { IError, UniverType } from '@univerjs/protocol';
import { ISheetBlockJson, ISnapshotJson } from './utils/snapshot';
import { HTTPService } from '@univerjs/network';
export interface IFileUploadResponse {
    FileId: string;
    error: IError;
}
export declare enum ImportOutputType {
    UNDEFINED = 0,
    /** UNIT - Import to univer unit, unit is store in the database */
    UNIT = 1,
    /** JSON - Import and convert to a json file which represents a univer unit, not store in the database */
    JSON = 2,
    UNRECOGNIZED = -1
}
export interface IImportRequest {
    fileID: string;
    type: UniverType;
    outputType: ImportOutputType;
    /** not supported yet */
    fileUrl: string;
    minSheetColumnCount: number;
    minSheetRowCount: number;
}
export interface IImportResponse {
    taskID: string;
    error: IError;
}
export interface IExportRequest {
    /** If unitID is specified, the input is the unit in the database */
    unitID: string;
    /** If jsonID is specified, the input is the json file which represents a univer unit */
    jsonID: string;
    type: UniverType;
    /** If sscSwitch is set to true, server-side formula calculation will be triggered */
    sscSwitch?: boolean;
    /** If useImageUrl is set to true, cell images will not be converted to links on export */
    useImageUrl?: boolean;
    /** If ignoreTableExport is set to true, tables will be ignored on export */
    ignoreTableExport?: boolean;
}
export interface IExportResponse {
    error: IError | undefined;
    taskID: string;
}
export interface IGetTaskResponse {
    error: IError | undefined;
    taskID: string;
    status: string;
    import?: IImportTaskResult | undefined;
    export?: IExportTaskResult | undefined;
}
export interface IImportTaskResult {
    outputType: ImportOutputType;
    unitID: string;
    jsonID: string;
}
export interface IExportTaskResult {
    fileID: string;
    fileUrl: string;
}
export interface ISignUrlResponse {
    error: IError | undefined;
    url: string;
}
export interface IBindingResponse {
    error: IError;
}
export interface ISnapshotJsonResponse {
    snapshot: Partial<ISnapshotJson>;
    sheetBlocks: ISheetBlockJson;
}
export interface IRequestService {
    setTaskInterrupted(taskID: string): void;
    clearTaskInterrupted(): void;
    upload(file: File | string): Promise<IFileUploadResponse | undefined>;
    import(importRequest: IImportRequest): Promise<IImportResponse | undefined>;
    export(exportRequest: IExportRequest): Promise<IExportResponse | undefined>;
    getTask(taskID: string): Promise<IGetTaskResponse | undefined>;
    signUrl(fileID: string): Promise<ISignUrlResponse | undefined>;
    getTextFromUrl(url: string): Promise<string | undefined>;
}
export declare const IRequestService: import('@wendellhu/redi').IdentifierDecorator<IRequestService>;
/**
 * TODO@Dushusir maybe move to ExchangeClientPlugin plugin for reuse
 */
export declare class RequestService implements IRequestService, IDisposable {
    private readonly _configService;
    private readonly _httpService;
    private _taskInterrupted;
    constructor(_configService: IConfigService, _httpService: HTTPService);
    dispose(): void;
    setTaskInterrupted(taskID: string): void;
    clearTaskInterrupted(): void;
    /**
     * upload file to server
     * @param file
     */
    upload(file: File | string, size?: number, flate?: boolean): Promise<IFileUploadResponse | undefined>;
    import(importRequest: IImportRequest): Promise<IImportResponse | undefined>;
    export(exportRequest: IExportRequest): Promise<IExportResponse | undefined>;
    getTask(taskID: string): Promise<IGetTaskResponse | undefined>;
    signUrl(fileID: string): Promise<ISignUrlResponse | undefined>;
    getTextFromUrl(url: string): Promise<string | undefined>;
    private _getUploadFileURL;
    private _getImportURL;
    private _getExportURL;
    private _getTaskURL;
    private _getSignURL;
    private _getMaxPollingTime;
}
