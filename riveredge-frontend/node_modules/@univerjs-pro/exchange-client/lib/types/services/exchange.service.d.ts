import { IDisposable, IDocumentData, IWorkbookData, Disposable, IConfigService } from '@univerjs/core';
import { IError, UniverType } from '@univerjs/protocol';
import { Observable } from 'rxjs';
import { RequestService } from './request.service';
import { HTTPService } from '@univerjs/network';
export declare enum RequestState {
    UPLOAD = 0,
    IMPORT = 1,
    EXPORT = 2,
    GET_TASK = 3,
    SIGN_URL = 4,
    GET_JSON = 5,
    GET_FILE = 6
}
export interface IRequestState {
    error: IError | undefined;
    state: RequestState;
}
export interface IExchangeService {
    requestState$: Observable<IRequestState>;
    /**
     * Import XLSX file to workbook data
     * @param file
     */
    importXLSXToSnapshot(file: File | string): Promise<IWorkbookData | undefined>;
    /**
     * Export XLSX file by unit id
     * @param unitId
     */
    exportXLSXByUnitId(unitId: string): Promise<File | undefined>;
    /**
     * Export XLSX file by workbook data
     * @param snapshot
     * @returns
     */
    exportXLSXBySnapshot(snapshot: IWorkbookData): Promise<File | undefined>;
    /**
     * Import DOCX file to document data
     * @param file
     */
    importDOCXToSnapshot(file: File | string): Promise<IDocumentData | undefined>;
    /**
     * Export DOCX file by unit id
     * @param unitId
     */
    exportDOCXByUnitId(unitId: string): Promise<File | undefined>;
    /**
     * Export DOCX file by document data
     * @param data
     * @returns
     */
    exportDOCXBySnapshot(snapshot: IDocumentData): Promise<File | undefined>;
    /**
     * Import file to unit id
     * @param file
     * @param univerType
     */
    importFileToUnitId(file: File | string, univerType: UniverType): Promise<string | undefined>;
    interruptImportTask(): void;
}
export declare const IExchangeService: import('@wendellhu/redi').IdentifierDecorator<IExchangeService>;
export declare class ExchangeService extends Disposable implements IExchangeService, IDisposable {
    private readonly _configService;
    private readonly _httpService;
    private readonly _requestService;
    private _importTaskId;
    private readonly _requestState$;
    readonly requestState$: Observable<IRequestState>;
    constructor(_configService: IConfigService, _httpService: HTTPService, _requestService: RequestService);
    dispose(): void;
    importDOCXToSnapshot(file: File | string): Promise<IDocumentData | undefined>;
    exportDOCXByUnitId(unitId: string): Promise<File | undefined>;
    exportDOCXBySnapshot(data: IDocumentData): Promise<File | undefined>;
    importXLSXToSnapshot(file: File | string): Promise<IWorkbookData | undefined>;
    exportXLSXByUnitId(unitId: string): Promise<File | undefined>;
    exportXLSXBySnapshot(data: IWorkbookData): Promise<File | undefined>;
    importFileToUnitId(file: File | string, univerType: UniverType): Promise<string | undefined>;
    interruptImportTask(): void;
    private _importToSnapshot;
    /**
     * Export file by snapshot
     * @param snapshot
     * @param univerType
     * @returns
     */
    private _exportBySnapshot;
    private _export;
    private _upload;
    private _import;
    private _signUrl;
    private _getDownloadEndpointURL;
    private _getMinSheetRowCount;
    private _getMinSheetColumnCount;
    private _getEnableServerSideComputing;
    private _getDisableCellImageConversion;
    private _getIgnoreTableExport;
}
