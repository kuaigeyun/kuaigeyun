import { IDisposable, Disposable, ILogService, IUniverInstanceService, LocaleService, UniverInstanceType } from '@univerjs/core';
import { Observable } from 'rxjs';
import { ExchangeService } from './exchange.service';
import { UploadNotificationService } from './upload-notification.service';
import { UniverType } from '@univerjs/protocol';
import { IMessageService } from '@univerjs/ui';
export interface IExchangeOperateService {
    interrupt(): void;
    /**
     * Upload file to server, get unitId and open unit
     * @param file
     */
    importXLSXToUnitId(): Promise<string | undefined>;
    /**
     * Upload xlsx file to server, get snapshot and refresh current sheet
     * @param file
     */
    importXLSXToSnapshot(): Promise<void>;
    /**
     * Export xlsx file by unitId
     * @returns
     */
    exportXLSXByUnitId(unitId?: string, unitName?: string, unitType?: UniverInstanceType): Promise<void>;
    /**
     * Export xlsx file by snapshot
     * @returns
     */
    exportXLSXBySnapshot(): Promise<void>;
    /**
     * Upload file to server, get unitId and open unit
     * @param file
     */
    importDOCXToUnitId(): Promise<string | undefined>;
    /**
     * Upload docx file to server, get snapshot and refresh current doc
     * @param file
     */
    importDOCXToSnapshot(): Promise<void>;
    /**
     * Export docx file by unitId
     * @returns
     */
    exportDOCXByUnitId(unitId?: string, unitName?: string, unitType?: UniverType): Promise<void>;
    /**
     * Export docx file by snapshot
     * @returns
     */
    exportDOCXBySnapshot(): Promise<void>;
    /**
     * Upload file, supports multiple types
     * @param file
     */
    uploadFileToUnitId(types: UniverType[]): Promise<{
        unitId: string;
        type: UniverType;
    } | undefined>;
    /**
     * Customize the imported Unit URL format according to the needs of your own scene
     * @param getLink
     */
    registerLink(getLink: (unitId: string, univerType: UniverInstanceType) => string): void;
    /**
     * Observable of upload progress
     */
    progress$: Observable<IUploadProgress>;
}
export interface IUploadProgress {
    /** Task that already completed. */
    done: number;
    /** The total number of tasks need to execute. */
    count: number;
}
export declare const IExchangeOperateService: import('@wendellhu/redi').IdentifierDecorator<IExchangeOperateService>;
export declare class ExchangeOperateService extends Disposable implements IExchangeOperateService, IDisposable {
    private _univerInstanceService;
    private readonly _messageService;
    private readonly _localeService;
    private readonly _exchangeService;
    private readonly _uploadNotificationService;
    protected readonly _logService: ILogService;
    private readonly _progress$;
    readonly progress$: Observable<IUploadProgress>;
    private _totalUploadTaskCount;
    private _doneUploadTaskCount;
    constructor(_univerInstanceService: IUniverInstanceService, _messageService: IMessageService, _localeService: LocaleService, _exchangeService: ExchangeService, _uploadNotificationService: UploadNotificationService, _logService: ILogService);
    interrupt(): void;
    uploadFileToUnitId(types: UniverType[]): Promise<{
        unitId: string;
        type: UniverType;
    } | undefined>;
    importDOCXToUnitId(): Promise<string | undefined>;
    importDOCXToSnapshot(): Promise<void>;
    exportDOCXByUnitId(unitId?: string, unitName?: string, unitType?: UniverInstanceType): Promise<void>;
    exportDOCXBySnapshot(): Promise<void>;
    importXLSXToUnitId(): Promise<string | undefined>;
    importXLSXToSnapshot(): Promise<void>;
    exportXLSXByUnitId(unitId?: string, unitName?: string, unitType?: UniverInstanceType): Promise<void>;
    exportXLSXBySnapshot(): Promise<void>;
    registerLink(getLink: (unitId: string, univerType: UniverInstanceType) => string): void;
    private _importFileToUnitId;
    private _getUnitID;
    private _getUnitIDDoc;
    private _getUnitName;
    private _getUnitJson;
    private _getUnitDocJson;
    /**
     * Get unit link /?unit={unitId}&type=2
     * @param unitId
     * @param type
     * @returns
     */
    private _getLinkByUnitId;
    private _refresh;
    private _showNetworkError;
    private _showDownloadMessage;
    private _showUploadMessage;
    private _emitProgress;
    private _addTotalCount;
    private _addDoneTask;
    private _completeProgress;
    private _clearProgress;
    /**
     *  Although we have specified the supported file types in advance, users can still switch to select all types of files.
        In order to prevent such unsupported files from being transmitted to the server, they need to be intercepted in advance.
     * @param fileList
     * @param type
     * @returns
     */
    private _fileTypeError;
    private _uploadTaskNotDone;
}
