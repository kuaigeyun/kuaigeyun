import { ILogContext, SnapshotService } from '@univerjs-pro/collaboration';
import { IDisposable, Injector, IUniverInstanceService } from '@univerjs/core';
import { IMember } from '@univerjs/protocol';
import { FWorkbook } from '@univerjs/sheets/facade';
import { CollaborationController, CollaborationStatus } from '@univerjs-pro/collaboration-client';
import { FBase } from '@univerjs/core/facade';
/**
 * The Facade API object for the Collaboration module. It provides methods to interact with the
 * Univer Collaboration backend server, such as loading Univer Sheets and subscribing to collaborators.
 * @hideconstructor
 */
export declare class FCollaboration extends FBase {
    private readonly _handler;
    protected readonly _injector: Injector;
    protected readonly _univerInstanceService: IUniverInstanceService;
    protected readonly _snapshotService: SnapshotService;
    protected readonly _collaborationController: CollaborationController;
    constructor(_handler: {
        getUniverSheet: (id: string) => FWorkbook | null;
    }, _injector: Injector, _univerInstanceService: IUniverInstanceService, _snapshotService: SnapshotService, _collaborationController: CollaborationController);
    /**
     * @returns {Promise<FWorkbook | null>} The {@link FWorkbook} or null if the active Univer Sheet cannot be loaded.
     *
     * @deprecated Use `loadActiveSheetAsync` instead.
     */
    loadActiveSheet(): Promise<FWorkbook | null>;
    /**
     * Load the active Univer Sheet. It should be associated with the Uniscript Node.js Runtime.
     *
     * @returns {Promise<FWorkbook | null>} The {@link FWorkbook} or null if the active Univer Sheet cannot be loaded.
     * @throws {Error} If the method is not overridden.
     *
     * @example
     * ```typescript
     * const collaboration = univerAPI.getCollaboration();
     * const workbook = await collaboration.loadActiveSheetAsync();
     * ```
     */
    loadActiveSheetAsync(): Promise<FWorkbook | null>;
    /**
     * @param {string} unitId The Id of the Univer Sheet that you would like to load.
     * @returns {Promise<FWorkbook | null>} The {@link FWorkbook} or null if the Univer Sheet cannot be loaded.
     *
     * @deprecated Use `loadSheetAsync` instead.
     */
    loadSheet(unitId: string): Promise<FWorkbook | null>;
    /**
     * Load a Univer Sheet from the server with a unit ID.
     *
     * @param {string} unitId ID of the Univer Sheet that you would like to load.
     * @param {ILogContext} [context] Optional context.
     *
     * @returns {Promise<FWorkbook | null>} The {@link FWorkbook} or null if ID cannot be associated with a Univer Sheet.
     *
     * @example
     * ```typescript
     * const collaboration = univerAPI.getCollaboration();
     * const workbook = await collaboration.loadSheetAsync('your-unit-id');
     * ```
     */
    loadSheetAsync(unitId: string, context?: ILogContext): Promise<FWorkbook | null>;
    /**
     * Subscribe collaborators of a Univer file.
     *
     * @param {string} unitId ID of the Univer file.
     * @param {Function} callback A callback function that will be called when the collaborators change.
     * @returns {IDisposable} A handler to dispose the subscription.
     *
     * @example
     * ```typescript
     * const collaboration = univerAPI.getCollaboration();
     * collaboration.subscribeCollaborators('your-unit-id', (members) => {
     *    console.log(members);
     * });
     * ```
     */
    subscribeCollaborators(unitId: string, callback: (members: IMember[]) => void): IDisposable;
    /**
     * Get the synchronization status of the currently focused unit (workbook or document).
     *
     * @returns {CollaborationStatus} The current synchronization status of the focused unit.
     * Returns CollaborationStatus.NOT_COLLAB if no unit is focused or collaboration is not enabled.
     *
     * Possible status values:
     * - `NOT_COLLAB`: Not in collaboration mode
     * - `SYNCED`: All changes are synchronized
     * - `PENDING`: Local changes waiting to be sent
     * - `AWAITING`: Changes sent, waiting for server acknowledgement
     * - `AWAITING_WITH_PENDING`: Awaiting acknowledgement with new local changes
     * - `FETCH_MISS`: Fetching missing changesets from server
     * - `CONFLICT`: Conflict detected and being resolved
     * - `OFFLINE`: Network is offline
     *
     * @example
     * ```typescript
     * const collaboration = univerAPI.getCollaboration();
     * const status = collaboration.getCollaborationStatus();
     *
     * // Check if synchronized
     * if (status === univerAPI.Enum.CollaborationStatus.SYNCED) {
     *   console.log('All changes are synced!');
     * }
     * ```
     */
    getCollaborationStatus(): CollaborationStatus;
}
