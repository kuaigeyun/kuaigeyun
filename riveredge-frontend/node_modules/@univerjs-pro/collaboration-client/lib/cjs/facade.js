'use strict';const _0x72e851=_0x5896;(function(_0xcaf5db,_0x4c947e){const _0x5c39e0=_0x5896,_0x301f50=_0xcaf5db();while(!![]){try{const _0x4829eb=parseInt(_0x5c39e0(0xbc))/0x1+parseInt(_0x5c39e0(0xa9))/0x2*(-parseInt(_0x5c39e0(0xca))/0x3)+-parseInt(_0x5c39e0(0xd2))/0x4+parseInt(_0x5c39e0(0xac))/0x5+parseInt(_0x5c39e0(0xbb))/0x6*(-parseInt(_0x5c39e0(0xc7))/0x7)+parseInt(_0x5c39e0(0xbf))/0x8*(-parseInt(_0x5c39e0(0xae))/0x9)+parseInt(_0x5c39e0(0xbe))/0xa;if(_0x4829eb===_0x4c947e)break;else _0x301f50['push'](_0x301f50['shift']());}catch(_0x58462d){_0x301f50['push'](_0x301f50['shift']());}}}(_0x1b42,0x66e54));function _0x5896(_0x40da2b,_0x33a092){_0x40da2b=_0x40da2b-0xa0;const _0x1b4286=_0x1b42();let _0x5896da=_0x1b4286[_0x40da2b];return _0x5896da;}Object[_0x72e851(0xab)](exports,Symbol[_0x72e851(0xa0)],{'value':'Module'});const i=require('@univerjs-pro/collaboration-client'),l=require('@univerjs/core/facade'),v=require('@univerjs-pro/collaboration'),s=require('@univerjs/core'),b=require('rxjs');function _0x1b42(){const _0x49a615=['switchMap','14121840BjiCyK','16nsbeRt','loadActiveSheet','_handler','loadUnitOfRevision','get','extend','pipe','toDisposable','15953XCXCzl','loadServerUnitOfRevision','DataLoaderService','14961NsDLve','_univerInstanceService','Inject','NOT_COLLAB','FBase','getFocusedUnit','FCollaboration','waitForRoom$','2389008JClpmv','SnapshotService','members$','toStringTag','getOwnPropertyDescriptor','[FCollaboration]:\x20this\x20method\x20should\x20be\x20override.','CollaborationController','loadServerUnit','Injector','IUniverInstanceService','readyForCollab','getCollaboration','74kJdQXB','getUniverSheet','defineProperty','242800vCBfyb','FEnum','1452258FLIunC','_snapshotService','getCollabEntity','state','subscribe','_collaborationController','MemberService','_injector','subscribeCollaborators','status','loadSheetAsync','CollaborationStatus','createInstance','1962vqwxlH','810444oopIMF'];_0x1b42=function(){return _0x49a615;};return _0x1b42();}class h extends l[_0x72e851(0xad)]{get[_0x72e851(0xb9)](){const _0x25d07e=_0x72e851;return i[_0x25d07e(0xb9)];}}l[_0x72e851(0xad)][_0x72e851(0xc4)](h);var d=Object[_0x72e851(0xa1)],S=(_0xac8b3e,_0x45ae4c,_0x320372,_0x1ee8b2)=>{for(var _0xebf614=_0x1ee8b2>0x1?void 0x0:_0x1ee8b2?d(_0x45ae4c,_0x320372):_0x45ae4c,_0x3b1d51=_0xac8b3e['length']-0x1,_0xc3d688;_0x3b1d51>=0x0;_0x3b1d51--)(_0xc3d688=_0xac8b3e[_0x3b1d51])&&(_0xebf614=_0xc3d688(_0xebf614)||_0xebf614);return _0xebf614;},c=(_0x29ecf0,_0x1e29b1)=>(_0x4d5be3,_0x385770)=>_0x1e29b1(_0x4d5be3,_0x385770,_0x29ecf0);exports['FCollaboration']=class extends l[_0x72e851(0xce)]{constructor(_0x1313ea,_0xecd5c1,_0x5887e4,_0x4ba1e3,_0x1e619d){const _0x1c4df7=_0x72e851;super(),this[_0x1c4df7(0xc1)]=_0x1313ea,this['_injector']=_0xecd5c1,this[_0x1c4df7(0xcb)]=_0x5887e4,this[_0x1c4df7(0xaf)]=_0x4ba1e3,this[_0x1c4df7(0xb3)]=_0x1e619d;}async[_0x72e851(0xc0)](){return this['loadActiveSheetAsync']();}async['loadActiveSheetAsync'](){const _0x2a2cb0=_0x72e851;throw new Error(_0x2a2cb0(0xa2));}async['loadSheet'](_0x56bc35){const _0xf6fbfa=_0x72e851;return this[_0xf6fbfa(0xb8)](_0x56bc35);}async[_0x72e851(0xb8)](_0x5e7456,_0x5cb134){const _0x32ada2=_0x72e851;return await this[_0x32ada2(0xaf)]['loadSheet'](_0x5e7456,0x0,_0x5cb134)?(await this[_0x32ada2(0xb3)][_0x32ada2(0xa7)](_0x5e7456),this[_0x32ada2(0xc1)][_0x32ada2(0xaa)](_0x5e7456)):null;}[_0x72e851(0xb6)](_0xa1be51,_0x4f1951){const _0x577fd8=_0x72e851,_0x1725cc=this[_0x577fd8(0xb5)][_0x577fd8(0xc3)](i[_0x577fd8(0xb4)])[_0x577fd8(0xd1)](_0xa1be51)[_0x577fd8(0xc5)](b[_0x577fd8(0xbd)](_0x19b20e=>_0x19b20e[_0x577fd8(0xd4)]))[_0x577fd8(0xb2)](_0x3a2a5b=>_0x4f1951(Array['from'](_0x3a2a5b['values']())));return s[_0x577fd8(0xc6)](_0x1725cc);}['getCollaborationStatus'](){const _0xbc5d07=_0x72e851,_0x39980c=this[_0xbc5d07(0xcb)][_0xbc5d07(0xcf)]();if(!_0x39980c)return i[_0xbc5d07(0xb9)][_0xbc5d07(0xcd)];const _0x40f9aa=this['_collaborationController'][_0xbc5d07(0xb0)](_0x39980c['getUnitId']());return _0x40f9aa?_0x40f9aa[_0xbc5d07(0xb1)][_0xbc5d07(0xb7)]:i[_0xbc5d07(0xb9)]['NOT_COLLAB'];}},exports['FCollaboration']=S([c(0x1,s['Inject'](s[_0x72e851(0xa5)])),c(0x2,s[_0x72e851(0xa6)]),c(0x3,s['Inject'](v[_0x72e851(0xd3)])),c(0x4,s[_0x72e851(0xcc)](i[_0x72e851(0xa3)]))],exports[_0x72e851(0xd0)]);class C extends l['FUniver']{[_0x72e851(0xa8)](){const _0x144edd=_0x72e851;return this[_0x144edd(0xb5)][_0x144edd(0xba)](exports[_0x144edd(0xd0)],{'getUniverSheet':_0x123a06=>this['getUniverSheet'](_0x123a06)});}[_0x72e851(0xa4)](_0x4d2f02,_0x15b460,_0x50891a){const _0x41aa5c=_0x72e851;return this[_0x41aa5c(0xb5)]['get'](i[_0x41aa5c(0xc9)])['loadUnit'](_0x4d2f02,_0x15b460,_0x50891a);}[_0x72e851(0xc8)](_0x30b6f7,_0x1b67ad,_0x2b9768){const _0x99d5fc=_0x72e851;return this['_injector'][_0x99d5fc(0xc3)](i[_0x99d5fc(0xc9)])[_0x99d5fc(0xc2)](_0x30b6f7,_0x1b67ad,_0x2b9768);}}l['FUniver'][_0x72e851(0xc4)](C);