(function(_0x53cbe3,_0x45a409){const _0xd64623=_0x48a1,_0x2e1bb5=_0x53cbe3();while(!![]){try{const _0x2d8638=-parseInt(_0xd64623(0x2b1))/0x1+parseInt(_0xd64623(0x2d6))/0x2*(parseInt(_0xd64623(0x406))/0x3)+parseInt(_0xd64623(0x224))/0x4+parseInt(_0xd64623(0x438))/0x5+-parseInt(_0xd64623(0x399))/0x6*(-parseInt(_0xd64623(0x25f))/0x7)+-parseInt(_0xd64623(0x35a))/0x8+-parseInt(_0xd64623(0x1e5))/0x9;if(_0x2d8638===_0x45a409)break;else _0x2e1bb5['push'](_0x2e1bb5['shift']());}catch(_0x205f14){_0x2e1bb5['push'](_0x2e1bb5['shift']());}}}(_0xe035,0xc0460),function(_0xd4d077,_0x3d21c3){const _0x2c1a53=_0x48a1;typeof exports==_0x2c1a53(0x21e)&&typeof module<'u'?_0x3d21c3(exports,require('react/jsx-runtime'),require('@univerjs-pro/collaboration-client'),require('@univerjs/core'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/design'),require('react'),require('@univerjs/rpc'),require('@univerjs/sheets'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs-pro/collaboration'),require('@univerjs/docs'),require('@univerjs/engine-formula'),require('rxjs/operators'),require('@univerjs/sheets-ui')):typeof define=='function'&&define['amd']?define([_0x2c1a53(0x3d9),_0x2c1a53(0x427),_0x2c1a53(0x2b5),_0x2c1a53(0x256),_0x2c1a53(0x2c4),_0x2c1a53(0x2e9),_0x2c1a53(0x49e),_0x2c1a53(0x202),_0x2c1a53(0x2fe),'@univerjs/sheets',_0x2c1a53(0x281),_0x2c1a53(0x214),_0x2c1a53(0x1e3),_0x2c1a53(0x3b3),_0x2c1a53(0x371),_0x2c1a53(0x439),_0x2c1a53(0x1fe),_0x2c1a53(0x424),_0x2c1a53(0x311)],_0x3d21c3):(_0xd4d077=typeof globalThis<'u'?globalThis:_0xd4d077||self,_0x3d21c3(_0xd4d077[_0x2c1a53(0x27f)]={},_0xd4d077[_0x2c1a53(0x3ed)],_0xd4d077[_0x2c1a53(0x1b5)],_0xd4d077[_0x2c1a53(0x2ca)],_0xd4d077['UniverUi'],_0xd4d077[_0x2c1a53(0x2e9)],_0xd4d077[_0x2c1a53(0x2b2)],_0xd4d077[_0x2c1a53(0x3ed)],_0xd4d077[_0x2c1a53(0x2c0)],_0xd4d077[_0x2c1a53(0x337)],_0xd4d077['UniverEngineRender'],_0xd4d077[_0x2c1a53(0x405)],_0xd4d077[_0x2c1a53(0x2e4)],_0xd4d077[_0x2c1a53(0x3e4)],_0xd4d077[_0x2c1a53(0x213)],_0xd4d077[_0x2c1a53(0x47b)],_0xd4d077['UniverEngineFormula'],_0xd4d077[_0x2c1a53(0x2e9)][_0x2c1a53(0x2f6)],_0xd4d077[_0x2c1a53(0x269)]));}(this,function(_0x44b1a7,_0x89e71e,_0x3fe1f0,_0x39304f,_0x4c3b5c,_0x404575,_0x31598f,_0x13ddda,_0x256d9b,_0x3203ce,_0x46a3bd,_0x4e0fb2,_0x2abae2,_0x389a81,_0x560361,_0x59af06,_0x284237,_0x11a31a,_0x5ee9c5){'use strict';const _0x5de549=_0x48a1;var _0x28f531=Object[_0x5de549(0x412)],_0xeb5bc4=(_0x2733a3,_0x41b2d4,_0x2d1c3c)=>_0x41b2d4 in _0x2733a3?_0x28f531(_0x2733a3,_0x41b2d4,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x2d1c3c}):_0x2733a3[_0x41b2d4]=_0x2d1c3c,_0x41fabe=(_0x5acffd,_0x4ebf5c,_0x312e32)=>_0xeb5bc4(_0x5acffd,typeof _0x4ebf5c!=_0x5de549(0x277)?_0x4ebf5c+'':_0x4ebf5c,_0x312e32);function _0x5a6335({ref:_0x5983e8,..._0x1b53bb}){const _0x490bb7=_0x5de549,{icon:_0x557ba5,id:_0x434f45,className:_0x1be508,extend:_0x52e838,..._0x500606}=_0x1b53bb,_0x54f7a1=(_0x490bb7(0x450)+_0x434f45+'\x20'+(_0x1be508||''))[_0x490bb7(0x27a)](),_0x5e7743=_0x13ddda[_0x490bb7(0x27b)]('_'+_0x3b89e2());return _0x3b00c8(_0x557ba5,''+_0x434f45,{'defIds':_0x557ba5[_0x490bb7(0x417)],'idSuffix':_0x5e7743['current']},{'ref':_0x5983e8,'className':_0x54f7a1,..._0x500606},_0x52e838);}function _0x3b00c8(_0x26274b,_0x290b1c,_0x3c26de,_0x5661d8,_0x397cf7){const _0x5c6126=_0x5de549;return _0x13ddda['createElement'](_0x26274b[_0x5c6126(0x483)],{'key':_0x290b1c,..._0x4f9e0c(_0x26274b,_0x3c26de,_0x397cf7),..._0x5661d8},(_0x120f5f(_0x26274b,_0x3c26de)[_0x5c6126(0x497)]||[])[_0x5c6126(0x309)]((_0x17c1e5,_0x8db2f7)=>_0x3b00c8(_0x17c1e5,_0x290b1c+'-'+_0x26274b[_0x5c6126(0x483)]+'-'+_0x8db2f7,_0x3c26de,void 0x0,_0x397cf7)));}function _0x4f9e0c(_0x4dab37,_0x278bbd,_0x5ea664){const _0xf1e258=_0x5de549,_0x1002ea={..._0x4dab37['attrs']};_0x5ea664!=null&&_0x5ea664[_0xf1e258(0x30c)]&&_0x1002ea[_0xf1e258(0x402)]==='colorChannel1'&&(_0x1002ea[_0xf1e258(0x402)]=_0x5ea664[_0xf1e258(0x30c)]),_0x4dab37[_0xf1e258(0x483)]===_0xf1e258(0x292)&&_0x1002ea['id']&&(_0x1002ea['id']=_0x1002ea['id']+_0x278bbd[_0xf1e258(0x336)]),Object[_0xf1e258(0x400)](_0x1002ea)[_0xf1e258(0x22a)](([_0x53cc8a,_0x35906d])=>{const _0x5a4df8=_0xf1e258;_0x53cc8a===_0x5a4df8(0x292)&&typeof _0x35906d==_0x5a4df8(0x1cd)&&(_0x1002ea[_0x53cc8a]=_0x35906d['replace'](/url\(#(.*)\)/,'url(#$1'+_0x278bbd[_0x5a4df8(0x336)]+')'));});const {defIds:_0xc96725}=_0x278bbd;return!_0xc96725||_0xc96725[_0xf1e258(0x3b7)]===0x0||(_0x4dab37['tag']===_0xf1e258(0x313)&&_0x1002ea[_0xf1e258(0x3e3)]&&(_0x1002ea[_0xf1e258(0x3e3)]=_0x1002ea[_0xf1e258(0x3e3)]+_0x278bbd[_0xf1e258(0x336)]),Object['entries'](_0x1002ea)[_0xf1e258(0x22a)](([_0x372105,_0x8d17f1])=>{const _0x160136=_0xf1e258;typeof _0x8d17f1==_0x160136(0x1cd)&&(_0x1002ea[_0x372105]=_0x8d17f1[_0x160136(0x1dd)](/url\(#(.*)\)/,_0x160136(0x3cb)+_0x278bbd['idSuffix']+')'));})),_0x1002ea;}function _0x120f5f(_0x3ce3c3,_0xd70c4f){const _0x295a7c=_0x5de549;var _0x154b3e;const {defIds:_0x539ae8}=_0xd70c4f;return!_0x539ae8||_0x539ae8['length']===0x0?_0x3ce3c3:_0x3ce3c3[_0x295a7c(0x483)]===_0x295a7c(0x463)&&((_0x154b3e=_0x3ce3c3[_0x295a7c(0x497)])!=null&&_0x154b3e['length'])?{..._0x3ce3c3,'children':_0x3ce3c3[_0x295a7c(0x497)]['map'](_0x2010cc=>typeof _0x2010cc[_0x295a7c(0x454)]['id']==_0x295a7c(0x1cd)&&_0x539ae8&&_0x539ae8[_0x295a7c(0x410)](_0x2010cc[_0x295a7c(0x454)]['id'])?{..._0x2010cc,'attrs':{..._0x2010cc['attrs'],'id':_0x2010cc['attrs']['id']+_0xd70c4f['idSuffix']}}:_0x2010cc)}:_0x3ce3c3;}function _0x3b89e2(){const _0x18975c=_0x5de549;return Math[_0x18975c(0x46c)]()[_0x18975c(0x492)](0x24)[_0x18975c(0x301)](0x2,0x8);}_0x5a6335[_0x5de549(0x3bd)]='UniverIcon';const _0x343eae={'tag':_0x5de549(0x2a1),'attrs':{'xmlns':_0x5de549(0x2a9),'fill':'none','viewBox':_0x5de549(0x31f),'width':_0x5de549(0x2f5),'height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':_0x5de549(0x389)},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'stroke':_0x5de549(0x46a),'d':_0x5de549(0x4a9),'strokeLinecap':_0x5de549(0x3bb),'strokeLinejoin':_0x5de549(0x3bb),'strokeWidth':1.2}}]},{'tag':_0x5de549(0x463),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x5de549(0x3ec)},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'fill':_0x5de549(0x392),'d':_0x5de549(0x375)}}]}]}],'defIds':[_0x5de549(0x3ec)]},_0x2bc78d=_0x13ddda[_0x5de549(0x234)](function(_0x40a036,_0x29d2be){const _0x579388=_0x5de549;return _0x13ddda[_0x579388(0x45e)](_0x5a6335,Object[_0x579388(0x283)]({},_0x40a036,{'id':_0x579388(0x3d3),'ref':_0x29d2be,'icon':_0x343eae}));});_0x2bc78d[_0x5de549(0x3bd)]=_0x5de549(0x2a2);const _0x181b5c={'tag':'svg','attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':'none','viewBox':_0x5de549(0x217),'width':_0x5de549(0x2f5),'height':_0x5de549(0x2f5)},'children':[{'tag':'g','attrs':{'clipPath':_0x5de549(0x233)},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'stroke':_0x5de549(0x46a),'d':_0x5de549(0x232),'strokeLinecap':_0x5de549(0x3bb),'strokeLinejoin':_0x5de549(0x3bb),'strokeWidth':1.2}}]},{'tag':'defs','attrs':{},'children':[{'tag':'clipPath','attrs':{'id':'on-line-icon_clip0_910_349'},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'fill':'white','d':_0x5de549(0x375),'transform':'translate(.97)'}}]}]}],'defIds':['on-line-icon_clip0_910_349']},_0x5c0237=_0x13ddda[_0x5de549(0x234)](function(_0x43c65,_0x42df77){const _0x3e76cb=_0x5de549;return _0x13ddda['createElement'](_0x5a6335,Object[_0x3e76cb(0x283)]({},_0x43c65,{'id':_0x3e76cb(0x478),'ref':_0x42df77,'icon':_0x181b5c}));});_0x5c0237[_0x5de549(0x3bd)]=_0x5de549(0x1e4);function _0x19e725(_0x1d9633){const _0x159eb4=_0x5de549;switch(_0x1d9633){case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x327)]:return _0x159eb4(0x220);case _0x3fe1f0['CollaborationStatus']['CONFLICT']:return _0x159eb4(0x4a0);case _0x3fe1f0['CollaborationStatus'][_0x159eb4(0x2ef)]:return _0x159eb4(0x1fc);case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x475)]:return _0x159eb4(0x2aa);case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x2cd)]:case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x2e2)]:return _0x159eb4(0x216);case _0x3fe1f0['CollaborationStatus'][_0x159eb4(0x2a5)]:case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x363)]:return _0x159eb4(0x276);}}function _0x15d907(_0x511b81){const _0x404306=_0x5de549,{status$:_0x35106c}=_0x511b81,_0x1b1f2d=_0x4c3b5c[_0x404306(0x33c)](_0x35106c,_0x3fe1f0[_0x404306(0x329)][_0x404306(0x475)]),_0x1603f2=_0x4c3b5c[_0x404306(0x3d1)](_0x39304f[_0x404306(0x3f4)]),_0x5e4aad=_0x4c3b5c['useDependency'](_0x3fe1f0['CollaborationSessionService']),_0x1e0d9a=_0x1b1f2d!==_0x3fe1f0['CollaborationStatus'][_0x404306(0x327)],_0x4539da=_0x1603f2['t'](_0x19e725(_0x1b1f2d)),_0x4b059e=_0x1e0d9a?_0x89e71e['jsx'](_0x5c0237,{}):_0x89e71e[_0x404306(0x460)](_0x2bc78d,{}),_0x5d6804=_0x13ddda['useCallback'](()=>{const _0x59beb7=_0x404306;_0x1e0d9a||_0x5e4aad[_0x59beb7(0x1b3)]();},[_0x1e0d9a,_0x5e4aad]);function _0xc6b601(){const _0x3ef2ac=_0x404306;return _0x89e71e[_0x3ef2ac(0x20d)]('div',{'className':_0x3ef2ac(0x2e0),'onClick':_0x5d6804,'children':[_0x89e71e[_0x3ef2ac(0x460)](_0x3ef2ac(0x359),{'className':_0x31598f[_0x3ef2ac(0x409)]('univer-mr-2\x20univer-flex\x20univer-text-xl',{'univer-text-green-500':_0x1e0d9a,'univer-text-red-500':!_0x1e0d9a}),'children':_0x4b059e}),_0x89e71e[_0x3ef2ac(0x460)](_0x3ef2ac(0x359),{'className':_0x3ef2ac(0x489),'children':_0x4539da})]});}return _0x1e0d9a?_0xc6b601():_0x89e71e['jsx'](_0x31598f[_0x404306(0x3d2)],{'title':_0x1603f2['t'](_0x404306(0x268)),'children':_0xc6b601()});}var _0x2782bb=Object[_0x5de549(0x49f)],_0x172f07=(_0x2f8ea9,_0x42f4c9,_0xb09d29,_0x3e3cc2)=>{const _0x17cba1=_0x5de549;for(var _0x5a1a0c=_0x3e3cc2>0x1?void 0x0:_0x3e3cc2?_0x2782bb(_0x42f4c9,_0xb09d29):_0x42f4c9,_0x4d00b7=_0x2f8ea9[_0x17cba1(0x3b7)]-0x1,_0x2ba80b;_0x4d00b7>=0x0;_0x4d00b7--)(_0x2ba80b=_0x2f8ea9[_0x4d00b7])&&(_0x5a1a0c=_0x2ba80b(_0x5a1a0c)||_0x5a1a0c);return _0x5a1a0c;},_0x2ef9d2=(_0x1c68b5,_0x50f188)=>(_0x388ff8,_0x178ce4)=>_0x50f188(_0x388ff8,_0x178ce4,_0x1c68b5);_0x44b1a7['DesktopCollaborationStatusDisplayController']=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x9d4c5e,_0x4e52f0,_0x45af5d,_0x53a7da){const _0x5dd0af=_0x5de549;super(),_0x41fabe(this,_0x5dd0af(0x2e8),new _0x404575[(_0x5dd0af(0x25b))](_0x3fe1f0[_0x5dd0af(0x329)][_0x5dd0af(0x475)])),(this['_univerInstanceService']=_0x9d4c5e,this['_injector']=_0x4e52f0,this[_0x5dd0af(0x1fd)]=_0x45af5d,this[_0x5dd0af(0x30a)]=_0x53a7da,this['_initStatusComponent'](),this[_0x5dd0af(0x1b4)]());}[_0x5de549(0x1b4)](){const _0x2b536a=_0x5de549;this['disposeWithMe'](this[_0x2b536a(0x26e)][_0x2b536a(0x29c)][_0x2b536a(0x498)](_0x404575['switchMap'](()=>{const _0x4e64b3=_0x2b536a,_0x4cdc61=this['_univerInstanceService'][_0x4e64b3(0x3ae)]();return _0x4cdc61?this[_0x4e64b3(0x1fd)][_0x4e64b3(0x3a5)](_0x4cdc61[_0x4e64b3(0x41e)]()):_0x404575['of'](null);}),_0x404575[_0x2b536a(0x287)](_0x2bf472=>_0x2bf472?_0x2bf472[_0x2b536a(0x240)]:_0x404575['of'](_0x3fe1f0[_0x2b536a(0x329)][_0x2b536a(0x475)])))[_0x2b536a(0x38e)](_0x169db7=>{const _0x718656=_0x2b536a;this[_0x718656(0x2e8)][_0x718656(0x345)](_0x169db7);}));}['_initStatusComponent'](){const _0x1445a4=_0x5de549;this['disposeWithMe'](this[_0x1445a4(0x30a)][_0x1445a4(0x40c)](_0x4c3b5c['BuiltInUIPart'][_0x1445a4(0x40d)],()=>_0x4c3b5c[_0x1445a4(0x351)](_0x10ae48({'status$':this[_0x1445a4(0x2e8)]['asObservable']()}),this[_0x1445a4(0x31d)])));}},_0x44b1a7['DesktopCollaborationStatusDisplayController']=_0x172f07([_0x2ef9d2(0x0,_0x39304f[_0x5de549(0x2cc)]),_0x2ef9d2(0x1,_0x39304f[_0x5de549(0x356)](_0x39304f['Injector'])),_0x2ef9d2(0x2,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x28d)])),_0x2ef9d2(0x3,_0x4c3b5c[_0x5de549(0x2e3)])],_0x44b1a7['DesktopCollaborationStatusDisplayController']);function _0x10ae48(_0x337431){const {status$:_0x346179}=_0x337431;return function(){const _0x30f706=_0x48a1;return _0x89e71e[_0x30f706(0x460)](_0x15d907,{'status$':_0x346179});};}const _0x4d8922=_0x39304f[_0x5de549(0x221)](_0x5de549(0x3b6));var _0x57b2b1=Object[_0x5de549(0x49f)],_0x2c13d4=(_0x4713ca,_0x19cb17,_0x3a42ec,_0x4cc95d)=>{const _0x41e5f7=_0x5de549;for(var _0x1fe1ed=_0x4cc95d>0x1?void 0x0:_0x4cc95d?_0x57b2b1(_0x19cb17,_0x3a42ec):_0x19cb17,_0x30dac4=_0x4713ca[_0x41e5f7(0x3b7)]-0x1,_0x5457d8;_0x30dac4>=0x0;_0x30dac4--)(_0x5457d8=_0x4713ca[_0x30dac4])&&(_0x1fe1ed=_0x5457d8(_0x1fe1ed)||_0x1fe1ed);return _0x1fe1ed;},_0x7cdaa=(_0xae5d12,_0x257faf)=>(_0x502f07,_0x34f8c9)=>_0x257faf(_0x502f07,_0x34f8c9,_0xae5d12);_0x44b1a7[_0x5de549(0x315)]=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x491a08,_0x290500,_0x16efd3,_0x5705e6,_0x487e3f){const _0x152e86=_0x5de549;super(),this[_0x152e86(0x321)]=_0x491a08,this[_0x152e86(0x43a)]=_0x290500,this[_0x152e86(0x33e)]=_0x16efd3,this[_0x152e86(0x31c)]=_0x5705e6,_0x487e3f?_0x487e3f==null||_0x487e3f[_0x152e86(0x383)]()[_0x152e86(0x2f8)](()=>this[_0x152e86(0x48f)]()):(this['_logService'][_0x152e86(0x45b)]('[CollaborationDataLoaderController]',_0x152e86(0x24b)),this[_0x152e86(0x48f)]());}async['_init'](){const _0x3029a7=_0x5de549,_0x35fadc=this[_0x3029a7(0x321)]['getParam']('unit'),_0xf4bb82=this[_0x3029a7(0x321)]['getParam']('type'),_0x3cf74d=this[_0x3029a7(0x321)]['getParam']('subunit');if(!_0x35fadc||!_0xf4bb82){this[_0x3029a7(0x43a)]['debug'](_0x3029a7(0x1a6),'No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.');return;}const _0x4b3782=await this[_0x3029a7(0x31c)]['loadUnit'](_0x35fadc,Number(_0xf4bb82),_0x3cf74d);_0x4b3782&&_0x4b3782 instanceof _0x39304f[_0x3029a7(0x2b6)]&&this[_0x3029a7(0x3df)](_0x4b3782);}async[_0x5de549(0x3df)](_0x4133d9){const _0x54b59d=_0x5de549;await this[_0x54b59d(0x456)](_0x4133d9),_0x4133d9[_0x54b59d(0x31a)][_0x54b59d(0x498)](_0x404575[_0x54b59d(0x387)](this[_0x54b59d(0x241)]))[_0x54b59d(0x38e)](_0x28e88e=>{const _0x4efb4c=_0x54b59d;_0x28e88e&&this[_0x4efb4c(0x1a5)](_0x28e88e);}),this[_0x54b59d(0x321)]['urlChange$']['pipe'](_0x404575[_0x54b59d(0x387)](this['dispose$']))['subscribe'](()=>this['_updateSubUnitFromURLParams'](_0x4133d9));}['_updateURLWithCurrentState'](_0x2bdbf7,_0x15645a=!0x1){const _0x314741=_0x5de549,_0x210265=this[_0x314741(0x321)][_0x314741(0x350)](_0x314741(0x28a));_0x2bdbf7[_0x314741(0x308)]()!==_0x210265&&this[_0x314741(0x321)][_0x314741(0x374)]('subunit',_0x2bdbf7['getSheetId'](),_0x15645a);}async[_0x5de549(0x456)](_0x20347b){const _0x37baf1=_0x5de549;var _0x581549;const _0x77f874=this[_0x37baf1(0x321)]['getParam'](_0x37baf1(0x28a));if(!_0x77f874||!_0x20347b[_0x37baf1(0x296)](_0x77f874)){const _0xb2cc7c=_0x20347b[_0x37baf1(0x239)]()[0x0],_0xe42655=_0x20347b[_0x37baf1(0x296)](_0xb2cc7c);if(!_0xe42655)return;this[_0x37baf1(0x1a5)](_0xe42655,!0x0),await this[_0x37baf1(0x33e)][_0x37baf1(0x275)](_0x3203ce[_0x37baf1(0x264)]['id'],{'unitId':_0x20347b[_0x37baf1(0x41e)](),'subUnitId':_0xb2cc7c});return;}((_0x581549=_0x20347b[_0x37baf1(0x2e1)]())==null?void 0x0:_0x581549[_0x37baf1(0x308)]())!==_0x77f874&&await this[_0x37baf1(0x33e)][_0x37baf1(0x275)](_0x3203ce['SetWorksheetActivateCommand']['id'],{'unitId':_0x20347b[_0x37baf1(0x41e)](),'subUnitId':_0x77f874});}},_0x44b1a7[_0x5de549(0x315)]=_0x2c13d4([_0x7cdaa(0x0,_0x4d8922),_0x7cdaa(0x1,_0x39304f['ILogService']),_0x7cdaa(0x2,_0x39304f[_0x5de549(0x3bf)]),_0x7cdaa(0x3,_0x39304f['Inject'](_0x3fe1f0[_0x5de549(0x207)])),_0x7cdaa(0x4,_0x39304f[_0x5de549(0x24c)](_0x256d9b[_0x5de549(0x487)]))],_0x44b1a7[_0x5de549(0x315)]);var _0x3c4fad=Object['getOwnPropertyDescriptor'],_0x2b952c=(_0x648ea9,_0x557039,_0x274d8d,_0x18fb20)=>{const _0x241925=_0x5de549;for(var _0x3182db=_0x18fb20>0x1?void 0x0:_0x18fb20?_0x3c4fad(_0x557039,_0x274d8d):_0x557039,_0x1d0be2=_0x648ea9[_0x241925(0x3b7)]-0x1,_0x4f3e33;_0x1d0be2>=0x0;_0x1d0be2--)(_0x4f3e33=_0x648ea9[_0x1d0be2])&&(_0x3182db=_0x4f3e33(_0x3182db)||_0x3182db);return _0x3182db;},_0x3c0f37=(_0x5a1f75,_0x3916ee)=>(_0x506672,_0x370ffd)=>_0x3916ee(_0x506672,_0x370ffd,_0x5a1f75);let _0x171e0f=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x364fcf,_0x38b9d8){const _0x402ad5=_0x5de549;super(),this['_docClipboardService']=_0x364fcf,this[_0x402ad5(0x473)]=_0x38b9d8,this[_0x402ad5(0x48f)]();}[_0x5de549(0x48f)](){const _0x231316=_0x5de549,_0x1b0d45=this;this[_0x231316(0x24e)](this['_docClipboardService']['addClipboardHook']({'onBeforePasteImage':async _0x48031a=>{const _0x196072=_0x231316,_0x286f51=await _0x1b0d45[_0x196072(0x473)][_0x196072(0x3d8)](_0x48031a);return _0x286f51?{'source':_0x286f51[_0x196072(0x26f)],'imageSourceType':_0x286f51[_0x196072(0x304)]}:null;}}));}};_0x171e0f=_0x2b952c([_0x3c0f37(0x0,_0x2abae2[_0x5de549(0x396)]),_0x3c0f37(0x1,_0x389a81[_0x5de549(0x300)])],_0x171e0f);const _0x184156=[_0x5de549(0x23b),_0x5de549(0x480),'green.600','red.300',_0x5de549(0x420),_0x5de549(0x481)];class _0x34f587 extends _0x39304f[_0x5de549(0x1ba)]{constructor(){const _0x393454=_0x5de549;super(...arguments),_0x41fabe(this,_0x393454(0x3a8),new Map()),_0x41fabe(this,_0x393454(0x2c2),0x0);}[_0x5de549(0x21f)](_0x1f22d0){const _0xfed589=_0x5de549;if(this[_0xfed589(0x3a8)][_0xfed589(0x3f7)](_0x1f22d0))return this['_assignedColors'][_0xfed589(0x1c0)](_0x1f22d0);const _0x91c12b=_0x184156[this['_colorIndex']];return this[_0xfed589(0x2c2)]=(this[_0xfed589(0x2c2)]+0x1)%_0x184156['length'],this[_0xfed589(0x3a8)][_0xfed589(0x361)](_0x1f22d0,_0x91c12b),_0x91c12b;}}function _0x439a24(_0x259630){const _0x4da925=_0x5de549;let _0x3daa07='';for(const _0x436e67 of _0x259630){const {startOffset:_0x4652c5,endOffset:_0x2f99d4,isActive:_0x252a20,rangeType:_0x5c65c8,segmentId:_0x36eab7,segmentPage:_0x55d4e3}=_0x436e67;_0x3daa07[_0x4da925(0x3b7)]&&(_0x3daa07+=','),_0x3daa07+=_0x4652c5+':'+_0x2f99d4+':'+(_0x252a20?'1':'0')+':'+_0x5c65c8+':'+_0x36eab7+':'+_0x55d4e3;}return _0x3daa07;}function _0x170153(_0x1644a8){const _0x25a4cd=_0x5de549,_0x363718=_0x1644a8[_0x25a4cd(0x46f)](','),_0x19f8b6=[];for(const _0x327288 of _0x363718){const [_0x468207,_0x7a3396,_0x20faf0,_0x4c8c1c,_0x220a71,_0x4e214c]=_0x327288[_0x25a4cd(0x46f)](':');_0x19f8b6[_0x25a4cd(0x44d)]({'startOffset':Number(_0x468207),'endOffset':Number(_0x7a3396),'collapsed':_0x468207===_0x7a3396,'isActive':_0x20faf0==='1','rangeType':_0x4c8c1c===_0x39304f[_0x25a4cd(0x431)][_0x25a4cd(0x49a)]?_0x39304f[_0x25a4cd(0x431)][_0x25a4cd(0x49a)]:_0x39304f[_0x25a4cd(0x431)][_0x25a4cd(0x1b1)],'segmentId':typeof _0x220a71==_0x25a4cd(0x1cd)?String(_0x220a71):'','segmentPage':Number(_0x4e214c!=null?_0x4e214c:-0x1)});}return _0x19f8b6[_0x25a4cd(0x34f)](_0x36fd55=>_0x36fd55[_0x25a4cd(0x453)])||(_0x19f8b6[0x0][_0x25a4cd(0x453)]=!0x0),_0x19f8b6;}class _0x4c3a54 extends _0x39304f[_0x5de549(0x423)]{constructor(){const _0x818271=_0x5de549;super(...arguments),_0x41fabe(this,_0x818271(0x486),new _0x404575['BehaviorSubject'](null)),_0x41fabe(this,_0x818271(0x2c1),this[_0x818271(0x486)][_0x818271(0x2a6)]());}[_0x5de549(0x3e0)](_0x4487cb){const _0x20cda3=_0x5de549,{unitID:_0x1776b4,memberID:_0x419375,textRanges:_0x2c24ce}=_0x4487cb,_0x4c0a75=_0x439a24(_0x2c24ce);if(_0x4c0a75==='')return;const _0x2851ab={'unitID':_0x1776b4,'memberID':_0x419375,'selection':_0x4c0a75};this['_collabCursorState$'][_0x20cda3(0x345)](_0x2851ab);}}var _0x4b039e=Object[_0x5de549(0x49f)],_0x2b4f16=(_0x1ee426,_0x343cde,_0x51c387,_0x4a3382)=>{for(var _0x2f4148=_0x4a3382>0x1?void 0x0:_0x4a3382?_0x4b039e(_0x343cde,_0x51c387):_0x343cde,_0x2057a0=_0x1ee426['length']-0x1,_0x5ab883;_0x2057a0>=0x0;_0x2057a0--)(_0x5ab883=_0x1ee426[_0x2057a0])&&(_0x2f4148=_0x5ab883(_0x2f4148)||_0x2f4148);return _0x2f4148;},_0x25a220=(_0x4229ee,_0x3dd898)=>(_0x4a4d69,_0x18e7e8)=>_0x3dd898(_0x4a4d69,_0x18e7e8,_0x4229ee);const _0x50d76f=0x12c,_0x579577=0x64;let _0x427717=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x5cc96f,_0x511f38,_0x3c7219,_0x4ebb82,_0x2ed724,_0x5a3b98,_0x4f25d1,_0x257482,_0x2c5807){const _0x5dc9b2=_0x5de549;super(),_0x41fabe(this,_0x5dc9b2(0x1b7),!0x1),_0x41fabe(this,'_init',!0x1),_0x41fabe(this,_0x5dc9b2(0x35f),new _0x404575['BehaviorSubject'](new Map())),_0x41fabe(this,_0x5dc9b2(0x2af),this[_0x5dc9b2(0x35f)]['asObservable']()),_0x41fabe(this,'_roomMembers$',new _0x404575['BehaviorSubject']([])),_0x41fabe(this,_0x5dc9b2(0x35e),this[_0x5dc9b2(0x376)][_0x5dc9b2(0x498)](_0x404575['debounceTime'](_0x50d76f))),_0x41fabe(this,_0x5dc9b2(0x1dc),_0x39304f[_0x5dc9b2(0x484)](_0x9b4cd6=>{const _0xdb5b0e=_0x5dc9b2,_0x123dd5={'eventID':_0x560361[_0xdb5b0e(0x1da)]['UPDATE_CURSOR'],'data':{'unitID':this['unitID'],'memberID':this['_session'][_0xdb5b0e(0x1af)](),'selection':_0x439a24(_0x9b4cd6)}};this['_session'][_0xdb5b0e(0x200)](_0x123dd5,this['unitID']);},_0x579577)),(this[_0x5dc9b2(0x42f)]=_0x5cc96f,this[_0x5dc9b2(0x422)]=_0x511f38,this[_0x5dc9b2(0x31d)]=_0x3c7219,this[_0x5dc9b2(0x1c7)]=_0x4ebb82,this[_0x5dc9b2(0x413)]=_0x2ed724,this[_0x5dc9b2(0x45a)]=_0x5a3b98,this[_0x5dc9b2(0x403)]=_0x4f25d1,this['_univerInstanceService']=_0x257482,this[_0x5dc9b2(0x33e)]=_0x2c5807);}get[_0x5de549(0x3d7)](){const _0x6b97ed=_0x5de549;return this['_cursorInfo$'][_0x6b97ed(0x3fc)]();}get[_0x5de549(0x2a8)](){const _0x228bd5=_0x5de549;return this[_0x228bd5(0x376)]['getValue']();}['dispose'](){const _0x358f2f=_0x5de549;super[_0x358f2f(0x2c3)](),this[_0x358f2f(0x35f)][_0x358f2f(0x345)](new Map()),this['_cursorInfo$']['complete'](),this[_0x358f2f(0x376)]['next']([]),this[_0x358f2f(0x376)][_0x358f2f(0x2d4)]();}[_0x5de549(0x482)](){const _0x5f2253=_0x5de549;this[_0x5f2253(0x48f)]||(this[_0x5f2253(0x48f)]=!0x0,this['_session'][_0x5f2253(0x34c)]['pipe'](_0x404575[_0x5f2253(0x387)](this['dispose$']))[_0x5f2253(0x38e)](_0x10ba68=>{const _0xdd6168=_0x5f2253;_0x10ba68===_0x3fe1f0[_0xdd6168(0x434)]['ONLINE']?this[_0xdd6168(0x34e)]():this['_toggleOffline']();}),this[_0x5f2253(0x422)]['event$']['pipe'](_0x404575[_0x5f2253(0x387)](this[_0x5f2253(0x241)]))[_0x5f2253(0x38e)](_0x354de2=>{const _0x4fc56c=_0x5f2253,_0xdfa53=_0x354de2[_0x4fc56c(0x3f2)];_0xdfa53===_0x560361[_0x4fc56c(0x1da)][_0x4fc56c(0x2db)]&&this['_onCursorUpdate'](_0x354de2),_0xdfa53===_0x560361[_0x4fc56c(0x1da)][_0x4fc56c(0x4a5)]&&this[_0x4fc56c(0x346)](_0x354de2);}),this['disposeWithMe'](this[_0x5f2253(0x33e)]['onCommandExecuted'](_0x293813=>{const _0x2b5a7f=_0x5f2253,_0x4fc6b1=_0x293813[_0x2b5a7f(0x448)];_0x4fc6b1!=null&&this[_0x2b5a7f(0x1b7)]&&_0x293813['id']===_0x59af06[_0x2b5a7f(0x488)]['id']&&_0x4fc6b1[_0x2b5a7f(0x2fb)]===this[_0x2b5a7f(0x42f)]&&_0x4fc6b1[_0x2b5a7f(0x2f1)]===!0x1&&_0x4fc6b1[_0x2b5a7f(0x3a0)][_0x2b5a7f(0x3b7)]>0x0&&this[_0x2b5a7f(0x1dc)](_0x4fc6b1['ranges']);})),this[_0x5f2253(0x45a)][_0x5f2253(0x2c1)][_0x5f2253(0x498)](_0x404575[_0x5f2253(0x387)](this['dispose$']))['subscribe'](_0x10bf48=>{const _0x4fad2e=_0x5f2253;if((_0x10bf48==null?void 0x0:_0x10bf48[_0x4fad2e(0x42f)])!==this[_0x4fad2e(0x42f)])return;const _0x1599b2={'eventID':_0x560361[_0x4fad2e(0x1da)][_0x4fad2e(0x2db)],'data':_0x10bf48};this[_0x4fad2e(0x44b)](_0x1599b2);}),this['disposeWithMe'](this[_0x5f2253(0x33e)][_0x5f2253(0x2fd)](_0x52ddde=>{const _0x4ed14b=_0x5f2253;if(_0x52ddde[_0x4ed14b(0x448)]==null)return;const _0x1cd317=_0x52ddde[_0x4ed14b(0x448)];if(_0x52ddde['id']!==_0x59af06[_0x4ed14b(0x2f4)]['id']||_0x1cd317[_0x4ed14b(0x2fb)]!==this['unitID'])return;const _0x52a4a0={'id':'doc.mutation.rich-text-editing','params':_0x1cd317},_0x305405=this[_0x4ed14b(0x3d7)];for(const [_0x141407,_0x4d98b9]of _0x305405){const _0x2a9b3e={'id':'doc.mutation.rich-text-editing','params':{'unitId':this[_0x4ed14b(0x42f)],'actions':null,'textRanges':_0x4d98b9[_0x4ed14b(0x3a0)]}},_0x8bc51a=this[_0x4ed14b(0x403)]['transformMutation'](_0x52a4a0,_0x2a9b3e,!0x1);if(_0x560361['isTransformMutationFailure'](_0x8bc51a))throw _0x8bc51a[_0x4ed14b(0x2ee)];_0x305405['set'](_0x141407,{..._0x4d98b9,'ranges':_0x8bc51a[_0x4ed14b(0x1e0)][_0x4ed14b(0x448)]['textRanges']});}queueMicrotask(()=>{const _0x5ab3df=_0x4ed14b;this[_0x5ab3df(0x35f)]['next'](_0x305405);});})));}[_0x5de549(0x44b)](_0x13ee69){const _0x46ee3e=_0x5de549;var _0x33b71b,_0x1086ed;const {memberID:_0x518804,selection:_0x282b69}=_0x13ee69[_0x46ee3e(0x298)],_0x11c1d0=_0x170153(_0x282b69),_0x6bc7fd=(_0x1086ed=(_0x33b71b=this[_0x46ee3e(0x413)][_0x46ee3e(0x1de)](this[_0x46ee3e(0x42f)],_0x518804))==null?void 0x0:_0x33b71b[_0x46ee3e(0x231)])!=null?_0x1086ed:_0x46ee3e(0x490),_0x48f595={'color':this[_0x46ee3e(0x1c7)][_0x46ee3e(0x21f)](_0x518804),'name':_0x6bc7fd,'ranges':_0x11c1d0},_0x4ec7c4=this['cursorInfo'];_0x4ec7c4['set'](_0x518804,_0x48f595),this[_0x46ee3e(0x35f)][_0x46ee3e(0x345)](_0x4ec7c4);}[_0x5de549(0x346)](_0x57b3f9){const _0x2caa1e=_0x5de549,{memberID:_0x3d29e7}=_0x57b3f9[_0x2caa1e(0x298)],_0x2a72f6=this['cursorInfo'];_0x2a72f6[_0x2caa1e(0x421)](_0x3d29e7),this[_0x2caa1e(0x35f)][_0x2caa1e(0x345)](_0x2a72f6);}[_0x5de549(0x34e)](){const _0x23935e=_0x5de549;var _0x3c9e8b;if(this[_0x23935e(0x1b7)]=!0x0,((_0x3c9e8b=this[_0x23935e(0x26e)]['getFocusedUnit']())==null?void 0x0:_0x3c9e8b[_0x23935e(0x41e)]())!==this[_0x23935e(0x42f)])return;const _0x237f6a=this[_0x23935e(0x31d)][_0x23935e(0x1c0)](_0x59af06[_0x23935e(0x20c)])[_0x23935e(0x1e6)]();Array['isArray'](_0x237f6a)&&_0x237f6a[_0x23935e(0x3b7)]>0x0&&this['_updateLocalCursor'](_0x237f6a);}[_0x5de549(0x430)](){const _0x586f10=_0x5de549;this[_0x586f10(0x1b7)]=!0x1;}};_0x427717=_0x2b4f16([_0x25a220(0x2,_0x39304f[_0x5de549(0x356)](_0x39304f['Injector'])),_0x25a220(0x3,_0x39304f[_0x5de549(0x356)](_0x34f587)),_0x25a220(0x4,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x3f5)])),_0x25a220(0x5,_0x39304f[_0x5de549(0x356)](_0x4c3a54)),_0x25a220(0x6,_0x560361[_0x5de549(0x37e)]),_0x25a220(0x7,_0x39304f[_0x5de549(0x2cc)]),_0x25a220(0x8,_0x39304f['ICommandService'])],_0x427717);var _0x3c3f72=Object[_0x5de549(0x49f)],_0x3089b1=(_0x165894,_0x5cb4e1,_0x550b38,_0x440fb6)=>{const _0x20d186=_0x5de549;for(var _0x366366=_0x440fb6>0x1?void 0x0:_0x440fb6?_0x3c3f72(_0x5cb4e1,_0x550b38):_0x5cb4e1,_0x3530f7=_0x165894[_0x20d186(0x3b7)]-0x1,_0x4b461a;_0x3530f7>=0x0;_0x3530f7--)(_0x4b461a=_0x165894[_0x3530f7])&&(_0x366366=_0x4b461a(_0x366366)||_0x366366);return _0x366366;},_0x14e2e0=(_0xa840ba,_0x65aa15)=>(_0x1a3988,_0x30cbeb)=>_0x65aa15(_0x1a3988,_0x30cbeb,_0xa840ba);const _0x4cbb03=0x12c,_0x124466=0x64,_0x354494=()=>{let _0x22fd9e=[],_0x3c1eed=!0x1;return _0x27656e=>{const _0x5ccbec=_0x48a1;_0x22fd9e[_0x5ccbec(0x44d)](_0x27656e),_0x3c1eed||(_0x3c1eed=!0x0,setTimeout(()=>{_0x22fd9e['forEach'](_0x4915fe=>_0x4915fe()),_0x22fd9e=[],_0x3c1eed=!0x1;}));};};let _0x171417=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x3de082,_0x4bdd02,_0x2ae341,_0x1d6fbf,_0x3a24c3,_0x4add8c,_0x44f8df,_0x3fc5df){const _0x37772f=_0x5de549;super(),_0x41fabe(this,_0x37772f(0x1b7),!0x1),_0x41fabe(this,_0x37772f(0x48f),!0x1),_0x41fabe(this,_0x37772f(0x35f),new _0x404575['BehaviorSubject'](new Map())),_0x41fabe(this,_0x37772f(0x2af),this[_0x37772f(0x35f)][_0x37772f(0x2a6)]()),_0x41fabe(this,_0x37772f(0x376),new _0x404575[(_0x37772f(0x25b))]([])),_0x41fabe(this,_0x37772f(0x35e),this[_0x37772f(0x376)][_0x37772f(0x498)](_0x404575[_0x37772f(0x247)](_0x4cbb03))),_0x41fabe(this,_0x37772f(0x1dc),_0x39304f['debounce']((_0x48d9a3,_0x5c3fa9)=>{const _0x30aca0=_0x37772f,_0x15a49c={'eventID':_0x560361[_0x30aca0(0x1da)][_0x30aca0(0x2db)],'data':{'unitID':this['unitID'],'memberID':this[_0x30aca0(0x422)][_0x30aca0(0x1af)](),'selection':_0x284237['serializeRangeWithSheet'](_0x48d9a3,_0x5c3fa9[_0x30aca0(0x1f6)])}};this['_session']['send'](_0x15a49c,this[_0x30aca0(0x42f)]);},_0x124466)),(this[_0x37772f(0x42f)]=_0x3de082,this[_0x37772f(0x422)]=_0x4bdd02,this[_0x37772f(0x31d)]=_0x2ae341,this['_colorAssignService']=_0x1d6fbf,this[_0x37772f(0x413)]=_0x3a24c3,this[_0x37772f(0x26e)]=_0x4add8c,this['_commandService']=_0x44f8df,this['_refRangeService']=_0x3fc5df);}get['cursorInfo'](){return this['_cursorInfo$']['getValue']();}get[_0x5de549(0x2a8)](){const _0x45e3fb=_0x5de549;return this[_0x45e3fb(0x376)][_0x45e3fb(0x3fc)]();}['dispose'](){const _0x170e98=_0x5de549;super[_0x170e98(0x2c3)](),this['_cursorInfo$'][_0x170e98(0x345)](new Map()),this[_0x170e98(0x35f)][_0x170e98(0x2d4)](),this[_0x170e98(0x376)]['next']([]),this[_0x170e98(0x376)]['complete']();}[_0x5de549(0x482)](){const _0x790dae=_0x5de549;this[_0x790dae(0x48f)]||(this[_0x790dae(0x48f)]=!0x0,this['_session'][_0x790dae(0x34c)]['pipe'](_0x404575[_0x790dae(0x387)](this['dispose$']))[_0x790dae(0x38e)](_0x5e6b69=>{const _0x441bd0=_0x790dae;_0x5e6b69===_0x3fe1f0['SessionStatus'][_0x441bd0(0x43d)]?this[_0x441bd0(0x34e)]():this[_0x441bd0(0x430)]();}),this['_session'][_0x790dae(0x2dc)][_0x790dae(0x498)](_0x404575['takeUntil'](this[_0x790dae(0x241)]))['subscribe'](_0x52659c=>{const _0x39973e=_0x790dae,_0x113811=_0x52659c[_0x39973e(0x3f2)];_0x113811===_0x560361[_0x39973e(0x1da)][_0x39973e(0x2db)]&&this[_0x39973e(0x44b)](_0x52659c),_0x113811===_0x560361[_0x39973e(0x1da)][_0x39973e(0x4a5)]&&this[_0x39973e(0x346)](_0x52659c);}),this[_0x790dae(0x2be)](),this[_0x790dae(0x24e)](this[_0x790dae(0x33e)][_0x790dae(0x2fd)](_0x2eded9=>{const _0x4734c0=_0x790dae;if(this[_0x4734c0(0x1b7)]&&_0x2eded9['id']===_0x3203ce[_0x4734c0(0x33b)]['id']&&_0x2eded9['params'][_0x4734c0(0x2fb)]===this['unitID']){const _0x50941a=_0x2eded9[_0x4734c0(0x448)];this[_0x4734c0(0x1dc)](_0x50941a[_0x4734c0(0x330)],_0x50941a[_0x4734c0(0x380)][0x0]);}})));}[_0x5de549(0x44b)](_0x4858de){const _0x55d2aa=_0x5de549;var _0x19c5f8,_0x27c86f;const {memberID:_0x3b3776,selection:_0x592f19}=_0x4858de['data'],{sheetName:_0x5a0a11,range:_0x5eedff}=_0x284237['deserializeRangeWithSheet'](_0x592f19),_0x5ce1a6={'name':(_0x27c86f=(_0x19c5f8=this[_0x55d2aa(0x413)][_0x55d2aa(0x1de)](this[_0x55d2aa(0x42f)],_0x3b3776))==null?void 0x0:_0x19c5f8[_0x55d2aa(0x231)])!=null?_0x27c86f:_0x55d2aa(0x490),'range':this[_0x55d2aa(0x1e1)](_0x5a0a11,_0x5eedff),'sheetID':_0x5a0a11,'color':this[_0x55d2aa(0x1c7)]['assignAColorForMemberID'](_0x3b3776),'selection':_0x592f19},_0x34d223=this[_0x55d2aa(0x3d7)];_0x34d223[_0x55d2aa(0x361)](_0x3b3776,_0x5ce1a6),this[_0x55d2aa(0x35f)]['next'](_0x34d223);}[_0x5de549(0x346)](_0x22ae81){const _0x4cf9d2=_0x5de549,{memberID:_0x595391}=_0x22ae81['data'],_0x42369a=this[_0x4cf9d2(0x3d7)];_0x42369a[_0x4cf9d2(0x421)](_0x595391),this[_0x4cf9d2(0x35f)][_0x4cf9d2(0x345)](_0x42369a);}[_0x5de549(0x1e1)](_0x2f9462,_0x2f0632){const _0xdb392a=_0x5de549;var _0x37c4e9,_0x4ecb91;const _0x4bf17c=(_0x4ecb91=(_0x37c4e9=this['_univerInstanceService'][_0xdb392a(0x2b9)](this['unitID']))==null?void 0x0:_0x37c4e9[_0xdb392a(0x296)](_0x2f9462))==null?void 0x0:_0x4ecb91[_0xdb392a(0x3ba)]();return(_0x4bf17c==null?void 0x0:_0x4bf17c['find'](_0x25a92e=>_0x39304f['Rectangle'][_0xdb392a(0x44a)](_0x25a92e,_0x2f0632)))||_0x2f0632;}[_0x5de549(0x2be)](){const _0x4df4a1=_0x5de549,_0x4f9aae=new _0x39304f[(_0x4df4a1(0x325))](),_0x46bf14=_0x354494(),_0x5b52bf=()=>{const _0x3d0ae0=_0x4df4a1;_0x4f9aae[_0x3d0ae0(0x2c3)]();const _0x39e3c8=(_0x6650e8,_0x32690d,_0x445c19,_0xe3c6ef)=>{const _0x235348=_0x3d0ae0;let _0x599a7b=[];switch(_0x6650e8['id']){case _0x3203ce[_0x235348(0x2f7)]['DeleteRangeMoveLeftCommandId']:{_0x599a7b=_0x3203ce[_0x235348(0x20a)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x1ad)]:{_0x599a7b=_0x3203ce[_0x235348(0x3ee)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x419)]:{_0x599a7b=_0x3203ce[_0x235348(0x27d)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x255)]:{_0x599a7b=_0x3203ce['handleInsertRangeMoveDown'](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x37a)]:{_0x599a7b=_0x3203ce[_0x235348(0x291)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce['EffectRefRangId']['InsertRowCommandId']:{_0x599a7b=_0x3203ce[_0x235348(0x1cb)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x40e)]:{_0x599a7b=_0x3203ce[_0x235348(0x1c9)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x29b)]:{_0x599a7b=_0x3203ce[_0x235348(0x2b3)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x251)]:{_0x599a7b=_0x3203ce[_0x235348(0x3d5)](_0x6650e8,_0xe3c6ef);break;}}const _0x589d86=_0x3203ce['runRefRangeMutations'](_0x599a7b,_0xe3c6ef),_0x4ec50e=this['cursorInfo']['get'](_0x32690d);if(_0x4ec50e&&_0x589d86){const _0x49182b={..._0x4ec50e,'range':_0x589d86};this[_0x235348(0x3d7)]['set'](_0x32690d,_0x49182b),_0x46bf14(()=>{const _0x17d8d1=_0x235348,_0x232a68=this[_0x17d8d1(0x432)][_0x17d8d1(0x219)](_0x589d86,_0x482d1d=>(_0x232a68[_0x17d8d1(0x2c3)](),_0x39e3c8(_0x482d1d,_0x32690d,_0x445c19,_0x589d86)));_0x4f9aae[_0x17d8d1(0x26c)](_0x232a68);});}return{'redos':[],'undos':[]};};this[_0x3d0ae0(0x3d7)][_0x3d0ae0(0x22a)]((_0x35e273,_0x3172bd)=>{const _0x10e45c=_0x3d0ae0,{range:_0x2ddd06,sheetID:_0x1fe7fb}=_0x35e273,_0x33136=this['_refRangeService'][_0x10e45c(0x219)](_0x2ddd06,_0x39bfb2=>(_0x33136['dispose'](),_0x39e3c8(_0x39bfb2,_0x3172bd,_0x1fe7fb,_0x2ddd06)));_0x4f9aae[_0x10e45c(0x26c)](_0x33136);});};this[_0x4df4a1(0x24e)](_0x39304f['toDisposable'](this['_cursorInfo$'][_0x4df4a1(0x38e)](()=>{_0x5b52bf();})));}[_0x5de549(0x34e)](){const _0x1e1ef5=_0x5de549;var _0x4c4330,_0x594a62;if(this[_0x1e1ef5(0x1b7)]=!0x0,((_0x4c4330=this[_0x1e1ef5(0x26e)][_0x1e1ef5(0x3ae)]())==null?void 0x0:_0x4c4330['getUnitId']())!==this[_0x1e1ef5(0x42f)])return;const _0x5920b4=(_0x594a62=this[_0x1e1ef5(0x31d)][_0x1e1ef5(0x1c0)](_0x3203ce[_0x1e1ef5(0x204)])[_0x1e1ef5(0x2f9)]())==null?void 0x0:_0x594a62[0x0],_0x31d54c=this['_univerInstanceService']['getCurrentUnitForType'](_0x39304f[_0x1e1ef5(0x1cf)][_0x1e1ef5(0x211)])['getActiveSheet']();_0x5920b4&&_0x31d54c&&this[_0x1e1ef5(0x1dc)](_0x31d54c[_0x1e1ef5(0x308)](),_0x5920b4);}['_toggleOffline'](){this['_online']=!0x1;}};_0x171417=_0x3089b1([_0x14e2e0(0x2,_0x39304f['Inject'](_0x39304f[_0x5de549(0x2bd)])),_0x14e2e0(0x3,_0x39304f[_0x5de549(0x356)](_0x34f587)),_0x14e2e0(0x4,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x3f5)])),_0x14e2e0(0x5,_0x39304f[_0x5de549(0x2cc)]),_0x14e2e0(0x6,_0x39304f['ICommandService']),_0x14e2e0(0x7,_0x39304f[_0x5de549(0x356)](_0x3203ce[_0x5de549(0x228)]))],_0x171417);var _0x36f971=Object[_0x5de549(0x49f)],_0x4edad9=(_0x459c25,_0x57f159,_0x2faa0f,_0x28faa4)=>{const _0x558189=_0x5de549;for(var _0x579b87=_0x28faa4>0x1?void 0x0:_0x28faa4?_0x36f971(_0x57f159,_0x2faa0f):_0x57f159,_0x3a244a=_0x459c25[_0x558189(0x3b7)]-0x1,_0x2910cc;_0x3a244a>=0x0;_0x3a244a--)(_0x2910cc=_0x459c25[_0x3a244a])&&(_0x579b87=_0x2910cc(_0x579b87)||_0x579b87);return _0x579b87;},_0xc50099=(_0x51fe5a,_0x276257)=>(_0x245ce3,_0x474b71)=>_0x276257(_0x245ce3,_0x474b71,_0x51fe5a);let _0x1af4cc=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x156319,_0x33db77,_0x5a5d4f){const _0x23dff5=_0x5de549;super(),_0x41fabe(this,_0x23dff5(0x360),new Map()),_0x41fabe(this,_0x23dff5(0x3e7),new _0x404575['Subject']()),(this[_0x23dff5(0x26e)]=_0x156319,this['_injector']=_0x33db77,this[_0x23dff5(0x24f)]=_0x5a5d4f,this[_0x23dff5(0x48f)]());}['dispose'](){const _0x323840=_0x5de549;super[_0x323840(0x2c3)](),this['_entityInit$'][_0x323840(0x2d4)](),this[_0x323840(0x360)][_0x323840(0x22a)](_0x33a849=>_0x33a849['dispose']());}[_0x5de549(0x3eb)](_0x2370e8){const _0x43b04a=_0x5de549;return this[_0x43b04a(0x360)][_0x43b04a(0x3f7)](_0x2370e8)?this[_0x43b04a(0x360)][_0x43b04a(0x1c0)](_0x2370e8)[_0x43b04a(0x2af)]:this[_0x43b04a(0x3e7)]['pipe'](_0x404575[_0x43b04a(0x1c6)](_0x2204cf=>_0x2204cf['unitID']===_0x2370e8),_0x404575[_0x43b04a(0x287)](_0x2ae6b2=>_0x2ae6b2[_0x43b04a(0x2af)]));}[_0x5de549(0x48f)](){const _0xb3cfb=_0x5de549;this['_univerInstanceService'][_0xb3cfb(0x364)](_0x39304f['UniverInstanceType'][_0xb3cfb(0x211)])[_0xb3cfb(0x498)](_0x404575['takeUntil'](this['dispose$']))['subscribe'](async _0x41e332=>{const _0x5f2055=_0xb3cfb,_0x525769=_0x41e332['getUnitId'](),_0x5b1c2c=await this[_0x5f2055(0x472)](_0x525769);this[_0x5f2055(0x3e7)]['next'](_0x5b1c2c),this[_0x5f2055(0x360)][_0x5f2055(0x361)](_0x525769,_0x5b1c2c);}),this[_0xb3cfb(0x26e)][_0xb3cfb(0x364)](_0x39304f['UniverInstanceType'][_0xb3cfb(0x418)])[_0xb3cfb(0x498)](_0x404575[_0xb3cfb(0x387)](this[_0xb3cfb(0x241)]))[_0xb3cfb(0x498)](_0x404575[_0xb3cfb(0x1c6)](_0x12324f=>!_0x12324f['getUnitId']()[_0xb3cfb(0x3b2)]('__')))[_0xb3cfb(0x38e)](async _0x1bbb4d=>{const _0x54f3df=_0xb3cfb,_0x5779ad=_0x1bbb4d[_0x54f3df(0x41e)](),_0x3d2b2e=await this[_0x54f3df(0x354)](_0x5779ad);this['_entityInit$'][_0x54f3df(0x345)](_0x3d2b2e),this['_entities']['set'](_0x5779ad,_0x3d2b2e);}),_0x404575[_0xb3cfb(0x394)](this[_0xb3cfb(0x26e)][_0xb3cfb(0x414)](_0x39304f[_0xb3cfb(0x1cf)]['UNIVER_DOC']),this['_univerInstanceService'][_0xb3cfb(0x414)](_0x39304f[_0xb3cfb(0x1cf)]['UNIVER_SHEET']))[_0xb3cfb(0x498)](_0x404575[_0xb3cfb(0x387)](this[_0xb3cfb(0x241)]))[_0xb3cfb(0x38e)](_0x55ad45=>{const _0x5bdbf3=_0xb3cfb,_0x2fd4e6=_0x55ad45[_0x5bdbf3(0x41e)](),_0x1b7f12=this[_0x5bdbf3(0x360)]['get'](_0x2fd4e6);_0x1b7f12&&(_0x1b7f12[_0x5bdbf3(0x2c3)](),this[_0x5bdbf3(0x360)][_0x5bdbf3(0x421)](_0x2fd4e6));});}async[_0x5de549(0x472)](_0xec4fb0){const _0x43da82=_0x5de549,_0x285d01=await this[_0x43da82(0x24f)][_0x43da82(0x2d5)](_0xec4fb0),_0x20b519=this[_0x43da82(0x31d)]['createInstance'](_0x171417,_0xec4fb0,_0x285d01);return _0x20b519['init'](),_0x20b519;}async[_0x5de549(0x354)](_0x3c7e1e){const _0x25a314=_0x5de549,_0x2b49c3=await this[_0x25a314(0x24f)][_0x25a314(0x2d5)](_0x3c7e1e),_0x1e1351=this[_0x25a314(0x31d)]['createInstance'](_0x427717,_0x3c7e1e,_0x2b49c3);return _0x1e1351[_0x25a314(0x482)](),_0x1e1351;}};_0x1af4cc=_0x4edad9([_0xc50099(0x0,_0x39304f[_0x5de549(0x2cc)]),_0xc50099(0x1,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0xc50099(0x2,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x22f)]))],_0x1af4cc);const _0xcfdad9=0x14,_0x6bd10f=0xc8,_0x2fc9bb=0x4,_0x57bc63=0x5;function _0x3d96e9(_0xcb2a3d,_0x183d67){const _0x1904d0=_0x5de549;let {radius:_0x97250a,width:_0x479a33,height:_0x5b0c2a}=_0x183d67;_0x97250a=_0x97250a!=null?_0x97250a:0x0,_0x479a33=_0x479a33!=null?_0x479a33:0x1e,_0x5b0c2a=_0x5b0c2a!=null?_0x5b0c2a:0x1e;let _0x306330=0x0,_0x2d57a3=0x0,_0x24cd86=0x0;_0x306330=_0x2d57a3=_0x24cd86=Math[_0x1904d0(0x316)](_0x97250a,_0x479a33/0x2,_0x5b0c2a/0x2),_0xcb2a3d[_0x1904d0(0x252)](),_0xcb2a3d[_0x1904d0(0x23f)](_0x306330,0x0),_0xcb2a3d[_0x1904d0(0x470)](_0x479a33-_0x2d57a3,0x0),_0xcb2a3d[_0x1904d0(0x45f)](_0x479a33-_0x2d57a3,_0x2d57a3,_0x2d57a3,Math['PI']*0x3/0x2,0x0,!0x1),_0xcb2a3d[_0x1904d0(0x470)](_0x479a33,_0x5b0c2a-_0x24cd86),_0xcb2a3d[_0x1904d0(0x45f)](_0x479a33-_0x24cd86,_0x5b0c2a-_0x24cd86,_0x24cd86,0x0,Math['PI']/0x2,!0x1),_0xcb2a3d['lineTo'](0x0,_0x5b0c2a),_0xcb2a3d[_0x1904d0(0x470)](0x0,_0x306330),_0xcb2a3d[_0x1904d0(0x45f)](_0x306330,_0x306330,_0x306330,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0xcb2a3d[_0x1904d0(0x4a2)](),_0x183d67[_0x1904d0(0x402)]&&(_0xcb2a3d[_0x1904d0(0x1d8)](),_0xcb2a3d['fillStyle']=_0x183d67[_0x1904d0(0x402)],_0x183d67[_0x1904d0(0x1fb)]===_0x1904d0(0x3fe)?_0xcb2a3d[_0x1904d0(0x402)]('evenodd'):_0xcb2a3d[_0x1904d0(0x402)](),_0xcb2a3d[_0x1904d0(0x320)]());}class _0x92597c extends _0x46a3bd[_0x5de549(0x451)]{constructor(_0x5356dc,_0xa10320){const _0x1038ac=_0x5de549;super(_0x5356dc,_0xa10320),_0x41fabe(this,_0x1038ac(0x477)),_0x41fabe(this,_0x1038ac(0x28f)),(this[_0x1038ac(0x477)]=_0xa10320==null?void 0x0:_0xa10320[_0x1038ac(0x477)],this[_0x1038ac(0x28f)]=_0xa10320==null?void 0x0:_0xa10320[_0x1038ac(0x28f)]);}static[_0x5de549(0x3c3)](_0x3b0a94,_0x2cfe44){const _0x3fda34=_0x5de549,{text:_0x18fa42,color:_0x13dda0}=_0x2cfe44;_0x3b0a94['save'](),_0x3b0a94['font']='bold\x2013px\x20Source\x20Han\x20Sans\x20CN';const _0x5cbd12=_0x3b0a94[_0x3fda34(0x388)](_0x18fa42)[_0x3fda34(0x3d6)],_0x116a13=Math[_0x3fda34(0x316)](_0x5cbd12+0x2*_0x2fc9bb,_0x6bd10f);_0x3d96e9(_0x3b0a94,{'height':_0xcfdad9,'radius':0x4,'width':_0x116a13,'fill':_0x13dda0}),_0x3b0a94[_0x3fda34(0x31b)]=_0x3fda34(0x4a7);const _0x24f1a4=_0x2fc9bb,_0x3a024a=_0xcfdad9-_0x57bc63,_0x5480b5=_0x6bd10f-0x2*_0x2fc9bb;if(_0x5cbd12>_0x5480b5){let _0x3298a5='',_0x93164e=0x0;for(const _0xf25e93 of _0x18fa42){const _0x124fb6=_0x3b0a94[_0x3fda34(0x388)](_0xf25e93)[_0x3fda34(0x3d6)];if(_0x93164e+_0x124fb6<=_0x5480b5-_0x3b0a94['measureText'](_0x3fda34(0x36f))[_0x3fda34(0x3d6)])_0x3298a5+=_0xf25e93,_0x93164e+=_0x124fb6;else{_0x3298a5+=_0x3fda34(0x36f);break;}}_0x3b0a94[_0x3fda34(0x35b)](_0x3298a5,_0x24f1a4,_0x3a024a);}else _0x3b0a94[_0x3fda34(0x35b)](_0x18fa42,_0x24f1a4,_0x3a024a);_0x3b0a94[_0x3fda34(0x320)]();}[_0x5de549(0x3e6)](_0x3f6b23){const _0x446f3c=_0x5de549;_0x92597c[_0x446f3c(0x3c3)](_0x3f6b23,this);}}const _0x4a99ec=_0x5de549(0x1b6),_0x100123=_0x5de549(0x1bd),_0x1c8aab=_0x5de549(0x3ac),_0xd9bc96=0x6,_0x1a5323=1.5,_0x2a36ad=0x4,_0x3b9359=1.5,_0x2ad9df=_0x5de549(0x2b7);class _0x5b7907{constructor(_0x2d2ced,_0x3e7ed1,_0x3be581,_0x1ae4fe){const _0x508250=_0x5de549;_0x41fabe(this,_0x508250(0x290),[]),_0x41fabe(this,_0x508250(0x25c),null),_0x41fabe(this,_0x508250(0x22c),null),_0x41fabe(this,'_anchorDot',null),_0x41fabe(this,_0x508250(0x465),null),_0x41fabe(this,_0x508250(0x47d),null),(this[_0x508250(0x40a)]=_0x2d2ced,this[_0x508250(0x2c9)]=_0x3e7ed1,this[_0x508250(0x344)]=_0x3be581,this['_document']=_0x1ae4fe,this[_0x508250(0x348)]());}set[_0x5de549(0x1ca)](_0x3961dd){const _0x3e507e=_0x5de549;_0x3961dd?(this[_0x3e507e(0x3c8)]&&this[_0x3e507e(0x3c8)]['hide'](),this[_0x3e507e(0x22c)]&&this[_0x3e507e(0x22c)]['show']()):(this[_0x3e507e(0x3c8)]&&this['_anchorDot'][_0x3e507e(0x38d)](),this[_0x3e507e(0x22c)]&&this[_0x3e507e(0x22c)][_0x3e507e(0x212)]());}[_0x5de549(0x2c3)](){const _0x36db7f=_0x5de549;for(const _0x46573 of this['_shapes'])_0x46573['dispose']();this['_textBubble']&&this[_0x36db7f(0x22c)]['dispose'](),this[_0x36db7f(0x3c8)]&&this[_0x36db7f(0x3c8)]['dispose'](),this[_0x36db7f(0x25c)]&&this[_0x36db7f(0x25c)][_0x36db7f(0x2c3)](),this[_0x36db7f(0x47d)]&&this[_0x36db7f(0x47d)]();}[_0x5de549(0x348)](){const _0x4a2af5=_0x5de549;var _0xa1f67;const {_docSkeleton:_0x17bd03,_document:_0x3be0a9}=this,{color:_0x58f61f,name:_0x4f73fb,ranges:_0x260f31}=this[_0x4a2af5(0x40a)],_0x5a2d9f=_0x3be0a9[_0x4a2af5(0x3a1)](),{docsLeft:_0x300f99,docsTop:_0x372a1c}=_0x5a2d9f,_0x47664c=new _0x2abae2[(_0x4a2af5(0x38a))](_0x5a2d9f,_0x17bd03);for(const {startOffset:_0x1478ca,endOffset:_0x3c9071,rangeType:_0x39d987,segmentId:_0x3edc49,segmentPage:_0x4e8a38,collapsed:_0x396ae8,isActive:_0x3c1dce}of _0x260f31){const _0x52e774=_0x17bd03[_0x4a2af5(0x479)](_0x1478ca,!0x0,_0x3edc49,_0x4e8a38);let _0x4bd408=_0x17bd03['findNodePositionByCharIndex'](_0x3c9071,!0x0,_0x3edc49,_0x4e8a38);if(_0x4bd408==null&&(_0x4bd408=_0x17bd03[_0x4a2af5(0x479)](_0x3c9071-0x1,!0x1,_0x3edc49,_0x4e8a38)),_0x3c1dce){const {contentBoxPointGroup:_0x261525}=_0x47664c['getRangePointData'](_0x4bd408,_0x4bd408);if(_0x261525['length']===0x0)continue;this[_0x4a2af5(0x2ec)](_0x58f61f,_0x261525,_0x300f99,_0x372a1c,_0x4f73fb),this[_0x4a2af5(0x47d)]=this[_0x4a2af5(0x339)]();}if(_0x52e774&&_0x4bd408){if(_0x39d987===_0x39304f[_0x4a2af5(0x431)][_0x4a2af5(0x1b1)]){const _0x3ae3dd=new _0x2abae2[(_0x4a2af5(0x1cc))](_0x5a2d9f,_0x17bd03),{pointGroup:_0x58ea40}=(_0xa1f67=_0x3ae3dd[_0x4a2af5(0x42d)](_0x52e774,_0x4bd408))!=null?_0xa1f67:{};if(_0x58ea40==null||_0x58ea40[_0x4a2af5(0x3b7)]===0x0)continue;this[_0x4a2af5(0x3b8)](_0x58f61f,_0x58ea40,_0x300f99,_0x372a1c);}else{if(!_0x396ae8){const {borderBoxPointGroup:_0x5c37fe}=_0x47664c[_0x4a2af5(0x42d)](_0x52e774,_0x4bd408);if(_0x5c37fe[_0x4a2af5(0x3b7)]===0x0)continue;this[_0x4a2af5(0x442)](_0x58f61f,_0x5c37fe,_0x300f99,_0x372a1c);}}}}}[_0x5de549(0x2ec)](_0x14cff7,_0x1791e1,_0x20adee,_0x135caf,_0x59fe52){const _0x2a5d26=_0x5de549,_0x4f150b=this[_0x2a5d26(0x46b)](_0x1791e1),{left:_0x4bb375,top:_0x2fe17c,height:_0x223888}=_0x4f150b,_0x5b807a=this[_0x2a5d26(0x3fa)](),_0x4f1b91=_0x3b9359/_0x5b807a,_0x1c01e2=new _0x46a3bd[(_0x2a5d26(0x39c))](_0x4a99ec+_0x39304f[_0x2a5d26(0x26d)](_0xd9bc96),{'left':_0x4bb375+_0x20adee-_0x4f1b91,'top':_0x2fe17c+_0x135caf,'height':_0x223888,'width':_0x1a5323,'fill':_0x14cff7||_0x46a3bd[_0x2a5d26(0x2c6)](_0x39304f[_0x2a5d26(0x3de)][_0x2a5d26(0x260)],0x0),'strokeWidth':_0x4f1b91,'stroke':_0x2ad9df,'evented':!0x0});this['_anchor']=_0x1c01e2,this[_0x2a5d26(0x2c9)]['addObject'](_0x1c01e2,_0x2abae2[_0x2a5d26(0x2d3)]);const _0x567ce3=new _0x46a3bd[(_0x2a5d26(0x39c))](_0x4a99ec+_0x39304f[_0x2a5d26(0x26d)](_0xd9bc96),{'left':_0x4bb375+_0x20adee-_0x4f1b91,'top':_0x2fe17c+_0x135caf-_0x2a36ad/0x2,'height':_0x2a36ad,'width':_0x2a36ad,'fill':_0x14cff7||_0x46a3bd[_0x2a5d26(0x2c6)](_0x39304f[_0x2a5d26(0x3de)][_0x2a5d26(0x260)],0x0),'strokeWidth':0x0,'stroke':_0x14cff7||_0x46a3bd[_0x2a5d26(0x2c6)](_0x39304f[_0x2a5d26(0x3de)][_0x2a5d26(0x260)],0x0),'evented':!0x1});this[_0x2a5d26(0x3c8)]=_0x567ce3,this[_0x2a5d26(0x2c9)][_0x2a5d26(0x468)](_0x567ce3,_0x2abae2[_0x2a5d26(0x2d3)]);const _0x329c78=new _0x92597c(_0x4a99ec+_0x39304f['generateRandomId'](_0xd9bc96),{'left':_0x4bb375+_0x20adee-_0x4f1b91,'top':_0x2fe17c+_0x135caf-_0xcfdad9,'text':_0x59fe52,'color':_0x14cff7});this[_0x2a5d26(0x22c)]=_0x329c78,this[_0x2a5d26(0x2c9)][_0x2a5d26(0x468)](_0x329c78,_0x2abae2[_0x2a5d26(0x2d3)]),this[_0x2a5d26(0x1ca)]=!0x1;}[_0x5de549(0x339)](){const _0xcc7211=_0x5de549,_0x2d7913=this[_0xcc7211(0x25c)][_0xcc7211(0x2f2)]['subscribeEvent'](()=>{const _0x102ea4=_0xcc7211;this[_0x102ea4(0x1ca)]=!0x0;}),_0x31fe76=this[_0xcc7211(0x25c)][_0xcc7211(0x21d)][_0xcc7211(0x3f9)](()=>{const _0x32ebe7=_0xcc7211;this[_0x32ebe7(0x465)]&&clearTimeout(this[_0x32ebe7(0x465)]),this[_0x32ebe7(0x465)]=setTimeout(()=>{const _0x33eb58=_0x32ebe7;this[_0x33eb58(0x1ca)]=!0x1;},0x7d0);});return()=>{const _0x356aa8=_0xcc7211;_0x2d7913['unsubscribe'](),_0x31fe76[_0x356aa8(0x1c2)]();};}[_0x5de549(0x442)](_0x3fbae7,_0x22b19d,_0x19e3d1,_0x5eaa4d){const _0x4433d3=_0x5de549,_0xd59fc2=new _0x39304f[(_0x4433d3(0x253))](_0x3fbae7)[_0x4433d3(0x307)](0.2)[_0x4433d3(0x3f0)](),_0x17a0b9=new _0x46a3bd['RegularPolygon'](_0x100123+_0x39304f[_0x4433d3(0x26d)](_0xd9bc96),{'pointsGroup':_0x22b19d,'fill':_0xd59fc2||_0x46a3bd['getColor'](_0x39304f[_0x4433d3(0x3de)][_0x4433d3(0x260)],0.2),'left':_0x19e3d1,'top':_0x5eaa4d,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x4433d3(0x290)][_0x4433d3(0x44d)](_0x17a0b9),this[_0x4433d3(0x2c9)][_0x4433d3(0x468)](_0x17a0b9,_0x2abae2[_0x4433d3(0x2d3)]);}['_drawRectRange'](_0x1a96c6,_0x5691d7,_0x1ccb46,_0x3a9512){const _0xeedda7=_0x5de549,_0x5acb48=new _0x39304f[(_0xeedda7(0x253))](_0x1a96c6)[_0xeedda7(0x307)](0.2)[_0xeedda7(0x3f0)](),_0xd82177=new _0x46a3bd[(_0xeedda7(0x2e5))](_0x1c8aab+_0x39304f[_0xeedda7(0x26d)](_0xd9bc96),{'pointsGroup':_0x5691d7,'fill':_0x5acb48||_0x46a3bd[_0xeedda7(0x2c6)](_0x39304f['COLORS']['black'],0.2),'left':_0x1ccb46,'top':_0x3a9512,'evented':!0x1,'debounceParentDirty':!0x1});this[_0xeedda7(0x290)][_0xeedda7(0x44d)](_0xd82177),this[_0xeedda7(0x2c9)][_0xeedda7(0x468)](_0xd82177,_0x2abae2['TEXT_RANGE_LAYER_INDEX']);}[_0x5de549(0x46b)](_0x346a9a){const _0x1bc1a9=_0x346a9a[0x0],_0x2fb662=_0x1bc1a9[0x0],_0x3e6129=_0x1bc1a9[0x2],{x:_0x412132,y:_0x52da6b}=_0x2fb662,{x:_0x42a6ac,y:_0x414699}=_0x3e6129;return{'left':_0x412132,'top':_0x52da6b,'width':_0x42a6ac-_0x412132,'height':_0x414699-_0x52da6b};}[_0x5de549(0x3fa)](){const _0x371404=_0x5de549,{scaleX:_0xf1f0f3,scaleY:_0x14c6cf}=this[_0x371404(0x2c9)][_0x371404(0x3da)]();return Math[_0x371404(0x2c5)](_0xf1f0f3,_0x14c6cf);}}var _0x1cb7ff=Object[_0x5de549(0x49f)],_0x523c23=(_0x336df6,_0x5f5360,_0x569c56,_0xd71dab)=>{const _0x112fec=_0x5de549;for(var _0x5b79a3=_0xd71dab>0x1?void 0x0:_0xd71dab?_0x1cb7ff(_0x5f5360,_0x569c56):_0x5f5360,_0x31363c=_0x336df6[_0x112fec(0x3b7)]-0x1,_0x32adb4;_0x31363c>=0x0;_0x31363c--)(_0x32adb4=_0x336df6[_0x31363c])&&(_0x5b79a3=_0x32adb4(_0x5b79a3)||_0x5b79a3);return _0x5b79a3;},_0x4242c1=(_0x3e0550,_0xe9728e)=>(_0x1cc2b4,_0x4feed2)=>_0xe9728e(_0x1cc2b4,_0x4feed2,_0x3e0550);let _0x43034b=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x32fe80,_0x28a186,_0x4c2716,_0x29e4f6,_0xe5c98c){const _0x689ab3=_0x5de549;super(),_0x41fabe(this,_0x689ab3(0x3c0),[]),_0x41fabe(this,'_cursors',[]),(this[_0x689ab3(0x33f)]=_0x32fe80,this[_0x689ab3(0x317)]=_0x28a186,this[_0x689ab3(0x1c5)]=_0x4c2716,this['_commandService']=_0x29e4f6,this['_themeService']=_0xe5c98c,this[_0x689ab3(0x48f)]());}[_0x5de549(0x48f)](){const _0x53fd71=_0x5de549,_0xfd9696=this['_context'][_0x53fd71(0x2fb)],_0x58587f=this[_0x53fd71(0x317)];this[_0x53fd71(0x24e)](_0x404575['combineLatest']([this['_collabCursorController']['getCollabCursors$'](_0xfd9696),this['_themeService'][_0x53fd71(0x382)]])[_0x53fd71(0x498)](_0x11a31a[_0x53fd71(0x309)](([_0x1752f7,_0x34b36a])=>({'skeleton':_0x58587f[_0x53fd71(0x30d)](),'cursors':[..._0x1752f7[_0x53fd71(0x2ba)]()][_0x53fd71(0x1b2)](_0x24b8e3=>({..._0x24b8e3,'color':this[_0x53fd71(0x333)][_0x53fd71(0x302)](_0x24b8e3['color'])}))})))[_0x53fd71(0x38e)](_0x24f0e9=>{const _0x49f758=_0x53fd71;if(this[_0x49f758(0x369)](),_0x24f0e9){const {skeleton:_0x4c719d,cursors:_0x841627}=_0x24f0e9;this['_updateCollabCursors'](_0x4c719d,_0x841627);}})),this[_0x53fd71(0x441)](),this[_0x53fd71(0x2ac)]();}['_updateCollabCursors'](_0x5d1d11,_0x3da123){const _0x4fde4f=_0x5de549,{scene:_0x374fa5,mainComponent:_0x567e20}=this[_0x4fde4f(0x33f)],_0x5a9395=_0x3da123[_0x4fde4f(0x309)](_0x3f28a6=>new _0x5b7907(_0x3f28a6,_0x374fa5,_0x5d1d11,_0x567e20));this[_0x4fde4f(0x3c0)]=_0x5a9395,this[_0x4fde4f(0x2ad)]=_0x3da123;}[_0x5de549(0x295)](){const _0x50e70e=_0x5de549;this[_0x50e70e(0x369)]();const {scene:_0x33a49b,mainComponent:_0x1d2307}=this[_0x50e70e(0x33f)],_0x376e36=this['_docSkeletonManagerService'][_0x50e70e(0x30d)](),_0x2dc872=this[_0x50e70e(0x2ad)][_0x50e70e(0x309)](_0x2d7dd9=>new _0x5b7907(_0x2d7dd9,_0x33a49b,_0x376e36,_0x1d2307));this[_0x50e70e(0x3c0)]=_0x2dc872;}[_0x5de549(0x369)](){const _0x29e4ed=_0x5de549;this['_cursorShapes'][_0x29e4ed(0x22a)](_0xe30281=>_0xe30281[_0x29e4ed(0x2c3)]()),this[_0x29e4ed(0x3c0)]=[];}[_0x5de549(0x2ac)](){const _0x285d1b=_0x5de549,_0x1a6be0=[_0x2abae2[_0x285d1b(0x1ef)]['id']];this[_0x285d1b(0x24e)](this['_commandService'][_0x285d1b(0x2fd)](_0x63284e=>{const _0x1a0d99=_0x285d1b;_0x1a6be0[_0x1a0d99(0x410)](_0x63284e['id'])&&_0x63284e['params'][_0x1a0d99(0x2fb)]===this[_0x1a0d99(0x33f)][_0x1a0d99(0x2fb)]&&this['_refreshCollabCursors']();}));}[_0x5de549(0x441)](){const _0xf390af=_0x5de549;this[_0xf390af(0x24e)](_0x39304f[_0xf390af(0x1a4)](this[_0xf390af(0x33f)]['engine']['onTransformChange$'])[_0xf390af(0x498)](_0x11a31a[_0xf390af(0x1c6)](_0x29f320=>_0x29f320[_0xf390af(0x328)]===_0x46a3bd[_0xf390af(0x39d)]['resize']),_0x11a31a[_0xf390af(0x3fb)](0x10))['subscribe'](()=>{this['_refreshCollabCursors']();}));}};_0x43034b=_0x523c23([_0x4242c1(0x1,_0x39304f['Inject'](_0x59af06[_0x5de549(0x30b)])),_0x4242c1(0x2,_0x39304f[_0x5de549(0x356)](_0x1af4cc)),_0x4242c1(0x3,_0x39304f['ICommandService']),_0x4242c1(0x4,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x297)]))],_0x43034b);const _0x2e2110=0x1,_0x43d861=1.5;class _0x3ed0a extends _0x46a3bd[_0x5de549(0x451)]{constructor(_0x5dafd7,_0x3d1a35){const _0x23c2ff=_0x5de549;super(_0x5dafd7,_0x3d1a35),_0x41fabe(this,'_color'),_0x41fabe(this,_0x23c2ff(0x1e9),!0x1),_0x41fabe(this,'_range'),_0x41fabe(this,_0x23c2ff(0x47c),''),_0x41fabe(this,_0x23c2ff(0x206),_0x23c2ff(0x1d5)),_0x41fabe(this,_0x23c2ff(0x36a)),(_0x3d1a35&&this[_0x23c2ff(0x3e2)](_0x3d1a35),this[_0x23c2ff(0x2f2)][_0x23c2ff(0x3f9)](()=>this[_0x23c2ff(0x3e2)]({'hovered':!0x0})),this[_0x23c2ff(0x21d)][_0x23c2ff(0x3f9)](()=>this[_0x23c2ff(0x3e2)]({'hovered':!0x1})));}[_0x5de549(0x3e2)](_0x1f759b){const _0x2ce398=_0x5de549;var _0x28ec5b,_0x5550bb,_0x1d8c1f,_0x4e5e4f,_0x34ad7e,_0x25d370;this[_0x2ce398(0x436)]=(_0x28ec5b=_0x1f759b[_0x2ce398(0x477)])!=null?_0x28ec5b:this[_0x2ce398(0x436)],this[_0x2ce398(0x1e9)]=(_0x5550bb=_0x1f759b[_0x2ce398(0x272)])!=null?_0x5550bb:this['_hovered'],this['_range']=(_0x1d8c1f=_0x1f759b[_0x2ce398(0x1f6)])!=null?_0x1d8c1f:this[_0x2ce398(0x2d2)],this[_0x2ce398(0x47c)]=(_0x4e5e4f=_0x1f759b['name'])!=null?_0x4e5e4f:this[_0x2ce398(0x47c)],this[_0x2ce398(0x206)]=(_0x34ad7e=_0x1f759b[_0x2ce398(0x203)])!=null?_0x34ad7e:this['_labelPosition'],this['_backgroundColor']=(_0x25d370=_0x1f759b[_0x2ce398(0x42e)])!=null?_0x25d370:this[_0x2ce398(0x36a)],this[_0x2ce398(0x3f1)]({'width':_0x1f759b[_0x2ce398(0x3d6)],'height':_0x1f759b[_0x2ce398(0x381)]});}['onMouseMove'](_0xa16a8a){const _0x557c76=_0x5de549,{row:_0x487c3f,column:_0x194cfc}=_0xa16a8a;if(_0x487c3f>=this['_range'][_0x557c76(0x1a7)]&&_0x487c3f<=this[_0x557c76(0x2d2)][_0x557c76(0x1b9)]&&_0x194cfc>=this[_0x557c76(0x2d2)][_0x557c76(0x286)]&&_0x194cfc<=this[_0x557c76(0x2d2)][_0x557c76(0x305)]){this['setShapeProps']({'hovered':!0x0});return;}this[_0x557c76(0x3e2)]({'hovered':!0x1});}[_0x5de549(0x32e)](_0x4e0061){return!0x1;}['_draw'](_0x213ffc){const _0x405669=_0x5de549;_0x46a3bd[_0x405669(0x39c)][_0x405669(0x3c3)](_0x213ffc,{'width':this['width'],'height':this[_0x405669(0x381)],'strokeWidth':_0x43d861,'stroke':this[_0x405669(0x436)],'evented':!0x1,'fill':this['_backgroundColor']}),this[_0x405669(0x1e9)]&&(_0x213ffc[_0x405669(0x1d8)](),_0x213ffc['transform'](0x1,0x0,0x0,0x1,this[_0x405669(0x3d6)],this['_labelPosition']===_0x405669(0x2c7)?0x0:-_0xcfdad9),_0x92597c[_0x405669(0x3c3)](_0x213ffc,{'text':this[_0x405669(0x47c)],'color':this[_0x405669(0x436)]}),_0x213ffc[_0x405669(0x320)]());}}var _0x4c5c8d=Object[_0x5de549(0x49f)],_0x1af073=(_0x2e75b2,_0x11cf96,_0x3c727f,_0xa711d7)=>{const _0x1538f5=_0x5de549;for(var _0x1b8c04=_0xa711d7>0x1?void 0x0:_0xa711d7?_0x4c5c8d(_0x11cf96,_0x3c727f):_0x11cf96,_0x130c96=_0x2e75b2[_0x1538f5(0x3b7)]-0x1,_0x38f2fa;_0x130c96>=0x0;_0x130c96--)(_0x38f2fa=_0x2e75b2[_0x130c96])&&(_0x1b8c04=_0x38f2fa(_0x1b8c04)||_0x1b8c04);return _0x1b8c04;},_0x407ac8=(_0x6f515c,_0x2a0fcb)=>(_0x22eb03,_0x1cd18d)=>_0x2a0fcb(_0x22eb03,_0x1cd18d,_0x6f515c);const _0x296aa0=0x1389;let _0x338784=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0xfa3cc9,_0x5d9368,_0x2e72af,_0x8d6026){const _0x55dd9a=_0x5de549;super(),_0x41fabe(this,_0x55dd9a(0x2ad),new Set()),_0x41fabe(this,_0x55dd9a(0x3a4),null),(this[_0x55dd9a(0x33f)]=_0xfa3cc9,this[_0x55dd9a(0x271)]=_0x5d9368,this[_0x55dd9a(0x1c5)]=_0x2e72af,this['_themeService']=_0x8d6026,this[_0x55dd9a(0x48f)]());}[_0x5de549(0x48f)](){const _0x33700d=_0x5de549;this[_0x33700d(0x271)][_0x33700d(0x318)]['pipe'](_0x11a31a[_0x33700d(0x387)](this['dispose$']),_0x11a31a[_0x33700d(0x287)](_0x524101=>{const _0x46fc6c=_0x33700d;if(_0x524101){const _0x429a1b=_0x524101[_0x46fc6c(0x289)];return _0x404575['combineLatest'](this['_collabCursorController'][_0x46fc6c(0x3eb)](this['_context'][_0x46fc6c(0x2fb)]),this[_0x46fc6c(0x333)]['currentTheme$'])[_0x46fc6c(0x498)](_0x11a31a['map'](([_0x93bfa2,_0x5f3768])=>{const _0x22ac9c=new Map();return _0x93bfa2['forEach']((_0x16b3a5,_0x14029b)=>{const _0x154a14=_0x48a1;if(_0x16b3a5[_0x154a14(0x485)]===_0x429a1b){const _0x543876={..._0x16b3a5};_0x543876[_0x154a14(0x477)]=this[_0x154a14(0x333)][_0x154a14(0x302)](_0x16b3a5['color']),_0x22ac9c['set'](_0x14029b,_0x543876);}}),{'skeleton':_0x524101,'cursors':_0x22ac9c};}));}return _0x404575['of']({'skeleton':null,'cursors':new Map()});}))[_0x33700d(0x38e)](({skeleton:_0x1cec6f,cursors:_0x3b655b})=>{const _0x3cc9b4=_0x33700d;this[_0x3cc9b4(0x369)](),_0x1cec6f&&this[_0x3cc9b4(0x4a1)](_0x1cec6f,_0x3b655b);}),this['_sheetSkeletonManagerService']['currentSkeleton$'][_0x33700d(0x38e)](_0x9c2207=>{const _0x34b7bb=_0x33700d;if(_0x9c2207==null)return;const {skeleton:_0x5b7505}=_0x9c2207,{scene:_0x4ef404}=this[_0x34b7bb(0x33f)];_0x4ef404[_0x34b7bb(0x3ff)]['subscribeEvent'](_0x39304f[_0x34b7bb(0x484)](_0x44f8e6=>{const _0xc71997=_0x34b7bb;var _0x4044b9,_0x5b69a8;const {offsetX:_0x102f16,offsetY:_0x17620b}=_0x44f8e6,{x:_0x9eff90,y:_0x332573}=_0x4ef404[_0xc71997(0x425)](_0x46a3bd[_0xc71997(0x24a)][_0xc71997(0x2e7)]([_0x102f16,_0x17620b])),{scaleX:_0x54d343,scaleY:_0x3546e8}=_0x4ef404[_0xc71997(0x3da)](),_0x356396=_0x4ef404['getViewport'](_0x46a3bd[_0xc71997(0x3b9)][_0xc71997(0x263)]),_0x511ff6=_0x4ef404[_0xc71997(0x1d2)](_0x46a3bd[_0xc71997(0x24a)][_0xc71997(0x2e7)]([_0x9eff90,_0x332573]),_0x356396),_0xb67cb9=_0x5b7505['getCellPositionByOffset'](_0x102f16,_0x17620b,_0x54d343,_0x3546e8,_0x511ff6);((_0x4044b9=this[_0xc71997(0x3a4)])==null?void 0x0:_0x4044b9['column'])===_0xb67cb9[_0xc71997(0x2a3)]&&((_0x5b69a8=this[_0xc71997(0x3a4)])==null?void 0x0:_0x5b69a8[_0xc71997(0x367)])===_0xb67cb9[_0xc71997(0x367)]||this[_0xc71997(0x2ad)][_0xc71997(0x22a)](_0x3f8b92=>{const _0x3efc1c=_0xc71997;_0x3f8b92[_0x3efc1c(0x245)](_0xb67cb9);});},0x64));});}['_updateCollabCursors'](_0x13b2bd,_0x4a4ad3){const _0x2e8be7=_0x5de549;var _0x5bd5d9;const _0x5f29ac=(_0x5bd5d9=this[_0x2e8be7(0x271)][_0x2e8be7(0x335)]())==null?void 0x0:_0x5bd5d9[_0x2e8be7(0x280)];if(!_0x5f29ac)return;const _0x48d6df=this['_getSheetObject']();if(!_0x48d6df)return;this['_cursors'][_0x2e8be7(0x22a)](_0x3d5995=>{const _0x5eddb5=_0x2e8be7;_0x3d5995[_0x5eddb5(0x1bc)]();});const {scene:_0x59efc3}=_0x48d6df,_0x12e36a=_0x458cd3(Array['from'](_0x4a4ad3[_0x2e8be7(0x2ba)]()))[_0x2e8be7(0x309)](_0x332993=>{const _0x4b4fa2=_0x2e8be7,{color:_0x423810,range:_0x5d8786,name:_0x36a385,selection:_0xbce8e9,sheetID:_0xc42bbd}=_0x332993,{startColumn:_0x2f42e9,startRow:_0x2a9440,endColumn:_0x2e2a87,endRow:_0x258fdd}=_0x5d8786,_0x5ccc56=_0x5ee9c5['getCoordByCell'](_0x2a9440,_0x2f42e9,_0x59efc3,_0x5f29ac),_0x190278=_0x5ee9c5[_0x4b4fa2(0x365)](_0x258fdd,_0x2e2a87,_0x59efc3,_0x5f29ac),{columnHeaderHeightAndMarginTop:_0x453139}=_0x5f29ac,{startX:_0x3d919e,startY:_0x5d4228}=_0x5ccc56,{endX:_0x1cd7c2,endY:_0x32ae5f}=_0x190278,_0xa47f22=_0x1cd7c2-_0x3d919e,_0x45c369=_0x32ae5f-_0x5d4228,_0x4b9f99={'labelPosition':_0x5d4228-_0x453139>=_0xcfdad9?_0x4b4fa2(0x1d5):_0x4b4fa2(0x2c7),'sheetID':_0xc42bbd,'range':_0x5d8786,'color':_0x423810,'name':_0x36a385,'selection':_0xbce8e9,'left':_0x3d919e,'top':_0x5d4228,'width':_0xa47f22,'height':_0x45c369,'evented':!0x1,'zIndex':_0x296aa0};return new _0x3ed0a(_0x36a385,_0x4b9f99);});_0x59efc3['addObjects'](_0x12e36a,_0x2e2110),this[_0x2e8be7(0x2ad)]=new Set(_0x12e36a);}[_0x5de549(0x369)](){const _0x4d06a3=_0x5de549;var _0x4afb16;(_0x4afb16=this[_0x4d06a3(0x2ad)])==null||_0x4afb16[_0x4d06a3(0x22a)](_0x55ef26=>_0x55ef26['dispose']());}[_0x5de549(0x440)](){const _0x1c3382=_0x5de549;return _0x5ee9c5[_0x1c3382(0x415)](this[_0x1c3382(0x33f)][_0x1c3382(0x3c7)],this[_0x1c3382(0x33f)]);}};_0x338784=_0x1af073([_0x407ac8(0x1,_0x39304f['Inject'](_0x5ee9c5[_0x5de549(0x366)])),_0x407ac8(0x2,_0x39304f[_0x5de549(0x356)](_0x1af4cc)),_0x407ac8(0x3,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x297)]))],_0x338784);function _0x458cd3(_0x34cb49){const _0x2fda3d=_0x5de549,_0x421203=new Map();return _0x34cb49[_0x2fda3d(0x22a)](_0x10836f=>{const _0x237ca0=_0x2fda3d;if(_0x421203[_0x237ca0(0x3f7)](_0x10836f[_0x237ca0(0x368)])){const _0x4f7de6=_0x421203[_0x237ca0(0x1c0)](_0x10836f[_0x237ca0(0x368)]);_0x4f7de6[_0x237ca0(0x231)]+=',\x20'+_0x10836f[_0x237ca0(0x231)];}else _0x421203[_0x237ca0(0x361)](_0x10836f[_0x237ca0(0x368)],_0x10836f);}),Array[_0x2fda3d(0x1bf)](_0x421203[_0x2fda3d(0x2ba)]());}var _0xf8c215=Object[_0x5de549(0x49f)],_0x3b3685=(_0x2adfa4,_0xd61da1,_0x3f4c76,_0x9c023b)=>{const _0x489f5f=_0x5de549;for(var _0x49697e=_0x9c023b>0x1?void 0x0:_0x9c023b?_0xf8c215(_0xd61da1,_0x3f4c76):_0xd61da1,_0x8296a6=_0x2adfa4[_0x489f5f(0x3b7)]-0x1,_0xbb1cb7;_0x8296a6>=0x0;_0x8296a6--)(_0xbb1cb7=_0x2adfa4[_0x8296a6])&&(_0x49697e=_0xbb1cb7(_0x49697e)||_0x49697e);return _0x49697e;},_0x37b7aa=(_0x36f074,_0x11124c)=>(_0x327122,_0x3e10b4)=>_0x11124c(_0x327122,_0x3e10b4,_0x36f074);let _0x261734=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x4b7b0f,_0x3c15a6,_0x3e05b3,_0x1ae48b,_0x32186c,_0x51b570){const _0x2c7531=_0x5de549;super(),this[_0x2c7531(0x3d4)]=_0x4b7b0f,this['_localCacheService']=_0x3c15a6,this[_0x2c7531(0x250)]=_0x3e05b3,this[_0x2c7531(0x22d)]=_0x1ae48b,this['_notificationService']=_0x32186c,this[_0x2c7531(0x3c1)]=_0x51b570,this[_0x2c7531(0x229)](),this['_initEvent']();}[_0x5de549(0x229)](){const _0x428eab=_0x5de549;this[_0x428eab(0x24e)](this['_beforeCloseService'][_0x428eab(0x265)](()=>{const _0x51994e=_0x428eab;if(this[_0x51994e(0x2e6)][_0x51994e(0x32c)]['size'])return this[_0x51994e(0x3c1)]['t'](_0x51994e(0x39b));}));}[_0x5de549(0x23a)](){const _0x34beee=_0x5de549;this[_0x34beee(0x24e)](this[_0x34beee(0x250)][_0x34beee(0x2dc)][_0x34beee(0x38e)](_0x50e32e=>{const _0x2b8cdd=_0x34beee;_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x352)]&&this['_messageService'][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x370)],'content':this['_localeService']['t'](_0x2b8cdd(0x377))}),_0x50e32e['id']===_0x3fe1f0['CollaborationUIEventId'][_0x2b8cdd(0x326)]&&this[_0x2b8cdd(0x22d)]['show']({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x370)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x31e))}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x43e)]&&this['_notificationService'][_0x2b8cdd(0x38d)]({'title':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x257)),'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x254)),'type':'error','duration':0x0}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x3ad)]&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x385)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x31e))+'('+_0x50e32e['data']+')'}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)]['JOIN_ROOM_FAILED']&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x370)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x50e32e[_0x2b8cdd(0x298)]||'')}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x1f3)]&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f['MessageType'][_0x2b8cdd(0x370)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x243))}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)]['SOCKET_FAILED']&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)]['Error'],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x1db))}),_0x50e32e['id']===_0x3fe1f0['CollaborationUIEventId'][_0x2b8cdd(0x20b)]&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f['MessageType'][_0x2b8cdd(0x385)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x28e))});}));}};_0x261734=_0x3b3685([_0x37b7aa(0x0,_0x4c3b5c[_0x5de549(0x30f)]),_0x37b7aa(0x1,_0x3fe1f0['ILocalCacheService']),_0x37b7aa(0x2,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x49b)])),_0x37b7aa(0x3,_0x4c3b5c[_0x5de549(0x323)]),_0x37b7aa(0x4,_0x4c3b5c['INotificationService']),_0x37b7aa(0x5,_0x39304f['Inject'](_0x39304f[_0x5de549(0x3f4)]))],_0x261734);var _0x13e2d4=Object[_0x5de549(0x49f)],_0x10ba81=(_0x124bf3,_0x249681,_0x1806b9,_0x28810f)=>{const _0x5a8ec4=_0x5de549;for(var _0x48deb7=_0x28810f>0x1?void 0x0:_0x28810f?_0x13e2d4(_0x249681,_0x1806b9):_0x249681,_0x257f51=_0x124bf3[_0x5a8ec4(0x3b7)]-0x1,_0x4b7a52;_0x257f51>=0x0;_0x257f51--)(_0x4b7a52=_0x124bf3[_0x257f51])&&(_0x48deb7=_0x4b7a52(_0x48deb7)||_0x48deb7);return _0x48deb7;},_0x44586c=(_0x54155a,_0x3e77ee)=>(_0x5375eb,_0x2e343a)=>_0x3e77ee(_0x5375eb,_0x2e343a,_0x54155a);let _0x33fdc9=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x27263d,_0x260cd1,_0x5a6dd8,_0x395262){const _0x16a84f=_0x5de549;super(),_0x41fabe(this,_0x16a84f(0x1b8)),(this[_0x16a84f(0x31d)]=_0x27263d,this['_httpService']=_0x260cd1,this['_logService']=_0x5a6dd8,this[_0x16a84f(0x2cf)]=_0x395262,this[_0x16a84f(0x48f)]());}['_init'](){const _0x5b4ba0=_0x5de549;this[_0x5b4ba0(0x28b)](),this[_0x5b4ba0(0x343)](),this['_monkeyPatchLogService'](),this[_0x5b4ba0(0x39e)]();}['_initUserListener'](){const _0x5a9aae=_0x5de549;this[_0x5a9aae(0x24e)](this[_0x5a9aae(0x2cf)][_0x5a9aae(0x41f)]['subscribe'](_0x45ec33=>{const _0x222947=_0x5a9aae;this[_0x222947(0x1b8)]=_0x45ec33==null?void 0x0:_0x45ec33['memberID'];}));}['_initWindowErrorListener'](){const _0x141c9e=_0x5de549,_0x509417=_0xaaddbd=>{const _0x3d4797=_0x48a1;var _0x4115a5;this[_0x3d4797(0x45c)](_0x3d4797(0x2ee),'[Window\x20Error]:\x20'+_0xaaddbd[_0x3d4797(0x1c3)]+_0x3d4797(0x3b4)+_0xaaddbd[_0x3d4797(0x2d1)]+':'+_0xaaddbd[_0x3d4797(0x285)]+':'+_0xaaddbd['colno']+'\x0a'+(((_0x4115a5=_0xaaddbd[_0x3d4797(0x2ee)])==null?void 0x0:_0x4115a5[_0x3d4797(0x23d)])||''));};window[_0x141c9e(0x34d)]('error',_0x509417),this[_0x141c9e(0x24e)](()=>{const _0x356c8a=_0x141c9e;window['removeEventListener'](_0x356c8a(0x2ee),_0x509417);});}[_0x5de549(0x343)](){const _0xe27f4a=_0x5de549,_0x6bb16e=_0x189d06=>{const _0x392500=_0x48a1;this[_0x392500(0x45c)](_0x392500(0x2ee),_0x392500(0x4a6)+_0x189d06[_0x392500(0x218)]);};window[_0xe27f4a(0x34d)](_0xe27f4a(0x493),_0x6bb16e),this[_0xe27f4a(0x24e)](()=>{const _0x19d106=_0xe27f4a;window[_0x19d106(0x47e)]('unhandledrejection',_0x6bb16e);});}[_0x5de549(0x384)](){const _0x283af5=_0x5de549,_0x3ed876=this[_0x283af5(0x43a)]['error'][_0x283af5(0x3c6)](this[_0x283af5(0x43a)]);this[_0x283af5(0x43a)][_0x283af5(0x2ee)]=(..._0x4e7e78)=>{const _0x2bfa96=_0x283af5,_0x199123=_0x4e7e78[_0x2bfa96(0x309)](_0x564425=>_0x564425 instanceof Error?_0x564425[_0x2bfa96(0x1c3)]+'\x0a'+_0x564425[_0x2bfa96(0x23d)]:String(_0x564425))[_0x2bfa96(0x3b0)]('\x20');this[_0x2bfa96(0x45c)](_0x2bfa96(0x2ee),_0x2bfa96(0x2d7)+_0x199123),_0x3ed876(..._0x4e7e78);},this['disposeWithMe'](()=>{const _0x2baff1=_0x283af5;this[_0x2baff1(0x43a)][_0x2baff1(0x2ee)]=_0x3ed876;});}['_uploadLog'](_0xe0ad67,_0x53523f){const _0x234b66=_0x5de549;try{const _0x5015b7={'userId':this['_memberID'],'logLabel':_0xe0ad67,'content':_0x53523f};this[_0x234b66(0x40f)][_0x234b66(0x2b8)](_0x234b66(0x401),{'body':_0x5015b7})[_0x234b66(0x47a)](()=>{});}catch{}}};_0x33fdc9=_0x10ba81([_0x44586c(0x0,_0x39304f['Inject'](_0x39304f[_0x5de549(0x2bd)])),_0x44586c(0x1,_0x39304f[_0x5de549(0x356)](_0x4e0fb2[_0x5de549(0x469)])),_0x44586c(0x2,_0x39304f[_0x5de549(0x25e)]),_0x44586c(0x3,_0x39304f['Inject'](_0x3fe1f0[_0x5de549(0x22f)]))],_0x33fdc9);const _0x13b4e5='collaboration-client-ui.config',_0x469697={};var _0x2d8b6a=Object[_0x5de549(0x49f)],_0x5144bc=(_0x2e9deb,_0x49fce7,_0x2796ee,_0x5a5c38)=>{for(var _0x3add98=_0x5a5c38>0x1?void 0x0:_0x5a5c38?_0x2d8b6a(_0x49fce7,_0x2796ee):_0x49fce7,_0x583c85=_0x2e9deb['length']-0x1,_0x26f12f;_0x583c85>=0x0;_0x583c85--)(_0x26f12f=_0x2e9deb[_0x583c85])&&(_0x3add98=_0x26f12f(_0x3add98)||_0x3add98);return _0x3add98;},_0xaf46f4=(_0x318beb,_0x184d72)=>(_0x538d89,_0x556cb5)=>_0x184d72(_0x538d89,_0x556cb5,_0x318beb);let _0x547126=class{constructor(_0x1cdea0,_0x36fbef){const _0x38e088=_0x5de549;this[_0x38e088(0x403)]=_0x1cdea0,this['_renderManagerService']=_0x36fbef;}[_0x5de549(0x342)](_0x4542d6){this['_transformUndoRedoStack'](_0x4542d6),this['_transformPreviousActiveRange'](_0x4542d6);}['transformRemoteChangeset'](_0x55e528){const _0x53e068=_0x5de549,{unitID:_0x4b29d1}=_0x55e528,_0x362b15=this['_renderManagerService'][_0x53e068(0x21a)](_0x4b29d1)['with'](_0x2abae2[_0x53e068(0x278)]),{redoCache:_0x2d8887}=_0x362b15[_0x53e068(0x2dd)]();if(_0x2d8887[_0x53e068(0x3b7)]===0x0)return _0x55e528;let _0x8af97c=_0x39304f[_0x53e068(0x1ec)][_0x53e068(0x3ab)](_0x55e528[_0x53e068(0x404)][0x0]);for(let _0x5f4fd3=0x0;_0x5f4fd3<_0x2d8887['length'];_0x5f4fd3++){const _0x48cd37={'id':'doc.mutation.rich-text-editing','params':{..._0x2d8887[_0x5f4fd3]}},_0x4c9974=this[_0x53e068(0x403)][_0x53e068(0x37d)](_0x8af97c,_0x48cd37,!0x1);if(_0x560361['isTransformMutationFailure'](_0x4c9974))throw _0x4c9974['error'];_0x8af97c=_0x4c9974[_0x53e068(0x1d7)];}return{..._0x39304f[_0x53e068(0x1ec)][_0x53e068(0x3ab)](_0x55e528),'mutations':[_0x8af97c]};}[_0x5de549(0x1eb)](_0xa0a2df){const _0x2185bc=_0x5de549,{unitID:_0x34638f}=_0xa0a2df,_0x4fcd09=this[_0x2185bc(0x349)][_0x2185bc(0x21a)](_0x34638f)[_0x2185bc(0x29e)](_0x2abae2[_0x2185bc(0x278)]),{undoCache:_0x392f4c,redoCache:_0x28d1ef}=_0x4fcd09[_0x2185bc(0x2dd)]();if(_0x392f4c[_0x2185bc(0x3b7)]===0x0||_0x28d1ef[_0x2185bc(0x3b7)]===0x0)return;const _0x8c4423=[],_0x2d8532=[];let _0x4a9868=_0x39304f[_0x2185bc(0x1ec)][_0x2185bc(0x3ab)](_0xa0a2df[_0x2185bc(0x404)][0x0]),_0x259e9c=_0x39304f[_0x2185bc(0x1ec)][_0x2185bc(0x3ab)](_0xa0a2df[_0x2185bc(0x404)][0x0]);for(let _0x3e7a7b=_0x392f4c['length']-0x1;_0x3e7a7b>=0x0;_0x3e7a7b--){const _0x37ec47={'id':'doc.mutation.rich-text-editing','params':{..._0x392f4c[_0x3e7a7b]}},_0x5b75cf={'id':_0x2185bc(0x476),'params':{..._0x28d1ef[_0x3e7a7b]}},_0x3b4497=this[_0x2185bc(0x403)][_0x2185bc(0x37d)](_0x4a9868,_0x37ec47,!0x1),_0x4c6a4a=this['_transformService'][_0x2185bc(0x37d)](_0x259e9c,_0x5b75cf,!0x1);if(_0x560361[_0x2185bc(0x3fd)](_0x3b4497))throw _0x3b4497[_0x2185bc(0x2ee)];if(_0x560361[_0x2185bc(0x3fd)](_0x4c6a4a))throw _0x4c6a4a[_0x2185bc(0x2ee)];_0x8c4423[_0x2185bc(0x282)](_0x3b4497[_0x2185bc(0x1e0)][_0x2185bc(0x448)]),_0x2d8532[_0x2185bc(0x282)](_0x4c6a4a[_0x2185bc(0x1e0)][_0x2185bc(0x448)]),_0x4a9868=_0x3b4497[_0x2185bc(0x1d7)],_0x259e9c=_0x4c6a4a[_0x2185bc(0x1d7)];}_0x4fcd09[_0x2185bc(0x38f)]({'undoCache':_0x8c4423,'redoCache':_0x2d8532});}['_transformPreviousActiveRange'](_0x2cb7f2){const _0x1d2229=_0x5de549,{unitID:_0x575294}=_0x2cb7f2,_0x26100d=this[_0x1d2229(0x349)]['getRenderById'](_0x575294)[_0x1d2229(0x29e)](_0x2abae2['DocIMEInputManagerService']),_0x4e2705=_0x26100d[_0x1d2229(0x464)]();if(_0x4e2705==null)return;const _0x45d90f=[{'id':_0x1d2229(0x476),'params':{'unitId':_0x2cb7f2[_0x1d2229(0x42f)],'actions':null,'textRanges':[_0x4e2705]}}],_0x535b1b=this[_0x1d2229(0x403)][_0x1d2229(0x3c4)](_0x2cb7f2,_0x45d90f);if(!_0x560361[_0x1d2229(0x2ce)](_0x535b1b))throw _0x535b1b[_0x1d2229(0x2ee)];const _0x22a910=_0x535b1b[_0x1d2229(0x1e0)][0x0][_0x1d2229(0x448)]['textRanges'];Array[_0x1d2229(0x372)](_0x22a910)&&_0x22a910[_0x1d2229(0x3b7)]&&_0x26100d[_0x1d2229(0x2a0)](_0x22a910[0x0]);}};_0x547126=_0x5144bc([_0xaf46f4(0x0,_0x560361[_0x5de549(0x37e)]),_0xaf46f4(0x1,_0x46a3bd['IRenderManagerService'])],_0x547126);var _0x494865=Object[_0x5de549(0x49f)],_0x33054a=(_0x2b793d,_0x395f2,_0x41015,_0x3c2c33)=>{const _0x20b2a4=_0x5de549;for(var _0x3a49a3=_0x3c2c33>0x1?void 0x0:_0x3c2c33?_0x494865(_0x395f2,_0x41015):_0x395f2,_0x594a98=_0x2b793d[_0x20b2a4(0x3b7)]-0x1,_0x26bebd;_0x594a98>=0x0;_0x594a98--)(_0x26bebd=_0x2b793d[_0x594a98])&&(_0x3a49a3=_0x26bebd(_0x3a49a3)||_0x3a49a3);return _0x3a49a3;},_0x216ee=(_0x133e54,_0x50da81)=>(_0x35743c,_0x50739a)=>_0x50da81(_0x35743c,_0x50739a,_0x133e54);let _0xacb853=class{constructor(_0x293e0b,_0x1d7f52,_0x2b5dd9){const _0x1279b7=_0x5de549;this[_0x1279b7(0x31d)]=_0x293e0b,this[_0x1279b7(0x403)]=_0x1d7f52,this[_0x1279b7(0x3b1)]=_0x2b5dd9;}[_0x5de549(0x444)](_0x330ee9){const _0x55e2e4=_0x5de549;this[_0x55e2e4(0x201)](_0x330ee9);}[_0x5de549(0x46e)](_0x223ef2){const _0xa5f205=_0x5de549,{unitID:_0x4560d2}=_0x223ef2,{collaboration:_0x3442fd}=this[_0xa5f205(0x3b1)][_0xa5f205(0x261)](_0x4560d2);if(_0x3442fd[_0xa5f205(0x3b7)]===0x0)return _0x223ef2;let _0x28a2ab=_0x39304f[_0xa5f205(0x1ec)][_0xa5f205(0x3ab)](_0x223ef2[_0xa5f205(0x404)][0x0]);for(let _0x9a05d4=0x0;_0x9a05d4<_0x3442fd[_0xa5f205(0x3b7)];_0x9a05d4++){const _0x293e26={'id':_0xa5f205(0x476),'params':{'unitId':_0x3442fd[_0x9a05d4]['unitId'],..._0x3442fd[_0x9a05d4][_0xa5f205(0x293)]}},_0x19c041=this[_0xa5f205(0x403)][_0xa5f205(0x37d)](_0x28a2ab,_0x293e26,!0x1);if(_0x560361[_0xa5f205(0x3fd)](_0x19c041))throw _0x19c041['error'];_0x28a2ab=_0x19c041[_0xa5f205(0x1d7)];}return{..._0x39304f[_0xa5f205(0x1ec)][_0xa5f205(0x3ab)](_0x223ef2),'mutations':[_0x28a2ab]};}[_0x5de549(0x201)](_0x1aa0af){const _0x38d35a=_0x5de549,{unitID:_0x16e33e}=_0x1aa0af,{history:_0x50ff57,collaboration:_0x30be94}=this['_docStateChangeManagerService'][_0x38d35a(0x261)](_0x16e33e);if(_0x50ff57['length']===0x0&&_0x30be94['length']===0x0)return;const _0x3759f8=[],_0x3a8e7f=[];let _0x45acc6=_0x39304f[_0x38d35a(0x1ec)][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]),_0x14a992=_0x39304f[_0x38d35a(0x1ec)][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]);for(let _0x58bccd=_0x50ff57['length']-0x1;_0x58bccd>=0x0;_0x58bccd--){const _0x30130b={'id':_0x38d35a(0x476),'params':{'unitId':_0x50ff57[_0x58bccd][_0x38d35a(0x2fb)],..._0x50ff57[_0x58bccd][_0x38d35a(0x222)]}},_0x36d30e={'id':_0x38d35a(0x476),'params':{'unitId':_0x50ff57[_0x58bccd]['unitId'],..._0x50ff57[_0x58bccd][_0x38d35a(0x293)]}},_0x45fc5a=this[_0x38d35a(0x403)]['transformMutation'](_0x45acc6,_0x30130b,!0x1),_0x375666=this[_0x38d35a(0x403)]['transformMutation'](_0x14a992,_0x36d30e,!0x1);if(_0x560361[_0x38d35a(0x3fd)](_0x45fc5a))throw _0x45fc5a['error'];if(_0x560361['isTransformMutationFailure'](_0x375666))throw _0x375666[_0x38d35a(0x2ee)];_0x3759f8['unshift']({..._0x50ff57[_0x58bccd],'undoState':_0x45fc5a['m2Prime']['params'],'redoState':_0x375666['m2Prime']['params']}),_0x45acc6=_0x45fc5a[_0x38d35a(0x1d7)],_0x14a992=_0x375666['m1Prime'];}_0x45acc6=_0x39304f['Tools'][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]),_0x14a992=_0x39304f[_0x38d35a(0x1ec)][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]);for(let _0x286738=_0x30be94[_0x38d35a(0x3b7)]-0x1;_0x286738>=0x0;_0x286738--){const _0xb43fcc={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x30be94[_0x286738][_0x38d35a(0x2fb)],..._0x30be94[_0x286738][_0x38d35a(0x222)]}},_0xeb8c01={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x30be94[_0x286738][_0x38d35a(0x2fb)],..._0x30be94[_0x286738]['redoState']}},_0x3e48ae=this[_0x38d35a(0x403)][_0x38d35a(0x37d)](_0x45acc6,_0xb43fcc,!0x1),_0x34fa47=this[_0x38d35a(0x403)][_0x38d35a(0x37d)](_0x14a992,_0xeb8c01,!0x1);if(_0x560361['isTransformMutationFailure'](_0x3e48ae))throw _0x3e48ae[_0x38d35a(0x2ee)];if(_0x560361[_0x38d35a(0x3fd)](_0x34fa47))throw _0x34fa47[_0x38d35a(0x2ee)];_0x3a8e7f[_0x38d35a(0x282)]({..._0x30be94[_0x286738],'undoState':_0x3e48ae[_0x38d35a(0x1e0)]['params'],'redoState':_0x34fa47['m2Prime'][_0x38d35a(0x448)]}),_0x45acc6=_0x3e48ae['m1Prime'],_0x14a992=_0x34fa47[_0x38d35a(0x1d7)];}this[_0x38d35a(0x3b1)][_0x38d35a(0x461)](_0x16e33e,{'history':_0x3759f8,'collaboration':_0x3a8e7f});}};_0xacb853=_0x33054a([_0x216ee(0x0,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0x216ee(0x1,_0x560361[_0x5de549(0x37e)]),_0x216ee(0x2,_0x39304f['Inject'](_0x2abae2['DocStateChangeManagerService']))],_0xacb853);var _0x31e565=Object[_0x5de549(0x49f)],_0x523a3c=(_0x348d58,_0x4650b6,_0x5119a9,_0x47f61a)=>{const _0x5ec6a5=_0x5de549;for(var _0x6e6609=_0x47f61a>0x1?void 0x0:_0x47f61a?_0x31e565(_0x4650b6,_0x5119a9):_0x4650b6,_0x59d0df=_0x348d58[_0x5ec6a5(0x3b7)]-0x1,_0x2ad891;_0x59d0df>=0x0;_0x59d0df--)(_0x2ad891=_0x348d58[_0x59d0df])&&(_0x6e6609=_0x2ad891(_0x6e6609)||_0x6e6609);return _0x6e6609;},_0x70a35b=(_0x5b4eba,_0x42a892)=>(_0x187036,_0x26c230)=>_0x42a892(_0x187036,_0x26c230,_0x5b4eba);let _0x372ab3=class{constructor(_0x2477b5,_0x4e64cc){const _0x215a38=_0x5de549;this['_injector']=_0x2477b5,this[_0x215a38(0x403)]=_0x4e64cc;}[_0x5de549(0x33a)](_0x279231){const _0x4cc896=_0x5de549;var _0x4a012d;const _0x5b7d66=this[_0x4cc896(0x31d)][_0x4cc896(0x1c0)](_0x59af06[_0x4cc896(0x20c)]),_0x23f385=(_0x4a012d=_0x5b7d66['getDocRanges']())!=null?_0x4a012d:[];if(_0x23f385[_0x4cc896(0x3b7)]===0x0)return;const _0x4a8a0f=_0x279231[_0x4cc896(0x42f)],_0x4f0a48=[{'id':_0x4cc896(0x476),'params':{'unitId':_0x4a8a0f,'actions':null,'textRanges':_0x23f385}}],_0x49f637=this[_0x4cc896(0x403)]['transformMutationsWithChangeset'](_0x279231,_0x4f0a48);if(!_0x560361[_0x4cc896(0x2ce)](_0x49f637))throw _0x49f637['error'];const _0x24010c=_0x49f637[_0x4cc896(0x1e0)][0x0][_0x4cc896(0x448)][_0x4cc896(0x225)];Array[_0x4cc896(0x372)](_0x24010c)&&_0x24010c[_0x4cc896(0x3b7)]&&_0x5b7d66['replaceDocRanges'](_0x24010c,{'unitId':_0x4a8a0f,'subUnitId':_0x4a8a0f},!0x1);}};_0x372ab3=_0x523a3c([_0x70a35b(0x0,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0x70a35b(0x1,_0x560361[_0x5de549(0x37e)])],_0x372ab3);var _0x42e7e9=Object[_0x5de549(0x49f)],_0x1eb956=(_0x2f4774,_0x23a028,_0x284e45,_0x2ade7a)=>{const _0x514a23=_0x5de549;for(var _0x57d420=_0x2ade7a>0x1?void 0x0:_0x2ade7a?_0x42e7e9(_0x23a028,_0x284e45):_0x23a028,_0x26019d=_0x2f4774[_0x514a23(0x3b7)]-0x1,_0x29cd74;_0x26019d>=0x0;_0x26019d--)(_0x29cd74=_0x2f4774[_0x26019d])&&(_0x57d420=_0x29cd74(_0x57d420)||_0x57d420);return _0x57d420;},_0x23a64a=(_0x3e85bb,_0x439965)=>(_0x4c3a6f,_0x39596f)=>_0x439965(_0x4c3a6f,_0x39596f,_0x3e85bb);let _0x516750=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0xa203a5,_0x346642,_0xfd203f,_0x4ae842,_0x56b45b,_0x11cd3,_0x3d79de,_0x4a94bb){const _0x27f0ad=_0x5de549;super(),_0x41fabe(this,_0x27f0ad(0x2e8),new _0x404575[(_0x27f0ad(0x25b))](_0x3fe1f0[_0x27f0ad(0x329)]['NOT_COLLAB'])),(this[_0x27f0ad(0x3b1)]=_0xa203a5,this['_collaborationController']=_0x346642,this[_0x27f0ad(0x23e)]=_0xfd203f,this[_0x27f0ad(0x3e8)]=_0x4ae842,this['_docTransformSelectionsService']=_0x56b45b,this[_0x27f0ad(0x2ff)]=_0x11cd3,this['_messageService']=_0x3d79de,this['_localeService']=_0x4a94bb,this[_0x27f0ad(0x3cc)]());}[_0x5de549(0x3cc)](){const _0x10a33c=_0x5de549;this[_0x10a33c(0x24e)](this[_0x10a33c(0x1fd)][_0x10a33c(0x312)][_0x10a33c(0x38e)](_0x3445a6=>{const _0x4a5315=_0x10a33c,_0x15fce7=this['_docStateChangeManagerService'][_0x4a5315(0x30e)]['subscribe'](_0x5b8b55=>{const _0x47c270=_0x4a5315;if(_0x5b8b55==null)return;const {unitId:_0x471479,redoState:_0x20066d,commandId:_0x43a32a}=_0x5b8b55;if(_0x471479!==_0x3445a6[_0x47c270(0x42f)])return;const _0x47a486={'id':_0x43a32a,'type':_0x39304f[_0x47c270(0x208)][_0x47c270(0x397)],'params':{'unitId':_0x471479,'actions':_0x20066d[_0x47c270(0x42c)],'textRanges':null}};_0x3445a6[_0x47c270(0x1ea)](_0x47a486);});if(_0x3445a6[_0x4a5315(0x24e)](_0x15fce7),_0x3445a6 instanceof _0x3fe1f0[_0x4a5315(0x1ce)]){const _0x222696={'onTransformIME':_0x4d3723=>this[_0x4a5315(0x23e)][_0x4a5315(0x342)](_0x4d3723),'onTransformState':_0x6d6f9e=>this[_0x4a5315(0x3e8)][_0x4a5315(0x444)](_0x6d6f9e),'onTransformSelections':_0x3b1dae=>this['_docTransformSelectionsService'][_0x4a5315(0x33a)](_0x3b1dae),'onSyncEditingCollabCursor':_0x5cc744=>this['_docSyncEditingCollabCursorService'][_0x4a5315(0x3e0)](_0x5cc744),'onTransformRemoteChangesetByIMECache':_0x599616=>this['_docTransformIMECacheService'][_0x4a5315(0x46e)](_0x599616),'onTransformRemoteChangesetByStateCache':_0x4a3212=>this[_0x4a5315(0x3e8)][_0x4a5315(0x46e)](_0x4a3212)};_0x3445a6[_0x4a5315(0x3c9)](_0x222696);}}));}};_0x516750=_0x1eb956([_0x23a64a(0x0,_0x39304f[_0x5de549(0x356)](_0x2abae2[_0x5de549(0x48c)])),_0x23a64a(0x1,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x28d)])),_0x23a64a(0x2,_0x39304f['Inject'](_0x547126)),_0x23a64a(0x3,_0x39304f[_0x5de549(0x356)](_0xacb853)),_0x23a64a(0x4,_0x39304f[_0x5de549(0x356)](_0x372ab3)),_0x23a64a(0x5,_0x39304f['Inject'](_0x4c3a54)),_0x23a64a(0x6,_0x4c3b5c[_0x5de549(0x323)]),_0x23a64a(0x7,_0x39304f[_0x5de549(0x356)](_0x39304f['LocaleService']))],_0x516750);var _0x277c13=(_0xa63f82=>(_0xa63f82[_0xa63f82[_0x5de549(0x2ed)]=0x0]='UNDEFINED',_0xa63f82[_0xa63f82['OK']=0x1]='OK',_0xa63f82[_0xa63f82[_0x5de549(0x3a3)]=0x2]=_0x5de549(0x3a3),_0xa63f82[_0xa63f82[_0x5de549(0x43e)]=0x3]='PERMISSION_DENIED',_0xa63f82[_0xa63f82[_0x5de549(0x1bb)]=0x4]=_0x5de549(0x1bb),_0xa63f82[_0xa63f82[_0x5de549(0x306)]=0x5]=_0x5de549(0x306),_0xa63f82[_0xa63f82[_0x5de549(0x496)]=0x6]='ALREADY_EXISTS',_0xa63f82[_0xa63f82['INVALID_ARGUMENT']=0x7]=_0x5de549(0x3a2),_0xa63f82[_0xa63f82['TOO_MANY_REQUESTS']=0x8]=_0x5de549(0x331),_0xa63f82[_0xa63f82[_0x5de549(0x433)]=0x9]=_0x5de549(0x433),_0xa63f82[_0xa63f82['LOGIN_FAILED']=0xa]=_0x5de549(0x46d),_0xa63f82[_0xa63f82[_0x5de549(0x2da)]=0xb]='MOBILE_VERIFY_CODE_MISMATCH',_0xa63f82[_0xa63f82[_0x5de549(0x1d1)]=0xc]=_0x5de549(0x1d1),_0xa63f82[_0xa63f82['EMAIL_VERIFY_CODE_MISMATCH']=0xd]=_0x5de549(0x270),_0xa63f82[_0xa63f82[_0x5de549(0x1f9)]=0xe]='EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0xa63f82[_0xa63f82[_0x5de549(0x1d3)]=0xf]=_0x5de549(0x1d3),_0xa63f82[_0xa63f82[_0x5de549(0x324)]=0x10]=_0x5de549(0x324),_0xa63f82[_0xa63f82[_0x5de549(0x379)]=0x64]=_0x5de549(0x379),_0xa63f82[_0xa63f82[_0x5de549(0x1c1)]=0x65]='ERROR_AGAIN',_0xa63f82[_0xa63f82[_0x5de549(0x445)]=0xc9]=_0x5de549(0x445),_0xa63f82[_0xa63f82[_0x5de549(0x40b)]=0xca]=_0x5de549(0x40b),_0xa63f82[_0xa63f82[_0x5de549(0x45d)]=0x1389]='CHANGESET_REVISION_CONFILICT',_0xa63f82[_0xa63f82[_0x5de549(0x499)]=0x1771]=_0x5de549(0x499),_0xa63f82[_0xa63f82[_0x5de549(0x1ed)]=0x1772]=_0x5de549(0x1ed),_0xa63f82[_0xa63f82[_0x5de549(0x491)]=0x1773]=_0x5de549(0x491),_0xa63f82[_0xa63f82[_0x5de549(0x25a)]=0x1b59]='APPLY_REJECT',_0xa63f82[_0xa63f82[_0x5de549(0x3bc)]=0x1b5a]=_0x5de549(0x3bc),_0xa63f82[_0xa63f82[_0x5de549(0x258)]=0x1b5b]='APPLY_REVISION_CONFILICT',_0xa63f82[_0xa63f82[_0x5de549(0x23c)]=0x1b5c]=_0x5de549(0x23c),_0xa63f82[_0xa63f82[_0x5de549(0x407)]=0x1b5d]=_0x5de549(0x407),_0xa63f82[_0xa63f82[_0x5de549(0x3aa)]=0x1f41]=_0x5de549(0x3aa),_0xa63f82[_0xa63f82['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0xa63f82[_0xa63f82[_0x5de549(0x4a4)]=0x232a]=_0x5de549(0x4a4),_0xa63f82[_0xa63f82[_0x5de549(0x429)]=0x232b]='LICENSE_IMPORT_SIZE_EXCEEDED',_0xa63f82[_0xa63f82[_0x5de549(0x246)]=0x232c]='LICENSE_EXPORT_SIZE_EXCEEDED',_0xa63f82[_0xa63f82[_0x5de549(0x1ff)]=0x232d]='LICENSE_DISTRO_REJECTED',_0xa63f82[_0xa63f82[_0x5de549(0x2fc)]=0x2711]='YUUMI_UNABLE_LOAD_URL',_0xa63f82[_0xa63f82[_0x5de549(0x386)]=0x2712]=_0x5de549(0x386),_0xa63f82[_0xa63f82[_0x5de549(0x37b)]=0x2713]='YUUMI_RATE_OVER_LIMIT',_0xa63f82[_0xa63f82[_0x5de549(0x447)]=0x2714]=_0x5de549(0x447),_0xa63f82[_0xa63f82[_0x5de549(0x1d9)]=0x271a]=_0x5de549(0x1d9),_0xa63f82[_0xa63f82[_0x5de549(0x244)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0xa63f82[_0xa63f82['YUUMI_TABLE_NOT_FOUND_IN_UNIT']=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0xa63f82[_0xa63f82[_0x5de549(0x2f0)]=0x271d]='YUUMI_ALL_TABLES_IS_INVALID',_0xa63f82[_0xa63f82[_0x5de549(0x3af)]=0x271e]=_0x5de549(0x3af),_0xa63f82[_0xa63f82['YUUMI_AI_RUN_FAILED']=0x271f]=_0x5de549(0x471),_0xa63f82[_0xa63f82[_0x5de549(0x494)]=0x2720]=_0x5de549(0x494),_0xa63f82[_0xa63f82[_0x5de549(0x36e)]=0x2af9]=_0x5de549(0x36e),_0xa63f82[_0xa63f82['INVITE_CODE_HAS_BEEN_UES']=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0xa63f82[_0xa63f82[_0x5de549(0x2fa)]=0x2ee2]='INVALID_INVITE_CODE',_0xa63f82[_0xa63f82['INVITE_CODE_REQUIRED']=0x2ee3]=_0x5de549(0x235),_0xa63f82[_0xa63f82[_0x5de549(0x3c5)]=0x2ee4]=_0x5de549(0x3c5),_0xa63f82[_0xa63f82[_0x5de549(0x2ab)]=0x2ee5]=_0x5de549(0x2ab),_0xa63f82[_0xa63f82[_0x5de549(0x262)]=0x32c9]=_0x5de549(0x262),_0xa63f82[_0xa63f82[_0x5de549(0x3c2)]=0x32ca]=_0x5de549(0x3c2),_0xa63f82[_0xa63f82[_0x5de549(0x38c)]=0x32cb]=_0x5de549(0x38c),_0xa63f82[_0xa63f82[_0x5de549(0x209)]=0x36b1]='ENTITLE_CAN_NOT_BUY_LOWER_OTP',_0xa63f82[_0xa63f82[_0x5de549(0x274)]=0x36b2]=_0x5de549(0x274),_0xa63f82[_0xa63f82[_0x5de549(0x35d)]=0x36b3]=_0x5de549(0x35d),_0xa63f82[_0xa63f82[_0x5de549(0x3a9)]=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0xa63f82[_0xa63f82[_0x5de549(0x3ea)]=0x36b5]=_0x5de549(0x3ea),_0xa63f82[_0xa63f82[_0x5de549(0x35c)]=0x36b6]=_0x5de549(0x35c),_0xa63f82[_0xa63f82[_0x5de549(0x249)]=0x36b7]=_0x5de549(0x249),_0xa63f82[_0xa63f82[_0x5de549(0x2a7)]=0x36b8]=_0x5de549(0x2a7),_0xa63f82[_0xa63f82[_0x5de549(0x340)]=0x3715]=_0x5de549(0x340),_0xa63f82[_0xa63f82[_0x5de549(0x38b)]=0x3716]=_0x5de549(0x38b),_0xa63f82[_0xa63f82[_0x5de549(0x362)]=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0xa63f82[_0xa63f82[_0x5de549(0x2b4)]=0x37dd]='ENTITLE_NEED_BILLING_ADDRESS',_0xa63f82[_0xa63f82[_0x5de549(0x3f6)]=0x3a99]=_0x5de549(0x3f6),_0xa63f82[_0xa63f82[_0x5de549(0x462)]=0x3a9a]='REDEMPTION_CODE_INACTIVE',_0xa63f82[_0xa63f82[_0x5de549(0x39a)]=0x3a9b]='REDEMPTION_CODE_FULLY_REDEEMED',_0xa63f82[_0xa63f82[_0x5de549(0x279)]=0x3a9c]=_0x5de549(0x279),_0xa63f82[_0xa63f82['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x5de549(0x284),_0xa63f82[_0xa63f82[_0x5de549(0x1df)]=0x3a9e]=_0x5de549(0x1df),_0xa63f82[_0xa63f82[_0x5de549(0x22b)]=0x3a9f]=_0x5de549(0x22b),_0xa63f82[_0xa63f82[_0x5de549(0x408)]=0x3e81]=_0x5de549(0x408),_0xa63f82[_0xa63f82[_0x5de549(0x426)]=-0x1]=_0x5de549(0x426),_0xa63f82))(_0x277c13||{});function _0x204ffd(_0x1aeb0b){const _0x5f5d38=_0x5de549;var _0x5f1f09,_0x2d4e76;const _0x4b47dd=(_0x5f1f09=_0x1aeb0b[_0x5f5d38(0x41a)])==null?void 0x0:_0x5f1f09[_0x5f5d38(0x1be)],_0x5c2619=((_0x2d4e76=_0x1aeb0b['stageInfo'])==null?void 0x0:_0x2d4e76[_0x5f5d38(0x355)])||0x0;return _0x4b47dd===_0x284237[_0x5f5d38(0x3f3)][_0x5f5d38(0x3a6)]&&_0x5c2619>0x0;}function _0x2be4ae(_0x5dbe80){const _0x18ab4f=_0x5de549;return _0x5dbe80['functionsExecutedState']===_0x284237[_0x18ab4f(0x21c)][_0x18ab4f(0x248)];}var _0x412897=Object[_0x5de549(0x49f)],_0x11c584=(_0x34f1b4,_0x87d016,_0x20889c,_0x48923a)=>{const _0x45afe6=_0x5de549;for(var _0x275158=_0x48923a>0x1?void 0x0:_0x48923a?_0x412897(_0x87d016,_0x20889c):_0x87d016,_0x21f6e0=_0x34f1b4[_0x45afe6(0x3b7)]-0x1,_0x40de39;_0x21f6e0>=0x0;_0x21f6e0--)(_0x40de39=_0x34f1b4[_0x21f6e0])&&(_0x275158=_0x40de39(_0x275158)||_0x275158);return _0x275158;},_0x56ccd2=(_0x17a95f,_0x264b58)=>(_0x229b07,_0x401e57)=>_0x264b58(_0x229b07,_0x401e57,_0x17a95f);const _0xdbcb5d=_0x5de549(0x416),_0x342981=_0x5de549(0x1d4),_0x4fe584=_0x5de549(0x1d0);let _0x2bfa89=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0xc45c9a,_0x5a8e7e,_0x5c4015,_0x9bc080,_0x26c66f,_0x1862f8,_0x266bfe){const _0x13e764=_0x5de549;super(),_0x41fabe(this,_0x13e764(0x29f),null),_0x41fabe(this,_0x13e764(0x27c),0x0),_0x41fabe(this,_0x13e764(0x467),0x0),_0x41fabe(this,_0x13e764(0x215),[]),_0x41fabe(this,_0x13e764(0x411),0x0),(this['_messageService']=_0xc45c9a,this[_0x13e764(0x33e)]=_0x5a8e7e,this[_0x13e764(0x20f)]=_0x5c4015,this[_0x13e764(0x40f)]=_0x9bc080,this[_0x13e764(0x26e)]=_0x26c66f,this['_logService']=_0x1862f8,this[_0x13e764(0x3c1)]=_0x266bfe,this[_0x13e764(0x3cd)]());}['_initCommandInterceptor'](){const _0x4ae39c=_0x5de549;this[_0x4ae39c(0x24e)](this['_commandService'][_0x4ae39c(0x259)]((_0x5c38ab,_0x5308fb)=>{const _0x11e224=_0x4ae39c;var _0x18f9ea;if(_0x5c38ab['id']!==_0x284237[_0x11e224(0x1b0)]['id'])return;const _0x3c812b=_0x5c38ab[_0x11e224(0x448)];if(!this[_0x11e224(0x1e7)]((_0x18f9ea=_0x3c812b[_0x11e224(0x2d9)])!=null?_0x18f9ea:[]))return;if(!this['_checkCalculationAvailable']())throw this['_checkAndWaitForCalculationPermission'](_0x5c38ab,_0x5308fb),this['_showGuardMessage'](),new _0x39304f[(_0x11e224(0x358))]();})),this[_0x4ae39c(0x24e)](this[_0x4ae39c(0x33e)][_0x4ae39c(0x2fd)]((_0x2ebb2b,_0x3cba68)=>{const _0x94105d=_0x4ae39c;if(_0x2ebb2b['id']!==_0x284237[_0x94105d(0x29a)]['id'])return;const _0x460af8=_0x2ebb2b['params'];if(_0x204ffd(_0x460af8)){const _0x19c934=_0x39304f[_0x94105d(0x26d)]();this[_0x94105d(0x215)]['push'](_0x19c934),this['_startCalculationLimit'](_0x19c934);}else{if(_0x2be4ae(_0x460af8)&&this[_0x94105d(0x215)][_0x94105d(0x3b7)]>0x0){const _0x57f7db=this[_0x94105d(0x215)]['shift']();this[_0x94105d(0x1f2)](_0x57f7db);}}}));}[_0x5de549(0x2c3)](){const _0x36d0b2=_0x5de549;super[_0x36d0b2(0x2c3)](),this['_clearPolling'](),this[_0x36d0b2(0x215)]=[],this['_currentUsage']=0x0,this[_0x36d0b2(0x27c)]=0x0,this[_0x36d0b2(0x411)]=0x0;}async[_0x5de549(0x28c)](_0x11193a,_0x4c158e){const _0x5b8513=_0x5de549;for(let _0x59a0a5=0x0;_0x59a0a5<0x1e;_0x59a0a5++)try{if(await this[_0x5b8513(0x341)](),this[_0x5b8513(0x44e)]()){this[_0x5b8513(0x227)](_0x11193a,_0x4c158e),this[_0x5b8513(0x22d)]['show']({'content':this[_0x5b8513(0x3c1)]['t'](_0x5b8513(0x3db)),'type':_0x31598f[_0x5b8513(0x242)][_0x5b8513(0x2bb)]});return;}await new Promise(_0x4a44ed=>{const _0x13a0c0=_0x5b8513;this[_0x13a0c0(0x29f)]=window['setTimeout'](_0x4a44ed,0x3e8);});}catch(_0x3ff704){this['_logService'][_0x5b8513(0x2ee)](_0x3ff704);}this[_0x5b8513(0x22d)][_0x5b8513(0x38d)]({'content':this[_0x5b8513(0x3c1)]['t'](_0x5b8513(0x1e2)),'type':_0x31598f[_0x5b8513(0x242)][_0x5b8513(0x385)]});}[_0x5de549(0x227)](_0x355d39,_0x32122a){const _0x1a302c=_0x5de549;try{this[_0x1a302c(0x33e)][_0x1a302c(0x275)](_0x355d39['id'],_0x355d39['params'],_0x32122a);}catch(_0x5673ae){this['_logService']['error'](_0x5673ae);}}[_0x5de549(0x314)](_0x4c56e0,_0x40933b){const _0x2f7308=_0x5de549;_0x40933b<this[_0x2f7308(0x411)]||(this[_0x2f7308(0x411)]=_0x40933b,this[_0x2f7308(0x27c)]=Number[_0x2f7308(0x435)](_0x4c56e0[_0x2f7308(0x44c)]),this['_currentUsage']=Number['parseInt'](_0x4c56e0[_0x2f7308(0x273)]));}async['_startCalculationLimit'](_0x360c93){const _0x38a34d=_0x5de549;var _0x1523eb,_0x114b81;const _0x36d26c=Date[_0x38a34d(0x48e)]();try{const _0x375feb=((_0x1523eb=this[_0x38a34d(0x20f)][_0x38a34d(0x47f)](_0x3fe1f0[_0x38a34d(0x4a3)]))==null?void 0x0:_0x1523eb['startFormulaLimitUrl'])||_0x342981,_0xb7f446=(await this[_0x38a34d(0x40f)][_0x38a34d(0x2b8)](_0x375feb,{'body':JSON[_0x38a34d(0x230)]({'taskId':_0x360c93})}))[_0x38a34d(0x20e)];if(((_0x114b81=_0xb7f446['error'])==null?void 0x0:_0x114b81[_0x38a34d(0x36c)])!==_0x277c13['OK'])return;this[_0x38a34d(0x314)](_0xb7f446[_0x38a34d(0x353)],_0x36d26c);}catch(_0x4faa4f){this[_0x38a34d(0x43a)][_0x38a34d(0x2ee)](_0x4faa4f);}}async[_0x5de549(0x341)](_0x459a7a){const _0x55499b=_0x5de549;var _0x36c0d9,_0x394628;const _0x43f0f6=Date[_0x55499b(0x48e)]();try{const _0x2d7397=((_0x36c0d9=this['_configService']['getConfig'](_0x3fe1f0['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']))==null?void 0x0:_0x36c0d9[_0x55499b(0x2ae)])||_0xdbcb5d,_0x4c147a=_0x459a7a?_0x2d7397+_0x55499b(0x29d)+encodeURIComponent(_0x459a7a):_0x2d7397,_0x51ba83=(await this[_0x55499b(0x40f)][_0x55499b(0x1c0)](_0x4c147a))['body'];if(((_0x394628=_0x51ba83['error'])==null?void 0x0:_0x394628['code'])!==_0x277c13['OK'])return;this[_0x55499b(0x314)](_0x51ba83['limitInfo'],_0x43f0f6);}catch(_0x3530c4){this[_0x55499b(0x43a)]['error'](_0x3530c4);}}async[_0x5de549(0x1f2)](_0x49b644){const _0x354f67=_0x5de549;var _0x353367,_0x4f4024;const _0x46a5c5=Date['now']();try{const _0x30c98e=((_0x353367=this[_0x354f67(0x20f)]['getConfig'](_0x3fe1f0[_0x354f67(0x4a3)]))==null?void 0x0:_0x353367[_0x354f67(0x223)])||_0x4fe584,_0x4a6b7a=(await this[_0x354f67(0x40f)]['post'](_0x30c98e,{'body':JSON[_0x354f67(0x230)]({'taskId':_0x49b644})}))[_0x354f67(0x20e)];if(((_0x4f4024=_0x4a6b7a[_0x354f67(0x2ee)])==null?void 0x0:_0x4f4024[_0x354f67(0x36c)])!==_0x277c13['OK'])return;this[_0x354f67(0x314)](_0x4a6b7a[_0x354f67(0x353)],_0x46a5c5);}catch(_0x23d8e4){this[_0x354f67(0x43a)]['error'](_0x23d8e4);}}[_0x5de549(0x44e)](){const _0x2eb8da=_0x5de549;return this[_0x2eb8da(0x27c)]===0x0?!0x0:this['_maxFormulaLimit']-this['_currentUsage']>0x0;}[_0x5de549(0x2bf)](){const _0x58d377=_0x5de549;this[_0x58d377(0x29f)]&&(clearTimeout(this['_pollingInterval']),this[_0x58d377(0x29f)]=null);}['_showGuardMessage'](){const _0x15b792=_0x5de549;this[_0x15b792(0x22d)][_0x15b792(0x38d)]({'content':this[_0x15b792(0x3c1)]['t'](_0x15b792(0x2ea)),'type':_0x31598f[_0x15b792(0x242)][_0x15b792(0x299)]});}[_0x5de549(0x1e7)](_0x59bac8){const _0x21cc59=_0x5de549;for(const _0x336633 of _0x59bac8){const {unitId:_0x2e15d4,sheetId:_0x36ec57,range:_0x335d5c}=_0x336633,_0x53da8e=this[_0x21cc59(0x26e)]['getUnit'](_0x2e15d4);if(!_0x53da8e)continue;const _0x4de68f=_0x53da8e[_0x21cc59(0x296)](_0x36ec57);if(!_0x4de68f)continue;const _0x1a79af=_0x4de68f[_0x21cc59(0x1f0)]();for(let _0x1894dd=_0x335d5c[_0x21cc59(0x1a7)];_0x1894dd<=_0x335d5c['endRow'];_0x1894dd++)for(let _0x2c7713=_0x335d5c[_0x21cc59(0x286)];_0x2c7713<=_0x335d5c[_0x21cc59(0x305)];_0x2c7713++){const _0x54b125=_0x1a79af[_0x21cc59(0x3fc)](_0x1894dd,_0x2c7713);if(_0x54b125&&(_0x39304f[_0x21cc59(0x37f)](_0x54b125['f'])||_0x39304f[_0x21cc59(0x43c)](_0x54b125['si'])))return!0x0;}}return!0x1;}};_0x2bfa89=_0x11c584([_0x56ccd2(0x0,_0x39304f[_0x5de549(0x356)](_0x4c3b5c[_0x5de549(0x323)])),_0x56ccd2(0x1,_0x39304f[_0x5de549(0x3bf)]),_0x56ccd2(0x2,_0x39304f[_0x5de549(0x205)]),_0x56ccd2(0x3,_0x39304f[_0x5de549(0x356)](_0x4e0fb2[_0x5de549(0x469)])),_0x56ccd2(0x4,_0x39304f[_0x5de549(0x2cc)]),_0x56ccd2(0x5,_0x39304f[_0x5de549(0x25e)]),_0x56ccd2(0x6,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x3f4)]))],_0x2bfa89);var _0x74e318=Object[_0x5de549(0x49f)],_0x4d192b=(_0x29401a,_0xe9a37f,_0x1c8c03,_0x16e567)=>{const _0x50a798=_0x5de549;for(var _0x276cec=_0x16e567>0x1?void 0x0:_0x16e567?_0x74e318(_0xe9a37f,_0x1c8c03):_0xe9a37f,_0x51dbb0=_0x29401a[_0x50a798(0x3b7)]-0x1,_0x19ff64;_0x51dbb0>=0x0;_0x51dbb0--)(_0x19ff64=_0x29401a[_0x51dbb0])&&(_0x276cec=_0x19ff64(_0x276cec)||_0x276cec);return _0x276cec;},_0x226814=(_0x243898,_0x35dc32)=>(_0x26824d,_0x267ea1)=>_0x35dc32(_0x26824d,_0x267ea1,_0x243898);let _0x1e23b0=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x53ae89,_0x30eed9,_0x7dbf61){const _0x40c75f=_0x5de549;super(),_0x41fabe(this,_0x40c75f(0x2df),new Map()),_0x41fabe(this,_0x40c75f(0x288),new Map()),_0x41fabe(this,'_disabled',!0x1),(this[_0x40c75f(0x20f)]=_0x53ae89,this[_0x40c75f(0x310)]=_0x30eed9,this['_revisionService']=_0x7dbf61);}[_0x5de549(0x42a)](){this['_disabled']=!0x0;}[_0x5de549(0x41c)](){const _0x379fb2=_0x5de549;this[_0x379fb2(0x1d6)]=!0x1;}get[_0x5de549(0x32c)](){const _0x3c8e27=_0x5de549;return this[_0x3c8e27(0x288)];}['dispose'](){const _0x3a3ac2=_0x5de549;this[_0x3a3ac2(0x34b)]()[_0x3a3ac2(0x2f8)](()=>super['dispose']());}async[_0x5de549(0x43b)](_0xa6dd78){const _0x5e49f8=_0x5de549;return this['_disabled']?null:this[_0x5e49f8(0x310)]['getItem'](_0x3fe1f0[_0x5e49f8(0x357)](_0xa6dd78));}async[_0x5de549(0x32f)](_0x15f1e6,_0x3e06a5){const _0x2adad1=_0x5de549;return!!this[_0x2adad1(0x310)][_0x2adad1(0x3ca)](_0x15f1e6,_0x3e06a5);}[_0x5de549(0x378)](_0x28549c,_0x303503,_0x27b3bc,_0x3914ae){const _0x2dcf15=_0x5de549,_0x217b03=this[_0x2dcf15(0x48b)][_0x2dcf15(0x303)](_0x28549c);this[_0x2dcf15(0x2df)]['set'](_0x28549c,{'unitID':_0x28549c,'type':_0x303503,'awaitingChangeset':_0x27b3bc,'mutations':_0x3914ae,'rev':_0x217b03}),this[_0x2dcf15(0x288)][_0x2dcf15(0x3f7)](_0x28549c)||this[_0x2dcf15(0x266)](_0x28549c);}[_0x5de549(0x266)](_0x42d18f){const _0x4c6d06=_0x5de549,_0x116b92=this[_0x4c6d06(0x294)]();_0x116b92===0x0?this[_0x4c6d06(0x34a)](_0x42d18f):this[_0x4c6d06(0x288)][_0x4c6d06(0x361)](_0x42d18f,setTimeout(()=>this['_saveCache'](_0x42d18f),_0x116b92));}[_0x5de549(0x294)](){const _0x4afe10=_0x5de549;var _0x2ad5df;return(_0x2ad5df=this[_0x4afe10(0x20f)][_0x4afe10(0x47f)](_0x3fe1f0[_0x4afe10(0x459)]))!=null?_0x2ad5df:_0x3fe1f0['LOCAL_CACHE_INTERVAL'];}[_0x5de549(0x34a)](_0x42be44){const _0x464e42=_0x5de549,_0x3c4ec2=this[_0x464e42(0x288)][_0x464e42(0x1c0)](_0x42be44);return _0x3c4ec2!==void 0x0&&window[_0x464e42(0x3e9)](_0x3c4ec2),this['_localStorageService'][_0x464e42(0x3ca)](_0x3fe1f0[_0x464e42(0x357)](_0x42be44),this[_0x464e42(0x2df)]['get'](_0x42be44))[_0x464e42(0x2f8)](()=>this[_0x464e42(0x288)]['delete'](_0x42be44));}async[_0x5de549(0x34b)](){const _0x3dda55=_0x5de549,_0x4db39a=[];this[_0x3dda55(0x288)][_0x3dda55(0x22a)]((_0x8fe20c,_0x3036df)=>{const _0x5539d0=_0x3dda55;window[_0x5539d0(0x3e9)](_0x8fe20c),_0x4db39a[_0x5539d0(0x44d)](this[_0x5539d0(0x34a)](_0x3036df)[_0x5539d0(0x2f8)](()=>{const _0x353b52=_0x5539d0;this[_0x353b52(0x288)][_0x353b52(0x421)](_0x3036df);}));}),await Promise[_0x3dda55(0x22e)](_0x4db39a);}};_0x1e23b0=_0x4d192b([_0x226814(0x0,_0x39304f[_0x5de549(0x205)]),_0x226814(0x1,_0x39304f[_0x5de549(0x1f1)]),_0x226814(0x2,_0x39304f['Inject'](_0x560361[_0x5de549(0x458)]))],_0x1e23b0);class _0x12ecfd extends _0x39304f[_0x5de549(0x423)]{constructor(){const _0x8ad5c4=_0x5de549;super(),_0x41fabe(this,_0x8ad5c4(0x322)),this['urlChange$']=_0x404575[_0x8ad5c4(0x2de)](window,_0x8ad5c4(0x3cf))[_0x8ad5c4(0x498)](_0x404575['takeUntil'](this[_0x8ad5c4(0x241)]),_0x404575['shareReplay'](0x1),_0x404575['mapTo'](void 0x0));}[_0x5de549(0x374)](_0x260e80,_0x5bbeac,_0x5ac81b=!0x1){const _0x23a40d=_0x5de549,_0x4f0936=new URL(window['location'][_0x23a40d(0x25d)]);_0x4f0936[_0x23a40d(0x3ce)][_0x23a40d(0x361)](_0x260e80,_0x5bbeac),_0x5ac81b?window[_0x23a40d(0x3be)][_0x23a40d(0x27e)]('','',_0x4f0936[_0x23a40d(0x492)]()):window['history'][_0x23a40d(0x3d0)]('','',_0x4f0936[_0x23a40d(0x492)]());}[_0x5de549(0x2b0)](_0x29f086,_0x1c05bc=!0x1){const _0x337c7c=_0x5de549,_0x5e228f=new URL(window['location'][_0x337c7c(0x25d)]);_0x5e228f[_0x337c7c(0x3ce)][_0x337c7c(0x421)](_0x29f086),_0x1c05bc?window[_0x337c7c(0x3be)][_0x337c7c(0x27e)]('','',_0x5e228f[_0x337c7c(0x492)]()):window['history']['pushState']('','',_0x5e228f['toString']());}[_0x5de549(0x350)](_0x59356f){const _0x535fde=_0x5de549;var _0x4fb76a;return(_0x4fb76a=new URL(window[_0x535fde(0x457)][_0x535fde(0x25d)])[_0x535fde(0x3ce)][_0x535fde(0x1c0)](_0x59356f))!=null?_0x4fb76a:void 0x0;}}var _0x393bbe=Object['defineProperty'],_0x5fc207=Object[_0x5de549(0x49f)],_0x3adff3=(_0x4b5892,_0x50c80b,_0xfaae4f)=>_0x50c80b in _0x4b5892?_0x393bbe(_0x4b5892,_0x50c80b,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xfaae4f}):_0x4b5892[_0x50c80b]=_0xfaae4f,_0x53693c=(_0x1aa74c,_0x34dbf7,_0xc7596e,_0x5bfe0f)=>{const _0x44c64a=_0x5de549;for(var _0x56ef79=_0x5bfe0f>0x1?void 0x0:_0x5bfe0f?_0x5fc207(_0x34dbf7,_0xc7596e):_0x34dbf7,_0x28b8fb=_0x1aa74c[_0x44c64a(0x3b7)]-0x1,_0x56626a;_0x28b8fb>=0x0;_0x28b8fb--)(_0x56626a=_0x1aa74c[_0x28b8fb])&&(_0x56ef79=_0x56626a(_0x56ef79)||_0x56ef79);return _0x56ef79;},_0x13208c=(_0x38cded,_0x35fbe9)=>(_0x184873,_0x21a03e)=>_0x35fbe9(_0x184873,_0x21a03e,_0x38cded),_0x4c9030=(_0x2b51a4,_0x345a2f,_0x4596cf)=>_0x3adff3(_0x2b51a4,_0x345a2f+'',_0x4596cf);const _0x1dade5=_0x5de549(0x267);_0x44b1a7['UniverCollaborationClientUIPlugin']=class extends _0x39304f[_0x5de549(0x41d)]{constructor(_0x4ff6f7=_0x469697,_0x11c5b3,_0x3b87c3,_0xace2cd){const _0x2c1a5f=_0x5de549;super(),this[_0x2c1a5f(0x2cb)]=_0x4ff6f7,this[_0x2c1a5f(0x349)]=_0x11c5b3,this[_0x2c1a5f(0x31d)]=_0x3b87c3,this[_0x2c1a5f(0x20f)]=_0xace2cd;const {..._0x3e1a9a}=_0x39304f[_0x2c1a5f(0x394)]({},_0x469697,this[_0x2c1a5f(0x2cb)]);this[_0x2c1a5f(0x20f)]['setConfig'](_0x13b4e5,_0x3e1a9a);}[_0x5de549(0x3ef)](){this['_registerDependencies'](),this['_initDependencies']();}[_0x5de549(0x238)](){this['_registerRenderDependencies']();}[_0x5de549(0x1ac)](){const _0x2fa01c=_0x5de549;var _0x1eef1a;const _0x54a336=[[_0x34f587],[_0x2bfa89],[_0x372ab3],[_0x547126],[_0xacb853],[_0x4c3a54],[_0x4d8922,{'useClass':_0x12ecfd}],[_0x4e0fb2[_0x2fa01c(0x43f)],{'useClass':_0x4e0fb2[_0x2fa01c(0x236)]}],[_0x3fe1f0[_0x2fa01c(0x443)],{'useClass':_0x1e23b0}],[_0x44b1a7[_0x2fa01c(0x319)]],[_0x516750],[_0x261734],[_0x1af4cc],[_0x171e0f],[_0x44b1a7[_0x2fa01c(0x315)]]];this['_config'][_0x2fa01c(0x455)]&&_0x54a336['push']([_0x33fdc9]),_0x39304f[_0x2fa01c(0x1c4)](this['_injector'],_0x39304f[_0x2fa01c(0x1fa)](_0x54a336,(_0x1eef1a=this[_0x2fa01c(0x2cb)])==null?void 0x0:_0x1eef1a[_0x2fa01c(0x1a8)]));}[_0x5de549(0x398)](){const _0x1d16a1=_0x5de549;this['disposeWithMe'](this[_0x1d16a1(0x349)][_0x1d16a1(0x390)](_0x39304f[_0x1d16a1(0x1cf)][_0x1d16a1(0x418)],[_0x43034b])),this[_0x1d16a1(0x24e)](this[_0x1d16a1(0x349)][_0x1d16a1(0x390)](_0x39304f[_0x1d16a1(0x1cf)][_0x1d16a1(0x211)],[_0x338784]));}[_0x5de549(0x1f4)](){const _0x2555f0=_0x5de549;_0x39304f[_0x2555f0(0x452)](this[_0x2555f0(0x31d)],[[_0x1af4cc],[_0x44b1a7[_0x2555f0(0x319)]],[_0x516750],[_0x261734],[_0x44b1a7[_0x2555f0(0x315)]],[_0x2bfa89]]),this['_config'][_0x2555f0(0x455)]&&_0x39304f['touchDependencies'](this[_0x2555f0(0x31d)],[[_0x33fdc9]]);}},_0x4c9030(_0x44b1a7['UniverCollaborationClientUIPlugin'],'pluginName',_0x1dade5),_0x44b1a7[_0x5de549(0x21b)]=_0x53693c([_0x39304f[_0x5de549(0x3e1)](_0x3fe1f0[_0x5de549(0x1ab)]),_0x13208c(0x1,_0x46a3bd[_0x5de549(0x334)]),_0x13208c(0x2,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0x13208c(0x3,_0x39304f[_0x5de549(0x205)])],_0x44b1a7[_0x5de549(0x21b)]);var _0xc03d57=Object[_0x5de549(0x49f)],_0x1b004e=(_0x3df999,_0x5d5603,_0x25f6bb,_0x4ccd40)=>{for(var _0xfa5ea5=_0x4ccd40>0x1?void 0x0:_0x4ccd40?_0xc03d57(_0x5d5603,_0x25f6bb):_0x5d5603,_0x30cae6=_0x3df999['length']-0x1,_0x1dbfe6;_0x30cae6>=0x0;_0x30cae6--)(_0x1dbfe6=_0x3df999[_0x30cae6])&&(_0xfa5ea5=_0x1dbfe6(_0xfa5ea5)||_0xfa5ea5);return _0xfa5ea5;},_0x3ee60e=(_0x217cb7,_0x14f25e)=>(_0x5c2b3e,_0x31fa64)=>_0x14f25e(_0x5c2b3e,_0x31fa64,_0x217cb7);_0x44b1a7['BrowserCollaborationSocketService']=class extends _0x3fe1f0['CollaborationSocketService']{constructor(_0x355588,_0x5ef208,_0x30a48a,_0x12a4e8,_0x10b2bd){super(_0x355588,_0x5ef208,_0x30a48a,_0x12a4e8,_0x10b2bd);}async[_0x5de549(0x1c8)](_0x519145){const _0x12df93=_0x5de549,_0x5347c1=await this['_getSessionTicket'](),_0x582d17=this[_0x12df93(0x3a7)](_0x519145,_0x5347c1);return this[_0x12df93(0x1f5)](_0x582d17);}['_createSocketURL'](_0xbc9b45,_0x5ade35){const _0x546c21=_0x5de549,_0x2f90a0=typeof window>'u'?new URL(_0xbc9b45):new URL(_0xbc9b45,window[_0x546c21(0x457)]['origin']);_0x2f90a0[_0x546c21(0x3ce)]['set'](_0x546c21(0x1ee),_0x5ade35);const _0x408a83=typeof window>'u'?new URLSearchParams():new URLSearchParams(window['location'][_0x546c21(0x48d)]);return _0x408a83[_0x546c21(0x1c0)](_0x546c21(0x428))&&_0x2f90a0[_0x546c21(0x3ce)][_0x546c21(0x361)](_0x546c21(0x428),_0x408a83[_0x546c21(0x1c0)](_0x546c21(0x428))),_0x2f90a0['toString']();}async[_0x5de549(0x2bc)](){const _0x487afd=_0x5de549;var _0x2d2241,_0x4de4fc,_0x4cb55c;const _0x3b8ae0=this[_0x487afd(0x20f)][_0x487afd(0x47f)](_0x3fe1f0['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']),_0x283e1d=(_0x2d2241=_0x3b8ae0==null?void 0x0:_0x3b8ae0['wsSessionTicketUrl'])!=null?_0x2d2241:_0x3fe1f0[_0x487afd(0x1f7)];return(_0x4cb55c=(_0x4de4fc=(await this[_0x487afd(0x40f)][_0x487afd(0x1c0)](_0x283e1d,{'headers':{'Content-Type':_0x487afd(0x466)}}))[_0x487afd(0x20e)])==null?void 0x0:_0x4de4fc['ticket'])!=null?_0x4cb55c:'';}},_0x44b1a7['BrowserCollaborationSocketService']=_0x1b004e([_0x3ee60e(0x0,_0x39304f['Inject'](_0x39304f['Injector'])),_0x3ee60e(0x1,_0x39304f[_0x5de549(0x356)](_0x4e0fb2[_0x5de549(0x469)])),_0x3ee60e(0x2,_0x39304f['IConfigService']),_0x3ee60e(0x3,_0x39304f[_0x5de549(0x25e)]),_0x3ee60e(0x4,_0x560361[_0x5de549(0x4a8)])],_0x44b1a7[_0x5de549(0x3dc)]);var _0x596e83=Object[_0x5de549(0x49f)],_0xe44d28=(_0x531ff5,_0x2dac1b,_0x4d96ec,_0x52ec5e)=>{const _0x52d9e3=_0x5de549;for(var _0x4aae2f=_0x52ec5e>0x1?void 0x0:_0x52ec5e?_0x596e83(_0x2dac1b,_0x4d96ec):_0x2dac1b,_0x27e07e=_0x531ff5[_0x52d9e3(0x3b7)]-0x1,_0x4014d1;_0x27e07e>=0x0;_0x27e07e--)(_0x4014d1=_0x531ff5[_0x27e07e])&&(_0x4aae2f=_0x4014d1(_0x4aae2f)||_0x4aae2f);return _0x4aae2f;},_0x2b5778=(_0x225c71,_0x518d67)=>(_0x45ba7b,_0x28f9cd)=>_0x518d67(_0x45ba7b,_0x28f9cd,_0x225c71);_0x44b1a7[_0x5de549(0x446)]=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x1694d9,_0x36112b,_0x536998){const _0x509258=_0x5de549;super(),this['_instanceService']=_0x1694d9,this[_0x509258(0x40f)]=_0x36112b,this[_0x509258(0x20f)]=_0x536998;}async[_0x5de549(0x395)](_0x2addc0,_0x16ee4c,_0x302d1b,..._0x53ef91){const _0x3d8e43=_0x5de549;var _0xe08d3d,_0x12e47d,_0x53d692,_0x285287;const _0x48e4c2=this['_instanceService'][_0x3d8e43(0x3ae)]();if(!_0x48e4c2)throw new Error(_0x3d8e43(0x49d));const _0x4ceca7=((_0xe08d3d=this[_0x3d8e43(0x20f)][_0x3d8e43(0x47f)](_0x3fe1f0['REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY']))!=null?_0xe08d3d:_0x3fe1f0['DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT'])+'/'+_0x2addc0+_0x3d8e43(0x2a4)+_0x16ee4c,_0x19e7e3=new URL(window['location']['href']),_0x4abfb9={'scriptId':_0x2addc0,'runId':(_0x12e47d=_0x19e7e3[_0x3d8e43(0x3ce)][_0x3d8e43(0x1c0)](_0x3d8e43(0x428)))!=null?_0x12e47d:'','function':_0x16ee4c,'unitId':_0x48e4c2[_0x3d8e43(0x41e)](),'argsOfFunction':JSON['stringify'](_0x53ef91),'invokeId':(_0x53d692=_0x302d1b[_0x3d8e43(0x49c)])!=null?_0x53d692:'','executionId':(_0x285287=_0x302d1b[_0x3d8e43(0x3b5)])!=null?_0x285287:''};try{const _0x318230=await this[_0x3d8e43(0x40f)][_0x3d8e43(0x2b8)](_0x4ceca7,{'body':_0x4abfb9});return _0x318230['body']['error']&&_0x318230[_0x3d8e43(0x20e)][_0x3d8e43(0x2ee)]['code']!==_0x277c13['OK']?'Failed':_0x318230['body'][_0x3d8e43(0x3e5)];}catch{return'Failed';}}},_0x44b1a7['RemoteUniscriptService']=_0xe44d28([_0x2b5778(0x0,_0x39304f[_0x5de549(0x2cc)]),_0x2b5778(0x1,_0x39304f[_0x5de549(0x356)](_0x4e0fb2['HTTPService'])),_0x2b5778(0x2,_0x39304f[_0x5de549(0x205)])],_0x44b1a7[_0x5de549(0x446)]);const _0x13780e=0x7530,_0x3e2726=_0x5de549(0x1f8);class _0x55eb3c extends _0x39304f[_0x5de549(0x1ba)]{constructor(){const _0x46c6b3=_0x5de549;super(),_0x41fabe(this,_0x46c6b3(0x2c8),_0x39304f[_0x46c6b3(0x26d)]()),_0x41fabe(this,_0x46c6b3(0x39f),new Set()),_0x41fabe(this,_0x46c6b3(0x437),new Map()),_0x41fabe(this,_0x46c6b3(0x3f8),null),_0x41fabe(this,_0x46c6b3(0x2eb),new Map()),_0x41fabe(this,'_unitStatus',new Map()),this['_init']();}[_0x5de549(0x2c3)](){const _0x44108d=_0x5de549;super[_0x44108d(0x2c3)](),this[_0x44108d(0x2eb)][_0x44108d(0x22a)]((_0x298182,_0x4ce0b5)=>this[_0x44108d(0x26b)](_0x4ce0b5)),this[_0x44108d(0x3f8)]&&window[_0x44108d(0x24d)](this[_0x44108d(0x3f8)]);}[_0x5de549(0x332)](_0x461314){const _0x1d7467=_0x5de549;return this[_0x1d7467(0x32a)](_0x461314)[_0x1d7467(0x498)](_0x404575[_0x1d7467(0x393)]());}[_0x5de549(0x42b)](_0x303a47){const _0x1aa934=_0x5de549;this['_selfUnitIDs']['size']===0x0&&this['_scheduleHeartbeat'](),this['_selfUnitIDs'][_0x1aa934(0x26c)](_0x303a47),this[_0x1aa934(0x373)]({'type':0x0,'memberID':this[_0x1aa934(0x2c8)],'unitIDs':[_0x303a47],'isForwarded':!0x1});}['disposeUnit'](_0x2182bb){const _0x47ca30=_0x5de549;this[_0x47ca30(0x39f)][_0x47ca30(0x421)](_0x2182bb),this['_selfUnitIDs'][_0x47ca30(0x1ae)]===0x0&&this[_0x47ca30(0x3f8)]&&window['clearInterval'](this[_0x47ca30(0x3f8)]);}[_0x5de549(0x48f)](){const _0x161035=_0x5de549;this['disposeWithMe'](_0x39304f[_0x161035(0x391)](_0x404575[_0x161035(0x2de)](window,_0x161035(0x3dd))['subscribe'](_0x2e1448=>{const _0x586850=_0x161035;if(_0x2e1448[_0x586850(0x1aa)]!==_0x3e2726||!_0x2e1448[_0x586850(0x32b)])return;const _0x11d679=JSON[_0x586850(0x48a)](_0x2e1448['newValue']);this[_0x586850(0x495)](_0x11d679);}))),window[_0x161035(0x34d)](_0x161035(0x226),()=>this['_send']({'type':0x1,'memberID':this['_id'],'unitIDs':Array[_0x161035(0x1bf)](this[_0x161035(0x39f)])}));}[_0x5de549(0x495)](_0x20dfc4){const _0x53e8eb=_0x5de549;switch(_0x20dfc4['type']){case 0x0:this[_0x53e8eb(0x36b)](_0x20dfc4);break;case 0x1:this[_0x53e8eb(0x347)](_0x20dfc4);break;case 0x2:this[_0x53e8eb(0x32d)](_0x20dfc4);break;}}[_0x5de549(0x36b)](_0x28512c){const _0x3fc83a=_0x5de549,{unitIDs:_0x3f2d64,memberID:_0x3d4b1f,isForwarded:_0x3d43ef}=_0x28512c;_0x3f2d64[_0x3fc83a(0x22a)](_0x17cdea=>{const _0x14bf4a=_0x3fc83a;if(!_0x3d43ef&&this[_0x14bf4a(0x437)][_0x14bf4a(0x3f7)](_0x17cdea)&&this[_0x14bf4a(0x32a)](_0x17cdea)[_0x14bf4a(0x345)](_0x3fe1f0[_0x14bf4a(0x1e8)][_0x14bf4a(0x237)]),!this[_0x14bf4a(0x437)][_0x14bf4a(0x3f7)](_0x17cdea)||!this[_0x14bf4a(0x437)][_0x14bf4a(0x1c0)](_0x17cdea)['has'](_0x3d4b1f)){const _0x3355ab=this[_0x14bf4a(0x437)][_0x14bf4a(0x1c0)](_0x17cdea)||new Set();_0x3355ab[_0x14bf4a(0x26c)](_0x3d4b1f),this[_0x14bf4a(0x437)][_0x14bf4a(0x361)](_0x17cdea,_0x3355ab),this['_scheduleClearOtherTimer'](_0x3d4b1f);}}),_0x3d43ef||this[_0x3fc83a(0x373)]({'type':0x0,'memberID':this['_id'],'unitIDs':[...this[_0x3fc83a(0x39f)]],'isForwarded':!0x0});}['_scheduleClearOtherTimer'](_0x275457){const _0xd48f44=_0x5de549;this[_0xd48f44(0x26b)](_0x275457);const _0x75ff0b=window[_0xd48f44(0x338)](()=>{const _0x178dd7=_0xd48f44;this[_0x178dd7(0x437)][_0x178dd7(0x22a)](_0x1c34c5=>{_0x1c34c5['delete'](_0x275457);});},_0x13780e*0x2);this['_clearOtherTimers'][_0xd48f44(0x361)](_0x275457,_0x75ff0b);}[_0x5de549(0x26b)](_0x3f8741){const _0x12bb70=_0x5de549;if(this[_0x12bb70(0x2eb)][_0x12bb70(0x3f7)](_0x3f8741)){const _0x34a8e3=this['_clearOtherTimers']['get'](_0x3f8741);_0x34a8e3&&window[_0x12bb70(0x3e9)](_0x34a8e3),this[_0x12bb70(0x2eb)][_0x12bb70(0x361)](_0x3f8741,null);}}[_0x5de549(0x347)](_0xaa8649){const _0x578c32=_0x5de549,{memberID:_0x2f97ec,unitIDs:_0x178157}=_0xaa8649;_0x178157['forEach'](_0x577486=>{const _0x5702f4=_0x48a1;var _0x55b5c4;const _0x296cd4=this['_unitOnClients'][_0x5702f4(0x1c0)](_0x577486);_0x296cd4&&(_0x296cd4[_0x5702f4(0x421)](_0x2f97ec),(_0x55b5c4=this[_0x5702f4(0x32a)](_0x577486))==null||_0x55b5c4[_0x5702f4(0x345)](_0x296cd4['size']===0x0?_0x3fe1f0['UnitStatus'][_0x5702f4(0x449)]:_0x3fe1f0['UnitStatus']['OTHER_CLIENTS_EDITING']));}),this[_0x578c32(0x26b)](_0x2f97ec);}[_0x5de549(0x32d)](_0x3f05f4){const _0x20f25b=_0x5de549;this[_0x20f25b(0x2d8)](_0x3f05f4[_0x20f25b(0x210)]);}[_0x5de549(0x373)](_0x5a0ca5){localStorage['setItem'](_0x3e2726,JSON['stringify'](_0x5a0ca5));}[_0x5de549(0x41b)](){const _0x206322=_0x5de549;this[_0x206322(0x3f8)]=window[_0x206322(0x37c)](()=>{this['_send']({'type':0x2,'memberID':this['_id']});},_0x13780e);}[_0x5de549(0x32a)](_0x531b08){const _0x291cd1=_0x5de549;return this[_0x291cd1(0x1a9)][_0x291cd1(0x3f7)](_0x531b08)||this['_unitStatus'][_0x291cd1(0x361)](_0x531b08,new _0x404575['BehaviorSubject'](_0x3fe1f0[_0x291cd1(0x1e8)]['NO_OTHER_CLIENTS_EDITING'])),this[_0x291cd1(0x1a9)][_0x291cd1(0x1c0)](_0x531b08);}}_0x44b1a7[_0x5de549(0x26a)]=_0x4d8922,_0x44b1a7[_0x5de549(0x44f)]=_0x3ed0a,_0x44b1a7[_0x5de549(0x474)]=_0x55eb3c,_0x44b1a7[_0x5de549(0x2d0)]=_0x12ecfd,Object[_0x5de549(0x412)](_0x44b1a7,Symbol[_0x5de549(0x36d)],{'value':'Module'});}));function _0x48a1(_0x3ec77b,_0x2f799c){_0x3ec77b=_0x3ec77b-0x1a4;const _0xe03509=_0xe035();let _0x48a183=_0xe03509[_0x3ec77b];return _0x48a183;}function _0xe035(){const _0x514721=['getColor','bottom','_id','_scene','UniverCore','_config','IUniverInstanceService','AWAITING','isTransformMutationsWithChangesetSuccess','_collaborationSessionService','WebURLService','filename','_range','TEXT_RANGE_LAYER_INDEX','complete','requireSession','38uXbool','[LogService\x20Error]:\x20','_scheduleClearOtherTimer','dirtyRanges','MOBILE_VERIFY_CODE_MISMATCH','UPDATE_CURSOR','event$','getUndoRedoMutationParamsCache','fromEvent','_cachedData','univer-flex\x20univer-items-center','getActiveSheet','AWAITING_WITH_PENDING','IUIPartsService','UniverDocsUi','RegularPolygon','_localCacheService','FromArray','_status$','rxjs','formula.calculation.waiting','_clearOtherTimers','_drawAnchor','UNDEFINED','error','FETCH_MISS','YUUMI_ALL_TABLES_IS_INVALID','isEditing','onPointerEnter$','path','RichTextEditingMutation','1em','operators','EffectRefRangId','then','getCurrentSelections','INVALID_INVITE_CODE','unitId','YUUMI_UNABLE_LOAD_URL','onCommandExecuted','@univerjs/rpc','_docSyncEditingCollabCursorService','IImageIoService','substring','getColorFromTheme','getCurrentRevOfUnit','imageSourceType','endColumn','UNAUTHENTICATED','setAlpha','getSheetId','map','_uiPartsService','DocSkeletonManagerService','colorChannel1','getSkeleton','docStateChange$','IBeforeCloseService','_localStorageService','@univerjs/sheets-ui','entityInit$','use','_setFormulaLimitStatus','CollaborationDataLoaderController','min','_docSkeletonManagerService','currentSkeleton$','DesktopCollaborationStatusDisplayController','activeSheet$','fillStyle','_dataLoaderService','_injector','collaboration.closeRoom','0\x200\x2016\x2016','restore','_urlService','urlChange$','IMessageService','LOGIN_TOKEN_PROCESSING_FAILED','DisposableCollection','CLOSE_ROOM','OFFLINE','type','CollaborationStatus','_ensureSubject','newValue','saveTaskMap','_handleHeartbeatEvent','triggerDblclick','saveOfflineData','subUnitId','TOO_MANY_REQUESTS','getUnitStatus$','_themeService','IRenderManagerService','getCurrent','idSuffix','UniverSheets','setTimeout','_handleHover','transformSelections','SetSelectionsOperation','useObservable','CollaborationUIEventId','_commandService','_context','ENTITLE_CHAT_LIMIT_EXCEED','_getFormulaLimitStatus','transformIMECache','_initUnhandledRejectionListener','_docSkeleton','next','_onCursorDelete','_handleLeaveEvent','_render','_renderManagerService','_saveCache','exhaustSavingTask','sessionStatus$','addEventListener','_toggleOnline','some','getParam','connectInjector','OTHER_CLIENT_EDITING','limitInfo','_startDocCollabCursor','totalFormulasToCalculate','Inject','getLocalCacheKey','CanceledError','div','3542600xJygBe','fillText','ENTITLE_COUPON_EXPIRED','ENTITLE_DUP_SUBSCRIPTION','roomMembers$','_cursorInfo$','_entities','set','ENTITLE_INSUFFICIENT_QUOTA','PENDING','getTypeOfUnitAdded$','getCoordByCell','SheetSkeletonManagerService','row','selection','_removeCollabCursors','_backgroundColor','_handleJoinEvent','code','toStringTag','PY_RUNTIME_SCRIPT_ERROR','...','Warning','@univerjs-pro/collaboration','isArray','_send','setParam','M0\x200H16V16H0z','_roomMembers$','collaboration.single-unit.warning','updateOfflineData','CURRENT_STATUS_CANNOT_OPERATE','InsertRangeMoveRightCommandId','YUUMI_RATE_OVER_LIMIT','setInterval','transformMutation','ITransformService','isFormulaString','selections','height','currentTheme$','whenReady','_monkeyPatchLogService','Error','YUUMI_URL_COL_OUT_OF_RANGE','takeUntil','measureText','url(#off-line-icon_clip0_910_343)','NodePositionConvertToCursor','ENTITLE_REPORT_LIMIT_EXCEED','EMAIL_HAS_BEEN_BOUND','show','subscribe','setUndoRedoMutationParamsCache','registerRenderModule','toDisposable','white','distinctUntilChanged','merge','runOnServer','IDocClipboardService','MUTATION','_registerRenderDependencies','6XetXdA','REDEMPTION_CODE_FULLY_REDEEMED','collaboration.offline-data-not-saved','Rect','TRANSFORM_CHANGE_OBSERVABLE_TYPE','_initUserListener','_selfUnitIDs','ranges','getOffsetConfig','INVALID_ARGUMENT','INTERNAL_ERROR','_lastPointer','getCollabEntity$','START_CALCULATION','_createSocketURL','_assignedColors','PAYMENT_CHANNEL_NOT_SUPPORT','CONNECTOR_DATA_TOO_LARGE','deepClone','collab-rect-range-','CONFLICT','getFocusedUnit','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','join','_docStateChangeManagerService','startsWith','@univerjs/drawing','\x20at\x20','executionId','uni.network.url-service','length','_drawRectRange','SHEET_VIEWPORT_KEY','getMergeData','round','APPLY_NON_SEQUENTIAL_REVISION','displayName','history','ICommandService','_cursorShapes','_localeService','MOBILE_HAS_BEEN_BOUND','drawWith','transformMutationsWithChangeset','USER_NOT_INVITED_CODE','bind','unit','_anchorDot','addHandlerCallback','setItem','url(#$1','_initEntityListener','_initCommandInterceptor','searchParams','popstate','pushState','useDependency','Tooltip','off-line-icon','_beforeCloseService','handleIRemoveRow','width','cursorInfo','saveImage','exports','getAncestorScale','formula.calculation.started','BrowserCollaborationSocketService','storage','COLORS','_setupSubUnitSync','syncEditingCollabCursor','DependentOn','setShapeProps','xlink:href','UniverDrawing','result','_draw','_entityInit$','_docTransformStateCacheService','clearTimeout','ENTITLE_INVALID_COUPON_CODE','getCollabCursors$','off-line-icon_clip0_910_343','React','handleDeleteRangeMoveUp','onStarting','toRgbString','transformByState','eventID','FormulaExecuteStageType','LocaleService','MemberService','REDEMPTION_INVALID_CODE','has','_heartbeatTimer','subscribeEvent','_getScale','throttleTime','getValue','isTransformMutationFailure','evenodd','onPointerMove$','entries','/universer-api/frontend/logs','fill','_transformService','mutations','UniverNetwork','16806gYtOTL','APPLY_DUPLICATED','DATA_SOURCE_TOO_LARGE','clsx','_cursor','USER_IS_ANONYMOUS','registerComponent','HEADER_MENU','MoveRangeCommandId','_httpService','includes','_lastResponseTimestamp','defineProperty','_memberService','getTypeOfUnitDisposed$','getSheetObject','/universer-api/license/formula/limit/status','defIds','UNIVER_DOC','InsertColCommandId','stageInfo','_scheduleHeartbeat','enableLocalCache','Plugin','getUnitId','socket$','blue.400','delete','_session','RxDisposable','rxjs/operators','getRelativeToViewportCoord','UNRECOGNIZED','react/jsx-runtime','runId','LICENSE_IMPORT_SIZE_EXCEEDED','disableLocalCache','editingUnit','actions','getRangePointData','backgroundColor','unitID','_toggleOffline','DOC_RANGE_TYPE','_refRangeService','COMPLETION_FINISHED','SessionStatus','parseInt','_color','_unitOnClients','3582780XfDNln','@univerjs/docs','_logService','loadOfflineData','isFormulaId','ONLINE','PERMISSION_DENIED','ISocketService','_getSheetObject','_initResize','_drawTextRange','ILocalCacheService','transformStateCache','USER_NOT_FOUND','RemoteUniscriptService','YUUMI_SUBSCRIPTION_NOT_FOUND','params','NO_OTHER_CLIENTS_EDITING','contains','_onCursorUpdate','maxFormulaLimit','push','_checkCalculationAvailable','SheetCollabCursorShape','univerjs-icon\x20univerjs-icon-','Shape','touchDependencies','isActive','attrs','enableFrontendLog','_updateSubUnitFromURLParams','location','RevisionService','LOCAL_CACHE_INTERVAL_KEY','_syncEditingCollabCursorService','debug','_uploadLog','CHANGESET_REVISION_CONFILICT','createElement','arc','jsx','setStateCache','REDEMPTION_CODE_INACTIVE','defs','getActiveRange','_hideTimer','application/json','_currentUsage','addObject','HTTPService','currentColor','_getAnchorBounding','random','LOGIN_FAILED','transformRemoteChangeset','split','lineTo','YUUMI_AI_RUN_FAILED','_startSheetCollabCursor','_imageIoService','WebBrowserSingleActiveUnitService','NOT_COLLAB','doc.mutation.rich-text-editing','color','on-line-icon','findNodePositionByCharIndex','catch','UniverDocs','_name','_eventUnsubscribe','removeEventListener','getConfig','jiqing.500','yellow.400','init','tag','debounce','sheetID','_collabCursorState$','IRemoteInstanceService','SetTextSelectionsOperation','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','parse','_revisionService','DocStateChangeManagerService','search','now','_init','Unknown\x20user','ENSURE_SNAPSHOT_EXECUTION','toString','unhandledrejection','YUUMI_CONNECTOR_URL_NOT_FOUND','_handleEvent','ALREADY_EXISTS','children','pipe','SNAPSHOT_INVALID_SNAPSHOT','TEXT','CollaborationUIEventService','invokeId','[RemoteUniscriptService]:\x20no\x20focused\x20unit','@univerjs/design','getOwnPropertyDescriptor','collabStatus.conflict','_updateCollabCursors','closePath','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','USERS_LEAVE','[Unhandled\x20Rejection]:\x20','#FFF','ISnapshotServerService','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','fromEventSubject','_updateURLWithCurrentState','[CollaborationDataLoaderController]','startRow','override','_unitStatus','key','UniverCollaborationClientPlugin','_registerDependencies','DeleteRangeMoveUpCommandId','size','getMemberID','SetFormulaCalculationStartMutation','RECT','flatMap','reconnect','_initStatusListener','UniverProCollaborationClient','collab-text-anchor-','_online','_memberID','endRow','Disposable','NOT_FOUND','makeDirty','collab-text-range-','stage','from','get','ERROR_AGAIN','unsubscribe','message','registerDependencies','_collabCursorController','filter','_colorAssignService','createSocket','handleMoveRange','_hover','handleInsertRow','NodePositionConvertToRectRange','string','DocCollaborationEntity','UniverInstanceType','/universer-api/license/formula/limit/done','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','getVpScrollXYInfoByPosToVp','AUTHORIZE_CODE_ILLEGAL','/universer-api/license/formula/limit/start','top','_disabled','m1Prime','save','YUUMI_NO_CUBOID_FOR_QUESTION','CollaborationEvent','session.connection-failed','_updateLocalCursor','replace','getMember','REDEMPTION_USER_REDEEM_TIMES_EXCEED','m2Prime','_getMergeRange','formula.calculation.unable','@univerjs/docs-ui','OnLineIcon','6509889OWujhq','getDocRanges','_hasFormulaInDirtyRanges','UnitStatus','_hovered','onLocalMutation','_transformUndoRedoStack','Tools','SNAPSHOT_HAS_BEEN_REMOVED','sessionTicket','SetDocZoomRatioOperation','getCellMatrix','ILocalStorageService','_releaseCalculationLimit','SOCKET_FAILED_RETRY','_initDependencies','_doCreateSocket','range','DEFAULT_WS_SESSION_TICKET_URL','ACTIVE_UNIT_EVENT_CHANNEL','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','mergeOverrideWithDependencies','fillRule','collabStatus.fetchMiss','_collaborationController','@univerjs/engine-formula','LICENSE_DISTRO_REJECTED','send','_transformHistoryAndStateStack','react','labelPosition','SheetsSelectionsService','IConfigService','_labelPosition','DataLoaderService','CommandType','ENTITLE_CAN_NOT_BUY_LOWER_OTP','handleDeleteRangeMoveLeft','SUBMIT_CHANGESET_TIMEOUT','DocSelectionManagerService','jsxs','body','_configService','memberID','UNIVER_SHEET','hide','UniverProCollaboration','@univerjs/network','_taskIds','collabStatus.syncing','0\x200\x2017\x2016','reason','registerRefRange','getRenderById','UniverCollaborationClientUIPlugin','FormulaExecutedStateType','onPointerLeave$','object','assignAColorForMemberID','collabStatus.offline','createIdentifier','undoState','releaseFormulaLimitUrl','5443844DxUaeI','textRanges','unload','_applyCommand','RefRangeService','_setupBeforeClosingHandler','forEach','REDEMPTION_CODE_HAS_BEEN_CREATED','_textBubble','_messageService','all','CollaborationSessionService','stringify','name','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','url(#on-line-icon_clip0_910_349)','forwardRef','INVITE_CODE_REQUIRED','WebSocketService','OTHER_CLIENTS_EDITING','onRendered','getUnhiddenWorksheets','_initEvent','purple.300','APPLY_PERMISSION_DENIED','stack','_docTransformIMECacheService','moveTo','status$','dispose$','MessageType','session.will-retry','YUUMI_ASYNCIO_CANCELLED','onMouseMove','LICENSE_EXPORT_SIZE_EXCEEDED','debounceTime','SUCCESS','ENTITLE_COUPON_USED_UP','Vector2','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','Optional','clearInterval','disposeWithMe','_collabSessionService','_collaborationUIEventService','RemoveRowCommandId','beginPath','ColorKit','permission.content','InsertRangeMoveDownCommandId','@univerjs/core','permission.title','APPLY_REVISION_CONFILICT','beforeCommandExecuted','APPLY_REJECT','BehaviorSubject','_anchor','href','ILogService','3703021xAPbgu','black','getStateCache','WECHAT_HAS_BEEN_BOUND','VIEW_MAIN','SetWorksheetActivateCommand','registerBeforeClose','_scheduleSaving','UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN','collab-client.tooltip.reconnect','UniverSheetsUi','IURLService','_removeClearOtherTimer','add','generateRandomId','_univerInstanceService','source','EMAIL_VERIFY_CODE_MISMATCH','_sheetSkeletonManagerService','hovered','currentUsage','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','executeCommand','collabStatus.synced','symbol','DocIMEInputManagerService','REDEMPTION_CODE_NOT_STARTED','trim','useRef','_maxFormulaLimit','handleInsertCol','replaceState','UniverProCollaborationClientUi','skeleton','@univerjs/engine-render','unshift','assign','REDEMPTION_USER_NOT_ELIGIBLE','lineno','startColumn','switchMap','_saveTaskMap','sheetId','subunit','_initWindowErrorListener','_checkAndWaitForCalculationPermission','CollaborationController','session.collaboration-timeout','text','_shapes','handleInsertRangeMoveRight','mask','redoState','_getSaveTimeout','_refreshCollabCursors','getSheetBySheetId','ThemeService','data','Loading','SetFormulaCalculationNotificationMutation','RemoveColCommandId','focused$','?taskId=','with','_pollingInterval','setActiveRange','svg','OffLineIcon','column','/run/','SYNCED','asObservable','ENTITLE_USE_COUPON_NOT_1ST_TRADE','roomMembers','http://www.w3.org/2000/svg','collabStatus.notCollab','INVITE_CODE_ALREADY_BOUND','_initCommandExecutedListener','_cursors','getformulaLimitStatusUrl','cursorInfo$','removeParam','759260kWJjFy','UniverDesign','handleIRemoveCol','ENTITLE_NEED_BILLING_ADDRESS','@univerjs-pro/collaboration-client','Workbook','rgba(255,\x20255,\x20255,\x200.01)','post','getUniverSheetInstance','values','Success','_getSessionTicket','Injector','_onRefRangeChange','_clearPolling','UniverRpc','collabCursorState$','_colorIndex','dispose','@univerjs/ui','max'];_0xe035=function(){return _0x514721;};return _0xe035();}