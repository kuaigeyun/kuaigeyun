'use strict';const _0x108f61=_0x5f13;(function(_0x4825a9,_0x18eefb){const _0x4ce012=_0x5f13,_0x3f0042=_0x4825a9();while(!![]){try{const _0x55e198=parseInt(_0x4ce012(0x11b))/0x1*(-parseInt(_0x4ce012(0x38d))/0x2)+parseInt(_0x4ce012(0x15b))/0x3+parseInt(_0x4ce012(0x30a))/0x4+parseInt(_0x4ce012(0x119))/0x5+parseInt(_0x4ce012(0x32f))/0x6+-parseInt(_0x4ce012(0x3aa))/0x7+-parseInt(_0x4ce012(0x132))/0x8*(parseInt(_0x4ce012(0x2ad))/0x9);if(_0x55e198===_0x18eefb)break;else _0x3f0042['push'](_0x3f0042['shift']());}catch(_0x52e5ce){_0x3f0042['push'](_0x3f0042['shift']());}}}(_0xe0ef,0x343d2));var Xe=Object[_0x108f61(0x1d2)],Ke=(_0x47b080,_0x57a3e8,_0x5f1f18)=>_0x57a3e8 in _0x47b080?Xe(_0x47b080,_0x57a3e8,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x5f1f18}):_0x47b080[_0x57a3e8]=_0x5f1f18,_=(_0x285588,_0x4b9c0b,_0x356fe6)=>Ke(_0x285588,typeof _0x4b9c0b!=_0x108f61(0x135)?_0x4b9c0b+'':_0x4b9c0b,_0x356fe6);Object[_0x108f61(0x1d2)](exports,Symbol['toStringTag'],{'value':'Module'});const M=require('react/jsx-runtime'),u=require('@univerjs-pro/collaboration-client'),a=require('@univerjs/core'),O=require('@univerjs/ui'),I=require('rxjs'),p=require('@univerjs/design'),A=require('react'),qe=require('@univerjs/rpc'),v=require('@univerjs/sheets'),C=require('@univerjs/engine-render'),x=require('@univerjs/network'),T=require('@univerjs/docs-ui'),ze=require('@univerjs/drawing'),g=require('@univerjs-pro/collaboration'),V=require('@univerjs/docs'),B=require('@univerjs/engine-formula'),$=require('rxjs/operators'),J=require('@univerjs/sheets-ui');function pe({ref:_0x698f10,..._0x2a5746}){const _0x27cb7e=_0x108f61,{icon:_0x5d2977,id:_0x4c8363,className:_0x24bad6,extend:_0x25c842,..._0x25403d}=_0x2a5746,_0x38a336=(_0x27cb7e(0x176)+_0x4c8363+'\x20'+(_0x24bad6||''))[_0x27cb7e(0x31c)](),_0x1b01ec=A['useRef']('_'+Qe());return $e(_0x5d2977,''+_0x4c8363,{'defIds':_0x5d2977['defIds'],'idSuffix':_0x1b01ec['current']},{'ref':_0x698f10,'className':_0x38a336,..._0x25403d},_0x25c842);}function $e(_0x5c26fe,_0x19a1f7,_0x38303d,_0x44c78b,_0x5212d1){const _0x41fc16=_0x108f61;return A['createElement'](_0x5c26fe['tag'],{'key':_0x19a1f7,...Je(_0x5c26fe,_0x38303d,_0x5212d1),..._0x44c78b},(Ze(_0x5c26fe,_0x38303d)[_0x41fc16(0x22a)]||[])['map']((_0x59dae2,_0x19560c)=>$e(_0x59dae2,_0x19a1f7+'-'+_0x5c26fe[_0x41fc16(0x2d7)]+'-'+_0x19560c,_0x38303d,void 0x0,_0x5212d1)));}function Je(_0x52305e,_0x15954,_0x3cb210){const _0x261bb7=_0x108f61,_0x4539a3={..._0x52305e[_0x261bb7(0x247)]};_0x3cb210!=null&&_0x3cb210[_0x261bb7(0x1a4)]&&_0x4539a3[_0x261bb7(0x303)]===_0x261bb7(0x1a4)&&(_0x4539a3[_0x261bb7(0x303)]=_0x3cb210['colorChannel1']),_0x52305e['tag']===_0x261bb7(0x11c)&&_0x4539a3['id']&&(_0x4539a3['id']=_0x4539a3['id']+_0x15954[_0x261bb7(0x3b9)]),Object[_0x261bb7(0x351)](_0x4539a3)[_0x261bb7(0xf8)](([_0x221d66,_0x1fc39e])=>{const _0x3d0104=_0x261bb7;_0x221d66===_0x3d0104(0x11c)&&typeof _0x1fc39e==_0x3d0104(0x149)&&(_0x4539a3[_0x221d66]=_0x1fc39e['replace'](/url\(#(.*)\)/,_0x3d0104(0x368)+_0x15954[_0x3d0104(0x3b9)]+')'));});const {defIds:_0x1f3826}=_0x15954;return!_0x1f3826||_0x1f3826[_0x261bb7(0x14d)]===0x0||(_0x52305e[_0x261bb7(0x2d7)]===_0x261bb7(0x1e3)&&_0x4539a3[_0x261bb7(0x13c)]&&(_0x4539a3['xlink:href']=_0x4539a3[_0x261bb7(0x13c)]+_0x15954[_0x261bb7(0x3b9)]),Object[_0x261bb7(0x351)](_0x4539a3)[_0x261bb7(0xf8)](([_0x6a186c,_0x294ca2])=>{const _0x2a8c0a=_0x261bb7;typeof _0x294ca2==_0x2a8c0a(0x149)&&(_0x4539a3[_0x6a186c]=_0x294ca2[_0x2a8c0a(0x272)](/url\(#(.*)\)/,_0x2a8c0a(0x368)+_0x15954[_0x2a8c0a(0x3b9)]+')'));})),_0x4539a3;}function Ze(_0x2c0b50,_0x188470){const _0x5c53ed=_0x108f61;var _0x64b96a;const {defIds:_0x4ff903}=_0x188470;return!_0x4ff903||_0x4ff903['length']===0x0?_0x2c0b50:_0x2c0b50[_0x5c53ed(0x2d7)]==='defs'&&((_0x64b96a=_0x2c0b50[_0x5c53ed(0x22a)])!=null&&_0x64b96a[_0x5c53ed(0x14d)])?{..._0x2c0b50,'children':_0x2c0b50[_0x5c53ed(0x22a)]['map'](_0x49500a=>typeof _0x49500a[_0x5c53ed(0x247)]['id']==_0x5c53ed(0x149)&&_0x4ff903&&_0x4ff903[_0x5c53ed(0x36c)](_0x49500a[_0x5c53ed(0x247)]['id'])?{..._0x49500a,'attrs':{..._0x49500a[_0x5c53ed(0x247)],'id':_0x49500a[_0x5c53ed(0x247)]['id']+_0x188470[_0x5c53ed(0x3b9)]}}:_0x49500a)}:_0x2c0b50;}function Qe(){const _0x3896f3=_0x108f61;return Math[_0x3896f3(0x2cb)]()[_0x3896f3(0x26c)](0x24)[_0x3896f3(0x34a)](0x2,0x8);}pe['displayName']=_0x108f61(0x223);const et={'tag':_0x108f61(0x123),'attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':_0x108f61(0x19f),'viewBox':_0x108f61(0x2b4),'width':_0x108f61(0x129),'height':_0x108f61(0x129)},'children':[{'tag':'g','attrs':{'clipPath':_0x108f61(0x36e)},'children':[{'tag':_0x108f61(0x313),'attrs':{'stroke':_0x108f61(0x1ef),'d':_0x108f61(0x159),'strokeLinecap':_0x108f61(0x289),'strokeLinejoin':_0x108f61(0x289),'strokeWidth':1.2}}]},{'tag':_0x108f61(0x1e4),'attrs':{},'children':[{'tag':_0x108f61(0x34e),'attrs':{'id':_0x108f61(0x2db)},'children':[{'tag':'path','attrs':{'fill':_0x108f61(0x226),'d':_0x108f61(0x203)}}]}]}],'defIds':['off-line-icon_clip0_910_343']},xe=A[_0x108f61(0x312)](function(_0x2186d1,_0x49ba56){const _0x185f1d=_0x108f61;return A[_0x185f1d(0x205)](pe,Object[_0x185f1d(0x30e)]({},_0x2186d1,{'id':_0x185f1d(0x2b5),'ref':_0x49ba56,'icon':et}));});xe[_0x108f61(0x173)]=_0x108f61(0x1aa);const tt={'tag':'svg','attrs':{'xmlns':_0x108f61(0x1e9),'fill':_0x108f61(0x19f),'viewBox':_0x108f61(0x2a4),'width':_0x108f61(0x129),'height':_0x108f61(0x129)},'children':[{'tag':'g','attrs':{'clipPath':_0x108f61(0x38b)},'children':[{'tag':'path','attrs':{'stroke':_0x108f61(0x1ef),'d':'M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','strokeLinecap':_0x108f61(0x289),'strokeLinejoin':_0x108f61(0x289),'strokeWidth':1.2}}]},{'tag':_0x108f61(0x1e4),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x108f61(0x2d1)},'children':[{'tag':'path','attrs':{'fill':_0x108f61(0x226),'d':_0x108f61(0x203),'transform':_0x108f61(0x1f5)}}]}]}],'defIds':[_0x108f61(0x2d1)]},Be=A[_0x108f61(0x312)](function(_0xc3664f,_0x9b771c){const _0x233337=_0x108f61;return A[_0x233337(0x205)](pe,Object[_0x233337(0x30e)]({},_0xc3664f,{'id':'on-line-icon','ref':_0x9b771c,'icon':tt}));});Be[_0x108f61(0x173)]=_0x108f61(0x363);function st(_0x24b25f){const _0x22d033=_0x108f61;switch(_0x24b25f){case u[_0x22d033(0x32d)][_0x22d033(0x3c0)]:return _0x22d033(0x322);case u[_0x22d033(0x32d)]['CONFLICT']:return _0x22d033(0x19c);case u[_0x22d033(0x32d)][_0x22d033(0x1bc)]:return'collabStatus.fetchMiss';case u[_0x22d033(0x32d)][_0x22d033(0x162)]:return _0x22d033(0x3a6);case u[_0x22d033(0x32d)][_0x22d033(0x240)]:case u[_0x22d033(0x32d)][_0x22d033(0x2e7)]:return'collabStatus.syncing';case u[_0x22d033(0x32d)][_0x22d033(0x1f7)]:case u[_0x22d033(0x32d)][_0x22d033(0x116)]:return _0x22d033(0xf7);}}function it(_0x260db4){const _0x350b18=_0x108f61,{status$:_0xb84a58}=_0x260db4,_0xedea4d=O['useObservable'](_0xb84a58,u[_0x350b18(0x32d)][_0x350b18(0x162)]),_0x1bb666=O['useDependency'](a[_0x350b18(0x179)]),_0x4d179f=O['useDependency'](u[_0x350b18(0x2af)]),_0x4c8d14=_0xedea4d!==u['CollaborationStatus']['OFFLINE'],_0x55403a=_0x1bb666['t'](st(_0xedea4d)),_0x204bd3=_0x4c8d14?M[_0x350b18(0x33c)](Be,{}):M[_0x350b18(0x33c)](xe,{}),_0x11bf33=A[_0x350b18(0x284)](()=>{const _0x35efe5=_0x350b18;_0x4c8d14||_0x4d179f[_0x35efe5(0x2d5)]();},[_0x4c8d14,_0x4d179f]);function _0x25afd7(){const _0xc5ed77=_0x350b18;return M[_0xc5ed77(0x2e4)](_0xc5ed77(0x17c),{'className':_0xc5ed77(0x222),'onClick':_0x11bf33,'children':[M[_0xc5ed77(0x33c)](_0xc5ed77(0x17c),{'className':p[_0xc5ed77(0x339)]('univer-mr-2\x20univer-flex\x20univer-text-xl',{'univer-text-green-500':_0x4c8d14,'univer-text-red-500':!_0x4c8d14}),'children':_0x204bd3}),M[_0xc5ed77(0x33c)](_0xc5ed77(0x17c),{'className':_0xc5ed77(0x178),'children':_0x55403a})]});}return _0x4c8d14?_0x25afd7():M[_0x350b18(0x33c)](p[_0x350b18(0x263)],{'title':_0x1bb666['t'](_0x350b18(0x2e2)),'children':_0x25afd7()});}var nt=Object[_0x108f61(0x37b)],rt=(_0x3bc869,_0x380c20,_0x2fb23d,_0x324ba9)=>{const _0x21870a=_0x108f61;for(var _0x1a9b1e=_0x324ba9>0x1?void 0x0:_0x324ba9?nt(_0x380c20,_0x2fb23d):_0x380c20,_0x6a6ad4=_0x3bc869[_0x21870a(0x14d)]-0x1,_0x55cb87;_0x6a6ad4>=0x0;_0x6a6ad4--)(_0x55cb87=_0x3bc869[_0x6a6ad4])&&(_0x1a9b1e=_0x55cb87(_0x1a9b1e)||_0x1a9b1e);return _0x1a9b1e;},K=(_0x3423fd,_0x23c7f6)=>(_0x55ee09,_0x4f4a18)=>_0x23c7f6(_0x55ee09,_0x4f4a18,_0x3423fd);exports[_0x108f61(0x256)]=class extends a[_0x108f61(0x3b6)]{constructor(_0x19f17a,_0x419c8c,_0x1e8c29,_0x34ca69){const _0x347f09=_0x108f61;super(),_(this,_0x347f09(0x286),new I[(_0x347f09(0x391))](u[_0x347f09(0x32d)]['NOT_COLLAB'])),(this[_0x347f09(0x311)]=_0x19f17a,this[_0x347f09(0x266)]=_0x419c8c,this[_0x347f09(0x246)]=_0x1e8c29,this[_0x347f09(0x35e)]=_0x34ca69,this[_0x347f09(0x1cb)](),this['_initStatusListener']());}[_0x108f61(0x2d8)](){const _0x257e1c=_0x108f61;this[_0x257e1c(0x1d6)](this['_univerInstanceService']['focused$']['pipe'](I[_0x257e1c(0x1c1)](()=>{const _0x493b18=_0x257e1c,_0xadc6e6=this[_0x493b18(0x311)]['getFocusedUnit']();return _0xadc6e6?this[_0x493b18(0x246)][_0x493b18(0x2dc)](_0xadc6e6[_0x493b18(0xf9)]()):I['of'](null);}),I['switchMap'](_0x25ac35=>_0x25ac35?_0x25ac35[_0x257e1c(0x16a)]:I['of'](u[_0x257e1c(0x32d)]['NOT_COLLAB'])))[_0x257e1c(0x346)](_0x4f0c36=>{const _0x51abc4=_0x257e1c;this[_0x51abc4(0x286)][_0x51abc4(0x120)](_0x4f0c36);}));}[_0x108f61(0x1cb)](){const _0x1fecd3=_0x108f61;this[_0x1fecd3(0x1d6)](this[_0x1fecd3(0x35e)][_0x1fecd3(0x1ab)](O['BuiltInUIPart']['HEADER_MENU'],()=>O['connectInjector'](ot({'status$':this['_status$']['asObservable']()}),this[_0x1fecd3(0x266)])));}},exports[_0x108f61(0x256)]=rt([K(0x0,a['IUniverInstanceService']),K(0x1,a[_0x108f61(0x230)](a[_0x108f61(0x1e8)])),K(0x2,a[_0x108f61(0x230)](u[_0x108f61(0x328)])),K(0x3,O[_0x108f61(0x356)])],exports[_0x108f61(0x256)]);function ot(_0x55405b){const {status$:_0x399dff}=_0x55405b;return function(){const _0x59fe28=_0x5f13;return M[_0x59fe28(0x33c)](it,{'status$':_0x399dff});};}const Oe=a[_0x108f61(0x3a7)]('uni.network.url-service');var at=Object[_0x108f61(0x37b)],ct=(_0x19eb31,_0x515f73,_0x45c1df,_0x238279)=>{for(var _0x3ed935=_0x238279>0x1?void 0x0:_0x238279?at(_0x515f73,_0x45c1df):_0x515f73,_0x3ab679=_0x19eb31['length']-0x1,_0x5bc710;_0x3ab679>=0x0;_0x3ab679--)(_0x5bc710=_0x19eb31[_0x3ab679])&&(_0x3ed935=_0x5bc710(_0x3ed935)||_0x3ed935);return _0x3ed935;},Y=(_0x2a6caf,_0x57e78e)=>(_0x276451,_0x16b076)=>_0x57e78e(_0x276451,_0x16b076,_0x2a6caf);exports['CollaborationDataLoaderController']=class extends a[_0x108f61(0x217)]{constructor(_0x445e97,_0x51a0bf,_0x272d69,_0x4e3970,_0x5cc0a2){const _0x31a8ed=_0x108f61;super(),this[_0x31a8ed(0x260)]=_0x445e97,this[_0x31a8ed(0x214)]=_0x51a0bf,this[_0x31a8ed(0x34d)]=_0x272d69,this[_0x31a8ed(0x25f)]=_0x4e3970,_0x5cc0a2?_0x5cc0a2==null||_0x5cc0a2['whenReady']()[_0x31a8ed(0x3af)](()=>this[_0x31a8ed(0x239)]()):(this[_0x31a8ed(0x214)]['debug'](_0x31a8ed(0x136),_0x31a8ed(0x17a)),this[_0x31a8ed(0x239)]());}async['_init'](){const _0x38bcaa=_0x108f61,_0xec07fa=this[_0x38bcaa(0x260)]['getParam'](_0x38bcaa(0x291)),_0x144615=this['_urlService'][_0x38bcaa(0xed)]('type'),_0x6fa555=this['_urlService'][_0x38bcaa(0xed)](_0x38bcaa(0x23b));if(!_0xec07fa||!_0x144615){this[_0x38bcaa(0x214)][_0x38bcaa(0x318)](_0x38bcaa(0x136),_0x38bcaa(0x105));return;}const _0x5d138b=await this[_0x38bcaa(0x25f)]['loadUnit'](_0xec07fa,Number(_0x144615),_0x6fa555);_0x5d138b&&_0x5d138b instanceof a[_0x38bcaa(0x153)]&&this[_0x38bcaa(0x326)](_0x5d138b);}async[_0x108f61(0x326)](_0x26e3df){const _0x29830f=_0x108f61;await this[_0x29830f(0x33a)](_0x26e3df),_0x26e3df[_0x29830f(0x2a0)][_0x29830f(0x143)](I['takeUntil'](this[_0x29830f(0x251)]))[_0x29830f(0x346)](_0x5b5b9f=>{_0x5b5b9f&&this['_updateURLWithCurrentState'](_0x5b5b9f);}),this[_0x29830f(0x260)][_0x29830f(0x29a)][_0x29830f(0x143)](I['takeUntil'](this['dispose$']))['subscribe'](()=>this[_0x29830f(0x33a)](_0x26e3df));}['_updateURLWithCurrentState'](_0x21d4eb,_0x3f4222=!0x1){const _0x3f717f=_0x108f61,_0x85d7d4=this[_0x3f717f(0x260)]['getParam'](_0x3f717f(0x23b));_0x21d4eb[_0x3f717f(0xff)]()!==_0x85d7d4&&this['_urlService'][_0x3f717f(0x122)](_0x3f717f(0x23b),_0x21d4eb[_0x3f717f(0xff)](),_0x3f4222);}async[_0x108f61(0x33a)](_0x1eb89f){const _0x5f0f31=_0x108f61;var _0x103394;const _0x5f1d40=this[_0x5f0f31(0x260)]['getParam'](_0x5f0f31(0x23b));if(!_0x5f1d40||!_0x1eb89f[_0x5f0f31(0x236)](_0x5f1d40)){const _0x2721b3=_0x1eb89f[_0x5f0f31(0x1b8)]()[0x0],_0x271e0e=_0x1eb89f[_0x5f0f31(0x236)](_0x2721b3);if(!_0x271e0e)return;this[_0x5f0f31(0x33e)](_0x271e0e,!0x0),await this[_0x5f0f31(0x34d)][_0x5f0f31(0x28d)](v[_0x5f0f31(0x161)]['id'],{'unitId':_0x1eb89f[_0x5f0f31(0xf9)](),'subUnitId':_0x2721b3});return;}((_0x103394=_0x1eb89f[_0x5f0f31(0x2e5)]())==null?void 0x0:_0x103394[_0x5f0f31(0xff)]())!==_0x5f1d40&&await this['_commandService'][_0x5f0f31(0x28d)](v[_0x5f0f31(0x161)]['id'],{'unitId':_0x1eb89f['getUnitId'](),'subUnitId':_0x5f1d40});}},exports[_0x108f61(0x374)]=ct([Y(0x0,Oe),Y(0x1,a['ILogService']),Y(0x2,a[_0x108f61(0x225)]),Y(0x3,a['Inject'](u['DataLoaderService'])),Y(0x4,a[_0x108f61(0x21a)](qe[_0x108f61(0x106)]))],exports[_0x108f61(0x374)]);function _0x5f13(_0x5005e2,_0x35bee5){_0x5005e2=_0x5005e2-0xed;const _0xe0ef0c=_0xe0ef();let _0x5f13f3=_0xe0ef0c[_0x5005e2];return _0x5f13f3;}var lt=Object[_0x108f61(0x37b)],_t=(_0x51d365,_0x3097c7,_0xf81b33,_0x5bb8e1)=>{const _0x375f8d=_0x108f61;for(var _0x101f17=_0x5bb8e1>0x1?void 0x0:_0x5bb8e1?lt(_0x3097c7,_0xf81b33):_0x3097c7,_0x3de52c=_0x51d365[_0x375f8d(0x14d)]-0x1,_0x19c6b3;_0x3de52c>=0x0;_0x3de52c--)(_0x19c6b3=_0x51d365[_0x3de52c])&&(_0x101f17=_0x19c6b3(_0x101f17)||_0x101f17);return _0x101f17;},De=(_0x301019,_0x297c36)=>(_0x857e6c,_0x47e458)=>_0x297c36(_0x857e6c,_0x47e458,_0x301019);let me=class extends a[_0x108f61(0x217)]{constructor(_0x4742d1,_0x3d65a2){const _0x293509=_0x108f61;super(),this[_0x293509(0x257)]=_0x4742d1,this['_imageIoService']=_0x3d65a2,this[_0x293509(0x239)]();}[_0x108f61(0x239)](){const _0x33e14a=_0x108f61,_0x4e4016=this;this[_0x33e14a(0x1d6)](this[_0x33e14a(0x257)][_0x33e14a(0x1eb)]({'onBeforePasteImage':async _0x2e7c0b=>{const _0xedfaf5=_0x33e14a,_0x3710f9=await _0x4e4016[_0xedfaf5(0x1ba)][_0xedfaf5(0x145)](_0x2e7c0b);return _0x3710f9?{'source':_0x3710f9['source'],'imageSourceType':_0x3710f9[_0xedfaf5(0x304)]}:null;}}));}};me=_t([De(0x0,T[_0x108f61(0x2ab)]),De(0x1,ze[_0x108f61(0x198)])],me);const Ne=[_0x108f61(0x294),_0x108f61(0x30c),_0x108f61(0x19b),_0x108f61(0x359),_0x108f61(0x16e),_0x108f61(0x26a)];class Re extends a[_0x108f61(0x3b6)]{constructor(){const _0x2457da=_0x108f61;super(...arguments),_(this,_0x2457da(0x30f),new Map()),_(this,'_colorIndex',0x0);}['assignAColorForMemberID'](_0xffcbc1){const _0x1f062f=_0x108f61;if(this[_0x1f062f(0x30f)][_0x1f062f(0x369)](_0xffcbc1))return this[_0x1f062f(0x30f)]['get'](_0xffcbc1);const _0x5a285d=Ne[this[_0x1f062f(0x2f7)]];return this[_0x1f062f(0x2f7)]=(this[_0x1f062f(0x2f7)]+0x1)%Ne[_0x1f062f(0x14d)],this[_0x1f062f(0x30f)][_0x1f062f(0x187)](_0xffcbc1,_0x5a285d),_0x5a285d;}}function Fe(_0x24e31e){let _0x52bc95='';for(const _0x33e5bf of _0x24e31e){const {startOffset:_0x4873f6,endOffset:_0x57fadb,isActive:_0x4c7828,rangeType:_0x21b439,segmentId:_0x3cee71,segmentPage:_0xf3eb15}=_0x33e5bf;_0x52bc95['length']&&(_0x52bc95+=','),_0x52bc95+=_0x4873f6+':'+_0x57fadb+':'+(_0x4c7828?'1':'0')+':'+_0x21b439+':'+_0x3cee71+':'+_0xf3eb15;}return _0x52bc95;}function ht(_0x3cad12){const _0x43282f=_0x108f61,_0x8dd4a5=_0x3cad12['split'](','),_0x1fbda5=[];for(const _0x11e257 of _0x8dd4a5){const [_0x6d03cb,_0x283bf2,_0x21eedf,_0x359607,_0x21f6e1,_0x459c7f]=_0x11e257[_0x43282f(0x11d)](':');_0x1fbda5['push']({'startOffset':Number(_0x6d03cb),'endOffset':Number(_0x283bf2),'collapsed':_0x6d03cb===_0x283bf2,'isActive':_0x21eedf==='1','rangeType':_0x359607===a[_0x43282f(0x130)][_0x43282f(0x36a)]?a[_0x43282f(0x130)][_0x43282f(0x36a)]:a[_0x43282f(0x130)][_0x43282f(0x107)],'segmentId':typeof _0x21f6e1=='string'?String(_0x21f6e1):'','segmentPage':Number(_0x459c7f!=null?_0x459c7f:-0x1)});}return _0x1fbda5[_0x43282f(0x1ee)](_0x25baaa=>_0x25baaa[_0x43282f(0x306)])||(_0x1fbda5[0x0][_0x43282f(0x306)]=!0x0),_0x1fbda5;}class be extends a[_0x108f61(0x217)]{constructor(){const _0x62f1f6=_0x108f61;super(...arguments),_(this,_0x62f1f6(0x397),new I[(_0x62f1f6(0x391))](null)),_(this,_0x62f1f6(0x24c),this['_collabCursorState$'][_0x62f1f6(0x169)]());}[_0x108f61(0x19d)](_0x2580f7){const _0x333fad=_0x108f61,{unitID:_0x6e080f,memberID:_0x35c4f7,textRanges:_0x10d843}=_0x2580f7,_0x195671=Fe(_0x10d843);if(_0x195671==='')return;const _0x29ce92={'unitID':_0x6e080f,'memberID':_0x35c4f7,'selection':_0x195671};this[_0x333fad(0x397)][_0x333fad(0x120)](_0x29ce92);}}var ut=Object[_0x108f61(0x37b)],It=(_0x2d3b8b,_0x368b40,_0x497057,_0x30ef8b)=>{const _0x2d71e5=_0x108f61;for(var _0x1ecea9=_0x30ef8b>0x1?void 0x0:_0x30ef8b?ut(_0x368b40,_0x497057):_0x368b40,_0x226480=_0x2d3b8b[_0x2d71e5(0x14d)]-0x1,_0x170a59;_0x226480>=0x0;_0x226480--)(_0x170a59=_0x2d3b8b[_0x226480])&&(_0x1ecea9=_0x170a59(_0x1ecea9)||_0x1ecea9);return _0x1ecea9;},U=(_0x266918,_0x587a4e)=>(_0x1564e7,_0x1d8d5a)=>_0x587a4e(_0x1564e7,_0x1d8d5a,_0x266918);const St=0x12c,dt=0x64;let ve=class extends a['RxDisposable']{constructor(_0x3a12d8,_0x2bcf17,_0x109533,_0x5c6f1e,_0x3d06be,_0x46c4a8,_0x10d40d,_0x4882c3,_0x27ea08){const _0x55b80c=_0x108f61;super(),_(this,'_online',!0x1),_(this,_0x55b80c(0x239),!0x1),_(this,_0x55b80c(0x124),new I[(_0x55b80c(0x391))](new Map())),_(this,_0x55b80c(0x221),this['_cursorInfo$'][_0x55b80c(0x169)]()),_(this,'_roomMembers$',new I['BehaviorSubject']([])),_(this,_0x55b80c(0x1b9),this[_0x55b80c(0x112)][_0x55b80c(0x143)](I[_0x55b80c(0x21c)](St))),_(this,'_updateLocalCursor',a[_0x55b80c(0x18b)](_0x56bf41=>{const _0x2ecc10=_0x55b80c,_0x4fdb03={'eventID':g[_0x2ecc10(0x2ae)][_0x2ecc10(0x2a3)],'data':{'unitID':this['unitID'],'memberID':this[_0x2ecc10(0x1ed)]['getMemberID'](),'selection':Fe(_0x56bf41)}};this['_session'][_0x2ecc10(0x2f2)](_0x4fdb03,this['unitID']);},dt)),(this[_0x55b80c(0x24b)]=_0x3a12d8,this[_0x55b80c(0x1ed)]=_0x2bcf17,this['_injector']=_0x109533,this[_0x55b80c(0x2b0)]=_0x5c6f1e,this[_0x55b80c(0x15a)]=_0x3d06be,this['_syncEditingCollabCursorService']=_0x46c4a8,this[_0x55b80c(0x111)]=_0x10d40d,this[_0x55b80c(0x311)]=_0x4882c3,this[_0x55b80c(0x34d)]=_0x27ea08);}get['cursorInfo'](){return this['_cursorInfo$']['getValue']();}get['roomMembers'](){const _0x3ff9d9=_0x108f61;return this[_0x3ff9d9(0x112)][_0x3ff9d9(0x1d9)]();}[_0x108f61(0x1a6)](){const _0x5b2480=_0x108f61;super[_0x5b2480(0x1a6)](),this[_0x5b2480(0x124)]['next'](new Map()),this[_0x5b2480(0x124)][_0x5b2480(0x133)](),this[_0x5b2480(0x112)][_0x5b2480(0x120)]([]),this[_0x5b2480(0x112)][_0x5b2480(0x133)]();}[_0x108f61(0x350)](){const _0x5420d9=_0x108f61;this['_init']||(this[_0x5420d9(0x239)]=!0x0,this[_0x5420d9(0x1ed)]['sessionStatus$']['pipe'](I[_0x5420d9(0x1fd)](this[_0x5420d9(0x251)]))['subscribe'](_0x4374ad=>{const _0x1c3bb6=_0x5420d9;_0x4374ad===u[_0x1c3bb6(0x342)][_0x1c3bb6(0x276)]?this['_toggleOnline']():this['_toggleOffline']();}),this[_0x5420d9(0x1ed)][_0x5420d9(0xfa)]['pipe'](I['takeUntil'](this[_0x5420d9(0x251)]))[_0x5420d9(0x346)](_0x513473=>{const _0x4f5c79=_0x5420d9,_0x39d380=_0x513473['eventID'];_0x39d380===g[_0x4f5c79(0x2ae)]['UPDATE_CURSOR']&&this[_0x4f5c79(0x2f5)](_0x513473),_0x39d380===g[_0x4f5c79(0x2ae)][_0x4f5c79(0x365)]&&this['_onCursorDelete'](_0x513473);}),this[_0x5420d9(0x1d6)](this[_0x5420d9(0x34d)][_0x5420d9(0x1c7)](_0x43c774=>{const _0x9dc824=_0x5420d9,_0x1c9cee=_0x43c774['params'];_0x1c9cee!=null&&this[_0x9dc824(0xf1)]&&_0x43c774['id']===V[_0x9dc824(0x243)]['id']&&_0x1c9cee[_0x9dc824(0x2aa)]===this[_0x9dc824(0x24b)]&&_0x1c9cee['isEditing']===!0x1&&_0x1c9cee[_0x9dc824(0x117)][_0x9dc824(0x14d)]>0x0&&this[_0x9dc824(0x2b3)](_0x1c9cee[_0x9dc824(0x117)]);})),this[_0x5420d9(0x1f1)]['collabCursorState$']['pipe'](I['takeUntil'](this[_0x5420d9(0x251)]))['subscribe'](_0x3e03d7=>{const _0x20c6ae=_0x5420d9;if((_0x3e03d7==null?void 0x0:_0x3e03d7['unitID'])!==this[_0x20c6ae(0x24b)])return;const _0x3b1e51={'eventID':g[_0x20c6ae(0x2ae)]['UPDATE_CURSOR'],'data':_0x3e03d7};this[_0x20c6ae(0x2f5)](_0x3b1e51);}),this[_0x5420d9(0x1d6)](this['_commandService'][_0x5420d9(0x1c7)](_0x26ea75=>{const _0x1e7107=_0x5420d9;if(_0x26ea75[_0x1e7107(0x39e)]==null)return;const _0x548bc5=_0x26ea75['params'];if(_0x26ea75['id']!==V['RichTextEditingMutation']['id']||_0x548bc5['unitId']!==this['unitID'])return;const _0x1cb124={'id':_0x1e7107(0x325),'params':_0x548bc5},_0x20a674=this[_0x1e7107(0x191)];for(const [_0x595f2d,_0x34bb2d]of _0x20a674){const _0x79d726={'id':_0x1e7107(0x325),'params':{'unitId':this[_0x1e7107(0x24b)],'actions':null,'textRanges':_0x34bb2d['ranges']}},_0x528232=this[_0x1e7107(0x111)][_0x1e7107(0x10c)](_0x1cb124,_0x79d726,!0x1);if(g[_0x1e7107(0x35f)](_0x528232))throw _0x528232[_0x1e7107(0x29b)];_0x20a674[_0x1e7107(0x187)](_0x595f2d,{..._0x34bb2d,'ranges':_0x528232['m2Prime'][_0x1e7107(0x39e)][_0x1e7107(0x23d)]});}queueMicrotask(()=>{const _0x407300=_0x1e7107;this['_cursorInfo$'][_0x407300(0x120)](_0x20a674);});})));}[_0x108f61(0x2f5)](_0x1d708e){const _0x534058=_0x108f61;var _0x42fb60,_0x576c50;const {memberID:_0x449399,selection:_0xfc455f}=_0x1d708e['data'],_0x41900c=ht(_0xfc455f),_0x454de7=(_0x576c50=(_0x42fb60=this[_0x534058(0x15a)][_0x534058(0x172)](this['unitID'],_0x449399))==null?void 0x0:_0x42fb60[_0x534058(0x21e)])!=null?_0x576c50:_0x534058(0x253),_0x47bba9={'color':this[_0x534058(0x2b0)][_0x534058(0x245)](_0x449399),'name':_0x454de7,'ranges':_0x41900c},_0x1626d5=this['cursorInfo'];_0x1626d5[_0x534058(0x187)](_0x449399,_0x47bba9),this[_0x534058(0x124)][_0x534058(0x120)](_0x1626d5);}[_0x108f61(0x2a5)](_0x4b73c4){const _0x517f50=_0x108f61,{memberID:_0x58d00a}=_0x4b73c4[_0x517f50(0x184)],_0x2ff350=this[_0x517f50(0x191)];_0x2ff350['delete'](_0x58d00a),this[_0x517f50(0x124)][_0x517f50(0x120)](_0x2ff350);}[_0x108f61(0x144)](){const _0x20b0fe=_0x108f61;var _0xebdf7c;if(this['_online']=!0x0,((_0xebdf7c=this['_univerInstanceService'][_0x20b0fe(0x277)]())==null?void 0x0:_0xebdf7c[_0x20b0fe(0xf9)]())!==this['unitID'])return;const _0x5b7e91=this[_0x20b0fe(0x266)]['get'](V[_0x20b0fe(0x131)])['getDocRanges']();Array['isArray'](_0x5b7e91)&&_0x5b7e91[_0x20b0fe(0x14d)]>0x0&&this['_updateLocalCursor'](_0x5b7e91);}[_0x108f61(0x213)](){const _0x21d5e8=_0x108f61;this[_0x21d5e8(0xf1)]=!0x1;}};ve=It([U(0x2,a[_0x108f61(0x230)](a[_0x108f61(0x1e8)])),U(0x3,a[_0x108f61(0x230)](Re)),U(0x4,a[_0x108f61(0x230)](u['MemberService'])),U(0x5,a[_0x108f61(0x230)](be)),U(0x6,g[_0x108f61(0x12b)]),U(0x7,a[_0x108f61(0x163)]),U(0x8,a[_0x108f61(0x225)])],ve);var ft=Object[_0x108f61(0x37b)],mt=(_0x151e56,_0x4e215c,_0x3fe4ad,_0xeae300)=>{const _0x14a59e=_0x108f61;for(var _0x7a2532=_0xeae300>0x1?void 0x0:_0xeae300?ft(_0x4e215c,_0x3fe4ad):_0x4e215c,_0x216f01=_0x151e56[_0x14a59e(0x14d)]-0x1,_0x598018;_0x216f01>=0x0;_0x216f01--)(_0x598018=_0x151e56[_0x216f01])&&(_0x7a2532=_0x598018(_0x7a2532)||_0x7a2532);return _0x7a2532;},w=(_0x11436b,_0x3facf1)=>(_0x3ad3a2,_0x1315e5)=>_0x3facf1(_0x3ad3a2,_0x1315e5,_0x11436b);const vt=0x12c,gt=0x64,Et=()=>{let _0x4a4741=[],_0x2a44d2=!0x1;return _0x2a7327=>{const _0x36dff1=_0x5f13;_0x4a4741[_0x36dff1(0x1cd)](_0x2a7327),_0x2a44d2||(_0x2a44d2=!0x0,setTimeout(()=>{const _0x1b8579=_0x36dff1;_0x4a4741[_0x1b8579(0xf8)](_0xcf9b73=>_0xcf9b73()),_0x4a4741=[],_0x2a44d2=!0x1;}));};};let ge=class extends a[_0x108f61(0x217)]{constructor(_0x3bb0ce,_0x42e20c,_0x2a0a8a,_0x324e48,_0x201a7d,_0x2dd10a,_0x17180d,_0x463551){const _0x3866c9=_0x108f61;super(),_(this,_0x3866c9(0xf1),!0x1),_(this,_0x3866c9(0x239),!0x1),_(this,'_cursorInfo$',new I[(_0x3866c9(0x391))](new Map())),_(this,_0x3866c9(0x221),this[_0x3866c9(0x124)][_0x3866c9(0x169)]()),_(this,_0x3866c9(0x112),new I[(_0x3866c9(0x391))]([])),_(this,_0x3866c9(0x1b9),this[_0x3866c9(0x112)]['pipe'](I[_0x3866c9(0x21c)](vt))),_(this,_0x3866c9(0x2b3),a['debounce']((_0x16aba5,_0x1ee750)=>{const _0x279aa5=_0x3866c9,_0x3edff1={'eventID':g['CollaborationEvent'][_0x279aa5(0x2a3)],'data':{'unitID':this[_0x279aa5(0x24b)],'memberID':this[_0x279aa5(0x1ed)]['getMemberID'](),'selection':B['serializeRangeWithSheet'](_0x16aba5,_0x1ee750[_0x279aa5(0x1fb)])}};this['_session'][_0x279aa5(0x2f2)](_0x3edff1,this[_0x279aa5(0x24b)]);},gt)),(this[_0x3866c9(0x24b)]=_0x3bb0ce,this[_0x3866c9(0x1ed)]=_0x42e20c,this[_0x3866c9(0x266)]=_0x2a0a8a,this[_0x3866c9(0x2b0)]=_0x324e48,this[_0x3866c9(0x15a)]=_0x201a7d,this['_univerInstanceService']=_0x2dd10a,this[_0x3866c9(0x34d)]=_0x17180d,this['_refRangeService']=_0x463551);}get[_0x108f61(0x191)](){const _0x4d527f=_0x108f61;return this[_0x4d527f(0x124)][_0x4d527f(0x1d9)]();}get[_0x108f61(0x2ef)](){const _0xa79368=_0x108f61;return this[_0xa79368(0x112)][_0xa79368(0x1d9)]();}['dispose'](){const _0x577965=_0x108f61;super[_0x577965(0x1a6)](),this[_0x577965(0x124)][_0x577965(0x120)](new Map()),this['_cursorInfo$']['complete'](),this[_0x577965(0x112)][_0x577965(0x120)]([]),this[_0x577965(0x112)][_0x577965(0x133)]();}['init'](){const _0x3c17a6=_0x108f61;this[_0x3c17a6(0x239)]||(this['_init']=!0x0,this[_0x3c17a6(0x1ed)][_0x3c17a6(0x26b)]['pipe'](I[_0x3c17a6(0x1fd)](this['dispose$']))[_0x3c17a6(0x346)](_0x3b1362=>{const _0x40157e=_0x3c17a6;_0x3b1362===u[_0x40157e(0x342)][_0x40157e(0x276)]?this['_toggleOnline']():this[_0x40157e(0x213)]();}),this[_0x3c17a6(0x1ed)][_0x3c17a6(0xfa)][_0x3c17a6(0x143)](I[_0x3c17a6(0x1fd)](this[_0x3c17a6(0x251)]))[_0x3c17a6(0x346)](_0x12c717=>{const _0x59b93d=_0x3c17a6,_0x5e5549=_0x12c717['eventID'];_0x5e5549===g[_0x59b93d(0x2ae)][_0x59b93d(0x2a3)]&&this['_onCursorUpdate'](_0x12c717),_0x5e5549===g[_0x59b93d(0x2ae)][_0x59b93d(0x365)]&&this['_onCursorDelete'](_0x12c717);}),this[_0x3c17a6(0x24a)](),this[_0x3c17a6(0x1d6)](this['_commandService']['onCommandExecuted'](_0x3a38a4=>{const _0x3349b1=_0x3c17a6;if(this[_0x3349b1(0xf1)]&&_0x3a38a4['id']===v[_0x3349b1(0x336)]['id']&&_0x3a38a4[_0x3349b1(0x39e)]['unitId']===this[_0x3349b1(0x24b)]){const _0x5e43b5=_0x3a38a4[_0x3349b1(0x39e)];this[_0x3349b1(0x2b3)](_0x5e43b5[_0x3349b1(0x10e)],_0x5e43b5[_0x3349b1(0x1f4)][0x0]);}})));}[_0x108f61(0x2f5)](_0x28e5dc){const _0x40809a=_0x108f61;var _0x205ffb,_0x2a61cd;const {memberID:_0x206ed2,selection:_0x586f18}=_0x28e5dc['data'],{sheetName:_0x3384f5,range:_0x178070}=B[_0x40809a(0x1b6)](_0x586f18),_0x4cc5e9={'name':(_0x2a61cd=(_0x205ffb=this[_0x40809a(0x15a)][_0x40809a(0x172)](this[_0x40809a(0x24b)],_0x206ed2))==null?void 0x0:_0x205ffb[_0x40809a(0x21e)])!=null?_0x2a61cd:_0x40809a(0x253),'range':this['_getMergeRange'](_0x3384f5,_0x178070),'sheetID':_0x3384f5,'color':this[_0x40809a(0x2b0)][_0x40809a(0x245)](_0x206ed2),'selection':_0x586f18},_0x3097e7=this[_0x40809a(0x191)];_0x3097e7[_0x40809a(0x187)](_0x206ed2,_0x4cc5e9),this[_0x40809a(0x124)][_0x40809a(0x120)](_0x3097e7);}['_onCursorDelete'](_0xc4b26d){const _0x4ec810=_0x108f61,{memberID:_0x55f8ca}=_0xc4b26d[_0x4ec810(0x184)],_0x54b9bf=this['cursorInfo'];_0x54b9bf[_0x4ec810(0x233)](_0x55f8ca),this[_0x4ec810(0x124)]['next'](_0x54b9bf);}[_0x108f61(0x296)](_0x1a0e3e,_0x3d754d){const _0x4a6684=_0x108f61;var _0x5239d0,_0x91e06e;const _0x3995c4=(_0x91e06e=(_0x5239d0=this[_0x4a6684(0x311)]['getUniverSheetInstance'](this[_0x4a6684(0x24b)]))==null?void 0x0:_0x5239d0[_0x4a6684(0x236)](_0x1a0e3e))==null?void 0x0:_0x91e06e[_0x4a6684(0x103)]();return(_0x3995c4==null?void 0x0:_0x3995c4['find'](_0x22bc9a=>a[_0x4a6684(0x3a9)][_0x4a6684(0x195)](_0x22bc9a,_0x3d754d)))||_0x3d754d;}[_0x108f61(0x24a)](){const _0x575969=_0x108f61,_0x49b48b=new a[(_0x575969(0x1de))](),_0x340fd2=Et(),_0x2f87cb=()=>{const _0x1e7481=_0x575969;_0x49b48b['dispose']();const _0x157c40=(_0x4760f3,_0x5805f6,_0x445049,_0x50393a)=>{const _0x5d18b9=_0x5f13;let _0x5bb220=[];switch(_0x4760f3['id']){case v['EffectRefRangId'][_0x5d18b9(0x3a0)]:{_0x5bb220=v[_0x5d18b9(0x1f6)](_0x4760f3,_0x50393a);break;}case v['EffectRefRangId'][_0x5d18b9(0x36b)]:{_0x5bb220=v[_0x5d18b9(0x151)](_0x4760f3,_0x50393a);break;}case v[_0x5d18b9(0x241)][_0x5d18b9(0x366)]:{_0x5bb220=v[_0x5d18b9(0x37c)](_0x4760f3,_0x50393a);break;}case v[_0x5d18b9(0x241)][_0x5d18b9(0x14c)]:{_0x5bb220=v[_0x5d18b9(0x1c6)](_0x4760f3,_0x50393a);break;}case v[_0x5d18b9(0x241)][_0x5d18b9(0x3bc)]:{_0x5bb220=v[_0x5d18b9(0x353)](_0x4760f3,_0x50393a);break;}case v[_0x5d18b9(0x241)]['InsertRowCommandId']:{_0x5bb220=v[_0x5d18b9(0x249)](_0x4760f3,_0x50393a);break;}case v['EffectRefRangId'][_0x5d18b9(0x24e)]:{_0x5bb220=v[_0x5d18b9(0x21f)](_0x4760f3,_0x50393a);break;}case v[_0x5d18b9(0x241)][_0x5d18b9(0x101)]:{_0x5bb220=v[_0x5d18b9(0x2b6)](_0x4760f3,_0x50393a);break;}case v[_0x5d18b9(0x241)][_0x5d18b9(0x274)]:{_0x5bb220=v['handleIRemoveRow'](_0x4760f3,_0x50393a);break;}}const _0x55b6f4=v[_0x5d18b9(0x1e6)](_0x5bb220,_0x50393a),_0x587271=this['cursorInfo'][_0x5d18b9(0x1e2)](_0x5805f6);if(_0x587271&&_0x55b6f4){const _0x2d3abb={..._0x587271,'range':_0x55b6f4};this['cursorInfo'][_0x5d18b9(0x187)](_0x5805f6,_0x2d3abb),_0x340fd2(()=>{const _0x1d5abc=_0x5d18b9,_0x8dbd9a=this[_0x1d5abc(0x197)]['registerRefRange'](_0x55b6f4,_0x395831=>(_0x8dbd9a[_0x1d5abc(0x1a6)](),_0x157c40(_0x395831,_0x5805f6,_0x445049,_0x55b6f4)));_0x49b48b[_0x1d5abc(0xf0)](_0x8dbd9a);});}return{'redos':[],'undos':[]};};this[_0x1e7481(0x191)][_0x1e7481(0xf8)]((_0x345c7f,_0x3e049c)=>{const _0x238ef1=_0x1e7481,{range:_0xa92576,sheetID:_0x113ad0}=_0x345c7f,_0x1c39ba=this[_0x238ef1(0x197)][_0x238ef1(0x3b1)](_0xa92576,_0x17195c=>(_0x1c39ba[_0x238ef1(0x1a6)](),_0x157c40(_0x17195c,_0x3e049c,_0x113ad0,_0xa92576)));_0x49b48b[_0x238ef1(0xf0)](_0x1c39ba);});};this[_0x575969(0x1d6)](a[_0x575969(0x317)](this[_0x575969(0x124)][_0x575969(0x346)](()=>{_0x2f87cb();})));}[_0x108f61(0x144)](){const _0x3f7c23=_0x108f61;var _0x285a09,_0x397c07;if(this[_0x3f7c23(0xf1)]=!0x0,((_0x285a09=this['_univerInstanceService']['getFocusedUnit']())==null?void 0x0:_0x285a09['getUnitId']())!==this[_0x3f7c23(0x24b)])return;const _0x408367=(_0x397c07=this[_0x3f7c23(0x266)][_0x3f7c23(0x1e2)](v[_0x3f7c23(0x17b)])[_0x3f7c23(0x24f)]())==null?void 0x0:_0x397c07[0x0],_0xaac103=this['_univerInstanceService'][_0x3f7c23(0x267)](a['UniverInstanceType']['UNIVER_SHEET'])[_0x3f7c23(0x2e5)]();_0x408367&&_0xaac103&&this['_updateLocalCursor'](_0xaac103[_0x3f7c23(0xff)](),_0x408367);}[_0x108f61(0x213)](){const _0x5c0fa0=_0x108f61;this[_0x5c0fa0(0xf1)]=!0x1;}};ge=mt([w(0x2,a['Inject'](a[_0x108f61(0x1e8)])),w(0x3,a['Inject'](Re)),w(0x4,a[_0x108f61(0x230)](u[_0x108f61(0x16d)])),w(0x5,a[_0x108f61(0x163)]),w(0x6,a['ICommandService']),w(0x7,a[_0x108f61(0x230)](v[_0x108f61(0x1ad)]))],ge);var Ct=Object['getOwnPropertyDescriptor'],Tt=(_0x2f6526,_0x3262fb,_0x2760c2,_0x5ed66a)=>{for(var _0x32b3c5=_0x5ed66a>0x1?void 0x0:_0x5ed66a?Ct(_0x3262fb,_0x2760c2):_0x3262fb,_0x228c2c=_0x2f6526['length']-0x1,_0x1c0744;_0x228c2c>=0x0;_0x228c2c--)(_0x1c0744=_0x2f6526[_0x228c2c])&&(_0x32b3c5=_0x1c0744(_0x32b3c5)||_0x32b3c5);return _0x32b3c5;},ce=(_0x32dda0,_0x4fc223)=>(_0x287874,_0x46bb95)=>_0x4fc223(_0x287874,_0x46bb95,_0x32dda0);let F=class extends a[_0x108f61(0x217)]{constructor(_0x4b7852,_0x411b6b,_0x557a3c){const _0x4c26dc=_0x108f61;super(),_(this,_0x4c26dc(0x282),new Map()),_(this,'_entityInit$',new I[(_0x4c26dc(0x399))]()),(this[_0x4c26dc(0x311)]=_0x4b7852,this[_0x4c26dc(0x266)]=_0x411b6b,this[_0x4c26dc(0xfd)]=_0x557a3c,this[_0x4c26dc(0x239)]());}[_0x108f61(0x1a6)](){const _0x2555da=_0x108f61;super['dispose'](),this[_0x2555da(0x196)][_0x2555da(0x133)](),this[_0x2555da(0x282)]['forEach'](_0x44fcba=>_0x44fcba['dispose']());}[_0x108f61(0x271)](_0x1489f7){const _0x270624=_0x108f61;return this[_0x270624(0x282)][_0x270624(0x369)](_0x1489f7)?this[_0x270624(0x282)][_0x270624(0x1e2)](_0x1489f7)['cursorInfo$']:this[_0x270624(0x196)]['pipe'](I[_0x270624(0x229)](_0x20f9d1=>_0x20f9d1[_0x270624(0x24b)]===_0x1489f7),I[_0x270624(0x1c1)](_0x55575a=>_0x55575a[_0x270624(0x221)]));}[_0x108f61(0x239)](){const _0x578b72=_0x108f61;this[_0x578b72(0x311)]['getTypeOfUnitAdded$'](a[_0x578b72(0x234)][_0x578b72(0x2c7)])['pipe'](I['takeUntil'](this['dispose$']))[_0x578b72(0x346)](async _0x31db62=>{const _0x385bd4=_0x578b72,_0x27c434=_0x31db62[_0x385bd4(0xf9)](),_0x4c227c=await this[_0x385bd4(0x32b)](_0x27c434);this[_0x385bd4(0x196)][_0x385bd4(0x120)](_0x4c227c),this[_0x385bd4(0x282)][_0x385bd4(0x187)](_0x27c434,_0x4c227c);}),this[_0x578b72(0x311)][_0x578b72(0x18a)](a[_0x578b72(0x234)]['UNIVER_DOC'])[_0x578b72(0x143)](I[_0x578b72(0x1fd)](this[_0x578b72(0x251)]))['pipe'](I[_0x578b72(0x229)](_0x1ed8bc=>!_0x1ed8bc[_0x578b72(0xf9)]()[_0x578b72(0x2ec)]('__')))[_0x578b72(0x346)](async _0x5ca396=>{const _0x1b6f65=_0x578b72,_0x59a6cf=_0x5ca396['getUnitId'](),_0x514e83=await this['_startDocCollabCursor'](_0x59a6cf);this[_0x1b6f65(0x196)]['next'](_0x514e83),this['_entities'][_0x1b6f65(0x187)](_0x59a6cf,_0x514e83);}),I['merge'](this[_0x578b72(0x311)][_0x578b72(0x12f)](a[_0x578b72(0x234)][_0x578b72(0x16b)]),this[_0x578b72(0x311)][_0x578b72(0x12f)](a[_0x578b72(0x234)][_0x578b72(0x2c7)]))[_0x578b72(0x143)](I[_0x578b72(0x1fd)](this[_0x578b72(0x251)]))[_0x578b72(0x346)](_0x4d68d7=>{const _0x10aba7=_0x578b72,_0x3be56d=_0x4d68d7[_0x10aba7(0xf9)](),_0x4906c6=this[_0x10aba7(0x282)][_0x10aba7(0x1e2)](_0x3be56d);_0x4906c6&&(_0x4906c6[_0x10aba7(0x1a6)](),this['_entities'][_0x10aba7(0x233)](_0x3be56d));});}async[_0x108f61(0x32b)](_0x441f35){const _0x34e9be=_0x108f61,_0x12c3cb=await this[_0x34e9be(0xfd)][_0x34e9be(0x29c)](_0x441f35),_0x575d23=this[_0x34e9be(0x266)][_0x34e9be(0x11f)](ge,_0x441f35,_0x12c3cb);return _0x575d23['init'](),_0x575d23;}async['_startDocCollabCursor'](_0x16053e){const _0x930ee3=_0x108f61,_0x3ed332=await this[_0x930ee3(0xfd)][_0x930ee3(0x29c)](_0x16053e),_0x4ad60a=this[_0x930ee3(0x266)]['createInstance'](ve,_0x16053e,_0x3ed332);return _0x4ad60a[_0x930ee3(0x350)](),_0x4ad60a;}};F=Tt([ce(0x0,a[_0x108f61(0x163)]),ce(0x1,a[_0x108f61(0x230)](a[_0x108f61(0x1e8)])),ce(0x2,a[_0x108f61(0x230)](u[_0x108f61(0x2af)]))],F);const X=0x14,Ue=0xc8,le=0x4,pt=0x5;function Ot(_0x34903e,_0x38a78c){const _0x11acdd=_0x108f61;let {radius:_0x4cbf9f,width:_0x34ab8a,height:_0x402c5c}=_0x38a78c;_0x4cbf9f=_0x4cbf9f!=null?_0x4cbf9f:0x0,_0x34ab8a=_0x34ab8a!=null?_0x34ab8a:0x1e,_0x402c5c=_0x402c5c!=null?_0x402c5c:0x1e;let _0x19adad=0x0,_0x883e98=0x0,_0x2a1bfa=0x0;_0x19adad=_0x883e98=_0x2a1bfa=Math['min'](_0x4cbf9f,_0x34ab8a/0x2,_0x402c5c/0x2),_0x34903e[_0x11acdd(0x1dd)](),_0x34903e[_0x11acdd(0x1e5)](_0x19adad,0x0),_0x34903e[_0x11acdd(0x273)](_0x34ab8a-_0x883e98,0x0),_0x34903e[_0x11acdd(0x340)](_0x34ab8a-_0x883e98,_0x883e98,_0x883e98,Math['PI']*0x3/0x2,0x0,!0x1),_0x34903e[_0x11acdd(0x273)](_0x34ab8a,_0x402c5c-_0x2a1bfa),_0x34903e[_0x11acdd(0x340)](_0x34ab8a-_0x2a1bfa,_0x402c5c-_0x2a1bfa,_0x2a1bfa,0x0,Math['PI']/0x2,!0x1),_0x34903e[_0x11acdd(0x273)](0x0,_0x402c5c),_0x34903e[_0x11acdd(0x273)](0x0,_0x19adad),_0x34903e[_0x11acdd(0x340)](_0x19adad,_0x19adad,_0x19adad,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x34903e[_0x11acdd(0x361)](),_0x38a78c[_0x11acdd(0x303)]&&(_0x34903e['save'](),_0x34903e[_0x11acdd(0x28a)]=_0x38a78c[_0x11acdd(0x303)],_0x38a78c[_0x11acdd(0x275)]===_0x11acdd(0x156)?_0x34903e[_0x11acdd(0x303)](_0x11acdd(0x156)):_0x34903e[_0x11acdd(0x303)](),_0x34903e[_0x11acdd(0x3ba)]());}class re extends C[_0x108f61(0x28c)]{constructor(_0x320aa1,_0x2206ea){const _0x3172ba=_0x108f61;super(_0x320aa1,_0x2206ea),_(this,'color'),_(this,_0x3172ba(0x2df)),(this[_0x3172ba(0x385)]=_0x2206ea==null?void 0x0:_0x2206ea[_0x3172ba(0x385)],this[_0x3172ba(0x2df)]=_0x2206ea==null?void 0x0:_0x2206ea[_0x3172ba(0x2df)]);}static[_0x108f61(0x2d0)](_0x2ee14e,_0x26c85c){const _0x50a105=_0x108f61,{text:_0x3babd0,color:_0x4730fc}=_0x26c85c;_0x2ee14e[_0x50a105(0x31a)](),_0x2ee14e[_0x50a105(0x387)]=_0x50a105(0x301);const _0x3d4510=_0x2ee14e[_0x50a105(0x2e3)](_0x3babd0)[_0x50a105(0x37d)],_0x5a16b0=Math[_0x50a105(0x396)](_0x3d4510+0x2*le,Ue);Ot(_0x2ee14e,{'height':X,'radius':0x4,'width':_0x5a16b0,'fill':_0x4730fc}),_0x2ee14e['fillStyle']=_0x50a105(0x383);const _0x12dfa3=le,_0x5bcad2=X-pt,_0x4c9863=Ue-0x2*le;if(_0x3d4510>_0x4c9863){let _0x15237b='',_0x2d0758=0x0;for(const _0x33e089 of _0x3babd0){const _0x4a39af=_0x2ee14e[_0x50a105(0x2e3)](_0x33e089)[_0x50a105(0x37d)];if(_0x2d0758+_0x4a39af<=_0x4c9863-_0x2ee14e[_0x50a105(0x2e3)]('...')[_0x50a105(0x37d)])_0x15237b+=_0x33e089,_0x2d0758+=_0x4a39af;else{_0x15237b+='...';break;}}_0x2ee14e[_0x50a105(0x2a7)](_0x15237b,_0x12dfa3,_0x5bcad2);}else _0x2ee14e[_0x50a105(0x2a7)](_0x3babd0,_0x12dfa3,_0x5bcad2);_0x2ee14e[_0x50a105(0x3ba)]();}[_0x108f61(0x100)](_0x26b25e){const _0x5b4e2a=_0x108f61;re[_0x5b4e2a(0x2d0)](_0x26b25e,this);}}const _e=_0x108f61(0xf6),Rt=_0x108f61(0x3be),bt=_0x108f61(0x23f),H=0x6,Dt=1.5,he=0x4,Nt=1.5,Ut=_0x108f61(0x183);class Le{constructor(_0x437116,_0x5496a6,_0x512eb1,_0x28ed03){const _0x5deda2=_0x108f61;_(this,_0x5deda2(0x19e),[]),_(this,_0x5deda2(0x231),null),_(this,_0x5deda2(0x29f),null),_(this,'_anchorDot',null),_(this,_0x5deda2(0x1e0),null),_(this,_0x5deda2(0x26f),null),(this[_0x5deda2(0x343)]=_0x437116,this['_scene']=_0x5496a6,this['_docSkeleton']=_0x512eb1,this[_0x5deda2(0x3b0)]=_0x28ed03,this[_0x5deda2(0x25c)]());}set[_0x108f61(0x38c)](_0x56514f){const _0x45ef5a=_0x108f61;_0x56514f?(this[_0x45ef5a(0xfb)]&&this[_0x45ef5a(0xfb)][_0x45ef5a(0x188)](),this['_textBubble']&&this[_0x45ef5a(0x29f)][_0x45ef5a(0x146)]()):(this[_0x45ef5a(0xfb)]&&this[_0x45ef5a(0xfb)]['show'](),this[_0x45ef5a(0x29f)]&&this[_0x45ef5a(0x29f)]['hide']());}[_0x108f61(0x1a6)](){const _0x148c12=_0x108f61;for(const _0xeb2b0 of this[_0x148c12(0x19e)])_0xeb2b0[_0x148c12(0x1a6)]();this[_0x148c12(0x29f)]&&this['_textBubble'][_0x148c12(0x1a6)](),this['_anchorDot']&&this[_0x148c12(0xfb)][_0x148c12(0x1a6)](),this['_anchor']&&this['_anchor'][_0x148c12(0x1a6)](),this[_0x148c12(0x26f)]&&this[_0x148c12(0x26f)]();}[_0x108f61(0x25c)](){const _0x442008=_0x108f61;var _0x4f1501;const {_docSkeleton:_0x52f569,_document:_0x3232d5}=this,{color:_0x369797,name:_0xa2491b,ranges:_0x2a5e95}=this[_0x442008(0x343)],_0x723ab3=_0x3232d5[_0x442008(0x208)](),{docsLeft:_0x2b06e8,docsTop:_0x4e485c}=_0x723ab3,_0x319dbc=new T[(_0x442008(0x125))](_0x723ab3,_0x52f569);for(const {startOffset:_0x34dea9,endOffset:_0x2e6769,rangeType:_0x5c061d,segmentId:_0xfd279b,segmentPage:_0x46600b,collapsed:_0x2911f0,isActive:_0x5d702d}of _0x2a5e95){const _0x2eafdd=_0x52f569['findNodePositionByCharIndex'](_0x34dea9,!0x0,_0xfd279b,_0x46600b);let _0x192969=_0x52f569[_0x442008(0x33f)](_0x2e6769,!0x0,_0xfd279b,_0x46600b);if(_0x192969==null&&(_0x192969=_0x52f569[_0x442008(0x33f)](_0x2e6769-0x1,!0x1,_0xfd279b,_0x46600b)),_0x5d702d){const {contentBoxPointGroup:_0x5c6269}=_0x319dbc[_0x442008(0x39f)](_0x192969,_0x192969);if(_0x5c6269[_0x442008(0x14d)]===0x0)continue;this[_0x442008(0x31f)](_0x369797,_0x5c6269,_0x2b06e8,_0x4e485c,_0xa2491b),this['_eventUnsubscribe']=this[_0x442008(0x29e)]();}if(_0x2eafdd&&_0x192969){if(_0x5c061d===a[_0x442008(0x130)][_0x442008(0x107)]){const _0xddb25b=new T[(_0x442008(0x259))](_0x723ab3,_0x52f569),{pointGroup:_0x4ec6b2}=(_0x4f1501=_0xddb25b[_0x442008(0x39f)](_0x2eafdd,_0x192969))!=null?_0x4f1501:{};if(_0x4ec6b2==null||_0x4ec6b2['length']===0x0)continue;this[_0x442008(0x393)](_0x369797,_0x4ec6b2,_0x2b06e8,_0x4e485c);}else{if(!_0x2911f0){const {borderBoxPointGroup:_0x8c5bc5}=_0x319dbc[_0x442008(0x39f)](_0x2eafdd,_0x192969);if(_0x8c5bc5['length']===0x0)continue;this['_drawTextRange'](_0x369797,_0x8c5bc5,_0x2b06e8,_0x4e485c);}}}}}[_0x108f61(0x31f)](_0xc2b42e,_0x1816f2,_0x3889a0,_0x52ccd2,_0x34c395){const _0x513214=_0x108f61,_0x54b6b3=this[_0x513214(0x34c)](_0x1816f2),{left:_0x1253be,top:_0x1c3964,height:_0x15c9a9}=_0x54b6b3,_0x571451=this[_0x513214(0x31e)](),_0x9d91ba=Nt/_0x571451,_0xa800e6=new C[(_0x513214(0x398))](_e+a[_0x513214(0x23c)](H),{'left':_0x1253be+_0x3889a0-_0x9d91ba,'top':_0x1c3964+_0x52ccd2,'height':_0x15c9a9,'width':Dt,'fill':_0xc2b42e||C['getColor'](a[_0x513214(0x26d)][_0x513214(0x362)],0x0),'strokeWidth':_0x9d91ba,'stroke':Ut,'evented':!0x0});this['_anchor']=_0xa800e6,this[_0x513214(0x23e)][_0x513214(0x2b2)](_0xa800e6,T[_0x513214(0x3b8)]);const _0xdf82d5=new C[(_0x513214(0x398))](_e+a[_0x513214(0x23c)](H),{'left':_0x1253be+_0x3889a0-_0x9d91ba,'top':_0x1c3964+_0x52ccd2-he/0x2,'height':he,'width':he,'fill':_0xc2b42e||C['getColor'](a[_0x513214(0x26d)][_0x513214(0x362)],0x0),'strokeWidth':0x0,'stroke':_0xc2b42e||C[_0x513214(0x297)](a['COLORS'][_0x513214(0x362)],0x0),'evented':!0x1});this['_anchorDot']=_0xdf82d5,this[_0x513214(0x23e)][_0x513214(0x2b2)](_0xdf82d5,T[_0x513214(0x3b8)]);const _0x39a5fa=new re(_e+a['generateRandomId'](H),{'left':_0x1253be+_0x3889a0-_0x9d91ba,'top':_0x1c3964+_0x52ccd2-X,'text':_0x34c395,'color':_0xc2b42e});this[_0x513214(0x29f)]=_0x39a5fa,this[_0x513214(0x23e)][_0x513214(0x2b2)](_0x39a5fa,T[_0x513214(0x3b8)]),this[_0x513214(0x38c)]=!0x1;}[_0x108f61(0x29e)](){const _0x26a063=_0x108f61,_0x3c9822=this[_0x26a063(0x231)][_0x26a063(0x20e)][_0x26a063(0x2fe)](()=>{const _0x5d06e9=_0x26a063;this[_0x5d06e9(0x38c)]=!0x0;}),_0x1fc53b=this['_anchor'][_0x26a063(0x14a)]['subscribeEvent'](()=>{const _0x50b734=_0x26a063;this['_hideTimer']&&clearTimeout(this[_0x50b734(0x1e0)]),this[_0x50b734(0x1e0)]=setTimeout(()=>{const _0xfac21b=_0x50b734;this[_0xfac21b(0x38c)]=!0x1;},0x7d0);});return()=>{_0x3c9822['unsubscribe'](),_0x1fc53b['unsubscribe']();};}[_0x108f61(0x39c)](_0x733f26,_0x3ea2c8,_0x56d028,_0x686f1c){const _0x4412a2=_0x108f61,_0x1373ab=new a['ColorKit'](_0x733f26)[_0x4412a2(0x250)](0.2)[_0x4412a2(0x35b)](),_0x763079=new C[(_0x4412a2(0x199))](Rt+a[_0x4412a2(0x23c)](H),{'pointsGroup':_0x3ea2c8,'fill':_0x1373ab||C[_0x4412a2(0x297)](a[_0x4412a2(0x26d)][_0x4412a2(0x362)],0.2),'left':_0x56d028,'top':_0x686f1c,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0x4412a2(0x1cd)](_0x763079),this[_0x4412a2(0x23e)][_0x4412a2(0x2b2)](_0x763079,T[_0x4412a2(0x3b8)]);}[_0x108f61(0x393)](_0x4c708f,_0x59988d,_0x198c66,_0x3deb90){const _0x496353=_0x108f61,_0x200e79=new a[(_0x496353(0x232))](_0x4c708f)[_0x496353(0x250)](0.2)['toRgbString'](),_0x39a454=new C[(_0x496353(0x199))](bt+a[_0x496353(0x23c)](H),{'pointsGroup':_0x59988d,'fill':_0x200e79||C[_0x496353(0x297)](a[_0x496353(0x26d)][_0x496353(0x362)],0.2),'left':_0x198c66,'top':_0x3deb90,'evented':!0x1,'debounceParentDirty':!0x1});this['_shapes'][_0x496353(0x1cd)](_0x39a454),this['_scene'][_0x496353(0x2b2)](_0x39a454,T['TEXT_RANGE_LAYER_INDEX']);}[_0x108f61(0x34c)](_0x4af14c){const _0x56e4f5=_0x4af14c[0x0],_0x464552=_0x56e4f5[0x0],_0x45174e=_0x56e4f5[0x2],{x:_0x3167c5,y:_0x308abc}=_0x464552,{x:_0x127393,y:_0x3a9543}=_0x45174e;return{'left':_0x3167c5,'top':_0x308abc,'width':_0x127393-_0x3167c5,'height':_0x3a9543-_0x308abc};}['_getScale'](){const _0x5f044c=_0x108f61,{scaleX:_0x266826,scaleY:_0x446890}=this[_0x5f044c(0x23e)][_0x5f044c(0x381)]();return Math['max'](_0x266826,_0x446890);}}var Lt=Object[_0x108f61(0x37b)],Mt=(_0x494ca6,_0x305910,_0x41ef2d,_0x1b519f)=>{for(var _0x2dd5ab=_0x1b519f>0x1?void 0x0:_0x1b519f?Lt(_0x305910,_0x41ef2d):_0x305910,_0x5227c2=_0x494ca6['length']-0x1,_0x326ff3;_0x5227c2>=0x0;_0x5227c2--)(_0x326ff3=_0x494ca6[_0x5227c2])&&(_0x2dd5ab=_0x326ff3(_0x2dd5ab)||_0x2dd5ab);return _0x2dd5ab;},q=(_0x26cbb9,_0x355491)=>(_0x140e74,_0x1c4bb0)=>_0x355491(_0x140e74,_0x1c4bb0,_0x26cbb9);let Ee=class extends a['RxDisposable']{constructor(_0x5d72dc,_0x15309d,_0x1876b4,_0x255541,_0x8ef8d){const _0x55a40b=_0x108f61;super(),_(this,_0x55a40b(0x27c),[]),_(this,'_cursors',[]),(this[_0x55a40b(0x17e)]=_0x5d72dc,this[_0x55a40b(0xee)]=_0x15309d,this[_0x55a40b(0x193)]=_0x1876b4,this[_0x55a40b(0x34d)]=_0x255541,this[_0x55a40b(0x2f3)]=_0x8ef8d,this[_0x55a40b(0x239)]());}[_0x108f61(0x239)](){const _0x34a9bb=_0x108f61,_0x2d291f=this[_0x34a9bb(0x17e)]['unitId'],_0x2b7a60=this['_docSkeletonManagerService'];this[_0x34a9bb(0x1d6)](I[_0x34a9bb(0x1df)]([this['_collabCursorController']['getCollabCursors$'](_0x2d291f),this[_0x34a9bb(0x2f3)]['currentTheme$']])[_0x34a9bb(0x143)]($[_0x34a9bb(0x17f)](([_0x3064a6,_0x3ad5d8])=>({'skeleton':_0x2b7a60[_0x34a9bb(0x35c)](),'cursors':[..._0x3064a6[_0x34a9bb(0x1a2)]()][_0x34a9bb(0x1b3)](_0x3e1a2d=>({..._0x3e1a2d,'color':this[_0x34a9bb(0x2f3)][_0x34a9bb(0x142)](_0x3e1a2d[_0x34a9bb(0x385)])}))})))[_0x34a9bb(0x346)](_0x5aea98=>{const _0x137272=_0x34a9bb;if(this[_0x137272(0x378)](),_0x5aea98){const {skeleton:_0x5561af,cursors:_0x167e10}=_0x5aea98;this['_updateCollabCursors'](_0x5561af,_0x167e10);}})),this[_0x34a9bb(0x373)](),this[_0x34a9bb(0x2f0)]();}[_0x108f61(0x28b)](_0x4595d2,_0x26dd0a){const _0x444440=_0x108f61,{scene:_0xc9d1fa,mainComponent:_0x34c07d}=this['_context'],_0x462dcd=_0x26dd0a[_0x444440(0x17f)](_0x5b3a80=>new Le(_0x5b3a80,_0xc9d1fa,_0x4595d2,_0x34c07d));this[_0x444440(0x27c)]=_0x462dcd,this[_0x444440(0x10f)]=_0x26dd0a;}['_refreshCollabCursors'](){const _0x5133ec=_0x108f61;this[_0x5133ec(0x378)]();const {scene:_0x346077,mainComponent:_0x7b623e}=this[_0x5133ec(0x17e)],_0x4733a3=this[_0x5133ec(0xee)]['getSkeleton'](),_0x151401=this['_cursors'][_0x5133ec(0x17f)](_0x1103b9=>new Le(_0x1103b9,_0x346077,_0x4733a3,_0x7b623e));this[_0x5133ec(0x27c)]=_0x151401;}[_0x108f61(0x378)](){const _0x844e36=_0x108f61;this[_0x844e36(0x27c)][_0x844e36(0xf8)](_0x471a57=>_0x471a57[_0x844e36(0x1a6)]()),this['_cursorShapes']=[];}[_0x108f61(0x2f0)](){const _0x4d8e13=_0x108f61,_0x4b07f0=[T[_0x4d8e13(0x281)]['id']];this[_0x4d8e13(0x1d6)](this['_commandService'][_0x4d8e13(0x1c7)](_0x7eedc9=>{const _0xad0465=_0x4d8e13;_0x4b07f0[_0xad0465(0x36c)](_0x7eedc9['id'])&&_0x7eedc9[_0xad0465(0x39e)][_0xad0465(0x2aa)]===this[_0xad0465(0x17e)][_0xad0465(0x2aa)]&&this[_0xad0465(0x394)]();}));}[_0x108f61(0x373)](){const _0x124df6=_0x108f61;this[_0x124df6(0x1d6)](a[_0x124df6(0x2f9)](this[_0x124df6(0x17e)][_0x124df6(0x2c3)]['onTransformChange$'])['pipe']($[_0x124df6(0x229)](_0x509ad2=>_0x509ad2['type']===C[_0x124df6(0x392)][_0x124df6(0x202)]),$[_0x124df6(0x126)](0x10))['subscribe'](()=>{const _0x179950=_0x124df6;this[_0x179950(0x394)]();}));}};Ee=Mt([q(0x1,a[_0x108f61(0x230)](V[_0x108f61(0x1fe)])),q(0x2,a[_0x108f61(0x230)](F)),q(0x3,a['ICommandService']),q(0x4,a[_0x108f61(0x230)](a['ThemeService']))],Ee);const At=0x1,Pt=1.5;class je extends C[_0x108f61(0x28c)]{constructor(_0x4b001e,_0x1be8de){const _0xdfa8f1=_0x108f61;super(_0x4b001e,_0x1be8de),_(this,_0xdfa8f1(0x261)),_(this,_0xdfa8f1(0x1a5),!0x1),_(this,_0xdfa8f1(0x2bd)),_(this,_0xdfa8f1(0x262),''),_(this,_0xdfa8f1(0x118),_0xdfa8f1(0x305)),_(this,_0xdfa8f1(0x18e)),(_0x1be8de&&this['setShapeProps'](_0x1be8de),this[_0xdfa8f1(0x20e)][_0xdfa8f1(0x2fe)](()=>this[_0xdfa8f1(0x2f6)]({'hovered':!0x0})),this[_0xdfa8f1(0x14a)]['subscribeEvent'](()=>this[_0xdfa8f1(0x2f6)]({'hovered':!0x1})));}['setShapeProps'](_0x172ed1){const _0x70336b=_0x108f61;var _0x5027ef,_0x13cece,_0xdeb6e9,_0x26c52c,_0x4e3068,_0x2e98be;this['_color']=(_0x5027ef=_0x172ed1[_0x70336b(0x385)])!=null?_0x5027ef:this[_0x70336b(0x261)],this[_0x70336b(0x1a5)]=(_0x13cece=_0x172ed1[_0x70336b(0x2fb)])!=null?_0x13cece:this['_hovered'],this[_0x70336b(0x2bd)]=(_0xdeb6e9=_0x172ed1[_0x70336b(0x1fb)])!=null?_0xdeb6e9:this[_0x70336b(0x2bd)],this['_name']=(_0x26c52c=_0x172ed1['name'])!=null?_0x26c52c:this[_0x70336b(0x262)],this[_0x70336b(0x118)]=(_0x4e3068=_0x172ed1[_0x70336b(0x32a)])!=null?_0x4e3068:this['_labelPosition'],this['_backgroundColor']=(_0x2e98be=_0x172ed1[_0x70336b(0x18d)])!=null?_0x2e98be:this[_0x70336b(0x18e)],this[_0x70336b(0x2c8)]({'width':_0x172ed1['width'],'height':_0x172ed1[_0x70336b(0x332)]});}[_0x108f61(0x14b)](_0x5d6185){const _0x4b37f2=_0x108f61,{row:_0x51e21e,column:_0x3ba2c4}=_0x5d6185;if(_0x51e21e>=this[_0x4b37f2(0x2bd)][_0x4b37f2(0x1b7)]&&_0x51e21e<=this['_range'][_0x4b37f2(0x237)]&&_0x3ba2c4>=this[_0x4b37f2(0x2bd)][_0x4b37f2(0x389)]&&_0x3ba2c4<=this[_0x4b37f2(0x2bd)][_0x4b37f2(0x25e)]){this[_0x4b37f2(0x2f6)]({'hovered':!0x0});return;}this[_0x4b37f2(0x2f6)]({'hovered':!0x1});}['triggerDblclick'](_0x17284a){return!0x1;}[_0x108f61(0x100)](_0x6f6f1e){const _0x371231=_0x108f61;C[_0x371231(0x398)][_0x371231(0x2d0)](_0x6f6f1e,{'width':this[_0x371231(0x37d)],'height':this[_0x371231(0x332)],'strokeWidth':Pt,'stroke':this[_0x371231(0x261)],'evented':!0x1,'fill':this[_0x371231(0x18e)]}),this['_hovered']&&(_0x6f6f1e['save'](),_0x6f6f1e[_0x371231(0x207)](0x1,0x0,0x0,0x1,this[_0x371231(0x37d)],this[_0x371231(0x118)]===_0x371231(0x382)?0x0:-X),re[_0x371231(0x2d0)](_0x6f6f1e,{'text':this[_0x371231(0x262)],'color':this[_0x371231(0x261)]}),_0x6f6f1e['restore']());}}var wt=Object[_0x108f61(0x37b)],yt=(_0x5885b5,_0xd9712b,_0xea856d,_0x64e683)=>{const _0xb0fd14=_0x108f61;for(var _0x1a3acc=_0x64e683>0x1?void 0x0:_0x64e683?wt(_0xd9712b,_0xea856d):_0xd9712b,_0x2643d4=_0x5885b5[_0xb0fd14(0x14d)]-0x1,_0x3e82e2;_0x2643d4>=0x0;_0x2643d4--)(_0x3e82e2=_0x5885b5[_0x2643d4])&&(_0x1a3acc=_0x3e82e2(_0x1a3acc)||_0x1a3acc);return _0x1a3acc;},ue=(_0x3f9446,_0x407706)=>(_0x1e3c70,_0x4cd3ee)=>_0x407706(_0x1e3c70,_0x4cd3ee,_0x3f9446);const $t=0x1389;let Ce=class extends a['RxDisposable']{constructor(_0x45b13e,_0x302adb,_0x55ddca,_0x502607){const _0x25395a=_0x108f61;super(),_(this,_0x25395a(0x10f),new Set()),_(this,_0x25395a(0x1a1),null),(this[_0x25395a(0x17e)]=_0x45b13e,this[_0x25395a(0x2eb)]=_0x302adb,this[_0x25395a(0x193)]=_0x55ddca,this[_0x25395a(0x2f3)]=_0x502607,this['_init']());}[_0x108f61(0x239)](){const _0x28b8bc=_0x108f61;this[_0x28b8bc(0x2eb)][_0x28b8bc(0x228)][_0x28b8bc(0x143)]($[_0x28b8bc(0x1fd)](this[_0x28b8bc(0x251)]),$[_0x28b8bc(0x1c1)](_0x26121c=>{const _0x4263fb=_0x28b8bc;if(_0x26121c){const _0x424740=_0x26121c['sheetId'];return I['combineLatest'](this[_0x4263fb(0x193)][_0x4263fb(0x271)](this[_0x4263fb(0x17e)]['unitId']),this[_0x4263fb(0x2f3)]['currentTheme$'])[_0x4263fb(0x143)]($['map'](([_0x44f9e5,_0x4fb36a])=>{const _0x5e4dee=_0x4263fb,_0x195ac1=new Map();return _0x44f9e5[_0x5e4dee(0xf8)]((_0xb932d7,_0x5da238)=>{const _0x5e858b=_0x5e4dee;if(_0xb932d7['sheetID']===_0x424740){const _0x1ba439={..._0xb932d7};_0x1ba439['color']=this[_0x5e858b(0x2f3)][_0x5e858b(0x142)](_0xb932d7[_0x5e858b(0x385)]),_0x195ac1[_0x5e858b(0x187)](_0x5da238,_0x1ba439);}}),{'skeleton':_0x26121c,'cursors':_0x195ac1};}));}return I['of']({'skeleton':null,'cursors':new Map()});}))[_0x28b8bc(0x346)](({skeleton:_0x13f4ff,cursors:_0x35eae9})=>{const _0x46ad90=_0x28b8bc;this[_0x46ad90(0x378)](),_0x13f4ff&&this[_0x46ad90(0x28b)](_0x13f4ff,_0x35eae9);}),this[_0x28b8bc(0x2eb)]['currentSkeleton$'][_0x28b8bc(0x346)](_0x1e9ea5=>{const _0x13f9fc=_0x28b8bc;if(_0x1e9ea5==null)return;const {skeleton:_0x57e7a6}=_0x1e9ea5,{scene:_0x1c69ef}=this[_0x13f9fc(0x17e)];_0x1c69ef[_0x13f9fc(0x167)][_0x13f9fc(0x2fe)](a['debounce'](_0xf0297c=>{const _0x4e9bba=_0x13f9fc;var _0xa7cd06,_0x5c50ff;const {offsetX:_0x1e4874,offsetY:_0x23b93f}=_0xf0297c,{x:_0x1e5e42,y:_0x4a5be1}=_0x1c69ef['getRelativeToViewportCoord'](C[_0x4e9bba(0x186)][_0x4e9bba(0x39a)]([_0x1e4874,_0x23b93f])),{scaleX:_0x196eb9,scaleY:_0x762cb4}=_0x1c69ef[_0x4e9bba(0x381)](),_0x203e14=_0x1c69ef[_0x4e9bba(0x1ff)](C[_0x4e9bba(0x121)][_0x4e9bba(0x299)]),_0x4a3256=_0x1c69ef[_0x4e9bba(0x204)](C[_0x4e9bba(0x186)][_0x4e9bba(0x39a)]([_0x1e5e42,_0x4a5be1]),_0x203e14),_0x5b0ea8=_0x57e7a6[_0x4e9bba(0x354)](_0x1e4874,_0x23b93f,_0x196eb9,_0x762cb4,_0x4a3256);((_0xa7cd06=this[_0x4e9bba(0x1a1)])==null?void 0x0:_0xa7cd06[_0x4e9bba(0x171)])===_0x5b0ea8[_0x4e9bba(0x171)]&&((_0x5c50ff=this[_0x4e9bba(0x1a1)])==null?void 0x0:_0x5c50ff[_0x4e9bba(0x3b2)])===_0x5b0ea8['row']||this[_0x4e9bba(0x10f)][_0x4e9bba(0xf8)](_0x5043b9=>{const _0x489aff=_0x4e9bba;_0x5043b9[_0x489aff(0x14b)](_0x5b0ea8);});},0x64));});}[_0x108f61(0x28b)](_0x2a0422,_0x4a0c7b){const _0x20e2b9=_0x108f61;var _0x33f454;const _0x5205fe=(_0x33f454=this[_0x20e2b9(0x2eb)]['getCurrent']())==null?void 0x0:_0x33f454[_0x20e2b9(0x2c1)];if(!_0x5205fe)return;const _0x343421=this[_0x20e2b9(0x1f2)]();if(!_0x343421)return;this[_0x20e2b9(0x10f)]['forEach'](_0x3e23c9=>{const _0x4dd9e3=_0x20e2b9;_0x3e23c9[_0x4dd9e3(0x2e6)]();});const {scene:_0x156026}=_0x343421,_0xe35ba=xt(Array[_0x20e2b9(0x3b3)](_0x4a0c7b[_0x20e2b9(0x1a2)]()))[_0x20e2b9(0x17f)](_0x46a589=>{const _0x248000=_0x20e2b9,{color:_0x38dfad,range:_0x190342,name:_0x519bc1,selection:_0x1d2122,sheetID:_0x4af6ea}=_0x46a589,{startColumn:_0x534b8c,startRow:_0xd341bc,endColumn:_0x344ae4,endRow:_0x5f5845}=_0x190342,_0x400141=J[_0x248000(0x341)](_0xd341bc,_0x534b8c,_0x156026,_0x5205fe),_0x1a9e23=J['getCoordByCell'](_0x5f5845,_0x344ae4,_0x156026,_0x5205fe),{columnHeaderHeightAndMarginTop:_0x5ddd4e}=_0x5205fe,{startX:_0x36447a,startY:_0x46e607}=_0x400141,{endX:_0x5dd5b9,endY:_0x1bf8b1}=_0x1a9e23,_0x5ca1dc=_0x5dd5b9-_0x36447a,_0x21d1b9=_0x1bf8b1-_0x46e607,_0xdd8db={'labelPosition':_0x46e607-_0x5ddd4e>=X?'top':_0x248000(0x382),'sheetID':_0x4af6ea,'range':_0x190342,'color':_0x38dfad,'name':_0x519bc1,'selection':_0x1d2122,'left':_0x36447a,'top':_0x46e607,'width':_0x5ca1dc,'height':_0x21d1b9,'evented':!0x1,'zIndex':$t};return new je(_0x519bc1,_0xdd8db);});_0x156026[_0x20e2b9(0x270)](_0xe35ba,At),this[_0x20e2b9(0x10f)]=new Set(_0xe35ba);}[_0x108f61(0x378)](){const _0x16ad39=_0x108f61;var _0x47b49f;(_0x47b49f=this['_cursors'])==null||_0x47b49f[_0x16ad39(0xf8)](_0x22c6cd=>_0x22c6cd[_0x16ad39(0x1a6)]());}[_0x108f61(0x1f2)](){const _0x331b98=_0x108f61;return J[_0x331b98(0x113)](this[_0x331b98(0x17e)][_0x331b98(0x291)],this['_context']);}};Ce=yt([ue(0x1,a['Inject'](J[_0x108f61(0x1ea)])),ue(0x2,a['Inject'](F)),ue(0x3,a[_0x108f61(0x230)](a[_0x108f61(0x108)]))],Ce);function xt(_0x224bfa){const _0x347d1f=_0x108f61,_0x4d4b4c=new Map();return _0x224bfa['forEach'](_0x2158a7=>{const _0x58a2c7=_0x5f13;if(_0x4d4b4c[_0x58a2c7(0x369)](_0x2158a7[_0x58a2c7(0x1a0)])){const _0x58465b=_0x4d4b4c[_0x58a2c7(0x1e2)](_0x2158a7[_0x58a2c7(0x1a0)]);_0x58465b[_0x58a2c7(0x21e)]+=',\x20'+_0x2158a7[_0x58a2c7(0x21e)];}else _0x4d4b4c[_0x58a2c7(0x187)](_0x2158a7[_0x58a2c7(0x1a0)],_0x2158a7);}),Array[_0x347d1f(0x3b3)](_0x4d4b4c[_0x347d1f(0x1a2)]());}var Bt=Object['getOwnPropertyDescriptor'],Ft=(_0x47a1d0,_0x2dc721,_0x16b744,_0x3d85b9)=>{const _0x12d83d=_0x108f61;for(var _0xc671a1=_0x3d85b9>0x1?void 0x0:_0x3d85b9?Bt(_0x2dc721,_0x16b744):_0x2dc721,_0x328c67=_0x47a1d0[_0x12d83d(0x14d)]-0x1,_0x338161;_0x328c67>=0x0;_0x328c67--)(_0x338161=_0x47a1d0[_0x328c67])&&(_0xc671a1=_0x338161(_0xc671a1)||_0xc671a1);return _0xc671a1;},y=(_0x2c7a71,_0x375bfd)=>(_0x12e8a2,_0x20812b)=>_0x375bfd(_0x12e8a2,_0x20812b,_0x2c7a71);let Z=class extends a[_0x108f61(0x3b6)]{constructor(_0xddce23,_0xdeb5e4,_0x40ee08,_0x271085,_0x3581d1,_0x16d8b8){const _0x5d09fa=_0x108f61;super(),this[_0x5d09fa(0x37f)]=_0xddce23,this[_0x5d09fa(0x104)]=_0xdeb5e4,this[_0x5d09fa(0x12d)]=_0x40ee08,this[_0x5d09fa(0x300)]=_0x271085,this[_0x5d09fa(0x3a1)]=_0x3581d1,this[_0x5d09fa(0x1ae)]=_0x16d8b8,this['_setupBeforeClosingHandler'](),this['_initEvent']();}['_setupBeforeClosingHandler'](){const _0x2a600f=_0x108f61;this[_0x2a600f(0x1d6)](this[_0x2a600f(0x37f)][_0x2a600f(0x2c5)](()=>{const _0x2da64a=_0x2a600f;if(this[_0x2da64a(0x104)][_0x2da64a(0x2cd)][_0x2da64a(0x22e)])return this['_localeService']['t']('collaboration.offline-data-not-saved');}));}['_initEvent'](){const _0x7805bf=_0x108f61;this[_0x7805bf(0x1d6)](this[_0x7805bf(0x12d)][_0x7805bf(0xfa)]['subscribe'](_0x5cc0be=>{const _0x3ecc37=_0x7805bf;_0x5cc0be['id']===u[_0x3ecc37(0x35a)][_0x3ecc37(0x181)]&&this[_0x3ecc37(0x300)]['show']({'type':p['MessageType'][_0x3ecc37(0x1c0)],'content':this[_0x3ecc37(0x1ae)]['t'](_0x3ecc37(0x1a8))}),_0x5cc0be['id']===u[_0x3ecc37(0x35a)][_0x3ecc37(0x39b)]&&this[_0x3ecc37(0x300)]['show']({'type':p[_0x3ecc37(0x1af)][_0x3ecc37(0x1c0)],'content':this[_0x3ecc37(0x1ae)]['t'](_0x3ecc37(0x349))}),_0x5cc0be['id']===u[_0x3ecc37(0x35a)]['PERMISSION_DENIED']&&this['_notificationService'][_0x3ecc37(0x146)]({'title':this[_0x3ecc37(0x1ae)]['t'](_0x3ecc37(0x1a3)),'content':this[_0x3ecc37(0x1ae)]['t'](_0x3ecc37(0x264)),'type':_0x3ecc37(0x29b),'duration':0x0}),_0x5cc0be['id']===u[_0x3ecc37(0x35a)]['CONFLICT']&&this[_0x3ecc37(0x300)][_0x3ecc37(0x146)]({'type':p['MessageType'][_0x3ecc37(0x1b4)],'content':this[_0x3ecc37(0x1ae)]['t']('collaboration.closeRoom')+'('+_0x5cc0be[_0x3ecc37(0x184)]+')'}),_0x5cc0be['id']===u[_0x3ecc37(0x35a)]['JOIN_ROOM_FAILED']&&this['_messageService'][_0x3ecc37(0x146)]({'type':p['MessageType'][_0x3ecc37(0x1c0)],'content':this[_0x3ecc37(0x1ae)]['t'](_0x5cc0be['data']||'')}),_0x5cc0be['id']===u[_0x3ecc37(0x35a)][_0x3ecc37(0x307)]&&this[_0x3ecc37(0x300)][_0x3ecc37(0x146)]({'type':p[_0x3ecc37(0x1af)][_0x3ecc37(0x1c0)],'content':this['_localeService']['t']('session.will-retry')}),_0x5cc0be['id']===u['CollaborationUIEventId'][_0x3ecc37(0x30d)]&&this[_0x3ecc37(0x300)]['show']({'type':p[_0x3ecc37(0x1af)][_0x3ecc37(0x1b4)],'content':this['_localeService']['t'](_0x3ecc37(0x25a))}),_0x5cc0be['id']===u[_0x3ecc37(0x35a)]['SUBMIT_CHANGESET_TIMEOUT']&&this[_0x3ecc37(0x300)][_0x3ecc37(0x146)]({'type':p['MessageType'][_0x3ecc37(0x1b4)],'content':this['_localeService']['t'](_0x3ecc37(0x180))});}));}};Z=Ft([y(0x0,O['IBeforeCloseService']),y(0x1,u[_0x108f61(0x1d8)]),y(0x2,a[_0x108f61(0x230)](u[_0x108f61(0xf5)])),y(0x3,O[_0x108f61(0x1c5)]),y(0x4,O[_0x108f61(0x158)]),y(0x5,a[_0x108f61(0x230)](a[_0x108f61(0x179)]))],Z);var jt=Object[_0x108f61(0x37b)],kt=(_0x4672c3,_0xb8a3c8,_0x154422,_0x271b63)=>{const _0x18dfb9=_0x108f61;for(var _0x56ecb7=_0x271b63>0x1?void 0x0:_0x271b63?jt(_0xb8a3c8,_0x154422):_0xb8a3c8,_0xa38866=_0x4672c3[_0x18dfb9(0x14d)]-0x1,_0x3320d9;_0xa38866>=0x0;_0xa38866--)(_0x3320d9=_0x4672c3[_0xa38866])&&(_0x56ecb7=_0x3320d9(_0x56ecb7)||_0x56ecb7);return _0x56ecb7;},z=(_0x4a32dd,_0x4a61e2)=>(_0x36f19d,_0x42ebd9)=>_0x4a61e2(_0x36f19d,_0x42ebd9,_0x4a32dd);let Q=class extends a[_0x108f61(0x3b6)]{constructor(_0x208bb3,_0x20b824,_0x593774,_0x229cbd){const _0x3d20e4=_0x108f61;super(),_(this,_0x3d20e4(0x30b)),(this[_0x3d20e4(0x266)]=_0x208bb3,this[_0x3d20e4(0x182)]=_0x20b824,this[_0x3d20e4(0x214)]=_0x593774,this[_0x3d20e4(0x160)]=_0x229cbd,this[_0x3d20e4(0x239)]());}['_init'](){const _0x18e24b=_0x108f61;this[_0x18e24b(0x114)](),this[_0x18e24b(0x168)](),this['_monkeyPatchLogService'](),this[_0x18e24b(0x31b)]();}[_0x108f61(0x31b)](){const _0x489a46=_0x108f61;this[_0x489a46(0x1d6)](this[_0x489a46(0x160)][_0x489a46(0x1a9)]['subscribe'](_0x1457cf=>{const _0x5f28fe=_0x489a46;this[_0x5f28fe(0x30b)]=_0x1457cf==null?void 0x0:_0x1457cf[_0x5f28fe(0x201)];}));}[_0x108f61(0x114)](){const _0x521bef=_0x108f61,_0x3d6f78=_0x1477c0=>{const _0x564ef5=_0x5f13;var _0x3392e8;this[_0x564ef5(0x1f8)]('error',_0x564ef5(0x10a)+_0x1477c0[_0x564ef5(0x1ac)]+'\x20at\x20'+_0x1477c0[_0x564ef5(0x290)]+':'+_0x1477c0[_0x564ef5(0x16c)]+':'+_0x1477c0[_0x564ef5(0x20d)]+'\x0a'+(((_0x3392e8=_0x1477c0['error'])==null?void 0x0:_0x3392e8['stack'])||''));};window[_0x521bef(0x321)]('error',_0x3d6f78),this[_0x521bef(0x1d6)](()=>{const _0x57a278=_0x521bef;window['removeEventListener'](_0x57a278(0x29b),_0x3d6f78);});}[_0x108f61(0x168)](){const _0x1c59ab=_0x108f61,_0x18afb3=_0x2ffffe=>{const _0x281dd7=_0x5f13;this['_uploadLog'](_0x281dd7(0x29b),_0x281dd7(0x1fa)+_0x2ffffe[_0x281dd7(0x192)]);};window[_0x1c59ab(0x321)](_0x1c59ab(0x395),_0x18afb3),this[_0x1c59ab(0x1d6)](()=>{const _0x432af0=_0x1c59ab;window[_0x432af0(0x309)](_0x432af0(0x395),_0x18afb3);});}[_0x108f61(0x1e1)](){const _0x5c38da=_0x108f61,_0x66a9be=this[_0x5c38da(0x214)]['error']['bind'](this['_logService']);this[_0x5c38da(0x214)][_0x5c38da(0x29b)]=(..._0x4b62e8)=>{const _0xb20673=_0x5c38da,_0x3f78f9=_0x4b62e8['map'](_0x1c8527=>_0x1c8527 instanceof Error?_0x1c8527[_0xb20673(0x1ac)]+'\x0a'+_0x1c8527[_0xb20673(0x15f)]:String(_0x1c8527))[_0xb20673(0x1d0)]('\x20');this[_0xb20673(0x1f8)](_0xb20673(0x29b),'[LogService\x20Error]:\x20'+_0x3f78f9),_0x66a9be(..._0x4b62e8);},this[_0x5c38da(0x1d6)](()=>{const _0x589d02=_0x5c38da;this[_0x589d02(0x214)]['error']=_0x66a9be;});}[_0x108f61(0x1f8)](_0x1ca26e,_0x35aa71){const _0x25380e=_0x108f61;try{const _0x5bade0={'userId':this[_0x25380e(0x30b)],'logLabel':_0x1ca26e,'content':_0x35aa71};this[_0x25380e(0x182)]['post']('/universer-api/frontend/logs',{'body':_0x5bade0})[_0x25380e(0x11e)](()=>{});}catch{}}};Q=kt([z(0x0,a[_0x108f61(0x230)](a['Injector'])),z(0x1,a[_0x108f61(0x230)](x[_0x108f61(0x2de)])),z(0x2,a['ILogService']),z(0x3,a[_0x108f61(0x230)](u[_0x108f61(0x2af)]))],Q);const Yt=_0x108f61(0x12a),Me={};var Ht=Object[_0x108f61(0x37b)],Wt=(_0x3a19ee,_0x3f8d05,_0x314b71,_0x45b9f3)=>{for(var _0xe66453=_0x45b9f3>0x1?void 0x0:_0x45b9f3?Ht(_0x3f8d05,_0x314b71):_0x3f8d05,_0x3cd972=_0x3a19ee['length']-0x1,_0x4141e8;_0x3cd972>=0x0;_0x3cd972--)(_0x4141e8=_0x3a19ee[_0x3cd972])&&(_0xe66453=_0x4141e8(_0xe66453)||_0xe66453);return _0xe66453;},Ae=(_0x3e2791,_0x4e99b3)=>(_0x38daac,_0x53f15c)=>_0x4e99b3(_0x38daac,_0x53f15c,_0x3e2791);let ee=class{constructor(_0x1e175d,_0x236665){const _0x544bb1=_0x108f61;this[_0x544bb1(0x111)]=_0x1e175d,this[_0x544bb1(0x10b)]=_0x236665;}[_0x108f61(0x211)](_0x422007){const _0x24c86b=_0x108f61;this['_transformUndoRedoStack'](_0x422007),this[_0x24c86b(0x2bb)](_0x422007);}['transformRemoteChangeset'](_0x1573f7){const _0x9d2706=_0x108f61,{unitID:_0x1e8bc4}=_0x1573f7,_0x3deab9=this[_0x9d2706(0x10b)][_0x9d2706(0x330)](_0x1e8bc4)[_0x9d2706(0x216)](T['DocIMEInputManagerService']),{redoCache:_0x3263fa}=_0x3deab9['getUndoRedoMutationParamsCache']();if(_0x3263fa[_0x9d2706(0x14d)]===0x0)return _0x1573f7;let _0xb2697d=a['Tools'][_0x9d2706(0x2e0)](_0x1573f7[_0x9d2706(0x1d5)][0x0]);for(let _0x5259e1=0x0;_0x5259e1<_0x3263fa[_0x9d2706(0x14d)];_0x5259e1++){const _0x454a03={'id':_0x9d2706(0x325),'params':{..._0x3263fa[_0x5259e1]}},_0xb3fb0c=this['_transformService']['transformMutation'](_0xb2697d,_0x454a03,!0x1);if(g['isTransformMutationFailure'](_0xb3fb0c))throw _0xb3fb0c[_0x9d2706(0x29b)];_0xb2697d=_0xb3fb0c['m1Prime'];}return{...a[_0x9d2706(0x139)][_0x9d2706(0x2e0)](_0x1573f7),'mutations':[_0xb2697d]};}['_transformUndoRedoStack'](_0x1087b0){const _0x1545a4=_0x108f61,{unitID:_0x53e782}=_0x1087b0,_0x199fa6=this[_0x1545a4(0x10b)]['getRenderById'](_0x53e782)[_0x1545a4(0x216)](T[_0x1545a4(0x1d7)]),{undoCache:_0x27a146,redoCache:_0x468238}=_0x199fa6[_0x1545a4(0x3b5)]();if(_0x27a146[_0x1545a4(0x14d)]===0x0||_0x468238[_0x1545a4(0x14d)]===0x0)return;const _0x58fec4=[],_0x2fedc8=[];let _0x2de1d6=a['Tools'][_0x1545a4(0x2e0)](_0x1087b0['mutations'][0x0]),_0x289f9e=a[_0x1545a4(0x139)][_0x1545a4(0x2e0)](_0x1087b0[_0x1545a4(0x1d5)][0x0]);for(let _0x1378d3=_0x27a146[_0x1545a4(0x14d)]-0x1;_0x1378d3>=0x0;_0x1378d3--){const _0x59b4ce={'id':_0x1545a4(0x325),'params':{..._0x27a146[_0x1378d3]}},_0x541704={'id':_0x1545a4(0x325),'params':{..._0x468238[_0x1378d3]}},_0x4b5609=this[_0x1545a4(0x111)][_0x1545a4(0x10c)](_0x2de1d6,_0x59b4ce,!0x1),_0x609566=this[_0x1545a4(0x111)]['transformMutation'](_0x289f9e,_0x541704,!0x1);if(g['isTransformMutationFailure'](_0x4b5609))throw _0x4b5609[_0x1545a4(0x29b)];if(g[_0x1545a4(0x35f)](_0x609566))throw _0x609566['error'];_0x58fec4[_0x1545a4(0x147)](_0x4b5609['m2Prime'][_0x1545a4(0x39e)]),_0x2fedc8[_0x1545a4(0x147)](_0x609566[_0x1545a4(0x1bf)]['params']),_0x2de1d6=_0x4b5609[_0x1545a4(0x384)],_0x289f9e=_0x609566[_0x1545a4(0x384)];}_0x199fa6[_0x1545a4(0x140)]({'undoCache':_0x58fec4,'redoCache':_0x2fedc8});}[_0x108f61(0x2bb)](_0x23eb85){const _0x4854b2=_0x108f61,{unitID:_0x65ef0e}=_0x23eb85,_0x19779b=this[_0x4854b2(0x10b)][_0x4854b2(0x330)](_0x65ef0e)[_0x4854b2(0x216)](T[_0x4854b2(0x1d7)]),_0xf3e36c=_0x19779b[_0x4854b2(0x20f)]();if(_0xf3e36c==null)return;const _0x1f6549=[{'id':_0x4854b2(0x325),'params':{'unitId':_0x23eb85['unitID'],'actions':null,'textRanges':[_0xf3e36c]}}],_0x1772b5=this[_0x4854b2(0x111)][_0x4854b2(0x1be)](_0x23eb85,_0x1f6549);if(!g[_0x4854b2(0x10d)](_0x1772b5))throw _0x1772b5['error'];const _0x41ee1a=_0x1772b5[_0x4854b2(0x1bf)][0x0]['params'][_0x4854b2(0x23d)];Array[_0x4854b2(0x280)](_0x41ee1a)&&_0x41ee1a[_0x4854b2(0x14d)]&&_0x19779b[_0x4854b2(0x367)](_0x41ee1a[0x0]);}};ee=Wt([Ae(0x0,g['ITransformService']),Ae(0x1,C[_0x108f61(0x1cf)])],ee);var Vt=Object[_0x108f61(0x37b)],Gt=(_0x38d197,_0x32fee0,_0x26434c,_0x3aba73)=>{const _0x438923=_0x108f61;for(var _0x5f4ac4=_0x3aba73>0x1?void 0x0:_0x3aba73?Vt(_0x32fee0,_0x26434c):_0x32fee0,_0x3ea13f=_0x38d197[_0x438923(0x14d)]-0x1,_0x2d7d53;_0x3ea13f>=0x0;_0x3ea13f--)(_0x2d7d53=_0x38d197[_0x3ea13f])&&(_0x5f4ac4=_0x2d7d53(_0x5f4ac4)||_0x5f4ac4);return _0x5f4ac4;},Ie=(_0x21c55e,_0x43d932)=>(_0xc8748f,_0x467fbd)=>_0x43d932(_0xc8748f,_0x467fbd,_0x21c55e);let te=class{constructor(_0x5e5cbc,_0x49494c,_0x579c88){const _0x52dc41=_0x108f61;this[_0x52dc41(0x266)]=_0x5e5cbc,this['_transformService']=_0x49494c,this[_0x52dc41(0x2e8)]=_0x579c88;}[_0x108f61(0x2bf)](_0x29a21c){const _0x5ba2cc=_0x108f61;this[_0x5ba2cc(0x37a)](_0x29a21c);}[_0x108f61(0x379)](_0xdfa8a){const _0x4debf2=_0x108f61,{unitID:_0x4268ed}=_0xdfa8a,{collaboration:_0x2a38e2}=this[_0x4debf2(0x2e8)][_0x4debf2(0x2a1)](_0x4268ed);if(_0x2a38e2[_0x4debf2(0x14d)]===0x0)return _0xdfa8a;let _0x5ad3ad=a[_0x4debf2(0x139)][_0x4debf2(0x2e0)](_0xdfa8a[_0x4debf2(0x1d5)][0x0]);for(let _0x55a576=0x0;_0x55a576<_0x2a38e2[_0x4debf2(0x14d)];_0x55a576++){const _0x4b8275={'id':_0x4debf2(0x325),'params':{'unitId':_0x2a38e2[_0x55a576][_0x4debf2(0x2aa)],..._0x2a38e2[_0x55a576][_0x4debf2(0x23a)]}},_0x45bd95=this['_transformService'][_0x4debf2(0x10c)](_0x5ad3ad,_0x4b8275,!0x1);if(g[_0x4debf2(0x35f)](_0x45bd95))throw _0x45bd95['error'];_0x5ad3ad=_0x45bd95[_0x4debf2(0x384)];}return{...a[_0x4debf2(0x139)][_0x4debf2(0x2e0)](_0xdfa8a),'mutations':[_0x5ad3ad]};}[_0x108f61(0x37a)](_0xb3d9a7){const _0x48c062=_0x108f61,{unitID:_0x4e9381}=_0xb3d9a7,{history:_0x14dbb4,collaboration:_0x2ed722}=this[_0x48c062(0x2e8)][_0x48c062(0x2a1)](_0x4e9381);if(_0x14dbb4[_0x48c062(0x14d)]===0x0&&_0x2ed722[_0x48c062(0x14d)]===0x0)return;const _0x14a52a=[],_0x155fff=[];let _0xe7161d=a['Tools'][_0x48c062(0x2e0)](_0xb3d9a7[_0x48c062(0x1d5)][0x0]),_0x12bf3d=a[_0x48c062(0x139)][_0x48c062(0x2e0)](_0xb3d9a7[_0x48c062(0x1d5)][0x0]);for(let _0x5b2da8=_0x14dbb4[_0x48c062(0x14d)]-0x1;_0x5b2da8>=0x0;_0x5b2da8--){const _0x4dbf94={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x14dbb4[_0x5b2da8][_0x48c062(0x2aa)],..._0x14dbb4[_0x5b2da8][_0x48c062(0x2da)]}},_0x198484={'id':_0x48c062(0x325),'params':{'unitId':_0x14dbb4[_0x5b2da8]['unitId'],..._0x14dbb4[_0x5b2da8][_0x48c062(0x23a)]}},_0x3e1654=this[_0x48c062(0x111)][_0x48c062(0x10c)](_0xe7161d,_0x4dbf94,!0x1),_0x571bec=this[_0x48c062(0x111)][_0x48c062(0x10c)](_0x12bf3d,_0x198484,!0x1);if(g[_0x48c062(0x35f)](_0x3e1654))throw _0x3e1654[_0x48c062(0x29b)];if(g[_0x48c062(0x35f)](_0x571bec))throw _0x571bec[_0x48c062(0x29b)];_0x14a52a['unshift']({..._0x14dbb4[_0x5b2da8],'undoState':_0x3e1654[_0x48c062(0x1bf)][_0x48c062(0x39e)],'redoState':_0x571bec[_0x48c062(0x1bf)][_0x48c062(0x39e)]}),_0xe7161d=_0x3e1654['m1Prime'],_0x12bf3d=_0x571bec['m1Prime'];}_0xe7161d=a[_0x48c062(0x139)][_0x48c062(0x2e0)](_0xb3d9a7[_0x48c062(0x1d5)][0x0]),_0x12bf3d=a[_0x48c062(0x139)]['deepClone'](_0xb3d9a7[_0x48c062(0x1d5)][0x0]);for(let _0xb034a1=_0x2ed722[_0x48c062(0x14d)]-0x1;_0xb034a1>=0x0;_0xb034a1--){const _0x39a26f={'id':_0x48c062(0x325),'params':{'unitId':_0x2ed722[_0xb034a1]['unitId'],..._0x2ed722[_0xb034a1][_0x48c062(0x2da)]}},_0xbf49ea={'id':_0x48c062(0x325),'params':{'unitId':_0x2ed722[_0xb034a1]['unitId'],..._0x2ed722[_0xb034a1][_0x48c062(0x23a)]}},_0x14715e=this['_transformService']['transformMutation'](_0xe7161d,_0x39a26f,!0x1),_0x585583=this[_0x48c062(0x111)][_0x48c062(0x10c)](_0x12bf3d,_0xbf49ea,!0x1);if(g[_0x48c062(0x35f)](_0x14715e))throw _0x14715e['error'];if(g[_0x48c062(0x35f)](_0x585583))throw _0x585583[_0x48c062(0x29b)];_0x155fff[_0x48c062(0x147)]({..._0x2ed722[_0xb034a1],'undoState':_0x14715e[_0x48c062(0x1bf)][_0x48c062(0x39e)],'redoState':_0x585583[_0x48c062(0x1bf)][_0x48c062(0x39e)]}),_0xe7161d=_0x14715e[_0x48c062(0x384)],_0x12bf3d=_0x585583[_0x48c062(0x384)];}this[_0x48c062(0x2e8)][_0x48c062(0x3a2)](_0x4e9381,{'history':_0x14a52a,'collaboration':_0x155fff});}};te=Gt([Ie(0x0,a[_0x108f61(0x230)](a[_0x108f61(0x1e8)])),Ie(0x1,g[_0x108f61(0x12b)]),Ie(0x2,a[_0x108f61(0x230)](T['DocStateChangeManagerService']))],te);var Xt=Object[_0x108f61(0x37b)],Kt=(_0x53364f,_0x132b05,_0x196759,_0x1ae082)=>{const _0x3ad9fb=_0x108f61;for(var _0x4c1c74=_0x1ae082>0x1?void 0x0:_0x1ae082?Xt(_0x132b05,_0x196759):_0x132b05,_0x2c9774=_0x53364f[_0x3ad9fb(0x14d)]-0x1,_0x47a22b;_0x2c9774>=0x0;_0x2c9774--)(_0x47a22b=_0x53364f[_0x2c9774])&&(_0x4c1c74=_0x47a22b(_0x4c1c74)||_0x4c1c74);return _0x4c1c74;},Pe=(_0x36bdf7,_0x7dd84e)=>(_0x373974,_0xad49e3)=>_0x7dd84e(_0x373974,_0xad49e3,_0x36bdf7);let se=class{constructor(_0x5bb846,_0x1f108f){const _0x2d0027=_0x108f61;this['_injector']=_0x5bb846,this[_0x2d0027(0x111)]=_0x1f108f;}['transformSelections'](_0x34cdcb){const _0x29ddc0=_0x108f61;var _0x5984be;const _0x582e30=this[_0x29ddc0(0x266)][_0x29ddc0(0x1e2)](V[_0x29ddc0(0x131)]),_0x5807bb=(_0x5984be=_0x582e30[_0x29ddc0(0x344)]())!=null?_0x5984be:[];if(_0x5807bb[_0x29ddc0(0x14d)]===0x0)return;const _0x4e5e22=_0x34cdcb[_0x29ddc0(0x24b)],_0x5a5634=[{'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x4e5e22,'actions':null,'textRanges':_0x5807bb}}],_0x425016=this[_0x29ddc0(0x111)]['transformMutationsWithChangeset'](_0x34cdcb,_0x5a5634);if(!g[_0x29ddc0(0x10d)](_0x425016))throw _0x425016['error'];const _0x2f96be=_0x425016['m2Prime'][0x0][_0x29ddc0(0x39e)][_0x29ddc0(0x23d)];Array['isArray'](_0x2f96be)&&_0x2f96be['length']&&_0x582e30[_0x29ddc0(0x1c8)](_0x2f96be,{'unitId':_0x4e5e22,'subUnitId':_0x4e5e22},!0x1);}};se=Kt([Pe(0x0,a[_0x108f61(0x230)](a['Injector'])),Pe(0x1,g[_0x108f61(0x12b)])],se);var qt=Object[_0x108f61(0x37b)],zt=(_0x1e3459,_0x170142,_0x33e4e7,_0x2bed96)=>{const _0x224359=_0x108f61;for(var _0x32df13=_0x2bed96>0x1?void 0x0:_0x2bed96?qt(_0x170142,_0x33e4e7):_0x170142,_0x21484e=_0x1e3459[_0x224359(0x14d)]-0x1,_0x4e2f2d;_0x21484e>=0x0;_0x21484e--)(_0x4e2f2d=_0x1e3459[_0x21484e])&&(_0x32df13=_0x4e2f2d(_0x32df13)||_0x32df13);return _0x32df13;},N=(_0x37ac06,_0x299d11)=>(_0x4a4623,_0x221265)=>_0x299d11(_0x4a4623,_0x221265,_0x37ac06);let ie=class extends a['Disposable']{constructor(_0x5e042b,_0x54edf6,_0x16e426,_0x5a0aca,_0x326de5,_0x5a9fa1,_0x1d33d0,_0x3efbee){const _0x12443e=_0x108f61;super(),_(this,_0x12443e(0x286),new I[(_0x12443e(0x391))](u['CollaborationStatus'][_0x12443e(0x162)])),(this[_0x12443e(0x2e8)]=_0x5e042b,this[_0x12443e(0x246)]=_0x54edf6,this[_0x12443e(0x2a9)]=_0x16e426,this[_0x12443e(0x128)]=_0x5a0aca,this[_0x12443e(0x2f8)]=_0x326de5,this[_0x12443e(0x320)]=_0x5a9fa1,this[_0x12443e(0x300)]=_0x1d33d0,this['_localeService']=_0x3efbee,this['_initEntityListener']());}[_0x108f61(0x1ca)](){const _0x606963=_0x108f61;this[_0x606963(0x1d6)](this[_0x606963(0x246)]['entityInit$'][_0x606963(0x346)](_0x392752=>{const _0x477142=_0x606963,_0x3ff0d8=this[_0x477142(0x2e8)][_0x477142(0x215)][_0x477142(0x346)](_0xa2746=>{const _0x366447=_0x477142;if(_0xa2746==null)return;const {unitId:_0x435d00,redoState:_0x429c31,commandId:_0x301934}=_0xa2746;if(_0x435d00!==_0x392752['unitID'])return;const _0x5c8077={'id':_0x301934,'type':a[_0x366447(0x164)][_0x366447(0x33d)],'params':{'unitId':_0x435d00,'actions':_0x429c31['actions'],'textRanges':null}};_0x392752[_0x366447(0x2e9)](_0x5c8077);});if(_0x392752[_0x477142(0x1d6)](_0x3ff0d8),_0x392752 instanceof u[_0x477142(0xfe)]){const _0x567d27={'onTransformIME':_0x58c47a=>this[_0x477142(0x2a9)][_0x477142(0x211)](_0x58c47a),'onTransformState':_0x1db9de=>this[_0x477142(0x128)][_0x477142(0x2bf)](_0x1db9de),'onTransformSelections':_0x1c0f7e=>this[_0x477142(0x2f8)][_0x477142(0x134)](_0x1c0f7e),'onSyncEditingCollabCursor':_0xacdc51=>this['_docSyncEditingCollabCursorService'][_0x477142(0x19d)](_0xacdc51),'onTransformRemoteChangesetByIMECache':_0x59d223=>this[_0x477142(0x2a9)][_0x477142(0x379)](_0x59d223),'onTransformRemoteChangesetByStateCache':_0x4829ca=>this[_0x477142(0x128)]['transformRemoteChangeset'](_0x4829ca)};_0x392752[_0x477142(0x2e1)](_0x567d27);}}));}};ie=zt([N(0x0,a[_0x108f61(0x230)](T['DocStateChangeManagerService'])),N(0x1,a[_0x108f61(0x230)](u[_0x108f61(0x328)])),N(0x2,a[_0x108f61(0x230)](ee)),N(0x3,a[_0x108f61(0x230)](te)),N(0x4,a['Inject'](se)),N(0x5,a[_0x108f61(0x230)](be)),N(0x6,O['IMessageService']),N(0x7,a[_0x108f61(0x230)](a[_0x108f61(0x179)]))],ie);var G=(_0x24e22c=>(_0x24e22c[_0x24e22c[_0x108f61(0x1c9)]=0x0]=_0x108f61(0x1c9),_0x24e22c[_0x24e22c['OK']=0x1]='OK',_0x24e22c[_0x24e22c[_0x108f61(0x1a7)]=0x2]=_0x108f61(0x1a7),_0x24e22c[_0x24e22c[_0x108f61(0x338)]=0x3]=_0x108f61(0x338),_0x24e22c[_0x24e22c[_0x108f61(0x352)]=0x4]=_0x108f61(0x352),_0x24e22c[_0x24e22c[_0x108f61(0x269)]=0x5]=_0x108f61(0x269),_0x24e22c[_0x24e22c[_0x108f61(0x150)]=0x6]=_0x108f61(0x150),_0x24e22c[_0x24e22c[_0x108f61(0x1b1)]=0x7]=_0x108f61(0x1b1),_0x24e22c[_0x24e22c[_0x108f61(0x255)]=0x8]=_0x108f61(0x255),_0x24e22c[_0x24e22c[_0x108f61(0x110)]=0x9]=_0x108f61(0x110),_0x24e22c[_0x24e22c[_0x108f61(0x17d)]=0xa]=_0x108f61(0x17d),_0x24e22c[_0x24e22c['MOBILE_VERIFY_CODE_MISMATCH']=0xb]=_0x108f61(0x39d),_0x24e22c[_0x24e22c[_0x108f61(0x12c)]=0xc]=_0x108f61(0x12c),_0x24e22c[_0x24e22c[_0x108f61(0x345)]=0xd]=_0x108f61(0x345),_0x24e22c[_0x24e22c[_0x108f61(0x2ee)]=0xe]=_0x108f61(0x2ee),_0x24e22c[_0x24e22c[_0x108f61(0x2fa)]=0xf]=_0x108f61(0x2fa),_0x24e22c[_0x24e22c['LOGIN_TOKEN_PROCESSING_FAILED']=0x10]=_0x108f61(0x29d),_0x24e22c[_0x24e22c[_0x108f61(0x27f)]=0x64]='CURRENT_STATUS_CANNOT_OPERATE',_0x24e22c[_0x24e22c[_0x108f61(0x19a)]=0x65]=_0x108f61(0x19a),_0x24e22c[_0x24e22c['USER_NOT_FOUND']=0xc9]=_0x108f61(0x20c),_0x24e22c[_0x24e22c[_0x108f61(0x18c)]=0xca]=_0x108f61(0x18c),_0x24e22c[_0x24e22c[_0x108f61(0x279)]=0x1389]=_0x108f61(0x279),_0x24e22c[_0x24e22c[_0x108f61(0x218)]=0x1771]=_0x108f61(0x218),_0x24e22c[_0x24e22c[_0x108f61(0x36d)]=0x1772]='SNAPSHOT_HAS_BEEN_REMOVED',_0x24e22c[_0x24e22c[_0x108f61(0x35d)]=0x1773]=_0x108f61(0x35d),_0x24e22c[_0x24e22c[_0x108f61(0x1da)]=0x1b59]='APPLY_REJECT',_0x24e22c[_0x24e22c['APPLY_NON_SEQUENTIAL_REVISION']=0x1b5a]='APPLY_NON_SEQUENTIAL_REVISION',_0x24e22c[_0x24e22c[_0x108f61(0x334)]=0x1b5b]=_0x108f61(0x334),_0x24e22c[_0x24e22c[_0x108f61(0x227)]=0x1b5c]=_0x108f61(0x227),_0x24e22c[_0x24e22c[_0x108f61(0x265)]=0x1b5d]=_0x108f61(0x265),_0x24e22c[_0x24e22c[_0x108f61(0x314)]=0x1f41]='CONNECTOR_DATA_TOO_LARGE',_0x24e22c[_0x24e22c['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]=_0x108f61(0x22c),_0x24e22c[_0x24e22c[_0x108f61(0x209)]=0x232a]=_0x108f61(0x209),_0x24e22c[_0x24e22c['LICENSE_IMPORT_SIZE_EXCEEDED']=0x232b]=_0x108f61(0xf2),_0x24e22c[_0x24e22c[_0x108f61(0x13e)]=0x232c]=_0x108f61(0x13e),_0x24e22c[_0x24e22c['LICENSE_DISTRO_REJECTED']=0x232d]=_0x108f61(0x1b5),_0x24e22c[_0x24e22c[_0x108f61(0x331)]=0x2711]=_0x108f61(0x331),_0x24e22c[_0x24e22c[_0x108f61(0x375)]=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x24e22c[_0x24e22c['YUUMI_RATE_OVER_LIMIT']=0x2713]='YUUMI_RATE_OVER_LIMIT',_0x24e22c[_0x24e22c[_0x108f61(0x376)]=0x2714]=_0x108f61(0x376),_0x24e22c[_0x24e22c['YUUMI_NO_CUBOID_FOR_QUESTION']=0x271a]=_0x108f61(0x20a),_0x24e22c[_0x24e22c[_0x108f61(0x13a)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0x24e22c[_0x24e22c['YUUMI_TABLE_NOT_FOUND_IN_UNIT']=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0x24e22c[_0x24e22c[_0x108f61(0x15d)]=0x271d]=_0x108f61(0x15d),_0x24e22c[_0x24e22c[_0x108f61(0x2c0)]=0x271e]=_0x108f61(0x2c0),_0x24e22c[_0x24e22c[_0x108f61(0x175)]=0x271f]='YUUMI_AI_RUN_FAILED',_0x24e22c[_0x24e22c[_0x108f61(0x333)]=0x2720]=_0x108f61(0x333),_0x24e22c[_0x24e22c[_0x108f61(0x1dc)]=0x2af9]=_0x108f61(0x1dc),_0x24e22c[_0x24e22c[_0x108f61(0x380)]=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0x24e22c[_0x24e22c['INVALID_INVITE_CODE']=0x2ee2]=_0x108f61(0x324),_0x24e22c[_0x24e22c[_0x108f61(0x2d2)]=0x2ee3]=_0x108f61(0x2d2),_0x24e22c[_0x24e22c[_0x108f61(0x21d)]=0x2ee4]=_0x108f61(0x21d),_0x24e22c[_0x24e22c[_0x108f61(0x148)]=0x2ee5]=_0x108f61(0x148),_0x24e22c[_0x24e22c[_0x108f61(0x138)]=0x32c9]='WECHAT_HAS_BEEN_BOUND',_0x24e22c[_0x24e22c['MOBILE_HAS_BEEN_BOUND']=0x32ca]=_0x108f61(0x25d),_0x24e22c[_0x24e22c[_0x108f61(0x2b8)]=0x32cb]=_0x108f61(0x2b8),_0x24e22c[_0x24e22c[_0x108f61(0x3ac)]=0x36b1]=_0x108f61(0x3ac),_0x24e22c[_0x24e22c[_0x108f61(0x3b4)]=0x36b2]=_0x108f61(0x3b4),_0x24e22c[_0x24e22c[_0x108f61(0x364)]=0x36b3]='ENTITLE_DUP_SUBSCRIPTION',_0x24e22c[_0x24e22c[_0x108f61(0x154)]=0x36b4]=_0x108f61(0x154),_0x24e22c[_0x24e22c[_0x108f61(0x152)]=0x36b5]=_0x108f61(0x152),_0x24e22c[_0x24e22c[_0x108f61(0x26e)]=0x36b6]=_0x108f61(0x26e),_0x24e22c[_0x24e22c['ENTITLE_COUPON_USED_UP']=0x36b7]=_0x108f61(0x329),_0x24e22c[_0x24e22c[_0x108f61(0x1d3)]=0x36b8]=_0x108f61(0x1d3),_0x24e22c[_0x24e22c[_0x108f61(0x2a2)]=0x3715]='ENTITLE_CHAT_LIMIT_EXCEED',_0x24e22c[_0x24e22c[_0x108f61(0x194)]=0x3716]=_0x108f61(0x194),_0x24e22c[_0x24e22c[_0x108f61(0x32c)]=0x3717]=_0x108f61(0x32c),_0x24e22c[_0x24e22c['ENTITLE_NEED_BILLING_ADDRESS']=0x37dd]=_0x108f61(0x252),_0x24e22c[_0x24e22c[_0x108f61(0x323)]=0x3a99]=_0x108f61(0x323),_0x24e22c[_0x24e22c[_0x108f61(0x2d6)]=0x3a9a]=_0x108f61(0x2d6),_0x24e22c[_0x24e22c['REDEMPTION_CODE_FULLY_REDEEMED']=0x3a9b]=_0x108f61(0x177),_0x24e22c[_0x24e22c['REDEMPTION_CODE_NOT_STARTED']=0x3a9c]='REDEMPTION_CODE_NOT_STARTED',_0x24e22c[_0x24e22c[_0x108f61(0x1f9)]=0x3a9d]=_0x108f61(0x1f9),_0x24e22c[_0x24e22c['REDEMPTION_USER_REDEEM_TIMES_EXCEED']=0x3a9e]='REDEMPTION_USER_REDEEM_TIMES_EXCEED',_0x24e22c[_0x24e22c[_0x108f61(0x127)]=0x3a9f]=_0x108f61(0x127),_0x24e22c[_0x24e22c[_0x108f61(0x372)]=0x3e81]=_0x108f61(0x372),_0x24e22c[_0x24e22c[_0x108f61(0x2bc)]=-0x1]=_0x108f61(0x2bc),_0x24e22c))(G||{});function Jt(_0x234e9f){const _0x1c2a4e=_0x108f61;var _0x11dab2,_0x19cd63;const _0x5f475c=(_0x11dab2=_0x234e9f[_0x1c2a4e(0x235)])==null?void 0x0:_0x11dab2[_0x1c2a4e(0x38a)],_0x23ab9f=((_0x19cd63=_0x234e9f[_0x1c2a4e(0x235)])==null?void 0x0:_0x19cd63['totalFormulasToCalculate'])||0x0;return _0x5f475c===B[_0x1c2a4e(0x157)][_0x1c2a4e(0x190)]&&_0x23ab9f>0x0;}function _0xe0ef(){const _0x1ab415=['CanceledError','drawWith','on-line-icon_clip0_910_349','INVITE_CODE_REQUIRED','sessionTicket','IConfigService','reconnect','REDEMPTION_CODE_INACTIVE','tag','_initStatusListener','_send','undoState','off-line-icon_clip0_910_343','getCollabEntity$','distinctUntilChanged','HTTPService','text','deepClone','addHandlerCallback','collab-client.tooltip.reconnect','measureText','jsxs','getActiveSheet','makeDirty','AWAITING_WITH_PENDING','_docStateChangeManagerService','onLocalMutation','_scheduleHeartbeat','_sheetSkeletonManagerService','startsWith','origin','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','roomMembers','_initCommandExecutedListener','_selfUnitIDs','send','_themeService','parseInt','_onCursorUpdate','setShapeProps','_colorIndex','_docTransformSelectionsService','fromEventSubject','AUTHORIZE_CODE_ILLEGAL','hovered','touchDependencies','?taskId=','subscribeEvent','search','_messageService','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','LOCAL_CACHE_INTERVAL','fill','imageSourceType','top','isActive','SOCKET_FAILED_RETRY','_saveCache','removeEventListener','1577312OUreHy','_memberID','jiqing.500','SOCKET_FAILED','assign','_assignedColors','_cachedData','_univerInstanceService','forwardRef','path','CONNECTOR_DATA_TOO_LARGE','getUnitStatus$','SheetCollabCursorShape','toDisposable','debug','_lastResponseTimestamp','save','_initUserListener','trim','beforeCommandExecuted','_getScale','_drawAnchor','_docSyncEditingCollabCursorService','addEventListener','collabStatus.offline','REDEMPTION_INVALID_CODE','INVALID_INVITE_CODE','doc.mutation.rich-text-editing','_setupSubUnitSync','getCurrentRevOfUnit','CollaborationController','ENTITLE_COUPON_USED_UP','labelPosition','_startSheetCollabCursor','ENTITLE_INSUFFICIENT_QUOTA','CollaborationStatus','_applyCommand','1400466pdricv','getRenderById','YUUMI_UNABLE_LOAD_URL','height','YUUMI_CONNECTOR_URL_NOT_FOUND','APPLY_REVISION_CONFILICT','startFormulaLimitUrl','SetSelectionsOperation','_unitOnClients','PERMISSION_DENIED','clsx','_updateSubUnitFromURLParams','_scheduleClearOtherTimer','jsx','MUTATION','_updateURLWithCurrentState','findNodePositionByCharIndex','arc','getCoordByCell','SessionStatus','_cursor','getDocRanges','EMAIL_VERIFY_CODE_MISMATCH','subscribe','_config','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','collaboration.closeRoom','substring','Plugin','_getAnchorBounding','_commandService','clipPath','SetFormulaCalculationNotificationMutation','init','entries','NOT_FOUND','handleInsertRangeMoveRight','getCellPositionByOffset','FormulaExecutedStateType','IUIPartsService','BrowserCollaborationSocketService','_hasFormulaInDirtyRanges','red.300','CollaborationUIEventId','toRgbString','getSkeleton','ENSURE_SNAPSHOT_EXECUTION','_uiPartsService','isTransformMutationFailure','disableLocalCache','closePath','black','OnLineIcon','ENTITLE_DUP_SUBSCRIPTION','USERS_LEAVE','InsertColCommandId','setActiveRange','url(#$1','has','TEXT','DeleteRangeMoveUpCommandId','includes','SNAPSHOT_HAS_BEEN_REMOVED','url(#off-line-icon_clip0_910_343)','releaseFormulaLimitUrl','shareReplay','_removeClearOtherTimer','DATA_SOURCE_TOO_LARGE','_initResize','CollaborationDataLoaderController','YUUMI_URL_COL_OUT_OF_RANGE','YUUMI_SUBSCRIPTION_NOT_FOUND','formula.calculation.unable','_removeCollabCursors','transformRemoteChangeset','_transformHistoryAndStateStack','getOwnPropertyDescriptor','handleInsertCol','width','_startCalculationLimit','_beforeCloseService','INVITE_CODE_HAS_BEEN_UES','getAncestorScale','bottom','#FFF','m1Prime','color','fromEvent','font','_disabled','startColumn','stage','url(#on-line-icon_clip0_910_349)','_hover','18822xujula','_createSocketURL','_localStorageService','getCellMatrix','BehaviorSubject','TRANSFORM_CHANGE_OBSERVABLE_TYPE','_drawRectRange','_refreshCollabCursors','unhandledrejection','min','_collabCursorState$','Rect','Subject','FromArray','CLOSE_ROOM','_drawTextRange','MOBILE_VERIFY_CODE_MISMATCH','params','getRangePointData','DeleteRangeMoveLeftCommandId','_notificationService','setStateCache','UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN','_maxFormulaLimit','ticket','collabStatus.notCollab','createIdentifier','/run/','Rectangle','2257675WhJPqv','executionId','ENTITLE_CAN_NOT_BUY_LOWER_OTP','exhaustSavingTask','_handleLeaveEvent','then','_document','registerRefRange','row','from','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','getUndoRedoMutationParamsCache','Disposable','_heartbeatTimer','TEXT_RANGE_LAYER_INDEX','idSuffix','restore','stringify','InsertRangeMoveRightCommandId','/universer-api/license/formula/limit/start','collab-text-range-','updateOfflineData','OFFLINE','getParam','_docSkeletonManagerService','WebBrowserSingleActiveUnitService','add','_online','LICENSE_IMPORT_SIZE_EXCEEDED','type','formula.calculation.started','CollaborationUIEventService','collab-text-anchor-','collabStatus.synced','forEach','getUnitId','event$','_anchorDot','result','_collabSessionService','DocCollaborationEntity','getSheetId','_draw','RemoveColCommandId','functionsExecutedState','getMergeData','_localCacheService','No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','IRemoteInstanceService','RECT','ThemeService','_getFormulaLimitStatus','[Window\x20Error]:\x20','_renderManagerService','transformMutation','isTransformMutationsWithChangesetSuccess','subUnitId','_cursors','COMPLETION_FINISHED','_transformService','_roomMembers$','getSheetObject','_initWindowErrorListener','setInterval','PENDING','ranges','_labelPosition','1178880kmjvDp','dirtyRanges','6tyTvIM','mask','split','catch','createInstance','next','SHEET_VIEWPORT_KEY','setParam','svg','_cursorInfo$','NodePositionConvertToCursor','throttleTime','REDEMPTION_CODE_HAS_BEEN_CREATED','_docTransformStateCacheService','1em','collaboration-client-ui.config','ITransformService','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','_collaborationUIEventService','UniverCollaborationClientUIPlugin','getTypeOfUnitDisposed$','DOC_RANGE_TYPE','DocSelectionManagerService','1222048eySyCp','complete','transformSelections','symbol','[CollaborationDataLoaderController]','location','WECHAT_HAS_BEEN_BOUND','Tools','YUUMI_ASYNCIO_CANCELLED','/universer-api/license/formula/limit/done','xlink:href','ILogService','LICENSE_EXPORT_SIZE_EXCEEDED','SetFormulaCalculationStartMutation','setUndoRedoMutationParamsCache','onRendered','getColorFromTheme','pipe','_toggleOnline','saveImage','show','unshift','INVITE_CODE_ALREADY_BOUND','string','onPointerLeave$','onMouseMove','InsertRangeMoveDownCommandId','length','setTimeout','_handleEvent','ALREADY_EXISTS','handleDeleteRangeMoveUp','ENTITLE_INVALID_COUPON_CODE','Workbook','PAYMENT_CHANNEL_NOT_SUPPORT','history','evenodd','FormulaExecuteStageType','INotificationService','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','_memberService','104874GuJBZM','now','YUUMI_ALL_TABLES_IS_INVALID','setConfig','stack','_collaborationSessionService','SetWorksheetActivateCommand','NOT_COLLAB','IUniverInstanceService','CommandType','href','Loading','onPointerMove$','_initUnhandledRejectionListener','asObservable','status$','UNIVER_DOC','lineno','MemberService','blue.400','clearTimeout','_instanceService','column','getMember','displayName','_doCreateSocket','YUUMI_AI_RUN_FAILED','univerjs-icon\x20univerjs-icon-','REDEMPTION_CODE_FULLY_REDEEMED','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','LocaleService','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','SheetsSelectionsService','div','LOGIN_FAILED','_context','map','session.collaboration-timeout','OTHER_CLIENT_EDITING','_httpService','rgba(255,\x20255,\x20255,\x200.01)','data','createSocket','Vector2','set','hide','limitInfo','getTypeOfUnitAdded$','debounce','USER_IS_ANONYMOUS','backgroundColor','_backgroundColor','_configService','START_CALCULATION','cursorInfo','reason','_collabCursorController','ENTITLE_REPORT_LIMIT_EXCEED','contains','_entityInit$','_refRangeService','IImageIoService','RegularPolygon','ERROR_AGAIN','green.600','collabStatus.conflict','syncEditingCollabCursor','_shapes','none','selection','_lastPointer','values','permission.title','colorChannel1','_hovered','dispose','INTERNAL_ERROR','collaboration.single-unit.warning','socket$','OffLineIcon','registerComponent','message','RefRangeService','_localeService','MessageType','_getSessionTicket','INVALID_ARGUMENT','_showGuardMessage','flatMap','Error','LICENSE_DISTRO_REJECTED','deserializeRangeWithSheet','startRow','getUnhiddenWorksheets','roomMembers$','_imageIoService','WebSocketService','FETCH_MISS','RemoteUniscriptService','transformMutationsWithChangeset','m2Prime','Warning','switchMap','storage','UnitStatus','removeParam','IMessageService','handleInsertRangeMoveDown','onCommandExecuted','replaceDocRanges','UNDEFINED','_initEntityListener','_initStatusComponent','_getSaveTimeout','push','_taskIds','IRenderManagerService','join','/universer-api/license/formula/limit/status','defineProperty','ENTITLE_USE_COUPON_NOT_1ST_TRADE','_initCommandInterceptor','mutations','disposeWithMe','DocIMEInputManagerService','ILocalCacheService','getValue','APPLY_REJECT','_scheduleSaving','PY_RUNTIME_SCRIPT_ERROR','beginPath','DisposableCollection','combineLatest','_hideTimer','_monkeyPatchLogService','get','use','defs','moveTo','runRefRangeMutations','_unitStatus','Injector','http://www.w3.org/2000/svg','SheetSkeletonManagerService','addClipboardHook','newValue','_session','some','currentColor','LOCAL_CACHE_INTERVAL_KEY','_syncEditingCollabCursorService','_getSheetObject','override','selections','translate(.97)','handleDeleteRangeMoveLeft','SYNCED','_uploadLog','REDEMPTION_USER_NOT_ELIGIBLE','[Unhandled\x20Rejection]:\x20','range','merge','takeUntil','DocSkeletonManagerService','getViewport','setItem','memberID','resize','M0\x200H16V16H0z','getVpScrollXYInfoByPosToVp','createElement','_registerDependencies','transform','getOffsetConfig','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','YUUMI_NO_CUBOID_FOR_QUESTION','loadOfflineData','USER_NOT_FOUND','colno','onPointerEnter$','getActiveRange','[RemoteUniscriptService]:\x20no\x20focused\x20unit','transformIMECache','onStarting','_toggleOffline','_logService','docStateChange$','with','RxDisposable','SNAPSHOT_INVALID_SNAPSHOT','DEFAULT_WS_SESSION_TICKET_URL','Optional','_id','debounceTime','USER_NOT_INVITED_CODE','name','handleMoveRange','searchParams','cursorInfo$','univer-flex\x20univer-items-center','UniverIcon','isFormulaId','ICommandService','white','APPLY_PERMISSION_DENIED','currentSkeleton$','filter','children','enableFrontendLog','LICENSE_MAX_UNITS_EXCEEDED','IURLService','size','getConfig','Inject','_anchor','ColorKit','delete','UniverInstanceType','stageInfo','getSheetBySheetId','endRow','ILocalStorageService','_init','redoState','subunit','generateRandomId','textRanges','_scene','collab-rect-range-','AWAITING','EffectRefRangId','_handleJoinEvent','SetTextSelectionsOperation','_setFormulaLimitStatus','assignAColorForMemberID','_collaborationController','attrs','RevisionService','handleInsertRow','_onRefRangeChange','unitID','collabCursorState$','enableLocalCache','MoveRangeCommandId','getCurrentSelections','setAlpha','dispose$','ENTITLE_NEED_BILLING_ADDRESS','Unknown\x20user','DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','TOO_MANY_REQUESTS','DesktopCollaborationStatusDisplayController','_docClipboardService','getLocalCacheKey','NodePositionConvertToRectRange','session.connection-failed','Success','_render','MOBILE_HAS_BEEN_BOUND','endColumn','_dataLoaderService','_urlService','_color','_name','Tooltip','permission.content','APPLY_DUPLICATED','_injector','getCurrentUnitForType','REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY','UNAUTHENTICATED','yellow.400','sessionStatus$','toString','COLORS','ENTITLE_COUPON_EXPIRED','_eventUnsubscribe','addObjects','getCollabCursors$','replace','lineTo','RemoveRowCommandId','fillRule','ONLINE','getFocusedUnit','clearInterval','CHANGESET_REVISION_CONFILICT','_clearOtherTimers','pluginName','_cursorShapes','getformulaLimitStatusUrl','_ensureSubject','CURRENT_STATUS_CANNOT_OPERATE','isArray','SetDocZoomRatioOperation','_entities','code','useCallback','pushState','_status$','all','_pollingInterval','round','fillStyle','_updateCollabCursors','Shape','executeCommand','_clearPolling','editingUnit','filename','unit','_registerRenderDependencies','wsSessionTicketUrl','purple.300','invokeId','_getMergeRange','getColor','_checkCalculationAvailable','VIEW_MAIN','urlChange$','error','requireSession','LOGIN_TOKEN_PROCESSING_FAILED','_handleHover','_textBubble','activeSheet$','getStateCache','ENTITLE_CHAT_LIMIT_EXCEED','UPDATE_CURSOR','0\x200\x2017\x2016','_onCursorDelete','OTHER_CLIENTS_EDITING','fillText','_releaseCalculationLimit','_docTransformIMECacheService','unitId','IDocClipboardService','saveOfflineData','18uNqnGO','CollaborationEvent','CollaborationSessionService','_colorAssignService','formula.calculation.waiting','addObject','_updateLocalCursor','0\x200\x2016\x2016','off-line-icon','handleIRemoveCol','maxFormulaLimit','EMAIL_HAS_BEEN_BOUND','isFormulaString','_currentUsage','_transformPreviousActiveRange','UNRECOGNIZED','_range','body','transformStateCache','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','skeleton','mergeOverrideWithDependencies','engine','ACTIVE_UNIT_EVENT_CHANNEL','registerBeforeClose','_saveTaskMap','UNIVER_SHEET','transformByState','ISocketService','_initDependencies','random','NO_OTHER_CLIENTS_EDITING','saveTaskMap','_revisionService'];_0xe0ef=function(){return _0x1ab415;};return _0xe0ef();}function Zt(_0x5e6ab0){const _0x4b405d=_0x108f61;return _0x5e6ab0[_0x4b405d(0x102)]===B[_0x4b405d(0x355)]['SUCCESS'];}var Qt=Object[_0x108f61(0x37b)],es=(_0x4f9ebb,_0x22a5de,_0x1d5c5b,_0xa6e66d)=>{for(var _0x2b74b0=_0xa6e66d>0x1?void 0x0:_0xa6e66d?Qt(_0x22a5de,_0x1d5c5b):_0x22a5de,_0x4d1623=_0x4f9ebb['length']-0x1,_0x46f4f9;_0x4d1623>=0x0;_0x4d1623--)(_0x46f4f9=_0x4f9ebb[_0x4d1623])&&(_0x2b74b0=_0x46f4f9(_0x2b74b0)||_0x2b74b0);return _0x2b74b0;},L=(_0x3610bc,_0x49948b)=>(_0x12c0ca,_0x55576c)=>_0x49948b(_0x12c0ca,_0x55576c,_0x3610bc);const ts=_0x108f61(0x1d1),ss=_0x108f61(0x3bd),is=_0x108f61(0x13b);let ne=class extends a[_0x108f61(0x3b6)]{constructor(_0xfbfea,_0x10fc2d,_0x3f6394,_0x17cf13,_0x2bdc56,_0x51d2cf,_0x1cf07a){const _0xa2892e=_0x108f61;super(),_(this,'_pollingInterval',null),_(this,'_maxFormulaLimit',0x0),_(this,_0xa2892e(0x2ba),0x0),_(this,_0xa2892e(0x1ce),[]),_(this,_0xa2892e(0x319),0x0),(this[_0xa2892e(0x300)]=_0xfbfea,this['_commandService']=_0x10fc2d,this[_0xa2892e(0x18f)]=_0x3f6394,this['_httpService']=_0x17cf13,this['_univerInstanceService']=_0x2bdc56,this[_0xa2892e(0x214)]=_0x51d2cf,this[_0xa2892e(0x1ae)]=_0x1cf07a,this['_initCommandInterceptor']());}[_0x108f61(0x1d4)](){const _0x20892e=_0x108f61;this[_0x20892e(0x1d6)](this[_0x20892e(0x34d)][_0x20892e(0x31d)]((_0x3ef0a2,_0x21fea5)=>{const _0x23b52c=_0x20892e;var _0x538915;if(_0x3ef0a2['id']!==B[_0x23b52c(0x13f)]['id'])return;const _0x1076b6=_0x3ef0a2[_0x23b52c(0x39e)];if(!this[_0x23b52c(0x358)]((_0x538915=_0x1076b6[_0x23b52c(0x11a)])!=null?_0x538915:[]))return;if(!this[_0x23b52c(0x298)]())throw this['_checkAndWaitForCalculationPermission'](_0x3ef0a2,_0x21fea5),this[_0x23b52c(0x1b2)](),new a[(_0x23b52c(0x2cf))]();})),this['disposeWithMe'](this[_0x20892e(0x34d)][_0x20892e(0x1c7)]((_0x30e7d0,_0xe081a1)=>{const _0x37f6e5=_0x20892e;if(_0x30e7d0['id']!==B[_0x37f6e5(0x34f)]['id'])return;const _0x32f7e1=_0x30e7d0[_0x37f6e5(0x39e)];if(Jt(_0x32f7e1)){const _0x5d0757=a['generateRandomId']();this[_0x37f6e5(0x1ce)][_0x37f6e5(0x1cd)](_0x5d0757),this[_0x37f6e5(0x37e)](_0x5d0757);}else{if(Zt(_0x32f7e1)&&this[_0x37f6e5(0x1ce)]['length']>0x0){const _0x3d0247=this[_0x37f6e5(0x1ce)]['shift']();this[_0x37f6e5(0x2a8)](_0x3d0247);}}}));}[_0x108f61(0x1a6)](){const _0x2a2913=_0x108f61;super[_0x2a2913(0x1a6)](),this[_0x2a2913(0x28e)](),this[_0x2a2913(0x1ce)]=[],this['_currentUsage']=0x0,this['_maxFormulaLimit']=0x0,this[_0x2a2913(0x319)]=0x0;}async['_checkAndWaitForCalculationPermission'](_0x379cfb,_0x3d1bba){const _0x2b2731=_0x108f61;for(let _0x48df5a=0x0;_0x48df5a<0x1e;_0x48df5a++)try{if(await this[_0x2b2731(0x109)](),this[_0x2b2731(0x298)]()){this['_applyCommand'](_0x379cfb,_0x3d1bba),this[_0x2b2731(0x300)][_0x2b2731(0x146)]({'content':this[_0x2b2731(0x1ae)]['t'](_0x2b2731(0xf4)),'type':p[_0x2b2731(0x1af)][_0x2b2731(0x25b)]});return;}await new Promise(_0x3a6174=>{const _0x34fce9=_0x2b2731;this[_0x34fce9(0x288)]=window[_0x34fce9(0x14e)](_0x3a6174,0x3e8);});}catch(_0xd9b959){this['_logService'][_0x2b2731(0x29b)](_0xd9b959);}this['_messageService'][_0x2b2731(0x146)]({'content':this[_0x2b2731(0x1ae)]['t'](_0x2b2731(0x377)),'type':p[_0x2b2731(0x1af)][_0x2b2731(0x1b4)]});}[_0x108f61(0x32e)](_0x395d76,_0x267533){const _0x539fac=_0x108f61;try{this[_0x539fac(0x34d)][_0x539fac(0x28d)](_0x395d76['id'],_0x395d76[_0x539fac(0x39e)],_0x267533);}catch(_0x3be3d8){this[_0x539fac(0x214)][_0x539fac(0x29b)](_0x3be3d8);}}[_0x108f61(0x244)](_0x274a6d,_0x346f4b){const _0x30a3a6=_0x108f61;_0x346f4b<this[_0x30a3a6(0x319)]||(this[_0x30a3a6(0x319)]=_0x346f4b,this[_0x30a3a6(0x3a4)]=Number[_0x30a3a6(0x2f4)](_0x274a6d[_0x30a3a6(0x2b7)]),this[_0x30a3a6(0x2ba)]=Number['parseInt'](_0x274a6d['currentUsage']));}async[_0x108f61(0x37e)](_0x2b9af8){const _0xf42b82=_0x108f61;var _0x481959,_0x1f98d5;const _0x44aff6=Date['now']();try{const _0x42eef6=((_0x481959=this[_0xf42b82(0x18f)][_0xf42b82(0x22f)](u['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']))==null?void 0x0:_0x481959[_0xf42b82(0x335)])||ss,_0x2a1810=(await this['_httpService']['post'](_0x42eef6,{'body':JSON[_0xf42b82(0x3bb)]({'taskId':_0x2b9af8})}))[_0xf42b82(0x2be)];if(((_0x1f98d5=_0x2a1810['error'])==null?void 0x0:_0x1f98d5[_0xf42b82(0x283)])!==G['OK'])return;this[_0xf42b82(0x244)](_0x2a1810[_0xf42b82(0x189)],_0x44aff6);}catch(_0x1dd398){this[_0xf42b82(0x214)][_0xf42b82(0x29b)](_0x1dd398);}}async[_0x108f61(0x109)](_0x1bb12e){const _0x427e5a=_0x108f61;var _0x5012ac,_0x4f90c4;const _0x381264=Date['now']();try{const _0x42a666=((_0x5012ac=this['_configService'][_0x427e5a(0x22f)](u[_0x427e5a(0x348)]))==null?void 0x0:_0x5012ac[_0x427e5a(0x27d)])||ts,_0x1450eb=_0x1bb12e?_0x42a666+_0x427e5a(0x2fd)+encodeURIComponent(_0x1bb12e):_0x42a666,_0x1997f3=(await this[_0x427e5a(0x182)][_0x427e5a(0x1e2)](_0x1450eb))[_0x427e5a(0x2be)];if(((_0x4f90c4=_0x1997f3[_0x427e5a(0x29b)])==null?void 0x0:_0x4f90c4[_0x427e5a(0x283)])!==G['OK'])return;this['_setFormulaLimitStatus'](_0x1997f3['limitInfo'],_0x381264);}catch(_0x82aad8){this[_0x427e5a(0x214)][_0x427e5a(0x29b)](_0x82aad8);}}async[_0x108f61(0x2a8)](_0x50639d){const _0x55df40=_0x108f61;var _0xfb12a7,_0x4780cf;const _0x270a22=Date[_0x55df40(0x15c)]();try{const _0x9d169b=((_0xfb12a7=this[_0x55df40(0x18f)][_0x55df40(0x22f)](u[_0x55df40(0x348)]))==null?void 0x0:_0xfb12a7[_0x55df40(0x36f)])||is,_0x3e6f83=(await this['_httpService']['post'](_0x9d169b,{'body':JSON[_0x55df40(0x3bb)]({'taskId':_0x50639d})}))['body'];if(((_0x4780cf=_0x3e6f83[_0x55df40(0x29b)])==null?void 0x0:_0x4780cf[_0x55df40(0x283)])!==G['OK'])return;this[_0x55df40(0x244)](_0x3e6f83['limitInfo'],_0x270a22);}catch(_0x31aed3){this[_0x55df40(0x214)][_0x55df40(0x29b)](_0x31aed3);}}[_0x108f61(0x298)](){const _0x1776f6=_0x108f61;return this['_maxFormulaLimit']===0x0?!0x0:this[_0x1776f6(0x3a4)]-this[_0x1776f6(0x2ba)]>0x0;}[_0x108f61(0x28e)](){const _0x4b6419=_0x108f61;this[_0x4b6419(0x288)]&&(clearTimeout(this[_0x4b6419(0x288)]),this['_pollingInterval']=null);}[_0x108f61(0x1b2)](){const _0x429f39=_0x108f61;this[_0x429f39(0x300)][_0x429f39(0x146)]({'content':this['_localeService']['t'](_0x429f39(0x2b1)),'type':p[_0x429f39(0x1af)][_0x429f39(0x166)]});}['_hasFormulaInDirtyRanges'](_0x581543){const _0x442489=_0x108f61;for(const _0x2ad060 of _0x581543){const {unitId:_0xf28786,sheetId:_0x475c43,range:_0x99c8a4}=_0x2ad060,_0x1273cf=this[_0x442489(0x311)]['getUnit'](_0xf28786);if(!_0x1273cf)continue;const _0x1b5f0e=_0x1273cf['getSheetBySheetId'](_0x475c43);if(!_0x1b5f0e)continue;const _0x189947=_0x1b5f0e[_0x442489(0x390)]();for(let _0x4e6df0=_0x99c8a4[_0x442489(0x1b7)];_0x4e6df0<=_0x99c8a4[_0x442489(0x237)];_0x4e6df0++)for(let _0x26a61a=_0x99c8a4[_0x442489(0x389)];_0x26a61a<=_0x99c8a4[_0x442489(0x25e)];_0x26a61a++){const _0x41b2b8=_0x189947[_0x442489(0x1d9)](_0x4e6df0,_0x26a61a);if(_0x41b2b8&&(a[_0x442489(0x2b9)](_0x41b2b8['f'])||a[_0x442489(0x224)](_0x41b2b8['si'])))return!0x0;}}return!0x1;}};ne=es([L(0x0,a[_0x108f61(0x230)](O['IMessageService'])),L(0x1,a[_0x108f61(0x225)]),L(0x2,a['IConfigService']),L(0x3,a[_0x108f61(0x230)](x[_0x108f61(0x2de)])),L(0x4,a['IUniverInstanceService']),L(0x5,a[_0x108f61(0x13d)]),L(0x6,a['Inject'](a[_0x108f61(0x179)]))],ne);var ns=Object[_0x108f61(0x37b)],rs=(_0x5a8d56,_0x233c03,_0xa685c4,_0x4693a5)=>{const _0x3cff3b=_0x108f61;for(var _0x14db6d=_0x4693a5>0x1?void 0x0:_0x4693a5?ns(_0x233c03,_0xa685c4):_0x233c03,_0x3741f1=_0x5a8d56[_0x3cff3b(0x14d)]-0x1,_0x7b3a49;_0x3741f1>=0x0;_0x3741f1--)(_0x7b3a49=_0x5a8d56[_0x3741f1])&&(_0x14db6d=_0x7b3a49(_0x14db6d)||_0x14db6d);return _0x14db6d;},Se=(_0x2eb90,_0x285184)=>(_0x405892,_0x1d101d)=>_0x285184(_0x405892,_0x1d101d,_0x2eb90);let Te=class extends a[_0x108f61(0x3b6)]{constructor(_0x41594f,_0x125592,_0x4d9950){const _0x11368f=_0x108f61;super(),_(this,_0x11368f(0x310),new Map()),_(this,_0x11368f(0x2c6),new Map()),_(this,_0x11368f(0x388),!0x1),(this['_configService']=_0x41594f,this[_0x11368f(0x38f)]=_0x125592,this['_revisionService']=_0x4d9950);}[_0x108f61(0x360)](){this['_disabled']=!0x0;}[_0x108f61(0x24d)](){const _0x2e5deb=_0x108f61;this[_0x2e5deb(0x388)]=!0x1;}get['saveTaskMap'](){return this['_saveTaskMap'];}[_0x108f61(0x1a6)](){const _0x5cc3d2=_0x108f61;this[_0x5cc3d2(0x3ad)]()['then'](()=>super['dispose']());}async[_0x108f61(0x20b)](_0x316882){const _0x5a0ece=_0x108f61;return this[_0x5a0ece(0x388)]?null:this[_0x5a0ece(0x38f)]['getItem'](u[_0x5a0ece(0x258)](_0x316882));}async[_0x108f61(0x2ac)](_0x314969,_0x5651dc){const _0x250190=_0x108f61;return!!this[_0x250190(0x38f)][_0x250190(0x200)](_0x314969,_0x5651dc);}[_0x108f61(0x3bf)](_0x37f08e,_0x541fe1,_0xfd4548,_0x57dc84){const _0x1df25f=_0x108f61,_0x1b5273=this[_0x1df25f(0x2ce)][_0x1df25f(0x327)](_0x37f08e);this['_cachedData'][_0x1df25f(0x187)](_0x37f08e,{'unitID':_0x37f08e,'type':_0x541fe1,'awaitingChangeset':_0xfd4548,'mutations':_0x57dc84,'rev':_0x1b5273}),this['_saveTaskMap'][_0x1df25f(0x369)](_0x37f08e)||this[_0x1df25f(0x1db)](_0x37f08e);}[_0x108f61(0x1db)](_0x28092f){const _0x19d5a6=_0x108f61,_0x4eefcd=this[_0x19d5a6(0x1cc)]();_0x4eefcd===0x0?this[_0x19d5a6(0x308)](_0x28092f):this[_0x19d5a6(0x2c6)][_0x19d5a6(0x187)](_0x28092f,setTimeout(()=>this[_0x19d5a6(0x308)](_0x28092f),_0x4eefcd));}[_0x108f61(0x1cc)](){const _0x2dc557=_0x108f61;var _0x5abb2d;return(_0x5abb2d=this[_0x2dc557(0x18f)]['getConfig'](u[_0x2dc557(0x1f0)]))!=null?_0x5abb2d:u[_0x2dc557(0x302)];}[_0x108f61(0x308)](_0x3d59a9){const _0x2e7d16=_0x108f61,_0xec034b=this[_0x2e7d16(0x2c6)][_0x2e7d16(0x1e2)](_0x3d59a9);return _0xec034b!==void 0x0&&window[_0x2e7d16(0x16f)](_0xec034b),this['_localStorageService'][_0x2e7d16(0x200)](u['getLocalCacheKey'](_0x3d59a9),this['_cachedData'][_0x2e7d16(0x1e2)](_0x3d59a9))[_0x2e7d16(0x3af)](()=>this[_0x2e7d16(0x2c6)][_0x2e7d16(0x233)](_0x3d59a9));}async[_0x108f61(0x3ad)](){const _0x27d0a3=_0x108f61,_0x245030=[];this[_0x27d0a3(0x2c6)][_0x27d0a3(0xf8)]((_0x489d0f,_0x24f519)=>{const _0x1504de=_0x27d0a3;window[_0x1504de(0x16f)](_0x489d0f),_0x245030[_0x1504de(0x1cd)](this[_0x1504de(0x308)](_0x24f519)[_0x1504de(0x3af)](()=>{const _0x364002=_0x1504de;this[_0x364002(0x2c6)][_0x364002(0x233)](_0x24f519);}));}),await Promise[_0x27d0a3(0x287)](_0x245030);}};Te=rs([Se(0x0,a[_0x108f61(0x2d4)]),Se(0x1,a[_0x108f61(0x238)]),Se(0x2,a[_0x108f61(0x230)](g[_0x108f61(0x248)]))],Te);class ke extends a[_0x108f61(0x217)]{constructor(){const _0x26fa9c=_0x108f61;super(),_(this,_0x26fa9c(0x29a)),this[_0x26fa9c(0x29a)]=I[_0x26fa9c(0x386)](window,'popstate')['pipe'](I['takeUntil'](this[_0x26fa9c(0x251)]),I[_0x26fa9c(0x370)](0x1),I['mapTo'](void 0x0));}[_0x108f61(0x122)](_0x467d5f,_0x469fb7,_0x23bd4d=!0x1){const _0x48f668=_0x108f61,_0x4b1255=new URL(window[_0x48f668(0x137)][_0x48f668(0x165)]);_0x4b1255[_0x48f668(0x220)][_0x48f668(0x187)](_0x467d5f,_0x469fb7),_0x23bd4d?window['history']['replaceState']('','',_0x4b1255[_0x48f668(0x26c)]()):window[_0x48f668(0x155)][_0x48f668(0x285)]('','',_0x4b1255[_0x48f668(0x26c)]());}[_0x108f61(0x1c4)](_0x33e303,_0x2ea3a4=!0x1){const _0x330e23=_0x108f61,_0x21b1f0=new URL(window[_0x330e23(0x137)][_0x330e23(0x165)]);_0x21b1f0[_0x330e23(0x220)][_0x330e23(0x233)](_0x33e303),_0x2ea3a4?window[_0x330e23(0x155)]['replaceState']('','',_0x21b1f0[_0x330e23(0x26c)]()):window[_0x330e23(0x155)][_0x330e23(0x285)]('','',_0x21b1f0[_0x330e23(0x26c)]());}['getParam'](_0x4b5dd6){const _0x1fbe08=_0x108f61;var _0x8d66a;return(_0x8d66a=new URL(window[_0x1fbe08(0x137)][_0x1fbe08(0x165)])[_0x1fbe08(0x220)][_0x1fbe08(0x1e2)](_0x4b5dd6))!=null?_0x8d66a:void 0x0;}}var os=Object['defineProperty'],as=Object[_0x108f61(0x37b)],cs=(_0x3d01b8,_0x3a367c,_0x463c7b)=>_0x3a367c in _0x3d01b8?os(_0x3d01b8,_0x3a367c,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x463c7b}):_0x3d01b8[_0x3a367c]=_0x463c7b,ls=(_0x4863eb,_0x291a75,_0x32022a,_0x192099)=>{const _0x30a6b7=_0x108f61;for(var _0x1a6920=_0x192099>0x1?void 0x0:_0x192099?as(_0x291a75,_0x32022a):_0x291a75,_0x1165b3=_0x4863eb[_0x30a6b7(0x14d)]-0x1,_0x20a14a;_0x1165b3>=0x0;_0x1165b3--)(_0x20a14a=_0x4863eb[_0x1165b3])&&(_0x1a6920=_0x20a14a(_0x1a6920)||_0x1a6920);return _0x1a6920;},de=(_0x345ac1,_0xb2ec2c)=>(_0x58cb4f,_0x538c83)=>_0xb2ec2c(_0x58cb4f,_0x538c83,_0x345ac1),_s=(_0x524da0,_0x1e9017,_0x3496f0)=>cs(_0x524da0,_0x1e9017+'',_0x3496f0);const hs=_0x108f61(0x3a3);exports[_0x108f61(0x12e)]=class extends a[_0x108f61(0x34b)]{constructor(_0x41df82=Me,_0x4b0091,_0x5337ac,_0x5241c8){const _0x2d1db1=_0x108f61;super(),this[_0x2d1db1(0x347)]=_0x41df82,this[_0x2d1db1(0x10b)]=_0x4b0091,this[_0x2d1db1(0x266)]=_0x5337ac,this[_0x2d1db1(0x18f)]=_0x5241c8;const {..._0x3eb701}=a[_0x2d1db1(0x1fc)]({},Me,this[_0x2d1db1(0x347)]);this['_configService'][_0x2d1db1(0x15e)](Yt,_0x3eb701);}[_0x108f61(0x212)](){this['_registerDependencies'](),this['_initDependencies']();}[_0x108f61(0x141)](){const _0x1bcadc=_0x108f61;this[_0x1bcadc(0x292)]();}[_0x108f61(0x206)](){const _0x4b786d=_0x108f61;var _0x1596ab;const _0x15178e=[[Re],[ne],[se],[ee],[te],[be],[Oe,{'useClass':ke}],[x[_0x4b786d(0x2c9)],{'useClass':x[_0x4b786d(0x1bb)]}],[u[_0x4b786d(0x1d8)],{'useClass':Te}],[exports[_0x4b786d(0x256)]],[ie],[Z],[F],[me],[exports[_0x4b786d(0x374)]]];this['_config'][_0x4b786d(0x22b)]&&_0x15178e['push']([Q]),a['registerDependencies'](this[_0x4b786d(0x266)],a[_0x4b786d(0x2c2)](_0x15178e,(_0x1596ab=this[_0x4b786d(0x347)])==null?void 0x0:_0x1596ab[_0x4b786d(0x1f3)]));}[_0x108f61(0x292)](){const _0x1568d8=_0x108f61;this['disposeWithMe'](this['_renderManagerService']['registerRenderModule'](a['UniverInstanceType'][_0x1568d8(0x16b)],[Ee])),this['disposeWithMe'](this[_0x1568d8(0x10b)]['registerRenderModule'](a[_0x1568d8(0x234)][_0x1568d8(0x2c7)],[Ce]));}[_0x108f61(0x2ca)](){const _0x25cefd=_0x108f61;a[_0x25cefd(0x2fc)](this[_0x25cefd(0x266)],[[F],[exports[_0x25cefd(0x256)]],[ie],[Z],[exports[_0x25cefd(0x374)]],[ne]]),this[_0x25cefd(0x347)][_0x25cefd(0x22b)]&&a['touchDependencies'](this['_injector'],[[Q]]);}},_s(exports[_0x108f61(0x12e)],_0x108f61(0x27b),hs),exports[_0x108f61(0x12e)]=ls([a['DependentOn'](u['UniverCollaborationClientPlugin']),de(0x1,C[_0x108f61(0x1cf)]),de(0x2,a[_0x108f61(0x230)](a['Injector'])),de(0x3,a[_0x108f61(0x2d4)])],exports[_0x108f61(0x12e)]);var us=Object[_0x108f61(0x37b)],Is=(_0x490a3c,_0x5a1789,_0x3e578f,_0x244a36)=>{const _0x5425ea=_0x108f61;for(var _0x202e55=_0x244a36>0x1?void 0x0:_0x244a36?us(_0x5a1789,_0x3e578f):_0x5a1789,_0x1c5156=_0x490a3c[_0x5425ea(0x14d)]-0x1,_0x513fbc;_0x1c5156>=0x0;_0x1c5156--)(_0x513fbc=_0x490a3c[_0x1c5156])&&(_0x202e55=_0x513fbc(_0x202e55)||_0x202e55);return _0x202e55;},W=(_0x5d13cf,_0x4e51c)=>(_0x1b736c,_0x26fa0f)=>_0x4e51c(_0x1b736c,_0x26fa0f,_0x5d13cf);exports[_0x108f61(0x357)]=class extends u['CollaborationSocketService']{constructor(_0x1d3749,_0x1a5558,_0xfdfdbe,_0x4a3338,_0x11edc1){super(_0x1d3749,_0x1a5558,_0xfdfdbe,_0x4a3338,_0x11edc1);}async[_0x108f61(0x185)](_0x7f976b){const _0x56c0bb=_0x108f61,_0x6b0575=await this['_getSessionTicket'](),_0x3dd0d1=this['_createSocketURL'](_0x7f976b,_0x6b0575);return this[_0x56c0bb(0x174)](_0x3dd0d1);}[_0x108f61(0x38e)](_0x2228a7,_0x59e7ee){const _0x77bec4=_0x108f61,_0x589661=typeof window>'u'?new URL(_0x2228a7):new URL(_0x2228a7,window[_0x77bec4(0x137)][_0x77bec4(0x2ed)]);_0x589661[_0x77bec4(0x220)][_0x77bec4(0x187)](_0x77bec4(0x2d3),_0x59e7ee);const _0x2dcfe1=typeof window>'u'?new URLSearchParams():new URLSearchParams(window['location'][_0x77bec4(0x2ff)]);return _0x2dcfe1['get']('runId')&&_0x589661['searchParams'][_0x77bec4(0x187)]('runId',_0x2dcfe1[_0x77bec4(0x1e2)]('runId')),_0x589661[_0x77bec4(0x26c)]();}async[_0x108f61(0x1b0)](){const _0x596d99=_0x108f61;var _0x5904d2,_0x35e3fc,_0x3f09d5;const _0xcac446=this['_configService']['getConfig'](u[_0x596d99(0x348)]),_0x50e3a4=(_0x5904d2=_0xcac446==null?void 0x0:_0xcac446[_0x596d99(0x293)])!=null?_0x5904d2:u[_0x596d99(0x219)];return(_0x3f09d5=(_0x35e3fc=(await this[_0x596d99(0x182)][_0x596d99(0x1e2)](_0x50e3a4,{'headers':{'Content-Type':'application/json'}}))[_0x596d99(0x2be)])==null?void 0x0:_0x35e3fc[_0x596d99(0x3a5)])!=null?_0x3f09d5:'';}},exports[_0x108f61(0x357)]=Is([W(0x0,a[_0x108f61(0x230)](a[_0x108f61(0x1e8)])),W(0x1,a[_0x108f61(0x230)](x[_0x108f61(0x2de)])),W(0x2,a[_0x108f61(0x2d4)]),W(0x3,a[_0x108f61(0x13d)]),W(0x4,g['ISnapshotServerService'])],exports[_0x108f61(0x357)]);var Ss=Object['getOwnPropertyDescriptor'],ds=(_0x1e579b,_0x2267ba,_0x5838ed,_0x578286)=>{for(var _0x4478af=_0x578286>0x1?void 0x0:_0x578286?Ss(_0x2267ba,_0x5838ed):_0x2267ba,_0x1babc7=_0x1e579b['length']-0x1,_0xdc9b9a;_0x1babc7>=0x0;_0x1babc7--)(_0xdc9b9a=_0x1e579b[_0x1babc7])&&(_0x4478af=_0xdc9b9a(_0x4478af)||_0x4478af);return _0x4478af;},fe=(_0x3e183b,_0x223882)=>(_0x16ead5,_0x13ac85)=>_0x223882(_0x16ead5,_0x13ac85,_0x3e183b);exports[_0x108f61(0x1bd)]=class extends a['Disposable']{constructor(_0x22fd7d,_0x14a078,_0x20636b){const _0x20b470=_0x108f61;super(),this[_0x20b470(0x170)]=_0x22fd7d,this[_0x20b470(0x182)]=_0x14a078,this['_configService']=_0x20636b;}async['runOnServer'](_0x2470e6,_0x2133c4,_0xf7aa18,..._0xa3f90b){const _0x4a38e9=_0x108f61;var _0x3f10e7,_0x10192a,_0x3c6bed,_0x411f1e;const _0x337dc8=this[_0x4a38e9(0x170)][_0x4a38e9(0x277)]();if(!_0x337dc8)throw new Error(_0x4a38e9(0x210));const _0x5106b2=((_0x3f10e7=this[_0x4a38e9(0x18f)]['getConfig'](u[_0x4a38e9(0x268)]))!=null?_0x3f10e7:u[_0x4a38e9(0x254)])+'/'+_0x2470e6+_0x4a38e9(0x3a8)+_0x2133c4,_0x36ecb5=new URL(window[_0x4a38e9(0x137)][_0x4a38e9(0x165)]),_0x56bb1c={'scriptId':_0x2470e6,'runId':(_0x10192a=_0x36ecb5[_0x4a38e9(0x220)]['get']('runId'))!=null?_0x10192a:'','function':_0x2133c4,'unitId':_0x337dc8[_0x4a38e9(0xf9)](),'argsOfFunction':JSON[_0x4a38e9(0x3bb)](_0xa3f90b),'invokeId':(_0x3c6bed=_0xf7aa18[_0x4a38e9(0x295)])!=null?_0x3c6bed:'','executionId':(_0x411f1e=_0xf7aa18[_0x4a38e9(0x3ab)])!=null?_0x411f1e:''};try{const _0x253192=await this[_0x4a38e9(0x182)]['post'](_0x5106b2,{'body':_0x56bb1c});return _0x253192[_0x4a38e9(0x2be)]['error']&&_0x253192['body'][_0x4a38e9(0x29b)][_0x4a38e9(0x283)]!==G['OK']?'Failed':_0x253192[_0x4a38e9(0x2be)][_0x4a38e9(0xfc)];}catch{return'Failed';}}},exports[_0x108f61(0x1bd)]=ds([fe(0x0,a['IUniverInstanceService']),fe(0x1,a[_0x108f61(0x230)](x[_0x108f61(0x2de)])),fe(0x2,a[_0x108f61(0x2d4)])],exports[_0x108f61(0x1bd)]);const we=0x7530,ye=_0x108f61(0x2c4);class fs extends a[_0x108f61(0x3b6)]{constructor(){const _0x1a3016=_0x108f61;super(),_(this,_0x1a3016(0x21b),a['generateRandomId']()),_(this,_0x1a3016(0x2f1),new Set()),_(this,_0x1a3016(0x337),new Map()),_(this,_0x1a3016(0x3b7),null),_(this,_0x1a3016(0x27a),new Map()),_(this,'_unitStatus',new Map()),this[_0x1a3016(0x239)]();}[_0x108f61(0x1a6)](){const _0x5877ea=_0x108f61;super['dispose'](),this[_0x5877ea(0x27a)][_0x5877ea(0xf8)]((_0x233ba3,_0x21e24f)=>this['_removeClearOtherTimer'](_0x21e24f)),this[_0x5877ea(0x3b7)]&&window['clearInterval'](this['_heartbeatTimer']);}[_0x108f61(0x315)](_0x4015ea){const _0x17ad47=_0x108f61;return this[_0x17ad47(0x27e)](_0x4015ea)['pipe'](I[_0x17ad47(0x2dd)]());}[_0x108f61(0x28f)](_0x262b2a){const _0x22edef=_0x108f61;this[_0x22edef(0x2f1)][_0x22edef(0x22e)]===0x0&&this[_0x22edef(0x2ea)](),this[_0x22edef(0x2f1)][_0x22edef(0xf0)](_0x262b2a),this[_0x22edef(0x2d9)]({'type':0x0,'memberID':this[_0x22edef(0x21b)],'unitIDs':[_0x262b2a],'isForwarded':!0x1});}['disposeUnit'](_0x382677){const _0xfe2818=_0x108f61;this[_0xfe2818(0x2f1)][_0xfe2818(0x233)](_0x382677),this[_0xfe2818(0x2f1)][_0xfe2818(0x22e)]===0x0&&this[_0xfe2818(0x3b7)]&&window[_0xfe2818(0x278)](this[_0xfe2818(0x3b7)]);}[_0x108f61(0x239)](){const _0x44d7dd=_0x108f61;this['disposeWithMe'](a['toDisposable'](I[_0x44d7dd(0x386)](window,_0x44d7dd(0x1c2))[_0x44d7dd(0x346)](_0x101897=>{const _0x1a4a09=_0x44d7dd;if(_0x101897['key']!==ye||!_0x101897[_0x1a4a09(0x1ec)])return;const _0x429ffb=JSON['parse'](_0x101897[_0x1a4a09(0x1ec)]);this[_0x1a4a09(0x14f)](_0x429ffb);}))),window[_0x44d7dd(0x321)]('unload',()=>this[_0x44d7dd(0x2d9)]({'type':0x1,'memberID':this[_0x44d7dd(0x21b)],'unitIDs':Array[_0x44d7dd(0x3b3)](this[_0x44d7dd(0x2f1)])}));}[_0x108f61(0x14f)](_0x328df7){const _0x4df10e=_0x108f61;switch(_0x328df7[_0x4df10e(0xf3)]){case 0x0:this['_handleJoinEvent'](_0x328df7);break;case 0x1:this['_handleLeaveEvent'](_0x328df7);break;case 0x2:this['_handleHeartbeatEvent'](_0x328df7);break;}}[_0x108f61(0x242)](_0x230b04){const _0x253846=_0x108f61,{unitIDs:_0x82b0eb,memberID:_0x4a2b4f,isForwarded:_0x21e8b2}=_0x230b04;_0x82b0eb['forEach'](_0x4fbd36=>{const _0x38e8e2=_0x5f13;if(!_0x21e8b2&&this[_0x38e8e2(0x337)][_0x38e8e2(0x369)](_0x4fbd36)&&this[_0x38e8e2(0x27e)](_0x4fbd36)[_0x38e8e2(0x120)](u['UnitStatus'][_0x38e8e2(0x2a6)]),!this[_0x38e8e2(0x337)][_0x38e8e2(0x369)](_0x4fbd36)||!this[_0x38e8e2(0x337)][_0x38e8e2(0x1e2)](_0x4fbd36)[_0x38e8e2(0x369)](_0x4a2b4f)){const _0x4d43f1=this[_0x38e8e2(0x337)][_0x38e8e2(0x1e2)](_0x4fbd36)||new Set();_0x4d43f1[_0x38e8e2(0xf0)](_0x4a2b4f),this['_unitOnClients'][_0x38e8e2(0x187)](_0x4fbd36,_0x4d43f1),this[_0x38e8e2(0x33b)](_0x4a2b4f);}}),_0x21e8b2||this[_0x253846(0x2d9)]({'type':0x0,'memberID':this['_id'],'unitIDs':[...this[_0x253846(0x2f1)]],'isForwarded':!0x0});}['_scheduleClearOtherTimer'](_0x21a717){const _0x335388=_0x108f61;this[_0x335388(0x371)](_0x21a717);const _0x3a4c01=window[_0x335388(0x14e)](()=>{const _0x5a7606=_0x335388;this[_0x5a7606(0x337)][_0x5a7606(0xf8)](_0x33b608=>{_0x33b608['delete'](_0x21a717);});},we*0x2);this[_0x335388(0x27a)][_0x335388(0x187)](_0x21a717,_0x3a4c01);}[_0x108f61(0x371)](_0x4a826c){const _0x52334e=_0x108f61;if(this['_clearOtherTimers'][_0x52334e(0x369)](_0x4a826c)){const _0x1ecc7a=this['_clearOtherTimers'][_0x52334e(0x1e2)](_0x4a826c);_0x1ecc7a&&window['clearTimeout'](_0x1ecc7a),this[_0x52334e(0x27a)][_0x52334e(0x187)](_0x4a826c,null);}}[_0x108f61(0x3ae)](_0x2a2727){const _0x29e87e=_0x108f61,{memberID:_0x304d46,unitIDs:_0x32cf8b}=_0x2a2727;_0x32cf8b['forEach'](_0x4cb06f=>{const _0x5b814a=_0x5f13;var _0x2dc706;const _0x1b81ae=this['_unitOnClients'][_0x5b814a(0x1e2)](_0x4cb06f);_0x1b81ae&&(_0x1b81ae['delete'](_0x304d46),(_0x2dc706=this[_0x5b814a(0x27e)](_0x4cb06f))==null||_0x2dc706[_0x5b814a(0x120)](_0x1b81ae[_0x5b814a(0x22e)]===0x0?u[_0x5b814a(0x1c3)][_0x5b814a(0x2cc)]:u['UnitStatus']['OTHER_CLIENTS_EDITING']));}),this[_0x29e87e(0x371)](_0x304d46);}['_handleHeartbeatEvent'](_0x42188d){const _0x5e506a=_0x108f61;this[_0x5e506a(0x33b)](_0x42188d[_0x5e506a(0x201)]);}[_0x108f61(0x2d9)](_0x15a5c8){const _0x2caa62=_0x108f61;localStorage['setItem'](ye,JSON[_0x2caa62(0x3bb)](_0x15a5c8));}[_0x108f61(0x2ea)](){const _0x542245=_0x108f61;this[_0x542245(0x3b7)]=window[_0x542245(0x115)](()=>{const _0x3dc3ea=_0x542245;this[_0x3dc3ea(0x2d9)]({'type':0x2,'memberID':this[_0x3dc3ea(0x21b)]});},we);}[_0x108f61(0x27e)](_0x269dc1){const _0x340cbc=_0x108f61;return this[_0x340cbc(0x1e7)][_0x340cbc(0x369)](_0x269dc1)||this['_unitStatus'][_0x340cbc(0x187)](_0x269dc1,new I[(_0x340cbc(0x391))](u[_0x340cbc(0x1c3)][_0x340cbc(0x2cc)])),this[_0x340cbc(0x1e7)]['get'](_0x269dc1);}}exports[_0x108f61(0x22d)]=Oe,exports[_0x108f61(0x316)]=je,exports[_0x108f61(0xef)]=fs,exports['WebURLService']=ke;