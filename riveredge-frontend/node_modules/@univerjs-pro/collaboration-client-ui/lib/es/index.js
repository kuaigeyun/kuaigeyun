const _0x38cdda=_0x215c;(function(_0x3872dd,_0x2d5631){const _0x2f5482=_0x215c,_0x441c27=_0x3872dd();while(!![]){try{const _0x13cafb=parseInt(_0x2f5482(0x224))/0x1*(parseInt(_0x2f5482(0x1d6))/0x2)+-parseInt(_0x2f5482(0x296))/0x3+-parseInt(_0x2f5482(0x19a))/0x4*(parseInt(_0x2f5482(0x2b9))/0x5)+-parseInt(_0x2f5482(0x2e0))/0x6+-parseInt(_0x2f5482(0xd7))/0x7*(-parseInt(_0x2f5482(0x2ee))/0x8)+parseInt(_0x2f5482(0x23a))/0x9*(parseInt(_0x2f5482(0x228))/0xa)+parseInt(_0x2f5482(0x17b))/0xb;if(_0x13cafb===_0x2d5631)break;else _0x441c27['push'](_0x441c27['shift']());}catch(_0x5f1708){_0x441c27['push'](_0x441c27['shift']());}}}(_0x988b,0x5a182));var Yt=Object[_0x38cdda(0x276)],Wt=(_0x4b5a99,_0x1a80be,_0x3dd1c1)=>_0x1a80be in _0x4b5a99?Yt(_0x4b5a99,_0x1a80be,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x3dd1c1}):_0x4b5a99[_0x1a80be]=_0x3dd1c1,_=(_0x37a34f,_0x578de3,_0x4e79a1)=>Wt(_0x37a34f,typeof _0x578de3!=_0x38cdda(0x2bf)?_0x578de3+'':_0x578de3,_0x4e79a1);import{jsx as _0x22a0e6,jsxs as _0x3aac37}from'react/jsx-runtime';import{CollaborationStatus as _0x5566b4,CollaborationSessionService as _0x4496ea,CollaborationController as _0x489919,DataLoaderService as _0x1082c0,MemberService as _0xf7eafd,SessionStatus as _0x43c2dd,ILocalCacheService as _0x4e2cad,CollaborationUIEventService as _0x464162,CollaborationUIEventId as _0x354e6a,DocCollaborationEntity as _0x55b7eb,COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY as _0xe89f7f,getLocalCacheKey as _0x598630,LOCAL_CACHE_INTERVAL as _0x5a0638,LOCAL_CACHE_INTERVAL_KEY as _0x2cb797,UniverCollaborationClientPlugin as _0x36932a,CollaborationSocketService as _0x22b90f,DEFAULT_WS_SESSION_TICKET_URL as _0x47950d,REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY as _0x42eef4,DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT as _0x3d49c2,UnitStatus as _0x47df77}from'@univerjs-pro/collaboration-client';import{LocaleService as _0x134929,IUniverInstanceService as _0x57b197,Inject as _0x11edd2,Injector as _0x1d6fba,Disposable as _0x447589,createIdentifier as _0x2b27ed,ILogService as _0x3b2794,ICommandService as _0x30ccef,Optional as _0xa5584e,RxDisposable as _0x3f6cad,Workbook as _0x403982,DOC_RANGE_TYPE as _0x337f20,debounce as _0x899b23,Rectangle as _0x32e6d6,DisposableCollection as _0x48f1ed,toDisposable as _0x2e6c99,UniverInstanceType as _0x13411f,generateRandomId as _0x11358d,COLORS as _0x2b8a6b,ColorKit as _0x1f7760,ThemeService as _0x387df0,fromEventSubject as _0x225d82,Tools as _0x5884ee,CommandType as _0x4f786a,IConfigService as _0x36ab28,CanceledError as _0x473ecc,isFormulaString as _0x6c29ae,isFormulaId as _0x328479,ILocalStorageService as _0x1c020e,DependentOn as _0x28cf15,Plugin as _0x571114,merge as _0x223c4b,registerDependencies as _0x273047,mergeOverrideWithDependencies as _0x583a07,touchDependencies as _0x165c59}from'@univerjs/core';import{useObservable as _0x89bded,useDependency as _0x23e243,IUIPartsService as _0xe7b79e,BuiltInUIPart as _0x8be1cd,connectInjector as _0x4e4129,IBeforeCloseService as _0x1b49ec,IMessageService as _0x19a1ba,INotificationService as _0x19ecf0}from'@univerjs/ui';import{BehaviorSubject as _0x4f0f13,switchMap as _0x59793b,of as _0x2d29f0,takeUntil as _0x3c41cb,debounceTime as _0xc04ef5,Subject as _0x5ac8bc,filter as _0x32f62e,merge as _0x44c07d,combineLatest as _0x2b9b2e,fromEvent as _0x1b1549,shareReplay as _0xfb0504,mapTo as _0x2c534b,distinctUntilChanged as _0xc41425}from'rxjs';import{Tooltip as _0x230ffb,clsx as _0x57d231,MessageType as _0x8f3016}from'@univerjs/design';import{useRef as _0x33b1b0,createElement as _0x4422eb,forwardRef as _0x52d57e,useCallback as _0x55c03e}from'react';import{IRemoteInstanceService as _0x511197}from'@univerjs/rpc';import{SetWorksheetActivateCommand as _0x4a6e79,RefRangeService as _0x1bca19,SetSelectionsOperation as _0x224ac4,SheetsSelectionsService as _0x5f0afd,EffectRefRangId as _0x37396e,handleIRemoveRow as _0x590d44,handleIRemoveCol as _0x58fde2,handleMoveRange as _0x10c4cd,handleInsertRow as _0x21bb57,handleInsertRangeMoveRight as _0x204698,handleInsertRangeMoveDown as _0x533ae0,handleInsertCol as _0x260fbe,handleDeleteRangeMoveUp as _0x276adc,handleDeleteRangeMoveLeft as _0x406111,runRefRangeMutations as _0x5887a9}from'@univerjs/sheets';import{Shape as _0x490c21,Rect as _0xa348d8,getColor as _0x19c299,RegularPolygon as _0x1e1639,TRANSFORM_CHANGE_OBSERVABLE_TYPE as _0x97da41,Vector2 as _0xbab593,SHEET_VIEWPORT_KEY as _0x2234b8,IRenderManagerService as _0x294de9}from'@univerjs/engine-render';import{HTTPService as _0x1718b4,ISocketService as _0x4d0498,WebSocketService as _0x1893c1}from'@univerjs/network';function _0x215c(_0x15663a,_0x26345f){_0x15663a=_0x15663a-0xd1;const _0x988b04=_0x988b();let _0x215c45=_0x988b04[_0x15663a];return _0x215c45;}import{IDocClipboardService as _0x1d7147,NodePositionConvertToCursor as _0x262f06,NodePositionConvertToRectRange as _0x4e4b6b,TEXT_RANGE_LAYER_INDEX as _0xd0acda,SetDocZoomRatioOperation as _0x90994e,DocIMEInputManagerService as _0x26f90f,DocStateChangeManagerService as _0x4a4247}from'@univerjs/docs-ui';import{IImageIoService as _0x4baf00}from'@univerjs/drawing';import{ITransformService as _0x41e619,CollaborationEvent as _0xd5765d,isTransformMutationFailure as _0x2b6a5f,isTransformMutationsWithChangesetSuccess as _0x1d4010,RevisionService as _0x5e4bb5,ISnapshotServerService as _0x7728f}from'@univerjs-pro/collaboration';import{SetTextSelectionsOperation as _0x549163,RichTextEditingMutation as _0xb130a7,DocSelectionManagerService as _0x186872,DocSkeletonManagerService as _0x183183}from'@univerjs/docs';import{deserializeRangeWithSheet as _0x873948,serializeRangeWithSheet as _0x44e445,FormulaExecuteStageType as _0x303b82,FormulaExecutedStateType as _0x13dfd6,SetFormulaCalculationStartMutation as _0x17cc85,SetFormulaCalculationNotificationMutation as _0x5908a9}from'@univerjs/engine-formula';import{map as _0x5244f0,filter as _0x103525,throttleTime as _0x151c08,takeUntil as _0x4ef6d1,switchMap as _0x4e657c}from'rxjs/operators';import{SheetSkeletonManagerService as _0x519004,getCoordByCell as _0x36ff32,getSheetObject as _0x3eefee}from'@univerjs/sheets-ui';function Ge({ref:_0x77e0df,..._0x5393d9}){const _0x398c61=_0x38cdda,{icon:_0x1b24c7,id:_0x30d0b5,className:_0x17878f,extend:_0xfa7990,..._0x377722}=_0x5393d9,_0x4ec91c=(_0x398c61(0x201)+_0x30d0b5+'\x20'+(_0x17878f||''))['trim'](),_0x4778fd=_0x33b1b0('_'+vi());return At(_0x1b24c7,''+_0x30d0b5,{'defIds':_0x1b24c7['defIds'],'idSuffix':_0x4778fd['current']},{'ref':_0x77e0df,'className':_0x4ec91c,..._0x377722},_0xfa7990);}function At(_0x204bfd,_0x5c441e,_0x21bc8a,_0x245b77,_0x36634d){const _0x8ea550=_0x38cdda;return _0x4422eb(_0x204bfd[_0x8ea550(0x29f)],{'key':_0x5c441e,...gi(_0x204bfd,_0x21bc8a,_0x36634d),..._0x245b77},(Ei(_0x204bfd,_0x21bc8a)[_0x8ea550(0x2f5)]||[])[_0x8ea550(0x1b2)]((_0x2d6170,_0x345658)=>At(_0x2d6170,_0x5c441e+'-'+_0x204bfd[_0x8ea550(0x29f)]+'-'+_0x345658,_0x21bc8a,void 0x0,_0x36634d)));}function gi(_0x4c41ab,_0xfb8526,_0x34fc26){const _0x538ef8=_0x38cdda,_0x1432c9={..._0x4c41ab['attrs']};_0x34fc26!=null&&_0x34fc26['colorChannel1']&&_0x1432c9[_0x538ef8(0x2b4)]==='colorChannel1'&&(_0x1432c9[_0x538ef8(0x2b4)]=_0x34fc26[_0x538ef8(0x195)]),_0x4c41ab[_0x538ef8(0x29f)]===_0x538ef8(0x1ee)&&_0x1432c9['id']&&(_0x1432c9['id']=_0x1432c9['id']+_0xfb8526[_0x538ef8(0x29e)]),Object['entries'](_0x1432c9)[_0x538ef8(0x109)](([_0x2325dc,_0x44ded9])=>{const _0xc596c1=_0x538ef8;_0x2325dc===_0xc596c1(0x1ee)&&typeof _0x44ded9==_0xc596c1(0xec)&&(_0x1432c9[_0x2325dc]=_0x44ded9[_0xc596c1(0x246)](/url\(#(.*)\)/,_0xc596c1(0x211)+_0xfb8526[_0xc596c1(0x29e)]+')'));});const {defIds:_0x3daca7}=_0xfb8526;return!_0x3daca7||_0x3daca7[_0x538ef8(0xe4)]===0x0||(_0x4c41ab[_0x538ef8(0x29f)]===_0x538ef8(0x1a1)&&_0x1432c9[_0x538ef8(0x146)]&&(_0x1432c9[_0x538ef8(0x146)]=_0x1432c9['xlink:href']+_0xfb8526['idSuffix']),Object[_0x538ef8(0x1cd)](_0x1432c9)[_0x538ef8(0x109)](([_0x5ea7f9,_0x3adb8c])=>{const _0x468d38=_0x538ef8;typeof _0x3adb8c=='string'&&(_0x1432c9[_0x5ea7f9]=_0x3adb8c[_0x468d38(0x246)](/url\(#(.*)\)/,_0x468d38(0x211)+_0xfb8526['idSuffix']+')'));})),_0x1432c9;}function Ei(_0x48b611,_0x4bd359){const _0x30bbbb=_0x38cdda;var _0x3af7a8;const {defIds:_0xa7e875}=_0x4bd359;return!_0xa7e875||_0xa7e875[_0x30bbbb(0xe4)]===0x0?_0x48b611:_0x48b611[_0x30bbbb(0x29f)]===_0x30bbbb(0x1c2)&&((_0x3af7a8=_0x48b611[_0x30bbbb(0x2f5)])!=null&&_0x3af7a8[_0x30bbbb(0xe4)])?{..._0x48b611,'children':_0x48b611[_0x30bbbb(0x2f5)]['map'](_0x2d7869=>typeof _0x2d7869['attrs']['id']==_0x30bbbb(0xec)&&_0xa7e875&&_0xa7e875['includes'](_0x2d7869['attrs']['id'])?{..._0x2d7869,'attrs':{..._0x2d7869[_0x30bbbb(0xd4)],'id':_0x2d7869[_0x30bbbb(0xd4)]['id']+_0x4bd359[_0x30bbbb(0x29e)]}}:_0x2d7869)}:_0x48b611;}function vi(){const _0x36b92f=_0x38cdda;return Math[_0x36b92f(0x123)]()['toString'](0x24)[_0x36b92f(0x225)](0x2,0x8);}Ge[_0x38cdda(0x2e8)]=_0x38cdda(0x241);const pi={'tag':_0x38cdda(0x2ae),'attrs':{'xmlns':_0x38cdda(0x2eb),'fill':_0x38cdda(0x19d),'viewBox':_0x38cdda(0x250),'width':_0x38cdda(0x19b),'height':_0x38cdda(0x19b)},'children':[{'tag':'g','attrs':{'clipPath':_0x38cdda(0x31e)},'children':[{'tag':_0x38cdda(0x1b1),'attrs':{'stroke':_0x38cdda(0x178),'d':_0x38cdda(0x321),'strokeLinecap':_0x38cdda(0xda),'strokeLinejoin':_0x38cdda(0xda),'strokeWidth':1.2}}]},{'tag':'defs','attrs':{},'children':[{'tag':_0x38cdda(0x1aa),'attrs':{'id':_0x38cdda(0x2d3)},'children':[{'tag':_0x38cdda(0x1b1),'attrs':{'fill':_0x38cdda(0x28c),'d':_0x38cdda(0x28f)}}]}]}],'defIds':['off-line-icon_clip0_910_343']},Pt=_0x52d57e(function(_0x52b010,_0x5ecddb){return _0x4422eb(Ge,Object['assign']({},_0x52b010,{'id':'off-line-icon','ref':_0x5ecddb,'icon':pi}));});Pt[_0x38cdda(0x2e8)]=_0x38cdda(0x1d3);const Oi={'tag':_0x38cdda(0x2ae),'attrs':{'xmlns':_0x38cdda(0x2eb),'fill':_0x38cdda(0x19d),'viewBox':'0\x200\x2017\x2016','width':'1em','height':_0x38cdda(0x19b)},'children':[{'tag':'g','attrs':{'clipPath':_0x38cdda(0x272)},'children':[{'tag':_0x38cdda(0x1b1),'attrs':{'stroke':_0x38cdda(0x178),'d':_0x38cdda(0x132),'strokeLinecap':_0x38cdda(0xda),'strokeLinejoin':'round','strokeWidth':1.2}}]},{'tag':_0x38cdda(0x1c2),'attrs':{},'children':[{'tag':_0x38cdda(0x1aa),'attrs':{'id':_0x38cdda(0x112)},'children':[{'tag':_0x38cdda(0x1b1),'attrs':{'fill':_0x38cdda(0x28c),'d':_0x38cdda(0x28f),'transform':_0x38cdda(0x10c)}}]}]}],'defIds':[_0x38cdda(0x112)]},wt=_0x52d57e(function(_0x3e3bd1,_0x440abd){const _0x2f4c15=_0x38cdda;return _0x4422eb(Ge,Object[_0x2f4c15(0x187)]({},_0x3e3bd1,{'id':_0x2f4c15(0x136),'ref':_0x440abd,'icon':Oi}));});wt[_0x38cdda(0x2e8)]=_0x38cdda(0x278);function Ti(_0x59adee){const _0x1f7823=_0x38cdda;switch(_0x59adee){case _0x5566b4[_0x1f7823(0x1d8)]:return'collabStatus.offline';case _0x5566b4[_0x1f7823(0x251)]:return _0x1f7823(0x152);case _0x5566b4[_0x1f7823(0x108)]:return _0x1f7823(0x177);case _0x5566b4['NOT_COLLAB']:return'collabStatus.notCollab';case _0x5566b4[_0x1f7823(0x295)]:case _0x5566b4[_0x1f7823(0x13b)]:return _0x1f7823(0x292);case _0x5566b4[_0x1f7823(0x159)]:case _0x5566b4[_0x1f7823(0x2f2)]:return'collabStatus.synced';}}function Ci(_0xd5de00){const _0x2e8552=_0x38cdda,{status$:_0x5e5f67}=_0xd5de00,_0x1515a5=_0x89bded(_0x5e5f67,_0x5566b4[_0x2e8552(0x143)]),_0x5d8b16=_0x23e243(_0x134929),_0x5a5407=_0x23e243(_0x4496ea),_0x5e3b6c=_0x1515a5!==_0x5566b4[_0x2e8552(0x1d8)],_0x17cb8c=_0x5d8b16['t'](Ti(_0x1515a5)),_0x1b2e0d=_0x5e3b6c?_0x22a0e6(wt,{}):_0x22a0e6(Pt,{}),_0x204c4f=_0x55c03e(()=>{_0x5e3b6c||_0x5a5407['reconnect']();},[_0x5e3b6c,_0x5a5407]);function _0x482966(){const _0x24ac90=_0x2e8552;return _0x3aac37(_0x24ac90(0x21d),{'className':_0x24ac90(0x24d),'onClick':_0x204c4f,'children':[_0x22a0e6(_0x24ac90(0x21d),{'className':_0x57d231('univer-mr-2\x20univer-flex\x20univer-text-xl',{'univer-text-green-500':_0x5e3b6c,'univer-text-red-500':!_0x5e3b6c}),'children':_0x1b2e0d}),_0x22a0e6(_0x24ac90(0x21d),{'className':'univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','children':_0x17cb8c})]});}return _0x5e3b6c?_0x482966():_0x22a0e6(_0x230ffb,{'title':_0x5d8b16['t']('collab-client.tooltip.reconnect'),'children':_0x482966()});}var Ri=Object['getOwnPropertyDescriptor'],Di=(_0x4e952b,_0x2b1b20,_0x357c4e,_0x2ef498)=>{for(var _0x40aa22=_0x2ef498>0x1?void 0x0:_0x2ef498?Ri(_0x2b1b20,_0x357c4e):_0x2b1b20,_0x431fcc=_0x4e952b['length']-0x1,_0x44ecc2;_0x431fcc>=0x0;_0x431fcc--)(_0x44ecc2=_0x4e952b[_0x431fcc])&&(_0x40aa22=_0x44ecc2(_0x40aa22)||_0x40aa22);return _0x40aa22;},se=(_0x41dc,_0x2a11b5)=>(_0xd77c7a,_0x2f92c1)=>_0x2a11b5(_0xd77c7a,_0x2f92c1,_0x41dc);let ae=class extends _0x447589{constructor(_0x24ae3a,_0x4d5dc0,_0x270154,_0x3a2b7e){const _0xf3c911=_0x38cdda;super(),_(this,'_status$',new _0x4f0f13(_0x5566b4[_0xf3c911(0x143)])),(this['_univerInstanceService']=_0x24ae3a,this[_0xf3c911(0x203)]=_0x4d5dc0,this[_0xf3c911(0x11d)]=_0x270154,this[_0xf3c911(0xfd)]=_0x3a2b7e,this[_0xf3c911(0x229)](),this[_0xf3c911(0x2c3)]());}[_0x38cdda(0x2c3)](){const _0x20461c=_0x38cdda;this[_0x20461c(0xfe)](this[_0x20461c(0x26c)][_0x20461c(0x15f)]['pipe'](_0x59793b(()=>{const _0x5423f8=_0x20461c,_0xc9d940=this[_0x5423f8(0x26c)][_0x5423f8(0x17e)]();return _0xc9d940?this[_0x5423f8(0x11d)]['getCollabEntity$'](_0xc9d940['getUnitId']()):_0x2d29f0(null);}),_0x59793b(_0x130014=>_0x130014?_0x130014[_0x20461c(0x1e7)]:_0x2d29f0(_0x5566b4[_0x20461c(0x143)])))[_0x20461c(0x268)](_0x1a8dab=>{const _0x4f771e=_0x20461c;this[_0x4f771e(0x2ac)][_0x4f771e(0x21c)](_0x1a8dab);}));}['_initStatusComponent'](){const _0x4a45f5=_0x38cdda;this['disposeWithMe'](this[_0x4a45f5(0xfd)][_0x4a45f5(0x1ca)](_0x8be1cd[_0x4a45f5(0x1e9)],()=>_0x4e4129(Ni({'status$':this['_status$']['asObservable']()}),this[_0x4a45f5(0x203)])));}};ae=Di([se(0x0,_0x57b197),se(0x1,_0x11edd2(_0x1d6fba)),se(0x2,_0x11edd2(_0x489919)),se(0x3,_0xe7b79e)],ae);function Ni(_0x248fb1){const {status$:_0x5424b6}=_0x248fb1;return function(){return _0x22a0e6(Ci,{'status$':_0x5424b6});};}const yt=_0x2b27ed(_0x38cdda(0x255));var bi=Object[_0x38cdda(0x1ac)],Li=(_0x3a704b,_0x5cc7fc,_0x2e568b,_0x49fc8e)=>{const _0x924d52=_0x38cdda;for(var _0x530069=_0x49fc8e>0x1?void 0x0:_0x49fc8e?bi(_0x5cc7fc,_0x2e568b):_0x5cc7fc,_0xb94aa4=_0x3a704b[_0x924d52(0xe4)]-0x1,_0xfe75d6;_0xb94aa4>=0x0;_0xb94aa4--)(_0xfe75d6=_0x3a704b[_0xb94aa4])&&(_0x530069=_0xfe75d6(_0x530069)||_0x530069);return _0x530069;},K=(_0x428033,_0x431360)=>(_0x19e67a,_0x28c346)=>_0x431360(_0x19e67a,_0x28c346,_0x428033);let ce=class extends _0x3f6cad{constructor(_0x123826,_0x378146,_0x547282,_0x1a5b65,_0x5513fe){const _0x19d9dd=_0x38cdda;super(),this['_urlService']=_0x123826,this[_0x19d9dd(0x193)]=_0x378146,this[_0x19d9dd(0x2d5)]=_0x547282,this[_0x19d9dd(0x179)]=_0x1a5b65,_0x5513fe?_0x5513fe==null||_0x5513fe[_0x19d9dd(0x189)]()[_0x19d9dd(0x256)](()=>this[_0x19d9dd(0x141)]()):(this[_0x19d9dd(0x193)][_0x19d9dd(0x22c)](_0x19d9dd(0xf9),_0x19d9dd(0x303)),this[_0x19d9dd(0x141)]());}async[_0x38cdda(0x141)](){const _0x365820=_0x38cdda,_0x25a725=this[_0x365820(0x23f)][_0x365820(0x264)](_0x365820(0x165)),_0xbb6316=this[_0x365820(0x23f)][_0x365820(0x264)](_0x365820(0x29a)),_0x22d6cd=this[_0x365820(0x23f)][_0x365820(0x264)]('subunit');if(!_0x25a725||!_0xbb6316){this[_0x365820(0x193)][_0x365820(0x22c)](_0x365820(0xf9),'No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.');return;}const _0x52a080=await this[_0x365820(0x179)][_0x365820(0x1bc)](_0x25a725,Number(_0xbb6316),_0x22d6cd);_0x52a080&&_0x52a080 instanceof _0x403982&&this[_0x365820(0xd8)](_0x52a080);}async['_setupSubUnitSync'](_0x427db0){const _0x2b1571=_0x38cdda;await this[_0x2b1571(0x11a)](_0x427db0),_0x427db0[_0x2b1571(0x2fc)][_0x2b1571(0x31b)](_0x3c41cb(this[_0x2b1571(0x1c5)]))['subscribe'](_0x2103e6=>{const _0x599319=_0x2b1571;_0x2103e6&&this[_0x599319(0x233)](_0x2103e6);}),this['_urlService']['urlChange$']['pipe'](_0x3c41cb(this[_0x2b1571(0x1c5)]))[_0x2b1571(0x268)](()=>this[_0x2b1571(0x11a)](_0x427db0));}[_0x38cdda(0x233)](_0x22bd11,_0x1d4f5e=!0x1){const _0xfee452=_0x38cdda,_0x3a719a=this[_0xfee452(0x23f)][_0xfee452(0x264)]('subunit');_0x22bd11[_0xfee452(0xdf)]()!==_0x3a719a&&this['_urlService'][_0xfee452(0xe7)](_0xfee452(0x1c1),_0x22bd11[_0xfee452(0xdf)](),_0x1d4f5e);}async[_0x38cdda(0x11a)](_0x502386){const _0x445e10=_0x38cdda;var _0x16d60b;const _0x29a89c=this['_urlService']['getParam'](_0x445e10(0x1c1));if(!_0x29a89c||!_0x502386[_0x445e10(0x149)](_0x29a89c)){const _0x27f363=_0x502386['getUnhiddenWorksheets']()[0x0],_0x5e5f18=_0x502386['getSheetBySheetId'](_0x27f363);if(!_0x5e5f18)return;this[_0x445e10(0x233)](_0x5e5f18,!0x0),await this[_0x445e10(0x2d5)][_0x445e10(0x223)](_0x4a6e79['id'],{'unitId':_0x502386['getUnitId'](),'subUnitId':_0x27f363});return;}((_0x16d60b=_0x502386[_0x445e10(0x25d)]())==null?void 0x0:_0x16d60b[_0x445e10(0xdf)]())!==_0x29a89c&&await this[_0x445e10(0x2d5)]['executeCommand'](_0x4a6e79['id'],{'unitId':_0x502386[_0x445e10(0xf6)](),'subUnitId':_0x29a89c});}};ce=Li([K(0x0,yt),K(0x1,_0x3b2794),K(0x2,_0x30ccef),K(0x3,_0x11edd2(_0x1082c0)),K(0x4,_0xa5584e(_0x511197))],ce);var Ui=Object[_0x38cdda(0x1ac)],Mi=(_0x904f0,_0x44327a,_0x4335e1,_0x2f5ea4)=>{for(var _0x5e5ad9=_0x2f5ea4>0x1?void 0x0:_0x2f5ea4?Ui(_0x44327a,_0x4335e1):_0x44327a,_0x23ed49=_0x904f0['length']-0x1,_0x539d17;_0x23ed49>=0x0;_0x23ed49--)(_0x539d17=_0x904f0[_0x23ed49])&&(_0x5e5ad9=_0x539d17(_0x5e5ad9)||_0x5e5ad9);return _0x5e5ad9;},rt=(_0x4fdef8,_0x5b81ca)=>(_0x450606,_0x5333d7)=>_0x5b81ca(_0x450606,_0x5333d7,_0x4fdef8);let $e=class extends _0x3f6cad{constructor(_0x337899,_0x2d4be1){const _0x44dd45=_0x38cdda;super(),this['_docClipboardService']=_0x337899,this[_0x44dd45(0x205)]=_0x2d4be1,this[_0x44dd45(0x141)]();}[_0x38cdda(0x141)](){const _0x42f7ac=_0x38cdda,_0x40b94a=this;this[_0x42f7ac(0xfe)](this[_0x42f7ac(0x2a4)][_0x42f7ac(0x236)]({'onBeforePasteImage':async _0x5eb60c=>{const _0x4f6de0=_0x42f7ac,_0x1e0e62=await _0x40b94a[_0x4f6de0(0x205)][_0x4f6de0(0x1f6)](_0x5eb60c);return _0x1e0e62?{'source':_0x1e0e62['source'],'imageSourceType':_0x1e0e62[_0x4f6de0(0x1c9)]}:null;}}));}};$e=Mi([rt(0x0,_0x1d7147),rt(0x1,_0x4baf00)],$e);const ot=['purple.300',_0x38cdda(0x1f8),_0x38cdda(0x1f3),_0x38cdda(0x2b1),_0x38cdda(0xfa),_0x38cdda(0x282)];class Ke extends _0x447589{constructor(){const _0x3fdf5c=_0x38cdda;super(...arguments),_(this,_0x3fdf5c(0x283),new Map()),_(this,_0x3fdf5c(0x1bd),0x0);}[_0x38cdda(0x168)](_0x4c36d7){const _0x33d8cb=_0x38cdda;if(this[_0x33d8cb(0x283)][_0x33d8cb(0x2e2)](_0x4c36d7))return this[_0x33d8cb(0x283)][_0x33d8cb(0x244)](_0x4c36d7);const _0x5327fb=ot[this['_colorIndex']];return this[_0x33d8cb(0x1bd)]=(this[_0x33d8cb(0x1bd)]+0x1)%ot[_0x33d8cb(0xe4)],this[_0x33d8cb(0x283)][_0x33d8cb(0x1ad)](_0x4c36d7,_0x5327fb),_0x5327fb;}}function $t(_0x38544e){const _0x527726=_0x38cdda;let _0x45c1ee='';for(const _0x26e007 of _0x38544e){const {startOffset:_0x2d7759,endOffset:_0x4c3922,isActive:_0x4eca07,rangeType:_0x1eab82,segmentId:_0x2bf8f2,segmentPage:_0x2d62a4}=_0x26e007;_0x45c1ee[_0x527726(0xe4)]&&(_0x45c1ee+=','),_0x45c1ee+=_0x2d7759+':'+_0x4c3922+':'+(_0x4eca07?'1':'0')+':'+_0x1eab82+':'+_0x2bf8f2+':'+_0x2d62a4;}return _0x45c1ee;}function Ai(_0x358fca){const _0x566f2e=_0x38cdda,_0x13a005=_0x358fca[_0x566f2e(0x2b2)](','),_0x40865a=[];for(const _0x3af69e of _0x13a005){const [_0x4ca90b,_0x32444b,_0x1fc2ac,_0x405c3f,_0x25158e,_0x3455e9]=_0x3af69e['split'](':');_0x40865a['push']({'startOffset':Number(_0x4ca90b),'endOffset':Number(_0x32444b),'collapsed':_0x4ca90b===_0x32444b,'isActive':_0x1fc2ac==='1','rangeType':_0x405c3f===_0x337f20[_0x566f2e(0x232)]?_0x337f20[_0x566f2e(0x232)]:_0x337f20['RECT'],'segmentId':typeof _0x25158e==_0x566f2e(0xec)?String(_0x25158e):'','segmentPage':Number(_0x3455e9!=null?_0x3455e9:-0x1)});}return _0x40865a['some'](_0x4dbbce=>_0x4dbbce[_0x566f2e(0x170)])||(_0x40865a[0x0][_0x566f2e(0x170)]=!0x0),_0x40865a;}class ze extends _0x3f6cad{constructor(){const _0x561ae4=_0x38cdda;super(...arguments),_(this,_0x561ae4(0x29d),new _0x4f0f13(null)),_(this,_0x561ae4(0x175),this[_0x561ae4(0x29d)]['asObservable']());}[_0x38cdda(0x16b)](_0x17d4b7){const _0x4104bc=_0x38cdda,{unitID:_0x5ea3f5,memberID:_0x1345b8,textRanges:_0x59c1e9}=_0x17d4b7,_0x5559eb=$t(_0x59c1e9);if(_0x5559eb==='')return;const _0x297ab9={'unitID':_0x5ea3f5,'memberID':_0x1345b8,'selection':_0x5559eb};this[_0x4104bc(0x29d)]['next'](_0x297ab9);}}var Pi=Object[_0x38cdda(0x1ac)],wi=(_0x225726,_0x17cd71,_0x2f6d61,_0x2eb8d0)=>{const _0x5029b7=_0x38cdda;for(var _0x5768a2=_0x2eb8d0>0x1?void 0x0:_0x2eb8d0?Pi(_0x17cd71,_0x2f6d61):_0x17cd71,_0x45f8bd=_0x225726[_0x5029b7(0xe4)]-0x1,_0x183cfc;_0x45f8bd>=0x0;_0x45f8bd--)(_0x183cfc=_0x225726[_0x45f8bd])&&(_0x5768a2=_0x183cfc(_0x5768a2)||_0x5768a2);return _0x5768a2;},A=(_0x385794,_0x2902b0)=>(_0x484148,_0x682c32)=>_0x2902b0(_0x484148,_0x682c32,_0x385794);const yi=0x12c,$i=0x64;let xe=class extends _0x3f6cad{constructor(_0x560a03,_0x20fa4d,_0x38950c,_0x45dae6,_0x3b04de,_0xa58678,_0x410f4b,_0x466702,_0x293928){const _0x4c4d74=_0x38cdda;super(),_(this,_0x4c4d74(0x1b4),!0x1),_(this,_0x4c4d74(0x141),!0x1),_(this,_0x4c4d74(0x17d),new _0x4f0f13(new Map())),_(this,_0x4c4d74(0x25e),this[_0x4c4d74(0x17d)][_0x4c4d74(0x1fe)]()),_(this,'_roomMembers$',new _0x4f0f13([])),_(this,_0x4c4d74(0xf1),this[_0x4c4d74(0x252)][_0x4c4d74(0x31b)](_0xc04ef5(yi))),_(this,_0x4c4d74(0x122),_0x899b23(_0x4da2e3=>{const _0x4e5495=_0x4c4d74,_0x3369fe={'eventID':_0xd5765d['UPDATE_CURSOR'],'data':{'unitID':this[_0x4e5495(0x14a)],'memberID':this[_0x4e5495(0x25c)][_0x4e5495(0x1fb)](),'selection':$t(_0x4da2e3)}};this[_0x4e5495(0x25c)][_0x4e5495(0x1a7)](_0x3369fe,this[_0x4e5495(0x14a)]);},$i)),(this[_0x4c4d74(0x14a)]=_0x560a03,this[_0x4c4d74(0x25c)]=_0x20fa4d,this[_0x4c4d74(0x203)]=_0x38950c,this[_0x4c4d74(0x1dc)]=_0x45dae6,this[_0x4c4d74(0x2c2)]=_0x3b04de,this['_syncEditingCollabCursorService']=_0xa58678,this[_0x4c4d74(0x27d)]=_0x410f4b,this[_0x4c4d74(0x26c)]=_0x466702,this[_0x4c4d74(0x2d5)]=_0x293928);}get[_0x38cdda(0x18d)](){const _0xd9efa4=_0x38cdda;return this[_0xd9efa4(0x17d)][_0xd9efa4(0x102)]();}get[_0x38cdda(0x1e6)](){const _0x4beff3=_0x38cdda;return this[_0x4beff3(0x252)][_0x4beff3(0x102)]();}['dispose'](){const _0x3b1c26=_0x38cdda;super[_0x3b1c26(0x16f)](),this[_0x3b1c26(0x17d)][_0x3b1c26(0x21c)](new Map()),this[_0x3b1c26(0x17d)][_0x3b1c26(0x319)](),this[_0x3b1c26(0x252)][_0x3b1c26(0x21c)]([]),this['_roomMembers$'][_0x3b1c26(0x319)]();}[_0x38cdda(0x2d1)](){const _0x52dd5b=_0x38cdda;this['_init']||(this['_init']=!0x0,this[_0x52dd5b(0x25c)][_0x52dd5b(0x1a3)][_0x52dd5b(0x31b)](_0x3c41cb(this[_0x52dd5b(0x1c5)]))[_0x52dd5b(0x268)](_0x4afbc7=>{const _0x4bf600=_0x52dd5b;_0x4afbc7===_0x43c2dd[_0x4bf600(0x24a)]?this[_0x4bf600(0x291)]():this['_toggleOffline']();}),this[_0x52dd5b(0x25c)][_0x52dd5b(0x130)][_0x52dd5b(0x31b)](_0x3c41cb(this[_0x52dd5b(0x1c5)]))[_0x52dd5b(0x268)](_0x1398d5=>{const _0x1c04f3=_0x52dd5b,_0x4f2e22=_0x1398d5[_0x1c04f3(0x1d2)];_0x4f2e22===_0xd5765d[_0x1c04f3(0xe2)]&&this['_onCursorUpdate'](_0x1398d5),_0x4f2e22===_0xd5765d['USERS_LEAVE']&&this[_0x1c04f3(0xe5)](_0x1398d5);}),this[_0x52dd5b(0xfe)](this[_0x52dd5b(0x2d5)][_0x52dd5b(0x113)](_0x1017f7=>{const _0x18fc46=_0x52dd5b,_0x2e5620=_0x1017f7[_0x18fc46(0x2a7)];_0x2e5620!=null&&this[_0x18fc46(0x1b4)]&&_0x1017f7['id']===_0x549163['id']&&_0x2e5620[_0x18fc46(0x18e)]===this[_0x18fc46(0x14a)]&&_0x2e5620[_0x18fc46(0x258)]===!0x1&&_0x2e5620[_0x18fc46(0x1b9)]['length']>0x0&&this[_0x18fc46(0x122)](_0x2e5620[_0x18fc46(0x1b9)]);})),this[_0x52dd5b(0x266)]['collabCursorState$'][_0x52dd5b(0x31b)](_0x3c41cb(this[_0x52dd5b(0x1c5)]))[_0x52dd5b(0x268)](_0x48f3c6=>{const _0x3d75e4=_0x52dd5b;if((_0x48f3c6==null?void 0x0:_0x48f3c6[_0x3d75e4(0x14a)])!==this[_0x3d75e4(0x14a)])return;const _0x57d81b={'eventID':_0xd5765d[_0x3d75e4(0xe2)],'data':_0x48f3c6};this[_0x3d75e4(0x305)](_0x57d81b);}),this['disposeWithMe'](this['_commandService'][_0x52dd5b(0x113)](_0x43670a=>{const _0x2614e7=_0x52dd5b;if(_0x43670a[_0x2614e7(0x2a7)]==null)return;const _0x379723=_0x43670a[_0x2614e7(0x2a7)];if(_0x43670a['id']!==_0xb130a7['id']||_0x379723[_0x2614e7(0x18e)]!==this[_0x2614e7(0x14a)])return;const _0x551587={'id':_0x2614e7(0x2bc),'params':_0x379723},_0x956498=this[_0x2614e7(0x18d)];for(const [_0x436685,_0x3c4ce1]of _0x956498){const _0x38f19d={'id':'doc.mutation.rich-text-editing','params':{'unitId':this[_0x2614e7(0x14a)],'actions':null,'textRanges':_0x3c4ce1[_0x2614e7(0x1b9)]}},_0x6d0a51=this[_0x2614e7(0x27d)][_0x2614e7(0x1d1)](_0x551587,_0x38f19d,!0x1);if(_0x2b6a5f(_0x6d0a51))throw _0x6d0a51[_0x2614e7(0x12a)];_0x956498[_0x2614e7(0x1ad)](_0x436685,{..._0x3c4ce1,'ranges':_0x6d0a51[_0x2614e7(0x1c6)]['params'][_0x2614e7(0x117)]});}queueMicrotask(()=>{const _0x49a3b9=_0x2614e7;this[_0x49a3b9(0x17d)][_0x49a3b9(0x21c)](_0x956498);});})));}[_0x38cdda(0x305)](_0x135d14){const _0x2872f2=_0x38cdda;var _0xd492d4,_0x4f6883;const {memberID:_0x14096f,selection:_0x3a651a}=_0x135d14[_0x2872f2(0x219)],_0x1cf372=Ai(_0x3a651a),_0x28e666=(_0x4f6883=(_0xd492d4=this[_0x2872f2(0x2c2)][_0x2872f2(0x1eb)](this[_0x2872f2(0x14a)],_0x14096f))==null?void 0x0:_0xd492d4[_0x2872f2(0x231)])!=null?_0x4f6883:_0x2872f2(0x31f),_0x5f23a8={'color':this[_0x2872f2(0x1dc)][_0x2872f2(0x168)](_0x14096f),'name':_0x28e666,'ranges':_0x1cf372},_0x5a79e8=this[_0x2872f2(0x18d)];_0x5a79e8['set'](_0x14096f,_0x5f23a8),this[_0x2872f2(0x17d)][_0x2872f2(0x21c)](_0x5a79e8);}[_0x38cdda(0xe5)](_0x77e268){const _0x96b6fa=_0x38cdda,{memberID:_0x4125c0}=_0x77e268[_0x96b6fa(0x219)],_0x927925=this[_0x96b6fa(0x18d)];_0x927925[_0x96b6fa(0x1f5)](_0x4125c0),this[_0x96b6fa(0x17d)]['next'](_0x927925);}[_0x38cdda(0x291)](){const _0x338f2e=_0x38cdda;var _0x476ef6;if(this[_0x338f2e(0x1b4)]=!0x0,((_0x476ef6=this[_0x338f2e(0x26c)]['getFocusedUnit']())==null?void 0x0:_0x476ef6[_0x338f2e(0xf6)]())!==this[_0x338f2e(0x14a)])return;const _0x4e9cb5=this['_injector']['get'](_0x186872)[_0x338f2e(0x2dd)]();Array[_0x338f2e(0x2c5)](_0x4e9cb5)&&_0x4e9cb5['length']>0x0&&this['_updateLocalCursor'](_0x4e9cb5);}[_0x38cdda(0x314)](){this['_online']=!0x1;}};xe=wi([A(0x2,_0x11edd2(_0x1d6fba)),A(0x3,_0x11edd2(Ke)),A(0x4,_0x11edd2(_0xf7eafd)),A(0x5,_0x11edd2(ze)),A(0x6,_0x41e619),A(0x7,_0x57b197),A(0x8,_0x30ccef)],xe);var xi=Object[_0x38cdda(0x1ac)],Bi=(_0x422ba7,_0x6734a7,_0x31e0a7,_0x4c4f4f)=>{const _0x1923ec=_0x38cdda;for(var _0x72eb06=_0x4c4f4f>0x1?void 0x0:_0x4c4f4f?xi(_0x6734a7,_0x31e0a7):_0x6734a7,_0x369dbf=_0x422ba7[_0x1923ec(0xe4)]-0x1,_0x264da2;_0x369dbf>=0x0;_0x369dbf--)(_0x264da2=_0x422ba7[_0x369dbf])&&(_0x72eb06=_0x264da2(_0x72eb06)||_0x72eb06);return _0x72eb06;},B=(_0x254ae4,_0x5db489)=>(_0x3ae834,_0x540fde)=>_0x5db489(_0x3ae834,_0x540fde,_0x254ae4);const Fi=0x12c,ki=0x64,Hi=()=>{let _0x3ac35f=[],_0x58f1ac=!0x1;return _0x3fc31f=>{const _0x1a12a2=_0x215c;_0x3ac35f[_0x1a12a2(0x186)](_0x3fc31f),_0x58f1ac||(_0x58f1ac=!0x0,setTimeout(()=>{_0x3ac35f['forEach'](_0x14864c=>_0x14864c()),_0x3ac35f=[],_0x58f1ac=!0x1;}));};};let Be=class extends _0x3f6cad{constructor(_0x505aab,_0x5e9557,_0x1e7be4,_0x374830,_0x48cb70,_0x1025d6,_0x3ee85a,_0x54a1ea){const _0x459c27=_0x38cdda;super(),_(this,_0x459c27(0x1b4),!0x1),_(this,_0x459c27(0x141),!0x1),_(this,_0x459c27(0x17d),new _0x4f0f13(new Map())),_(this,_0x459c27(0x25e),this[_0x459c27(0x17d)]['asObservable']()),_(this,_0x459c27(0x252),new _0x4f0f13([])),_(this,_0x459c27(0xf1),this[_0x459c27(0x252)][_0x459c27(0x31b)](_0xc04ef5(Fi))),_(this,_0x459c27(0x122),_0x899b23((_0x3cc0dd,_0x8f07ed)=>{const _0x4c83f9=_0x459c27,_0x1d389d={'eventID':_0xd5765d[_0x4c83f9(0xe2)],'data':{'unitID':this[_0x4c83f9(0x14a)],'memberID':this['_session']['getMemberID'](),'selection':_0x44e445(_0x3cc0dd,_0x8f07ed[_0x4c83f9(0x2f3)])}};this[_0x4c83f9(0x25c)][_0x4c83f9(0x1a7)](_0x1d389d,this[_0x4c83f9(0x14a)]);},ki)),(this[_0x459c27(0x14a)]=_0x505aab,this[_0x459c27(0x25c)]=_0x5e9557,this['_injector']=_0x1e7be4,this[_0x459c27(0x1dc)]=_0x374830,this['_memberService']=_0x48cb70,this[_0x459c27(0x26c)]=_0x1025d6,this['_commandService']=_0x3ee85a,this['_refRangeService']=_0x54a1ea);}get[_0x38cdda(0x18d)](){const _0x6b97ec=_0x38cdda;return this[_0x6b97ec(0x17d)][_0x6b97ec(0x102)]();}get['roomMembers'](){const _0x3f155d=_0x38cdda;return this['_roomMembers$'][_0x3f155d(0x102)]();}[_0x38cdda(0x16f)](){const _0x5177c4=_0x38cdda;super['dispose'](),this[_0x5177c4(0x17d)][_0x5177c4(0x21c)](new Map()),this[_0x5177c4(0x17d)][_0x5177c4(0x319)](),this['_roomMembers$'][_0x5177c4(0x21c)]([]),this[_0x5177c4(0x252)][_0x5177c4(0x319)]();}[_0x38cdda(0x2d1)](){const _0x8797e=_0x38cdda;this[_0x8797e(0x141)]||(this[_0x8797e(0x141)]=!0x0,this[_0x8797e(0x25c)][_0x8797e(0x1a3)][_0x8797e(0x31b)](_0x3c41cb(this[_0x8797e(0x1c5)]))[_0x8797e(0x268)](_0x5b53f0=>{const _0x4797f9=_0x8797e;_0x5b53f0===_0x43c2dd[_0x4797f9(0x24a)]?this[_0x4797f9(0x291)]():this[_0x4797f9(0x314)]();}),this[_0x8797e(0x25c)][_0x8797e(0x130)]['pipe'](_0x3c41cb(this[_0x8797e(0x1c5)]))['subscribe'](_0x2f658a=>{const _0x59e9bb=_0x8797e,_0x4bff60=_0x2f658a[_0x59e9bb(0x1d2)];_0x4bff60===_0xd5765d[_0x59e9bb(0xe2)]&&this[_0x59e9bb(0x305)](_0x2f658a),_0x4bff60===_0xd5765d[_0x59e9bb(0xf8)]&&this[_0x59e9bb(0xe5)](_0x2f658a);}),this[_0x8797e(0x147)](),this[_0x8797e(0xfe)](this[_0x8797e(0x2d5)][_0x8797e(0x113)](_0x590661=>{const _0x536dee=_0x8797e;if(this['_online']&&_0x590661['id']===_0x224ac4['id']&&_0x590661[_0x536dee(0x2a7)]['unitId']===this[_0x536dee(0x14a)]){const _0x3c71fe=_0x590661[_0x536dee(0x2a7)];this[_0x536dee(0x122)](_0x3c71fe['subUnitId'],_0x3c71fe[_0x536dee(0x247)][0x0]);}})));}[_0x38cdda(0x305)](_0x428e71){const _0x5b0f8a=_0x38cdda;var _0x4e6acb,_0x387eb8;const {memberID:_0x33b38c,selection:_0x275983}=_0x428e71[_0x5b0f8a(0x219)],{sheetName:_0x1d79df,range:_0x2967fd}=_0x873948(_0x275983),_0x1bc172={'name':(_0x387eb8=(_0x4e6acb=this[_0x5b0f8a(0x2c2)][_0x5b0f8a(0x1eb)](this[_0x5b0f8a(0x14a)],_0x33b38c))==null?void 0x0:_0x4e6acb['name'])!=null?_0x387eb8:_0x5b0f8a(0x31f),'range':this[_0x5b0f8a(0x19c)](_0x1d79df,_0x2967fd),'sheetID':_0x1d79df,'color':this[_0x5b0f8a(0x1dc)][_0x5b0f8a(0x168)](_0x33b38c),'selection':_0x275983},_0x1cef28=this[_0x5b0f8a(0x18d)];_0x1cef28[_0x5b0f8a(0x1ad)](_0x33b38c,_0x1bc172),this[_0x5b0f8a(0x17d)][_0x5b0f8a(0x21c)](_0x1cef28);}[_0x38cdda(0xe5)](_0x4507b3){const _0x358eac=_0x38cdda,{memberID:_0x2b46a7}=_0x4507b3[_0x358eac(0x219)],_0x33a8e=this[_0x358eac(0x18d)];_0x33a8e['delete'](_0x2b46a7),this[_0x358eac(0x17d)][_0x358eac(0x21c)](_0x33a8e);}['_getMergeRange'](_0x205fcb,_0x47b234){const _0x487704=_0x38cdda;var _0x281361,_0x4c9e86;const _0x16efe2=(_0x4c9e86=(_0x281361=this['_univerInstanceService'][_0x487704(0x14c)](this[_0x487704(0x14a)]))==null?void 0x0:_0x281361['getSheetBySheetId'](_0x205fcb))==null?void 0x0:_0x4c9e86['getMergeData']();return(_0x16efe2==null?void 0x0:_0x16efe2[_0x487704(0x243)](_0x1ee7fb=>_0x32e6d6[_0x487704(0x1a9)](_0x1ee7fb,_0x47b234)))||_0x47b234;}[_0x38cdda(0x147)](){const _0x734b6c=_0x38cdda,_0x487ba7=new _0x48f1ed(),_0x2f6201=Hi(),_0x361fbe=()=>{const _0x32fdb3=_0x215c;_0x487ba7[_0x32fdb3(0x16f)]();const _0x4e4f62=(_0x93daae,_0x571daa,_0x2ae1c2,_0x3bfd00)=>{const _0x4bd821=_0x32fdb3;let _0x32816e=[];switch(_0x93daae['id']){case _0x37396e[_0x4bd821(0x1f0)]:{_0x32816e=_0x406111(_0x93daae,_0x3bfd00);break;}case _0x37396e['DeleteRangeMoveUpCommandId']:{_0x32816e=_0x276adc(_0x93daae,_0x3bfd00);break;}case _0x37396e[_0x4bd821(0xf7)]:{_0x32816e=_0x260fbe(_0x93daae,_0x3bfd00);break;}case _0x37396e['InsertRangeMoveDownCommandId']:{_0x32816e=_0x533ae0(_0x93daae,_0x3bfd00);break;}case _0x37396e[_0x4bd821(0x1e5)]:{_0x32816e=_0x204698(_0x93daae,_0x3bfd00);break;}case _0x37396e[_0x4bd821(0x1e1)]:{_0x32816e=_0x21bb57(_0x93daae,_0x3bfd00);break;}case _0x37396e[_0x4bd821(0x133)]:{_0x32816e=_0x10c4cd(_0x93daae,_0x3bfd00);break;}case _0x37396e[_0x4bd821(0x2e7)]:{_0x32816e=_0x58fde2(_0x93daae,_0x3bfd00);break;}case _0x37396e['RemoveRowCommandId']:{_0x32816e=_0x590d44(_0x93daae,_0x3bfd00);break;}}const _0xf2da29=_0x5887a9(_0x32816e,_0x3bfd00),_0x37b44f=this[_0x4bd821(0x18d)]['get'](_0x571daa);if(_0x37b44f&&_0xf2da29){const _0xbdd3af={..._0x37b44f,'range':_0xf2da29};this[_0x4bd821(0x18d)][_0x4bd821(0x1ad)](_0x571daa,_0xbdd3af),_0x2f6201(()=>{const _0x50df15=_0x4bd821,_0x45bc95=this[_0x50df15(0x1d9)][_0x50df15(0x14d)](_0xf2da29,_0x1def29=>(_0x45bc95['dispose'](),_0x4e4f62(_0x1def29,_0x571daa,_0x2ae1c2,_0xf2da29)));_0x487ba7[_0x50df15(0x126)](_0x45bc95);});}return{'redos':[],'undos':[]};};this[_0x32fdb3(0x18d)]['forEach']((_0x1173fe,_0x19f802)=>{const _0x456448=_0x32fdb3,{range:_0x404b7b,sheetID:_0x127b31}=_0x1173fe,_0x373177=this[_0x456448(0x1d9)]['registerRefRange'](_0x404b7b,_0x15e946=>(_0x373177['dispose'](),_0x4e4f62(_0x15e946,_0x19f802,_0x127b31,_0x404b7b)));_0x487ba7[_0x456448(0x126)](_0x373177);});};this[_0x734b6c(0xfe)](_0x2e6c99(this['_cursorInfo$'][_0x734b6c(0x268)](()=>{_0x361fbe();})));}[_0x38cdda(0x291)](){const _0x2259fe=_0x38cdda;var _0x2eed26,_0x3a984f;if(this[_0x2259fe(0x1b4)]=!0x0,((_0x2eed26=this[_0x2259fe(0x26c)][_0x2259fe(0x17e)]())==null?void 0x0:_0x2eed26[_0x2259fe(0xf6)]())!==this['unitID'])return;const _0x539295=(_0x3a984f=this[_0x2259fe(0x203)]['get'](_0x5f0afd)['getCurrentSelections']())==null?void 0x0:_0x3a984f[0x0],_0x4bdab5=this[_0x2259fe(0x26c)][_0x2259fe(0x118)](_0x13411f[_0x2259fe(0x18f)])['getActiveSheet']();_0x539295&&_0x4bdab5&&this[_0x2259fe(0x122)](_0x4bdab5[_0x2259fe(0xdf)](),_0x539295);}[_0x38cdda(0x314)](){const _0x2c52b8=_0x38cdda;this[_0x2c52b8(0x1b4)]=!0x1;}};Be=Bi([B(0x2,_0x11edd2(_0x1d6fba)),B(0x3,_0x11edd2(Ke)),B(0x4,_0x11edd2(_0xf7eafd)),B(0x5,_0x57b197),B(0x6,_0x30ccef),B(0x7,_0x11edd2(_0x1bca19))],Be);var Yi=Object[_0x38cdda(0x1ac)],Wi=(_0x34f951,_0x36fa4b,_0xb78e97,_0x5202fa)=>{const _0x2467b1=_0x38cdda;for(var _0x579ae0=_0x5202fa>0x1?void 0x0:_0x5202fa?Yi(_0x36fa4b,_0xb78e97):_0x36fa4b,_0x3301f9=_0x34f951[_0x2467b1(0xe4)]-0x1,_0x486b03;_0x3301f9>=0x0;_0x3301f9--)(_0x486b03=_0x34f951[_0x3301f9])&&(_0x579ae0=_0x486b03(_0x579ae0)||_0x579ae0);return _0x579ae0;},Ce=(_0x3aaaaa,_0x46ff56)=>(_0x6a5a4e,_0x26566d)=>_0x46ff56(_0x6a5a4e,_0x26566d,_0x3aaaaa);let H=class extends _0x3f6cad{constructor(_0x5536e8,_0x1dbdca,_0x8815c1){const _0x1320ef=_0x38cdda;super(),_(this,_0x1320ef(0x1ec),new Map()),_(this,_0x1320ef(0x145),new _0x5ac8bc()),(this[_0x1320ef(0x26c)]=_0x5536e8,this[_0x1320ef(0x203)]=_0x1dbdca,this['_collabSessionService']=_0x8815c1,this[_0x1320ef(0x141)]());}[_0x38cdda(0x16f)](){const _0x299d1a=_0x38cdda;super[_0x299d1a(0x16f)](),this[_0x299d1a(0x145)][_0x299d1a(0x319)](),this[_0x299d1a(0x1ec)][_0x299d1a(0x109)](_0x32a525=>_0x32a525[_0x299d1a(0x16f)]());}['getCollabCursors$'](_0x462735){const _0x2c4835=_0x38cdda;return this[_0x2c4835(0x1ec)][_0x2c4835(0x2e2)](_0x462735)?this['_entities'][_0x2c4835(0x244)](_0x462735)[_0x2c4835(0x25e)]:this[_0x2c4835(0x145)][_0x2c4835(0x31b)](_0x32f62e(_0x2cc62e=>_0x2cc62e[_0x2c4835(0x14a)]===_0x462735),_0x59793b(_0x3c778a=>_0x3c778a[_0x2c4835(0x25e)]));}['_init'](){const _0x13323e=_0x38cdda;this[_0x13323e(0x26c)][_0x13323e(0x226)](_0x13411f[_0x13323e(0x18f)])[_0x13323e(0x31b)](_0x3c41cb(this['dispose$']))['subscribe'](async _0x51e344=>{const _0x16358a=_0x13323e,_0x3d07ca=_0x51e344[_0x16358a(0xf6)](),_0x6faa6f=await this['_startSheetCollabCursor'](_0x3d07ca);this[_0x16358a(0x145)][_0x16358a(0x21c)](_0x6faa6f),this[_0x16358a(0x1ec)]['set'](_0x3d07ca,_0x6faa6f);}),this[_0x13323e(0x26c)][_0x13323e(0x226)](_0x13411f[_0x13323e(0x269)])[_0x13323e(0x31b)](_0x3c41cb(this[_0x13323e(0x1c5)]))[_0x13323e(0x31b)](_0x32f62e(_0x24707c=>!_0x24707c[_0x13323e(0xf6)]()['startsWith']('__')))[_0x13323e(0x268)](async _0x262376=>{const _0x5614e7=_0x13323e,_0x2aa859=_0x262376[_0x5614e7(0xf6)](),_0x54c8d5=await this['_startDocCollabCursor'](_0x2aa859);this[_0x5614e7(0x145)]['next'](_0x54c8d5),this[_0x5614e7(0x1ec)][_0x5614e7(0x1ad)](_0x2aa859,_0x54c8d5);}),_0x44c07d(this[_0x13323e(0x26c)][_0x13323e(0x190)](_0x13411f[_0x13323e(0x269)]),this['_univerInstanceService']['getTypeOfUnitDisposed$'](_0x13411f[_0x13323e(0x18f)]))[_0x13323e(0x31b)](_0x3c41cb(this[_0x13323e(0x1c5)]))['subscribe'](_0x3c9b79=>{const _0x315483=_0x13323e,_0x43bf40=_0x3c9b79[_0x315483(0xf6)](),_0x5a8a61=this[_0x315483(0x1ec)][_0x315483(0x244)](_0x43bf40);_0x5a8a61&&(_0x5a8a61['dispose'](),this[_0x315483(0x1ec)][_0x315483(0x1f5)](_0x43bf40));});}async[_0x38cdda(0x28a)](_0x49653c){const _0x55627d=_0x38cdda,_0x5c8ac8=await this[_0x55627d(0x2fe)]['requireSession'](_0x49653c),_0x50b285=this[_0x55627d(0x203)]['createInstance'](Be,_0x49653c,_0x5c8ac8);return _0x50b285[_0x55627d(0x2d1)](),_0x50b285;}async[_0x38cdda(0x13a)](_0xba0c59){const _0x3ff5cf=_0x38cdda,_0x54ec52=await this[_0x3ff5cf(0x2fe)]['requireSession'](_0xba0c59),_0x19a4f5=this[_0x3ff5cf(0x203)][_0x3ff5cf(0x15c)](xe,_0xba0c59,_0x54ec52);return _0x19a4f5['init'](),_0x19a4f5;}};H=Wi([Ce(0x0,_0x57b197),Ce(0x1,_0x11edd2(_0x1d6fba)),Ce(0x2,_0x11edd2(_0x4496ea))],H);const Q=0x14,at=0xc8,Re=0x4,Vi=0x5;function ji(_0x15c8c9,_0x12d472){const _0x1a2408=_0x38cdda;let {radius:_0x1f5451,width:_0x3ef09b,height:_0x1f23b6}=_0x12d472;_0x1f5451=_0x1f5451!=null?_0x1f5451:0x0,_0x3ef09b=_0x3ef09b!=null?_0x3ef09b:0x1e,_0x1f23b6=_0x1f23b6!=null?_0x1f23b6:0x1e;let _0x2bf6a3=0x0,_0x4c122c=0x0,_0x3bc2d9=0x0;_0x2bf6a3=_0x4c122c=_0x3bc2d9=Math[_0x1a2408(0x17f)](_0x1f5451,_0x3ef09b/0x2,_0x1f23b6/0x2),_0x15c8c9[_0x1a2408(0x26e)](),_0x15c8c9[_0x1a2408(0x137)](_0x2bf6a3,0x0),_0x15c8c9[_0x1a2408(0x1de)](_0x3ef09b-_0x4c122c,0x0),_0x15c8c9[_0x1a2408(0x2d0)](_0x3ef09b-_0x4c122c,_0x4c122c,_0x4c122c,Math['PI']*0x3/0x2,0x0,!0x1),_0x15c8c9[_0x1a2408(0x1de)](_0x3ef09b,_0x1f23b6-_0x3bc2d9),_0x15c8c9[_0x1a2408(0x2d0)](_0x3ef09b-_0x3bc2d9,_0x1f23b6-_0x3bc2d9,_0x3bc2d9,0x0,Math['PI']/0x2,!0x1),_0x15c8c9[_0x1a2408(0x1de)](0x0,_0x1f23b6),_0x15c8c9[_0x1a2408(0x1de)](0x0,_0x2bf6a3),_0x15c8c9[_0x1a2408(0x2d0)](_0x2bf6a3,_0x2bf6a3,_0x2bf6a3,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0x15c8c9[_0x1a2408(0x163)](),_0x12d472[_0x1a2408(0x2b4)]&&(_0x15c8c9[_0x1a2408(0xd9)](),_0x15c8c9[_0x1a2408(0x2b3)]=_0x12d472[_0x1a2408(0x2b4)],_0x12d472[_0x1a2408(0x24c)]===_0x1a2408(0x1d5)?_0x15c8c9[_0x1a2408(0x2b4)](_0x1a2408(0x1d5)):_0x15c8c9[_0x1a2408(0x2b4)](),_0x15c8c9['restore']());}class ve extends _0x490c21{constructor(_0x37c8db,_0x13a7d9){const _0x2eb3ad=_0x38cdda;super(_0x37c8db,_0x13a7d9),_(this,'color'),_(this,_0x2eb3ad(0xf4)),(this[_0x2eb3ad(0x13f)]=_0x13a7d9==null?void 0x0:_0x13a7d9['color'],this[_0x2eb3ad(0xf4)]=_0x13a7d9==null?void 0x0:_0x13a7d9[_0x2eb3ad(0xf4)]);}static[_0x38cdda(0xea)](_0x4ea882,_0x1d5646){const _0x4382c9=_0x38cdda,{text:_0x5d3f7b,color:_0x518cd1}=_0x1d5646;_0x4ea882[_0x4382c9(0xd9)](),_0x4ea882[_0x4382c9(0x2ef)]=_0x4382c9(0x22a);const _0x445773=_0x4ea882[_0x4382c9(0x104)](_0x5d3f7b)['width'],_0xa8dc5e=Math['min'](_0x445773+0x2*Re,at);ji(_0x4ea882,{'height':Q,'radius':0x4,'width':_0xa8dc5e,'fill':_0x518cd1}),_0x4ea882[_0x4382c9(0x2b3)]='#FFF';const _0x1121bd=Re,_0x5c1673=Q-Vi,_0x5cbf3c=at-0x2*Re;if(_0x445773>_0x5cbf3c){let _0xea96d0='',_0xd3032=0x0;for(const _0x1d0322 of _0x5d3f7b){const _0x4af00f=_0x4ea882['measureText'](_0x1d0322)['width'];if(_0xd3032+_0x4af00f<=_0x5cbf3c-_0x4ea882[_0x4382c9(0x104)](_0x4382c9(0x2c0))['width'])_0xea96d0+=_0x1d0322,_0xd3032+=_0x4af00f;else{_0xea96d0+=_0x4382c9(0x2c0);break;}}_0x4ea882[_0x4382c9(0x125)](_0xea96d0,_0x1121bd,_0x5c1673);}else _0x4ea882[_0x4382c9(0x125)](_0x5d3f7b,_0x1121bd,_0x5c1673);_0x4ea882[_0x4382c9(0x1bf)]();}['_draw'](_0x4580d8){const _0x33eb4e=_0x38cdda;ve[_0x33eb4e(0xea)](_0x4580d8,this);}}const De=_0x38cdda(0x153),Xi=_0x38cdda(0x1c4),Gi=_0x38cdda(0xdc),z=0x6,Ki=1.5,Ne=0x4,zi=1.5,Ji=_0x38cdda(0x22e);class ct{constructor(_0x2c97a8,_0x4a3720,_0x50ba52,_0x397d6a){const _0x10386d=_0x38cdda;_(this,'_shapes',[]),_(this,_0x10386d(0x275),null),_(this,_0x10386d(0x11e),null),_(this,'_anchorDot',null),_(this,'_hideTimer',null),_(this,_0x10386d(0xe1),null),(this['_cursor']=_0x2c97a8,this[_0x10386d(0x2df)]=_0x4a3720,this['_docSkeleton']=_0x50ba52,this[_0x10386d(0x1c0)]=_0x397d6a,this[_0x10386d(0x311)]());}set['_hover'](_0x2d8d90){const _0x184225=_0x38cdda;_0x2d8d90?(this[_0x184225(0x16e)]&&this[_0x184225(0x16e)][_0x184225(0xe8)](),this[_0x184225(0x11e)]&&this[_0x184225(0x11e)][_0x184225(0x197)]()):(this[_0x184225(0x16e)]&&this['_anchorDot'][_0x184225(0x197)](),this[_0x184225(0x11e)]&&this[_0x184225(0x11e)]['hide']());}[_0x38cdda(0x16f)](){const _0xbc05e=_0x38cdda;for(const _0x734760 of this[_0xbc05e(0x131)])_0x734760['dispose']();this[_0xbc05e(0x11e)]&&this[_0xbc05e(0x11e)][_0xbc05e(0x16f)](),this[_0xbc05e(0x16e)]&&this['_anchorDot'][_0xbc05e(0x16f)](),this[_0xbc05e(0x275)]&&this[_0xbc05e(0x275)][_0xbc05e(0x16f)](),this[_0xbc05e(0xe1)]&&this[_0xbc05e(0xe1)]();}[_0x38cdda(0x311)](){const _0x192318=_0x38cdda;var _0x74d81f;const {_docSkeleton:_0x16c82f,_document:_0x19ea74}=this,{color:_0x5c75af,name:_0x31a089,ranges:_0xec49f2}=this[_0x192318(0x1e8)],_0x1efd64=_0x19ea74[_0x192318(0x14b)](),{docsLeft:_0x5a0283,docsTop:_0xc8d838}=_0x1efd64,_0x3cbca4=new _0x262f06(_0x1efd64,_0x16c82f);for(const {startOffset:_0x497d1d,endOffset:_0x409a58,rangeType:_0x3d9455,segmentId:_0x414f4b,segmentPage:_0x2b990a,collapsed:_0x36ce5f,isActive:_0x3d7e38}of _0xec49f2){const _0x2c5c43=_0x16c82f[_0x192318(0x31c)](_0x497d1d,!0x0,_0x414f4b,_0x2b990a);let _0x24e6a3=_0x16c82f[_0x192318(0x31c)](_0x409a58,!0x0,_0x414f4b,_0x2b990a);if(_0x24e6a3==null&&(_0x24e6a3=_0x16c82f[_0x192318(0x31c)](_0x409a58-0x1,!0x1,_0x414f4b,_0x2b990a)),_0x3d7e38){const {contentBoxPointGroup:_0x28c006}=_0x3cbca4[_0x192318(0x24b)](_0x24e6a3,_0x24e6a3);if(_0x28c006['length']===0x0)continue;this[_0x192318(0x1bb)](_0x5c75af,_0x28c006,_0x5a0283,_0xc8d838,_0x31a089),this[_0x192318(0xe1)]=this[_0x192318(0x12b)]();}if(_0x2c5c43&&_0x24e6a3){if(_0x3d9455===_0x337f20[_0x192318(0x169)]){const _0x1bdf5d=new _0x4e4b6b(_0x1efd64,_0x16c82f),{pointGroup:_0x4629a8}=(_0x74d81f=_0x1bdf5d[_0x192318(0x24b)](_0x2c5c43,_0x24e6a3))!=null?_0x74d81f:{};if(_0x4629a8==null||_0x4629a8[_0x192318(0xe4)]===0x0)continue;this[_0x192318(0x20f)](_0x5c75af,_0x4629a8,_0x5a0283,_0xc8d838);}else{if(!_0x36ce5f){const {borderBoxPointGroup:_0x4881d0}=_0x3cbca4[_0x192318(0x24b)](_0x2c5c43,_0x24e6a3);if(_0x4881d0[_0x192318(0xe4)]===0x0)continue;this[_0x192318(0x27f)](_0x5c75af,_0x4881d0,_0x5a0283,_0xc8d838);}}}}}[_0x38cdda(0x1bb)](_0x2f4346,_0xffaa46,_0xc3e949,_0x38da43,_0x9a978e){const _0x475050=_0x38cdda,_0x302831=this[_0x475050(0x1cc)](_0xffaa46),{left:_0xee6295,top:_0x1429df,height:_0x13d7ac}=_0x302831,_0x3e3452=this[_0x475050(0x198)](),_0x1c195c=zi/_0x3e3452,_0xf3b9e0=new _0xa348d8(De+_0x11358d(z),{'left':_0xee6295+_0xc3e949-_0x1c195c,'top':_0x1429df+_0x38da43,'height':_0x13d7ac,'width':Ki,'fill':_0x2f4346||_0x19c299(_0x2b8a6b[_0x475050(0x214)],0x0),'strokeWidth':_0x1c195c,'stroke':Ji,'evented':!0x0});this[_0x475050(0x275)]=_0xf3b9e0,this['_scene'][_0x475050(0x204)](_0xf3b9e0,_0xd0acda);const _0x41c9b8=new _0xa348d8(De+_0x11358d(z),{'left':_0xee6295+_0xc3e949-_0x1c195c,'top':_0x1429df+_0x38da43-Ne/0x2,'height':Ne,'width':Ne,'fill':_0x2f4346||_0x19c299(_0x2b8a6b[_0x475050(0x214)],0x0),'strokeWidth':0x0,'stroke':_0x2f4346||_0x19c299(_0x2b8a6b[_0x475050(0x214)],0x0),'evented':!0x1});this[_0x475050(0x16e)]=_0x41c9b8,this[_0x475050(0x2df)][_0x475050(0x204)](_0x41c9b8,_0xd0acda);const _0x50abfd=new ve(De+_0x11358d(z),{'left':_0xee6295+_0xc3e949-_0x1c195c,'top':_0x1429df+_0x38da43-Q,'text':_0x9a978e,'color':_0x2f4346});this[_0x475050(0x11e)]=_0x50abfd,this[_0x475050(0x2df)][_0x475050(0x204)](_0x50abfd,_0xd0acda),this[_0x475050(0x312)]=!0x1;}[_0x38cdda(0x12b)](){const _0xd6bb63=_0x38cdda,_0x581f86=this[_0xd6bb63(0x275)][_0xd6bb63(0x15b)][_0xd6bb63(0x18a)](()=>{const _0x11fc12=_0xd6bb63;this[_0x11fc12(0x312)]=!0x0;}),_0x137813=this['_anchor'][_0xd6bb63(0x2cf)]['subscribeEvent'](()=>{const _0x4a753a=_0xd6bb63;this['_hideTimer']&&clearTimeout(this[_0x4a753a(0x19f)]),this[_0x4a753a(0x19f)]=setTimeout(()=>{const _0x55c0a7=_0x4a753a;this[_0x55c0a7(0x312)]=!0x1;},0x7d0);});return()=>{const _0x2d435e=_0xd6bb63;_0x581f86['unsubscribe'](),_0x137813[_0x2d435e(0x13e)]();};}[_0x38cdda(0x27f)](_0x34c387,_0x3a91fb,_0x5ecaa8,_0x108266){const _0x598a24=_0x38cdda,_0x55d04a=new _0x1f7760(_0x34c387)[_0x598a24(0x24e)](0.2)[_0x598a24(0x322)](),_0x16d7a3=new _0x1e1639(Xi+_0x11358d(z),{'pointsGroup':_0x3a91fb,'fill':_0x55d04a||_0x19c299(_0x2b8a6b[_0x598a24(0x214)],0.2),'left':_0x5ecaa8,'top':_0x108266,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x598a24(0x131)]['push'](_0x16d7a3),this[_0x598a24(0x2df)][_0x598a24(0x204)](_0x16d7a3,_0xd0acda);}[_0x38cdda(0x20f)](_0x46f1e2,_0xd8f683,_0x5cfcbf,_0x2ab9a6){const _0x119707=_0x38cdda,_0x3856cf=new _0x1f7760(_0x46f1e2)[_0x119707(0x24e)](0.2)[_0x119707(0x322)](),_0x1dab14=new _0x1e1639(Gi+_0x11358d(z),{'pointsGroup':_0xd8f683,'fill':_0x3856cf||_0x19c299(_0x2b8a6b[_0x119707(0x214)],0.2),'left':_0x5cfcbf,'top':_0x2ab9a6,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x119707(0x131)]['push'](_0x1dab14),this[_0x119707(0x2df)][_0x119707(0x204)](_0x1dab14,_0xd0acda);}['_getAnchorBounding'](_0x59dad9){const _0x1dd457=_0x59dad9[0x0],_0x19094e=_0x1dd457[0x0],_0x2b4a73=_0x1dd457[0x2],{x:_0x4e7a78,y:_0xd6d8f1}=_0x19094e,{x:_0xbbc18a,y:_0x48a86e}=_0x2b4a73;return{'left':_0x4e7a78,'top':_0xd6d8f1,'width':_0xbbc18a-_0x4e7a78,'height':_0x48a86e-_0xd6d8f1};}[_0x38cdda(0x198)](){const _0x3c57c7=_0x38cdda,{scaleX:_0x2bb20f,scaleY:_0x4bafa4}=this[_0x3c57c7(0x2df)][_0x3c57c7(0x171)]();return Math[_0x3c57c7(0x12d)](_0x2bb20f,_0x4bafa4);}}var Zi=Object[_0x38cdda(0x1ac)],Qi=(_0x5b8753,_0x2e93af,_0x557dd0,_0x10054c)=>{const _0x2a41d4=_0x38cdda;for(var _0xb814e2=_0x10054c>0x1?void 0x0:_0x10054c?Zi(_0x2e93af,_0x557dd0):_0x2e93af,_0x1a9481=_0x5b8753[_0x2a41d4(0xe4)]-0x1,_0x410344;_0x1a9481>=0x0;_0x1a9481--)(_0x410344=_0x5b8753[_0x1a9481])&&(_0xb814e2=_0x410344(_0xb814e2)||_0xb814e2);return _0xb814e2;},ie=(_0x1cb3c6,_0x59cc8d)=>(_0x3f7d8c,_0x15202e)=>_0x59cc8d(_0x3f7d8c,_0x15202e,_0x1cb3c6);let Fe=class extends _0x3f6cad{constructor(_0x308393,_0x187a88,_0x41d42b,_0x547c74,_0x10a44e){const _0x56e3fc=_0x38cdda;super(),_(this,_0x56e3fc(0x158),[]),_(this,_0x56e3fc(0xd5),[]),(this[_0x56e3fc(0x2e1)]=_0x308393,this[_0x56e3fc(0x16c)]=_0x187a88,this[_0x56e3fc(0x1db)]=_0x41d42b,this[_0x56e3fc(0x2d5)]=_0x547c74,this[_0x56e3fc(0x30e)]=_0x10a44e,this[_0x56e3fc(0x141)]());}['_init'](){const _0x464a2d=_0x38cdda,_0x4464a1=this[_0x464a2d(0x2e1)]['unitId'],_0x2f90a5=this[_0x464a2d(0x16c)];this[_0x464a2d(0xfe)](_0x2b9b2e([this[_0x464a2d(0x1db)]['getCollabCursors$'](_0x4464a1),this[_0x464a2d(0x30e)][_0x464a2d(0x182)]])[_0x464a2d(0x31b)](_0x5244f0(([_0x2d1a94,_0x37165a])=>({'skeleton':_0x2f90a5['getSkeleton'](),'cursors':[..._0x2d1a94[_0x464a2d(0x2e5)]()][_0x464a2d(0x151)](_0x293b43=>({..._0x293b43,'color':this[_0x464a2d(0x30e)][_0x464a2d(0x10f)](_0x293b43[_0x464a2d(0x13f)])}))})))['subscribe'](_0x13fec2=>{const _0x27a504=_0x464a2d;if(this[_0x27a504(0xee)](),_0x13fec2){const {skeleton:_0x13cb23,cursors:_0x1af92f}=_0x13fec2;this[_0x27a504(0x16a)](_0x13cb23,_0x1af92f);}})),this[_0x464a2d(0xe6)](),this[_0x464a2d(0x114)]();}[_0x38cdda(0x16a)](_0x453f86,_0x2fd715){const _0x46a5a2=_0x38cdda,{scene:_0x4eae06,mainComponent:_0x4d76d4}=this[_0x46a5a2(0x2e1)],_0x106df2=_0x2fd715[_0x46a5a2(0x1b2)](_0x5bf167=>new ct(_0x5bf167,_0x4eae06,_0x453f86,_0x4d76d4));this[_0x46a5a2(0x158)]=_0x106df2,this[_0x46a5a2(0xd5)]=_0x2fd715;}['_refreshCollabCursors'](){const _0x5e2fef=_0x38cdda;this[_0x5e2fef(0xee)]();const {scene:_0x166e33,mainComponent:_0x493652}=this[_0x5e2fef(0x2e1)],_0xeec63e=this[_0x5e2fef(0x16c)][_0x5e2fef(0x2a2)](),_0x9f860f=this[_0x5e2fef(0xd5)][_0x5e2fef(0x1b2)](_0x2d3a15=>new ct(_0x2d3a15,_0x166e33,_0xeec63e,_0x493652));this[_0x5e2fef(0x158)]=_0x9f860f;}[_0x38cdda(0xee)](){const _0x18efba=_0x38cdda;this[_0x18efba(0x158)][_0x18efba(0x109)](_0x293c6c=>_0x293c6c['dispose']()),this['_cursorShapes']=[];}['_initCommandExecutedListener'](){const _0x151f7e=_0x38cdda,_0x217230=[_0x90994e['id']];this['disposeWithMe'](this[_0x151f7e(0x2d5)]['onCommandExecuted'](_0x56815b=>{const _0x5b5f37=_0x151f7e;_0x217230[_0x5b5f37(0x286)](_0x56815b['id'])&&_0x56815b[_0x5b5f37(0x2a7)][_0x5b5f37(0x18e)]===this[_0x5b5f37(0x2e1)][_0x5b5f37(0x18e)]&&this[_0x5b5f37(0x274)]();}));}[_0x38cdda(0xe6)](){const _0x514aa4=_0x38cdda;this[_0x514aa4(0xfe)](_0x225d82(this[_0x514aa4(0x2e1)][_0x514aa4(0x28e)][_0x514aa4(0x25b)])['pipe'](_0x103525(_0x475016=>_0x475016['type']===_0x97da41[_0x514aa4(0x194)]),_0x151c08(0x10))[_0x514aa4(0x268)](()=>{const _0x5b5cfa=_0x514aa4;this[_0x5b5cfa(0x274)]();}));}};Fe=Qi([ie(0x1,_0x11edd2(_0x183183)),ie(0x2,_0x11edd2(H)),ie(0x3,_0x30ccef),ie(0x4,_0x11edd2(_0x387df0))],Fe);const qi=0x1,en=1.5;class tn extends _0x490c21{constructor(_0x362d43,_0xe462da){const _0x4c7d7a=_0x38cdda;super(_0x362d43,_0xe462da),_(this,_0x4c7d7a(0x1b7)),_(this,'_hovered',!0x1),_(this,_0x4c7d7a(0xe0)),_(this,'_name',''),_(this,_0x4c7d7a(0x138),_0x4c7d7a(0x26f)),_(this,_0x4c7d7a(0x1b0)),(_0xe462da&&this[_0x4c7d7a(0x106)](_0xe462da),this['onPointerEnter$'][_0x4c7d7a(0x18a)](()=>this[_0x4c7d7a(0x106)]({'hovered':!0x0})),this[_0x4c7d7a(0x2cf)][_0x4c7d7a(0x18a)](()=>this[_0x4c7d7a(0x106)]({'hovered':!0x1})));}[_0x38cdda(0x106)](_0x671d75){const _0x96671b=_0x38cdda;var _0x102a20,_0x10c4b1,_0x21b880,_0x14ba13,_0x5ba059,_0x143fc;this['_color']=(_0x102a20=_0x671d75[_0x96671b(0x13f)])!=null?_0x102a20:this[_0x96671b(0x1b7)],this[_0x96671b(0x2f7)]=(_0x10c4b1=_0x671d75['hovered'])!=null?_0x10c4b1:this['_hovered'],this[_0x96671b(0xe0)]=(_0x21b880=_0x671d75[_0x96671b(0x2f3)])!=null?_0x21b880:this[_0x96671b(0xe0)],this[_0x96671b(0x1f1)]=(_0x14ba13=_0x671d75['name'])!=null?_0x14ba13:this[_0x96671b(0x1f1)],this[_0x96671b(0x138)]=(_0x5ba059=_0x671d75[_0x96671b(0x21b)])!=null?_0x5ba059:this[_0x96671b(0x138)],this[_0x96671b(0x1b0)]=(_0x143fc=_0x671d75[_0x96671b(0x287)])!=null?_0x143fc:this[_0x96671b(0x1b0)],this['transformByState']({'width':_0x671d75[_0x96671b(0x285)],'height':_0x671d75[_0x96671b(0x181)]});}[_0x38cdda(0x281)](_0x30cb6c){const _0x25ce74=_0x38cdda,{row:_0x4c6cea,column:_0x3e7632}=_0x30cb6c;if(_0x4c6cea>=this[_0x25ce74(0xe0)][_0x25ce74(0x2bd)]&&_0x4c6cea<=this[_0x25ce74(0xe0)][_0x25ce74(0x2b7)]&&_0x3e7632>=this[_0x25ce74(0xe0)][_0x25ce74(0x2d7)]&&_0x3e7632<=this[_0x25ce74(0xe0)][_0x25ce74(0xdb)]){this[_0x25ce74(0x106)]({'hovered':!0x0});return;}this[_0x25ce74(0x106)]({'hovered':!0x1});}[_0x38cdda(0x249)](_0x4a7766){return!0x1;}['_draw'](_0x431cba){const _0x182526=_0x38cdda;_0xa348d8[_0x182526(0xea)](_0x431cba,{'width':this['width'],'height':this[_0x182526(0x181)],'strokeWidth':en,'stroke':this['_color'],'evented':!0x1,'fill':this[_0x182526(0x1b0)]}),this[_0x182526(0x2f7)]&&(_0x431cba[_0x182526(0xd9)](),_0x431cba[_0x182526(0xf0)](0x1,0x0,0x0,0x1,this[_0x182526(0x285)],this[_0x182526(0x138)]===_0x182526(0x2a9)?0x0:-Q),ve[_0x182526(0xea)](_0x431cba,{'text':this['_name'],'color':this[_0x182526(0x1b7)]}),_0x431cba['restore']());}}var sn=Object[_0x38cdda(0x1ac)],nn=(_0x4a564f,_0x3a6856,_0x1573b1,_0x28b3a2)=>{const _0x3fab5d=_0x38cdda;for(var _0x363616=_0x28b3a2>0x1?void 0x0:_0x28b3a2?sn(_0x3a6856,_0x1573b1):_0x3a6856,_0x3c91e8=_0x4a564f[_0x3fab5d(0xe4)]-0x1,_0x38cca2;_0x3c91e8>=0x0;_0x3c91e8--)(_0x38cca2=_0x4a564f[_0x3c91e8])&&(_0x363616=_0x38cca2(_0x363616)||_0x363616);return _0x363616;},be=(_0xa9d4ea,_0x2e5fdd)=>(_0x56eb9c,_0x29b0d0)=>_0x2e5fdd(_0x56eb9c,_0x29b0d0,_0xa9d4ea);const rn=0x1389;let ke=class extends _0x3f6cad{constructor(_0x187aec,_0x4ef7e8,_0x56fa49,_0x55061a){const _0x4a5d11=_0x38cdda;super(),_(this,'_cursors',new Set()),_(this,_0x4a5d11(0x209),null),(this['_context']=_0x187aec,this[_0x4a5d11(0x1c7)]=_0x4ef7e8,this[_0x4a5d11(0x1db)]=_0x56fa49,this['_themeService']=_0x55061a,this[_0x4a5d11(0x141)]());}[_0x38cdda(0x141)](){const _0x776acd=_0x38cdda;this[_0x776acd(0x1c7)]['currentSkeleton$'][_0x776acd(0x31b)](_0x4ef6d1(this[_0x776acd(0x1c5)]),_0x4e657c(_0x2073e4=>{const _0x495bfe=_0x776acd;if(_0x2073e4){const _0x3a6abe=_0x2073e4[_0x495bfe(0x265)];return _0x2b9b2e(this[_0x495bfe(0x1db)][_0x495bfe(0x17c)](this[_0x495bfe(0x2e1)]['unitId']),this[_0x495bfe(0x30e)][_0x495bfe(0x182)])['pipe'](_0x5244f0(([_0x49b79f,_0x712b01])=>{const _0x1540e0=new Map();return _0x49b79f['forEach']((_0x49e0d8,_0x26e33a)=>{const _0x3e8a10=_0x215c;if(_0x49e0d8[_0x3e8a10(0x2ca)]===_0x3a6abe){const _0x1be5d9={..._0x49e0d8};_0x1be5d9['color']=this[_0x3e8a10(0x30e)][_0x3e8a10(0x10f)](_0x49e0d8[_0x3e8a10(0x13f)]),_0x1540e0['set'](_0x26e33a,_0x1be5d9);}}),{'skeleton':_0x2073e4,'cursors':_0x1540e0};}));}return _0x2d29f0({'skeleton':null,'cursors':new Map()});}))['subscribe'](({skeleton:_0x437eb4,cursors:_0x3d963b})=>{const _0x463a36=_0x776acd;this[_0x463a36(0xee)](),_0x437eb4&&this['_updateCollabCursors'](_0x437eb4,_0x3d963b);}),this[_0x776acd(0x1c7)][_0x776acd(0x2c7)]['subscribe'](_0x11df69=>{const _0x3d3c69=_0x776acd;if(_0x11df69==null)return;const {skeleton:_0x4f62f7}=_0x11df69,{scene:_0x278910}=this[_0x3d3c69(0x2e1)];_0x278910['onPointerMove$']['subscribeEvent'](_0x899b23(_0x3a7e55=>{const _0x591041=_0x3d3c69;var _0x1bc783,_0x308ffa;const {offsetX:_0x41e184,offsetY:_0x64ec9b}=_0x3a7e55,{x:_0x26a206,y:_0x2e22bc}=_0x278910['getRelativeToViewportCoord'](_0xbab593[_0x591041(0x180)]([_0x41e184,_0x64ec9b])),{scaleX:_0x3d72fa,scaleY:_0x4dfd35}=_0x278910[_0x591041(0x171)](),_0x496858=_0x278910['getViewport'](_0x2234b8['VIEW_MAIN']),_0x22e66b=_0x278910[_0x591041(0x315)](_0xbab593[_0x591041(0x180)]([_0x26a206,_0x2e22bc]),_0x496858),_0x140e3f=_0x4f62f7[_0x591041(0x2ab)](_0x41e184,_0x64ec9b,_0x3d72fa,_0x4dfd35,_0x22e66b);((_0x1bc783=this[_0x591041(0x209)])==null?void 0x0:_0x1bc783[_0x591041(0x2c6)])===_0x140e3f['column']&&((_0x308ffa=this[_0x591041(0x209)])==null?void 0x0:_0x308ffa[_0x591041(0x280)])===_0x140e3f[_0x591041(0x280)]||this[_0x591041(0xd5)][_0x591041(0x109)](_0x534e47=>{_0x534e47['onMouseMove'](_0x140e3f);});},0x64));});}[_0x38cdda(0x16a)](_0x1d38cf,_0x32e447){const _0x1e038c=_0x38cdda;var _0xd04529;const _0x27743c=(_0xd04529=this['_sheetSkeletonManagerService']['getCurrent']())==null?void 0x0:_0xd04529[_0x1e038c(0x200)];if(!_0x27743c)return;const _0x3ab494=this[_0x1e038c(0x1b5)]();if(!_0x3ab494)return;this['_cursors'][_0x1e038c(0x109)](_0x21eb2f=>{const _0x13ffd9=_0x1e038c;_0x21eb2f[_0x13ffd9(0x2fb)]();});const {scene:_0x2ac52f}=_0x3ab494,_0x2cdda9=on(Array[_0x1e038c(0x2b0)](_0x32e447[_0x1e038c(0x2e5)]()))['map'](_0x318b68=>{const _0x436c12=_0x1e038c,{color:_0x50cccf,range:_0x1c466a,name:_0x3bc897,selection:_0x1b2038,sheetID:_0x579903}=_0x318b68,{startColumn:_0x45bd45,startRow:_0x5c0be3,endColumn:_0xbfd3dd,endRow:_0x299468}=_0x1c466a,_0x561617=_0x36ff32(_0x5c0be3,_0x45bd45,_0x2ac52f,_0x27743c),_0x27c191=_0x36ff32(_0x299468,_0xbfd3dd,_0x2ac52f,_0x27743c),{columnHeaderHeightAndMarginTop:_0x1f5cf5}=_0x27743c,{startX:_0x11907c,startY:_0x2eb64b}=_0x561617,{endX:_0x52b2fd,endY:_0x50aa92}=_0x27c191,_0x5a0941=_0x52b2fd-_0x11907c,_0x3d251b=_0x50aa92-_0x2eb64b,_0x285d6e={'labelPosition':_0x2eb64b-_0x1f5cf5>=Q?_0x436c12(0x26f):_0x436c12(0x2a9),'sheetID':_0x579903,'range':_0x1c466a,'color':_0x50cccf,'name':_0x3bc897,'selection':_0x1b2038,'left':_0x11907c,'top':_0x2eb64b,'width':_0x5a0941,'height':_0x3d251b,'evented':!0x1,'zIndex':rn};return new tn(_0x3bc897,_0x285d6e);});_0x2ac52f[_0x1e038c(0x289)](_0x2cdda9,qi),this['_cursors']=new Set(_0x2cdda9);}[_0x38cdda(0xee)](){const _0xd176a5=_0x38cdda;var _0xa9dc0e;(_0xa9dc0e=this[_0xd176a5(0xd5)])==null||_0xa9dc0e[_0xd176a5(0x109)](_0x47f691=>_0x47f691[_0xd176a5(0x16f)]());}['_getSheetObject'](){const _0x2d6162=_0x38cdda;return _0x3eefee(this[_0x2d6162(0x2e1)][_0x2d6162(0x165)],this[_0x2d6162(0x2e1)]);}};ke=nn([be(0x1,_0x11edd2(_0x519004)),be(0x2,_0x11edd2(H)),be(0x3,_0x11edd2(_0x387df0))],ke);function on(_0x14f581){const _0xf09399=_0x38cdda,_0x44fa0d=new Map();return _0x14f581[_0xf09399(0x109)](_0x42fcec=>{const _0x5af3a8=_0xf09399;if(_0x44fa0d[_0x5af3a8(0x2e2)](_0x42fcec[_0x5af3a8(0x2a5)])){const _0x1949a7=_0x44fa0d[_0x5af3a8(0x244)](_0x42fcec[_0x5af3a8(0x2a5)]);_0x1949a7['name']+=',\x20'+_0x42fcec['name'];}else _0x44fa0d[_0x5af3a8(0x1ad)](_0x42fcec[_0x5af3a8(0x2a5)],_0x42fcec);}),Array[_0xf09399(0x2b0)](_0x44fa0d[_0xf09399(0x2e5)]());}var an=Object['getOwnPropertyDescriptor'],cn=(_0xd077d7,_0x57cde2,_0x25b444,_0x78456b)=>{const _0x266d32=_0x38cdda;for(var _0x29f9c2=_0x78456b>0x1?void 0x0:_0x78456b?an(_0x57cde2,_0x25b444):_0x57cde2,_0x514431=_0xd077d7[_0x266d32(0xe4)]-0x1,_0x259946;_0x514431>=0x0;_0x514431--)(_0x259946=_0xd077d7[_0x514431])&&(_0x29f9c2=_0x259946(_0x29f9c2)||_0x29f9c2);return _0x29f9c2;},F=(_0x10ccc9,_0x1c024c)=>(_0xb1f9ac,_0x287e67)=>_0x1c024c(_0xb1f9ac,_0x287e67,_0x10ccc9);let _e=class extends _0x447589{constructor(_0x1152ab,_0x2be4f6,_0x2bd6f4,_0x2d1499,_0x3b9899,_0x5d5295){const _0x25e0f2=_0x38cdda;super(),this[_0x25e0f2(0x2d2)]=_0x1152ab,this[_0x25e0f2(0x196)]=_0x2be4f6,this[_0x25e0f2(0x242)]=_0x2bd6f4,this['_messageService']=_0x2d1499,this['_notificationService']=_0x3b9899,this[_0x25e0f2(0x10a)]=_0x5d5295,this[_0x25e0f2(0x11b)](),this[_0x25e0f2(0x1e0)]();}[_0x38cdda(0x11b)](){const _0x7833a3=_0x38cdda;this['disposeWithMe'](this[_0x7833a3(0x2d2)][_0x7833a3(0x12f)](()=>{const _0x1c7f1e=_0x7833a3;if(this[_0x1c7f1e(0x196)]['saveTaskMap'][_0x1c7f1e(0x2d9)])return this[_0x1c7f1e(0x10a)]['t'](_0x1c7f1e(0x1e4));}));}[_0x38cdda(0x1e0)](){const _0x476ca4=_0x38cdda;this[_0x476ca4(0xfe)](this['_collaborationUIEventService']['event$'][_0x476ca4(0x268)](_0x39f9dc=>{const _0x2890ec=_0x476ca4;_0x39f9dc['id']===_0x354e6a[_0x2890ec(0x134)]&&this[_0x2890ec(0x304)][_0x2890ec(0x197)]({'type':_0x8f3016[_0x2890ec(0x316)],'content':this['_localeService']['t']('collaboration.single-unit.warning')}),_0x39f9dc['id']===_0x354e6a[_0x2890ec(0x313)]&&this[_0x2890ec(0x304)][_0x2890ec(0x197)]({'type':_0x8f3016['Warning'],'content':this[_0x2890ec(0x10a)]['t'](_0x2890ec(0x2b5))}),_0x39f9dc['id']===_0x354e6a['PERMISSION_DENIED']&&this[_0x2890ec(0x107)][_0x2890ec(0x197)]({'title':this[_0x2890ec(0x10a)]['t'](_0x2890ec(0x1f4)),'content':this['_localeService']['t'](_0x2890ec(0x30c)),'type':_0x2890ec(0x12a),'duration':0x0}),_0x39f9dc['id']===_0x354e6a[_0x2890ec(0x251)]&&this['_messageService']['show']({'type':_0x8f3016['Error'],'content':this['_localeService']['t'](_0x2890ec(0x2b5))+'('+_0x39f9dc['data']+')'}),_0x39f9dc['id']===_0x354e6a['JOIN_ROOM_FAILED']&&this['_messageService'][_0x2890ec(0x197)]({'type':_0x8f3016[_0x2890ec(0x316)],'content':this[_0x2890ec(0x10a)]['t'](_0x39f9dc['data']||'')}),_0x39f9dc['id']===_0x354e6a[_0x2890ec(0xff)]&&this[_0x2890ec(0x304)][_0x2890ec(0x197)]({'type':_0x8f3016[_0x2890ec(0x316)],'content':this[_0x2890ec(0x10a)]['t'](_0x2890ec(0x11f))}),_0x39f9dc['id']===_0x354e6a['SOCKET_FAILED']&&this[_0x2890ec(0x304)][_0x2890ec(0x197)]({'type':_0x8f3016[_0x2890ec(0x248)],'content':this[_0x2890ec(0x10a)]['t']('session.connection-failed')}),_0x39f9dc['id']===_0x354e6a['SUBMIT_CHANGESET_TIMEOUT']&&this['_messageService'][_0x2890ec(0x197)]({'type':_0x8f3016[_0x2890ec(0x248)],'content':this['_localeService']['t'](_0x2890ec(0x277))});}));}};_e=cn([F(0x0,_0x1b49ec),F(0x1,_0x4e2cad),F(0x2,_0x11edd2(_0x464162)),F(0x3,_0x19a1ba),F(0x4,_0x19ecf0),F(0x5,_0x11edd2(_0x134929))],_e);var _n=Object[_0x38cdda(0x1ac)],ln=(_0x52f301,_0xa2ac74,_0x45a775,_0x130f8e)=>{const _0x9b06fb=_0x38cdda;for(var _0x2ce0a3=_0x130f8e>0x1?void 0x0:_0x130f8e?_n(_0xa2ac74,_0x45a775):_0xa2ac74,_0x5a2a77=_0x52f301[_0x9b06fb(0xe4)]-0x1,_0x2160c7;_0x5a2a77>=0x0;_0x5a2a77--)(_0x2160c7=_0x52f301[_0x5a2a77])&&(_0x2ce0a3=_0x2160c7(_0x2ce0a3)||_0x2ce0a3);return _0x2ce0a3;},ne=(_0x4dd94d,_0xc0c9df)=>(_0x1dbb12,_0xb4356d)=>_0xc0c9df(_0x1dbb12,_0xb4356d,_0x4dd94d);let le=class extends _0x447589{constructor(_0x49810c,_0x34f7b7,_0x3b7104,_0x176a10){const _0xc9fa2b=_0x38cdda;super(),_(this,'_memberID'),(this['_injector']=_0x49810c,this['_httpService']=_0x34f7b7,this[_0xc9fa2b(0x193)]=_0x3b7104,this[_0xc9fa2b(0xd6)]=_0x176a10,this[_0xc9fa2b(0x141)]());}[_0x38cdda(0x141)](){const _0x275bb5=_0x38cdda;this[_0x275bb5(0x1a2)](),this[_0x275bb5(0x267)](),this[_0x275bb5(0x162)](),this[_0x275bb5(0x213)]();}[_0x38cdda(0x213)](){const _0x36f4a=_0x38cdda;this['disposeWithMe'](this[_0x36f4a(0xd6)][_0x36f4a(0x207)]['subscribe'](_0x5ca4d5=>{const _0x2e6379=_0x36f4a;this[_0x2e6379(0x2b6)]=_0x5ca4d5==null?void 0x0:_0x5ca4d5['memberID'];}));}[_0x38cdda(0x1a2)](){const _0x2189c6=_0x38cdda,_0x2c5efd=_0x3ec450=>{const _0x4633ea=_0x215c;var _0x31adda;this[_0x4633ea(0xd3)](_0x4633ea(0x12a),_0x4633ea(0x28d)+_0x3ec450[_0x4633ea(0xe9)]+_0x4633ea(0x270)+_0x3ec450[_0x4633ea(0x2ea)]+':'+_0x3ec450[_0x4633ea(0x14f)]+':'+_0x3ec450['colno']+'\x0a'+(((_0x31adda=_0x3ec450[_0x4633ea(0x12a)])==null?void 0x0:_0x31adda[_0x4633ea(0x2f4)])||''));};window[_0x2189c6(0xde)](_0x2189c6(0x12a),_0x2c5efd),this[_0x2189c6(0xfe)](()=>{const _0x3a0e91=_0x2189c6;window[_0x3a0e91(0x1c8)](_0x3a0e91(0x12a),_0x2c5efd);});}[_0x38cdda(0x267)](){const _0x3f0235=_0x38cdda,_0x50d55c=_0x2d3daa=>{const _0x2780d5=_0x215c;this[_0x2780d5(0xd3)](_0x2780d5(0x12a),'[Unhandled\x20Rejection]:\x20'+_0x2d3daa[_0x2780d5(0x2c4)]);};window[_0x3f0235(0xde)]('unhandledrejection',_0x50d55c),this[_0x3f0235(0xfe)](()=>{const _0x4f6ce0=_0x3f0235;window['removeEventListener'](_0x4f6ce0(0x191),_0x50d55c);});}[_0x38cdda(0x162)](){const _0x1b361c=_0x38cdda,_0x536ab2=this[_0x1b361c(0x193)]['error'][_0x1b361c(0x166)](this['_logService']);this['_logService'][_0x1b361c(0x12a)]=(..._0x301a1f)=>{const _0x2a4b81=_0x1b361c,_0x2e1b8a=_0x301a1f[_0x2a4b81(0x1b2)](_0x48a219=>_0x48a219 instanceof Error?_0x48a219[_0x2a4b81(0xe9)]+'\x0a'+_0x48a219[_0x2a4b81(0x2f4)]:String(_0x48a219))[_0x2a4b81(0x2ce)]('\x20');this[_0x2a4b81(0xd3)](_0x2a4b81(0x12a),_0x2a4b81(0x261)+_0x2e1b8a),_0x536ab2(..._0x301a1f);},this[_0x1b361c(0xfe)](()=>{const _0x2ca9c6=_0x1b361c;this[_0x2ca9c6(0x193)]['error']=_0x536ab2;});}[_0x38cdda(0xd3)](_0x22f37d,_0x11a7ea){const _0x4ef026=_0x38cdda;try{const _0x5a51ba={'userId':this[_0x4ef026(0x2b6)],'logLabel':_0x22f37d,'content':_0x11a7ea};this[_0x4ef026(0x1ef)][_0x4ef026(0x306)](_0x4ef026(0x20c),{'body':_0x5a51ba})[_0x4ef026(0x11c)](()=>{});}catch{}}};le=ln([ne(0x0,_0x11edd2(_0x1d6fba)),ne(0x1,_0x11edd2(_0x1718b4)),ne(0x2,_0x3b2794),ne(0x3,_0x11edd2(_0x4496ea))],le);const hn=_0x38cdda(0x293),_t={};var un=Object[_0x38cdda(0x1ac)],dn=(_0x461756,_0x33bf69,_0x31ca07,_0x50d69e)=>{for(var _0x33d23b=_0x50d69e>0x1?void 0x0:_0x50d69e?un(_0x33bf69,_0x31ca07):_0x33bf69,_0x330eb9=_0x461756['length']-0x1,_0x487448;_0x330eb9>=0x0;_0x330eb9--)(_0x487448=_0x461756[_0x330eb9])&&(_0x33d23b=_0x487448(_0x33d23b)||_0x33d23b);return _0x33d23b;},lt=(_0x1aee93,_0x1a4eb3)=>(_0x76c41c,_0x1addb7)=>_0x1a4eb3(_0x76c41c,_0x1addb7,_0x1aee93);let he=class{constructor(_0x28b49d,_0x31c7af){const _0x201477=_0x38cdda;this[_0x201477(0x27d)]=_0x28b49d,this['_renderManagerService']=_0x31c7af;}[_0x38cdda(0x144)](_0x41a679){const _0x2f3855=_0x38cdda;this[_0x2f3855(0x2ff)](_0x41a679),this['_transformPreviousActiveRange'](_0x41a679);}[_0x38cdda(0x2c1)](_0x1f3719){const _0x20d125=_0x38cdda,{unitID:_0x2a91b8}=_0x1f3719,_0x4ae231=this[_0x20d125(0x1ab)]['getRenderById'](_0x2a91b8)['with'](_0x26f90f),{redoCache:_0x20a8bc}=_0x4ae231['getUndoRedoMutationParamsCache']();if(_0x20a8bc[_0x20d125(0xe4)]===0x0)return _0x1f3719;let _0x274ae7=_0x5884ee[_0x20d125(0x13c)](_0x1f3719['mutations'][0x0]);for(let _0x31603f=0x0;_0x31603f<_0x20a8bc[_0x20d125(0xe4)];_0x31603f++){const _0x3e6a63={'id':_0x20d125(0x2bc),'params':{..._0x20a8bc[_0x31603f]}},_0x39b69d=this['_transformService']['transformMutation'](_0x274ae7,_0x3e6a63,!0x1);if(_0x2b6a5f(_0x39b69d))throw _0x39b69d[_0x20d125(0x12a)];_0x274ae7=_0x39b69d['m1Prime'];}return{..._0x5884ee[_0x20d125(0x13c)](_0x1f3719),'mutations':[_0x274ae7]};}[_0x38cdda(0x2ff)](_0x75245c){const _0x2545d5=_0x38cdda,{unitID:_0x4c31f9}=_0x75245c,_0x506d6a=this['_renderManagerService'][_0x2545d5(0x1b3)](_0x4c31f9)[_0x2545d5(0x26d)](_0x26f90f),{undoCache:_0x1e70f9,redoCache:_0x3e51e9}=_0x506d6a[_0x2545d5(0x100)]();if(_0x1e70f9[_0x2545d5(0xe4)]===0x0||_0x3e51e9[_0x2545d5(0xe4)]===0x0)return;const _0x373a52=[],_0x22ef8f=[];let _0x97bd0a=_0x5884ee[_0x2545d5(0x13c)](_0x75245c[_0x2545d5(0x1f2)][0x0]),_0x51b2ff=_0x5884ee[_0x2545d5(0x13c)](_0x75245c['mutations'][0x0]);for(let _0x27b9bd=_0x1e70f9[_0x2545d5(0xe4)]-0x1;_0x27b9bd>=0x0;_0x27b9bd--){const _0x435d7c={'id':_0x2545d5(0x2bc),'params':{..._0x1e70f9[_0x27b9bd]}},_0x56a493={'id':_0x2545d5(0x2bc),'params':{..._0x3e51e9[_0x27b9bd]}},_0x5c28a9=this[_0x2545d5(0x27d)][_0x2545d5(0x1d1)](_0x97bd0a,_0x435d7c,!0x1),_0x10ce7a=this['_transformService'][_0x2545d5(0x1d1)](_0x51b2ff,_0x56a493,!0x1);if(_0x2b6a5f(_0x5c28a9))throw _0x5c28a9['error'];if(_0x2b6a5f(_0x10ce7a))throw _0x10ce7a['error'];_0x373a52[_0x2545d5(0x220)](_0x5c28a9['m2Prime'][_0x2545d5(0x2a7)]),_0x22ef8f[_0x2545d5(0x220)](_0x10ce7a[_0x2545d5(0x1c6)][_0x2545d5(0x2a7)]),_0x97bd0a=_0x5c28a9[_0x2545d5(0x2a3)],_0x51b2ff=_0x10ce7a[_0x2545d5(0x2a3)];}_0x506d6a[_0x2545d5(0x2c9)]({'undoCache':_0x373a52,'redoCache':_0x22ef8f});}[_0x38cdda(0x20b)](_0x71f4fe){const _0x5f35d1=_0x38cdda,{unitID:_0x4129cd}=_0x71f4fe,_0x3de5c6=this[_0x5f35d1(0x1ab)]['getRenderById'](_0x4129cd)['with'](_0x26f90f),_0x21091c=_0x3de5c6['getActiveRange']();if(_0x21091c==null)return;const _0x542b52=[{'id':_0x5f35d1(0x2bc),'params':{'unitId':_0x71f4fe[_0x5f35d1(0x14a)],'actions':null,'textRanges':[_0x21091c]}}],_0x5dd11d=this[_0x5f35d1(0x27d)][_0x5f35d1(0x174)](_0x71f4fe,_0x542b52);if(!_0x1d4010(_0x5dd11d))throw _0x5dd11d[_0x5f35d1(0x12a)];const _0x427c53=_0x5dd11d['m2Prime'][0x0]['params'][_0x5f35d1(0x117)];Array['isArray'](_0x427c53)&&_0x427c53['length']&&_0x3de5c6[_0x5f35d1(0x103)](_0x427c53[0x0]);}};he=dn([lt(0x0,_0x41e619),lt(0x1,_0x294de9)],he);var Sn=Object['getOwnPropertyDescriptor'],In=(_0x1aae8e,_0x314860,_0x2f91e2,_0x18763b)=>{const _0xe75e95=_0x38cdda;for(var _0x5dd6e0=_0x18763b>0x1?void 0x0:_0x18763b?Sn(_0x314860,_0x2f91e2):_0x314860,_0x581af0=_0x1aae8e[_0xe75e95(0xe4)]-0x1,_0x26873d;_0x581af0>=0x0;_0x581af0--)(_0x26873d=_0x1aae8e[_0x581af0])&&(_0x5dd6e0=_0x26873d(_0x5dd6e0)||_0x5dd6e0);return _0x5dd6e0;},Le=(_0x42d0f5,_0x4947c1)=>(_0x4b469d,_0x4c868b)=>_0x4947c1(_0x4b469d,_0x4c868b,_0x42d0f5);let ue=class{constructor(_0x489935,_0x14a4d7,_0x51489b){const _0x36fbf2=_0x38cdda;this[_0x36fbf2(0x203)]=_0x489935,this[_0x36fbf2(0x27d)]=_0x14a4d7,this['_docStateChangeManagerService']=_0x51489b;}[_0x38cdda(0x1c3)](_0x2aadc0){const _0x5afcd1=_0x38cdda;this[_0x5afcd1(0x1f7)](_0x2aadc0);}[_0x38cdda(0x2c1)](_0x1133ce){const _0x5948d2=_0x38cdda,{unitID:_0x2545b6}=_0x1133ce,{collaboration:_0x23bc48}=this[_0x5948d2(0x1f9)]['getStateCache'](_0x2545b6);if(_0x23bc48[_0x5948d2(0xe4)]===0x0)return _0x1133ce;let _0x59cb0a=_0x5884ee[_0x5948d2(0x13c)](_0x1133ce['mutations'][0x0]);for(let _0xeabf73=0x0;_0xeabf73<_0x23bc48[_0x5948d2(0xe4)];_0xeabf73++){const _0x9ff040={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x23bc48[_0xeabf73][_0x5948d2(0x18e)],..._0x23bc48[_0xeabf73][_0x5948d2(0x2cc)]}},_0x368a7b=this[_0x5948d2(0x27d)]['transformMutation'](_0x59cb0a,_0x9ff040,!0x1);if(_0x2b6a5f(_0x368a7b))throw _0x368a7b[_0x5948d2(0x12a)];_0x59cb0a=_0x368a7b['m1Prime'];}return{..._0x5884ee['deepClone'](_0x1133ce),'mutations':[_0x59cb0a]};}[_0x38cdda(0x1f7)](_0x505ce){const _0x1694c5=_0x38cdda,{unitID:_0x3da7fe}=_0x505ce,{history:_0x30f8d1,collaboration:_0x3cd312}=this['_docStateChangeManagerService'][_0x1694c5(0x28b)](_0x3da7fe);if(_0x30f8d1[_0x1694c5(0xe4)]===0x0&&_0x3cd312['length']===0x0)return;const _0x3fa2d8=[],_0x5938ef=[];let _0x1bab51=_0x5884ee[_0x1694c5(0x13c)](_0x505ce[_0x1694c5(0x1f2)][0x0]),_0x97e614=_0x5884ee[_0x1694c5(0x13c)](_0x505ce[_0x1694c5(0x1f2)][0x0]);for(let _0x3d6a99=_0x30f8d1[_0x1694c5(0xe4)]-0x1;_0x3d6a99>=0x0;_0x3d6a99--){const _0x5d1eeb={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x30f8d1[_0x3d6a99][_0x1694c5(0x18e)],..._0x30f8d1[_0x3d6a99][_0x1694c5(0x155)]}},_0x53a263={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x30f8d1[_0x3d6a99][_0x1694c5(0x18e)],..._0x30f8d1[_0x3d6a99][_0x1694c5(0x2cc)]}},_0x4fca18=this[_0x1694c5(0x27d)]['transformMutation'](_0x1bab51,_0x5d1eeb,!0x1),_0x46e58c=this[_0x1694c5(0x27d)][_0x1694c5(0x1d1)](_0x97e614,_0x53a263,!0x1);if(_0x2b6a5f(_0x4fca18))throw _0x4fca18[_0x1694c5(0x12a)];if(_0x2b6a5f(_0x46e58c))throw _0x46e58c['error'];_0x3fa2d8['unshift']({..._0x30f8d1[_0x3d6a99],'undoState':_0x4fca18[_0x1694c5(0x1c6)][_0x1694c5(0x2a7)],'redoState':_0x46e58c[_0x1694c5(0x1c6)]['params']}),_0x1bab51=_0x4fca18['m1Prime'],_0x97e614=_0x46e58c[_0x1694c5(0x2a3)];}_0x1bab51=_0x5884ee[_0x1694c5(0x13c)](_0x505ce[_0x1694c5(0x1f2)][0x0]),_0x97e614=_0x5884ee[_0x1694c5(0x13c)](_0x505ce['mutations'][0x0]);for(let _0x45d887=_0x3cd312['length']-0x1;_0x45d887>=0x0;_0x45d887--){const _0x2a2b21={'id':_0x1694c5(0x2bc),'params':{'unitId':_0x3cd312[_0x45d887][_0x1694c5(0x18e)],..._0x3cd312[_0x45d887][_0x1694c5(0x155)]}},_0x5ab28a={'id':_0x1694c5(0x2bc),'params':{'unitId':_0x3cd312[_0x45d887][_0x1694c5(0x18e)],..._0x3cd312[_0x45d887]['redoState']}},_0x3fd2f2=this[_0x1694c5(0x27d)]['transformMutation'](_0x1bab51,_0x2a2b21,!0x1),_0x480f95=this[_0x1694c5(0x27d)][_0x1694c5(0x1d1)](_0x97e614,_0x5ab28a,!0x1);if(_0x2b6a5f(_0x3fd2f2))throw _0x3fd2f2[_0x1694c5(0x12a)];if(_0x2b6a5f(_0x480f95))throw _0x480f95['error'];_0x5938ef['unshift']({..._0x3cd312[_0x45d887],'undoState':_0x3fd2f2['m2Prime'][_0x1694c5(0x2a7)],'redoState':_0x480f95[_0x1694c5(0x1c6)]['params']}),_0x1bab51=_0x3fd2f2[_0x1694c5(0x2a3)],_0x97e614=_0x480f95[_0x1694c5(0x2a3)];}this[_0x1694c5(0x1f9)][_0x1694c5(0xeb)](_0x3da7fe,{'history':_0x3fa2d8,'collaboration':_0x5938ef});}};ue=In([Le(0x0,_0x11edd2(_0x1d6fba)),Le(0x1,_0x41e619),Le(0x2,_0x11edd2(_0x4a4247))],ue);var mn=Object[_0x38cdda(0x1ac)],fn=(_0x2f7c0d,_0x4e3e53,_0x10b1cd,_0x229113)=>{const _0x547688=_0x38cdda;for(var _0x5afaa1=_0x229113>0x1?void 0x0:_0x229113?mn(_0x4e3e53,_0x10b1cd):_0x4e3e53,_0x1817ae=_0x2f7c0d[_0x547688(0xe4)]-0x1,_0x5e05b2;_0x1817ae>=0x0;_0x1817ae--)(_0x5e05b2=_0x2f7c0d[_0x1817ae])&&(_0x5afaa1=_0x5e05b2(_0x5afaa1)||_0x5afaa1);return _0x5afaa1;},ht=(_0x508ee1,_0x2ddf94)=>(_0x3f7f26,_0x5c4a1a)=>_0x2ddf94(_0x3f7f26,_0x5c4a1a,_0x508ee1);let de=class{constructor(_0x27bd1e,_0x331016){const _0x243c6e=_0x38cdda;this['_injector']=_0x27bd1e,this[_0x243c6e(0x27d)]=_0x331016;}[_0x38cdda(0x184)](_0x58b631){const _0x5104f6=_0x38cdda;var _0xb7636f;const _0x5c5edf=this['_injector'][_0x5104f6(0x244)](_0x186872),_0x237e83=(_0xb7636f=_0x5c5edf[_0x5104f6(0x2dd)]())!=null?_0xb7636f:[];if(_0x237e83[_0x5104f6(0xe4)]===0x0)return;const _0x49d39f=_0x58b631['unitID'],_0xe03071=[{'id':_0x5104f6(0x2bc),'params':{'unitId':_0x49d39f,'actions':null,'textRanges':_0x237e83}}],_0x4d92c3=this[_0x5104f6(0x27d)][_0x5104f6(0x174)](_0x58b631,_0xe03071);if(!_0x1d4010(_0x4d92c3))throw _0x4d92c3['error'];const _0x231452=_0x4d92c3[_0x5104f6(0x1c6)][0x0][_0x5104f6(0x2a7)][_0x5104f6(0x117)];Array[_0x5104f6(0x2c5)](_0x231452)&&_0x231452[_0x5104f6(0xe4)]&&_0x5c5edf[_0x5104f6(0x1a6)](_0x231452,{'unitId':_0x49d39f,'subUnitId':_0x49d39f},!0x1);}};de=fn([ht(0x0,_0x11edd2(_0x1d6fba)),ht(0x1,_0x41e619)],de);var gn=Object['getOwnPropertyDescriptor'],En=(_0x31221e,_0x4d6f38,_0x4c4574,_0x12cf72)=>{for(var _0x24f558=_0x12cf72>0x1?void 0x0:_0x12cf72?gn(_0x4d6f38,_0x4c4574):_0x4d6f38,_0x220da2=_0x31221e['length']-0x1,_0x4c31e1;_0x220da2>=0x0;_0x220da2--)(_0x4c31e1=_0x31221e[_0x220da2])&&(_0x24f558=_0x4c31e1(_0x24f558)||_0x24f558);return _0x24f558;},U=(_0x21837c,_0x3f0396)=>(_0xdde7ee,_0x11f654)=>_0x3f0396(_0xdde7ee,_0x11f654,_0x21837c);let Se=class extends _0x447589{constructor(_0x8e46ea,_0x7a2316,_0x5ccc17,_0x4ed953,_0x123ed6,_0x296c60,_0x44f534,_0x321d37){const _0x125886=_0x38cdda;super(),_(this,_0x125886(0x2ac),new _0x4f0f13(_0x5566b4['NOT_COLLAB'])),(this[_0x125886(0x1f9)]=_0x8e46ea,this[_0x125886(0x11d)]=_0x7a2316,this[_0x125886(0x2d8)]=_0x5ccc17,this[_0x125886(0x27c)]=_0x4ed953,this[_0x125886(0x2e9)]=_0x123ed6,this['_docSyncEditingCollabCursorService']=_0x296c60,this['_messageService']=_0x44f534,this['_localeService']=_0x321d37,this[_0x125886(0x1da)]());}['_initEntityListener'](){const _0x2e4b4d=_0x38cdda;this[_0x2e4b4d(0xfe)](this[_0x2e4b4d(0x11d)][_0x2e4b4d(0x298)]['subscribe'](_0x347813=>{const _0x35c13f=_0x2e4b4d,_0x115de6=this[_0x35c13f(0x1f9)][_0x35c13f(0x257)][_0x35c13f(0x268)](_0x8fb4a8=>{const _0x34bdd8=_0x35c13f;if(_0x8fb4a8==null)return;const {unitId:_0x52d12d,redoState:_0x57226e,commandId:_0x44e9bc}=_0x8fb4a8;if(_0x52d12d!==_0x347813[_0x34bdd8(0x14a)])return;const _0x350e98={'id':_0x44e9bc,'type':_0x4f786a[_0x34bdd8(0x29b)],'params':{'unitId':_0x52d12d,'actions':_0x57226e[_0x34bdd8(0x20e)],'textRanges':null}};_0x347813[_0x34bdd8(0x245)](_0x350e98);});if(_0x347813['disposeWithMe'](_0x115de6),_0x347813 instanceof _0x55b7eb){const _0x22ced1={'onTransformIME':_0x48c064=>this[_0x35c13f(0x2d8)][_0x35c13f(0x144)](_0x48c064),'onTransformState':_0x300be5=>this[_0x35c13f(0x27c)][_0x35c13f(0x1c3)](_0x300be5),'onTransformSelections':_0x4c25fe=>this[_0x35c13f(0x2e9)][_0x35c13f(0x184)](_0x4c25fe),'onSyncEditingCollabCursor':_0x11c2ed=>this[_0x35c13f(0x1d4)][_0x35c13f(0x16b)](_0x11c2ed),'onTransformRemoteChangesetByIMECache':_0x3442a6=>this['_docTransformIMECacheService'][_0x35c13f(0x2c1)](_0x3442a6),'onTransformRemoteChangesetByStateCache':_0x10ce2d=>this['_docTransformStateCacheService']['transformRemoteChangeset'](_0x10ce2d)};_0x347813[_0x35c13f(0x2aa)](_0x22ced1);}}));}};Se=En([U(0x0,_0x11edd2(_0x4a4247)),U(0x1,_0x11edd2(_0x489919)),U(0x2,_0x11edd2(he)),U(0x3,_0x11edd2(ue)),U(0x4,_0x11edd2(de)),U(0x5,_0x11edd2(ze)),U(0x6,_0x19a1ba),U(0x7,_0x11edd2(_0x134929))],Se);var Z=(_0x266130=>(_0x266130[_0x266130['UNDEFINED']=0x0]=_0x38cdda(0x215),_0x266130[_0x266130['OK']=0x1]='OK',_0x266130[_0x266130[_0x38cdda(0x222)]=0x2]=_0x38cdda(0x222),_0x266130[_0x266130[_0x38cdda(0x21f)]=0x3]=_0x38cdda(0x21f),_0x266130[_0x266130[_0x38cdda(0x176)]=0x4]=_0x38cdda(0x176),_0x266130[_0x266130[_0x38cdda(0x263)]=0x5]=_0x38cdda(0x263),_0x266130[_0x266130[_0x38cdda(0x2fa)]=0x6]=_0x38cdda(0x2fa),_0x266130[_0x266130['INVALID_ARGUMENT']=0x7]='INVALID_ARGUMENT',_0x266130[_0x266130[_0x38cdda(0x23d)]=0x8]=_0x38cdda(0x23d),_0x266130[_0x266130[_0x38cdda(0x317)]=0x9]=_0x38cdda(0x317),_0x266130[_0x266130['LOGIN_FAILED']=0xa]='LOGIN_FAILED',_0x266130[_0x266130[_0x38cdda(0x2fd)]=0xb]='MOBILE_VERIFY_CODE_MISMATCH',_0x266130[_0x266130[_0x38cdda(0x199)]=0xc]=_0x38cdda(0x199),_0x266130[_0x266130['EMAIL_VERIFY_CODE_MISMATCH']=0xd]=_0x38cdda(0x2a0),_0x266130[_0x266130['EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED']=0xe]=_0x38cdda(0x1ed),_0x266130[_0x266130[_0x38cdda(0x2e3)]=0xf]=_0x38cdda(0x2e3),_0x266130[_0x266130[_0x38cdda(0x2a8)]=0x10]=_0x38cdda(0x2a8),_0x266130[_0x266130[_0x38cdda(0x1ce)]=0x64]=_0x38cdda(0x1ce),_0x266130[_0x266130[_0x38cdda(0x101)]=0x65]=_0x38cdda(0x101),_0x266130[_0x266130[_0x38cdda(0x183)]=0xc9]=_0x38cdda(0x183),_0x266130[_0x266130[_0x38cdda(0x262)]=0xca]='USER_IS_ANONYMOUS',_0x266130[_0x266130['CHANGESET_REVISION_CONFILICT']=0x1389]=_0x38cdda(0x1e2),_0x266130[_0x266130['SNAPSHOT_INVALID_SNAPSHOT']=0x1771]=_0x38cdda(0x318),_0x266130[_0x266130[_0x38cdda(0x23b)]=0x1772]=_0x38cdda(0x23b),_0x266130[_0x266130['ENSURE_SNAPSHOT_EXECUTION']=0x1773]=_0x38cdda(0x206),_0x266130[_0x266130['APPLY_REJECT']=0x1b59]=_0x38cdda(0x115),_0x266130[_0x266130[_0x38cdda(0x284)]=0x1b5a]=_0x38cdda(0x284),_0x266130[_0x266130[_0x38cdda(0x192)]=0x1b5b]=_0x38cdda(0x192),_0x266130[_0x266130['APPLY_PERMISSION_DENIED']=0x1b5c]=_0x38cdda(0x27a),_0x266130[_0x266130[_0x38cdda(0x105)]=0x1b5d]=_0x38cdda(0x105),_0x266130[_0x266130[_0x38cdda(0x239)]=0x1f41]=_0x38cdda(0x239),_0x266130[_0x266130[_0x38cdda(0x300)]=0x2329]=_0x38cdda(0x300),_0x266130[_0x266130[_0x38cdda(0x1dd)]=0x232a]='LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED',_0x266130[_0x266130[_0x38cdda(0x221)]=0x232b]=_0x38cdda(0x221),_0x266130[_0x266130[_0x38cdda(0x307)]=0x232c]='LICENSE_EXPORT_SIZE_EXCEEDED',_0x266130[_0x266130[_0x38cdda(0x2ec)]=0x232d]=_0x38cdda(0x2ec),_0x266130[_0x266130[_0x38cdda(0x1be)]=0x2711]=_0x38cdda(0x1be),_0x266130[_0x266130[_0x38cdda(0x1a8)]=0x2712]=_0x38cdda(0x1a8),_0x266130[_0x266130[_0x38cdda(0x167)]=0x2713]=_0x38cdda(0x167),_0x266130[_0x266130['YUUMI_SUBSCRIPTION_NOT_FOUND']=0x2714]=_0x38cdda(0x208),_0x266130[_0x266130[_0x38cdda(0x121)]=0x271a]=_0x38cdda(0x121),_0x266130[_0x266130[_0x38cdda(0x294)]=0x271b]=_0x38cdda(0x294),_0x266130[_0x266130[_0x38cdda(0x2f8)]=0x271c]=_0x38cdda(0x2f8),_0x266130[_0x266130[_0x38cdda(0x1b8)]=0x271d]=_0x38cdda(0x1b8),_0x266130[_0x266130[_0x38cdda(0x308)]=0x271e]=_0x38cdda(0x308),_0x266130[_0x266130[_0x38cdda(0x2d6)]=0x271f]=_0x38cdda(0x2d6),_0x266130[_0x266130[_0x38cdda(0x27e)]=0x2720]=_0x38cdda(0x27e),_0x266130[_0x266130[_0x38cdda(0x31d)]=0x2af9]='PY_RUNTIME_SCRIPT_ERROR',_0x266130[_0x266130['INVITE_CODE_HAS_BEEN_UES']=0x2ee1]=_0x38cdda(0x288),_0x266130[_0x266130[_0x38cdda(0x234)]=0x2ee2]='INVALID_INVITE_CODE',_0x266130[_0x266130['INVITE_CODE_REQUIRED']=0x2ee3]=_0x38cdda(0x2ba),_0x266130[_0x266130[_0x38cdda(0x202)]=0x2ee4]='USER_NOT_INVITED_CODE',_0x266130[_0x266130[_0x38cdda(0x1cb)]=0x2ee5]=_0x38cdda(0x1cb),_0x266130[_0x266130[_0x38cdda(0xe3)]=0x32c9]='WECHAT_HAS_BEEN_BOUND',_0x266130[_0x266130[_0x38cdda(0xdd)]=0x32ca]=_0x38cdda(0xdd),_0x266130[_0x266130['EMAIL_HAS_BEEN_BOUND']=0x32cb]='EMAIL_HAS_BEEN_BOUND',_0x266130[_0x266130[_0x38cdda(0xf2)]=0x36b1]='ENTITLE_CAN_NOT_BUY_LOWER_OTP',_0x266130[_0x266130[_0x38cdda(0x309)]=0x36b2]=_0x38cdda(0x309),_0x266130[_0x266130[_0x38cdda(0x2f0)]=0x36b3]=_0x38cdda(0x2f0),_0x266130[_0x266130[_0x38cdda(0x1ba)]=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0x266130[_0x266130['ENTITLE_INVALID_COUPON_CODE']=0x36b5]=_0x38cdda(0x26b),_0x266130[_0x266130[_0x38cdda(0x148)]=0x36b6]=_0x38cdda(0x148),_0x266130[_0x266130[_0x38cdda(0x22d)]=0x36b7]='ENTITLE_COUPON_USED_UP',_0x266130[_0x266130[_0x38cdda(0x24f)]=0x36b8]=_0x38cdda(0x24f),_0x266130[_0x266130[_0x38cdda(0x253)]=0x3715]=_0x38cdda(0x253),_0x266130[_0x266130[_0x38cdda(0x217)]=0x3716]=_0x38cdda(0x217),_0x266130[_0x266130[_0x38cdda(0x2f1)]=0x3717]=_0x38cdda(0x2f1),_0x266130[_0x266130[_0x38cdda(0x17a)]=0x37dd]='ENTITLE_NEED_BILLING_ADDRESS',_0x266130[_0x266130['REDEMPTION_INVALID_CODE']=0x3a99]=_0x38cdda(0xf5),_0x266130[_0x266130[_0x38cdda(0x12e)]=0x3a9a]=_0x38cdda(0x12e),_0x266130[_0x266130['REDEMPTION_CODE_FULLY_REDEEMED']=0x3a9b]=_0x38cdda(0x2f6),_0x266130[_0x266130[_0x38cdda(0x128)]=0x3a9c]=_0x38cdda(0x128),_0x266130[_0x266130['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x38cdda(0x18b),_0x266130[_0x266130[_0x38cdda(0x1b6)]=0x3a9e]=_0x38cdda(0x1b6),_0x266130[_0x266130[_0x38cdda(0x2af)]=0x3a9f]=_0x38cdda(0x2af),_0x266130[_0x266130[_0x38cdda(0x188)]=0x3e81]=_0x38cdda(0x188),_0x266130[_0x266130['UNRECOGNIZED']=-0x1]=_0x38cdda(0x1ea),_0x266130))(Z||{});function vn(_0xf278ac){const _0x4c0ce0=_0x38cdda;var _0x150d8a,_0x45d7e9;const _0x28354d=(_0x150d8a=_0xf278ac[_0x4c0ce0(0x26a)])==null?void 0x0:_0x150d8a[_0x4c0ce0(0x30f)],_0x1d6739=((_0x45d7e9=_0xf278ac[_0x4c0ce0(0x26a)])==null?void 0x0:_0x45d7e9[_0x4c0ce0(0x310)])||0x0;return _0x28354d===_0x303b82[_0x4c0ce0(0x30b)]&&_0x1d6739>0x0;}function pn(_0x58170d){const _0x1b4b93=_0x38cdda;return _0x58170d[_0x1b4b93(0x227)]===_0x13dfd6[_0x1b4b93(0x1a5)];}var On=Object[_0x38cdda(0x1ac)],Tn=(_0x386a76,_0x4d6097,_0x5ea9cb,_0x4571cd)=>{const _0x12d93c=_0x38cdda;for(var _0x3b9b60=_0x4571cd>0x1?void 0x0:_0x4571cd?On(_0x4d6097,_0x5ea9cb):_0x4d6097,_0x367651=_0x386a76[_0x12d93c(0xe4)]-0x1,_0x323c67;_0x367651>=0x0;_0x367651--)(_0x323c67=_0x386a76[_0x367651])&&(_0x3b9b60=_0x323c67(_0x3b9b60)||_0x3b9b60);return _0x3b9b60;},P=(_0x48cc0d,_0xdb7bf9)=>(_0x5343c1,_0x1beb51)=>_0xdb7bf9(_0x5343c1,_0x1beb51,_0x48cc0d);const Cn=_0x38cdda(0x2f9),Rn='/universer-api/license/formula/limit/start',Dn=_0x38cdda(0x1df);let Ie=class extends _0x447589{constructor(_0x1079c5,_0x843411,_0x256747,_0x2014bb,_0x26f126,_0x359719,_0x171834){const _0x437798=_0x38cdda;super(),_(this,_0x437798(0x1d0),null),_(this,_0x437798(0x320),0x0),_(this,'_currentUsage',0x0),_(this,_0x437798(0x25a),[]),_(this,_0x437798(0x2be),0x0),(this[_0x437798(0x304)]=_0x1079c5,this['_commandService']=_0x843411,this[_0x437798(0x173)]=_0x256747,this['_httpService']=_0x2014bb,this[_0x437798(0x26c)]=_0x26f126,this[_0x437798(0x193)]=_0x359719,this[_0x437798(0x10a)]=_0x171834,this[_0x437798(0xf3)]());}[_0x38cdda(0xf3)](){const _0x1e6f5f=_0x38cdda;this['disposeWithMe'](this[_0x1e6f5f(0x2d5)]['beforeCommandExecuted']((_0x5e6e30,_0x39db95)=>{const _0x5834f3=_0x1e6f5f;var _0x3efca5;if(_0x5e6e30['id']!==_0x17cc85['id'])return;const _0x55db2a=_0x5e6e30['params'];if(!this[_0x5834f3(0x230)]((_0x3efca5=_0x55db2a[_0x5834f3(0x22b)])!=null?_0x3efca5:[]))return;if(!this[_0x5834f3(0x120)]())throw this[_0x5834f3(0x2da)](_0x5e6e30,_0x39db95),this[_0x5834f3(0x1ff)](),new _0x473ecc();})),this[_0x1e6f5f(0xfe)](this[_0x1e6f5f(0x2d5)][_0x1e6f5f(0x113)]((_0xb8fd09,_0x2b61b1)=>{const _0x106a49=_0x1e6f5f;if(_0xb8fd09['id']!==_0x5908a9['id'])return;const _0x13ca22=_0xb8fd09[_0x106a49(0x2a7)];if(vn(_0x13ca22)){const _0x2a2dad=_0x11358d();this[_0x106a49(0x25a)][_0x106a49(0x186)](_0x2a2dad),this['_startCalculationLimit'](_0x2a2dad);}else{if(pn(_0x13ca22)&&this[_0x106a49(0x25a)][_0x106a49(0xe4)]>0x0){const _0x9c2e81=this[_0x106a49(0x25a)]['shift']();this[_0x106a49(0x135)](_0x9c2e81);}}}));}[_0x38cdda(0x16f)](){const _0x2f0468=_0x38cdda;super[_0x2f0468(0x16f)](),this['_clearPolling'](),this[_0x2f0468(0x25a)]=[],this[_0x2f0468(0x1af)]=0x0,this[_0x2f0468(0x320)]=0x0,this[_0x2f0468(0x2be)]=0x0;}async[_0x38cdda(0x2da)](_0xea5563,_0x2d4e31){const _0x15be7e=_0x38cdda;for(let _0x30acf7=0x0;_0x30acf7<0x1e;_0x30acf7++)try{if(await this[_0x15be7e(0x30a)](),this['_checkCalculationAvailable']()){this[_0x15be7e(0x111)](_0xea5563,_0x2d4e31),this[_0x15be7e(0x304)][_0x15be7e(0x197)]({'content':this[_0x15be7e(0x10a)]['t']('formula.calculation.started'),'type':_0x8f3016['Success']});return;}await new Promise(_0x1723cd=>{const _0x1fa4e4=_0x15be7e;this[_0x1fa4e4(0x1d0)]=window[_0x1fa4e4(0x161)](_0x1723cd,0x3e8);});}catch(_0x3b6cf9){this[_0x15be7e(0x193)][_0x15be7e(0x12a)](_0x3b6cf9);}this[_0x15be7e(0x304)][_0x15be7e(0x197)]({'content':this[_0x15be7e(0x10a)]['t'](_0x15be7e(0x160)),'type':_0x8f3016[_0x15be7e(0x248)]});}[_0x38cdda(0x111)](_0xffaa85,_0x1c541c){const _0x4d929b=_0x38cdda;try{this[_0x4d929b(0x2d5)][_0x4d929b(0x223)](_0xffaa85['id'],_0xffaa85['params'],_0x1c541c);}catch(_0x3963bf){this[_0x4d929b(0x193)][_0x4d929b(0x12a)](_0x3963bf);}}[_0x38cdda(0x2ed)](_0x3bcf59,_0x4b393f){const _0x13b947=_0x38cdda;_0x4b393f<this[_0x13b947(0x2be)]||(this[_0x13b947(0x2be)]=_0x4b393f,this[_0x13b947(0x320)]=Number['parseInt'](_0x3bcf59[_0x13b947(0x216)]),this['_currentUsage']=Number[_0x13b947(0x1fc)](_0x3bcf59['currentUsage']));}async['_startCalculationLimit'](_0x467caa){const _0x52d838=_0x38cdda;var _0x8a2651,_0x40d029;const _0x1df0fe=Date[_0x52d838(0x238)]();try{const _0x3fadc4=((_0x8a2651=this[_0x52d838(0x173)][_0x52d838(0x2c8)](_0xe89f7f))==null?void 0x0:_0x8a2651['startFormulaLimitUrl'])||Rn,_0x242beb=(await this['_httpService'][_0x52d838(0x306)](_0x3fadc4,{'body':JSON[_0x52d838(0xd2)]({'taskId':_0x467caa})}))[_0x52d838(0x2a6)];if(((_0x40d029=_0x242beb[_0x52d838(0x12a)])==null?void 0x0:_0x40d029['code'])!==Z['OK'])return;this[_0x52d838(0x2ed)](_0x242beb[_0x52d838(0x10b)],_0x1df0fe);}catch(_0x263711){this[_0x52d838(0x193)]['error'](_0x263711);}}async[_0x38cdda(0x30a)](_0x4ce217){const _0x52a279=_0x38cdda;var _0x1be71e,_0x1443f6;const _0x332bb8=Date['now']();try{const _0x39b0ae=((_0x1be71e=this[_0x52a279(0x173)][_0x52a279(0x2c8)](_0xe89f7f))==null?void 0x0:_0x1be71e['getformulaLimitStatusUrl'])||Cn,_0x16ced0=_0x4ce217?_0x39b0ae+_0x52a279(0xed)+encodeURIComponent(_0x4ce217):_0x39b0ae,_0x3393b0=(await this[_0x52a279(0x1ef)]['get'](_0x16ced0))['body'];if(((_0x1443f6=_0x3393b0['error'])==null?void 0x0:_0x1443f6[_0x52a279(0x212)])!==Z['OK'])return;this[_0x52a279(0x2ed)](_0x3393b0[_0x52a279(0x10b)],_0x332bb8);}catch(_0x1e4cae){this[_0x52a279(0x193)][_0x52a279(0x12a)](_0x1e4cae);}}async['_releaseCalculationLimit'](_0x231f30){const _0x409567=_0x38cdda;var _0x1f5e71,_0x12b0ca;const _0x1b74b6=Date[_0x409567(0x238)]();try{const _0x48962b=((_0x1f5e71=this[_0x409567(0x173)][_0x409567(0x2c8)](_0xe89f7f))==null?void 0x0:_0x1f5e71['releaseFormulaLimitUrl'])||Dn,_0x27aa08=(await this[_0x409567(0x1ef)][_0x409567(0x306)](_0x48962b,{'body':JSON['stringify']({'taskId':_0x231f30})}))[_0x409567(0x2a6)];if(((_0x12b0ca=_0x27aa08['error'])==null?void 0x0:_0x12b0ca[_0x409567(0x212)])!==Z['OK'])return;this[_0x409567(0x2ed)](_0x27aa08[_0x409567(0x10b)],_0x1b74b6);}catch(_0x5cdf32){this['_logService']['error'](_0x5cdf32);}}['_checkCalculationAvailable'](){const _0xd51ecd=_0x38cdda;return this[_0xd51ecd(0x320)]===0x0?!0x0:this[_0xd51ecd(0x320)]-this['_currentUsage']>0x0;}[_0x38cdda(0x23c)](){const _0x4c00b3=_0x38cdda;this[_0x4c00b3(0x1d0)]&&(clearTimeout(this[_0x4c00b3(0x1d0)]),this[_0x4c00b3(0x1d0)]=null);}[_0x38cdda(0x1ff)](){const _0x16f362=_0x38cdda;this[_0x16f362(0x304)][_0x16f362(0x197)]({'content':this[_0x16f362(0x10a)]['t'](_0x16f362(0x129)),'type':_0x8f3016[_0x16f362(0x240)]});}['_hasFormulaInDirtyRanges'](_0x12b88e){const _0xb929a3=_0x38cdda;for(const _0x461dc3 of _0x12b88e){const {unitId:_0x36eae5,sheetId:_0x1cb712,range:_0x2e0c4b}=_0x461dc3,_0x4b96fd=this[_0xb929a3(0x26c)][_0xb929a3(0x31a)](_0x36eae5);if(!_0x4b96fd)continue;const _0x1fc8c2=_0x4b96fd[_0xb929a3(0x149)](_0x1cb712);if(!_0x1fc8c2)continue;const _0x43cf09=_0x1fc8c2['getCellMatrix']();for(let _0x5f4dfe=_0x2e0c4b[_0xb929a3(0x2bd)];_0x5f4dfe<=_0x2e0c4b['endRow'];_0x5f4dfe++)for(let _0x421904=_0x2e0c4b['startColumn'];_0x421904<=_0x2e0c4b[_0xb929a3(0xdb)];_0x421904++){const _0x582c60=_0x43cf09['getValue'](_0x5f4dfe,_0x421904);if(_0x582c60&&(_0x6c29ae(_0x582c60['f'])||_0x328479(_0x582c60['si'])))return!0x0;}}return!0x1;}};Ie=Tn([P(0x0,_0x11edd2(_0x19a1ba)),P(0x1,_0x30ccef),P(0x2,_0x36ab28),P(0x3,_0x11edd2(_0x1718b4)),P(0x4,_0x57b197),P(0x5,_0x3b2794),P(0x6,_0x11edd2(_0x134929))],Ie);var Nn=Object[_0x38cdda(0x1ac)],bn=(_0x3e5b15,_0x20efb6,_0x3fad87,_0x214a71)=>{const _0xefc7a=_0x38cdda;for(var _0x4cdbb5=_0x214a71>0x1?void 0x0:_0x214a71?Nn(_0x20efb6,_0x3fad87):_0x20efb6,_0x5b90e5=_0x3e5b15[_0xefc7a(0xe4)]-0x1,_0x62dd9a;_0x5b90e5>=0x0;_0x5b90e5--)(_0x62dd9a=_0x3e5b15[_0x5b90e5])&&(_0x4cdbb5=_0x62dd9a(_0x4cdbb5)||_0x4cdbb5);return _0x4cdbb5;},Ue=(_0x321092,_0x24e64e)=>(_0x31de5d,_0xefad3)=>_0x24e64e(_0x31de5d,_0xefad3,_0x321092);let He=class extends _0x447589{constructor(_0x45ef4d,_0x32eed3,_0x31ad6e){const _0x5b5790=_0x38cdda;super(),_(this,_0x5b5790(0x127),new Map()),_(this,'_saveTaskMap',new Map()),_(this,'_disabled',!0x1),(this[_0x5b5790(0x173)]=_0x45ef4d,this[_0x5b5790(0x156)]=_0x32eed3,this['_revisionService']=_0x31ad6e);}[_0x38cdda(0x1ae)](){const _0x4b0e08=_0x38cdda;this[_0x4b0e08(0x14e)]=!0x0;}[_0x38cdda(0x150)](){this['_disabled']=!0x1;}get[_0x38cdda(0x25f)](){return this['_saveTaskMap'];}[_0x38cdda(0x16f)](){const _0xcd1c5=_0x38cdda;this['exhaustSavingTask']()[_0xcd1c5(0x256)](()=>super[_0xcd1c5(0x16f)]());}async['loadOfflineData'](_0x21f3ad){const _0x52f55b=_0x38cdda;return this['_disabled']?null:this[_0x52f55b(0x156)][_0x52f55b(0x290)](_0x598630(_0x21f3ad));}async['saveOfflineData'](_0x4dcf2e,_0x25bfcd){const _0x46b42a=_0x38cdda;return!!this[_0x46b42a(0x156)][_0x46b42a(0x140)](_0x4dcf2e,_0x25bfcd);}[_0x38cdda(0x2dc)](_0xf8684c,_0x120236,_0x442074,_0x2a429c){const _0x5f2344=_0x38cdda,_0x4ce6f1=this[_0x5f2344(0x2b8)][_0x5f2344(0x1fa)](_0xf8684c);this[_0x5f2344(0x127)][_0x5f2344(0x1ad)](_0xf8684c,{'unitID':_0xf8684c,'type':_0x120236,'awaitingChangeset':_0x442074,'mutations':_0x2a429c,'rev':_0x4ce6f1}),this[_0x5f2344(0x2cd)][_0x5f2344(0x2e2)](_0xf8684c)||this[_0x5f2344(0x27b)](_0xf8684c);}[_0x38cdda(0x27b)](_0x59ccc9){const _0x26689e=_0x38cdda,_0x54dea2=this[_0x26689e(0x2a1)]();_0x54dea2===0x0?this[_0x26689e(0x273)](_0x59ccc9):this['_saveTaskMap']['set'](_0x59ccc9,setTimeout(()=>this[_0x26689e(0x273)](_0x59ccc9),_0x54dea2));}[_0x38cdda(0x2a1)](){const _0x34e1bc=_0x38cdda;var _0xf9641d;return(_0xf9641d=this[_0x34e1bc(0x173)][_0x34e1bc(0x2c8)](_0x2cb797))!=null?_0xf9641d:_0x5a0638;}[_0x38cdda(0x273)](_0x5aa086){const _0x44599a=_0x38cdda,_0x2a62b1=this['_saveTaskMap'][_0x44599a(0x244)](_0x5aa086);return _0x2a62b1!==void 0x0&&window[_0x44599a(0x299)](_0x2a62b1),this[_0x44599a(0x156)][_0x44599a(0x140)](_0x598630(_0x5aa086),this[_0x44599a(0x127)][_0x44599a(0x244)](_0x5aa086))[_0x44599a(0x256)](()=>this[_0x44599a(0x2cd)][_0x44599a(0x1f5)](_0x5aa086));}async[_0x38cdda(0x22f)](){const _0x360140=_0x38cdda,_0x4180cb=[];this[_0x360140(0x2cd)][_0x360140(0x109)]((_0x241c80,_0x32e74b)=>{const _0x227fe5=_0x360140;window[_0x227fe5(0x299)](_0x241c80),_0x4180cb[_0x227fe5(0x186)](this[_0x227fe5(0x273)](_0x32e74b)[_0x227fe5(0x256)](()=>{const _0x49472b=_0x227fe5;this[_0x49472b(0x2cd)]['delete'](_0x32e74b);}));}),await Promise['all'](_0x4180cb);}};He=bn([Ue(0x0,_0x36ab28),Ue(0x1,_0x1c020e),Ue(0x2,_0x11edd2(_0x5e4bb5))],He);class Ln extends _0x3f6cad{constructor(){const _0x5b84de=_0x38cdda;super(),_(this,_0x5b84de(0x15d)),this[_0x5b84de(0x15d)]=_0x1b1549(window,_0x5b84de(0x210))['pipe'](_0x3c41cb(this['dispose$']),_0xfb0504(0x1),_0x2c534b(void 0x0));}[_0x38cdda(0xe7)](_0x1d2f2c,_0x182b9e,_0x751342=!0x1){const _0x5a49cd=_0x38cdda,_0x39c1b3=new URL(window[_0x5a49cd(0x185)][_0x5a49cd(0x172)]);_0x39c1b3[_0x5a49cd(0x21e)][_0x5a49cd(0x1ad)](_0x1d2f2c,_0x182b9e),_0x751342?window[_0x5a49cd(0x29c)]['replaceState']('','',_0x39c1b3[_0x5a49cd(0x23e)]()):window['history'][_0x5a49cd(0x2ad)]('','',_0x39c1b3['toString']());}[_0x38cdda(0x235)](_0x2fc383,_0x5af94a=!0x1){const _0xff483e=_0x38cdda,_0x11d624=new URL(window[_0xff483e(0x185)]['href']);_0x11d624['searchParams']['delete'](_0x2fc383),_0x5af94a?window['history']['replaceState']('','',_0x11d624['toString']()):window[_0xff483e(0x29c)][_0xff483e(0x2ad)]('','',_0x11d624[_0xff483e(0x23e)]());}[_0x38cdda(0x264)](_0x37b88c){const _0x1b81c0=_0x38cdda;var _0x157894;return(_0x157894=new URL(window[_0x1b81c0(0x185)][_0x1b81c0(0x172)])[_0x1b81c0(0x21e)][_0x1b81c0(0x244)](_0x37b88c))!=null?_0x157894:void 0x0;}}var Un=Object[_0x38cdda(0x276)],Mn=Object[_0x38cdda(0x1ac)],An=(_0x17f7b1,_0x774132,_0x8e4cf0)=>_0x774132 in _0x17f7b1?Un(_0x17f7b1,_0x774132,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x8e4cf0}):_0x17f7b1[_0x774132]=_0x8e4cf0,Pn=(_0x5b8aba,_0x943a46,_0x31ad6d,_0x329962)=>{const _0x5e2cb3=_0x38cdda;for(var _0x4616ac=_0x329962>0x1?void 0x0:_0x329962?Mn(_0x943a46,_0x31ad6d):_0x943a46,_0x1c4396=_0x5b8aba[_0x5e2cb3(0xe4)]-0x1,_0x14cf95;_0x1c4396>=0x0;_0x1c4396--)(_0x14cf95=_0x5b8aba[_0x1c4396])&&(_0x4616ac=_0x14cf95(_0x4616ac)||_0x4616ac);return _0x4616ac;},Me=(_0x234cf1,_0x8b4360)=>(_0x3a43a5,_0x3635fe)=>_0x8b4360(_0x3a43a5,_0x3635fe,_0x234cf1),wn=(_0xf42c91,_0x1a806d,_0xe7e334)=>An(_0xf42c91,_0x1a806d+'',_0xe7e334);const yn='UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN';let Ye=class extends _0x571114{constructor(_0x398a81=_t,_0x3b20ac,_0x537ea8,_0x3d3b4d){const _0x3cb91f=_0x38cdda;super(),this[_0x3cb91f(0x259)]=_0x398a81,this[_0x3cb91f(0x1ab)]=_0x3b20ac,this[_0x3cb91f(0x203)]=_0x537ea8,this[_0x3cb91f(0x173)]=_0x3d3b4d;const {..._0x21e180}=_0x223c4b({},_t,this[_0x3cb91f(0x259)]);this[_0x3cb91f(0x173)][_0x3cb91f(0x110)](hn,_0x21e180);}['onStarting'](){const _0x2d9206=_0x38cdda;this[_0x2d9206(0x20a)](),this[_0x2d9206(0xfb)]();}[_0x38cdda(0x260)](){const _0x56c05d=_0x38cdda;this[_0x56c05d(0x218)]();}[_0x38cdda(0x20a)](){const _0x2ee88d=_0x38cdda;var _0x4fa52d;const _0x448f32=[[Ke],[Ie],[de],[he],[ue],[ze],[yt,{'useClass':Ln}],[_0x4d0498,{'useClass':_0x1893c1}],[_0x4e2cad,{'useClass':He}],[ae],[Se],[_e],[H],[$e],[ce]];this[_0x2ee88d(0x259)][_0x2ee88d(0x30d)]&&_0x448f32[_0x2ee88d(0x186)]([le]),_0x273047(this['_injector'],_0x583a07(_0x448f32,(_0x4fa52d=this[_0x2ee88d(0x259)])==null?void 0x0:_0x4fa52d['override']));}['_registerRenderDependencies'](){const _0x212fdb=_0x38cdda;this['disposeWithMe'](this[_0x212fdb(0x1ab)]['registerRenderModule'](_0x13411f['UNIVER_DOC'],[Fe])),this[_0x212fdb(0xfe)](this[_0x212fdb(0x1ab)][_0x212fdb(0x1cf)](_0x13411f[_0x212fdb(0x18f)],[ke]));}[_0x38cdda(0xfb)](){const _0x2eb332=_0x38cdda;_0x165c59(this[_0x2eb332(0x203)],[[H],[ae],[Se],[_e],[ce],[Ie]]),this[_0x2eb332(0x259)][_0x2eb332(0x30d)]&&_0x165c59(this[_0x2eb332(0x203)],[[le]]);}};wn(Ye,_0x38cdda(0x2bb),yn),Ye=Pn([_0x28cf15(_0x36932a),Me(0x1,_0x294de9),Me(0x2,_0x11edd2(_0x1d6fba)),Me(0x3,_0x36ab28)],Ye);var $n=Object[_0x38cdda(0x1ac)],xn=(_0x49804a,_0x44baf4,_0xd248e7,_0x4d8af3)=>{const _0x100a77=_0x38cdda;for(var _0x543be0=_0x4d8af3>0x1?void 0x0:_0x4d8af3?$n(_0x44baf4,_0xd248e7):_0x44baf4,_0x18b5e8=_0x49804a[_0x100a77(0xe4)]-0x1,_0x504528;_0x18b5e8>=0x0;_0x18b5e8--)(_0x504528=_0x49804a[_0x18b5e8])&&(_0x543be0=_0x504528(_0x543be0)||_0x543be0);return _0x543be0;},J=(_0x2a058b,_0x420e90)=>(_0x369129,_0x31001c)=>_0x420e90(_0x369129,_0x31001c,_0x2a058b);let ut=class extends _0x22b90f{constructor(_0x32136c,_0x21147b,_0x21b429,_0x5ed31f,_0x1430c5){super(_0x32136c,_0x21147b,_0x21b429,_0x5ed31f,_0x1430c5);}async[_0x38cdda(0x164)](_0x579f7e){const _0x44871e=_0x38cdda,_0x495b02=await this[_0x44871e(0x1a4)](),_0x17ad62=this['_createSocketURL'](_0x579f7e,_0x495b02);return this[_0x44871e(0x2cb)](_0x17ad62);}[_0x38cdda(0x2de)](_0xaac486,_0x20841a){const _0xf1d61f=_0x38cdda,_0x3869df=typeof window>'u'?new URL(_0xaac486):new URL(_0xaac486,window[_0xf1d61f(0x185)][_0xf1d61f(0x1fd)]);_0x3869df[_0xf1d61f(0x21e)][_0xf1d61f(0x1ad)](_0xf1d61f(0xef),_0x20841a);const _0x25d984=typeof window>'u'?new URLSearchParams():new URLSearchParams(window[_0xf1d61f(0x185)][_0xf1d61f(0x21a)]);return _0x25d984[_0xf1d61f(0x244)](_0xf1d61f(0x157))&&_0x3869df[_0xf1d61f(0x21e)][_0xf1d61f(0x1ad)]('runId',_0x25d984['get']('runId')),_0x3869df[_0xf1d61f(0x23e)]();}async[_0x38cdda(0x1a4)](){const _0x4a4da1=_0x38cdda;var _0x10ca21,_0x18229d,_0x19df0a;const _0x2d2a01=this[_0x4a4da1(0x173)][_0x4a4da1(0x2c8)](_0xe89f7f),_0x681c61=(_0x10ca21=_0x2d2a01==null?void 0x0:_0x2d2a01['wsSessionTicketUrl'])!=null?_0x10ca21:_0x47950d;return(_0x19df0a=(_0x18229d=(await this['_httpService'][_0x4a4da1(0x244)](_0x681c61,{'headers':{'Content-Type':_0x4a4da1(0x2d4)}}))[_0x4a4da1(0x2a6)])==null?void 0x0:_0x18229d[_0x4a4da1(0x1a0)])!=null?_0x19df0a:'';}};ut=xn([J(0x0,_0x11edd2(_0x1d6fba)),J(0x1,_0x11edd2(_0x1718b4)),J(0x2,_0x36ab28),J(0x3,_0x3b2794),J(0x4,_0x7728f)],ut);var Bn=Object[_0x38cdda(0x1ac)],Fn=(_0x2b4f4d,_0x5cc997,_0x35cea5,_0x226915)=>{for(var _0x239a3c=_0x226915>0x1?void 0x0:_0x226915?Bn(_0x5cc997,_0x35cea5):_0x5cc997,_0x5ba20e=_0x2b4f4d['length']-0x1,_0x3f366f;_0x5ba20e>=0x0;_0x5ba20e--)(_0x3f366f=_0x2b4f4d[_0x5ba20e])&&(_0x239a3c=_0x3f366f(_0x239a3c)||_0x239a3c);return _0x239a3c;},Ae=(_0x35967b,_0x182742)=>(_0x1c8e56,_0x4f98fd)=>_0x182742(_0x1c8e56,_0x4f98fd,_0x35967b);let dt=class extends _0x447589{constructor(_0x45b046,_0x13d9be,_0x56fee9){const _0x11627d=_0x38cdda;super(),this[_0x11627d(0x279)]=_0x45b046,this[_0x11627d(0x1ef)]=_0x13d9be,this[_0x11627d(0x173)]=_0x56fee9;}async[_0x38cdda(0x12c)](_0x1baeec,_0x22417b,_0x3dc213,..._0x5a5231){const _0x71c506=_0x38cdda;var _0x3de4c0,_0x3d5008,_0x3e0af3,_0x499462;const _0x1651d6=this['_instanceService'][_0x71c506(0x17e)]();if(!_0x1651d6)throw new Error(_0x71c506(0x1e3));const _0x205101=((_0x3de4c0=this['_configService'][_0x71c506(0x2c8)](_0x42eef4))!=null?_0x3de4c0:_0x3d49c2)+'/'+_0x1baeec+'/run/'+_0x22417b,_0x106949=new URL(window[_0x71c506(0x185)][_0x71c506(0x172)]),_0x3481cf={'scriptId':_0x1baeec,'runId':(_0x3d5008=_0x106949[_0x71c506(0x21e)]['get']('runId'))!=null?_0x3d5008:'','function':_0x22417b,'unitId':_0x1651d6[_0x71c506(0xf6)](),'argsOfFunction':JSON[_0x71c506(0xd2)](_0x5a5231),'invokeId':(_0x3e0af3=_0x3dc213['invokeId'])!=null?_0x3e0af3:'','executionId':(_0x499462=_0x3dc213['executionId'])!=null?_0x499462:''};try{const _0x3bd52c=await this[_0x71c506(0x1ef)][_0x71c506(0x306)](_0x205101,{'body':_0x3481cf});return _0x3bd52c[_0x71c506(0x2a6)]['error']&&_0x3bd52c[_0x71c506(0x2a6)][_0x71c506(0x12a)][_0x71c506(0x212)]!==Z['OK']?'Failed':_0x3bd52c['body'][_0x71c506(0x116)];}catch{return _0x71c506(0x2db);}}};dt=Fn([Ae(0x0,_0x57b197),Ae(0x1,_0x11edd2(_0x1718b4)),Ae(0x2,_0x36ab28)],dt);function _0x988b(){const _0x1bdf7e=['debug','ENTITLE_COUPON_USED_UP','rgba(255,\x20255,\x20255,\x200.01)','exhaustSavingTask','_hasFormulaInDirtyRanges','name','TEXT','_updateURLWithCurrentState','INVALID_INVITE_CODE','removeParam','addClipboardHook','parse','now','CONNECTOR_DATA_TOO_LARGE','9XiAGgN','SNAPSHOT_HAS_BEEN_REMOVED','_clearPolling','TOO_MANY_REQUESTS','toString','_urlService','Loading','UniverIcon','_collaborationUIEventService','find','get','onLocalMutation','replace','selections','Error','triggerDblclick','ONLINE','getRangePointData','fillRule','univer-flex\x20univer-items-center','setAlpha','ENTITLE_USE_COUPON_NOT_1ST_TRADE','0\x200\x2016\x2016','CONFLICT','_roomMembers$','ENTITLE_CHAT_LIMIT_EXCEED','clearInterval','uni.network.url-service','then','docStateChange$','isEditing','_config','_taskIds','onTransformChange$','_session','getActiveSheet','cursorInfo$','saveTaskMap','onRendered','[LogService\x20Error]:\x20','USER_IS_ANONYMOUS','UNAUTHENTICATED','getParam','sheetId','_syncEditingCollabCursorService','_initUnhandledRejectionListener','subscribe','UNIVER_DOC','stageInfo','ENTITLE_INVALID_COUPON_CODE','_univerInstanceService','with','beginPath','top','\x20at\x20','ACTIVE_UNIT_EVENT_CHANNEL','url(#on-line-icon_clip0_910_349)','_saveCache','_refreshCollabCursors','_anchor','defineProperty','session.collaboration-timeout','OnLineIcon','_instanceService','APPLY_PERMISSION_DENIED','_scheduleSaving','_docTransformStateCacheService','_transformService','YUUMI_CONNECTOR_URL_NOT_FOUND','_drawTextRange','row','onMouseMove','yellow.400','_assignedColors','APPLY_NON_SEQUENTIAL_REVISION','width','includes','backgroundColor','INVITE_CODE_HAS_BEEN_UES','addObjects','_startSheetCollabCursor','getStateCache','white','[Window\x20Error]:\x20','engine','M0\x200H16V16H0z','getItem','_toggleOnline','collabStatus.syncing','collaboration-client-ui.config','YUUMI_ASYNCIO_CANCELLED','AWAITING','1315116XXznTQ','setInterval','entityInit$','clearTimeout','type','MUTATION','history','_collabCursorState$','idSuffix','tag','EMAIL_VERIFY_CODE_MISMATCH','_getSaveTimeout','getSkeleton','m1Prime','_docClipboardService','selection','body','params','LOGIN_TOKEN_PROCESSING_FAILED','bottom','addHandlerCallback','getCellPositionByOffset','_status$','pushState','svg','REDEMPTION_CODE_HAS_BEEN_CREATED','from','red.300','split','fillStyle','fill','collaboration.closeRoom','_memberID','endRow','_revisionService','25LRaSRX','INVITE_CODE_REQUIRED','pluginName','doc.mutation.rich-text-editing','startRow','_lastResponseTimestamp','symbol','...','transformRemoteChangeset','_memberService','_initStatusListener','reason','isArray','column','currentSkeleton$','getConfig','setUndoRedoMutationParamsCache','sheetID','_doCreateSocket','redoState','_saveTaskMap','join','onPointerLeave$','arc','init','_beforeCloseService','off-line-icon_clip0_910_343','application/json','_commandService','YUUMI_AI_RUN_FAILED','startColumn','_docTransformIMECacheService','size','_checkAndWaitForCalculationPermission','Failed','updateOfflineData','getDocRanges','_createSocketURL','_scene','2637678YvvzkK','_context','has','AUTHORIZE_CODE_ILLEGAL','_id','values','_handleHeartbeatEvent','RemoveColCommandId','displayName','_docTransformSelectionsService','filename','http://www.w3.org/2000/svg','LICENSE_DISTRO_REJECTED','_setFormulaLimitStatus','40KqVjdH','font','ENTITLE_DUP_SUBSCRIPTION','ENTITLE_INSUFFICIENT_QUOTA','PENDING','range','stack','children','REDEMPTION_CODE_FULLY_REDEEMED','_hovered','YUUMI_TABLE_NOT_FOUND_IN_UNIT','/universer-api/license/formula/limit/status','ALREADY_EXISTS','makeDirty','activeSheet$','MOBILE_VERIFY_CODE_MISMATCH','_collabSessionService','_transformUndoRedoStack','LICENSE_MAX_UNITS_EXCEEDED','_handleEvent','_scheduleHeartbeat','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','_messageService','_onCursorUpdate','post','LICENSE_EXPORT_SIZE_EXCEEDED','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','_getFormulaLimitStatus','START_CALCULATION','permission.content','enableFrontendLog','_themeService','stage','totalFormulasToCalculate','_render','_hover','CLOSE_ROOM','_toggleOffline','getVpScrollXYInfoByPosToVp','Warning','COMPLETION_FINISHED','SNAPSHOT_INVALID_SNAPSHOT','complete','getUnit','pipe','findNodePositionByCharIndex','PY_RUNTIME_SCRIPT_ERROR','url(#off-line-icon_clip0_910_343)','Unknown\x20user','_maxFormulaLimit','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','toRgbString','_handleLeaveEvent','stringify','_uploadLog','attrs','_cursors','_collaborationSessionService','678867wuCxbW','_setupSubUnitSync','save','round','endColumn','collab-rect-range-','MOBILE_HAS_BEEN_BOUND','addEventListener','getSheetId','_range','_eventUnsubscribe','UPDATE_CURSOR','WECHAT_HAS_BEEN_BOUND','length','_onCursorDelete','_initResize','setParam','hide','message','drawWith','setStateCache','string','?taskId=','_removeCollabCursors','sessionTicket','transform','roomMembers$','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_initCommandInterceptor','text','REDEMPTION_INVALID_CODE','getUnitId','InsertColCommandId','USERS_LEAVE','[CollaborationDataLoaderController]','blue.400','_initDependencies','_clearOtherTimers','_uiPartsService','disposeWithMe','SOCKET_FAILED_RETRY','getUndoRedoMutationParamsCache','ERROR_AGAIN','getValue','setActiveRange','measureText','APPLY_DUPLICATED','setShapeProps','_notificationService','FETCH_MISS','forEach','_localeService','limitInfo','translate(.97)','storage','_removeClearOtherTimer','getColorFromTheme','setConfig','_applyCommand','on-line-icon_clip0_910_349','onCommandExecuted','_initCommandExecutedListener','APPLY_REJECT','result','textRanges','getCurrentUnitForType','editingUnit','_updateSubUnitFromURLParams','_setupBeforeClosingHandler','catch','_collaborationController','_textBubble','session.will-retry','_checkCalculationAvailable','YUUMI_NO_CUBOID_FOR_QUESTION','_updateLocalCursor','random','_handleJoinEvent','fillText','add','_cachedData','REDEMPTION_CODE_NOT_STARTED','formula.calculation.waiting','error','_handleHover','runOnServer','max','REDEMPTION_CODE_INACTIVE','registerBeforeClose','event$','_shapes','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','MoveRangeCommandId','OTHER_CLIENT_EDITING','_releaseCalculationLimit','on-line-icon','moveTo','_labelPosition','OTHER_CLIENTS_EDITING','_startDocCollabCursor','AWAITING_WITH_PENDING','deepClone','newValue','unsubscribe','color','setItem','_init','_send','NOT_COLLAB','transformIMECache','_entityInit$','xlink:href','_onRefRangeChange','ENTITLE_COUPON_EXPIRED','getSheetBySheetId','unitID','getOffsetConfig','getUniverSheetInstance','registerRefRange','_disabled','lineno','enableLocalCache','flatMap','collabStatus.conflict','collab-text-anchor-','NO_OTHER_CLIENTS_EDITING','undoState','_localStorageService','runId','_cursorShapes','SYNCED','_unitStatus','onPointerEnter$','createInstance','urlChange$','_heartbeatTimer','focused$','formula.calculation.unable','setTimeout','_monkeyPatchLogService','closePath','createSocket','unit','bind','YUUMI_RATE_OVER_LIMIT','assignAColorForMemberID','RECT','_updateCollabCursors','syncEditingCollabCursor','_docSkeletonManagerService','_selfUnitIDs','_anchorDot','dispose','isActive','getAncestorScale','href','_configService','transformMutationsWithChangeset','collabCursorState$','NOT_FOUND','collabStatus.fetchMiss','currentColor','_dataLoaderService','ENTITLE_NEED_BILLING_ADDRESS','3958570BtvSDZ','getCollabCursors$','_cursorInfo$','getFocusedUnit','min','FromArray','height','currentTheme$','USER_NOT_FOUND','transformSelections','location','push','assign','DATA_SOURCE_TOO_LARGE','whenReady','subscribeEvent','REDEMPTION_USER_NOT_ELIGIBLE','_unitOnClients','cursorInfo','unitId','UNIVER_SHEET','getTypeOfUnitDisposed$','unhandledrejection','APPLY_REVISION_CONFILICT','_logService','resize','colorChannel1','_localCacheService','show','_getScale','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','215076LVCmEM','1em','_getMergeRange','none','unload','_hideTimer','ticket','use','_initWindowErrorListener','sessionStatus$','_getSessionTicket','SUCCESS','replaceDocRanges','send','YUUMI_URL_COL_OUT_OF_RANGE','contains','clipPath','_renderManagerService','getOwnPropertyDescriptor','set','disableLocalCache','_currentUsage','_backgroundColor','path','map','getRenderById','_online','_getSheetObject','REDEMPTION_USER_REDEEM_TIMES_EXCEED','_color','YUUMI_ALL_TABLES_IS_INVALID','ranges','PAYMENT_CHANNEL_NOT_SUPPORT','_drawAnchor','loadUnit','_colorIndex','YUUMI_UNABLE_LOAD_URL','restore','_document','subunit','defs','transformStateCache','collab-text-range-','dispose$','m2Prime','_sheetSkeletonManagerService','removeEventListener','imageSourceType','registerComponent','INVITE_CODE_ALREADY_BOUND','_getAnchorBounding','entries','CURRENT_STATUS_CANNOT_OPERATE','registerRenderModule','_pollingInterval','transformMutation','eventID','OffLineIcon','_docSyncEditingCollabCursorService','evenodd','50nheIWs','_ensureSubject','OFFLINE','_refRangeService','_initEntityListener','_collabCursorController','_colorAssignService','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','lineTo','/universer-api/license/formula/limit/done','_initEvent','InsertRowCommandId','CHANGESET_REVISION_CONFILICT','[RemoteUniscriptService]:\x20no\x20focused\x20unit','collaboration.offline-data-not-saved','InsertRangeMoveRightCommandId','roomMembers','status$','_cursor','HEADER_MENU','UNRECOGNIZED','getMember','_entities','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','mask','_httpService','DeleteRangeMoveLeftCommandId','_name','mutations','green.600','permission.title','delete','saveImage','_transformHistoryAndStateStack','jiqing.500','_docStateChangeManagerService','getCurrentRevOfUnit','getMemberID','parseInt','origin','asObservable','_showGuardMessage','skeleton','univerjs-icon\x20univerjs-icon-','USER_NOT_INVITED_CODE','_injector','addObject','_imageIoService','ENSURE_SNAPSHOT_EXECUTION','socket$','YUUMI_SUBSCRIPTION_NOT_FOUND','_lastPointer','_registerDependencies','_transformPreviousActiveRange','/universer-api/frontend/logs','_scheduleClearOtherTimer','actions','_drawRectRange','popstate','url(#$1','code','_initUserListener','black','UNDEFINED','maxFormulaLimit','ENTITLE_REPORT_LIMIT_EXCEED','_registerRenderDependencies','data','search','labelPosition','next','div','searchParams','PERMISSION_DENIED','unshift','LICENSE_IMPORT_SIZE_EXCEEDED','INTERNAL_ERROR','executeCommand','10359DhJnOZ','substring','getTypeOfUnitAdded$','functionsExecutedState','4121060JbitYd','_initStatusComponent','bold\x2013px\x20Source\x20Han\x20Sans\x20CN','dirtyRanges'];_0x988b=function(){return _0x1bdf7e;};return _0x988b();}const St=0x7530,It=_0x38cdda(0x271);class rr extends _0x447589{constructor(){const _0x5dfc8c=_0x38cdda;super(),_(this,_0x5dfc8c(0x2e4),_0x11358d()),_(this,_0x5dfc8c(0x16d),new Set()),_(this,_0x5dfc8c(0x18c),new Map()),_(this,'_heartbeatTimer',null),_(this,_0x5dfc8c(0xfc),new Map()),_(this,_0x5dfc8c(0x15a),new Map()),this[_0x5dfc8c(0x141)]();}[_0x38cdda(0x16f)](){const _0x553eed=_0x38cdda;super[_0x553eed(0x16f)](),this['_clearOtherTimers'][_0x553eed(0x109)]((_0x2446af,_0x4e1101)=>this[_0x553eed(0x10e)](_0x4e1101)),this[_0x553eed(0x15e)]&&window[_0x553eed(0x254)](this[_0x553eed(0x15e)]);}['getUnitStatus$'](_0x2f035e){const _0x4fe973=_0x38cdda;return this['_ensureSubject'](_0x2f035e)[_0x4fe973(0x31b)](_0xc41425());}[_0x38cdda(0x119)](_0x34e011){const _0x44261f=_0x38cdda;this[_0x44261f(0x16d)][_0x44261f(0x2d9)]===0x0&&this[_0x44261f(0x302)](),this[_0x44261f(0x16d)]['add'](_0x34e011),this[_0x44261f(0x142)]({'type':0x0,'memberID':this[_0x44261f(0x2e4)],'unitIDs':[_0x34e011],'isForwarded':!0x1});}['disposeUnit'](_0x2d9afe){const _0x3114cf=_0x38cdda;this[_0x3114cf(0x16d)][_0x3114cf(0x1f5)](_0x2d9afe),this[_0x3114cf(0x16d)]['size']===0x0&&this[_0x3114cf(0x15e)]&&window[_0x3114cf(0x254)](this['_heartbeatTimer']);}['_init'](){const _0x193eaf=_0x38cdda;this['disposeWithMe'](_0x2e6c99(_0x1b1549(window,_0x193eaf(0x10d))[_0x193eaf(0x268)](_0x1c538b=>{const _0x602353=_0x193eaf;if(_0x1c538b['key']!==It||!_0x1c538b[_0x602353(0x13d)])return;const _0x46bc7b=JSON[_0x602353(0x237)](_0x1c538b[_0x602353(0x13d)]);this[_0x602353(0x301)](_0x46bc7b);}))),window[_0x193eaf(0xde)](_0x193eaf(0x19e),()=>this[_0x193eaf(0x142)]({'type':0x1,'memberID':this[_0x193eaf(0x2e4)],'unitIDs':Array[_0x193eaf(0x2b0)](this[_0x193eaf(0x16d)])}));}[_0x38cdda(0x301)](_0x252f46){const _0x43c407=_0x38cdda;switch(_0x252f46[_0x43c407(0x29a)]){case 0x0:this['_handleJoinEvent'](_0x252f46);break;case 0x1:this[_0x43c407(0xd1)](_0x252f46);break;case 0x2:this[_0x43c407(0x2e6)](_0x252f46);break;}}[_0x38cdda(0x124)](_0x1cf53a){const _0x1a6a4e=_0x38cdda,{unitIDs:_0x4f3021,memberID:_0x353dd8,isForwarded:_0x12fd07}=_0x1cf53a;_0x4f3021[_0x1a6a4e(0x109)](_0x211eaf=>{const _0xe4b172=_0x1a6a4e;if(!_0x12fd07&&this['_unitOnClients']['has'](_0x211eaf)&&this[_0xe4b172(0x1d7)](_0x211eaf)[_0xe4b172(0x21c)](_0x47df77[_0xe4b172(0x139)]),!this[_0xe4b172(0x18c)][_0xe4b172(0x2e2)](_0x211eaf)||!this[_0xe4b172(0x18c)][_0xe4b172(0x244)](_0x211eaf)['has'](_0x353dd8)){const _0x850c17=this[_0xe4b172(0x18c)][_0xe4b172(0x244)](_0x211eaf)||new Set();_0x850c17[_0xe4b172(0x126)](_0x353dd8),this[_0xe4b172(0x18c)][_0xe4b172(0x1ad)](_0x211eaf,_0x850c17),this[_0xe4b172(0x20d)](_0x353dd8);}}),_0x12fd07||this[_0x1a6a4e(0x142)]({'type':0x0,'memberID':this[_0x1a6a4e(0x2e4)],'unitIDs':[...this[_0x1a6a4e(0x16d)]],'isForwarded':!0x0});}[_0x38cdda(0x20d)](_0x2167b2){const _0x5477f2=_0x38cdda;this['_removeClearOtherTimer'](_0x2167b2);const _0x465523=window[_0x5477f2(0x161)](()=>{const _0xe7ec07=_0x5477f2;this[_0xe7ec07(0x18c)][_0xe7ec07(0x109)](_0x2cd427=>{const _0x3a1859=_0xe7ec07;_0x2cd427[_0x3a1859(0x1f5)](_0x2167b2);});},St*0x2);this[_0x5477f2(0xfc)][_0x5477f2(0x1ad)](_0x2167b2,_0x465523);}['_removeClearOtherTimer'](_0x4f2255){const _0x1ecbd3=_0x38cdda;if(this[_0x1ecbd3(0xfc)][_0x1ecbd3(0x2e2)](_0x4f2255)){const _0x4bb816=this[_0x1ecbd3(0xfc)]['get'](_0x4f2255);_0x4bb816&&window[_0x1ecbd3(0x299)](_0x4bb816),this[_0x1ecbd3(0xfc)][_0x1ecbd3(0x1ad)](_0x4f2255,null);}}['_handleLeaveEvent'](_0x2cbe32){const _0xebe4d2=_0x38cdda,{memberID:_0x215c80,unitIDs:_0x57c766}=_0x2cbe32;_0x57c766[_0xebe4d2(0x109)](_0x191213=>{const _0x495846=_0xebe4d2;var _0x142594;const _0x3d3a7a=this[_0x495846(0x18c)][_0x495846(0x244)](_0x191213);_0x3d3a7a&&(_0x3d3a7a[_0x495846(0x1f5)](_0x215c80),(_0x142594=this['_ensureSubject'](_0x191213))==null||_0x142594['next'](_0x3d3a7a['size']===0x0?_0x47df77[_0x495846(0x154)]:_0x47df77[_0x495846(0x139)]));}),this[_0xebe4d2(0x10e)](_0x215c80);}[_0x38cdda(0x2e6)](_0xcda6c4){const _0x5e063a=_0x38cdda;this[_0x5e063a(0x20d)](_0xcda6c4['memberID']);}[_0x38cdda(0x142)](_0x323e46){const _0x3dbc03=_0x38cdda;localStorage[_0x3dbc03(0x140)](It,JSON[_0x3dbc03(0xd2)](_0x323e46));}[_0x38cdda(0x302)](){const _0x1f4ef1=_0x38cdda;this[_0x1f4ef1(0x15e)]=window[_0x1f4ef1(0x297)](()=>{const _0x2410e3=_0x1f4ef1;this['_send']({'type':0x2,'memberID':this[_0x2410e3(0x2e4)]});},St);}[_0x38cdda(0x1d7)](_0x23701d){const _0x17f794=_0x38cdda;return this[_0x17f794(0x15a)][_0x17f794(0x2e2)](_0x23701d)||this[_0x17f794(0x15a)][_0x17f794(0x1ad)](_0x23701d,new _0x4f0f13(_0x47df77[_0x17f794(0x154)])),this['_unitStatus'][_0x17f794(0x244)](_0x23701d);}}export{ut as BrowserCollaborationSocketService,ce as CollaborationDataLoaderController,ae as DesktopCollaborationStatusDisplayController,yt as IURLService,dt as RemoteUniscriptService,tn as SheetCollabCursorShape,Ye as UniverCollaborationClientUIPlugin,rr as WebBrowserSingleActiveUnitService,Ln as WebURLService};