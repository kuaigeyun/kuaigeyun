'use strict';const _0x268cd7=_0x19bb;(function(_0x3f6a66,_0x196fb1){const _0x5651fa=_0x19bb,_0x50144e=_0x3f6a66();while(!![]){try{const _0x472052=-parseInt(_0x5651fa(0xe2))/0x1*(parseInt(_0x5651fa(0xc7))/0x2)+-parseInt(_0x5651fa(0xc8))/0x3*(parseInt(_0x5651fa(0xd6))/0x4)+parseInt(_0x5651fa(0xfa))/0x5+-parseInt(_0x5651fa(0xcd))/0x6*(parseInt(_0x5651fa(0xf1))/0x7)+parseInt(_0x5651fa(0xd9))/0x8*(parseInt(_0x5651fa(0xfb))/0x9)+-parseInt(_0x5651fa(0xda))/0xa*(parseInt(_0x5651fa(0xf5))/0xb)+-parseInt(_0x5651fa(0xdd))/0xc*(-parseInt(_0x5651fa(0xdb))/0xd);if(_0x472052===_0x196fb1)break;else _0x50144e['push'](_0x50144e['shift']());}catch(_0x3cfa53){_0x50144e['push'](_0x50144e['shift']());}}}(_0x3241,0xd798c));function _0x3241(){const _0x191afe=['SheetPrintConfirmed','SheetPrintOpenOperation','PrintHeaderFooter','7VzAPBs','updateLayoutConfig','PrintPaperSize','PrintDirection','761002UEwSxo','layoutConfig','onCommandExecuted','updatePrintRenderConfig','updateRenderConfig','699380njdxOd','10709271uifGMM','BeforeSheetPrintOpen','_initialize','PrintFreeze','executeCommand','_injector','_worksheet','get','getScreenshot','Event','FEnum','PrintPaperMargin','syncExecuteCommand','_workbook','ConfirmSheetPrintOperation','ICommandService','23306xcwEcH','3585gyjVKc','fireEvent','FWorkbook','SheetPrintOpen','getUnitId','10211046ChgQhf','extend','BeforeSheetPrintConfirm','SheetPrintCanceled','closePrintDialog','_range','print','openPrintDialog','PrintArea','2268cgYpjE','getSheetId','renderConfig','8HNOfds','170tHTAVP','57986981HUlEJG','PrintHeaderFooterSymbol','12AIFLMb','getActiveSheet','SheetPrintClientService','CanceledError','PaperType','116XCvecN','SheetScreenShotOperation','getActiveUniverSheet','hasPrintFacadePermission','FUniver','cancel','saveScreenshotToClipboard','ISheetPrintManagerService','BeforeSheetPrintCanceled','PrintAlign','registerEventHandler','beforeCommandExecuted'];_0x3241=function(){return _0x191afe;};return _0x3241();}const e=require('@univerjs-pro/sheets-print'),a=require('@univerjs/core'),d=require('@univerjs/sheets/facade'),g=require('@univerjs/core/facade'),c=require('@univerjs-pro/print');class S extends d['FWorkbook']{['updatePrintConfig'](_0x5c9a60){const _0x5b45fc=_0x19bb;return this[_0x5b45fc(0x100)][_0x5b45fc(0x102)](e[_0x5b45fc(0xe9)])[_0x5b45fc(0xf2)](_0x5c9a60),this;}[_0x268cd7(0xf8)](_0x459e85){const _0x1c8d73=_0x268cd7;return this[_0x1c8d73(0x100)][_0x1c8d73(0x102)](e['ISheetPrintManagerService'])[_0x1c8d73(0xf9)](_0x459e85),this;}[_0x268cd7(0xd3)](){const _0x22316e=_0x268cd7;return this[_0x22316e(0x100)]['get'](a[_0x22316e(0xc6)])[_0x22316e(0xc3)](e[_0x22316e(0xc5)]['id']);}[_0x268cd7(0xd4)](){const _0x38c4dd=_0x268cd7;return this[_0x38c4dd(0x100)][_0x38c4dd(0x102)](a[_0x38c4dd(0xc6)])[_0x38c4dd(0xc3)](e[_0x38c4dd(0xef)]['id']);}[_0x268cd7(0xd1)](){const _0x34f755=_0x268cd7;return this['_injector'][_0x34f755(0x102)](a['ICommandService'])['syncExecuteCommand'](e['CancelSheetPrintOperation']['id']);}async[_0x268cd7(0xe8)](){const _0x454fb2=_0x268cd7;return e[_0x454fb2(0xe5)](this[_0x454fb2(0x100)])?this[_0x454fb2(0x100)]['get'](a[_0x454fb2(0xc6)])[_0x454fb2(0xff)](e[_0x454fb2(0xe3)]['id']):!0x1;}}d[_0x268cd7(0xca)][_0x268cd7(0xce)](S);class f extends d['FRange']{[_0x268cd7(0x103)](){const _0x58d8df=_0x268cd7;return e['hasPrintFacadePermission'](this[_0x58d8df(0x100)])?this[_0x58d8df(0x100)][_0x58d8df(0x102)](e[_0x58d8df(0xdf)])['getRangeImage'](this[_0x58d8df(0xc4)][_0x58d8df(0xcc)](),this[_0x58d8df(0x101)][_0x58d8df(0xd7)](),this[_0x58d8df(0xd2)]):!0x1;}}d['FRange'][_0x268cd7(0xce)](f);class P{get[_0x268cd7(0xfc)](){return'BeforeSheetPrintOpen';}get['BeforeSheetPrintConfirm'](){const _0x53413e=_0x268cd7;return _0x53413e(0xcf);}get[_0x268cd7(0xea)](){return'BeforeSheetPrintCanceled';}get['SheetPrintOpen'](){const _0x3fc0e0=_0x268cd7;return _0x3fc0e0(0xcb);}get[_0x268cd7(0xee)](){const _0x5c9b40=_0x268cd7;return _0x5c9b40(0xee);}get[_0x268cd7(0xd0)](){const _0x30ebd2=_0x268cd7;return _0x30ebd2(0xd0);}}function _0x19bb(_0x5ad09d,_0x3b9cf7){_0x5ad09d=_0x5ad09d-0xc0;const _0x32411c=_0x3241();let _0x19bbba=_0x32411c[_0x5ad09d];return _0x19bbba;}g['FEventName'][_0x268cd7(0xce)](P);class u{get[_0x268cd7(0xd5)](){const _0x530547=_0x268cd7;return e[_0x530547(0xd5)];}get['PrintAlign'](){const _0x10206a=_0x268cd7;return c[_0x10206a(0xeb)];}get[_0x268cd7(0xf3)](){const _0xf5a30e=_0x268cd7;return a[_0xf5a30e(0xe1)];}get[_0x268cd7(0xc2)](){const _0x5176c7=_0x268cd7;return c[_0x5176c7(0xc2)];}get['PrintScale'](){return c['PrintScale'];}get[_0x268cd7(0xf4)](){const _0x427893=_0x268cd7;return c[_0x427893(0xf4)];}get['PrintFreeze'](){const _0x1103a1=_0x268cd7;return e[_0x1103a1(0xfe)];}get['PrintHeaderFooter'](){const _0x1c8459=_0x268cd7;return e[_0x1c8459(0xf0)];}get[_0x268cd7(0xdc)](){const _0x4b3c05=_0x268cd7;return e[_0x4b3c05(0xdc)];}}g[_0x268cd7(0xc1)][_0x268cd7(0xce)](u);class l extends g[_0x268cd7(0xe6)]{[_0x268cd7(0xfd)](_0x3188ab){const _0x3a1176=_0x268cd7,_0x36ef2d=_0x3188ab[_0x3a1176(0x102)](a[_0x3a1176(0xc6)]);this['registerEventHandler'](this[_0x3a1176(0xc0)][_0x3a1176(0xfc)],()=>_0x36ef2d[_0x3a1176(0xed)](_0x4d2701=>{const _0x3da98c=_0x3a1176;if(_0x4d2701['id']===e[_0x3da98c(0xef)]['id']){const _0x2d0ddd=this[_0x3da98c(0xe4)]();if(!_0x2d0ddd)return;const _0x185911={'workbook':_0x2d0ddd,'worksheet':_0x2d0ddd['getActiveSheet']()};if(_0x185911==null)return;if(this[_0x3da98c(0xc9)](this['Event'][_0x3da98c(0xfc)],_0x185911),_0x185911[_0x3da98c(0xe7)])throw new a['CanceledError']();}})),this[_0x3a1176(0xec)](this[_0x3a1176(0xc0)]['BeforeSheetPrintConfirm'],()=>_0x36ef2d[_0x3a1176(0xed)](_0x9ce91d=>{const _0x1de08d=_0x3a1176;if(_0x9ce91d['id']===e[_0x1de08d(0xc5)]['id']){const _0xf86527=_0x3188ab[_0x1de08d(0x102)](e[_0x1de08d(0xe9)]);if(!this[_0x1de08d(0xe4)]())return;const _0x89b6b6={'layoutConfig':_0xf86527[_0x1de08d(0xf6)],'renderConfig':_0xf86527['renderConfig']};if(_0x89b6b6==null)return;if(this[_0x1de08d(0xc9)](this[_0x1de08d(0xc0)][_0x1de08d(0xcf)],_0x89b6b6),_0x89b6b6[_0x1de08d(0xe7)])throw new a[(_0x1de08d(0xe0))]();}})),this[_0x3a1176(0xec)](this['Event']['BeforeSheetPrintCanceled'],()=>_0x36ef2d[_0x3a1176(0xed)](_0x193503=>{const _0x4cc08c=_0x3a1176;if(_0x193503['id']===e['CancelSheetPrintOperation']['id']){const _0x145c21=_0x3188ab[_0x4cc08c(0x102)](e['ISheetPrintManagerService']);if(!this[_0x4cc08c(0xe4)]())return;const _0xd67c2={'layoutConfig':_0x145c21[_0x4cc08c(0xf6)],'renderConfig':_0x145c21[_0x4cc08c(0xd8)]};if(_0xd67c2==null)return;if(this['fireEvent'](this[_0x4cc08c(0xc0)]['BeforeSheetPrintCanceled'],_0xd67c2),_0xd67c2[_0x4cc08c(0xe7)])throw new a[(_0x4cc08c(0xe0))]();}})),this[_0x3a1176(0xec)](this[_0x3a1176(0xc0)]['SheetPrintOpen'],()=>_0x36ef2d['onCommandExecuted'](_0x383ad8=>{const _0x57714f=_0x3a1176;if(_0x383ad8['id']===e[_0x57714f(0xef)]['id']){const _0x12dd66=this['getActiveUniverSheet']();if(!_0x12dd66)return;const _0x58a64b={'workbook':_0x12dd66,'worksheet':_0x12dd66[_0x57714f(0xde)]()};if(_0x58a64b==null)return;this[_0x57714f(0xc9)](this[_0x57714f(0xc0)][_0x57714f(0xcb)],_0x58a64b);}})),this[_0x3a1176(0xec)](this['Event']['SheetPrintConfirmed'],()=>_0x36ef2d[_0x3a1176(0xf7)](_0x490612=>{const _0x239fb2=_0x3a1176;if(_0x490612['id']===e['ConfirmSheetPrintOperation']['id']){const _0x267136=_0x3188ab['get'](e[_0x239fb2(0xe9)]);if(!this[_0x239fb2(0xe4)]())return;const _0x17376b={'layoutConfig':_0x267136['layoutConfig'],'renderConfig':_0x267136[_0x239fb2(0xd8)]};if(_0x17376b==null)return;this[_0x239fb2(0xc9)](this[_0x239fb2(0xc0)][_0x239fb2(0xee)],_0x17376b);}})),this['registerEventHandler'](this[_0x3a1176(0xc0)]['SheetPrintCanceled'],()=>_0x36ef2d[_0x3a1176(0xf7)](_0x44af44=>{const _0x5680bd=_0x3a1176;if(_0x44af44['id']===e['CancelSheetPrintOperation']['id']){const _0x1d4311=_0x3188ab[_0x5680bd(0x102)](e[_0x5680bd(0xe9)]);if(!this[_0x5680bd(0xe4)]())return;const _0x534d6b={'layoutConfig':_0x1d4311[_0x5680bd(0xf6)],'renderConfig':_0x1d4311[_0x5680bd(0xd8)]};if(_0x534d6b==null)return;this[_0x5680bd(0xc9)](this[_0x5680bd(0xc0)][_0x5680bd(0xd0)],_0x534d6b);}}));}}g[_0x268cd7(0xe6)]['extend'](l);