const _0x12defb=_0x293b;(function(_0x554b20,_0x414a02){const _0xc53168=_0x293b,_0x418600=_0x554b20();while(!![]){try{const _0x2a1563=-parseInt(_0xc53168(0x18d))/0x1+-parseInt(_0xc53168(0x1a9))/0x2+parseInt(_0xc53168(0x197))/0x3+-parseInt(_0xc53168(0x18f))/0x4+-parseInt(_0xc53168(0x18a))/0x5+-parseInt(_0xc53168(0x196))/0x6+-parseInt(_0xc53168(0x186))/0x7*(-parseInt(_0xc53168(0x1a3))/0x8);if(_0x2a1563===_0x414a02)break;else _0x418600['push'](_0x418600['shift']());}catch(_0x5237f2){_0x418600['push'](_0x418600['shift']());}}}(_0x5bf2,0x41638));import{ISheetPrintManagerService as _0x838471,ConfirmSheetPrintOperation as _0x58e40f,SheetPrintOpenOperation as _0x3c4eae,CancelSheetPrintOperation as _0x383684,hasPrintFacadePermission as _0x2fe31b,SheetScreenShotOperation as _0x592f06,SheetPrintClientService as _0x28fd14,PrintArea as _0x452417,PrintFreeze as _0x2a4aa7,PrintHeaderFooter as _0x39d5c7,PrintHeaderFooterSymbol as _0x10d4c9}from'@univerjs-pro/sheets-print';import{ICommandService as _0x1afa1f,PaperType as _0x293063,CanceledError as _0x4bd77a}from'@univerjs/core';import{FWorkbook as _0x532a2f,FRange as _0x240be8}from'@univerjs/sheets/facade';import{FEventName as _0x18a8c5,FEnum as _0x3fc369,FUniver as _0x5dcc7f}from'@univerjs/core/facade';import{PrintAlign as _0x289f58,PrintPaperMargin as _0x3f2715,PrintScale as _0x5161f9,PrintDirection as _0x3a97a6}from'@univerjs-pro/print';class A extends _0x532a2f{['updatePrintConfig'](_0x49f097){const _0x4a5ceb=_0x293b;return this[_0x4a5ceb(0x18c)][_0x4a5ceb(0x18b)](_0x838471)['updateLayoutConfig'](_0x49f097),this;}['updatePrintRenderConfig'](_0x2d3efa){const _0x427466=_0x293b;return this['_injector']['get'](_0x838471)[_0x427466(0x193)](_0x2d3efa),this;}[_0x12defb(0x1ab)](){const _0x3f0cd4=_0x12defb;return this['_injector'][_0x3f0cd4(0x18b)](_0x1afa1f)['syncExecuteCommand'](_0x58e40f['id']);}[_0x12defb(0x184)](){const _0x47e441=_0x12defb;return this[_0x47e441(0x18c)][_0x47e441(0x18b)](_0x1afa1f)[_0x47e441(0x19e)](_0x3c4eae['id']);}['closePrintDialog'](){const _0x23f905=_0x12defb;return this['_injector'][_0x23f905(0x18b)](_0x1afa1f)['syncExecuteCommand'](_0x383684['id']);}async[_0x12defb(0x1a4)](){const _0x9df278=_0x12defb;return _0x2fe31b(this[_0x9df278(0x18c)])?this[_0x9df278(0x18c)][_0x9df278(0x18b)](_0x1afa1f)[_0x9df278(0x183)](_0x592f06['id']):!0x1;}}_0x532a2f[_0x12defb(0x1a2)](A);class B extends _0x240be8{[_0x12defb(0x199)](){const _0x4d9f7b=_0x12defb;return _0x2fe31b(this[_0x4d9f7b(0x18c)])?this[_0x4d9f7b(0x18c)]['get'](_0x28fd14)[_0x4d9f7b(0x1ac)](this[_0x4d9f7b(0x19b)][_0x4d9f7b(0x185)](),this[_0x4d9f7b(0x1a8)][_0x4d9f7b(0x1a0)](),this[_0x4d9f7b(0x191)]):!0x1;}}_0x240be8[_0x12defb(0x1a2)](B);class H{get['BeforeSheetPrintOpen'](){const _0x2563d8=_0x12defb;return _0x2563d8(0x192);}get[_0x12defb(0x182)](){return'BeforeSheetPrintConfirm';}get[_0x12defb(0x190)](){return'BeforeSheetPrintCanceled';}get[_0x12defb(0x181)](){const _0x1bbe3a=_0x12defb;return _0x1bbe3a(0x181);}get['SheetPrintConfirmed'](){const _0x510e94=_0x12defb;return _0x510e94(0x1a6);}get[_0x12defb(0x1a5)](){const _0x19a5dd=_0x12defb;return _0x19a5dd(0x1a5);}}_0x18a8c5[_0x12defb(0x1a2)](H);class U{get['PrintArea'](){return _0x452417;}get[_0x12defb(0x1a1)](){return _0x289f58;}get['PrintPaperSize'](){return _0x293063;}get['PrintPaperMargin'](){return _0x3f2715;}get[_0x12defb(0x189)](){return _0x5161f9;}get['PrintDirection'](){return _0x3a97a6;}get['PrintFreeze'](){return _0x2a4aa7;}get[_0x12defb(0x180)](){return _0x39d5c7;}get[_0x12defb(0x1aa)](){return _0x10d4c9;}}_0x3fc369[_0x12defb(0x1a2)](U);function _0x5bf2(){const _0x540aa8=['fireEvent','getScreenshot','registerEventHandler','_workbook','getActiveSheet','renderConfig','syncExecuteCommand','getActiveUniverSheet','getSheetId','PrintAlign','extend','8TDDHtv','saveScreenshotToClipboard','SheetPrintCanceled','SheetPrintConfirmed','beforeCommandExecuted','_worksheet','381896GflyJa','PrintHeaderFooterSymbol','print','getRangeImage','PrintHeaderFooter','SheetPrintOpen','BeforeSheetPrintConfirm','executeCommand','openPrintDialog','getUnitId','13663055xVgJaz','layoutConfig','Event','PrintScale','1800375gAffnG','get','_injector','290770rFXHfC','_initialize','2001320jtPYyD','BeforeSheetPrintCanceled','_range','BeforeSheetPrintOpen','updateRenderConfig','cancel','onCommandExecuted','2952888qOpmlB','450714eetwCI'];_0x5bf2=function(){return _0x540aa8;};return _0x5bf2();}class M extends _0x5dcc7f{[_0x12defb(0x18e)](_0x3440f7){const _0x2d24f6=_0x12defb,_0x567ebc=_0x3440f7[_0x2d24f6(0x18b)](_0x1afa1f);this['registerEventHandler'](this['Event'][_0x2d24f6(0x192)],()=>_0x567ebc['beforeCommandExecuted'](_0x59cbd5=>{const _0x3083e8=_0x2d24f6;if(_0x59cbd5['id']===_0x3c4eae['id']){const _0x2237c1=this[_0x3083e8(0x19f)]();if(!_0x2237c1)return;const _0x3c0a73={'workbook':_0x2237c1,'worksheet':_0x2237c1[_0x3083e8(0x19c)]()};if(_0x3c0a73==null)return;if(this[_0x3083e8(0x198)](this['Event'][_0x3083e8(0x192)],_0x3c0a73),_0x3c0a73[_0x3083e8(0x194)])throw new _0x4bd77a();}})),this[_0x2d24f6(0x19a)](this[_0x2d24f6(0x188)][_0x2d24f6(0x182)],()=>_0x567ebc[_0x2d24f6(0x1a7)](_0xf55f0e=>{const _0x480678=_0x2d24f6;if(_0xf55f0e['id']===_0x58e40f['id']){const _0xdcd455=_0x3440f7[_0x480678(0x18b)](_0x838471);if(!this[_0x480678(0x19f)]())return;const _0x39f0b1={'layoutConfig':_0xdcd455[_0x480678(0x187)],'renderConfig':_0xdcd455[_0x480678(0x19d)]};if(_0x39f0b1==null)return;if(this[_0x480678(0x198)](this[_0x480678(0x188)]['BeforeSheetPrintConfirm'],_0x39f0b1),_0x39f0b1[_0x480678(0x194)])throw new _0x4bd77a();}})),this[_0x2d24f6(0x19a)](this[_0x2d24f6(0x188)][_0x2d24f6(0x190)],()=>_0x567ebc[_0x2d24f6(0x1a7)](_0x58e265=>{const _0x501764=_0x2d24f6;if(_0x58e265['id']===_0x383684['id']){const _0x23f742=_0x3440f7[_0x501764(0x18b)](_0x838471);if(!this[_0x501764(0x19f)]())return;const _0x16c9d0={'layoutConfig':_0x23f742[_0x501764(0x187)],'renderConfig':_0x23f742[_0x501764(0x19d)]};if(_0x16c9d0==null)return;if(this[_0x501764(0x198)](this[_0x501764(0x188)][_0x501764(0x190)],_0x16c9d0),_0x16c9d0[_0x501764(0x194)])throw new _0x4bd77a();}})),this[_0x2d24f6(0x19a)](this['Event']['SheetPrintOpen'],()=>_0x567ebc['onCommandExecuted'](_0x34d77a=>{const _0x647659=_0x2d24f6;if(_0x34d77a['id']===_0x3c4eae['id']){const _0x1d1174=this['getActiveUniverSheet']();if(!_0x1d1174)return;const _0x3c8845={'workbook':_0x1d1174,'worksheet':_0x1d1174['getActiveSheet']()};if(_0x3c8845==null)return;this[_0x647659(0x198)](this[_0x647659(0x188)][_0x647659(0x181)],_0x3c8845);}})),this[_0x2d24f6(0x19a)](this[_0x2d24f6(0x188)][_0x2d24f6(0x1a6)],()=>_0x567ebc[_0x2d24f6(0x195)](_0x453016=>{const _0x47481d=_0x2d24f6;if(_0x453016['id']===_0x58e40f['id']){const _0x105c5e=_0x3440f7['get'](_0x838471);if(!this['getActiveUniverSheet']())return;const _0x4f5811={'layoutConfig':_0x105c5e[_0x47481d(0x187)],'renderConfig':_0x105c5e['renderConfig']};if(_0x4f5811==null)return;this['fireEvent'](this['Event'][_0x47481d(0x1a6)],_0x4f5811);}})),this[_0x2d24f6(0x19a)](this[_0x2d24f6(0x188)][_0x2d24f6(0x1a5)],()=>_0x567ebc[_0x2d24f6(0x195)](_0x43ac32=>{const _0xd2abfe=_0x2d24f6;if(_0x43ac32['id']===_0x383684['id']){const _0xb24712=_0x3440f7['get'](_0x838471);if(!this['getActiveUniverSheet']())return;const _0x3d2299={'layoutConfig':_0xb24712['layoutConfig'],'renderConfig':_0xb24712['renderConfig']};if(_0x3d2299==null)return;this[_0xd2abfe(0x198)](this[_0xd2abfe(0x188)][_0xd2abfe(0x1a5)],_0x3d2299);}}));}}function _0x293b(_0x33d282,_0x1ce6b3){_0x33d282=_0x33d282-0x180;const _0x5bf23f=_0x5bf2();let _0x293b47=_0x5bf23f[_0x33d282];return _0x293b47;}_0x5dcc7f[_0x12defb(0x1a2)](M);