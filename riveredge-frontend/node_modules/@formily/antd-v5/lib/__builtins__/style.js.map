{"version":3,"file":"style.js","sourceRoot":"lib/","sources":["__builtins__/style.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AACA,+CAAsD;AACtD,0CAAuC;AAEvC,iCAA6C;AA2BtC,IAAM,cAAc,GAAG,UAC5B,KAAU,EACV,kBAA0B;;IAElB,IAAA,UAAU,GAAe,KAAK,WAApB,EAAE,QAAQ,GAAK,KAAK,SAAV,CAAU;IAEtC,IAAM,kBAAkB,GAAG,oBAAY,kBAAkB,6BAAiB,kBAAkB,QAAI,CAAA;IAEhG;QACE,GAAC,kBAAkB;gBACjB,UAAU,YAAA;gBACV,QAAQ,UAAA;gBACR,SAAS,EAAE,YAAY;gBAEvB,qBAAqB,EAAE;oBACrB,SAAS,EAAE,YAAY;iBACxB;;YAED,GAAC,kBAAkB,IAAG;gBACpB,SAAS,EAAE,YAAY;gBAEvB,qBAAqB,EAAE;oBACrB,SAAS,EAAE,YAAY;iBACxB;aACF;eACF;WACF;AACH,CAAC,CAAA;AA3BY,QAAA,cAAc,kBA2B1B;AAMM,IAAM,YAAY,GAAG,UAC1B,SAAwB,EACxB,OAGqB;IAErB,OAAO,UAAC,SAAiB;QACjB,IAAA,KAA2B,IAAA,gBAAQ,GAAE,EAAnC,KAAK,WAAA,EAAE,KAAK,WAAA,EAAE,MAAM,YAAe,CAAA;QACrC,IAAA,KAAuC,IAAA,iBAAS,GAAE,EAAhD,YAAY,kBAAA,EAAE,aAAa,mBAAA,EAAE,GAAG,SAAgB,CAAA;QACxD,IAAM,aAAa,GAAG,YAAY,EAAE,CAAA;QACpC,OAAO;YACL,IAAA,0BAAgB,EACd;gBACE,KAAK,EAAE,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,KAAK;gBACjB,KAAK,OAAA;gBACL,KAAK,OAAA;gBACL,MAAM,QAAA;gBACN,IAAI,EAAE,CAAC,cAAc,EAAE,SAAS,EAAE,SAAS,EAAE,aAAa,CAAC;aAC5D,EACD;gBACE,IAAM,YAAY,GAAG,WAAI,SAAS,CAAE,CAAA;gBACpC,IAAM,WAAW,GAAoC,IAAA,cAAK,EAAC,KAAK,wBAC3D,KAAK,CAAC,MAAM,CAAC,KAAE,4BAA4B;oBAC9C,YAAY,cAAA,EACZ,SAAS,WAAA,EACT,OAAO,EAAE,WAAI,aAAa,CAAE,EAC5B,MAAM,EAAE,WAAI,aAAa,CAAE,IAC3B,CAAA;gBAEF,IAAM,kBAAkB,GAAG,OAAO,CAAC,WAAW,EAAE;oBAC9C,MAAM,QAAA;oBACN,SAAS,WAAA;oBACT,aAAa,eAAA;oBACb,aAAa,eAAA;iBACd,CAAC,CAAA;gBACF,OAAO,CAAC,IAAA,sBAAc,EAAC,KAAK,EAAE,SAAS,CAAC,EAAE,kBAAkB,CAAC,CAAA;YAC/D,CAAC,CACF;YACD,MAAM;SACP,CAAA;IACH,CAAC,CAAA;AACH,CAAC,CAAA;AA1CY,QAAA,YAAY,gBA0CxB","sourcesContent":["import type { CSSInterpolation, CSSObject } from '@ant-design/cssinjs'\nimport { useStyleRegister } from '@ant-design/cssinjs'\nimport { merge } from '@formily/shared'\nimport type { ComponentTokenMap, GlobalToken } from 'antd/es/theme/interface'\nimport { useConfig, useToken } from './hooks'\n\nexport type OverrideComponent = keyof ComponentTokenMap | (string & {})\n\nexport interface StyleInfo {\n  hashId: string\n  prefixCls: string\n  rootPrefixCls: string\n  iconPrefixCls: string\n}\n\nexport type TokenWithCommonCls<T> = T & {\n  /** Wrap component class with `.` prefix */\n  componentCls: string\n  /** Origin prefix which do not have `.` prefix */\n  prefixCls: string\n  /** Wrap icon class with `.` prefix */\n  iconCls: string\n  /** Wrap ant prefixCls class with `.` prefix */\n  antCls: string\n}\n\nexport type GenerateStyle<\n  ComponentToken extends object = TokenWithCommonCls<GlobalToken>,\n  ReturnType = CSSInterpolation\n> = (token: ComponentToken, options?: any) => ReturnType\n\nexport const genCommonStyle = (\n  token: any,\n  componentPrefixCls: string\n): CSSObject => {\n  const { fontFamily, fontSize } = token\n\n  const rootPrefixSelector = `[class^=\"${componentPrefixCls}\"], [class*=\" ${componentPrefixCls}\"]`\n\n  return {\n    [rootPrefixSelector]: {\n      fontFamily,\n      fontSize,\n      boxSizing: 'border-box',\n\n      '&::before, &::after': {\n        boxSizing: 'border-box',\n      },\n\n      [rootPrefixSelector]: {\n        boxSizing: 'border-box',\n\n        '&::before, &::after': {\n          boxSizing: 'border-box',\n        },\n      },\n    },\n  }\n}\nexport type UseComponentStyleResult = [\n  (node: React.ReactNode) => React.ReactElement,\n  string\n]\n\nexport const genStyleHook = <ComponentName extends OverrideComponent>(\n  component: ComponentName,\n  styleFn: (\n    token: TokenWithCommonCls<GlobalToken>,\n    info: StyleInfo\n  ) => CSSInterpolation\n) => {\n  return (prefixCls: string): UseComponentStyleResult => {\n    const { theme, token, hashId } = useToken()\n    const { getPrefixCls, iconPrefixCls, csp } = useConfig()\n    const rootPrefixCls = getPrefixCls()\n    return [\n      useStyleRegister(\n        {\n          nonce: csp?.nonce,\n          theme,\n          token,\n          hashId,\n          path: ['formily-antd', component, prefixCls, iconPrefixCls],\n        },\n        () => {\n          const componentCls = `.${prefixCls}`\n          const mergedToken: TokenWithCommonCls<GlobalToken> = merge(token, {\n            ...token['Form'], // Merge the antd form token\n            componentCls,\n            prefixCls,\n            iconCls: `.${iconPrefixCls}`,\n            antCls: `.${rootPrefixCls}`,\n          })\n\n          const styleInterpolation = styleFn(mergedToken, {\n            hashId,\n            prefixCls,\n            rootPrefixCls,\n            iconPrefixCls,\n          })\n          return [genCommonStyle(token, prefixCls), styleInterpolation]\n        }\n      ),\n      hashId,\n    ]\n  }\n}\n"]}