"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.formatDayjsValue = exports.dayjsable = void 0;
// FOR: https://github.com/ant-design/antd-moment-webpack-plugin
var shared_1 = require("@formily/shared");
var moment_1 = __importDefault(require("moment"));
function dayjsable(value, format) {
    if (!value)
        return value;
    if (Array.isArray(value)) {
        return value.map(function (val) {
            var date = (0, moment_1.default)(val, format);
            if (date.isValid())
                return date;
            var _date = (0, moment_1.default)(val);
            return _date.isValid() ? _date : val;
        });
    }
    else {
        var date = (0, moment_1.default)(value, format);
        if (date.isValid())
            return date;
        var _date = (0, moment_1.default)(value);
        return _date.isValid() ? _date : value;
    }
}
exports.dayjsable = dayjsable;
var formatDayjsValue = function (value, format, placeholder) {
    var validFormatDate = function (date, format) {
        if (typeof date === 'number') {
            return (0, moment_1.default)(date).format(format);
        }
        var _date = (0, moment_1.default)(date, format);
        return _date.isValid() ? _date.format(format) : date;
    };
    var formatDate = function (date, format, i) {
        if (i === void 0) { i = 0; }
        if (!date)
            return placeholder;
        if ((0, shared_1.isArr)(format)) {
            var _format = format[i];
            if ((0, shared_1.isFn)(_format)) {
                return _format(date);
            }
            if ((0, shared_1.isEmpty)(_format)) {
                return date;
            }
            return validFormatDate(date, _format);
        }
        else {
            if ((0, shared_1.isFn)(format)) {
                return format(date);
            }
            if ((0, shared_1.isEmpty)(format)) {
                return date;
            }
            return validFormatDate(date, format);
        }
    };
    if ((0, shared_1.isArr)(value)) {
        return value.map(function (val, index) {
            return formatDate(val, format, index);
        });
    }
    else {
        return value ? formatDate(value, format) : value || placeholder;
    }
};
exports.formatDayjsValue = formatDayjsValue;
//# sourceMappingURL=moment.js.map