{"version":3,"file":"index.js","sourceRoot":"lib/","sources":["array-table/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ArrayField, FieldDisplayTypes, GeneralField } from '@formily/core'\nimport { Schema } from '@formily/json-schema'\nimport {\n  observer,\n  ReactFC,\n  RecursionField,\n  useField,\n  useFieldSchema,\n} from '@formily/react'\nimport { isArr, isBool, isFn } from '@formily/shared'\nimport {\n  Badge,\n  Pagination,\n  PaginationProps,\n  Select,\n  SelectProps,\n  Space,\n  Table,\n  TableProps,\n} from 'antd'\nimport { ColumnProps, ColumnsType } from 'antd/es/table'\nimport cls from 'classnames'\nimport React, {\n  createContext,\n  forwardRef,\n  Fragment,\n  useCallback,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\nimport { ArrayBase, ArrayBaseMixins } from '../array-base'\nimport {\n  ISortableContainerProps,\n  SortableContainer,\n  SortableElement,\n  usePrefixCls,\n} from '../__builtins__'\nimport useStyle from './style'\n\ninterface ObservableColumnSource {\n  field?: GeneralField\n  columnProps: ColumnProps<any>\n  schema: Schema\n  display: FieldDisplayTypes\n  name: string\n}\ninterface IArrayTablePaginationProps extends PaginationProps {\n  dataSource?: any[]\n  showPagination: boolean\n  children?: (\n    dataSource: any[],\n    pagination: React.ReactNode,\n    options: {\n      startIndex: number\n    }\n  ) => React.ReactElement\n}\n\ninterface IStatusSelectProps extends SelectProps<any> {\n  pageSize?: number\n}\n\ninterface PaginationAction {\n  totalPage?: number\n  pageSize?: number\n  startIndex?: number\n  changePage?: (page: number) => void\n}\n\nconst SortableRow = SortableElement((props) => <tr {...props} />)\n\nconst SortableBodyRaw = SortableContainer<\n  React.HTMLAttributes<HTMLTableSectionElement> & {\n    tbodyRef: React.LegacyRef<HTMLTableSectionElement>\n  }\n>(({ tbodyRef, ...props }) => <tbody {...props} ref={tbodyRef} />)\nconst SortableBody = forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement> & ISortableContainerProps\n>((props, ref) => <SortableBodyRaw {...props} tbodyRef={ref} />)\n\nconst isColumnComponent = (schema: Schema) => {\n  return schema['x-component']?.indexOf('Column') > -1\n}\n\nconst isOperationsComponent = (schema: Schema) => {\n  return schema['x-component']?.indexOf('Operations') > -1\n}\n\nconst isAdditionComponent = (schema: Schema) => {\n  return schema['x-component']?.indexOf('Addition') > -1\n}\n\nconst useArrayTableSources = () => {\n  const arrayField = useField()\n  const schema = useFieldSchema()\n  const parseSources = (schema: Schema): ObservableColumnSource[] => {\n    if (\n      isColumnComponent(schema) ||\n      isOperationsComponent(schema) ||\n      isAdditionComponent(schema)\n    ) {\n      if (!schema['x-component-props']?.['dataIndex'] && !schema['name'])\n        return []\n      const name = schema['x-component-props']?.['dataIndex'] || schema['name']\n      const field = arrayField.query(arrayField.address.concat(name)).take()\n      const columnProps =\n        field?.component?.[1] || schema['x-component-props'] || {}\n      const display = field?.display || schema['x-display']\n      return [\n        {\n          name,\n          display,\n          field,\n          schema,\n          columnProps,\n        },\n      ]\n    } else if (schema.properties) {\n      return schema.reduceProperties<\n        ObservableColumnSource[],\n        ObservableColumnSource[]\n      >((buf, schema) => {\n        return buf.concat(parseSources(schema))\n      }, [])\n    }\n    return []\n  }\n\n  const parseArrayItems = (schema: Schema['items']) => {\n    if (!schema) return []\n    const sources: ObservableColumnSource[] = []\n    const items = isArr(schema) ? schema : [schema]\n    return items.reduce((columns, schema) => {\n      const item = parseSources(schema)\n      if (item) {\n        return columns.concat(item)\n      }\n      return columns\n    }, sources)\n  }\n\n  if (!schema) throw new Error('can not found schema object')\n\n  return parseArrayItems(schema.items)\n}\nconst indexKey = '__DO_NOT_USE_THIS_PROPERTY_index__'\nconst useArrayTableColumns = (\n  dataSource: any[],\n  field: ArrayField,\n  sources: ObservableColumnSource[]\n): ColumnsType<any> => {\n  return sources.reduce<ColumnsType<any>>(\n    (buf, { name, columnProps, schema, display }, key) => {\n      if (display !== 'visible') return buf\n      if (!isColumnComponent(schema)) return buf\n      return buf.concat({\n        ...columnProps,\n        key,\n        dataIndex: name,\n        render: (value: any, record: any) => {\n          const index = record[indexKey]\n\n          const children = (\n            <ArrayBase.Item index={index} record={() => field?.value?.[index]}>\n              <RecursionField\n                schema={schema}\n                name={index}\n                onlyRenderProperties\n              />\n            </ArrayBase.Item>\n          )\n\n          return index > -1 ? children : null\n        },\n      })\n    },\n    []\n  )\n}\n\nconst useAddition = () => {\n  const schema = useFieldSchema()\n  return schema.reduceProperties((addition, schema, key) => {\n    if (isAdditionComponent(schema)) {\n      return <RecursionField schema={schema} name={key} />\n    }\n    return addition\n  }, null)\n}\n\nconst schedulerRequest = {\n  request: null as null | number,\n}\n\nconst StatusSelect: ReactFC<IStatusSelectProps> = observer(\n  (props) => {\n    const field = useField<ArrayField>()\n    const prefixCls = usePrefixCls('formily-array-table')\n    const [wrapSSR, hashId] = useStyle(prefixCls)\n    const errors = field.errors\n    const parseIndex = (address?: string) => {\n      return Number(\n        address\n          ?.slice(address.indexOf(field.address.toString()))\n          .match(/(\\d+)/)?.[1]\n      )\n    }\n    const options = props.options?.map(({ label, value }) => {\n      const val = Number(value)\n      const hasError = errors.some(({ address }) => {\n        const currentIndex = parseIndex(address)\n        const startIndex = props.pageSize ? (val - 1) * props.pageSize : 0\n        const endIndex = props.pageSize\n          ? val * props.pageSize\n          : props.options?.length || 0\n        return currentIndex >= startIndex && currentIndex <= endIndex\n      })\n      return {\n        label: hasError ? <Badge dot>{label}</Badge> : label,\n        value,\n      }\n    })\n\n    const width = String(options?.length).length * 15\n\n    return wrapSSR(\n      <Select\n        value={props.value}\n        onChange={props.onChange}\n        options={options}\n        virtual\n        style={{\n          width: width < 60 ? 60 : width,\n        }}\n        className={cls(`${prefixCls}-status-select`, hashId, {\n          'has-error': errors?.length,\n        })}\n      />\n    )\n  },\n  {\n    scheduler: (update) => {\n      clearTimeout(schedulerRequest.request as any)\n      schedulerRequest.request = setTimeout(() => {\n        update()\n      }, 100) as unknown as number\n    },\n  }\n)\n\nconst PaginationContext = createContext<PaginationAction>({})\nconst usePagination = () => {\n  return useContext(PaginationContext)\n}\n\nconst ArrayTablePagination: ReactFC<IArrayTablePaginationProps> = (props) => {\n  const [current, setCurrent] = useState(1)\n  const prefixCls = usePrefixCls('formily-array-table')\n  const [wrapSSR, hashId] = useStyle(prefixCls)\n  const [pageSize, setPageSize] = useState(props.pageSize || 10)\n  const size = props.size || 'default'\n  const dataSource = props.dataSource || []\n  const showPagination = props.showPagination\n  const startIndex = (current - 1) * pageSize\n  const endIndex = startIndex + pageSize - 1\n  const total = dataSource?.length || 0\n  const totalPage = Math.ceil(total / pageSize)\n  const pages = Array.from(new Array(totalPage)).map((_, index) => {\n    const page = index + 1\n    return {\n      label: page,\n      value: page,\n    }\n  })\n  const handleChange = (current: number) => {\n    setCurrent(current)\n  }\n  const handleSizeChange = (_, size: number) => {\n    setPageSize(size)\n  }\n\n  useEffect(() => {\n    setPageSize(props.pageSize || 10)\n  }, [props.pageSize])\n\n  useEffect(() => {\n    if (totalPage > 0 && totalPage < current) {\n      handleChange(totalPage)\n    }\n  }, [totalPage, current])\n\n  const renderPagination = () => {\n    if (!showPagination || totalPage < 1) return\n    return (\n      <div className={cls(`${prefixCls}-pagination`, hashId)}>\n        <Space>\n          <StatusSelect\n            value={current}\n            pageSize={pageSize}\n            onChange={handleChange}\n            options={pages}\n            notFoundContent={false}\n          />\n          <Pagination\n            {...props}\n            pageSize={pageSize}\n            current={current}\n            total={dataSource.length}\n            size={size}\n            showSizeChanger={true}\n            onShowSizeChange={handleSizeChange}\n            onChange={handleChange}\n          />\n        </Space>\n      </div>\n    )\n  }\n\n  return wrapSSR(\n    <Fragment>\n      <PaginationContext.Provider\n        value={{ totalPage, pageSize, startIndex, changePage: handleChange }}\n      >\n        {props.children?.(\n          showPagination\n            ? dataSource?.slice(startIndex, endIndex + 1)\n            : dataSource,\n          renderPagination(),\n          {\n            startIndex,\n          }\n        )}\n      </PaginationContext.Provider>\n    </Fragment>\n  )\n}\n\nconst WrapperComp = (props: React.HTMLAttributes<HTMLTableSectionElement>) => {\n  const ref = useRef<HTMLTableSectionElement>(null)\n  const field = useField<ArrayField>()\n  const prefixCls = usePrefixCls('formily-array-table')\n  const { startIndex } = useContext(PaginationContext)\n  const dataSource = Array.isArray(field.value) ? field.value.slice() : []\n\n  const addTdStyles = (id: number) => {\n    const node = ref.current?.querySelector(`.${prefixCls}-row-${id}`)\n    const helper = document.body.querySelector(`.${prefixCls}-sort-helper`)\n    if (!helper) return\n    const tds = node?.querySelectorAll('td')\n    if (!tds) return\n    requestAnimationFrame(() => {\n      helper.querySelectorAll('td').forEach((td, index) => {\n        if (tds[index]) {\n          td.style.width = getComputedStyle(tds[index]).width\n        }\n      })\n    })\n  }\n\n  return (\n    <SortableBody\n      ref={ref}\n      {...props}\n      start={startIndex}\n      list={dataSource.slice()}\n      accessibility={{\n        container: ref.current || undefined,\n      }}\n      onSortStart={(event) => {\n        addTdStyles(event.active.id as number)\n      }}\n      onSortEnd={({ oldIndex, newIndex }) => {\n        field.move(oldIndex, newIndex)\n      }}\n      className={cls(`${prefixCls}-sort-helper`, props.className)}\n    />\n  )\n}\n\nconst RowComp: ReactFC<React.HTMLAttributes<HTMLTableRowElement>> = (props) => {\n  const prefixCls = usePrefixCls('formily-array-table')\n  const index = props['data-row-key'] || 0\n  return (\n    <SortableRow\n      lockAxis=\"y\"\n      {...props}\n      index={index}\n      className={cls(props.className, `${prefixCls}-row-${index + 1}`)}\n    />\n  )\n}\n\nconst InternalArrayTable: ReactFC<TableProps<any>> = observer(\n  (props: TableProps<any>) => {\n    const ref = useRef<HTMLDivElement>(null)\n    const field = useField<ArrayField>()\n    const prefixCls = usePrefixCls('formily-array-table')\n    const [wrapSSR, hashId] = useStyle(prefixCls)\n    const dataSource = Array.isArray(field.value) ? field.value.slice() : []\n    dataSource.forEach((item, index) => {\n      item[indexKey] = index\n    })\n    const sources = useArrayTableSources()\n    const columns = useArrayTableColumns(dataSource, field, sources)\n    const pagination = isBool(props.pagination) ? {} : props.pagination\n    const showPagination = isBool(props.pagination) ? props.pagination : true\n    const addition = useAddition()\n    const defaultRowKey = (record: any) => {\n      return record[indexKey]\n    }\n\n    return wrapSSR(\n      <ArrayTablePagination\n        {...pagination}\n        dataSource={dataSource}\n        showPagination={showPagination}\n      >\n        {(dataSource, pager, { startIndex }) => {\n          return (\n            <div ref={ref} className={cls(prefixCls, hashId)}>\n              <ArrayBase>\n                <Table\n                  size=\"small\"\n                  bordered\n                  rowKey={defaultRowKey}\n                  {...props}\n                  onChange={() => {}}\n                  pagination={false}\n                  columns={columns}\n                  dataSource={dataSource}\n                  components={{\n                    body: {\n                      wrapper: WrapperComp,\n                      row: RowComp,\n                    },\n                  }}\n                />\n                <div style={{ marginTop: 5, marginBottom: 5 }}>{pager}</div>\n                {sources.map((column, key) => {\n                  //专门用来承接对Column的状态管理\n                  if (!isColumnComponent(column.schema)) return\n                  return React.createElement(RecursionField, {\n                    name: column.name,\n                    schema: column.schema,\n                    onlyRenderSelf: true,\n                    key,\n                  })\n                })}\n                {addition}\n              </ArrayBase>\n            </div>\n          )\n        }}\n      </ArrayTablePagination>\n    )\n  }\n)\n\nconst Column: ReactFC<ColumnProps<any>> = () => {\n  return <Fragment />\n}\n\nconst Addition: ArrayBaseMixins['Addition'] = (props) => {\n  const array = ArrayBase.useArray()\n  const { totalPage = 0, pageSize = 10, changePage } = usePagination()\n  return (\n    <ArrayBase.Addition\n      {...props}\n      onClick={(e) => {\n        // 如果添加数据后将超过当前页，则自动切换到下一页\n        const total = array?.field?.value.length || 0\n        if (total === totalPage * pageSize + 1 && isFn(changePage)) {\n          changePage(totalPage + 1)\n        }\n        props.onClick?.(e)\n      }}\n    />\n  )\n}\n\nexport const ArrayTable = Object.assign(ArrayBase.mixin(InternalArrayTable), {\n  Column,\n  Addition,\n})\n\nArrayTable.displayName = 'ArrayTable'\n\nexport default ArrayTable\n"]}