import {
  require_jsx_runtime
} from "./chunk-5T6QEG5N.js";
import {
  require_react_dom
} from "./chunk-4DDZX4I5.js";
import {
  require_react
} from "./chunk-KTKTKB6L.js";
import {
  __async,
  __objRest,
  __publicField,
  __spreadProps,
  __spreadValues,
  __toESM
} from "./chunk-JMNN7AZU.js";

// node_modules/@svar-ui/react-gantt/dist/index.es.js
var import_jsx_runtime6 = __toESM(require_jsx_runtime());
var import_react7 = __toESM(require_react());

// node_modules/@svar-ui/react-core/dist/index.es.js
var import_jsx_runtime = __toESM(require_jsx_runtime());
var import_react2 = __toESM(require_react());

// node_modules/@svar-ui/lib-react/dist/index.js
var import_react = __toESM(require_react());

// node_modules/@svar-ui/lib-dom/dist/index.js
function locate(el, attr = "data-id") {
  let node = el;
  if (!node.tagName && el.target)
    node = el.target;
  while (node) {
    if (node.getAttribute) {
      const id3 = node.getAttribute(attr);
      if (id3) return node;
    }
    node = node.parentNode;
  }
  return null;
}
function locateAttr(el, attr = "data-id") {
  const node = locate(el, attr);
  if (node) return node.getAttribute(attr);
  return null;
}
function locateID(el, attr = "data-id") {
  const node = locate(el, attr);
  if (node) {
    return id(node.getAttribute(attr));
  }
  return null;
}
function id(value) {
  if (typeof value === "string") {
    const t2 = value * 1;
    if (!isNaN(t2)) return t2;
  }
  return value;
}
function getEnv() {
  return {
    detect: () => true,
    addEvent: function(node, event, handler) {
      node.addEventListener(event, handler);
      return () => node.removeEventListener(event, handler);
    },
    addGlobalEvent: function(event, handler) {
      document.addEventListener(event, handler);
      return () => document.removeEventListener(event, handler);
    },
    getTopNode: function() {
      return window.document.body;
    }
  };
}
var env = getEnv();
function setEnv(update) {
  Object.assign(env, update);
}
function delegateEvent(node, handlers, event) {
  function handleEvent(ev) {
    const node2 = locate(ev);
    if (!node2) return;
    const id3 = id(node2.dataset.id);
    if (typeof handlers === "function") return handlers(id3, ev);
    let action;
    let test = ev.target;
    while (test != node2) {
      action = test.dataset ? test.dataset.action : null;
      if (action) {
        if (handlers[action]) {
          handlers[action](id3, ev);
          return;
        }
      }
      test = test.parentNode;
    }
    if (handlers[event]) handlers[event](id3, ev);
  }
  env.addEvent(node, event, handleEvent);
}
function delegateClick(node, handlers) {
  delegateEvent(node, handlers, "click");
  if (handlers.dblclick) delegateEvent(node, handlers.dblclick, "dblclick");
}
function remove(items, node) {
  for (let i = items.length - 1; i >= 0; i--) {
    if (items[i] === node) {
      items.splice(i, 1);
      break;
    }
  }
}
var activationDate = /* @__PURE__ */ new Date();
var skipNext = false;
var outsideHandlers = [];
var outsideListners = [];
var handleOutsideClick = (event) => {
  if (skipNext) {
    skipNext = false;
    return;
  }
  for (let i = outsideListners.length - 1; i >= 0; i--) {
    const { node, date, props } = outsideListners[i];
    if (date > activationDate) continue;
    if (!node.contains(event.target) && node !== event.target) {
      if (props.callback) props.callback(event);
      if (props.modal || event.defaultPrevented) break;
    }
  }
};
var handleMouseDown = (event) => {
  activationDate = /* @__PURE__ */ new Date();
  skipNext = true;
  for (let i = outsideListners.length - 1; i >= 0; i--) {
    const { node } = outsideListners[i];
    if (!node.contains(event.target) && node !== event.target) {
      skipNext = false;
      break;
    }
  }
};
function clickOutside(node, props) {
  if (!outsideHandlers.length) {
    outsideHandlers = [
      env.addGlobalEvent("click", handleOutsideClick, node),
      env.addGlobalEvent("contextmenu", handleOutsideClick, node),
      env.addGlobalEvent("mousedown", handleMouseDown, node)
    ];
  }
  if (typeof props !== "object") {
    props = { callback: props };
  }
  const pack = { node, date: /* @__PURE__ */ new Date(), props };
  outsideListners.push(pack);
  return {
    destroy() {
      remove(outsideListners, pack);
      if (!outsideListners.length) {
        outsideHandlers.forEach((e) => e());
        outsideHandlers = [];
      }
    }
  };
}
var isBottom = (mode) => mode.indexOf("bottom") !== -1;
var isLeft = (mode) => mode.indexOf("left") !== -1;
var isRight = (mode) => mode.indexOf("right") !== -1;
var isTop = (mode) => mode.indexOf("top") !== -1;
var isFit = (mode) => mode.indexOf("fit") !== -1;
var isOverlap = (mode) => mode.indexOf("overlap") !== -1;
var isCenter = (mode) => {
  return mode.split("-").every((v3) => ["center", "fit"].indexOf(v3) > -1);
};
var getAlign = (mode) => {
  const match = mode.match(/(start|center|end)/);
  return match ? match[0] : null;
};
function getMaxIndex(p2, ap) {
  let zi = 0;
  const top = env.getTopNode(p2);
  while (p2) {
    if (p2 === top) break;
    const pos2 = getComputedStyle(p2)["position"];
    if (pos2 === "absolute" || pos2 === "relative" || pos2 === "fixed") {
      zi = parseInt(getComputedStyle(p2)["zIndex"]) || 0;
    }
    p2 = p2.parentNode;
    if (p2 === ap) break;
  }
  return zi;
}
var x;
var y;
var width;
var pos;
function calculatePosition(self, parent, at4 = "bottom", left = 0, top = 0) {
  if (!self) return null;
  x = left;
  y = top;
  width = "auto";
  let z5 = 0;
  let fixLeft = 0;
  const body = getAbsParent(self);
  const cont = isOverlap(at4) ? env.getTopNode(self) : body;
  if (!body) return null;
  const bodyRect = body.getBoundingClientRect();
  const selfRect = self.getBoundingClientRect();
  const contRect = cont.getBoundingClientRect();
  const contStyle = window.getComputedStyle(cont);
  const border = {
    left: 0,
    top: 0,
    bottom: 0,
    right: 0
  };
  for (const key in border) {
    const style = `border-${key}-width`;
    border[key] = parseFloat(contStyle.getPropertyValue(style));
  }
  if (parent) {
    const zi = getMaxIndex(parent, body);
    z5 = Math.max(zi + 1, 20);
  }
  if (parent) {
    pos = parent.getBoundingClientRect();
    if (isFit(at4)) width = pos.width + "px";
    if (at4 !== "point") {
      if (isCenter(at4)) {
        if (isFit(at4)) {
          x = 0;
        } else {
          x = contRect.width / 2;
          fixLeft = 1;
        }
        y = (contRect.height - selfRect.height) / 2;
      } else {
        const fix = isOverlap(at4) ? 0 : 1;
        x = isRight(at4) ? pos.right + fix : pos.left - fix;
        y = isBottom(at4) ? pos.bottom + 1 : pos.top;
        const align = getAlign(at4);
        if (align) {
          if (isRight(at4) || isLeft(at4)) {
            if (align === "center") y -= (selfRect.height - pos.height) / 2;
            else if (align === "end") y -= selfRect.height - pos.height;
          } else if (isBottom(at4) || isTop(at4)) {
            if (align === "center") x -= (selfRect.width - pos.width) / 2;
            else if (align === "end") x -= selfRect.width - pos.width;
            if (!isOverlap(at4)) x += 1;
          }
        }
      }
    }
  } else pos = { left, right: left, top, bottom: top };
  const isCorner = (isLeft(at4) || isRight(at4)) && (isBottom(at4) || isTop(at4));
  if (isLeft(at4)) {
    fixLeft = 2;
  }
  const dxL = x - selfRect.width - contRect.left;
  if (parent && isLeft(at4) && !isCorner && dxL < 0) {
    x = pos.right;
    fixLeft = 0;
  }
  const dxR = x + selfRect.width * (1 - fixLeft / 2) - contRect.right;
  if (dxR > 0) {
    if (!isRight(at4)) {
      x = contRect.right - border.right - selfRect.width;
    } else {
      const dx = pos.left - contRect.x - selfRect.width;
      if (parent && !isOverlap(at4) && !isCorner && dx >= 0) {
        x = pos.left - selfRect.width;
      } else {
        x -= dxR + border.right;
      }
    }
  }
  if (fixLeft) {
    x = Math.round(x - selfRect.width * fixLeft / 2);
  }
  const needSwap = dxL < 0 || dxR > 0 || !isCorner;
  if (isTop(at4)) {
    y = pos.top - selfRect.height;
    if (parent && y < contRect.y && needSwap) {
      y = pos.bottom;
    }
  }
  const dy = y + selfRect.height - contRect.bottom;
  if (dy > 0) {
    if (parent && isBottom(at4) && needSwap) {
      y -= selfRect.height + pos.height + 1;
    } else {
      y -= dy + border.bottom;
    }
  }
  x -= bodyRect.left + border.left;
  y -= bodyRect.top + border.top;
  x = Math.max(x, 0) + cont.scrollLeft;
  y = Math.max(y, 0) + cont.scrollTop;
  width = width || "auto";
  return { x, y, z: z5, width };
}
function getAbsParent(el) {
  const top = env.getTopNode(el);
  if (el) el = el.parentElement;
  while (el) {
    const pos2 = getComputedStyle(el)["position"];
    if (el === top || pos2 === "relative" || pos2 === "absolute" || pos2 === "fixed")
      return el;
    el = el.parentNode;
  }
  return null;
}
var id2 = (/* @__PURE__ */ new Date()).valueOf();
function uid() {
  id2 += 1;
  return id2;
}
var ScreenKeys = class {
  constructor() {
    this.store = /* @__PURE__ */ new Map();
  }
  configure(hotkeys2, node) {
    this.node = node;
    for (const hotkey in hotkeys2) {
      if (hotkeys2[hotkey]) {
        const hotkeyFormatted = hotkey.toLowerCase().replace(/[ ]/g, "");
        const handler = hotkeys2[hotkey];
        this.store.set(hotkeyFormatted, handler);
      }
    }
  }
};
var chain = [];
var hotkeys = {
  subscribe: (v3) => {
    init_once();
    const t2 = new ScreenKeys();
    chain.push(t2);
    v3(t2);
    return () => {
      const ind = chain.findIndex((a2) => a2 === t2);
      if (ind >= 0) chain.splice(ind, 1);
    };
  }
};
var ready = false;
function init_once() {
  if (ready) return;
  ready = true;
  document.addEventListener("keydown", (ev) => {
    if (chain.length && (ev.ctrlKey || ev.altKey || ev.metaKey || ev.shiftKey || ev.key.length > 1 || ev.key === " ")) {
      const code = [];
      if (ev.ctrlKey) code.push("ctrl");
      if (ev.altKey) code.push("alt");
      if (ev.metaKey) code.push("meta");
      if (ev.shiftKey) code.push("shift");
      let evKey = ev.code.replace("Key", "").toLocaleLowerCase();
      if (ev.key === " ") {
        evKey = "space";
      }
      code.push(evKey);
      const key = code.join("+");
      for (let i = chain.length - 1; i >= 0; i--) {
        const target = chain[i];
        const handler = target.store.get(key) || target.store.get(evKey);
        if (handler && target.node.contains(ev.target)) {
          handler(ev, { key, evKey });
        }
      }
    }
  });
}
function toFixed(num) {
  if (num < 10) return "0" + num;
  return num.toString();
}
function toFixedMs(num) {
  const temp = toFixed(num);
  return temp.length == 2 ? "0" + temp : temp;
}
function getDuodecade(year) {
  const start = Math.floor(year / 11) * 11;
  return {
    start,
    end: start + 11
  };
}
function getWeekNumber(ndate, weekStart = 1) {
  let nday = ndate.getDay();
  if (nday === 0) {
    nday = 7;
  }
  nday = (nday - weekStart + 7) % 7;
  const first_thursday = new Date(ndate.valueOf());
  first_thursday.setDate(ndate.getDate() + (3 - nday));
  const year_number = first_thursday.getFullYear();
  const ordinal_date = Math.floor(
    (first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 864e5
  );
  return 1 + Math.floor(ordinal_date / 7);
}
var emptyAmPm = ["", ""];
function date2str(mask, date, locale2) {
  var _a2;
  switch (mask) {
    case "%d":
      return toFixed(date.getDate());
    case "%m":
      return toFixed(date.getMonth() + 1);
    case "%j":
      return date.getDate();
    case "%n":
      return date.getMonth() + 1;
    case "%y":
      return toFixed(date.getFullYear() % 100);
    case "%Y":
      return date.getFullYear();
    case "%D":
      return locale2.dayShort[date.getDay()];
    case "%l":
      return locale2.dayFull[date.getDay()];
    case "%M":
      return locale2.monthShort[date.getMonth()];
    case "%F":
      return locale2.monthFull[date.getMonth()];
    case "%h":
      return toFixed((date.getHours() + 11) % 12 + 1);
    case "%g":
      return (date.getHours() + 11) % 12 + 1;
    case "%G":
      return date.getHours();
    case "%H":
      return toFixed(date.getHours());
    case "%i":
      return toFixed(date.getMinutes());
    case "%a":
      return ((date.getHours() > 11 ? locale2.pm : locale2.am) || emptyAmPm)[0];
    case "%A":
      return ((date.getHours() > 11 ? locale2.pm : locale2.am) || emptyAmPm)[1];
    case "%s":
      return toFixed(date.getSeconds());
    case "%S":
      return toFixedMs(date.getMilliseconds());
    case "%W":
      return toFixed(getWeekNumber(date));
    case "%w":
      return toFixed(getWeekNumber(date, (_a2 = locale2.weekStart) != null ? _a2 : 1));
    case "%c": {
      let str = date.getFullYear() + "";
      str += "-" + toFixed(date.getMonth() + 1);
      str += "-" + toFixed(date.getDate());
      str += "T";
      str += toFixed(date.getHours());
      str += ":" + toFixed(date.getMinutes());
      str += ":" + toFixed(date.getSeconds());
      return str;
    }
    case "%Q":
      return Math.floor(date.getMonth() / 3) + 1;
    default:
      return mask;
  }
}
var formatFlags = /%[a-zA-Z]/g;
function dateToString(format, locale2) {
  if (typeof format == "function") return format;
  return function(date) {
    if (!date) return "";
    if (!date.getMonth) date = new Date(date);
    return format.replace(
      formatFlags,
      (s) => date2str(s, date, locale2)
    );
  };
}
function isObject(a2) {
  return a2 && typeof a2 === "object" && !Array.isArray(a2);
}
function extend(a2, b5) {
  for (const key in b5) {
    const from = b5[key];
    if (isObject(a2[key]) && isObject(from)) {
      a2[key] = extend(
        __spreadValues({}, a2[key]),
        b5[key]
      );
    } else {
      a2[key] = b5[key];
    }
  }
  return a2;
}
function locale(words) {
  return {
    getGroup(group) {
      const block = words[group];
      return (key) => {
        return block ? block[key] || key : key;
      };
    },
    getRaw() {
      return words;
    },
    extend(values, optional) {
      if (!values) return this;
      let data2;
      if (optional) {
        data2 = extend(__spreadValues({}, values), words);
      } else {
        data2 = extend(__spreadValues({}, words), values);
      }
      return locale(data2);
    }
  };
}

// node_modules/@svar-ui/lib-react/dist/index.js
function useWritableProp(propValue) {
  const [value, setValue] = (0, import_react.useState)(propValue);
  const prevPropRef = (0, import_react.useRef)(propValue);
  (0, import_react.useEffect)(() => {
    if (prevPropRef.current !== propValue) {
      if (Array.isArray(prevPropRef.current) && Array.isArray(propValue) && prevPropRef.current.length === 0 && propValue.length === 0)
        return;
      prevPropRef.current = propValue;
      setValue(propValue);
    }
  }, [propValue]);
  return [value, setValue];
}
function useWritable(writable2, initialValue, name) {
  const [state, setState] = (0, import_react.useState)(() => initialValue);
  if (!writable2) console.warn(`Writable ${name} is not defined`);
  (0, import_react.useEffect)(() => {
    if (!writable2) return;
    const unsubscribe = writable2.subscribe((newValue) => {
      setState(() => newValue);
    });
    return unsubscribe;
  }, [writable2]);
  return state;
}
function useStore(store, name) {
  const s = store.getState();
  const r = store.getReactiveState();
  return useWritable(r[name], s[name], name);
}
function useStoreLater(store, name) {
  const [state, setState] = (0, import_react.useState)(() => null);
  (0, import_react.useEffect)(() => {
    if (!store) return;
    const r = store.getReactiveState();
    const wr = r ? r[name] : null;
    if (!wr) return;
    const unsubscribe = wr.subscribe((newValue) => setState(() => newValue));
    return unsubscribe;
  }, [store, name]);
  return state;
}
function useWritableWithCounter(writable2, initialValue) {
  const state = (0, import_react.useRef)(initialValue);
  state.current = initialValue;
  const [counter, setCounter] = (0, import_react.useState)(1);
  (0, import_react.useEffect)(() => {
    const unsubscribe = writable2.subscribe((newValue) => {
      state.current = newValue;
      setCounter((v3) => v3 + 1);
    });
    return unsubscribe;
  }, [writable2]);
  return [state.current, counter];
}
function useStoreWithCounter(store, name) {
  const s = store.getState();
  const r = store.getReactiveState();
  return useWritableWithCounter(r[name], s[name]);
}
function useHotkeys(keys, nodeRef) {
  (0, import_react.useEffect)(() => {
    const node = nodeRef.current;
    if (!node) return;
    return hotkeys.subscribe((sk) => {
      sk.configure(keys, node);
    });
  }, [hotkeys, nodeRef]);
}
function snippet(name, arg) {
  if (typeof name === "function") {
    if (typeof arg === "object") {
      return name(arg);
    } else {
      return name();
    }
  }
  return name;
}
function styleObject(text) {
  const out = {};
  text.split(";").forEach((x2) => {
    const [k4, v3] = x2.split(":");
    if (v3) {
      let n = k4.trim();
      if (n.indexOf("-")) n = n.replace(/-([a-z])/g, (_3, c2) => c2.toUpperCase());
      out[n] = v3.trim();
    }
  });
  return out;
}
function writable(value) {
  let _value = value;
  let listeners = [];
  const subscribe = (cb) => {
    listeners.push(cb);
    cb(_value);
  };
  const unsubscribe = (cb) => {
    listeners = listeners.filter((l2) => l2 !== cb);
  };
  const update = (cb) => {
    _value = cb(_value);
    listeners.forEach((l2) => l2(_value));
  };
  const set = (v3) => {
    _value = v3;
    listeners.forEach((l2) => l2(_value));
  };
  return {
    subscribe,
    unsubscribe,
    set,
    update
  };
}
function delegateEvent2(node, handlers, event) {
  function handleEvent(ev) {
    const node2 = locate(ev);
    if (!node2) return;
    const id$1 = id(node2.dataset.id);
    if (typeof handlers === "function") return handlers(id$1, ev);
    let action;
    let test = ev.target;
    while (test != node2) {
      action = test.dataset ? test.dataset.action : null;
      if (action) {
        if (handlers[action]) {
          handlers[action](id$1, ev);
          return;
        }
      }
      test = test.parentNode;
    }
    if (handlers[event]) handlers[event](id$1, ev);
  }
  return env.addEvent(node, event, handleEvent);
}
function delegateClick2(node, handlers) {
  const result = [delegateEvent2(node, handlers, "click")];
  if (handlers.dblclick)
    result.push(delegateEvent2(node, handlers.dblclick, "dblclick"));
  return () => {
    result.forEach((r) => r());
  };
}

// node_modules/@svar-ui/core-locales/locales/en.js
var lang = "en-US";
var calendar = {
  monthFull: [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December"
  ],
  monthShort: [
    "Jan",
    "Feb",
    "Mar",
    "Apr",
    "May",
    "Jun",
    "Jul",
    "Aug",
    "Sep",
    "Oct",
    "Nov",
    "Dec"
  ],
  dayFull: [
    "Sunday",
    "Monday",
    "Tuesday",
    "Wednesday",
    "Thursday",
    "Friday",
    "Saturday"
  ],
  dayShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
  hours: "Hours",
  minutes: "Minutes",
  done: "Done",
  clear: "Clear",
  today: "Today",
  am: ["am", "AM"],
  pm: ["pm", "PM"],
  weekStart: 0,
  clockFormat: 24
};
var core = {
  ok: "OK",
  cancel: "Cancel",
  select: "Select",
  "No data": "No data",
  "Rows per page": "Rows per page",
  "Total pages": "Total pages"
};
var formats = {
  timeFormat: "%H:%i",
  dateFormat: "%m/%d/%Y",
  monthYearFormat: "%F %Y",
  yearFormat: "%Y"
};
var data = {
  core,
  calendar,
  formats,
  lang
};
var en_default = data;

// node_modules/@svar-ui/react-core/dist/index.es.js
var import_react_dom = __toESM(require_react_dom());
var re = (0, import_react2.createContext)("willow");
var Me = (0, import_react2.createContext)({});
var G = (0, import_react2.createContext)(null);
var se = (0, import_react2.createContext)(null);
var Dt = Object.freeze(Object.defineProperty({
  __proto__: null,
  fieldId: se,
  helpers: Me,
  i18n: G,
  theme: re
}, Symbol.toStringTag, { value: "Module" }));
function z(e) {
  const n = (0, import_react2.useContext)(se), [t2] = (0, import_react2.useState)(() => e || n && n() || uid());
  return t2;
}
function Vt({
  value: e = "",
  id: n,
  placeholder: t2 = "",
  title: c2 = "",
  disabled: r = false,
  error: i = false,
  readonly: o2 = false,
  onChange: s
}) {
  const a2 = z(n), [u, w] = useWritableProp(e), f = (0, import_react2.useCallback)(
    (p2) => {
      const d2 = p2.target.value;
      w(d2), s && s({ value: d2, input: true });
    },
    [s]
  ), x2 = (0, import_react2.useCallback)(
    (p2) => {
      const d2 = p2.target.value;
      w(d2), s && s({ value: d2 });
    },
    [s]
  ), m = (0, import_react2.useRef)(null);
  return (0, import_react2.useEffect)(() => {
    const p2 = x2, d2 = m.current;
    return d2.addEventListener("change", p2), () => {
      d2 && d2.removeEventListener("change", p2);
    };
  }, [x2]), (0, import_jsx_runtime.jsx)(
    "textarea",
    {
      className: `wx-3yFVAC wx-textarea ${i ? "wx-error" : ""}`,
      id: a2,
      disabled: r,
      placeholder: t2,
      readOnly: o2,
      title: c2,
      value: u,
      onInput: f,
      ref: m
    }
  );
}
function ee({
  type: e = "",
  css: n = "",
  icon: t2 = "",
  disabled: c2 = false,
  title: r = "",
  text: i = "",
  children: o2,
  onClick: s
}) {
  const a2 = (0, import_react2.useMemo)(() => {
    let w = e ? e.split(" ").filter((f) => f !== "").map((f) => "wx-" + f).join(" ") : "";
    return n + (n ? " " : "") + w;
  }, [e, n]), u = (w) => {
    s && s(w);
  };
  return (0, import_jsx_runtime.jsxs)(
    "button",
    {
      title: r,
      className: `wx-2ZWgb4 wx-button ${a2} ${t2 && !o2 ? "wx-icon" : ""}`,
      disabled: c2,
      onClick: u,
      children: [
        t2 && (0, import_jsx_runtime.jsx)("i", { className: "wx-2ZWgb4 " + t2 }),
        o2 || i || " "
      ]
    }
  );
}
function Ie({
  id: e,
  label: n = "",
  inputValue: t2 = "",
  value: c2 = false,
  onChange: r,
  disabled: i = false
}) {
  const o2 = z(e), [s, a2] = useWritableProp(c2);
  return (0, import_jsx_runtime.jsxs)("div", { className: "wx-2IvefP wx-checkbox", children: [
    (0, import_jsx_runtime.jsx)(
      "input",
      {
        type: "checkbox",
        id: o2,
        disabled: i,
        className: "wx-2IvefP wx-check",
        checked: s,
        value: t2,
        onChange: ({ target: w }) => {
          const f = w.checked;
          a2(f), r && r({ value: f, inputValue: t2 });
        }
      }
    ),
    (0, import_jsx_runtime.jsxs)("label", { htmlFor: o2, className: "wx-2IvefP wx-label", children: [
      (0, import_jsx_runtime.jsx)("span", { className: "wx-2IvefP wx-before" }),
      n && (0, import_jsx_runtime.jsx)("span", { className: "wx-2IvefP wx-after", children: n })
    ] })
  ] });
}
function te({
  position: e = "bottom",
  align: n = "start",
  autoFit: t2 = true,
  onCancel: c2,
  width: r = "100%",
  children: i
}) {
  const o2 = (0, import_react2.useRef)(null), [s, a2] = useWritableProp(e), [u, w] = useWritableProp(n);
  return (0, import_react2.useEffect)(() => {
    if (t2) {
      const f = o2.current;
      if (f) {
        const x2 = f.getBoundingClientRect(), m = env.getTopNode(f).getBoundingClientRect();
        x2.right >= m.right && w("end"), x2.bottom >= m.bottom && a2("top");
      }
    }
  }, [t2]), (0, import_react2.useEffect)(() => {
    if (o2.current) {
      const f = (x2) => {
        c2 && c2(x2);
      };
      return clickOutside(o2.current, f).destroy;
    }
  }, [c2]), (0, import_jsx_runtime.jsx)(
    "div",
    {
      ref: o2,
      className: `wx-32GZ52 wx-dropdown wx-${s}-${u}`,
      style: { width: r },
      children: i
    }
  );
}
function Z() {
  return locale(en_default);
}
function je() {
  let e = null, n = false, t2, c2, r, i;
  const o2 = (x2, m, p2, d2) => {
    t2 = x2, c2 = m, r = p2, i = d2;
  }, s = (x2) => {
    e = x2, n = e !== null, r(e);
  }, a2 = (x2, m) => {
    if (x2 !== null && t2) {
      const p2 = t2.querySelectorAll(".wx-list > .wx-item")[x2];
      p2 && (p2.scrollIntoView({ block: "nearest" }), m && m.preventDefault());
    }
  }, u = (x2, m) => {
    const p2 = x2 === null ? null : Math.max(0, Math.min(e + x2, c2.length - 1));
    p2 !== e && (s(p2), t2 ? a2(p2, m) : requestAnimationFrame(() => a2(p2, m)));
  };
  return { move: (x2) => {
    const m = locateID(x2), p2 = c2.findIndex((d2) => d2.id == m);
    p2 !== e && s(p2);
  }, keydown: (x2, m) => {
    switch (x2.code) {
      case "Enter":
        n ? i() : s(0);
        break;
      case "Space":
        n || s(0);
        break;
      case "Escape":
        r(e = null);
        break;
      case "Tab":
        r(e = null);
        break;
      case "ArrowDown":
        u(n ? 1 : m || 0, x2);
        break;
      case "ArrowUp":
        u(n ? -1 : m || 0, x2);
        break;
    }
  }, init: o2, navigate: u };
}
function we({
  items: e = [],
  children: n,
  onSelect: t2,
  onReady: c2
}) {
  const r = (0, import_react2.useRef)(), i = (0, import_react2.useRef)(je()), [o2, s] = (0, import_react2.useState)(null), a2 = (0, import_react2.useRef)(o2), u = ((0, import_react2.useContext)(G) || Z()).getGroup("core"), w = (x2) => {
    var _a2;
    x2 && x2.stopPropagation(), t2 && t2({ id: (_a2 = e[a2.current]) == null ? void 0 : _a2.id });
  };
  (0, import_react2.useEffect)(() => {
    i.current.init(
      r.current,
      e,
      (x2) => {
        s(x2), a2.current = x2;
      },
      w
    );
  }, [e, r.current]), (0, import_react2.useEffect)(() => {
    c2 && c2(i.current);
  }, []);
  const f = (0, import_react2.useCallback)(() => {
    i.current.navigate(null);
  }, [i]);
  return o2 === null ? null : (0, import_jsx_runtime.jsx)(te, { onCancel: f, children: (0, import_jsx_runtime.jsx)(
    "div",
    {
      className: "wx-233fr7 wx-list",
      ref: r,
      onClick: w,
      onMouseMove: i.current.move,
      children: e.length ? e.map((x2, m) => (0, import_jsx_runtime.jsx)(
        "div",
        {
          className: `wx-233fr7 wx-item ${m === o2 ? "wx-focus" : ""}`,
          "data-id": x2.id,
          children: n ? snippet(n, { option: x2 }) : x2.label
        },
        x2.id
      )) : (0, import_jsx_runtime.jsx)("div", { className: "wx-233fr7 wx-no-data", children: u("No data") })
    }
  ) });
}
function It({
  value: e = "",
  id: n,
  options: t2 = [],
  textOptions: c2 = null,
  textField: r = "label",
  placeholder: i = "",
  title: o2 = "",
  disabled: s = false,
  error: a2 = false,
  clear: u = false,
  children: w,
  onChange: f
}) {
  const x2 = z(n), m = (0, import_react2.useRef)(null), p2 = (0, import_react2.useRef)(null), [d2, h] = useWritableProp(e), [v3, N5] = (0, import_react2.useState)(false), [R5, g] = (0, import_react2.useState)(""), T4 = (0, import_react2.useRef)(null), M2 = (0, import_react2.useRef)(false), S4 = (0, import_react2.useMemo)(() => {
    if (v3) return R5;
    if (d2 || d2 === 0) {
      const C3 = (c2 || t2).find((U6) => U6.id === d2);
      if (C3) return C3[r];
    }
    return "";
  }, [v3, R5, d2, c2, t2, r]), D3 = (0, import_react2.useMemo)(() => !S4 || !v3 ? t2 : t2.filter(
    (C3) => C3[r].toLowerCase().includes(S4.toLowerCase())
  ), [S4, v3, t2, r]), b5 = (0, import_react2.useCallback)(
    () => D3.findIndex((C3) => C3.id === d2),
    [D3, d2]
  ), k4 = (0, import_react2.useCallback)((C3) => {
    m.current = C3.navigate, p2.current = C3.keydown;
  }, []), F4 = (0, import_react2.useCallback)(
    (C3, U6) => {
      if (C3 || C3 === 0) {
        let K6 = t2.find((V4) => V4.id === C3);
        if (N5(false), U6 && m.current(null), K6 && d2 !== K6.id) {
          const V4 = K6.id;
          h(V4), f && f({ value: V4 });
        }
      }
      !M2.current && U6 && T4.current.focus();
    },
    [t2, d2, f]
  ), A3 = (0, import_react2.useCallback)(
    ({ id: C3 }) => {
      F4(C3, true);
    },
    [F4]
  ), L5 = (0, import_react2.useCallback)(
    (C3) => {
      C3 && C3.stopPropagation(), h(""), N5(false), f && f({ value: "" });
    },
    [f]
  ), I6 = (0, import_react2.useCallback)(
    (C3) => {
      if (!t2.length) return;
      if (C3 === "" && u) {
        L5();
        return;
      }
      let U6 = t2.find((V4) => V4[r] === C3);
      U6 || (U6 = t2.find(
        (V4) => V4[r].toLowerCase().includes(C3.toLowerCase())
      ));
      const K6 = U6 ? U6.id : d2 || t2[0].id;
      F4(K6, false);
    },
    [t2, r, u, d2, F4, L5]
  ), O4 = (0, import_react2.useCallback)(() => {
    g(T4.current.value), N5(true), D3.length ? m.current(0) : m.current(null);
  }, [D3.length, m]), Y4 = (0, import_react2.useCallback)(() => {
    M2.current = true;
  }, []), _3 = (0, import_react2.useCallback)(() => {
    M2.current = false, setTimeout(() => {
      M2.current || I6(S4);
    }, 200);
  }, [I6, S4]);
  return (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: "wx-1j11Jk wx-combo",
      onClick: () => m.current(b5()),
      onKeyDown: (C3) => p2.current(C3, b5()),
      title: o2,
      children: [
        (0, import_jsx_runtime.jsx)(
          "input",
          {
            className: "wx-1j11Jk wx-input " + (a2 ? "wx-error" : ""),
            id: x2,
            ref: T4,
            value: S4,
            disabled: s,
            placeholder: i,
            onFocus: Y4,
            onBlur: _3,
            onInput: O4
          }
        ),
        u && !s && d2 ? (0, import_jsx_runtime.jsx)("i", { className: "wx-1j11Jk wx-icon wxi-close", onClick: L5 }) : (0, import_jsx_runtime.jsx)("i", { className: "wx-1j11Jk wx-icon wxi-angle-down" }),
        !s && (0, import_jsx_runtime.jsx)(we, { items: D3, onReady: k4, onSelect: A3, children: ({ option: C3 }) => (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, { children: w ? w({ option: C3 }) : C3[r] }) })
      ]
    }
  );
}
function fe({
  value: e = "",
  id: n,
  readonly: t2 = false,
  focus: c2 = false,
  select: r = false,
  type: i = "text",
  placeholder: o2 = "",
  disabled: s = false,
  error: a2 = false,
  inputStyle: u = {},
  title: w = "",
  css: f = "",
  icon: x2 = "",
  clear: m = false,
  onChange: p2
}) {
  const d2 = z(n), [h, v3] = useWritableProp(e), N5 = (0, import_react2.useRef)(null), R5 = (0, import_react2.useMemo)(
    () => x2 && f.indexOf("wx-icon-left") === -1 ? "wx-icon-right " + f : f,
    [x2, f]
  ), g = (0, import_react2.useMemo)(
    () => x2 && f.indexOf("wx-icon-left") !== -1,
    [x2, f]
  );
  (0, import_react2.useEffect)(() => {
    const b5 = setTimeout(() => {
      c2 && N5.current && N5.current.focus(), r && N5.current && N5.current.select();
    }, 1);
    return () => clearTimeout(b5);
  }, [c2, r]);
  const T4 = (0, import_react2.useCallback)(
    (b5) => {
      const k4 = b5.target.value;
      v3(k4), p2 && p2({ value: k4, input: true });
    },
    [p2]
  ), M2 = (0, import_react2.useCallback)(
    (b5) => p2 && p2({ value: b5.target.value }),
    [p2]
  );
  function S4(b5) {
    b5.stopPropagation(), v3(""), p2 && p2({ value: "" });
  }
  let D3 = i;
  return i !== "password" && i !== "number" && (D3 = "text"), (0, import_react2.useEffect)(() => {
    const b5 = M2, k4 = N5.current;
    return k4.addEventListener("change", b5), () => {
      k4 && k4.removeEventListener("change", b5);
    };
  }, [M2]), (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: `wx-hQ64J4 wx-text ${R5} ${a2 ? "wx-error" : ""} ${s ? "wx-disabled" : ""} ${m ? "wx-clear" : ""}`,
      children: [
        (0, import_jsx_runtime.jsx)(
          "input",
          {
            className: "wx-hQ64J4 wx-input",
            ref: N5,
            id: d2,
            readOnly: t2,
            disabled: s,
            placeholder: o2,
            type: D3,
            style: u,
            title: w,
            value: h,
            onInput: T4
          }
        ),
        m && !s && h ? (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
          (0, import_jsx_runtime.jsx)("i", { className: "wx-hQ64J4 wx-icon wxi-close", onClick: S4 }),
          g && (0, import_jsx_runtime.jsx)("i", { className: `wx-hQ64J4 wx-icon ${x2}` })
        ] }) : x2 ? (0, import_jsx_runtime.jsx)("i", { className: `wx-hQ64J4 wx-icon ${x2}` }) : null
      ]
    }
  );
}
function Je({ date: e, type: n, part: t2, onShift: c2 }) {
  const { calendar: r, formats: i } = (0, import_react2.useContext)(G).getRaw(), o2 = e.getFullYear(), s = (0, import_react2.useMemo)(() => {
    switch (n) {
      case "month":
        return dateToString(i.monthYearFormat, r)(e);
      case "year":
        return dateToString(i.yearFormat, r)(e);
      case "duodecade": {
        const { start: u, end: w } = getDuodecade(o2), f = dateToString(i.yearFormat, r);
        return `${f(new Date(u, 0, 1))} - ${f(new Date(w, 11, 31))}`;
      }
      default:
        return "";
    }
  }, [e, n, o2, r, i]);
  function a2() {
    c2 && c2({ diff: 0, type: n });
  }
  return (0, import_jsx_runtime.jsxs)("div", { className: "wx-8HQVQV wx-header", children: [
    t2 !== "right" ? (0, import_jsx_runtime.jsx)(
      "i",
      {
        className: "wx-8HQVQV wx-pager wxi-angle-left",
        onClick: () => c2 && c2({ diff: -1, type: n })
      }
    ) : (0, import_jsx_runtime.jsx)("span", { className: "wx-8HQVQV wx-spacer" }),
    (0, import_jsx_runtime.jsx)("span", { className: "wx-8HQVQV wx-label", onClick: a2, children: s }),
    t2 !== "left" ? (0, import_jsx_runtime.jsx)(
      "i",
      {
        className: "wx-8HQVQV wx-pager wxi-angle-right",
        onClick: () => c2 && c2({ diff: 1, type: n })
      }
    ) : (0, import_jsx_runtime.jsx)("span", { className: "wx-8HQVQV wx-spacer" })
  ] });
}
function xe({ onClick: e, children: n }) {
  return (0, import_jsx_runtime.jsx)("button", { className: "wx-3s8W4d wx-button", onClick: e, children: n });
}
function Ge({
  value: e,
  current: n,
  part: t2 = "",
  markers: c2 = null,
  onCancel: r,
  onChange: i
}) {
  const o2 = ((0, import_react2.useContext)(G) || Z()).getRaw().calendar, s = (o2.weekStart || 7) % 7, a2 = o2.dayShort.slice(s).concat(o2.dayShort.slice(0, s)), u = (g, T4, M2) => new Date(
    g.getFullYear(),
    g.getMonth() + (T4 || 0),
    g.getDate() + (M2 || 0)
  );
  let w = t2 !== "normal";
  function f(g) {
    const T4 = g.getDay();
    return T4 === 0 || T4 === 6;
  }
  function x2() {
    const g = u(n, 0, 1 - n.getDate());
    return g.setDate(g.getDate() - (g.getDay() - (s - 7)) % 7), g;
  }
  function m() {
    const g = u(n, 1, -n.getDate());
    return g.setDate(g.getDate() + (6 - g.getDay() + s) % 7), g;
  }
  const p2 = (0, import_react2.useRef)(0);
  function d2(g, T4) {
    T4.timeStamp !== p2.current && (p2.current = T4.timeStamp, T4.stopPropagation(), i && i(new Date(new Date(g))), r && r());
  }
  const h = (0, import_react2.useMemo)(() => t2 == "normal" ? [e ? u(e).valueOf() : 0] : e ? [
    e.start ? u(e.start).valueOf() : 0,
    e.end ? u(e.end).valueOf() : 0
  ] : [0, 0], [t2, e]), v3 = (0, import_react2.useMemo)(() => {
    const g = x2(), T4 = m(), M2 = n.getMonth();
    let S4 = [];
    for (let D3 = g; D3 <= T4; D3.setDate(D3.getDate() + 1)) {
      const b5 = {
        day: D3.getDate(),
        in: D3.getMonth() === M2,
        date: D3.valueOf()
      };
      let k4 = "";
      if (k4 += b5.in ? "" : " wx-inactive", k4 += h.indexOf(b5.date) > -1 ? " wx-selected" : "", w) {
        const F4 = b5.date == h[0], A3 = b5.date == h[1];
        F4 && !A3 ? k4 += " wx-left" : A3 && !F4 && (k4 += " wx-right"), b5.date > h[0] && b5.date < h[1] && (k4 += " wx-inrange");
      }
      if (k4 += f(D3) ? " wx-weekend" : "", c2) {
        const F4 = c2(D3);
        F4 && (k4 += " " + F4);
      }
      S4.push(__spreadProps(__spreadValues({}, b5), { css: k4 }));
    }
    return S4;
  }, [n, h, w, c2]), N5 = (0, import_react2.useRef)(null);
  let R5 = (0, import_react2.useRef)({});
  return R5.current.click = d2, (0, import_react2.useEffect)(() => {
    delegateClick(N5.current, R5.current);
  }, []), (0, import_jsx_runtime.jsxs)("div", { children: [
    (0, import_jsx_runtime.jsx)("div", { className: "wx-398RBS wx-weekdays", children: a2.map((g) => (0, import_jsx_runtime.jsx)("div", { className: "wx-398RBS wx-weekday", children: g }, g)) }),
    (0, import_jsx_runtime.jsx)("div", { className: "wx-398RBS wx-days", ref: N5, children: v3.map((g) => (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: `wx-398RBS wx-day ${g.css} ${g.in ? "" : "wx-out"}`,
        "data-id": g.date,
        children: g.day
      },
      g.date
    )) })
  ] });
}
function Qe({
  value: e,
  current: n,
  part: t2,
  onCancel: c2,
  onChange: r,
  onShift: i
}) {
  const [o2, s] = useWritableProp(e || /* @__PURE__ */ new Date()), [a2, u] = useWritableProp(n || /* @__PURE__ */ new Date()), w = (0, import_react2.useContext)(G).getRaw().calendar, f = w.monthShort || [], x2 = (0, import_react2.useMemo)(() => a2.getMonth(), [a2]), m = (0, import_react2.useCallback)(
    (h, v3) => {
      if (h != null) {
        v3.stopPropagation();
        const N5 = new Date(a2);
        N5.setMonth(h), u(N5), i && i({ current: N5 });
      }
      t2 === "normal" && s(new Date(a2)), c2 && c2();
    },
    [a2, t2, i, c2]
  ), p2 = (0, import_react2.useCallback)(() => {
    const h = new Date(Re(o2, t2) || a2);
    h.setMonth(a2.getMonth()), h.setFullYear(a2.getFullYear()), r && r(h);
  }, [o2, a2, t2, r]), d2 = (0, import_react2.useCallback)(
    (h) => {
      const v3 = h.target.closest("[data-id]");
      if (v3) {
        const N5 = parseInt(v3.getAttribute("data-id"), 10);
        m(N5, h);
      }
    },
    [m]
  );
  return (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    (0, import_jsx_runtime.jsx)("div", { className: "wx-34U8T8 wx-months", onClick: d2, children: f.map((h, v3) => (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: "wx-34U8T8 wx-month" + (x2 === v3 ? " wx-current" : ""),
        "data-id": v3,
        children: h
      },
      v3
    )) }),
    (0, import_jsx_runtime.jsx)("div", { className: "wx-34U8T8 wx-buttons", children: (0, import_jsx_runtime.jsx)(xe, { onClick: p2, children: w.done }) })
  ] });
}
var ie = "wx-1XEF33";
var _e = ({ value: e, current: n, onCancel: t2, onChange: c2, onShift: r, part: i }) => {
  const o2 = (0, import_react2.useContext)(G).getRaw().calendar, [s, a2] = useWritableProp(n), [u, w] = useWritableProp(e), f = (0, import_react2.useMemo)(() => s.getFullYear(), [s]), x2 = (0, import_react2.useMemo)(() => {
    const { start: v3, end: N5 } = getDuodecade(f), R5 = [];
    for (let g = v3; g <= N5; ++g)
      R5.push(g);
    return R5;
  }, [f]), m = {
    click: p2
  };
  function p2(v3, N5) {
    if (v3) {
      N5.stopPropagation();
      const R5 = new Date(s);
      R5.setFullYear(v3), a2(R5), r && r({ current: R5 });
    }
    i === "normal" && w(new Date(s)), t2 && t2();
  }
  function d2() {
    const v3 = new Date(Re(u, i) || s);
    v3.setFullYear(s.getFullYear()), c2 && c2(v3);
  }
  const h = (0, import_react2.useRef)(null);
  return (0, import_react2.useEffect)(() => {
    h.current && delegateClick(h.current, m);
  }, []), (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    (0, import_jsx_runtime.jsx)("div", { className: ie + " wx-years", ref: h, children: x2.map((v3, N5) => (0, import_jsx_runtime.jsx)(
      "div",
      {
        className: ie + ` wx-year ${f == v3 ? "wx-current" : ""} ${N5 === 0 ? "wx-prev-decade" : ""} ${N5 === 11 ? "wx-next-decade" : ""}`,
        "data-id": v3,
        children: v3
      },
      N5
    )) }),
    (0, import_jsx_runtime.jsx)("div", { className: ie + " wx-buttons", children: (0, import_jsx_runtime.jsx)(xe, { onClick: d2, children: o2.done }) })
  ] });
};
var ge = {
  month: {
    component: Ge,
    next: ze,
    prev: Ue
  },
  year: {
    component: Qe,
    next: Ze,
    prev: Ke
  },
  duodecade: {
    component: _e,
    next: Xe,
    prev: qe
  }
};
function Ue(e) {
  return e = new Date(e), e.setMonth(e.getMonth() - 1), e;
}
function ze(e) {
  return e = new Date(e), e.setMonth(e.getMonth() + 1), e;
}
function Ke(e) {
  return e = new Date(e), e.setFullYear(e.getFullYear() - 1), e;
}
function Ze(e) {
  return e = new Date(e), e.setFullYear(e.getFullYear() + 1), e;
}
function qe(e) {
  return e = new Date(e), e.setFullYear(e.getFullYear() - 10), e;
}
function Xe(e) {
  return e = new Date(e), e.setFullYear(e.getFullYear() + 10), e;
}
function Re(e, n) {
  let t2;
  if (n === "normal") t2 = e;
  else {
    const { start: c2, end: r } = e;
    n === "left" ? t2 = c2 : n == "right" ? t2 = r : t2 = c2 && r;
  }
  return t2;
}
var et = ["clear", "today"];
function tt(e) {
  if (e === "done") return -1;
  if (e === "clear") return null;
  if (e === "today") return /* @__PURE__ */ new Date();
}
function ce({
  value: e,
  current: n,
  onCurrentChange: t2,
  part: c2 = "normal",
  markers: r = null,
  buttons: i,
  onShift: o2,
  onChange: s
}) {
  const a2 = (0, import_react2.useContext)(G).getGroup("calendar"), [u, w] = (0, import_react2.useState)("month"), f = Array.isArray(i) ? i : i ? et : [], x2 = (v3, N5) => {
    v3.preventDefault(), s && s({ value: N5 });
  }, m = () => {
    u === "duodecade" ? w("year") : u === "year" && w("month");
  }, p2 = (v3) => {
    const { diff: N5, current: R5 } = v3;
    if (N5 === 0) {
      u === "month" ? w("year") : u === "year" && w("duodecade");
      return;
    }
    if (N5) {
      const g = ge[u];
      t2(N5 > 0 ? g.next(n) : g.prev(n));
    } else R5 && t2(R5);
    o2 && o2();
  }, d2 = (v3) => {
    w("month"), s && s({ select: true, value: v3 });
  }, h = (0, import_react2.useMemo)(() => ge[u].component, [u]);
  return (0, import_jsx_runtime.jsx)(
    "div",
    {
      className: `wx-2Gr4AS wx-calendar ${c2 !== "normal" && c2 !== "both" ? "wx-part" : ""}`,
      children: (0, import_jsx_runtime.jsxs)("div", { className: "wx-2Gr4AS wx-wrap", children: [
        (0, import_jsx_runtime.jsx)(Je, { date: n, part: c2, type: u, onShift: p2 }),
        (0, import_jsx_runtime.jsxs)("div", { children: [
          (0, import_jsx_runtime.jsx)(
            h,
            {
              value: e,
              current: n,
              onCurrentChange: t2,
              part: c2,
              markers: r,
              onCancel: m,
              onChange: d2,
              onShift: p2
            }
          ),
          u === "month" && f.length > 0 && (0, import_jsx_runtime.jsx)("div", { className: "wx-2Gr4AS wx-buttons", children: f.map((v3) => (0, import_jsx_runtime.jsx)("div", { className: "wx-2Gr4AS wx-button-item", children: (0, import_jsx_runtime.jsx)(
            xe,
            {
              onClick: (N5) => x2(N5, tt(v3)),
              children: a2(v3)
            }
          ) }, v3)) })
        ] })
      ] })
    }
  );
}
function ue(e) {
  let { words: n = null, optional: t2 = false, children: c2 } = e, r = (0, import_react2.useContext)(G);
  const i = (0, import_react2.useMemo)(() => {
    let o2 = r;
    return (!o2 || !o2.extend) && (o2 = locale(en_default)), n !== null && (o2 = o2.extend(n, t2)), o2;
  }, [n, t2, r]);
  return (0, import_jsx_runtime.jsx)(G.Provider, { value: i, children: c2 });
}
function Ne(e, n, t2, c2) {
  if (!e || c2) {
    const r = n ? new Date(n) : /* @__PURE__ */ new Date();
    r.setDate(1), t2(r);
  } else if (e.getDate() !== 1) {
    const r = new Date(e);
    r.setDate(1), t2(r);
  }
}
var nt = ["clear", "today"];
function lt({
  value: e,
  current: n,
  markers: t2 = null,
  buttons: c2 = nt,
  onChange: r
}) {
  const [i, o2] = useWritableProp(e), [s, a2] = useWritableProp(n);
  (0, import_react2.useEffect)(() => {
    Ne(s, i, a2, false);
  }, [i, s]);
  const u = (0, import_react2.useCallback)(
    (f) => {
      const x2 = f.value;
      x2 ? (o2(new Date(x2)), Ne(s, new Date(x2), a2, true)) : o2(null), r && r({ value: x2 ? new Date(x2) : null });
    },
    [r, s]
  ), w = (0, import_react2.useCallback)(
    (f) => {
      a2(f);
    },
    [a2]
  );
  return s ? (0, import_jsx_runtime.jsx)(ue, { children: (0, import_jsx_runtime.jsx)(
    ce,
    {
      value: i,
      current: s,
      markers: t2,
      buttons: c2,
      onChange: u,
      onCurrentChange: w
    }
  ) }) : null;
}
var rt = ["clear", "today"];
function Rt({
  value: e,
  id: n,
  disabled: t2 = false,
  error: c2 = false,
  width: r = "unset",
  align: i = "start",
  placeholder: o2 = "",
  format: s = "",
  buttons: a2 = rt,
  css: u = "",
  title: w = "",
  editable: f = false,
  clear: x2 = false,
  onChange: m
}) {
  const { calendar: p2, formats: d2 } = ((0, import_react2.useContext)(G) || Z()).getRaw(), h = s || (d2 == null ? void 0 : d2.dateFormat);
  let v3 = typeof h == "function" ? h : dateToString(h, p2);
  const [N5, R5] = (0, import_react2.useState)(e), [g, T4] = (0, import_react2.useState)(false);
  (0, import_react2.useEffect)(() => {
    R5(e);
  }, [e]);
  function M2() {
    T4(false);
  }
  function S4(k4) {
    const F4 = k4 === N5 || k4 && N5 && k4.valueOf() === N5.valueOf() || !k4 && !N5;
    R5(k4), F4 || m && m({ value: k4 }), setTimeout(M2, 1);
  }
  const D3 = (0, import_react2.useMemo)(
    () => N5 ? v3(N5) : "",
    [N5, v3]
  );
  function b5({ value: k4, input: F4 }) {
    if (!f && !x2 || F4) return;
    let A3 = typeof f == "function" ? f(k4) : k4 ? new Date(k4) : null;
    A3 = isNaN(A3) ? N5 || null : A3 || null, S4(A3);
  }
  return (0, import_react2.useEffect)(() => {
    const k4 = M2;
    return window.addEventListener("scroll", k4), () => window.removeEventListener("scroll", k4);
  }, []), (0, import_jsx_runtime.jsxs)("div", { className: "wx-1lKOFG wx-datepicker", onClick: () => T4(true), children: [
    (0, import_jsx_runtime.jsx)(
      fe,
      {
        css: u,
        title: w,
        value: D3,
        id: n,
        readonly: !f,
        disabled: t2,
        error: c2,
        placeholder: o2,
        onInput: M2,
        onChange: b5,
        icon: "wxi-calendar",
        inputStyle: {
          cursor: "pointer",
          width: "100%",
          paddingRight: "calc(var(--wx-input-icon-size) + var(--wx-input-icon-indent) * 2)"
        },
        clear: x2
      }
    ),
    g && !t2 && (0, import_jsx_runtime.jsx)(
      te,
      {
        onCancel: M2,
        width: r,
        align: i,
        autoFit: !!i,
        children: (0, import_jsx_runtime.jsx)(
          lt,
          {
            buttons: a2,
            value: N5,
            onChange: (k4) => S4(k4.value)
          }
        )
      }
    )
  ] });
}
function Et({
  value: e = "",
  options: n = [],
  textOptions: t2 = null,
  placeholder: c2 = "",
  disabled: r = false,
  error: i = false,
  title: o2 = "",
  textField: s = "label",
  clear: a2 = false,
  children: u,
  onChange: w
}) {
  const f = (0, import_react2.useRef)(null), x2 = (0, import_react2.useRef)(null);
  let [m, p2] = useWritableProp(e);
  function d2(g) {
    f.current = g.navigate, x2.current = g.keydown;
  }
  const h = (0, import_react2.useMemo)(() => m || m === 0 ? (t2 || n).find((g) => g.id === m) : null, [m, t2, n]), v3 = (0, import_react2.useCallback)(
    ({ id: g }) => {
      (g || g === 0) && (p2(g), f.current(null), w && w({ value: g }));
    },
    [p2, w]
  ), N5 = (0, import_react2.useCallback)(
    (g) => {
      g.stopPropagation(), p2(""), w && w({ value: "" });
    },
    [p2, w]
  ), R5 = (0, import_react2.useCallback)(() => n.findIndex((g) => g.id === m), [n, m]);
  return (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: `wx-2YgblL wx-richselect ${i ? "wx-2YgblL wx-error" : ""} ${r ? "wx-2YgblL wx-disabled" : ""} ${u ? "" : "wx-2YgblL wx-nowrap"}`,
      title: o2,
      onClick: () => f.current(R5()),
      onKeyDown: (g) => x2.current(g, R5()),
      tabIndex: 0,
      children: [
        (0, import_jsx_runtime.jsx)("div", { className: "wx-2YgblL wx-label", children: h ? u ? u(h) : h[s] : c2 ? (0, import_jsx_runtime.jsx)("span", { className: "wx-2YgblL wx-placeholder", children: c2 }) : "Â " }),
        a2 && !r && m ? (0, import_jsx_runtime.jsx)("i", { className: "wx-2YgblL wx-icon wxi-close", onClick: N5 }) : (0, import_jsx_runtime.jsx)("i", { className: "wx-2YgblL wx-icon wxi-angle-down" }),
        !r && (0, import_jsx_runtime.jsx)(we, { items: n, onReady: d2, onSelect: v3, children: ({ option: g }) => u ? u(g) : g[s] })
      ]
    }
  );
}
function ke({
  id: e,
  label: n = "",
  css: t2 = "",
  min: c2 = 0,
  max: r = 100,
  value: i = 0,
  step: o2 = 1,
  title: s = "",
  disabled: a2 = false,
  onChange: u
}) {
  const w = z(e), [f, x2] = useWritableProp(i), m = (0, import_react2.useRef)({ value: f, input: f }), p2 = (0, import_react2.useMemo)(
    () => (f - c2) / (r - c2) * 100 + "%",
    [f, c2, r]
  ), d2 = (0, import_react2.useMemo)(() => a2 ? "" : `linear-gradient(90deg, var(--wx-slider-primary) 0% ${p2}, var(--wx-slider-background) ${p2} 100%)`, [a2, p2]);
  function h({ target: R5 }) {
    const g = R5.value * 1;
    x2(g), u && u({
      value: g,
      previous: m.current.input,
      input: true
    }), m.current.input = g;
  }
  function v3({ target: R5 }) {
    const g = R5.value * 1;
    x2(g), u && u({ value: g, previous: m.current.value }), m.current.value = g;
  }
  (0, import_react2.useEffect)(() => {
    x2(i);
  }, [i]);
  const N5 = (0, import_react2.useRef)(null);
  return (0, import_react2.useEffect)(() => {
    if (N5.current)
      return N5.current.addEventListener("change", v3), () => {
        N5.current && N5.current.removeEventListener("change", v3);
      };
  }, [N5, v3]), (0, import_jsx_runtime.jsxs)("div", { className: `wx-2EDJ8G wx-slider ${t2}`, title: s, children: [
    n && (0, import_jsx_runtime.jsx)("label", { className: "wx-2EDJ8G wx-label", htmlFor: w, children: n }),
    (0, import_jsx_runtime.jsx)("div", { className: "wx-2EDJ8G wx-inner", children: (0, import_jsx_runtime.jsx)(
      "input",
      {
        id: w,
        className: "wx-2EDJ8G wx-input",
        type: "range",
        min: c2,
        max: r,
        step: o2,
        disabled: a2,
        value: f,
        onInput: h,
        style: { background: d2 },
        ref: N5
      }
    ) })
  ] });
}
var jt = ({
  id: e,
  value: n = 0,
  step: t2 = 1,
  min: c2 = 0,
  max: r = 1 / 0,
  error: i = false,
  disabled: o2 = false,
  readonly: s = false,
  onChange: a2
}) => {
  const u = z(e), [w, f] = useWritableProp(n), x2 = (0, import_react2.useCallback)(() => {
    if (s || w <= c2) return;
    const h = w - t2;
    f(h), a2 && a2({ value: h });
  }, [w, s, c2, t2, a2]), m = (0, import_react2.useCallback)(() => {
    if (s || w >= r) return;
    const h = w + t2;
    f(h), a2 && a2({ value: h });
  }, [w, s, r, t2, a2]), p2 = (0, import_react2.useCallback)(() => {
    if (!s) {
      const h = Math.round(Math.min(r, Math.max(w, c2)) / t2) * t2, v3 = isNaN(h) ? Math.max(c2, 0) : h;
      f(v3), a2 && a2({ value: v3 });
    }
  }, [s, w, r, c2, t2, a2]), d2 = (0, import_react2.useCallback)(
    (h) => {
      const v3 = h.target.value * 1;
      f(v3), a2 && a2({ value: v3, input: true });
    },
    [a2]
  );
  return (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: `wx-22t21n wx-counter ${o2 ? "wx-disabled" : ""} ${s ? "wx-readonly" : ""} ${i ? "wx-error" : ""}`,
      children: [
        (0, import_jsx_runtime.jsx)(
          "button",
          {
            "aria-label": "-",
            className: "wx-22t21n wx-btn wx-btn-dec",
            disabled: o2,
            onClick: x2,
            children: (0, import_jsx_runtime.jsx)(
              "svg",
              {
                className: "wx-22t21n wx-dec",
                width: "12",
                height: "2",
                viewBox: "0 0 12 2",
                fill: "none",
                xmlns: "http://www.w3.org/2000/svg",
                children: (0, import_jsx_runtime.jsx)("path", { d: "M11.2501 1.74994H0.750092V0.249939H11.2501V1.74994Z" })
              }
            )
          }
        ),
        (0, import_jsx_runtime.jsx)(
          "input",
          {
            id: u,
            type: "text",
            className: "wx-22t21n wx-input",
            disabled: o2,
            readOnly: s,
            required: true,
            value: w,
            onBlur: p2,
            onInput: d2
          }
        ),
        (0, import_jsx_runtime.jsx)(
          "button",
          {
            "aria-label": "-",
            className: "wx-22t21n wx-btn wx-btn-inc",
            disabled: o2,
            onClick: m,
            children: (0, import_jsx_runtime.jsx)(
              "svg",
              {
                className: "wx-22t21n wx-inc",
                width: "12",
                height: "12",
                viewBox: "0 0 12 12",
                fill: "none",
                xmlns: "http://www.w3.org/2000/svg",
                children: (0, import_jsx_runtime.jsx)(
                  "path",
                  {
                    d: `M11.2501
								6.74994H6.75009V11.2499H5.25009V6.74994H0.750092V5.24994H5.25009V0.749939H6.75009V5.24994H11.2501V6.74994Z`
                  }
                )
              }
            )
          }
        )
      ]
    }
  );
};
function ut({ notice: e = {} }) {
  function n() {
    e.remove && e.remove();
  }
  return (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: `wx-11sNg5 wx-notice wx-${e.type ? e.type : ""}`,
      role: "status",
      "aria-live": "polite",
      children: [
        (0, import_jsx_runtime.jsx)("div", { className: "wx-11sNg5 wx-text", children: e.text }),
        (0, import_jsx_runtime.jsx)("div", { className: "wx-11sNg5 wx-button", children: (0, import_jsx_runtime.jsx)("i", { className: "wx-11sNg5 wxi-close", onClick: n }) })
      ]
    }
  );
}
function dt({ data: e = [] }) {
  return (0, import_jsx_runtime.jsx)("div", { className: "wx-3nwoO9 wx-notices", children: e.map((n) => (0, import_jsx_runtime.jsx)(ut, { notice: n }, n.id)) });
}
function wt({
  title: e = "",
  buttons: n = ["cancel", "ok"],
  header: t2,
  children: c2,
  footer: r,
  onConfirm: i,
  onCancel: o2
}) {
  const s = ((0, import_react2.useContext)(G) || Z()).getGroup("core"), a2 = (0, import_react2.useRef)(null);
  (0, import_react2.useEffect)(() => {
    var _a2;
    (_a2 = a2.current) == null ? void 0 : _a2.focus();
  }, []);
  function u(f) {
    switch (f.code) {
      case "Enter": {
        const x2 = f.target.tagName;
        if (x2 === "TEXTAREA" || x2 === "BUTTON") return;
        i && i({ event: f });
        break;
      }
      case "Escape":
        o2 && o2({ event: f });
        break;
    }
  }
  function w(f, x2) {
    const m = { event: f, button: x2 };
    x2 === "cancel" ? o2 && o2(m) : i && i(m);
  }
  return (0, import_jsx_runtime.jsx)(
    "div",
    {
      className: "wx-1FxkZa wx-modal",
      ref: a2,
      tabIndex: 0,
      onKeyDown: u,
      children: (0, import_jsx_runtime.jsxs)("div", { className: "wx-1FxkZa wx-window", children: [
        t2 || (e ? (0, import_jsx_runtime.jsx)("div", { className: "wx-1FxkZa wx-header", children: e }) : null),
        (0, import_jsx_runtime.jsx)("div", { children: c2 }),
        r || n && (0, import_jsx_runtime.jsx)("div", { className: "wx-1FxkZa wx-buttons", children: n.map((f) => (0, import_jsx_runtime.jsx)("div", { className: "wx-1FxkZa wx-button", children: (0, import_jsx_runtime.jsx)(
          ee,
          {
            type: `block ${f === "ok" ? "primary" : "secondary"}`,
            onClick: (x2) => w(x2, f),
            children: s(f)
          }
        ) }, f)) })
      ] })
    }
  );
}
function ft({ children: e }, n) {
  const [t2, c2] = (0, import_react2.useState)(null), [r, i] = (0, import_react2.useState)([]);
  return (0, import_react2.useImperativeHandle)(
    n,
    () => ({
      showModal: (o2) => {
        const s = __spreadValues({}, o2);
        return c2(s), new Promise((a2, u) => {
          s.resolve = (w) => {
            c2(null), a2(w);
          }, s.reject = (w) => {
            c2(null), u(w);
          };
        });
      },
      showNotice: (o2) => {
        o2 = __spreadValues({}, o2), o2.id = o2.id || uid(), o2.remove = () => i((s) => s.filter((a2) => a2.id !== o2.id)), o2.expire != -1 && setTimeout(o2.remove, o2.expire || 5100), i((s) => [...s, o2]);
      }
    }),
    []
  ), (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    e,
    t2 && (0, import_jsx_runtime.jsx)(
      wt,
      {
        title: t2.title,
        buttons: t2.buttons,
        onConfirm: t2.resolve,
        onCancel: t2.reject,
        children: t2.message
      }
    ),
    (0, import_jsx_runtime.jsx)(dt, { data: r })
  ] });
}
var xt = (0, import_react2.forwardRef)(ft);
function ye({
  label: e = "",
  position: n = "",
  css: t2 = "",
  error: c2 = false,
  type: r = "",
  required: i = false,
  children: o2
}) {
  const s = (0, import_react2.useRef)(null), a2 = (0, import_react2.useCallback)(() => {
    if (s.current) return s.current;
    const u = uid();
    return s.current = u, u;
  }, []);
  return (0, import_jsx_runtime.jsx)(se.Provider, { value: a2, children: (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: `wx-2oVUvC wx-field wx-${n} ${t2} ${c2 ? "wx-error" : ""} ${i ? "wx-required" : ""}`.trim(),
      children: [
        e && (0, import_jsx_runtime.jsx)("label", { className: "wx-2oVUvC wx-label", htmlFor: s.current, children: e }),
        (0, import_jsx_runtime.jsx)("div", { className: `wx-2oVUvC wx-field-control wx-${r}`, children: o2 })
      ]
    }
  ) });
}
var mt = ({
  value: e = false,
  type: n = "",
  icon: t2 = "",
  disabled: c2 = false,
  iconActive: r = "",
  onClick: i,
  title: o2 = "",
  css: s = "",
  text: a2 = "",
  textActive: u = "",
  children: w,
  active: f,
  onChange: x2
}) => {
  const [m, p2] = useWritableProp(e), d2 = (0, import_react2.useMemo)(() => (m ? "pressed" : "") + (n ? " " + n : ""), [m, n]), h = (0, import_react2.useCallback)(
    (v3) => {
      let N5 = !m;
      i && i(v3), v3.defaultPrevented || (p2(N5), x2 && x2({ value: N5 }));
    },
    [m, i, x2]
  );
  return m && f ? (0, import_jsx_runtime.jsx)(
    ee,
    {
      title: o2,
      text: m && u || a2,
      css: s,
      type: d2,
      icon: m && r || t2,
      onClick: h,
      disabled: c2,
      children: snippet(f, { value: m })
    }
  ) : w ? (0, import_jsx_runtime.jsx)(
    ee,
    {
      title: o2,
      text: m && u || a2,
      css: s,
      type: d2,
      icon: m && r || t2,
      onClick: h,
      disabled: c2,
      children: w
    }
  ) : (0, import_jsx_runtime.jsx)(
    ee,
    {
      title: o2,
      text: m && u || a2,
      css: s,
      type: d2,
      icon: m && r || t2,
      onClick: h,
      disabled: c2
    }
  );
};
var be = new Date(0, 0, 0, 0, 0);
function Gt({
  value: e = be,
  id: n,
  title: t2 = "",
  css: c2 = "",
  disabled: r = false,
  error: i = false,
  format: o2 = "",
  onChange: s
}) {
  let [a2, u] = useWritableProp(e);
  const { calendar: w, formats: f } = ((0, import_react2.useContext)(G) || Z()).getRaw(), x2 = w.clockFormat == 12, m = 23, p2 = 59, d2 = (0, import_react2.useMemo)(() => {
    const V4 = o2 || (f == null ? void 0 : f.timeFormat);
    return typeof V4 == "function" ? V4 : dateToString(V4, w);
  }, [o2, f, w]), h = (0, import_react2.useMemo)(() => d2(new Date(0, 0, 0, 1)).indexOf("01") != -1, [d2]), v3 = (V4, j4) => (V4 < 10 && j4 ? `0${V4}` : `${V4}`).slice(-2), N5 = (V4) => v3(V4, true), R5 = (V4) => `${V4}`.replace(/[^\d]/g, "") || 0, g = (V4) => x2 && (V4 = V4 % 12, V4 === 0) ? "12" : v3(V4, h), T4 = (0, import_react2.useCallback)((V4, j4) => (V4 = R5(V4), Math.min(V4, j4)), []), [M2, S4] = (0, import_react2.useState)(null), D3 = a2 || be, b5 = T4(D3.getHours(), m), k4 = T4(D3.getMinutes(), p2), F4 = b5 > 12, A3 = g(b5), L5 = N5(k4), I6 = (0, import_react2.useMemo)(
    () => d2(new Date(0, 0, 0, b5, k4)),
    [b5, k4, d2]
  ), O4 = (0, import_react2.useCallback)(() => {
    S4(true);
  }, []), Y4 = (0, import_react2.useCallback)(() => {
    const V4 = new Date(D3);
    V4.setHours(V4.getHours() + (F4 ? -12 : 12)), u(V4), s && s({ value: V4 });
  }, [D3, F4, s]), _3 = (0, import_react2.useCallback)(
    ({ value: V4 }) => {
      if (D3.getHours() === V4) return;
      const j4 = new Date(D3);
      j4.setHours(V4), u(j4), s && s({ value: j4 });
    },
    [D3, s]
  ), C3 = (0, import_react2.useCallback)(
    ({ value: V4 }) => {
      if (D3.getMinutes() === V4) return;
      const j4 = new Date(D3);
      j4.setMinutes(V4), u(j4), s && s({ value: j4 });
    },
    [D3, s]
  ), U6 = (0, import_react2.useCallback)(
    (V4) => (V4 = T4(V4, m), x2 && (V4 = V4 * 1, V4 === 12 && (V4 = 0), F4 && (V4 += 12)), V4),
    [T4, x2, F4]
  ), K6 = (0, import_react2.useCallback)(() => {
    S4(null);
  }, []);
  return (0, import_jsx_runtime.jsxs)(
    "div",
    {
      className: `wx-7f497i wx-timepicker ${i ? "wx-7f497i wx-error" : ""} ${r ? "wx-7f497i wx-disabled" : ""}`,
      onClick: r ? void 0 : O4,
      style: { cursor: r ? "default" : "pointer" },
      children: [
        (0, import_jsx_runtime.jsx)(
          fe,
          {
            id: n,
            css: c2,
            title: t2,
            value: I6,
            readonly: true,
            disabled: r,
            error: i,
            icon: "wxi-clock",
            inputStyle: {
              cursor: "pointer",
              width: "100%",
              paddingRight: "calc(var(--wx-input-icon-size) + var(--wx-input-icon-indent) * 2)"
            }
          }
        ),
        M2 && !r && (0, import_jsx_runtime.jsx)(te, { onCancel: K6, width: "unset", children: (0, import_jsx_runtime.jsxs)("div", { className: "wx-7f497i wx-wrapper", children: [
          (0, import_jsx_runtime.jsxs)("div", { className: "wx-7f497i wx-timer", children: [
            (0, import_jsx_runtime.jsx)(
              "input",
              {
                className: "wx-7f497i wx-digit",
                value: A3,
                onChange: (V4) => {
                  const j4 = U6(V4.target.value);
                  _3({ value: j4 });
                }
              }
            ),
            (0, import_jsx_runtime.jsx)("div", { className: "wx-7f497i wx-separator", children: ":" }),
            (0, import_jsx_runtime.jsx)(
              "input",
              {
                className: "wx-7f497i wx-digit",
                value: L5,
                onChange: (V4) => {
                  const j4 = T4(V4.target.value, p2);
                  C3({ value: j4 });
                }
              }
            ),
            x2 && (0, import_jsx_runtime.jsx)(
              mt,
              {
                value: F4,
                onClick: Y4,
                active: () => (0, import_jsx_runtime.jsx)("span", { children: "pm" }),
                children: (0, import_jsx_runtime.jsx)("span", { children: "am" })
              }
            )
          ] }),
          (0, import_jsx_runtime.jsx)(ye, { width: "unset", children: (0, import_jsx_runtime.jsx)(
            ke,
            {
              label: w.hours,
              value: b5,
              onChange: _3,
              max: m
            }
          ) }),
          (0, import_jsx_runtime.jsx)(ye, { width: "unset", children: (0, import_jsx_runtime.jsx)(
            ke,
            {
              label: w.minutes,
              value: k4,
              onChange: C3,
              max: p2
            }
          ) })
        ] }) })
      ]
    }
  );
}
function Qt({ children: e }) {
  return (0, import_jsx_runtime.jsx)("div", { className: "wx-KgpO9N wx-modal", children: (0, import_jsx_runtime.jsx)("div", { className: "wx-KgpO9N wx-window", children: e }) });
}
function _t({ position: e = "right", children: n, onCancel: t2 }) {
  const c2 = (0, import_react2.useRef)(null);
  return (0, import_react2.useEffect)(() => clickOutside(c2.current, t2).destroy, []), (0, import_jsx_runtime.jsx)("div", { ref: c2, className: `wx-2L733M wx-sidearea wx-pos-${e}`, children: n });
}
function Ut({ theme: e = "", target: n, children: t2 }) {
  const c2 = (0, import_react2.useRef)(null), r = (0, import_react2.useRef)(null), [i, o2] = (0, import_react2.useState)(null);
  c2.current || (c2.current = document.createElement("div"));
  const s = (0, import_react2.useContext)(re);
  return (0, import_react2.useEffect)(() => {
    o2(
      n || ht(r.current) || env.getTopNode(r.current)
    );
  }, [r.current]), (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    (0, import_jsx_runtime.jsx)("span", { ref: r, style: { display: "none" } }),
    r.current && i ? (0, import_react_dom.createPortal)(
      (0, import_jsx_runtime.jsx)(
        "div",
        {
          className: `wx-3ZWsT0 wx-${e || s}-theme`,
          children: t2
        }
      ),
      i
    ) : null
  ] });
}
function ht(e) {
  const n = env.getTopNode(e);
  for (; e && e !== n && !e.getAttribute("data-wx-portal-root"); )
    e = e.parentNode;
  return e;
}
function pt() {
  return (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {});
}
function zt(e) {
  const { fonts: n = true, children: t2 } = e;
  return (0, import_jsx_runtime.jsx)(re.Provider, { value: "material", children: (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    t2 && (0, import_jsx_runtime.jsx)("div", { className: "wx-theme wx-material-theme", children: t2 }),
    n && (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
      (0, import_jsx_runtime.jsx)(
        "link",
        {
          rel: "preconnect",
          href: "https://cdn.svar.dev",
          crossOrigin: "true"
        }
      ),
      (0, import_jsx_runtime.jsx)(pt, {}),
      (0, import_jsx_runtime.jsx)(
        "link",
        {
          rel: "stylesheet",
          href: "https://cdn.svar.dev/fonts/wxi/wx-icons.css"
        }
      )
    ] })
  ] }) });
}
function Se() {
  return (0, import_jsx_runtime.jsx)(import_jsx_runtime.Fragment, {});
}
function Kt(e) {
  const { fonts: n = true, children: t2 } = e;
  return (0, import_jsx_runtime.jsx)(re.Provider, { value: "willow", children: (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    t2 && t2 && (0, import_jsx_runtime.jsx)("div", { className: "wx-theme wx-willow-theme", children: t2 }),
    n && (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
      (0, import_jsx_runtime.jsx)(
        "link",
        {
          rel: "preconnect",
          href: "https://cdn.svar.dev",
          crossOrigin: "true"
        }
      ),
      (0, import_jsx_runtime.jsx)(Se, {}),
      (0, import_jsx_runtime.jsx)(
        "link",
        {
          rel: "stylesheet",
          href: "https://cdn.svar.dev/fonts/wxi/wx-icons.css"
        }
      )
    ] })
  ] }) });
}
function Zt(e) {
  const { fonts: n = true, children: t2 } = e;
  return (0, import_jsx_runtime.jsx)(re.Provider, { value: "willow-dark", children: (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
    t2 && t2 && (0, import_jsx_runtime.jsx)("div", { className: "wx-theme wx-willow-dark-theme", children: t2 }),
    n && (0, import_jsx_runtime.jsxs)(import_jsx_runtime.Fragment, { children: [
      (0, import_jsx_runtime.jsx)(
        "link",
        {
          rel: "preconnect",
          href: "https://cdn.svar.dev",
          crossOrigin: "true"
        }
      ),
      (0, import_jsx_runtime.jsx)(Se, {}),
      (0, import_jsx_runtime.jsx)(
        "link",
        {
          rel: "stylesheet",
          href: "https://cdn.svar.dev/fonts/wxi/wx-icons.css"
        }
      )
    ] })
  ] }) });
}
setEnv(env);

// node_modules/@svar-ui/gantt-locales/locales/en.js
var en_default2 = {
  gantt: {
    // Header / sidebar
    "Task name": "Task name",
    "Start date": "Start date",
    "Add task": "Add task",
    Duration: "Duration",
    Task: "Task",
    Milestone: "Milestone",
    "Summary task": "Summary task",
    // Sidebar
    Save: "Save",
    Delete: "Delete",
    Name: "Name",
    Description: "Description",
    "Select type": "Select type",
    Type: "Type",
    "End date": "End date",
    Progress: "Progress",
    Predecessors: "Predecessors",
    Successors: "Successors",
    "Add task name": "Add task name",
    "Add description": "Add description",
    "Select link type": "Select link type",
    "End-to-start": "End-to-start",
    "Start-to-start": "Start-to-start",
    "End-to-end": "End-to-end",
    "Start-to-end": "Start-to-end",
    // Context menu / toolbar
    Add: "Add",
    "Child task": "Child task",
    "Task above": "Task above",
    "Task below": "Task below",
    "Convert to": "Convert to",
    Edit: "Edit",
    Cut: "Cut",
    Copy: "Copy",
    Paste: "Paste",
    Move: "Move",
    Up: "Up",
    Down: "Down",
    Indent: "Indent",
    Outdent: "Outdent",
    "Split task": "Split task",
    Segment: "Segment",
    // Toolbar
    "New task": "New task",
    "Move up": "Move up",
    "Move down": "Move down",
    Undo: "Undo",
    Redo: "Redo",
    // Formats
    Week: "Week",
    Q: "Quarter"
  }
};

// node_modules/@svar-ui/lib-state/dist/index.js
var iid = (/* @__PURE__ */ new Date()).valueOf();
var uid2 = () => iid++;
function isSameObject(left, right) {
  if (Object.keys(left).length !== Object.keys(right).length) return false;
  for (const key in right) {
    const v3 = left[key];
    const nv = right[key];
    if (!isSame(v3, nv)) return false;
  }
  return true;
}
function isSame(v3, nv) {
  const primitiveValue = typeof v3 === "number" || typeof v3 === "string" || typeof v3 === "boolean" || v3 === null;
  if (primitiveValue) return v3 === nv;
  if (typeof v3 !== typeof nv) return false;
  if ((v3 === null || nv === null) && v3 !== nv) return false;
  if (v3 instanceof Date && nv instanceof Date && v3.getTime() !== nv.getTime())
    return false;
  if (typeof v3 === "object") {
    if (Array.isArray(v3) && Array.isArray(nv)) {
      if (v3.length !== nv.length) return false;
      for (let i = v3.length - 1; i >= 0; i--) {
        if (!isSame(v3[i], nv[i])) return false;
      }
      return true;
    } else {
      return isSameObject(v3, nv);
    }
  }
  return v3 === nv;
}
function deepCopy(obj) {
  if (typeof obj !== "object") return obj;
  if (obj === null) return obj;
  if (obj instanceof Date) return new Date(obj);
  if (obj instanceof Array) return obj.map(deepCopy);
  const out = {};
  for (const key in obj) {
    out[key] = deepCopy(obj[key]);
  }
  return out;
}
var EventBusRouter = class {
  constructor(dispatch) {
    this._nextHandler = null;
    this._dispatch = dispatch;
    this.exec = this.exec.bind(this);
  }
  exec(name, ev) {
    return __async(this, null, function* () {
      this._dispatch(name, ev);
      if (this._nextHandler) yield this._nextHandler.exec(name, ev);
      return ev;
    });
  }
  setNext(next) {
    return this._nextHandler = next;
  }
};

// node_modules/@svar-ui/gantt-store/dist/index.js
var Tt = (/* @__PURE__ */ new Date()).valueOf();
var ve = () => Tt++;
function nt2() {
  return "temp://" + Tt++;
}
var Wt = class {
  constructor(t2) {
    this._data = t2, this._pool = /* @__PURE__ */ new Map();
    for (let e = 0; e < t2.length; e++) {
      const n = t2[e];
      this._pool.set(n.id, n);
    }
  }
  add(t2) {
    t2 = __spreadValues({ id: ve() }, t2), this._data.push(t2), this._pool.set(t2.id, t2);
  }
  update(t2, e) {
    const n = this._data.findIndex((s) => s.id == t2), a2 = __spreadValues(__spreadValues({}, this._data[n]), e);
    this._data[n] = a2, this._pool.set(a2.id, a2);
  }
  remove(t2) {
    this._data = this._data.filter((e) => e.id != t2), this._pool.delete(t2);
  }
  filter(t2) {
    this._data = this._data.filter((e) => {
      const n = t2(e);
      return n || this._pool.delete(e.id), n;
    });
  }
  byId(t2) {
    return this._pool.get(t2);
  }
  map(t2) {
    return this._data.map(t2);
  }
  forEach(t2) {
    this._data.forEach(t2);
  }
};
var Se2 = class {
  constructor(t2) {
    const e = { id: 0, $level: 0, data: [], parent: null }, n = /* @__PURE__ */ new Map();
    n.set(0, e), this._pool = n, t2 && t2.length && this.parse(t2, 0);
  }
  parse(t2, e) {
    const n = this._pool;
    for (let s = 0; s < t2.length; s++) {
      const r = t2[s];
      r.parent = r.parent || e, r.data = null, n.set(r.id, r);
    }
    for (let s = 0; s < t2.length; s++) {
      const r = t2[s], i = n.get(r.parent);
      i && (i.data || (i.data = []), i.data.push(r));
    }
    const a2 = n.get(e);
    this.setLevel(a2, a2.$level + 1, false);
  }
  add(t2, e) {
    const n = this._pool.get(t2.parent || 0);
    t2.$level = n.$level + 1, this._pool.set(t2.id, t2), n.data ? e === -1 ? n.data = [...n.data, t2] : It2(n, e, t2) : n.data = [t2];
  }
  addAfter(t2, e) {
    if (!e) return this.add(t2, -1);
    const n = this.byId(e), a2 = this.byId(n.parent), s = G2(a2, n.id) + 1;
    t2.parent = a2.id, t2.$level = a2.$level + 1, this.add(t2, s);
  }
  remove(t2) {
    const e = this._pool.get(t2);
    this._remove(e);
    const n = this._pool.get(e.parent);
    n.data = n.data.filter((a2) => a2.id != t2), this._clearBranch(n);
  }
  _remove(t2) {
    t2.data && t2.data.forEach((e) => this._remove(e)), this._pool.delete(t2.id);
  }
  update(t2, e) {
    let n = this._pool.get(t2);
    const a2 = this._pool.get(n.parent), s = G2(a2, n.id);
    n = __spreadValues(__spreadValues({}, n), e), a2 && s >= 0 && (a2.data[s] = n, a2.data = [...a2.data]), this._pool.set(n.id, n);
  }
  move(t2, e, n) {
    const a2 = this._pool.get(t2), s = e === "child", r = this._pool.get(n), i = r.$level + (s ? 1 : 0);
    if (!a2 || !r) return;
    const o2 = this._pool.get(a2.parent), c2 = s ? r : this._pool.get(r.parent);
    c2.data || (c2.data = []);
    const d2 = G2(o2, a2.id);
    Me2(o2, d2);
    const u = s ? c2.data.length : G2(c2, r.id) + (e === "after" ? 1 : 0);
    if (It2(c2, u, a2), o2.id === c2.id && d2 === u) return null;
    a2.parent = c2.id, a2.$level !== i && (a2.$level = i, this.setLevel(a2, i + 1, true)), this.update(a2.id, a2), this._clearBranch(o2);
  }
  _clearBranch(t2) {
    t2.data && !t2.data.length && (t2.open && delete t2.open, this.update(t2.id, { data: null }));
  }
  toArray() {
    const t2 = [], e = this._pool.get(0).data;
    return e && $t(e, t2), t2;
  }
  byId(t2) {
    return this._pool.get(t2);
  }
  getBranch(t2) {
    return this._pool.get(t2).data;
  }
  forEach(t2) {
    this._pool.forEach((e, n) => {
      n !== 0 && t2(e);
    });
  }
  eachChild(t2, e) {
    const n = this.byId(e);
    !n || !n.data || n.data.forEach((a2, s) => {
      t2(this.byId(a2.id), s), this.eachChild(t2, a2.id);
    });
  }
  setLevel(t2, e, n) {
    t2.data && (t2.data = t2.data.map((a2) => (n && (a2 = __spreadValues({}, a2), this._pool.set(a2.id, a2)), a2.$level = e, a2.data && this.setLevel(a2, e + 1, n), a2)));
  }
};
function $t(t2, e) {
  t2.forEach((n) => {
    e.push(n), n.open === true && $t(n.data, e);
  });
}
function Me2(t2, e) {
  const n = [...t2.data];
  n.splice(e, 1), t2.data = n;
}
function It2(t2, e, n) {
  const a2 = [...t2.data];
  a2.splice(e, 0, n), t2.data = a2;
}
function G2(t2, e) {
  return t2 == null ? void 0 : t2.data.findIndex((n) => n.id === e);
}
var Pt = 2;
var De = class {
  constructor(t2) {
    t2 && (this._writable = t2.writable, this._async = t2.async), this._values = {}, this._state = {};
  }
  setState(t2, e = 0) {
    const n = {};
    return this._wrapProperties(t2, this._state, this._values, "", n, e), n;
  }
  getState() {
    return this._values;
  }
  getReactive() {
    return this._state;
  }
  _wrapProperties(t2, e, n, a2, s, r) {
    for (const i in t2) {
      const o2 = e[i], c2 = n[i], d2 = t2[i];
      if (o2 && (c2 === d2 && typeof d2 != "object" || d2 instanceof Date && c2 instanceof Date && c2.getTime() === d2.getTime())) continue;
      const u = a2 + (a2 ? "." : "") + i;
      o2 ? (o2.__parse(d2, u, s, r) && (n[i] = d2), r & Pt ? s[u] = o2.__trigger : o2.__trigger()) : (d2 && d2.__reactive ? e[i] = this._wrapNested(d2, d2, u, s) : e[i] = this._wrapWritable(d2), n[i] = d2), s[u] = s[u] || null;
    }
  }
  _wrapNested(t2, e, n, a2) {
    const s = this._wrapWritable(t2);
    return this._wrapProperties(t2, s, e, n, a2, 0), s.__parse = (r, i, o2, c2) => (this._wrapProperties(r, s, e, i, o2, c2), false), s;
  }
  _wrapWritable(t2) {
    const e = [], n = function() {
      for (let a2 = 0; a2 < e.length; a2++) e[a2](t2);
    };
    return { subscribe: (a2) => (e.push(a2), this._async ? setTimeout(a2, 1, t2) : a2(t2), () => {
      const s = e.indexOf(a2);
      s >= 0 && e.splice(s, 1);
    }), __trigger: () => {
      e.length && (this._async ? setTimeout(n, 1) : n());
    }, __parse: function(a2) {
      return t2 = a2, true;
    } };
  }
};
var Te = class {
  constructor(t2, e, n, a2) {
    typeof t2 == "function" ? this._setter = t2 : this._setter = t2.setState.bind(t2), this._routes = e, this._parsers = n, this._prev = {}, this._triggers = /* @__PURE__ */ new Map(), this._sources = /* @__PURE__ */ new Map(), this._routes.forEach((s) => {
      s.in.forEach((r) => {
        const i = this._triggers.get(r) || [];
        i.push(s), this._triggers.set(r, i);
      }), s.out.forEach((r) => {
        const i = this._sources.get(r) || {};
        s.in.forEach((o2) => i[o2] = true), this._sources.set(r, i);
      });
    }), this._routes.forEach((s) => {
      s.length = Math.max(...s.in.map((r) => Ct(r, this._sources, 1)));
    }), this._bus = a2;
  }
  init(t2) {
    const e = {};
    for (const n in t2) if (this._prev[n] !== t2[n]) {
      const a2 = this._parsers[n];
      e[n] = a2 ? a2(t2[n]) : t2[n];
    }
    this._prev = this._prev ? __spreadValues(__spreadValues({}, this._prev), t2) : __spreadValues({}, t2), this.setState(e), this._bus && this._bus.exec("init-state", e);
  }
  setStateAsync(t2) {
    const e = this._setter(t2, Pt);
    return this._async ? Object.assign(this._async.signals, e) : this._async = { signals: e, timer: setTimeout(this._applyState.bind(this), 1) }, e;
  }
  _applyState() {
    const t2 = this._async;
    if (t2) {
      this._async = null, this._triggerUpdates(t2.signals, []);
      for (const e in t2.signals) {
        const n = t2.signals[e];
        n && n();
      }
    }
  }
  setState(t2, e = []) {
    const n = this._setter(t2);
    return this._triggerUpdates(n, e), n;
  }
  _triggerUpdates(t2, e) {
    const n = Object.keys(t2), a2 = !e.length;
    e = e || [];
    for (let s = 0; s < n.length; s++) {
      const r = n[s], i = this._triggers.get(r);
      i && i.forEach((o2) => {
        e.indexOf(o2) == -1 && e.push(o2);
      });
    }
    a2 && this._execNext(e);
  }
  _execNext(t2) {
    for (; t2.length; ) {
      t2.sort((n, a2) => n.length < a2.length ? 1 : -1);
      const e = t2[t2.length - 1];
      t2.splice(t2.length - 1), e.exec(t2);
    }
  }
};
function Ct(t2, e, n) {
  const a2 = e.get(t2);
  if (!a2) return n;
  const s = Object.keys(a2).map((r) => Ct(r, e, n + 1));
  return Math.max(...s);
}
var We = class {
  constructor() {
    this._nextHandler = null, this._handlers = {}, this._tag = /* @__PURE__ */ new WeakMap(), this.exec = this.exec.bind(this);
  }
  on(t2, e, n) {
    let a2 = this._handlers[t2];
    a2 ? n && n.intercept ? a2.unshift(e) : a2.push(e) : a2 = this._handlers[t2] = [e], n && n.tag && this._tag.set(e, n.tag);
  }
  intercept(t2, e, n) {
    this.on(t2, e, __spreadProps(__spreadValues({}, n), { intercept: true }));
  }
  detach(t2) {
    for (const e in this._handlers) {
      const n = this._handlers[e];
      for (let a2 = n.length - 1; a2 >= 0; a2--) this._tag.get(n[a2]) === t2 && n.splice(a2, 1);
    }
  }
  exec(t2, e) {
    return __async(this, null, function* () {
      const n = this._handlers[t2];
      if (n) for (let a2 = 0; a2 < n.length; a2++) {
        const s = n[a2](e);
        if (s === false || s && s.then && (yield s) === false) return;
      }
      return this._nextHandler && (yield this._nextHandler.exec(t2, e)), e;
    });
  }
  setNext(t2) {
    return this._nextHandler = t2;
  }
};
function $e(t2, e) {
  return typeof t2 == "string" ? t2.localeCompare(e, void 0, { numeric: true }) : typeof t2 == "object" ? t2.getTime() - e.getTime() : (t2 != null ? t2 : 0) - (e != null ? e : 0);
}
function Ie2(t2, e) {
  return typeof t2 == "string" ? -t2.localeCompare(e, void 0, { numeric: true }) : typeof e == "object" ? e.getTime() - t2.getTime() : (e != null ? e : 0) - (t2 != null ? t2 : 0);
}
function Pe({ key: t2, order: e }) {
  const n = e === "asc" ? $e : Ie2;
  return (a2, s) => n(a2[t2], s[t2]);
}
function Ce2(t2) {
  if (!t2 || !t2.length) return;
  const e = t2.map((n) => Pe(n));
  return t2.length === 1 ? e[0] : function(n, a2) {
    for (let s = 0; s < e.length; s++) {
      const r = e[s](n, a2);
      if (r !== 0) return r;
    }
    return 0;
  };
}
function Ee(t2, e) {
  return t2.sort(Ce2(e));
}
var Oe = class extends Se2 {
  constructor(e) {
    super();
    __publicField(this, "_sort");
    this.parse(e, 0);
  }
  parse(e, n) {
    if (!e || !e.length) return;
    const a2 = e.map((s) => this.normalizeTask(s));
    super.parse(a2, n), this._sort && this.sortBranch(this._sort, n);
  }
  getBranch(e) {
    const n = this._pool.get(e);
    return this._pool.get(n.parent || 0).data;
  }
  contains(e, n) {
    const a2 = this._pool.get(e).data;
    let s = false;
    if (a2) for (let r = 0; r < a2.length; r++) {
      if (a2[r].id === n) {
        s = true;
        break;
      }
      if (a2[r].data && (s = this.contains(a2[r].id, n), s)) break;
    }
    return s;
  }
  getIndexById(e) {
    return this.getBranch(e).findIndex((n) => n.id === e);
  }
  add(e, n) {
    const a2 = this.normalizeTask(e);
    return super.add(a2, n), a2;
  }
  copy(e, n, a2) {
    var _a2;
    const s = this.add(__spreadProps(__spreadValues({}, e), { id: null, data: null, parent: n }), a2);
    let r = [[e.id, s.id]];
    return (_a2 = e.data) == null ? void 0 : _a2.forEach((i, o2) => {
      const c2 = this.copy(i, s.id, o2);
      r = r.concat(c2);
    }), r;
  }
  normalizeTask(e) {
    const n = e.id || nt2(), a2 = e.parent || 0, s = e.text || "", r = e.type || "task", i = e.progress || 0, o2 = e.details || "", c2 = __spreadProps(__spreadValues({}, e), { id: n, text: s, parent: a2, progress: i, type: r, details: o2 });
    return e.segments && (c2.segments = e.segments.map((d2) => __spreadValues({}, d2))), e.segments && (c2.segments = e.segments.map((d2) => __spreadValues({}, d2))), c2;
  }
  getSummaryId(e, n = false) {
    const a2 = this._pool.get(e);
    if (!a2.parent) return null;
    const s = this._pool.get(a2.parent);
    if (n) {
      let r = e, i = this.getSummaryId(r);
      const o2 = [];
      for (; i; ) r = i, o2.push(i), i = this.getSummaryId(r);
      return o2;
    }
    return s.type === "summary" ? s.id : this.getSummaryId(s.id);
  }
  sort(e) {
    this._sort = e, e && this.sortBranch(e, 0);
  }
  sortBranch(e, n) {
    const a2 = this._pool.get(n || 0).data;
    a2 && (Ee(a2, e), a2.forEach((s) => {
      this.sortBranch(e, s.id);
    }));
  }
  serialize() {
    const e = [], n = this._pool.get(0).data;
    return n && Et2(n, e), e;
  }
  clear() {
    this.forEach((e) => {
      this.remove(e.id);
    });
  }
};
function Et2(t2, e) {
  t2.forEach((n) => {
    e.push(n), n.data && Et2(n.data, e);
  });
}
function b(t2) {
  const e = Object.prototype.toString.call(t2);
  return t2 instanceof Date || typeof t2 == "object" && e === "[object Date]" ? new t2.constructor(+t2) : typeof t2 == "number" || e === "[object Number]" || typeof t2 == "string" || e === "[object String]" ? new Date(t2) : /* @__PURE__ */ new Date(NaN);
}
function D(t2, e) {
  return t2 instanceof Date ? new t2.constructor(e) : new Date(e);
}
function R(t2, e) {
  const n = b(t2);
  return isNaN(e) ? D(t2, NaN) : (e && n.setDate(n.getDate() + e), n);
}
function at(t2, e) {
  const n = b(t2);
  if (isNaN(e)) return D(t2, NaN);
  if (!e) return n;
  const a2 = n.getDate(), s = D(t2, n.getTime());
  s.setMonth(n.getMonth() + e + 1, 0);
  const r = s.getDate();
  return a2 >= r ? s : (n.setFullYear(s.getFullYear(), s.getMonth(), a2), n);
}
function Ot(t2, e) {
  const n = +b(t2);
  return D(t2, n + e);
}
var J2 = 6048e5;
var He = 864e5;
var Ht = 6e4;
var Nt = 36e5;
function Ne2(t2, e) {
  return Ot(t2, e * Nt);
}
var Ye = {};
function F() {
  return Ye;
}
function I(t2, e) {
  var _a2, _b, _c, _d, _e4, _f, _g, _h;
  const n = F(), a2 = (_h = (_g = (_d = (_c = e == null ? void 0 : e.weekStartsOn) != null ? _c : (_b = (_a2 = e == null ? void 0 : e.locale) == null ? void 0 : _a2.options) == null ? void 0 : _b.weekStartsOn) != null ? _d : n.weekStartsOn) != null ? _g : (_f = (_e4 = n.locale) == null ? void 0 : _e4.options) == null ? void 0 : _f.weekStartsOn) != null ? _h : 0, s = b(t2), r = s.getDay(), i = (r < a2 ? 7 : 0) + r - a2;
  return s.setDate(s.getDate() - i), s.setHours(0, 0, 0, 0), s;
}
function N(t2) {
  return I(t2, { weekStartsOn: 1 });
}
function Yt(t2) {
  const e = b(t2), n = e.getFullYear(), a2 = D(t2, 0);
  a2.setFullYear(n + 1, 0, 4), a2.setHours(0, 0, 0, 0);
  const s = N(a2), r = D(t2, 0);
  r.setFullYear(n, 0, 4), r.setHours(0, 0, 0, 0);
  const i = N(r);
  return e.getTime() >= s.getTime() ? n + 1 : e.getTime() >= i.getTime() ? n : n - 1;
}
function C(t2) {
  const e = b(t2);
  return e.setHours(0, 0, 0, 0), e;
}
function V(t2) {
  const e = b(t2), n = new Date(Date.UTC(e.getFullYear(), e.getMonth(), e.getDate(), e.getHours(), e.getMinutes(), e.getSeconds(), e.getMilliseconds()));
  return n.setUTCFullYear(e.getFullYear()), +t2 - +n;
}
function st(t2, e) {
  const n = C(t2), a2 = C(e), s = +n - V(n), r = +a2 - V(a2);
  return Math.round((s - r) / He);
}
function rt2(t2) {
  const e = Yt(t2), n = D(t2, 0);
  return n.setFullYear(e, 0, 4), n.setHours(0, 0, 0, 0), N(n);
}
function ze2(t2, e) {
  return Ot(t2, e * Ht);
}
function Ae2(t2, e) {
  const n = e * 3;
  return at(t2, n);
}
function zt2(t2, e) {
  const n = e * 7;
  return R(t2, n);
}
function Be(t2, e) {
  return at(t2, e * 12);
}
function q(t2, e) {
  const n = b(t2), a2 = b(e), s = n.getTime() - a2.getTime();
  return s < 0 ? -1 : s > 0 ? 1 : s;
}
function Fe2(t2, e) {
  const n = C(t2), a2 = C(e);
  return +n == +a2;
}
function it(t2, e) {
  const n = N(t2), a2 = N(e), s = +n - V(n), r = +a2 - V(a2);
  return Math.round((s - r) / J2);
}
function je2(t2, e) {
  const n = b(t2), a2 = b(e), s = n.getFullYear() - a2.getFullYear(), r = n.getMonth() - a2.getMonth();
  return s * 12 + r;
}
function Le2(t2, e) {
  const n = b(t2), a2 = b(e);
  return n.getFullYear() - a2.getFullYear();
}
function ot(t2) {
  return (e) => {
    const n = (t2 ? Math[t2] : Math.trunc)(e);
    return n === 0 ? 0 : n;
  };
}
function At(t2, e) {
  return +b(t2) - +b(e);
}
function Xe2(t2, e, n) {
  const a2 = At(t2, e) / Nt;
  return ot(n == null ? void 0 : n.roundingMethod)(a2);
}
function Qe2(t2, e, n) {
  const a2 = At(t2, e) / Ht;
  return ot(n == null ? void 0 : n.roundingMethod)(a2);
}
function Bt(t2) {
  const e = b(t2);
  return e.setHours(23, 59, 59, 999), e;
}
function ct(t2) {
  const e = b(t2), n = e.getMonth();
  return e.setFullYear(e.getFullYear(), n + 1, 0), e.setHours(23, 59, 59, 999), e;
}
function Ge2(t2) {
  const e = b(t2);
  return +Bt(e) == +ct(e);
}
function Ft(t2, e) {
  const n = b(t2), a2 = b(e), s = q(n, a2), r = Math.abs(je2(n, a2));
  let i;
  if (r < 1) i = 0;
  else {
    n.getMonth() === 1 && n.getDate() > 27 && n.setDate(30), n.setMonth(n.getMonth() - s * r);
    let o2 = q(n, a2) === -s;
    Ge2(b(t2)) && r === 1 && q(t2, a2) === 1 && (o2 = false), i = s * (r - Number(o2));
  }
  return i === 0 ? 0 : i;
}
function Re2(t2, e, n) {
  const a2 = Ft(t2, e) / 3;
  return ot(n == null ? void 0 : n.roundingMethod)(a2);
}
function Je2(t2, e) {
  const n = b(t2), a2 = b(e), s = q(n, a2), r = Math.abs(Le2(n, a2));
  n.setFullYear(1584), a2.setFullYear(1584);
  const i = q(n, a2) === -s, o2 = s * (r - +i);
  return o2 === 0 ? 0 : o2;
}
function U(t2) {
  const e = b(t2), n = e.getMonth(), a2 = n - n % 3;
  return e.setMonth(a2, 1), e.setHours(0, 0, 0, 0), e;
}
function qt(t2) {
  const e = b(t2);
  return e.setDate(1), e.setHours(0, 0, 0, 0), e;
}
function Ve(t2) {
  const e = b(t2), n = e.getFullYear();
  return e.setFullYear(n + 1, 0, 0), e.setHours(23, 59, 59, 999), e;
}
function Ut2(t2) {
  const e = b(t2), n = D(t2, 0);
  return n.setFullYear(e.getFullYear(), 0, 1), n.setHours(0, 0, 0, 0), n;
}
function Ke2(t2) {
  const e = b(t2);
  return e.setMinutes(59, 59, 999), e;
}
function Ze2(t2, e) {
  var _a2, _b, _c, _d, _e4, _f, _g, _h;
  const n = F(), a2 = (_h = (_g = (_d = (_c = e == null ? void 0 : e.weekStartsOn) != null ? _c : (_b = (_a2 = e == null ? void 0 : e.locale) == null ? void 0 : _a2.options) == null ? void 0 : _b.weekStartsOn) != null ? _d : n.weekStartsOn) != null ? _g : (_f = (_e4 = n.locale) == null ? void 0 : _e4.options) == null ? void 0 : _f.weekStartsOn) != null ? _h : 0, s = b(t2), r = s.getDay(), i = (r < a2 ? -7 : 0) + 6 - (r - a2);
  return s.setDate(s.getDate() + i), s.setHours(23, 59, 59, 999), s;
}
function dt2(t2) {
  const e = b(t2), n = e.getMonth(), a2 = n - n % 3 + 3;
  return e.setMonth(a2, 0), e.setHours(23, 59, 59, 999), e;
}
function ut2(t2) {
  return (e = {}) => {
    const n = e.width ? String(e.width) : t2.defaultWidth;
    return t2.formats[n] || t2.formats[t2.defaultWidth];
  };
}
var nn = { full: "EEEE, MMMM do, y", long: "MMMM do, y", medium: "MMM d, y", short: "MM/dd/yyyy" };
var an = { full: "h:mm:ss a zzzz", long: "h:mm:ss a z", medium: "h:mm:ss a", short: "h:mm a" };
var sn = { full: "{{date}} 'at' {{time}}", long: "{{date}} 'at' {{time}}", medium: "{{date}}, {{time}}", short: "{{date}}, {{time}}" };
var rn = { date: ut2({ formats: nn, defaultWidth: "full" }), time: ut2({ formats: an, defaultWidth: "full" }), dateTime: ut2({ formats: sn, defaultWidth: "full" }) };
function j(t2) {
  return (e, n) => {
    const a2 = (n == null ? void 0 : n.context) ? String(n.context) : "standalone";
    let s;
    if (a2 === "formatting" && t2.formattingValues) {
      const i = t2.defaultFormattingWidth || t2.defaultWidth, o2 = (n == null ? void 0 : n.width) ? String(n.width) : i;
      s = t2.formattingValues[o2] || t2.formattingValues[i];
    } else {
      const i = t2.defaultWidth, o2 = (n == null ? void 0 : n.width) ? String(n.width) : t2.defaultWidth;
      s = t2.values[o2] || t2.values[i];
    }
    const r = t2.argumentCallback ? t2.argumentCallback(e) : e;
    return s[r];
  };
}
var dn = { narrow: ["B", "A"], abbreviated: ["BC", "AD"], wide: ["Before Christ", "Anno Domini"] };
var un = { narrow: ["1", "2", "3", "4"], abbreviated: ["Q1", "Q2", "Q3", "Q4"], wide: ["1st quarter", "2nd quarter", "3rd quarter", "4th quarter"] };
var ln = { narrow: ["J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"], abbreviated: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], wide: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"] };
var hn = { narrow: ["S", "M", "T", "W", "T", "F", "S"], short: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"], abbreviated: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], wide: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"] };
var fn = { narrow: { am: "a", pm: "p", midnight: "mi", noon: "n", morning: "morning", afternoon: "afternoon", evening: "evening", night: "night" }, abbreviated: { am: "AM", pm: "PM", midnight: "midnight", noon: "noon", morning: "morning", afternoon: "afternoon", evening: "evening", night: "night" }, wide: { am: "a.m.", pm: "p.m.", midnight: "midnight", noon: "noon", morning: "morning", afternoon: "afternoon", evening: "evening", night: "night" } };
var mn = { narrow: { am: "a", pm: "p", midnight: "mi", noon: "n", morning: "in the morning", afternoon: "in the afternoon", evening: "in the evening", night: "at night" }, abbreviated: { am: "AM", pm: "PM", midnight: "midnight", noon: "noon", morning: "in the morning", afternoon: "in the afternoon", evening: "in the evening", night: "at night" }, wide: { am: "a.m.", pm: "p.m.", midnight: "midnight", noon: "noon", morning: "in the morning", afternoon: "in the afternoon", evening: "in the evening", night: "at night" } };
var gn = (t2, e) => {
  const n = Number(t2), a2 = n % 100;
  if (a2 > 20 || a2 < 10) switch (a2 % 10) {
    case 1:
      return n + "st";
    case 2:
      return n + "nd";
    case 3:
      return n + "rd";
  }
  return n + "th";
};
var pn = { ordinalNumber: gn, era: j({ values: dn, defaultWidth: "wide" }), quarter: j({ values: un, defaultWidth: "wide", argumentCallback: (t2) => t2 - 1 }), month: j({ values: ln, defaultWidth: "wide" }), day: j({ values: hn, defaultWidth: "wide" }), dayPeriod: j({ values: fn, defaultWidth: "wide", formattingValues: mn, defaultFormattingWidth: "wide" }) };
function L(t2) {
  return (e, n = {}) => {
    const a2 = n.width, s = a2 && t2.matchPatterns[a2] || t2.matchPatterns[t2.defaultMatchWidth], r = e.match(s);
    if (!r) return null;
    const i = r[0], o2 = a2 && t2.parsePatterns[a2] || t2.parsePatterns[t2.defaultParseWidth], c2 = Array.isArray(o2) ? kn(o2, (h) => h.test(i)) : yn(o2, (h) => h.test(i));
    let d2;
    d2 = t2.valueCallback ? t2.valueCallback(c2) : c2, d2 = n.valueCallback ? n.valueCallback(d2) : d2;
    const u = e.slice(i.length);
    return { value: d2, rest: u };
  };
}
function yn(t2, e) {
  for (const n in t2) if (Object.prototype.hasOwnProperty.call(t2, n) && e(t2[n])) return n;
}
function kn(t2, e) {
  for (let n = 0; n < t2.length; n++) if (e(t2[n])) return n;
}
function wn(t2) {
  return (e, n = {}) => {
    const a2 = e.match(t2.matchPattern);
    if (!a2) return null;
    const s = a2[0], r = e.match(t2.parsePattern);
    if (!r) return null;
    let i = t2.valueCallback ? t2.valueCallback(r[0]) : r[0];
    i = n.valueCallback ? n.valueCallback(i) : i;
    const o2 = e.slice(s.length);
    return { value: i, rest: o2 };
  };
}
var bn = /^(\d+)(th|st|nd|rd)?/i;
var xn = /\d+/i;
var _n = { narrow: /^(b|a)/i, abbreviated: /^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i, wide: /^(before christ|before common era|anno domini|common era)/i };
var vn = { any: [/^b/i, /^(a|c)/i] };
var Sn = { narrow: /^[1234]/i, abbreviated: /^q[1234]/i, wide: /^[1234](th|st|nd|rd)? quarter/i };
var Mn = { any: [/1/i, /2/i, /3/i, /4/i] };
var Dn = { narrow: /^[jfmasond]/i, abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i, wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i };
var Tn = { narrow: [/^j/i, /^f/i, /^m/i, /^a/i, /^m/i, /^j/i, /^j/i, /^a/i, /^s/i, /^o/i, /^n/i, /^d/i], any: [/^ja/i, /^f/i, /^mar/i, /^ap/i, /^may/i, /^jun/i, /^jul/i, /^au/i, /^s/i, /^o/i, /^n/i, /^d/i] };
var Wn = { narrow: /^[smtwf]/i, short: /^(su|mo|tu|we|th|fr|sa)/i, abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i, wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i };
var $n = { narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i], any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i] };
var In = { narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i, any: /^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i };
var Pn = { any: { am: /^a/i, pm: /^p/i, midnight: /^mi/i, noon: /^no/i, morning: /morning/i, afternoon: /afternoon/i, evening: /evening/i, night: /night/i } };
var Cn = { ordinalNumber: wn({ matchPattern: bn, parsePattern: xn, valueCallback: (t2) => parseInt(t2, 10) }), era: L({ matchPatterns: _n, defaultMatchWidth: "wide", parsePatterns: vn, defaultParseWidth: "any" }), quarter: L({ matchPatterns: Sn, defaultMatchWidth: "wide", parsePatterns: Mn, defaultParseWidth: "any", valueCallback: (t2) => t2 + 1 }), month: L({ matchPatterns: Dn, defaultMatchWidth: "wide", parsePatterns: Tn, defaultParseWidth: "any" }), day: L({ matchPatterns: Wn, defaultMatchWidth: "wide", parsePatterns: $n, defaultParseWidth: "any" }), dayPeriod: L({ matchPatterns: In, defaultMatchWidth: "any", parsePatterns: Pn, defaultParseWidth: "any" }) };
function Jt(t2) {
  const e = b(t2), n = e.getFullYear(), a2 = e.getMonth(), s = D(t2, 0);
  return s.setFullYear(n, a2 + 1, 0), s.setHours(0, 0, 0, 0), s.getDate();
}
function ta(t2) {
  const e = b(t2).getFullYear();
  return e % 400 === 0 || e % 4 === 0 && e % 100 !== 0;
}
function Vt2(t2) {
  const e = b(t2);
  return String(new Date(e)) === "Invalid Date" ? NaN : ta(e) ? 366 : 365;
}
function ea(t2) {
  const e = rt2(t2), n = +rt2(zt2(e, 60)) - +e;
  return Math.round(n / J2);
}
function z2(t2, e) {
  const n = b(t2), a2 = b(e);
  return +n == +a2;
}
function na(t2) {
  const e = b(t2);
  return e.setMinutes(0, 0, 0), e;
}
function aa(t2, e, n) {
  const a2 = I(t2, n), s = I(e, n);
  return +a2 == +s;
}
function sa(t2, e) {
  const n = b(t2), a2 = b(e);
  return n.getFullYear() === a2.getFullYear() && n.getMonth() === a2.getMonth();
}
function ra(t2, e) {
  const n = U(t2), a2 = U(e);
  return +n == +a2;
}
function ia(t2, e) {
  const n = b(t2), a2 = b(e);
  return n.getFullYear() === a2.getFullYear();
}
var lt2 = { year: Je2, quarter: Re2, month: Ft, week: it, day: st, hour: Xe2, minute: Qe2 };
var O = { year: { quarter: 4, month: 12, week: ea, day: oa, hour: ca }, quarter: { month: 3, week: da, day: Kt2, hour: ua }, month: { week: la, day: ha, hour: fa }, week: { day: 7, hour: 24 * 7 }, day: { hour: 24 }, hour: { minute: 60 } };
function oa(t2) {
  return t2 ? Vt2(t2) : 365;
}
function ca(t2) {
  return Vt2(t2) * 24;
}
function da(t2) {
  const e = U(t2), n = R(C(dt2(t2)), 1);
  return it(n, e);
}
function Kt2(t2) {
  if (t2) {
    const e = U(t2), n = dt2(t2);
    return st(n, e) + 1;
  }
  return 91;
}
function ua(t2) {
  return Kt2(t2) * 24;
}
function la(t2) {
  if (t2) {
    const e = qt(t2), n = R(C(ct(t2)), 1);
    return it(n, e);
  }
  return 5;
}
function ha(t2) {
  return t2 ? Jt(t2) : 30;
}
function fa(t2) {
  return Jt(t2) * 24;
}
function K(t2, e, n) {
  const a2 = O[t2][e];
  return a2 ? typeof a2 == "number" ? a2 : a2(n) : 1;
}
function ma(t2, e) {
  return t2 === e || !!(O[t2] && O[t2][e]);
}
var Z2 = { year: Be, quarter: Ae2, month: at, week: zt2, day: R, hour: Ne2, minute: ze2 };
function tt2(t2, e, n) {
  if (e) {
    if (t2 === "day") return (a2, s) => e.getWorkingDays(s, a2, true);
    if (t2 === "hour") return (a2, s) => e.getWorkingHours(s, a2, true);
  }
  return (a2, s, r, i) => {
    var _a2;
    const o2 = (_a2 = O[t2]) == null ? void 0 : _a2[r];
    return !o2 || typeof o2 == "number" || ee2(t2, a2, s, n) ? X(t2, a2, s, r, i, n) : ga(a2, s, t2, r, i, n);
  };
}
function X(t2, e, n, a2, s, r) {
  const i = a2 || t2;
  let o2 = n, c2 = e;
  if (s && (o2 = $2(i, n, r), c2 = $2(i, e, r), c2 < e && (c2 = T(i)(c2, 1))), t2 !== i) {
    const d2 = lt2[i](c2, o2), u = K(t2, i, n);
    return d2 / u;
  } else return lt2[i](c2, o2);
}
function ga(t2, e, n, a2, s, r) {
  let i = 0;
  const o2 = $2(n, e, r);
  if (e > o2) {
    const d2 = Z2[n](o2, 1);
    i = X(n, d2, e, a2, void 0, r), e = d2;
  }
  let c2 = 0;
  return ee2(n, e, t2, r) || (c2 = X(n, $2(n, t2, r), e, void 0, void 0, r), e = Z2[n](e, c2)), c2 += i + X(n, t2, e, a2, void 0, r), !c2 && s && (c2 = X(n, t2, e, a2, s, r)), c2;
}
function T(t2, e) {
  if (e) {
    if (t2 === "day") return (n, a2) => e.addWorkingDays(n, a2, true);
    if (t2 === "hour") return (n, a2) => e.addWorkingHours(n, a2);
  }
  return Z2[t2];
}
var Zt2 = { year: Ut2, quarter: U, month: qt, week: (t2, e) => I(t2, { weekStartsOn: e }), day: C, hour: na };
function $2(t2, e, n) {
  const a2 = Zt2[t2];
  return a2 ? a2(e, n) : new Date(e);
}
var pa = { year: Ve, quarter: dt2, month: ct, week: (t2, e) => Ze2(t2, { weekStartsOn: e }), day: Bt, hour: Ke2 };
var te2 = { year: ia, quarter: ra, month: sa, week: (t2, e, n) => aa(t2, e, { weekStartsOn: n }), day: Fe2 };
function ee2(t2, e, n, a2) {
  const s = te2[t2];
  return s ? s(e, n, a2) : false;
}
var ya = { start: Zt2, end: pa, add: Z2, isSame: te2, diff: lt2, smallerCount: O };
var ne = (t2) => typeof t2 == "function" ? t2(/* @__PURE__ */ new Date()) : t2;
function ka(t2, e) {
  for (const n in e) {
    if (n === "smallerCount") {
      const a2 = Object.keys(e[n]).sort((o2, c2) => W.indexOf(o2) - W.indexOf(c2)).shift();
      let s = W.indexOf(a2);
      const r = e[n][a2], i = ne(r);
      for (let o2 = s - 1; o2 >= 0; o2--) {
        const c2 = W[o2], d2 = ne(O[c2][a2]);
        if (i <= d2) break;
        s = o2;
      }
      W.splice(s, 0, t2);
    }
    if (n === "biggerCount") for (const a2 in e[n]) O[a2][t2] = e[n][a2];
    else ya[n][t2] = e[n];
  }
}
function ht2(t2, e = 1, n) {
  return n.isWorkingDay(t2) || (t2 = e > 0 ? n.getNextWorkingDay(t2) : n.getPreviousWorkingDay(t2)), t2;
}
function wa(t2) {
  return (e, n) => {
    if (n > 0) for (let a2 = 0; a2 < n; a2++) e = t2.getNextWorkingDay(e);
    if (n < 0) for (let a2 = 0; a2 > n; a2--) e = t2.getPreviousWorkingDay(e);
    return e;
  };
}
function A(t2) {
  const e = /* @__PURE__ */ new Date();
  return t2.map((n) => ({ item: n, len: T(n.unit)(e, 1) })).sort((n, a2) => n.len < a2.len ? -1 : 1)[0].item;
}
var W = ["year", "quarter", "month", "week", "day", "hour"];
var ft2 = 50;
var mt2 = 300;
function ba(t2, e, n, a2, s, r) {
  const i = !t2 || n, o2 = !e || n;
  let c2 = t2, d2 = e, u = false, h = false;
  (i || o2) && (s == null ? void 0 : s.forEach((f) => {
    i && (!c2 || f.start <= c2) && (c2 = f.start, u = true);
    const g = f.type === "milestone" ? f.start : f.end;
    o2 && (!d2 || g >= d2) && (d2 = g, h = true);
  }), r == null ? void 0 : r.forEach((f) => {
    i && (!c2 || f.start <= c2) && (c2 = f.start, u = true), o2 && (!d2 || f.start >= d2) && (d2 = f.start, h = true);
  }));
  const l2 = T(a2 || "day");
  return c2 ? u && (c2 = l2(c2, -1)) : d2 ? c2 = l2(d2, -30) : c2 = /* @__PURE__ */ new Date(), d2 ? h && (d2 = l2(d2, 1)) : d2 = l2(c2, 30), { _start: c2, _end: d2 };
}
function xa(t2, e, n, a2, s, r, i) {
  const o2 = A(i).unit, c2 = tt2(o2, void 0, r), d2 = c2(e, t2, "", true), u = $2(o2, e, r);
  t2 = $2(o2, t2, r), e = u < e ? T(o2)(u, 1) : u;
  const h = d2 * a2, l2 = s * i.length, f = i.map((m) => {
    const y3 = [], p2 = T(m.unit);
    let k4 = $2(m.unit, t2, r);
    for (; k4 < e; ) {
      const w = p2(k4, m.step), _3 = k4 < t2 ? t2 : k4, v3 = w > e ? e : w, S4 = c2(v3, _3, "", true) * a2, M2 = typeof m.format == "function" ? m.format(k4, w) : m.format;
      let B4 = "";
      m.css && (B4 += typeof m.css == "function" ? m.css(k4) : m.css), y3.push({ width: S4, value: M2, date: _3, css: B4, unit: m.unit }), k4 = w;
    }
    return { cells: y3, add: p2, height: s };
  });
  let g = a2;
  return o2 !== n && (g = g / K(o2, n)), { rows: f, width: h, height: l2, diff: c2, start: t2, end: e, lengthUnit: n, minUnit: o2, lengthUnitWidth: g };
}
function _a(t2, e, n, a2) {
  const s = typeof t2 == "boolean" ? {} : t2, r = W.indexOf(A(n).unit);
  if (typeof s.level > "u" && (s.level = r), s.levels) s.levels.forEach((c2) => {
    c2.minCellWidth || (c2.minCellWidth = et2(s.minCellWidth, ft2)), c2.maxCellWidth || (c2.maxCellWidth = et2(s.maxCellWidth, mt2));
  });
  else {
    const c2 = [], d2 = n.length || 1, u = et2(s.minCellWidth, ft2), h = et2(s.maxCellWidth, mt2);
    n.forEach((l2) => {
      l2.format && !e[l2.unit] && (e[l2.unit] = l2.format);
    }), W.forEach((l2, f) => {
      if (f === r) c2.push({ minCellWidth: u, maxCellWidth: h, scales: n });
      else {
        const g = [];
        if (f) for (let m = d2 - 1; m > 0; m--) {
          const y3 = W[f - m];
          y3 && g.push({ unit: y3, step: 1, format: e[y3] });
        }
        g.push({ unit: l2, step: 1, format: e[l2] }), c2.push({ minCellWidth: u, maxCellWidth: h, scales: g });
      }
    }), s.levels = c2;
  }
  s.levels[s.level] || (s.level = 0);
  const i = s.levels[s.level], o2 = Math.min(Math.max(a2, i.minCellWidth), i.maxCellWidth);
  return { zoom: s, scales: i.scales, cellWidth: o2 };
}
function va(t2, e, n, a2, s, r, i) {
  var _a2, _b;
  t2.level = n;
  let o2;
  const c2 = a2.scales || a2, d2 = A(c2).unit, u = Sa(d2, s);
  if (e === -1) {
    const f = K(d2, s);
    o2 = i * f;
  } else {
    const f = K(A(r).unit, d2);
    o2 = Math.round(i / f);
  }
  const h = (_a2 = a2.minCellWidth) != null ? _a2 : ft2, l2 = (_b = a2.maxCellWidth) != null ? _b : mt2;
  return { scales: c2, cellWidth: Math.min(l2, Math.max(h, o2)), lengthUnit: u, zoom: t2 };
}
function Sa(t2, e) {
  const n = W.indexOf(t2), a2 = W.indexOf(e);
  return a2 >= n ? t2 === "hour" ? "hour" : "day" : W[a2];
}
function et2(t2, e) {
  return t2 != null ? t2 : e;
}
var gt = 8;
var ae2 = 4;
var Ma = 3;
var se2 = 7;
var Da = gt + ae2;
function re2(t2, e, n) {
  var _a2;
  (t2.open || t2.type != "summary") && ((_a2 = t2.data) == null ? void 0 : _a2.forEach((a2) => {
    typeof a2.$x > "u" && oe(a2, n), a2.$x += e, re2(a2, e, n);
  }));
}
function pt2(t2, e, n, a2) {
  const s = t2.getSummaryId(e.id);
  if (s) {
    const r = t2.byId(s), i = { xMin: 1 / 0, xMax: 0 };
    a2 && de(r, n), ie2(r, i, n), r.$x = i.xMin, r.$w = i.xMax - i.xMin, pt2(t2, r, n);
  }
}
function ie2(t2, e, n) {
  var _a2;
  (_a2 = t2.data) == null ? void 0 : _a2.forEach((a2) => {
    if (!a2.unscheduled) {
      typeof a2.$x > "u" && oe(a2, n);
      const s = a2.type === "milestone" && a2.$h ? a2.$h / 2 : 0;
      e.xMin > a2.$x + s && (e.xMin = a2.$x + s);
      const r = a2.$x + a2.$w - s;
      e.xMax < r && (e.xMax = r);
    }
    a2.type !== "summary" && ie2(a2, e, n);
  });
}
function oe(t2, e) {
  const { _scales: n, cellWidth: a2 } = e;
  t2.$x = Math.round(n.diff(t2.start, n.start, n.lengthUnit) * a2), t2.$w = Math.round(n.diff(t2.end, t2.start, n.lengthUnit, true) * a2);
}
function yt(t2, e) {
  var _a2;
  let n;
  e && (n = e.filter((s) => s.parent == t2.id));
  const a2 = __spreadValues({ data: n }, t2);
  if ((_a2 = a2.data) == null ? void 0 : _a2.length) a2.data.forEach((s) => {
    if (s.unscheduled && !s.data) return;
    (e || s.type != "summary" && s.data) && (s.unscheduled && (s = __spreadProps(__spreadValues({}, s), { start: void 0, end: void 0 })), s = yt(s, e)), s.start && (!a2.start || a2.start > s.start) && (a2.start = new Date(s.start));
    const r = s.end || s.start;
    r && (!a2.end || a2.end < r) && (a2.end = new Date(r));
  });
  else if (t2.type === "summary") throw Error("Summary tasks must have start and end dates if they have no subtasks");
  return a2;
}
function ce2(t2, e, n) {
  var _a2;
  return kt(t2, e, n, false), n.splitTasks && ((_a2 = t2.segments) == null ? void 0 : _a2.forEach((a2) => {
    ce2(a2, e, __spreadProps(__spreadValues({}, n), { baselines: false })), a2.$x -= t2.$x;
  })), n.baselines && kt(t2, e, n, true), t2;
}
function kt(t2, e, n, a2) {
  const { cellWidth: s, cellHeight: r, _scales: i, baselines: o2 } = n, { start: c2, end: d2, lengthUnit: u, diff: h } = i, l2 = (a2 ? "base_" : "") + "start", f = (a2 ? "base_" : "") + "end", g = "$x" + (a2 ? "_base" : ""), m = "$y" + (a2 ? "_base" : ""), y3 = "$w" + (a2 ? "_base" : ""), p2 = "$h" + (a2 ? "_base" : ""), k4 = "$skip" + (a2 ? "_baseline" : "");
  let w = t2[l2], _3 = t2[f];
  if (a2 && !w) {
    t2[k4] = true;
    return;
  }
  t2[l2] < c2 && (t2[f] < c2 || z2(t2[f], c2)) ? w = _3 = c2 : t2[l2] > d2 && (w = _3 = d2), t2[g] = Math.round(h(w, c2, u) * s), t2[y3] = Math.round(h(_3, w, u, true) * s), e !== null && (t2[m] = a2 ? t2.$y + t2.$h + ae2 : r * e + Ma), t2[p2] = a2 ? gt : o2 ? r - se2 - Da : r - se2, t2.type === "milestone" && (t2[g] = t2[g] - t2.$h / 2, t2[y3] = t2.$h, a2 && (t2[m] = t2.$y + gt, t2[y3] = t2[p2] = t2.$h)), n.unscheduledTasks && t2.unscheduled && !a2 ? t2.$skip = true : t2[k4] = z2(w, _3);
}
function de(t2, e, n) {
  t2.data && !t2.$skip && (n = n || !t2.open, t2.data.forEach((a2) => {
    n && kt(a2, null, e, false), de(a2, e, n);
  }));
}
function Ta(t2, e) {
  return false;
}
function Wa(t2, e) {
}
var wt2 = 20;
var $a = function(t2, e, n, a2, s) {
  const r = Math.round(a2 / 2) - 3;
  if (!e || !n || !e.$y || !n.$y || e.$skip || n.$skip) return t2.$p = "", t2.$pl = 0, t2;
  let i = false, o2 = false;
  switch (t2.type) {
    case "e2s":
      o2 = true;
      break;
    case "s2s":
      i = true, o2 = true;
      break;
    case "s2e":
      i = true;
      break;
  }
  const c2 = i ? e.$x : e.$x + e.$w, d2 = s ? e.$y - 7 : e.$y, u = o2 ? n.$x : n.$x + n.$w, h = s ? n.$y - 7 : n.$y;
  if (c2 !== u || d2 !== h) {
    const l2 = Pa(c2, d2 + r, u, h + r, i, o2, a2 / 2, s), f = Ca(u, h + r, o2);
    t2.$p = `${l2},${f}`, t2.$pl = Ia(t2.$p);
  }
  return t2;
};
function Ia(t2) {
  const e = t2.split(",").map(Number), n = [];
  for (let s = 0; s < e.length; s += 2) s + 1 < e.length && n.push([e[s], e[s + 1]]);
  let a2 = 0;
  for (let s = 0; s < n.length - 1; s++) {
    const [r, i] = n[s], [o2, c2] = n[s + 1];
    a2 += Math.hypot(o2 - r, c2 - i);
  }
  return a2;
}
function Pa(t2, e, n, a2, s, r, i, o2) {
  const c2 = wt2 * (s ? -1 : 1), d2 = wt2 * (r ? -1 : 1), u = t2 + c2, h = n + d2, l2 = [t2, e, u, e, 0, 0, 0, 0, h, a2, n, a2], f = h - u;
  let g = a2 - e;
  const m = r === s;
  return m || (h <= t2 + wt2 - 2 && r || h > t2 && !r) && (g = o2 ? g - i + 6 : g - i), m && r && u > h || m && !r && u < h ? (l2[4] = l2[2] + f, l2[5] = l2[3], l2[6] = l2[4], l2[7] = l2[5] + g) : (l2[4] = l2[2], l2[5] = l2[3] + g, l2[6] = l2[4] + f, l2[7] = l2[5]), l2.join(",");
}
function Ca(t2, e, n) {
  return n ? `${t2 - 5},${e - 3},${t2 - 5},${e + 3},${t2},${e}` : `${t2 + 5},${e + 3},${t2 + 5},${e - 3},${t2},${e}`;
}
function ue2(t2) {
  return t2.map((e) => {
    const n = e.id || nt2();
    return __spreadProps(__spreadValues({}, e), { id: n });
  });
}
var le = ["start", "end", "duration"];
function Oa(t2, e) {
  const { type: n, unscheduled: a2 } = t2;
  return a2 || n === "summary" ? !le.includes(e) : n === "milestone" ? !["end", "duration"].includes(e) : true;
}
function Ha(t2, e) {
  return typeof e == "function" ? e : le.includes(t2) ? (typeof e == "string" && (e = { type: e, config: {} }), e.config || (e.config = {}), e.type === "datepicker" && (e.config.buttons = ["today"]), (n, a2) => Oa(n, a2.id) ? e : null) : e;
}
function Na(t2) {
  return !t2 || !t2.length ? [] : t2.map((e) => {
    var _a2, _b;
    const n = e.align || "left", a2 = e.id === "add-task", s = !a2 && e.flexgrow ? e.flexgrow : null, r = s ? 1 : e.width || (a2 ? 50 : 120), i = e.editor && Ha(e.id, e.editor);
    return __spreadValues(__spreadValues(__spreadProps(__spreadValues({ width: r, align: n, header: e.header, id: e.id, template: e.template, _template: e._template }, s && { flexgrow: s }), { cell: e.cell, resize: (_a2 = e.resize) != null ? _a2 : true, sort: (_b = e.sort) != null ? _b : !a2 }), i && { editor: i }), e.options && { options: e.options });
  });
}
var Ya = [{ id: "text", header: "Task name", flexgrow: 1, sort: true }, { id: "start", header: "Start date", align: "center", sort: true }, { id: "duration", header: "Duration", width: 100, align: "center", sort: true }, { id: "add-task", header: "Add task", width: 50, align: "center", sort: false, resize: false }];
function Q2(t2, e, n, a2) {
  const { selected: s, tasks: r } = t2.getState(), i = s.length, o2 = ["edit-task", "paste-task", "edit-task:task", "edit-task:segment"], c2 = ["copy-task", "cut-task"], d2 = ["copy-task", "cut-task", "delete-task", "indent-task:remove", "move-task:down"], u = ["add-task", "undo", "redo"], h = ["indent-task:add", "move-task:down", "move-task:up"], l2 = { "indent-task:remove": 2 }, f = !i && u.includes(e), g = { parent: h.includes(e), level: l2[e] };
  if (n = n || (i ? s[s.length - 1] : null), !(!n && !f)) {
    if (e !== "paste-task" && (t2._temp = null), o2.includes(e) || f || s.length === 1) he(t2, e, n, a2);
    else if (i) {
      const m = c2.includes(e) ? s : za(s, r, g);
      d2.includes(e) && m.reverse();
      const y3 = t2.getHistory();
      y3 && y3.startBatch(), m.forEach((p2, k4) => he(t2, e, p2, a2, k4)), y3 && y3.endBatch();
    }
  }
}
function za(t2, e, n) {
  let a2 = t2.map((s) => {
    const r = e.byId(s);
    return { id: s, level: r.$level, parent: r.parent, index: e.getIndexById(s) };
  });
  return (n.parent || n.level) && (a2 = a2.filter((s) => n.level && s.level <= n.level || !t2.includes(s.parent))), a2.sort((s, r) => s.level - r.level || s.index - r.index), a2.map((s) => s.id);
}
function he(t2, e, n, a2, s) {
  const r = t2.exec ? t2.exec : t2.in.exec;
  let i = e.split(":")[0], o2 = e.split(":")[1];
  const c2 = (n == null ? void 0 : n.id) || n;
  let d2 = { id: c2 }, u = {}, h = false;
  if (i == "copy-task" || i == "cut-task") {
    t2._temp || (t2._temp = []), t2._temp.push({ id: c2, cut: i == "cut-task" });
    return;
  } else if (i == "paste-task") {
    if (t2._temp && t2._temp.length) {
      const l2 = t2.getHistory();
      l2 && l2.startBatch();
      const f = /* @__PURE__ */ new Map();
      if (t2._temp.forEach((g) => {
        const m = { id: g.id, target: c2, mode: "after" };
        r(g.cut ? "move-task" : "copy-task", m), f.set(g.id, m.id);
      }), !t2._temp[0].cut) {
        const { links: g } = t2.getState(), m = t2._temp.map((p2) => p2.id), y3 = [];
        g.forEach((p2) => {
          m.includes(p2.source) && m.includes(p2.target) && y3.push(p2);
        }), y3.forEach((p2) => {
          r("add-link", { link: { source: f.get(p2.source), target: f.get(p2.target), type: p2.type } });
        }), t2._temp.forEach((p2, k4) => {
          r("select-task", { id: f.get(p2.id), toggle: !!k4 });
        });
      }
      l2 && l2.endBatch(), t2._temp = null;
    }
    return;
  } else i === "add-task" ? (u = { task: { type: "task", text: a2("New Task") }, target: c2, show: true, select: false }, d2 = {}, h = true) : i === "edit-task" ? (i = "show-editor", o2 === "segment" && typeof n == "object" && (u = n)) : i === "convert-task" ? (i = "update-task", u = { task: { type: o2 } }, o2 = void 0) : i === "indent-task" && (o2 = o2 === "add");
  if (i === "split-task" && typeof n == "object") u = n;
  else if (i === "delete-task" && o2 === "segment" && typeof n == "object") {
    const l2 = t2.getTask(c2), { segmentIndex: f } = n, g = l2.segments.filter((m, y3) => y3 !== f);
    r("update-task", { id: c2, task: { segments: g } });
    return;
  }
  typeof o2 < "u" && (u = __spreadValues({ mode: o2 }, u)), d2 = __spreadValues(__spreadValues({}, d2), u), r(i, d2), h && r("select-task", { id: d2.id, toggle: !!s });
}
function fe2(t2, e) {
  return t2.some((n) => n.data ? fe2(n.data, e) : n.id === e);
}
var me = (t2, e) => T(t2, e);
var Aa = (t2, e) => tt2(t2, e);
function ge2(t2, e) {
  Array.isArray(t2) && (t2.forEach((n) => H2(n, e)), t2.forEach((n) => {
    if (n.type === "summary" && !(n.start && n.end)) {
      const { start: a2, end: s } = yt(n, t2);
      n.start = a2, n.end = s, H2(n, e);
    }
  }));
}
function H2(t2, e) {
  t2.unscheduled || pe(t2, e, false), t2.base_start && pe(t2, e, true);
}
function pe(t2, e, n) {
  const { calendar: a2, durationUnit: s } = e, r = s || "day", [i, o2, c2] = ye2(n);
  t2.type === "milestone" ? (t2[c2] = 0, t2[o2] = void 0) : t2[i] && (t2[c2] ? t2[o2] = me(r, a2)(t2[i], t2[c2]) : t2[o2] ? t2[c2] = Aa(r, a2)(t2[o2], t2[i]) : (t2[o2] = me(r, a2)(t2[i], 1), t2[c2] = 1));
}
function ye2(t2) {
  return t2 ? ["base_start", "base_end", "base_duration"] : ["start", "end", "duration"];
}
function ke2(t2, e, n) {
  const [a2, s, r] = ye2(n);
  (e === r || e === a2) && (t2[s] = null), e === s && (t2[r] = 0, t2[a2] && t2[a2] >= t2[s] && (t2[s] = null, t2[r] = 1));
}
function Ba(t2, e, n) {
  ke2(t2, n, false), t2.base_start && ke2(t2, n, true), H2(t2, e);
}
var Fa = class extends De {
  constructor(e) {
    super({ writable: e, async: false });
    __publicField(this, "in");
    __publicField(this, "_router");
    __publicField(this, "_modules", /* @__PURE__ */ new Map());
    this._router = new Te(super.setState.bind(this), [{ in: ["tasks", "start", "end", "scales", "autoScale", "markers"], out: ["_start", "_end"], exec: (s) => {
      const { _end: r, _start: i, start: o2, end: c2, tasks: d2, scales: u, autoScale: h, markers: l2 } = this.getState();
      if (!o2 || !c2 || h) {
        const f = A(u).unit, g = ba(o2, c2, h, f, d2, l2);
        (g._end != r || g._start != i) && this.setState(g, s);
      } else this.setState({ _start: o2, _end: c2 }, s);
    } }, { in: ["_start", "_end", "cellWidth", "scaleHeight", "scales", "lengthUnit", "_weekStart"], out: ["_scales"], exec: (s) => {
      const r = this.getState();
      let { lengthUnit: i } = r;
      const { _start: o2, _end: c2, cellWidth: d2, scaleHeight: u, scales: h, _weekStart: l2 } = r, f = A(h).unit;
      ma(f, i) || (i = f);
      const g = xa(o2, c2, i, d2, u, l2, h);
      this.setState({ _scales: g }, s);
    } }, { in: ["_scales", "tasks", "cellHeight", "baselines", "unscheduledTasks"], out: ["_tasks"], exec: (s) => {
      const { cellWidth: r, cellHeight: i, tasks: o2, _scales: c2, baselines: d2, splitTasks: u, unscheduledTasks: h } = this.getState(), l2 = o2.toArray().map((f, g) => ce2(f, g, { cellWidth: r, cellHeight: i, _scales: c2, baselines: d2, splitTasks: u, unscheduledTasks: h }));
      this.setState({ _tasks: l2 }, s);
    } }, { in: ["_tasks", "links", "cellHeight"], out: ["_links"], exec: (s) => {
      const { tasks: r, links: i, cellHeight: o2, baselines: c2, criticalPath: d2 } = this.getState(), u = i.map((h) => {
        const l2 = r.byId(h.source), f = r.byId(h.target);
        return $a(h, l2, f, o2, c2);
      }).toSorted((h, l2) => d2 ? !!h.$critical == !!l2.$critical ? l2.$pl - h.$pl : h.$critical ? 1 : -1 : l2.$pl - h.$pl).filter((h) => h !== null);
      this.setState({ _links: u }, s);
    } }, { in: ["tasks", "activeTask"], out: ["_activeTask"], exec: (s) => {
      const r = this.getState();
      let { activeTask: i } = r;
      i && typeof i == "object" && (i = i.id);
      const o2 = r.tasks.byId(i);
      this.setState({ _activeTask: o2 || null }, s);
    } }, { in: ["tasks", "selected"], out: ["_selected"], exec: (s) => {
      const { tasks: r, selected: i } = this.getState(), o2 = i.map((c2) => r.byId(c2)).filter((c2) => !!c2);
      this.setState({ _selected: o2 }, s);
    } }, { in: ["start", "end"], out: ["cellWidth"], exec: (s) => {
      const { _cellWidth: r, cellWidth: i } = this.getState();
      r != i && this.setState({ cellWidth: r }, s);
    } }], { tasks: (s) => new Oe(s), links: (s) => new Wt(s), columns: (s) => Na(s) });
    const n = this.in = new We();
    n.on("show-editor", (s) => {
      const { splitTasks: r } = this.getState();
      if (r) {
        const { id: i, segmentIndex: o2 } = s;
        if (i && (o2 || o2 === 0)) {
          this.setStateAsync({ activeTask: { id: i, segmentIndex: o2 } });
          return;
        }
      }
      this.setStateAsync({ activeTask: s.id });
    }), n.on("select-task", ({ id: s, toggle: r, range: i, show: o2, segmentIndex: c2 }) => {
      const { selected: d2, _tasks: u, activeTask: h, splitTasks: l2 } = this.getState();
      let f = false, g;
      if (d2.length && (r || i)) {
        const y3 = [...d2];
        if (i) {
          const p2 = y3[y3.length - 1], k4 = u.findIndex((M2) => M2.id == p2), w = u.findIndex((M2) => M2.id == s), _3 = Math.min(k4, w), v3 = Math.max(k4, w) + 1, S4 = u.slice(_3, v3).map((M2) => M2.id);
          k4 > w && S4.reverse(), S4.forEach((M2) => {
            y3.includes(M2) || y3.push(M2);
          });
        } else if (r) {
          const p2 = y3.findIndex((k4) => k4 == s);
          p2 === -1 ? y3.push(s) : (f = true, y3.splice(p2, 1));
        }
        g = y3;
      } else g = [s];
      const m = { selected: g };
      o2 && g.length && (m._scrollTask = { id: g[0], mode: o2 }), this.setStateAsync(m), !f && h && (h !== s || l2) && n.exec("show-editor", __spreadValues({ id: s }, l2 && { segmentIndex: c2 }));
    }), n.on("delete-link", ({ id: s }) => {
      const { links: r } = this.getState();
      r.remove(s), this.setStateAsync({ links: r });
    }), n.on("update-link", (s) => {
      const { links: r } = this.getState(), i = s.id;
      let o2 = s.link;
      r.update(i, o2), o2 = r.byId(i), !o2.lag && o2.lag !== 0 && delete o2.lag, this.setStateAsync({ links: r }), s.link = o2;
    }), n.on("add-link", (s) => {
      const { link: r } = s, { links: i } = this.getState();
      !r.source || !r.target || (r.type || (r.type = "e2s"), r.id = r.id || nt2(), i.add(r), this.setStateAsync({ links: i }), s.id = r.id, s.link = i.byId(r.id));
    });
    let a2 = null;
    n.on("move-task", (s) => {
      const { tasks: r } = this.getState();
      let { mode: i, target: o2 } = s;
      const { id: c2, inProgress: d2 } = s, u = r.byId(c2);
      if (typeof d2 > "u" ? s.source = u.parent : s.source = a2 = a2 != null ? a2 : u.parent, d2 === false) {
        r.update(u.id, { $reorder: false }), this.setState({ tasks: r }), a2 = null;
        return;
      }
      if (o2 === c2 || r.contains(c2, o2)) {
        s.skipProvider = true;
        return;
      }
      if (i === "up" || i === "down") {
        const h = r.getBranch(c2);
        let l2 = r.getIndexById(c2);
        if (i === "up") {
          const f = u.parent === 0;
          if (l2 === 0 && f) {
            s.skipProvider = true;
            return;
          }
          l2 -= 1, i = "before";
        } else if (i === "down") {
          const f = l2 === h.length - 1, g = u.parent === 0;
          if (f && g) {
            s.skipProvider = true;
            return;
          }
          l2 += 1, i = "after";
        }
        if (o2 = h[l2] && h[l2].id || u.parent, o2) {
          const f = r.getBranch(o2);
          let g = r.getIndexById(o2), m = f[g];
          if (m.data) {
            if (i === "before") {
              if (m.parent === u.parent) {
                for (; m.data; ) m.open || n.exec("open-task", { id: m.id, mode: true }), m = m.data[m.data.length - 1];
                o2 = m.id;
              }
            } else if (i === "after") {
              let k4;
              m.parent === u.parent ? (k4 = m, m = m.data[0], o2 = m.id, i = "before") : f.length - 1 !== g && (k4 = m, g += 1, m = f[g], u.$level > m.$level && m.data ? (k4 = m, m = m.data[0], o2 = m.id, i = "before") : o2 = m.id), k4 && !k4.open && n.exec("open-task", { id: k4.id, mode: true });
            }
          }
          const y3 = r.getSummaryId(u.id);
          r.move(c2, i, o2);
          const p2 = r.getSummaryId(c2);
          y3 != p2 && (y3 && this.resetSummaryDates(y3, "move-task"), p2 && this.resetSummaryDates(p2, "move-task"));
        }
      } else {
        const h = r.byId(o2);
        let l2 = h, f = false;
        for (; l2.$level > u.$level; ) l2 = r.byId(l2.parent), l2.id === c2 && (f = true);
        if (f) return;
        const g = r.getSummaryId(u.id);
        if (r.move(c2, i, o2), i == "child") {
          let y3 = h;
          for (; y3.id !== 0 && !y3.open; ) n.exec("open-task", { id: y3.id, mode: true }), y3 = r.byId(y3.parent);
        }
        const m = r.getSummaryId(c2);
        g != m && (g && this.resetSummaryDates(g, "move-task"), m && this.resetSummaryDates(m, "move-task"));
      }
      d2 ? this.setState({ tasks: r }) : this.setStateAsync({ tasks: r }), s.target = o2, s.mode = i;
    }), n.on("drag-task", (s) => {
      const r = this.getState(), { tasks: i, _tasks: o2, _selected: c2, _scales: d2, cellWidth: u, cellHeight: h } = r, l2 = i.byId(s.id), { left: f, top: g, width: m, start: y3, inProgress: p2 } = s, k4 = { _tasks: o2, _selected: c2 };
      if (typeof m < "u" && (l2.$w = m, pt2(i, l2, { _scales: d2, cellWidth: u })), typeof f < "u") {
        if (l2.type === "summary") {
          const w = f - l2.$x;
          re2(l2, w, { _scales: d2, cellWidth: u });
        }
        l2.$x = f, pt2(i, l2, { _scales: d2, cellWidth: u, cellHeight: h }, !y3);
      }
      typeof g < "u" && (l2.$y = g + 4, l2.$reorder = p2), this.setState(k4);
    }), n.on("update-task", (s) => {
      var _a2, _b;
      const { id: r, segmentIndex: i, diff: o2, eventSource: c2 } = s;
      let { task: d2 } = s;
      const { tasks: u, _scales: h, durationUnit: l2, splitTasks: f, calendar: g } = this.getState(), m = u.byId(r), y3 = { durationUnit: l2, calendar: g };
      if (c2 === "add-task" || c2 === "copy-task" || c2 === "move-task" || c2 === "update-task" || c2 === "delete-task" || c2 === "provide-data") {
        H2(d2, y3), u.update(r, d2);
        return;
      }
      const p2 = h.lengthUnit;
      let k4 = T(p2);
      const w = tt2(l2, g);
      if (o2 && (d2.start && (d2.start = k4(d2.start, o2)), !i && i !== 0 && (d2.start && d2.end ? d2.duration = m.duration : (d2.start ? d2.end = m.end : (d2.end = k4(d2.end, o2), d2.start = m.start, d2.duration = w(d2.end, d2.start)), w(d2.end, d2.start) || (d2.duration = 1)))), d2.type = (_a2 = d2.type) != null ? _a2 : m.type, g && d2.start && (d2.start = ht2(d2.start, o2, g)), d2.start && d2.end && (!z2(d2.start, m.start) || !z2(d2.end, m.end)) && d2.type === "summary" && ((_b = m.data) == null ? void 0 : _b.length)) {
        let v3 = o2 || w(d2.start, m.start);
        g && (v3 = d2.start > m.start ? w(d2.start, m.start) : -w(m.start, d2.start), k4 = wa(g)), this.moveSummaryKids(m, (S4) => (S4 = k4(S4, v3), g ? ht2(S4, o2, g) : S4), "update-task");
      }
      d2.start || (d2.start = m.start), !d2.end && !d2.duration && (d2.duration = m.duration), H2(d2, y3), u.update(r, d2), (g && d2.type === "summary" || d2.type === "summary" && m.type !== "summary") && this.resetSummaryDates(r, "update-task", true);
      const _3 = u.getSummaryId(r);
      _3 && this.resetSummaryDates(_3, "update-task"), this.setStateAsync({ tasks: u }), s.task = u.byId(r);
    }), n.on("add-task", (s) => {
      const { tasks: r, _scales: i, unscheduledTasks: o2, durationUnit: c2, splitTasks: d2, calendar: u } = this.getState(), { target: h, mode: l2, task: f, show: g, select: m = true } = s;
      !s.eventSource && o2 && (f.unscheduled = true);
      let y3 = -1, p2, k4;
      if (h ? (k4 = r.byId(h), l2 == "child" ? (p2 = k4, f.parent = p2.id) : (k4.parent !== null && (p2 = r.byId(k4.parent), f.parent = p2.id), y3 = r.getIndexById(h), l2 == "after" && (y3 += 1))) : f.parent && (p2 = r.byId(f.parent)), !f.start) {
        if (p2 == null ? void 0 : p2.start) f.start = new Date(p2.start.valueOf());
        else if (k4) f.start = new Date(k4.start.valueOf());
        else {
          const S4 = r.getBranch(0);
          let M2;
          if (S4 == null ? void 0 : S4.length) {
            const B4 = S4[S4.length - 1];
            if (!B4.$skip) {
              const Dt2 = new Date(B4.start.valueOf());
              i.start <= Dt2 && (M2 = Dt2);
            }
          }
          f.start = M2 || T(c2, u)(i.start, 1);
        }
        f.duration = 1;
      }
      u && (f.start = ht2(f.start, 1, u)), this.getState().baselines && (f.base_start = f.start, f.base_duration = f.duration), H2(f, { durationUnit: c2, calendar: u });
      const w = r.add(f, y3), _3 = { tasks: r };
      if (p2 && g) {
        for (; p2 && p2.id; ) n.exec("open-task", { id: p2.id, mode: true }), p2 = r.byId(p2.parent);
        _3._scrollTask = { id: w.id, mode: g };
      }
      s.id = w.id;
      const v3 = r.getSummaryId(w.id);
      v3 && this.resetSummaryDates(v3, "add-task"), this.setStateAsync(_3), s.id = w.id, s.task = w, m && n.exec("select-task", { id: w.id });
    }), n.on("delete-task", (s) => {
      const { id: r } = s, { tasks: i, links: o2, selected: c2 } = this.getState();
      s.source = i.byId(r).parent;
      const d2 = i.getSummaryId(r), u = [r];
      i.eachChild((l2) => u.push(l2.id), r), o2.filter((l2) => !(u.includes(l2.source) || u.includes(l2.target)));
      const h = { tasks: i, links: o2 };
      c2.includes(r) && (h.selected = c2.filter((l2) => l2 !== r)), i.remove(r), d2 && this.resetSummaryDates(d2, "delete-task"), this.setStateAsync(h);
    }), n.on("indent-task", ({ id: s, mode: r }) => {
      const { tasks: i } = this.getState();
      if (r) {
        const o2 = i.getBranch(s)[i.getIndexById(s) - 1];
        o2 && n.exec("move-task", { id: s, mode: "child", target: o2.id });
      } else {
        const o2 = i.byId(s), c2 = i.byId(o2.parent);
        c2 && c2.parent !== null && n.exec("move-task", { id: s, mode: "after", target: o2.parent });
      }
    }), n.on("copy-task", (s) => {
      const { id: r, target: i, mode: o2, eventSource: c2 } = s;
      if (c2 === "copy-task") return;
      const { tasks: d2, links: u } = this.getState();
      if (d2.contains(r, i)) {
        s.skipProvider = true;
        return;
      }
      const h = d2.getSummaryId(r), l2 = d2.getSummaryId(i);
      let f = d2.getIndexById(i);
      o2 == "before" && (f -= 1);
      const g = d2.byId(r), m = d2.copy(g, d2.byId(i).parent, f + 1);
      s.source = s.id, s.id = m[0][1], g.lazy && (s.lazy = true), h != l2 && l2 && this.resetSummaryDates(l2, "copy-task");
      let y3 = [];
      for (let p2 = 1; p2 < m.length; p2++) {
        const [k4, w] = m[p2];
        u.forEach((_3) => {
          if (_3.source === k4) {
            const v3 = __spreadValues({}, _3);
            delete v3.target, y3.push(__spreadProps(__spreadValues({}, v3), { source: w }));
          } else if (_3.target === k4) {
            const v3 = __spreadValues({}, _3);
            delete v3.source, y3.push(__spreadProps(__spreadValues({}, v3), { target: w }));
          }
        });
      }
      y3 = y3.reduce((p2, k4) => {
        const w = p2.findIndex((_3) => _3.id === k4.id);
        return w > -1 ? p2[w] = __spreadValues(__spreadValues({}, p2[w]), k4) : p2.push(k4), p2;
      }, []);
      for (let p2 = 1; p2 < m.length; p2++) {
        const [k4, w] = m[p2], _3 = d2.byId(w);
        n.exec("copy-task", { source: k4, id: w, lazy: !!_3.lazy, eventSource: "copy-task", target: _3.parent, mode: "child", skipUndo: true });
      }
      y3.forEach((p2) => {
        n.exec("add-link", { link: { source: p2.source, target: p2.target, type: p2.type }, eventSource: "copy-task", skipUndo: true });
      }), this.setStateAsync({ tasks: d2 });
    }), n.on("open-task", ({ id: s, mode: r }) => {
      const { tasks: i } = this.getState(), o2 = i.byId(s);
      o2.lazy ? n.exec("request-data", { id: o2.id }) : (i.toArray().forEach((c2) => c2.$y = 0), i.update(s, { open: r }), this.setState({ tasks: i }));
    }), n.on("scroll-chart", ({ left: s, top: r }) => {
      if (!isNaN(s)) {
        const i = this.calcScaleDate(s);
        this.setState({ scrollLeft: s, _scaleDate: i });
      }
      isNaN(r) || this.setState({ scrollTop: r });
    }), n.on("render-data", (s) => {
      this.setState({ area: s });
    }), n.on("provide-data", (s) => {
      const { tasks: r, links: i, durationUnit: o2, calendar: c2, splitTasks: d2 } = this.getState(), u = r.byId(s.id);
      u.lazy ? (u.lazy = false, u.open = true) : u.data = [], ge2(s.data.tasks, { durationUnit: o2, calendar: c2 }), r.parse(s.data.tasks, s.id), u.type == "summary" && this.resetSummaryDates(u.id, "provide-data"), this.setStateAsync({ tasks: r, links: new Wt(i.map((h) => h).concat(ue2(s.data.links))) });
    }), n.on("zoom-scale", ({ dir: s, offset: r }) => {
      const { zoom: i, cellWidth: o2, _cellWidth: c2, scrollLeft: d2 } = this.getState(), u = r + d2, h = this.calcScaleDate(u);
      let l2 = o2;
      s < 0 && (l2 = c2 || o2);
      const f = l2 + s * 50, g = i.levels[i.level], m = s < 0 && o2 > g.maxCellWidth;
      if (f < g.minCellWidth || f > g.maxCellWidth || m) {
        if (!this.changeScale(i, s)) return;
      } else this.setState({ cellWidth: f, _cellWidth: f });
      const { _scales: y3, _start: p2, cellWidth: k4, _weekStart: w } = this.getState(), _3 = $2(y3.minUnit, p2, w), v3 = y3.diff(h, _3, "hour");
      typeof r > "u" && (r = k4);
      let S4 = Math.round(v3 * k4) - r;
      S4 < 0 && (S4 = 0), this.setState({ scrollLeft: S4, _scaleDate: h, _zoomOffset: r });
    }), n.on("expand-scale", ({ minWidth: s }) => {
      const { _start: r, _scales: i, start: o2, end: c2, _end: d2, cellWidth: u, _scaleDate: h, _zoomOffset: l2 } = this.getState(), f = T(i.minUnit);
      let g = i.width;
      if (o2 && c2) {
        if (g < s && g) {
          const w = s / g;
          this.setState({ cellWidth: u * w });
        }
        return true;
      }
      let m = 0;
      for (; g < s; ) g += u, m++;
      const y3 = m && c2 ? -m : 0, p2 = o2 || f(r, y3);
      let k4 = 0;
      if (h) {
        const w = i.diff(h, p2, "hour");
        k4 = Math.max(0, Math.round(w * u) - (l2 || 0));
      }
      this.setState({ _start: p2, _end: c2 || f(d2, m), scrollLeft: k4 });
    }), n.on("sort-tasks", ({ key: s, order: r, add: i }) => {
      const o2 = this.getState(), { tasks: c2 } = o2;
      let d2 = o2._sort;
      const u = { key: s, order: r };
      let h = (d2 == null ? void 0 : d2.length) || 0;
      h && i ? (d2.forEach((l2, f) => {
        l2.key === s && (h = f);
      }), d2[h] = u) : d2 = [u], c2.sort(d2), this.setState({ _sort: d2, tasks: c2 });
    }), n.on("hotkey", ({ key: s, event: r, eventSource: i }) => {
      var _a2, _b, _c, _d;
      switch (s) {
        case "arrowup":
        case "arrowdown": {
          const { selected: o2, _tasks: c2 } = this.getState();
          r.preventDefault();
          const d2 = o2.length;
          let u;
          if (s === "arrowup" ? u = d2 ? (_a2 = this.getPrevRow(o2[d2 - 1])) == null ? void 0 : _a2.id : (_b = c2[c2.length - 1]) == null ? void 0 : _b.id : u = d2 ? (_c = this.getNextRow(o2[d2 - 1])) == null ? void 0 : _c.id : (_d = c2[0]) == null ? void 0 : _d.id, u) {
            const h = i === "chart" ? "xy" : true;
            this.in.exec("select-task", { id: u, show: h });
          }
          break;
        }
        case "ctrl+c": {
          Q2(this, "copy-task", null, null);
          break;
        }
        case "ctrl+x": {
          Q2(this, "cut-task", null, null);
          break;
        }
        case "ctrl+v": {
          Q2(this, "paste-task", null, null);
          break;
        }
        case "ctrl+d":
        case "backspace": {
          r.preventDefault(), Q2(this, "delete-task", null, null);
          break;
        }
        case "ctrl+z": {
          this.in.exec("undo", {});
          break;
        }
        case "ctrl+y": {
          this.in.exec("redo", {});
          break;
        }
      }
    });
  }
  init(e) {
    var _a2;
    const n = this.getState().area ? {} : { scrollLeft: 0, scrollTop: 0, area: { from: 0, start: 0, end: 0 } };
    e.cellWidth && (e._cellWidth = e.cellWidth), e._sort = null, e.unscheduledTasks = false, e.baselines = false, e.markers = [], e._markers = [], e.undo = false, e.schedule = {}, e.criticalPath = null, e.splitTasks = false, e.summary = {}, Array.isArray(e.tasks) && ((_a2 = this.getHistory()) == null ? void 0 : _a2.resetHistory()), this._router.init(__spreadValues(__spreadValues({ _scrollTask: null, selected: [], markers: [], autoScale: true, durationUnit: "day" }, n), e));
  }
  setState(e, n) {
    return this._router.setState(e, n);
  }
  setStateAsync(e) {
    this._router.setStateAsync(e);
  }
  getTask(e) {
    const { tasks: n } = this.getState();
    return n.byId(e);
  }
  getHistory() {
    return this.getState().undo ? this._modules.get("historyManager") : null;
  }
  serialize() {
    return this.getState().tasks.serialize();
  }
  changeScale(e, n) {
    const a2 = e.level + n, s = e.levels[a2];
    if (s) {
      const { cellWidth: r, scales: i, _scales: o2 } = this.getState(), c2 = va(e, n, a2, s, o2.lengthUnit, i, r);
      return c2._cellWidth = c2.cellWidth, this.setState(c2), true;
    }
    return false;
  }
  isScheduled(e) {
    return this.getState().unscheduledTasks ? e.some((n) => !n.unscheduled || n.data && this.isScheduled(n.data)) : true;
  }
  resetSummaryDates(e, n, a2) {
    const { tasks: s, durationUnit: r, splitTasks: i, calendar: o2 } = this.getState(), c2 = s.byId(e), d2 = c2.data;
    if ((d2 == null ? void 0 : d2.length) && this.isScheduled(d2)) {
      const u = yt(__spreadProps(__spreadValues({}, c2), { start: void 0, end: void 0, duration: void 0 }));
      if (!z2(c2.start, u.start) || !z2(c2.end, u.end)) {
        a2 ? (H2(u, { durationUnit: r, calendar: o2 }), s.update(e, u)) : this.in.exec("update-task", { id: e, task: u, eventSource: n, skipUndo: true });
        const h = s.getSummaryId(e);
        h && this.resetSummaryDates(h, n);
      }
    }
  }
  moveSummaryKids(e, n, a2) {
    const { tasks: s } = this.getState();
    e.data.forEach((r) => {
      var _a2;
      const i = __spreadProps(__spreadValues({}, s.byId(r.id)), { start: n(r.start) });
      delete i.end, delete i.id, this.in.exec("update-task", { id: r.id, task: i, eventSource: a2, skipUndo: true }), ((_a2 = r.data) == null ? void 0 : _a2.length) && this.moveSummaryKids(r, n, a2);
    });
  }
  calcScaleDate(e) {
    const { _scales: n, _start: a2, _weekStart: s } = this.getState(), r = n.lengthUnit === "day" ? n.lengthUnitWidth / 24 : n.lengthUnitWidth;
    return T("hour")($2(n.minUnit, a2, s), Math.floor(e / r));
  }
  getNextRow(e) {
    const n = this.getState()._tasks, a2 = n.findIndex((s) => s.id == e);
    return n[a2 + 1];
  }
  getPrevRow(e) {
    const n = this.getState()._tasks, a2 = n.findIndex((s) => s.id == e);
    return n[a2 - 1];
  }
};
function qa(t2, e, n, a2) {
  if (typeof document > "u") return "";
  const s = document.createElement("canvas");
  {
    const r = Ua(s, t2, e, 1, n);
    ja(r, a2, 0, t2, 0, e);
  }
  return s.toDataURL();
}
function Ua(t2, e, n, a2, s) {
  t2.setAttribute("width", (e * a2).toString()), t2.setAttribute("height", (n * a2).toString());
  const r = t2.getContext("2d");
  return r.translate(-0.5, -0.5), r.strokeStyle = s, r;
}
function ja(t2, e, n, a2, s, r) {
  t2.beginPath(), t2.moveTo(a2, s), t2.lineTo(a2, r), e === "full" && t2.lineTo(n, r), t2.stroke();
}
var bt = [{ id: "task", label: "Task" }, { id: "summary", label: "Summary task" }, { id: "milestone", label: "Milestone" }];
function La(t2) {
  let e = [...be2];
  const n = (t2 == null ? void 0 : t2.taskTypes) || bt, a2 = e.find((s) => s.id == "convert-task");
  return a2.data = [], n.forEach((s) => {
    var _a2;
    (!((_a2 = t2 == null ? void 0 : t2.summary) == null ? void 0 : _a2.autoConvert) || s.id !== "summary") && a2.data.push(a2.dataFactory(s));
  }), e;
}
function xt2(t2) {
  return t2.map((e) => {
    switch (e.data && xt2(e.data), e.id) {
      case "add-task:before":
      case "move-task:up":
        e.isDisabled = (n, a2) => Qa(n, a2);
        break;
      case "move-task:down":
        e.isDisabled = (n, a2) => Ga(n, a2);
        break;
      case "indent-task:add":
        e.isDisabled = (n, a2) => Ra(n, a2) === n.parent;
        break;
      case "indent-task:remove":
        e.isDisabled = (n) => Xa(n);
        break;
    }
    return e;
  });
}
function Xa(t2) {
  return t2.parent === 0;
}
function Qa(t2, e) {
  var _a2;
  const { _tasks: n } = e;
  return ((_a2 = n[0]) == null ? void 0 : _a2.id) === t2.id;
}
function Ga(t2, e) {
  var _a2;
  const { _tasks: n } = e;
  return ((_a2 = n[n.length - 1]) == null ? void 0 : _a2.id) === t2.id;
}
function Ra(t2, e) {
  var _a2, _b;
  const { _tasks: n } = e, a2 = n.findIndex((s) => s.id === t2.id);
  return (_b = (_a2 = n[a2 - 1]) == null ? void 0 : _a2.id) != null ? _b : t2.parent;
}
function we2(t2) {
  return t2 && typeof t2 == "object";
}
function Ja(t2) {
  return !t2.selected || t2.selected.length < 2;
}
var Va = (t2) => (e) => e.type === t2;
var be2 = xt2([{ id: "add-task", text: "Add", icon: "wxi-plus", data: [{ id: "add-task:child", text: "Child task" }, { id: "add-task:before", text: "Task above" }, { id: "add-task:after", text: "Task below" }] }, { type: "separator" }, { id: "convert-task", text: "Convert to", icon: "wxi-swap-horizontal", dataFactory: (t2) => ({ id: `convert-task:${t2.id}`, text: `${t2.label}`, isDisabled: Va(t2.id) }) }, { id: "edit-task", text: "Edit", icon: "wxi-edit", isHidden: (t2, e, n) => we2(n) }, { type: "separator" }, { id: "cut-task", text: "Cut", icon: "wxi-content-cut", subtext: "Ctrl+X" }, { id: "copy-task", text: "Copy", icon: "wxi-content-copy", subtext: "Ctrl+C" }, { id: "paste-task", text: "Paste", icon: "wxi-content-paste", subtext: "Ctrl+V" }, { id: "move-task", text: "Move", icon: "wxi-swap-vertical", data: [{ id: "move-task:up", text: "Up" }, { id: "move-task:down", text: "Down" }] }, { type: "separator" }, { id: "indent-task:add", text: "Indent", icon: "wxi-indent" }, { id: "indent-task:remove", text: "Outdent", icon: "wxi-unindent" }, { type: "separator" }, { id: "delete-task", icon: "wxi-delete", text: "Delete", subtext: "Ctrl+D / BS", isHidden: (t2, e, n) => Ja(e) && we2(n) }]);
function Ka(t2) {
  return [...xe2];
}
var xe2 = xt2([{ id: "add-task", comp: "button", icon: "wxi-plus", text: "New task", type: "primary" }, { id: "edit-task", comp: "icon", icon: "wxi-edit", menuText: "Edit", text: "Ctrl+E" }, { id: "delete-task", comp: "icon", icon: "wxi-delete", menuText: "Delete", text: "Ctrl+D, Backspace" }, { comp: "separator" }, { id: "move-task:up", comp: "icon", icon: "wxi-angle-up", menuText: "Move up" }, { id: "move-task:down", comp: "icon", icon: "wxi-angle-down", menuText: "Move down" }, { comp: "separator" }, { id: "copy-task", comp: "icon", icon: "wxi-content-copy", menuText: "Copy", text: "Ctrl+V" }, { id: "cut-task", comp: "icon", icon: "wxi-content-cut", menuText: "Cut", text: "Ctrl+X" }, { id: "paste-task", comp: "icon", icon: "wxi-content-paste", menuText: "Paste", text: "Ctrl+V" }, { comp: "separator" }, { id: "indent-task:add", comp: "icon", icon: "wxi-indent", menuText: "Indent" }, { id: "indent-task:remove", comp: "icon", icon: "wxi-unindent", menuText: "Outdent" }]);
function _t2(t2) {
  return t2.type === "summary";
}
function vt(t2) {
  return t2.type === "milestone";
}
function St(t2) {
  return typeof t2.parent > "u";
}
function Mt(t2, e) {
  return e.unscheduledTasks && t2.unscheduled;
}
function Za(t2) {
  const e = _e2.map((a2) => __spreadValues({}, a2)), n = e.find((a2) => a2.key == "type");
  return n.options = (t2 == null ? void 0 : t2.taskTypes) || bt, e;
}
var _e2 = [{ key: "text", comp: "text", label: "Name", config: { placeholder: "Add task name" } }, { key: "details", comp: "textarea", label: "Description", config: { placeholder: "Add description" } }, { key: "type", comp: "select", label: "Type", isHidden: (t2) => St(t2) }, { key: "start", comp: "date", label: "Start date", isHidden: (t2) => _t2(t2), isDisabled: Mt }, { key: "end", comp: "date", label: "End date", isHidden: (t2) => _t2(t2) || vt(t2), isDisabled: Mt }, { key: "duration", comp: "counter", label: "Duration", config: { min: 1 }, isHidden: (t2) => _t2(t2) || vt(t2), isDisabled: Mt }, { key: "progress", comp: "slider", label: "Progress", config: { min: 1, max: 100 }, isHidden: (t2) => vt(t2) || St(t2) }, { key: "links", comp: "links", label: "", isHidden: (t2) => St(t2) }];

// node_modules/@svar-ui/grid-store/dist/index.js
var F2 = (/* @__PURE__ */ new Date()).valueOf();
function U2(r, e) {
  if (Object.keys(r).length !== Object.keys(e).length) return false;
  for (const o2 in e) {
    const t2 = r[o2], i = e[o2];
    if (!k(t2, i)) return false;
  }
  return true;
}
function k(r, e) {
  if (typeof r == "number" || typeof r == "string" || typeof r == "boolean" || r === null) return r === e;
  if (typeof r != typeof e || (r === null || e === null) && r !== e || r instanceof Date && e instanceof Date && r.getTime() !== e.getTime()) return false;
  if (typeof r == "object") if (Array.isArray(r) && Array.isArray(e)) {
    if (r.length !== e.length) return false;
    for (let o2 = r.length - 1; o2 >= 0; o2--) if (!k(r[o2], e[o2])) return false;
    return true;
  } else return U2(r, e);
  return r === e;
}
function I2(r) {
  if (typeof r != "object" || r === null) return r;
  if (r instanceof Date) return new Date(r);
  if (r instanceof Array) return r.map(I2);
  const e = {};
  for (const o2 in r) e[o2] = I2(r[o2]);
  return e;
}
var D2 = 2;
var K2 = class {
  constructor(r) {
    r && (this._writable = r.writable, this._async = r.async), this._values = {}, this._state = {};
  }
  setState(r, e = 0) {
    const o2 = {};
    return this._wrapProperties(r, this._state, this._values, "", o2, e), o2;
  }
  getState() {
    return this._values;
  }
  getReactive() {
    return this._state;
  }
  _wrapProperties(r, e, o2, t2, i, s) {
    for (const a2 in r) {
      const n = e[a2], l2 = o2[a2], c2 = r[a2];
      if (n && (l2 === c2 && typeof c2 != "object" || c2 instanceof Date && l2 instanceof Date && l2.getTime() === c2.getTime())) continue;
      const d2 = t2 + (t2 ? "." : "") + a2;
      n ? (n.__parse(c2, d2, i, s) && (o2[a2] = c2), s & D2 ? i[d2] = n.__trigger : n.__trigger()) : (c2 && c2.__reactive ? e[a2] = this._wrapNested(c2, c2, d2, i) : e[a2] = this._wrapWritable(c2), o2[a2] = c2), i[d2] = i[d2] || null;
    }
  }
  _wrapNested(r, e, o2, t2) {
    const i = this._wrapWritable(r);
    return this._wrapProperties(r, i, e, o2, t2, 0), i.__parse = (s, a2, n, l2) => (this._wrapProperties(s, i, e, a2, n, l2), false), i;
  }
  _wrapWritable(r) {
    const e = [], o2 = function() {
      for (let t2 = 0; t2 < e.length; t2++) e[t2](r);
    };
    return { subscribe: (t2) => (e.push(t2), this._async ? setTimeout(t2, 1, r) : t2(r), () => {
      const i = e.indexOf(t2);
      i >= 0 && e.splice(i, 1);
    }), __trigger: () => {
      e.length && (this._async ? setTimeout(o2, 1) : o2());
    }, __parse: function(t2) {
      return r = t2, true;
    } };
  }
};
var B2 = class {
  constructor(r, e, o2, t2) {
    typeof r == "function" ? this._setter = r : this._setter = r.setState.bind(r), this._routes = e, this._parsers = o2, this._prev = {}, this._triggers = /* @__PURE__ */ new Map(), this._sources = /* @__PURE__ */ new Map(), this._routes.forEach((i) => {
      i.in.forEach((s) => {
        const a2 = this._triggers.get(s) || [];
        a2.push(i), this._triggers.set(s, a2);
      }), i.out.forEach((s) => {
        const a2 = this._sources.get(s) || {};
        i.in.forEach((n) => a2[n] = true), this._sources.set(s, a2);
      });
    }), this._routes.forEach((i) => {
      i.length = Math.max(...i.in.map((s) => H3(s, this._sources, 1)));
    }), this._bus = t2;
  }
  init(r) {
    const e = {};
    for (const o2 in r) if (this._prev[o2] !== r[o2]) {
      const t2 = this._parsers[o2];
      e[o2] = t2 ? t2(r[o2]) : r[o2];
    }
    this._prev = this._prev ? __spreadValues(__spreadValues({}, this._prev), r) : __spreadValues({}, r), this.setState(e), this._bus && this._bus.exec("init-state", e);
  }
  setStateAsync(r) {
    const e = this._setter(r, D2);
    return this._async ? Object.assign(this._async.signals, e) : this._async = { signals: e, timer: setTimeout(this._applyState.bind(this), 1) }, e;
  }
  _applyState() {
    const r = this._async;
    if (r) {
      this._async = null, this._triggerUpdates(r.signals, []);
      for (const e in r.signals) {
        const o2 = r.signals[e];
        o2 && o2();
      }
    }
  }
  setState(r, e = []) {
    const o2 = this._setter(r);
    return this._triggerUpdates(o2, e), o2;
  }
  _triggerUpdates(r, e) {
    const o2 = Object.keys(r), t2 = !e.length;
    e = e || [];
    for (let i = 0; i < o2.length; i++) {
      const s = o2[i], a2 = this._triggers.get(s);
      a2 && a2.forEach((n) => {
        e.indexOf(n) == -1 && e.push(n);
      });
    }
    t2 && this._execNext(e);
  }
  _execNext(r) {
    for (; r.length; ) {
      r.sort((o2, t2) => o2.length < t2.length ? 1 : -1);
      const e = r[r.length - 1];
      r.splice(r.length - 1), e.exec(r);
    }
  }
};
function H3(r, e, o2) {
  const t2 = e.get(r);
  if (!t2) return o2;
  const i = Object.keys(t2).map((s) => H3(s, e, o2 + 1));
  return Math.max(...i);
}
var X2 = class {
  constructor() {
    this._nextHandler = null, this._handlers = {}, this._tag = /* @__PURE__ */ new WeakMap(), this.exec = this.exec.bind(this);
  }
  on(r, e, o2) {
    let t2 = this._handlers[r];
    t2 ? o2 && o2.intercept ? t2.unshift(e) : t2.push(e) : t2 = this._handlers[r] = [e], o2 && o2.tag && this._tag.set(e, o2.tag);
  }
  intercept(r, e, o2) {
    this.on(r, e, __spreadProps(__spreadValues({}, o2), { intercept: true }));
  }
  detach(r) {
    for (const e in this._handlers) {
      const o2 = this._handlers[e];
      for (let t2 = o2.length - 1; t2 >= 0; t2--) this._tag.get(o2[t2]) === r && o2.splice(t2, 1);
    }
  }
  exec(r, e) {
    return __async(this, null, function* () {
      const o2 = this._handlers[r];
      if (o2) for (let t2 = 0; t2 < o2.length; t2++) {
        const i = o2[t2](e);
        if (i === false || i && i.then && (yield i) === false) return;
      }
      return this._nextHandler && (yield this._nextHandler.exec(r, e)), e;
    });
  }
  setNext(r) {
    return this._nextHandler = r;
  }
};
function q2(r) {
  return (e) => e[r];
}
function Y(r) {
  return (e, o2) => e[r] = o2;
}
function S(r, e) {
  return (e.getter || q2(e.id))(r);
}
function M(r, e, o2) {
  return (e.setter || Y(e.id))(r, o2);
}
function P2(r, e) {
  const o2 = document.createElement("a");
  o2.href = URL.createObjectURL(r), o2.download = e, document.body.appendChild(o2), o2.click(), document.body.removeChild(o2);
}
function b2(r, e) {
  var _a2;
  let o2 = (_a2 = S(r, e)) != null ? _a2 : "";
  return e.template && (o2 = e.template(o2, r, e)), e.optionsMap && (Array.isArray(o2) ? o2 = o2.map((t2) => e.optionsMap.get(t2)) : o2 = e.optionsMap.get(o2)), typeof o2 > "u" ? "" : o2 + "";
}
function G3(r, e) {
  const o2 = /\n|"|;|,/;
  let t2 = "";
  const i = e.rows || `
`, s = e.cols || "	", a2 = r._columns, n = r.flatData;
  e.header !== false && a2[0].header && (t2 = z3("header", a2, t2, s, i));
  for (let l2 = 0; l2 < n.length; l2++) {
    const c2 = [];
    for (let d2 = 0; d2 < a2.length; d2++) {
      let h = b2(n[l2], a2[d2]);
      o2.test(h) && (h = '"' + h.replace(/"/g, '""') + '"'), c2.push(h);
    }
    t2 += (t2 ? i : "") + c2.join(s);
  }
  return e.footer !== false && a2[0].footer && (t2 = z3("footer", a2, t2, s, i)), t2;
}
function z3(r, e, o2, t2, i) {
  const s = /\n|"|;|,/;
  for (let a2 = 0; a2 < e[0][r].length; a2++) {
    const n = [];
    for (let l2 = 0; l2 < e.length; l2++) {
      let c2 = (e[l2][r][a2].text || "") + "";
      s.test(c2) && (c2 = '"' + c2.replace(/"/g, '""') + '"'), n.push(c2);
    }
    o2 += (o2 ? i : "") + n.join(t2);
  }
  return o2;
}
function J3(r, e, o2) {
  var _a2, _b;
  const t2 = [], i = [], s = [];
  let a2 = [];
  const n = r._columns, l2 = r.flatData, c2 = r._sizes;
  for (const h of n) s.push({ width: h.flexgrow ? c2.columnWidth : h.width });
  let d2 = 0;
  e.header !== false && n[0].header && (A2("header", n, t2, i, d2, e, o2), a2 = a2.concat(c2.headerRowHeights.map((h) => ({ height: h }))), d2 += n[0].header.length);
  for (let h = 0; h < l2.length; h++) {
    const u = [];
    for (let f = 0; f < n.length; f++) {
      const p2 = l2[h], g = n[f], w = (_a2 = S(p2, g)) != null ? _a2 : "";
      let x2 = b2(p2, g), m;
      e.cellStyle && (m = e.cellStyle(w, p2, g)), e.cellTemplate && (x2 = (_b = e.cellTemplate(w, p2, g)) != null ? _b : x2);
      const y3 = L2(x2, 2, m, o2);
      u.push(y3);
    }
    t2.push(u), a2.push({ height: c2.rowHeight });
  }
  return d2 += l2.length, e.footer !== false && n[0].footer && (A2("footer", n, t2, i, d2, e, o2), a2 = a2.concat(c2.footerRowHeights.map((h) => ({ height: h })))), { cells: t2, merged: i, rowSizes: a2, colSizes: s, styles: o2 };
}
function A2(r, e, o2, t2, i, s, a2) {
  var _a2, _b;
  for (let n = 0; n < e[0][r].length; n++) {
    const l2 = [];
    for (let c2 = 0; c2 < e.length; c2++) {
      const d2 = e[c2][r][n], h = d2.colspan ? d2.colspan - 1 : 0, u = d2.rowspan ? d2.rowspan - 1 : 0;
      (h || u) && t2.push({ from: { row: n + i, column: c2 }, to: { row: n + i + u, column: c2 + h } });
      let f = (_a2 = d2.text) != null ? _a2 : "", p2;
      s.headerCellStyle && (p2 = s.headerCellStyle(f, d2, e[c2], r)), s.headerCellTemplate && (f = (_b = s.headerCellTemplate(f, d2, e[c2], r)) != null ? _b : f);
      let g;
      r == "header" ? n == e[0][r].length - 1 ? g = 1 : g = 0 : n ? g = 4 : g = 3;
      const w = L2(f, g, p2, a2);
      l2.push(w);
    }
    o2.push(l2);
  }
}
function L2(r, e, o2, t2) {
  let i = e;
  if (r && r instanceof Date && (r = ee3(r), o2 = o2 || {}, o2.format = o2.format || "dd/mm/yyyy"), o2) {
    o2 = __spreadValues(__spreadValues({}, t2[e]), o2);
    const s = t2.findIndex((a2) => k(a2, o2));
    s < 0 ? (t2.push(o2), i = t2.length - 1) : i = s;
  }
  return { v: r + "", s: i };
}
function Q3(r) {
  const e = { material: "#000000", willow: "#000000", "willow-dark": "#ffffff" }, o2 = { material: "none", willow: "none", "willow-dark": "#2a2b2d" }, t2 = { material: "#fafafb", willow: "#f2f3f7", "willow-dark": "#20262b" }, i = { material: "0.5px solid #dfdfdf", willow: "0.5px solid #e6e6e6", "willow-dark": "0.5px solid #384047" }, s = { material: "#dfdfdf", willow: "#e6e6e6", "willow-dark": "#384047" }, a2 = e[r], n = "0.5px solid " + s[r], l2 = { verticalAlign: "center", align: "left" }, c2 = __spreadProps(__spreadValues({ fontWeight: "bold", color: a2, background: t2[r] }, l2), { borderBottom: n, borderRight: n });
  return { cell: __spreadValues({ color: a2, background: o2[r], borderBottom: i[r], borderRight: i[r] }, l2), header: __spreadValues({}, c2), footer: __spreadValues({}, c2) };
}
function ee3(r) {
  return r ? 25569 + (r.getTime() - r.getTimezoneOffset() * 6e4) / (86400 * 1e3) : null;
}
var te3 = "portrait";
var oe2 = 100;
var ie3 = "a4";
var se3 = { a3: { width: 11.7, height: 16.5 }, a4: { width: 8.27, height: 11.7 }, letter: { width: 8.5, height: 11 } };
function re3(r, e) {
  const o2 = [];
  let t2 = [], i = 0;
  const s = r.filter((n) => !n.hidden), a2 = ae3(e);
  return s.forEach((n, l2) => {
    i + n.width <= a2 ? (i += n.width, t2.push(n)) : (t2.length && o2.push(t2), t2 = [n], i = n.width), l2 === s.length - 1 && t2.length && o2.push(t2);
  }), o2;
}
function ne2(r, e, o2) {
  const t2 = [];
  return r.forEach((i, s) => {
    const a2 = i[e];
    for (let n = 0; n < o2.length; n++) {
      t2[n] || (t2[n] = []);
      const l2 = __spreadValues({}, a2[n]);
      if (t2[n][s] !== null) {
        if (!s && !l2.rowspan && !l2.colspan) {
          let c2 = 1, d2 = r[s + c2][e][n], h = l2.width;
          for (; !d2.rowspan && !d2.colspan; ) c2++, d2 = r[s + c2][e][n], h += d2.width;
          l2.colspan = c2, l2.width = h, l2.height = o2[n];
        }
        if (t2[n].push(l2), !l2.collapsed && l2.colspan > 1) {
          let c2 = l2.colspan - 1;
          if (l2.colspan + s > r.length) {
            const d2 = l2.colspan - (l2.colspan + s - r.length);
            l2.colspan = d2, l2.width = r.slice(s, s + c2 + 1).reduce((h, u) => h + u.width, 0), d2 > 1 && (c2 = d2 - 1);
          }
          for (let d2 = 0; d2 < c2; d2++) t2[n].push(null);
        }
        if (l2.rowspan > 1) {
          const c2 = l2.rowspan;
          for (let d2 = 1; d2 < c2; d2++) t2[n + d2] || (t2[n + d2] = []), t2[n + d2].push(null);
        }
      }
    }
    if (i.collapsed) for (let n = 0; n < t2.length; n++) {
      const l2 = t2[n], c2 = l2[s];
      if (c2 && c2.collapsed) {
        if (l2[s] = null, !n) break;
      } else {
        const d2 = c2 || l2.findLast((h) => (h == null ? void 0 : h.colspan) >= 1);
        d2 && (d2.colspan = d2.colspan - 1, d2.width = d2.width - i.width);
      }
    }
  }), t2.map((i) => i.filter((s) => s && s.colspan !== 0));
}
function ae3(r) {
  const { mode: e, ppi: o2, paper: t2 } = r, { width: i, height: s } = se3[t2];
  return le2(e === "portrait" ? i : s, o2);
}
function le2(r, e) {
  return r * e;
}
function ce3(r = {}) {
  const { mode: e, ppi: o2, paper: t2 } = r;
  return { mode: e || te3, ppi: o2 || oe2, paper: t2 || ie3 };
}
function de2(r, e) {
  return r.flexgrow ? `min-width:${e}px;width:auto` : `width:${r.width}px; max-width:${r.width}px; height:${r.height}px`;
}
function he2(r, e, o2) {
  var _a2;
  let t2 = r[o2.id];
  if (o2.filter.type === "richselect" && t2) {
    const i = ((_a2 = o2.filter.config) == null ? void 0 : _a2.options) || e.find(({ id: s }) => s == o2.id).options;
    i && (t2 = i.find(({ id: s }) => s == t2).label);
  }
  return t2 != null ? t2 : "";
}
var N2 = ["resize-column", "hide-column", "update-cell"];
var ue3 = ["delete-row", "update-row", "update-cell"];
var fe3 = ["move-item"];
var ge3 = ["resize-column", "move-item"];
var pe2 = class {
  constructor(e, o2, t2) {
    __publicField(this, "undo", []);
    __publicField(this, "redo", []);
    __publicField(this, "progress", {});
    __publicField(this, "in");
    __publicField(this, "getState");
    __publicField(this, "setState");
    __publicField(this, "_previousValues", {});
    this.in = e, this.getState = o2, this.setState = t2, this.setHandlers(), this.resetStateHistory();
  }
  getHandlers() {
    return { "add-row": { handler: (e) => ({ action: "delete-row", data: { id: e.id }, source: { action: "add-row", data: e } }) }, "delete-row": { handler: (e) => {
      const { id: o2 } = e, { data: t2 } = this.getPrev(), i = t2.findIndex((s) => s.id == o2);
      return { action: "add-row", data: { id: o2, row: t2[i], before: i < t2.length - 1 ? t2[i + 1].id : void 0 }, source: { action: "delete-row", data: e } };
    } }, "update-cell": { handler: (e) => {
      const { id: o2, column: t2 } = e, i = this.getRow(o2), s = this.getColumn(t2), a2 = S(i, s);
      return k(a2, e.value) ? null : { action: "update-cell", data: { id: o2, column: t2, value: a2 }, source: { action: "update-cell", data: e } };
    } }, "update-row": { handler: (e) => {
      const { id: o2, row: t2 } = e, i = this.getRow(o2);
      for (const s in t2) Object.keys(i).includes(s) || (i[s] = void 0);
      return { action: "update-row", data: { id: o2, row: i }, source: { action: "update-row", data: e } };
    } }, "copy-row": { handler: (e) => {
      const { id: o2 } = e, { data: t2 } = this.getState(), i = t2.findIndex((a2) => a2.id == o2), s = t2[i];
      return { action: "delete-row", data: { id: o2 }, source: { action: "add-row", data: { id: o2, row: s, before: i < t2.length - 1 ? t2[i + 1].id : void 0 } } };
    } }, "resize-column": { handler: (e) => {
      var _a2;
      const { id: o2, width: t2 } = e, i = this.getColumn(o2), { _sizes: s } = this.getState();
      return { action: "resize-column", data: { id: o2, width: (_a2 = i.width) != null ? _a2 : s.columnWidth }, source: { action: "resize-column", data: { id: o2, width: t2 } } };
    } }, "hide-column": { handler: (e) => {
      const { id: o2 } = e, t2 = this.getColumn(o2);
      return { action: "hide-column", data: { id: o2, mode: t2.hidden }, source: { action: "hide-column", data: e } };
    } }, "collapse-column": { handler: (e) => {
      const { id: o2, row: t2, mode: i } = e;
      return { action: "collapse-column", data: { id: o2, row: t2, mode: typeof i == "boolean" ? !i : i }, source: { action: "collapse-column", data: e } };
    } }, "move-item": { handler: (e) => {
      const { id: o2, target: t2, mode: i } = e, { flatData: s } = this.getPrev(), a2 = s.findIndex((n) => n.id == o2);
      return { action: "move-item", data: { id: o2, target: s[a2 + (a2 ? -1 : 1)].id, mode: a2 ? "after" : "before" }, source: { action: "move-item", data: { id: o2, target: t2, mode: i } } };
    } }, "open-row": { handler: (e) => {
      const { id: o2, nested: t2 } = e;
      return { action: "close-row", data: { id: o2, nested: t2 }, source: { action: "open-row", data: e } };
    } }, "close-row": { handler: (e) => {
      const { id: o2, nested: t2 } = e;
      return { action: "open-row", data: { id: o2, nested: t2 }, source: { action: "close-row", data: e } };
    } } };
  }
  resetHistory() {
    this.undo = [], this.redo = [], this.progress = {}, this.resetStateHistory();
  }
  getPrev() {
    return this._previousValues;
  }
  setHandlers() {
    const e = this.getHandlers();
    for (const o2 in e) this.in.intercept(o2, (t2) => {
      if (!(t2.eventSource === "undo" || t2.eventSource === "redo" || t2.skipUndo)) {
        if (ge3.includes(o2)) {
          (t2.inProgress && !this.progress[o2] || typeof t2.inProgress != "boolean") && (fe3.includes(o2) && this.setPrev("flatData"), N2.includes(o2) && this.setPrev("columns")), this.progress[o2] = t2.inProgress;
          return;
        }
        ue3.includes(o2) && this.setPrev("data"), N2.includes(o2) && this.setPrev("columns");
      }
    }), this.in.on(o2, (t2) => {
      if (t2.eventSource === "undo" || t2.eventSource === "redo" || t2.skipUndo || t2.inProgress) return;
      const i = e[o2].handler(t2);
      i && this.addToHistory(i);
    });
  }
  setPrev(e) {
    this._previousValues[e] = I2(this.getState()[e]);
  }
  addToHistory(e) {
    this.undo.push(e), this.redo = [], this.setStateHistory();
  }
  handleUndo() {
    if (!this.undo.length) return;
    const e = this.undo.pop();
    this.redo.push(__spreadProps(__spreadValues({}, e.source), { source: e })), this.in.exec(e.action, __spreadProps(__spreadValues({}, e.data), { eventSource: "undo" })), this.setStateHistory();
  }
  handleRedo() {
    if (!this.redo.length) return;
    const e = this.redo.pop();
    this.undo.push(__spreadProps(__spreadValues({}, e.source), { source: e })), this.in.exec(e.action, __spreadProps(__spreadValues({}, e.data), { eventSource: "redo" })), this.setStateHistory();
  }
  resetStateHistory() {
    this.setState({ history: { undo: 0, redo: 0 } });
  }
  setStateHistory() {
    this.setState({ history: { undo: this.undo.length, redo: this.redo.length } });
  }
  getRow(e) {
    const { data: o2 } = this.getPrev();
    return this.getState().tree ? this.getTreeRow(o2, e) : o2.find((t2) => t2.id == e);
  }
  getTreeRow(e, o2) {
    for (let t2 = 0; t2 < e.length; t2++) {
      if (e[t2].id == o2) return e[t2];
      if (e[t2].data) {
        const i = this.getTreeRow(e[t2].data, o2);
        if (i) return i;
      }
    }
    return null;
  }
  getColumn(e) {
    const { columns: o2 } = this.getPrev();
    return o2.find((t2) => t2.id == e);
  }
};
function O2() {
  let r = true;
  return r = false, r;
}
function $3(r, e) {
  return typeof r > "u" || r === null ? -1 : typeof e > "u" || e === null ? 1 : r === e ? 0 : r > e ? 1 : -1;
}
function me2(r, e) {
  return -$3(r, e);
}
function xe3(r, e) {
  if (typeof e.sort == "function") return function(t2, i) {
    const s = e.sort(t2, i);
    return r === "asc" ? s : -s;
  };
  const o2 = r === "asc" ? $3 : me2;
  return function(t2, i) {
    return o2(S(t2, e), S(i, e));
  };
}
function ye3(r, e) {
  if (!r || !r.length) return;
  const o2 = r.map((t2) => {
    const i = e.find((s) => s.id == t2.key);
    return xe3(t2.order, i);
  });
  return r.length === 1 ? o2[0] : function(t2, i) {
    for (let s = 0; s < o2.length; s++) {
      const a2 = o2[s](t2, i);
      if (a2 !== 0) return a2;
    }
    return 0;
  };
}
var C2 = 28;
var _e3 = 20;
function Se3() {
  if (typeof document > "u") return "willow";
  const r = document.querySelector('[class^="wx"][class$="theme"]');
  return r ? r.className.substring(3, r.className.length - 6) : "willow";
}
function R2(r, e, o2, t2, i) {
  const s = document.createElement("div"), a2 = document.createElement("div"), n = document.body;
  i = i ? `${i}px` : "auto";
  let l2, c2;
  a2.className = e, s.classList.add(`wx-${o2}-theme`), s.style.cssText = `height:auto;position:absolute;top:0px;left:100px;overflow:hidden;width=${i};white-space:nowrap;`, s.appendChild(a2), n.appendChild(s), typeof r != "object" && (r = [r]);
  for (let d2 = 0; d2 < r.length; d2++) {
    a2.innerText = r[d2] + "";
    const h = s.getBoundingClientRect(), u = Math.ceil(h.width) + (t2 && t2.length ? t2[d2] : 0), f = Math.ceil(h.height);
    l2 = Math.max(l2 || 0, u), c2 = Math.max(c2 || 0, f);
  }
  return s.remove(), { width: l2, height: c2 };
}
function j2(r, e, o2, t2, i) {
  const s = [];
  for (let a2 = 0; a2 < r.length; a2++) {
    const n = r[a2][e], l2 = n.length;
    for (let c2 = 0; c2 < l2; c2++) {
      const { text: d2, vertical: h, collapsed: u, rowspan: f, css: p2 } = n[c2];
      if (!d2) {
        s[c2] = Math.max(s[c2] || 0, t2);
        continue;
      }
      let g = 0;
      if (h && !u) {
        let w = `wx-measure-cell-${e}`;
        if (w += p2 ? ` ${p2}` : "", g = R2(d2, w, i).width, (f > 1 || !n[c2 + 1]) && o2 > c2 + 1) {
          const x2 = f || o2 - c2, m = s.slice(c2, c2 + x2).reduce((y3, _3) => y3 + _3, 0);
          if (m < g) {
            const y3 = Math.ceil((g - m) / x2);
            for (let _3 = c2; _3 < c2 + x2; _3++) s[_3] = (s[_3] || t2) + y3;
          }
          continue;
        }
      }
      s[c2] = Math.max(s[c2] || t2, g);
    }
  }
  return s;
}
function be3(r, e, o2) {
  const t2 = [], i = [];
  let s = "wx-measure-cell-body";
  s += r.css ? ` ${r.css}` : "";
  for (let a2 = 0; a2 < e.length; a2++) {
    const n = e[a2], l2 = b2(n, r);
    l2 && (t2.push(l2), r.treetoggle ? i.push(e[a2].$level * C2 + (e[a2].$count ? C2 : 0) + (r.draggable ? C2 : 0)) : r.draggable && i.push(C2));
  }
  return R2(t2, s, o2, i).width;
}
function ve2(r, e) {
  const o2 = "wx-measure-cell-header", t2 = r.sort ? _e3 : 0;
  let i = r.header;
  if (typeof i == "string") return R2(i, o2, e).width + t2;
  let s;
  Array.isArray(i) || (i = [i]);
  for (let a2 = 0; a2 < i.length; a2++) {
    const n = i[a2], l2 = typeof n == "string" ? n : n.text, c2 = o2 + (typeof n == "string" ? "" : ` ${n.css}`);
    let d2 = R2(l2, c2, e).width;
    a2 === i.length - 1 && (d2 += t2), s = Math.max(s || 0, d2);
  }
  return s;
}
var ke3 = { text: (r, e) => r ? r.toString().toLowerCase().indexOf(e.toLowerCase()) !== -1 : !e, richselect: (r, e) => typeof e != "number" && !e ? true : r == e };
function Ce3(r) {
  return ke3[r];
}
var Re3 = class extends K2 {
  constructor(e) {
    super({ writable: e, async: false });
    __publicField(this, "in");
    __publicField(this, "_router");
    __publicField(this, "_branches");
    __publicField(this, "_xlsxWorker");
    __publicField(this, "_historyManager");
    const o2 = { rowHeight: 37, columnWidth: 160, headerHeight: 36, footerHeight: 36 };
    this._router = new B2(super.setState.bind(this), [{ in: ["columns", "sizes", "_skin"], out: ["_columns", "_sizes"], exec: (i) => {
      const { columns: s, sizes: a2, _skin: n } = this.getState(), l2 = this.copyColumns(s), c2 = l2.reduce((u, f) => Math.max(f.header.length, u), 0), d2 = l2.reduce((u, f) => Math.max(f.footer.length, u), 0);
      l2.forEach(this.setCollapsibleColumns);
      const h = this.normalizeSizes(l2, a2, c2, d2, n);
      for (let u = 0; u < l2.length; u++) this.normalizeColumns(l2, u, "header", c2, h), this.normalizeColumns(l2, u, "footer", d2, h);
      this.setState({ _columns: l2, _sizes: h }, i);
    } }, { in: ["data", "tree", "_filterIds"], out: ["flatData", "_rowHeightFromData"], exec: (i) => {
      const { data: s, tree: a2, dynamic: n, _filterIds: l2 } = this.getState(), c2 = l2 && new Set(l2), d2 = a2 ? this.flattenRows(s, [], l2) : c2 ? s.filter((u) => c2.has(u.id)) : s, h = !n && d2.some((u) => u.rowHeight);
      this.setState({ flatData: d2, _rowHeightFromData: h }, i);
    } }], { sizes: (i) => __spreadValues(__spreadValues({}, o2), i) });
    const t2 = this.in = new X2();
    t2.on("close-editor", ({ ignore: i }) => {
      const { editor: s } = this.getState();
      s && (i || t2.exec("update-cell", s), this.setState({ editor: null }));
    }), t2.on("open-editor", ({ id: i, column: s }) => {
      var _a2;
      let a2 = this.getState().editor;
      a2 && t2.exec("close-editor", {});
      const n = this.getRow(i), l2 = s ? this.getColumn(s) : this.getNextEditor(n);
      if (l2 == null ? void 0 : l2.editor) {
        let c2 = l2.editor;
        if (typeof c2 == "function" && (c2 = c2(n, l2)), !c2) return;
        a2 = { column: l2.id, id: i, value: (_a2 = S(n, l2)) != null ? _a2 : "", renderedValue: b2(n, l2) }, typeof c2 == "object" && c2.config && (a2.config = c2.config, c2.config.options && (a2.options = c2.config.options)), l2.options && !a2.options && (a2.options = l2.options), this.setState({ editor: a2 });
      }
    }), t2.on("editor", ({ value: i }) => {
      const s = this.getState().editor;
      s && (s.value = i, this.setState({ editor: s }));
    }), t2.on("add-row", (i) => {
      const s = this.getState();
      let { data: a2 } = s;
      const { select: n, _filterIds: l2 } = s, { row: c2, before: d2, after: h, select: u } = i;
      if (i.id = c2.id = i.id || c2.id || E2(), d2 || h) {
        const p2 = d2 || h, g = a2.findIndex((w) => w.id === p2);
        a2 = [...a2], a2.splice(g + (h ? 1 : 0), 0, i.row);
      } else a2 = [...a2, i.row];
      const f = { data: a2 };
      l2 && (f._filterIds = [...l2, i.id]), this.setState(f), !(typeof u == "boolean" && !u) && (u || n) && t2.exec("select-row", { id: c2.id, show: true });
    }), t2.on("delete-row", (i) => {
      const { data: s, selectedRows: a2, focusCell: n, editor: l2 } = this.getState(), { id: c2 } = i, d2 = { data: s.filter((h) => h.id !== c2) };
      this.isSelected(c2) && (d2.selectedRows = a2.filter((h) => h !== c2)), (l2 == null ? void 0 : l2.id) == c2 && (d2.editor = null), this.setState(d2), (n == null ? void 0 : n.row) === c2 && this.in.exec("focus-cell", { eventSource: "delete-row" });
    }), t2.on("update-cell", (i) => {
      const s = this.getState();
      let { data: a2 } = s;
      a2 = [...a2];
      const { tree: n } = s, { id: l2, column: c2, value: d2 } = i, h = this.getColumn(c2);
      if (n) {
        const u = __spreadValues({}, this._branches[l2]);
        M(u, h, d2);
        const f = this.updateTreeRow(u);
        u.$parent === 0 && (a2 = f);
      } else {
        const u = a2.findIndex((p2) => p2.id == l2), f = __spreadValues({}, a2[u]);
        M(f, h, d2), a2[u] = f;
      }
      this.setState({ data: a2 });
    }), t2.on("update-row", (i) => {
      let { data: s } = this.getState();
      const { id: a2, row: n } = i, l2 = s.findIndex((c2) => c2.id == a2);
      s = [...s], s[l2] = __spreadValues(__spreadValues({}, s[l2]), n), this.setState({ data: s });
    }), t2.on("select-row", ({ id: i, toggle: s, range: a2, mode: n, show: l2, column: c2 }) => {
      const d2 = this.getState(), { focusCell: h } = d2;
      let { selectedRows: u } = d2;
      if (u.length || (a2 = s = false), a2) {
        const { data: f } = this.getState();
        let p2 = f.findIndex((w) => w.id == u[u.length - 1]), g = f.findIndex((w) => w.id == i);
        p2 > g && ([p2, g] = [g, p2]), f.slice(p2, g + 1).forEach((w) => {
          u.indexOf(w.id) === -1 && u.push(w.id);
        });
      } else if (s && this.isSelected(i)) {
        if (n === true) return;
        u = u.filter((f) => f !== i);
      } else if (s) {
        if (n === false) return;
        u.push(i);
      } else u = [i];
      this.setState({ selectedRows: [...u] }), (h == null ? void 0 : h.row) !== i && this.in.exec("focus-cell", { eventSource: "select-row" }), l2 && this.in.exec("scroll", { row: i, column: c2 });
    }), this.in.on("focus-cell", (i) => {
      const { row: s, column: a2, eventSource: n } = i, { _columns: l2, split: c2 } = this.getState();
      s && a2 ? (this.setState({ focusCell: { row: s, column: a2 } }), n !== "click" && ((!c2.left || l2.findIndex((d2) => d2.id == i.column) >= c2.left) && (!c2.right || l2.findIndex((d2) => d2.id == i.column) < l2.length - c2.right) ? this.in.exec("scroll", { row: s, column: a2 }) : this.in.exec("scroll", { row: s }))) : this.setState({ focusCell: null });
    }), t2.on("resize-column", (i) => {
      const { id: s, auto: a2, maxRows: n, inProgress: l2 } = i;
      if (l2 === false) return;
      let c2 = i.width || 0;
      const d2 = [...this.getState().columns], h = d2.find((u) => u.id == s);
      if (a2) {
        if (a2 == "data" || a2 === true) {
          const { flatData: u, _skin: f } = this.getState();
          let p2 = u.length;
          n && (p2 = Math.min(n, p2));
          const g = u.slice(0, p2);
          c2 = be3(h, g, f);
        }
        if (a2 == "header" || a2 === true) {
          const { _skin: u } = this.getState();
          c2 = Math.max(ve2(h, u), c2);
        }
      }
      h.width = Math.max(17, c2), delete h.flexgrow, this.setState({ columns: d2 });
    }), t2.on("hide-column", (i) => {
      const { id: s, mode: a2 } = i, n = [...this.getState().columns], l2 = n.find((d2) => d2.id == s), c2 = n.reduce((d2, h) => d2 + (h.hidden ? 0 : 1), 0);
      !a2 || c2 > 1 ? (l2.hidden = !l2.hidden, this.setState({ columns: n })) : i.skipUndo = true;
    }), t2.on("sort-rows", (i) => {
      var _a2, _b;
      const { key: s, add: a2, sort: n } = i, l2 = this.getState(), { columns: c2, data: d2, tree: h } = l2;
      if (n) {
        const m = [...d2];
        m.sort(n), this.setState({ data: m });
        return;
      }
      const { order: u = "asc" } = i;
      let f = l2.sortMarks;
      const p2 = Object.keys(f), g = p2.length;
      !a2 || !g || g === 1 && f[s] ? f = { [s]: { order: u } } : (g === 1 && (f[p2[0]] = __spreadProps(__spreadValues({}, f[p2[0]]), { index: 0 })), f = __spreadProps(__spreadValues({}, f), { [s]: { order: u, index: typeof a2 == "number" ? a2 : (_b = (_a2 = f[s]) == null ? void 0 : _a2.index) != null ? _b : g } }));
      const w = Object.keys(f).sort((m, y3) => f[m].index - f[y3].index).map((m) => ({ key: m, order: f[m].order }));
      this.setState({ sortMarks: f });
      const x2 = ye3(w, c2);
      if (x2) {
        const m = [...d2];
        h ? this.sortTree(m, x2) : m.sort(x2), this.setState({ data: m });
      }
    }), t2.on("filter-rows", (i) => {
      const { value: s, key: a2, filter: n } = i;
      if (!Object.keys(i).length) {
        this.setState({ filterValues: {}, _filterIds: null });
        return;
      }
      const l2 = this.getState(), { data: c2, tree: d2 } = l2;
      let h = l2.filterValues;
      const u = {};
      a2 && (h = __spreadProps(__spreadValues({}, h), { [a2]: s }), u.filterValues = h);
      const f = n != null ? n : this.createFilter(h);
      let p2 = [];
      d2 ? p2 = this.filterTree(c2, f, p2) : c2.forEach((g) => {
        f(g) && p2.push(g.id);
      }), u._filterIds = p2, this.setState(u);
    }), t2.on("collapse-column", (i) => {
      const { id: s, row: a2, mode: n } = i, l2 = [...this.getState().columns], c2 = this.getColumn(s).header, d2 = Array.isArray(c2) ? c2[a2] : c2;
      typeof d2 == "object" && (d2.collapsed = n != null ? n : !d2.collapsed, this.setState({ columns: l2 }));
    }), t2.on("move-item", (i) => {
      const { id: s, inProgress: a2 } = i;
      let { target: n, mode: l2 = "after" } = i;
      const { data: c2, flatData: d2, tree: h } = this.getState(), u = d2.findIndex((g) => g.id == s);
      let f;
      if (l2 === "up" || l2 === "down") {
        if (l2 === "up") {
          if (u === 0) return;
          f = u - 1, l2 = "before";
        } else if (l2 === "down") {
          if (u === d2.length - 1) return;
          f = u + 1, l2 = "after";
        }
        n = d2[f] && d2[f].id;
      } else f = d2.findIndex((g) => g.id == n);
      if (u === -1 || f === -1 || a2 === false) return;
      let p2;
      h ? p2 = this.moveItem(s, n, c2, l2) : p2 = this.moveItem(s, n, c2, l2), this.setState({ data: h ? this.normalizeTreeRows(p2) : p2 });
    }), t2.on("copy-row", (i) => {
      const { id: s, target: a2, mode: n = "after" } = i, l2 = this.getState(), { flatData: c2, _filterIds: d2 } = l2;
      let { data: h } = l2;
      const u = this.getRow(s);
      if (!u) return;
      const f = __spreadProps(__spreadValues({}, u), { id: E2() });
      i.id = f.id;
      const p2 = c2.findIndex((w) => w.id == a2);
      if (p2 === -1) return;
      h.splice(p2 + (n === "after" ? 1 : 0), 0, f), h = [...h];
      const g = { data: h };
      d2 && (g._filterIds = [...d2, f.id]), this.setState(g);
    }), t2.on("open-row", (i) => {
      const { id: s, nested: a2 } = i;
      this.toggleBranch(s, true, a2);
    }), t2.on("close-row", (i) => {
      const { id: s, nested: a2 } = i;
      this.toggleBranch(s, false, a2);
    }), t2.on("export-data", (i) => new Promise((s, a2) => {
      var _a2;
      const n = i.format || "csv", l2 = `${i.fileName || "data"}.${n}`;
      if (n == "csv") {
        const c2 = G3(this.getState(), i.csv || {});
        i.download !== false ? P2(new Blob(["\uFEFF" + c2], { type: "text/csv" }), l2) : i.result = c2, s(true);
      } else if (n == "xlsx") {
        let c2 = (_a2 = i.excel) == null ? void 0 : _a2.styles;
        !c2 && c2 !== false && (c2 = Q3(this.getState()._skin));
        const d2 = c2, h = d2 ? [__spreadValues({}, d2.header), __spreadValues({}, d2.lastHeaderCell || d2.header), __spreadValues({}, d2.cell), __spreadValues({}, d2.firstFooterCell || d2.footer), __spreadValues({}, d2.footer)] : Array(5).fill({}), { cells: u, merged: f, rowSizes: p2, colSizes: g, styles: w } = J3(this.getState(), i.excel || {}, h), x2 = i.cdn || "https://cdn.dhtmlx.com/libs/json2excel/1.3.2/worker.js";
        this.getXlsxWorker(x2).then((m) => {
          m.onmessage = (y3) => {
            if (y3.data.type == "ready") {
              const _3 = y3.data.blob;
              i.download !== false ? P2(_3, l2) : i.result = _3, s(true);
            }
          }, m.postMessage({ type: "convert", data: { data: [{ name: i.sheetName || "data", cells: u, cols: g, rows: p2, merged: f }], styles: w } });
        });
      } else a2();
    })), t2.on("search-rows", (i) => {
      const { search: s, columns: a2 } = i, n = this.searchRows(s, a2);
      this.setState({ search: { value: s, rows: n } });
    }), t2.on("hotkey", ({ key: i, event: s, isInput: a2 }) => {
      var _a2, _b, _c, _d, _e4, _f, _g, _h, _i, _j, _k, _l, _m;
      switch (i) {
        case "arrowup": {
          const { flatData: n, focusCell: l2, select: c2 } = this.getState();
          if (s.preventDefault(), a2) return;
          const d2 = l2 ? l2.column : (_a2 = this._getFirstVisibleColumn()) == null ? void 0 : _a2.id, h = l2 ? (_b = this.getPrevRow(l2.row)) == null ? void 0 : _b.id : (_c = n[n.length - 1]) == null ? void 0 : _c.id;
          d2 && h && (this.in.exec("focus-cell", { row: h, column: d2, eventSource: "key" }), c2 && this.in.exec("select-row", { id: h }));
          break;
        }
        case "arrowdown": {
          const { flatData: n, focusCell: l2, select: c2 } = this.getState();
          if (s.preventDefault(), a2) return;
          const d2 = l2 ? l2.column : (_d = this._getFirstVisibleColumn()) == null ? void 0 : _d.id, h = l2 ? (_e4 = this.getNextRow(l2.row)) == null ? void 0 : _e4.id : (_f = n[0]) == null ? void 0 : _f.id;
          d2 && h && (this.in.exec("focus-cell", { row: h, column: d2, eventSource: "key" }), c2 && this.in.exec("select-row", { id: h }));
          break;
        }
        case "arrowright": {
          const { focusCell: n } = this.getState();
          if (a2) return;
          if (s.preventDefault(), n) {
            const l2 = (_g = this.getNextColumn(n.column, true)) == null ? void 0 : _g.id;
            l2 && this.in.exec("focus-cell", { row: n.row, column: l2, eventSource: "key" });
          }
          break;
        }
        case "arrowleft": {
          const { focusCell: n } = this.getState();
          if (a2) return;
          if (s.preventDefault(), n) {
            const l2 = (_h = this.getPrevColumn(n.column, true)) == null ? void 0 : _h.id;
            l2 && this.in.exec("focus-cell", { row: n.row, column: l2, eventSource: "key" });
          }
          break;
        }
        case "tab": {
          const { editor: n, focusCell: l2, select: c2 } = this.getState();
          if (n) {
            s.preventDefault();
            const d2 = n.column;
            let h = n.id, u = this.getNextEditor(this.getRow(h), this.getColumn(d2));
            if (!u) {
              const f = this.getNextRow(h);
              f && (h = f.id, u = this.getNextEditor(f));
            }
            u && (this.in.exec("open-editor", { id: h, column: u.id }), this.in.exec("focus-cell", { row: h, column: u.id, eventSource: "key" }), c2 && !this.isSelected(h) && this.in.exec("select-row", { id: h }));
          } else l2 && this.in.exec("focus-cell", { eventSource: "key" });
          break;
        }
        case "shift+tab": {
          const { editor: n, focusCell: l2, select: c2 } = this.getState();
          if (n) {
            s.preventDefault();
            const d2 = n.column;
            let h = n.id, u = this.getPrevEditor(this.getRow(h), this.getColumn(d2));
            if (!u) {
              const f = this.getPrevRow(h);
              f && (h = f.id, u = this.getPrevEditor(f));
            }
            u && (this.in.exec("open-editor", { id: h, column: u.id }), this.in.exec("focus-cell", { row: h, column: u.id, eventSource: "key" }), c2 && !this.isSelected(h) && this.in.exec("select-row", { id: h }));
          } else l2 && this.in.exec("focus-cell", { eventSource: "key" });
          break;
        }
        case "escape": {
          const { editor: n } = this.getState();
          n && (this.in.exec("close-editor", { ignore: true }), this.in.exec("focus-cell", { row: n.id, column: n.column, eventSource: "key" }));
          break;
        }
        case "f2": {
          const { editor: n, focusCell: l2 } = this.getState();
          !n && l2 && this.in.exec("open-editor", { id: l2.row, column: l2.column });
          break;
        }
        case "enter": {
          const { focusCell: n, tree: l2 } = this.getState();
          if (!a2 && l2 && n && this.getColumn(n.column).treetoggle) {
            const c2 = this.getRow(n.row);
            if (!c2.data) return;
            this.in.exec(c2.open ? "close-row" : "open-row", { id: n.row, nested: true });
          }
          break;
        }
        case "home": {
          const { editor: n, focusCell: l2 } = this.getState();
          if (!n && l2) {
            s.preventDefault();
            const c2 = (_i = this._getFirstVisibleColumn()) == null ? void 0 : _i.id;
            this.in.exec("focus-cell", { row: l2.row, column: c2, eventSource: "key" });
          }
          break;
        }
        case "ctrl+home": {
          const { editor: n, focusCell: l2, flatData: c2, select: d2 } = this.getState();
          if (!n && l2) {
            s.preventDefault();
            const h = (_j = c2[0]) == null ? void 0 : _j.id, u = (_k = this._getFirstVisibleColumn()) == null ? void 0 : _k.id;
            h && u && (this.in.exec("focus-cell", { row: h, column: u, eventSource: "key" }), d2 && !this.isSelected(h) && this.in.exec("select-row", { id: h }));
          }
          break;
        }
        case "end": {
          const { editor: n, focusCell: l2 } = this.getState();
          if (!n && l2) {
            s.preventDefault();
            const c2 = (_l = this._getLastVisibleColumn()) == null ? void 0 : _l.id, d2 = l2.row;
            this.in.exec("focus-cell", { row: d2, column: c2, eventSource: "key" });
          }
          break;
        }
        case "ctrl+end": {
          const { editor: n, focusCell: l2, flatData: c2, select: d2 } = this.getState();
          if (!n && l2) {
            s.preventDefault();
            const h = c2.at(-1).id, u = (_m = this._getLastVisibleColumn()) == null ? void 0 : _m.id;
            h && u && (this.in.exec("focus-cell", { row: h, column: u, eventSource: "key" }), d2 && !this.isSelected(h) && this.in.exec("select-row", { id: h }));
          }
          break;
        }
        case "ctrl+z": {
          this.in.exec("undo", {});
          break;
        }
        case "ctrl+y": {
          this.in.exec("redo", {});
          break;
        }
      }
    }), t2.on("scroll", (i) => {
      var _a2;
      const { _columns: s, split: a2, _sizes: n, flatData: l2, dynamic: c2, _rowHeightFromData: d2 } = this.getState();
      let h = -1, u = -1, f = 0, p2 = 0;
      if (i.column) {
        h = 0;
        const g = s.findIndex((w) => w.id == i.column);
        f = s[g].width;
        for (let w = (_a2 = a2.left) != null ? _a2 : 0; w < g; w++) {
          const x2 = s[w];
          x2.hidden || (h += x2.width);
        }
      }
      if (i.row && !c2) {
        const g = l2.findIndex((w) => w.id == i.row);
        g >= 0 && (d2 ? (u = l2.slice(0, g).reduce((w, x2) => w + (x2.rowHeight || n.rowHeight), 0), p2 = l2[g].rowHeight) : u = n.rowHeight * g);
      }
      this.setState({ scroll: { top: u, left: h, width: f, height: p2 || n.rowHeight } });
    }), t2.on("print", (i) => {
      const s = ce3(i);
      this.setState({ _print: s }), this.setStateAsync({ _print: null });
    }), t2.on("undo", () => {
      var _a2;
      (_a2 = this._historyManager) == null ? void 0 : _a2.handleUndo();
    }), t2.on("redo", () => {
      var _a2;
      (_a2 = this._historyManager) == null ? void 0 : _a2.handleRedo();
    }), this.initOnce();
  }
  getXlsxWorker(e) {
    if (!this._xlsxWorker) {
      const o2 = window.URL.createObjectURL(new Blob([`importScripts('${e}');`], { type: "text/javascript" }));
      this._xlsxWorker = new Promise((t2) => {
        const i = new Worker(o2);
        i.addEventListener("message", (s) => {
          s.data.type === "init" && t2(i);
        });
      });
    }
    return this._xlsxWorker;
  }
  initOnce() {
    const e = { sortMarks: {}, _filterIds: null, data: [], filterValues: {}, scroll: null, editor: null, focusCell: null, _print: null, history: { undo: 0, redo: 0 }, search: null };
    this._router.init(e);
  }
  init(e) {
    var _a2;
    e.hasOwnProperty("_skin") && !e._skin && (e._skin = Se3()), e.columns && e.columns.forEach((o2) => {
      o2.options && (o2.optionsMap = new Map(o2.options.map((t2) => [t2.id, t2.label])));
    }), k(this.getState().data, e.data) || (e.tree ? (this._branches = { 0: { data: e.data } }, e.data = this.normalizeTreeRows(e.data)) : e.data = this.normalizeRows(e.data), this.setState({ _filterIds: null, filterValues: {}, sortMarks: {}, search: null }), this._historyManager && this._historyManager.resetHistory()), O2() && (e.tree && (e.undo = false, e.reorder = false), ((_a2 = e.split) == null ? void 0 : _a2.right) && (e.split.right = 0)), e.undo && !this._historyManager && (this._historyManager = new pe2(this.in, this.getState.bind(this), this.setState.bind(this))), this._router.init(__spreadValues({}, e));
  }
  setState(e, o2) {
    return this._router.setState(e, o2);
  }
  setStateAsync(e) {
    this._router.setStateAsync(e);
  }
  getRow(e) {
    const { tree: o2 } = this.getState();
    return o2 ? this._branches[e] : this.getState().data.find((t2) => t2.id == e);
  }
  getRowIndex(e, o2) {
    return o2 || (o2 = this.getState().flatData), o2.findIndex((t2) => t2.id == e);
  }
  getNextRow(e) {
    const o2 = this.getState().flatData, t2 = this.getRowIndex(e, o2);
    return o2[t2 + 1];
  }
  getPrevRow(e) {
    const o2 = this.getState().flatData, t2 = this.getRowIndex(e, o2);
    return o2[t2 - 1];
  }
  getColumn(e) {
    return this.getState().columns.find((o2) => o2.id == e);
  }
  getNextColumn(e, o2) {
    const t2 = this.getState()._columns, i = t2.findIndex((s) => s.id == e);
    return o2 ? this._getFirstVisibleColumn(i + 1) : t2[i + 1];
  }
  getPrevColumn(e, o2) {
    const t2 = this.getState()._columns, i = t2.findIndex((s) => s.id == e);
    return o2 ? this._getLastVisibleColumn(i - 1) : t2[i - 1];
  }
  _getFirstVisibleColumn(e) {
    var _a2, _b;
    const o2 = this.getState()._columns;
    let t2 = e != null ? e : 0;
    for (; t2 < o2.length && (((_a2 = o2[t2]) == null ? void 0 : _a2.hidden) || ((_b = o2[t2]) == null ? void 0 : _b.collapsed)); ) t2++;
    return o2[t2];
  }
  _getLastVisibleColumn(e) {
    var _a2, _b;
    const o2 = this.getState()._columns;
    let t2 = e != null ? e : o2.length - 1;
    for (; t2 < o2.length && (((_a2 = o2[t2]) == null ? void 0 : _a2.hidden) || ((_b = o2[t2]) == null ? void 0 : _b.collapsed)); ) t2--;
    return o2[t2];
  }
  isCellEditable(e, o2) {
    const { editor: t2, hidden: i } = o2;
    return !t2 || i ? false : typeof t2 == "function" ? t2(e, o2) : true;
  }
  getNextEditor(e, o2) {
    let t2 = this.getState().columns;
    if (o2) {
      const i = t2.findIndex((s) => s.id == o2.id);
      t2 = t2.slice(i + 1);
    }
    return t2.find((i) => this.isCellEditable(e, i));
  }
  getPrevEditor(e, o2) {
    let t2 = this.getState().columns;
    if (o2) {
      const i = t2.findLastIndex((s) => s.id == o2.id);
      t2 = t2.slice(0, i);
    }
    return t2.findLast((i) => this.isCellEditable(e, i));
  }
  toggleBranch(e, o2, t2) {
    var _a2;
    let i = this._branches[e], { data: s } = this.getState();
    if (s = [...s], e !== 0) {
      i = __spreadProps(__spreadValues({}, i), { open: o2 });
      const a2 = this.updateTreeRow(i);
      i.$parent === 0 && (s = a2);
    }
    t2 && ((_a2 = i.data) == null ? void 0 : _a2.length) && i.data.forEach((a2) => {
      const n = this.toggleKids(a2, o2, t2);
      e === 0 && (s = n);
    }), this.setState({ data: s });
  }
  toggleKids(e, o2, t2) {
    var _a2;
    e = __spreadProps(__spreadValues({}, e), { open: o2 });
    const i = this.updateTreeRow(e);
    return t2 && ((_a2 = e.data) == null ? void 0 : _a2.length) && e.data.forEach((s) => {
      this.toggleKids(s, o2, t2);
    }), i;
  }
  updateTreeRow(e) {
    const o2 = e.id;
    this._branches[o2] = e;
    const t2 = this._branches[e.$parent], i = t2.data.findIndex((s) => s.id == o2);
    return t2.data = [...t2.data], t2.data[i] = e, t2.data;
  }
  isSelected(e) {
    return this.getState().selectedRows.indexOf(e) !== -1;
  }
  findAndRemove(e, o2) {
    for (let t2 = 0; t2 < e.length; t2++) {
      if (e[t2].id == o2) return e.splice(t2, 1)[0];
      if (e[t2].data) {
        const i = [...e[t2].data], s = this.findAndRemove(i, o2);
        if (s) return e[t2] = __spreadProps(__spreadValues({}, e[t2]), { data: i }), s;
      }
    }
    return null;
  }
  insertItem(e, o2, t2, i) {
    for (let s = 0; s < e.length; s++) {
      if (e[s].id == o2) {
        const a2 = e[s], n = i === "before" ? s : s + 1;
        if (a2.data) {
          if (i === "before") {
            const l2 = s > 0 ? e[s - 1] : null;
            return (l2 == null ? void 0 : l2.data) && l2.open ? e[s - 1] = __spreadProps(__spreadValues({}, l2), { data: [...l2.data, t2] }) : e.splice(n, 0, t2), true;
          } else if (a2.open) return e[s] = __spreadProps(__spreadValues({}, a2), { data: [t2, ...a2.data] }), true;
        }
        return e.splice(n, 0, t2), true;
      }
      if (e[s].data && (e[s] = __spreadProps(__spreadValues({}, e[s]), { data: [...e[s].data] }), this.insertItem(e[s].data, o2, t2, i))) return true;
    }
    return false;
  }
  moveItem(e, o2, t2, i) {
    const s = [...t2], a2 = this.findAndRemove(s, e);
    return this.insertItem(s, o2, a2, i), s;
  }
  copyColumns(e) {
    const o2 = [];
    for (let t2 = 0; t2 < e.length; t2++) {
      const i = __spreadValues({}, e[t2]);
      this.copyHeaderFooter(i, "header"), this.copyHeaderFooter(i, "footer"), o2[t2] = i;
    }
    return o2;
  }
  copyHeaderFooter(e, o2) {
    let t2 = e[o2];
    t2 = Array.isArray(t2) ? [...t2] : [t2], t2.forEach((i, s) => {
      t2[s] = typeof i == "string" ? { text: i } : __spreadValues({}, i);
    }), e[o2] = t2;
  }
  setCollapsibleColumns(e, o2, t2) {
    let i = e.header;
    for (let s = 0; s < i.length; s++) {
      const a2 = i[s];
      if (a2.collapsible && a2.collapsed) {
        if (a2.collapsible !== "first") {
          e.collapsed = true, e.width = 36, a2.vertical = true;
          const l2 = i.length - s;
          i = i.slice(0, s + 1), i[s].rowspan = l2;
        }
        const n = a2.colspan;
        if (n) {
          const l2 = i[s + 1];
          let c2 = 1;
          l2 && l2.colspan && !l2.collapsed && (c2 = l2.colspan);
          for (let d2 = c2; d2 < n; d2++) {
            const h = t2[o2 + d2];
            h && (h.hidden = true);
          }
        }
      }
    }
  }
  normalizeColumns(e, o2, t2, i, s) {
    const a2 = e[o2];
    a2.width || (a2.width = a2.flexgrow ? 17 : s.columnWidth), a2._colindex = o2 + 1;
    const n = a2[t2], l2 = s[`${t2}RowHeights`];
    for (let c2 = 0; c2 < i; c2++) {
      const d2 = n[c2];
      d2.id = a2.id, c2 === n.length - 1 && (d2.rowspan = d2.rowspan ? Math.min(d2.rowspan, i - c2) : i - c2);
      for (let h = 1; h < d2.rowspan; h++) {
        n.splice(c2 + h, 0, { _hidden: true });
        for (let u = 1; u < d2.colspan; u++) e[o2 + u][t2].splice(c2 + h, 0, {});
      }
      if (d2.rowspan) {
        const h = (d2.rowspan === i ? l2 : l2.slice(c2, d2.rowspan + c2)).reduce((u, f) => u + f, 0);
        d2.height = h, c2 + d2.rowspan != i && d2.height--;
      }
      if (d2.colspan) {
        let h = a2.width, u = a2.flexgrow || 0;
        const f = d2.colspan;
        for (let p2 = 1; p2 < f; p2++) {
          const g = e[o2 + p2];
          g && (g.hidden ? d2.colspan -= 1 : g.flexgrow ? u += g.flexgrow : h += g.width || s.columnWidth), u ? d2.flexgrow = u : d2.width = h;
        }
      } else d2.width = a2.width, d2.flexgrow = a2.flexgrow;
      t2 === "header" && d2.filter && typeof d2.filter == "string" && (d2.filter = { type: d2.filter });
    }
    n.length > i && (n.length = i), a2[t2] = n;
  }
  normalizeRows(e) {
    for (let o2 = 0; o2 < e.length; o2++) e[o2].id || (e[o2].id = E2());
    return e;
  }
  normalizeTreeRows(e, o2, t2) {
    return e.forEach((i) => {
      i.id || (i.id = E2()), i.$level = o2 || 0, i.$parent = t2 || 0, this._branches[i.id] = i, i.data && (i.data.length ? (i.$count = i.data.length, this.normalizeTreeRows(i.data, i.$level + 1, i.id)) : (delete i.data, delete i.$count, delete i.open));
    }), e;
  }
  sortTree(e, o2) {
    e.sort(o2), e.forEach((t2) => {
      t2.data && this.sortTree(t2.data, o2);
    });
  }
  filterTree(e, o2, t2) {
    return e.forEach((i) => {
      o2(i) && t2.push(i.id), i.data && this.filterTree(i.data, o2, t2);
    }), t2;
  }
  flattenRows(e, o2, t2) {
    const i = o2;
    return e.forEach((s) => {
      var _a2;
      (!t2 || t2.includes(s.id)) && i.push(s), ((_a2 = s.data) == null ? void 0 : _a2.length) && s.open !== false && this.flattenRows(s.data, i, t2);
    }), i;
  }
  createFilter(e) {
    const { _columns: o2 } = this.getState(), t2 = [];
    for (const i in e) {
      const { config: s, type: a2 } = o2.find((l2) => l2.id == i).header.find((l2) => l2.filter).filter, n = e[i];
      t2.push((l2) => (s == null ? void 0 : s.handler) ? s.handler(l2[i], n) : Ce3(a2)(l2[i], n));
    }
    return (i) => {
      for (let s = 0; s < t2.length; s++) if (!t2[s](i)) return false;
      return true;
    };
  }
  searchRows(e, o2) {
    e = e.trim().toLowerCase();
    const t2 = {};
    if (!e) return t2;
    const { flatData: i, columns: s } = this.getState(), a2 = o2 ? s.filter((n) => o2[n.id]) : s;
    return i.forEach((n) => {
      const l2 = {};
      a2.forEach((c2) => {
        const d2 = b2(n, c2);
        String(d2).toLowerCase().includes(e) && (l2[c2.id] = true);
      }), Object.keys(l2).length && (t2[n.id] = l2);
    }), t2;
  }
  normalizeSizes(e, o2, t2, i, s) {
    const a2 = j2(e, "header", t2, o2.headerHeight, s), n = j2(e, "footer", i, o2.footerHeight, s), l2 = a2.reduce((d2, h) => d2 + h, 0), c2 = n.reduce((d2, h) => d2 + h, 0);
    return __spreadProps(__spreadValues({}, o2), { headerRowHeights: a2, footerRowHeights: n, headerHeight: l2, footerHeight: c2 });
  }
};
var Ee2 = (/* @__PURE__ */ new Date()).valueOf();
function E2() {
  return "temp://" + Ee2++;
}
function Ie3(r, e = "data-id") {
  let o2 = r;
  for (!o2.tagName && r.target && (o2 = r.target); o2; ) {
    if (o2.getAttribute && o2.getAttribute(e)) return o2;
    o2 = o2.parentNode;
  }
  return null;
}
(/* @__PURE__ */ new Date()).valueOf();
var Te2 = class {
  constructor() {
    this.store = /* @__PURE__ */ new Map();
  }
  configure(r, e) {
    this.node = e;
    for (const o2 in r) if (r[o2]) {
      const t2 = o2.toLowerCase().replace(/[ ]/g, ""), i = r[o2];
      this.store.set(t2, i);
    }
  }
};
var v = [];
var De2 = { subscribe: (r) => {
  He2();
  const e = new Te2();
  return v.push(e), r(e), () => {
    const o2 = v.findIndex((t2) => t2 === e);
    o2 >= 0 && v.splice(o2, 1);
  };
} };
var V2 = false;
function He2() {
  V2 || (V2 = true, document.addEventListener("keydown", (r) => {
    if (v.length && (r.ctrlKey || r.altKey || r.metaKey || r.shiftKey || r.key.length > 1 || r.key === " ")) {
      const e = [];
      r.ctrlKey && e.push("ctrl"), r.altKey && e.push("alt"), r.metaKey && e.push("meta"), r.shiftKey && e.push("shift");
      let o2 = r.code.replace("Key", "").toLocaleLowerCase();
      r.key === " " && (o2 = "space"), e.push(o2);
      const t2 = e.join("+");
      for (let i = v.length - 1; i >= 0; i--) {
        const s = v[i], a2 = s.store.get(t2) || s.store.get(o2);
        a2 && s.node.contains(r.target) && a2(r, { key: t2, evKey: o2 });
      }
    }
  }));
}
var Me3 = { tab: true, "shift+tab": true, arrowup: true, arrowdown: true, arrowright: true, arrowleft: true, enter: true, escape: true, f2: true, home: true, end: true, "ctrl+home": true, "ctrl+end": true, "ctrl+z": true, "ctrl+y": true };
function Pe2(r, { keys: e, exec: o2 }) {
  if (!e) return;
  function t2(a2) {
    var _a2;
    const n = a2.target;
    return n.tagName === "INPUT" || n.tagName === "TEXTAREA" || ((_a2 = Ie3(n, "data-header-id")) == null ? void 0 : _a2.classList.contains("wx-filter")) || !!n.closest(".wx-cell.wx-editor");
  }
  const i = {};
  for (const a2 in e) {
    const n = e[a2];
    typeof n < "u" && (typeof n == "function" ? i[a2] = n : n && (i[a2] = (l2) => {
      const c2 = t2(l2);
      o2({ key: a2, event: l2, isInput: c2 });
    }));
  }
  const s = De2.subscribe((a2) => {
    a2.configure(i, r);
  });
  return { destroy: () => {
    s();
  } };
}
function ze3(r, e) {
  let o2 = null;
  e.scroll.subscribe((t2) => {
    if (!t2 || t2 === o2) return;
    o2 = t2;
    const { left: i, top: s, height: a2, width: n } = t2, l2 = e.getHeight(), c2 = e.getWidth(), d2 = e.getScrollMargin();
    if (s >= 0) {
      const h = r.scrollTop;
      s < h ? r.scrollTop = s : s + a2 > h + l2 && (r.scrollTop = s - l2 + a2);
    }
    if (i >= 0) {
      const h = r.scrollLeft;
      i < h ? r.scrollLeft = i : i + n > h + c2 - d2 && (r.scrollLeft = i - c2 + n + d2);
    }
  });
}

// node_modules/@svar-ui/react-grid/dist/index.es.js
var import_jsx_runtime4 = __toESM(require_jsx_runtime());
var import_react5 = __toESM(require_react());

// node_modules/@svar-ui/grid-locales/locales/en.js
var en_default3 = {
  grid: {
    "Add before": "Add before",
    "Add after": "Add after",
    Copy: "Copy",
    Cut: "Cut",
    Paste: "Paste",
    Delete: "Delete",
    "New row": "New row",
    "Move up": "Move up",
    "Move down": "Move down",
    Undo: "Undo",
    Redo: "Redo"
  }
};

// node_modules/@svar-ui/react-menu/dist/index.es.js
var import_jsx_runtime2 = __toESM(require_jsx_runtime());
var import_react3 = __toESM(require_react());
function K3(r, n) {
  return r.map((t2) => {
    const e = n(t2);
    return t2.data && t2.data.length && (e.data = K3(t2.data, n)), e;
  });
}
function q3(r, n) {
  const t2 = [];
  return r.forEach((e) => {
    if (e.data) {
      const a2 = q3(e.data, n);
      a2.length && t2.push(__spreadProps(__spreadValues({}, e), { data: a2 }));
    } else
      n(e) && t2.push(e);
  }), t2;
}
var W2 = 1;
function G4(r) {
  return K3(r, (n) => {
    const t2 = __spreadProps(__spreadValues({}, n), { id: n.id || W2++ });
    return t2.type && (t2.comp = t2.type), t2;
  });
}
var U3 = {};
function J4(r) {
  return U3[r] || r;
}
function st2(r, n) {
  U3[r] = n;
}
function _({ onClick: r, onShow: n, option: t2 }) {
  const e = (0, import_react3.useRef)(null), a2 = (0, import_react3.useCallback)(() => {
    n(t2.data ? t2.id : false, e.current);
  }, [n, t2]), f = (0, import_react3.useMemo)(() => t2 && t2.comp ? J4(t2.comp) : null, [t2]);
  return (0, import_jsx_runtime2.jsxs)(
    "div",
    {
      ref: e,
      className: `wx-cDCz9rZQ wx-option ${t2.css || ""} ${t2.disabled ? "wx-disabled" : ""}`,
      "data-id": t2.id,
      onMouseEnter: a2,
      onClick: r,
      children: [
        t2.icon ? (0, import_jsx_runtime2.jsx)("i", { className: `wx-cDCz9rZQ wx-icon ${t2.icon}` }) : null,
        t2.comp ? f ? (0, import_jsx_runtime2.jsx)(f, { item: t2, option: t2 }) : null : (0, import_jsx_runtime2.jsxs)("span", { className: "wx-cDCz9rZQ wx-value", children: [
          " ",
          t2.text,
          " "
        ] }),
        t2.subtext ? (0, import_jsx_runtime2.jsx)("span", { className: "wx-cDCz9rZQ wx-subtext", children: t2.subtext }) : null,
        t2.data ? (0, import_jsx_runtime2.jsx)("i", { className: "wx-cDCz9rZQ wx-sub-icon wxi-angle-right" }) : null
      ]
    }
  );
}
function H4({
  options: r,
  left: n = 0,
  top: t2 = 0,
  at: e = "bottom",
  parent: a2 = null,
  mount: f = null,
  context: x2 = null,
  css: d2 = "",
  onClick: c2
}) {
  const [m, w] = (0, import_react3.useState)(-1e4), [h, C3] = (0, import_react3.useState)(-1e4), [g, s] = (0, import_react3.useState)(20), [l2, b5] = (0, import_react3.useState)(), P4 = (0, import_react3.useRef)(null), [Q6, z5] = (0, import_react3.useState)(false), [R5, A3] = (0, import_react3.useState)(null), D3 = (0, import_react3.useCallback)(() => {
    const i = calculatePosition(P4.current, a2, e, n, t2);
    i && (w(i.x), C3(i.y), s(i.z), b5(i.width));
  }, [a2, e, n, t2]);
  (0, import_react3.useEffect)(() => {
    f && f(D3);
  }, []);
  const u = (0, import_react3.useCallback)(() => {
    z5(false);
  }, []), k4 = (0, import_react3.useCallback)(() => {
    c2 && c2({ action: null, option: null });
  }, [c2]), M2 = (0, import_react3.useCallback)((i, O4) => {
    z5(i), A3(O4);
  }, []), y3 = (0, import_react3.useMemo)(() => G4(r), [r]);
  return (0, import_react3.useEffect)(() => {
    D3();
  }, [a2, D3]), (0, import_react3.useEffect)(() => {
    if (P4.current)
      return clickOutside(P4.current, { callback: k4, modal: true }).destroy;
  }, [k4]), (0, import_jsx_runtime2.jsx)(
    "div",
    {
      ref: P4,
      "data-wx-menu": "true",
      className: `wx-XMmAGqVx wx-menu ${d2}`,
      style: {
        position: "absolute",
        top: h + "px",
        left: m + "px",
        width: l2,
        zIndex: g
      },
      onMouseLeave: u,
      children: y3.map((i) => (0, import_jsx_runtime2.jsxs)(import_react3.Fragment, { children: [
        i.comp === "separator" ? (0, import_jsx_runtime2.jsx)("div", { className: "wx-XMmAGqVx wx-separator" }) : (0, import_jsx_runtime2.jsx)(
          _,
          {
            option: i,
            onShow: M2,
            onClick: (O4) => {
              if (!i.data && !O4.defaultPrevented) {
                const X5 = { context: x2, action: i, option: i, event: O4 };
                i.handler && i.handler(X5), c2 && c2(X5), O4.stopPropagation();
              }
            }
          }
        ),
        i.data && Q6 === i.id ? (0, import_jsx_runtime2.jsx)(
          H4,
          {
            css: d2,
            options: i.data,
            at: "right-overlap",
            parent: R5,
            context: x2,
            onClick: c2
          }
        ) : null
      ] }, i.id))
    }
  );
}
var V3 = (0, import_react3.forwardRef)(function(n, t2) {
  const {
    options: e,
    at: a2 = "bottom",
    resolver: f = null,
    dataKey: x2 = "contextId",
    filter: d2 = null,
    css: c2 = "",
    children: m,
    onClick: w
  } = n, [h, C3] = (0, import_react3.useState)(null), [g, s] = (0, import_react3.useState)(null), [l2, b5] = (0, import_react3.useState)(0), [P4, Q6] = (0, import_react3.useState)(0), z5 = (0, import_react3.useMemo)(() => h !== null && d2 ? q3(e, (u) => d2(u, h)) : e, [h, d2, e]), R5 = (0, import_react3.useCallback)(
    (u) => {
      s(null), w && w(u);
    },
    [w]
  ), A3 = (0, import_react3.useCallback)((u, k4) => {
    let M2 = null;
    for (; u && u.dataset && !M2; )
      M2 = u.dataset[k4], u = u.parentNode;
    return M2 ? id(M2) : null;
  }, []), D3 = (0, import_react3.useCallback)(
    (u, k4) => {
      if (!u) {
        s(null);
        return;
      }
      if (u.defaultPrevented) return;
      const M2 = u.target;
      if (M2 && M2.dataset && M2.dataset.menuIgnore) return;
      b5(u.clientX + 1), Q6(u.clientY + 1);
      let y3 = typeof k4 < "u" ? k4 : A3(M2, x2);
      f && (y3 = f(y3, u), !y3) || (C3(y3), s(M2), u.preventDefault());
    },
    [x2, A3, f]
  );
  return (0, import_react3.useImperativeHandle)(t2, () => ({ show: D3 }), [D3]), (0, import_jsx_runtime2.jsxs)(import_jsx_runtime2.Fragment, { children: [
    m ? (0, import_jsx_runtime2.jsx)("span", { onClick: D3, "data-menu-ignore": "true", children: typeof m == "function" ? m() : m }) : null,
    g ? (0, import_jsx_runtime2.jsx)(Ut, { children: (0, import_jsx_runtime2.jsx)(
      H4,
      {
        css: c2,
        at: a2,
        top: P4,
        left: l2,
        parent: g,
        context: h,
        onClick: R5,
        options: z5
      },
      g
    ) }) : null
  ] });
});
var at2 = (0, import_react3.forwardRef)(function(n, t2) {
  const { options: e, at: a2 = "bottom", css: f = "", children: x2, onClick: d2 } = n, [c2, m] = (0, import_react3.useState)(null);
  function w(l2) {
    m(null), d2 && d2(l2);
  }
  const h = (0, import_react3.useCallback)((l2) => {
    m(l2.target), l2.preventDefault();
  }, []);
  (0, import_react3.useImperativeHandle)(t2, () => ({ show: h }), [h]);
  function C3(l2) {
    let b5 = l2.target;
    for (; !b5.dataset.menuIgnore; )
      m(b5), b5 = b5.parentNode;
  }
  const g = (0, import_react3.useRef)(0), s = (0, import_react3.useRef)(c2);
  return (0, import_react3.useEffect)(() => {
    s.current !== c2 && (g.current += 1, s.current = c2);
  }, [c2]), (0, import_jsx_runtime2.jsxs)(import_jsx_runtime2.Fragment, { children: [
    (0, import_jsx_runtime2.jsx)("span", { onClick: C3, "data-menu-ignore": "true", children: x2 }),
    c2 ? (0, import_jsx_runtime2.jsx)(Ut, { children: (0, import_jsx_runtime2.jsx)(
      H4,
      {
        css: f,
        at: a2,
        parent: c2,
        options: e,
        onClick: w
      },
      g.current
    ) }) : null
  ] });
});
var ct2 = (0, import_react3.forwardRef)(function(n, t2) {
  const {
    options: e,
    at: a2 = "bottom",
    resolver: f = null,
    dataKey: x2 = "contextId",
    filter: d2 = null,
    css: c2 = "",
    children: m,
    onClick: w
  } = n, h = (0, import_react3.useRef)(null), C3 = (0, import_react3.useCallback)((g, s) => {
    h.current.show(g, s);
  }, []);
  return (0, import_react3.useImperativeHandle)(
    t2,
    () => ({
      show: C3
    }),
    [C3]
  ), (0, import_jsx_runtime2.jsxs)(import_jsx_runtime2.Fragment, { children: [
    m ? (0, import_jsx_runtime2.jsx)("span", { onContextMenu: C3, "data-menu-ignore": "true", children: m }) : null,
    (0, import_jsx_runtime2.jsx)(
      V3,
      {
        css: c2,
        at: a2,
        options: e,
        resolver: f,
        dataKey: x2,
        filter: d2,
        ref: h,
        onClick: w
      }
    )
  ] });
});

// node_modules/@svar-ui/react-toolbar/dist/index.es.js
var import_jsx_runtime3 = __toESM(require_jsx_runtime());
var import_react4 = __toESM(require_react());
var K4 = {};
function ee4(n) {
  return K4[n] || n;
}
function k2(n, e) {
  K4[n] = e;
}
function U4({ menu: n = false }) {
  return (0, import_jsx_runtime3.jsx)("div", { className: `wx-z1qpqrvg wx-separator${n ? "-menu" : ""}`, children: "Â " });
}
function Z4() {
  return (0, import_jsx_runtime3.jsx)("div", { className: "wx-1IhFzpJV wx-spacer" });
}
var ne3 = (_a2) => {
  var _b = _a2, { key: n, text: e } = _b, r = __objRest(_b, ["key", "text"]);
  return r;
};
function P3(n) {
  const { item: e = {}, menu: r = false, values: c2, onClick: i, onChange: s } = n, w = (0, import_react4.useMemo)(
    () => ee4(e.comp || "label"),
    [e]
  ), d2 = (0, import_react4.useCallback)(() => {
    e && e.handler && e.handler(e), i && i({ item: e });
  }, [e, i]), v3 = (0, import_react4.useMemo)(() => e && e.key && c2 ? c2[e.key] : void 0, [e, c2]), x2 = (0, import_react4.useCallback)(
    ({ value: u }) => {
      e && e.handler && e.handler(e, u), s && s({ value: u, item: e });
    },
    [e, s]
  ), h = (0, import_react4.useMemo)(() => r ? e ? e.menuText || e.text : void 0 : e ? e.text : void 0, [r, e]);
  if (e && e.comp == "spacer")
    return (0, import_jsx_runtime3.jsx)(Z4, {});
  if (e && e.comp == "separator")
    return (0, import_jsx_runtime3.jsx)(U4, { menu: r });
  {
    const u = w, f = [
      "wx-tb-element",
      e && e.css ? e.css : "",
      e && e.spacer ? "wx-spacer" : "",
      r ? "wx-menu" : ""
    ].filter(Boolean).join(" ");
    return (0, import_jsx_runtime3.jsx)(
      "div",
      {
        className: "wx-KVAsgMam " + f,
        "data-id": e ? e.id : void 0,
        children: (0, import_jsx_runtime3.jsx)(
          u,
          __spreadValues({
            value: v3,
            onChange: x2,
            onClick: d2,
            text: h,
            menu: r
          }, ne3(e))
        )
      }
    );
  }
}
function B3({
  item: n,
  values: e = null,
  menu: r = false,
  onChange: c2,
  onClick: i
}) {
  const [s, w] = (0, import_react4.useState)(true), d2 = () => w(true), v3 = () => w(false), x2 = (u) => {
    d2(), i && i(u);
  }, h = [
    "wx-wSVFAGym",
    "wx-tb-group",
    n.css || "",
    n.layout == "column" ? "wx-column" : "",
    n.collapsed && !r ? "wx-group-collapsed" : ""
  ].filter(Boolean).join(" ");
  return (0, import_jsx_runtime3.jsx)("div", { className: h, children: n.collapsed && !r ? (0, import_jsx_runtime3.jsxs)(import_jsx_runtime3.Fragment, { children: [
    (0, import_jsx_runtime3.jsxs)("div", { className: "wx-wSVFAGym wx-collapsed", onClick: v3, children: [
      n.icon ? (0, import_jsx_runtime3.jsx)("i", { className: `wx-wSVFAGym icon ${n.icon}` }) : null,
      n.text ? (0, import_jsx_runtime3.jsx)("div", { className: "wx-wSVFAGym wx-label-text", children: n.text }) : null,
      n.text && !n.icon ? (0, import_jsx_runtime3.jsx)("i", { className: "wx-wSVFAGym wx-label-arrow wxi-angle-down" }) : null
    ] }),
    s ? null : (0, import_jsx_runtime3.jsx)(te, { width: "", oncancel: d2, children: (0, import_jsx_runtime3.jsx)("div", { className: "wx-wSVFAGym wx-drop-group", children: (0, import_jsx_runtime3.jsx)(
      B3,
      {
        item: __spreadProps(__spreadValues({}, n), { text: "", collapsed: false }),
        values: e,
        menu: r,
        onChange: c2,
        onClick: x2
      }
    ) }) })
  ] }) : (0, import_jsx_runtime3.jsxs)(import_jsx_runtime3.Fragment, { children: [
    (0, import_jsx_runtime3.jsx)("div", { className: "wx-wSVFAGym wx-tb-body", children: n.items.map(
      (u, f) => u.items ? (0, import_jsx_runtime3.jsx)(
        B3,
        {
          item: u,
          values: e,
          onClick: x2,
          onChange: c2
        },
        u.id || f
      ) : (0, import_jsx_runtime3.jsx)(
        P3,
        {
          item: u,
          values: e,
          onClick: x2,
          onChange: c2
        },
        u.id || f
      )
    ) }),
    n.text ? (0, import_jsx_runtime3.jsx)("div", { className: "wx-wSVFAGym wx-label", children: n.text }) : null
  ] }) });
}
function te4({ items: n = [], css: e, values: r, width: c2, onClick: i, onChange: s }) {
  const [w, d2] = (0, import_react4.useState)(void 0), v3 = (0, import_react4.useRef)(null);
  function x2() {
    d2(null);
  }
  function h() {
    d2(true);
  }
  function u(f) {
    x2(), i && i(f);
  }
  return (0, import_jsx_runtime3.jsxs)(
    "div",
    {
      className: `wx-Yo6BuX0p wx-menu ${e || ""}`,
      ref: v3,
      "data-id": "$menu",
      children: [
        (0, import_jsx_runtime3.jsx)(ee, { icon: "wxi-dots-h", onClick: h }),
        w ? (0, import_jsx_runtime3.jsx)(te, { width: `${c2}px`, onCancel: x2, children: (0, import_jsx_runtime3.jsx)("div", { className: "wx-Yo6BuX0p wx-drop-menu", children: n.map(
          (f, C3) => f.items ? (0, import_jsx_runtime3.jsx)(
            B3,
            {
              item: f,
              values: r,
              menu: true,
              onClick: u,
              onChange: s
            },
            f.id || C3
          ) : (0, import_jsx_runtime3.jsx)(
            P3,
            {
              item: f,
              values: r,
              menu: true,
              onClick: u,
              onChange: s
            },
            f.id || C3
          )
        ) }) }) : null
      ]
    }
  );
}
function re4(n) {
  return n.forEach((e) => {
    e.id || (e.id = uid());
  }), n;
}
function pe3(n) {
  const {
    items: e,
    menuCss: r = "",
    css: c2 = "",
    values: i,
    overflow: s = "menu",
    onClick: w,
    onChange: d2
  } = n, [v3, x2] = useWritableProp(e || []), [h, u] = useWritableProp(i || null), f = (0, import_react4.useMemo)(() => re4(v3), [v3]), C3 = (0, import_react4.useRef)(null), F4 = (0, import_react4.useRef)(-1), [S4, T4] = (0, import_react4.useState)([]), $5 = (0, import_react4.useRef)(f);
  (0, import_react4.useEffect)(() => {
    $5.current = f;
  }, [v3]);
  const O4 = (0, import_react4.useRef)(s);
  (0, import_react4.useEffect)(() => {
    O4.current = s;
  }, [s]);
  const q4 = (0, import_react4.useRef)(S4);
  (0, import_react4.useEffect)(() => {
    q4.current = S4;
  }, [S4]);
  const V4 = (0, import_react4.useRef)(false);
  function A3(l2) {
    h && (h[l2.item.key] = l2.value, u(__spreadValues({}, h))), d2 && d2(l2);
  }
  function D3() {
    const l2 = C3.current;
    if (!l2) return 0;
    const a2 = l2.children, o2 = $5.current || [];
    let m = 0;
    for (let g = 0; g < o2.length; g++)
      o2[g].comp !== "spacer" && (m += a2[g].clientWidth, o2[g].comp === "separator" && (m += 8));
    return m;
  }
  function L5() {
    const l2 = C3.current, a2 = $5.current || [];
    if (l2) {
      for (let o2 = a2.length - 1; o2 >= 0; o2--)
        if (a2[o2].items && !a2[o2].collapsed) {
          a2[o2].collapsed = true, a2[o2].$width = l2.children[o2].offsetWidth, V4.current = true, x2([...a2]);
          return;
        }
    }
  }
  function Q6(l2) {
    const a2 = C3.current, o2 = $5.current || [];
    if (a2) {
      for (let m = 0; m < o2.length; m++)
        if (o2[m].collapsed && o2[m].$width) {
          o2[m].$width - a2.children[m].offsetWidth < l2 + 10 && (o2[m].collapsed = false, V4.current = true), x2([...o2]);
          return;
        }
    }
  }
  function z5() {
    const l2 = C3.current;
    if (!l2) return;
    const a2 = $5.current || [], o2 = O4.current;
    if (o2 === "wrap") return;
    const m = l2.clientWidth;
    if (l2.scrollWidth > m) {
      if (o2 === "collapse") return L5();
      const y3 = l2.children;
      let G5 = 0;
      for (let p2 = 0; p2 < a2.length; p2++) {
        if (G5 += y3[p2].clientWidth, a2[p2].comp === "separator" && (G5 += 8), G5 > m - 40) {
          if (F4.current === p2) return;
          F4.current = p2;
          const E4 = [];
          for (let W4 = p2; W4 < a2.length; W4++)
            E4.push(a2[W4]), y3[W4].style.visibility = "hidden";
          p2 > 0 && a2[p2 - 1].comp === "separator" && (y3[p2 - 1].style.visibility = "hidden"), T4(E4);
          break;
        }
        y3[p2].style.visibility = "";
      }
    } else {
      const y3 = m - D3();
      if (y3 <= 0) return;
      if (o2 === "collapse") return Q6(y3);
      if ((q4.current || []).length) {
        F4.current = null;
        const G5 = l2.children;
        for (let p2 = 0; p2 < a2.length; p2++)
          G5[p2].style.visibility = "";
        T4([]);
      }
    }
  }
  return (0, import_react4.useEffect)(() => {
    V4.current && (V4.current = false, z5());
  }, [v3]), (0, import_react4.useEffect)(() => {
    const l2 = new ResizeObserver(() => z5());
    return C3.current && l2.observe(C3.current), () => {
      l2.disconnect();
    };
  }, []), (0, import_jsx_runtime3.jsxs)(
    "div",
    {
      className: `wx-VdPSJj8y wx-toolbar ${c2 || ""} ${s === "wrap" ? "wx-wrap" : ""}`,
      ref: C3,
      children: [
        f.map(
          (l2) => l2.items ? (0, import_jsx_runtime3.jsx)(
            B3,
            {
              item: l2,
              values: h,
              onClick: w,
              onChange: A3
            },
            l2.id
          ) : (0, import_jsx_runtime3.jsx)(
            P3,
            {
              item: l2,
              values: h,
              onClick: w,
              onChange: A3
            },
            l2.id
          )
        ),
        !!S4.length && (0, import_jsx_runtime3.jsx)(
          te4,
          {
            items: S4,
            css: r,
            values: h,
            onClick: w,
            onChange: A3
          }
        )
      ]
    }
  );
}
function le3(n) {
  const { icon: e, text: r = "", css: c2, type: i, disabled: s, menu: w, onClick: d2 } = n;
  return w ? (0, import_jsx_runtime3.jsxs)("div", { className: "wx-HXpG4gnx wx-item", onClick: d2, children: [
    (0, import_jsx_runtime3.jsx)("i", { className: `wx-HXpG4gnx ${e || "wxi-empty"} ${c2 || ""}` }),
    r
  ] }) : (0, import_jsx_runtime3.jsx)(
    ee,
    {
      icon: e,
      type: i,
      css: c2,
      text: r,
      disabled: s,
      onClick: d2
    }
  );
}
function ce4(n) {
  const { text: e, value: r, children: c2 } = n;
  return c2 ? (0, import_jsx_runtime3.jsx)("div", { className: "wx-PTEZGYcj wx-label", children: c2() }) : (0, import_jsx_runtime3.jsx)("div", { className: "wx-PTEZGYcj wx-label", children: r || e });
}
function oe3(n) {
  const { icon: e, text: r, css: c2, type: i, disabled: s, menu: w, onClick: d2 } = n;
  return w ? (0, import_jsx_runtime3.jsxs)("div", { className: "wx-3cuSqONJ wx-item", onClick: d2, children: [
    e ? (0, import_jsx_runtime3.jsx)("i", { className: `wx-3cuSqONJ ${e || ""} ${c2 || ""}` }) : null,
    r
  ] }) : (0, import_jsx_runtime3.jsx)(
    ee,
    {
      icon: e,
      type: i,
      css: c2,
      title: r,
      disabled: s,
      onClick: d2
    }
  );
}
function se4({ id: n = "", text: e = "", css: r = "", icon: c2 = "", onClick: i }) {
  function s() {
    i && i({ id: n });
  }
  return (0, import_jsx_runtime3.jsxs)("div", { className: `wx-U0Bx7pIR wx-label ${r}`, onClick: s, children: [
    c2 ? (0, import_jsx_runtime3.jsx)("i", { className: "wx-U0Bx7pIR " + c2 }) : null,
    e
  ] });
}
k2("button", le3);
k2("separator", U4);
k2("spacer", Z4);
k2("label", ce4);
k2("item", se4);
k2("icon", oe3);

// node_modules/@svar-ui/react-grid/dist/index.es.js
var oe4 = (0, import_react5.createContext)(null);
function yn2(n, e) {
  const t2 = new ResizeObserver((r) => {
    requestAnimationFrame(() => e(r[0].contentRect));
  });
  return t2.observe(n.parentNode), {
    destroy() {
      t2.disconnect();
    }
  };
}
var pt3 = 5;
var bn2 = 700;
function vn2(n) {
  return id(n.getAttribute("data-id"));
}
function Pe3(n) {
  const e = n.getBoundingClientRect(), t2 = document.body, r = e.top + t2.scrollTop - t2.clientTop || 0, u = e.left + t2.scrollLeft - t2.clientLeft || 0;
  return {
    y: Math.round(r),
    x: Math.round(u),
    width: n.offsetWidth,
    height: n.offsetHeight
  };
}
function Ze3(n, e) {
  const t2 = Pe3(e);
  return { x: n.clientX - t2.x, y: n.clientY - t2.y };
}
function Cn2(n, e) {
  const t2 = e.current;
  let r = null, u, x2, a2 = false, b5 = false;
  const d2 = document.createElement("DIV");
  d2.className = "wx-drag-zone", d2.setAttribute("tabindex", -1);
  function f() {
    clearTimeout(u), u = null;
  }
  function h(i) {
    const k4 = locate(i);
    k4 && (r = {
      container: d2,
      sourceNode: i.target,
      from: vn2(k4),
      pos: Ze3(i, n)
    }, x2 = r.pos, s(i));
  }
  function s(i) {
    var _a2;
    if (!r) return;
    const k4 = r.pos = Ze3(i, n);
    if (!a2) {
      if (!b5 && !((_a2 = i == null ? void 0 : i.target) == null ? void 0 : _a2.getAttribute("draggable-data")) && Math.abs(x2.x - k4.x) < pt3 && Math.abs(x2.y - k4.y) < pt3)
        return;
      if (D3(i) === false) return R5();
    }
    if (b5) {
      const U6 = window.scrollX || document.documentElement.scrollLeft || document.body.scrollLeft, J7 = window.scrollY || document.documentElement.scrollTop || document.body.scrollTop;
      r.targetNode = document.elementFromPoint(
        i.pageX - U6,
        i.pageY - J7
      );
    } else r.targetNode = i.target;
    t2.move && t2.move(i, r), d2.style.left = -(r.offset ? r.offset.x : 0) + "px", d2.style.top = r.pos.y + (r.offset ? r.offset.y : 0) + "px";
  }
  function v3(i) {
    d2.parentNode && d2.parentNode.removeChild(d2), d2.innerHTML = "", a2 && t2.end && t2.end(i, r), r = x2 = null, R5();
  }
  function E4(i) {
    t2.getReorder && !t2.getReorder() || i.button === 0 && (T4(i), window.addEventListener("mousemove", C3), window.addEventListener("mouseup", l2), h(i));
  }
  function C3(i) {
    s(i);
  }
  function l2(i) {
    v3(i);
  }
  function m(i) {
    if (t2.getReorder && !t2.getReorder()) return;
    u = setTimeout(() => {
      b5 = true, h(i.touches[0]);
    }, bn2), T4(i);
    function k4() {
      u && f(), i.target.removeEventListener("touchmove", g), i.target.removeEventListener("touchend", k4), v3(i);
    }
    i.target.addEventListener("touchmove", g), i.target.addEventListener("touchend", k4), n.addEventListener("contextmenu", w);
  }
  function g(i) {
    a2 ? (i.preventDefault(), s(i.touches[0])) : u && f();
  }
  function w(i) {
    if (a2 || u)
      return i.preventDefault(), false;
  }
  function y3(i) {
    i.preventDefault();
  }
  function T4(i) {
    if (!t2.getDraggableInfo) return;
    const { hasDraggable: k4 } = t2.getDraggableInfo();
    (!k4 || i.target.getAttribute("draggable-data")) && (document.body.style.userSelect = "none", document.body.style.webkitUserSelect = "none");
  }
  function D3(i) {
    if (a2 = true, t2.start) {
      if (t2.start(i, r) === false) return false;
      n.appendChild(d2), document.body.style.cursor = "move";
    }
  }
  function R5(i) {
    a2 = b5 = false, document.body.style.cursor = "", document.body.style.userSelect = "", document.body.style.webkitUserSelect = "", window.removeEventListener("mousemove", C3), window.removeEventListener("mouseup", l2), i && (n.removeEventListener("mousedown", E4), n.removeEventListener("touchstart", m), n.removeEventListener("dragstart", y3));
  }
  return n.addEventListener("mousedown", E4), n.addEventListener("touchstart", m), n.addEventListener("dragstart", y3), {
    destroy() {
      R5(true);
    }
  };
}
var Sn2 = 4e-3;
function Rn() {
  return {
    dirX: 0,
    dirY: 0,
    scrollSpeedFactor: 1
  };
}
function Nn(n, e, t2, r) {
  const { node: u, left: x2, top: a2, bottom: b5, sense: d2, xScroll: f, yScroll: h } = r, s = Ze3(n, u);
  t2.scrollState || (t2.scrollState = Rn());
  let v3 = 0, E4 = 0;
  s.x < x2 + d2 ? v3 = -1 : s.x > e.width - d2 && (v3 = 1), s.y < a2 + Math.round(d2 / 2) ? E4 = -1 : s.y > e.height - b5 - Math.round(d2 / 2) && (E4 = 1), (t2.scrollState.dirX !== v3 || t2.scrollState.dirY !== E4) && (Et3(t2), t2.scrollState.dirX = v3, t2.scrollState.dirY = E4), (f && t2.scrollState.dirX !== 0 || h && t2.scrollState.dirY !== 0) && Dn2(t2, r, {
    x: t2.scrollState.dirX,
    y: t2.scrollState.dirY
  });
}
function Dn2(n, e, t2) {
  n.autoScrollTimer || (n.autoScrollTimer = setTimeout(() => {
    n.activeAutoScroll = setInterval(
      Tn2,
      15,
      n,
      e,
      t2
    );
  }, 250));
}
function Et3(n) {
  n.scrollSpeedFactor = 1, n.autoScrollTimer && (n.autoScrollTimer = clearTimeout(n.autoScrollTimer), n.activeAutoScroll = clearInterval(n.activeAutoScroll));
}
function Tn2(n, e, t2) {
  const { x: r, y: u } = t2;
  n.scrollSpeedFactor += Sn2, r !== 0 && Ln(n, e, r), u !== 0 && En(n, e, u);
}
function En(n, e, t2) {
  const r = e.node.scrollTop;
  Lt(
    r + Math.round(e.sense / 3) * n.scrollSpeedFactor * t2,
    "scrollTop",
    e
  );
}
function Ln(n, e, t2) {
  const r = e.node.scrollLeft;
  Lt(
    r + Math.round(e.sense / 3) * n.scrollSpeedFactor * t2,
    "scrollLeft",
    e
  );
}
function Lt(n, e, t2) {
  t2.node[e] = n;
}
function We2(n, e, t2, r, u, x2) {
  const a2 = {};
  return n && (a2.width = `${n}px`, a2.minWidth = `${n}px`), e && (a2.flexGrow = e), x2 && (a2.height = `${x2}px`), t2 && (a2.position = "sticky", t2.left && (a2.left = `${r}px`), t2.right && (a2.right = `${u}px`)), a2;
}
function Ht2(n, e, t2) {
  let r = "";
  if (n.fixed)
    for (const u in n.fixed)
      r += n.fixed[u] === -1 ? "wx-shadow " : "wx-fixed ";
  return r += e.rowspan > 1 ? "wx-rowspan " : "", r += e.colspan > 1 ? "wx-colspan " : "", r += e.vertical ? "wx-vertical " : "", r += t2 ? t2(n) + " " : "", r;
}
function Hn(n) {
  const {
    row: e,
    column: t2,
    cellStyle: r = null,
    columnStyle: u = null,
    children: x2
  } = n, [a2, b5] = useWritableProp(n.focusable), d2 = (0, import_react5.useContext)(oe4), f = useStore(d2, "focusCell"), h = useStore(d2, "search"), s = useStore(d2, "reorder"), v3 = (0, import_react5.useMemo)(
    () => (h == null ? void 0 : h.rows[e.id]) && h.rows[e.id][t2.id],
    [h, e.id, t2.id]
  ), E4 = (0, import_react5.useMemo)(
    () => We2(
      t2.width,
      t2.flexgrow,
      t2.fixed,
      t2.left,
      t2.right
    ),
    [t2.width, t2.flexgrow, t2.fixed, t2.left, t2.right]
  );
  function C3(R5, i) {
    let k4 = "wx-cell";
    return k4 += t2.fixed ? " " + (t2.fixed === -1 ? "wx-shadow" : "wx-fixed") : "", k4 += R5 ? " " + R5(t2) : "", k4 += i ? " " + i(e, t2) : "", k4 += t2.treetoggle ? " wx-tree-cell" : "", k4;
  }
  const l2 = (0, import_react5.useMemo)(
    () => C3(u, r),
    [u, r, t2, e]
  ), m = (0, import_react5.useMemo)(() => typeof t2.draggable == "function" ? t2.draggable(e, t2) !== false : t2.draggable, [t2, e]), g = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    g.current && a2 && (f == null ? void 0 : f.row) === e.id && (f == null ? void 0 : f.column) === t2.id && g.current.focus();
  }, [f, a2, e.id, t2.id]);
  const w = (0, import_react5.useCallback)(() => {
    a2 && !f && d2.exec("focus-cell", {
      row: e.id,
      column: t2.id,
      eventSource: "focus"
    });
  }, [d2, a2, f, e.id, t2.id]);
  (0, import_react5.useEffect)(() => () => {
    a2 && f && (d2.exec("focus-cell", { eventSource: "destroy" }), b5(false));
  }, [d2, b5]);
  function y3(R5) {
    const i = new RegExp(`(${h.value.trim()})`, "gi");
    return String(R5).split(i).map((U6) => ({ text: U6, highlight: i.test(U6) }));
  }
  const T4 = (0, import_react5.useMemo)(() => {
    const R5 = t2.fixed && t2.fixed.left === -1 || t2.fixed.right === -1, i = t2.fixed && t2.fixed.right;
    return [
      l2,
      R5 ? "wx-shadow" : "",
      i ? "wx-fixed-right" : ""
    ].filter(Boolean).join(" ");
  }, [l2, t2]), D3 = t2.cell;
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      className: "wx-TSCaXsGV " + T4,
      ref: g,
      onFocus: w,
      style: E4,
      "data-row-id": e.id,
      "data-col-id": t2.id,
      tabIndex: a2 ? "0" : "-1",
      role: "gridcell",
      "aria-colindex": t2._colindex,
      "aria-readonly": t2.editor ? void 0 : true,
      children: [
        s && t2.draggable ? m ? (0, import_jsx_runtime4.jsx)(
          "i",
          {
            "draggable-data": "true",
            className: "wx-TSCaXsGV wx-draggable wxi-drag"
          }
        ) : (0, import_jsx_runtime4.jsx)("i", { className: "wx-TSCaXsGV wx-draggable-stub" }) : null,
        t2.treetoggle ? (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
          (0, import_jsx_runtime4.jsx)("span", { style: { marginLeft: `${e.$level * 28}px` } }),
          e.$count ? (0, import_jsx_runtime4.jsx)(
            "i",
            {
              "data-action": "toggle-row",
              className: `wx-TSCaXsGV wx-table-tree-toggle wxi-menu-${e.open !== false ? "down" : "right"}`
            }
          ) : null
        ] }) : null,
        D3 ? (0, import_jsx_runtime4.jsx)(
          D3,
          {
            api: d2,
            row: e,
            column: t2,
            onAction: ({ action: R5, data: i }) => d2.exec(R5, i)
          }
        ) : x2 ? x2() : v3 ? (0, import_jsx_runtime4.jsx)("span", { children: y3(b2(e, t2)).map(
          ({ highlight: R5, text: i }, k4) => R5 ? (0, import_jsx_runtime4.jsx)("mark", { className: "wx-TSCaXsGV wx-search", children: i }, k4) : (0, import_jsx_runtime4.jsx)("span", { children: i }, k4)
        ) }) : b2(e, t2)
      ]
    }
  );
}
function wt3(n, e) {
  let t2, r;
  function u(b5) {
    t2 = b5.clientX, n.style.opacity = 1, document.body.style.cursor = "ew-resize", document.body.style.userSelect = "none", window.addEventListener("mousemove", x2), window.addEventListener("mouseup", a2), e && e.down && e.down(n);
  }
  function x2(b5) {
    r = b5.clientX - t2, e && e.move && e.move(r);
  }
  function a2() {
    n.style.opacity = "", document.body.style.cursor = "", document.body.style.userSelect = "", e && e.up && e.up(r), window.removeEventListener("mousemove", x2), window.removeEventListener("mouseup", a2);
  }
  return n.addEventListener("mousedown", u), {
    destroy() {
      n.removeEventListener("mousedown", u);
    }
  };
}
function kn2({ filter: n, column: e, action: t2, filterValue: r }) {
  var _a2;
  function u({ value: x2 }) {
    t2({ value: x2, key: e.id });
  }
  return (0, import_jsx_runtime4.jsx)(
    fe,
    __spreadProps(__spreadValues({}, (_a2 = n.config) != null ? _a2 : {}), {
      value: r,
      onChange: u
    })
  );
}
function $n2({ filter: n, column: e, action: t2, filterValue: r }) {
  var _a2;
  const u = (0, import_react5.useContext)(oe4), x2 = useStore(u, "flatData"), a2 = (0, import_react5.useMemo)(
    () => {
      var _a3;
      return ((_a3 = n == null ? void 0 : n.config) == null ? void 0 : _a3.options) || (e == null ? void 0 : e.options) || d2();
    },
    [n, e, x2]
  ), b5 = (0, import_react5.useMemo)(() => {
    var _a3;
    return (_a3 = n == null ? void 0 : n.config) == null ? void 0 : _a3.template;
  }, [n]);
  function d2() {
    const s = [];
    return x2.forEach((v3) => {
      const E4 = S(v3, e);
      s.includes(E4) || s.push(E4);
    }), s.map((v3) => ({ id: v3, label: v3 }));
  }
  function f({ value: s }) {
    t2({ value: s, key: e.id });
  }
  function h(s) {
    s.key !== "Tab" && s.preventDefault();
  }
  return (0, import_jsx_runtime4.jsx)("div", { style: { width: "100%" }, onKeyDown: h, children: (0, import_jsx_runtime4.jsx)(
    Et,
    __spreadProps(__spreadValues({
      placeholder: "",
      clear: true
    }, (_a2 = n == null ? void 0 : n.config) != null ? _a2 : {}), {
      options: a2,
      value: r,
      onChange: f,
      children: (s) => b5 ? b5(s) : s.label
    })
  ) });
}
var Mn2 = {
  text: kn2,
  richselect: $n2
};
function An({ filter: n, column: e }) {
  const t2 = (0, import_react5.useContext)(oe4), r = useStore(t2, "filterValues");
  function u(a2) {
    t2.exec("filter-rows", a2);
  }
  const x2 = (0, import_react5.useMemo)(() => Mn2[n.type], [n.type]);
  return (0, import_jsx_runtime4.jsx)(
    x2,
    {
      filter: n,
      column: e,
      action: u,
      filterValue: r[e.id]
    }
  );
}
function In2(n) {
  const {
    cell: e,
    column: t2,
    row: r,
    lastRow: u,
    sortRow: x2,
    columnStyle: a2,
    bodyHeight: b5,
    hasSplit: d2
  } = n, f = (0, import_react5.useContext)(oe4), h = useStore(f, "sortMarks"), s = (0, import_react5.useMemo)(() => h ? h[t2.id] : void 0, [h, t2.id]), v3 = (0, import_react5.useRef)(), E4 = (0, import_react5.useCallback)(
    (H6) => {
      v3.current = e.flexgrow ? H6.parentNode.clientWidth : e.width;
    },
    [e.flexgrow, e.width]
  ), C3 = (0, import_react5.useCallback)(
    (H6, $5) => {
      f.exec("resize-column", {
        id: e.id,
        width: Math.max(1, (v3.current || 0) + H6),
        inProgress: $5
      });
    },
    [f, e.id]
  ), l2 = (0, import_react5.useCallback)((H6) => C3(H6, true), [C3]), m = (0, import_react5.useCallback)((H6) => C3(H6, false), [C3]), g = (0, import_react5.useCallback)(
    (H6) => {
      if (!t2.sort || e.filter) return;
      let $5 = s == null ? void 0 : s.order;
      $5 && ($5 = $5 === "asc" ? "desc" : "asc"), f.exec("sort-rows", { key: e.id, add: H6.ctrlKey, order: $5 });
    },
    [f, e.id, e.filter, t2.sort, s == null ? void 0 : s.order]
  ), w = (0, import_react5.useCallback)(
    (H6) => {
      H6 && H6.stopPropagation(), f.exec("collapse-column", { id: e.id, row: r });
    },
    [f, e.id, r]
  ), y3 = (0, import_react5.useCallback)(
    (H6) => {
      H6.key === "Enter" && w();
    },
    [w]
  ), T4 = (0, import_react5.useCallback)(
    (H6) => {
      H6.key === "Enter" && !e.filter && g(H6);
    },
    [g, e.filter]
  ), D3 = (0, import_react5.useMemo)(
    () => e.collapsed && t2.collapsed,
    [e.collapsed, t2.collapsed]
  ), R5 = (0, import_react5.useMemo)(
    () => D3 && !d2 && e.collapsible !== "header",
    [D3, d2, e.collapsible]
  ), i = (0, import_react5.useMemo)(
    () => R5 ? { top: -b5 / 2, position: "absolute" } : {},
    [R5, b5]
  ), k4 = (0, import_react5.useMemo)(
    () => {
      var _a2;
      return We2(
        e.width,
        e.flexgrow,
        t2.fixed,
        t2.left,
        (_a2 = e.right) != null ? _a2 : t2.right,
        e.height + (D3 && R5 ? b5 : 0)
      );
    },
    [
      e.width,
      e.flexgrow,
      t2.fixed,
      t2.left,
      e.right,
      t2.right,
      e.height,
      D3,
      R5,
      b5
    ]
  ), U6 = (0, import_react5.useMemo)(
    () => Ht2(t2, e, a2),
    [t2, e, a2]
  ), J7 = (0, import_react5.useCallback)(() => Object.fromEntries(
    Object.entries(e).filter(([H6]) => H6 !== "cell")
  ), [e]), te5 = `wx-cell ${U6} ${e.css || ""} wx-collapsed`, V4 = [
    "wx-cell",
    U6,
    e.css || "",
    e.filter ? "wx-filter" : "",
    t2.fixed && t2.fixed.right ? "wx-fixed-right" : ""
  ].filter(Boolean).join(" "), j4 = (0, import_react5.useRef)(null);
  return (0, import_react5.useEffect)(() => {
    const H6 = j4.current;
    if (!H6) return;
    const $5 = wt3(H6, { down: E4, move: l2, up: m });
    return () => {
      typeof $5 == "function" && $5();
    };
  }, [E4, l2, m, wt3]), D3 ? (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "wx-RsQD74qC " + te5,
      style: k4,
      role: "button",
      "aria-label": `Expand column ${e.text || ""}`,
      "aria-expanded": !e.collapsed,
      tabIndex: 0,
      onKeyDown: y3,
      onClick: w,
      "data-header-id": t2.id,
      children: (0, import_jsx_runtime4.jsx)("div", { className: "wx-RsQD74qC wx-text", style: i, children: e.text || "" })
    }
  ) : (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      className: "wx-RsQD74qC " + V4,
      style: k4,
      onClick: g,
      "data-header-id": t2.id,
      tabIndex: !e._hidden && t2.sort && !e.filter ? 0 : void 0,
      role: "columnheader",
      "aria-colindex": e._colindex,
      "aria-colspan": e.colspan > 1 ? e.colspan : void 0,
      "aria-rowspan": e.rowspan > 1 ? e.rowspan : void 0,
      "aria-sort": !(s == null ? void 0 : s.order) || e.filter ? "none" : (s == null ? void 0 : s.order) === "asc" ? "ascending" : "descending",
      onKeyDown: T4,
      children: [
        e.collapsible ? (0, import_jsx_runtime4.jsx)(
          "div",
          {
            className: "wx-RsQD74qC wx-collapse",
            role: "button",
            "aria-label": e.collapsed ? "Expand column" : "Collapse column",
            "aria-expanded": !e.collapsed,
            tabIndex: 0,
            onKeyDown: y3,
            onClick: w,
            children: (0, import_jsx_runtime4.jsx)(
              "i",
              {
                className: `wx-RsQD74qC wxi-angle-${e.collapsed ? "down" : "right"}`
              }
            )
          }
        ) : null,
        e.cell ? (() => {
          const H6 = e.cell;
          return (0, import_jsx_runtime4.jsx)(
            H6,
            {
              api: f,
              cell: J7(),
              column: t2,
              row: r,
              onAction: ({ action: $5, data: Ee4 }) => f.exec($5, Ee4)
            }
          );
        })() : e.filter ? (0, import_jsx_runtime4.jsx)(An, { filter: e.filter, column: t2 }) : (0, import_jsx_runtime4.jsx)("div", { className: "wx-RsQD74qC wx-text", children: e.text || "" }),
        t2.resize && u && !e._hidden ? (0, import_jsx_runtime4.jsx)(
          "div",
          {
            className: "wx-RsQD74qC wx-grip",
            role: "presentation",
            "aria-label": "Resize column",
            ref: j4,
            onClick: (H6) => H6.stopPropagation(),
            children: (0, import_jsx_runtime4.jsx)("div", {})
          }
        ) : null,
        x2 ? (0, import_jsx_runtime4.jsx)("div", { className: "wx-RsQD74qC wx-sort", children: s ? (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
          typeof s.index < "u" ? (0, import_jsx_runtime4.jsx)("div", { className: "wx-RsQD74qC wx-order", children: s.index + 1 }) : null,
          (0, import_jsx_runtime4.jsx)(
            "i",
            {
              className: `wx-RsQD74qC wxi-arrow-${s.order === "asc" ? "up" : "down"}`
            }
          )
        ] }) : null }) : null
      ]
    }
  );
}
function Vn({ cell: n, column: e, row: t2, columnStyle: r }) {
  const u = (0, import_react5.useContext)(oe4), x2 = (0, import_react5.useMemo)(
    () => {
      var _a2;
      return We2(
        n == null ? void 0 : n.width,
        n == null ? void 0 : n.flexgrow,
        e == null ? void 0 : e.fixed,
        e == null ? void 0 : e.left,
        (_a2 = n == null ? void 0 : n.right) != null ? _a2 : e == null ? void 0 : e.right,
        n == null ? void 0 : n.height
      );
    },
    [
      n == null ? void 0 : n.width,
      n == null ? void 0 : n.flexgrow,
      e == null ? void 0 : e.fixed,
      e == null ? void 0 : e.left,
      n == null ? void 0 : n.right,
      e == null ? void 0 : e.right,
      n == null ? void 0 : n.height
    ]
  ), a2 = (0, import_react5.useMemo)(
    () => Ht2(e, n, r),
    [e, n, r]
  ), b5 = (0, import_react5.useCallback)(() => Object.fromEntries(
    Object.entries(n || {}).filter(([f]) => f !== "cell")
  ), [n]), d2 = `wx-6Sdi3Dfd wx-cell ${a2 || ""} ${(n == null ? void 0 : n.css) || ""}` + ((e == null ? void 0 : e.fixed) && (e == null ? void 0 : e.fixed.right) ? " wx-fixed-right" : "");
  return (0, import_jsx_runtime4.jsx)("div", { className: d2, style: x2, children: !(e == null ? void 0 : e.collapsed) && !(n == null ? void 0 : n.collapsed) ? (n == null ? void 0 : n.cell) ? import_react5.default.createElement(n.cell, {
    api: u,
    cell: b5(),
    column: e,
    row: t2,
    onAction: ({ action: f, data: h }) => u.exec(f, h)
  }) : (0, import_jsx_runtime4.jsx)("div", { className: "wx-6Sdi3Dfd wx-text", children: (n == null ? void 0 : n.text) || "" }) : null });
}
function xt3({
  deltaLeft: n,
  contentWidth: e,
  columns: t2,
  type: r = "header",
  columnStyle: u,
  bodyHeight: x2
}) {
  const a2 = (0, import_react5.useContext)(oe4), b5 = useStore(a2, "_sizes"), d2 = useStore(a2, "split"), f = (0, import_react5.useMemo)(() => b5 == null ? void 0 : b5[`${r}RowHeights`], [b5, r]), h = (0, import_react5.useMemo)(() => {
    let l2 = [];
    if (t2 && t2.length) {
      const m = t2[0][r].length;
      for (let g = 0; g < m; g++) {
        let w = 0;
        l2.push([]), t2.forEach((y3, T4) => {
          const D3 = __spreadValues({}, y3[r][g]);
          if (w || l2[g].push(D3), D3.colspan > 1) {
            if (w = D3.colspan - 1, !O2() && y3.right) {
              let R5 = y3.right;
              for (let i = 1; i < D3.colspan; i++)
                R5 -= t2[T4 + i].width;
              D3.right = R5;
            }
          } else w && w--;
        });
      }
    }
    return l2;
  }, [t2, r]), s = (0, import_react5.useMemo)(() => (d2 == null ? void 0 : d2.left) || (d2 == null ? void 0 : d2.right), [d2]);
  function v3(l2) {
    return t2.find((m) => m.id === l2);
  }
  function E4(l2, m) {
    let g = m;
    return l2.rowspan && (g += l2.rowspan - 1), g === h.length - 1;
  }
  function C3(l2, m, g) {
    if (!g.sort) return false;
    for (let w = h.length - 1; w >= 0; w--) {
      const y3 = g.header[w];
      if (!y3.filter && !y3._hidden) return m === w;
    }
    return E4(l2, m);
  }
  return (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: `wx-sAsPVaUK wx-${r}`,
      style: { paddingLeft: `${n}px`, width: `${e}px` },
      role: "rowgroup",
      children: h.map((l2, m) => (0, import_jsx_runtime4.jsx)(
        "div",
        {
          className: r === "header" ? "wx-sAsPVaUK wx-h-row" : "wx-sAsPVaUK wx-f-row",
          style: { height: `${f == null ? void 0 : f[m]}px`, display: "flex" },
          role: "row",
          children: l2.map((g) => {
            const w = v3(g.id);
            return r === "header" ? (0, import_jsx_runtime4.jsx)(
              In2,
              {
                cell: g,
                columnStyle: u,
                column: w,
                row: m,
                lastRow: E4(g, m),
                bodyHeight: x2,
                sortRow: C3(g, m, w),
                hasSplit: s
              },
              g.id
            ) : (0, import_jsx_runtime4.jsx)(
              Vn,
              {
                cell: g,
                columnStyle: u,
                column: v3(g.id),
                row: m
              },
              g.id
            );
          })
        },
        m
      ))
    }
  );
}
function zn({ overlay: n }) {
  const e = (0, import_react5.useContext)(oe4);
  function t2(u) {
    return typeof u == "function";
  }
  const r = n;
  return (0, import_jsx_runtime4.jsx)("div", { className: "wx-1ty666CQ wx-overlay", children: t2(n) ? (0, import_jsx_runtime4.jsx)(r, { onAction: ({ action: u, data: x2 }) => e.exec(u, x2) }) : n });
}
function On(n) {
  const { actions: e, editor: t2 } = n, [r, u] = (0, import_react5.useState)((t2 == null ? void 0 : t2.value) || ""), x2 = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    x2.current && x2.current.focus();
  }, []);
  function a2() {
    x2.current && (u(x2.current.value), e.updateValue(x2.current.value));
  }
  function b5({ key: d2 }) {
    d2 === "Enter" && e.save();
  }
  return (0, import_jsx_runtime4.jsx)(
    "input",
    {
      className: "wx-e7Ao5ejY wx-text",
      onInput: a2,
      onKeyDown: b5,
      ref: x2,
      type: "text",
      value: r
    }
  );
}
function Pn2({ actions: n, editor: e, onAction: t2 }) {
  const [r, u] = (0, import_react5.useState)(e == null ? void 0 : e.value), [x2, a2] = (0, import_react5.useState)(e == null ? void 0 : e.renderedValue), [b5, d2] = (0, import_react5.useState)((e == null ? void 0 : e.options) || []), f = (0, import_react5.useMemo)(() => {
    var _a2;
    return (_a2 = e == null ? void 0 : e.config) == null ? void 0 : _a2.template;
  }, [e]), h = (0, import_react5.useMemo)(() => {
    var _a2;
    return (_a2 = e == null ? void 0 : e.config) == null ? void 0 : _a2.cell;
  }, [e]), s = (0, import_react5.useMemo)(() => (b5 || []).findIndex((w) => w.id === r), [b5, r]), v3 = (0, import_react5.useRef)(null), E4 = (0, import_react5.useRef)(null), C3 = (0, import_react5.useCallback)(
    (w) => {
      v3.current = w.navigate, E4.current = w.keydown, v3.current(s);
    },
    [s, v3]
  ), l2 = (0, import_react5.useCallback)(
    (w) => {
      var _a2, _b;
      const y3 = (_b = (_a2 = w == null ? void 0 : w.target) == null ? void 0 : _a2.value) != null ? _b : "";
      a2(y3);
      const T4 = y3 ? ((e == null ? void 0 : e.options) || []).filter(
        (D3) => (D3.label || "").toLowerCase().includes(y3.toLowerCase())
      ) : (e == null ? void 0 : e.options) || [];
      d2(T4), T4.length ? v3.current(-1 / 0) : v3.current(null);
    },
    [e]
  ), m = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    m.current && m.current.focus();
  }, []), (0, import_react5.useEffect)(() => {
    u(e == null ? void 0 : e.value), a2(e == null ? void 0 : e.renderedValue), d2((e == null ? void 0 : e.options) || []);
  }, [e]);
  const g = (0, import_react5.useCallback)(
    ({ id: w }) => {
      n.updateValue(w), n.save();
    },
    [n]
  );
  return (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(
      "input",
      {
        className: "wx-0UYfSd1x wx-input",
        ref: m,
        value: x2 != null ? x2 : "",
        onChange: l2,
        onKeyDown: (w) => E4.current ? E4.current(w, s) : void 0
      }
    ),
    (0, import_jsx_runtime4.jsx)(
      we,
      {
        items: b5,
        onReady: C3,
        onSelect: g,
        children: ({ option: w }) => f ? f(w) : h ? (0, import_jsx_runtime4.jsx)(h, { data: w, onAction: t2 }) : w.label
      }
    )
  ] });
}
function Kn({ actions: n, editor: e, onAction: t2 }) {
  var _a2;
  const [r] = (0, import_react5.useState)(() => e.value || /* @__PURE__ */ new Date()), [u] = (0, import_react5.useState)(() => {
    var _a3;
    return (_a3 = e.config) == null ? void 0 : _a3.template;
  }), [x2] = (0, import_react5.useState)(() => {
    var _a3;
    return (_a3 = e.config) == null ? void 0 : _a3.cell;
  });
  function a2({ value: d2 }) {
    n.updateValue(d2), n.save();
  }
  const b5 = (0, import_react5.useRef)(null);
  return (0, import_react5.useEffect)(() => {
    b5.current && b5.current.focus(), typeof window < "u" && window.getSelection && window.getSelection().removeAllRanges();
  }, []), (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(
      "div",
      {
        className: "wx-lNWNYUb6 wx-value",
        ref: b5,
        tabIndex: 0,
        onClick: () => n.cancel(),
        onKeyDown: (d2) => d2.preventDefault(),
        children: u ? u(r) : x2 ? (0, import_jsx_runtime4.jsx)(x2, { data: e.value, onAction: t2 }) : (0, import_jsx_runtime4.jsx)("span", { className: "wx-lNWNYUb6 wx-text", children: e.renderedValue })
      }
    ),
    (0, import_jsx_runtime4.jsx)(te, { width: "auto", children: (0, import_jsx_runtime4.jsx)(
      lt,
      {
        value: r,
        onChange: a2,
        buttons: (_a2 = e.config) == null ? void 0 : _a2.buttons
      }
    ) })
  ] });
}
function Wn2(n) {
  var _a2;
  const { actions: e, editor: t2 } = n, r = (_a2 = n.onAction) != null ? _a2 : n.onaction, u = t2.config || {}, [x2] = (0, import_react5.useState)(
    t2.options.find((l2) => l2.id === t2.value)
  ), [a2] = (0, import_react5.useState)(t2.value), [b5] = (0, import_react5.useState)(t2.options), d2 = (0, import_react5.useMemo)(
    () => b5.findIndex((l2) => l2.id === a2),
    [b5, a2]
  );
  function f({ id: l2 }) {
    e.updateValue(l2), e.save();
  }
  let h;
  const [s, v3] = (0, import_react5.useState)();
  function E4(l2) {
    h = l2.navigate, v3(() => l2.keydown), h(d2);
  }
  const C3 = (0, import_react5.useRef)(null);
  return (0, import_react5.useEffect)(() => {
    C3.current && C3.current.focus(), typeof window < "u" && window.getSelection && window.getSelection().removeAllRanges();
  }, []), (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(
      "div",
      {
        ref: C3,
        className: "wx-ywGRk611 wx-value",
        tabIndex: 0,
        onClick: () => e.cancel(),
        onKeyDown: (l2) => {
          s(l2, d2), l2.preventDefault();
        },
        children: u.template ? u.template(x2) : u.cell ? (() => {
          const l2 = u.cell;
          return (0, import_jsx_runtime4.jsx)(l2, { data: x2, onAction: r });
        })() : (0, import_jsx_runtime4.jsx)("span", { className: "wx-ywGRk611 wx-text", children: t2.renderedValue })
      }
    ),
    (0, import_jsx_runtime4.jsx)(we, { items: b5, onReady: E4, onSelect: f, children: ({ option: l2 }) => u.template ? u.template(l2) : u.cell ? (() => {
      const m = u.cell;
      return (0, import_jsx_runtime4.jsx)(m, { data: l2, onAction: r });
    })() : l2.label })
  ] });
}
var _n2 = {
  text: On,
  combo: Pn2,
  datepicker: Kn,
  richselect: Wn2
};
function Fn({ column: n, row: e }) {
  const t2 = (0, import_react5.useContext)(oe4), r = useStore(t2, "editor"), u = (0, import_react5.useCallback)(
    (C3, l2) => {
      t2.exec("close-editor", { ignore: C3 }), l2 && t2.exec("focus-cell", __spreadProps(__spreadValues({}, l2), {
        eventSource: "click"
      }));
    },
    [t2]
  ), x2 = (0, import_react5.useCallback)(
    (C3) => {
      const l2 = C3 ? null : { row: r == null ? void 0 : r.id, column: r == null ? void 0 : r.column };
      u(false, l2);
    },
    [r, u]
  ), a2 = (0, import_react5.useCallback)(() => {
    u(true, { row: r == null ? void 0 : r.id, column: r == null ? void 0 : r.column });
  }, [r, u]), b5 = (0, import_react5.useCallback)(
    (C3) => {
      t2.exec("editor", { value: C3 });
    },
    [t2]
  ), d2 = (0, import_react5.useCallback)(
    (C3) => {
      C3.key === "Enter" && r && a2();
    },
    [r, a2]
  ), f = (0, import_react5.useMemo)(
    () => We2(
      n.width,
      n.flexgrow,
      n.fixed,
      n.left,
      n.right
    ),
    [n.width, n.flexgrow, n.fixed, n.left, n.right]
  ), h = (0, import_react5.useMemo)(() => {
    let C3 = n.editor;
    typeof C3 == "function" && (C3 = C3(e, n));
    let l2 = typeof C3 == "string" ? C3 : C3.type;
    return _n2[l2];
  }, [n, e]), s = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    if (!s.current) return;
    const C3 = clickOutside(s.current, () => x2(true));
    return () => {
      typeof C3 == "function" && C3();
    };
  }, [x2]), (0, import_react5.useEffect)(() => {
    s.current && typeof f == "string" && s.current.setAttribute("style", f);
  }, [f]);
  const v3 = typeof e.$parent < "u" ? "gridcell" : "cell", E4 = typeof e.$parent < "u" ? !n.editor : void 0;
  return (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: "wx-8l724t2g wx-cell wx-editor",
      ref: s,
      style: typeof f == "object" && f !== null ? f : void 0,
      role: v3,
      "aria-readonly": E4,
      tabIndex: -1,
      onClick: (C3) => C3.stopPropagation(),
      onDoubleClick: (C3) => C3.stopPropagation(),
      onKeyDown: d2,
      children: h ? (0, import_jsx_runtime4.jsx)(
        h,
        {
          editor: r,
          actions: { save: x2, cancel: a2, updateValue: b5 },
          onAction: ({ action: C3, data: l2 }) => t2.exec(C3, l2)
        }
      ) : null
    }
  );
}
function mt3(n) {
  const { columns: e, type: t2, columnStyle: r } = n, u = (0, import_react5.useContext)(oe4), { filterValues: x2, _columns: a2, _sizes: b5 } = u.getState();
  function d2(f) {
    return r ? " " + r(f) : "";
  }
  return (0, import_jsx_runtime4.jsx)(import_jsx_runtime4.Fragment, { children: e.map((f, h) => (0, import_jsx_runtime4.jsx)("tr", { children: f.map((s) => {
    var _a2;
    const v3 = a2.find((l2) => l2.id == s.id), E4 = `wx-print-cell-${t2}${d2(v3)}${s.filter ? " wx-print-cell-filter" : ""}${s.vertical ? " wx-vertical" : ""}`, C3 = s.cell;
    return (0, import_jsx_runtime4.jsx)(
      "th",
      {
        style: styleObject(de2(s, b5.columnWidth)),
        className: "wx-Gy81xq2u " + E4,
        rowSpan: s.rowspan,
        colSpan: s.colspan,
        children: C3 ? (0, import_jsx_runtime4.jsx)(
          C3,
          {
            api: u,
            cell: Object.fromEntries(
              Object.entries(s).filter(([l2]) => l2 !== "cell")
            ),
            column: v3,
            row: h
          }
        ) : s.filter ? (0, import_jsx_runtime4.jsx)("div", { className: "wx-Gy81xq2u wx-print-filter", children: he2(x2, a2, s) }) : (0, import_jsx_runtime4.jsx)("div", { className: "wx-Gy81xq2u wx-text", children: (_a2 = s.text) != null ? _a2 : "" })
      },
      s.id
    );
  }) }, h)) });
}
function Xn(n) {
  const { columns: e, rowStyle: t2, columnStyle: r, cellStyle: u, header: x2, footer: a2, reorder: b5 } = n, d2 = (0, import_react5.useContext)(oe4), { flatData: f, _sizes: h } = d2.getState(), s = x2 && ne2(e, "header", h.headerRowHeights), v3 = a2 && ne2(e, "footer", h.footerRowHeights);
  function E4(l2, m) {
    let g = "";
    return g += r ? " " + r(m) : "", g += u ? " " + u(l2, m) : "", g;
  }
  function C3(l2, m) {
    return typeof m.draggable == "function" ? m.draggable(l2, m) !== false : m.draggable;
  }
  return (0, import_jsx_runtime4.jsxs)(
    "table",
    {
      className: `wx-8NTMLH0z wx-print-grid ${e.some((l2) => l2.flexgrow) ? "wx-flex-columns" : ""}`,
      children: [
        x2 ? (0, import_jsx_runtime4.jsx)("thead", { children: (0, import_jsx_runtime4.jsx)(
          mt3,
          {
            columns: s,
            type: "header",
            columnStyle: r
          }
        ) }) : null,
        (0, import_jsx_runtime4.jsx)("tbody", { children: f.map((l2, m) => (0, import_jsx_runtime4.jsx)(
          "tr",
          {
            className: "wx-8NTMLH0z wx-row" + (t2 ? " " + t2(l2) : ""),
            style: { height: `${l2.rowHeight || h.rowHeight}px` },
            children: e.map(
              (g) => g.collapsed ? null : (0, import_jsx_runtime4.jsxs)(
                "td",
                {
                  className: `wx-8NTMLH0z wx-print-cell wx-cell ${E4(l2, g)}`,
                  style: styleObject(
                    de2(g, h.columnWidth)
                  ),
                  children: [
                    b5 && g.draggable ? (0, import_jsx_runtime4.jsx)("span", { className: "wx-8NTMLH0z wx-print-draggable", children: C3(l2, g) ? (0, import_jsx_runtime4.jsx)("i", { className: "wx-8NTMLH0z wxi-drag" }) : null }) : null,
                    g.treetoggle ? (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
                      (0, import_jsx_runtime4.jsx)(
                        "span",
                        {
                          style: { marginLeft: l2.$level * 28 + "px" }
                        }
                      ),
                      l2.$count ? (0, import_jsx_runtime4.jsx)(
                        "i",
                        {
                          className: `wx-8NTMLH0z wx-print-grid-tree-toggle wxi-menu-${l2.open !== false ? "down" : "right"}`
                        }
                      ) : null
                    ] }) : null,
                    g.cell ? (() => {
                      const w = g.cell;
                      return (0, import_jsx_runtime4.jsx)(w, { api: d2, row: l2, column: g });
                    })() : (0, import_jsx_runtime4.jsx)("span", { children: b2(l2, g) })
                  ]
                },
                g.id
              )
            )
          },
          m
        )) }),
        a2 ? (0, import_jsx_runtime4.jsx)("tfoot", { children: (0, import_jsx_runtime4.jsx)(
          mt3,
          {
            columns: v3,
            type: "footer",
            columnStyle: r
          }
        ) }) : null
      ]
    }
  );
}
function Yn(n) {
  const _a2 = n, { config: e } = _a2, t2 = __objRest(_a2, ["config"]), r = (0, import_react5.useContext)(oe4), { _skin: u, _columns: x2 } = r.getState(), a2 = (0, import_react5.useMemo)(() => re3(x2, e), []), b5 = (0, import_react5.useRef)(null);
  return (0, import_react5.useEffect)(() => {
    const d2 = document.body;
    d2.classList.add("wx-print");
    const f = b5.current;
    if (!f) return;
    const h = f.cloneNode(true);
    d2.appendChild(h);
    const s = `@media print { @page { size: ${e.paper} ${e.mode}; }`, v3 = document.createElement("style");
    v3.setAttribute("type", "text/css"), v3.setAttribute("media", "print"), document.getElementsByTagName("head")[0].appendChild(v3), v3.appendChild(document.createTextNode(s)), window.print(), v3.remove(), d2.classList.remove("wx-print"), h.remove();
  }, []), (0, import_jsx_runtime4.jsx)(
    "div",
    {
      className: `wx-4zwCKA7C wx-${u}-theme wx-print-container`,
      ref: b5,
      children: a2.map((d2, f) => (0, import_jsx_runtime4.jsx)("div", { className: "wx-4zwCKA7C wx-print-grid-wrapper", children: (0, import_jsx_runtime4.jsx)(Xn, __spreadValues({ columns: d2 }, t2)) }, f))
    }
  );
}
function jn(n) {
  const {
    header: e,
    footer: t2,
    overlay: r,
    multiselect: u,
    onreorder: x2,
    rowStyle: a2,
    columnStyle: b5,
    cellStyle: d2,
    autoRowHeight: f,
    resize: h,
    clientWidth: s,
    clientHeight: v3,
    responsiveLevel: E4,
    hotkeys: C3
  } = n, l2 = (0, import_react5.useContext)(oe4), m = useStore(l2, "dynamic"), g = useStore(l2, "_columns"), w = useStore(l2, "flatData"), y3 = useStore(l2, "split"), T4 = useStore(l2, "_sizes"), [D3, R5] = useStoreWithCounter(l2, "selectedRows"), i = useStore(l2, "select"), k4 = useStore(l2, "editor"), U6 = useStore(l2, "tree"), J7 = useStore(l2, "focusCell"), te5 = useStore(l2, "_print"), V4 = useStore(l2, "undo"), j4 = useStore(l2, "reorder"), H6 = useStore(l2, "_rowHeightFromData"), [$5, Ee4] = (0, import_react5.useState)(0);
  (0, import_react5.useEffect)(() => {
    Ee4(Pt2());
  }, []);
  const [ve3, _e4] = (0, import_react5.useState)(0), [ge4, Le3] = (0, import_react5.useState)(0), ce6 = (0, import_react5.useMemo)(() => (g || []).some((o2) => !o2.hidden && o2.flexgrow), [g]), P4 = (0, import_react5.useMemo)(() => (T4 == null ? void 0 : T4.rowHeight) || 0, [T4]), ee7 = (0, import_react5.useRef)(null), [He3, Ce5] = (0, import_react5.useState)(null), [pe5, Se4] = (0, import_react5.useState)(null), ne4 = (0, import_react5.useMemo)(() => {
    let o2 = [], p2 = 0;
    return y3 && y3.left && (o2 = (g || []).slice(0, y3.left).filter((N5) => !N5.hidden).map((N5) => __spreadValues({}, N5)), o2.forEach((N5) => {
      N5.fixed = { left: 1 }, N5.left = p2, p2 += N5.width;
    }), o2.length && (o2[o2.length - 1].fixed = { left: -1 })), { columns: o2, width: p2 };
  }, [y3, g]), _3 = (0, import_react5.useMemo)(() => {
    let o2 = [], p2 = 0;
    if (y3 && y3.right) {
      o2 = (g || []).slice(y3.right * -1).filter((N5) => !N5.hidden).map((N5) => __spreadValues({}, N5));
      for (let N5 = o2.length - 1; N5 >= 0; N5--) {
        const M2 = o2[N5];
        M2.fixed = { right: 1 }, M2.right = p2, p2 += M2.width;
      }
      o2.length && (o2[0].fixed = { right: -1 });
    }
    return { columns: o2, width: p2 };
  }, [y3, g]), B4 = (0, import_react5.useMemo)(() => {
    var _a2;
    const o2 = (g || []).slice((y3 == null ? void 0 : y3.left) || 0, (g || []).length - ((_a2 = y3 == null ? void 0 : y3.right) != null ? _a2 : 0)).filter((p2) => !p2.hidden);
    return o2.forEach((p2) => {
      p2.fixed = 0;
    }), o2;
  }, [g, y3]), z5 = (0, import_react5.useMemo)(() => (g || []).reduce((o2, p2) => (p2.hidden || (o2 += p2.width), o2), 0), [g]), ae5 = 1;
  function Me4(o2, p2, N5) {
    let M2 = p2, X5 = o2;
    if (B4.length) {
      let A3 = B4.length;
      for (let L5 = o2; L5 >= 0; L5--)
        B4[L5][N5].forEach((q4) => {
          q4.colspan > 1 && L5 > o2 - q4.colspan && L5 < A3 && (A3 = L5);
        });
      if (A3 !== B4.length && A3 < o2) {
        for (let L5 = A3; L5 < o2; L5++)
          M2 -= B4[L5].width;
        X5 = A3;
      }
    }
    return { index: X5, delta: M2 };
  }
  const re6 = (0, import_react5.useMemo)(() => {
    let o2, p2, N5;
    const M2 = ve3, X5 = ve3 + (s || 0);
    let A3 = 0, L5 = 0, Y4 = 0, q4 = 0;
    B4.forEach((fe4, Te3) => {
      M2 > Y4 && (A3 = Te3, q4 = Y4), Y4 = Y4 + fe4.width, X5 > Y4 && (L5 = Te3 + ae5);
    });
    const ie4 = { header: 0, footer: 0 };
    for (let fe4 = L5; fe4 >= A3; fe4--)
      ["header", "footer"].forEach((Te3) => {
        B4[fe4] && B4[fe4][Te3].forEach((Ft2) => {
          const qe3 = Ft2.colspan;
          if (qe3 && qe3 > 1) {
            const at4 = qe3 - (L5 - fe4 + 1);
            at4 > 0 && (ie4[Te3] = Math.max(ie4[Te3], at4));
          }
        });
      });
    const G5 = Me4(A3, q4, "header"), se5 = Me4(A3, q4, "footer"), Ue2 = G5.delta, $e4 = G5.index, ze5 = se5.delta, Oe4 = se5.index;
    return ce6 && z5 > (s || 0) ? o2 = p2 = N5 = [...ne4.columns, ...B4, ..._3.columns] : (o2 = [
      ...ne4.columns,
      ...B4.slice(A3, L5 + 1),
      ..._3.columns
    ], p2 = [
      ...ne4.columns,
      ...B4.slice($e4, L5 + ie4.header + 1),
      ..._3.columns
    ], N5 = [
      ...ne4.columns,
      ...B4.slice(Oe4, L5 + ie4.footer + 1),
      ..._3.columns
    ]), {
      data: o2 || [],
      header: p2 || [],
      footer: N5 || [],
      d: q4,
      df: ze5,
      dh: Ue2
    };
  }, [
    B4,
    ne4,
    _3,
    ve3,
    s,
    ce6,
    z5
  ]), me4 = (0, import_react5.useMemo)(
    () => e && (T4 == null ? void 0 : T4.headerHeight) || 0,
    [e, T4]
  ), ye4 = (0, import_react5.useMemo)(
    () => t2 && (T4 == null ? void 0 : T4.footerHeight) || 0,
    [t2, T4]
  ), we4 = (0, import_react5.useMemo)(() => s && v3 ? z5 >= s : false, [s, v3, z5]), Re5 = (0, import_react5.useMemo)(() => (v3 || 0) - me4 - ye4 - (we4 ? $5 : 0), [v3, me4, ye4, we4, $5]), tt3 = (0, import_react5.useMemo)(() => Math.ceil((Re5 || 0) / (P4 || 1)) + 1, [Re5, P4]), Fe4 = (0, import_react5.useRef)([]), [nt3, kt2] = (0, import_react5.useState)(0), [ot3, $t2] = (0, import_react5.useState)(void 0), le5 = (0, import_react5.useMemo)(() => {
    let o2 = 0, p2 = 0;
    const N5 = 2;
    if (f) {
      let A3 = ge4;
      for (; A3 > 0; )
        A3 -= Fe4.current[o2] || P4, o2++;
      p2 = ge4 - A3;
      for (let L5 = Math.max(0, o2 - N5 - 1); L5 < o2; L5++)
        p2 -= Fe4.current[o2 - L5] || P4;
      o2 = Math.max(0, o2 - N5);
    } else {
      if (H6) {
        let A3 = 0, L5 = 0;
        for (let G5 = 0; G5 < (w || []).length; G5++) {
          const se5 = w[G5].rowHeight || P4;
          if (L5 + se5 > ge4) {
            A3 = G5;
            break;
          }
          L5 += se5;
        }
        o2 = Math.max(0, A3 - N5);
        for (let G5 = 0; G5 < o2; G5++)
          p2 += w[G5].rowHeight || P4;
        let Y4 = 0, q4 = 0;
        for (let G5 = A3 + 1; G5 < (w || []).length; G5++) {
          const se5 = w[G5].rowHeight || P4;
          if (Y4++, q4 + se5 > Re5)
            break;
          q4 += se5;
        }
        const ie4 = Math.min(
          m ? m.rowCount : (w || []).length,
          A3 + Y4 + N5
        );
        return { d: p2, start: o2, end: ie4 };
      }
      o2 = Math.floor(ge4 / (P4 || 1)), o2 = Math.max(0, o2 - N5), p2 = o2 * (P4 || 0);
    }
    const M2 = m ? m.rowCount : (w || []).length, X5 = Math.min(M2, o2 + (tt3 || 0) + N5);
    return { d: p2, start: o2, end: X5 };
  }, [f, H6, ge4, P4, m, w, tt3, Re5]), Xe3 = (0, import_react5.useMemo)(() => {
    var _a2;
    const o2 = m ? m.rowCount : (w || []).length;
    if (f)
      return nt3 + le5.d + (o2 - (ot3 || 0)) * (P4 || 0);
    if (!H6)
      return o2 * (P4 || 0);
    let p2 = 0;
    for (let N5 = 0; N5 < o2; N5++)
      p2 += ((_a2 = w[N5]) == null ? void 0 : _a2.rowHeight) || P4;
    return p2;
  }, [
    m,
    w,
    P4,
    f,
    H6,
    nt3,
    le5.d,
    ot3
  ]), de3 = (0, import_react5.useMemo)(() => s && v3 ? Xe3 + me4 + ye4 >= v3 - (z5 >= (s || 0) ? $5 : 0) : false, [
    s,
    v3,
    Xe3,
    me4,
    ye4,
    z5,
    $5
  ]), be4 = (0, import_react5.useMemo)(() => ce6 && z5 <= (s || 0) ? (s || 0) - 0 - (de3 ? $5 : 0) : z5, [ce6, z5, s, de3, $5, we4]), Ye2 = (0, import_react5.useMemo)(() => ce6 && z5 <= (s || 0) ? s || 0 : be4 < (s || 0) ? z5 + (de3 ? $5 : 0) : -1, [ce6, z5, s, be4, de3, $5]), je3 = (0, import_react5.useRef)({});
  (0, import_react5.useEffect)(() => {
    if (m && (je3.current.start !== le5.start || je3.current.end !== le5.end)) {
      const { start: o2, end: p2 } = le5;
      je3.current = { start: o2, end: p2 }, l2 && l2.exec && l2.exec("request-data", { row: { start: o2, end: p2 } });
    }
  }, [m, le5, l2]);
  const ue4 = (0, import_react5.useMemo)(() => m ? w || [] : (w || []).slice(le5.start, le5.end), [m, w, le5]), ke4 = (0, import_react5.useMemo)(() => (D3 || []).filter(
    (o2) => (ue4 || []).some((p2) => p2.id === o2)
  ), [R5, ue4]), Be2 = (0, import_react5.useMemo)(() => le5.start, [le5.start]), Mt2 = (0, import_react5.useCallback)((o2) => {
    Le3(o2.target.scrollTop), _e4(o2.target.scrollLeft);
  }, []), At2 = (0, import_react5.useCallback)((o2) => {
    o2.shiftKey && o2.preventDefault(), ee7.current && ee7.current.focus && ee7.current.focus();
  }, []), rt3 = (0, import_react5.useCallback)(() => !!(g || []).find((o2) => !!o2.draggable), [g]), Ge3 = (0, import_react5.useRef)(null), Ne4 = (0, import_react5.useRef)(null), It3 = (0, import_react5.useRef)({
    dblclick: (o2, p2) => {
      const N5 = { id: o2, column: locateAttr(p2, "data-col-id") };
      l2.exec("open-editor", N5);
    },
    click: (o2, p2) => {
      if (Ge3.current) return;
      const N5 = locateAttr(p2, "data-col-id");
      if ((J7 == null ? void 0 : J7.id) !== o2 && l2.exec("focus-cell", {
        row: o2,
        column: N5,
        eventSource: "click"
      }), i === false) return;
      const M2 = u && p2.ctrlKey, X5 = u && p2.shiftKey;
      (M2 || D3.length > 1 || !D3.includes(o2)) && l2.exec("select-row", { id: o2, toggle: M2, range: X5 });
    },
    "toggle-row": (o2) => {
      const p2 = l2.getRow(o2);
      l2.exec(p2.open !== false ? "close-row" : "open-row", { id: o2 });
    },
    "ignore-click": () => false
  }), Ae3 = (0, import_react5.useMemo)(() => ({
    top: me4,
    bottom: ye4,
    left: ne4.width,
    xScroll: we4,
    yScroll: de3,
    sense: f && pe5 ? pe5.offsetHeight : Math.max((T4 == null ? void 0 : T4.rowHeight) || 0, 40),
    node: ee7.current && ee7.current.firstElementChild
  }), [
    me4,
    ye4,
    ne4.width,
    we4,
    de3,
    f,
    pe5,
    T4
  ]);
  function Vt3(o2, p2) {
    const { container: N5, sourceNode: M2, from: X5 } = p2;
    if (rt3() && !M2.getAttribute("draggable-data"))
      return false;
    Ce5(X5), l2.getRow(X5).open && l2.exec("close-row", { id: X5, nested: true });
    const L5 = locate(M2, "data-id"), Y4 = L5.cloneNode(true);
    Y4.classList.remove("wx-selected"), Y4.querySelectorAll("[tabindex]").forEach((se5) => se5.setAttribute("tabindex", "-1")), N5.appendChild(Y4), Se4(Y4);
    const q4 = ve3 - re6.d, ie4 = de3 ? $5 : 0;
    N5.style.width = Math.min(
      (s || 0) - ie4,
      ce6 && z5 <= (s || 0) ? be4 : be4 - ie4
    ) + q4 + "px";
    const G5 = Pe3(L5);
    p2.offset = {
      x: q4,
      y: -Math.round(G5.height / 2)
    }, Ne4.current || (Ne4.current = o2.clientY);
  }
  function zt3(o2, p2) {
    const { from: N5 } = p2, M2 = p2.pos, X5 = Pe3(ee7.current);
    M2.x = X5.x;
    const A3 = Ae3.top;
    if (M2.y < A3) M2.y = A3;
    else {
      const L5 = X5.height - (we4 && $5 > 0 ? $5 : Math.round(Ae3.sense / 2)) - Ae3.bottom;
      M2.y > L5 && (M2.y = L5);
    }
    if (ee7.current.contains(p2.targetNode)) {
      const L5 = locate(p2.targetNode, "data-id"), Y4 = id(L5 == null ? void 0 : L5.getAttribute("data-id"));
      if (Y4 && Y4 !== N5) {
        p2.to = Y4;
        const q4 = f ? pe5 == null ? void 0 : pe5.offsetHeight : T4 == null ? void 0 : T4.rowHeight;
        if (pe5 && (ge4 === 0 || M2.y > A3 + q4 - 1)) {
          const ie4 = L5.getBoundingClientRect(), se5 = Pe3(pe5).y, Ue2 = ie4.y, $e4 = se5 > Ue2 ? -1 : 1, ze5 = $e4 === 1 ? "after" : "before", Oe4 = Math.abs(l2.getRowIndex(N5) - l2.getRowIndex(Y4)), fe4 = Oe4 !== 1 ? ze5 === "before" ? "after" : "before" : ze5;
          if (Oe4 === 1 && ($e4 === -1 && o2.clientY > Ne4.current || $e4 === 1 && o2.clientY < Ne4.current))
            return;
          Ne4.current = o2.clientY, l2.exec("move-item", {
            id: N5,
            target: Y4,
            mode: fe4,
            inProgress: true
          });
        }
      }
      x2 && x2({ event: o2, context: p2 });
    }
    Nn(o2, X5, p2, Ae3);
  }
  function Ot3(o2, p2) {
    const { from: N5, to: M2 } = p2;
    l2.exec("move-item", {
      id: N5,
      target: M2,
      inProgress: false
    }), Ge3.current = setTimeout(() => {
      Ge3.current = 0;
    }, 1), Ce5(null), Se4(null), Ne4.current = null, Et3(p2);
  }
  function Pt2() {
    const o2 = document.createElement("div");
    o2.style.cssText = "position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;min-height:100px;overflow-y:scroll;", document.body.appendChild(o2);
    const p2 = o2.offsetWidth - o2.clientWidth;
    return document.body.removeChild(o2), p2;
  }
  const Kt3 = (0, import_react5.useMemo)(() => Ye2 > 0 ? { width: `${Ye2}px` } : void 0, [Ye2]), lt4 = (0, import_react5.useRef)(null);
  function Wt2() {
    Promise.resolve().then(() => {
      let o2 = 0, p2 = Be2;
      const N5 = lt4.current;
      N5 && (Array.from(N5.children).forEach((M2, X5) => {
        Fe4.current[Be2 + X5] = M2.offsetHeight, o2 += M2.offsetHeight, p2++;
      }), kt2(o2), $t2(p2));
    });
  }
  (0, import_react5.useEffect)(() => {
    ue4 && f && Wt2();
  }, [ue4, f, Be2]);
  let [De5, Ie5] = (0, import_react5.useState)();
  (0, import_react5.useEffect)(() => {
    if (J7 && (!i || !ke4.length || ke4.includes(J7.row)))
      Ie5(__spreadValues({}, J7));
    else if (ue4.length && re6.data.length) {
      if (!De5 || ke4.length && !ke4.includes(De5.row) || ue4.findIndex((o2) => o2.id == De5.row) === -1 || re6.data.findIndex(
        (o2) => o2.id == De5.column && !o2.collapsed
      ) === -1) {
        const o2 = ke4[0] || ue4[0].id, p2 = re6.data.findIndex((N5) => !N5.collapsed);
        Ie5(p2 !== -1 ? { row: o2, column: re6.data[p2].id } : null);
      }
    } else Ie5(null);
  }, [J7]);
  const st3 = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    const o2 = ee7.current;
    if (!o2) return;
    const p2 = yn2(o2, h);
    return () => {
      typeof p2 == "function" && p2();
    };
  }, [h]);
  const it3 = (0, import_react5.useRef)({});
  Object.assign(it3.current, {
    start: Vt3,
    move: zt3,
    end: Ot3,
    getReorder: () => j4,
    getDraggableInfo: () => ({ hasDraggable: rt3() })
  }), (0, import_react5.useEffect)(() => {
    const o2 = ee7.current;
    return o2 ? Cn2(o2, it3).destroy : void 0;
  }, [j4, ee7.current]), (0, import_react5.useEffect)(() => {
    const o2 = ee7.current;
    return o2 ? Pe2(o2, {
      keys: C3 !== false && __spreadValues(__spreadProps(__spreadValues({}, Me3), {
        "ctrl+z": V4,
        "ctrl+y": V4
      }), C3),
      exec: (N5) => l2.exec("hotkey", N5)
    }).destroy : void 0;
  }, [l2, V4, C3]);
  const Ve3 = (0, import_react5.useRef)({
    scroll: l2.getReactiveState().scroll
  });
  Ve3.current.getWidth = () => (s || 0) - (de3 ? $5 : 0), Ve3.current.getHeight = () => Re5, Ve3.current.getScrollMargin = () => ne4.width + _3.width, (0, import_react5.useEffect)(() => {
    ze3(st3.current, Ve3.current);
  }, []);
  const ct4 = (0, import_react5.useRef)(null);
  (0, import_react5.useEffect)(() => {
    const o2 = ct4.current;
    if (!o2) return;
    const p2 = [];
    return p2.push(
      clickOutside(o2, () => l2.exec("focus-cell", { eventSource: "click" })).destroy
    ), p2.push(delegateClick2(o2, It3.current)), () => p2.forEach((N5) => N5());
  }, []);
  const _t3 = `wx-grid ${E4 ? `wx-responsive-${E4}` : ""}`;
  return (0, import_jsx_runtime4.jsxs)(import_jsx_runtime4.Fragment, { children: [
    (0, import_jsx_runtime4.jsx)(
      "div",
      {
        className: "wx-4VuBwK2D " + _t3,
        style: {
          "--header-height": `${me4}px`,
          "--footer-height": `${ye4}px`,
          "--split-left-width": `${ne4.width}px`,
          "--split-right-width": `${_3.width}px`
        },
        children: (0, import_jsx_runtime4.jsx)(
          "div",
          {
            ref: ee7,
            className: "wx-4VuBwK2D wx-table-box",
            style: Kt3,
            role: U6 ? "treegrid" : "grid",
            "aria-colcount": re6.data.length,
            "aria-rowcount": ue4.length,
            "aria-multiselectable": U6 && u ? true : void 0,
            tabIndex: -1,
            children: (0, import_jsx_runtime4.jsxs)(
              "div",
              {
                ref: st3,
                className: "wx-4VuBwK2D wx-scroll",
                style: {
                  overflowX: we4 ? "scroll" : "hidden",
                  overflowY: de3 ? "scroll" : "hidden"
                },
                onScroll: Mt2,
                children: [
                  e ? (0, import_jsx_runtime4.jsx)("div", { className: "wx-4VuBwK2D wx-header-wrapper", children: (0, import_jsx_runtime4.jsx)(
                    xt3,
                    {
                      contentWidth: be4,
                      deltaLeft: re6.dh,
                      columns: re6.header,
                      columnStyle: b5,
                      bodyHeight: Re5 - +t2
                    }
                  ) }) : null,
                  (0, import_jsx_runtime4.jsxs)(
                    "div",
                    {
                      ref: ct4,
                      className: "wx-4VuBwK2D wx-body",
                      style: { width: `${be4}px`, height: `${Xe3}px` },
                      onMouseDown: (o2) => At2(o2),
                      children: [
                        r ? (0, import_jsx_runtime4.jsx)(zn, { overlay: r }) : null,
                        (0, import_jsx_runtime4.jsx)(
                          "div",
                          {
                            ref: lt4,
                            className: "wx-4VuBwK2D wx-data",
                            style: {
                              paddingTop: `${le5.d}px`,
                              paddingLeft: `${re6.d}px`
                            },
                            children: ue4.map((o2, p2) => {
                              const N5 = D3.indexOf(o2.id) !== -1, M2 = He3 === o2.id, X5 = "wx-row" + (f ? " wx-autoheight" : "") + (a2 ? " " + a2(o2) : "") + (N5 ? " wx-selected" : "") + (M2 ? " wx-inactive" : ""), A3 = f ? { minHeight: `${o2.rowHeight || P4}px` } : { height: `${o2.rowHeight || P4}px` };
                              return (0, import_jsx_runtime4.jsx)(
                                "div",
                                {
                                  className: "wx-4VuBwK2D " + X5,
                                  "data-id": o2.id,
                                  "data-context-id": o2.id,
                                  style: A3,
                                  role: "row",
                                  "aria-rowindex": p2,
                                  "aria-expanded": o2.open,
                                  "aria-level": U6 ? o2.$level + 1 : void 0,
                                  "aria-selected": U6 ? N5 : void 0,
                                  tabIndex: -1,
                                  children: re6.data.map((L5) => L5.collapsed ? (0, import_jsx_runtime4.jsx)(
                                    "div",
                                    {
                                      className: "wx-4VuBwK2D wx-cell wx-collapsed"
                                    },
                                    L5.id
                                  ) : (k4 == null ? void 0 : k4.id) === o2.id && k4.column == L5.id ? (0, import_jsx_runtime4.jsx)(Fn, { row: o2, column: L5 }, L5.id) : (0, import_jsx_runtime4.jsx)(
                                    Hn,
                                    {
                                      row: o2,
                                      column: L5,
                                      columnStyle: b5,
                                      cellStyle: d2,
                                      reorder: j4,
                                      focusable: (De5 == null ? void 0 : De5.row) === o2.id && (De5 == null ? void 0 : De5.column) == L5.id
                                    },
                                    L5.id
                                  ))
                                },
                                o2.id
                              );
                            })
                          }
                        )
                      ]
                    }
                  ),
                  t2 && (w || []).length ? (0, import_jsx_runtime4.jsx)(
                    xt3,
                    {
                      type: "footer",
                      contentWidth: be4,
                      deltaLeft: re6.df,
                      columns: re6.footer,
                      columnStyle: b5
                    }
                  ) : null
                ]
              }
            )
          }
        )
      }
    ),
    te5 ? (0, import_jsx_runtime4.jsx)(
      Yn,
      {
        config: te5,
        rowStyle: a2,
        columnStyle: b5,
        cellStyle: d2,
        header: e,
        footer: t2,
        reorder: j4
      }
    ) : null
  ] });
}
var Bn = (n) => n.split("-").map((e) => e ? e.charAt(0).toUpperCase() + e.slice(1) : "").join("");
var lo = (0, import_react5.forwardRef)(function(_a2, J7) {
  var _b = _a2, {
    data: e = [],
    columns: t2 = [],
    rowStyle: r = null,
    columnStyle: u = null,
    cellStyle: x2 = null,
    selectedRows: a2,
    select: b5 = true,
    multiselect: d2 = false,
    header: f = true,
    footer: h = false,
    dynamic: s = null,
    overlay: v3 = null,
    reorder: E4 = false,
    onReorder: C3 = null,
    autoRowHeight: l2 = false,
    sizes: m,
    split: g,
    tree: w = false,
    autoConfig: y3 = false,
    init: T4 = null,
    responsive: D3 = null,
    sortMarks: R5,
    undo: i = false,
    hotkeys: k4 = null
  } = _b, U6 = __objRest(_b, [
    "data",
    "columns",
    "rowStyle",
    "columnStyle",
    "cellStyle",
    "selectedRows",
    "select",
    "multiselect",
    "header",
    "footer",
    "dynamic",
    "overlay",
    "reorder",
    "onReorder",
    "autoRowHeight",
    "sizes",
    "split",
    "tree",
    "autoConfig",
    "init",
    "responsive",
    "sortMarks",
    "undo",
    "hotkeys"
  ]);
  const te5 = (0, import_react5.useRef)();
  te5.current = U6;
  const V4 = (0, import_react5.useMemo)(() => new Re3(writable), []), j4 = (0, import_react5.useMemo)(() => V4.in, [V4]), H6 = (0, import_react5.useRef)(null);
  H6.current === null && (H6.current = new EventBusRouter((_3, B4) => {
    const z5 = "on" + Bn(_3);
    te5.current && te5.current[z5] && te5.current[z5](B4);
  }), j4.setNext(H6.current));
  const $5 = (0, import_react5.useMemo)(
    () => ({
      getState: V4.getState.bind(V4),
      getReactiveState: V4.getReactive.bind(V4),
      getStores: () => ({ data: V4 }),
      exec: j4.exec,
      setNext: (_3) => (H6.current = H6.current.setNext(_3), H6.current),
      intercept: j4.intercept.bind(j4),
      on: j4.on.bind(j4),
      detach: j4.detach.bind(j4),
      getRow: V4.getRow.bind(V4),
      getRowIndex: V4.getRowIndex.bind(V4),
      getColumn: V4.getColumn.bind(V4)
    }),
    [V4, j4]
  ), [Ee4, ve3] = (0, import_react5.useState)(0), [_e4, ge4] = (0, import_react5.useState)(0), [Le3, ce6] = (0, import_react5.useState)(null), [P4, ee7] = (0, import_react5.useState)(null), He3 = (0, import_react5.useMemo)(() => {
    var _a3;
    if (y3 && !t2.length && e.length) {
      const _3 = e[0], B4 = [];
      for (let z5 in _3)
        if (z5 !== "id" && z5[0] !== "$") {
          let ae5 = {
            id: z5,
            header: z5[0].toUpperCase() + z5.slice(1)
          };
          typeof y3 == "object" && (ae5 = __spreadValues(__spreadValues({}, ae5), y3)), B4.push(ae5);
        }
      return B4;
    }
    return (_a3 = P4 && P4.columns) != null ? _a3 : t2;
  }, [y3, t2, e, P4]), Ce5 = (0, import_react5.useMemo)(
    () => {
      var _a3;
      return (_a3 = P4 && P4.sizes) != null ? _a3 : m;
    },
    [P4, m]
  ), pe5 = (0, import_react5.useCallback)(
    (_3) => {
      var _a3;
      if (ve3(_3.width), ge4(_3.height), D3) {
        const z5 = (_a3 = Object.keys(D3).map(Number).sort((ae5, Me4) => ae5 - Me4).find((ae5) => _3.width <= ae5)) != null ? _a3 : null;
        z5 !== Le3 && (ee7(D3[z5]), ce6(z5));
      }
    },
    [D3, Le3]
  ), Se4 = (0, import_react5.useContext)(Dt.theme), ne4 = (0, import_react5.useRef)(0);
  return (0, import_react5.useEffect)(() => {
    if (!ne4.current)
      T4 && T4($5);
    else {
      const _3 = V4.getState();
      V4.init({
        data: e,
        columns: He3,
        split: g || _3.split,
        sizes: Ce5 || _3.sizes,
        selectedRows: a2 || _3.selectedRows,
        dynamic: s,
        tree: w,
        sortMarks: R5 || _3.sortMarks,
        undo: i,
        reorder: E4,
        _skin: Se4,
        _select: b5
      });
    }
    ne4.current++;
  }, [
    V4,
    e,
    He3,
    g,
    Ce5,
    a2,
    s,
    w,
    R5,
    i,
    E4,
    Se4,
    b5,
    T4,
    $5
  ]), ne4.current === 0 && V4.init({
    data: e,
    columns: He3,
    split: g || { left: 0 },
    sizes: Ce5 || {},
    selectedRows: a2 || [],
    dynamic: s,
    tree: w,
    sortMarks: R5 || {},
    undo: i,
    reorder: E4,
    _skin: Se4,
    select: b5
  }), (0, import_react5.useImperativeHandle)(
    J7,
    () => __spreadValues({}, $5),
    [$5]
  ), (0, import_jsx_runtime4.jsx)(oe4.Provider, { value: $5, children: (0, import_jsx_runtime4.jsx)(ue, { words: en_default3, optional: true, children: (0, import_jsx_runtime4.jsx)(
    jn,
    {
      header: f,
      footer: h,
      overlay: v3,
      rowStyle: r,
      columnStyle: u,
      cellStyle: x2,
      onReorder: C3,
      multiselect: d2,
      autoRowHeight: l2,
      clientWidth: Ee4,
      clientHeight: _e4,
      responsiveLevel: Le3,
      resize: pe5,
      hotkeys: k4
    }
  ) }) });
});
function Gn({ item: n }) {
  return (0, import_jsx_runtime4.jsxs)(
    "div",
    {
      tabIndex: -1,
      role: "menuitem",
      "aria-label": n.hidden ? `Show ${n.text} column` : `Hide ${n.text} column`,
      children: [
        (0, import_jsx_runtime4.jsx)(
          "div",
          {
            className: "wx-v13lZxja wx-icon" + (n.hidden ? " wx-hidden" : ""),
            children: (0, import_jsx_runtime4.jsx)("i", { className: "wx-v13lZxja wxi-eye" })
          }
        ),
        (0, import_jsx_runtime4.jsx)("span", { children: n.text })
      ]
    }
  );
}
function so({ columns: n = null, api: e, children: t2 }) {
  (0, import_react5.useEffect)(() => {
    st2("table-header", Gn);
  }, []);
  function r(d2) {
    for (let f = d2.header.length - 1; f >= 0; f--) {
      const h = d2.header[f].text;
      if (h) return h;
    }
    return d2.id;
  }
  function u(d2) {
    const f = d2.action;
    f && e.exec("hide-column", { id: f.id, mode: !f.hidden });
  }
  function x2(d2) {
    return d2;
  }
  const a2 = useStoreLater(e, "_columns"), b5 = (0, import_react5.useMemo)(() => {
    if (e) {
      const d2 = Array.isArray(a2) ? a2 : [];
      return (n ? d2.filter((h) => n[h.id]) : d2).map((h) => {
        const s = r(h);
        return {
          id: h.id,
          text: s,
          type: "table-header",
          hidden: h.hidden
        };
      });
    } else
      return [];
  }, [e, n, a2]);
  return (0, import_jsx_runtime4.jsx)(
    ct2,
    {
      dataKey: "headerId",
      options: b5,
      onClick: u,
      at: "point",
      resolver: x2,
      children: typeof t2 == "function" ? t2() : t2
    }
  );
}
setEnv(env);

// node_modules/@svar-ui/react-gantt/dist/index.es.js
var import_react_dom2 = __toESM(require_react_dom());

// node_modules/@svar-ui/react-editor/dist/index.es.js
var import_jsx_runtime5 = __toESM(require_jsx_runtime());
var import_react6 = __toESM(require_react());
var ee5 = {};
function ce5(t2) {
  return typeof t2 < "u" ? ee5[t2] || t2 : ee5.text;
}
function z4(t2, e) {
  ee5[t2] = e;
}
var me3 = {
  editor: {}
};
function F3(t2) {
  const {
    editors: e,
    data: o2,
    css: l2 = "",
    errors: r,
    focus: u = false,
    onClick: n,
    children: s,
    onChange: c2
  } = t2, m = (0, import_react6.useRef)(null);
  (0, import_react6.useEffect)(() => {
    if (u) {
      const f = document.activeElement;
      if (f && m.current && m.current.contains(f)) return;
      const p2 = m.current ? m.current.querySelector(
        "input:not([disabled]), textarea:not([disabled]), select:not([disabled])"
      ) : null;
      p2 && setTimeout(() => {
        typeof p2.select == "function" && p2.select(), typeof p2.focus == "function" && p2.focus();
      }, 300);
    }
  }, []);
  const i = (0, import_react6.useContext)(Dt.i18n), y3 = (0, import_react6.useMemo)(() => i.getGroup("editor"), [i]), g = (0, import_react6.useMemo)(
    () => e.config[0].comp === "readonly" && e.config.every((f) => !Object.keys(o2).includes(f.key)),
    [e, o2]
  );
  return (0, import_jsx_runtime5.jsxs)("div", { className: "wx-s2aE1xdZ wx-sections " + l2, ref: m, children: [
    s,
    g ? (0, import_jsx_runtime5.jsx)("div", { className: "wx-s2aE1xdZ wx-overlay", children: y3("No data") }) : null,
    e.config.map((f) => {
      var _b;
      if (!f.hidden) {
        const _a2 = f, { key: p2, onChange: k4 } = _a2, b5 = __objRest(_a2, ["key", "onChange"]);
        if (f.comp === "readonly" || f.comp === "section") {
          const N5 = ce5(f.comp);
          return (0, import_jsx_runtime5.jsx)(
            N5,
            __spreadProps(__spreadValues({
              fieldKey: p2,
              label: f.label,
              value: o2[p2]
            }, b5), {
              onClick: n
            }),
            p2
          );
        } else {
          const N5 = ce5(f.comp);
          return (0, import_jsx_runtime5.jsxs)("div", { children: [
            (0, import_jsx_runtime5.jsx)(
              ye,
              {
                label: f.labelTemplate ? f.labelTemplate(o2[p2]) : (_b = f.label) != null ? _b : "",
                required: f.required,
                children: (0, import_jsx_runtime5.jsx)(
                  N5,
                  __spreadProps(__spreadValues({
                    fieldKey: p2
                  }, b5), {
                    onChange: k4 || ((E4) => {
                      c2 && c2({
                        value: E4.value,
                        key: p2,
                        input: E4.input
                      });
                    }),
                    label: void 0,
                    error: r && r[p2],
                    value: o2[p2]
                  }),
                  p2
                )
              }
            ),
            r && r[p2] && f.validationMessage ? (0, import_jsx_runtime5.jsx)("div", { className: "wx-s2aE1xdZ wx-message", children: f.validationMessage }) : null
          ] }, p2);
        }
      }
      return null;
    })
  ] });
}
function Ve2(t2) {
  if (typeof t2 == "string" && t2.includes(".")) {
    const e = t2.split(".");
    return (o2) => {
      let l2 = o2;
      return e.forEach((r) => {
        l2 = l2[r];
      }), l2;
    };
  }
  return (e) => e[t2];
}
function De3(t2) {
  if (typeof t2 == "string" && t2.includes(".")) {
    const e = t2.split(".");
    return (o2, l2) => {
      let r = o2;
      e.forEach((u, n) => {
        n === e.length - 1 ? r[u] = l2 : r = r[u];
      });
    };
  }
  return (e, o2) => e[t2] = o2;
}
function $e3(t2) {
  const e = t2.map((n) => {
    const s = __spreadValues({}, n);
    return n.config && Object.assign(s, n.config), s.key = n.key || uid2(), s.setter = n.setter || De3(n.key), s.getter = n.getter || Ve2(n.key), s;
  }), o2 = (n) => {
    const s = {};
    return e.forEach((c2) => {
      c2.comp !== "section" && (c2.getter ? s[c2.key] = c2.getter(n) : s[c2.key] = n[c2.key]);
    }), s;
  }, l2 = (n, s, c2) => ((c2.length ? c2.map((i) => e.find((y3) => y3.key === i)) : e).forEach((i) => {
    i.setter ? i.setter(n, s[i.key]) : n[i.key] = s[i.key];
  }), n), r = (n, s) => {
    const c2 = o2(n), m = [];
    return e.forEach((i) => {
      const y3 = c2[i.key], g = s[i.key];
      !isSame(y3, g) && (y3 !== void 0 || g) && m.push(i.key);
    }), m;
  }, u = (n, s, c2) => {
    let m = 0;
    const i = {};
    return ((s == null ? void 0 : s.length) ? s.map((g) => e.find((f) => f.key === g)) : e).forEach((g) => {
      var _a2, _b;
      g.required && !n[g.key] ? (i[g.key] = {
        errorType: "required"
      }, g.validationMessage = (_a2 = g.validationMessage) != null ? _a2 : c2("This field is required"), m++) : g.validation && !g.validation(n[g.key]) && (i[g.key] = {
        errorType: "validation"
      }, g.validationMessage = (_b = g.validationMessage) != null ? _b : c2("Invalid value"), m++);
    }), m > 0 ? i : null;
  };
  return {
    config: e.filter((n) => n.comp !== "hidden"),
    getValues: o2,
    setValues: l2,
    diff: r,
    validateValues: u
  };
}
function pe4({
  values: t2,
  items: e,
  css: o2,
  activeBatch: l2,
  autoSave: r,
  focus: u,
  readonly: n,
  topBar: s = true,
  bottomBar: c2 = true,
  layout: m = "default",
  placement: i = "inline",
  view: y3,
  children: g,
  onChange: f,
  onSave: p2,
  onAction: k4,
  onValidation: b5,
  hotkeys: N5
}) {
  const $5 = (0, import_react6.useContext)(Dt.i18n).getGroup("editor"), [v3, V4] = useWritableProp(t2), [O4, B4] = (0, import_react6.useState)(null), S4 = (0, import_react6.useMemo)(() => {
    const h = $e3(e);
    O4 && h.config.forEach((d2) => {
      d2.comp === "section" && d2.key === O4 && (d2.sectionMode === "accordion" ? d2.activeSection || (h.config.forEach((D3) => {
        D3.comp === "section" && D3.key !== d2.key && (D3.activeSection = false);
      }), d2.activeSection = true) : d2.activeSection = !d2.activeSection);
    });
    let C3 = /* @__PURE__ */ new Set(), j4 = null;
    return h.config.forEach((d2) => {
      d2.sectionMode === "exclusive" && d2.activeSection && (j4 = d2.key), d2.activeSection && C3.add(d2.key);
    }), h.config.forEach((d2) => {
      d2.hidden = d2.hidden || l2 && l2 !== d2.batch || j4 && d2.key != j4 && d2.section !== j4 || d2.section && !C3.has(d2.section);
    }), n ? __spreadProps(__spreadValues({}, h), {
      config: h.config.map((d2) => __spreadProps(__spreadValues({}, d2), { comp: "readonly" })),
      diff: () => []
    }) : h;
  }, [e, O4, l2, n]), [M2, w] = (0, import_react6.useState)({}), [A3, W4] = (0, import_react6.useState)({}), x2 = v3;
  (0, import_react6.useEffect)(() => {
    v3 !== void 0 && (w(deepCopy(v3)), W4(deepCopy(v3)), x2.errors && (x2.errors = K6()));
  }, [v3]);
  const [q4, I6] = (0, import_react6.useState)([]);
  (0, import_react6.useEffect)(() => {
    v3 && I6([]);
  }, [v3]);
  function te5(h) {
    return [...new Set(h)];
  }
  function K6(h) {
    const C3 = S4.validateValues(M2, h, $5);
    return isSame(C3, x2.errors) || b5 && b5({ errors: C3, values: M2 }), C3;
  }
  function he3(h, C3) {
    if (r && !x2.errors) {
      const j4 = S4.setValues(v3, C3 != null ? C3 : A3, h);
      V4(j4), p2 && p2({ changes: h, values: j4 });
    } else
      I6(h);
  }
  function ge4({ value: h, key: C3, input: j4 }) {
    var _a2, _b;
    let d2 = __spreadProps(__spreadValues({}, A3 || {}), { [C3]: h });
    const D3 = {
      key: C3,
      value: h,
      update: d2
    };
    if (j4 && (D3.input = j4), f && f(D3), !v3) return;
    d2 = D3.update, W4(d2);
    const G5 = S4.diff(v3, d2), ye4 = S4.setValues(
      __spreadValues({}, M2 || {}),
      d2,
      te5([...G5, C3])
    );
    if (w(ye4), G5.length) {
      const P4 = r ? [] : te5([...G5, ...Object.keys((_a2 = x2.errors) != null ? _a2 : {}), C3]);
      x2.errors = K6(P4), he3(G5, d2);
    } else {
      const P4 = Object.keys((_b = x2.errors) != null ? _b : {});
      P4.length && (x2.errors = K6(P4)), I6([]);
    }
  }
  function we4() {
    if (q4.length && (r || (x2.errors = K6()), !x2.errors)) {
      p2 && p2({
        changes: q4,
        values: M2
      });
      const h = S4.setValues(v3, A3, q4);
      V4(h), I6([]), V4(__spreadValues({}, M2));
    }
  }
  function ne4({ item: h }) {
    h.id === "save" ? we4() : h.id === "toggle-section" && B4(h.key), k4 && k4({ item: h, values: M2, changes: q4 });
  }
  return (0, import_jsx_runtime5.jsx)(
    y3,
    {
      topBar: s,
      bottomBar: c2,
      placement: i,
      layout: m,
      readonly: n,
      autoSave: r,
      css: o2,
      data: A3,
      editors: S4,
      focus: u,
      hotkeys: N5,
      errors: x2.errors,
      onClick: ne4,
      onKeyDown: ne4,
      onChange: ge4,
      children: g
    }
  );
}
function Oe3(t2) {
  const { editors: e, data: o2, layout: l2, errors: r, focus: u, onClick: n, onChange: s } = t2, c2 = (0, import_react6.useMemo)(() => {
    let m = [];
    if (l2 === "columns" && (m = [
      __spreadProps(__spreadValues({}, e), { config: [] }),
      __spreadProps(__spreadValues({}, e), { config: [] })
    ], e.config.forEach((i) => {
      const y3 = i.column === "left" ? 0 : 1;
      m[y3].config.push(i);
    }), m[0].config.length)) {
      const i = m[0].config[0];
      i.comp === "text" && (m[0][0] = __spreadProps(__spreadValues({}, i), {
        css: "title",
        label: ""
      }));
    }
    return m;
  }, [l2, e]);
  return l2 === "columns" ? (0, import_jsx_runtime5.jsxs)("div", { className: "wx-bNrSbszs wx-cols", children: [
    (0, import_jsx_runtime5.jsx)("div", { className: "wx-bNrSbszs wx-left", children: (0, import_jsx_runtime5.jsx)(
      F3,
      {
        editors: c2[0],
        data: o2,
        errors: r,
        onClick: n,
        onChange: s
      }
    ) }),
    (0, import_jsx_runtime5.jsx)("div", { className: "wx-bNrSbszs wx-right", children: (0, import_jsx_runtime5.jsx)(
      F3,
      {
        editors: c2[1],
        data: o2,
        focus: u,
        errors: r,
        onClick: n,
        onChange: s
      }
    ) })
  ] }) : (0, import_jsx_runtime5.jsx)(
    F3,
    {
      editors: e,
      data: o2,
      focus: u,
      errors: r,
      onClick: n,
      onChange: s
    }
  );
}
function le4({
  items: t2,
  values: e = null,
  top: o2 = true,
  onClick: l2,
  onChange: r
}) {
  const u = (0, import_react6.useCallback)(
    ({ item: n, value: s }) => {
      r && r({ key: n.key, value: s });
    },
    [r]
  );
  return t2.length ? (0, import_jsx_runtime5.jsx)(
    "div",
    {
      className: `wx-66OW1j0R wx-editor-toolbar ${o2 ? "wx-topbar" : "wx-bottom"}`,
      children: (0, import_jsx_runtime5.jsx)(
        pe3,
        {
          items: t2,
          values: e,
          onClick: l2,
          onChange: u
        }
      )
    }
  ) : null;
}
var H5 = () => ({ comp: "spacer" });
var L4 = (t2) => ({
  comp: "button",
  text: t2("Cancel"),
  id: "cancel"
});
var Q5 = (t2) => ({
  type: "primary",
  comp: "button",
  text: t2("Save"),
  id: "save"
});
var ae4 = () => ({
  comp: "icon",
  icon: "wxi-close",
  id: "close"
});
function Y3(t2) {
  const {
    data: e,
    editors: o2,
    focus: l2,
    css: r,
    topBar: u,
    bottomBar: n,
    layout: s,
    placement: c2,
    errors: m,
    readonly: i,
    autoSave: y3,
    children: g,
    onClick: f,
    onKeyDown: p2,
    onChange: k4,
    hotkeys: b5
  } = t2, N5 = (0, import_react6.useContext)(Dt.i18n), E4 = (0, import_react6.useMemo)(() => N5.getGroup("editor"), [N5]), $5 = (0, import_react6.useMemo)(
    () => u === true && n === true,
    [u, n]
  ), v3 = (0, import_react6.useMemo)(() => {
    let w = u && u.items ? u.items.map((A3) => __spreadValues({}, A3)) : [];
    return $5 && (i ? w = [H5(), ae4()] : (y3 ? w = [H5(), ae4()] : c2 !== "modal" && (w = [H5(), L4(E4), Q5(E4)]), s === "columns" && !w.length && (w = [H5(), Q5(E4), L4(E4)]))), w;
  }, [u, $5, i, y3, c2, s, E4]), V4 = (0, import_react6.useMemo)(() => {
    let w = n && n.items ? n.items.map((A3) => __spreadValues({}, A3)) : [];
    return $5 && (i || (c2 === "modal" && !y3 && (w = [H5(), Q5(E4), L4(E4)]), s === "columns" && v3.length && (w = []))), w;
  }, [n, $5, i, c2, y3, s, v3, E4]), O4 = (0, import_react6.useMemo)(() => [...v3, ...V4], [v3, V4]), B4 = (0, import_react6.useRef)(null), S4 = (0, import_react6.useRef)(null);
  S4.current = (w, ...A3) => {
    const W4 = O4.findIndex((I6) => A3.includes(I6.id));
    if (W4 === -1) return false;
    const x2 = w.target, q4 = O4[W4];
    w.key == "Escape" && (x2.closest(".wx-combo") || x2.closest(".wx-multicombo") || x2.closest(".wx-richselect")) || w.key == "Delete" && (x2.tagName === "INPUT" || x2.tagName === "TEXTAREA") || (w.preventDefault(), p2 && p2({ item: q4 }));
  };
  const M2 = (0, import_react6.useMemo)(() => b5 === false ? {} : __spreadValues({
    "ctrl+s": (w) => S4.current(w, "save"),
    escape: (w) => S4.current(w, "cancel", "close"),
    "ctrl+d": (w) => S4.current(w, "delete")
  }, b5 || {}), [b5]);
  return useHotkeys(M2, B4), (0, import_jsx_runtime5.jsxs)("div", { className: r ? "wx-85HDaNoA " + r : "wx-85HDaNoA", ref: B4, children: [
    (0, import_jsx_runtime5.jsx)(
      le4,
      __spreadProps(__spreadValues({}, u && typeof u == "object" ? u : {}), {
        items: v3,
        values: e,
        onClick: f,
        onChange: k4
      })
    ),
    (0, import_jsx_runtime5.jsxs)(
      "div",
      {
        className: `wx-85HDaNoA wx-content${s === "columns" ? " wx-layout-columns" : ""}`,
        children: [
          g,
          (0, import_jsx_runtime5.jsx)(
            Oe3,
            {
              editors: o2,
              layout: s,
              data: e,
              focus: l2,
              errors: m,
              onClick: f,
              onChange: k4
            }
          ),
          (0, import_jsx_runtime5.jsx)(
            le4,
            __spreadProps(__spreadValues({}, n && typeof n == "object" ? n : {}), {
              items: V4,
              values: e,
              top: false,
              onClick: f,
              onChange: k4
            })
          )
        ]
      }
    )
  ] });
}
function qe2(t2) {
  const _a2 = t2, { css: e, onClick: o2, placement: l2 } = _a2, r = __objRest(_a2, ["css", "onClick", "placement"]);
  function u() {
    o2 && o2({ item: { id: "close" } });
  }
  return l2 === "modal" ? (0, import_jsx_runtime5.jsx)(Qt, { children: (0, import_jsx_runtime5.jsx)(
    Y3,
    __spreadValues({
      css: `wx-panel ${e}`,
      onClick: o2,
      placement: l2
    }, r)
  ) }) : l2 === "sidebar" ? (0, import_jsx_runtime5.jsx)(_t, { onCancel: u, children: (0, import_jsx_runtime5.jsx)(
    Y3,
    __spreadValues({
      css: `wx-panel ${e}`,
      onClick: o2,
      placement: l2
    }, r)
  ) }) : (0, import_jsx_runtime5.jsx)(
    Y3,
    __spreadValues({
      css: `wx-inline-form ${e}`,
      onClick: o2,
      placement: l2
    }, r)
  );
}
function Fe3(t2) {
  const _a2 = t2, {
    values: e = {},
    items: o2 = [],
    css: l2 = "",
    activeBatch: r = null,
    topBar: u = true,
    bottomBar: n = true,
    focus: s = false,
    autoSave: c2 = false,
    layout: m = "default",
    readonly: i = false,
    placement: y3 = "inline",
    children: g
  } = _a2, f = __objRest(_a2, [
    "values",
    "items",
    "css",
    "activeBatch",
    "topBar",
    "bottomBar",
    "focus",
    "autoSave",
    "layout",
    "readonly",
    "placement",
    "children"
  ]), p2 = Object.keys(f).reduce((k4, b5) => {
    if (/^on[a-z]/.test(b5)) {
      const N5 = "on" + b5.charAt(2).toUpperCase() + b5.slice(3);
      N5 in f ? k4[b5] = f[b5] : k4[N5] = f[b5];
    } else
      k4[b5] = f[b5];
    return k4;
  }, {});
  return (0, import_jsx_runtime5.jsx)(ue, { words: me3, optional: true, children: (0, import_jsx_runtime5.jsx)(
    pe4,
    __spreadProps(__spreadValues({
      view: qe2,
      values: e,
      items: o2,
      css: l2,
      activeBatch: r,
      topBar: u,
      bottomBar: n,
      focus: s,
      autoSave: c2,
      layout: m,
      readonly: i,
      placement: y3
    }, p2), {
      children: g
    })
  ) });
}
function Ie4({ value: t2, options: e, label: o2 }) {
  const r = (0, import_react6.useContext)(Dt.i18n).getGroup("editor"), u = (0, import_react6.useMemo)(() => {
    let n = t2;
    if (typeof t2 == "boolean" && (n = r(t2 ? "Yes" : "No")), e) {
      const s = e.find((c2) => c2.id === t2);
      s && (n = s.label);
    }
    return n;
  }, [t2, e, r]);
  return u || u === 0 ? (0, import_jsx_runtime5.jsx)(ye, { label: o2, children: u }) : null;
}
function Re4({ fieldKey: t2, label: e, activeSection: o2, onClick: l2 }) {
  return (0, import_jsx_runtime5.jsxs)(
    "div",
    {
      className: `wx-OmgQq65I wx-section${o2 ? " wx-section-active" : ""}`,
      onClick: () => l2 && l2({
        item: { id: "toggle-section", key: o2 ? null : t2 }
      }),
      children: [
        (0, import_jsx_runtime5.jsx)("h3", { children: e }),
        (0, import_jsx_runtime5.jsx)(
          "i",
          {
            className: `wx-OmgQq65I wxi-angle-${o2 ? "down" : "right"} wx-icon`
          }
        )
      ]
    }
  );
}
z4("text", fe);
z4("textarea", Vt);
z4("checkbox", Ie);
z4("readonly", Ie4);
z4("section", Re4);
setEnv(env);

// node_modules/@svar-ui/react-gantt/dist/index.es.js
var De4 = (0, import_react7.createContext)(null);
function ze4(t2) {
  const s = t2.getAttribute("data-id"), r = parseInt(s);
  return isNaN(r) || r.toString() != s ? s : r;
}
function Bt3(t2, s, r) {
  const n = t2.getBoundingClientRect(), o2 = s.querySelector(".wx-body").getBoundingClientRect();
  return {
    top: n.top - o2.top,
    left: n.left - o2.left,
    dt: n.bottom - r.clientY,
    db: r.clientY - n.top
  };
}
function ot2(t2) {
  return t2 && t2.getAttribute("data-context-id");
}
var lt3 = 5;
function Xt2(t2, s) {
  let r, n, o2, N5, h, u, x2, S4, m;
  function P4(a2) {
    N5 = a2.clientX, h = a2.clientY, u = __spreadProps(__spreadValues({}, Bt3(r, t2, a2)), {
      y: s.getTask(o2).$y
    }), document.body.style.userSelect = "none";
  }
  function T4(a2) {
    r = locate(a2), ot2(r) && (o2 = ze4(r), m = setTimeout(() => {
      S4 = true, s && s.touchStart && s.touchStart(), P4(a2.touches[0]);
    }, 500), t2.addEventListener("touchmove", G5), t2.addEventListener("contextmenu", c2), window.addEventListener("touchend", I6));
  }
  function c2(a2) {
    if (S4 || m)
      return a2.preventDefault(), false;
  }
  function V4(a2) {
    a2.which === 1 && (r = locate(a2), ot2(r) && (o2 = ze4(r), t2.addEventListener("mousemove", L5), window.addEventListener("mouseup", C3), P4(a2)));
  }
  function E4(a2) {
    t2.removeEventListener("mousemove", L5), t2.removeEventListener("touchmove", G5), document.body.removeEventListener("mouseup", C3), document.body.removeEventListener("touchend", I6), document.body.style.userSelect = "", a2 && (t2.removeEventListener("mousedown", V4), t2.removeEventListener("touchstart", T4));
  }
  function _3(a2) {
    const B4 = a2.clientX - N5, O4 = a2.clientY - h;
    if (!n) {
      if (Math.abs(B4) < lt3 && Math.abs(O4) < lt3 || s && s.start && s.start({ id: o2, e: a2 }) === false)
        return;
      n = r.cloneNode(true), n.style.pointerEvents = "none", n.classList.add("wx-reorder-task"), n.style.position = "absolute", n.style.left = u.left + "px", n.style.top = u.top + "px", r.style.visibility = "hidden", r.parentNode.insertBefore(n, r);
    }
    if (n) {
      const J7 = Math.round(Math.max(0, u.top + O4));
      if (s && s.move && s.move({ id: o2, top: J7, detail: x2 }) === false)
        return;
      const j4 = s.getTask(o2), Q6 = j4.$y;
      if (!u.start && u.y == Q6) return H6();
      u.start = true, u.y = j4.$y - 4, n.style.top = J7 + "px";
      const X5 = document.elementFromPoint(
        a2.clientX,
        a2.clientY
      ), z5 = locate(X5);
      if (z5 && z5 !== r) {
        const U6 = ze4(z5), R5 = z5.getBoundingClientRect(), i = R5.top + R5.height / 2, p2 = a2.clientY + u.db > i && z5.nextElementSibling !== r, W4 = a2.clientY - u.dt < i && z5.previousElementSibling !== r;
        (x2 == null ? void 0 : x2.after) == U6 || (x2 == null ? void 0 : x2.before) == U6 ? x2 = null : p2 ? x2 = { id: o2, after: U6 } : W4 && (x2 = { id: o2, before: U6 });
      }
    }
  }
  function L5(a2) {
    _3(a2);
  }
  function G5(a2) {
    S4 ? (a2.preventDefault(), _3(a2.touches[0])) : m && (clearTimeout(m), m = null);
  }
  function I6() {
    S4 = null, m && (clearTimeout(m), m = null), H6();
  }
  function C3() {
    H6();
  }
  function H6() {
    r && (r.style.visibility = ""), n && (n.parentNode.removeChild(n), s && s.end && s.end({ id: o2, top: u.top })), o2 = r = n = u = x2 = null, E4();
  }
  return t2.style.position !== "absolute" && (t2.style.position = "relative"), t2.addEventListener("mousedown", V4), t2.addEventListener("touchstart", T4), {
    destroy() {
      E4(true);
    }
  };
}
function Yt3({ row: t2, column: s }) {
  function r(o2, N5) {
    return {
      justifyContent: N5.align,
      paddingLeft: `${(o2.$level - 1) * 20}px`
    };
  }
  const n = s && s._cell;
  return (0, import_jsx_runtime6.jsxs)("div", { className: "wx-pqc08MHU wx-content", style: r(t2, s), children: [
    t2.data || t2.lazy ? (0, import_jsx_runtime6.jsx)(
      "i",
      {
        className: `wx-pqc08MHU wx-toggle-icon wxi-menu-${t2.open ? "down" : "right"}`,
        "data-action": "open-task"
      }
    ) : (0, import_jsx_runtime6.jsx)("i", { className: "wx-pqc08MHU wx-toggle-placeholder" }),
    (0, import_jsx_runtime6.jsx)("div", { className: "wx-pqc08MHU wx-text", children: n ? (0, import_jsx_runtime6.jsx)(n, { row: t2, column: s }) : t2.text })
  ] });
}
function it2({ column: t2, cell: s }) {
  const r = (0, import_react7.useMemo)(() => t2.id, [t2 == null ? void 0 : t2.id]);
  return s || t2.id == "add-task" ? (0, import_jsx_runtime6.jsx)("div", { style: { textAlign: t2.align }, children: (0, import_jsx_runtime6.jsx)(
    "i",
    {
      className: "wx-9DAESAHW wx-action-icon wxi-plus",
      "data-action": r
    }
  ) }) : null;
}
function jt3(t2) {
  const {
    readonly: s,
    compactMode: r,
    width: n = 0,
    display: o2 = "all",
    columnWidth: N5 = 0,
    onTableAPIChange: h
  } = t2, [u, x2] = useWritableProp(N5), [S4, m] = (0, import_react7.useState)(), P4 = (0, import_react7.useContext)(Dt.i18n), T4 = (0, import_react7.useMemo)(() => P4.getGroup("gantt"), [P4]), c2 = (0, import_react7.useContext)(De4), V4 = useStore(c2, "scrollTop"), E4 = useStore(c2, "cellHeight"), _3 = useStore(c2, "_scrollTask"), L5 = useStore(c2, "_selected"), G5 = useStore(c2, "area"), I6 = useStore(c2, "_tasks"), C3 = useStore(c2, "_scales"), H6 = useStore(c2, "columns"), a2 = useStore(c2, "_sort"), B4 = useStore(c2, "calendar"), O4 = useStore(c2, "durationUnit"), J7 = useStore(c2, "splitTasks"), [j4, Q6] = (0, import_react7.useState)(null), X5 = (0, import_react7.useMemo)(() => !I6 || !G5 ? [] : I6.slice(G5.start, G5.end), [I6, G5]), z5 = (0, import_react7.useCallback)(
    (l2, g) => {
      if (g === "add-task")
        c2.exec(g, {
          target: l2,
          task: { text: T4("New Task") },
          mode: "child",
          show: true
        });
      else if (g === "open-task") {
        const $5 = X5.find((e) => e.id === l2);
        (($5 == null ? void 0 : $5.data) || ($5 == null ? void 0 : $5.lazy)) && c2.exec(g, { id: l2, mode: !$5.open });
      }
    },
    [X5]
  ), U6 = (0, import_react7.useCallback)(
    (l2) => {
      const g = locateID(l2), $5 = l2.target.dataset.action;
      $5 && l2.preventDefault(), g ? $5 === "add-task" || $5 === "open-task" ? z5(g, $5) : c2.exec("select-task", {
        id: g,
        toggle: l2.ctrlKey || l2.metaKey,
        range: l2.shiftKey,
        show: true
      }) : $5 === "add-task" && z5(null, $5);
    },
    [c2, z5]
  ), R5 = (0, import_react7.useRef)(null), i = (0, import_react7.useRef)(null), [p2, W4] = (0, import_react7.useState)(0), [D3, Y4] = (0, import_react7.useState)(false);
  (0, import_react7.useEffect)(() => {
    const l2 = i.current;
    if (!l2 || typeof ResizeObserver > "u") return;
    const g = () => W4(l2.clientWidth);
    g();
    const $5 = new ResizeObserver(g);
    return $5.observe(l2), () => $5.disconnect();
  }, []);
  const F4 = (0, import_react7.useRef)(null), de3 = (0, import_react7.useCallback)(
    (l2) => {
      var _a2;
      const g = l2.id, { before: $5, after: e } = l2, f = l2.onMove;
      let y3 = $5 || e, M2 = $5 ? "before" : "after";
      if (f) {
        if (M2 === "after") {
          const q4 = c2.getTask(y3);
          ((_a2 = q4.data) == null ? void 0 : _a2.length) && q4.open && (M2 = "before", y3 = q4.data[0].id);
        }
        F4.current = { id: g, [M2]: y3 };
      } else F4.current = null;
      c2.exec("move-task", {
        id: g,
        mode: M2,
        target: y3,
        inProgress: f
      });
    },
    [c2]
  ), ue4 = (0, import_react7.useMemo)(() => {
    var _a2;
    return (_a2 = G5 == null ? void 0 : G5.from) != null ? _a2 : 0;
  }, [G5]), fe4 = (0, import_react7.useMemo)(() => {
    var _a2;
    return (_a2 = C3 == null ? void 0 : C3.height) != null ? _a2 : 0;
  }, [C3]), le5 = (0, import_react7.useMemo)(() => !r && o2 !== "grid" ? (u != null ? u : 0) > (n != null ? n : 0) : (u != null ? u : 0) > (p2 != null ? p2 : 0), [r, o2, u, n, p2]), v3 = (0, import_react7.useMemo)(() => {
    const l2 = {};
    return le5 && o2 === "all" || o2 === "grid" && le5 ? l2.width = u : o2 === "grid" && (l2.width = "100%"), l2;
  }, [le5, o2, u]), se5 = (0, import_react7.useMemo)(() => j4 && !X5.find((l2) => l2.id === j4.id) ? [...X5, j4] : X5, [X5, j4]), te5 = (0, import_react7.useMemo)(() => {
    let l2 = (H6 || []).map((e) => {
      e = __spreadValues({}, e);
      const f = e.header;
      if (typeof f == "object") {
        const y3 = f.text && T4(f.text);
        e.header = __spreadProps(__spreadValues({}, f), { text: y3 });
      } else e.header = T4(f);
      return e;
    });
    const g = l2.findIndex((e) => e.id === "text"), $5 = l2.findIndex((e) => e.id === "add-task");
    if (g !== -1 && (l2[g].cell && (l2[g]._cell = l2[g].cell), l2[g].cell = Yt3), $5 !== -1) {
      l2[$5].cell = l2[$5].cell || it2;
      const e = l2[$5].header;
      if (typeof e != "object" && (l2[$5].header = { text: e }), l2[$5].header.cell = e.cell || it2, s)
        l2.splice($5, 1);
      else if (r) {
        const [f] = l2.splice($5, 1);
        l2.unshift(f);
      }
    }
    return l2.length > 0 && (l2[l2.length - 1].resize = false), l2;
  }, [H6, T4, s, r]), oe5 = (0, import_react7.useMemo)(() => o2 === "all" ? `${n}px` : o2 === "grid" ? "calc(100% - 4px)" : te5.find((l2) => l2.id === "add-task") ? "50px" : "0", [o2, n, te5]), ve3 = (0, import_react7.useMemo)(() => {
    if (se5 && (a2 == null ? void 0 : a2.length)) {
      const l2 = {};
      return a2.forEach(({ key: g, order: $5 }, e) => {
        l2[g] = __spreadValues({
          order: $5
        }, a2.length > 1 && { index: e });
      }), l2;
    }
    return {};
  }, [se5, a2]), be4 = (0, import_react7.useCallback)(() => te5.some((l2) => l2.flexgrow && !l2.hidden), []), $e4 = (0, import_react7.useMemo)(() => be4(), [be4, D3]), me4 = (0, import_react7.useMemo)(() => {
    let l2 = o2 === "chart" ? te5.filter(($5) => $5.id === "add-task") : te5;
    const g = o2 === "all" ? n : p2;
    if (!$e4) {
      let $5 = u, e = false;
      if (te5.some((f) => f.$width)) {
        let f = 0;
        $5 = te5.reduce((y3, M2) => (M2.hidden || (f += M2.width, y3 += M2.$width || M2.width), y3), 0), f > $5 && $5 > g && (e = true);
      }
      if (e || $5 < g) {
        let f = 1;
        return e || (f = (g - 50) / ($5 - 50 || 1)), l2.map((y3) => (y3.id !== "add-task" && !y3.hidden && (y3.$width || (y3.$width = y3.width), y3.width = y3.$width * f), y3));
      }
    }
    return l2;
  }, [o2, te5, $e4, u, n, p2]), ke4 = (0, import_react7.useCallback)(
    (l2) => {
      if (!be4()) {
        const g = me4.reduce(($5, e) => (l2 && e.$width && (e.$width = e.width), $5 + (e.hidden ? 0 : e.width)), 0);
        g !== u && x2(g);
      }
      Y4(true), Y4(false);
    },
    [be4, me4, u, x2]
  ), Te3 = (0, import_react7.useCallback)(() => {
    te5.filter((g) => g.flexgrow && !g.hidden).length === 1 && te5.forEach((g) => {
      g.$width && !g.flexgrow && !g.hidden && (g.width = g.$width);
    });
  }, []), ie4 = (0, import_react7.useCallback)(
    (l2) => {
      var _a2;
      if (!s) {
        const g = locateID(l2), $5 = locateAttr(l2, "data-col-id");
        !((_a2 = $5 && te5.find((f) => f.id == $5)) == null ? void 0 : _a2.editor) && g && c2.exec("show-editor", { id: g });
      }
    },
    [c2, s]
    // cols is defined later; relies on latest value at call time
  ), xe5 = (0, import_react7.useMemo)(
    () => Array.isArray(L5) ? L5.map((l2) => l2.id) : [],
    [L5]
  ), he3 = (0, import_react7.useCallback)(() => {
    if (R5.current && se5 !== null) {
      const l2 = R5.current.querySelector(".wx-body");
      l2 && (l2.style.top = -((V4 != null ? V4 : 0) - (ue4 != null ? ue4 : 0)) + "px");
    }
    i.current && (i.current.scrollTop = 0);
  }, [se5, V4, ue4]);
  (0, import_react7.useEffect)(() => {
    R5.current && he3();
  }, [V4, ue4, he3]), (0, import_react7.useEffect)(() => {
    const l2 = R5.current;
    if (!l2) return;
    const g = l2.querySelector(".wx-table-box .wx-body");
    if (!g || typeof ResizeObserver > "u") return;
    const $5 = new ResizeObserver(() => {
      he3();
    });
    return $5.observe(g), () => {
      $5.disconnect();
    };
  }, [me4, v3, o2, oe5, se5, he3]), (0, import_react7.useEffect)(() => {
    if (!_3 || !S4) return;
    const { id: l2 } = _3, g = S4.getState().focusCell;
    g && g.row !== l2 && R5.current && R5.current.contains(document.activeElement) && S4.exec("focus-cell", {
      row: l2,
      column: g.column
    });
  }, [_3, S4]);
  const w = (0, import_react7.useCallback)(
    ({ id: l2 }) => {
      if (s) return false;
      c2.getTask(l2).open && c2.exec("open-task", { id: l2, mode: false });
      const g = c2.getState()._tasks.find(($5) => $5.id === l2);
      if (Q6(g || null), !g) return false;
    },
    [c2, s]
  ), ne4 = (0, import_react7.useCallback)(
    ({ id: l2, top: g }) => {
      F4.current ? de3(__spreadProps(__spreadValues({}, F4.current), { onMove: false })) : c2.exec("drag-task", {
        id: l2,
        top: g + (ue4 != null ? ue4 : 0),
        inProgress: false
      }), Q6(null);
    },
    [c2, de3, ue4]
  ), ce6 = (0, import_react7.useCallback)(
    ({ id: l2, top: g, detail: $5 }) => {
      $5 && de3(__spreadProps(__spreadValues({}, $5), { onMove: true })), c2.exec("drag-task", {
        id: l2,
        top: g + (ue4 != null ? ue4 : 0),
        inProgress: true
      });
    },
    [c2, de3, ue4]
  );
  (0, import_react7.useEffect)(() => {
    const l2 = R5.current;
    return l2 ? Xt2(l2, {
      start: w,
      end: ne4,
      move: ce6,
      getTask: c2.getTask
    }).destroy : void 0;
  }, [c2, w, ne4, ce6]);
  const K6 = (0, import_react7.useCallback)(
    (l2) => {
      const { key: g, isInput: $5 } = l2;
      if (!$5 && (g === "arrowup" || g === "arrowdown"))
        return l2.eventSource = "grid", c2.exec("hotkey", l2), false;
      if (g === "enter") {
        const e = S4 == null ? void 0 : S4.getState().focusCell;
        if (e) {
          const { row: f, column: y3 } = e;
          y3 === "add-task" ? z5(f, "add-task") : y3 === "text" && z5(f, "open-task");
        }
      }
    },
    [c2, z5, S4]
  ), ae5 = (0, import_react7.useRef)(null), Me4 = () => {
    ae5.current = {
      setTableAPI: m,
      handleHotkey: K6,
      sortVal: a2,
      api: c2,
      adjustColumns: Te3,
      setColumnWidth: ke4,
      tasks: X5,
      calendarVal: B4,
      durationUnitVal: O4,
      splitTasksVal: J7,
      onTableAPIChange: h
    };
  };
  Me4(), (0, import_react7.useEffect)(() => {
    Me4();
  }, [
    m,
    K6,
    a2,
    c2,
    Te3,
    ke4,
    X5,
    B4,
    O4,
    J7,
    h
  ]);
  const We3 = (0, import_react7.useCallback)((l2) => {
    m(l2), l2.intercept("hotkey", (g) => ae5.current.handleHotkey(g)), l2.intercept("scroll", () => false), l2.intercept("select-row", () => false), l2.intercept("sort-rows", (g) => {
      const $5 = ae5.current.sortVal, { key: e, add: f } = g, y3 = $5 ? $5.find((q4) => q4.key === e) : null;
      let M2 = "asc";
      return y3 && (M2 = !y3 || y3.order === "asc" ? "desc" : "asc"), c2.exec("sort-tasks", {
        key: e,
        order: M2,
        add: f
      }), false;
    }), l2.on("resize-column", () => {
      ae5.current.setColumnWidth(true);
    }), l2.on("hide-column", (g) => {
      g.mode || ae5.current.adjustColumns(), ae5.current.setColumnWidth();
    }), l2.intercept("update-cell", (g) => {
      const { id: $5, column: e, value: f } = g, y3 = ae5.current.tasks.find((M2) => M2.id === $5);
      if (y3) {
        const M2 = __spreadValues({}, y3);
        let q4 = f;
        q4 && !isNaN(q4) && !(q4 instanceof Date) && (q4 *= 1), M2[e] = q4, Ba(
          M2,
          {
            calendar: ae5.current.calendarVal,
            durationUnit: ae5.current.durationUnitVal,
            splitTasks: ae5.current.splitTasksVal
          },
          e
        ), c2.exec("update-task", {
          id: $5,
          task: M2
        });
      }
      return false;
    }), h && h(l2);
  }, []);
  return (0, import_jsx_runtime6.jsx)(
    "div",
    {
      className: "wx-rHj6070p wx-table-container",
      style: { flex: `0 0 ${oe5}` },
      ref: i,
      children: (0, import_jsx_runtime6.jsx)(
        "div",
        {
          ref: R5,
          style: v3,
          className: "wx-rHj6070p wx-table",
          onClick: U6,
          onDoubleClick: ie4,
          children: (0, import_jsx_runtime6.jsx)(
            lo,
            {
              init: We3,
              sizes: {
                rowHeight: E4,
                headerHeight: (fe4 != null ? fe4 : 0) - 1
              },
              rowStyle: (l2) => l2.$reorder ? "wx-rHj6070p wx-reorder-task" : "wx-rHj6070p",
              columnStyle: (l2) => `wx-rHj6070p wx-text-${l2.align}${l2.id === "add-task" ? " wx-action" : ""}`,
              data: se5,
              columns: me4,
              selectedRows: [...xe5],
              sortMarks: ve3
            }
          )
        }
      )
    }
  );
}
function qt2({ borders: t2 = "" }) {
  const s = (0, import_react7.useContext)(De4), r = useStore(s, "cellWidth"), n = useStore(s, "cellHeight"), o2 = (0, import_react7.useRef)(null), [N5, h] = (0, import_react7.useState)("#e4e4e4");
  (0, import_react7.useEffect)(() => {
    if (typeof getComputedStyle < "u" && o2.current) {
      const x2 = getComputedStyle(o2.current).getPropertyValue(
        "--wx-gantt-border"
      );
      h(x2 ? x2.substring(x2.indexOf("#")) : "#1d1e261a");
    }
  }, []);
  const u = {
    width: "100%",
    height: "100%",
    background: r != null && n != null ? `url(${qa(r, n, N5, t2)})` : void 0,
    position: "absolute"
  };
  return (0, import_jsx_runtime6.jsx)("div", { ref: o2, style: u });
}
function Qt2({ onSelectLink: t2, selectedLink: s, readonly: r }) {
  const n = (0, import_react7.useContext)(De4), o2 = useStore(n, "_links"), N5 = useStore(n, "criticalPath"), h = (0, import_react7.useRef)(null), u = (0, import_react7.useCallback)(
    (x2) => {
      var _a2;
      const S4 = (_a2 = x2 == null ? void 0 : x2.target) == null ? void 0 : _a2.classList;
      !(S4 == null ? void 0 : S4.contains("wx-line")) && !(S4 == null ? void 0 : S4.contains("wx-delete-button")) && t2(null);
    },
    [t2]
  );
  return (0, import_react7.useEffect)(() => {
    if (!r && s && h.current) {
      const x2 = (S4) => {
        h.current && !h.current.contains(S4.target) && u(S4);
      };
      return document.addEventListener("click", x2), () => {
        document.removeEventListener("click", x2);
      };
    }
  }, [r, s, u]), (0, import_jsx_runtime6.jsxs)("svg", { className: "wx-dkx3NwEn wx-links", children: [
    (o2 || []).map((x2) => {
      const S4 = "wx-dkx3NwEn wx-line" + (N5 && x2.$critical ? " wx-critical" : "") + (r ? "" : " wx-line-selectable");
      return (0, import_jsx_runtime6.jsx)(
        "polyline",
        {
          className: S4,
          points: x2.$p,
          onClick: () => !r && t2(x2.id),
          "data-link-id": x2.id
        },
        x2.id
      );
    }),
    !r && s && (0, import_jsx_runtime6.jsx)(
      "polyline",
      {
        ref: h,
        className: "wx-dkx3NwEn wx-line wx-line-selected wx-line-selectable wx-delete-link",
        points: s.$p
      }
    )
  ] });
}
function Ut3(t2) {
  const { task: s, type: r } = t2;
  function n(N5) {
    const h = s.segments[N5];
    return {
      left: `${h.$x}px`,
      top: "0px",
      width: `${h.$w}px`,
      height: "100%"
    };
  }
  function o2(N5) {
    if (!s.progress) return 0;
    const h = s.duration * s.progress / 100, u = s.segments;
    let x2 = 0, S4 = 0, m = null;
    do {
      const P4 = u[S4];
      S4 === N5 && (x2 > h ? m = 0 : m = Math.min((h - x2) / P4.duration, 1) * 100), x2 += P4.duration, S4++;
    } while (m === null && S4 < u.length);
    return m || 0;
  }
  return (0, import_jsx_runtime6.jsx)("div", { className: "wx-segments wx-GKbcLEGA", children: s.segments.map((N5, h) => (0, import_jsx_runtime6.jsxs)(
    "div",
    {
      className: `wx-segment wx-bar wx-${r} wx-GKbcLEGA`,
      "data-segment": h,
      style: n(h),
      children: [
        s.progress ? (0, import_jsx_runtime6.jsx)("div", { className: "wx-progress-wrapper", children: (0, import_jsx_runtime6.jsx)(
          "div",
          {
            className: "wx-progress-percent wx-GKbcLEGA",
            style: { width: `${o2(h)}%` }
          }
        ) }) : null,
        (0, import_jsx_runtime6.jsx)("div", { className: "wx-content", children: N5.text || "" })
      ]
    },
    h
  )) });
}
function Zt3(t2) {
  const { readonly: s, taskTemplate: r } = t2, n = (0, import_react7.useContext)(De4), [o2, N5] = useStoreWithCounter(n, "_tasks"), [h, u] = useStoreWithCounter(n, "_links"), x2 = useStore(n, "area"), S4 = useStore(n, "_scales"), m = useStore(n, "taskTypes"), P4 = useStore(n, "baselines"), T4 = useStore(n, "_selected"), c2 = useStore(n, "_scrollTask"), V4 = useStore(n, "criticalPath"), E4 = useStore(n, "tasks"), _3 = useStore(n, "schedule"), L5 = useStore(n, "splitTasks"), G5 = useStore(n, "summary"), I6 = (0, import_react7.useMemo)(() => {
    var _a2, _b;
    if (!x2 || !Array.isArray(o2)) return [];
    const e = (_a2 = x2.start) != null ? _a2 : 0, f = (_b = x2.end) != null ? _b : 0;
    return o2.slice(e, f).map((y3) => __spreadValues({}, y3));
  }, [N5, x2]), C3 = (0, import_react7.useMemo)(
    () => S4.lengthUnitWidth,
    [S4]
  ), H6 = (0, import_react7.useRef)(false), [a2, B4] = (0, import_react7.useState)(void 0), [O4, J7] = (0, import_react7.useState)(null), j4 = (0, import_react7.useRef)(null), [Q6, X5] = (0, import_react7.useState)(null), z5 = (0, import_react7.useMemo)(() => Q6 && __spreadValues({}, h.find((e) => e.id === Q6)), [Q6, u]), [U6, R5] = (0, import_react7.useState)(void 0), i = (0, import_react7.useRef)(null), [p2, W4] = (0, import_react7.useState)(0), D3 = (0, import_react7.useRef)(null), Y4 = (0, import_react7.useMemo)(() => {
    const e = D3.current;
    return !!(T4.length && e && e.contains(document.activeElement));
  }, [T4, D3.current]), F4 = (0, import_react7.useMemo)(() => {
    var _a2;
    return Y4 && ((_a2 = T4[T4.length - 1]) == null ? void 0 : _a2.id);
  }, [Y4, T4]);
  (0, import_react7.useEffect)(() => {
    var _a2;
    if (c2 && Y4 && c2) {
      const { id: e } = c2, f = (_a2 = D3.current) == null ? void 0 : _a2.querySelector(
        `.wx-bar[data-id='${e}']`
      );
      f && f.focus({ preventScroll: true });
    }
  }, [c2]), (0, import_react7.useEffect)(() => {
    const e = D3.current;
    if (e && (W4(e.offsetWidth || 0), typeof ResizeObserver < "u")) {
      const f = new ResizeObserver((y3) => {
        y3[0] && W4(y3[0].contentRect.width);
      });
      return f.observe(e), () => f.disconnect();
    }
  }, [D3.current]);
  const de3 = (0, import_react7.useCallback)(() => {
    document.body.style.userSelect = "none";
  }, []), ue4 = (0, import_react7.useCallback)(() => {
    document.body.style.userSelect = "";
  }, []), fe4 = (0, import_react7.useCallback)(
    (e, f, y3) => {
      if (f.target.classList.contains("wx-line") || (y3 || (y3 = n.getTask(ze4(e))), y3.type === "milestone" || y3.type === "summary")) return "";
      const M2 = locate(f, "data-segment");
      M2 && (e = M2);
      const { left: q4, width: ge4 } = e.getBoundingClientRect(), pe5 = (f.clientX - q4) / ge4;
      let ye4 = 0.2 / (ge4 > 200 ? ge4 / 200 : 1);
      return pe5 < ye4 ? "start" : pe5 > 1 - ye4 ? "end" : "";
    },
    [n]
  ), le5 = (0, import_react7.useCallback)(
    (e, f) => {
      var _a2;
      const { clientX: y3 } = f, M2 = ze4(e), q4 = n.getTask(M2), ge4 = f.target.classList;
      if (!f.target.closest(".wx-delete-button") && !s) {
        if (ge4.contains("wx-progress-marker")) {
          const { progress: pe5 } = n.getTask(M2);
          j4.current = {
            id: M2,
            x: y3,
            progress: pe5,
            dx: 0,
            node: e,
            marker: f.target
          }, f.target.classList.add("wx-progress-in-drag");
        } else {
          const pe5 = fe4(e, f, q4) || "move", ye4 = {
            id: M2,
            mode: pe5,
            x: y3,
            dx: 0,
            l: q4.$x,
            w: q4.$w
          };
          if (L5 && ((_a2 = q4.segments) == null ? void 0 : _a2.length)) {
            const Ne4 = locate(f, "data-segment");
            Ne4 && (ye4.segmentIndex = Ne4.dataset.segment * 1, Wa(q4, ye4));
          }
          J7(ye4);
        }
        de3();
      }
    },
    [n, s, fe4, de3, L5]
  ), v3 = (0, import_react7.useCallback)(
    (e) => {
      if (e.button !== 0) return;
      const f = locate(e);
      f && le5(f, e);
    },
    [le5]
  ), se5 = (0, import_react7.useCallback)(
    (e) => {
      const f = locate(e);
      f && (i.current = setTimeout(() => {
        R5(true), le5(f, e.touches[0]);
      }, 300));
    },
    [le5]
  ), te5 = (0, import_react7.useCallback)((e) => {
    X5(e);
  }, []), oe5 = (0, import_react7.useCallback)(() => {
    if (j4.current) {
      const { dx: e, id: f, marker: y3, value: M2 } = j4.current;
      j4.current = null, typeof M2 < "u" && e && n.exec("update-task", {
        id: f,
        task: { progress: M2 },
        inProgress: false
      }), y3.classList.remove("wx-progress-in-drag"), H6.current = true, ue4();
    } else if (O4) {
      const { id: e, mode: f, dx: y3, l: M2, w: q4, start: ge4, segment: pe5, index: ye4 } = O4;
      if (J7(null), ge4) {
        const Ne4 = Math.round(y3 / C3);
        if (!Ne4)
          n.exec("drag-task", __spreadValues({
            id: e,
            width: q4,
            left: M2,
            inProgress: false
          }, pe5 && { segmentIndex: ye4 }));
        else {
          let He3 = {}, Ae3 = n.getTask(e);
          pe5 && (Ae3 = Ae3.segments[ye4]), f === "move" ? (He3.start = Ae3.start, He3.end = Ae3.end) : He3[f] = Ae3[f], n.exec("update-task", __spreadValues({
            id: e,
            diff: Ne4,
            task: He3
          }, pe5 && { segmentIndex: ye4 }));
        }
        H6.current = true;
      }
      ue4();
    }
  }, [n, ue4, O4, C3]), ve3 = (0, import_react7.useCallback)(
    (e, f) => {
      const { clientX: y3 } = f;
      if (!s)
        if (j4.current) {
          const { node: M2, x: q4, id: ge4 } = j4.current, pe5 = j4.current.dx = y3 - q4, ye4 = Math.round(pe5 / M2.offsetWidth * 100);
          let Ne4 = j4.current.progress + ye4;
          j4.current.value = Ne4 = Math.min(
            Math.max(0, Ne4),
            100
          ), n.exec("update-task", {
            id: ge4,
            task: { progress: Ne4 },
            inProgress: true
          });
        } else if (O4) {
          te5(null);
          const { mode: M2, l: q4, w: ge4, x: pe5, id: ye4, start: Ne4, segment: He3, index: Ae3 } = O4, Be2 = n.getTask(ye4), Re5 = y3 - pe5, Qe3 = Math.round(C3) || 1;
          if (!Ne4 && Math.abs(Re5) < 20 || M2 === "start" && ge4 - Re5 < Qe3 || M2 === "end" && ge4 + Re5 < Qe3 || M2 === "move" && (Re5 < 0 && q4 + Re5 < 0 || Re5 > 0 && q4 + ge4 + Re5 > p2) || O4.segment && !Ta(Be2, O4))
            return;
          const Xe3 = __spreadProps(__spreadValues({}, O4), { dx: Re5 });
          let _e4, Ve3;
          if (M2 === "start" ? (_e4 = q4 + Re5, Ve3 = ge4 - Re5) : M2 === "end" ? (_e4 = q4, Ve3 = ge4 + Re5) : M2 === "move" && (_e4 = q4 + Re5, Ve3 = ge4), n.exec("drag-task", __spreadValues({
            id: ye4,
            width: Ve3,
            left: _e4,
            inProgress: true,
            start: Ne4
          }, He3 && { segmentIndex: Ae3 })), !Xe3.start && (M2 === "move" && Be2.$x == q4 || M2 !== "move" && Be2.$w == ge4)) {
            H6.current = true, oe5();
            return;
          }
          Xe3.start = true, J7(Xe3);
        } else {
          const M2 = locate(e);
          if (M2) {
            const q4 = n.getTask(ze4(M2)), pe5 = locate(e, "data-segment") || M2, ye4 = fe4(pe5, f, q4);
            pe5.style.cursor = ye4 && !s ? "col-resize" : "pointer";
          }
        }
    },
    [
      n,
      s,
      O4,
      C3,
      p2,
      fe4,
      te5,
      oe5
    ]
  ), be4 = (0, import_react7.useCallback)(
    (e) => {
      ve3(e, e);
    },
    [ve3]
  ), $e4 = (0, import_react7.useCallback)(
    (e) => {
      U6 ? (e.preventDefault(), ve3(e, e.touches[0])) : i.current && (clearTimeout(i.current), i.current = null);
    },
    [U6, ve3]
  ), me4 = (0, import_react7.useCallback)(() => {
    oe5();
  }, [oe5]), ke4 = (0, import_react7.useCallback)(() => {
    R5(null), i.current && (clearTimeout(i.current), i.current = null), oe5();
  }, [oe5]);
  (0, import_react7.useEffect)(() => (window.addEventListener("mouseup", me4), () => {
    window.removeEventListener("mouseup", me4);
  }), [me4]);
  const Te3 = (0, import_react7.useCallback)(
    (e) => {
      if (!s) {
        const f = locateID(e.target);
        if (f && !e.target.classList.contains("wx-link")) {
          const y3 = locateID(e.target, "data-segment");
          n.exec("show-editor", __spreadValues({
            id: f
          }, y3 !== null && { segmentIndex: y3 }));
        }
      }
    },
    [n, s]
  ), ie4 = ["e2s", "s2s", "e2e", "s2e"], xe5 = (0, import_react7.useCallback)((e, f) => ie4[(e ? 1 : 0) + (f ? 0 : 2)], []), he3 = (0, import_react7.useCallback)(
    (e, f) => {
      const y3 = a2.id, M2 = a2.start;
      return e === y3 ? true : !!h.find((q4) => q4.target == e && q4.source == y3 && q4.type === xe5(M2, f));
    },
    [a2, u, xe5]
  ), w = (0, import_react7.useCallback)(() => {
    a2 && B4(null);
  }, [a2]), ne4 = (0, import_react7.useCallback)(
    (e) => {
      if (H6.current) {
        H6.current = false;
        return;
      }
      const f = locateID(e.target);
      if (f) {
        const y3 = e.target.classList;
        if (y3.contains("wx-link")) {
          const M2 = y3.contains("wx-left");
          if (!a2) {
            B4({ id: f, start: M2 });
            return;
          }
          a2.id !== f && !he3(f, M2) && n.exec("add-link", {
            link: {
              source: a2.id,
              target: f,
              type: xe5(a2.start, M2)
            }
          });
        } else if (y3.contains("wx-delete-button-icon"))
          n.exec("delete-link", { id: Q6 }), X5(null);
        else {
          let M2;
          const q4 = locate(e, "data-segment");
          q4 && (M2 = q4.dataset.segment * 1), n.exec("select-task", {
            id: f,
            toggle: e.ctrlKey || e.metaKey,
            range: e.shiftKey,
            segmentIndex: M2
          });
        }
      }
      w();
    },
    [
      n,
      a2,
      u,
      z5,
      he3,
      xe5,
      w
    ]
  ), ce6 = (0, import_react7.useCallback)((e) => ({
    left: `${e.$x}px`,
    top: `${e.$y}px`,
    width: `${e.$w}px`,
    height: `${e.$h}px`
  }), []), K6 = (0, import_react7.useCallback)((e) => ({
    left: `${e.$x_base}px`,
    top: `${e.$y_base}px`,
    width: `${e.$w_base}px`,
    height: `${e.$h_base}px`
  }), []), ae5 = (0, import_react7.useCallback)(
    (e) => {
      if (U6 || i.current)
        return e.preventDefault(), false;
    },
    [U6]
  ), Me4 = (0, import_react7.useMemo)(
    () => m.map((e) => e.id),
    [m]
  ), We3 = (0, import_react7.useCallback)(
    (e) => {
      let f = Me4.includes(e) ? e : "task";
      return ["task", "milestone", "summary"].includes(e) || (f = `task ${f}`), f;
    },
    [Me4]
  ), l2 = (0, import_react7.useCallback)(
    (e) => {
      n.exec(e.action, e.data);
    },
    [n]
  ), g = (0, import_react7.useCallback)(
    (e) => V4 && E4.byId(e).$critical,
    [V4, E4]
  ), $5 = (0, import_react7.useCallback)(
    (e) => {
      if (_3 == null ? void 0 : _3.auto) {
        const f = E4.getSummaryId(e, true), y3 = E4.getSummaryId(a2.id, true);
        return (a2 == null ? void 0 : a2.id) && !(Array.isArray(f) ? f : [f]).includes(
          a2.id
        ) && !(Array.isArray(y3) ? y3 : [y3]).includes(e);
      }
      return a2;
    },
    [_3, E4, a2]
  );
  return (0, import_jsx_runtime6.jsxs)(
    "div",
    {
      className: "wx-GKbcLEGA wx-bars",
      style: { lineHeight: `${I6.length ? I6[0].$h : 0}px` },
      ref: D3,
      onContextMenu: ae5,
      onMouseDown: v3,
      onMouseMove: be4,
      onTouchStart: se5,
      onTouchMove: $e4,
      onTouchEnd: ke4,
      onClick: ne4,
      onDoubleClick: Te3,
      onDragStart: (e) => (e.preventDefault(), false),
      children: [
        (0, import_jsx_runtime6.jsx)(
          Qt2,
          {
            onSelectLink: te5,
            selectedLink: z5,
            readonly: s
          }
        ),
        I6.map((e) => {
          if (e.$skip && e.$skip_baseline) return null;
          const f = `wx-bar wx-${We3(e.type)}` + (U6 && O4 && e.id === O4.id ? " wx-touch" : "") + (a2 && a2.id === e.id ? " wx-selected" : "") + (g(e.id) ? " wx-critical" : "") + (e.$reorder ? " wx-reorder-task" : "") + (L5 && e.segments ? " wx-split" : ""), y3 = "wx-link wx-left" + (a2 ? " wx-visible" : "") + (!a2 || !he3(e.id, true) && $5(e.id) ? " wx-target" : "") + (a2 && a2.id === e.id && a2.start ? " wx-selected" : "") + (g(e.id) ? " wx-critical" : ""), M2 = "wx-link wx-right" + (a2 ? " wx-visible" : "") + (!a2 || !he3(e.id, false) && $5(e.id) ? " wx-target" : "") + (a2 && a2.id === e.id && !a2.start ? " wx-selected" : "") + (g(e.id) ? " wx-critical" : "");
          return (0, import_jsx_runtime6.jsxs)(import_react7.Fragment, { children: [
            !e.$skip && (0, import_jsx_runtime6.jsxs)(
              "div",
              {
                className: "wx-GKbcLEGA " + f,
                style: ce6(e),
                "data-tooltip-id": e.id,
                "data-id": e.id,
                tabIndex: F4 === e.id ? 0 : -1,
                children: [
                  s ? null : e.id === (z5 == null ? void 0 : z5.target) && (z5 == null ? void 0 : z5.type[2]) === "s" ? (0, import_jsx_runtime6.jsx)(
                    ee,
                    {
                      type: "danger",
                      css: "wx-left wx-delete-button wx-delete-link",
                      children: (0, import_jsx_runtime6.jsx)("i", { className: "wxi-close wx-delete-button-icon" })
                    }
                  ) : (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA " + y3, children: (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA wx-inner" }) }),
                  e.type !== "milestone" ? (0, import_jsx_runtime6.jsxs)(import_jsx_runtime6.Fragment, { children: [
                    e.progress && !(L5 && e.segments) ? (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA wx-progress-wrapper", children: (0, import_jsx_runtime6.jsx)(
                      "div",
                      {
                        className: "wx-GKbcLEGA wx-progress-percent",
                        style: { width: `${e.progress}%` }
                      }
                    ) }) : null,
                    !s && !(L5 && e.segments) && !(e.type == "summary" && (G5 == null ? void 0 : G5.autoProgress)) ? (0, import_jsx_runtime6.jsx)(
                      "div",
                      {
                        className: "wx-GKbcLEGA wx-progress-marker",
                        style: { left: `calc(${e.progress}% - 10px)` },
                        children: e.progress
                      }
                    ) : null,
                    r ? (0, import_jsx_runtime6.jsx)(r, { data: e, api: n, onAction: l2 }) : L5 && e.segments ? (0, import_jsx_runtime6.jsx)(Ut3, { task: e, type: We3(e.type) }) : (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA wx-content", children: e.text || "" })
                  ] }) : (0, import_jsx_runtime6.jsxs)(import_jsx_runtime6.Fragment, { children: [
                    (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA wx-content" }),
                    r ? (0, import_jsx_runtime6.jsx)(r, { data: e, api: n, onAction: l2 }) : (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA wx-text-out", children: e.text })
                  ] }),
                  s ? null : e.id === (z5 == null ? void 0 : z5.target) && (z5 == null ? void 0 : z5.type[2]) === "e" ? (0, import_jsx_runtime6.jsx)(
                    ee,
                    {
                      type: "danger",
                      css: "wx-right wx-delete-button wx-delete-link",
                      children: (0, import_jsx_runtime6.jsx)("i", { className: "wxi-close wx-delete-button-icon" })
                    }
                  ) : (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA " + M2, children: (0, import_jsx_runtime6.jsx)("div", { className: "wx-GKbcLEGA wx-inner" }) })
                ]
              }
            ),
            P4 && !e.$skip_baseline ? (0, import_jsx_runtime6.jsx)(
              "div",
              {
                className: "wx-GKbcLEGA wx-baseline" + (e.type === "milestone" ? " wx-milestone" : ""),
                style: K6(e)
              }
            ) : null
          ] }, e.id);
        })
      ]
    }
  );
}
function Jt2(t2) {
  const { highlightTime: s } = t2, r = (0, import_react7.useContext)(De4), n = useStore(r, "_scales");
  return (0, import_jsx_runtime6.jsx)("div", { className: "wx-ZkvhDKir wx-scale", style: { width: n.width }, children: ((n == null ? void 0 : n.rows) || []).map((o2, N5) => (0, import_jsx_runtime6.jsx)(
    "div",
    {
      className: "wx-ZkvhDKir wx-row",
      style: { height: `${o2.height}px` },
      children: (o2.cells || []).map((h, u) => {
        const x2 = s ? s(h.date, h.unit) : "", S4 = "wx-cell " + (h.css || "") + " " + (x2 || "");
        return (0, import_jsx_runtime6.jsx)(
          "div",
          {
            className: "wx-ZkvhDKir " + S4,
            style: { width: `${h.width}px` },
            children: h.value
          },
          u
        );
      })
    },
    N5
  )) });
}
var en = /* @__PURE__ */ new Map();
function tn(t2) {
  const s = (0, import_react7.useRef)(null), r = (0, import_react7.useRef)(0), n = (0, import_react7.useRef)(null), o2 = typeof window < "u" && window.__RENDER_METRICS_ENABLED__;
  s.current === null && (s.current = performance.now()), r.current++, (0, import_react7.useEffect)(() => {
    if (o2)
      return cancelAnimationFrame(n.current), n.current = requestAnimationFrame(() => {
        const N5 = {
          label: t2,
          time: performance.now() - s.current,
          renders: r.current,
          timestamp: Date.now()
        };
        en.set(t2, N5), window.dispatchEvent(
          new CustomEvent("render-metric", { detail: N5 })
        );
      }), () => cancelAnimationFrame(n.current);
  });
}
function nn2(t2) {
  var _a2;
  const {
    readonly: s,
    fullWidth: r,
    fullHeight: n,
    taskTemplate: o2,
    cellBorders: N5,
    highlightTime: h
  } = t2, u = (0, import_react7.useContext)(De4), [x2, S4] = useStoreWithCounter(u, "_selected"), m = useStore(u, "scrollTop"), P4 = useStore(u, "cellHeight"), T4 = useStore(u, "cellWidth"), c2 = useStore(u, "_scales"), V4 = useStore(u, "_markers"), E4 = useStore(u, "_scrollTask"), _3 = useStore(u, "zoom"), [L5, G5] = (0, import_react7.useState)(), I6 = (0, import_react7.useRef)(null), C3 = 1 + (((_a2 = c2 == null ? void 0 : c2.rows) == null ? void 0 : _a2.length) || 0), H6 = (0, import_react7.useMemo)(() => {
    const i = [];
    return x2 && x2.length && P4 && x2.forEach((p2) => {
      i.push({ height: `${P4}px`, top: `${p2.$y - 3}px` });
    }), i;
  }, [S4, P4]), a2 = (0, import_react7.useMemo)(
    () => Math.max(L5 || 0, n),
    [L5, n]
  );
  (0, import_react7.useEffect)(() => {
    const i = I6.current;
    i && typeof m == "number" && (i.scrollTop = m);
  }, [m]);
  const B4 = () => {
    O4();
  };
  function O4(i) {
    const p2 = I6.current;
    if (!p2) return;
    const W4 = {};
    W4.left = p2.scrollLeft, u.exec("scroll-chart", W4);
  }
  function J7() {
    const i = I6.current, W4 = Math.ceil((L5 || 0) / (P4 || 1)) + 1, D3 = Math.floor((i && i.scrollTop || 0) / (P4 || 1)), Y4 = Math.max(0, D3 - C3), F4 = D3 + W4 + C3, de3 = Y4 * (P4 || 0);
    u.exec("render-data", {
      start: Y4,
      end: F4,
      from: de3
    });
  }
  (0, import_react7.useEffect)(() => {
    J7();
  }, [L5, m]);
  const j4 = (0, import_react7.useCallback)(
    (i) => {
      if (!i) return;
      const { id: p2, mode: W4 } = i;
      if (W4.toString().indexOf("x") < 0) return;
      const D3 = I6.current;
      if (!D3) return;
      const { clientWidth: Y4 } = D3, F4 = u.getTask(p2);
      if (F4.$x + F4.$w < D3.scrollLeft)
        u.exec("scroll-chart", { left: F4.$x - (T4 || 0) }), D3.scrollLeft = F4.$x - (T4 || 0);
      else if (F4.$x >= Y4 + D3.scrollLeft) {
        const de3 = Y4 < F4.$w ? T4 || 0 : F4.$w;
        u.exec("scroll-chart", { left: F4.$x - Y4 + de3 }), D3.scrollLeft = F4.$x - Y4 + de3;
      }
    },
    [u, T4]
  );
  (0, import_react7.useEffect)(() => {
    j4(E4);
  }, [E4]);
  function Q6(i) {
    if (_3 && (i.ctrlKey || i.metaKey)) {
      i.preventDefault();
      const p2 = I6.current, W4 = -Math.sign(i.deltaY), D3 = i.clientX - (p2 ? p2.getBoundingClientRect().left : 0);
      u.exec("zoom-scale", {
        dir: W4,
        offset: D3
      });
    }
  }
  function X5(i) {
    const p2 = h(i.date, i.unit);
    return p2 ? {
      css: p2,
      width: i.width
    } : null;
  }
  const z5 = (0, import_react7.useMemo)(() => c2 && (c2.minUnit === "hour" || c2.minUnit === "day") && h ? c2.rows[c2.rows.length - 1].cells.map(X5) : null, [c2, h]), U6 = (0, import_react7.useCallback)(
    (i) => {
      i.eventSource = "chart", u.exec("hotkey", i);
    },
    [u]
  );
  (0, import_react7.useEffect)(() => {
    const i = I6.current;
    if (!i) return;
    const p2 = () => G5(i.clientHeight);
    p2();
    const W4 = new ResizeObserver(() => p2());
    return W4.observe(i), () => {
      W4.disconnect();
    };
  }, [I6.current]);
  const R5 = (0, import_react7.useRef)(null);
  return (0, import_react7.useEffect)(() => {
    const i = I6.current;
    if (i && !R5.current)
      return R5.current = Pe2(i, {
        keys: {
          arrowup: true,
          arrowdown: true
        },
        exec: (p2) => U6(p2)
      }), () => {
        var _a3;
        (_a3 = R5.current) == null ? void 0 : _a3.destroy(), R5.current = null;
      };
  }, []), (0, import_react7.useEffect)(() => {
    const i = I6.current;
    if (!i) return;
    const p2 = Q6;
    return i.addEventListener("wheel", p2), () => {
      i.removeEventListener("wheel", p2);
    };
  }, [Q6]), tn("chart"), (0, import_jsx_runtime6.jsxs)(
    "div",
    {
      className: "wx-mR7v2Xag wx-chart",
      tabIndex: -1,
      ref: I6,
      onScroll: B4,
      children: [
        (0, import_jsx_runtime6.jsx)(Jt2, { highlightTime: h, scales: c2 }),
        V4 && V4.length ? (0, import_jsx_runtime6.jsx)(
          "div",
          {
            className: "wx-mR7v2Xag wx-markers",
            style: { height: `${a2}px` },
            children: V4.map((i, p2) => (0, import_jsx_runtime6.jsx)(
              "div",
              {
                className: `wx-mR7v2Xag wx-marker ${i.css || ""}`,
                style: { left: `${i.left}px` },
                children: (0, import_jsx_runtime6.jsx)("div", { className: "wx-mR7v2Xag wx-content", children: i.text })
              },
              p2
            ))
          }
        ) : null,
        (0, import_jsx_runtime6.jsxs)(
          "div",
          {
            className: "wx-mR7v2Xag wx-area",
            style: { width: `${r}px`, height: `${a2}px` },
            children: [
              z5 ? (0, import_jsx_runtime6.jsx)(
                "div",
                {
                  className: "wx-mR7v2Xag wx-gantt-holidays",
                  style: { height: "100%" },
                  children: z5.map(
                    (i, p2) => i ? (0, import_jsx_runtime6.jsx)(
                      "div",
                      {
                        className: "wx-mR7v2Xag " + i.css,
                        style: {
                          width: `${i.width}px`,
                          left: `${p2 * i.width}px`
                        }
                      },
                      p2
                    ) : null
                  )
                }
              ) : null,
              (0, import_jsx_runtime6.jsx)(qt2, { borders: N5 }),
              x2 && x2.length ? x2.map(
                (i, p2) => i.$y ? (0, import_jsx_runtime6.jsx)(
                  "div",
                  {
                    className: "wx-mR7v2Xag wx-selected",
                    "data-id": i.id,
                    style: H6[p2]
                  },
                  i.id
                ) : null
              ) : null,
              (0, import_jsx_runtime6.jsx)(Zt3, { readonly: s, taskTemplate: o2 })
            ]
          }
        )
      ]
    }
  );
}
function sn2(t2) {
  var _a2, _b;
  const {
    position: s = "after",
    size: r = 4,
    dir: n = "x",
    onMove: o2,
    onDisplayChange: N5,
    compactMode: h,
    containerWidth: u = 0,
    leftThreshold: x2 = 50,
    rightThreshold: S4 = 50
  } = t2, [m, P4] = useWritableProp((_a2 = t2.value) != null ? _a2 : 0), [T4, c2] = useWritableProp((_b = t2.display) != null ? _b : "all");
  function V4(W4) {
    let D3 = 0;
    s == "center" ? D3 = r / 2 : s == "before" && (D3 = r);
    const Y4 = {
      size: [r + "px", "auto"],
      p: [W4 - D3 + "px", "0px"],
      p2: ["auto", "0px"]
    };
    if (n != "x")
      for (let F4 in Y4) Y4[F4] = Y4[F4].reverse();
    return Y4;
  }
  const [E4, _3] = (0, import_react7.useState)(false), [L5, G5] = (0, import_react7.useState)(null), I6 = (0, import_react7.useRef)(0), C3 = (0, import_react7.useRef)(), H6 = (0, import_react7.useRef)(), a2 = (0, import_react7.useRef)(T4);
  (0, import_react7.useEffect)(() => {
    a2.current = T4;
  }, [T4]), (0, import_react7.useEffect)(() => {
    L5 === null && m > 0 && G5(m);
  }, [L5, m]);
  function B4(W4) {
    return n == "x" ? W4.clientX : W4.clientY;
  }
  const O4 = (0, import_react7.useCallback)(
    (W4) => {
      const D3 = C3.current + B4(W4) - I6.current;
      P4(D3);
      let Y4;
      D3 <= x2 ? Y4 = "chart" : u - D3 <= S4 ? Y4 = "grid" : Y4 = "all", a2.current !== Y4 && (c2(Y4), a2.current = Y4), H6.current && clearTimeout(H6.current), H6.current = setTimeout(() => o2 && o2(D3), 100);
    },
    [u, x2, S4, o2]
  ), J7 = (0, import_react7.useCallback)(() => {
    document.body.style.cursor = "", document.body.style.userSelect = "", _3(false), window.removeEventListener("mousemove", O4), window.removeEventListener("mouseup", J7);
  }, [O4]), j4 = (0, import_react7.useMemo)(
    () => T4 !== "all" ? "auto" : n == "x" ? "ew-resize" : "ns-resize",
    [T4, n]
  ), Q6 = (0, import_react7.useCallback)(
    (W4) => {
      !h && (T4 === "grid" || T4 === "chart") || (I6.current = B4(W4), C3.current = m, _3(true), document.body.style.cursor = j4, document.body.style.userSelect = "none", window.addEventListener("mousemove", O4), window.addEventListener("mouseup", J7));
    },
    [j4, O4, J7, m, h, T4]
  );
  function X5() {
    c2("all"), L5 !== null && (P4(L5), o2 && o2(L5));
  }
  function z5(W4) {
    if (h) {
      const D3 = T4 === "chart" ? "grid" : "chart";
      c2(D3), N5(D3);
    } else if (T4 === "grid" || T4 === "chart")
      X5(), N5("all");
    else {
      const D3 = W4 === "left" ? "chart" : "grid";
      c2(D3), N5(D3);
    }
  }
  function U6() {
    z5("left");
  }
  function R5() {
    z5("right");
  }
  const i = (0, import_react7.useMemo)(() => V4(m), [m, s, r, n]), p2 = [
    "wx-resizer",
    `wx-resizer-${n}`,
    `wx-resizer-display-${T4}`,
    E4 ? "wx-resizer-active" : ""
  ].filter(Boolean).join(" ");
  return (0, import_jsx_runtime6.jsxs)(
    "div",
    {
      className: "wx-pFykzMlT " + p2,
      onMouseDown: Q6,
      style: { width: i.size[0], height: i.size[1], cursor: j4 },
      children: [
        (0, import_jsx_runtime6.jsxs)("div", { className: "wx-pFykzMlT wx-button-expand-box", children: [
          (0, import_jsx_runtime6.jsx)("div", { className: "wx-pFykzMlT wx-button-expand-content wx-button-expand-left", children: (0, import_jsx_runtime6.jsx)(
            "i",
            {
              className: "wx-pFykzMlT wxi-menu-left",
              onClick: U6
            }
          ) }),
          (0, import_jsx_runtime6.jsx)("div", { className: "wx-pFykzMlT wx-button-expand-content wx-button-expand-right", children: (0, import_jsx_runtime6.jsx)(
            "i",
            {
              className: "wx-pFykzMlT wxi-menu-right",
              onClick: R5
            }
          ) })
        ] }),
        (0, import_jsx_runtime6.jsx)("div", { className: "wx-pFykzMlT wx-resizer-line" })
      ]
    }
  );
}
var rn2 = 650;
function mt4(t2) {
  let s;
  function r() {
    s = new ResizeObserver((o2) => {
      for (let N5 of o2)
        if (N5.target === document.body) {
          let h = N5.contentRect.width <= rn2;
          t2(h);
        }
    }), s.observe(document.body);
  }
  function n() {
    s && (s.disconnect(), s = null);
  }
  return {
    observe: r,
    disconnect: n
  };
}
function on(t2) {
  const {
    taskTemplate: s,
    readonly: r,
    cellBorders: n,
    highlightTime: o2,
    onTableAPIChange: N5
  } = t2, h = (0, import_react7.useContext)(De4), u = useStore(h, "_tasks"), x2 = useStore(h, "_scales"), S4 = useStore(h, "cellHeight"), m = useStore(h, "columns"), P4 = useStore(h, "_scrollTask"), T4 = useStore(h, "undo"), [c2, V4] = (0, import_react7.useState)(false);
  let [E4, _3] = (0, import_react7.useState)(0);
  const [L5, G5] = (0, import_react7.useState)(0), [I6, C3] = (0, import_react7.useState)(0), [H6, a2] = (0, import_react7.useState)(void 0), [B4, O4] = (0, import_react7.useState)("all"), J7 = (0, import_react7.useRef)(null), j4 = (0, import_react7.useCallback)(
    (v3) => {
      V4((se5) => (v3 !== se5 && (v3 ? (J7.current = B4, B4 === "all" && O4("grid")) : (!J7.current || J7.current === "all") && O4("all")), v3));
    },
    [B4]
  );
  (0, import_react7.useEffect)(() => {
    const v3 = mt4(j4);
    return v3.observe(), () => {
      v3.disconnect();
    };
  }, [j4]);
  const Q6 = (0, import_react7.useMemo)(() => {
    var _a2;
    let v3;
    return m.every((se5) => se5.width && !se5.flexgrow) ? v3 = m.reduce((se5, te5) => se5 + parseInt(te5.width), 0) : c2 && B4 === "chart" ? v3 = parseInt((_a2 = m.find((se5) => se5.id === "action")) == null ? void 0 : _a2.width) || 50 : v3 = 440, E4 = v3, v3;
  }, [m, c2, B4]);
  (0, import_react7.useEffect)(() => {
    _3(Q6);
  }, [Q6]);
  const X5 = (0, import_react7.useMemo)(
    () => (L5 != null ? L5 : 0) - (H6 != null ? H6 : 0),
    [L5, H6]
  ), z5 = (0, import_react7.useMemo)(() => x2.width, [x2]), U6 = (0, import_react7.useMemo)(
    () => u.length * S4,
    [u, S4]
  ), R5 = (0, import_react7.useMemo)(
    () => x2.height + U6 + X5,
    [x2, U6, X5]
  ), i = (0, import_react7.useMemo)(
    () => E4 + z5,
    [E4, z5]
  ), p2 = (0, import_react7.useRef)(null), W4 = (0, import_react7.useCallback)(() => {
    Promise.resolve().then(() => {
      if ((L5 != null ? L5 : 0) > (i != null ? i : 0)) {
        const v3 = (L5 != null ? L5 : 0) - E4;
        h.exec("expand-scale", { minWidth: v3 });
      }
    });
  }, [L5, i, E4, h]);
  (0, import_react7.useEffect)(() => {
    let v3;
    return p2.current && (v3 = new ResizeObserver(W4), v3.observe(p2.current)), () => {
      v3 && v3.disconnect();
    };
  }, [p2.current, W4]), (0, import_react7.useEffect)(() => {
    W4();
  }, [z5]);
  const D3 = (0, import_react7.useRef)(null), Y4 = (0, import_react7.useRef)(null), F4 = (0, import_react7.useCallback)(() => {
    const v3 = D3.current;
    v3 && h.exec("scroll-chart", {
      top: v3.scrollTop
    });
  }, [h]), de3 = (0, import_react7.useRef)({
    rTasks: [],
    rScales: { height: 0 },
    rCellHeight: 0,
    scrollSize: 0,
    ganttDiv: null,
    ganttHeight: 0
  });
  (0, import_react7.useEffect)(() => {
    de3.current = {
      rTasks: u,
      rScales: x2,
      rCellHeight: S4,
      scrollSize: X5,
      ganttDiv: D3.current,
      ganttHeight: I6 != null ? I6 : 0
    };
  }, [u, x2, S4, X5, I6]);
  const ue4 = (0, import_react7.useCallback)(
    (v3) => {
      if (!v3) return;
      const {
        rTasks: se5,
        rScales: te5,
        rCellHeight: oe5,
        scrollSize: ve3,
        ganttDiv: be4,
        ganttHeight: $e4
      } = de3.current;
      if (!be4) return;
      const { id: me4 } = v3, ke4 = se5.findIndex((Te3) => Te3.id === me4);
      if (ke4 > -1) {
        const Te3 = $e4 - te5.height, ie4 = ke4 * oe5, xe5 = be4.scrollTop;
        let he3 = null;
        ie4 < xe5 ? he3 = ie4 : ie4 + oe5 > xe5 + Te3 && (he3 = ie4 - Te3 + oe5 + ve3), he3 !== null && (h.exec("scroll-chart", { top: Math.max(he3, 0) }), D3.current.scrollTop = Math.max(he3, 0));
      }
    },
    [h]
  );
  (0, import_react7.useEffect)(() => {
    ue4(P4);
  }, [P4]), (0, import_react7.useEffect)(() => {
    const v3 = D3.current, se5 = Y4.current;
    if (!v3 || !se5) return;
    const te5 = () => {
      (0, import_react_dom2.flushSync)(() => {
        C3(v3.offsetHeight), G5(v3.offsetWidth), a2(se5.offsetWidth);
      });
    }, oe5 = new ResizeObserver(te5);
    return oe5.observe(v3), () => oe5.disconnect();
  }, [D3.current]);
  const fe4 = (0, import_react7.useRef)(null), le5 = (0, import_react7.useRef)(null);
  return (0, import_react7.useEffect)(() => {
    le5.current && (le5.current.destroy(), le5.current = null);
    const v3 = fe4.current;
    if (v3)
      return le5.current = Pe2(v3, {
        keys: {
          "ctrl+c": true,
          "ctrl+v": true,
          "ctrl+x": true,
          "ctrl+d": true,
          backspace: true,
          "ctrl+z": T4,
          "ctrl+y": T4
        },
        exec: (se5) => {
          se5.isInput || h.exec("hotkey", se5);
        }
      }), () => {
        var _a2;
        (_a2 = le5.current) == null ? void 0 : _a2.destroy(), le5.current = null;
      };
  }, [T4]), (0, import_jsx_runtime6.jsx)("div", { className: "wx-jlbQoHOz wx-gantt", ref: D3, onScroll: F4, children: (0, import_jsx_runtime6.jsx)(
    "div",
    {
      className: "wx-jlbQoHOz wx-pseudo-rows",
      style: { height: R5, width: "100%" },
      ref: Y4,
      children: (0, import_jsx_runtime6.jsx)(
        "div",
        {
          className: "wx-jlbQoHOz wx-stuck",
          style: {
            height: I6,
            width: H6
          },
          children: (0, import_jsx_runtime6.jsxs)("div", { tabIndex: 0, className: "wx-jlbQoHOz wx-layout", ref: fe4, children: [
            m.length ? (0, import_jsx_runtime6.jsxs)(import_jsx_runtime6.Fragment, { children: [
              (0, import_jsx_runtime6.jsx)(
                jt3,
                {
                  display: B4,
                  compactMode: c2,
                  columnWidth: Q6,
                  width: E4,
                  readonly: r,
                  fullHeight: U6,
                  onTableAPIChange: N5
                }
              ),
              (0, import_jsx_runtime6.jsx)(
                sn2,
                {
                  value: E4,
                  display: B4,
                  compactMode: c2,
                  containerWidth: L5,
                  onMove: (v3) => _3(v3),
                  onDisplayChange: (v3) => O4(v3)
                }
              )
            ] }) : null,
            (0, import_jsx_runtime6.jsx)("div", { className: "wx-jlbQoHOz wx-content", ref: p2, children: (0, import_jsx_runtime6.jsx)(
              nn2,
              {
                readonly: r,
                fullWidth: z5,
                fullHeight: U6,
                taskTemplate: s,
                cellBorders: n,
                highlightTime: o2
              }
            ) })
          ] })
        }
      )
    }
  ) });
}
function ln2(t2) {
  return {
    year: "%Y",
    quarter: `${t2("Q")} %Q`,
    month: "%M",
    week: `${t2("Week")} %w`,
    day: "%M %j",
    hour: "%H:%i"
  };
}
function cn(t2, s) {
  return typeof t2 == "function" ? t2 : dateToString(t2, s);
}
function xt4(t2, s) {
  return t2.map((_a2) => {
    var _b = _a2, { format: r } = _b, n = __objRest(_b, ["format"]);
    return __spreadProps(__spreadValues({}, n), {
      format: cn(r, s)
    });
  });
}
function an2(t2, s) {
  const r = ln2(s);
  for (let n in r)
    r[n] = dateToString(r[n], t2);
  return r;
}
function dn2(t2, s) {
  if (!t2 || !t2.length) return t2;
  const r = dateToString("%d-%m-%Y", s);
  return t2.map((n) => n.template ? n : n.id === "start" || n.id == "end" ? __spreadProps(__spreadValues({}, n), {
    //store locale template for unscheduled tasks
    _template: (o2) => r(o2),
    template: (o2) => r(o2)
  }) : n.id === "duration" ? __spreadProps(__spreadValues({}, n), {
    _template: (o2) => o2,
    template: (o2) => o2
  }) : n);
}
function un2(t2, s) {
  return t2.levels ? __spreadProps(__spreadValues({}, t2), {
    levels: t2.levels.map((r) => __spreadProps(__spreadValues({}, r), {
      scales: xt4(r.scales, s)
    }))
  }) : t2;
}
var fn2 = (t2) => t2.split("-").map((s) => s ? s.charAt(0).toUpperCase() + s.slice(1) : "").join("");
var hn2 = [
  { unit: "month", step: 1, format: "%F %Y" },
  { unit: "day", step: 1, format: "%j" }
];
var An2 = (0, import_react7.forwardRef)(function(_a2, D3) {
  var _b = _a2, {
    taskTemplate: s = null,
    markers: r = [],
    taskTypes: n = bt,
    tasks: o2 = [],
    selected: N5 = [],
    activeTask: h = null,
    links: u = [],
    scales: x2 = hn2,
    columns: S4 = Ya,
    start: m = null,
    end: P4 = null,
    lengthUnit: T4 = "day",
    durationUnit: c2 = "day",
    cellWidth: V4 = 100,
    cellHeight: E4 = 38,
    scaleHeight: _3 = 36,
    readonly: L5 = false,
    cellBorders: G5 = "full",
    zoom: I6 = false,
    baselines: C3 = false,
    highlightTime: H6 = null,
    init: a2 = null,
    autoScale: B4 = true,
    unscheduledTasks: O4 = false,
    criticalPath: J7 = null,
    schedule: j4 = { type: "forward" },
    projectStart: Q6 = null,
    projectEnd: X5 = null,
    calendar: z5 = null,
    undo: U6 = false,
    splitTasks: R5 = false,
    summary: i = null,
    _export: p2 = false
  } = _b, W4 = __objRest(_b, [
    "taskTemplate",
    "markers",
    "taskTypes",
    "tasks",
    "selected",
    "activeTask",
    "links",
    "scales",
    "columns",
    "start",
    "end",
    "lengthUnit",
    "durationUnit",
    "cellWidth",
    "cellHeight",
    "scaleHeight",
    "readonly",
    "cellBorders",
    "zoom",
    "baselines",
    "highlightTime",
    "init",
    "autoScale",
    "unscheduledTasks",
    "criticalPath",
    "schedule",
    "projectStart",
    "projectEnd",
    "calendar",
    "undo",
    "splitTasks",
    "summary",
    "_export"
  ]);
  const Y4 = (0, import_react7.useRef)();
  Y4.current = W4;
  const F4 = (0, import_react7.useMemo)(() => new Fa(writable), []), de3 = (0, import_react7.useMemo)(() => __spreadValues(__spreadValues({}, en_default), en_default2), []), ue4 = (0, import_react7.useContext)(Dt.i18n), fe4 = (0, import_react7.useMemo)(() => ue4 ? ue4.extend(de3, true) : locale(de3), [ue4, de3]), le5 = (0, import_react7.useMemo)(() => fe4.getRaw().calendar, [fe4]), v3 = (0, import_react7.useMemo)(() => {
    let ie4 = {
      zoom: un2(I6, le5),
      scales: xt4(x2, le5),
      columns: dn2(S4, le5),
      links: ue2(u),
      cellWidth: V4
    };
    return ie4.zoom && (ie4 = __spreadValues(__spreadValues({}, ie4), _a(
      ie4.zoom,
      an2(le5, fe4.getGroup("gantt")),
      ie4.scales,
      V4
    ))), ie4;
  }, [I6, x2, S4, u, V4, le5, fe4]), se5 = (0, import_react7.useRef)(null);
  se5.current !== o2 && (p2 || ge2(o2, { durationUnit: c2, splitTasks: R5, calendar: z5 }), se5.current = o2), (0, import_react7.useEffect)(() => {
    p2 || ge2(o2, { durationUnit: c2, splitTasks: R5, calendar: z5 });
  }, [o2, c2, z5, R5, p2]);
  const te5 = (0, import_react7.useMemo)(() => F4.in, [F4]), oe5 = (0, import_react7.useRef)(null);
  oe5.current === null && (oe5.current = new EventBusRouter((ie4, xe5) => {
    const he3 = "on" + fn2(ie4);
    Y4.current && Y4.current[he3] && Y4.current[he3](xe5);
  }), te5.setNext(oe5.current));
  const [ve3, be4] = (0, import_react7.useState)(null), $e4 = (0, import_react7.useRef)(null);
  $e4.current = ve3;
  const me4 = (0, import_react7.useMemo)(
    () => ({
      getState: F4.getState.bind(F4),
      getReactiveState: F4.getReactive.bind(F4),
      getStores: () => ({ data: F4 }),
      exec: te5.exec,
      setNext: (ie4) => (oe5.current = oe5.current.setNext(ie4), oe5.current),
      intercept: te5.intercept.bind(te5),
      on: te5.on.bind(te5),
      detach: te5.detach.bind(te5),
      getTask: F4.getTask.bind(F4),
      serialize: () => F4.serialize(),
      getTable: (ie4) => ie4 ? new Promise((xe5) => setTimeout(() => xe5($e4.current), 1)) : $e4.current,
      getHistory: () => F4.getHistory()
    }),
    [F4, te5]
  );
  (0, import_react7.useImperativeHandle)(
    D3,
    () => __spreadValues({}, me4),
    [me4]
  );
  const ke4 = (0, import_react7.useRef)(0);
  (0, import_react7.useEffect)(() => {
    ke4.current ? F4.init({
      tasks: o2,
      links: v3.links,
      start: m,
      columns: v3.columns,
      end: P4,
      lengthUnit: T4,
      cellWidth: v3.cellWidth,
      cellHeight: E4,
      scaleHeight: _3,
      scales: v3.scales,
      taskTypes: n,
      zoom: v3.zoom,
      selected: N5,
      activeTask: h,
      baselines: C3,
      autoScale: B4,
      unscheduledTasks: O4,
      markers: r,
      durationUnit: c2,
      criticalPath: J7,
      schedule: j4,
      projectStart: Q6,
      projectEnd: X5,
      calendar: z5,
      undo: U6,
      _weekStart: le5.weekStart,
      splitTasks: R5,
      summary: i
    }) : a2 && a2(me4), ke4.current++;
  }, [
    me4,
    a2,
    o2,
    v3,
    m,
    P4,
    T4,
    E4,
    _3,
    n,
    N5,
    h,
    C3,
    B4,
    O4,
    r,
    c2,
    J7,
    j4,
    Q6,
    X5,
    z5,
    U6,
    le5,
    R5,
    i,
    F4
  ]), ke4.current === 0 && F4.init({
    tasks: o2,
    links: v3.links,
    start: m,
    columns: v3.columns,
    end: P4,
    lengthUnit: T4,
    cellWidth: v3.cellWidth,
    cellHeight: E4,
    scaleHeight: _3,
    scales: v3.scales,
    taskTypes: n,
    zoom: v3.zoom,
    selected: N5,
    activeTask: h,
    baselines: C3,
    autoScale: B4,
    unscheduledTasks: O4,
    markers: r,
    durationUnit: c2,
    criticalPath: J7,
    schedule: j4,
    projectStart: Q6,
    projectEnd: X5,
    calendar: z5,
    undo: U6,
    _weekStart: le5.weekStart,
    splitTasks: R5,
    summary: i
  });
  const Te3 = (0, import_react7.useMemo)(() => z5 ? (ie4, xe5) => xe5 == "day" && !z5.getDayHours(ie4) || xe5 == "hour" && !z5.getDayHours(ie4) ? "wx-weekend" : "" : H6, [z5, H6]);
  return (0, import_jsx_runtime6.jsx)(Dt.i18n.Provider, { value: fe4, children: (0, import_jsx_runtime6.jsx)(De4.Provider, { value: me4, children: (0, import_jsx_runtime6.jsx)(
    on,
    {
      taskTemplate: s,
      readonly: L5,
      cellBorders: G5,
      highlightTime: Te3,
      onTableAPIChange: be4
    }
  ) }) });
});
function Hn2({ api: t2 = null, items: s = [] }) {
  const r = (0, import_react7.useContext)(Dt.i18n), n = (0, import_react7.useMemo)(() => r || locale(en_default2), [r]), o2 = (0, import_react7.useMemo)(() => n.getGroup("gantt"), [n]), N5 = useStoreLater(t2, "_selected"), h = useStoreLater(t2, "undo"), u = useStoreLater(t2, "history"), x2 = useStoreLater(t2, "splitTasks"), S4 = ["undo", "redo"], m = (0, import_react7.useMemo)(() => {
    const T4 = Ka({ undo: true, splitTasks: true });
    return (s.length ? s : Ka({
      undo: h,
      splitTasks: x2
    })).map((V4) => {
      let E4 = __spreadProps(__spreadValues({}, V4), { disabled: false });
      return E4.handler = fe2(T4, E4.id) ? (_3) => Q2(t2, _3.id, null, o2) : E4.handler, E4.text && (E4.text = o2(E4.text)), E4.menuText && (E4.menuText = o2(E4.menuText)), E4;
    });
  }, [s, t2, o2, h, x2]), P4 = (0, import_react7.useMemo)(() => {
    const T4 = [];
    return m.forEach((c2) => {
      const V4 = c2.id;
      if (V4 === "add-task")
        T4.push(c2);
      else if (S4.includes(V4))
        S4.includes(V4) && T4.push(__spreadProps(__spreadValues({}, c2), {
          disabled: c2.isDisabled(u)
        }));
      else {
        if (!(N5 == null ? void 0 : N5.length) || !t2) return;
        T4.push(__spreadProps(__spreadValues({}, c2), {
          disabled: c2.isDisabled && N5.some((E4) => c2.isDisabled(E4, t2.getState()))
        }));
      }
    }), T4.filter((c2, V4) => {
      if (t2 && c2.isHidden)
        return !N5.some((E4) => c2.isHidden(E4, t2.getState()));
      if (c2.comp === "separator") {
        const E4 = T4[V4 + 1];
        if (!E4 || E4.comp === "separator") return false;
      }
      return true;
    });
  }, [t2, N5, u, m]);
  return r ? (0, import_jsx_runtime6.jsx)(pe3, { items: P4 }) : (0, import_jsx_runtime6.jsx)(Dt.i18n.Provider, { value: n, children: (0, import_jsx_runtime6.jsx)(pe3, { items: P4 }) });
}
var In3 = (0, import_react7.forwardRef)(function({
  options: s = [],
  api: r = null,
  resolver: n = null,
  filter: o2 = null,
  at: N5 = "point",
  children: h,
  onClick: u,
  css: x2
}, S4) {
  var _a2;
  const m = (0, import_react7.useRef)(null), P4 = (0, import_react7.useRef)(null), T4 = (0, import_react7.useContext)(Dt.i18n), c2 = (0, import_react7.useMemo)(() => T4 || locale(__spreadValues(__spreadValues({}, en_default2), en_default)), [T4]), V4 = (0, import_react7.useMemo)(() => c2.getGroup("gantt"), [c2]), E4 = useStoreLater(r, "taskTypes"), _3 = useStoreLater(r, "selected"), L5 = useStoreLater(r, "_selected"), G5 = useStoreLater(r, "splitTasks"), I6 = useStoreLater(r, "summary"), C3 = (0, import_react7.useMemo)(
    () => ({
      splitTasks: G5,
      taskTypes: E4,
      summary: I6
    }),
    [G5, E4, I6]
  ), H6 = (0, import_react7.useMemo)(() => La(C3), [C3]);
  (0, import_react7.useEffect)(() => {
    r && (r.on("scroll-chart", () => {
      m.current && m.current.show && m.current.show();
    }), r.on("drag-task", () => {
      m.current && m.current.show && m.current.show();
    }));
  }, [r]);
  function a2(R5) {
    return R5.map((i) => (i = __spreadValues({}, i), i.text && (i.text = V4(i.text)), i.subtext && (i.subtext = V4(i.subtext)), i.data && (i.data = a2(i.data)), i));
  }
  function B4() {
    const R5 = s.length ? s : La(C3);
    return a2(R5);
  }
  const O4 = (0, import_react7.useMemo)(() => B4(), [r, s, C3, V4]), J7 = (0, import_react7.useMemo)(
    () => L5 && L5.length ? L5 : [],
    [L5]
  ), j4 = (0, import_react7.useCallback)(
    (R5, i) => {
      let p2 = R5 ? r == null ? void 0 : r.getTask(R5) : null;
      if (n) {
        const W4 = n(R5, i);
        p2 = W4 === true ? p2 : W4;
      }
      if (p2) {
        const W4 = locateID(i.target, "data-segment");
        W4 !== null ? P4.current = { id: p2.id, segmentIndex: W4 } : P4.current = p2.id, (!Array.isArray(_3) || !_3.includes(p2.id)) && r && r.exec && r.exec("select-task", { id: p2.id });
      }
      return p2;
    },
    [r, n, _3]
  ), Q6 = (0, import_react7.useCallback)(
    (R5) => {
      const i = R5.action;
      i && (fe2(H6, i.id) && Q2(r, i.id, P4.current, V4), u && u(R5));
    },
    [r, V4, u, H6]
  ), X5 = (0, import_react7.useCallback)(
    (R5, i) => {
      const p2 = J7.length ? J7 : i ? [i] : [];
      let W4 = o2 ? p2.every((D3) => o2(R5, D3)) : true;
      if (W4 && (R5.isHidden && (W4 = !p2.some(
        (D3) => R5.isHidden(D3, r.getState(), P4.current)
      )), R5.isDisabled)) {
        const D3 = p2.some(
          (Y4) => R5.isDisabled(Y4, r.getState(), P4.current)
        );
        R5.disabled = D3;
      }
      return W4;
    },
    [o2, J7, r]
  );
  (0, import_react7.useImperativeHandle)(S4, () => ({
    show: (R5, i) => {
      m.current && m.current.show && m.current.show(R5, i);
    }
  }));
  const z5 = (0, import_react7.useCallback)((R5) => {
    m.current && m.current.show && m.current.show(R5);
  }, []), U6 = (0, import_jsx_runtime6.jsxs)(import_jsx_runtime6.Fragment, { children: [
    (0, import_jsx_runtime6.jsx)(
      ct2,
      {
        filter: X5,
        options: O4,
        dataKey: "id",
        resolver: j4,
        onClick: Q6,
        at: N5,
        ref: m,
        css: x2
      }
    ),
    (0, import_jsx_runtime6.jsx)("span", { onContextMenu: z5, "data-menu-ignore": "true", children: typeof h == "function" ? h() : h })
  ] });
  if (!T4 && ((_a2 = Dt.i18n) == null ? void 0 : _a2.Provider)) {
    const R5 = Dt.i18n.Provider;
    return (0, import_jsx_runtime6.jsx)(R5, { value: c2, children: U6 });
  }
  return U6;
});
function mn2({ api: t2, autoSave: s, onLinksChange: r }) {
  const o2 = (0, import_react7.useContext)(Dt.i18n).getGroup("gantt"), N5 = useStore(t2, "activeTask"), h = useStore(t2, "_activeTask"), u = useStore(t2, "_links"), x2 = useStore(t2, "schedule"), S4 = useStore(t2, "unscheduledTasks"), [m, P4] = (0, import_react7.useState)();
  function T4() {
    if (N5) {
      const _3 = u.filter((G5) => G5.target == N5).map((G5) => ({ link: G5, task: t2.getTask(G5.source) })), L5 = u.filter((G5) => G5.source == N5).map((G5) => ({ link: G5, task: t2.getTask(G5.target) }));
      return [
        { title: o2("Predecessors"), data: _3 },
        { title: o2("Successors"), data: L5 }
      ];
    }
  }
  (0, import_react7.useEffect)(() => {
    P4(T4());
  }, [N5, u]);
  const c2 = (0, import_react7.useMemo)(
    () => [
      { id: "e2s", label: o2("End-to-start") },
      { id: "s2s", label: o2("Start-to-start") },
      { id: "e2e", label: o2("End-to-end") },
      { id: "s2e", label: o2("Start-to-end") }
    ],
    [o2]
  );
  function V4(_3) {
    s ? t2.exec("delete-link", { id: _3 }) : (P4(
      (L5) => (L5 || []).map((G5) => __spreadProps(__spreadValues({}, G5), {
        data: G5.data.filter((I6) => I6.link.id !== _3)
      }))
    ), r && r({
      id: _3,
      action: "delete-link",
      data: { id: _3 }
    }));
  }
  function E4(_3, L5) {
    s ? t2.exec("update-link", {
      id: _3,
      link: L5
    }) : (P4(
      (G5) => (G5 || []).map((I6) => __spreadProps(__spreadValues({}, I6), {
        data: I6.data.map(
          (C3) => C3.link.id === _3 ? __spreadProps(__spreadValues({}, C3), { link: __spreadValues(__spreadValues({}, C3.link), L5) }) : C3
        )
      }))
    ), r && r({
      id: _3,
      action: "update-link",
      data: {
        id: _3,
        link: L5
      }
    }));
  }
  return (0, import_jsx_runtime6.jsx)(import_jsx_runtime6.Fragment, { children: (m || []).map(
    (_3, L5) => _3.data.length ? (0, import_jsx_runtime6.jsx)("div", { className: "wx-j93aYGQf wx-links", children: (0, import_jsx_runtime6.jsx)(Dt.fieldId.Provider, { value: null, children: (0, import_jsx_runtime6.jsx)(ye, { label: _3.title, position: "top", children: (0, import_jsx_runtime6.jsx)("table", { children: (0, import_jsx_runtime6.jsx)("tbody", { children: _3.data.map((G5) => (0, import_jsx_runtime6.jsxs)("tr", { children: [
      (0, import_jsx_runtime6.jsx)("td", { className: "wx-j93aYGQf wx-cell", children: (0, import_jsx_runtime6.jsx)("div", { className: "wx-j93aYGQf wx-task-name", children: G5.task.text || "" }) }),
      (x2 == null ? void 0 : x2.auto) && G5.link.type === "e2s" ? (0, import_jsx_runtime6.jsx)("td", { className: "wx-j93aYGQf wx-cell wx-link-lag", children: (0, import_jsx_runtime6.jsx)(
        fe,
        {
          type: "number",
          placeholder: o2("Lag"),
          value: G5.link.lag,
          disabled: S4 && (h == null ? void 0 : h.unscheduled),
          onChange: (I6) => {
            I6.input || E4(G5.link.id, { lag: I6.value });
          }
        }
      ) }) : null,
      (0, import_jsx_runtime6.jsx)("td", { className: "wx-j93aYGQf wx-cell", children: (0, import_jsx_runtime6.jsx)("div", { className: "wx-j93aYGQf wx-wrapper", children: (0, import_jsx_runtime6.jsx)(
        It,
        {
          value: G5.link.type,
          placeholder: o2("Select link type"),
          options: c2,
          onChange: (I6) => E4(G5.link.id, { type: I6.value }),
          children: ({ option: I6 }) => I6.label
        }
      ) }) }),
      (0, import_jsx_runtime6.jsx)("td", { className: "wx-j93aYGQf wx-cell", children: (0, import_jsx_runtime6.jsx)(
        "i",
        {
          className: "wx-j93aYGQf wxi-delete wx-delete-icon",
          onClick: () => V4(G5.link.id),
          role: "button"
        }
      ) })
    ] }, G5.link.id)) }) }) }) }) }, L5) : null
  ) });
}
function xn2(t2) {
  const _a2 = t2, { value: s, time: r, format: n, onchange: o2, onChange: N5 } = _a2, h = __objRest(_a2, ["value", "time", "format", "onchange", "onChange"]), u = N5 != null ? N5 : o2;
  function x2(S4) {
    const m = new Date(S4.value);
    m.setHours(s.getHours()), m.setMinutes(s.getMinutes()), u && u({ value: m });
  }
  return (0, import_jsx_runtime6.jsxs)("div", { className: "wx-hFsbgDln date-time-controll", children: [
    (0, import_jsx_runtime6.jsx)(
      Rt,
      __spreadProps(__spreadValues({}, h), {
        value: s,
        onChange: x2,
        format: n,
        buttons: ["today"],
        clear: false
      })
    ),
    r ? (0, import_jsx_runtime6.jsx)(Gt, { value: s, onChange: u, format: n }) : null
  ] });
}
z4("select", Et);
z4("date", xn2);
z4("twostate", mt);
z4("slider", ke);
z4("counter", jt);
z4("links", mn2);
function zn2({
  api: t2,
  items: s = [],
  css: r = "",
  layout: n = "default",
  readonly: o2 = false,
  placement: N5 = "sidebar",
  bottomBar: h = true,
  topBar: u = true,
  autoSave: x2 = true,
  focus: S4 = false,
  hotkeys: m = {}
}) {
  const P4 = (0, import_react7.useContext)(Dt.i18n), T4 = (0, import_react7.useMemo)(() => P4 || locale(__spreadValues(__spreadValues({}, en_default2), en_default)), [P4]), c2 = (0, import_react7.useMemo)(() => T4.getGroup("gantt"), [T4]), V4 = T4.getRaw(), E4 = (0, import_react7.useMemo)(() => {
    var _a2, _b;
    const w = ((_a2 = V4.gantt) == null ? void 0 : _a2.dateFormat) || ((_b = V4.formats) == null ? void 0 : _b.dateFormat);
    return dateToString(w, V4.calendar);
  }, [V4]), _3 = (0, import_react7.useMemo)(() => {
    if (u === true && !o2) {
      const w = [
        { comp: "icon", icon: "wxi-close", id: "close" },
        { comp: "spacer" },
        {
          comp: "button",
          type: "danger",
          text: c2("Delete"),
          id: "delete"
        }
      ];
      return x2 ? { items: w } : {
        items: [
          ...w,
          {
            comp: "button",
            type: "primary",
            text: c2("Save"),
            id: "save"
          }
        ]
      };
    }
    return u;
  }, [u, o2, x2, c2]), [L5, G5] = (0, import_react7.useState)(false), I6 = (0, import_react7.useMemo)(
    () => L5 ? "wx-full-screen" : "",
    [L5]
  ), C3 = (0, import_react7.useCallback)((w) => {
    G5(w);
  }, []);
  (0, import_react7.useEffect)(() => {
    const w = mt4(C3);
    return w.observe(), () => {
      w.disconnect();
    };
  }, [C3]);
  const H6 = useStore(t2, "_activeTask"), a2 = useStore(t2, "activeTask"), B4 = useStore(t2, "unscheduledTasks"), O4 = useStore(t2, "summary"), J7 = useStore(t2, "links"), j4 = useStore(t2, "splitTasks"), Q6 = (0, import_react7.useMemo)(
    () => j4 && (a2 == null ? void 0 : a2.segmentIndex),
    [j4, a2]
  ), X5 = (0, import_react7.useMemo)(
    () => Q6 || Q6 === 0,
    [Q6]
  ), z5 = useStore(t2, "taskTypes"), U6 = (0, import_react7.useMemo)(
    () => Za({ unscheduledTasks: B4, summary: O4, taskTypes: z5 }),
    [B4, O4, z5]
  ), R5 = useStore(t2, "undo"), [i, p2] = (0, import_react7.useState)({}), [W4, D3] = (0, import_react7.useState)(null), [Y4, F4] = (0, import_react7.useState)(), [de3, ue4] = (0, import_react7.useState)(null), fe4 = (0, import_react7.useMemo)(() => {
    if (!H6) return null;
    let w;
    if (X5 && H6.segments ? w = __spreadValues({}, H6.segments[Q6]) : w = __spreadValues({}, H6), o2) {
      let ne4 = { parent: w.parent };
      return U6.forEach(({ key: ce6, comp: K6 }) => {
        if (K6 !== "links") {
          const ae5 = w[ce6];
          K6 === "date" && ae5 instanceof Date ? ne4[ce6] = E4(ae5) : K6 === "slider" && ce6 === "progress" ? ne4[ce6] = `${ae5}%` : ne4[ce6] = ae5;
        }
      }), ne4;
    }
    return w || null;
  }, [H6, X5, Q6, o2, U6, E4]);
  (0, import_react7.useEffect)(() => {
    F4(fe4);
  }, [fe4]), (0, import_react7.useEffect)(() => {
    p2({}), ue4(null), D3(null);
  }, [a2]);
  function le5(w, ne4) {
    return w.map((ce6) => {
      var _a2, _b;
      const K6 = __spreadValues({}, ce6);
      if (ce6.config && (K6.config = __spreadValues({}, K6.config)), K6.comp === "links" && t2 && (K6.api = t2, K6.autoSave = x2, K6.onLinksChange = te5), K6.comp === "select" && K6.key === "type") {
        const ae5 = (_a2 = K6.options) != null ? _a2 : [];
        K6.options = ae5.map((Me4) => __spreadProps(__spreadValues({}, Me4), {
          label: c2(Me4.label)
        }));
      }
      return K6.comp === "slider" && K6.key === "progress" && (K6.labelTemplate = (ae5) => `${c2(K6.label)} ${ae5}%`), K6.label && (K6.label = c2(K6.label)), ((_b = K6.config) == null ? void 0 : _b.placeholder) && (K6.config.placeholder = c2(K6.config.placeholder)), ne4 && (K6.isDisabled && K6.isDisabled(ne4, t2.getState()) ? K6.disabled = true : delete K6.disabled), K6;
    });
  }
  const v3 = (0, import_react7.useMemo)(() => {
    let w = s.length ? s : U6;
    return w = le5(w, Y4), Y4 ? w.filter(
      (ne4) => !ne4.isHidden || !ne4.isHidden(Y4, t2.getState())
    ) : w;
  }, [s, U6, Y4, c2, t2, x2]), se5 = (0, import_react7.useMemo)(
    () => v3.map((w) => w.key),
    [v3]
  );
  function te5({ id: w, action: ne4, data: ce6 }) {
    p2((K6) => __spreadProps(__spreadValues({}, K6), {
      [w]: { action: ne4, data: ce6 }
    }));
  }
  const oe5 = (0, import_react7.useCallback)(() => {
    for (let w in i)
      if (J7.byId(w)) {
        const { action: ne4, data: ce6 } = i[w];
        t2.exec(ne4, ce6);
      }
  }, [t2, i, J7]), ve3 = (0, import_react7.useCallback)(() => {
    const w = (a2 == null ? void 0 : a2.id) || a2;
    if (X5) {
      if (H6 == null ? void 0 : H6.segments) {
        const ne4 = H6.segments.filter(
          (ce6, K6) => K6 !== Q6
        );
        t2.exec("update-task", {
          id: w,
          task: { segments: ne4 }
        });
      }
    } else
      t2.exec("delete-task", { id: w });
  }, [t2, a2, X5, H6, Q6]), be4 = (0, import_react7.useCallback)(() => {
    t2.exec("show-editor", { id: null });
  }, [t2]), $e4 = (0, import_react7.useCallback)(
    (w) => {
      const { item: ne4, changes: ce6 } = w;
      ne4.id === "delete" && ve3(), ne4.id === "save" && (ce6.length ? be4() : oe5()), ne4.comp && be4();
    },
    [t2, a2, x2, oe5, ve3, be4]
  ), me4 = (0, import_react7.useCallback)(
    (w, ne4, ce6) => (B4 && w.type === "summary" && (w.unscheduled = false), Ba(w, t2.getState(), ne4), ce6 || D3(false), w),
    [B4, t2]
  ), ke4 = (0, import_react7.useCallback)(
    (w) => {
      w = __spreadProps(__spreadValues({}, w), {
        unscheduled: B4 && w.unscheduled && w.type !== "summary"
      }), delete w.links, delete w.data, (se5.indexOf("duration") === -1 || w.segments && !w.duration) && delete w.duration;
      const ne4 = __spreadValues({
        id: (a2 == null ? void 0 : a2.id) || a2,
        task: w
      }, X5 && { segmentIndex: Q6 });
      x2 && W4 && (ne4.inProgress = W4), t2.exec("update-task", ne4), x2 || oe5();
    },
    [
      t2,
      a2,
      B4,
      x2,
      oe5,
      se5,
      X5,
      Q6,
      W4
    ]
  ), Te3 = (0, import_react7.useCallback)(
    (w) => {
      let { update: ne4, key: ce6, input: K6 } = w;
      if (K6 && D3(true), w.update = me4(__spreadValues({}, ne4), ce6, K6), !x2) F4(w.update);
      else if (!de3 && !K6) {
        const ae5 = v3.find((l2) => l2.key === ce6), Me4 = ne4[ce6];
        (!ae5.validation || ae5.validation(Me4)) && (!ae5.required || Me4) && ke4(w.update);
      }
    },
    [x2, me4, de3, v3, ke4]
  ), ie4 = (0, import_react7.useCallback)(
    (w) => {
      x2 || ke4(w.values);
    },
    [x2, ke4]
  ), xe5 = (0, import_react7.useCallback)((w) => {
    ue4(w.errors);
  }, []), he3 = (0, import_react7.useMemo)(
    () => R5 ? {
      "ctrl+z": (w) => {
        w.preventDefault(), t2.exec("undo");
      },
      "ctrl+y": (w) => {
        w.preventDefault(), t2.exec("redo");
      }
    } : {},
    [R5, t2]
  );
  return fe4 ? (0, import_jsx_runtime6.jsx)(ue, { children: (0, import_jsx_runtime6.jsx)(
    Fe3,
    {
      css: `wx-XkvqDXuw wx-gantt-editor ${I6} ${r}`,
      items: v3,
      values: fe4,
      topBar: _3,
      bottomBar: h,
      placement: N5,
      layout: n,
      readonly: o2,
      autoSave: x2,
      focus: S4,
      onAction: $e4,
      onSave: ie4,
      onValidation: xe5,
      onChange: Te3,
      hotkeys: m && __spreadValues(__spreadValues({}, he3), m)
    }
  ) }) : null;
}
var Gn2 = ({ children: t2, columns: s = null, api: r }) => {
  const [n, o2] = (0, import_react7.useState)(null);
  return (0, import_react7.useEffect)(() => {
    r && r.getTable(true).then(o2);
  }, [r]), (0, import_jsx_runtime6.jsx)(so, { api: n, columns: s, children: t2 });
};
function Wn3(t2) {
  const { api: s, content: r, children: n } = t2, o2 = (0, import_react7.useRef)(null), N5 = (0, import_react7.useRef)(null), [h, u] = (0, import_react7.useState)({}), [x2, S4] = (0, import_react7.useState)(null), [m, P4] = (0, import_react7.useState)({});
  function T4(C3) {
    for (; C3; ) {
      if (C3.getAttribute) {
        const H6 = C3.getAttribute("data-tooltip-id"), a2 = C3.getAttribute("data-tooltip-at"), B4 = C3.getAttribute("data-tooltip");
        if (H6 || B4) return { id: H6, tooltip: B4, target: C3, at: a2 };
      }
      C3 = C3.parentNode;
    }
    return { id: null, tooltip: null, target: null, at: null };
  }
  (0, import_react7.useEffect)(() => {
    const C3 = N5.current;
    if (C3 && m && (m.text || r)) {
      const H6 = C3.getBoundingClientRect();
      let a2 = false, B4 = m.left, O4 = m.top;
      H6.right >= h.right && (B4 = h.width - H6.width - 5, a2 = true), H6.bottom >= h.bottom && (O4 = m.top - (H6.bottom - h.bottom + 2), a2 = true), a2 && P4((J7) => J7 && __spreadProps(__spreadValues({}, J7), { left: B4, top: O4 }));
    }
  }, [m, h, r]);
  const c2 = (0, import_react7.useRef)(null), V4 = 300, E4 = (C3) => {
    clearTimeout(c2.current), c2.current = setTimeout(() => {
      C3();
    }, V4);
  };
  function _3(C3) {
    let { id: H6, tooltip: a2, target: B4, at: O4 } = T4(C3.target);
    if (P4(null), S4(null), !a2)
      if (H6)
        a2 = G5(H6);
      else {
        clearTimeout(c2.current);
        return;
      }
    const J7 = C3.clientX;
    E4(() => {
      H6 && S4(L5(I6(H6)));
      const j4 = B4.getBoundingClientRect(), Q6 = o2.current, X5 = Q6 ? Q6.getBoundingClientRect() : { top: 0, left: 0, right: 0, bottom: 0, width: 0, height: 0 };
      let z5, U6;
      O4 === "left" ? (z5 = j4.top + 5 - X5.top, U6 = j4.right + 5 - X5.left) : (z5 = j4.top + j4.height - X5.top, U6 = J7 - X5.left), u(X5), P4({ top: z5, left: U6, text: a2 });
    });
  }
  function L5(C3) {
    return (s == null ? void 0 : s.getTask(I6(C3))) || null;
  }
  function G5(C3) {
    var _a2;
    return ((_a2 = L5(C3)) == null ? void 0 : _a2.text) || "";
  }
  function I6(C3) {
    const H6 = parseInt(C3);
    return isNaN(H6) ? C3 : H6;
  }
  return (0, import_jsx_runtime6.jsxs)(
    "div",
    {
      className: "wx-KG0Lwsqo wx-tooltip-area",
      ref: o2,
      onMouseMove: _3,
      children: [
        m && (m.text || r) ? (0, import_jsx_runtime6.jsx)(
          "div",
          {
            className: "wx-KG0Lwsqo wx-gantt-tooltip",
            ref: N5,
            style: { top: `${m.top}px`, left: `${m.left}px` },
            children: r ? (0, import_jsx_runtime6.jsx)(r, { data: x2 }) : m.text ? (0, import_jsx_runtime6.jsx)("div", { className: "wx-KG0Lwsqo wx-gantt-tooltip-text", children: m.text }) : null
          }
        ) : null,
        n
      ]
    }
  );
}
function Pn3({ fonts: t2 = true, children: s }) {
  return s ? (0, import_jsx_runtime6.jsx)(zt, { fonts: t2, children: s() }) : (0, import_jsx_runtime6.jsx)(zt, { fonts: t2 });
}
function _n3({ fonts: t2 = true, children: s }) {
  return s ? (0, import_jsx_runtime6.jsx)(Kt, { fonts: t2, children: s }) : (0, import_jsx_runtime6.jsx)(Kt, { fonts: t2 });
}
function Vn2({ fonts: t2 = true, children: s }) {
  return s ? (0, import_jsx_runtime6.jsx)(Zt, { fonts: t2, children: s }) : (0, import_jsx_runtime6.jsx)(Zt, { fonts: t2 });
}
var gn2 = "2.5.2";
var wn2 = {
  version: gn2
};
var On2 = wn2.version;
export {
  In3 as ContextMenu,
  zn2 as Editor,
  An2 as Gantt,
  Gn2 as HeaderMenu,
  Pn3 as Material,
  Hn2 as Toolbar,
  Wn3 as Tooltip,
  _n3 as Willow,
  Vn2 as WillowDark,
  Ya as defaultColumns,
  _e2 as defaultEditorItems,
  be2 as defaultMenuOptions,
  bt as defaultTaskTypes,
  xe2 as defaultToolbarButtons,
  Za as getEditorItems,
  La as getMenuOptions,
  Ka as getToolbarButtons,
  z4 as registerEditorItem,
  ka as registerScaleUnit,
  On2 as version
};
//# sourceMappingURL=@svar-ui_react-gantt.js.map
