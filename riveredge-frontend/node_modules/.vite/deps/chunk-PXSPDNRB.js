import {
  Be,
  Cm,
  Cn,
  DC,
  Dn,
  Ds,
  Em,
  Eo,
  Fn,
  Hn,
  Im,
  Inject,
  Injector,
  Is,
  Ji,
  Ls,
  Mm,
  Nm,
  Oi,
  Om,
  PC,
  Pe,
  Pt,
  Rm,
  Rs,
  SC,
  Sm,
  Tm,
  Ts,
  UC,
  Ve,
  Ws,
  Yn,
  Z,
  Zt,
  _m,
  _n,
  a1,
  br,
  dI,
  dn,
  fn,
  gm,
  gs,
  ie,
  jn,
  js,
  kC,
  lu,
  pm,
  ra,
  st,
  tR,
  wC,
  we,
  wm,
  xC,
  xe,
  ye,
  yt
} from "./chunk-Y4UF2FTU.js";
import {
  filter
} from "./chunk-AR6LG6UR.js";

// node_modules/@univerjs/core/lib/es/facade.js
var W = Object.defineProperty;
var q = (i, e, t) => e in i ? W(i, e, { enumerable: true, configurable: true, writable: true, value: t }) : i[e] = t;
var d = (i, e, t) => q(i, typeof e != "symbol" ? e + "" : e, t);
var $ = class extends Ve {
  /**
   * @ignore
   */
  static extend(e) {
    Object.getOwnPropertyNames(e.prototype).forEach((t) => {
      t !== "constructor" && (this.prototype[t] = e.prototype[t]);
    }), Object.getOwnPropertyNames(e).forEach((t) => {
      t !== "prototype" && t !== "name" && t !== "length" && (this[t] = e[t]);
    });
  }
};
var S = Symbol("initializers");
var A = Symbol("manualInit");
var $e = class extends Ve {
  constructor(e) {
    if (super(), this._injector = e, !!this.constructor[A]) return;
    const n = this, o = Object.getPrototypeOf(this)[S];
    o && o.forEach(function(s) {
      s.apply(n, [e]);
    });
  }
  /**
   * @ignore
   */
  _initialize(e, ...t) {
  }
  _runInitializers(...e) {
    const t = Object.getPrototypeOf(this)[S];
    t != null && t.length && t.forEach((r) => r.apply(this, e));
  }
  static _enableManualInit() {
    this[A] = true;
  }
  /**
   * @ignore
   */
  static extend(e) {
    Object.getOwnPropertyNames(e.prototype).forEach((t) => {
      if (t === "_initialize") {
        let r = this.prototype[S];
        r || (r = [], this.prototype[S] = r), r.push(e.prototype._initialize);
      } else t !== "constructor" && (this.prototype[t] = e.prototype[t]);
    }), Object.getOwnPropertyNames(e).forEach((t) => {
      t !== "prototype" && t !== "name" && t !== "length" && (this[t] = e[t]);
    });
  }
};
var ze = Object.getOwnPropertyDescriptor;
var Ae = (i, e, t, r) => {
  for (var n = r > 1 ? void 0 : r ? ze(e, t) : e, o = i.length - 1, s; o >= 0; o--)
    (s = i[o]) && (n = s(n) || n);
  return n;
};
var Le = (i, e) => (t, r) => e(t, r, i);
var D = class extends $ {
  constructor(i, e) {
    super(), this._blob = i, this._injector = e;
  }
  /**
   * Returns a copy of this blob.
   * @returns a new blob by copying the current blob
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * const newBlob = blob.copyBlob();
   * console.log(newBlob);
   * ```
   */
  copyBlob() {
    return this._injector.createInstance(D, this._blob);
  }
  /**
   * Return the data inside this object as a blob converted to the specified content type.
   * @param contentType the content type refer to https://developer.mozilla.org/en-US/docs/Web/HTTP/MIME_types/Common_types
   * @returns a new blob by converting the current blob to the specified content type
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * const newBlob = blob.getAs('text/plain');
   * console.log(newBlob);
   * ```
   */
  getAs(i) {
    const e = this.copyBlob();
    return e.setContentType(i), e;
  }
  getDataAsString(i) {
    return this._blob === null ? Promise.resolve("") : i === void 0 ? this._blob.text() : new Promise((e, t) => {
      this._blob.arrayBuffer().then((r) => {
        const n = new TextDecoder(i).decode(r);
        e(n);
      }).catch((r) => {
        t(new Error(`Failed to read Blob as ArrayBuffer: ${r.message}`));
      });
    });
  }
  /**
   * Gets the data stored in this blob.
   * @returns the blob content as a byte array
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * const bytes = await blob.getBytes();
   * console.log(bytes);
   * ```
   */
  getBytes() {
    return this._blob ? this._blob.arrayBuffer().then((i) => new Uint8Array(i)) : Promise.reject(new Error("Blob is undefined or null."));
  }
  /**
   * Sets the data stored in this blob.
   * @param bytes a byte array
   * @returns the blob object
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * const bytes = new Uint8Array(10);
   * blob.setBytes(bytes);
   * ```
   */
  setBytes(i) {
    return this._blob = new Blob([i.buffer]), this;
  }
  setDataFromString(i, e) {
    const t = e != null ? e : "text/plain", r = new Blob([i], { type: t });
    return this._blob = r, this;
  }
  /**
   * Gets the content type of the data stored in this blob.
   * @returns the content type
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * const contentType = blob.getContentType();
   * console.log(contentType);
   * ```
   */
  getContentType() {
    var i;
    return (i = this._blob) == null ? void 0 : i.type;
  }
  /**
   * Sets the content type of the data stored in this blob.
   * @param contentType the content type refer to https://developer.mozilla.org/en-US/docs/Web/HTTP/MIME_types/Common_types
   * @returns the blob object
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * blob.setContentType('text/plain');
   * ```
   */
  setContentType(i) {
    var e;
    return this._blob = (e = this._blob) == null ? void 0 : e.slice(0, this._blob.size, i), this;
  }
};
D = Ae([
  Le(1, Inject(Injector))
], D);
var y = class y2 {
  static get() {
    if (this._instance)
      return this._instance;
    const e = new y2();
    return this._instance = e, e;
  }
  /**
   * @ignore
   */
  static extend(e) {
    Object.getOwnPropertyNames(e.prototype).forEach((t) => {
      t !== "constructor" && (this.prototype[t] = e.prototype[t]);
    }), Object.getOwnPropertyNames(e).forEach((t) => {
      t !== "prototype" && t !== "name" && t !== "length" && (this[t] = e[t]);
    });
  }
  constructor() {
    for (const e in y2.prototype)
      this[e] = y2.prototype[e];
  }
  /**
   * Defines different types of absolute references
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.AbsoluteRefType);
   * ```
   */
  get AbsoluteRefType() {
    return ye;
  }
  /**
   * Defines different types of Univer instances
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.UniverInstanceType.UNIVER_SHEET);
   * ```
   */
  get UniverInstanceType() {
    return we;
  }
  /**
   * Represents different stages in the lifecycle
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.LifecycleStages.Rendered);
   * ```
   */
  get LifecycleStages() {
    return Pe;
  }
  /**
   * Different types of data validation
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DataValidationType.LIST);
   * ```
   */
  get DataValidationType() {
    return kC;
  }
  /**
   * Different error display styles
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DataValidationErrorStyle.WARNING);
   * ```
   */
  get DataValidationErrorStyle() {
    return xC;
  }
  /**
   * Different validation rendering modes
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DataValidationRenderMode.TEXT);
   * ```
   */
  get DataValidationRenderMode() {
    return UC;
  }
  /**
   * Different validation operators
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DataValidationOperator.BETWEEN);
   * ```
   */
  get DataValidationOperator() {
    return DC;
  }
  /**
   * Different validation states
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DataValidationStatus.VALID);
   * ```
   */
  get DataValidationStatus() {
    return PC;
  }
  /**
   * Different types of commands
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.CommandType.COMMAND);
   * ```
   */
  get CommandType() {
    return Ls;
  }
  /**
   * Different baseline offsets for text baseline positioning
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.BaselineOffset.SUPERSCRIPT);
   * ```
   */
  get BaselineOffset() {
    return Zt;
  }
  /**
   * Boolean number representations
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.BooleanNumber.TRUE);
   * ```
   */
  get BooleanNumber() {
    return ie;
  }
  /**
   * Different horizontal text alignment options
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.HorizontalAlign.CENTER);
   * ```
   */
  get HorizontalAlign() {
    return Pt;
  }
  /**
   * Different text decoration styles
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.TextDecoration.DOUBLE);
   * ```
   */
  get TextDecoration() {
    return Mm;
  }
  /**
   * Different text direction options
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.TextDirection.LEFT_TO_RIGHT);
   * ```
   */
  get TextDirection() {
    return gs;
  }
  /**
   * Different vertical text alignment options
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.VerticalAlign.MIDDLE);
   * ```
   */
  get VerticalAlign() {
    return Dn;
  }
  /**
   * Different wrap strategy options
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.WrapStrategy.WRAP);
   * ```
   */
  get WrapStrategy() {
    return jn;
  }
  /**
   * Different border types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.BorderType.OUTSIDE);
   * ```
   */
  get BorderType() {
    return _m;
  }
  /**
   * Different border style types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.BorderStyleTypes.NONE);
   * ```
   */
  get BorderStyleTypes() {
    return xe;
  }
  /**
   * Auto fill series types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.AutoFillSeries.ALTERNATE_SERIES);
   * ```
   */
  get AutoFillSeries() {
    return gm;
  }
  /**
   * Color types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.ColorType.RGB);
   * ```
   */
  get ColorType() {
    return yt;
  }
  /**
   * Common hide types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.CommonHideTypes.ON);
   * ```
   */
  get CommonHideTypes() {
    return pm;
  }
  /**
   * Copy paste types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.CopyPasteType.PASTE_VALUES);
   * ```
   */
  get CopyPasteType() {
    return Em;
  }
  /**
   * Delete direction types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DeleteDirection.LEFT);
   * ```
   */
  get DeleteDirection() {
    return Cm;
  }
  /**
   * Developer metadata visibility types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.DeveloperMetadataVisibility.DOCUMENT);
   * ```
   */
  get DeveloperMetadataVisibility() {
    return Rm;
  }
  /**
   * Dimension types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.Dimension.ROWS);
   * ```
   */
  get Dimension() {
    return Im;
  }
  /**
   * Direction types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.Direction.UP);
   * ```
   */
  get Direction() {
    return wm;
  }
  /**
   * Interpolation point types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.InterpolationPointType.NUMBER);
   * ```
   */
  get InterpolationPointType() {
    return Sm;
  }
  /**
   * Locale types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.LocaleType.EN_US);
   * ```
   */
  get LocaleType() {
    return Ts;
  }
  /**
   * Mention types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.MentionType.PERSON);
   * ```
   */
  get MentionType() {
    return Oi;
  }
  /**
   * Protection types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.ProtectionType.RANGE);
   * ```
   */
  get ProtectionType() {
    return Om;
  }
  /**
   * Relative date types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.RelativeDate.TODAY);
   * ```
   */
  get RelativeDate() {
    return Nm;
  }
  /**
   * Sheet types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.SheetTypes.GRID);
   * ```
   */
  get SheetTypes() {
    return Tm;
  }
  /**
   * Theme color types
   *
   * @example
   * ```ts
   * console.log(univerAPI.Enum.ThemeColorType.ACCENT1);
   * ```
   */
  get ThemeColorType() {
    return st;
  }
};
d(y, "_instance");
var O = y;
var v = class v2 {
  static get() {
    if (this._instance)
      return this._instance;
    const e = new v2();
    return this._instance = e, e;
  }
  /**
   * @ignore
   */
  static extend(e) {
    Object.getOwnPropertyNames(e.prototype).forEach((t) => {
      t !== "constructor" && (this.prototype[t] = e.prototype[t]);
    }), Object.getOwnPropertyNames(e).forEach((t) => {
      t !== "prototype" && t !== "name" && t !== "length" && (this[t] = e[t]);
    });
  }
  constructor() {
    for (const e in v2.prototype)
      this[e] = v2.prototype[e];
  }
  /**
   * Event fired when a document is created
   * @see {@link IDocCreatedParam}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.DocCreated, (params) => {
   *   const { unitId, type, doc, unit } = params;
   *   console.log('doc created', params);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get DocCreated() {
    return "DocCreated";
  }
  /**
   * Event fired when a document is disposed
   * @see {@link IDocDisposedEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.DocDisposed, (params) => {
   *   const { unitId, unitType, snapshot } = params;
   *   console.log('doc disposed', params);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get DocDisposed() {
    return "DocDisposed";
  }
  /**
   * Event fired when life cycle is changed
   * @see {@link ILifeCycleChangedEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, (params) => {
   *   const { stage } = params;
   *   console.log('life cycle changed', params);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get LifeCycleChanged() {
    return "LifeCycleChanged";
  }
  /**
   * Event fired when a redo command is executed
   * @see {@link ICommandEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.Redo, (event) => {
   *   const { params, id, type } = event;
   *   console.log('redo command executed', event);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get Redo() {
    return "Redo";
  }
  /**
   * Event fired when an undo command is executed
   * @see {@link ICommandEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.Undo, (event) => {
   *   const { params, id, type } = event;
   *   console.log('undo command executed', event);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get Undo() {
    return "Undo";
  }
  /**
   * Event fired before a redo command is executed
   * @see {@link ICommandEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.BeforeRedo, (event) => {
   *   const { params, id, type } = event;
   *   console.log('before redo command executed', event);
   *
   *   // Cancel the redo operation
   *   event.cancel = true;
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get BeforeRedo() {
    return "BeforeRedo";
  }
  /**
   * Event fired before an undo command is executed
   * @see {@link ICommandEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.BeforeUndo, (event) => {
   *   const { params, id, type } = event;
   *   console.log('before undo command executed', event);
   *
   *   // Cancel the undo operation
   *   event.cancel = true;
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get BeforeUndo() {
    return "BeforeUndo";
  }
  /**
   * Event fired when a command is executed
   * @see {@link ICommandEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.CommandExecuted, (event) => {
   *   const { params, id, type, options } = event;
   *   console.log('command executed', event);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get CommandExecuted() {
    return "CommandExecuted";
  }
  /**
   * Event fired before a command is executed
   * @see {@link ICommandEvent}
   * @example
   * ```ts
   * const disposable = univerAPI.addEvent(univerAPI.Event.BeforeCommandExecute, (event) => {
   *   const { params, id, type, options } = event;
   *   console.log('before command executed', event);
   *
   *   // Cancel the command execution
   *   event.cancel = true;
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  get BeforeCommandExecute() {
    return "BeforeCommandExecute";
  }
};
d(v, "_instance");
var j = v;
var Ne = Object.getOwnPropertyDescriptor;
var Fe = (i, e, t, r) => {
  for (var n = r > 1 ? void 0 : r ? Ne(e, t) : e, o = i.length - 1, s; o >= 0; o--)
    (s = i[o]) && (n = s(n) || n);
  return n;
};
var L = (i, e) => (t, r) => e(t, r, i);
var P = class extends $ {
  constructor(i, e) {
    super(), this._injector = i, this._lifecycleService = e;
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, ({ stage }) => {})` as instead
   */
  onStarting(i) {
    return Be(this._lifecycleService.lifecycle$.pipe(filter((e) => e === Pe.Starting)).subscribe(i));
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, ({ stage }) => {})` as instead
   */
  onReady(i) {
    return Be(this._lifecycleService.lifecycle$.pipe(filter((e) => e === Pe.Ready)).subscribe(i));
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, ({ stage }) => {})` as instead
   */
  onRendered(i) {
    return Be(this._lifecycleService.lifecycle$.pipe(filter((e) => e === Pe.Rendered)).subscribe(i));
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, ({ stage }) => {})` as instead
   */
  onSteady(i) {
    return Be(this._lifecycleService.lifecycle$.pipe(filter((e) => e === Pe.Steady)).subscribe(i));
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.BeforeUndo, (event) => {})` as instead
   */
  onBeforeUndo(i) {
    return this._injector.get(Ds).beforeCommandExecuted((t) => {
      if (t.id === wC.id) {
        const n = this._injector.get(ra).pitchTopUndoElement();
        n && i(n);
      }
    });
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.Undo, (event) => {})` as instead
   */
  onUndo(i) {
    return this._injector.get(Ds).onCommandExecuted((t) => {
      if (t.id === wC.id) {
        const n = this._injector.get(ra).pitchTopUndoElement();
        n && i(n);
      }
    });
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.BeforeRedo, (event) => {})` as instead
   */
  onBeforeRedo(i) {
    return this._injector.get(Ds).beforeCommandExecuted((t) => {
      if (t.id === SC.id) {
        const n = this._injector.get(ra).pitchTopRedoElement();
        n && i(n);
      }
    });
  }
  /**
   * @param callback
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.Redo, (event) => {})` as instead
   */
  onRedo(i) {
    return this._injector.get(Ds).onCommandExecuted((t) => {
      if (t.id === SC.id) {
        const n = this._injector.get(ra).pitchTopRedoElement();
        n && i(n);
      }
    });
  }
};
P = Fe([
  L(0, Inject(Injector)),
  L(1, Inject(Yn))
], P);
var We = Object.getOwnPropertyDescriptor;
var qe = (i, e, t, r) => {
  for (var n = r > 1 ? void 0 : r ? We(e, t) : e, o = i.length - 1, s; o >= 0; o--)
    (s = i[o]) && (n = s(n) || n);
  return n;
};
var Ge = (i, e) => (t, r) => e(t, r, i);
var B = class extends $e {
  constructor(i, e) {
    super(e), this.doc = i;
  }
};
B = qe([
  Ge(1, Inject(Injector))
], B);
var Je = class {
  constructor() {
    d(this, "_eventRegistry", /* @__PURE__ */ new Map());
    d(this, "_eventHandlerMap", /* @__PURE__ */ new Map());
    d(this, "_eventHandlerRegisted", /* @__PURE__ */ new Map());
  }
  _ensureEventRegistry(e) {
    return this._eventRegistry.has(e) || this._eventRegistry.set(e, new lu()), this._eventRegistry.get(e);
  }
  dispose() {
    this._eventRegistry.clear(), this._eventHandlerMap.clear(), this._eventHandlerRegisted.forEach((e) => {
      e.forEach((t) => t.dispose()), e.clear();
    }), this._eventHandlerRegisted.clear();
  }
  registerEventHandler(e, t) {
    const r = this._eventHandlerMap.get(e);
    return r ? r.add(t) : this._eventHandlerMap.set(e, /* @__PURE__ */ new Set([t])), this._ensureEventRegistry(e).getData().length && this._initEventHandler(e), Be(() => {
      var n, o, s, c;
      (n = this._eventHandlerMap.get(e)) == null || n.delete(t), (s = (o = this._eventHandlerRegisted.get(e)) == null ? void 0 : o.get(t)) == null || s.dispose(), (c = this._eventHandlerRegisted.get(e)) == null || c.delete(t);
    });
  }
  removeEvent(e, t) {
    const r = this._ensureEventRegistry(e);
    if (r.delete(t), r.getData().length === 0) {
      const n = this._eventHandlerRegisted.get(e);
      n == null || n.forEach((o) => o.dispose()), this._eventHandlerRegisted.delete(e);
    }
  }
  _initEventHandler(e) {
    let t = this._eventHandlerRegisted.get(e);
    const r = this._eventHandlerMap.get(e);
    r && (t || (t = /* @__PURE__ */ new Map(), this._eventHandlerRegisted.set(e, t), r == null || r.forEach((n) => {
      t == null || t.set(n, Be(n()));
    })));
  }
  /**
   * Add an event listener
   * @param {string} event key of event
   * @param {(params: IEventParamConfig[typeof event]) => void} callback callback when event triggered
   * @returns {Disposable} The Disposable instance, for remove the listener
   * @example
   * ```ts
   * univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, (params) => {
   *   const { stage } = params;
   *   console.log('life cycle changed', params);
   * });
   * ```
   */
  addEvent(e, t) {
    return this._ensureEventRegistry(e).add(t), this._initEventHandler(e), Be(() => this.removeEvent(e, t));
  }
  /**
   * Fire an event, used in internal only.
   * @param {string} event key of event
   * @param {any} params params of event
   * @returns {boolean} should cancel
   * @example
   * ```ts
   * this.fireEvent(univerAPI.Event.LifeCycleChanged, params);
   * ```
   */
  fireEvent(e, t) {
    var r;
    return (r = this._eventRegistry.get(e)) == null || r.getData().forEach((n) => {
      n(t);
    }), t.cancel;
  }
};
var Ke = Object.getOwnPropertyDescriptor;
var Qe = (i, e, t, r) => {
  for (var n = r > 1 ? void 0 : r ? Ke(e, t) : e, o = i.length - 1, s; o >= 0; o--)
    (s = i[o]) && (n = s(n) || n);
  return n;
};
var N = (i, e) => (t, r) => e(t, r, i);
var H = class extends $ {
  constructor(i, e) {
    super(), this._injector = i, this._userManagerService = e;
  }
  /**
   * Get current user info.
   * @returns {IUser} Current user info.
   * @example
   * ```typescript
   * univerAPI.getUserManager().getCurrentUser();
   * ```
   */
  getCurrentUser() {
    return this._userManagerService.getCurrentUser();
  }
};
H = Qe([
  N(0, Inject(Injector)),
  N(1, Inject(Is))
], H);
var x = class x2 {
  static get() {
    if (this._instance)
      return this._instance;
    const e = new x2();
    return this._instance = e, e;
  }
  /**
   * @ignore
   */
  static extend(e) {
    Object.getOwnPropertyNames(e.prototype).forEach((t) => {
      t !== "constructor" && (this.prototype[t] = e.prototype[t]);
    }), Object.getOwnPropertyNames(e).forEach((t) => {
      t !== "prototype" && t !== "name" && t !== "length" && (this[t] = e[t]);
    });
  }
  /**
   * Rectangle utils, including range operations likes merge, subtract, split
   *
   * @example
   * ```ts
   * const ranges = [
   *   { startRow: 0, startColumn: 0, endRow: 1, endColumn: 1 },
   *   { startRow: 1, startColumn: 1, endRow: 2, endColumn: 2 }
   * ];
   * const merged = univerAPI.Util.rectangle.mergeRanges(ranges);
   * console.log(merged);
   * ```
   */
  get rectangle() {
    return Cn;
  }
  /**
   * Number format utils, including parse and strigify about date, price, etc
   *
   * @example
   * ```ts
   * const text = univerAPI.Util.numfmt.format('#,##0.00', 1234.567);
   * console.log(text);
   * ```
   */
  get numfmt() {
    return a1;
  }
  /**
   * common tools
   *
   * @example
   * ```ts
   * const key = univerAPI.Util.tools.generateRandomId(6);
   * console.log(key);
   * ```
   */
  get tools() {
    return Z;
  }
};
d(x, "_instance");
var U = x;
var Xe = Object.getOwnPropertyDescriptor;
var Ye = (i, e, t, r) => {
  for (var n = r > 1 ? void 0 : r ? Xe(e, t) : e, o = i.length - 1, s; o >= 0; o--)
    (s = i[o]) && (n = s(n) || n);
  return n;
};
var C = (i, e) => (t, r) => e(t, r, i);
var w = Symbol("initializers");
var I = class extends Ve {
  constructor(e, t, r, n) {
    super();
    d(this, "_eventRegistry", new Je());
    d(this, "registerEventHandler", (e2, t2) => this._eventRegistry.registerEventHandler(e2, t2));
    this._injector = e, this._commandService = t, this._univerInstanceService = r, this._lifecycleService = n, this.registerEventHandler(
      this.Event.LifeCycleChanged,
      () => Be(
        this._lifecycleService.lifecycle$.subscribe((s) => {
          this.fireEvent(this.Event.LifeCycleChanged, { stage: s });
        })
      )
    ), this._initUnitEvent(this._injector), this._initBeforeCommandEvent(this._injector), this._initCommandEvent(this._injector), this._injector.onDispose(() => {
      this.dispose();
    });
    const o = Object.getPrototypeOf(this)[w];
    if (o) {
      const s = this;
      o.forEach(function(c) {
        c.apply(s, [e]);
      });
    }
  }
  /**
   * Create an FUniver instance, if the injector is not provided, it will create a new Univer instance.
   * @static
   * @param {Univer | Injector} wrapped - The Univer instance or injector instance.
   * @returns {FUniver} - The FUniver instance.
   *
   * @example
   * ```ts
   * const univerAPI = FUniver.newAPI(univer);
   * ```
   */
  static newAPI(e) {
    return (e instanceof dI ? e.__getInjector() : e).createInstance(I);
  }
  /**
   * @ignore
   */
  _initialize(e) {
  }
  /**
   * @ignore
   */
  static extend(e) {
    Object.getOwnPropertyNames(e.prototype).forEach((t) => {
      if (t === "_initialize") {
        let r = this.prototype[w];
        r || (r = [], this.prototype[w] = r), r.push(e.prototype._initialize);
      } else t !== "constructor" && (this.prototype[t] = e.prototype[t]);
    }), Object.getOwnPropertyNames(e).forEach((t) => {
      t !== "prototype" && t !== "name" && t !== "length" && (this[t] = e[t]);
    });
  }
  _initCommandEvent(e) {
    const t = e.get(Ds);
    this.registerEventHandler(
      this.Event.Redo,
      () => t.onCommandExecuted((r) => {
        const { id: n, type: o, params: s } = r;
        if (r.id === SC.id) {
          const a = { id: n, type: o, params: s };
          this.fireEvent(this.Event.Redo, a);
        }
      })
    ), this.registerEventHandler(
      this.Event.Undo,
      () => t.onCommandExecuted((r) => {
        const { id: n, type: o, params: s } = r;
        if (r.id === wC.id) {
          const a = { id: n, type: o, params: s };
          this.fireEvent(this.Event.Undo, a);
        }
      })
    ), this.registerEventHandler(
      this.Event.CommandExecuted,
      () => t.onCommandExecuted((r, n) => {
        const { id: o, type: s, params: c } = r;
        if (r.id !== SC.id && r.id !== wC.id) {
          const m = { id: o, type: s, params: c, options: n };
          this.fireEvent(this.Event.CommandExecuted, m);
        }
      })
    );
  }
  _initBeforeCommandEvent(e) {
    const t = e.get(Ds);
    this.registerEventHandler(
      this.Event.BeforeRedo,
      () => t.beforeCommandExecuted((r) => {
        const { id: n, type: o, params: s } = r;
        if (r.id === SC.id) {
          const a = { id: n, type: o, params: s };
          if (this.fireEvent(this.Event.BeforeRedo, a), a.cancel)
            throw new tR();
        }
      })
    ), this.registerEventHandler(
      this.Event.BeforeUndo,
      () => t.beforeCommandExecuted((r) => {
        const { id: n, type: o, params: s } = r;
        if (r.id === wC.id) {
          const a = { id: n, type: o, params: s };
          if (this.fireEvent(this.Event.BeforeUndo, a), a.cancel)
            throw new tR();
        }
      })
    ), this.registerEventHandler(
      this.Event.BeforeCommandExecute,
      () => t.beforeCommandExecuted((r, n) => {
        const { id: o, type: s, params: c } = r;
        if (r.id !== SC.id && r.id !== wC.id) {
          const m = { id: o, type: s, params: c, options: n };
          if (this.fireEvent(this.Event.BeforeCommandExecute, m), m.cancel)
            throw new tR();
        }
      })
    );
  }
  _initUnitEvent(e) {
    const t = e.get(br);
    this.registerEventHandler(
      this.Event.DocDisposed,
      () => t.unitDisposed$.subscribe((r) => {
        r.type === we.UNIVER_DOC && this.fireEvent(this.Event.DocDisposed, {
          unitId: r.getUnitId(),
          unitType: r.type,
          snapshot: r.getSnapshot()
        });
      })
    ), this.registerEventHandler(
      this.Event.DocCreated,
      () => t.unitAdded$.subscribe((r) => {
        if (r.type === we.UNIVER_DOC) {
          const n = r, o = e.createInstance(B, n);
          this.fireEvent(this.Event.DocCreated, {
            unitId: r.getUnitId(),
            type: r.type,
            doc: o,
            unit: o
          });
        }
      })
    );
  }
  /**
   * Dispose the UniverSheet by the `unitId`. The UniverSheet would be unload from the application.
   * @param unitId The unit id of the UniverSheet.
   * @returns Whether the Univer instance is disposed successfully.
   *
   * @example
   * ```ts
   * const fWorkbook = univerAPI.getActiveWorkbook();
   * const unitId = fWorkbook?.getId();
   *
   * if (unitId) {
   *   univerAPI.disposeUnit(unitId);
   * }
   * ```
   */
  disposeUnit(e) {
    const t = this._univerInstanceService.disposeUnit(e);
    return this._eventRegistry.dispose(), t;
  }
  /**
   * Get the current lifecycle stage.
   * @returns {LifecycleStages} - The current lifecycle stage.
   *
   * @example
   * ```ts
   * const stage = univerAPI.getCurrentLifecycleStage();
   * console.log(stage);
   * ```
   */
  getCurrentLifecycleStage() {
    return this._injector.get(Yn).stage;
  }
  /**
   * Undo an editing on the currently focused document.
   * @returns {Promise<boolean>} undo result
   *
   * @example
   * ```ts
   * await univerAPI.undo();
   * ```
   */
  undo() {
    return this._commandService.executeCommand(wC.id);
  }
  /**
   * Redo an editing on the currently focused document.
   * @returns {Promise<boolean>} redo result
   *
   * @example
   * ```ts
   * await univerAPI.redo();
   * ```
   */
  redo() {
    return this._commandService.executeCommand(SC.id);
  }
  /**
   * Toggle dark mode on or off.
   * @param {boolean} isDarkMode - Whether the dark mode is enabled.
   * @example
   * ```ts
   * univerAPI.toggleDarkMode(true);
   * ```
   */
  toggleDarkMode(e) {
    this._injector.get(Ji).setDarkMode(e);
  }
  /**
   * Load locales for the given locale.
   * @description This method is utilized to load locales, which can be either built-in or custom-defined.
   * @param {string} locale - A unique locale identifier.
   * @param {ILanguagePack} locales  - The locales object containing the translations.
   * @example
   * ```ts
   * univerAPI.loadLocales('esES', {
   *   'Hello World': 'Hola Mundo',
   * });
   * ```
   */
  loadLocales(e, t) {
    this._injector.get(Hn).load({ [e]: t });
  }
  /**
   * Set the current locale.
   * @param {string} locale - A unique locale identifier.
   * @example
   * ```ts
   * univerAPI.setLocale('esES');
   * ```
   */
  setLocale(e) {
    this._injector.get(Hn).setLocale(e);
  }
  /**
   * Register a callback that will be triggered before invoking a command.
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.BeforeCommandExecute, (event) => {})` instead.
   * @param {CommandListener} callback The callback.
   * @returns {IDisposable} The disposable instance.
   */
  onBeforeCommandExecute(e) {
    return this._commandService.beforeCommandExecuted((t, r) => {
      e(t, r);
    });
  }
  /**
   * Register a callback that will be triggered when a command is invoked.
   * @deprecated use `univerAPI.addEvent(univerAPI.Event.CommandExecuted, (event) => {})` instead.
   * @param {CommandListener} callback The callback.
   * @returns {IDisposable} The disposable instance.
   */
  onCommandExecuted(e) {
    return this._commandService.onCommandExecuted((t, r) => {
      e(t, r);
    });
  }
  /**
   * Execute a command with the given id and parameters.
   * @param id Identifier of the command.
   * @param params Parameters of this execution.
   * @param options Options of this execution.
   * @returns The result of the execution. It is a boolean value by default which indicates the command is executed.
   *
   * @example
   * ```ts
   * univerAPI.executeCommand('sheet.command.set-range-values', {
   *   value: { v: "Hello, Univer!" },
   *   range: { startRow: 0, startColumn: 0, endRow: 0, endColumn: 0 }
   * });
   * ```
   */
  executeCommand(e, t, r) {
    return this._commandService.executeCommand(e, t, r);
  }
  /**
   * Execute a command with the given id and parameters synchronously.
   * @param id Identifier of the command.
   * @param params Parameters of this execution.
   * @param options Options of this execution.
   * @returns The result of the execution. It is a boolean value by default which indicates the command is executed.
   *
   * @example
   * ```ts
   * univerAPI.syncExecuteCommand('sheet.command.set-range-values', {
   *   value: { v: "Hello, Univer!" },
   *   range: { startRow: 0, startColumn: 0, endRow: 0, endColumn: 0 }
   * });
   * ```
   */
  syncExecuteCommand(e, t, r) {
    return this._commandService.syncExecuteCommand(e, t, r);
  }
  /**
   * Get hooks.
   * @deprecated use `addEvent` instead.
   * @returns {FHooks} FHooks instance
   */
  getHooks() {
    return this._injector.createInstance(P);
  }
  get Enum() {
    return O.get();
  }
  get Event() {
    return j.get();
  }
  get Util() {
    return U.get();
  }
  /**
   * Add an event listener
   * @param {string} event key of event
   * @param {(params: IEventParamConfig[typeof event]) => void} callback callback when event triggered
   * @returns {Disposable} The Disposable instance, for remove the listener
   * @example
   * ```ts
   * // Add life cycle changed event listener
   * const disposable = univerAPI.addEvent(univerAPI.Event.LifeCycleChanged, (params) => {
   *   const { stage } = params;
   *   console.log('life cycle changed', params);
   * });
   *
   * // Remove the event listener, use `disposable.dispose()`
   * ```
   */
  addEvent(e, t) {
    if (!e || !t) throw new Error("Cannot add empty event");
    return this._eventRegistry.addEvent(e, t);
  }
  /**
   * Fire an event, used in internal only.
   * @param {string} event key of event
   * @param {any} params params of event
   * @returns {boolean} should cancel
   * @example
   * ```ts
   * this.fireEvent(univerAPI.Event.LifeCycleChanged, params);
   * ```
   */
  fireEvent(e, t) {
    return this._eventRegistry.fireEvent(e, t);
  }
  getUserManager() {
    return this._injector.createInstance(H);
  }
  /**
   * Create a new blob.
   * @returns {FBlob} The new blob instance
   * @example
   * ```ts
   * const blob = univerAPI.newBlob();
   * ```
   */
  newBlob() {
    return this._injector.createInstance(D);
  }
  /**
   * Create a new color.
   * @returns {ColorBuilder} The new color instance
   * @example
   * ```ts
   * const color = univerAPI.newColor();
   * ```
   * @deprecated
   */
  newColor() {
    return new Eo();
  }
  /**
   * Create a new rich text.
   * @param {IDocumentData} data
   * @returns {RichTextBuilder} The new rich text instance
   * @example
   * ```ts
   * const richText = univerAPI.newRichText({ body: { dataStream: 'Hello World\r\n' } });
   * const range = univerAPI.getActiveWorkbook().getActiveSheet().getRange('A1');
   * range.setRichTextValueForCell(richText);
   * ```
   */
  newRichText(e) {
    return Fn.create(e);
  }
  /**
   * Create a new rich text value.
   * @param {IDocumentData} data - The rich text data
   * @returns {RichTextValue} The new rich text value instance
   * @example
   * ```ts
   * const richTextValue = univerAPI.newRichTextValue({ body: { dataStream: 'Hello World\r\n' } });
   * const range = univerAPI.getActiveWorkbook().getActiveSheet().getRange('A1');
   * range.setRichTextValueForCell(richTextValue);
   * ```
   */
  newRichTextValue(e) {
    return fn.create(e);
  }
  /**
   * Create a new paragraph style.
   * @param {IParagraphStyle} style - The paragraph style
   * @returns {ParagraphStyleBuilder} The new paragraph style instance
   * @example
   * ```ts
   * const richText = univerAPI.newRichText({ body: { dataStream: 'Hello World\r\n' } });
   * const paragraphStyle = univerAPI.newParagraphStyle({ textStyle: { ff: 'Arial', fs: 12, it: univerAPI.Enum.BooleanNumber.TRUE, bl: univerAPI.Enum.BooleanNumber.TRUE } });
   * richText.insertParagraph(paragraphStyle);
   * const range = univerAPI.getActiveWorkbook().getActiveSheet().getRange('A1');
   * range.setRichTextValueForCell(richText);
   * ```
   */
  newParagraphStyle(e) {
    return Rs.create(e);
  }
  /**
   * Create a new paragraph style value.
   * @param {IParagraphStyle} style - The paragraph style
   * @returns {ParagraphStyleValue} The new paragraph style value instance
   * @example
   * ```ts
   * const paragraphStyleValue = univerAPI.newParagraphStyleValue();
   * ```
   */
  newParagraphStyleValue(e) {
    return Ws.create(e);
  }
  /**
   * Create a new text style.
   * @param {ITextStyle} style - The text style
   * @returns {TextStyleBuilder} The new text style instance
   * @example
   * ```ts
   * const textStyle = univerAPI.newTextStyle();
   * ```
   */
  newTextStyle(e) {
    return _n.create(e);
  }
  /**
   * Create a new text style value.
   * @param {ITextStyle} style - The text style
   * @returns {TextStyleValue} The new text style value instance
   * @example
   * ```ts
   * const textStyleValue = univerAPI.newTextStyleValue();
   * ```
   */
  newTextStyleValue(e) {
    return js.create(e);
  }
  /**
   * Create a new text decoration.
   * @param {ITextDecoration} decoration - The text decoration
   * @returns {TextDecorationBuilder} The new text decoration instance
   * @example
   * ```ts
   * const decoration = univerAPI.newTextDecoration();
   * ```
   */
  newTextDecoration(e) {
    return new dn(e);
  }
};
I = Ye([
  C(0, Inject(Injector)),
  C(1, Ds),
  C(2, br),
  C(3, Inject(Yn))
], I);

export {
  $,
  $e,
  D,
  O,
  j,
  P,
  U,
  I
};
//# sourceMappingURL=chunk-PXSPDNRB.js.map
