"use strict";const c=require("@univerjs/sheets-numfmt"),u=require("@univerjs/sheets/facade");class l extends u.FRange{setNumberFormat(o){const t=[],{startColumn:e,startRow:n,endColumn:r,endRow:i}=this._range;for(let m=n;m<=i;m++)for(let s=e;s<=r;s++)t.push({row:m,col:s,pattern:o});return this._commandService.syncExecuteCommand(c.SetNumfmtCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),values:t}),this}setNumberFormats(o){var m;const t=[],{startColumn:e,startRow:n,endColumn:r,endRow:i}=this._range;for(let s=n;s<=i;s++)for(let a=e;a<=r;a++){const h=(m=o[s-n])==null?void 0:m[a-e];t.push({row:s,col:a,pattern:h})}return this._commandService.syncExecuteCommand(c.SetNumfmtCommand.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),values:t}),this}getNumberFormat(){var t,e;const o=this.getCellStyle();return(e=(t=o==null?void 0:o.numberFormat)==null?void 0:t.pattern)!=null?e:""}getNumberFormats(){return this.getCellStyles().map(t=>t.map(e=>{var n,r;return(r=(n=e==null?void 0:e.numberFormat)==null?void 0:n.pattern)!=null?r:""}))}}u.FRange.extend(l);class C extends u.FWorkbook{setNumfmtLocal(o){return this._injector.get(c.SheetsNumfmtCellContentController).setNumfmtLocal(o),this}}u.FWorkbook.extend(C);
