"use strict";var X2=Object.defineProperty;var Y2=(i,s,n)=>s in i?X2(i,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[s]=n;var F=(i,s,n)=>Y2(i,typeof s!="symbol"?s+"":s,n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const u=require("@univerjs/core"),p=require("@univerjs/sheets"),z=require("rxjs"),V=require("@univerjs/engine-formula"),o2=require("rxjs/operators"),H=require("@univerjs/engine-render"),F2="SHEET_CONDITIONAL_FORMATTING_PLUGIN";var S=(i=>(i.beginsWith="beginsWith",i.endsWith="endsWith",i.containsText="containsText",i.notContainsText="notContainsText",i.equal="equal",i.notEqual="notEqual",i.containsBlanks="containsBlanks",i.notContainsBlanks="notContainsBlanks",i.containsErrors="containsErrors",i.notContainsErrors="notContainsErrors",i))(S||{}),b=(i=>(i.today="today",i.yesterday="yesterday",i.tomorrow="tomorrow",i.last7Days="last7Days",i.thisMonth="thisMonth",i.lastMonth="lastMonth",i.nextMonth="nextMonth",i.thisWeek="thisWeek",i.lastWeek="lastWeek",i.nextWeek="nextWeek",i))(b||{}),w=(i=>(i.greaterThan="greaterThan",i.greaterThanOrEqual="greaterThanOrEqual",i.lessThan="lessThan",i.lessThanOrEqual="lessThanOrEqual",i.notBetween="notBetween",i.between="between",i.equal="equal",i.notEqual="notEqual",i))(w||{}),M=(i=>(i.highlightCell="highlightCell",i.dataBar="dataBar",i.colorScale="colorScale",i.iconSet="iconSet",i))(M||{}),y=(i=>(i.uniqueValues="uniqueValues",i.duplicateValues="duplicateValues",i.rank="rank",i.text="text",i.timePeriod="timePeriod",i.number="number",i.average="average",i.formula="formula",i))(y||{}),_=(i=>(i.num="num",i.min="min",i.max="max",i.percent="percent",i.percentile="percentile",i.formula="formula",i))(_||{});const K2="#fff",J2="#000000",z2=()=>({cfId:void 0,ranges:[],stopIfTrue:!1,rule:{type:"highlightCell",subType:"text",operator:"containsText"}}),Q2=(i,s)=>{switch(i){case"text":{if(["beginsWith","containsText","endsWith","equal","notContainsText","notEqual"].includes(s))return"";break}case"number":return["between","notBetween"].includes(s)?[10,100]:10}return""},e0=(i,s)=>{switch(i){case"formula":return"=";case"max":case"min":return"";case"percent":case"percentile":case"num":return s!==void 0?s:10}return""},O=(i,s,n)=>{if(!s)return null;const e=s.findIndex(t=>n(t)===i.id);if(e<0)return null;switch(i.type){case"after":return e+1;case"before":return e-1;case"self":return e}},y2=(i,s,n,e)=>{if(!n)return null;const t=O(i,n,e);let r=O(s,n,e);if(t===null||r===null||t===r)return;const a=n.splice(t,1)[0];switch(t<r&&(r=O(s,n,e)),s.type){case"before":{n.splice(r+1,0,a);break}case"self":case"after":{n.splice(r,0,a);break}}},v2=(i,s,n,e)=>{if(i.type==="after"&&["after","before"].includes(s.type))return[i,s];const t={...i},r={...s};if(t.type!=="after"){const a=O(t,n,e);if(a===null)return null;if(a-1<0){const l=n[a+1];if(l)t.id=e(l),t.type="before";else return null}else{const l=e(n[a-1]);t.id=l,t.type="after"}}if(!["after","before"].includes(r.type)){const a=O(r,n,e);if(a===null)return null;if(a===0)r.type="before";else if(a-1>=0){const l=e(n[a-1]);r.id=l,r.type="after"}else if(a+1<=n.length-1){const l=e(n[a+1]);r.id=l,r.type="before"}else return null}return t.id===r.id&&t.type===r.type?null:[t,r]},x2=(i,s)=>{if(["after","before"].includes(s.type)){if(i.type==="after")return[s,i];if(i.type==="before")return[s,{...i,type:"self"}]}return null},t0=(i,s)=>i.id===s.id&&i.type===s.type,_2=()=>`${u.generateRandomId(8)}`;class x{constructor(){F(this,"_model",new Map);F(this,"_ruleChange$",new z.Subject);F(this,"$ruleChange",this._ruleChange$.asObservable())}_ensureList(s,n){let e=this.getSubunitRules(s,n);if(!e){e=[];let t=this._model.get(s);t||(t=new Map,this._model.set(s,t)),t.set(n,e)}return e}getRule(s,n,e){const t=this.getSubunitRules(s,n);return t?t.find(r=>r.cfId===e):null}getUnitRules(s){return this._model.get(s)||null}getSubunitRules(s,n){var t;return((t=this._model.get(s))==null?void 0:t.get(n))||null}deleteRule(s,n,e){const t=this.getSubunitRules(s,n);if(t){const r=t.findIndex(l=>l.cfId===e),a=t[r];a&&(t.splice(r,1),this._ruleChange$.next({rule:a,subUnitId:n,unitId:s,type:"delete"}))}}setRule(s,n,e,t){const a=this._ensureList(s,n).find(l=>l.cfId===t);if(a){const l=u.Tools.deepClone(a);Object.assign(a,e),this._ruleChange$.next({rule:a,subUnitId:n,unitId:s,type:"set",oldRule:l})}}addRule(s,n,e){const t=this._ensureList(s,n);t.find(a=>a.cfId===e.cfId)||t.unshift(e),this._ruleChange$.next({rule:e,subUnitId:n,unitId:s,type:"add"})}moveRulePriority(s,n,e,t){const r=this._ensureList(s,n),a=O(e,r,o=>o.cfId),l=O(t,r,o=>o.cfId);if(l===null||a===null||l===a)return;const d=r[a];d&&(y2(e,t,r,o=>o.cfId),this._ruleChange$.next({rule:d,subUnitId:n,unitId:s,type:"sort"}))}createCfId(s,n){return _2()}deleteUnitId(s){this._model.delete(s)}}const X={type:u.CommandType.MUTATION,id:"sheet.mutation.move-conditional-rule",handler(i,s){if(!s)return!1;const{unitId:n,subUnitId:e,start:t,end:r}=s;return i.get(x).moveRulePriority(n,e,t,r),!0}},M2=i=>{const{unitId:s,subUnitId:n}=i,e=x2(i.start,i.end);if(!e)return[];const[t,r]=e;return[{id:X.id,params:{unitId:s,subUnitId:n,start:t,end:r}}]},n2=(i,s)=>{const n=i.get(x),{unitId:e,subUnitId:t,cfId:r}=s,a=[...n.getSubunitRules(e,t)||[]],l=a.findIndex(o=>o.cfId===r),d=a[l-1];if(l>-1){const o=a[l],c=[{id:Y.id,params:{unitId:e,subUnitId:t,rule:u.Tools.deepClone(o)}}];if(a.splice(l,1),l!==0){const h=a[0];if(h){const g=v2({id:h.cfId,type:"before"},{id:d.cfId,type:"after"},a,v=>v.cfId);if(!g)return c;const[C,D]=g,m={unitId:e,subUnitId:t,start:C,end:D};c.push({id:X.id,params:m})}}return c}return[]},$={type:u.CommandType.MUTATION,id:"sheet.mutation.delete-conditional-rule",handler(i,s){if(!s)return!1;const{unitId:n,subUnitId:e,cfId:t}=s;return i.get(x).deleteRule(n,e,t),!0}},w2=(i,s)=>({id:$.id,params:{unitId:s.unitId,subUnitId:s.subUnitId,cfId:s.rule.cfId}}),Y={type:u.CommandType.MUTATION,id:"sheet.mutation.add-conditional-rule",handler(i,s){if(!s)return!1;const{unitId:n,subUnitId:e,rule:t}=s;return i.get(x).addRule(n,e,t),!0}},I2={type:u.CommandType.COMMAND,id:"sheet.command.add-conditional-rule",handler(i,s){if(!s)return!1;const{rule:n}=s,e=i.get(u.IUndoRedoService),t=i.get(u.ICommandService),r=i.get(x),a=i.get(u.IUniverInstanceService),l=p.getSheetCommandTarget(a,s);if(!l)return!1;const{unitId:d,subUnitId:o}=l,c=r.createCfId(d,o),h={unitId:d,subUnitId:o,rule:{...n,cfId:n.cfId||c}},g=w2(i,h),C=t.syncExecuteCommand(Y.id,h);return C&&e.pushUndoRedo({unitID:d,redoMutations:[{id:Y.id,params:h}],undoMutations:[g]}),C}},K={type:u.CommandType.MUTATION,id:"sheet.mutation.set-conditional-rule",handler(i,s){if(!s)return!1;const{unitId:n,subUnitId:e,rule:t}=s,r=s.cfId||s.rule.cfId;return i.get(x).setRule(n,e,t,r),!0}},p2=(i,s)=>{const n=i.get(x),{unitId:e,subUnitId:t}=s,r=s.cfId||s.rule.cfId,a=n.getRule(e,t,r);return a?[{id:K.id,params:{unitId:e,subUnitId:t,cfId:r,rule:u.Tools.deepClone(a)}}]:[]},R2={type:u.CommandType.COMMAND,id:"sheet.command.clear-range-conditional-rule",handler(i,s){var m;if(!s)return!1;const n=i.get(x),e=i.get(u.IUniverInstanceService),t=i.get(u.ICommandService),r=i.get(u.IUndoRedoService),a=i.get(p.SheetsSelectionsService),l=p.getSheetCommandTarget(e,s);if(!l)return!1;const{unitId:d,subUnitId:o}=l,c=((m=a.getCurrentSelections())==null?void 0:m.map(v=>v.range))||[],h=n.getSubunitRules(d,o);if(!(h!=null&&h.length)||!c.length)return!1;const g=[],C=[];h.forEach(v=>{const E=new u.ObjectMatrix;v.ranges.forEach(A=>{u.Range.foreach(A,(R,B)=>{E.setValue(R,B,1)})}),c.forEach(A=>{u.Range.foreach(A,(R,B)=>{E.realDeleteValue(R,B)})});const I=p.findAllRectangle(p.createTopMatrixFromMatrix(E));if(I.length){const A={...v,ranges:I},R={unitId:d,subUnitId:o,rule:A},B=p2(i,R);g.push({id:K.id,params:R}),C.push(...B)}else{const A={unitId:d,subUnitId:o,cfId:v.cfId},R=n2(i,A);g.push({id:$.id,params:A}),C.push(...R)}});const D=u.sequenceExecute(g,t).result;return D&&r.pushUndoRedo({unitID:d,redoMutations:g,undoMutations:C}),D}},S2={type:u.CommandType.COMMAND,id:"sheet.command.clear-worksheet-conditional-rule",handler(i,s){const n=i.get(x),e=i.get(u.IUniverInstanceService),t=i.get(u.ICommandService),r=i.get(u.IUndoRedoService),a=p.getSheetCommandTarget(e,s);if(!a)return!1;const{unitId:l,subUnitId:d}=a,o=n.getSubunitRules(l,d);if(!(o!=null&&o.length))return!1;const c=o.map(D=>({cfId:D.cfId,unitId:l,subUnitId:d})),h=c.map(D=>({id:$.id,params:D})),g=c.map(D=>n2(i,D)[0]),C=u.sequenceExecute(h,t).result;return C&&r.pushUndoRedo({unitID:l,redoMutations:h,undoMutations:g}),C}},b2={type:u.CommandType.COMMAND,id:"sheet.command.delete-conditional-rule",handler(i,s){if(!s)return!1;const n=i.get(u.IUndoRedoService),e=i.get(u.ICommandService),t=i.get(u.IUniverInstanceService),r=p.getSheetCommandTarget(t,s);if(!r)return!1;const{unitId:a,subUnitId:l}=r,d={unitId:a,subUnitId:l,cfId:s.cfId},o=n2(i,d),c=e.syncExecuteCommand($.id,d);return c&&n.pushUndoRedo({unitID:a,undoMutations:o,redoMutations:[{id:$.id,params:d}]}),c}},L2={type:u.CommandType.COMMAND,id:"sheet.command.move-conditional-rule",handler(i,s){if(!s)return!1;const n=i.get(u.IUndoRedoService),e=i.get(u.ICommandService),t=i.get(u.IUniverInstanceService),r=i.get(x),a=p.getSheetCommandTarget(t,s);if(!a)return!1;const{unitId:l,subUnitId:d}=a,o=v2(s.start,s.end,r.getSubunitRules(l,d)||[],m=>m.cfId);if(!o)return!1;const[c,h]=o,g={unitId:l,subUnitId:d,start:c,end:h},C=M2(g),D=e.syncExecuteCommand(X.id,g);return D&&n.pushUndoRedo({unitID:l,redoMutations:[{id:X.id,params:g}],undoMutations:C}),D}},T2={type:u.CommandType.COMMAND,id:"sheet.command.set-conditional-rule",handler(i,s){if(!s)return!1;const n=i.get(u.IUndoRedoService),e=i.get(u.ICommandService),t=i.get(u.IUniverInstanceService),r=p.getSheetCommandTarget(t,s);if(!r)return!1;const{unitId:a,subUnitId:l}=r,d={unitId:a,subUnitId:l,rule:s.rule,cfId:s.cfId},o=p2(i,d),c=e.syncExecuteCommand(K.id,d);return c&&n.pushUndoRedo({unitID:a,undoMutations:o,redoMutations:[{id:K.id,params:d}]}),c}},J={type:u.CommandType.MUTATION,id:"sheet.mutation.conditional-formatting-formula-mark-dirty",handler(){return!0}};var n0=Object.getOwnPropertyDescriptor,r0=(i,s,n,e)=>{for(var t=e>1?void 0:e?n0(s,n):s,r=i.length-1,a;r>=0;r--)(a=i[r])&&(t=a(t)||t);return t},g2=(i,s)=>(n,e)=>s(n,e,i),T=(i=>(i[i.NOT_REGISTER=1]="NOT_REGISTER",i[i.SUCCESS=2]="SUCCESS",i[i.WAIT=3]="WAIT",i[i.ERROR=4]="ERROR",i))(T||{});const i0=i=>{const s=i&&i[0]&&i[0][0];return(s==null?void 0:s.t)===u.CellValueType.BOOLEAN?s.v===u.BooleanNumber.TRUE||s.v===!0:s?s.v:!1};exports.ConditionalFormattingFormulaService=class extends u.Disposable{constructor(n,e,t){super();F(this,"_formulaMap",new Map);F(this,"_result$",new z.Subject);F(this,"result$",this._result$.asObservable());this._commandService=n,this._activeDirtyManagerService=e,this._conditionalFormattingRuleModel=t,this._initFormulaCalculationResultChange(),this._initRuleChange()}_initRuleChange(){const n=e=>{switch(e.type){case M.colorScale:return e.config.some(t=>t.value.type===_.formula);case M.dataBar:return[e.config.max,e.config.min].some(t=>t.type===_.formula);case M.iconSet:return e.config.some(t=>t.value.type===_.formula)}};this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(e=>{const{unitId:t,subUnitId:r,rule:a,oldRule:l}=e;e.type==="delete"&&this._removeFormulaByCfId(t,r,a.cfId),e.type==="set"&&(n(a.rule)||l&&n(l.rule))&&this._removeFormulaByCfId(t,r,a.cfId)}))}_initFormulaCalculationResultChange(){this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(n.id===V.SetFormulaCalculationResultMutation.id){const e=n.params;for(const t in e.unitOtherData)for(const r in e.unitOtherData[t])for(const a in e.unitOtherData[t][r]){const l=new u.ObjectMatrix(e.unitOtherData[t][r][a]),d=this._ensureSubunitFormulaMap(t,r).getValue(a,["formulaId"]);if(!d)continue;const o=d.ranges;if(!o)continue;const c=d.result,h=o[0].startRow,g=o[0].startColumn;l.forValue((m,v,E)=>{c.setValue(h+m,g+v,i0(E))}),d.status=2;const D=this._getAllFormulaResultByCfId(t,r,d.cfId).every(m=>m.status===2);this._result$.next({...d,isAllFinished:D})}}})),this._activeDirtyManagerService.register(J.id,{commandId:J.id,getDirtyData(n){return{dirtyUnitOtherFormulaMap:n.params}}})}_ensureSubunitFormulaMap(n,e){let t=this._formulaMap.get(n);t||(t=new Map,this._formulaMap.set(n,t));let r=t.get(e);return r||(r=new u.RefAlias([],["formulaId","id"]),t.set(e,r)),r}getSubUnitFormulaMap(n,e){var t;return(t=this._formulaMap.get(n))==null?void 0:t.get(e)}registerFormulaWithRange(n,e,t,r,a=[{startRow:0,endRow:0,startColumn:0,endColumn:0}]){const l=this._ensureSubunitFormulaMap(n,e),d=this.createCFormulaId(t,r);if(l.getValue(d,["id"]))return;const o=this._createFormulaId(n,e);l.addValue({formulaText:r,unitId:n,subUnitId:e,cfId:t,id:d,ranges:a,formulaId:o,status:3,result:new u.ObjectMatrix});const c={unitId:n,subUnitId:e,formulaMap:{[o]:{f:r,ranges:a}}};this._commandService.executeCommand(V.SetOtherFormulaMutation.id,c,{onlyLocal:!0}).then(()=>{this._commandService.executeCommand(J.id,{[n]:{[e]:{[o]:!0}}},{onlyLocal:!0})})}_removeFormulaByCfId(n,e,t){const a=this.deleteCache(n,e,t).map(l=>l.formulaId);this._commandService.executeCommand(V.RemoveOtherFormulaMutation.id,{unitId:n,subUnitId:e,formulaIdList:a},{onlyLocal:!0})}getFormulaResultWithCoords(n,e,t,r,a=0,l=0){const d=this.getSubUnitFormulaMap(n,e);if(!d)return{status:1};const o=d.getValue(this.createCFormulaId(t,r),["id"]);return o?o.status===2&&o.result?{result:o.result.getValue(a,l),status:2}:o.status===3?{status:3}:{status:4}:{status:1}}getFormulaMatrix(n,e,t,r){const a=this.getSubUnitFormulaMap(n,e);if(!a)return{status:1};const l=a.getValue(this.createCFormulaId(t,r),["id"]);if(!l)return{status:1};if(l.status===2&&l.result)return{result:l.result,status:2}}deleteCache(n,e,t,r){const a=this.getSubUnitFormulaMap(n,e);if(!a)return[];if(r){const l=this.createCFormulaId(t,r);return a.deleteValue(l,["id"]),[]}else{const l=a.getValues().filter(d=>d.cfId===t);return l.forEach(d=>{a.deleteValue(d.formulaId,["formulaId"])}),l}}_getAllFormulaResultByCfId(n,e,t){const r=this.getSubUnitFormulaMap(n,e);return r?r.getValues().filter(l=>l.cfId===t):[]}_createFormulaId(n,e){return`sheet.cf_${n}_${e}_${u.generateRandomId(8)}`}createCFormulaId(n,e){return`${n}_${e}`}};exports.ConditionalFormattingFormulaService=r0([g2(0,u.Inject(u.ICommandService)),g2(1,u.Inject(V.IActiveDirtyManagerService)),g2(2,u.Inject(x))],exports.ConditionalFormattingFormulaService);var k=(i=>(i.preComputingStart="preComputingStart",i.preComputing="preComputing",i.preComputingEnd="preComputingEnd",i.preComputingError="preComputingError",i))(k||{});class c2{constructor(s){F(this,"_cache");F(this,"_preComputingStatus$",new z.BehaviorSubject("preComputingStart"));F(this,"preComputingStatus$",this._preComputingStatus$.asObservable().pipe(o2.distinctUntilChanged()));F(this,"_preComputingCache");F(this,"_rule");this._context=s,this._cache=new u.LRUMap(s.limit),this._rule=s.rule,this._preComputingCache=null,this._initClearCacheListener()}setCacheLength(s){this._cache.limit=s}clearCache(){this._cache.clear()}resetPreComputingCache(){this._preComputingStatus$.next("preComputingStart"),this._preComputingCache=null}updateRule(s){this._rule=s,this.resetPreComputingCache()}getCell(s,n){const e=this._createKey(s,n);if(this._preComputingStatus$.getValue()==="preComputing")return this._cache.get(e);let t=this.getPreComputingResult(s,n);if(t===null&&(this._preComputingStatus$.next("preComputingStart"),this.preComputing(s,n,this._getContext()),t=this.getPreComputingResult(s,n),t===null))return this._cache.get(e);if(this._preComputingStatus$.next("preComputingEnd"),this._cache.has(e))return this._cache.get(e);const r=this.getCellResult(s,n,t,this._getContext());return r!==null&&this._setCache(s,n,r),r}setPreComputingCache(s){this._preComputingCache=s}getPreComputingResult(s,n){return this._preComputingCache}_createKey(s,n){return`${s}_${n}`}_setCache(s,n,e){const t=this._createKey(s,n);this._cache.set(t,e)}_getContext(){return{...this._context,rule:this._rule}}_initClearCacheListener(){this.preComputingStatus$.subscribe(s=>{s==="preComputingEnd"&&this.clearCache()})}}class s0 extends c2{preComputing(s,n,e){const t=e.rule,r=e.worksheet,a=new u.ObjectMatrix;!t.rule.config.every(c=>c.value.type===_.num)&&u2(t.ranges,r.getMaxRows()-1,r.getMaxColumns()-1).forEach(h=>{u.Range.foreach(h,(g,C)=>{const D=e.getCellValue(g,C),m=D&&D.v;if(!L(m)&&(D==null?void 0:D.t)===u.CellValueType.NUMBER){const v=Number(m);!Number.isNaN(v)&&a.setValue(g,C,v)}})});const d=[...t.rule.config].sort((c,h)=>c.index-h.index).map(c=>({value:e2(c.value,a,{...e,cfId:t.cfId}),color:new u.ColorKit(c.color)}));if(!d.some(c=>H.isObject(c.value)?c.value.status!==T.SUCCESS:!1)){const c=d.map(h=>h.color).reduce((h,g,C)=>(h.result.push({color:g,value:h.sortValue[C]}),h),{result:[],sortValue:d.map(h=>h.value.result).sort((h,g)=>h-g)}).result;this.setPreComputingCache(c),this._preComputingStatus$.next(k.preComputingEnd);return}this._preComputingStatus$.next(k.preComputing)}getCellResult(s,n,e,t){if(!e)return null;const r=t.getCellValue(s,n);if(r.t===u.CellValueType.NUMBER){const a=Number(r.v);if(!Number.isNaN(a))return $2(e,a)}}}const B2="sheet-conditional-rule-data-bar",f2="#ffbe38",m2="#abd91a",k2="#000",a0=34,o0=i=>{const{startRow:s,endRow:n,startColumn:e,endColumn:t}=i;return`${s}-${n}-${e}-${t}`};class N2 extends H.SheetExtension{constructor(){super(...arguments);F(this,"_paddingRightAndLeft",2);F(this,"_paddingTopAndBottom",2);F(this,"uKey",B2);F(this,"Z_INDEX",a0);F(this,"_radius",1)}draw(n,e,t,r){const{worksheet:a}=t;if(!a)return!1;const l=new Set;n.save(),u.Range.foreach(t.rowColumnSegment,(d,o)=>{if(!a.getRowVisible(d)||!a.getColVisible(o))return;const c=t.getCellWithCoordByIndex(d,o,!1),{isMerged:h,isMergedMainCell:g,mergeInfo:C}=c;let D=a.getCell(d,o);if(h&&(D=a.getCell(C.startRow,C.startColumn)),!(D!=null&&D.dataBar)||!this.isRenderDiffRangesByCell(C,r))return;if(h||g){const N=o0(C);if(l.has(N))return;l.add(N)}const{color:m,value:v,startPoint:E,isGradient:I}=D.dataBar,{startX:A,endX:R,startY:B,endY:d2}=h||g?C:c,r2=R-A,h2=d2+H.FIX_ONE_PIXEL_BLUR_OFFSET-B,j=r2-this._paddingRightAndLeft*2,E2=h2-this._paddingTopAndBottom*2;if(v>0){const N=Math.max(j*(1-E/100)*v/100,1),P=A+this._paddingRightAndLeft+E/100*j,W=B+this._paddingTopAndBottom;if(I){const q=n.createLinearGradient(P,W,P+N,W);q.addColorStop(0,m),q.addColorStop(1,"rgb(255 255 255)"),n.fillStyle=q,n.strokeStyle=m,n.lineWidth=1}else n.fillStyle=m;this._drawRectWithRoundedCorner(n,P,W,N,E2,!1,!0,!0,!1),I&&n.stroke()}else{const N=Math.max(j*E/100*Math.abs(v)/100,1),P=A+this._paddingRightAndLeft+E/100*j-N,W=B+this._paddingTopAndBottom;if(I){const q=n.createLinearGradient(P,W,P+N,W);q.addColorStop(0,"rgb(255 255 255)"),q.addColorStop(1,m),n.fillStyle=q,n.strokeStyle=m,n.lineWidth=1}else n.fillStyle=m;this._drawRectWithRoundedCorner(n,P,W,N,E2,!0,!1,!1,!0),I&&n.stroke()}}),n.restore()}_drawRectWithRoundedCorner(n,e,t,r,a,l,d,o,c){const h=this._radius;!a||!r||(n.beginPath(),n.moveTo(e+h,t),n.lineTo(e+r-h,t),d?n.arcTo(e+r,t,e+r,t+h,h):n.lineTo(e+r,t),n.lineTo(e+r,t+a-h),o?n.arcTo(e+r,t+a,e+r-h,t+a,h):n.lineTo(e+r,t+a),n.lineTo(e+h,t+a),c?n.arcTo(e,t+a,e,t+a-h,h):n.lineTo(e,t+a),n.lineTo(e,t+h),l?n.arcTo(e,t,e+h,t,h):n.lineTo(e,t),n.closePath(),n.fill())}}H.SpreadsheetExtensionRegistry.add(N2);const i2=i=>Math.max(Math.min(100,i),0),l0=(i,s,n)=>{const e=n(i,s);if(e&&e.t===u.CellValueType.NUMBER){const t=Number(e.v);return Number.isNaN(t)?null:t}return null};class c0 extends c2{preComputing(s,n,e){const t=e.rule,r=t.rule,a=e.worksheet,l=new u.ObjectMatrix;![t.rule.config.max,t.rule.config.min].every(C=>C.type===_.num)&&u2(t.ranges,a.getMaxRows()-1,a.getMaxColumns()-1).forEach(D=>{u.Range.foreach(D,(m,v)=>{const E=e.getCellValue(m,v),I=E&&E.v;if(!L(I)&&(E==null?void 0:E.t)===u.CellValueType.NUMBER){const A=Number(I);!Number.isNaN(A)&&l.setValue(m,v,A)}})});const o=e2(r.config.min,l,{...e,cfId:t.cfId}),c=e2(r.config.max,l,{...e,cfId:t.cfId});let h=0,g=0;if(o.status===T.SUCCESS){const C=Number(o.result);h=Number.isNaN(C)?0:C}else{this._preComputingStatus$.next(k.preComputing);return}if(c.status===T.SUCCESS){const C=Number(c.result),D=Number.isNaN(C)?0:C;g=Math.max(D,h),h=Math.min(D,h);let m=50;if(h<0&&g<=0)m=100;else if(h<0&&g>0){const v=Math.abs(g)+Math.abs(h);m=Math.abs(h)/v*100}else h>=0&&g>0&&(m=0);this.setPreComputingCache({min:h,max:g,startPoint:m}),this._preComputingStatus$.next(k.preComputingEnd);return}this._preComputingStatus$.next(k.preComputing)}getCellResult(s,n,e,t){const{min:r,max:a,startPoint:l}=e,o=t.rule.rule,c=o.isShowValue,h=o.config.isGradient,g=l0(s,n,t.getCellValue);if(!(g===null||g<r||r===a||a<r)){if(g===0)return{color:k2,startPoint:l,value:0,isGradient:h,isShowValue:c};if(r<0&&a<=0){const C=a-r,D=i2((a-g)/C*100);return D===0?void 0:{color:o.config.nativeColor||m2,startPoint:l,value:-D,isGradient:h,isShowValue:c}}else if(r<0&&a>0)if(g>0){const C=i2(Math.min(g/a,1)*100);return C===0?void 0:{color:o.config.positiveColor||f2,startPoint:l,value:C,isGradient:h,isShowValue:c}}else{const C=i2(Math.min(Math.abs(g)/Math.abs(r),1)*100);return C===0?void 0:{color:o.config.nativeColor||m2,startPoint:l,value:-C,isGradient:h,isShowValue:c}}else if(r>=0&&a>0){const C=a-r,D=0,m=i2((1-(a-g)/C)*100);return m===0?void 0:{color:o.config.positiveColor||f2,startPoint:D,value:m,isGradient:h,isShowValue:c}}}}}class u0 extends c2{preComputing(s,n,e){const t=e.rule.rule,r=e.rule.ranges,l=(()=>{switch(t.subType){case y.average:{let d=0,o=0;return r.forEach(c=>{u.Range.foreach(c,(h,g)=>{const C=e.getCellValue(h,g),D=U(C||void 0);C&&C.t===u.CellValueType.NUMBER&&D!==void 0&&(d+=Number(D)||0,o++)})}),{value:d/o,type:t.subType}}case y.uniqueValues:case y.duplicateValues:{const d=new Map;return r.forEach(o=>{u.Range.foreach(o,(c,h)=>{const g=e.getCellValue(c,h),C=U(g||void 0);if(C!==void 0){const D=d.get(C);D?d.set(C,D+1):d.set(C,1)}})}),{value:d,type:t.subType}}case y.rank:{let d=[];r.forEach(h=>{u.Range.foreach(h,(g,C)=>{const D=e.getCellValue(g,C),m=U(D||void 0);D&&D.t===u.CellValueType.NUMBER&&m!==void 0&&d.push(Number(m)||0)})}),d.sort((h,g)=>g-h);const o=e.rule.rule;if(o.isPercent){o.isBottom&&(d=d.toReversed());const h=u.Tools.clamp(o.value,0,100)/100,g=Math.floor(h*d.length),C=u.Tools.clamp(g-1,0,d.length-1);return{value:d[C],type:t.subType}}const c=Math.floor(u.Tools.clamp(o.isBottom?o.value-1:o.value,0,d.length));return o.isBottom?{value:d[d.length-c-1],type:t.subType}:{value:d[Math.max(c-1,0)],type:t.subType}}case y.formula:{const d=t,o=e.accessor.get(exports.ConditionalFormattingFormulaService);o.registerFormulaWithRange(e.unitId,e.subUnitId,e.rule.cfId,d.value,e.rule.ranges);const c=o.getFormulaMatrix(e.unitId,e.subUnitId,e.rule.cfId,d.value);return c&&c.status===T.SUCCESS?(this._preComputingStatus$.next(k.preComputingEnd),{value:c.result,type:t.subType}):(this._preComputingStatus$.next(k.preComputing),null)}case y.timePeriod:switch(t.operator){case b.last7Days:return{value:{start:u.dayjs().subtract(7,"day").valueOf(),end:u.dayjs().valueOf()},type:t.subType};case b.lastMonth:return{value:{start:u.dayjs().startOf("month").subtract(1,"month").valueOf(),end:u.dayjs().endOf("month").subtract(1,"month").valueOf()},type:t.subType};case b.lastWeek:return{value:{start:u.dayjs().startOf("week").subtract(1,"week").valueOf(),end:u.dayjs().endOf("week").subtract(1,"week").valueOf()},type:t.subType};case b.nextMonth:return{value:{start:u.dayjs().startOf("month").add(1,"month").valueOf(),end:u.dayjs().endOf("month").add(1,"month").valueOf()},type:t.subType};case b.nextWeek:return{value:{start:u.dayjs().startOf("week").add(1,"week").valueOf(),end:u.dayjs().endOf("week").add(1,"week").valueOf()},type:t.subType};case b.thisMonth:return{value:{start:u.dayjs().startOf("month").valueOf(),end:u.dayjs().endOf("month").valueOf()},type:t.subType};case b.thisWeek:return{value:{start:u.dayjs().startOf("week").valueOf(),end:u.dayjs().endOf("week").valueOf()},type:t.subType};case b.today:return{value:{start:u.dayjs().startOf("day").valueOf(),end:u.dayjs().endOf("day").valueOf()},type:t.subType};case b.tomorrow:return{value:{start:u.dayjs().startOf("day").add(1,"day").valueOf(),end:u.dayjs().endOf("day").add(1,"day").valueOf()},type:t.subType};case b.yesterday:return{value:{start:u.dayjs().startOf("day").subtract(1,"day").valueOf(),end:u.dayjs().endOf("day").subtract(1,"day").valueOf()},type:t.subType}}}})();this.setPreComputingCache(l)}getCellResult(s,n,e,t){const r=t.getCellValue(s,n),a=t.rule.rule;return(()=>{switch(a.subType){case y.number:{const o=r&&Number(r.v),c=(r==null?void 0:r.t)===u.CellValueType.NUMBER,h=a;return c?L(o)||Number.isNaN(o)?void 0:G({operator:h.operator,value:h.value||0},o||0):!![w.notEqual,w.notBetween].includes(h.operator)}case y.text:{const o=a,c=U(r),h=c===null?"":String(c),g=o.value||"";switch(o.operator){case S.beginsWith:return h.startsWith(g);case S.containsBlanks:return/^\s*$/.test(h);case S.notContainsBlanks:return!/^\s*$/.test(h);case S.containsErrors:return V.ERROR_TYPE_SET.has(h);case S.notContainsErrors:return!V.ERROR_TYPE_SET.has(h);case S.containsText:return h.indexOf(g)>-1;case S.notContainsText:return h.indexOf(g)===-1;case S.endsWith:return h.endsWith(g);case S.equal:return h===g;case S.notEqual:return h!==g;default:return!1}}case y.timePeriod:{const o=U(r);if(L(o)||Number.isNaN(Number(o))||(r==null?void 0:r.t)!==u.CellValueType.NUMBER||!e)return;const c=V2(Number(o)),{start:h,end:g}=e.value;return c>=h&&c<=g}case y.average:{const o=r&&r.v,c=Number(o),h=(r==null?void 0:r.t)===u.CellValueType.NUMBER,g=a;if(!h)return w.notEqual===g.operator;if(L(o)||Number.isNaN(c)||!e)return!1;const C=e.value;switch(g.operator){case w.greaterThan:return c>C;case w.greaterThanOrEqual:return c>=C;case w.lessThan:return c<C;case w.lessThanOrEqual:return c<=C;case w.equal:return Q(c,C);case w.notEqual:return!Q(c,C);default:return!1}}case y.rank:{const o=U(r),c=Number(o);if(L(o)||Number.isNaN(c)||(r==null?void 0:r.t)!==u.CellValueType.NUMBER||!e)return!1;const h=e.value;return a.isBottom?c<=h:c>=h}case y.uniqueValues:{const o=U(r);return L(o)||!e?!1:e.value.get(o)===1}case y.duplicateValues:{const o=U(r);return L(o)||!e?!1:e.value.get(o)!==1}case y.formula:{const o=e==null?void 0:e.value;return o?o.getValue(s,n)===!0:!1}}})()?a.style:{}}}const d0=(i,s,n)=>{const e=n(i,s);if(e&&e.t===u.CellValueType.NUMBER){const t=Number(e.v);return Number.isNaN(t)?null:t}return null};class h0 extends c2{preComputing(s,n,e){const t=e.rule.rule,r=e.worksheet,a=new u.ObjectMatrix;!t.config.every(c=>c.value.type===_.num)&&u2(e.rule.ranges,r.getMaxRows()-1,r.getMaxColumns()-1).forEach(h=>{u.Range.foreach(h,(g,C)=>{const D=e.getCellValue(g,C),m=D&&D.v;if(!L(m)&&(D==null?void 0:D.t)===u.CellValueType.NUMBER){const v=Number(m);!Number.isNaN(v)&&a.setValue(g,C,v)}})});const d=t.config.map(c=>e2(c.value,a,{...e,cfId:e.rule.cfId}));if(!d.some(c=>c.status!==T.SUCCESS)){const c=d.map((h,g)=>({operator:t.config[g].operator,value:Number(h.result)||0})).reduce((h,g,C,D)=>{const m=t.config[C];if(!C||C===D.length-1)h.push({...g,iconId:m.iconId,iconType:m.iconType});else{const v=D[C-1];G(v,g.value)||h.push({...g,iconId:m.iconId,iconType:m.iconType})}return h},[]);this.setPreComputingCache(c),this._preComputingStatus$.next(k.preComputingEnd);return}this._preComputingStatus$.next(k.preComputing)}getCellResult(s,n,e,t){if(!e)return null;const r=d0(s,n,t.getCellValue);if(r===null)return;const a=t.rule.rule,l=a.isShowValue===void 0?!0:!!a.isShowValue;for(let d=0;d<e.length;d++){const o=e[d],c={...o},h={...o},{iconId:g,iconType:C}=o;if(d===0){if(G(o,r))return{iconId:g,iconType:C,isShowValue:l}}else{if(d===e.length-1)return{iconId:g,iconType:C,isShowValue:l};{const D=e[d-1];if(h.operator=O2(D.operator),h.value=D.value,G(c,r)&&G(h,r))return{iconId:g,iconType:C,isShowValue:l}}}}}}var g0=Object.getOwnPropertyDescriptor,C0=(i,s,n,e)=>{for(var t=e>1?void 0:e?g0(s,n):s,r=i.length-1,a;r>=0;r--)(a=i[r])&&(t=a(t)||t);return t},s2=(i,s)=>(n,e)=>s(n,e,i);const l2=1e3*3*3;exports.ConditionalFormattingViewModel=class extends u.Disposable{constructor(n,e,t,r){super();F(this,"_calculateUnitManagers",new Map);F(this,"_rTreeManager",new u.RTree);F(this,"_cellCache",new u.LRUMap(l2));F(this,"_markDirty$",new z.Subject);F(this,"markDirty$",this._markDirty$.asObservable());F(this,"_markRuleDirtyAtOnce",(n,e,t,r=!0)=>{if(this._cellCache.clear(),r){const l=this._ensureCalculateUnitManager(n,e).get(t);l&&l.resetPreComputingCache()}this._markDirty$.next({unitId:n,subUnitId:e,cfId:t})});F(this,"markRuleDirty",(()=>{const n=new z.Subject;return this.disposeWithMe(n.pipe(o2.bufferTime(100),o2.filter(e=>!!e.length),o2.map(e=>{const t=new Set,r=[];return e.forEach(a=>{const l=`${a.unitId}_${a.subUnitId}_${a.cfId}`;if(t.has(l)){if(a.isNeedResetPreComputingCache){const d=r.find(o=>o.cfId===a.cfId);d.isNeedResetPreComputingCache=!0}return}t.add(l),r.push({...a})}),r})).subscribe(e=>{e.forEach(t=>{this._markRuleDirtyAtOnce(t.unitId,t.subUnitId,t.cfId,t.isNeedResetPreComputingCache)})})),(e,t,r,a=!0)=>{n.next({unitId:e,subUnitId:t,cfId:r,isNeedResetPreComputingCache:a})}})());this._injector=n,this._conditionalFormattingRuleModel=e,this._conditionalFormattingFormulaService=t,this._univerInstanceService=r,this._initRuleListener(),this._handleCustomFormulasSeparately(),this._initCFFormulaListener()}_initCFFormulaListener(){this.disposeWithMe(this._conditionalFormattingFormulaService.result$.subscribe(({unitId:n,subUnitId:e,cfId:t,isAllFinished:r})=>{r&&this._markRuleDirtyAtOnce(n,e,t,r)}))}getCellCfs(n,e,t,r){const a=this._createCacheKey(n,e,t,r);if(this._cellCache.has(a))return this._cellCache.get(a);const l=this._getCellCfs(n,e,t,r);return l.length&&this._cellCache.set(a,l),l}_getCellCfs(n,e,t,r){var h;const a=(h=this._conditionalFormattingRuleModel.getSubunitRules(n,e))!=null?h:[],l=this._ensureCalculateUnitManager(n,e),d=this._rTreeManager.bulkSearch([{unitId:n,sheetId:e,range:{startColumn:r,endColumn:r,startRow:t,endRow:t}}]),o=a.filter(g=>d.has(g.cfId));return o.length?o.map(g=>{const C=l.get(g.cfId);return C?{cfId:g.cfId,result:C.getCell(t,r)}:null}).filter(g=>!!g).map((g,C)=>({...g,priority:C})):[]}dispose(){this._calculateUnitManagers.clear(),this._cellCache.clear(),this._rTreeManager.clear(),super.dispose()}_handleCustomFormulasSeparately(){this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(n=>{if(n.type==="set"){const{unitId:e,subUnitId:t}=n,r=n.oldRule;r.rule.type===M.highlightCell&&r.rule.subType===y.formula&&this._conditionalFormattingFormulaService.deleteCache(e,t,r.cfId)}}))}_initRuleListener(){this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(n=>{const{unitId:e,subUnitId:t,rule:r}=n,{cfId:a,ranges:l}=r,d=this._ensureCalculateUnitManager(e,t);switch(this.markRuleDirty(e,t,a),n.type){case"add":{this._rTreeManager.bulkInsert(l.map(c=>({unitId:e,sheetId:t,id:a,range:c})));const o=this._createRuleCalculateUnitInstance(e,t,r);if(!o)return;d.set(r.cfId,o);break}case"delete":{this._rTreeManager.bulkRemove(l.map(o=>({unitId:e,sheetId:t,id:a,range:o}))),d.delete(r.cfId);break}case"set":{const o=n.oldRule;if(this._rTreeManager.bulkRemove(o.ranges.map(c=>({unitId:e,sheetId:t,id:o.cfId,range:c}))),this._rTreeManager.bulkInsert(l.map(c=>({unitId:e,sheetId:t,id:a,range:c}))),o.rule.type!==r.rule.type){const c=this._createRuleCalculateUnitInstance(e,t,r);if(!c)return;d.delete(o.cfId),d.set(r.cfId,c)}else{const c=d.get(o.cfId);if(!c)return;c.updateRule(r)}}}}))}_ensureCalculateUnitManager(n,e){let t=this._calculateUnitManagers.get(n);t||(t=new Map,this._calculateUnitManagers.set(n,t));let r=t.get(e);return r||(r=new Map,t.set(e,r)),r}_createRuleCalculateUnitInstance(n,e,t){const r=this._univerInstanceService.getUnit(n),a=r==null?void 0:r.getSheetBySheetId(e);if(!r||!a)return;const l={workbook:r,worksheet:a,unitId:n,subUnitId:e,accessor:this._injector,rule:t,limit:l2,getCellValue:(d,o)=>a.getCellRaw(d,o)||{}};switch(t.rule.type){case M.colorScale:return new s0(l);case M.dataBar:return new c0(l);case M.highlightCell:return new u0(l);case M.iconSet:return new h0(l)}}_createCacheKey(n,e,t,r){return`${n}_${e}_${t}_${r}`}setCacheLength(n=l2){this._cellCache.limit!==n&&(this._cellCache.limit=n,this._calculateUnitManagers.forEach(e=>{e.forEach(t=>{t.forEach(r=>{r.setCacheLength(n)})})}))}};exports.ConditionalFormattingViewModel=C0([s2(0,u.Inject(u.Injector)),s2(1,u.Inject(x)),s2(2,u.Inject(exports.ConditionalFormattingFormulaService)),s2(3,u.IUniverInstanceService)],exports.ConditionalFormattingViewModel);function Q(i,s){return Math.abs(i-s)<Number.EPSILON}const L=i=>[void 0,null].includes(i),U=i=>{var e,t;if(!i)return null;if(i.t===u.CellValueType.BOOLEAN)return i.v===u.BooleanNumber.TRUE?V.BooleanValue.TRUE:V.BooleanValue.FALSE;const s=i.v,n=(t=(e=i.p)==null?void 0:e.body)==null?void 0:t.dataStream.replace(/\r\n$/,"");return L(s)?L(n)?null:n:s},C2=86400;function U2(i,s=!0){if(s&&i>=0){if(i===0)return[1900,1,0];if(i===60)return[1900,2,29];if(i<60)return[1900,i<32?1:2,(i-1)%31+1]}let n=i+68569+2415019;const e=Math.floor(4*n/146097);n=n-Math.floor((146097*e+3)/4);const t=Math.floor(4e3*(n+1)/1461001);n=n-Math.floor(1461*t/4)+31;const r=Math.floor(80*n/2447),a=n-Math.floor(2447*r/80);n=Math.floor(r/11);const l=r+2-12*n;return[100*(e-49)+t+n|0,l|0,a|0]}const V2=i=>{let s=i|0;const n=C2*(i-s);let e=Math.floor(n);n-e>.9999&&(e+=1,e===C2&&(e=0,s+=1));const t=e<0?C2+e:e,[r,a,l]=U2(i,!0),d=Math.floor(t/60/60)%60,o=Math.floor(t/60)%60,c=Math.floor(t)%60;return u.dayjs(`${r}/${a}/${l} ${d}:${o}:${c}`).valueOf()},e2=(i,s,n)=>{switch(i.type){case _.max:{let e=0;return s.forValue((t,r,a)=>{a>e&&(e=a)}),{status:T.SUCCESS,result:e}}case _.min:{let e;return s.forValue((t,r,a)=>{e===void 0&&(e=a),a<e&&(e=a)}),{status:T.SUCCESS,result:e}}case _.percent:{let e,t;s.forValue((l,d,o)=>{(e===void 0||t===void 0)&&(e=o,t=o),o>e&&(e=o),o<t&&(t=o)});const r=(e||0)-(t||0),a=Math.max(Math.min(Number(i.value)||0,100),0);return{status:T.SUCCESS,result:r*(a/100)+(t||0)}}case _.percentile:{const e=s.toNativeArray().sort((o,c)=>o-c),t=Math.max(Math.min(Number(i.value)||0,100),0),r=(e.length-1)*t/100,a=Math.floor(r),l=r-a,d=e[a]+(e[Math.min(a+1,e.length-1)]-e[a])*l;return{status:T.SUCCESS,result:d}}case _.formula:{const{accessor:e,unitId:t,subUnitId:r,cfId:a}=n,l=String(i.value),d=e.get(exports.ConditionalFormattingFormulaService);return d.registerFormulaWithRange(t,r,a,l),d.getFormulaResultWithCoords(t,r,a,l)}case _.num:default:{const e=Number(i.value);return{status:T.SUCCESS,result:Number.isNaN(e)?0:e}}}},D0=(i,s,n,e)=>{const{accessor:t}=e,r=t.get(exports.ConditionalFormattingViewModel),a=new u.ObjectMatrix;return n.ranges.forEach(l=>{u.Range.foreach(l,(d,o)=>{const c=r.getCellCfs(i,s,d,o);if(c){const h=c.find(g=>g.cfId===n.cfId);h!=null&&h.result&&a.setValue(d,o,h.result)}})}),a},G=(i,s)=>{switch(i.operator){case w.between:{if(typeof i.value!="object"||!i.value.length)return;const n=Math.min(...i.value),e=Math.max(...i.value);return s>=n&&s<=e}case w.notBetween:{if(typeof i.value!="object"||!i.value.length)return;const n=Math.min(...i.value),e=Math.max(...i.value);return!(s>=n&&s<=e)}case w.equal:{const n=i.value||0;return Q(n,s)}case w.notEqual:{const n=i.value||0;return!Q(n,s)}case w.greaterThan:{const n=i.value||0;return s>n}case w.greaterThanOrEqual:{const n=i.value||0;return s>=n}case w.lessThan:{const n=i.value||0;return s<n}case w.lessThanOrEqual:{const n=i.value||0;return s<=n}default:return!1}},O2=i=>{switch(i){case w.greaterThan:return w.lessThanOrEqual;case w.greaterThanOrEqual:return w.lessThan;case w.lessThan:return w.greaterThanOrEqual;case w.lessThanOrEqual:return w.greaterThan}return i},$2=(i,s)=>{const n=r=>r.a!==void 0?r:{...r,a:1},e=i.findIndex(r=>r.value>=s),t=e-1;if(e===0)return i[0].color.toRgbString();if(t>=0){const r=i[t],a=i[e];if(r.color.isValid&&a.color.isValid){const l=n(r.color.toRgb()),d=n(a.color.toRgb()),o=a.value-r.value,c=(s-r.value)/o,h=["r","g","b","a"].reduce((C,D)=>{const m=l[D];return C[D]=(d[D]-m)*c+m,C},{});return new u.ColorKit(h).toRgbString()}}else return i[i.length-1].color.toRgbString()},u2=(i,s,n)=>i.map(e=>{if(e.startColumn>n||e.startRow>s)return null;const t={...e};return t.endRow=Math.min(t.endRow,s),t.endColumn=Math.min(t.endColumn,n),t}).filter(e=>!!e);function f0(i){let s=0;return new u.ObjectMatrix(i).forValue((n,e,t)=>{s=Math.max(Number.isNaN(s)?0:s,Number(t))}),s}const m0={mistake:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%227.03704%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.87359%206.87332C6.6146%207.13231%206.6146%207.55221%206.87359%207.8112L9.062%209.99961L6.87356%2012.188C6.61457%2012.447%206.61457%2012.8669%206.87356%2013.1259C7.13255%2013.3849%207.55245%2013.3849%207.81144%2013.1259L9.99987%2010.9375L12.1882%2013.1258C12.4472%2013.3848%2012.8671%2013.3848%2013.1261%2013.1258C13.3851%2012.8669%2013.3851%2012.447%2013.1261%2012.188L10.9378%209.99961L13.1261%207.81127C13.3851%207.55228%2013.3851%207.13238%2013.1261%206.87339C12.8671%206.61441%2012.4472%206.61441%2012.1882%206.87339L9.99987%209.06173L7.81147%206.87332C7.55248%206.61433%207.13257%206.61433%206.87359%206.87332Z%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3C%2Fsvg%3E%0A",warn:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%227.03704%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3Cpath%20d%3D%22M9.16817%206.67735C9.16646%206.61745%209.1656%206.5875%209.16653%206.56236C9.18103%206.16817%209.49136%205.84883%209.88497%205.82306C9.91008%205.82141%209.94004%205.82141%209.99996%205.82141V5.82141C10.0599%205.82141%2010.0899%205.82141%2010.115%205.82306C10.5086%205.84883%2010.8189%206.16817%2010.8334%206.56236C10.8343%206.5875%2010.8335%206.61745%2010.8318%206.67735L10.7043%2011.131C10.6934%2011.5121%2010.3812%2011.8154%209.99995%2011.8154V11.8154C9.61866%2011.8154%209.30655%2011.5121%209.29564%2011.131L9.16817%206.67735Z%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3Crect%20x%3D%229.31488%22%20y%3D%2212.8086%22%20width%3D%221.37006%22%20height%3D%221.37006%22%20rx%3D%220.685032%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3C%2Fsvg%3E%0A",correct:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M17.037%2010C17.037%2013.8865%2013.8864%2017.0371%209.99999%2017.0371C6.11354%2017.0371%202.96295%2013.8865%202.96295%2010C2.96295%206.1136%206.11354%202.96301%209.99999%202.96301C13.8864%202.96301%2017.037%206.1136%2017.037%2010Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3Cpath%20d%3D%22M13.9239%207.17477C13.6638%206.91472%2013.2422%206.91472%2012.9821%207.17477L8.74433%2011.4126L7.01786%209.6861C6.75781%209.42606%206.33619%209.42606%206.07614%209.6861C5.81609%209.94615%205.81609%2010.3678%206.07614%2010.6278L8.27349%2012.8252C8.53354%2013.0852%208.95516%2013.0852%209.21521%2012.8252L9.2195%2012.8209L13.9239%208.1165C14.1839%207.85645%2014.1839%207.43482%2013.9239%207.17477Z%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3C%2Fsvg%3E%0A"},F0={starEmpty:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.8451%207.0699%2012.2165%207.33978%2012.6421%207.36863L16.2362%207.61233C16.5693%207.63492%2016.7048%208.05202%2016.4486%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.215%2011.2859%2013.319%2011.6996L14.1979%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6418%2015.5971L10.5908%2013.6817C10.2296%2013.4549%209.77045%2013.4549%209.40924%2013.6817L6.35828%2015.5971C6.07553%2015.7746%205.72072%2015.5168%205.80217%2015.1931L6.68105%2011.6996C6.7851%2011.2859%206.64322%2010.8493%206.31592%2010.5758L3.55145%208.26607C3.29525%208.05202%203.43078%207.63492%203.76386%207.61233L7.358%207.36863C7.78352%207.33978%208.15498%207.0699%208.31391%206.67412L9.65633%203.3312C9.78074%203.0214%2010.2193%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23fff%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fsvg%3E%0A",starIncomplete:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.845%207.0699%2012.2165%207.33978%2012.642%207.36863L16.2361%207.61233C16.5692%207.63492%2016.7047%208.05202%2016.4485%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.2149%2011.2859%2013.3189%2011.6996L14.1978%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6417%2015.5971L10.5908%2013.6817C10.2295%2013.4549%209.77039%2013.4549%209.40918%2013.6817L6.35822%2015.5971C6.07547%2015.7746%205.72066%2015.5168%205.80211%2015.1931L6.68098%2011.6996C6.78504%2011.2859%206.64316%2010.8493%206.31586%2010.5758L3.55139%208.26607C3.29519%208.05202%203.43072%207.63492%203.7638%207.61233L7.35793%207.36863C7.78346%207.33978%208.15491%207.0699%208.31385%206.67412L9.65627%203.3312C9.78068%203.0214%2010.2192%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23fff%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cmask%20id%3D%22mask1_613_177%22%20style%3D%22mask-type%3Aalpha%22%20maskUnits%3D%22userSpaceOnUse%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2210%22%20height%3D%2220%22%3E%0A%3Crect%20width%3D%2210%22%20height%3D%2220%22%20fill%3D%22%23C4C4C4%22%2F%3E%0A%3C%2Fmask%3E%0A%3Cg%20mask%3D%22url(%23mask1_613_177)%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.845%207.0699%2012.2165%207.33978%2012.642%207.36863L16.2361%207.61233C16.5692%207.63492%2016.7047%208.05202%2016.4485%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.2149%2011.2859%2013.3189%2011.6996L14.1978%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6417%2015.5971L10.5908%2013.6817C10.2295%2013.4549%209.77039%2013.4549%209.40918%2013.6817L6.35822%2015.5971C6.07547%2015.7746%205.72066%2015.5168%205.80211%2015.1931L6.68098%2011.6996C6.78504%2011.2859%206.64316%2010.8493%206.31586%2010.5758L3.55139%208.26607C3.29519%208.05202%203.43072%207.63492%203.7638%207.61233L7.35793%207.36863C7.78346%207.33978%208.15491%207.0699%208.31385%206.67412L9.65627%203.3312C9.78068%203.0214%2010.2192%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A",starFull:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.8451%207.0699%2012.2165%207.33978%2012.6421%207.36863L16.2362%207.61233C16.5693%207.63492%2016.7048%208.05202%2016.4486%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.215%2011.2859%2013.319%2011.6996L14.1979%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6418%2015.5971L10.5908%2013.6817C10.2296%2013.4549%209.77045%2013.4549%209.40924%2013.6817L6.35828%2015.5971C6.07553%2015.7746%205.72072%2015.5168%205.80217%2015.1931L6.68105%2011.6996C6.7851%2011.2859%206.64322%2010.8493%206.31592%2010.5758L3.55145%208.26607C3.29525%208.05202%203.43078%207.63492%203.76386%207.61233L7.358%207.36863C7.78352%207.33978%208.15498%207.0699%208.31391%206.67412L9.65633%203.3312C9.78074%203.0214%2010.2193%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fsvg%3E%0A"},v0={progress0:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress25:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cpath%20d%3D%22M16.2963%209.99991C16.2963%209.17307%2016.1335%208.35432%2015.8171%207.59042C15.5006%206.82652%2015.0369%206.13242%2014.4522%205.54776C13.8675%204.96309%2013.1734%204.49931%2012.4095%204.18289C11.6456%203.86647%2010.8269%203.70361%2010%203.70361L10%209.99991H16.2963Z%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress50:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cpath%20d%3D%22M10%2016.2962C11.6699%2016.2962%2013.2714%2015.6328%2014.4522%2014.4521C15.633%2013.2713%2016.2963%2011.6698%2016.2963%209.99991C16.2963%208.33003%2015.633%206.72854%2014.4522%205.54776C13.2714%204.36697%2011.6699%203.70361%2010%203.70361L10%209.99991L10%2016.2962Z%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress75:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cpath%20d%3D%22M3.70374%209.99991C3.70374%2011.2452%204.07301%2012.4625%204.76485%2013.4979C5.4567%2014.5334%206.44005%2015.3404%207.59054%2015.8169C8.74104%2016.2935%2010.007%2016.4182%2011.2284%2016.1752C12.4497%2015.9323%2013.5716%2015.3326%2014.4522%2014.4521C15.3327%2013.5715%2015.9324%2012.4496%2016.1753%2011.2283C16.4183%2010.0069%2016.2936%208.74092%2015.8171%207.59042C15.3405%206.43992%2014.5335%205.45658%2013.4981%204.76473C12.4626%204.07288%2011.2453%203.70361%2010%203.70361L10%209.99991L3.70374%209.99991Z%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress100:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99991%22%20r%3D%226.2963%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A"},w0={signal0:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal25:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal50:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal75:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal100:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93933%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70447%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A"},p0={guffaw:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16.887%2010C16.887%2013.8037%2013.8036%2016.8871%209.99999%2016.8871C6.19638%2016.8871%203.11295%2013.8037%203.11295%2010C3.11295%206.19644%206.19638%203.11301%209.99999%203.11301C13.8036%203.11301%2016.887%206.19644%2016.887%2010Z%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M12.5355%2013.5821C13.0482%2013.1841%2013.3951%2012.6107%2013.5405%2012.0327C13.5934%2011.8226%2013.5051%2011.6349%2013.3518%2011.5331C13.2036%2011.4346%2013.0031%2011.4203%2012.8265%2011.5131C11.0615%2012.4407%208.94609%2012.4427%207.1828%2011.513C7.00629%2011.4199%206.80602%2011.4343%206.65798%2011.5329C6.50518%2011.6346%206.41701%2011.8217%206.46844%2012.0312C6.61029%2012.609%206.95079%2013.1833%207.46449%2013.5821C8.14361%2014.1093%209.05608%2014.3999%2010%2014.3999C10.9439%2014.3999%2011.8564%2014.1093%2012.5355%2013.5821Z%22%20fill%3D%22white%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.4%22%2F%3E%0A%3C%2Fsvg%3E%0A",smile:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.03705%2011.8518C7.03705%2011.8518%207.77779%2013.7037%2010%2013.7037C12.2222%2013.7037%2012.963%2011.8518%2012.963%2011.8518%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.962963%22%20stroke-linecap%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A",noninductive:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.9259%22%20width%3D%221.48148%22%20height%3D%221.11111%22%20rx%3D%220.555556%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.9259%22%20width%3D%221.48148%22%20height%3D%221.11111%22%20rx%3D%220.555556%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.03705%2012.5927C7.03705%2012.5927%208.14816%2012.5927%2010.3704%2012.5927C12.5926%2012.5927%2012.963%2012.5927%2012.963%2012.5927%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.962963%22%20stroke-linecap%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A",dissatisfied:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.03705%2013.7037C7.03705%2013.7037%207.77779%2011.8519%2010%2011.8519C12.2222%2011.8519%2012.963%2013.7037%2012.963%2013.7037%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.962963%22%20stroke-linecap%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A",impatient:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.47573%2011.731C6.96306%2012.129%206.61613%2012.7024%206.47071%2013.2804C6.41784%2013.4905%206.50617%2013.6782%206.65942%2013.78C6.80761%2013.8785%207.00813%2013.8928%207.18477%2013.8C8.9498%2012.8724%2011.0652%2012.8704%2012.8285%2013.8002C13.005%2013.8932%2013.2052%2013.8788%2013.3533%2013.7802C13.5061%2013.6785%2013.5942%2013.4914%2013.5428%2013.2819C13.401%2012.7041%2013.0605%2012.1298%2012.5468%2011.731C11.8676%2011.2038%2010.9552%2010.9132%2010.0112%2010.9132C9.06732%2010.9132%208.15485%2011.2038%207.47573%2011.731Z%22%20fill%3D%22white%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.4%22%2F%3E%0A%3C%2Fsvg%3E%0A"},E0=JSON.parse('{"down-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M8.90467%203.99244C8.84611%204.1338%208.84611%204.31301%208.84611%204.67143V13.716L5.92068%2010.7906C5.66724%2010.5371%205.54052%2010.4104%205.39916%2010.3519C5.21067%2010.2738%204.9989%2010.2738%204.81041%2010.3519C4.66905%2010.4104%204.54233%2010.5371%204.28889%2010.7906C4.03545%2011.044%203.90873%2011.1707%203.85018%2011.3121C3.77211%2011.5006%203.77211%2011.7124%203.85018%2011.9008C3.90873%2012.0422%204.03545%2012.1689%204.28889%2012.4224L9.03476%2017.1682C9.07839%2017.2127%209.12737%2017.2617%209.18231%2017.3166L9.18239%2017.3167L9.18241%2017.3167C9.40545%2017.5398%209.53035%2017.6647%209.65346%2017.7313C9.67085%2017.7408%209.6882%2017.7492%209.70577%2017.7564C9.89425%2017.8345%2010.106%2017.8345%2010.2945%2017.7564C10.4359%2017.6979%2010.5626%2017.5712%2010.816%2017.3177C10.8986%2017.2352%2010.9677%2017.1661%2011.0253%2017.1056L15.7095%2012.4214L15.7095%2012.4213C15.963%2012.1679%2016.0897%2012.0412%2016.1482%2011.8998C16.2263%2011.7114%2016.2263%2011.4996%2016.1482%2011.3111C16.0897%2011.1697%2015.963%2011.043%2015.7095%2010.7896C15.4561%2010.5361%2015.3294%2010.4094%2015.188%2010.3509C14.9995%2010.2728%2014.7878%2010.2728%2014.5993%2010.3509C14.4579%2010.4094%2014.3312%2010.5361%2014.0778%2010.7896L14.0777%2010.7896L11.1538%2013.7135V4.67142C11.1538%204.31301%2011.1538%204.1338%2011.0953%203.99244C11.0172%203.80395%2010.8674%203.6542%2010.6789%203.57613C10.5376%203.51758%2010.3584%203.51758%209.99996%203.51758C9.64154%203.51758%209.46233%203.51758%209.32097%203.57613C9.13249%203.6542%208.98274%203.80395%208.90467%203.99244Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","right-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.32508%2011.7609C3.46644%2011.8194%203.64565%2011.8194%204.00407%2011.8194H13.049L10.1235%2014.745C9.87002%2014.9984%209.7433%2015.1251%209.68475%2015.2665C9.60668%2015.455%209.60668%2015.6668%209.68475%2015.8552C9.7433%2015.9966%209.87002%2016.1233%2010.1235%2016.3768C10.3769%2016.6302%2010.5036%2016.7569%2010.645%2016.8155C10.8335%2016.8935%2011.0452%2016.8935%2011.2337%2016.8155C11.3751%2016.7569%2011.5018%2016.6302%2011.7552%2016.3768L16.5105%2011.6215C16.5524%2011.5803%2016.5983%2011.5344%2016.6493%2011.4834L16.6495%2011.4831C16.8561%2011.2765%2016.9785%2011.1542%2017.0484%2011.0394C17.0648%2011.0128%2017.0782%2010.9866%2017.0893%2010.9599C17.1674%2010.7714%2017.1674%2010.5596%2017.0893%2010.3711C17.0308%2010.2298%2016.904%2010.1031%2016.6506%209.84962C16.5685%209.76752%2016.4997%209.69872%2016.4394%209.64123L11.7542%204.95601C11.5007%204.70257%2011.374%204.57585%2011.2327%204.5173C11.0442%204.43923%2010.8324%204.43923%2010.6439%204.5173C10.5026%204.57585%2010.3758%204.70257%2010.1224%204.95601L10.1224%204.95601C9.86895%205.20945%209.74223%205.33617%209.68368%205.47753C9.60561%205.66601%209.60561%205.87779%209.68368%206.06627C9.74223%206.20764%209.86895%206.33436%2010.1224%206.5878L13.0463%209.51175H4.00407C3.64565%209.51175%203.46644%209.51175%203.32508%209.5703C3.1366%209.64837%202.98685%209.79812%202.90877%209.98661C2.85022%2010.128%202.85022%2010.3072%202.85022%2010.6656C2.85022%2011.024%202.85022%2011.2032%202.90877%2011.3446C2.98685%2011.5331%203.1366%2011.6828%203.32508%2011.7609Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","up-green":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.0936%2017.3406C11.1522%2017.1992%2011.1522%2017.02%2011.1522%2016.6616V7.61701L14.0776%2010.5424C14.3311%2010.7959%2014.4578%2010.9226%2014.5991%2010.9811C14.7876%2011.0592%2014.9994%2011.0592%2015.1879%2010.9811C15.3292%2010.9226%2015.456%2010.7959%2015.7094%2010.5424C15.9628%2010.289%2016.0896%2010.1623%2016.1481%2010.0209C16.2262%209.83243%2016.2262%209.62066%2016.1481%209.43217C16.0896%209.29081%2015.9628%209.16409%2015.7094%208.91065L10.9645%204.16576C10.9207%204.12105%2010.8714%204.07178%2010.8161%204.01648L10.8159%204.0163C10.5916%203.792%2010.4666%203.66696%2010.3428%203.60058C10.3261%203.59154%2010.3094%203.58358%2010.2925%203.57658C10.104%203.49851%209.89226%203.49851%209.70378%203.57658C9.56242%203.63514%209.4357%203.76186%209.18226%204.0153C9.09955%204.09801%209.03034%204.16722%208.97258%204.22785L4.28878%208.91166C4.03534%209.1651%203.90862%209.29182%203.85006%209.43318C3.77199%209.62166%203.77199%209.83344%203.85006%2010.0219C3.90862%2010.1633%204.03534%2010.29%204.28878%2010.5434C4.54221%2010.7969%204.66893%2010.9236%204.8103%2010.9822C4.99878%2011.0602%205.21056%2011.0602%205.39904%2010.9822C5.5404%2010.9236%205.66712%2010.7969%205.92056%2010.5434L5.92056%2010.5434L8.84449%207.61951V16.6616C8.84449%2017.02%208.84449%2017.1992%208.90305%2017.3406C8.98112%2017.5291%209.13087%2017.6788%209.31935%2017.7569C9.46072%2017.8154%209.63992%2017.8154%209.99834%2017.8154C10.3568%2017.8154%2010.536%2017.8154%2010.6773%2017.7569C10.8658%2017.6788%2011.0156%2017.5291%2011.0936%2017.3406Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndDown-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.5062%206.72126C4.56476%206.86262%204.69148%206.98934%204.94492%207.24278L11.3404%2013.6382L7.20313%2013.6382C6.84471%2013.6382%206.66551%2013.6382%206.52414%2013.6968C6.33566%2013.7749%206.18591%2013.9246%206.10784%2014.1131C6.04928%2014.2545%206.04928%2014.4337%206.04928%2014.7921C6.04928%2015.1505%206.04928%2015.3297%206.10784%2015.4711C6.18591%2015.6596%206.33566%2015.8093%206.52414%2015.8874C6.66551%2015.9459%206.84471%2015.9459%207.20313%2015.9459L13.9194%2015.9459C13.9805%2015.9465%2014.0484%2015.9465%2014.1243%2015.9465H14.1243C14.4353%2015.9465%2014.6114%2015.9465%2014.7449%2015.9082C14.7659%2015.9023%2014.7859%2015.8954%2014.8052%2015.8874C14.9937%2015.8093%2015.1434%2015.6596%2015.2215%2015.4711C15.2801%2015.3297%2015.2801%2015.1505%2015.2801%2014.7921C15.2801%2014.6767%2015.2801%2014.5799%2015.2781%2014.497L15.2781%207.86957C15.2781%207.51115%2015.2781%207.33194%2015.2195%207.19058C15.1415%207.0021%2014.9917%206.85235%2014.8032%206.77428C14.6619%206.71572%2014.4827%206.71572%2014.1243%206.71572C13.7658%206.71572%2013.5866%206.71572%2013.4453%206.77428C13.2568%206.85235%2013.107%207.0021%2013.029%207.19058C12.9704%207.33194%2012.9704%207.51115%2012.9704%207.86957L12.9704%2012.0047L6.5767%205.61099C6.32326%205.35755%206.19654%205.23083%206.05518%205.17228C5.8667%205.09421%205.65492%205.09421%205.46644%205.17228C5.32508%205.23083%205.19836%205.35755%204.94492%205.61099C4.69148%205.86443%204.56476%205.99115%204.5062%206.13251C4.42813%206.32099%204.42813%206.53277%204.5062%206.72126Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndUp-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.05431%2016.1597C6.19567%2016.1012%206.32239%2015.9745%206.57583%2015.721L12.9712%209.32568L12.9712%2013.4626C12.9712%2013.821%2012.9712%2014.0002%2013.0297%2014.1416C13.1078%2014.3301%2013.2576%2014.4798%2013.446%2014.5579C13.5874%2014.6164%2013.7666%2014.6164%2014.125%2014.6164C14.4834%2014.6164%2014.6626%2014.6164%2014.804%2014.5579C14.9925%2014.4798%2015.1422%2014.3301%2015.2203%2014.1416C15.2789%2014.0002%2015.2789%2013.821%2015.2789%2013.4626L15.2789%206.75233C15.2795%206.68972%2015.2795%206.62004%2015.2795%206.54182L15.2795%206.54157C15.2795%206.22585%2015.2795%206.04918%2015.2395%205.91495C15.2339%205.89605%2015.2276%205.878%2015.2203%205.86053C15.1422%205.67204%2014.9925%205.52229%2014.804%205.44422C14.6626%205.38567%2014.4834%205.38567%2014.125%205.38567L14.125%205.38567C14.0075%205.38567%2013.9093%205.38567%2013.8254%205.38773L7.20256%205.38773C6.84414%205.38773%206.66493%205.38773%206.52357%205.44628C6.33509%205.52436%206.18534%205.6741%206.10727%205.86259C6.04871%206.00395%206.04871%206.18315%206.04871%206.54156V6.54157L6.04871%206.54159C6.04871%206.9%206.04871%207.0792%206.10727%207.22056C6.18534%207.40905%206.33509%207.55879%206.52357%207.63687C6.66493%207.69542%206.84414%207.69542%207.20256%207.69542H11.3379L4.94405%2014.0892C4.69061%2014.3427%204.56389%2014.4694%204.50533%2014.6108C4.42726%2014.7992%204.42726%2015.011%204.50533%2015.1995C4.56389%2015.3409%204.69061%2015.4676%204.94405%2015.721C5.19749%2015.9745%205.32421%2016.1012%205.46557%2016.1597C5.65405%2016.2378%205.86583%2016.2378%206.05431%2016.1597Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","down-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M8.90467%203.99244C8.84611%204.1338%208.84611%204.31301%208.84611%204.67143V13.716L5.92068%2010.7906C5.66724%2010.5371%205.54052%2010.4104%205.39916%2010.3519C5.21067%2010.2738%204.9989%2010.2738%204.81041%2010.3519C4.66905%2010.4104%204.54233%2010.5371%204.28889%2010.7906C4.03545%2011.044%203.90873%2011.1707%203.85018%2011.3121C3.77211%2011.5006%203.77211%2011.7124%203.85018%2011.9008C3.90873%2012.0422%204.03545%2012.1689%204.28889%2012.4224L9.03476%2017.1682C9.07839%2017.2127%209.12737%2017.2617%209.18231%2017.3166L9.18239%2017.3167L9.18241%2017.3167C9.40545%2017.5398%209.53035%2017.6647%209.65346%2017.7313C9.67085%2017.7408%209.6882%2017.7492%209.70577%2017.7564C9.89425%2017.8345%2010.106%2017.8345%2010.2945%2017.7564C10.4359%2017.6979%2010.5626%2017.5712%2010.816%2017.3177C10.8986%2017.2352%2010.9677%2017.1661%2011.0253%2017.1056L15.7095%2012.4214L15.7095%2012.4213C15.963%2012.1679%2016.0897%2012.0412%2016.1482%2011.8998C16.2263%2011.7114%2016.2263%2011.4996%2016.1482%2011.3111C16.0897%2011.1697%2015.963%2011.043%2015.7095%2010.7896C15.4561%2010.5361%2015.3294%2010.4094%2015.188%2010.3509C14.9995%2010.2728%2014.7878%2010.2728%2014.5993%2010.3509C14.4579%2010.4094%2014.3312%2010.5361%2014.0778%2010.7896L14.0777%2010.7896L11.1538%2013.7135V4.67142C11.1538%204.31301%2011.1538%204.1338%2011.0953%203.99244C11.0172%203.80395%2010.8674%203.6542%2010.6789%203.57613C10.5376%203.51758%2010.3584%203.51758%209.99996%203.51758C9.64154%203.51758%209.46233%203.51758%209.32097%203.57613C9.13249%203.6542%208.98274%203.80395%208.90467%203.99244Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","right-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.32508%2011.7609C3.46644%2011.8194%203.64565%2011.8194%204.00407%2011.8194H13.049L10.1235%2014.745C9.87002%2014.9984%209.7433%2015.1251%209.68475%2015.2665C9.60668%2015.455%209.60668%2015.6668%209.68475%2015.8552C9.7433%2015.9966%209.87002%2016.1233%2010.1235%2016.3768C10.3769%2016.6302%2010.5036%2016.7569%2010.645%2016.8155C10.8335%2016.8935%2011.0452%2016.8935%2011.2337%2016.8155C11.3751%2016.7569%2011.5018%2016.6302%2011.7552%2016.3768L16.5105%2011.6215C16.5524%2011.5803%2016.5983%2011.5344%2016.6493%2011.4834L16.6495%2011.4831C16.8561%2011.2765%2016.9785%2011.1542%2017.0484%2011.0394C17.0648%2011.0128%2017.0782%2010.9866%2017.0893%2010.9599C17.1674%2010.7714%2017.1674%2010.5596%2017.0893%2010.3711C17.0308%2010.2298%2016.904%2010.1031%2016.6506%209.84962C16.5685%209.76752%2016.4997%209.69872%2016.4394%209.64123L11.7542%204.95601C11.5007%204.70257%2011.374%204.57585%2011.2327%204.5173C11.0442%204.43923%2010.8324%204.43923%2010.6439%204.5173C10.5026%204.57585%2010.3758%204.70257%2010.1224%204.95601L10.1224%204.95601C9.86895%205.20945%209.74223%205.33617%209.68368%205.47753C9.60561%205.66601%209.60561%205.87779%209.68368%206.06627C9.74223%206.20764%209.86895%206.33436%2010.1224%206.5878L13.0463%209.51175H4.00407C3.64565%209.51175%203.46644%209.51175%203.32508%209.5703C3.1366%209.64837%202.98685%209.79812%202.90877%209.98661C2.85022%2010.128%202.85022%2010.3072%202.85022%2010.6656C2.85022%2011.024%202.85022%2011.2032%202.90877%2011.3446C2.98685%2011.5331%203.1366%2011.6828%203.32508%2011.7609Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","up-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.0936%2017.3406C11.1522%2017.1992%2011.1522%2017.02%2011.1522%2016.6616V7.61701L14.0776%2010.5424C14.3311%2010.7959%2014.4578%2010.9226%2014.5991%2010.9811C14.7876%2011.0592%2014.9994%2011.0592%2015.1879%2010.9811C15.3292%2010.9226%2015.456%2010.7959%2015.7094%2010.5424C15.9628%2010.289%2016.0896%2010.1623%2016.1481%2010.0209C16.2262%209.83243%2016.2262%209.62066%2016.1481%209.43217C16.0896%209.29081%2015.9628%209.16409%2015.7094%208.91065L10.9645%204.16576C10.9207%204.12105%2010.8714%204.07178%2010.8161%204.01648L10.8159%204.0163C10.5916%203.792%2010.4666%203.66696%2010.3428%203.60058C10.3261%203.59154%2010.3094%203.58358%2010.2925%203.57658C10.104%203.49851%209.89226%203.49851%209.70378%203.57658C9.56242%203.63514%209.4357%203.76186%209.18226%204.0153C9.09955%204.09801%209.03034%204.16722%208.97258%204.22785L4.28878%208.91166C4.03534%209.1651%203.90862%209.29182%203.85006%209.43318C3.77199%209.62166%203.77199%209.83344%203.85006%2010.0219C3.90862%2010.1633%204.03534%2010.29%204.28878%2010.5434C4.54221%2010.7969%204.66893%2010.9236%204.8103%2010.9822C4.99878%2011.0602%205.21056%2011.0602%205.39904%2010.9822C5.5404%2010.9236%205.66712%2010.7969%205.92056%2010.5434L5.92056%2010.5434L8.84449%207.61951V16.6616C8.84449%2017.02%208.84449%2017.1992%208.90305%2017.3406C8.98112%2017.5291%209.13087%2017.6788%209.31935%2017.7569C9.46072%2017.8154%209.63992%2017.8154%209.99834%2017.8154C10.3568%2017.8154%2010.536%2017.8154%2010.6773%2017.7569C10.8658%2017.6788%2011.0156%2017.5291%2011.0936%2017.3406Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndDown-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.5062%206.72126C4.56476%206.86262%204.69148%206.98934%204.94492%207.24278L11.3404%2013.6382L7.20313%2013.6382C6.84471%2013.6382%206.66551%2013.6382%206.52414%2013.6968C6.33566%2013.7749%206.18591%2013.9246%206.10784%2014.1131C6.04928%2014.2545%206.04928%2014.4337%206.04928%2014.7921C6.04928%2015.1505%206.04928%2015.3297%206.10784%2015.4711C6.18591%2015.6596%206.33566%2015.8093%206.52414%2015.8874C6.66551%2015.9459%206.84471%2015.9459%207.20313%2015.9459L13.9194%2015.9459C13.9805%2015.9465%2014.0484%2015.9465%2014.1243%2015.9465H14.1243C14.4353%2015.9465%2014.6114%2015.9465%2014.7449%2015.9082C14.7659%2015.9023%2014.7859%2015.8954%2014.8052%2015.8874C14.9937%2015.8093%2015.1434%2015.6596%2015.2215%2015.4711C15.2801%2015.3297%2015.2801%2015.1505%2015.2801%2014.7921C15.2801%2014.6767%2015.2801%2014.5799%2015.2781%2014.497L15.2781%207.86957C15.2781%207.51115%2015.2781%207.33194%2015.2195%207.19058C15.1415%207.0021%2014.9917%206.85235%2014.8032%206.77428C14.6619%206.71572%2014.4827%206.71572%2014.1243%206.71572C13.7658%206.71572%2013.5866%206.71572%2013.4453%206.77428C13.2568%206.85235%2013.107%207.0021%2013.029%207.19058C12.9704%207.33194%2012.9704%207.51115%2012.9704%207.86957L12.9704%2012.0047L6.5767%205.61099C6.32326%205.35755%206.19654%205.23083%206.05518%205.17228C5.8667%205.09421%205.65492%205.09421%205.46644%205.17228C5.32508%205.23083%205.19836%205.35755%204.94492%205.61099C4.69148%205.86443%204.56476%205.99115%204.5062%206.13251C4.42813%206.32099%204.42813%206.53277%204.5062%206.72126Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndUp-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.05431%2016.1597C6.19567%2016.1012%206.32239%2015.9745%206.57583%2015.721L12.9712%209.32568L12.9712%2013.4626C12.9712%2013.821%2012.9712%2014.0002%2013.0297%2014.1416C13.1078%2014.3301%2013.2576%2014.4798%2013.446%2014.5579C13.5874%2014.6164%2013.7666%2014.6164%2014.125%2014.6164C14.4834%2014.6164%2014.6626%2014.6164%2014.804%2014.5579C14.9925%2014.4798%2015.1422%2014.3301%2015.2203%2014.1416C15.2789%2014.0002%2015.2789%2013.821%2015.2789%2013.4626L15.2789%206.75233C15.2795%206.68972%2015.2795%206.62004%2015.2795%206.54182L15.2795%206.54157C15.2795%206.22585%2015.2795%206.04918%2015.2395%205.91495C15.2339%205.89605%2015.2276%205.878%2015.2203%205.86053C15.1422%205.67204%2014.9925%205.52229%2014.804%205.44422C14.6626%205.38567%2014.4834%205.38567%2014.125%205.38567L14.125%205.38567C14.0075%205.38567%2013.9093%205.38567%2013.8254%205.38773L7.20256%205.38773C6.84414%205.38773%206.66493%205.38773%206.52357%205.44628C6.33509%205.52436%206.18534%205.6741%206.10727%205.86259C6.04871%206.00395%206.04871%206.18315%206.04871%206.54156V6.54157L6.04871%206.54159C6.04871%206.9%206.04871%207.0792%206.10727%207.22056C6.18534%207.40905%206.33509%207.55879%206.52357%207.63687C6.66493%207.69542%206.84414%207.69542%207.20256%207.69542H11.3379L4.94405%2014.0892C4.69061%2014.3427%204.56389%2014.4694%204.50533%2014.6108C4.42726%2014.7992%204.42726%2015.011%204.50533%2015.1995C4.56389%2015.3409%204.69061%2015.4676%204.94405%2015.721C5.19749%2015.9745%205.32421%2016.1012%205.46557%2016.1597C5.65405%2016.2378%205.86583%2016.2378%206.05431%2016.1597Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A"}'),A0={cross:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%223.70374%22%20y%3D%228.14795%22%20width%3D%2212.5926%22%20height%3D%223.7037%22%20rx%3D%220.740741%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A",up:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M9.44533%205.81157C9.74012%205.47858%2010.2598%205.47858%2010.5546%205.81157L16.2868%2012.2867C16.71%2012.7647%2016.3706%2013.5184%2015.7322%2013.5184H4.26776C3.62933%2013.5184%203.28995%2012.7647%203.71313%2012.2867L9.44533%205.81157Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A",down:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.5547%2014.1884C10.2599%2014.5214%209.74019%2014.5214%209.4454%2014.1884L3.71321%207.71335C3.29002%207.23532%203.6294%206.48161%204.26784%206.48161L15.7322%206.48161C16.3707%206.48161%2016.7101%207.23532%2016.2869%207.71335L10.5547%2014.1884Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","rhomboid-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M2.1415%2011.1984C1.8412%2010.9074%201.8412%2010.4256%202.1415%2010.1346L9.48467%203.01785C9.77196%202.73942%2010.2284%202.73942%2010.5157%203.01786L17.8586%2010.1346C18.1589%2010.4256%2018.1589%2010.9074%2017.8586%2011.1984L10.5157%2018.3151C10.2284%2018.5936%209.77196%2018.5936%209.48467%2018.3152L2.1415%2011.1984Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-greed":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-pink":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23FB9D9D%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-black":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22black%22%2F%3E%0A%3C%2Fsvg%3E%0A","triangle-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url(%23clip0_613_237)%22%3E%0A%3Cpath%20d%3D%22M9.32308%204.41301C9.58368%203.82623%2010.4164%203.82623%2010.677%204.413L15.9526%2016.2917C16.1701%2016.7815%2015.8115%2017.3331%2015.2756%2017.3331H4.72454C4.18858%2017.3331%203.83002%2016.7815%204.04756%2016.2917L9.32308%204.41301Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_613_237%22%3E%0A%3Crect%20width%3D%2220%22%20height%3D%2220%22%20fill%3D%22white%22%20transform%3D%22translate(0%200.666504)%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A","indicate-greed":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%222.76941%22%20y%3D%222.76941%22%20width%3D%2214.4612%22%20height%3D%2214.4612%22%20rx%3D%223%22%20fill%3D%22black%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210%22%20r%3D%224.5%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","indicate-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%222.76941%22%20y%3D%222.76941%22%20width%3D%2214.4612%22%20height%3D%2214.4612%22%20rx%3D%223%22%20fill%3D%22black%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210%22%20r%3D%224.5%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","indicate-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%222.76941%22%20y%3D%222.76941%22%20width%3D%2214.4612%22%20height%3D%2214.4612%22%20rx%3D%223%22%20fill%3D%22black%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210%22%20r%3D%224.5%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A"},y0={mistake2:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.12194%206.33702C4.1805%206.47839%204.30722%206.6051%204.56066%206.85854L8.36822%2010.6661L4.56062%2014.4737C4.30718%2014.7272%204.18046%2014.8539%204.12191%2014.9952C4.04384%2015.1837%204.04384%2015.3955%204.12191%2015.584C4.18046%2015.7253%204.30718%2015.8521%204.56062%2016.1055C4.81406%2016.3589%204.94078%2016.4857%205.08214%2016.5442C5.27062%2016.6223%205.4824%2016.6223%205.67089%2016.5442C5.81225%2016.4857%205.93897%2016.3589%206.19241%2016.1055L10%2012.2979L13.8074%2016.1053C14.0609%2016.3588%2014.1876%2016.4855%2014.329%2016.544C14.5174%2016.6221%2014.7292%2016.6221%2014.9177%2016.544C15.0591%2016.4855%2015.1858%2016.3588%2015.4392%2016.1053L15.4392%2016.1053C15.6927%2015.8519%2015.8194%2015.7252%2015.8779%2015.5838C15.956%2015.3953%2015.956%2015.1835%2015.8779%2014.9951C15.8194%2014.8537%2015.6927%2014.727%2015.4392%2014.4735L15.4392%2014.4735L11.6318%2010.6661L15.4392%206.85872C15.6926%206.60528%2015.8193%206.47856%2015.8779%206.3372C15.956%206.14871%2015.956%205.93694%2015.8779%205.74845C15.8193%205.60709%2015.6926%205.48037%2015.4392%205.22693C15.1857%204.97349%2015.059%204.84677%2014.9177%204.78822C14.7292%204.71015%2014.5174%204.71015%2014.3289%204.78822C14.1876%204.84677%2014.0608%204.97349%2013.8074%205.22693L10%209.03433L6.19244%205.22676C5.939%204.97332%205.81228%204.8466%205.67092%204.78805C5.48244%204.70997%205.27066%204.70997%205.08218%204.78805C4.94082%204.8466%204.8141%204.97332%204.56066%205.22676L4.56066%205.22676C4.30722%205.4802%204.1805%205.60692%204.12194%205.74828C4.04387%205.93676%204.04387%206.14854%204.12194%206.33702Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A",warn2:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M8.49778%205.00963C8.48513%204.56774%208.47881%204.3468%208.56086%204.17746C8.63301%204.02856%208.75124%203.90689%208.89802%203.83052C9.06494%203.74365%209.28597%203.74365%209.72805%203.74365H10.272C10.714%203.74365%2010.9351%203.74365%2011.102%203.83052C11.2488%203.9069%2011.367%204.02856%2011.4392%204.17746C11.5212%204.3468%2011.5149%204.56775%2011.5022%205.00964L11.2644%2013.3173C11.2524%2013.737%2011.2464%2013.9468%2011.1609%2014.1065C11.0857%2014.2471%2010.9687%2014.3609%2010.826%2014.432C10.6639%2014.5129%2010.454%2014.5129%2010.0342%2014.5129H9.96582C9.54601%2014.5129%209.33611%2014.5129%209.17397%2014.432C9.0313%2014.3609%208.91426%2014.2471%208.83904%2014.1065C8.75357%2013.9468%208.74756%2013.737%208.73555%2013.3173L8.49778%205.00963Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3Crect%20x%3D%228.76917%22%20y%3D%2215.2817%22%20width%3D%222.46154%22%20height%3D%222.46154%22%20rx%3D%220.769231%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A",correct2:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url(%23clip0_613_248)%22%3E%0A%3Cpath%20d%3D%22M15.689%205.69723C15.5476%205.75578%2015.4209%205.8825%2015.1675%206.13594L7.82436%2013.4791L4.83279%2010.4875C4.57935%2010.2341%204.45263%2010.1073%204.31127%2010.0488C4.12278%209.97071%203.91101%209.97071%203.72252%2010.0488C3.58116%2010.1073%203.45444%2010.2341%203.201%2010.4875C2.94756%2010.7409%202.82084%2010.8676%202.76229%2011.009C2.68422%2011.1975%202.68422%2011.4093%202.76229%2011.5978C2.82084%2011.7391%202.94756%2011.8658%203.201%2012.1193L7.0085%2015.9268C7.26194%2016.1802%207.38866%2016.3069%207.53002%2016.3655C7.7185%2016.4436%207.93028%2016.4436%208.11876%2016.3655C8.26013%2016.3069%208.38685%2016.1802%208.64028%2015.9268C8.66387%2015.9032%208.68636%2015.8807%208.7078%2015.8592L16.7993%207.76772C17.0527%207.51428%2017.1794%207.38756%2017.238%207.2462C17.3161%207.05772%2017.3161%206.84594%2017.238%206.65746C17.1794%206.5161%2017.0527%206.38938%2016.7993%206.13594C16.5458%205.8825%2016.4191%205.75578%2016.2777%205.69723C16.0893%205.61915%2015.8775%205.61915%2015.689%205.69723Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_613_248%22%3E%0A%3Crect%20width%3D%2220%22%20height%3D%2220%22%20fill%3D%22white%22%20transform%3D%22translate(0%200.666504)%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A"},x0={"flag-green":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.4274%204.74935C14.0982%205.1012%2013.1363%205.13675%2012.3604%205.03379C11.5776%204.93009%2010.9487%204.68342%2010.2456%204.40416L10.2246%204.39527C9.53411%204.1212%208.76945%203.8175%207.81312%203.69157C6.84279%203.56268%205.71016%203.61898%204.24802%204.0049C4.09343%204.04217%203.95538%204.13393%203.85649%204.26515C3.7576%204.39636%203.70374%204.55925%203.70374%204.72712V17.3197C3.70374%2017.5162%203.79534%2017.7046%203.92654%2017.8435C4.05773%2017.9824%204.25893%2018.0605%204.44448%2018.0605C4.63002%2018.0605%204.84911%2017.9824%204.98031%2017.8435C5.11151%2017.7046%205.18522%2017.5162%205.18522%2017.3197V14.9123V12.5049C6.24649%2012.2738%206.97081%2012.2605%207.63962%2012.3486C8.42246%2012.4523%209.05139%2012.699%209.75448%2012.9782L9.77546%2012.9871C10.466%2013.2612%2011.2306%2013.5649%2012.1869%2013.6908C13.1601%2013.8197%2014.2976%2013.7627%2015.7667%2013.3738C15.8866%2013.3421%2016.0727%2013.2135%2016.1483%2013.111C16.2238%2013.0084%2016.2963%2012.8204%2016.2963%2012.6553V5.46787C16.2963%205.35535%2016.2721%205.24432%2016.2255%205.1432C16.1788%205.04208%2016.1111%204.95353%2016.0274%204.88428C15.9436%204.81502%2015.846%204.76688%2015.7421%204.7435C15.6382%204.72012%2015.494%204.73173%2015.4274%204.74935Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","flag-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.4274%204.74935C14.0982%205.1012%2013.1363%205.13675%2012.3604%205.03379C11.5776%204.93009%2010.9487%204.68342%2010.2456%204.40416L10.2246%204.39527C9.53411%204.1212%208.76945%203.8175%207.81312%203.69157C6.84279%203.56268%205.71016%203.61898%204.24802%204.0049C4.09343%204.04217%203.95538%204.13393%203.85649%204.26515C3.7576%204.39636%203.70374%204.55925%203.70374%204.72712V17.3197C3.70374%2017.5162%203.79534%2017.7046%203.92654%2017.8435C4.05773%2017.9824%204.25893%2018.0605%204.44448%2018.0605C4.63002%2018.0605%204.84911%2017.9824%204.98031%2017.8435C5.11151%2017.7046%205.18522%2017.5162%205.18522%2017.3197V14.9123V12.5049C6.24649%2012.2738%206.97081%2012.2605%207.63962%2012.3486C8.42246%2012.4523%209.05139%2012.699%209.75448%2012.9782L9.77546%2012.9871C10.466%2013.2612%2011.2306%2013.5649%2012.1869%2013.6908C13.1601%2013.8197%2014.2976%2013.7627%2015.7667%2013.3738C15.8866%2013.3421%2016.0727%2013.2135%2016.1483%2013.111C16.2238%2013.0084%2016.2963%2012.8204%2016.2963%2012.6553V5.46787C16.2963%205.35535%2016.2721%205.24432%2016.2255%205.1432C16.1788%205.04208%2016.1111%204.95353%2016.0274%204.88428C15.9436%204.81502%2015.846%204.76688%2015.7421%204.7435C15.6382%204.72012%2015.494%204.73173%2015.4274%204.74935Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","flag-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.4274%204.74935C14.0982%205.1012%2013.1363%205.13675%2012.3604%205.03379C11.5776%204.93009%2010.9487%204.68342%2010.2456%204.40416L10.2246%204.39527C9.53411%204.1212%208.76945%203.8175%207.81312%203.69157C6.84279%203.56268%205.71016%203.61898%204.24802%204.0049C4.09343%204.04217%203.95538%204.13393%203.85649%204.26515C3.7576%204.39636%203.70374%204.55925%203.70374%204.72712V17.3197C3.70374%2017.5162%203.79534%2017.7046%203.92654%2017.8435C4.05773%2017.9824%204.25893%2018.0605%204.44448%2018.0605C4.63002%2018.0605%204.84911%2017.9824%204.98031%2017.8435C5.11151%2017.7046%205.18522%2017.5162%205.18522%2017.3197V14.9123V12.5049C6.24649%2012.2738%206.97081%2012.2605%207.63962%2012.3486C8.42246%2012.4523%209.05139%2012.699%209.75448%2012.9782L9.77546%2012.9871C10.466%2013.2612%2011.2306%2013.5649%2012.1869%2013.6908C13.1601%2013.8197%2014.2976%2013.7627%2015.7667%2013.3738C15.8866%2013.3421%2016.0727%2013.2135%2016.1483%2013.111C16.2238%2013.0084%2016.2963%2012.8204%2016.2963%2012.6553V5.46787C16.2963%205.35535%2016.2721%205.24432%2016.2255%205.1432C16.1788%205.04208%2016.1111%204.95353%2016.0274%204.88428C15.9436%204.81502%2015.846%204.76688%2015.7421%204.7435C15.6382%204.72012%2015.494%204.73173%2015.4274%204.74935Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A"},_0={"cell-0":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224%22%20y%3D%224.00098%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%224.00098%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-25":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%224.00098%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-50":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-75":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%2211.251%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-100":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%2211.251%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%2211.251%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3C%2Fsvg%3E%0A"},f={feedback:m0,star:F0,progress:v0,signal:w0,feeling:p0,arrow:E0,shape:A0,feedback2:y0,flag:x0,cell:_0},j2=[{title:"sheet.cf.iconSet.direction",group:[{name:"3Arrows",list:[f.arrow["up-green"],f.arrow["right-gold"],f.arrow["down-red"]]},{name:"3ArrowsGray",list:[f.arrow["up-gray"],f.arrow["right-gray"],f.arrow["down-gray"]]},{name:"4Arrows",list:[f.arrow["up-green"],f.arrow["rightAndUp-gold"],f.arrow["rightAndDown-gold"],f.arrow["down-red"]]},{name:"4ArrowsGray",list:[f.arrow["up-gray"],f.arrow["rightAndUp-gray"],f.arrow["rightAndDown-gray"],f.arrow["down-gray"]]},{name:"5Arrows",list:[f.arrow["up-green"],f.arrow["rightAndUp-gold"],f.arrow["right-gold"],f.arrow["rightAndDown-gold"],f.arrow["down-red"]]},{name:"5ArrowsGray",list:[f.arrow["up-gray"],f.arrow["rightAndUp-gray"],f.arrow["right-gray"],f.arrow["rightAndDown-gray"],f.arrow["down-gray"]]},{name:"3Triangles",list:[f.shape.up,f.shape.cross,f.shape.down]}]},{title:"sheet.cf.iconSet.shape",group:[{name:"3TrafficLights1",list:[f.shape["roundness-greed"],f.shape["roundness-gold"],f.shape["roundness-red"]]},{name:"3Signs",list:[f.shape["roundness-greed"],f.shape["triangle-gold"],f.shape["rhomboid-red"]]},{name:"3TrafficLights2",list:[f.shape["indicate-greed"],f.shape["indicate-gold"],f.shape["indicate-red"]]},{name:"4RedToBlack",list:[f.shape["roundness-red"],f.shape["roundness-pink"],f.shape["roundness-gray"],f.shape["roundness-black"]]},{name:"4TrafficLights",list:[f.shape["roundness-greed"],f.shape["roundness-gold"],f.shape["roundness-red"],f.shape["roundness-black"]]}]},{title:"sheet.cf.iconSet.mark",group:[{name:"3Symbols",list:[f.feedback.correct,f.feedback.warn,f.feedback.mistake]},{name:"3Symbols2",list:[f.feedback2.correct2,f.feedback2.warn2,f.feedback2.mistake2]},{name:"3Flags",list:[f.flag["flag-green"],f.flag["flag-gold"],f.flag["flag-red"]]}]},{title:"sheet.cf.iconSet.rank",group:[{name:"4Rating",list:[f.signal.signal25,f.signal.signal50,f.signal.signal75,f.signal.signal100]},{name:"5Rating",list:[f.signal.signal0,f.signal.signal25,f.signal.signal50,f.signal.signal75,f.signal.signal100]},{name:"5Quarters",list:[f.progress.progress100,f.progress.progress75,f.progress.progress50,f.progress.progress25,f.progress.progress0]},{name:"_5Felling",list:[f.feeling.guffaw,f.feeling.smile,f.feeling.noninductive,f.feeling.dissatisfied,f.feeling.impatient]},{name:"5Boxes",list:[f.cell["cell-100"],f.cell["cell-75"],f.cell["cell-50"],f.cell["cell-25"],f.cell["cell-0"]]},{name:"3Stars",list:[f.star.starFull,f.star.starIncomplete,f.star.starEmpty]}]}],t2=j2.reduce((i,s)=>{const{group:n}=s;for(const e of n)i[e.name]=e.list;return i},{});for(const i in t2){const s=t2[i];Object.freeze(s)}const P2="EMPTY_ICON_TYPE",M0="ssheets-conditional-formatting.config",A2={};var I0=Object.getOwnPropertyDescriptor,R0=(i,s,n,e)=>{for(var t=e>1?void 0:e?I0(s,n):s,r=i.length-1,a;r>=0;r--)(a=i[r])&&(t=a(t)||t);return t},Z=(i,s)=>(n,e)=>s(n,e,i);exports.ConditionalFormattingService=class extends u.Disposable{constructor(s,n,e,t,r,a){super(),this._conditionalFormattingRuleModel=s,this._injector=n,this._univerInstanceService=e,this._resourceManagerService=t,this._sheetInterceptorService=r,this._commandService=a,this._initCellChange(),this._initSnapshot(),this._initSheetChange()}get _conditionalFormattingViewModelV2(){return this._injector.get(exports.ConditionalFormattingViewModel)}composeStyle(s,n,e,t){const r=this._conditionalFormattingViewModelV2.getCellCfs(s,n,e,t);if(r&&(r!=null&&r.length)){const a=r.map(o=>this._conditionalFormattingRuleModel.getRule(s,n,o.cfId)).filter(o=>!!o).reverse(),l=a.findIndex(o=>o==null?void 0:o.stopIfTrue);return l>-1&&a.splice(l+1),a.reduce((o,c)=>{var C;const h=c.rule.type,g=r.find(D=>D.cfId===c.cfId);if(h===M.highlightCell)g.result&&u.merge(o,{style:g.result});else if(h===M.colorScale){const D=g==null?void 0:g.result;D&&typeof D=="string"&&(o.style={...(C=o.style)!=null?C:{},bg:{rgb:D}})}else if(h===M.dataBar){const D=g==null?void 0:g.result;D&&(o.dataBar=D,o.isShowValue=D.isShowValue)}else if(h===M.iconSet){const D=g==null?void 0:g.result;D&&(o.iconSet=D,o.isShowValue=D.isShowValue)}return o},{})}return null}_initSnapshot(){const s=e=>{const t=this._conditionalFormattingRuleModel.getUnitRules(e),r={};return t?(t.forEach((a,l)=>{r[l]=a}),JSON.stringify(r)):""},n=e=>{if(!e)return{};try{return JSON.parse(e)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({pluginName:F2,businesses:[u.UniverInstanceType.UNIVER_SHEET],toJson:e=>s(e),parseJson:e=>n(e),onUnLoad:e=>{this._conditionalFormattingRuleModel.deleteUnitId(e),!u.isInternalEditorID(e)&&this._conditionalFormattingViewModelV2.dispose()},onLoad:(e,t)=>{Object.keys(t).forEach(r=>{[...t[r]].reverse().forEach(l=>{this._conditionalFormattingRuleModel.addRule(e,r,l)})})}}))}_initSheetChange(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:s=>{if(s.id===p.RemoveSheetCommand.id){const n=s.params,e=n.unitId||S0(this._univerInstanceService),t=n.subUnitId||b0(this._univerInstanceService);if(!t)return{redos:[],undos:[]};const r=this._conditionalFormattingRuleModel.getSubunitRules(e,t);if(!r)return{redos:[],undos:[]};const a=[],l=[];return r.forEach(d=>{const o={unitId:e,subUnitId:t,cfId:d.cfId};a.push({id:$.id,params:o}),l.push(...n2(this._injector,o))}),{redos:a,undos:l}}else if(s.id===p.CopySheetCommand.id){const n=s.params,{unitId:e,subUnitId:t,targetSubUnitId:r}=n;if(!e||!t||!r)return{redos:[],undos:[]};const a=this._conditionalFormattingRuleModel.getSubunitRules(e,t);if(!a)return{redos:[],undos:[]};const l=[],d=[];return a.forEach(o=>{const c={unitId:e,subUnitId:r,rule:{...o,cfId:this._conditionalFormattingRuleModel.createCfId(e,r)}};l.push({id:Y.id,params:c}),d.push(w2(this._injector,c))}),{redos:l,undos:d}}return{redos:[],undos:[]}}}))}_initCellChange(){this.disposeWithMe(this._commandService.onCommandExecuted(s=>{const n=(e,t,r)=>{const a=new Set;return r.forEach(([l,d])=>{const o=this._conditionalFormattingViewModelV2.getCellCfs(e,t,l,d);o==null||o.forEach(c=>a.add(c.cfId))}),[...a].map(l=>this._conditionalFormattingRuleModel.getRule(e,t,l)).filter(l=>!!l)};switch(s.id){case p.SetRangeValuesMutation.id:{const e=s.params,{subUnitId:t,unitId:r,cellValue:a}=e,l=[];new u.ObjectMatrix(a).forValue((o,c,h)=>{h&&Object.keys(h).some(C=>["p","v"].includes(C))&&l.push([o,c])}),n(r,t,l).forEach(o=>{this._conditionalFormattingViewModelV2.markRuleDirty(r,t,o.cfId)});break}case p.InsertColMutation.id:case p.RemoveColMutation.id:{const{range:e,unitId:t,subUnitId:r}=s.params,a=this._conditionalFormattingRuleModel.getSubunitRules(t,r),l={...e,endColumn:Number.MAX_SAFE_INTEGER};a&&a.filter(o=>o.ranges.some(c=>u.Rectangle.intersects(c,l))).forEach(o=>{this._conditionalFormattingViewModelV2.markRuleDirty(t,r,o.cfId)});break}case p.RemoveRowMutation.id:case p.InsertRowMutation.id:{const{range:e,unitId:t,subUnitId:r}=s.params,a=this._conditionalFormattingRuleModel.getSubunitRules(t,r),l={...e,endRow:Number.MAX_SAFE_INTEGER};a&&a.filter(o=>o.ranges.some(c=>u.Rectangle.intersects(c,l))).forEach(o=>{this._conditionalFormattingViewModelV2.markRuleDirty(t,r,o.cfId)});break}case p.MoveRowsMutation.id:{const{sourceRange:e,targetRange:t,unitId:r,subUnitId:a}=s.params,l=this._conditionalFormattingRuleModel.getSubunitRules(r,a),d={startRow:Math.min(e.startRow,t.startRow),endRow:Number.MAX_SAFE_INTEGER,startColumn:0,endColumn:Number.MAX_SAFE_INTEGER};l&&l.filter(c=>c.ranges.some(h=>u.Rectangle.intersects(h,d))).forEach(c=>{this._conditionalFormattingViewModelV2.markRuleDirty(r,a,c.cfId)});break}case p.MoveColsMutation.id:{const{sourceRange:e,targetRange:t,unitId:r,subUnitId:a}=s.params,l=this._conditionalFormattingRuleModel.getSubunitRules(r,a),d={startRow:0,endRow:Number.MAX_SAFE_INTEGER,startColumn:Math.min(e.startColumn,t.startColumn),endColumn:Number.MAX_SAFE_INTEGER};l&&l.filter(c=>c.ranges.some(h=>u.Rectangle.intersects(h,d))).forEach(c=>{this._conditionalFormattingViewModelV2.markRuleDirty(r,a,c.cfId)});break}case p.MoveRangeMutation.id:{const{unitId:e,to:t,from:r}=s.params,a=l=>{const d=[];new u.ObjectMatrix(l.value).forValue((c,h)=>{d.push([c,h])}),n(e,l.subUnitId,d).forEach(c=>{this._conditionalFormattingViewModelV2.markRuleDirty(e,l.subUnitId,c.cfId)})};a(t),a(r);break}case p.ReorderRangeMutation.id:{const{range:e,unitId:t,subUnitId:r}=s.params,a=this._conditionalFormattingRuleModel.getSubunitRules(t,r);a&&a.filter(d=>d.ranges.some(o=>u.Rectangle.intersects(o,e))).forEach(d=>{this._conditionalFormattingViewModelV2.markRuleDirty(t,r,d.cfId)});break}}}))}};exports.ConditionalFormattingService=R0([Z(0,u.Inject(x)),Z(1,u.Inject(u.Injector)),Z(2,u.Inject(u.IUniverInstanceService)),Z(3,u.Inject(u.IResourceManagerService)),Z(4,u.Inject(p.SheetInterceptorService)),Z(5,u.Inject(u.ICommandService))],exports.ConditionalFormattingService);const S0=i=>i.getCurrentUnitForType(u.UniverInstanceType.UNIVER_SHEET).getUnitId(),b0=i=>{var s;return(s=i.getCurrentUnitForType(u.UniverInstanceType.UNIVER_SHEET).getActiveSheet())==null?void 0:s.getSheetId()};var L0=Object.getOwnPropertyDescriptor,T0=(i,s,n,e)=>{for(var t=e>1?void 0:e?L0(s,n):s,r=i.length-1,a;r>=0;r--)(a=i[r])&&(t=a(t)||t);return t},D2=(i,s)=>(n,e)=>s(n,e,i),a2;exports.UniverSheetsConditionalFormattingPlugin=(a2=class extends u.Plugin{constructor(s=A2,n,e,t){super(),this._config=s,this._injector=n,this._commandService=e,this._configService=t;const{...r}=u.merge({},A2,this._config);this._configService.setConfig(M0,r),[[exports.ConditionalFormattingService],[exports.ConditionalFormattingFormulaService],[x],[exports.ConditionalFormattingViewModel]].forEach(a=>{this._injector.add(a)}),[I2,R2,S2,b2,L2,T2,Y,$,K,X,J].forEach(a=>{this._commandService.registerCommand(a)})}onStarting(){this._injector.get(exports.ConditionalFormattingService),u.touchDependencies(this._injector,[[exports.ConditionalFormattingService],[exports.ConditionalFormattingViewModel]])}},F(a2,"pluginName",F2),F(a2,"type",u.UniverInstanceType.UNIVER_SHEET),a2);exports.UniverSheetsConditionalFormattingPlugin=T0([D2(1,u.Inject(u.Injector)),D2(2,u.Inject(u.ICommandService)),D2(3,u.IConfigService)],exports.UniverSheetsConditionalFormattingPlugin);const W2="sheet-conditional-rule-icon",B0=35,q2=15,Z2=2,k0=i=>{const{startRow:s,endRow:n,startColumn:e,endColumn:t}=i;return`${s}-${n}-${e}-${t}`};class G2 extends H.SheetExtension{constructor(){super();F(this,"_paddingRightAndLeft",Z2);F(this,"_width",q2);F(this,"_imageMap",new Map);F(this,"uKey",W2);F(this,"Z_INDEX",B0);F(this,"_radius",1);this._init()}draw(n,e,t,r){const{worksheet:a}=t;if(!a)return!1;const l=new Set;n.save(),u.Range.foreach(t.rowColumnSegment,(d,o)=>{if(!a.getRowVisible(d)||!a.getColVisible(o))return;const c=t.getCellWithCoordByIndex(d,o,!1),{isMerged:h,isMergedMainCell:g,mergeInfo:C}=c;let D=a.getCell(d,o);if(h&&(D=a.getCell(C.startRow,C.startColumn)),!(D!=null&&D.iconSet))return;const{iconType:m,iconId:v}=D.iconSet;if(m===P2)return;const E=this._imageMap.get(this._createKey(m,v));if(!E||!this.isRenderDiffRangesByCell(C,r))return;if(h||g){const j=k0(C);if(l.has(j))return;l.add(j)}const{startX:I,endX:A,startY:R,endY:B}=h||g?C:c,d2=A-I,r2=B-R;if(this._width>r2||this._width>d2+this._paddingRightAndLeft*2)return;const h2=(r2-this._width)/2+R;n.drawImage(E,I+this._paddingRightAndLeft,h2,this._width,this._width)}),n.restore()}_init(){for(const n in t2)t2[n].forEach((t,r)=>{const a=this._createKey(n,String(r)),l=new Image;l.onload=()=>{this._imageMap.set(a,l)},l.src=t})}_createKey(n,e){return`${n}_${e}`}}H.SpreadsheetExtensionRegistry.add(G2);function H2(i){if(typeof i!="object"||i===null)return i;const s={};for(const n in i)if(i.hasOwnProperty(n)){const e=H2(i[n]);e!==void 0&&(s[n]=e)}return s}Object.defineProperty(exports,"isRangesEqual",{enumerable:!0,get:()=>u.isRangesEqual});exports.AddCfCommand=I2;exports.AddConditionalRuleMutation=Y;exports.AddConditionalRuleMutationUndoFactory=w2;exports.CFNumberOperator=w;exports.CFRuleType=M;exports.CFSubRuleType=y;exports.CFTextOperator=S;exports.CFTimePeriodOperator=b;exports.CFValueType=_;exports.CONDITIONAL_FORMATTING_VIEWPORT_CACHE_LENGTH=l2;exports.ClearRangeCfCommand=R2;exports.ClearWorksheetCfCommand=S2;exports.ConditionalFormattingFormulaMarkDirty=J;exports.ConditionalFormattingIcon=G2;exports.ConditionalFormattingRuleModel=x;exports.DEFAULT_BG_COLOR=K2;exports.DEFAULT_FONT_COLOR=J2;exports.DEFAULT_PADDING=Z2;exports.DEFAULT_WIDTH=q2;exports.DataBar=N2;exports.DeleteCfCommand=b2;exports.DeleteConditionalRuleMutation=$;exports.DeleteConditionalRuleMutationUndoFactory=n2;exports.EMPTY_ICON_TYPE=P2;exports.FormulaResultStatus=T;exports.IconUKey=W2;exports.MoveCfCommand=L2;exports.MoveConditionalRuleMutation=X;exports.MoveConditionalRuleMutationUndoFactory=M2;exports.SHEET_CONDITIONAL_FORMATTING_PLUGIN=F2;exports.SetCfCommand=T2;exports.SetConditionalRuleMutation=K;exports.anchorUndoFactory=x2;exports.compareWithNumber=G;exports.createCfId=_2;exports.createDefaultRule=z2;exports.createDefaultValue=Q2;exports.createDefaultValueByValueType=e0;exports.dataBarUKey=B2;exports.defaultDataBarNativeColor=m2;exports.defaultDataBarPositiveColor=f2;exports.defaultPlaceholderColor=k2;exports.filterRange=u2;exports.findIndexByAnchor=O;exports.getCacheStyleMatrix=D0;exports.getCellValue=U;exports.getColorScaleFromValue=$2;exports.getMaxInFormulaResult=f0;exports.getOppositeOperator=O2;exports.getValueByType=e2;exports.iconGroup=j2;exports.iconMap=t2;exports.isAnchorEqual=t0;exports.isFloatsEqual=Q;exports.isNullable=L;exports.moveByAnchor=y2;exports.removeUndefinedAttr=H2;exports.serialTimeToTimestamp=V2;exports.setConditionalRuleMutationUndoFactory=p2;exports.toYMD_1900=U2;exports.transformSupportSymmetryAnchor=v2;
