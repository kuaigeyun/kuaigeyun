(function(f,Re){typeof exports=="object"&&typeof module<"u"?Re(exports,require("@wendellhu/redi"),require("rxjs"),require("rxjs/operators"),require("@univerjs/themes")):typeof define=="function"&&define.amd?define(["exports","@wendellhu/redi","rxjs","rxjs/operators","@univerjs/themes"],Re):(f=typeof globalThis<"u"?globalThis:f||self,Re(f.UniverCore={},f["@wendellhu/redi"],f.rxjs,f.rxjs.operators,f.UniverThemes))})(this,(function(f,Re,oe,qr,Jr){"use strict";var AI=Object.defineProperty;var yI=(f,Re,oe)=>Re in f?AI(f,Re,{enumerable:!0,configurable:!0,writable:!0,value:oe}):f[Re]=oe;var E=(f,Re,oe)=>yI(f,typeof Re!="symbol"?Re+"":Re,oe);var wd,bd;function yd(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const Dt=typeof global<"u"?global:typeof self<"u"?self:window;function Td(){const t=new Map;let n=0;typeof Dt.requestIdleCallback!="function"&&(Dt.requestIdleCallback=function(s){const i=Date.now(),o=++n,a=setTimeout(function(){t.delete(o);const u=Math.max(0,50-(Date.now()-i));s({didTimeout:u===0,timeRemaining(){return u}})},1);return t.set(o,a),o}),typeof Dt.cancelIdleCallback!="function"&&(Dt.cancelIdleCallback=function(s){const i=t.get(s);i!==void 0&&(clearTimeout(i),t.delete(s))})}function Nd(){typeof Dt.Array.prototype.findLastIndex!="function"&&(Dt.Array.prototype.findLastIndex=function(t,n){if(this==null)throw new TypeError("Array.prototype.findLastIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");const r=this.length>>>0;for(let s=r-1;s>=0;s--)if(s in this&&t.call(n,this[s],s,this))return s;return-1}),typeof Dt.Array.prototype.findLast!="function"&&(Dt.Array.prototype.findLast=function(t,n){const r=this.findLastIndex(t,n);return r!==-1?this[r]:void 0})}function Md(){typeof Dt.String.prototype.at!="function"&&(Dt.String.prototype.at=function(t){if(this==null)throw new TypeError("String.prototype.at called on null or undefined");const n=this.length;if(t<0&&(t=n+t),!(t<0||t>=n))return this.charAt(t)})}function Ld(){Td(),Nd(),Md()}function nr(e,t){const n=e.indexOf(t);return n>-1?(e.splice(n,1),!0):!1}function Dd(e){const t=new Set,n=[];for(const r of e)t.has(r)||(t.add(r),n.push(r));return n}function Ud(e,t){const n=new Set,r=[];for(const s of e){const i=t(s);n.has(i)||(n.add(i),r.push(s))}return r}function Pd(e,t){for(let n=e.length-1;n>-1;n--){const r=e[n];if(t(r,n))return r}return null}function kd(e,t){if(e.length===0)return e;const n=t%e.length;return e.slice(n).concat(e.slice(0,n))}function Fd(e,t){const n=new Map;return e.forEach(r=>{const s=t(r);let i=n.get(s);n.has(s)||(i=[],n.set(s,i)),i.push(r)}),n}function xd(e){return Array.isArray(e)?e:[e]}function gt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ii,pa;function Bd(){if(pa)return ii;pa=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,o=null,a=null;typeof r!="function"&&(s=r,r=null,a=new this.Promise(function(x,Y){i=x,o=Y})),s=s||{};var l=!1,u=null,c=null,h=null,d=this,m=function(x,Y,O){c&&(clearTimeout(c),c=null),h&&(clearTimeout(h),h=null),x&&(d.queues[t]&&d.queues[t].length===0&&delete d.queues[t],d.domainReentrant&&delete d.domains[t]),l||(a?Y?o(Y):i(O):typeof r=="function"&&r(Y,O),l=!0),x&&d.queues[t]&&d.queues[t].length>0&&d.queues[t].shift()()},_=function(x){if(l)return m(x);u&&(clearTimeout(u),u=null),d.domainReentrant&&x&&(d.domains[t]=process.domain);var Y=s.maxExecutionTime||d.maxExecutionTime;if(Y&&(h=setTimeout(function(){d.queues[t]&&m(x,new Error("Maximum execution time is exceeded "+t))},Y)),n.length===1){var O=!1;try{n(function(R,b){O||(O=!0,m(x,R,b))})}catch(R){O||(O=!0,m(x,R))}}else d._promiseTry(function(){return n()}).then(function(R){m(x,void 0,R)},function(R){m(x,R)})};d.domainReentrant&&process.domain&&(_=process.domain.bind(_));var p=s.maxPending||d.maxPending;if(!d.queues[t])d.queues[t]=[],_(!0);else if(d.domainReentrant&&process.domain&&process.domain===d.domains[t])_(!1);else if(d.queues[t].length>=p)m(!1,new Error("Too many pending tasks in queue "+t));else{var I=function(){_(!0)};s.skipQueue?d.queues[t].unshift(I):d.queues[t].push(I);var A=s.timeout||d.timeout;A&&(u=setTimeout(function(){u=null,m(!1,new Error("async-lock timed out in queue "+t))},A))}var B=s.maxOccupationTime||d.maxOccupationTime;if(B&&(c=setTimeout(function(){d.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},B)),a)return a},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,o=function(l,u){return function(c){i.acquire(l,u,c,s)}},a=t.reduceRight(function(l,u){return o(u,l)},n);if(typeof r=="function")a(r);else return new this.Promise(function(l,u){a.length===1?a(function(c,h){c?u(c):l(h)}):l(a())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},ii=e,ii}var oi,Ea;function Hd(){return Ea||(Ea=1,oi=Bd()),oi}var $d=Hd();const jd=gt($d),Wd=new Set(["true","false"]);function Yd(e){return Wd.has(e.toLowerCase())}const rr="__INTERNAL_EDITOR__",ai=`${rr}DOCS_NORMAL`,li=`${rr}DOCS_FORMULA_BAR`,Ca=`${rr}ZEN_EDITOR`,Ra=`\r
`,Ia="isRowStylePrecedeColumnStyle",Sa=Symbol("AUTO_HEIGHT_FOR_MERGED_CELLS");function Gd(e){return`${rr}${e}`}function Oa(e){return e.startsWith(rr)}function Vd(e,t){t.forEach(n=>e.add(n))}function va(e,t){t.forEach(([n])=>{e.has(n)&&e.get(n)})}function wa(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const s=Object.prototype.hasOwnProperty.bind(t);for(let i=0;i<n.length;i++){const o=n[i];if(!s(o))return!1;const a=e[o],l=t[o];if(a!==l)return!1}return!0}class Zr extends Error{constructor(t){super(t),this.name="CustomCommandExecutionError"}}class zd extends Zr{constructor(){super("Canceled by facade"),this.name="CanceledError"}}function Kd(e,t=16){let n=0,r=null;return function(...i){const o=Date.now();o-n<t?(r&&clearTimeout(r),r=setTimeout(()=>{n=o,e.apply(this,i)},t)):(n=o,e.apply(this,i))}}var An=(e=>(e[e.Style=1]="Style",e[e.Value=2]="Value",e))(An||{});function Xd(e){return`sheet_interceptor_${e}`}const ba=e=>function(t,n){let r=-1,s=t;for(let i=0;i<=e.length;i++){if(i<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=i,i===e.length)return s;const o=e[i];let a=!1;if(s=o.handler(s,n,l=>(a=!0,l)),!a)break}return s};class qd{constructor(t){E(this,"_interceptorsByName",new Map);E(this,"_interceptorPoints");this._interceptorPoints=t}fetchThroughInterceptors(t,n){const r=t;let s=this._interceptorsByName.get(r);return n&&(s=s.filter(n)),ba(s||[])}intercept(t,n){const r=t;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const s=this._interceptorsByName.get(r);return s.push(n),this._interceptorsByName.set(r,s.sort((i,o)=>{var a,l;return((a=o.priority)!=null?a:0)-((l=i.priority)!=null?l:0)})),()=>nr(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}}function Jd(e){return`sheet_async_interceptor_${e}`}const Zd=e=>async function(t,n){let r=-1,s=t;for(let i=0;i<=e.length;i++){if(i<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=i,i===e.length)return s;const o=e[i];let a=!1;if(s=await o.handler(s,n,async l=>(a=!0,l)),!a)break}return s};class Qd{constructor(t){E(this,"_asyncInterceptorsByName",new Map);E(this,"_asyncInterceptorPoints");this._asyncInterceptorPoints=t}fetchThroughAsyncInterceptors(t,n){const r=t;let s=this._asyncInterceptorsByName.get(r);return n&&(s=s.filter(n)),Zd(s||[])}async interceptAsync(t,n){const r=t;this._asyncInterceptorsByName.has(r)||this._asyncInterceptorsByName.set(r,[]);const s=this._asyncInterceptorsByName.get(r);return s.push(n),this._asyncInterceptorsByName.set(r,s.sort((i,o)=>{var a,l;return((a=o.priority)!=null?a:0)-((l=i.priority)!=null?l:0)})),()=>nr(this._asyncInterceptorsByName.get(r),n)}getInterceptPoints(){return this._asyncInterceptorPoints}dispose(){this._asyncInterceptorsByName.clear()}}function Aa(e){return e.map(t=>t/255)}function ya(e){return e.map(t=>Math.round(t*255))}function ef([e,t,n]){const r=Math.max(e,t,n),s=Math.min(e,t,n),i=(r+s)/2;let o=0,a=0;if(r!==s){const l=r-s;switch(a=i>.5?l/(2-r-s):l/(r+s),r){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4;break}o/=6}return[o,a,i]}function Qr(e,t,n){const r=[e,t,n].map(s=>s<=.03928?s/12.92:((s+.055)/1.055)**2.4);return .2126*r[0]+.7152*r[1]+.0722*r[2]}function Ta(e,t){return(Math.max(e,t)+.05)/(Math.min(e,t)+.05)}function tf(e,t,n){let r,s,i;if(t===0)r=s=i=n;else{const o=(u,c,h)=>{let d=h;return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?u+(c-u)*6*d:d<.5?c:d<.6666666666666666?u+(c-u)*(.6666666666666666-d)*6:u},a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;r=o(l,a,e+1/3),s=o(l,a,e),i=o(l,a,e-1/3)}return[r,s,i]}const ui={r:1,g:1,b:1},ci={r:0,g:0,b:0},nf=Qr(ui.r,ui.g,ui.b),rf=Qr(ci.r,ci.g,ci.b);function sf(e){const t=Qr(e[0],e[1],e[2]),n=Ta(nf,t),r=ef(e);let s=1-r[2],i,o,a;do i=tf(r[0],r[1],s),o=Qr(i[0],i[1],i[2]),a=Ta(o,rf),s+=.01;while(s<=1&&s>=0&&Math.abs(a-n)<.01);return i}function of(e){return ya(sf(Aa(e)))}const _t=[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0]];function af(e){const t=e[0],n=e[1],r=e[2];let s=[_t[0][0]*t+_t[0][1]*n+_t[0][2]*r+_t[0][4],_t[1][0]*t+_t[1][1]*n+_t[1][2]*r+_t[1][4],_t[2][0]*t+_t[2][1]*n+_t[2][2]*r+_t[2][4]];return s=s.map(i=>i>1?1:i<0?0:i),s}function lf(e){return ya(af(Aa(e)))}var Na=typeof global=="object"&&global&&global.Object===Object&&global,uf=typeof self=="object"&&self&&self.Object===Object&&self,hn=Na||uf||Function("return this")(),yn=hn.Symbol,Ma=Object.prototype,cf=Ma.hasOwnProperty,hf=Ma.toString,sr=yn?yn.toStringTag:void 0;function df(e){var t=cf.call(e,sr),n=e[sr];try{e[sr]=void 0;var r=!0}catch{}var s=hf.call(e);return r&&(t?e[sr]=n:delete e[sr]),s}var ff=Object.prototype,mf=ff.toString;function gf(e){return mf.call(e)}var _f="[object Null]",pf="[object Undefined]",La=yn?yn.toStringTag:void 0;function ir(e){return e==null?e===void 0?pf:_f:La&&La in Object(e)?df(e):gf(e)}function Tn(e){return e!=null&&typeof e=="object"}var Ef="[object Symbol]";function es(e){return typeof e=="symbol"||Tn(e)&&ir(e)==Ef}function Cf(e,t){for(var n=-1,r=e==null?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}var Nn=Array.isArray,Da=yn?yn.prototype:void 0,Ua=Da?Da.toString:void 0;function Pa(e){if(typeof e=="string")return e;if(Nn(e))return Cf(e,Pa)+"";if(es(e))return Ua?Ua.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Rf=/\s/;function If(e){for(var t=e.length;t--&&Rf.test(e.charAt(t)););return t}var Sf=/^\s+/;function Of(e){return e&&e.slice(0,If(e)+1).replace(Sf,"")}function pt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ka=NaN,vf=/^[-+]0x[0-9a-f]+$/i,wf=/^0b[01]+$/i,bf=/^0o[0-7]+$/i,Af=parseInt;function Fa(e){if(typeof e=="number")return e;if(es(e))return ka;if(pt(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=pt(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Of(e);var n=wf.test(e);return n||bf.test(e)?Af(e.slice(2),n?2:8):vf.test(e)?ka:+e}function xa(e){return e}var yf="[object AsyncFunction]",Tf="[object Function]",Nf="[object GeneratorFunction]",Mf="[object Proxy]";function hi(e){if(!pt(e))return!1;var t=ir(e);return t==Tf||t==Nf||t==yf||t==Mf}var di=hn["__core-js_shared__"],Ba=(function(){var e=/[^.]+$/.exec(di&&di.keys&&di.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function Lf(e){return!!Ba&&Ba in e}var Df=Function.prototype,Uf=Df.toString;function Pf(e){if(e!=null){try{return Uf.call(e)}catch{}try{return e+""}catch{}}return""}var kf=/[\\^$.*+?()[\]{}|]/g,Ff=/^\[object .+?Constructor\]$/,xf=Function.prototype,Bf=Object.prototype,Hf=xf.toString,$f=Bf.hasOwnProperty,jf=RegExp("^"+Hf.call($f).replace(kf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wf(e){if(!pt(e)||Lf(e))return!1;var t=hi(e)?jf:Ff;return t.test(Pf(e))}function Yf(e,t){return e==null?void 0:e[t]}function fi(e,t){var n=Yf(e,t);return Wf(n)?n:void 0}var Ha=Object.create,Gf=(function(){function e(){}return function(t){if(!pt(t))return{};if(Ha)return Ha(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}})();function Vf(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function zf(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Kf=800,Xf=16,qf=Date.now;function Jf(e){var t=0,n=0;return function(){var r=qf(),s=Xf-(r-n);if(n=r,s>0){if(++t>=Kf)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Zf(e){return function(){return e}}var ts=(function(){try{var e=fi(Object,"defineProperty");return e({},"",{}),e}catch{}})(),Qf=ts?function(e,t){return ts(e,"toString",{configurable:!0,enumerable:!1,value:Zf(t),writable:!0})}:xa,em=Jf(Qf),tm=9007199254740991,nm=/^(?:0|[1-9]\d*)$/;function mi(e,t){var n=typeof e;return t=t==null?tm:t,!!t&&(n=="number"||n!="symbol"&&nm.test(e))&&e>-1&&e%1==0&&e<t}function gi(e,t,n){t=="__proto__"&&ts?ts(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ns(e,t){return e===t||e!==e&&t!==t}var rm=Object.prototype,sm=rm.hasOwnProperty;function $a(e,t,n){var r=e[t];(!(sm.call(e,t)&&ns(r,n))||n===void 0&&!(t in e))&&gi(e,t,n)}function im(e,t,n,r){var s=!n;n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],l=void 0;l===void 0&&(l=e[a]),s?gi(n,a,l):$a(n,a,l)}return n}var ja=Math.max;function om(e,t,n){return t=ja(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=ja(r.length-t,0),o=Array(i);++s<i;)o[s]=r[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=r[s];return a[t]=n(o),Vf(e,this,a)}}function am(e,t){return em(om(e,t,xa),e+"")}var lm=9007199254740991;function Wa(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=lm}function _i(e){return e!=null&&Wa(e.length)&&!hi(e)}function um(e,t,n){if(!pt(n))return!1;var r=typeof t;return(r=="number"?_i(n)&&mi(t,n.length):r=="string"&&t in n)?ns(n[t],e):!1}function Ya(e){return am(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,o=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,o&&um(n[0],n[1],o)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var a=n[r];a&&e(t,a,r,i)}return t})}var cm=Object.prototype;function Ga(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||cm;return e===n}function hm(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var dm="[object Arguments]";function Va(e){return Tn(e)&&ir(e)==dm}var za=Object.prototype,fm=za.hasOwnProperty,mm=za.propertyIsEnumerable,pi=Va((function(){return arguments})())?Va:function(e){return Tn(e)&&fm.call(e,"callee")&&!mm.call(e,"callee")};function gm(){return!1}var Ka=typeof f=="object"&&f&&!f.nodeType&&f,Xa=Ka&&typeof module=="object"&&module&&!module.nodeType&&module,_m=Xa&&Xa.exports===Ka,qa=_m?hn.Buffer:void 0,pm=qa?qa.isBuffer:void 0,Ja=pm||gm,Em="[object Arguments]",Cm="[object Array]",Rm="[object Boolean]",Im="[object Date]",Sm="[object Error]",Om="[object Function]",vm="[object Map]",wm="[object Number]",bm="[object Object]",Am="[object RegExp]",ym="[object Set]",Tm="[object String]",Nm="[object WeakMap]",Mm="[object ArrayBuffer]",Lm="[object DataView]",Dm="[object Float32Array]",Um="[object Float64Array]",Pm="[object Int8Array]",km="[object Int16Array]",Fm="[object Int32Array]",xm="[object Uint8Array]",Bm="[object Uint8ClampedArray]",Hm="[object Uint16Array]",$m="[object Uint32Array]",xe={};xe[Dm]=xe[Um]=xe[Pm]=xe[km]=xe[Fm]=xe[xm]=xe[Bm]=xe[Hm]=xe[$m]=!0,xe[Em]=xe[Cm]=xe[Mm]=xe[Rm]=xe[Lm]=xe[Im]=xe[Sm]=xe[Om]=xe[vm]=xe[wm]=xe[bm]=xe[Am]=xe[ym]=xe[Tm]=xe[Nm]=!1;function jm(e){return Tn(e)&&Wa(e.length)&&!!xe[ir(e)]}function Wm(e){return function(t){return e(t)}}var Za=typeof f=="object"&&f&&!f.nodeType&&f,or=Za&&typeof module=="object"&&module&&!module.nodeType&&module,Ym=or&&or.exports===Za,Ei=Ym&&Na.process,Qa=(function(){try{var e=or&&or.require&&or.require("util").types;return e||Ei&&Ei.binding&&Ei.binding("util")}catch{}})(),el=Qa&&Qa.isTypedArray,tl=el?Wm(el):jm;function Gm(e,t){var n=Nn(e),r=!n&&pi(e),s=!n&&!r&&Ja(e),i=!n&&!r&&!s&&tl(e),o=n||r||s||i,a=o?hm(e.length,String):[],l=a.length;for(var u in e)o&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||mi(u,l))||a.push(u);return a}function Vm(e,t){return function(n){return e(t(n))}}function zm(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Km=Object.prototype,Xm=Km.hasOwnProperty;function qm(e){if(!pt(e))return zm(e);var t=Ga(e),n=[];for(var r in e)r=="constructor"&&(t||!Xm.call(e,r))||n.push(r);return n}function nl(e){return _i(e)?Gm(e):qm(e)}var Jm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Zm=/^\w*$/;function Qm(e,t){if(Nn(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||es(e)?!0:Zm.test(e)||!Jm.test(e)||t!=null&&e in Object(t)}var ar=fi(Object,"create");function eg(){this.__data__=ar?ar(null):{},this.size=0}function tg(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var ng="__lodash_hash_undefined__",rg=Object.prototype,sg=rg.hasOwnProperty;function ig(e){var t=this.__data__;if(ar){var n=t[e];return n===ng?void 0:n}return sg.call(t,e)?t[e]:void 0}var og=Object.prototype,ag=og.hasOwnProperty;function lg(e){var t=this.__data__;return ar?t[e]!==void 0:ag.call(t,e)}var ug="__lodash_hash_undefined__";function cg(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ar&&t===void 0?ug:t,this}function dn(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}dn.prototype.clear=eg,dn.prototype.delete=tg,dn.prototype.get=ig,dn.prototype.has=lg,dn.prototype.set=cg;function hg(){this.__data__=[],this.size=0}function rs(e,t){for(var n=e.length;n--;)if(ns(e[n][0],t))return n;return-1}var dg=Array.prototype,fg=dg.splice;function mg(e){var t=this.__data__,n=rs(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():fg.call(t,n,1),--this.size,!0}function gg(e){var t=this.__data__,n=rs(t,e);return n<0?void 0:t[n][1]}function _g(e){return rs(this.__data__,e)>-1}function pg(e,t){var n=this.__data__,r=rs(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function $t(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}$t.prototype.clear=hg,$t.prototype.delete=mg,$t.prototype.get=gg,$t.prototype.has=_g,$t.prototype.set=pg;var rl=fi(hn,"Map");function Eg(){this.size=0,this.__data__={hash:new dn,map:new(rl||$t),string:new dn}}function Cg(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ss(e,t){var n=e.__data__;return Cg(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Rg(e){var t=ss(this,e).delete(e);return this.size-=t?1:0,t}function Ig(e){return ss(this,e).get(e)}function Sg(e){return ss(this,e).has(e)}function Og(e,t){var n=ss(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function qt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}qt.prototype.clear=Eg,qt.prototype.delete=Rg,qt.prototype.get=Ig,qt.prototype.has=Sg,qt.prototype.set=Og;var vg="Expected a function";function Ci(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(vg);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var o=e.apply(this,r);return n.cache=i.set(s,o)||i,o};return n.cache=new(Ci.Cache||qt),n}Ci.Cache=qt;var wg=500;function bg(e){var t=Ci(e,function(r){return n.size===wg&&n.clear(),r}),n=t.cache;return t}var Ag=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yg=/\\(\\)?/g,Tg=bg(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ag,function(n,r,s,i){t.push(s?i.replace(yg,"$1"):r||n)}),t});function Ng(e){return e==null?"":Pa(e)}function sl(e,t){return Nn(e)?e:Qm(e,t)?[e]:Tg(Ng(e))}function il(e){if(typeof e=="string"||es(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Mg(e,t){t=sl(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[il(t[n++])];return n&&n==r?e:void 0}function ol(e,t,n){var r=e==null?void 0:Mg(e,t);return r===void 0?n:r}var al=Vm(Object.getPrototypeOf,Object),Lg="[object Object]",Dg=Function.prototype,Ug=Object.prototype,ll=Dg.toString,Pg=Ug.hasOwnProperty,kg=ll.call(Object);function Fg(e){if(!Tn(e)||ir(e)!=Lg)return!1;var t=al(e);if(t===null)return!0;var n=Pg.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&ll.call(n)==kg}function xg(){this.__data__=new $t,this.size=0}function Bg(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Hg(e){return this.__data__.get(e)}function $g(e){return this.__data__.has(e)}var jg=200;function Wg(e,t){var n=this.__data__;if(n instanceof $t){var r=n.__data__;if(!rl||r.length<jg-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new qt(r)}return n.set(e,t),this.size=n.size,this}function Mn(e){var t=this.__data__=new $t(e);this.size=t.size}Mn.prototype.clear=xg,Mn.prototype.delete=Bg,Mn.prototype.get=Hg,Mn.prototype.has=$g,Mn.prototype.set=Wg;var ul=typeof f=="object"&&f&&!f.nodeType&&f,cl=ul&&typeof module=="object"&&module&&!module.nodeType&&module,Yg=cl&&cl.exports===ul,hl=Yg?hn.Buffer:void 0;hl&&hl.allocUnsafe;function Gg(e,t){return e.slice()}var dl=hn.Uint8Array;function Vg(e){var t=new e.constructor(e.byteLength);return new dl(t).set(new dl(e)),t}function zg(e,t){var n=Vg(e.buffer);return new e.constructor(n,e.byteOffset,e.length)}function Kg(e){return typeof e.constructor=="function"&&!Ga(e)?Gf(al(e)):{}}function Xg(e){return function(t,n,r){for(var s=-1,i=Object(t),o=r(t),a=o.length;a--;){var l=o[++s];if(n(i[l],l,i)===!1)break}return t}}var qg=Xg(),Ri=function(){return hn.Date.now()},Jg="Expected a function",Zg=Math.max,Qg=Math.min;function e_(e,t,n){var r,s,i,o,a,l,u=0,c=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Jg);t=Fa(t)||0,pt(n)&&(c=!!n.leading,h="maxWait"in n,i=h?Zg(Fa(n.maxWait)||0,t):i,d="trailing"in n?!!n.trailing:d);function m(R){var b=r,T=s;return r=s=void 0,u=R,o=e.apply(T,b),o}function _(R){return u=R,a=setTimeout(A,t),c?m(R):o}function p(R){var b=R-l,T=R-u,H=t-b;return h?Qg(H,i-T):H}function I(R){var b=R-l,T=R-u;return l===void 0||b>=t||b<0||h&&T>=i}function A(){var R=Ri();if(I(R))return B(R);a=setTimeout(A,p(R))}function B(R){return a=void 0,d&&r?m(R):(r=s=void 0,o)}function x(){a!==void 0&&clearTimeout(a),u=0,r=l=s=a=void 0}function Y(){return a===void 0?o:B(Ri())}function O(){var R=Ri(),b=I(R);if(r=arguments,s=this,l=R,b){if(a===void 0)return _(l);if(h)return clearTimeout(a),a=setTimeout(A,t),m(l)}return a===void 0&&(a=setTimeout(A,t)),o}return O.cancel=x,O.flush=Y,O}function Ii(e,t,n){(n!==void 0&&!ns(e[t],n)||n===void 0&&!(t in e))&&gi(e,t,n)}function t_(e){return Tn(e)&&_i(e)}function Si(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function n_(e){return im(e,nl(e))}function r_(e,t,n,r,s,i,o){var a=Si(e,n),l=Si(t,n),u=o.get(l);if(u){Ii(e,n,u);return}var c=i?i(a,l,n+"",e,t,o):void 0,h=c===void 0;if(h){var d=Nn(l),m=!d&&Ja(l),_=!d&&!m&&tl(l);c=l,d||m||_?Nn(a)?c=a:t_(a)?c=zf(a):m?(h=!1,c=Gg(l)):_?(h=!1,c=zg(l)):c=[]:Fg(l)||pi(l)?(c=a,pi(a)?c=n_(a):(!pt(a)||hi(a))&&(c=Kg(l))):h=!1}h&&(o.set(l,c),s(c,l,r,i,o),o.delete(l)),Ii(e,n,c)}function Oi(e,t,n,r,s){e!==t&&qg(t,function(i,o){if(s||(s=new Mn),pt(i))r_(e,t,o,n,Oi,r,s);else{var a=r?r(Si(e,o),i,o+"",e,t,s):void 0;a===void 0&&(a=i),Ii(e,o,a)}},nl)}var s_=Ya(function(e,t,n,r){Oi(e,t,n,r)}),is=Ya(function(e,t,n){Oi(e,t,n)});function i_(e,t,n,r){if(!pt(e))return e;t=sl(t,e);for(var s=-1,i=t.length,o=i-1,a=e;a!=null&&++s<i;){var l=il(t[s]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(s!=o){var c=a[l];u=void 0,u===void 0&&(u=pt(c)?c:mi(t[s+1])?[]:{})}$a(a,l,u),a=a[l]}return e}function o_(e,t,n){return e==null?e:i_(e,t,n)}class fn{constructor(){E(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(t){this.cursor+=t}moveCursorTo(t){this.cursor=t}}function a_(e,t){for(const n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function fl(e){return/^-?\d+(\.\d+)?$/.test(e)}function l_(e){return fl(e)?Number(e)<=Number.MAX_SAFE_INTEGER:!1}function u_(e){return Number(e)>Number.MAX_SAFE_INTEGER||e.length>=18}class vi{constructor(){E(this,"_data",[])}static create(){return new vi}add(t){this._data.indexOf(t)>-1||this._data.push(t)}delete(t){const n=this._data.indexOf(t);this._data.splice(n,1)}getData(){return this._data}}class wi{constructor(){E(this,"_data",new Map)}static create(){return new wi}add(t,n){this._data.has(t)||this._data.set(t,n)}delete(t){this._data.delete(t)}getData(){return this._data}}function c_(e){const t=new MessageChannel;let n=!1;const r=()=>{n||e()};return t.port1.onmessage=r,t.port2.postMessage(null),()=>{n=!0,t.port1.onmessage=null,t.port1.close(),t.port2.close()}}async function ml(e){for(const[t,n]of e.entries())try{if(!await n())return{index:t,result:!1}}catch(r){return{index:t,result:!1,error:r}}return{result:!0,index:-1}}function gl(e){for(const[t,n]of e.entries())try{if(!n())return{index:t,result:!1}}catch(r){return{index:t,result:!1,error:r}}return{result:!0,index:-1}}function h_(e,t){return t.forEach(n=>e.add(n)),e}function d_(e){return e instanceof oe.Subscription||e instanceof oe.Subject||e&&"closed"in e&&typeof e.unsubscribe<"u"}function He(e){let t=!1;return e?d_(e)?{dispose:()=>e.unsubscribe()}:typeof e=="function"?{dispose:()=>{t||(t=!0,e())}}:e:He(()=>{})}function f_(e){return He(()=>{e.unsubscribe()})}class os{constructor(){E(this,"_disposables",new Set)}add(t){const n=He(t);return this._disposables.add(n),{dispose:(r=!1)=>{r||n.dispose(),this._disposables.delete(n)}}}dispose(){this._disposables.forEach(t=>{t.dispose()}),this._disposables.clear()}}class ze{constructor(){E(this,"_disposed",!1);E(this,"_collection",new os)}disposeWithMe(t){return this._collection.add(t)}ensureNotDisposed(){if(this._disposed)throw new Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}}class m_ extends ze{constructor(){super(...arguments);E(this,"dispose$",new oe.Subject)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}}class g_ extends ze{constructor(n){super();E(this,"_ref",0);this._rootDisposable=n}inc(){if(this._disposed)throw new Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,this._ref===0&&(this._rootDisposable.dispose(),this.dispose())}}var ve=(e=>(e[e.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",e[e.UNIVER_DOC=1]="UNIVER_DOC",e[e.UNIVER_SHEET=2]="UNIVER_SHEET",e[e.UNIVER_SLIDE=3]="UNIVER_SLIDE",e[e.UNIVER_PROJECT=4]="UNIVER_PROJECT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(ve||{}),Ut=(e=>(e[e.Reader=0]="Reader",e[e.Editor=1]="Editor",e[e.Owner=2]="Owner",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Ut||{}),bi=(e=>(e[e.SomeCollaborator=0]="SomeCollaborator",e[e.AllCollaborator=1]="AllCollaborator",e[e.OneSelf=2]="OneSelf",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(bi||{});class as extends ze{}const __="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let p_=e=>crypto.getRandomValues(new Uint8Array(e)),E_=(e,t,n)=>{let r=(2<<Math.log2(e.length-1))-1,s=-~(1.6*r*t/e.length);return(i=t)=>{let o="";for(;;){let a=n(s),l=s|0;for(;l--;)if(o+=e[a[l]&r]||"",o.length>=i)return o}}},C_=(e,t=21)=>E_(e,t|0,p_),R_=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=__[n[e]&63];return t};const _l=new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),I_=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function S_(e){if(!Number.isNaN(+e))return!1;if(e.startsWith("http://localhost:3002")||e.startsWith("localhost:3002"))return!0;if(I_.test(e)){if(pl(e))return!0;try{const r=new URL(El(e)).hostname.split(".").pop();if(r&&_l.has(r))return!0}catch{return!1}}return!1}function pl(e){return/^[a-zA-Z]+:\/\//.test(e)}function O_(e){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)}function El(e){return pl(e)?e:O_(e)?`mailto://${e}`:`https://${e}`}const Jt=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Ai(e,t){const n=Z.getValueType(e),r=Z.getValueType(t);return n!==r?!1:Z.isArray(e)?v_(e,t):Z.isObject(e)?w_(e,t):Z.isDate(e)?e.getTime()===t.getTime():Z.isRegExp(e)?e.toString()===t.toString():e===t}function v_(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++){const s=e[n],i=t[n];if(!Ai(s,i))return!1}return!0}function w_(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n){if(!r.includes(s))return!1;const i=e[s],o=t[s];if(!Ai(i,o))return!1}return!0}class Z{static deleteNull(t){for(const n in t)(t[n]===null||t[n]===void 0)&&delete t[n];return t}static stringAt(t){let n="",r=t;for(;r>=Jt.length;)r/=Jt.length,r-=1,n+=Jt[r%Jt.length];const s=t%Jt.length;return n+=Jt[s],n}static indexAt(t){let n=0;for(let r=0;r<t.length-1;r+=1){const s=t.charCodeAt(r)-65,i=t.length-1-r;n+=Jt.length**i+Jt.length*s}return n+=t.charCodeAt(t.length-1)-65,n}static deleteBlank(t){return Z.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){const t=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(t.indexOf("Windows NT 5.0")>-1||t.indexOf("Windows 2000")>-1)return"Windows 2000";if(t.indexOf("Windows NT 5.1")>-1||t.indexOf("Windows XP")>-1)return"Windows XP";if(t.indexOf("Windows NT 5.2")>-1||t.indexOf("Windows 2003")>-1)return"Windows 2003";if(t.indexOf("Windows NT 6.0")>-1||t.indexOf("Windows Vista")>-1)return"Windows Vista";if(t.indexOf("Windows NT 6.1")>-1||t.indexOf("Windows 7")>-1)return"Windows 7";if(t.indexOf("Windows NT 10")>-1||t.indexOf("Windows 10")>-1)return"Windows 10";if(t.indexOf("Windows NT 11")>-1||t.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const t=navigator.userAgent,n=t.indexOf("Opera")>-1,r=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!n,s=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,i=t.indexOf("Edge")>-1,o=t.indexOf("Firefox")>-1,a=t.indexOf("Safari")>-1&&t.indexOf("Chrome")===-1,l=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(t);const c=Number.parseFloat(RegExp.$1);return c===7?"IE7":c===8?"IE8":c===9?"IE9":c===10?"IE10":"0"}return o?"FF":n?"Opera":a?"Safari":l?"Chrome":i?"Edge":s?"IE11":"Unknown browser"}static getClassName(t){return t.constructor.name}static deepMerge(t,...n){n.forEach(o=>o&&i(o));function r(o,a){o.forEach((l,u)=>{var c,h;if(Z.isArray(l)){const d=(c=a[u])!=null?c:[];a[u]=d,r(l,d);return}if(Z.isObject(l)){const d=(h=a[u])!=null?h:{};a[u]=d,s(l,d);return}a[u]=l})}function s(o,a){Object.keys(o).forEach(l=>{var c,h;const u=o[l];if(Z.isObject(u)){const d=(c=a[l])!=null?c:{};a[l]=d,s(u,d);return}if(Z.isArray(u)){const d=(h=a[l])!=null?h:[];a[l]=d,r(u,d);return}a[l]=u})}function i(o){Object.keys(o).forEach(a=>{var u,c;const l=o[a];if(Z.isArray(l)){const h=(u=t[a])!=null?u:[];t[a]=h,r(l,h);return}if(Z.isObject(l)){const h=(c=t[a])!=null?c:{};t[a]=h,s(l,h);return}t[a]=l})}return t}static numberFixed(t,n){return Number(Number(t).toFixed(n))}static diffValue(t,n){return Ai(t,n)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){const n=[];return t.forEach((r,s)=>{n[s]=Z.deepClone(r)}),n}if(this.isObject(t)){const n={};return Object.keys(t).forEach(r=>{const s=t[r];n[r]=Z.deepClone(s)}),Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}return t}static getLanguage(){const t="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||t}static getValueType(t){return Object.prototype.toString.apply(t)}static isDefine(t){return t!=null}static isBlank(t){return this.isDefine(t)?this.isString(t)?t.trim()==="":!1:!0}static isPlainObject(t){return this.isDefine(t)?Object.getPrototypeOf(t)===Object.getPrototypeOf({}):!1}static isDate(t){return this.getValueType(t)==="[object Date]"}static isRegExp(t){return this.getValueType(t)==="[object RegExp]"}static isArray(t){return this.getValueType(t)==="[object Array]"}static isString(t){return this.getValueType(t)==="[object String]"}static isNumber(t){return this.getValueType(t)==="[object Number]"}static isStringNumber(t){return!isNaN(Number.parseFloat(t))&&isFinite(t)}static isObject(t){return this.getValueType(t)==="[object Object]"}static isEmptyObject(t){for(const n in t)return!1;return!0}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(t){return S_(t)}static normalizeUrl(t){return El(t)}static topLevelDomainCombiningString(){return[..._l].join("|")}static removeNull(t){return this.isObject(t)&&Object.keys(t).forEach(n=>{const r=t[n];r==null?delete t[n]:Z.removeNull(r)}),t}static fillTwoDimensionalArray(t,n,r){return new Array(t).fill(r).map(s=>new Array(n).fill(r))}static numToWord(t){let n="";for(;t>0;){let r=t%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,t=(t-r)/26}return n.toLocaleUpperCase()}static ABCatNum(t){if(t==null||t.length===0)return Number.NaN;const n=t.toLowerCase().split(""),r=n.length;let s=0,i=0;for(let o=0;o<r;o++)i=n[o].charCodeAt(0)-96,s+=i*26**(r-o-1);return s===0?Number.NaN:s-1}static chatAtABC(t){let i="";for(;t>=0;)i=String.fromCharCode(t%26+97)+i,t=Math.floor(t/26)-1;return i.toUpperCase()}static commonExtend(t,n){const r={};for(const s in t)r[s]=t[s];for(const s in n)n[s]!=null&&(r[s]=n[s]);return r}static hasIntersectionBetweenTwoRanges(t,n,r,s){return n>=r&&s>=t}static isStartValidPosition(t){return/^[A-Za-zА-Яа-яЁё_]/.test(t)}static isValidParameter(t){const n=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(t),r=t.length<=255;return!n&&r}static clamp(t,n,r){return Math.max(n,Math.min(r,t))}static now(){return performance&&performance.now?performance.now():Date.now()}}function tt(e=21,t){return t?C_(t,e)():R_(e)}function lr(...e){const t={},n=e.length;for(let r=n-1;r>=0;r--){const s=e[r];if(s){const i=Object.keys(s);for(const o of i)t[o]===void 0&&(t[o]=s[o])}}return t}const b_=()=>typeof process<"u"&&process.versions!=null&&process.versions.node!=null;function A_(e){const n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*").replace(/\\\?/g,".");return new RegExp(`^${n}$`,"i")}var Cl=(e=>(e[e.DEFAULT_SERIES=0]="DEFAULT_SERIES",e[e.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",e))(Cl||{}),Ue=(e=>(e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.HAIR=2]="HAIR",e[e.DOTTED=3]="DOTTED",e[e.DASHED=4]="DASHED",e[e.DASH_DOT=5]="DASH_DOT",e[e.DASH_DOT_DOT=6]="DASH_DOT_DOT",e[e.DOUBLE=7]="DOUBLE",e[e.MEDIUM=8]="MEDIUM",e[e.MEDIUM_DASHED=9]="MEDIUM_DASHED",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",e[e.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",e[e.THICK=13]="THICK",e))(Ue||{}),Rl=(e=>(e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.NONE="none",e.ALL="all",e.OUTSIDE="outside",e.INSIDE="inside",e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.TLBR="tlbr",e.TLBC_TLMR="tlbc_tlmr",e.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",e.BLTR="bl_tr",e.MLTR_BCTR="mltr_bctr",e))(Rl||{}),Et=(e=>(e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.RGB=1]="RGB",e[e.HEX=2]="HEX",e[e.THEME=3]="THEME",e))(Et||{}),Il=(e=>(e[e.ON=0]="ON",e[e.OFF=1]="OFF",e))(Il||{}),Sl=(e=>(e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_FORMULA=3]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",e[e.PASTE_VALUES=5]="PASTE_VALUES",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",e))(Sl||{}),Ol=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e))(Ol||{}),vl=(e=>(e[e.DOCUMENT=0]="DOCUMENT",e[e.PROJECT=1]="PROJECT",e))(vl||{}),wl=(e=>(e[e.COLUMNS=0]="COLUMNS",e[e.ROWS=1]="ROWS",e))(wl||{}),bl=(e=>(e[e.UP=0]="UP",e[e.RIGHT=1]="RIGHT",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e))(bl||{});function y_(e){switch(e){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var Al=(e=>(e[e.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",e[e.MIN=1]="MIN",e[e.MAX=2]="MAX",e[e.NUMBER=3]="NUMBER",e[e.PERCENT=4]="PERCENT",e[e.PERCENTILE=5]="PERCENTILE",e))(Al||{}),ur=(e=>(e.EN_US="enUS",e.FR_FR="frFR",e.ZH_CN="zhCN",e.RU_RU="ruRU",e.ZH_TW="zhTW",e.VI_VN="viVN",e.FA_IR="faIR",e.JA_JP="jaJP",e.KO_KR="koKR",e.ES_ES="esES",e.CA_ES="caES",e))(ur||{}),ls=(e=>(e[e.PERSON=0]="PERSON",e[e.FILE=1]="FILE",e[e.DATE=2]="DATE",e[e.LOCATION=3]="LOCATION",e[e.EVENT=4]="EVENT",e))(ls||{}),yl=(e=>(e[e.RANGE=0]="RANGE",e[e.SHEET=1]="SHEET",e))(yl||{}),Tl=(e=>(e.Line="line",e.LineInv="lineInv",e.Triangle="triangle",e.RtTriangle="rtTriangle",e.Rect="rect",e.Diamond="diamond",e.Parallelogram="parallelogram",e.Trapezoid="trapezoid",e.NonIsocelesTrapezoid="nonIsocelesTrapezoid",e.Pentagon="pentagon",e.Hexagon="hexagon",e.Heptagon="heptagon",e.Octagon="octagon",e.Decagon="decagon",e.Dodecagon="dodecagon",e.Star4="star4",e.Star5="star5",e.Star6="star6",e.Star7="star7",e.Star8="star8",e.Star10="star10",e.Star12="star12",e.Star16="star16",e.Star24="star24",e.Star32="star32",e.RoundRect="roundRect",e.Round1Rect="round1Rect",e.Round2SameRect="round2SameRect",e.Round2DiagRect="round2DiagRect",e.Ellipse="ellipse",e))(Tl||{}),Nl=(e=>(e.RightArrow="rightArrow",e.LeftArrow="leftArrow",e.UpArrow="upArrow",e.DownArrow="downArrow",e.LeftRightArrow="leftRightArrow",e.UpDownArrow="upDownArrow",e.QuadArrow="quadArrow",e.LeftRightUpArrow="leftRightUpArrow",e.BentArrow="bentArrow",e.UturnArrow="uturnArrow",e.CircularArrow="circularArrow",e.NotchedRightArrow="notchedRightArrow",e.HomePlate="homePlate",e.Chevron="chevron",e.LeftCircularArrow="leftCircularArrow",e.LeftRightCircularArrow="leftRightCircularArrow",e))(Nl||{}),Ml=(e=>(e.Plaque="plaque",e.Can="can",e.Cube="cube",e.Bevel="bevel",e.Donut="donut",e.NoSmoking="noSmoking",e.BlockArc="blockArc",e.FoldedCorner="foldedCorner",e))(Ml||{}),Ll=(e=>(e.SmileyFace="smileyFace",e.Heart="heart",e.LightningBolt="lightningBolt",e.Sun="sun",e.Moon="moon",e.Cloud="cloud",e.Arc="arc",e.Backpack="backpack",e.Frame="frame",e.HalfFrame="halfFrame",e.Corner="corner",e.Chord="chord",e.Pie="pie",e.Teardrop="teardrop",e.WedgeRectCallout="wedgeRectCallout",e.WedgeRRectCallout="wedgeRRectCallout",e.WedgeEllipseCallout="wedgeEllipseCallout",e.CloudCallout="cloudCallout",e.BorderCallout1="borderCallout1",e.BorderCallout2="borderCallout2",e.BorderCallout3="borderCallout3",e.AccentCallout1="accentCallout1",e.AccentCallout2="accentCallout2",e.AccentCallout3="accentCallout3",e.Callout1="callout1",e.Callout2="callout2",e.Callout3="callout3",e.ActionButtonBackPrevious="actionButtonBackPrevious",e.ActionButtonEnd="actionButtonEnd",e.ActionButtonForwardNext="actionButtonForwardNext",e.ActionButtonHelp="actionButtonHelp",e.ActionButtonHome="actionButtonHome",e.ActionButtonInformation="actionButtonInformation",e.ActionButtonMovie="actionButtonMovie",e.ActionButtonReturn="actionButtonReturn",e.ActionButtonSound="actionButtonSound",e))(Ll||{}),Dl=(e=>(e[e.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",e[e.PAST_YEAR=1]="PAST_YEAR",e[e.PAST_MONTH=2]="PAST_MONTH",e[e.PAST_WEEK=3]="PAST_WEEK",e[e.YESTERDAY=4]="YESTERDAY",e[e.TODAY=5]="TODAY",e[e.TOMORROW=6]="TOMORROW",e))(Dl||{}),Ul=(e=>(e[e.GRID=0]="GRID",e[e.KANBAN=1]="KANBAN",e[e.GANTT=2]="GANTT",e))(Ul||{}),cr=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",e))(cr||{}),Pl=(e=>(e[e.DASH=0]="DASH",e[e.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",e[e.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",e[e.DASHED_HEAVY=3]="DASHED_HEAVY",e[e.DASH_LONG=4]="DASH_LONG",e[e.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",e[e.DOT_DASH=6]="DOT_DASH",e[e.DOT_DOT_DASH=7]="DOT_DOT_DASH",e[e.DOTTED=8]="DOTTED",e[e.DOTTED_HEAVY=9]="DOTTED_HEAVY",e[e.DOUBLE=10]="DOUBLE",e[e.NONE=11]="NONE",e[e.SINGLE=12]="SINGLE",e[e.THICK=13]="THICK",e[e.WAVE=14]="WAVE",e[e.WAVY_DOUBLE=15]="WAVY_DOUBLE",e[e.WAVY_HEAVY=16]="WAVY_HEAVY",e[e.WORDS=17]="WORDS",e))(Pl||{}),wt=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT",e[e.JUSTIFIED=4]="JUSTIFIED",e[e.BOTH=5]="BOTH",e[e.DISTRIBUTED=6]="DISTRIBUTED",e))(wt||{}),mn=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM",e))(mn||{}),gn=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.OVERFLOW=1]="OVERFLOW",e[e.CLIP=2]="CLIP",e[e.WRAP=3]="WRAP",e))(gn||{}),us=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ITALIC=1]="ITALIC",e))(us||{}),cs=(e=>(e[e.NORMAL=0]="NORMAL",e[e.BOLD=1]="BOLD",e))(cs||{}),jt=(e=>(e[e.NORMAL=1]="NORMAL",e[e.SUBSCRIPT=2]="SUBSCRIPT",e[e.SUPERSCRIPT=3]="SUPERSCRIPT",e))(jt||{}),ae=(e=>(e[e.FALSE=0]="FALSE",e[e.TRUE=1]="TRUE",e))(ae||{}),Zt=(e=>(e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER",e[e.BOOLEAN=3]="BOOLEAN",e[e.FORCE_STRING=4]="FORCE_STRING",e))(Zt||{}),ot=(e=>(e[e.DARK1=0]="DARK1",e[e.LIGHT1=1]="LIGHT1",e[e.DARK2=2]="DARK2",e[e.LIGHT2=3]="LIGHT2",e[e.ACCENT1=4]="ACCENT1",e[e.ACCENT2=5]="ACCENT2",e[e.ACCENT3=6]="ACCENT3",e[e.ACCENT4=7]="ACCENT4",e[e.ACCENT5=8]="ACCENT5",e[e.ACCENT6=9]="ACCENT6",e[e.HYPERLINK=10]="HYPERLINK",e[e.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",e))(ot||{}),hs=(e=>(e.OFFICE="Office",e.OFFICE_2007_2010="Office 2007-2010",e.GRAYSCALE="Grayscale",e.BLUE_WARM="Blue Warm",e.BLUE="Blue",e.BLUE_II="Blue II",e.BLUE_GREEN="Blue Green",e.GREEN="Green",e.GREEN_YELLOW="Green Yellow",e.YELLOW="Yellow",e.YELLOW_ORANGE="Yellow Orange",e.ORANGE="Orange",e.ORANGE_RED="Orange Red",e.RED_ORANGE="Red Orange",e.RED="Red",e.RED_VIOLET="Red Violet",e.VIOLET="Violet",e.VIOLET_II="Violet II",e.MEDIAN="Median",e.PAPER="Paper",e.MARQUEE="Marquee",e.SLIPSTREAM="Slipstream",e.Aspect="Aspect",e))(hs||{}),kl=(e=>(e[e.character=0]="character",e[e.paragraph=1]="paragraph",e[e.table=2]="table",e[e.numbering=3]="numbering",e))(kl||{}),Fl=(e=>(e[e.TAB=0]="TAB",e[e.SPACE=1]="SPACE",e[e.NOTHING=2]="NOTHING",e))(Fl||{}),fe=(e=>(e[e.BULLET=0]="BULLET",e[e.NONE=1]="NONE",e[e.DECIMAL=2]="DECIMAL",e[e.DECIMAL_ZERO=3]="DECIMAL_ZERO",e[e.UPPER_LETTER=4]="UPPER_LETTER",e[e.LOWER_LETTER=5]="LOWER_LETTER",e[e.UPPER_ROMAN=6]="UPPER_ROMAN",e[e.LOWER_ROMAN=7]="LOWER_ROMAN",e[e.ORDINAL=8]="ORDINAL",e[e.CARDINAL_TEXT=9]="CARDINAL_TEXT",e[e.ORDINAL_TEXT=10]="ORDINAL_TEXT",e[e.HEX=11]="HEX",e[e.CHICAGO=12]="CHICAGO",e[e.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",e[e.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",e[e.AIUEO=15]="AIUEO",e[e.IROHA=16]="IROHA",e[e.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",e[e.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",e[e.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",e[e.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",e[e.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",e[e.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",e[e.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",e[e.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",e[e.GANADA=25]="GANADA",e[e.CHOSUNG=26]="CHOSUNG",e[e.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",e[e.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",e[e.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",e[e.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",e[e.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",e[e.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",e[e.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",e[e.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",e[e.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",e[e.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",e[e.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",e[e.CHINESE_COUNTING=38]="CHINESE_COUNTING",e[e.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",e[e.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",e[e.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",e[e.KOREAN_COUNTING=42]="KOREAN_COUNTING",e[e.KOREAN_LEGAL=43]="KOREAN_LEGAL",e[e.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",e[e.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",e[e.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",e[e.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",e[e.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",e[e.HEBREW1=49]="HEBREW1",e[e.HEBREW2=50]="HEBREW2",e[e.ARABIC_ALPHA=51]="ARABIC_ALPHA",e[e.ARABIC_ABJAD=52]="ARABIC_ABJAD",e[e.HINDI_VOWELS=53]="HINDI_VOWELS",e[e.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",e[e.HINDI_NUMBERS=55]="HINDI_NUMBERS",e[e.HINDI_COUNTING=56]="HINDI_COUNTING",e[e.THAI_LETTERS=57]="THAI_LETTERS",e[e.THAI_NUMBERS=58]="THAI_NUMBERS",e[e.THAI_COUNTING=59]="THAI_COUNTING",e[e.CUSTOM=60]="CUSTOM",e))(fe||{}),hr=(e=>(e[e.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e[e.BOTH=4]="BOTH",e))(hr||{}),Qt=(e=>(e[e.HYPERLINK=0]="HYPERLINK",e[e.FIELD=1]="FIELD",e[e.SDT=2]="SDT",e[e.BOOKMARK=3]="BOOKMARK",e[e.COMMENT=4]="COMMENT",e[e.CUSTOM=5]="CUSTOM",e[e.MENTION=6]="MENTION",e[e.UNI_FORMULA=7]="UNI_FORMULA",e[e.DELTED=9999]="DELTED",e))(Qt||{}),_n=(e=>(e[e.COMMENT=0]="COMMENT",e[e.DELETED=9999]="DELETED",e))(_n||{}),xl=(e=>(e[e.DRAWING=0]="DRAWING",e[e.CUSTOM=1]="CUSTOM",e))(xl||{}),yi=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TRADITIONAL=1]="TRADITIONAL",e[e.MODERN=2]="MODERN",e))(yi||{}),Bl=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.LINES=1]="LINES",e[e.LINES_AND_CHARS=2]="LINES_AND_CHARS",e[e.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",e))(Bl||{}),Hl=(e=>(e[e.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",e[e.CONTINUOUS=1]="CONTINUOUS",e[e.NEXT_PAGE=2]="NEXT_PAGE",e[e.EVEN_PAGE=3]="EVEN_PAGE",e[e.ODD_PAGE=4]="ODD_PAGE",e))(Hl||{}),$l=(e=>(e[e.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",e[e.NONE=1]="NONE",e[e.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",e))($l||{}),jl=(e=>(e[e.NORMAL=0]="NORMAL",e[e.TBRL=1]="TBRL",e[e.LRTBV=2]="LRTBV",e))(jl||{}),Wl=(e=>(e[e.TEXT_RUN=0]="TEXT_RUN",e[e.AUTO_TEXT=1]="AUTO_TEXT",e[e.PAGE_BREAK=2]="PAGE_BREAK",e[e.COLUMN_BREAK=3]="COLUMN_BREAK",e[e.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",e[e.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",e[e.EQUATION=6]="EQUATION",e[e.DRAWING=7]="DRAWING",e[e.PERSON=8]="PERSON",e[e.RICH_LINK=9]="RICH_LINK",e))(Wl||{}),Yl=(e=>(e[e.BOTH_SIDES=0]="BOTH_SIDES",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.LARGEST=3]="LARGEST",e))(Yl||{}),Gl=(e=>(e[e.INLINE=0]="INLINE",e[e.WRAP_NONE=1]="WRAP_NONE",e[e.WRAP_POLYGON=2]="WRAP_POLYGON",e[e.WRAP_SQUARE=3]="WRAP_SQUARE",e[e.WRAP_THROUGH=4]="WRAP_THROUGH",e[e.WRAP_TIGHT=5]="WRAP_TIGHT",e[e.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",e))(Gl||{}),qe=(e=>(e[e.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",e[e.NORMAL_TEXT=1]="NORMAL_TEXT",e[e.TITLE=2]="TITLE",e[e.SUBTITLE=3]="SUBTITLE",e[e.HEADING_1=4]="HEADING_1",e[e.HEADING_2=5]="HEADING_2",e[e.HEADING_3=6]="HEADING_3",e[e.HEADING_4=7]="HEADING_4",e[e.HEADING_5=8]="HEADING_5",e))(qe||{}),Vl=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))(Vl||{}),zl=(e=>(e[e.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",e[e.SOLID=1]="SOLID",e[e.DOT=2]="DOT",e[e.DASH=3]="DASH",e))(zl||{}),Kl=(e=>(e[e.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e))(Kl||{}),Xl=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SPECIFIED=1]="SPECIFIED",e))(Xl||{}),ql=(e=>(e[e.START=0]="START",e[e.CENTER=1]="CENTER",e[e.END=2]="END",e))(ql||{}),Jl=(e=>(e[e.AUTO_FIT=0]="AUTO_FIT",e[e.FIXED=1]="FIXED",e))(Jl||{}),Zl=(e=>(e[e.NONE=0]="NONE",e[e.WRAP=1]="WRAP",e))(Zl||{}),Ql=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))(Ql||{}),eu=(e=>(e[e.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",e[e.BOTH=1]="BOTH",e[e.TOP=2]="TOP",e[e.CENTER=3]="CENTER",e[e.BOTTOM=4]="BOTTOM",e))(eu||{}),Ln=(e=>(e.NORMAL="normal",e.BOLD="bold",e.ITALIC="italic",e))(Ln||{}),tu=(e=>(e[e.PAGE=0]="PAGE",e[e.COLUMN=1]="COLUMN",e[e.CHARACTER=2]="CHARACTER",e[e.MARGIN=3]="MARGIN",e[e.INSIDE_MARGIN=4]="INSIDE_MARGIN",e[e.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",e[e.LEFT_MARGIN=6]="LEFT_MARGIN",e[e.RIGHT_MARGIN=7]="RIGHT_MARGIN",e))(tu||{}),nu=(e=>(e[e.PAGE=0]="PAGE",e[e.PARAGRAPH=1]="PARAGRAPH",e[e.LINE=2]="LINE",e[e.MARGIN=3]="MARGIN",e[e.TOP_MARGIN=4]="TOP_MARGIN",e[e.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",e[e.INSIDE_MARGIN=6]="INSIDE_MARGIN",e[e.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",e))(nu||{}),ru=(e=>(e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.CHARACTER=2]="CHARACTER",e[e.PIXEL=3]="PIXEL",e[e.PERCENT=4]="PERCENT",e))(ru||{}),su=(e=>(e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.LEFT=2]="LEFT",e[e.OUTSIDE=3]="OUTSIDE",e[e.RIGHT=4]="RIGHT",e[e.BOTH=5]="BOTH",e[e.DISTRIBUTE=6]="DISTRIBUTE",e))(su||{}),iu=(e=>(e[e.BOTTOM=0]="BOTTOM",e[e.CENTER=1]="CENTER",e[e.INSIDE=2]="INSIDE",e[e.OUTSIDE=3]="OUTSIDE",e[e.TOP=4]="TOP",e))(iu||{}),ou=(e=>(e[e.compressPunctuation=0]="compressPunctuation",e[e.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",e[e.doNotCompress=2]="doNotCompress",e))(ou||{}),au=(e=>(e[e.PORTRAIT=0]="PORTRAIT",e[e.LANDSCAPE=1]="LANDSCAPE",e))(au||{}),ct=(e=>(e.Letter="Letter",e.Tabloid="Tabloid",e.Legal="Legal",e.Statement="Statement",e.Executive="Executive",e.Folio="Folio",e.A3="A3",e.A4="A4",e.A5="A5",e.B4="B4",e.B5="B5",e))(ct||{});const T_=["A3","A4","A5","B4","B5","Letter","Tabloid","Legal","Statement","Executive","Folio"];var lu=(e=>(e[e.forward=0]="forward",e[e.backward=1]="backward",e[e.front=2]="front",e[e.back=3]="back",e))(lu||{}),uu=(e=>(e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e[e.DRAWING_IMAGE=0]="DRAWING_IMAGE",e[e.DRAWING_SHAPE=1]="DRAWING_SHAPE",e[e.DRAWING_CHART=2]="DRAWING_CHART",e[e.DRAWING_TABLE=3]="DRAWING_TABLE",e[e.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",e[e.DRAWING_VIDEO=5]="DRAWING_VIDEO",e[e.DRAWING_GROUP=6]="DRAWING_GROUP",e[e.DRAWING_UNIT=7]="DRAWING_UNIT",e[e.DRAWING_DOM=8]="DRAWING_DOM",e))(uu||{}),Ti=(e=>(e[e.SLIDE=0]="SLIDE",e[e.MASTER=1]="MASTER",e[e.LAYOUT=2]="LAYOUT",e[e.HANDOUT_MASTER=3]="HANDOUT_MASTER",e[e.NOTES_MASTER=4]="NOTES_MASTER",e))(Ti||{}),cu=(e=>(e[e.SHAPE=0]="SHAPE",e[e.IMAGE=1]="IMAGE",e[e.TEXT=2]="TEXT",e[e.SPREADSHEET=3]="SPREADSHEET",e[e.DOCUMENT=4]="DOCUMENT",e[e.SLIDE=5]="SLIDE",e))(cu||{}),hu=(e=>(e[e.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",e[e.NEXT_SLIDE=1]="NEXT_SLIDE",e[e.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",e[e.FIRST_SLIDE=3]="FIRST_SLIDE",e[e.LAST_SLIDE=4]="LAST_SLIDE",e))(hu||{});function N_(e=tt(6),t=ur.EN_US,n=""){return{id:e,locale:t,title:n,tableSource:{},drawings:{},drawingsOrder:[],headers:{},footers:{},body:{dataStream:`\r
`,textRuns:[],customBlocks:[],tables:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},documentFlavor:yi.TRADITIONAL,marginTop:50,marginBottom:50,marginRight:50,marginLeft:50,renderConfig:{zeroWidthParagraphBreak:ae.FALSE,vertexAngle:0,centerAngle:0,background:{rgb:"#ccc"}},autoHyphenation:ae.TRUE,doNotHyphenateCaps:ae.FALSE,consecutiveHyphenLimit:2,defaultHeaderId:"",defaultFooterId:"",evenPageHeaderId:"",evenPageFooterId:"",firstPageHeaderId:"",firstPageFooterId:"",evenAndOddHeaders:ae.FALSE,useFirstPageHeaderFooter:ae.FALSE,marginHeader:30,marginFooter:30},settings:{}}}var pn={},dr={},ds={},du;function M_(){if(du)return ds;du=1,Object.defineProperty(ds,"__esModule",{value:!0});function e(r,s){if(Array.isArray(s))return!1;for(let i in r)if(!n(r[i],s[i]))return!1;for(let i in s)if(r[i]===void 0)return!1;return!0}function t(r,s){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let i=0;i<r.length;i++)if(!n(r[i],s[i]))return!1;return!0}function n(r,s){return r===s?!0:r===null||s===null||typeof r!="object"||typeof s!="object"?!1:Array.isArray(r)?t(r,s):e(r,s)}return ds.default=n,ds}var fs={},fu;function L_(){if(fu)return fs;fu=1,Object.defineProperty(fs,"__esModule",{value:!0});function e(t){if(t===null)return null;if(Array.isArray(t))return t.map(e);if(typeof t=="object"){const n={};for(let r in t)n[r]=e(t[r]);return n}else return t}return fs.default=e,fs}var Ni={},mu;function gu(){return mu||(mu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.eachChildOf=e.advancer=e.readCursor=e.writeCursor=e.WriteCursor=e.ReadCursor=e.isValidPathItem=void 0;function t(c,h){if(!c)throw new Error(h)}const n=c=>c!=null&&typeof c=="object"&&!Array.isArray(c),r=(c,h)=>typeof c==typeof h?c>h:typeof c=="string"&&typeof h=="number";function s(c,h){for(let d in c){const m=d;h.write(m,c[m])}}e.isValidPathItem=c=>typeof c=="number"||typeof c=="string"&&c!=="__proto__";class i{constructor(h=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=h}ascend(){t(this.parents.length===this.indexes.length/2),this.idx===0?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(t(this.idx>0),this.idx--,n(this.container[this.idx])&&this.idx--)}getPath(){const h=[];let d=this.container,m=this.parents.length-1,_=this.idx;for(;_>=0;)h.unshift(d[_]),_===0?(_=this.indexes[m*2],d=this.parents[m--]):_-=n(d[_-1])?2:1;return h}}class o extends i{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return t(this.container!=null,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let h;return this.container&&this.container.length>this.idx+1&&n(h=this.container[this.idx+1])?h:null}descendFirst(){let h=this.idx+1;if(!this.container||h>=this.container.length||n(this.container[h])&&h+1>=this.container.length)return!1;n(this.container[h])&&h++;const d=this.container[h];return Array.isArray(d)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(h),this.idx=0,this.container=d):this.idx=h,!0}nextSibling(){if(t(this.parents.length===this.indexes.length/2),this.idx>0||this.parents.length===0)return!1;const h=this.indexes[this.indexes.length-1]+1,d=this.parents[this.parents.length-1];return h>=d.length?!1:(t(!isNaN(h)),this.indexes[this.indexes.length-1]=h,this.container=d[h],!0)}_init(h,d,m,_){this.container=h,this.idx=d,this.parents=m.slice(),this.indexes=_.slice()}clone(){const h=new o;return h._init(this.container,this.idx,this.parents,this.indexes),h}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling());this.ascend()}}traverse(h,d){const m=this.getComponent();m&&d(m,h);for(const _ of this)h&&h.descend(_),this.traverse(h,d),h&&h.ascend()}eachPick(h,d){this.traverse(h,(m,_)=>{m.p!=null&&d(m.p,_)})}eachDrop(h,d){this.traverse(h,(m,_)=>{m.d!=null&&d(m.d,_)})}}e.ReadCursor=o;class a extends i{constructor(h=null){super(h),this.pendingDescent=[],this._op=h}flushDescent(){t(this.parents.length===this.indexes.length/2),this.container===null&&(this._op=this.container=[]);for(let h=0;h<this.pendingDescent.length;h++){const d=this.pendingDescent[h];let m=this.idx+1;if(m<this.container.length&&n(this.container[m])&&m++,t(m===this.container.length||!n(this.container[m])),m===this.container.length)this.container.push(d),this.idx=m;else if(this.container[m]===d)this.idx=m;else{if(!Array.isArray(this.container[m])){const _=this.container.splice(m,this.container.length-m);this.container.push(_),this.lcIdx>-1&&(this.lcIdx=m)}for(this.indexes.push(this.idx),this.parents.push(this.container),this.lcIdx!==-1&&(t(r(d,this.container[this.lcIdx][0])),m=this.lcIdx+1,this.lcIdx=-1);m<this.container.length&&r(d,this.container[m][0]);)m++;if(this.indexes.push(m),this.idx=0,m<this.container.length&&this.container[m][0]===d)this.container=this.container[m];else{const _=[d];this.container.splice(m,0,_),this.container=_}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();const h=this.idx+1;if(h<this.container.length&&n(this.container[h]))return this.container[h];{const d={};return this.container.splice(h,0,d),d}}write(h,d){const m=this.getComponent();t(m[h]==null||m[h]===d,"Internal consistency error: Overwritten component. File a bug"),m[h]=d}get(){return this._op}descend(h){if(!e.isValidPathItem(h))throw Error("Invalid JSON key");this.pendingDescent.push(h)}descendPath(h){return this.pendingDescent.push(...h),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(h,d=s){if(h===null)return;if(t(Array.isArray(h)),h===this._op)throw Error("Cannot merge into my own tree");const m=this.lcIdx,_=this.parents.length;let p=0;for(let I=0;I<h.length;I++){const A=h[I];typeof A=="string"||typeof A=="number"?(p++,this.descend(A)):Array.isArray(A)?this.mergeTree(A,d):typeof A=="object"&&d(A,this)}for(;p--;)this.ascend();this.lcIdx=this.parents.length===_?m:-1}at(h,d){this.descendPath(h),d(this);for(let m=0;m<h.length;m++)this.ascend();return this}writeAtPath(h,d,m){return this.at(h,()=>this.write(d,m)),this.reset(),this}writeMove(h,d,m=0){return this.writeAtPath(h,"p",m).writeAtPath(d,"d",m)}getPath(){const h=super.getPath();return h.push(...this.pendingDescent),h}}e.WriteCursor=a,e.writeCursor=()=>new a,e.readCursor=c=>new o(c);function l(c,h,d){let m,_;_=m=c?c.descendFirst():!1;function p(I){let A;for(;_;){const B=A=c.getKey();if(I!=null){let x=!1;if(h&&typeof B=="number"&&(A=h(B,c.getComponent()),A<0&&(A=~A,x=!0)),r(A,I))return null;if(A===I&&!x)return c}d&&typeof A=="number"&&d(A,c.getComponent()),_=c.nextSibling()}return null}return p.end=()=>{m&&c.ascend()},p}e.advancer=l;function u(c,h,d){let m,_,p,I;for(m=_=c&&c.descendFirst(),p=I=h&&h.descendFirst();m||p;){let A=m?c.getKey():null,B=p?h.getKey():null;A!==null&&B!==null&&(r(B,A)?B=null:A!==B&&(A=null)),d(A==null?B:A,A!=null?c:null,B!=null?h:null),A!=null&&m&&(m=c.nextSibling()),B!=null&&p&&(p=h.nextSibling())}_&&c.ascend(),I&&h.ascend()}e.eachChildOf=u})(Ni)),Ni}var Mi={},_u;function pu(){return _u||(_u=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConflictType=void 0,(function(t){t[t.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",t[t.DROP_COLLISION=2]="DROP_COLLISION",t[t.BLACKHOLE=3]="BLACKHOLE"})(e.ConflictType||(e.ConflictType={}))})(Mi)),Mi}var bt={},En={},Eu;function Li(){return Eu||(Eu=1,Object.defineProperty(En,"__esModule",{value:!0}),En.uniToStrPos=En.strPosToUni=void 0,En.strPosToUni=(e,t=e.length)=>{let n=0,r=0;for(;r<t;r++){const s=e.charCodeAt(r);s>=55296&&s<=57343&&(n++,r++)}if(r!==t)throw Error("Invalid offset - splits unicode bytes");return r-n},En.uniToStrPos=(e,t)=>{let n=0;for(;t>0;t--){const r=e.charCodeAt(n);n+=r>=55296&&r<=57343?2:1}return n}),En}var Di={},Cu;function Ui(){return Cu||(Cu=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniSlice=e.dlen=e.eachOp=void 0;const t=Li(),n=O=>{if(!Array.isArray(O))throw Error("Op must be an array of components");let R=null;for(let b=0;b<O.length;b++){const T=O[b];switch(typeof T){case"object":if(typeof T.d!="number"&&typeof T.d!="string")throw Error("Delete must be number or string");if(e.dlen(T.d)<=0)throw Error("Deletes must not be empty");break;case"string":if(!(T.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(T>0))throw Error("Skip components must be >0");if(typeof R=="number")throw Error("Adjacent skip components should be combined");break}R=T}if(typeof R=="number")throw Error("Op has a trailing skip")};function r(O,R){let b=0,T=0;for(let H=0;H<O.length;H++){const $=O[H];switch(R($,b,T),typeof $){case"object":b+=e.dlen($.d);break;case"string":T+=t.strPosToUni($);break;case"number":b+=$,T+=$;break}}}e.eachOp=r;function s(O,R){const b=[],T=a(b);return r(O,(H,$,g)=>{T(R(H,$,g))}),h(b)}const i=O=>O,o=O=>s(O,i);e.dlen=O=>typeof O=="number"?O:t.strPosToUni(O);const a=O=>R=>{if(!(!R||R.d===0||R.d===""))if(O.length===0)O.push(R);else if(typeof R==typeof O[O.length-1])if(typeof R=="object"){const b=O[O.length-1];b.d=typeof b.d=="string"&&typeof R.d=="string"?b.d+R.d:e.dlen(b.d)+e.dlen(R.d)}else O[O.length-1]+=R;else O.push(R)},l=O=>typeof O=="number"?O:typeof O=="string"?t.strPosToUni(O):typeof O.d=="number"?O.d:t.strPosToUni(O.d);e.uniSlice=(O,R,b)=>{const T=t.uniToStrPos(O,R),H=b==null?1/0:t.uniToStrPos(O,b);return O.slice(T,H)};const u=(O,R,b)=>typeof O=="number"?b==null?O-R:Math.min(O,b)-R:e.uniSlice(O,R,b),c=O=>{let R=0,b=0;return{take:($,g)=>{if(R===O.length)return $===-1?null:$;const P=O[R];let v;if(typeof P=="number")return $===-1||P-b<=$?(v=P-b,++R,b=0,v):(b+=$,$);if(typeof P=="string"){if($===-1||g==="i"||t.strPosToUni(P.slice(b))<=$)return v=P.slice(b),++R,b=0,v;{const M=b+t.uniToStrPos(P.slice(b),$);return v=P.slice(b,M),b=M,v}}else{if($===-1||g==="d"||e.dlen(P.d)-b<=$)return v={d:u(P.d,b)},++R,b=0,v;{let M=u(P.d,b,b+$);return b+=$,{d:M}}}},peek:()=>O[R]}},h=O=>(O.length>0&&typeof O[O.length-1]=="number"&&O.pop(),O);function d(O,R,b){if(b!=="left"&&b!=="right")throw Error("side ("+b+") must be 'left' or 'right'");n(O),n(R);const T=[],H=a(T),{take:$,peek:g}=c(O);for(let v=0;v<R.length;v++){const M=R[v];let y,w;switch(typeof M){case"number":for(y=M;y>0;)w=$(y,"i"),H(w),typeof w!="string"&&(y-=l(w));break;case"string":b==="left"&&typeof g()=="string"&&H($(-1)),H(t.strPosToUni(M));break;case"object":for(y=e.dlen(M.d);y>0;)switch(w=$(y,"i"),typeof w){case"number":y-=w;break;case"string":H(w);break;case"object":y-=e.dlen(w.d)}break}}let P;for(;P=$(-1);)H(P);return h(T)}function m(O,R){n(O),n(R);const b=[],T=a(b),{take:H}=c(O);for(let g=0;g<R.length;g++){const P=R[g];let v,M;switch(typeof P){case"number":for(v=P;v>0;)M=H(v,"d"),T(M),typeof M!="object"&&(v-=l(M));break;case"string":T(P);break;case"object":v=e.dlen(P.d);let y=0;for(;y<v;)switch(M=H(v-y,"d"),typeof M){case"number":T({d:u(P.d,y,y+M)}),y+=M;break;case"string":y+=t.strPosToUni(M);break;case"object":T(M)}break}}let $;for(;$=H(-1);)T($);return h(b)}const _=(O,R)=>{let b=0;for(let T=0;T<R.length&&O>b;T++){const H=R[T];switch(typeof H){case"number":{b+=H;break}case"string":const $=t.strPosToUni(H);b+=$,O+=$;break;case"object":O-=Math.min(e.dlen(H.d),O-b);break}}return O},p=(O,R)=>typeof O=="number"?_(O,R):O.map(b=>_(b,R));function I(O,R,b){return s(O,(T,H)=>typeof T=="object"&&typeof T.d=="number"?{d:b.slice(R,H,H+T.d)}:T)}function A(O){return s(O,R=>{switch(typeof R){case"object":if(typeof R.d=="number")throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return R.d;case"string":return{d:R};case"number":return R}})}function B(O){return s(O,R=>typeof R=="object"&&typeof R.d=="string"?{d:t.strPosToUni(R.d)}:R)}function x(O){let R=!0;return r(O,b=>{typeof b=="object"&&typeof b.d=="number"&&(R=!1)}),R}function Y(O){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:h,normalize:o,checkOp:n,create(R=""){if(typeof R!="string")throw Error("Initial data must be a string");return O.create(R)},apply(R,b){n(b);const T=O.builder(R);for(let H=0;H<b.length;H++){const $=b[H];switch(typeof $){case"number":T.skip($);break;case"string":T.append($);break;case"object":T.del(e.dlen($.d));break}}return T.build()},transform:d,compose:m,transformPosition:_,transformSelection:p,isInvertible:x,makeInvertible(R,b){return I(R,b,O)},stripInvertible:B,invert:A,invertWithDoc(R,b){return A(I(R,b,O))},isNoop:R=>R.length===0}}e.default=Y})(Di)),Di}var ms={},Ru;function D_(){if(Ru)return ms;Ru=1,Object.defineProperty(ms,"__esModule",{value:!0});const e=Ui(),t=Li();function n(r,s){return{get:r,getLength(){return r().length},insert(i,o,a){const l=t.strPosToUni(r(),i);return s([l,o],a)},remove(i,o,a){const l=t.strPosToUni(r(),i);return s([l,{d:o}],a)},_onOp(i){e.eachOp(i,(o,a,l)=>{switch(typeof o){case"string":this.onInsert&&this.onInsert(l,o);break;case"object":const u=e.dlen(o.d);this.onRemove&&this.onRemove(l,u)}})},onInsert:null,onRemove:null}}return ms.default=n,n.provides={text:!0},ms}var Iu;function U_(){return Iu||(Iu=1,(function(e){var t=bt&&bt.__createBinding||(Object.create?(function(d,m,_,p){p===void 0&&(p=_),Object.defineProperty(d,p,{enumerable:!0,get:function(){return m[_]}})}):(function(d,m,_,p){p===void 0&&(p=_),d[p]=m[_]})),n=bt&&bt.__setModuleDefault||(Object.create?(function(d,m){Object.defineProperty(d,"default",{enumerable:!0,value:m})}):function(d,m){d.default=m}),r=bt&&bt.__importStar||function(d){if(d&&d.__esModule)return d;var m={};if(d!=null)for(var _ in d)Object.hasOwnProperty.call(d,_)&&t(m,d,_);return n(m,d),m},s=bt&&bt.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.remove=e.insert=void 0;const i=Li(),o=r(Ui()),a=s(D_()),l={create(d){return d},toString(d){return d},builder(d){if(typeof d!="string")throw Error("Invalid document snapshot: "+d);const m=[];return{skip(_){let p=i.uniToStrPos(d,_);if(p>d.length)throw Error("The op is too long for this document");m.push(d.slice(0,p)),d=d.slice(p)},append(_){m.push(_)},del(_){d=d.slice(i.uniToStrPos(d,_))},build(){return m.join("")+d}}},slice:o.uniSlice},u=o.default(l),c=Object.assign(Object.assign({},u),{api:a.default});e.type=c,e.insert=(d,m)=>m.length===0?[]:d===0?[m]:[d,m],e.remove=(d,m)=>o.dlen(m)===0?[]:d===0?[{d:m}]:[d,{d:m}];var h=Ui();Object.defineProperty(e,"makeType",{enumerable:!0,get:function(){return h.default}})})(bt)),bt}var Su;function P_(){return Su||(Su=1,(function(e){var t=dr&&dr.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(e,"__esModule",{value:!0}),e.editOp=e.replaceOp=e.insertOp=e.moveOp=e.removeOp=e.type=void 0;const n=t(M_()),r=t(L_()),s=gu(),i=pu();function o(S,U){if(!S)throw new Error(U)}e.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:s.readCursor,writeCursor:s.writeCursor,create:S=>S,isNoop:S=>S==null,setDebug(S){},registerSubtype:A,checkValidOp:H,normalize:$,apply:g,transformPosition:P,compose:v,tryTransform:D,transform:Q,makeInvertible:w,invert:M,invertWithDoc:N,RM_UNEXPECTED_CONTENT:i.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:i.ConflictType.DROP_COLLISION,BLACKHOLE:i.ConflictType.BLACKHOLE,transformNoConflict:(S,U,G)=>ce(()=>!0,S,U,G),typeAllowingConflictsPred:S=>Object.assign(Object.assign({},e.type),{transform:(U,G,V)=>ce(S,U,G,V)})};const a=S=>S?S.getComponent():null;function l(S){return S&&typeof S=="object"&&!Array.isArray(S)}const u=S=>Array.isArray(S)?S.slice():S!==null&&typeof S=="object"?Object.assign({},S):S,c=S=>S&&(S.p!=null||S.r!==void 0),h=S=>S&&(S.d!=null||S.i!==void 0);function d(S,U){return o(S!=null),typeof U=="number"?(o(Array.isArray(S),"Invalid key - child is not an array"),(S=S.slice()).splice(U,1)):(o(l(S),"Invalid key - child is not an object"),delete(S=Object.assign({},S))[U]),S}function m(S,U,G){return typeof U=="number"?(o(S!=null,"Container is missing for key"),o(Array.isArray(S),"Cannot use numerical key for object container"),o(S.length>=U,"Cannot insert into out of bounds index"),S.splice(U,0,G)):(o(l(S),"Cannot insert into missing item"),o(S[U]===void 0,"Trying to overwrite value at key. Your op needs to remove it first"),S[U]=G),G}e.removeOp=(S,U=!0)=>s.writeCursor().writeAtPath(S,"r",U).get(),e.moveOp=(S,U)=>s.writeCursor().writeMove(S,U).get(),e.insertOp=(S,U)=>s.writeCursor().writeAtPath(S,"i",U).get(),e.replaceOp=(S,U,G)=>s.writeCursor().at(S,V=>{V.write("r",U),V.write("i",G)}).get(),e.editOp=(S,U,G,V=!1)=>s.writeCursor().at(S,j=>R(j,U,G,V)).get();const _=(S,U)=>S!=null&&(typeof U=="number"?Array.isArray(S):typeof S=="object"),p=(S,U)=>_(S,U)?S[U]:void 0,I={};function A(S){let U=S.type?S.type:S;U.name&&(I[U.name]=U),U.uri&&(I[U.uri]=U)}const B=S=>{const U=I[S];if(U)return U;throw Error("Missing type: "+S)};A(U_());const x=(S,U)=>S+U;A({name:"number",apply:x,compose:x,invert:S=>-S,transform:S=>S});const Y=S=>S==null?null:S.et?B(S.et):S.es?I["text-unicode"]:S.ena!=null?I.number:null,O=S=>S.es?S.es:S.ena!=null?S.ena:S.e,R=(S,U,G,V=!1)=>{const[j,W]=typeof U=="string"?[B(U),U]:[U,U.name];!V&&j.isNoop&&j.isNoop(G)||(W==="number"?S.write("ena",G):W==="text-unicode"?S.write("es",G):(S.write("et",W),S.write("e",G)))};function b(S){o(typeof S=="number"),o(S>=0),o(S===(0|S))}function T(S){typeof S=="number"?b(S):o(typeof S=="string")}function H(S){if(S===null)return;const U=new Set,G=new Set,V=W=>{let ee=!0,te=!1;for(let k in W){const K=W[k];if(ee=!1,o(k==="p"||k==="r"||k==="d"||k==="i"||k==="e"||k==="es"||k==="ena"||k==="et","Invalid component item '"+k+"'"),k==="p")b(K),o(!U.has(K)),U.add(K),o(W.r===void 0);else if(k==="d")b(K),o(!G.has(K)),G.add(K),o(W.i===void 0);else if(k==="e"||k==="es"||k==="ena"){o(!te),te=!0;const q=Y(W);o(q,"Missing type in edit"),q.checkValidOp&&q.checkValidOp(O(W))}}o(!ee)},j=(W,ee,te)=>{if(!Array.isArray(W))throw Error("Op must be null or a list");if(W.length===0)throw Error("Empty descent");ee||T(W[0]);let k=1,K=0,q=0;for(let re=0;re<W.length;re++){const ge=W[re];if(o(ge!=null),Array.isArray(ge)){const Ee=j(ge,!1);if(K){const X=typeof q,de=typeof Ee;X===de?o(q<Ee,"descent keys are not in order"):o(X==="number"&&de==="string")}q=Ee,K++,k=3}else typeof ge=="object"?(o(k===1,`Prev not scalar - instead ${k}`),V(ge),k=2):(o(k!==3),T(ge),o(s.isValidPathItem(ge),"Invalid path key"),k=1)}return o(K!==1,"Operation makes multiple descents. Remove some []"),o(k===2||k===3),W[0]};j(S,!0),o(U.size===G.size,"Mismatched picks and drops in op");for(let W=0;W<U.size;W++)o(U.has(W)),o(G.has(W))}function $(S){let U=0,G=[];const V=s.writeCursor();return V.mergeTree(S,(j,W)=>{const ee=Y(j);if(ee){const k=O(j);R(W,ee,ee.normalize?ee.normalize(k):k)}for(const k of["r","p","i","d"])if(j[k]!==void 0){const K=k==="p"||k==="d"?(te=j[k],G[te]==null&&(G[te]=U++),G[te]):j[k];W.write(k,K)}var te}),V.get()}function g(S,U){if(H(U),U===null)return S;const G=[];return(function V(j,W){let ee=j,te=0,k={root:j},K=0,q=k,re="root";function ge(){for(;K<te;K++){let Ee=W[K];typeof Ee!="object"&&(o(_(q,re)),q=q[re]=u(q[re]),re=Ee)}}for(;te<W.length;te++){const Ee=W[te];if(Array.isArray(Ee)){const X=V(ee,Ee);X!==ee&&X!==void 0&&(ge(),ee=q[re]=X)}else if(typeof Ee=="object"){Ee.d!=null?(ge(),ee=m(q,re,G[Ee.d])):Ee.i!==void 0&&(ge(),ee=m(q,re,Ee.i));const X=Y(Ee);if(X)ge(),ee=q[re]=X.apply(ee,O(Ee));else if(Ee.e!==void 0)throw Error("Subtype "+Ee.et+" undefined")}else ee=p(ee,Ee)}return k.root})(S=(function V(j,W){const ee=[];let te=0;for(;te<W.length;te++){const re=W[te];if(Array.isArray(re))break;typeof re!="object"&&(ee.push(j),j=p(j,re))}for(let re=W.length-1;re>=te;re--)j=V(j,W[re]);for(--te;te>=0;te--){const re=W[te];if(typeof re!="object"){const ge=ee.pop();j=j===p(ge,re)?ge:j===void 0?d(ge,re):(K=re,q=j,(k=u(k=ge))[K]=q,k)}else c(re)&&(o(j!==void 0,"Cannot pick up or remove undefined"),re.p!=null&&(G[re.p]=j),j=void 0)}var k,K,q;return j})(S,U),U)}function P(S,U){S=S.slice(),H(U);const G=s.readCursor(U);let V,j,W=!1;const ee=[];for(let k=0;;k++){const K=S[k],q=G.getComponent();if(q&&(q.r!==void 0?W=!0:q.p!=null&&(W=!1,V=q.p,j=k)),k>=S.length)break;let re=0;const ge=s.advancer(G,void 0,(X,de)=>{c(de)&&re++});ee.unshift(ge);const Ee=ge(K);if(typeof K=="number"&&(S[k]-=re),!Ee)break}if(ee.forEach(k=>k.end()),W)return null;const te=()=>{let k=0;if(V!=null){const K=G.getPath();k=K.length,S=K.concat(S.slice(j))}for(;k<S.length;k++){const K=S[k],q=a(G),re=Y(q);if(re){const X=O(q);re.transformPosition&&(S[k]=re.transformPosition(S[k],X));break}let ge=0;const Ee=s.advancer(G,(X,de)=>h(de)?~(X-ge):X-ge,(X,de)=>{h(de)&&ge++})(K);if(typeof K=="number"&&(S[k]+=ge),!Ee)break}};return V!=null?G.eachDrop(null,k=>{k===V&&te()}):te(),S}function v(S,U){if(H(S),H(U),S==null)return U;if(U==null)return S;let G=0;const V=s.readCursor(S),j=s.readCursor(U),W=s.writeCursor(),ee=[],te=[],k=[],K=[],q=[],re=[],ge=new Set;V.traverse(null,X=>{X.p!=null&&(k[X.p]=V.clone())}),j.traverse(null,X=>{X.d!=null&&(K[X.d]=j.clone())});const Ee=s.writeCursor();return(function X(de,Fe,Le,Oe,$e,Vt,rt,Qe){o(Fe||Le);const je=a(Fe),Ot=a(Le),Tt=!!Ot&&Ot.r!==void 0,vn=!!je&&je.i!==void 0,vt=je?je.d:null,mt=Ot?Ot.p:null,zt=(Vt||Tt)&&mt==null;if(mt!=null)Oe=K[mt],rt=te[mt]=new s.WriteCursor;else if(Ot&&Ot.r!==void 0)Oe=null;else{const ie=a(Oe);ie&&ie.d!=null&&(Oe=null)}const ye=a(Oe);if(vt!=null)if(de=k[vt],Qe=ee[vt]=new s.WriteCursor,zt)Vt&&!Tt&&Qe.write("r",!0);else{const ie=q[vt]=G++;rt.write("d",ie)}else if(je&&je.i!==void 0)de=null;else{const ie=a(de);ie&&ie.p!=null&&(de=null)}let ue;vn?(o($e===void 0),ue=je.i):ue=$e;const Ie=(mt==null?!vn||Vt||Tt:ue===void 0)?null:rt.getComponent();if(mt!=null){if(!($e!==void 0||vn)){const ie=vt!=null?q[vt]:G++;re[mt]=ie,Qe.write("p",ie)}}else Tt&&(vn||$e!==void 0||(Ot.r,Qe.write("r",Ot.r)));const he=zt?null:Y(je),se=Y(ye);if((he||se)&&(he&&he.name,se&&se.name),he&&se){o(he===se);const ie=O(je),Se=O(ye),Xe=he.compose(ie,Se);R(rt,he,Xe),ge.add(ye)}else he?R(rt,he,O(je)):se&&(R(rt,se,O(ye)),ge.add(ye));const me=typeof ue=="object"&&ue!=null;let Ae=!1,be=0,Te=0,Ke=0,Ve=0,We=0;const nt=s.advancer(Oe,(ie,Se)=>h(Se)?Ve-ie-1:ie-Ve,(ie,Se)=>{h(Se)&&Ve++}),we=s.advancer(de,(ie,Se)=>c(Se)?be-ie-1:ie-be,(ie,Se)=>{c(Se)&&be++});if(s.eachChildOf(Fe,Le,(ie,Se,Xe)=>{let it,Kt,wn=ie,Nt=ie,Xr=ie;if(typeof ie=="number"){let et=ie+Ke;Kt=nt(et),Nt=et+Ve;let Ye=ie+Te;it=we(Ye),h(a(Kt))&&(it=null),wn=Ye+be,Xr=ie+We,o(wn>=0,"p1PickKey is negative"),o(Nt>=0,"p2DropKey is negative");const Mt=h(a(Se)),Xt=c(a(Xe));(Mt||Xt&&!zt)&&We--,Mt&&Te--,Xt&&Ke--}else it=we(ie),Kt=nt(ie);Qe.descend(wn),rt.descend(Nt);const er=me&&!h(a(Se))?ue[Xr]:void 0,Bt=X(it,Se,Xe,Kt,er,zt,rt,Qe);var Ht,_e,Be;me&&!zt?er!==Bt&&(Ae||(ue=Array.isArray(ue)?ue.slice():Object.assign({},ue),Ae=!0),Ht=ue,Be=Bt,typeof(_e=Xr)=="number"?(o(Array.isArray(Ht)),o(_e<Ht.length)):(o(!Array.isArray(Ht)),o(Ht[_e]!==void 0)),Be===void 0?typeof _e=="number"?Ht.splice(_e,1):delete Ht[_e]:Ht[_e]=Be):o(Bt===void 0),rt.ascend(),Qe.ascend()}),we.end(),nt.end(),Ie!=null)Ie.i=ue;else if(!Vt&&!Tt&&mt==null)return ue})(V,V.clone(),j,j.clone(),void 0,!1,W,Ee),W.reset(),W.mergeTree(Ee.get()),W.reset(),W.get(),ee.map(X=>X.get()),te.map(X=>X.get()),V.traverse(W,(X,de)=>{const Fe=X.p;if(Fe!=null){const Le=q[Fe];Le!=null&&de.write("p",Le);const Oe=ee[Fe];Oe&&Oe.get(),Oe&&de.mergeTree(Oe.get())}else X.r!==void 0&&de.write("r",X.r)}),W.reset(),W.get(),j.traverse(W,(X,de)=>{const Fe=X.d;if(Fe!=null){const Oe=re[Fe];Oe!=null&&de.write("d",Oe);const $e=te[Fe];$e&&de.mergeTree($e.get())}else X.i!==void 0&&de.write("i",X.i);const Le=Y(X);Le&&!ge.has(X)&&R(de,Le,O(X))}),W.get()}function M(S){if(S==null)return null;const U=new s.ReadCursor(S),G=new s.WriteCursor;let V;const j=[],W=[];return(function ee(te,k,K){const q=te.getComponent();let re,ge=!1;if(q){q.p!=null&&(k.write("d",q.p),j[q.p]=te.clone()),q.r!==void 0&&k.write("i",q.r),q.d!=null&&(k.write("p",q.d),K=void 0),q.i!==void 0&&(K=re=q.i);const X=Y(q);X&&(K===void 0?(V||(V=new Set),V.add(q)):(O(q),K=X.apply(K,O(q)),ge=!0))}let Ee=0;for(const X of te){k.descend(X);const de=typeof X=="number"?X-Ee:X,Fe=p(K,de);h(te.getComponent())&&Ee++;const Le=ee(te,k,Fe);if(K!==void 0&&Le!==void 0){if(ge||(ge=!0,K=u(K)),!_(K,de))throw Error("Cannot modify child - invalid operation");K[de]=Le}k.ascend()}if(re===void 0)return ge?K:void 0;k.write("r",K)})(U,G,void 0),V&&(G.reset(),(function ee(te,k,K){const q=k.getComponent();if(q){const X=q.d;if(X!=null&&(te=j[X],K=W[X]=s.writeCursor()),V.has(q)){const de=Y(q);if(!de.invert)throw Error(`Cannot invert subtype ${de.name}`);R(K,de,de.invert(O(q)))}}let re=0,ge=0;const Ee=s.advancer(te,(X,de)=>c(de)?re-X-1:X-re,(X,de)=>{c(de)&&re++});for(const X of k)if(typeof X=="number"){const de=X-ge,Fe=Ee(de),Le=de+re;K.descend(Le),ee(Fe,k,K),h(k.getComponent())&&ge++,K.ascend()}else K.descend(X),ee(Ee(X),k,K),K.ascend();Ee.end()})(U.clone(),U,G),W.length&&(G.reset(),U.traverse(G,(ee,te)=>{const k=ee.p;if(k!=null){const K=W[k];K&&K.get(),K&&te.mergeTree(K.get())}}))),G.get()}const y=(S,U)=>S.some(G=>typeof G=="object"&&(Array.isArray(G)?y(G,U):U(G)));function w(S,U){if(S==null||!y(S,k=>{var K;return k.r!==void 0||((K=Y(k))===null||K===void 0?void 0:K.makeInvertible)!=null}))return S;const G=new s.ReadCursor(S),V=new s.WriteCursor;let j=!1;const W=[],ee=[],te=(k,K,q)=>{const re=k.getComponent();let ge=!1;if(re){re.d!=null&&K.write("d",re.d),re.i!==void 0&&K.write("i",re.i);const X=re.p;if(X!=null&&(W[X]=k.clone(),o(q!==void 0,"Operation picks up at an invalid key"),ee[X]=q,K.write("p",re.p)),re.r!==void 0&&q===void 0)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");const de=Y(re);de&&(de.makeInvertible?j=!0:R(K,de,O(re),!0))}let Ee=0;for(const X of k){K.descend(X);const de=typeof X=="number"?X-Ee:X,Fe=p(q,de),Le=te(k,K,Fe);Fe!==Le&&(ge||(ge=!0,q=u(q)),Le===void 0?(q=d(q,de),typeof X=="number"&&Ee++):q[de]=Le),K.ascend()}return re&&(re.r!==void 0?(K.write("r",r.default(q)),q=void 0):re.p!=null&&(q=void 0)),q};return te(G,V,U),V.get(),j&&(V.reset(),(function k(K,q,re,ge,Ee){const X=q.getComponent();if(X){X.i!==void 0?(ge=X.i,Ee=!0):X.d!=null&&(ge=ee[X.d],K=W[X.d],Ee=!1,X.d);let Oe=Y(X);if(Oe&&Oe.makeInvertible){const $e=O(X);R(re,Oe,Oe.makeInvertible($e,ge),!0)}}let de=0,Fe=0;const Le=s.advancer(K,(Oe,$e)=>c($e)?de-Oe-1:Oe-de,(Oe,$e)=>{c($e)&&de++});for(const Oe of q)if(typeof Oe=="number"){const $e=Oe-Fe,Vt=Le($e),rt=$e+de,Qe=p(ge,Ee?$e:rt);re.descend(Oe),k(Vt,q,re,Qe,Ee),h(q.getComponent())&&Fe++,re.ascend()}else{const $e=p(ge,Oe);re.descend(Oe),k(Le(Oe),q,re,$e,Ee),re.ascend()}Le.end()})(G.clone(),G,V,U,!1)),V.get()}function N(S,U){return M(w(S,U))}const L=S=>{if(S==null)return null;const U=S.slice();for(let G=0;G<S.length;G++){const V=U[G];Array.isArray(V)&&(U[G]=L(V))}return U};function D(S,U,G){o(G==="left"||G==="right","Direction must be left or right");const V=G==="left"?0:1;if(U==null)return{ok:!0,result:S};H(S),H(U);let j=null;const W=[],ee=[],te=[],k=[],K=[],q=[],re=[],ge=[],Ee=[],X=[],de=[],Fe=[],Le=[],Oe=[],$e=[];let Vt=0;const rt=s.readCursor(S),Qe=s.readCursor(U),je=s.writeCursor();if((function ye(ue,Ie=null,he){const se=a(Ie);se&&(se.r!==void 0?he=Ie.clone():se.p!=null&&(he=null,q[se.p]=ue.clone()));const me=ue.getComponent();let Ae;me&&(Ae=me.p)!=null&&(K[Ae]=Ie?Ie.clone():null,te[Ae]=ue.clone(),he&&(X[Ae]=!0,Ee[Ae]=he),se&&se.p!=null&&(Oe[Ae]=se.p));const be=s.advancer(Ie);for(const Te of ue)ye(ue,be(Te),he);be.end()})(Qe,rt,null),(function ye(ue,Ie,he,se,me){const Ae=he.getComponent();let be,Te=!1;Ae&&((be=Ae.d)!=null?(k[be]=he.clone(),se!=null&&($e[se]==null&&($e[se]=[]),$e[se].push(be)),X[be],ue=K[be]||null,Ie=te[be]||null,X[be]?(me&&(de[be]=!0),me=Ee[be]||null):!me||V!==1&&Oe[be]!=null||j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(me.getPath()),op2:e.moveOp(Ie.getPath(),he.getPath())}),Te=!0):Ae.i!==void 0&&(ue=Ie=null,Te=!0,me&&j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(me.getPath()),op2:e.insertOp(he.getPath(),Ae.i)})));const Ke=a(ue);Ke&&(Ke.r!==void 0?me=ue.clone():Ke.p!=null&&(Ke.p,se=Ke.p,me=null));const Ve=Y(Ae);Ve&&me&&j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.removeOp(me.getPath()),op2:e.editOp(he.getPath(),Ve,O(Ae),!0)});let We=0,nt=0;const we=s.advancer(Ie,(Se,Xe)=>c(Xe)?We-Se-1:Se-We,(Se,Xe)=>{c(Xe)&&We++}),ie=s.advancer(ue);for(const Se of he)if(typeof Se=="number"){const Xe=Se-nt,it=we(Xe);nt+=+ye(ie(Xe+We),it,he,se,me)}else{const Xe=we(Se);ye(ie(Se),Xe,he,se,me)}return we.end(),ie.end(),Te})(rt,Qe,Qe.clone(),null,null),k.map(ye=>ye&&ye.get()),j)return{ok:!1,conflict:j};de.map(ye=>!!ye);const Ot=[];let Tt=null;(function ye(ue,Ie,he,se,me){let Ae=!1;const be=a(Ie);if(c(be)){const we=be.p;we!=null?(he=k[we],se=Fe[we]=s.writeCursor(),Ae=!0,me=null):(he=null,me=Ie.clone())}else h(a(he))&&(he=null);const Te=ue.getComponent();if(Te){const we=Te.p;we!=null?(me&&(ge[we]=me),Ot[we]=me||V===1&&Ae?null:se.getComponent(),W[we]=ue.clone(),he&&(re[we]=he.clone())):Te.r!==void 0&&(me||se.write("r",!0),(me||Ae)&&(Tt==null&&(Tt=new Set),Tt.add(Te)))}let Ke=0,Ve=0;const We=s.advancer(Ie,void 0,(we,ie)=>{c(ie)&&Ke++}),nt=s.advancer(he,(we,ie)=>h(ie)?~(we-Ve):we-Ve,(we,ie)=>{h(ie)&&Ve++});if(ue)for(const we of ue)if(typeof we=="string"){const ie=We(we),Se=nt(we);se.descend(we),ye(ue,ie,Se,se,me),se.ascend()}else{const ie=We(we),Se=we-Ke,Xe=c(a(ie))?null:nt(Se),it=Se+Ve;o(it>=0),se.descend(it),ye(ue,ie,Xe,se,me),se.ascend()}We.end(),nt.end()})(rt,Qe,Qe.clone(),je,null),je.reset();let vn=[];if((function ye(ue,Ie,he,se,me,Ae){o(Ie);const be=Ie.getComponent();let Te=a(se),Ke=!1;const Ve=(_e,Be,et)=>_e?e.moveOp(_e.getPath(),Be.getPath()):e.insertOp(Be.getPath(),et.i);if(h(be)){const _e=be.d;_e!=null&&(ee[_e]=Ie.clone());const Be=_e!=null?Ot[_e]:null;let et=!1;if(be.i!==void 0||_e!=null&&Be){let Ye;Te&&(Te.i!==void 0||(Ye=Te.d)!=null&&!X[Ye])&&(et=Ye!=null?_e!=null&&_e===Oe[Ye]:n.default(Te.i,be.i),et||Ye!=null&&V!==1&&Oe[Ye]!=null||j==null&&(j={type:i.ConflictType.DROP_COLLISION,op1:Ve(_e!=null?W[_e]:null,Ie,be),op2:Ve(Ye!=null?te[Ye]:null,se,Te)})),et||(Ae?j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:Ve(_e!=null?W[_e]:null,Ie,be),op2:e.removeOp(Ae.getPath())}):(_e!=null?(vn[Vt]=_e,me.write("d",Be.p=Vt++)):me.write("i",r.default(be.i)),Ke=!0))}else if(_e!=null&&!Be){const Ye=ge[_e];Ye&&(Ae=Ye.clone())}_e!=null?(ue=W[_e],he=q[_e],se=re[_e]):be.i!==void 0&&(ue=he=null,et||(se=null))}else c(a(ue))&&(ue=he=se=null);const We=a(ue),nt=a(he);if(c(nt)){const _e=nt.p;nt.r!==void 0&&(!We||We.r===void 0)||X[_e]?(se=null,Ae=he.clone()):_e!=null&&(se=k[_e],V!==1&&Oe[_e]!=null||((me=Le[_e])||(me=Le[_e]=s.writeCursor()),me.reset(),Ae=null))}else!h(be)&&h(Te)&&(se=null);Te=se!=null?se.getComponent():null;const we=Y(be);if(we){const _e=O(be);if(Ae)j==null&&(j={type:i.ConflictType.RM_UNEXPECTED_CONTENT,op1:e.editOp(Ie.getPath(),we,_e,!0),op2:e.removeOp(Ae.getPath())});else{const Be=Y(Te);let et;if(Be){if(we!==Be)throw Error("Transforming incompatible types");const Ye=O(Te);et=we.transform(_e,Ye,G)}else et=r.default(_e);R(me,we,et)}}let ie=0,Se=0,Xe=0,it=0,Kt=0,wn=0,Nt=ue!=null&&ue.descendFirst(),Xr=Nt;const er=s.advancer(he,void 0,(_e,Be)=>{c(Be)&&Xe++});let Bt=se!=null&&se.descendFirst(),Ht=Bt;for(const _e of Ie)if(typeof _e=="number"){let Be;const et=h(Ie.getComponent()),Ye=_e-Se;{let un;for(;Nt&&typeof(un=ue.getKey())=="number";){un+=ie;const Lt=ue.getComponent(),tr=c(Lt);if(un>Ye||un===Ye&&(!tr||V===0&&et))break;if(tr){ie--;const bn=Lt.p;Oe.includes(bn),Lt.d,a(Le[Lt.d]),c(a(Le[Lt.d])),(Lt.r===void 0||Tt&&Tt.has(Lt))&&(bn==null||!Ot[bn]||V!==1&&Oe.includes(bn))||Kt--}Nt=ue.nextSibling()}Be=Nt&&un===Ye?ue:null}const Mt=Ye-ie;let Xt=er(Mt);const _a=Mt-Xe;let si=null;{let un,Lt;for(;Bt&&typeof(un=se.getKey())=="number";){Lt=un-it;const tr=se.getComponent(),bn=h(tr);if(Lt>_a)break;if(Lt===_a){if(!bn){si=se;break}{if(V===0&&et){si=se;break}const cn=Xt&&c(Xt.getComponent());if(V===0&&cn)break}}if(bn){const cn=tr.d;X[cn],Oe[cn],tr.i===void 0&&(X[cn]||Oe[cn]!=null&&V!==1)?(X[cn]||Oe[cn]!=null&&V===0)&&(it++,wn--):it++}Bt=se.nextSibling()}}const Ad=_a+it+Kt+wn;o(Ad>=0,"trying to descend to a negative index"),me.descend(Ad),et&&(Be=Xt=si=null,Se++),ye(Be,Ie,Xt,si,me,Ae)&&wn++,me.ascend()}else{let Be;for(;Nt&&(Be=ue.getKey(),typeof Be!="string"||!(Be>_e||Be===_e));)Nt=ue.nextSibling();const et=Nt&&Be===_e?ue:null,Ye=er(_e);let Mt;for(;Bt&&(Mt=se.getKey(),typeof Mt!="string"||!(Mt>_e||Mt===_e));)Bt=se.nextSibling();const Xt=Bt&&Mt===_e?se:null;me.descend(_e),ye(et,Ie,Ye,Xt,me,Ae),me.ascend()}return er.end(),Xr&&ue.ascend(),Ht&&se.ascend(),Ke})(rt,rt.clone(),Qe,Qe.clone(),je,null),j)return{ok:!1,conflict:j};je.reset();const vt=(ye,ue,Ie)=>ye.traverse(ue,(he,se)=>{he.d!=null&&Ie(he.d,ye,se)});(X.length||Fe.length)&&(vt(Qe,je,(ye,ue,Ie)=>{X[ye]&&!de[ye]&&Ie.write("r",!0),Fe[ye]&&Ie.mergeTree(Fe[ye].get())}),je.reset());const mt=[],zt=[];if((Le.length||X.length)&&!j){const ye=s.readCursor(L(je.get()));if(vt(ye,null,(ue,Ie)=>{mt[ue]=Ie.clone()}),Le.forEach(ue=>{ue&&vt(s.readCursor(ue.get()),null,(Ie,he)=>{mt[Ie]=he.clone()})}),(function ue(Ie,he,se,me,Ae,be){const Te=a(he);if(Te&&c(Te))if(Te.p!=null){const ie=Te.p;mt[ie].getPath(),se=mt[ie],me=zt[ie]=s.writeCursor()}else Te.r!==void 0&&(se=null);else h(a(se))&&(se=null);const Ke=Ie.getComponent();if(Ke){let ie;if((ie=Ke.d)!=null){const Se=Le[ie];Se&&(Se.get(),me.mergeTree(Se.get()),se=s.readCursor(Se.get()))}}let Ve=0,We=0;const nt=s.advancer(he,void 0,(ie,Se)=>{c(Se)&&Ve--}),we=s.advancer(se,(ie,Se)=>h(Se)?-(ie-We)-1:ie-We,(ie,Se)=>{h(Se)&&We++});for(const ie of Ie)if(typeof ie=="number"){const Se=nt(ie),Xe=ie+Ve,it=we(Xe),Kt=Xe+We;me.descend(Kt),ue(Ie,Se,it,me),me.ascend()}else me.descend(ie),ue(Ie,nt(ie),we(ie),me),me.ascend();nt.end(),we.end()})(Qe,ye,ye.clone(),je),je.reset(),j)return{ok:!1,conflict:j};if(je.get(),zt.length){const ue=zt.map(he=>he?he.get():null),Ie=s.readCursor(L(je.get()));if(vt(Ie,je,(he,se,me)=>{const Ae=ue[he];Ae&&(me.mergeTree(Ae),ue[he]=null)}),ue.find(he=>he)){const he=s.writeCursor(),se=s.writeCursor();let me=0,Ae=0;ue.forEach(be=>{be!=null&&vt(s.readCursor(be),null,Te=>{const Ke=vn[Te];he.writeMove(W[Ke].getPath(),ee[Ke].getPath(),me++);const Ve=$e[Ke];Ve&&Ve.forEach(We=>{X[We]||V!==1&&Oe[We]!=null||se.writeMove(te[We].getPath(),k[We].getPath(),Ae++)})})}),j={type:i.ConflictType.BLACKHOLE,op1:he.get(),op2:se.get()}}}}return j?{ok:!1,conflict:j}:{ok:!0,result:je.get()}}const F=S=>{const U=new Error("Transform detected write conflict");throw U.conflict=S,U.type=U.name="writeConflict",U};function Q(S,U,G){const V=D(S,U,G);if(V.ok)return V.result;F(V.conflict)}const z=S=>{const U=s.writeCursor();return s.readCursor(S).traverse(U,(G,V)=>{(h(G)||Y(G))&&V.write("r",!0)}),U.get()},le=(S,U)=>{const{type:G,op1:V,op2:j}=S;switch(G){case i.ConflictType.DROP_COLLISION:return U==="left"?[null,z(j)]:[z(V),null];case i.ConflictType.RM_UNEXPECTED_CONTENT:let W=!1;return s.readCursor(V).traverse(null,ee=>{ee.r!==void 0&&(W=!0)}),W?[null,z(j)]:[z(V),null];case i.ConflictType.BLACKHOLE:return[z(V),z(j)];default:throw Error("Unrecognised conflict: "+G)}};function ce(S,U,G,V){let j=null;for(;;){const W=D(U,G,V);if(W.ok)return v(j,W.result);{const{conflict:ee}=W;S(ee)||F(ee);const[te,k]=le(ee,V);U=v($(U),te),G=v($(G),k),j=v(j,k)}}}})(dr)),dr}var Ou;function k_(){return Ou||(Ou=1,(function(e){var t=pn&&pn.__createBinding||(Object.create?(function(i,o,a,l){l===void 0&&(l=a),Object.defineProperty(i,l,{enumerable:!0,get:function(){return o[a]}})}):(function(i,o,a,l){l===void 0&&(l=a),i[l]=o[a]})),n=pn&&pn.__exportStar||function(i,o){for(var a in i)a!=="default"&&!o.hasOwnProperty(a)&&t(o,i,a)};Object.defineProperty(e,"__esModule",{value:!0}),n(P_(),e);var r=gu();Object.defineProperty(e,"ReadCursor",{enumerable:!0,get:function(){return r.ReadCursor}}),Object.defineProperty(e,"WriteCursor",{enumerable:!0,get:function(){return r.WriteCursor}});var s=pu();Object.defineProperty(e,"ConflictType",{enumerable:!0,get:function(){return s.ConflictType}})})(pn)),pn}var at=k_();const F_=yd({__proto__:null,default:gt(at)},[at]);var Ce=(e=>(e[e.COVER=0]="COVER",e[e.REPLACE=1]="REPLACE",e))(Ce||{}),J=(e=>(e.RETAIN="r",e.INSERT="i",e.DELETE="d",e))(J||{});const fr=Re.createIdentifier("univer.config-service");class vu{constructor(){E(this,"_configChanged$",new oe.Subject);E(this,"configChanged$",this._configChanged$.asObservable());E(this,"_config",new Map)}dispose(){this._config.clear(),this._configChanged$.complete()}getConfig(t){return this._config.get(t)}setConfig(t,n,r){var o;const{merge:s=!1}=r||{};let i=(o=this._config.get(t))!=null?o:{};s?i=is(i,n):i=n,this._config.set(t,i),this._configChanged$.next({[t]:i})}deleteConfig(t){return this._config.delete(t)}subscribeConfigValue$(t){return new oe.Observable(n=>{Object.prototype.hasOwnProperty.call(this._config,t)&&n.next(this._config.get(t));const r=this.configChanged$.pipe(oe.filter(s=>Object.prototype.hasOwnProperty.call(s,t))).subscribe(s=>n.next(s[t]));return()=>r.unsubscribe()})}}const Dn=Re.createIdentifier("univer.context-service");class wu extends ze{constructor(){super(...arguments);E(this,"_contextChanged$",new oe.Subject);E(this,"contextChanged$",this._contextChanged$.asObservable());E(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete(),this._contextMap.clear()}getContextValue(n){var r;return(r=this._contextMap.get(n))!=null?r:!1}setContextValue(n,r){this._contextMap.set(n,r),this._contextChanged$.next({[n]:r})}subscribeContextValue$(n){return new oe.Observable(r=>{const s=this._contextChanged$.pipe(oe.filter(i=>typeof i[n]<"u")).subscribe(i=>r.next(i[n]));return this._contextMap.has(n)&&r.next(this._contextMap.get(n)),()=>s.unsubscribe()})}}var bu=(e=>(e[e.SILENT=0]="SILENT",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.VERBOSE=4]="VERBOSE",e))(bu||{});const Ct=Re.createIdentifier("univer.log");class Au extends ze{constructor(){super(...arguments);E(this,"_logLevel",3);E(this,"_deduction",new Set)}dispose(){super.dispose(),this._logLevel=3,this._deduction.clear()}debug(...n){this._logLevel>=4&&this._log(console.debug,...n)}log(...n){this._logLevel>=3&&this._log(console.log,...n)}warn(...n){this._logLevel>=2&&this._log(console.warn,...n)}error(...n){this._logLevel>=1&&this._log(console.error,...n)}deprecate(...n){this._logLevel>=2&&this._logWithDeduplication(console.error,...n)}setLogLevel(n){this._logLevel=n}_log(n,...r){const s=r[0];/^\[(.*?)\]/g.test(s)?n(`\x1B[97;104m${s}\x1B[0m`,...r.slice(1)):n(...r)}_logWithDeduplication(n,...r){const s=x_(...r);this._deduction.has(s)||(this._deduction.add(s),this._log(n,...r))}}function x_(...e){return e.map(t=>JSON.stringify(t)).join("")}var B_=Object.getOwnPropertyDescriptor,H_=(e,t,n,r)=>{for(var s=r>1?void 0:r?B_(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Pi=(e,t)=>(n,r)=>t(n,r,e);const gs="command.logExecution";var mr=(e=>(e[e.COMMAND=0]="COMMAND",e[e.OPERATION=1]="OPERATION",e[e.MUTATION=2]="MUTATION",e))(mr||{});const gr=Re.createIdentifier("univer.core.command-service");class $_{constructor(){E(this,"_commands",new Map);E(this,"_commandTypes",new Map)}registerCommand(t){if(this._commands.has(t.id))throw new Error(`[CommandRegistry]: command "${t.id}" has been registered before.`);return this._commands.set(t.id,t),this._commandTypes.set(t.id,t.type),He(()=>{this.unregisterCommand(t.id)})}unregisterCommand(t){this._commands.delete(t),this._commandTypes.delete(t)}hasCommand(t){return this._commands.has(t)}getCommand(t){return this._commands.has(t)?[this._commands.get(t)]:null}getCommandType(t){return this._commandTypes.get(t)}}const yu={id:"nil",type:0,handler:()=>!0};f.CommandService=class extends ze{constructor(n,r,s){super();E(this,"_commandRegistry");E(this,"_beforeCommandExecutionListeners",[]);E(this,"_commandExecutedListeners",[]);E(this,"_collabMutationListeners",[]);E(this,"_multiCommandDisposables",new Map);E(this,"_commandExecutingLevel",0);E(this,"_commandExecutionStack",[]);this._injector=n,this._logService=r,this._configService=s,this._commandRegistry=new $_,this.registerCommand(yu)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0,this._collabMutationListeners.length=0}hasCommand(n){return this._commandRegistry.hasCommand(n)}registerCommand(n){return this._commandRegistry.registerCommand(n)}unregisterCommand(n){var r;this._commandRegistry.unregisterCommand(n),(r=this._multiCommandDisposables.get(n))==null||r.dispose()}registerMultipleCommand(n){return this._registerMultiCommand(n)}beforeCommandExecuted(n){if(this._beforeCommandExecutionListeners.indexOf(n)===-1)return this._beforeCommandExecutionListeners.push(n),He(()=>{const r=this._beforeCommandExecutionListeners.indexOf(n);this._beforeCommandExecutionListeners.splice(r,1)});throw new Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(n){if(this._commandExecutedListeners.indexOf(n)===-1)return this._commandExecutedListeners.push(n),He(()=>{const r=this._commandExecutedListeners.indexOf(n);this._commandExecutedListeners.splice(r,1)});throw new Error("[CommandService]: could not add a listener twice.")}onMutationExecutedForCollab(n){if(this._collabMutationListeners.indexOf(n)===-1)return this._collabMutationListeners.push(n),He(()=>{const r=this._collabMutationListeners.indexOf(n);this._collabMutationListeners.splice(r,1)});throw new Error("[CommandService]: could not add a collab mutation listener twice.")}async executeCommand(n,r,s){try{const i=this._commandRegistry.getCommand(n);if(i){const[o]=i,a={id:o.id,type:o.type,params:r},l=this._pushCommandExecutionStack(a),u=s!=null?s:{};this._beforeCommandExecutionListeners.forEach(h=>h(a,u));const c=await this._execute(o,r,u);return u.syncOnly?o.type===2&&this._collabMutationListeners.forEach(h=>h(a,u)):(this._commandExecutedListeners.forEach(h=>h(a,u)),o.type===2&&this._collabMutationListeners.forEach(h=>h(a,u))),l.dispose(),c}throw new Error(`[CommandService]: command "${n}" is not registered.`)}catch(i){if(i instanceof Zr)return!1;throw i}}syncExecuteCommand(n,r,s){var i;try{const o=this._commandRegistry.getCommand(n);if(o){const[a]=o,l={id:a.id,type:a.type,params:r};if(a.type===2){const d=Pd(this._commandExecutionStack,m=>m.type===0);d&&(l.params=(i=l.params)!=null?i:{},l.params.trigger=d.id)}const u=this._pushCommandExecutionStack(l),c=s!=null?s:{};this._beforeCommandExecutionListeners.forEach(d=>d(l,c));const h=this._syncExecute(a,r,c);return c.syncOnly?a.type===2&&this._collabMutationListeners.forEach(d=>d(l,c)):(this._commandExecutedListeners.forEach(d=>d(l,c)),a.type===2&&this._collabMutationListeners.forEach(d=>d(l,c))),u.dispose(),h}throw new Error(`[CommandService]: command "${n}" is not registered.`)}catch(o){if(o instanceof Zr)return!1;throw o}}_pushCommandExecutionStack(n){return this._commandExecutionStack.push(n),He(()=>nr(this._commandExecutionStack,n))}_registerMultiCommand(n){const r=this._commandRegistry.getCommand(n.id);let s;if(r){if(r[0].multi!==!0)throw new Error("Command has registered as a single command.");s=r[0]}else{s=new j_(n.id);const o=new os;o.add(this._commandRegistry.registerCommand(s)),o.add(He(()=>{this._multiCommandDisposables.delete(n.id)})),this._multiCommandDisposables.set(n.id,o)}const i=s.registerImplementation(n);return He(()=>{var o;i.dispose(),s.hasImplementations()||(o=this._multiCommandDisposables.get(n.id))==null||o.dispose()})}async _execute(n,r,s){if(s!=null&&s.syncOnly)return!0;this._configService.getConfig(gs)!==!1&&this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${n.id}"`),this._commandExecutingLevel++;let i;try{i=await this._injector.invoke(n.handler,r,s),this._commandExecutingLevel--}catch(o){throw i=!1,this._commandExecutingLevel=0,o}return i}_syncExecute(n,r,s){if(s!=null&&s.syncOnly)return!0;this._configService.getConfig(gs)!==!1&&this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${n.id}".`),this._commandExecutingLevel++;let i;try{if(i=this._injector.invoke(n.handler,r,s),i instanceof Promise)throw new TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(o){throw i=!1,this._commandExecutingLevel=0,o}return i}},f.CommandService=H_([Pi(0,Re.Inject(Re.Injector)),Pi(1,Ct),Pi(2,fr)],f.CommandService);class j_{constructor(t){E(this,"name");E(this,"multi",!0);E(this,"type",0);E(this,"priority",0);E(this,"_implementations",[]);E(this,"handler",async(t,n)=>{if(!this._implementations.length)return!1;const r=t.get(Ct),s=t.get(Dn),i=t.get(Re.Injector);for(const o of this._implementations){const a=o.command.preconditions;if((!a||a&&a(s))&&(r.debug("[MultiCommand]",`executing implementation "${o.command.name}".`),await i.invoke(o.command.handler,n)))return!0}return!1});this.id=t,this.name=t}registerImplementation(t){const n={command:t};return this._implementations.push(n),this._implementations.sort((r,s)=>s.command.priority-r.command.priority),He(()=>{const r=this._implementations.indexOf(n);this._implementations.splice(r,1)})}hasImplementations(){return this._implementations.length>0}}function _s(e,t,n){const r=e.map(s=>()=>t.syncExecuteCommand(s.id,s.params,n));return gl(r)}function W_(e,t,n){const r=e.map(s=>()=>t.executeCommand(s.id,s.params,n));return ml(r)}function Tu(e){return new oe.Observable(t=>{const n=e((...r)=>t.next(r));return()=>n==null?void 0:n.dispose()})}function ki(e){return function(n){return new oe.Observable(r=>(n.subscribe({next:s=>{r.next(s),e(s)&&r.complete()},complete:()=>r.complete(),error:s=>r.error(s)}),()=>r.unsubscribe()))}}function Y_(e=0){return t=>{let n=[];return t.pipe(oe.tap(r=>n.push(r)),oe.debounceTime(e),oe.map(()=>n),oe.tap(()=>n=[]))}}function G_(e){const t=new oe.ReplaySubject(1);return setTimeout(()=>t.next(),e),t.pipe(oe.take(1))}function V_(e,t){const n=new oe.BehaviorSubject(t);return e.subscribe(n),n}const z_=e=>new Promise(t=>{oe.merge(Tu(e.onCommandExecuted.bind(e)).pipe(qr.filter(([n])=>n.type===mr.MUTATION)),oe.timer(300)).pipe(qr.debounceTime(16),qr.first()).subscribe(()=>{t()})});function Nu(e,t){let n=0,r=e.length-1;if(t<e[0])return 0;if(t>=e[e.length-1])return e.length-1;for(;n<=r;){if(e[n]===t){for(;n<e.length&&e[n]===t;)n++;return n}if(t>e[n]&&t<e[n+1])return n+1;if(e[r]===t){for(;r<e.length&&e[r]===t;)r++;return r}if(t>e[r-1]&&t<e[r])return r;n++,r--}return-1}function K_(e,t){let n=0,r=e.length-1;for(;n<=r;){const s=Math.floor((r+n)/2);if(t<e[s]&&(s===0||t>=e[s-1]))return s;if(t>=e[s])n=s+1;else if(t<e[s])r=s-1;else return-1}return-1}function Mu(e,t){let n=0,r=e.length;for(;n<r;){const s=Math.floor((n+r)/2);e[s]<=t?n=s+1:r=s}return n<e.length?n:e.length-1}function _r(e,t,n=!1){let r=e.length-1;if(t<0||t<e[0])return 0;if(e.length<40||t<=e[20]||t>=e[r-20]?r=Nu(e,t):r=Mu(e,t),n){const s=e[r];return e.indexOf(s)}return r}function X_(e){const t=new Blob([e],{type:"text/javascript"});return window.URL.createObjectURL(t)}const pr=2,Lu=1;function q_(e,t){if(t==null||e==null)return!0;const{left:n=0,top:r=0,height:s=0,width:i=0,angle:o=0}=t,{left:a=0,top:l=0,height:u=0,width:c=0,angle:h=0}=e,d=c,m=u,_=i,p=s;return Math.abs(a-n)>pr||Math.abs(l-r)>pr||Math.abs(d-_)>pr||Math.abs(m-p)>pr||Math.abs(h-o)>Lu}function ps(e,t,n){const{dataStream:r,textRuns:s=[]}=e;let i=t;const o=[];for(const a of s){const{st:l,ed:u}=a;Z.hasIntersectionBetweenTwoRanges(t,n,l,u)&&(l>i?(o.push(r.slice(i,l)),o.push(Fi(r,{...a,ed:Math.min(u,n)}))):o.push(Fi(r,{...a,st:i,ed:Math.min(u,n)}))),i=Math.max(t,Math.min(u,n))}return i!==n&&o.push(r.slice(i,n)),o.join("")}function J_(e,t=!0){var n;if(t&&((n=e.paragraphs)!=null&&n.length)){const{dataStream:r,paragraphs:s=[]}=e;let i="",o=-1;for(const a of s){const{startIndex:l,paragraphStyle:u={}}=a,{spaceAbove:c,spaceBelow:h,lineSpacing:d}=u,m=[];c!=null&&(typeof c=="number"?m.push(`margin-top: ${c}px`):m.push(`margin-top: ${c.v}px`)),h!=null&&(typeof h=="number"?m.push(`margin-bottom: ${h}px`):m.push(`margin-bottom: ${h.v}px`)),d!=null&&m.push(`line-height: ${d}`),l>o+1?i+=`<p class="UniverNormal" ${m.length?`style="${m.join("; ")};"`:""}>${ps(e,o+1,l)}</p>`:i+=`<p class="UniverNormal" ${m.length?`style="${m.join("; ")};"`:""}></p>`,o=l}return o!==r.length&&(i+=ps(e,o,r.length)),i}else return ps(e,0,e.dataStream.length)}function Fi(e,t){const{st:n,ed:r,ts:s={}}=t,{ff:i,fs:o,it:a,bl:l,ul:u,st:c,ol:h,bg:d,cl:m,va:_}=s;let p=e.slice(n,r);const I=[];return a===ae.TRUE&&(p=`<i>${p}</i>`),_===jt.SUPERSCRIPT?p=`<sup>${p}</sup>`:_===jt.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(u==null?void 0:u.s)===ae.TRUE&&(p=`<u>${p}</u>`),(c==null?void 0:c.s)===ae.TRUE&&(p=`<s>${p}</s>`),l===ae.TRUE&&(p=`<strong>${p}</strong>`),i&&I.push(`font-family: ${i}`),m&&I.push(`color: ${m.rgb}`),o&&I.push(`font-size: ${o}pt`),h&&I.push("text-decoration: overline"),d&&I.push(`background: ${d.rgb}`),I.length?`<span style="${I.join("; ")};">${p}</span>`:p}const Du={[hs.OFFICE]:{[ot.ACCENT1]:"#4472C4",[ot.ACCENT2]:"#ED7D31",[ot.ACCENT3]:"#A5A5A5",[ot.ACCENT4]:"#70AD47",[ot.ACCENT5]:"#5B9BD5",[ot.ACCENT6]:"#70AD47",[ot.DARK1]:"#000000",[ot.DARK2]:"#44546A",[ot.LIGHT1]:"#FFFFFF",[ot.LIGHT2]:"#E7E6E6",[ot.HYPERLINK]:"#0563C1",[ot.FOLLOWED_HYPERLINK]:"#954F72"}};class Es{constructor(){E(this,"_themeValue",ot.LIGHT1);E(this,"_themeColors");E(this,"_themeTint");E(this,"_rgbValue","");E(this,"_colorType");this._colorType=Et.UNSUPPORTED,this._themeColors=hs.OFFICE,this._themeTint=0}asRgbColor(){return new Cs(this._rgbValue,this)}asThemeColor(){return new Rs(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Et.THEME:return this.asThemeColor();case Et.RGB:return this.asRgbColor();case Et.UNSUPPORTED:throw new Error("unsupported color type")}}setRgbColor(t){return this._colorType=Et.RGB,this._rgbValue=t,this}setThemeColors(t){this._colorType=Et.THEME,this._themeColors=t}setThemeTint(t){this._colorType=Et.THEME,this._themeTint=t}setThemeColor(t){return this._colorType=Et.THEME,this._themeValue=t,this}getColorType(){return this._colorType}}class Cn{constructor(t){E(this,"_builder");this._builder=t}static rgbColorToHexValue(t){return`#${((1<<24)+(t.getRed()<<16)+(t.getGreen()<<8)+t.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(t){t?t.indexOf("#")>-1&&(t=t.substring(1)):t="#000000";const n=+`0x${t[0]}${t[1]}`,r=+`0x${t[2]}${t[3]}`,s=+`0x${t[4]}${t[5]}`;return new Es().setRgbColor(`rgb(${n},${r},${s})`).asRgbColor()}static hexToRgbString(t){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(n,(i,o,a,l)=>o+o+a+a+l+l);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);let s=null;if(r){const i=Number.parseInt(r[1],16),o=Number.parseInt(r[2],16),a=Number.parseInt(r[3],16);s=`rgba(${i},${o},${a})`}return s}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Cn(this._builder)}equals(t){return!1}}class Uu{constructor(t){E(this,"_saturation",0);E(this,"_hue",0);E(this,"_lightness",0);E(this,"_alpha",0);const n=t.getRed()/255,r=t.getGreen()/255,s=t.getBlue()/255,i=t.getAlpha()/255,o=Math.min(n,Math.min(r,s)),a=Math.max(n,Math.max(r,s)),l=a-o;if(a===o){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(o+a)/2,this._lightness<.5?this._saturation=l/(a+o):this._saturation=l/(2-a-o),n===a&&(this._hue=(r-s)/l),r===a&&(this._hue=2+(s-n)/l),s===a&&(this._hue=4+(n-r)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=i}asRgbColor(){const t=new Es;if(this._saturation===0)return t.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),t.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,s=this._hue/360,i=s+1/3,o=this.setColor(n,r,i),a=this.setColor(n,r,s),l=s-1/3,u=this.setColor(n,r,l);return t.setRgbColor(`rgba(${Math.round(o*255)},${Math.round(a*255)},${Math.round(u*255)},${this._alpha*255})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(t,n,r){r<0&&(r+=1),r>1&&(r-=1);let s;return 6*r<1?s=n+(t-n)*6*r:2*r<1?s=t:3*r<2?s=n+(t-n)*(2/3-r)*6:s=n,s}setLightness(t){this._lightness=t}}const St=class St extends Cn{constructor(n,r){super(r);E(this,"_cssString");E(this,"_red");E(this,"_green");E(this,"_blue");E(this,"_alpha");let s=n.match(St.RGBA_EXTRACT);if(s){const i=+s[1],o=+s[2],a=+s[3],l=+s[4];this._cssString=n,this._red=i,this._green=o,this._blue=a,this._alpha=l;return}if(s=n.match(St.RGB_EXTRACT),s){const i=+s[1],o=+s[2],a=+s[3];this._cssString=n,this._red=i,this._green=o,this._blue=a,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return Cn.rgbColorToHexValue(this)}getRed(){let n=this._red+St.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getGreen(){let n=this._green+St.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getBlue(){let n=this._blue+St.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getAlpha(){return this._alpha}getColorType(){return Et.RGB}clone(){return new St(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(n){return n instanceof St?n._red===this._red&&n._blue===this._blue&&n._green===this._green&&n._alpha===this._alpha:!1}getCssString(){return this._cssString}};E(St,"RGB_COLOR_AMT",0),E(St,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),E(St,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let Cs=St;const ln=class ln extends Cn{constructor(n,r,s,i){super(i);E(this,"_themeColorType");E(this,"_themeTint");E(this,"_themeColors");this._themeColorType=n,this._themeTint=r,this._themeColors=s}lumValue(n,r){if(n==null)return r;let s;return n<0?s=r*(1+n):s=r*(1-n)+(255-255*(1-n)),s}asRgbColor(){const n=Du[this._themeColors];if(n==null)throw new Error("not find themeColors type");const r=n[this._themeColorType];if(r==null)throw new Error("not find themeColors value");let s;if(ln._cacheThemeColor.has(this._themeColors)){if(s=ln._cacheThemeColor.get(this._themeColors),s.has(this._themeColorType))return s.get(this._themeColorType)}else s=new Map,ln._cacheThemeColor.set(this._themeColors,s);const i=new Uu(Cn.hexValueToRgbColor(r));i.setLightness(this.lumValue(this._themeTint,i.getLightness()*255)/255);const o=i.asRgbColor();return s.set(this._themeColorType,o),o}clone(){return new ln(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(n){return n instanceof ln?n._themeColorType===this._themeColorType:!1}getColorType(){return Et.THEME}getThemeColorType(){return this._themeColorType}};E(ln,"_cacheThemeColor",new Map);let Rs=ln;const Z_="rgb(",Q_="rgba(",xi={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkBlue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],darkYellow:[139,128,0],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};class Rt{constructor(t){E(this,"_color");E(this,"_rgbColor");E(this,"_isValid",!1);if(t==null){this._setNullColor();return}if(t instanceof Rt){this._color={...t._color},this._rgbColor={...t._rgbColor};return}const n=Pu(t);if(n==null){this._setNullColor();return}this._color=n;const r=sp(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(t,n,r){var u,c;r=Math.min(1,Math.max(0,r));const s=new Rt(t).toRgb(),i=new Rt(n).toRgb(),o=(u=s.a)!=null?u:1,a=(c=i.a)!=null?c:1,l={r:(i.r-s.r)*r+s.r,g:(i.g-s.g)*r+s.g,b:(i.b-s.b)*r+s.b,a:(a-o)*r+o};return new Rt(l)}static getContrastRatio(t,n){const r=new Rt(t).getLuminance(),s=new Rt(n).getLuminance();return(Math.max(r,s)+.05)/(Math.min(r,s)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:t,g:n,b:r,a:s=1}=this.toRgb(),i=s<1;return`rgb${i?"a":""}(${t},${n},${r}${i?`,${s}`:""})`}toString(){return this.toRgbString()}toHexString(t){const{r:n,g:r,b:s,a:i=1}=this.toRgb(),o=i<1,a=[Is(Math.round(n).toString(16)),Is(Math.round(r).toString(16)),Is(Math.round(s).toString(16)),Is(Math.round(i*255).toString(16))];return t&&a[0][0]===a[0][1]&&a[1][0]===a[1][1]&&a[2][0]===a[2][1]&&a[3][0]===a[3][1]?o?`#${a[0][0]}${a[1][0]}${a[2][0]}${a[3][0]}`:`#${a[0][0]}${a[1][0]}${a[2][0]}`:o?`#${a[0]}${a[1]}${a[2]}${a[3]}`:`#${a[0]}${a[1]}${a[2]}`}toHsv(){return lp(this.toRgb())}toHsl(){return ap(this.toRgb())}lighten(t=10){const n=this.toHsl();return n.l+=t,n.l=Math.min(Math.max(n.l,0),100),new Rt(n)}darken(t=10){const n=this.toHsl();return n.l-=t,n.l=Math.min(Math.max(n.l,0),100),new Rt(n)}setAlpha(t){return new Rt({...this._rgbColor,a:t})}getLuminance(){let{r:t,g:n,b:r}=this.toRgb();return t=Bi(t),n=Bi(n),r=Bi(r),Number((.2126*t+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:t,g:n,b:r}=this.toRgb();return(t*299+n*587+r*114)/1e3}getAlpha(){var t;return(t=this._color.a)!=null?t:1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}}const Is=e=>e.length===1?`0${e}`:e,Bi=e=>(e/=255,e<=.03928?e/12.92:((e+.055)/1.055)**2.4),Pu=e=>{if(cp(e)){if("r"in e){const r={r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)};return e.a!==void 0&&(r.a=e.a),r}if("l"in e){const r={h:Math.round(e.h),s:e.s,l:e.l};return e.a!==void 0&&(r.a=e.a),r}const n={h:Math.round(e.h),s:e.s,v:e.v};return e.a!==void 0&&(n.a=e.a),n}const t=e.trim();if(xi[t]){const n=xi[t],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(t.startsWith("#"))return ep(t);if(t.startsWith("rgb"))return tp(t);if(t.startsWith("hsl"))return np(t);if(t.startsWith("hsv"))return rp(t)},ep=e=>{const t=e.substring(1),n=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let r=t.match(n);if(!r||r.length<3)throw new Error(`The color '${e}' is illegal hex color`);r[0].length===1&&(r=r.map(i=>i+i));const s={r:Number.parseInt(r[0],16),g:Number.parseInt(r[1],16),b:Number.parseInt(r[2],16)};return r.length>3&&(s.a=Number.parseInt(r[3],16)/255),s},tp=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal rgb color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal rgb color`);const r={r:Number.parseInt(n[0],10),g:Number.parseInt(n[1],10),b:Number.parseInt(n[2],10)};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},np=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal hsl color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal hsl color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),l:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},rp=e=>{const t=e.indexOf("(");if(t===-1)throw new Error(`The color '${e}' is illegal hsv color`);const n=e.substring(t+1,e.length-1).split(",");if(n.length<3)throw new Error(`The color '${e}' is illegal hsv color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),v:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},sp=e=>{const t=Pu(e);if(t!=null)return"r"in t?t:"l"in t?ip(t):op(t)},Hi=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),ip=e=>{let{h:t,s:n,l:r}=e;t/=360,n/=100,r/=100;let s=0,i=0,o=0;if(n===0)s=i=o=r;else{const l=r<.5?r*(1+n):r+n-r*n,u=2*r-l;s=Hi(u,l,t+1/3),i=Hi(u,l,t),o=Hi(u,l,t-1/3)}const a={r:Math.round(s*255),g:Math.round(i*255),b:Math.round(o*255)};return e.a!==void 0&&(a.a=e.a),a},op=e=>{let{h:t,s:n,v:r}=e;t=t/360*6,n/=100,r/=100;const s=Math.floor(t),i=t-s,o=r*(1-n),a=r*(1-i*n),l=r*(1-(1-i)*n),u=s%6,c=[r,a,o,o,l,r][u],h=[l,r,r,a,o,o][u],d=[o,o,l,r,r,a][u],m={r:c*255,g:h*255,b:d*255};return e.a!==void 0&&(m.a=e.a),m},ap=e=>{let{r:t,g:n,b:r}=e;t/=255,n/=255,r/=255;const s=Math.max(t,n,r),i=Math.min(t,n,r),o=(s+i)/2;let a,l;if(s===i)a=l=0;else{const c=s-i;switch(l=o>.5?c/(2-s-i):c/(s+i),s){case t:a=(n-r)/c+(n<r?6:0);break;case n:a=(r-t)/c+2;break;default:a=(t-n)/c+4;break}a/=6}const u={h:Math.round(a*360),s:Math.round(l*100),l:Math.round(o*100)};return e.a!==void 0&&(u.a=e.a),u},lp=e=>{let{r:t,g:n,b:r}=e;t/=255,n/=255,r/=255;const s=Math.max(t,n,r),i=Math.min(t,n,r);let o;const a=s,l=s-i,u=s===0?0:l/s;if(s===i)o=0;else{switch(s){case t:o=(n-r)/l+(n<r?6:0);break;case n:o=(r-t)/l+2;break;default:o=(t-n)/l+4;break}o/=6}const c={h:Math.round(o*360),s:Math.round(u*100),v:Math.round(a*100)};return e.a!==void 0&&(c.a=e.a),c},up=e=>e==null,cp=e=>!up(e)&&typeof e=="object";function hp(e){const t=/^#(?:[0]{3}|[0]{6})\b/,n=/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/,r=/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/,i=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(t.test(e)||n.test(e)||r.test(e)||s.test(e)||i.test(e))}function dp(e){const t=/^#(?:[Ff]{3}|[Ff]{6})\b/,n=/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/,r=/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/,i=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(t.test(e)||n.test(e)||r.test(e)||s.test(e)||i.test(e))}function ku(e){return e&&(e.s!==void 0||e.p!==void 0||e.v!==void 0||e.t!==void 0||e.f!==void 0||e.si!==void 0||e.custom!==void 0)}function fp(e){if(e.t!==void 0)return e.t;if(typeof e.v=="string")return Zt.STRING;if(typeof e.v=="number")return Zt.NUMBER;if(typeof e.v=="boolean")return Zt.BOOLEAN}function mp(e){if(e==null)return!0;const{v:t,f:n,si:r,p:s,custom:i}=e;return!(!(t==null||typeof t=="string"&&t.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||s!=null||i!=null)}function Fu(e){return e!=null&&(typeof e=="string"||typeof e=="number"||typeof e=="boolean")}var pe=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e[e.ALL=3]="ALL",e))(pe||{}),Ne=(e=>(e[e.NONE=0]="NONE",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e[e.ALL=3]="ALL",e))(Ne||{});function gp(e){return[e.startRow,e.startColumn,e.endRow,e.endColumn]}var xu=(e=>(e.NONE="none",e.BACKWARD="backward",e.FORWARD="forward",e))(xu||{}),Bu=(e=>(e.RECT="RECT",e.TEXT="TEXT",e))(Bu||{});function _p(e,t,n){let r=!1,s=!1,i=e,o=t,a=e,l=t;if(n==null)return{actualRow:e,actualColumn:t,isMergedMainCell:s,isMerged:r,endRow:i,endColumn:o,startRow:a,startColumn:l};for(let u=0;u<n.length;u++){const{startRow:c,endRow:h,startColumn:d,endColumn:m}=n[u];if(e===c&&t===d){i=h,o=m,a=c,l=d,s=!0;break}if(e>=c&&e<=h&&t>=d&&t<=m){i=h,o=m,a=c,l=d,r=!0;break}}return{actualRow:e,actualColumn:t,isMergedMainCell:s,isMerged:r,endRow:i,endColumn:o,startRow:a,startColumn:l}}var Un=(e=>(e.Raw="raw",e.Intercepted="intercepted",e.Both="both",e))(Un||{});function pp(e,t){const n={};for(const r in e){const s=Number(r),i=e[s];for(const o in i){const a=Number(o),l=i[a],u=t(s,a,l);u!==void 0&&(n[s]?n[s][a]=u:n[s]={[a]:u})}}return n}function en(e){let t=0;const n=Object.keys(e);for(const r of n){const s=Number(r);t=Math.max(t,s)}return t+1}function Ep(e,t,n){const r=en(n),s=n;for(let i=r-1;i>=e;i--)s[i+1]=s[i];s[e]=t}function $i(e,t,n){const r=Object.keys(n).reduce((s,i)=>Math.max(s,Number.parseInt(i)),0)+1;for(let s=e;s<r;s++)s<e+t?delete n[s]:n[s]!==void 0&&(n[s-t]=n[s],delete n[s])}function Cp(e,t){const n=e,r=Object.keys(n),s=r.length,i=t,o=Object.keys(i),a=o.length,l={};let u=0;for(let c=0;c<s;c++,u++){const h=r[c];l[u]=n[h]}for(let c=0;c<a;c++,u++){const h=o[c];l[u]=i[h]}return l}function Rp(e,t,n){const r=n;if(en(n)>0){const i={};let o=0;for(let a=e;a<=t;a++)r[a]&&(i[o]=r[a],o++);return i}return{}}function ji(e,t,n,r){const s=e>n;if(!s&&e+t>n)throw new Error("Invalid move operation");s?Ip(e,t,n,r):Sp(e,t,n,r)}function Ip(e,t,n,r){const s=r,i=[];for(let o=e;o<e+t;o++)i.push(s[o]);for(let o=e-1;o>=n;o--){const a=s[o];s[o+t]=a,a===void 0&&delete s[o+t]}i.forEach((o,a)=>{s[n+a]=o,o===void 0&&delete s[n+a]})}function Sp(e,t,n,r){const s=r,i=[];for(let o=e;o<e+t;o++)i.push(s[o]);for(let o=e+t;o<n;o++){const a=s[o];s[o-t]=a,a===void 0&&delete s[o-t]}i.forEach((o,a)=>{s[n+a-t]=o,o===void 0&&delete s[n+a-t]})}class lt{constructor(t={}){E(this,"_matrix");this._setOriginValue(t)}static MakeObjectMatrixSize(t){return new lt({[t-1]:{}})}getMatrix(){return this._matrix}forEach(t){const n=this._matrix,r=Object.keys(n);for(const s of r){const i=Number(s),o=n[i];if(t(i,o)===!1)return this}return this}forRow(t){const n=this._matrix,r=Object.keys(n);for(const s of r){const i=Number(s),o=n[i];if(t(i,Object.keys(o).map(l=>Number(l)))===!1)return this}return this}forValue(t){const n=this._matrix;for(const r in n){const s=Number(r),i=n[s];if(i)for(const o in i){const a=Number(o),l=i[a];if(t(s,a,l)===!1)return this}}return this}swapRow(t,n){const r=this._matrix[t],s=this._matrix[n];this._matrix[t]=s,this._matrix[n]=r}getRow(t){return this._matrix[t]}getRowOrCreate(t){let n=this.getRow(t);return n==null&&(n={},this._matrix[t]=n),n}reset(){this._setOriginValue({})}hasValue(){const t=this._matrix,n=Object.keys(t);if(n.length===0)return!1;for(const r of n){const s=Number(r),i=t[s];if(Object.keys(i).length>0)return!0}return!1}getValue(t,n){var r,s;return(s=(r=this._matrix)==null?void 0:r[t])==null?void 0:s[n]}setValue(t,n,r){const s=this.getRowOrCreate(t);s[n]=r}deleteValue(t,n){var r,s;(s=(r=this._matrix)==null?void 0:r[t])==null||delete s[n]}realDeleteValue(t,n){var r,s,i;if((s=(r=this._matrix)==null?void 0:r[t])==null||delete s[n],this.getRow(t)){const o=this.getRow(t);if(o==null)return;Object.keys(o).length===0&&((i=this._matrix)==null||delete i[t])}}setRow(t,n){this._matrix[t]=n}moveRows(t,n,r){ji(t,n,r,this._matrix)}moveColumns(t,n,r){this.forEach((s,i)=>{ji(t,n,r,i)})}insertRows(t,n){const r=Object.keys(this._matrix);for(let s=r.length-1;s>=0;s--){const i=Number(r[s]);if(i>=t){const o=this._matrix[i];delete this._matrix[i],this._matrix[i+n]=o}}}insertColumns(t,n){const r=Object.keys(this._matrix);for(let s=0;s<r.length;s++){const i=Number(r[s]),o=this._matrix[i],a=Object.keys(o);for(let l=a.length-1;l>=0;l--){const u=Number(a[l]);if(u>=t){const c=o[u];delete o[u],o[u+n]=c}}}}removeRows(t,n){$i(t,n,this._matrix)}removeColumns(t,n){this.forEach((r,s)=>{s&&$i(t,n,s)})}getFragment(t,n,r,s){const i=new lt;let o=0;for(let a=t;a<=n;a++){const l={};let u=0;for(let c=r;c<=s;c++){const h=this.getValue(a,c);l[u]=h,u++}i.setRow(o,l),o++}return i}getSlice(t,n,r,s){const i=new lt;for(let o=t;o<=n;o++)for(let a=r;a<=s;a++){const l=this.getValue(o,a);l&&i.setValue(o,a,Z.deepClone(l))}return i}getSliceDataAndCellCountByRows(t,n){const r=new lt;let s=0;for(let i=t;i<=n;i++){const o=this.getRow(i);o&&(r.setRow(i,o),s+=Object.keys(o).length)}return{sliceData:r,cellCount:s}}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return en(this._matrix)}getRange(){const r=this.getLength()-1;let s=0;const i=this.getLength();for(let o=0;o<i;o++){const a=this.getRow(o);if(a){const l=en(a)-1;s=l>s?l:s}}return{startRow:0,startColumn:0,endRow:r,endColumn:s}}getRealRange(){const t=Object.keys(this._matrix),n=t.length,r=n>0?Number(t[0]):0,s=n>0?Number(t[n-1]):0;let i=-1/0,o=0;for(const a of t){const l=this.getRow(Number(a));if(l){const u=Object.keys(l);if(u.length>0){const c=Number(u[0]),h=Number(u[u.length-1]);(i===-1/0||c<i)&&(i=c),h>o&&(o=h)}}}return i===-1/0&&(i=0),{startRow:r,endRow:s,startColumn:i,endColumn:o}}getRealRowRange(){const t=Object.keys(this._matrix),n=t.length,r=n>0?Number(t[0]):0,s=n>0?Number(t[n-1]):0;return{startRow:r,endRow:s}}toNativeArray(){const t=new Array;return this.forValue((n,r,s)=>{t.push(s)}),t}toArray(){const t=[];return this.forRow((n,r)=>{t[n]==null&&(t[n]=[]),r.forEach(s=>{t[n][s]=this.getValue(n,s)})}),t}toFullArray(){const t=this.getRange(),{endColumn:n,endRow:r}=t,s=[];for(let i=0;i<=r;i++){const o=new Array(n+1).fill(void 0);s.push(o)}return this.forValue((i,o,a)=>{s[i][o]=a}),s}toJSON(){return this._matrix}clone(){const t=JSON.stringify(this._matrix);return JSON.parse(t)}getData(){const t=JSON.stringify(this._matrix);return JSON.parse(t)}getArrayData(){let t=0,n=0,r=!1,s=!1;const i=new lt;return this.forEach((o,a)=>{r||(r=!0,t=o),Object.keys(a).forEach(l=>{const u=Number(l);s?u<n&&(n=u):(s=!0,n=u);const c=this.getValue(o,u);i.setValue(o-t,u-n,c)})}),i.getData()}getStartEndScope(){let t=1/0,n=-1/0,r=1/0,s=-1/0;const i=Object.keys(this._matrix);i.length>0&&(t=+i[0],n=+i[i.length-1]);for(const o of i){const a=Object.keys(this._matrix[o]);a.length>0&&(r=Math.min(r,+a[0]),s=Math.max(s,+a[a.length-1]))}return{startRow:t,endRow:n,startColumn:r,endColumn:s}}getDataRange(){let t=0,n=0,r=0,s=-1,i=!1,o=!1;return this.forEach((a,l)=>{if(i||(i=!0,t=a),l==null)return;const u=en(l)-1;u>r&&(r=u),Object.keys(l).forEach(c=>{const h=Number(c);o?h<n&&(n=h):(o=!0,n=h)}),a>s&&(s=a)}),{startRow:t,startColumn:n,endRow:s,endColumn:r}}getDiscreteRanges(){const t=[];return this.forEach((n,r)=>{Object.keys(r).forEach(s=>{const i=Number(s);let o=!1;for(const a of t)if(n>=a.startRow&&n<=a.endRow+1&&i>=a.startColumn&&i<=a.endColumn+1){a.endRow=Math.max(n,a.endRow),a.endColumn=Math.max(i,a.endColumn),o=!0;break}o||t.push({startRow:n,endRow:n,startColumn:i,endColumn:i})})}),t}merge(t){this.forValue((n,r)=>{const s=t.getValue(n,r);s!=null&&this.setValue(n,r,s)})}concatRows(t){const n=t.getMatrix();for(const r in n){const s=Number(r);this.setRow(s,n[s])}}_setOriginValue(t={}){this._matrix=t}}function Hu(e){const{actualRow:t,actualColumn:n,isMerged:r,isMergedMainCell:s,mergeInfo:i}=e;let{startY:o,endY:a,startX:l,endX:u}=e,c=t,h=n,d=t,m=n;if(r&&i){const{startRow:_,startColumn:p,endRow:I,endColumn:A,startY:B,endY:x,startX:Y,endX:O}=i;c=_,h=p,d=I,m=A,o=B,a=x,l=Y,u=O}return s&&(o=i.startY,a=i.endY,l=i.startX,u=i.endX,d=i.endRow,m=i.endColumn),{startRow:c,startColumn:h,endRow:d,endColumn:m,startY:o,endY:a,startX:l,endX:u}}const Op=Hu;function vp(e){if(!e)return;const{actualRow:t,actualColumn:n,isMerged:r,isMergedMainCell:s,startRow:i,startColumn:o,endRow:a,endColumn:l}=e;let u=t,c=n,h=t,d=n;return(r||s)&&(u=i,c=o,h=a,d=l),{startRow:u,startColumn:c,endRow:h,endColumn:d}}function $u(e){var n;return!e||(((n=e==null?void 0:e.v)==null?void 0:n.toString())||"").length===0&&!e.p}function Wi(e){return $u(e)&&(e==null?void 0:e.coverable)!==!1}function Pt(e){if(e){if(e.rgb)return new Rt(e.rgb).toHexString();if(e.th)return new Es().setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function ju(e){return Z.isString(e)&&e.substring(0,1)==="="&&e.length>1}function wp(e){return Z.isString(e)&&e.length>0}function bp(e,t=!1){var i;let n="";const r=new Map([["ff",()=>{e.ff&&(n+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let o=e.fs;e.va&&(o/=2),n+=`font-size: ${o}pt; `}}],["it",()=>{e.it&&(n+="font-style: italic; ")}],["bl",()=>{e.bl&&(n+="font-weight: bold; ")}],["ul",()=>{var o;(o=e.ul)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} underline`):n+="text-decoration: underline; ",e.ul.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Pt(e.ul.cl)}; `),e.ul.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var o;(o=e.st)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} line-through`):n+="text-decoration-line: line-through; ",e.st.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Pt(e.st.cl)}; `),e.st.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var o;(o=e.ol)!=null&&o.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} overline`):n+="text-decoration-line: overline; ",e.ol.cl&&n.indexOf("text-decoration-color")===-1&&(n+=`text-decoration-color: ${Pt(e.ol.cl)}; `),e.ol.t&&n.indexOf("text-decoration-style")===-1&&(n+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{e.bg&&(n+=`background: ${Pt(e.bg)}; `)}],["bd",()=>{var o,a,l,u,c,h,d,m,_,p,I,A;(o=e.bd)!=null&&o.b&&(n+=`border-bottom: ${Ss((a=e.bd)==null?void 0:a.b.s)} ${(l=Pt(e.bd.b.cl))!=null?l:""}; `),(u=e.bd)!=null&&u.t&&(n+=`border-top: ${Ss((c=e.bd)==null?void 0:c.t.s)} ${(h=Pt(e.bd.t.cl))!=null?h:""}; `),(d=e.bd)!=null&&d.r&&(n+=`border-right: ${Ss((m=e.bd)==null?void 0:m.r.s)} ${(_=Pt(e.bd.r.cl))!=null?_:""}; `),(p=e.bd)!=null&&p.l&&(n+=`border-left: ${Ss((I=e.bd)==null?void 0:I.l.s)} ${(A=Pt(e.bd.l.cl))!=null?A:""}; `)}],["cl",()=>{e.cl&&(n+=`color: ${Pt(e.cl)}; `)}],["va",()=>{e.va===jt.SUBSCRIPT?n+="vertical-align: sub; ":e.va===jt.SUPERSCRIPT&&(n+="vertical-align: super; ")}],["td",()=>{e.td===cr.LEFT_TO_RIGHT?n+="direction: ltr; ":e.td===cr.RIGHT_TO_LEFT&&(n+="direction: rtl; ")}],["tr",()=>{var o,a,l;e.tr&&(n+=`--data-rotate: (${(o=e.tr)==null?void 0:o.a}deg${(a=e.tr)!=null&&a.v?` ,${(l=e.tr)==null?void 0:l.v}`:""});`)}],["ht",()=>{e.ht===wt.LEFT?n+="text-align: left; ":e.ht===wt.RIGHT?n+="text-align: right; ":e.ht===wt.CENTER?n+="text-align: center; ":e.ht===wt.JUSTIFIED&&(n+="text-align: justify; ")}],["vt",()=>{e.vt===mn.BOTTOM?n+="vertical-align: bottom; ":e.vt===mn.TOP?n+="vertical-align: top; ":e.vt===mn.MIDDLE&&(n+="vertical-align: middle; ")}],["tb",()=>{e.tb===gn.CLIP?n+="white-space: nowrap; overflow-x: hidden; ":e.tb===gn.WRAP&&(n+="white-space: normal;")}],["pd",()=>{var c,h,d,m,_,p,I,A;const o=`${(c=e.pd)==null?void 0:c.b}pt`,a=`${(h=e.pd)==null?void 0:h.t}pt`,l=`${(d=e.pd)==null?void 0:d.l}pt`,u=`${(m=e.pd)==null?void 0:m.r}pt`;(_=e.pd)!=null&&_.b&&(n+=`padding-bottom: ${o}; `),(p=e.pd)!=null&&p.t&&(n+=`padding-top: ${a}; `),(I=e.pd)!=null&&I.l&&(n+=`padding-left: ${l}; `),(A=e.pd)!=null&&A.r&&(n+=`padding-right: ${u}; `)}]]),s=["bd","tr","tb"];for(const o in e)t&&s.includes(o)||(i=r.get(o))==null||i();return n}function Ss(e){let t="";return e===Ue.NONE?t="none":e===Ue.THIN?t="0.5pt solid":e===Ue.HAIR?t="0.5pt double":e===Ue.DOTTED?t="0.5pt dotted":e===Ue.DASHED||e===Ue.DASH_DOT?t="0.5pt dashed":e===Ue.DASH_DOT_DOT?t="0.5pt dotted":e===Ue.DOUBLE?t="0.5pt double":e===Ue.MEDIUM?t="1pt solid":e===Ue.MEDIUM_DASHED||e===Ue.MEDIUM_DASH_DOT?t="1pt dashed":e===Ue.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===Ue.SLANT_DASH_DOT?t="0.5pt dashed":e===Ue.THICK&&(t="1.5pt solid"),t}function Ap(e){let t=0;if(e=e.trim(),e==="none")t=Ue.NONE;else if(e==="0.5pt solid")t=Ue.THIN;else if(e==="0.5pt double")t=Ue.HAIR;else if(e==="0.5pt dotted")t=Ue.DOTTED;else if(e==="0.5pt dashed")t=Ue.DASHED;else if(e==="1pt solid")t=Ue.MEDIUM;else if(e==="1pt dashed")t=Ue.MEDIUM_DASHED;else if(e==="1pt dotted")t=Ue.MEDIUM_DASH_DOT_DOT;else if(e==="1.5pt solid")t=Ue.THICK;else if(!e.includes("none"))t=Ue.THIN;else return Ue.NONE;return t}function yp(e,t){let n=e.body;if(t){const{headers:r,footers:s}=e;r!=null&&r[t]?n=r[t].body:s!=null&&s[t]&&(n=s[t].body)}return n}function Tp(e,t){const{startRow:n,endRow:r,startColumn:s,endColumn:i,rangeType:o}=e;if(n<0||s<0||r<0||i<0||!(Number.isNaN(n)&&Number.isNaN(r))&&o===pe.COLUMN||!(Number.isNaN(s)&&Number.isNaN(i))&&o===pe.ROW||o!==pe.ROW&&o!==pe.COLUMN&&(Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(i)||Number.isNaN(r)))return!1;if(t){const a=t.getRowCount(),l=t.getColumnCount();if(r>=a||i>=l)return!1}return!0}function Np(e,t){return{startRow:e,endRow:e,startColumn:t,endColumn:t}}function Yi(e){return ju(e)?{f:e,v:null,p:null}:Fu(e)?{v:e,p:null,f:null}:(ku(e),e)}function Mp(e,t){const n=new lt,{startRow:r,startColumn:s,endRow:i,endColumn:o}=t;if(Z.isArray(e))for(let a=0;a<=i-r;a++)for(let l=0;l<=o-s;l++)n.setValue(a+r,l+s,Yi(e[a][l]));else new lt(e).forValue((l,u,c)=>{n.setValue(l,u,Yi(c))});return n.getMatrix()}function Gi(e,t){return Object.prototype.toString.call(e)===Object.prototype.toString.call(t)?Object.prototype.toString.call(e)==="[object Object]"||Object.prototype.toString.call(e)==="[object Array]"?Object.keys(e).length!==Object.keys(t).length?!1:Object.keys(e).every(n=>Gi(e[n],t[n])):e===t:!1}function Wu(e,t){const n=e.ts||{},r=t.ts||{};return e.sId!==t.sId?!1:Gi(n,r)}function Lp(e,t){return t.some(n=>e.indexOf(n)>-1)}var Os={exports:{}},Dp=Os.exports,Yu;function Up(){return Yu||(Yu=1,(function(e,t){(function(n,r){e.exports=r()})(Dp,(function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",l="hour",u="day",c="week",h="month",d="quarter",m="year",_="date",p="Invalid Date",I=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,B={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(M){var y=["th","st","nd","rd"],w=M%100;return"["+M+(y[(w-20)%10]||y[w]||y[0])+"]"}},x=function(M,y,w){var N=String(M);return!N||N.length>=y?M:""+Array(y+1-N.length).join(w)+M},Y={s:x,z:function(M){var y=-M.utcOffset(),w=Math.abs(y),N=Math.floor(w/60),L=w%60;return(y<=0?"+":"-")+x(N,2,"0")+":"+x(L,2,"0")},m:function M(y,w){if(y.date()<w.date())return-M(w,y);var N=12*(w.year()-y.year())+(w.month()-y.month()),L=y.clone().add(N,h),D=w-L<0,F=y.clone().add(N+(D?-1:1),h);return+(-(N+(w-L)/(D?L-F:F-L))||0)},a:function(M){return M<0?Math.ceil(M)||0:Math.floor(M)},p:function(M){return{M:h,y:m,w:c,d:u,D:_,h:l,m:a,s:o,ms:i,Q:d}[M]||String(M||"").toLowerCase().replace(/s$/,"")},u:function(M){return M===void 0}},O="en",R={};R[O]=B;var b="$isDayjsObject",T=function(M){return M instanceof P||!(!M||!M[b])},H=function M(y,w,N){var L;if(!y)return O;if(typeof y=="string"){var D=y.toLowerCase();R[D]&&(L=D),w&&(R[D]=w,L=D);var F=y.split("-");if(!L&&F.length>1)return M(F[0])}else{var Q=y.name;R[Q]=y,L=Q}return!N&&L&&(O=L),L||!N&&O},$=function(M,y){if(T(M))return M.clone();var w=typeof y=="object"?y:{};return w.date=M,w.args=arguments,new P(w)},g=Y;g.l=H,g.i=T,g.w=function(M,y){return $(M,{locale:y.$L,utc:y.$u,x:y.$x,$offset:y.$offset})};var P=(function(){function M(w){this.$L=H(w.locale,null,!0),this.parse(w),this.$x=this.$x||w.x||{},this[b]=!0}var y=M.prototype;return y.parse=function(w){this.$d=(function(N){var L=N.date,D=N.utc;if(L===null)return new Date(NaN);if(g.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var F=L.match(I);if(F){var Q=F[2]-1||0,z=(F[7]||"0").substring(0,3);return D?new Date(Date.UTC(F[1],Q,F[3]||1,F[4]||0,F[5]||0,F[6]||0,z)):new Date(F[1],Q,F[3]||1,F[4]||0,F[5]||0,F[6]||0,z)}}return new Date(L)})(w),this.init()},y.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},y.$utils=function(){return g},y.isValid=function(){return this.$d.toString()!==p},y.isSame=function(w,N){var L=$(w);return this.startOf(N)<=L&&L<=this.endOf(N)},y.isAfter=function(w,N){return $(w)<this.startOf(N)},y.isBefore=function(w,N){return this.endOf(N)<$(w)},y.$g=function(w,N,L){return g.u(w)?this[N]:this.set(L,w)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(w,N){var L=this,D=!!g.u(N)||N,F=g.p(w),Q=function(j,W){var ee=g.w(L.$u?Date.UTC(L.$y,W,j):new Date(L.$y,W,j),L);return D?ee:ee.endOf(u)},z=function(j,W){return g.w(L.toDate()[j].apply(L.toDate("s"),(D?[0,0,0,0]:[23,59,59,999]).slice(W)),L)},le=this.$W,ce=this.$M,S=this.$D,U="set"+(this.$u?"UTC":"");switch(F){case m:return D?Q(1,0):Q(31,11);case h:return D?Q(1,ce):Q(0,ce+1);case c:var G=this.$locale().weekStart||0,V=(le<G?le+7:le)-G;return Q(D?S-V:S+(6-V),ce);case u:case _:return z(U+"Hours",0);case l:return z(U+"Minutes",1);case a:return z(U+"Seconds",2);case o:return z(U+"Milliseconds",3);default:return this.clone()}},y.endOf=function(w){return this.startOf(w,!1)},y.$set=function(w,N){var L,D=g.p(w),F="set"+(this.$u?"UTC":""),Q=(L={},L[u]=F+"Date",L[_]=F+"Date",L[h]=F+"Month",L[m]=F+"FullYear",L[l]=F+"Hours",L[a]=F+"Minutes",L[o]=F+"Seconds",L[i]=F+"Milliseconds",L)[D],z=D===u?this.$D+(N-this.$W):N;if(D===h||D===m){var le=this.clone().set(_,1);le.$d[Q](z),le.init(),this.$d=le.set(_,Math.min(this.$D,le.daysInMonth())).$d}else Q&&this.$d[Q](z);return this.init(),this},y.set=function(w,N){return this.clone().$set(w,N)},y.get=function(w){return this[g.p(w)]()},y.add=function(w,N){var L,D=this;w=Number(w);var F=g.p(N),Q=function(ce){var S=$(D);return g.w(S.date(S.date()+Math.round(ce*w)),D)};if(F===h)return this.set(h,this.$M+w);if(F===m)return this.set(m,this.$y+w);if(F===u)return Q(1);if(F===c)return Q(7);var z=(L={},L[a]=r,L[l]=s,L[o]=n,L)[F]||1,le=this.$d.getTime()+w*z;return g.w(le,this)},y.subtract=function(w,N){return this.add(-1*w,N)},y.format=function(w){var N=this,L=this.$locale();if(!this.isValid())return L.invalidDate||p;var D=w||"YYYY-MM-DDTHH:mm:ssZ",F=g.z(this),Q=this.$H,z=this.$m,le=this.$M,ce=L.weekdays,S=L.months,U=L.meridiem,G=function(W,ee,te,k){return W&&(W[ee]||W(N,D))||te[ee].slice(0,k)},V=function(W){return g.s(Q%12||12,W,"0")},j=U||function(W,ee,te){var k=W<12?"AM":"PM";return te?k.toLowerCase():k};return D.replace(A,(function(W,ee){return ee||(function(te){switch(te){case"YY":return String(N.$y).slice(-2);case"YYYY":return g.s(N.$y,4,"0");case"M":return le+1;case"MM":return g.s(le+1,2,"0");case"MMM":return G(L.monthsShort,le,S,3);case"MMMM":return G(S,le);case"D":return N.$D;case"DD":return g.s(N.$D,2,"0");case"d":return String(N.$W);case"dd":return G(L.weekdaysMin,N.$W,ce,2);case"ddd":return G(L.weekdaysShort,N.$W,ce,3);case"dddd":return ce[N.$W];case"H":return String(Q);case"HH":return g.s(Q,2,"0");case"h":return V(1);case"hh":return V(2);case"a":return j(Q,z,!0);case"A":return j(Q,z,!1);case"m":return String(z);case"mm":return g.s(z,2,"0");case"s":return String(N.$s);case"ss":return g.s(N.$s,2,"0");case"SSS":return g.s(N.$ms,3,"0");case"Z":return F}return null})(W)||F.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(w,N,L){var D,F=this,Q=g.p(N),z=$(w),le=(z.utcOffset()-this.utcOffset())*r,ce=this-z,S=function(){return g.m(F,z)};switch(Q){case m:D=S()/12;break;case h:D=S();break;case d:D=S()/3;break;case c:D=(ce-le)/6048e5;break;case u:D=(ce-le)/864e5;break;case l:D=ce/s;break;case a:D=ce/r;break;case o:D=ce/n;break;default:D=ce}return L?D:g.a(D)},y.daysInMonth=function(){return this.endOf(h).$D},y.$locale=function(){return R[this.$L]},y.locale=function(w,N){if(!w)return this.$L;var L=this.clone(),D=H(w,N,!0);return D&&(L.$L=D),L},y.clone=function(){return g.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},M})(),v=P.prototype;return $.prototype=v,[["$ms",i],["$s",o],["$m",a],["$H",l],["$W",u],["$M",h],["$y",m],["$D",_]].forEach((function(M){v[M[1]]=function(y){return this.$g(y,M[0],M[1])}})),$.extend=function(M,y){return M.$i||(M(y,P,$),M.$i=!0),$},$.locale=H,$.isDayjs=T,$.unix=function(M){return $(1e3*M)},$.en=R[O],$.Ls=R,$.p={},$}))})(Os)),Os.exports}var Pp=Up();const Wt=gt(Pp);var vs={exports:{}},kp=vs.exports,Gu;function Fp(){return Gu||(Gu=1,(function(e,t){(function(n,r){e.exports=r()})(kp,(function(){return function(n,r){var s=r.prototype,i=s.format;s.format=function(o){var a=this,l=this.$locale();if(!this.isValid())return i.bind(this)(o);var u=this.$utils(),c=(o||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(h){switch(h){case"Q":return Math.ceil((a.$M+1)/3);case"Do":return l.ordinal(a.$D);case"gggg":return a.weekYear();case"GGGG":return a.isoWeekYear();case"wo":return l.ordinal(a.week(),"W");case"w":case"ww":return u.s(a.week(),h==="w"?1:2,"0");case"W":case"WW":return u.s(a.isoWeek(),h==="W"?1:2,"0");case"k":case"kk":return u.s(String(a.$H===0?24:a.$H),h==="k"?1:2,"0");case"X":return Math.floor(a.$d.getTime()/1e3);case"x":return a.$d.getTime();case"z":return"["+a.offsetName()+"]";case"zzz":return"["+a.offsetName("long")+"]";default:return h}}));return i.bind(this)(c)}}}))})(vs)),vs.exports}var xp=Fp();const Bp=gt(xp);var ws={exports:{}},Hp=ws.exports,Vu;function $p(){return Vu||(Vu=1,(function(e,t){(function(n,r){e.exports=r()})(Hp,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,s=/\d/,i=/\d\d/,o=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,l={},u=function(I){return(I=+I)+(I>68?1900:2e3)},c=function(I){return function(A){this[I]=+A}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(I){(this.zone||(this.zone={})).offset=(function(A){if(!A||A==="Z")return 0;var B=A.match(/([+-]|\d\d)/g),x=60*B[1]+(+B[2]||0);return x===0?0:B[0]==="+"?-x:x})(I)}],d=function(I){var A=l[I];return A&&(A.indexOf?A:A.s.concat(A.f))},m=function(I,A){var B,x=l.meridiem;if(x){for(var Y=1;Y<=24;Y+=1)if(I.indexOf(x(Y,0,A))>-1){B=Y>12;break}}else B=I===(A?"pm":"PM");return B},_={A:[a,function(I){this.afternoon=m(I,!1)}],a:[a,function(I){this.afternoon=m(I,!0)}],Q:[s,function(I){this.month=3*(I-1)+1}],S:[s,function(I){this.milliseconds=100*+I}],SS:[i,function(I){this.milliseconds=10*+I}],SSS:[/\d{3}/,function(I){this.milliseconds=+I}],s:[o,c("seconds")],ss:[o,c("seconds")],m:[o,c("minutes")],mm:[o,c("minutes")],H:[o,c("hours")],h:[o,c("hours")],HH:[o,c("hours")],hh:[o,c("hours")],D:[o,c("day")],DD:[i,c("day")],Do:[a,function(I){var A=l.ordinal,B=I.match(/\d+/);if(this.day=B[0],A)for(var x=1;x<=31;x+=1)A(x).replace(/\[|\]/g,"")===I&&(this.day=x)}],w:[o,c("week")],ww:[i,c("week")],M:[o,c("month")],MM:[i,c("month")],MMM:[a,function(I){var A=d("months"),B=(d("monthsShort")||A.map((function(x){return x.slice(0,3)}))).indexOf(I)+1;if(B<1)throw new Error;this.month=B%12||B}],MMMM:[a,function(I){var A=d("months").indexOf(I)+1;if(A<1)throw new Error;this.month=A%12||A}],Y:[/[+-]?\d+/,c("year")],YY:[i,function(I){this.year=u(I)}],YYYY:[/\d{4}/,c("year")],Z:h,ZZ:h};function p(I){var A,B;A=I,B=l&&l.formats;for(var x=(I=A.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function($,g,P){var v=P&&P.toUpperCase();return g||B[P]||n[P]||B[v].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(M,y,w){return y||w.slice(1)}))}))).match(r),Y=x.length,O=0;O<Y;O+=1){var R=x[O],b=_[R],T=b&&b[0],H=b&&b[1];x[O]=H?{regex:T,parser:H}:R.replace(/^\[|\]$/g,"")}return function($){for(var g={},P=0,v=0;P<Y;P+=1){var M=x[P];if(typeof M=="string")v+=M.length;else{var y=M.regex,w=M.parser,N=$.slice(v),L=y.exec(N)[0];w.call(g,L),$=$.replace(L,"")}}return(function(D){var F=D.afternoon;if(F!==void 0){var Q=D.hours;F?Q<12&&(D.hours+=12):Q===12&&(D.hours=0),delete D.afternoon}})(g),g}}return function(I,A,B){B.p.customParseFormat=!0,I&&I.parseTwoDigitYear&&(u=I.parseTwoDigitYear);var x=A.prototype,Y=x.parse;x.parse=function(O){var R=O.date,b=O.utc,T=O.args;this.$u=b;var H=T[1];if(typeof H=="string"){var $=T[2]===!0,g=T[3]===!0,P=$||g,v=T[2];g&&(v=T[2]),l=this.$locale(),!$&&v&&(l=B.Ls[v]),this.$d=(function(N,L,D,F){try{if(["x","X"].indexOf(L)>-1)return new Date((L==="X"?1e3:1)*N);var Q=p(L)(N),z=Q.year,le=Q.month,ce=Q.day,S=Q.hours,U=Q.minutes,G=Q.seconds,V=Q.milliseconds,j=Q.zone,W=Q.week,ee=new Date,te=ce||(z||le?1:ee.getDate()),k=z||ee.getFullYear(),K=0;z&&!le||(K=le>0?le-1:ee.getMonth());var q,re=S||0,ge=U||0,Ee=G||0,X=V||0;return j?new Date(Date.UTC(k,K,te,re,ge,Ee,X+60*j.offset*1e3)):D?new Date(Date.UTC(k,K,te,re,ge,Ee,X)):(q=new Date(k,K,te,re,ge,Ee,X),W&&(q=F(q).week(W).toDate()),q)}catch{return new Date("")}})(R,H,b,B),this.init(),v&&v!==!0&&(this.$L=this.locale(v).$L),P&&R!=this.format(H)&&(this.$d=new Date("")),l={}}else if(H instanceof Array)for(var M=H.length,y=1;y<=M;y+=1){T[1]=H[y-1];var w=B.apply(this,T);if(w.isValid()){this.$d=w.$d,this.$L=w.$L,this.init();break}y===M&&(this.$d=new Date(""))}else Y.call(this,O)}}}))})(ws)),ws.exports}var jp=$p();const Wp=gt(jp);var bs={exports:{}},Yp=bs.exports,zu;function Gp(){return zu||(zu=1,(function(e,t){(function(n,r){e.exports=r()})(Yp,(function(){return function(n,r,s){var i=r.prototype,o=function(h){return h&&(h.indexOf?h:h.s)},a=function(h,d,m,_,p){var I=h.name?h:h.$locale(),A=o(I[d]),B=o(I[m]),x=A||B.map((function(O){return O.slice(0,_)}));if(!p)return x;var Y=I.weekStart;return x.map((function(O,R){return x[(R+(Y||0))%7]}))},l=function(){return s.Ls[s.locale()]},u=function(h,d){return h.formats[d]||(function(m){return m.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(_,p,I){return p||I.slice(1)}))})(h.formats[d.toUpperCase()])},c=function(){var h=this;return{months:function(d){return d?d.format("MMMM"):a(h,"months")},monthsShort:function(d){return d?d.format("MMM"):a(h,"monthsShort","months",3)},firstDayOfWeek:function(){return h.$locale().weekStart||0},weekdays:function(d){return d?d.format("dddd"):a(h,"weekdays")},weekdaysMin:function(d){return d?d.format("dd"):a(h,"weekdaysMin","weekdays",2)},weekdaysShort:function(d){return d?d.format("ddd"):a(h,"weekdaysShort","weekdays",3)},longDateFormat:function(d){return u(h.$locale(),d)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return c.bind(this)()},s.localeData=function(){var h=l();return{firstDayOfWeek:function(){return h.weekStart||0},weekdays:function(){return s.weekdays()},weekdaysShort:function(){return s.weekdaysShort()},weekdaysMin:function(){return s.weekdaysMin()},months:function(){return s.months()},monthsShort:function(){return s.monthsShort()},longDateFormat:function(d){return u(h,d)},meridiem:h.meridiem,ordinal:h.ordinal}},s.months=function(){return a(l(),"months")},s.monthsShort=function(){return a(l(),"monthsShort","months",3)},s.weekdays=function(h){return a(l(),"weekdays",null,null,h)},s.weekdaysShort=function(h){return a(l(),"weekdaysShort","weekdays",3,h)},s.weekdaysMin=function(h){return a(l(),"weekdaysMin","weekdays",2,h)}}}))})(bs)),bs.exports}var Vp=Gp();const zp=gt(Vp);var As={exports:{}},Kp=As.exports,Ku;function Xp(){return Ku||(Ku=1,(function(e,t){(function(n,r){e.exports=r()})(Kp,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(r,s,i){var o=s.prototype,a=o.format;i.en.formats=n,o.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var u=this.$locale().formats,c=(function(h,d){return h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(m,_,p){var I=p&&p.toUpperCase();return _||d[p]||n[p]||d[I].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(A,B,x){return B||x.slice(1)}))}))})(l,u===void 0?{}:u);return a.call(this,c)}}}))})(As)),As.exports}var qp=Xp();const Jp=gt(qp);var ys={exports:{}},Zp=ys.exports,Xu;function Qp(){return Xu||(Xu=1,(function(e,t){(function(n,r){e.exports=r()})(Zp,(function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(i,o,a){var l=o.prototype;a.utc=function(p){var I={date:p,utc:!0,args:arguments};return new o(I)},l.utc=function(p){var I=a(this.toDate(),{locale:this.$L,utc:!0});return p?I.add(this.utcOffset(),n):I},l.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var u=l.parse;l.parse=function(p){p.utc&&(this.$u=!0),this.$utils().u(p.$offset)||(this.$offset=p.$offset),u.call(this,p)};var c=l.init;l.init=function(){if(this.$u){var p=this.$d;this.$y=p.getUTCFullYear(),this.$M=p.getUTCMonth(),this.$D=p.getUTCDate(),this.$W=p.getUTCDay(),this.$H=p.getUTCHours(),this.$m=p.getUTCMinutes(),this.$s=p.getUTCSeconds(),this.$ms=p.getUTCMilliseconds()}else c.call(this)};var h=l.utcOffset;l.utcOffset=function(p,I){var A=this.$utils().u;if(A(p))return this.$u?0:A(this.$offset)?h.call(this):this.$offset;if(typeof p=="string"&&(p=(function(O){O===void 0&&(O="");var R=O.match(r);if(!R)return null;var b=(""+R[0]).match(s)||["-",0,0],T=b[0],H=60*+b[1]+ +b[2];return H===0?0:T==="+"?H:-H})(p),p===null))return this;var B=Math.abs(p)<=16?60*p:p;if(B===0)return this.utc(I);var x=this.clone();if(I)return x.$offset=B,x.$u=!1,x;var Y=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(x=this.local().add(B+Y,n)).$offset=B,x.$x.$localOffset=Y,x};var d=l.format;l.format=function(p){var I=p||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,I)},l.valueOf=function(){var p=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*p},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var m=l.toDate;l.toDate=function(p){return p==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var _=l.diff;l.diff=function(p,I,A){if(p&&this.$u===p.$u)return _.call(this,p,I,A);var B=this.local(),x=a(p).local();return _.call(B,x,I,A)}}}))})(ys)),ys.exports}var eE=Qp();const tE=gt(eE);var Ts={exports:{}},nE=Ts.exports,qu;function rE(){return qu||(qu=1,(function(e,t){(function(n,r){e.exports=r()})(nE,(function(){return function(n,r){r.prototype.weekday=function(s){var i=this.$locale().weekStart||0,o=this.$W,a=(o<i?o+7:o)-i;return this.$utils().u(s)?a:this.subtract(a,"day").add(s,"day")}}}))})(Ts)),Ts.exports}var sE=rE();const iE=gt(sE);var Ns={exports:{}},oE=Ns.exports,Ju;function aE(){return Ju||(Ju=1,(function(e,t){(function(n,r){e.exports=r()})(oE,(function(){var n="week",r="year";return function(s,i,o){var a=i.prototype;a.week=function(l){if(l===void 0&&(l=null),l!==null)return this.add(7*(l-this.week()),"day");var u=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var c=o(this).startOf(r).add(1,r).date(u),h=o(this).endOf(n);if(c.isBefore(h))return 1}var d=o(this).startOf(r).date(u).startOf(n).subtract(1,"millisecond"),m=this.diff(d,n,!0);return m<0?o(this).startOf("week").week():Math.ceil(m)},a.weeks=function(l){return l===void 0&&(l=null),this.week(l)}}}))})(Ns)),Ns.exports}var lE=aE();const uE=gt(lE);var Ms={exports:{}},cE=Ms.exports,Zu;function hE(){return Zu||(Zu=1,(function(e,t){(function(n,r){e.exports=r()})(cE,(function(){return function(n,r){r.prototype.weekYear=function(){var s=this.month(),i=this.week(),o=this.year();return i===1&&s===11?o+1:s===0&&i>=52?o-1:o}}}))})(Ms)),Ms.exports}var dE=hE();const fE=gt(dE);Wt.extend(Wp),Wt.extend(Bp),Wt.extend(iE),Wt.extend(zp),Wt.extend(uE),Wt.extend(fE),Wt.extend(tE),Wt.extend(Jp);function Ls(e,t,n,r){if(e>t)throw new Error("a1 should be less than a2");if(n>r)throw new Error("b1 should be less than b2");if(t<n||r<e)return[e,t];if(n<=e&&r>=t)return[];const s=r-n+1;return e<n&&t>r?[e,t-s]:n<=e&&r<t?[r+1-s,t-s]:n>e&&r>=t?[e,n-1]:[e,t]}function mE(e){if(e==null)return!1;const t=e.bullet;return(t==null?void 0:t.listId)!=null}function gE(e){if(e==null)return!1;const t=e.paragraphStyle;return Qu(t)}function Qu(e){var t;return!(e==null||(e.indentStart==null||e.indentStart.v===0)&&e.hanging==null||((t=e.hanging)==null?void 0:t.v)===0)}function ec(e,t,n){return e.slice(0,t)+n+e.slice(t)}function tc(e,t,n){return t>n?e:e.slice(0,t)+e.slice(n)}function _E(e){if(e==null||typeof e=="boolean")return!1;if(typeof e=="number")return!isNaN(e);if(typeof e=="string"){const t=e.trim();return t===""?!1:!isNaN(Number(t))}return!1}function pE(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return t>>>0}function EE(...e){let t;return e.length===1&&Array.isArray(e[0])?t=e[0]:t=e,is({},...t)}const De=Symbol("newer"),Je=Symbol("older");class CE{constructor(t){E(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[De],{done:!1,value:t.key}):{done:!0,value:void 0}}}class RE{constructor(t){E(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[De],{done:!1,value:t.value}):{done:!0,value:void 0}}}class IE{constructor(t){E(this,"entry");this.entry=t}[Symbol.iterator](){return this}next(){const t=this.entry;return t?(this.entry=t[De],{done:!1,value:[t.key,t.value]}):{done:!0,value:void 0}}}bd=De,wd=Je;class nc{constructor(t,n){E(this,"key");E(this,"value");E(this,bd);E(this,wd);this.key=t,this.value=n,this[De]=void 0,this[Je]=void 0}toJSON(){return{key:this.key,value:this.value}}}class Er{constructor(...t){E(this,"_keymap");E(this,"size",0);E(this,"limit");E(this,"oldest");E(this,"newest");E(this,"_onShiftListeners",[]);if(Cr.hasLength(t,1)){if(Cr.isNumber(t[0])){const n=t[0];this._initialize(n,void 0);return}if(Cr.isIterable(t[0])){const n=t[0];this._initialize(0,n);return}return}if(Cr.hasLength(t,2)){const n=t[0],r=t[1];this._initialize(n,r)}}onShift(t){if(this._onShiftListeners.indexOf(t)===-1)return this._onShiftListeners.push(t),He(()=>nr(this._onShiftListeners,t));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(t,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=t,this._keymap=new Map,n&&(this.assign(n),t<1&&(this.limit=this.size))}_markEntryAsUsed(t){t!==this.newest&&(t[De]&&(t===this.oldest&&(this.oldest=t[De]),t[De][Je]=t[Je]),t[Je]&&(t[Je][De]=t[De]),t[De]=void 0,t[Je]=this.newest,this.newest&&(this.newest[De]=t),this.newest=t)}assign(t){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const s=t[Symbol.iterator]();for(let i=s.next();!i.done;i=s.next()){const o=new nc(i.value[0],i.value[1]);if(this._keymap.set(o.key,o),n?(n[De]=o,o[Je]=n):this.oldest=o,n=o,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(t,n){let r=this._keymap.get(t);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(t,r=new nc(t,n)),this.newest?(this.newest[De]=r,r[Je]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const t=this.oldest;if(t)return this.oldest&&this.oldest[De]?(this.oldest=this.oldest[De],this.oldest[Je]=void 0):(this.oldest=void 0,this.newest=void 0),t[De]=t[Je]=void 0,this._keymap.delete(t.key),--this.size,this._onShiftListeners.forEach(n=>n(t)),[t.key,t.value]}get(t){const n=this._keymap.get(t);if(n)return this._markEntryAsUsed(n),n.value}has(t){return this._keymap.has(t)}find(t){const n=this._keymap.get(t);return n?n.value:void 0}delete(t){const n=this._keymap.get(t);if(n)return this._keymap.delete(n.key),n[De]&&n[Je]?(n[Je][De]=n[De],n[De][Je]=n[Je]):n[De]?(n[De][Je]=void 0,this.oldest=n[De]):n[Je]?(n[Je][De]=void 0,this.newest=n[Je]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new CE(this.oldest)}values(){return new RE(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new IE(this.oldest)}forEach(t,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)t.call(n,r.value,r.key,this),r=r[De]}toJSON(){const t=new Array(this.size);let n=0,r=this.oldest;for(;r;)t[n++]={key:r.key,value:r.value},r=r[De];return t}toString(){let t="",n=this.oldest;for(;n;)t+=`${String(n.key)}:${n.value}`,n=n[De],n&&(t+=" < ");return t}}class Cr{static hasLength(t,n){return t.length===n}static getValueType(t){return Object.prototype.toString.apply(t)}static isObject(t){return this.getValueType(t)==="[object Object]"}static isIterable(t){return t[Symbol.iterator]!=null}static isNumber(t){return this.getValueType(t)==="[object Number]"}}const Rr=2,Ir=2**2,Ds=2**3,Sr=2**4,Or=2**5,vr=2**6,Vi=2**7,zi=2**8,Ki=2**9,SE=0,OE=2958466,vE=-694324,wE=35830291,bE=-1,rc=1,Pn=6,Xi="general",qi="hash",kn="zero",Ji="qmark",Zi="slash",wr="group",Us="scale",Qi="comma",eo="break",Ps="text",to="plus",no="minus",ks="point",ro="space",so="percent",Fs="digit",io="calendar",br="error",oo="datetime",ao="duration",lo="condition",uo="dbnum",co="natnum",ho="locale",fo="color",sc="modifier",mo="ampm",go="escaped",_o="string",po="skip",Eo="exp",Co="fill",Ro="paren",xs="char",AE=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],Io=["¤","$","£","¥","֏","؋","৳","฿","៛","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"],So=new RegExp("["+Io.join("")+"]"),Oo=Object.freeze({1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"}),ic=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,Fn={},C=(e,t="")=>e.replace(/~/g,t).split(";"),Pe=(e,t=0,n=0)=>(e.mmm||(e.mmm=t<1?e.mmmm.concat():e.mmmm.map(r=>{const s=r.slice(0,t%10);return s+(t<10||r===s?"":".")})),e.ddd||(e.ddd=n<1?e.dddd.concat():e.dddd.map(r=>{const s=r.slice(0,n%10);return s+(n<10||r===s?"":".")})),!e.mmm6&&e.mmmm6&&(e.mmm6=e.mmmm6),e),yE={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:C("AM;PM"),mmmm6:C("Muharram;Safar;Rabiʻ I;Rabiʻ II;Jumada I;Jumada II;Rajab;Shaʻban;Ramadan;Shawwal;Dhuʻl-Qiʻdah;Dhuʻl-Hijjah"),mmm6:C("Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhuʻl-Q.;Dhuʻl-H."),mmmm:C("January;February;March;April;May;June;July;August;September;October;November;December"),mmm:C("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec"),dddd:C("Sunday;Monday;Tuesday;Wednesday;Thursday;Friday;Saturday"),ddd:C("Sun;Mon;Tue;Wed;Thu;Fri;Sat"),bool:C("TRUE;FALSE"),preferMDY:!1};function vo(e){const t=ic.exec(e);if(!t)throw new SyntaxError(`Malformed locale: ${e}`);return{lang:t[1]+(t[2]?"_"+t[2]:""),language:t[1],territory:t[2]||""}}function wo(e){if(typeof e=="number")return Oo[e&65535]||null;const t=parseInt(e,16);return isFinite(t)&&Oo[t&65535]?Oo[t&65535]||null:ic.test(e)?e:null}function xn(e){const t=wo(e);let n=null;if(t){const r=vo(t);n=Fn[r.lang]||Fn[r.language]||null}return n}function bo(e){return Object.assign({},yE,e)}function ne(e,t){const n=typeof t=="object"?t:vo(t);return Fn[n.lang]=bo(e),n.language!==n.lang&&!Fn[n.language]&&(Fn[n.language]=bo(e)),Fn[n.lang]}const tn=bo({group:",",preferMDY:!0});tn.isDefault=!0,ne({group:",",ampm:C("上午;下午"),mmmm:C("一月;二月;三月;四月;五月;六月;七月;八月;九月;十月;十一月;十二月"),mmm:C("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),dddd:C("~日;~一;~二;~三;~四;~五;~六","星期"),ddd:C("周日;周一;周二;周三;周四;周五;周六")},"zh_CN");const Ao={group:",",ampm:C("上午;下午"),mmmm:C("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),mmm:C("1月;2月;3月;4月;5月;6月;7月;8月;9月;10月;11月;12月"),dddd:C("~日;~一;~二;~三;~四;~五;~六","星期"),ddd:C("周日;周一;周二;周三;周四;周五;周六")};ne({...Ao,nan:"非數值",dddd:C("~日;~一;~二;~三;~四;~五;~六","星期")},"zh_TW"),ne({...Ao,dddd:C("~日;~一;~二;~三;~四;~五;~六","星期")},"zh_HK"),ne({...Ao,ampm:C("午前;午後"),dddd:C("日~;月~;火~;水~;木~;金~;土~","曜日"),ddd:C("日;月;火;水;木;金;土")},"ja"),ne({group:",",ampm:C("오전;오후"),mmmm:C("1월;2월;3월;4월;5월;6월;7월;8월;9월;10월;11월;12월"),mmm:C("1월;2월;3월;4월;5월;6월;7월;8월;9월;10월;11월;12월"),dddd:C("일요일;월요일;화요일;수요일;목요일;금요일;토요일"),ddd:C("일;월;화;수;목;금;토")},"ko"),ne({group:",",ampm:C("ก่อนเที่ยง;หลังเที่ยง"),mmmm:C("มกร~;กุมภาพันธ์;มีน~;เมษายน;พฤษภ~;มิถุนายน;กรกฎ~;สิงห~;กันยายน;ตุล~;พฤศจิกายน;ธันว~","าคม"),mmm:C("ม.ค.;ก.พ.;มี.ค.;เม.ย.;พ.ค.;มิ.ย.;ก.ค.;ส.ค.;ก.ย.;ต.ค.;พ.ย.;ธ.ค."),dddd:C("วันอาทิตย์;วันจันทร์;วันอังคาร;วันพุธ;วันพฤหัสบดี;วันศุกร์;วันเสาร์"),ddd:C("อา.;จ.;อ.;พ.;พฤ.;ศ.;ส.")},"th"),ne(Pe({decimal:",",ampm:C("dop.;odp."),mmmm:C("ledna;února;března;dubna;května;června;července;srpna;září;října;listopadu;prosince"),mmm:C("I;II;III;IV;V;VI;VII;VIII;IX;X;XI;XII"),dddd:C("neděle;pondělí;úterý;středa;čtvrtek;pátek;sobota"),bool:C("PRAVDA;NEPRAVDA")},-1,2),"cs"),ne(Pe({group:".",decimal:",",mmmm:C("januar;februar;marts;april;maj;juni;juli;august;september;oktober;november;december"),dddd:C("søn~;man~;tirs~;ons~;tors~;fre~;lør~","dag"),bool:C("SAND;FALSK")},13,13),"da"),ne(Pe({group:".",decimal:",",ampm:C("a.m.;p.m."),mmmm:C("januari;februari;maart;april;mei;juni;juli;augustus;september;oktober;november;december"),mmm:C("jan.;feb.;mrt.;apr.;mei;jun.;jul.;aug.;sep.;okt.;nov.;dec."),dddd:C("zondag;maandag;dinsdag;woensdag;donderdag;vrijdag;zaterdag"),bool:C("WAAR;ONWAAR")},-1,2),"nl"),ne({group:",",preferMDY:!0},"en"),ne({group:",",preferMDY:!0},"en_US"),ne({group:","},"en_AU"),ne({group:","},"en_CA"),ne({group:","},"en_GB"),ne({group:",",mmm:C("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sept;Oct;Nov;Dec")},"en_IE"),ne(Pe({decimal:",",nan:"epäluku",ampm:C("ap.;ip."),mmmm:C("tammi~;helmi~;maalis~;huhti~;touko~;kesä~;heinä~;elo~;syys~;loka~;marras~;joulu~","kuuta"),mmm:C("tammik.;helmik.;maalisk.;huhtik.;toukok.;kesäk.;heinäk.;elok.;syysk.;lokak.;marrask.;jouluk."),dddd:C("sunnun~;maanan~;tiis~;keskiviikkona;tors~;perjan~;lauan~","taina"),bool:C("TOSI;EPÄTOSI")},-1,2),"fi");const yo=Pe({group:" ",decimal:",",mmmm:C("janvier;février;mars;avril;mai;juin;juillet;août;septembre;octobre;novembre;décembre"),mmm:C("janv.;févr.;mars;avr.;mai;juin;juil.;août;sept.;oct.;nov.;déc."),dddd:C("~manche;lun~;mar~;mercre~;jeu~;vendre~;same~","di"),bool:C("VRAI;FAUX")},-1,13);ne({...yo},"fr"),ne({...yo,mmm:C("janv.;févr.;mars;avr.;mai;juin;juill.;août;sept.;oct.;nov.;déc.")},"fr_CA"),ne({group:"'",decimal:".",...yo},"fr_CH");const oc=Pe({mmmm:C("Januar;Februar;März;April;Mai;Juni;Juli;August;September;Oktober;November;Dezember"),mmm:C("Jan.;Feb.;März;Apr.;Mai;Juni;Juli;Aug.;Sept.;Okt.;Nov.;Dez."),dddd:C("Sonn~;Mon~;Diens~;Mittwoch;Donners~;Frei~;Sams~","tag"),bool:C("WAHR;FALSCH")},-1,12);ne({group:".",decimal:",",...oc},"de"),ne({group:"'",decimal:".",...oc},"de_CH"),ne(Pe({group:".",decimal:",",ampm:C("π.μ.;μ.μ."),mmmm:C("Ιανουαρ~;Φεβρουαρ~;Μαρτ~;Απριλ~;Μαΐου;Ιουν~;Ιουλ~;Αυγούστου;Σεπτεμβρ~;Οκτωβρ~;Νοεμβρ~;Δεκεμβρ~","ίου"),mmm:C("Ιαν;Φεβ;Μαρ;Απρ;Μαΐ;Ιουν;Ιουλ;Αυγ;Σεπ;Οκτ;Νοε;Δεκ"),dddd:C("Κυριακή;Δευτέρα;Τρίτη;Τετάρτη;Πέμπτη;Παρασκευή;Σάββατο")},-1,3),"el"),ne({decimal:",",ampm:C("de.;du."),mmmm:C("január;február;március;április;május;június;július;augusztus;szeptember;október;november;december"),mmm:C("jan.;febr.;márc.;ápr.;máj.;jún.;júl.;aug.;szept.;okt.;nov.;dec."),dddd:C("vasárnap;hétfő;kedd;szerda;csütörtök;péntek;szombat"),ddd:C("V;H;K;Sze;Cs;P;Szo"),bool:C("IGAZ;HAMIS")},"hu"),ne(Pe({group:".",decimal:",",ampm:C("f.h.;e.h."),mmmm:C("janúar;febrúar;mars;apríl;maí;júní;júlí;ágúst;september;október;nóvember;desember"),dddd:C("sunnu~;mánu~;þriðju~;miðviku~;fimmtu~;föstu~;laugar~","dagur")},13,13),"is"),ne(Pe({group:".",decimal:",",mmmm:C("Januari;Februari;Maret;April;Mei;Juni;Juli;Agustus;September;Oktober;November;Desember"),dddd:C("Minggu;Senin;Selasa;Rabu;Kamis;Jumat;Sabtu")},3,3),"id");const ac=Pe({mmmm:C("gennaio;febbraio;marzo;aprile;maggio;giugno;luglio;agosto;settembre;ottobre;novembre;dicembre"),dddd:C("domenica;lunedì;martedì;mercoledì;giovedì;venerdì;sabato"),bool:C("VERO;FALSO")},3,3);ne({group:".",decimal:",",...ac},"it"),ne({group:"'",decimal:".",...ac},"it_CH");const lc={decimal:",",ampm:C("a.m.;p.m."),mmmm:C("januar;februar;mars;april;mai;juni;juli;august;september;oktober;november;desember"),mmm:C("jan.;feb.;mar.;apr.;mai;jun.;jul.;aug.;sep.;okt.;nov.;des."),dddd:C("søn~;man~;tirs~;ons~;tors~;fre~;lør~","dag"),bool:C("SANN;USANN")};ne(Pe({...lc},-1,13),"nb"),ne(Pe({...lc},-1,13),"no"),ne(Pe({decimal:",",mmmm:C("stycznia;lutego;marca;kwietnia;maja;czerwca;lipca;sierpnia;września;października;listopada;grudnia"),dddd:C("niedziela;poniedziałek;wtorek;środa;czwartek;piątek;sobota"),ddd:C("niedz.;pon.;wt.;śr.;czw.;pt.;sob."),bool:C("PRAWDA;FAŁSZ")},3,-1),"pl");const uc={group:".",decimal:",",mmmm:C("janeiro;fevereiro;março;abril;maio;junho;julho;agosto;setembro;outubro;novembro;dezembro"),dddd:C("domingo;segunda-feira;terça-feira;quarta-feira;quinta-feira;sexta-feira;sábado"),bool:C("VERDADEIRO;FALSO")};ne(Pe(uc,13,13),"pt"),ne(Pe(uc,13,13),"pt_BR"),ne({decimal:",",nan:"не число",mmmm:C("января;февраля;марта;апреля;мая;июня;июля;августа;сентября;октября;ноября;декабря"),mmm:C("янв.;февр.;мар.;апр.;мая;июн.;июл.;авг.;сент.;окт.;нояб.;дек."),dddd:C("воскресенье;понедельник;вторник;среда;четверг;пятница;суббота"),ddd:C("вс;пн;вт;ср;чт;пт;сб"),mmmm6:C("рамадан;шавваль;зуль-каада;зуль-хиджжа;мухаррам;раби-уль-авваль;раби-уль-ахир;джумад-уль-авваль;джумад-уль-ахир;раджаб;шаабан;рамадан"),mmm6:C("рам.;шав.;зуль-к.;зуль-х.;мух.;раб. I;раб. II;джум. I;джум. II;радж.;шааб.;рам."),bool:C("ИСТИНА;ЛОЖЬ")},"ru"),ne(Pe({decimal:",",mmmm:C("januára;februára;marca;apríla;mája;júna;júla;augusta;septembra;októbra;novembra;decembra"),dddd:C("nedeľa;pondelok;utorok;streda;štvrtok;piatok;sobota")},3,2),"sk");const kt={group:".",decimal:",",ampm:C("a. m.;p. m."),mmmm:C("enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiem~;octu~;noviem~;diciem~","bre"),mmm:C("ene;feb;mar;abr;may;jun;jul;ago;sept;oct;nov;dic"),dddd:C("domingo;lunes;martes;miércoles;jueves;viernes;sábado"),ddd:C("dom;lun;mar;mié;jue;vie;sáb"),bool:C("VERDADERO;FALSO")},TE=C("ene;feb;mar;abr;may;jun;jul;ago;sep;oct;nov;dic"),To=C("ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sept.;oct.;nov.;dic.");ne({...kt},"es"),ne({...kt},"es_AR"),ne({...kt},"es_BO"),ne({...kt},"es_CL"),ne({...kt},"es_CO"),ne({...kt},"es_EC"),ne({...kt,mmm:TE,ampm:C("a.m.;p.m.")},"es_MX"),ne({...kt,mmm:To},"es_PY"),ne({...kt,mmm:To},"es_UY"),ne({...kt,mmm:To,mmmm:C("enero;febrero;marzo;abril;mayo;junio;julio;agosto;setiembre;octubre;noviembre;diciembre")},"es_VE"),ne({decimal:",",ampm:C("fm;em"),mmmm:C("januari;februari;mars;april;maj;juni;juli;augusti;september;oktober;november;december"),mmm:C("jan.;feb.;mars;apr.;maj;juni;juli;aug.;sep.;okt.;nov.;dec."),dddd:C("sön~;mån~;tis~;ons~;tors~;fre~;lör~","dag"),ddd:C("sön;mån;tis;ons;tors;fre;lör")},"sv"),ne(Pe({group:".",decimal:",",ampm:C("ÖÖ;ÖS"),mmmm:C("Ocak;Şubat;Mart;Nisan;Mayıs;Haziran;Temmuz;Ağustos;Eylül;Ekim;Kasım;Aralık"),mmm:C("Oca;Şub;Mar;Nis;May;Haz;Tem;Ağu;Eyl;Eki;Kas;Ara"),dddd:C("Pazar;Pazartesi;Salı;Çarşamba;Perşembe;Cuma;Cumartesi"),ddd:C("Paz;Pzt;Sal;Çar;Per;Cum;Cmt"),bool:C("DOĞRU;YANLIŞ")},3,-1),"tr"),ne({group:",",ampm:C("yb;yh"),mmmm:C("Ionawr;Chwefror;Mawrth;Ebrill;Mai;Mehefin;Gorffennaf;Awst;Medi;Hydref;Tachwedd;Rhagfyr"),mmm:C("Ion;Chwef;Maw;Ebr;Mai;Meh;Gorff;Awst;Medi;Hyd;Tach;Rhag"),dddd:C("Dydd Sul;Dydd Llun;Dydd Mawrth;Dydd Mercher;Dydd Iau;Dydd Gwener;Dydd Sadwrn"),ddd:C("Sul;Llun;Maw;Mer;Iau;Gwen;Sad")},"cy"),ne({group:".",decimal:",",mmmm:C("yanvar;fevral;mart;aprel;may;iyun;iyul;avqust;sentyabr;oktyabr;noyabr;dekabr"),mmm:C("yan;fev;mar;apr;may;iyn;iyl;avq;sen;okt;noy;dek"),dddd:C("bazar;bazar ertəsi;çərşənbə axşamı;çərşənbə;cümə axşamı;cümə;şənbə"),ddd:C("B.;B.e.;Ç.a.;Ç.;C.a.;C.;Ş.")},"az"),ne(Pe({decimal:",",mmmm:C("студзеня;лютага;сакавіка;красавіка;мая;чэрвеня;ліпеня;жніўня;верасня;кастрычніка;лістапада;снежня"),dddd:C("нядзеля;панядзелак;аўторак;серада;чацвер;пятніца;субота"),ddd:C("нд;пн;аў;ср;чц;пт;сб")},3,-1),"be"),ne({decimal:",",ampm:C("пр.об.;сл.об."),mmmm:C("януари;февруари;март;април;май;юни;юли;август;септември;октомври;ноември;декември"),mmm:C("яну;фев;март;апр;май;юни;юли;авг;сеп;окт;ное;дек"),dddd:C("неделя;понеделник;вторник;сряда;четвъртък;петък;събота"),ddd:C("нд;пн;вт;ср;чт;пт;сб"),bool:C("ИСТИНА;ЛОЖЬ")},"bg"),ne({group:".",decimal:",",mmmm:C("de gener;de febrer;de març;d’abril;de maig;de juny;de juliol;d’agost;de setembre;d’octubre;de novembre;de desembre"),mmm:C("de gen.;de febr.;de març;d’abr.;de maig;de juny;de jul.;d’ag.;de set.;d’oct.;de nov.;de des."),dddd:C("diumenge;dilluns;dimarts;dimecres;dijous;divendres;dissabte"),ddd:C("dg.;dl.;dt.;dc.;dj.;dv.;ds."),ampm:C("a. m.;p. m.")},"ca"),ne(Pe({group:",",decimal:".",mmmm:C("Enero;Pebrero;Marso;Abril;Mayo;Hunyo;Hulyo;Agosto;Setyembre;Oktubre;Nobyembre;Disyembre"),dddd:C("Linggo;Lunes;Martes;Miyerkules;Huwebes;Biyernes;Sabado")},3,3),"fil"),ne({group:",",decimal:".",mmmm:C("જાન્યુઆરી;ફેબ્રુઆરી;માર્ચ;એપ્રિલ;મે;જૂન;જુલાઈ;ઑગસ્ટ;સપ્ટેમ્બર;ઑક્ટોબર;નવેમ્બર;ડિસેમ્બર"),mmm:C("જાન્યુ;ફેબ્રુ;માર્ચ;એપ્રિલ;મે;જૂન;જુલાઈ;ઑગસ્ટ;સપ્ટે;ઑક્ટો;નવે;ડિસે"),dddd:C("રવિ~;સોમ~;મંગળ~;બુધ~;ગુરુ~;શુક્ર~;શનિ~","વાર"),ddd:C("રવિ;સોમ;મંગળ;બુધ;ગુરુ;શુક્ર;શનિ")},"gu"),ne({group:",",decimal:".",ampm:C("לפנה״צ;אחה״צ"),dddd:C("~ראשון;~שני;~שלישי;~רביעי;~חמישי;~שישי;~שבת","יום "),ddd:C("~א׳;~ב׳;~ג׳;~ד׳;~ה׳;~ו׳;שבת","יום "),mmmm:C("ינואר;פברואר;מרץ;אפריל;מאי;יוני;יולי;אוגוסט;ספטמבר;אוקטובר;נובמבר;דצמבר"),mmm:C("ינו׳;פבר׳;מרץ;אפר׳;מאי;יוני;יולי;אוג׳;ספט׳;אוק׳;נוב׳;דצמ׳"),mmmm6:C("רמדאן;שוואל;ד׳ו אל־קעדה;ד׳ו אל־חיג׳ה;מוחרם;רביע אל־אוול;רביע א־ת׳אני;ג׳ומאדא אל־אולא;ג׳ומאדא א־ת׳אניה;רג׳ב;שעבאן;רמדאן"),mmm6:C("רמדאן;שוואל;ד׳ו אל־קעדה;ד׳ו אל־חיג׳ה;מוחרם;רביע א׳;רביע ב׳;ג׳ומאדא א׳;ג׳ומאדא ב׳;רג׳ב;שעבאן;רמדאן")},"he"),ne(Pe({group:".",decimal:",",mmmm:C("siječnja;veljače;ožujka;travnja;svibnja;lipnja;srpnja;kolovoza;rujna;listopada;studenoga;prosinca"),mmm:C("sij;velj;ožu;tra;svi;lip;srp;kol;ruj;lis;stu;pro"),dddd:C("nedjelja;ponedjeljak;utorak;srijeda;četvrtak;petak;subota")},-1,3),"hr"),ne({decimal:",",mmmm:C("հունվարի;փետրվարի;մարտի;ապրիլի;մայիսի;հունիսի;հուլիսի;օգոստոսի;սեպտեմբերի;հոկտեմբերի;նոյեմբերի;դեկտեմբերի"),mmm:C("հնվ;փտվ;մրտ;ապր;մյս;հնս;հլս;օգս;սեպ;հոկ;նոյ;դեկ"),dddd:C("կիրակի;երկուշաբթի;երեքշաբթի;չորեքշաբթի;հինգշաբթի;ուրբաթ;շաբաթ"),ddd:C("կիր;երկ;երք;չրք;հնգ;ուր;շբթ")},"hy"),ne(Pe({decimal:",",mmmm:C("იანვარი;თებერვალი;მარტი;აპრილი;მაისი;ივნისი;ივლისი;აგვისტო;სექტემბერი;ოქტომბერი;ნოემბერი;დეკემბერი"),dddd:C("კვირა;ორშაბათი;სამშაბათი;ოთხშაბათი;ხუთშაბათი;პარასკევი;შაბათი")},3,3),"ka"),ne(Pe({decimal:",",mmmm:C("қаңтар;ақпан;наурыз;сәуір;мамыр;маусым;шілде;тамыз;қыркүйек;қазан;қараша;желтоқсан"),dddd:C("жексенбі;дүйсенбі;сейсенбі;сәрсенбі;бейсенбі;жұма;сенбі"),ddd:C("жс;дс;сс;ср;бс;жм;сб")},13,-1),"kk"),ne({group:",",mmmm:C("ಜನವರಿ;ಫೆಬ್ರವರಿ;ಮಾರ್ಚ್;ಏಪ್ರಿಲ್;ಮೇ;ಜೂನ್;ಜುಲೈ;ಆಗಸ್ಟ್;ಸೆಪ್ಟೆಂಬರ್;ಅಕ್ಟೋಬರ್;ನವೆಂಬರ್;ಡಿಸೆಂಬರ್"),mmm:C("ಜನವರಿ;ಫೆಬ್ರವರಿ;ಮಾರ್ಚ್;ಏಪ್ರಿ;ಮೇ;ಜೂನ್;ಜುಲೈ;ಆಗಸ್ಟ್;ಸೆಪ್ಟೆಂ;ಅಕ್ಟೋ;ನವೆಂ;ಡಿಸೆಂ"),dddd:C("ಭಾನು~;ಸೋಮ~;ಮಂಗಳ~;ಬುಧ~;ಗುರು~;ಶುಕ್ರ~;ಶನಿ~","ವಾರ"),ddd:C("ಭಾನು;ಸೋಮ;ಮಂಗಳ;ಬುಧ;ಗುರು;ಶುಕ್ರ;ಶನಿ"),ampm:C("ಪೂರ್ವಾಹ್ನ;ಅಪರಾಹ್ನ")},"kn"),ne({decimal:",",mmmm:C("sausio;vasario;kovo;balandžio;gegužės;birželio;liepos;rugpjūčio;rugsėjo;spalio;lapkričio;gruodžio"),mmm:C("saus.;vas.;kov.;bal.;geg.;birž.;liep.;rugp.;rugs.;spal.;lapkr.;gruod."),dddd:C("sekmadienis;pirmadienis;antradienis;trečiadienis;ketvirtadienis;penktadienis;šeštadienis"),ddd:C("sk;pr;an;tr;kt;pn;št"),ampm:C("priešpiet;popiet")},"lt"),ne({decimal:",",mmmm:C("janvāris;februāris;marts;aprīlis;maijs;jūnijs;jūlijs;augusts;septembris;oktobris;novembris;decembris"),mmm:C("janv.;febr.;marts;apr.;maijs;jūn.;jūl.;aug.;sept.;okt.;nov.;dec."),dddd:C("svētdiena;pirmdiena;otrdiena;trešdiena;ceturtdiena;piektdiena;sestdiena"),ddd:C("svētd.;pirmd.;otrd.;trešd.;ceturtd.;piektd.;sestd."),ampm:C("priekšpusdienā;pēcpusdienā")},"lv"),ne({group:",",decimal:".",mmmm:C("ജനുവരി;ഫെബ്രുവരി;മാർച്ച്;ഏപ്രിൽ;മേയ്;ജൂൺ;ജൂലൈ;ഓഗസ്റ്റ്;സെപ്റ്റംബർ;ഒക്‌ടോബർ;നവംബർ;ഡിസംബർ"),mmm:C("ജനു;ഫെബ്രു;മാർ;ഏപ്രി;മേയ്;ജൂൺ;ജൂലൈ;ഓഗ;സെപ്റ്റം;ഒക്ടോ;നവം;ഡിസം"),dddd:C("ഞായറാഴ്‌ച;തിങ്കളാഴ്‌ച;ചൊവ്വാഴ്ച;ബുധനാഴ്‌ച;വ്യാഴാഴ്‌ച;വെള്ളിയാഴ്‌ച;ശനിയാഴ്‌ച"),ddd:C("ഞായർ;തിങ്കൾ;ചൊവ്വ;ബുധൻ;വ്യാഴം;വെള്ളി;ശനി")},"ml"),ne({group:",",decimal:".",mmmm:C("нэгдүгээ~;хоёрдугаа~;гуравдугаа~;дөрөвдүгээ~;тавдугаа~;зургаадугаа~;долоодугаа~;наймдугаа~;есдүгээ~;аравдугаа~;арван нэгдүгээ~;арван хоёрдугаа~","р сар"),mmm:C("1~;2~;3~;4~;5~;6~;7~;8~;9~;10~;11~;12~","-р сар"),dddd:C("ням;даваа;мягмар;лхагва;пүрэв;баасан;бямба"),ddd:C("Ня;Да;Мя;Лх;Пү;Ба;Бя"),ampm:C("ү.ө.;ү.х.")},"mn"),ne({group:",",decimal:".",mmmm:C("जानेवारी;फेब्रुवारी;मार्च;एप्रिल;मे;जून;जुलै;ऑगस्ट;सप्टेंबर;ऑक्टोबर;नोव्हेंबर;डिसेंबर"),mmm:C("जाने;फेब्रु;मार्च;एप्रि;मे;जून;जुलै;ऑग;सप्टें;ऑक्टो;नोव्हें;डिसें"),dddd:C("रविवार;सोमवार;मंगळवार;बुधवार;गुरुवार;शुक्रवार;शनिवार"),ddd:C("रवि;सोम;मंगळ;बुध;गुरु;शुक्र;शनि")},"mr"),ne(Pe({group:",",decimal:".",mmmm:C("ဇန်နဝါရီ;ဖေဖော်ဝါရီ;မတ်;ဧပြီ;မေ;ဇွန်;ဇူလိုင်;ဩဂုတ်;စက်တင်ဘာ;အောက်တိုဘာ;နိုဝင်ဘာ;ဒီဇင်ဘာ"),mmm:C("ဇန်;ဖေ;မတ်;ဧ;မေ;ဇွန်;ဇူ;ဩ;စက်;အောက်;နို;ဒီ"),dddd:C("တနင်္ဂနွေ;တနင်္လာ;အင်္ဂါ;ဗုဒ္ဓဟူး;ကြာသပတေး;သောကြာ;စနေ"),ampm:C("နံနက်;ညနေ")},-1,0),"my"),ne({group:",",decimal:".",mmmm:C("ਜਨਵਰੀ;ਫ਼ਰਵਰੀ;ਮਾਰਚ;ਅਪ੍ਰੈਲ;ਮਈ;ਜੂਨ;ਜੁਲਾਈ;ਅਗਸਤ;ਸਤੰਬਰ;ਅਕਤੂਬਰ;ਨਵੰਬਰ;ਦਸੰਬਰ"),mmm:C("ਜਨ;ਫ਼ਰ;ਮਾਰਚ;ਅਪ੍ਰੈ;ਮਈ;ਜੂਨ;ਜੁਲਾ;ਅਗ;ਸਤੰ;ਅਕਤੂ;ਨਵੰ;ਦਸੰ"),dddd:C("ਐਤਵਾਰ;ਸੋਮਵਾਰ;ਮੰਗਲਵਾਰ;ਬੁੱਧਵਾਰ;ਵੀਰਵਾਰ;ਸ਼ੁੱਕਰਵਾਰ;ਸ਼ਨਿੱਚਰਵਾਰ"),ddd:C("ਐਤ;ਸੋਮ;ਮੰਗਲ;ਬੁੱਧ;ਵੀਰ;ਸ਼ੁੱਕਰ;ਸ਼ਨਿੱਚਰ"),ampm:C("ਪੂ.ਦੁ.;ਬਾ.ਦੁ.")},"pa"),ne({group:".",decimal:",",mmmm:C("ianuarie;februarie;martie;aprilie;mai;iunie;iulie;august;septem~;octom~;noiem~;decem~","brie"),mmm:C("ian.;feb.;mar.;apr.;mai;iun.;iul.;aug.;sept.;oct.;nov.;dec."),dddd:C("duminică;luni;marți;miercuri;joi;vineri;sâmbătă"),ddd:C("dum.;lun.;mar.;mie.;joi;vin.;sâm."),ampm:C("a.m.;p.m.")},"ro"),ne(Pe({group:".",decimal:",",mmmm:C("januar;februar;marec;april;maj;junij;julij;avgust;september;oktober;november;december"),mmm:C("jan.;feb.;mar.;apr.;maj;jun.;jul.;avg.;sep.;okt.;nov.;dec."),dddd:C("nedelja;ponedeljek;torek;sreda;četrtek;petek;sobota"),ampm:C("dop.;pop.")},-1,13),"sl"),ne(Pe({group:".",decimal:",",mmmm:C("јануар;фебруар;март;април;мај;јун;јул;август;септембар;октобар;новембар;децембар"),dddd:C("недеља;понедељак;уторак;среда;четвртак;петак;субота")},3,3),"sr"),ne({group:",",decimal:".",mmmm:C("ஜனவரி;பிப்ரவரி;மார்ச்;ஏப்ரல்;மே;ஜூன்;ஜூலை;ஆகஸ்ட்;செப்டம்பர்;அக்டோபர்;நவம்பர்;டிசம்பர்"),mmm:C("ஜன.;பிப்.;மார்.;ஏப்.;மே;ஜூன்;ஜூலை;ஆக.;செப்.;அக்.;நவ.;டிச."),dddd:C("ஞாயிறு;திங்கள்;செவ்வாய்;புதன்;வியாழன்;வெள்ளி;சனி"),ddd:C("ஞாயி.;திங்.;செவ்.;புத.;வியா.;வெள்.;சனி")},"ta"),ne({group:",",decimal:".",mmmm:C("జనవరి;ఫిబ్రవరి;మార్చి;ఏప్రిల్;మే;జూన్;జులై;ఆగస్టు;సెప్టెంబర్;అక్టోబర్;నవంబర్;డిసెంబర్"),mmm:C("జన;ఫిబ్ర;మార్చి;ఏప్రి;మే;జూన్;జులై;ఆగ;సెప్టెం;అక్టో;నవం;డిసెం"),dddd:C("ఆదివారం;సోమవారం;మంగళవారం;బుధవారం;గురువారం;శుక్రవారం;శనివారం"),ddd:C("ఆది;సోమ;మంగళ;బుధ;గురు;శుక్ర;శని")},"te"),ne({decimal:",",mmmm:C("січня;лютого;березня;квітня;травня;червня;липня;серпня;вересня;жовтня;листопада;грудня"),mmm:C("січ.;лют.;бер.;квіт.;трав.;черв.;лип.;серп.;вер.;жовт.;лист.;груд."),dddd:C("неділю;понеділок;вівторок;середу;четвер;пʼятницю;суботу"),ddd:C("нд;пн;вт;ср;чт;пт;сб"),ampm:C("дп;пп")},"uk"),ne({group:".",decimal:",",mmmm:C("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","tháng "),mmm:C("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thg "),dddd:C("Chủ Nhật;Thứ Hai;Thứ Ba;Thứ Tư;Thứ Năm;Thứ Sáu;Thứ Bảy"),ddd:C("CN;Th 2;Th 3;Th 4;Th 5;Th 6;Th 7"),ampm:C("SA;CH")},"vi"),ne(Pe({group:"٬",decimal:"٫",ampm:C("ص;م"),mmmm:C("يناير;فبراير;مارس;أبريل;مايو;يونيو;يوليو;أغسطس;سبتمبر;أكتوبر;نوفمبر;ديسمبر"),dddd:C("الأحد;الاثنين;الثلاثاء;الأربعاء;الخميس;الجمعة;السبت"),mmmm6:C("رمضان;شوال;ذو القعدة;ذو الحجة;محرم;ربيع الأول;ربيع الآخرة;جمادى الأولى;جمادى الآخرة;رجب;شعبان;رمضان")},0,0),"ar"),ne({group:",",decimal:".",mmmm:C("জানুয়ারী;ফেব্রুয়ারী;মার্চ;এপ্রিল;মে;জুন;জুলাই;আগস্ট;সেপ্টেম্বর;অক্টোবর;নভেম্বর;ডিসেম্বর"),mmm:C("জানু;ফেব;মার্চ;এপ্রি;মে;জুন;জুল;আগ;সেপ্টেঃ;অক্টোঃ;নভেঃ;ডিসেঃ"),dddd:C("রবিবার;সোমবার;মঙ্গলবার;বুধবার;বৃহস্পতিবার;শুক্রবার;শনিবার"),ddd:C("রবি;সোম;মঙ্গল;বুধ;বৃহস্পতি;শুক্র;শনি")},"bn"),ne({group:",",decimal:".",mmmm:C("जनवरी;फ़रवरी;मार्च;अप्रैल;मई;जून;जुलाई;अगस्त;सितंबर;अक्तूबर;नवंबर;दिसंबर"),mmm:C("जन॰;फ़र॰;मार्च;अप्रैल;मई;जून;जुल॰;अग॰;सित॰;अक्तू॰;नव॰;दिस॰"),dddd:C("रविवार;सोमवार;मंगलवार;बुधवार;गुरुवार;शुक्रवार;शनिवार"),ddd:C("रवि;सोम;मंगल;बुध;गुरु;शुक्र;शनि"),ampm:C("am;pm")},"hi");const cc={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,bigintErrorNumber:!1,dateSpanLarge:!0,leap1900:!0,nbsp:!1,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1,grouping:[3,3],indexColors:!0,skipChar:"",repeatChar:""};function It(e,t=0){if(typeof e!="number")return e;if(e<0)return-It(-e,t);if(t){const n=10**t||1;return It(e*n,0)/n}return Math.round(e)}const NE=1e-13;function hc(e,t=2,n=2){const r=e<0?-1:1,s=10**(t||2),i=10**(n||2);let o=Math.abs(e),a=0,l=0,u=0,c=1,h,d;if(e=o,e%1===0)d=[e*r,1];else if(e<1e-19)d=[r,1e19];else if(e>1e19)d=[1e19*r,1];else{do if(o=1/(o-Math.floor(o)),h=c,c=c*Math.floor(o)+a,a=h,l=u,u=Math.floor(e*c+.5),u>=s||c>=i)return[r*l,a];while(Math.abs(e-u/c)>=NE&&o!==Math.floor(o));d=[r*u,c]}return d}const ht=Math.floor;function dc(e,t=!0){if(t&&e>=0){if(e===0)return[1900,1,0];if(e===60)return[1900,2,29];if(e<60)return[1900,e<32?1:2,(e-1)%31+1]}let n=e+68569+2415019;const r=ht(4*n/146097);n=n-ht((146097*r+3)/4);const s=ht(4e3*(n+1)/1461001);n=n-ht(1461*s/4)+31;const i=ht(80*n/2447),o=n-ht(2447*i/80);n=ht(i/11);const a=i+2-12*n;return[100*(r-49)+s+n|0,a|0,o|0]}function ME(e){return dc(e+1462)}function LE(e){if(e===60)throw new Error("#VALUE!");if(e<=1)return[1317,8,29];if(e<60)return[1317,e<32?9:10,1+(e-2)%30];const t=10631/30,n=8.01/60;let r=e+466935;const s=ht(r/10631);r=r-10631*s;const i=ht((r-n)/t);r=r-ht(i*t+n);const o=ht((r+28.5001)/29.5);return o===13?[30*s+i,12,30]:[30*s+i,o,r-ht(29.5001*o-29)]}function fc(e,t=0,n=!0){const r=ht(e);return t===Pn?LE(r):t===bE?ME(r):dc(r,n)}const Bs=Math.floor,No=86400;function Mo(e,t){let n=null;if(Array.isArray(e)){const[r,s,i,o,a,l]=e;n=Date.UTC(r,s==null?0:s-1,i!=null?i:1,o||0,a||0,l||0)}else if(e instanceof Date&&(n=e*1,!t||!t.ignoreTimezone)){const r=new Date;r.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setUTCHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n=r*1}if(n!=null&&isFinite(n)){const r=n/864e5;return r-(r<=-25509?-25568:-25569)}return null}function DE(e,t){let n=e|0;const r=No*(e-n);let s=Bs(r);r-s>.9999&&(s+=1,s===No&&(s=0,n+=1));const i=s<0?No+s:s,[o,a,l]=fc(e,0,t&&t.leap1900),u=Bs(i/60/60)%60,c=Bs(i/60)%60,h=Bs(i)%60;return[o,a,l,u,c,h]}const UE=["!d-m-y","!d-m-Y","!j-m-y","!j-m-Y","!d-n-y","!d-n-Y","!j-n-y","!j-n-Y","?m-d-y","?m-d-Y","?m-j-y","?m-j-Y","?n-d-y","?n-d-Y","?n-j-y","?n-j-Y","d-M-y","d-M-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","d-F-y","d-F-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],PE={j:"d",d:"d",D:"ddd",l:"dddd",n:"m",m:"m",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},kE={j:"dd",d:"dd",D:"ddd",l:"dddd",n:"mm",m:"mm",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},mc={},gc={};function dt(e,t,n=1){if(e){const r=e[0],s=e.slice(1);r==="!"?dt(s,t,4):r==="?"?dt(s,t,2):(t[r]=t[r]||{},dt(s,t[r],n))}else t.$=n}function _c(e,t){dt(e,t),dt(e+" x",t),dt(e+" l",t),dt(e+" l x",t),dt("l "+e,t),dt("l "+e+" x",t),dt(e+" D",t),dt(e+" D x",t),dt("D "+e,t),dt("D "+e+" x",t)}UE.forEach(e=>{e[0]!=="?"&&_c(e,mc),e[0]!=="!"&&_c(e,gc)});const FE=new Date().getUTCFullYear(),pc=".",xE=",",Lo=" ",Ar=" ",yr=" ",Hs="'",$s="٬",BE={".":[xE,Ar,yr,Hs,$s],",":[pc,Ar,yr,Hs,$s],"٫":[pc,Ar,yr,Hs,$s]},Do=e=>e&&e.length===1&&e>="0"&&e<="9";function Uo(e,t={}){const n=xn(t.locale||"")||tn,r=n.decimal,s=[...BE[r]||[Hs,$s]];!s.includes(n.group)&&n.group!==Lo&&n.group!==r&&s.push(n.group);let i="",o="",a=1,l="",u=!1,c=!1,h=!1,d=!1,m=!1,_=null,p=!1,I=0;const A=[Lo,Ar,yr,"+","%","(","-"].concat(Io);for(;A.includes(e[I]);){const b=e[I];if(b==="-"){if(u||c)return null;u=!0,a=-1}else if(So.test(b)){if(m)return null;m=!0,_=b}else if(b==="("){if(c||u)return null;c=!0,a=-1}else if(b==="%"){if(d)return null;d=!0}I++}let B=!1,x;if(e[I]===r||Do(e[I]))for(;I<e.length;){const b=e[I];if(!x&&s.includes(b))x=b;else if(!(x&&x===b))if(b===r){if(B)break;i+=".",B=!0}else if(Do(b))i+=b;else break;I++}if(e[I]==="e"||e[I]==="E"){o+=e[I],I++,(e[I]==="+"||e[I]==="-")&&(o+=e[I],I++);const b=I;for(;Do(e[I]);)o+=e[I],I++;if(b===I)return null}const Y=[Lo,Ar,yr,"%","$",")"].concat(Io);for(;Y.includes(e[I]);){const b=e[I];if(So.test(b)){if(m)return null;m=!0,_=b,p=!0}else if(b===")"){if(h||!c)return null;h=!0}else if(b==="%"){if(d)return null;d=!0}I++}if(I!==e.length)return null;let O=parseFloat(i+o);if(!isFinite(O))return null;if(o){if(d||m)return null;l="0.00E+00"}else if(d){if(m)return null;l=i.includes(".")?"0.00%":"0%",O*=.01}else if(m){const b=i.includes(".")?"#,##0.00":"#,##0";p?l=b+_:l=_+b}else x&&(l=i.includes(".")?"#,##0.00":"#,##0");const R={v:O*a};return l&&(R.z=l),R}function HE(e,t,n){if(n<1||t<1||t>12)return!1;if(t===2){const s=e%4===0&&e%100!==0||e%400===0||e===1900?29:28;if(n>s)return!1}else if((t===4||t===6||t===9||t===11)&&n>30||(t===1||t===3||t===5||t===7||t===8||t===10||t===12)&&n>31)return!1;return!0}const Ec=(e,t,n=!1)=>{for(const r of t)if(e.startsWith(r[0])){let s=r[0].length;return n&&(r[2]==="D"||r[2]==="M")&&e[s]==="."&&s++,[e.slice(0,s),r]}return["",null]},Ft=(e,t,n,r)=>{const s=n.path||"",i=Object.keys(t);for(let o=0;o<i.length;o++){let a;const l=i[o];if(t[l]){if(l==="$"||l==="€")e||(a=n);else if(l==="-"){const u=/^(\s*([./-]|,\s)\s*|\s+)/.exec(e);if(u){const c=u[1]==="-"||u[1]==="/"||u[1]==="."?u[1]:" ";if(!n.sep||n.sep===c){const h=u[0].replace(/\s+/g," ");a=Ft(e.slice(u[0].length),t[l],{...n,sep:c,path:s+h},r)}}}else if(l===" "){const u=/^[,.]?\s+/.exec(e);if(u){const c=u[0].replace(/\s+/g," ");a=Ft(e.slice(u[0].length),t[l],{...n,path:s+c},r)}}else if(l==="j"||l==="d"){const u=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(e);u&&(a=Ft(e.slice(u[0].length),t[l],{...n,day:u[0],path:s+l},r))}else if(l==="n"||l==="m"){const u=/^(0?[1-9]|1[012])\b/.exec(e);u&&(a=Ft(e.slice(u[0].length),t[l],{...n,month:+u[0],_mon:u[0],path:s+l},r))}else if(l==="F"||l==="M"){const[u,c]=Ec(e,r.mon,r.mp);c&&c[2]===l&&(a=Ft(e.slice(u.length),t[l],{...n,month:c[1],_mon:u,path:s+l},r))}else if(l==="l"||l==="D"){const[u,c]=Ec(e,r.day,r.dp);c&&c[2]===l&&(a=Ft(e.slice(u.length),t[l],{...n,path:s+l},r))}else if(l==="y"){const u=/^\d\d\b/.exec(e);if(u){const c=+u[0]>=30?+u[0]+1900:+u[0]+2e3;a=Ft(e.slice(u[0].length),t[l],{...n,year:c,path:s+l},r)}}else if(l==="Y"){const u=/^\d\d\d\d\b/.exec(e);u&&(a=Ft(e.slice(u[0].length),t[l],{...n,year:+u[0],path:s+l},r))}else if(l==="x"){const u=Ws(e,{locale:r.locale});u&&(a=Ft("",t[l],{...n,time:u.v,tf:u.z,path:s+l},r))}else throw new Error(`Unknown date token "${l}"`);if(a&&HE(n.year||1916,n.month||1,n.day?+n.day:1))return a}}},Cc=e=>e.replace(/\s+/g," ").trim().replace(/’/,"'").replace(/\.$/,"").toLowerCase(),js=(e,t)=>{const n=e.map((r,s)=>[Cc(r),s+1,t]);return n.sort((r,s)=>s[0].length-r[0].length),n};function Po(e,t={}){var i;const n=xn(t.locale||"")||tn,r={mon:js(n.mmmm,"F").concat(js(n.mmm,"M")),mp:n.mmm[0].at(-1)===".",day:js(n.dddd,"l").concat(js(n.ddd,"D")),dp:n.ddd[0].at(-1)===".",locale:t.locale},s=Ft(Cc(e),n.preferMDY?gc:mc,{path:""},r);if(s){if(s.sep==="."&&s.path.length===3)return null;const o=+((i=s.year)!=null?i:FE);s.day||(s.day=1);let a=-1/0;if(o<1900)return null;o<=1900&&s.month<=2?a=25568:o<1e4&&(a=25569);const l=Date.UTC(o,s.month-1,s.day)/864e5+a+(s.time||0);if(l>=0&&l<=2958465){const u=s._mon[0]==="0"||s.day[0]==="0"||s._mon.length===2&&s.day.length===2,c=s.path.replace(/[jdlDnmMFyYx]/g,h=>h==="x"?s.tf||"":(u?kE[h]:PE[h])||h);return{v:l,z:c}}}return null}const ko=e=>e.replace(/\s+/g,"").trim().replace(/\./g,"").toLowerCase();function Ws(e,t={}){const n=xn(t.locale||"")||tn,r=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?=\s*[^\s\d]|$)/.exec(e);let s="";if(r){const i=ko(e.slice(r[0].length));if(i===ko(n.ampm[0])||i==="a"||i==="am")s="a";else if(i===ko(n.ampm[1])||i==="p"||i==="pm")s="p";else if(i)return null}if(r){const[,i,o,a,l]=r;if(l&&!a||!s&&!o&&!a)return null;let u=+(i||0)*1;if(s){if(u>=13)return null;s==="p"&&(u+=12)}const c=+(o||0)*1,h=+(a||0)*1,d=+(l||0)*1;return{v:(u*60*60+c*60+h+d)/(3600*24),z:(i.length===2?"hh":"h")+":mm"+(a?":ss":"")+(s?" AM/PM":"")}}return null}function Rc(e,t={}){const n=xn(t.locale||"")||tn,r=e.trim().toLowerCase(),s=n.bool[0].toLowerCase();if(r==="true"||r===s)return{v:!0};const i=n.bool[1].toLowerCase();return r==="false"||r===i?{v:!1}:null}function $E(e,t){var n,r,s;return(s=(r=(n=Uo(e,t))!=null?n:Po(e,t))!=null?r:Ws(e,t))!=null?s:Rc(e,t)}function Rn(e,t,n){return t[n+"_max"]=e.length,t[n+"_min"]=e.replace(/#/g,"").length,t}function Ge(e,t){typeof e=="string"?t.push({type:"string",value:e}):t.push(e)}function Ic(e,t){const n=e&&e.type;return n===qi||n===kn||n===Ji||n===Fs&&t==="den"}function Tr(e){var x,Y,O;const t=[],n={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:rc,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:t};let r="int",s=null;const i=[];let o,a=!1,l=-1,u=!1,c="",h=!1;for(;++l<e.length&&!u;){const R=e[l],b=R.type||br;if(c+=R.raw,b===Xi)n.general=!0,Ge(R,t);else if(Ic(R,r)){const T=n[r+"_pattern"];Ic(o,r)||(o==null?void 0:o.type)===wr?(T.push((T.pop()||"")+R.value),s.num+=R.value):(T.push(R.value),s={type:r,num:R.value},Ge(s,t))}else if(b===Ro)R.value==="("&&(n.parens=!0),Ge(R.value,t);else if(b===Fs)Ge(R.value,t);else if(b===Zi)if(h=!0,n[r+"_pattern"].length){if(!s)throw new SyntaxError("Format pattern is missing a numerator");n.fractions=!0,n.num_pattern.push(n[r+"_pattern"].pop()),s.type="num",r="den",Ge({type:"div"},t)}else Ge(R.value,t);else if(b===Qi)Ge(",",t);else if(b===Us)n.scale=.001**R.raw.length;else if(b===wr){if(r==="int"&&(n.grouping=!0),r==="den")throw new SyntaxError("Cannot group denominator digits")}else if(b===ro)Ge(R,t);else if(b===eo){u=!0;break}else if(b===Ps)n.text=!0,Ge(R,t);else if(b===to||b===no)Ge(R,t);else if(b===ao){const T=R.value.toLowerCase(),H=T[0],$={type:"",size:0,date:1,pad:T.length};H==="h"?($.size=Sr,$.type="hour-elap"):H==="m"?($.size=Or,$.type="min-elap"):($.size=vr,$.type="sec-elap"),n.date=n.date|$.size,i.push($),Ge($,t)}else if(n.date&&b===ks&&((x=e[l+1])==null?void 0:x.type)===kn){let T=1;l++;let H="0";((Y=e[l+1])==null?void 0:Y.type)===kn&&(H+="0",T=2,l++),((O=e[l+1])==null?void 0:O.type)===kn&&(H+="0",T=3,l++),c+=H;const $=[vr,Vi,zi,Ki][T];n.date=n.date|$,n.date_eval=!0,n.sec_decimals=Math.max(n.sec_decimals,T),Ge({type:"subsec",size:$,decimals:T,date:1},t)}else if(b===io)a||(R.value==="B2"||R.value==="b2"?n.date_system=Pn:n.date_system=rc);else if(b===oo){const T={type:"",size:0,date:1},H=R.value.toLowerCase(),$=H[0];if(H==="y"||H==="yy")T.size=Rr,T.type="year-short";else if($==="y"||$==="e")T.size=Rr,T.type="year";else if(H==="b"||H==="bb")T.size=Rr,T.type="b-year-short";else if($==="b")T.size=Rr,T.type="b-year";else if(H==="d"||H==="dd")T.size=Ds,T.type="day",T.pad=/dd/.test(H);else if(H==="ddd"||H==="aaa")T.size=Ds,T.type="weekday-short";else if($==="d"||$==="a")T.size=Ds,T.type="weekday";else if($==="h")T.size=Sr,T.type="hour",T.pad=/hh/i.test(H);else if($==="m"){H.length===3?(T.size=Ir,T.type="monthname-short"):H.length===5?(T.size=Ir,T.type="monthname-single"):H.length>=4&&(T.size=Ir,T.type="monthname");const g=i[i.length-1];!T.type&&g&&!g.used&&g.size&(Sr|vr)&&(g.used=!0,T.size=Or,T.type="min",T.pad=/mm/.test(H)),T.type||(T.size=Ir,T.type="month",T.pad=/mm/.test(H),T.indeterminate=!0)}else if($==="s"){T.size=vr,T.type="sec",T.pad=/ss/.test(H);const g=i[i.length-1];g&&g.size&Or?T.used=!0:g&&g.indeterminate&&(delete g.indeterminate,g.size=Or,g.type="min",T.used=!0)}n.date=n.date|T.size,n.date_eval=!0,i.push(T),Ge(T,t)}else if(b===mo)n.clock=12,n.date=n.date|Sr,n.date_eval=!0,R.short=R.value==="A/P",Ge(R,t);else if(b===_o||b===go||b===xs)Ge(R.value,t);else if(b===lo)n.condition=[R.value[0],parseFloat(R.value[1])];else if(b===ho){const T=R.value.split("-"),H=T.length<2?"":T.slice(1).join("-"),$=T[0];$&&Ge($,t);const g=wo(H);g&&(n.locale=g);const P=parseInt(H,16);isFinite(P)&&P&16711680&&(P>>16&255)===6&&(n.date_system=Pn),a=!0}else if(b===fo){let T,H=R.value.toLowerCase();(T=/^color\s*(\d+)$/i.exec(H))&&(H=parseInt(T[1],10)),n.color=H}else if(b===so)n.scale=100,n.percent=!0,Ge("%",t);else if(b===ks)Ge(R,t),n.date||(n.dec_fractions=!0,r="frac");else if(b===Eo)n.exponential=!0,n.exp_plus=R.value.includes("+"),r="man",Ge({type:"exp",plus:n.exp_plus},t);else if(b===po)Ge(R,t);else if(b===Co)Ge(R,t);else if(!(b===uo||b===co))throw b===br?new SyntaxError(`Illegal character: ${c}`):new SyntaxError(`Unknown token ${b} in ${c}`);o=R}if(n.tokensUsed=l,n.pattern=c,/^((?:\[[^\]]+\])+)(;|$)/.test(n.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(n.pattern)&&Ge({type:"text"},t),n.fractions&&n.dec_fractions||n.grouping&&!n.int_pattern.length||n.fractions&&n.exponential||n.fractions&&n.den_pattern.length*n.num_pattern.length===0||h&&!n.fractions&&!n.date||n.exponential&&(n.int_pattern.length||n.frac_pattern.length)*n.man_pattern.length===0)throw new SyntaxError(`Invalid pattern: ${c}`);const d=n.int_pattern.join(""),m=n.man_pattern.join(""),_=n.frac_pattern.join("");Rn(d,n,"int");let p=0;for(let R=0;R<d.length;R++){const b=d[d.length-1-R];/^[0-9?]/.test(b)&&(p=R+1)}n.int_min=p,Rn(_,n,"frac"),Rn(m,n,"man");let I=n.num_pattern.join(""),A=n.den_pattern[0]||"";if(A.includes("?")||I.includes("?")?(A=A.replace(/\d/g,"?"),A=A.replace(/#$/g,"?"),Rn(I,n,"num"),Rn(A,n,"den"),I=I.replace(/#$/g,"?")):(Rn(I,n,"num"),Rn(A,n,"den")),n.int_p=d,n.man_p=m,n.num_p=I,n.den_p=A,n.den_pattern.length&&(n.denominator=parseInt(n.den_pattern.join("").replace(/\D/g,""),10)),n.integer=!!d.length,!n.integer&&!n.exponential&&_.length){const R=n.tokens.findIndex(b=>b.type==="point");n.tokens.splice(R,0,{type:"int",value:"#"}),n.integer=!0,n.int_pattern=["#"],n.int_p="#"}if(n.fractions)for(let R=0;R<t.length-1;R++){const b=t[R];if(b.type!=="string"&&b.type!=="space")continue;const T=t[R+1].type;T==="num"?b.rule="num+int":T==="div"?b.rule="num":T==="den"&&(b.rule="den")}return n.grouping&&n.int_pattern.length>1&&(n.grouping=!1),n}function jE(e){if(e===0)return e;const t=Math.ceil(Math.log10(e<0?-e:e)),n=10**(16-Math.floor(t));return isFinite(n)?Math.round(e*n)/n:0}function Sc(e,t=0){const n=Math.floor(Math.log10(e));return t>1?Math.floor(n/t)*t:n}function Oc(e,t=1){return t<-300?parseFloat(e.toExponential().split("e")[0]):e*10**-t}const WE={total:1,sign:0,period:0,int:1,frac:0};function YE(e,t=!0){const n=Math.abs(e);if(!n)return WE;const r=t&&e<0?1:0,s=Math.floor(n),i=Math.floor(Math.log10(n)+1);let o=0,a=0;if(s!==n){o=1;const l=String(It(n*10**-i,15));let u=l.length,c=!0,h=0;for(;h<=l.length;){if(l[h]==="."){u--;break}else l[h]==="0"&&c?u--:c=!1;h++}a=u-i,a<0&&(a=0,o=0)}return{total:r+Math.max(i,1)+o+a,digits:Math.max(i,0)+a,sign:r,period:o,int:Math.max(i,1),frac:a}}const Bn=(e,t)=>e.replace(/\./,t.decimal),vc=(e,t,n)=>{const r=Math.abs(t);let s;return e===1?s=e:s=It(e,5),[Bn(s+"",n),n.exponent,t<0?n.negative:n.positive,r<10?"0":"",r]};function wc(e,t,n,r){const s=n|0;if(typeof n=="string")e.push(n);else if(n===s)e.push(Math.abs(s));else{const i=Math.abs(n);let o=Sc(i),a=Oc(i,o);a===10&&(a=1,o++);const l=YE(i);if(o>=-4&&o<=-1){const u=i.toPrecision(10+o).replace(/\.?0+$/,"");e.push(Bn(u,r))}else if(o===10){const u=i.toFixed(10).slice(0,12).replace(/\.$/,"");e.push(Bn(u,r))}else if(Math.abs(o)<=9)if(l.total<=11){const u=It(i,9).toFixed(l.frac);e.push(Bn(u,r))}else o===9?e.push(Math.floor(i)):o>=0&&o<9?e.push(Bn(String(It(i,9-o)),r)):e.push(...vc(a,o,r));else l.total>=12?e.push(...vc(a,o,r)):e.push(Bn(It(i,9).toFixed(l.frac),r))}return e}function In(e,t=!1){return e==="0"?"0":e==="?"?t?" ":" ":""}const Nr=86400,GE=(e,t,n)=>n?e<vE||t>=wE:e<SE||t>=OE;function bc(e,t,n,r){var y,w;let s="",i="",o="",a="",l="",u="",c=0,h=0;if(typeof e=="bigint"){if(e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER)e=Number(e);else return n.bigintErrorNumber?String(e):n.overflow;h=e}else h=Math.trunc(e);let d=0,m=0,_=1,p=0,I=0,A=0,B=0,x=0,Y=0;const O=r||tn;if(!t.text&&isFinite(t.scale)&&t.scale!==1&&(e=jE(e*t.scale)),t.exponential){let N=Math.abs(e);N&&(c=Sc(N,t.int_max)),e&&!t.integer&&c++,N=Oc(N,c),t.int_max===1&&It(N,t.frac_max)===10&&(N=1,c++),e=e<0?-N:N,s+=Math.abs(c)}if(t.integer){const N=Math.abs(It(e,t.fractions?1:t.frac_max));u+=N<1?"":Math.floor(N)}const R=(y=n.grouping[0])!=null?y:3,b=(w=n.grouping[1])!=null?w:R;t.dec_fractions&&(l=String(It(e,t.frac_max)).split(".")[1]||"");const T=!t.error&&(t.num_p.includes("0")||t.den_p.includes("0"));let H=T;if(t.fractions){H=T||!!(e%1);const N=Math.abs(t.integer?e%1:e);if(N)if(H=!0,t.denominator&&isFinite(t.denominator))a+=t.denominator,o+=It(N*t.denominator),o==="0"&&(o="",a="",H=T);else{const L=hc(N,1/0,t.den_max);o+=L[0],a+=L[1],t.integer&&o==="0"&&(o="",a="",H=T)}else!e&&!t.integer&&(H=!0,o="0",a="1");t.integer&&!H&&!Math.trunc(e)&&(u="0")}if(t.date){h=Math.trunc(e);const N=Nr*(e-h);if(d=Math.floor(N),Y=N-d,Math.abs(Y)<1e-6?Y=0:Y>.9999&&(Y=0,d+=1,d===Nr&&(d=0,h+=1)),Y){const L=t.date&Ki||t.date&zi||t.date&Vi;(L===Ki&&Y>.9995||L===zi&&Y>.995||L===Vi&&Y>.95||!L&&Y>=.5)&&(d++,Y=0)}if(h||t.date_system){const L=fc(e,t.date_system,n.leap1900);m=L[0],_=L[1],p=L[2]}if(d){const L=d<0?Nr+d:d;x=Math.floor(L)%60,B=Math.floor(L/60)%60,A=Math.floor(L/60/60)%60}if(I=(6+h)%7,t.date_eval&&GE(e,h+d/Nr,n.dateSpanLarge)){if(n.dateErrorThrows)throw new Error("Date out of bounds");if(n.dateErrorNumber){const L=e<0?[O.negative]:[];return wc(L,{},e,O).join("")}return n.overflow}}const $=In("?",n.nbsp);c<0?i="-":t.exp_plus&&(i="+");const g=[],P=(N,L,D,F)=>{const Q=!F&&N.length>L.length?D.length+N.length-L.length:D.length;N.length<L.length&&(F+=N.length-L.length);for(let z=0;z<Q;z++)g.push(N[z+F]||In(D[z],n.nbsp));return Q};let v=!1;const M={int:0,frac:0,man:0,num:0,den:0};for(let N=0,L=t.tokens.length;N<L;N++){const D=t.tokens[N],F=D.type,Q=D.num?D.num.length:0;if(F==="string")D.rule?D.rule==="num"?H?g.push(D.value.replace(/ /g,$)):(t.num_min>0||t.den_min>0)&&g.push(D.value.replace(/./g,$)):D.rule==="num+int"?H&&u?g.push(D.value.replace(/ /g,$)):t.den_min>0&&(u||t.num_min)&&g.push(D.value.replace(/./g,$)):D.rule==="den"&&(H?g.push(D.value.replace(/ /g,$)):(t.den_min>0||t.den_min>0)&&g.push(D.value.replace(/./g,$))):g.push(D.value.replace(/ /g,$));else if(F==="space")D.rule==="num+int"?(H||t.num_min||t.den_min)&&(u||t.num_min)&&g.push($):g.push($);else if(F==="error")g.push(n.invalid);else if(F==="point")g.push(t.date?D.value:O.decimal);else if(F==="general")wc(g,t,e,O);else if(F==="exp")g.push(O.exponent);else if(F==="minus")D.volatile&&t.date||D.volatile&&(e>=0||typeof e!="number")||(D.volatile&&!t.fractions&&(t.integer||t.dec_fractions)?(e<0&&u&&u!=="0"||l)&&g.push(O.negative):g.push(O.negative));else if(F==="plus")g.push(O.positive);else if(F==="text")g.push(e);else if(F==="fill")n.fillChar&&g.push(n.fillChar,D.value);else if(F==="skip")n.skipChar?g.push(n.skipChar,D.value):g.push(n.nbsp?" ":" ");else if(F==="div")H?g.push("/"):t.num_min>0||t.den_min>0?g.push($):g.push(In("#",n.nbsp));else if(F==="int")if(t.int_pattern.length===1){const z=t.int_p,le=Math.max(t.int_min,u.length);let ce="";for(let S=le;S>0;S--){const U=u.charAt(u.length-S),G=U?"":z.charAt(z.length-S)||z[0];let V="";if(t.grouping){const j=S-1-R;j>=0&&!(j%b)&&(V=U||G==="0"?O.group:In("?",n.nbsp))}ce+=(U||In(G,n.nbsp))+V}g.push(ce)}else M.int+=P(u,t.int_p,D.num,M.int);else if(F==="frac"){const z=M.frac;for(let le=0;le<Q;le++)g.push(l[le+z]||In(D.num[le],n.nbsp));M.frac+=Q}else if(F==="man")!M[F]&&!M.man&&g.push(i),M.man+=P(s,t.man_p,D.num,M.man);else if(F==="num")M.num+=P(o,t.num_p,D.num,M.num);else if(F==="den"){const z=M.den;for(let le=0;le<Q;le++){let ce=a[le+z];if(!ce){const S=D.num[le];"123456789".includes(S)||v&&S==="0"?(v=!0,ce=n.nbsp?" ":" "):!v&&le===Q-1&&S==="0"&&!a?ce="1":ce=In(S,n.nbsp)}g.push(ce)}M.den+=Q}else if(F==="year")m<0&&g.push(O.negative),g.push(String(Math.abs(m)).padStart(4,"0"));else if(F==="year-short"){const z=m%100;g.push(z<10?"0":"",z)}else if(F==="month")g.push(D.pad&&_<10?"0":"",_);else if(F==="monthname-single")t.date_system===Pn?g.push(O.mmmm6[_-1].charAt(0)):g.push(O.mmmm[_-1].charAt(0));else if(F==="monthname-short")t.date_system===Pn?g.push(O.mmm6[_-1]):g.push(O.mmm[_-1]);else if(F==="monthname")t.date_system===Pn?g.push(O.mmmm6[_-1]):g.push(O.mmmm[_-1]);else if(D.type==="weekday-short")g.push(O.ddd[I]);else if(F==="weekday")g.push(O.dddd[I]);else if(F==="day")g.push(D.pad&&p<10?"0":"",p);else if(F==="hour"){const z=A%t.clock||(t.clock<24?t.clock:0);g.push(D.pad&&z<10?"0":"",z)}else if(F==="min")g.push(D.pad&&B<10?"0":"",B);else if(F==="sec")g.push(D.pad&&x<10?"0":"",x);else if(F==="subsec"){g.push(O.decimal);const z=Y.toFixed(t.sec_decimals);g.push(z.slice(2,2+D.decimals))}else if(F==="ampm"){const z=A<12?0:1;D.short&&!r?g.push("AP"[z]):g.push(O.ampm[z])}else if(F==="hour-elap"){e<0&&g.push(O.negative);const z=h*24+Math.floor(Math.abs(d)/3600);g.push(String(Math.abs(z)).padStart(D.pad,"0"))}else if(F==="min-elap"){e<0&&g.push(O.negative);const z=h*1440+Math.floor(Math.abs(d)/60);g.push(String(Math.abs(z)).padStart(D.pad,"0"))}else if(F==="sec-elap"){e<0&&g.push(O.negative);const z=h*Nr+Math.abs(d);g.push(String(Math.abs(z)).padStart(D.pad,"0"))}else if(F==="b-year")g.push(m+543);else if(F==="b-year-short"){const z=(m+543)%100;g.push(z<10?"0":"",z)}}return g.join("")}const VE=Tr([{type:Ps,value:"@",raw:"@"}]);function Ac(e,t){for(let n=0;n<3;n++){const r=t[n];if(r){let s;if(r.condition){const i=r.condition[0],o=r.condition[1];i==="="?s=e===o:i===">"?s=e>o:i==="<"?s=e<o:i===">="?s=e>=o:i==="<="?s=e<=o:i==="<>"&&(s=e!==o)}else s=!0;if(s)return r}}}function zE(e,t,n){const r=t.partitions;let s=r[3],i=null;return(typeof e=="number"||typeof e=="bigint")&&isFinite(e)&&(s=Ac(e,r)),s&&s.color&&(i=s.color),i&&typeof i=="number"&&n.indexColors&&(i=AE[i-1]||"#000"),i}function KE(e,t,n){const r=t.partitions,s=xn(t.locale||n.locale),i=r[3]?r[3]:VE;if(typeof e=="boolean"&&(e=(s||tn).bool[e?0:1]),e==null)return"";const o=typeof e=="bigint";if(typeof e!="number"&&!o)return bc(e,i,n,s);if(!o&&!isFinite(e)){const l=s||tn;return isNaN(e)?l.nan:(e<0?l.negative:"")+l.infinity}const a=Ac(e,r);return a?bc(e,a,n,s):n.overflow}function yc(e){return!!(e[0]&&e[0].percent||e[1]&&e[1].percent||e[2]&&e[2].percent||e[3]&&e[3].percent)}function Tc(e){return!!(e[0]&&e[0].date||e[1]&&e[1].date||e[2]&&e[2].date||e[3]&&e[3].date)}function Nc(e){const[t,n,r,s]=e;return!!((!t||t.generated)&&(!n||n.generated)&&(!r||r.generated)&&s&&s.text&&!s.generated)}const XE={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},qE=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]];function JE(e,t=null){var h;const[n,r]=e,s=n.frac_max,i={type:"general",isDate:Tc(e),isText:Nc(e),isPercent:yc(e),maxDecimals:n.general?9:s,scale:(h=n.scale)!=null?h:1,color:0,parentheses:0,grouped:n.grouping?1:0},o=!i.isDate&&!i.isText&&!n.error&&n.tokens.some(d=>d.type==="string"&&(t?d.value===t:So.test(d.value)));let a="G",l=s>=0?Math.min(15,s):"",u="",c="";if(r&&r.color&&(c="-",i.color=1),n.parens&&(u="()",i.parentheses=1),o)a="C",i.type="currency";else if(n.error)i.type="error",i.maxDecimals=0;else if(i.isDate){let d=0,m=0,_="";n.tokens.forEach(I=>{const A=I.type;/^(b-)?year/.test(A)?(_+="Y",m++):A.startsWith("month")?(_+="M",m++):/^(week)?day/.test(A)?(_+="D",m++):(A==="hour"||A==="min"||A==="sec"||A==="ampm")&&(_+=A[0],d++)}),i.type="date",m&&d?i.type="datetime":!m&&d&&(i.type="time");const p=qE.find(I=>_.startsWith(I[0]));a=p?"D":"G",l=p?p[1]:""}else i.isText?(a="G",i.type="text",l="",i.maxDecimals=0):n.general?(a="G",i.type="general",l=""):n.fractions?(a="G",i.type="fraction",l=""):n.exponential?(a="S",i.type="scientific"):i.isPercent?(a="P",i.type="percent"):n.grouping?(a=",",i.type="grouped"):(n.int_max||s)&&(a="F",i.type="number");return i.code=a+l+c+u,i.level=XE[i.type],Object.freeze(i)}function ZE(e){const[t]=e;return{year:!!(t.date&Rr),month:!!(t.date&Ir),day:!!(t.date&Ds),hours:!!(t.date&Sr),minutes:!!(t.date&Or),seconds:!!(t.date&vr),clockType:t.clock===12?12:24}}const QE=[[Xi,/^General/i,0],[qi,/^#/,0],[kn,/^0/,0],[Ji,/^\?/,0],[Zi,/^\//,0],[eo,/^;/,0],[Ps,/^@/,0],[to,/^\+/,0],[no,/^-/,0],[ks,/^\./,0],[ro,/^ /,0],[so,/^%/,0],[Fs,/^[1-9]/,0],[io,/^(?:B[12])/i,0],[br,/^B$/,0],[oo,/^(?:[hH]+|[mM]+|[sS]+|[yY]+|[bB]+|[dD]+|[gG]+|[aA]{3,}|e+)/,0],[ao,/^(?:\[(h+|m+|s+)\])/i,1],[lo,/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/,[1,2]],[uo,/^\[(DBNum[0-4]?\d)\]/i,1],[co,/^\[(NatNum[0-4]?\d)\]/i,1],[ho,/^\[\$([^\]]+)\]/,1],[fo,/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*\d+)\]/i,1],[sc,/^\[([^\]]+)\]/,1],[mo,/^(?:AM\/PM|am\/pm|A\/P)/,0],[go,/^\\(.)/,1],[_o,/^"([^"]*?)"/,1],[po,/^_(\\.|.)/,1],[Eo,/^[Ee]([+-])/,1],[Co,/^\*(\\.|.)/,1],[Ro,/^[()]/,0],[br,/^[EÈÉÊËèéêëĒēĔĕĖėĘęĚěȄȅȆȇȨȩNnÑñŃńŅņŇňǸǹ["*/\\_]/,0],[xs,/^./,0]],e0=63,t0=35,n0=48,r0=57,Fo=e=>{const t=(e||"\0").charCodeAt(0);return t===e0||t===t0||t>=n0&&t<=r0};function Hn(e){let t=0;const n=[],r=[];for(;t<e.length;){const s=e.slice(t);let i=0;const o=/^(,+)(.)?/.exec(s);if(o){const a=o[1];i=a.length;const l=e[t-1]||"";let u=!1,c=!1;Fo(l)?(u=!0,c=!0):l==="."&&(c=!0);const h=o[2]||"";if(u&&(!h||h===";")&&(u=!1),c&&Fo(h)&&(c=!1),u&&!c)n.push({type:wr,value:",",raw:a});else if(!u&&c)n.push({type:Us,value:",",raw:a});else if(u&&c){const d={type:Us,value:",",raw:a};n.push(d),r.push(d)}else n.push({type:Qi,value:",",raw:a})}else{let a;for(const[l,u,c]of QE){const h=u.exec(s);if(h){const d=Array.isArray(c)?c.map(m=>h[m]):h[c||0];a={type:l,value:d,raw:h[0]},n.push(a),i=h[0].length;break}}r.length&&a.raw===";"&&(r.length=0),r.length&&Fo(a.raw)&&(r.forEach(l=>l.type=wr),r.length=0)}if(!i){const a=s[0];i=1,n.push({type:xs,value:a,raw:a})}t+=i}return n}const xo=e=>{const t=e.condition;t&&t[1]<0&&(t[0]==="<"||t[0]==="<="||t[0]==="=")||e.tokens.unshift({type:"minus",volatile:!0})},Mc=(e,t=null)=>{const n={};for(const r in e)Array.isArray(e[r])?n[r]=[...e[r]]:n[r]=e[r];return t&&n.tokens.unshift(t),n.generated=!0,n};function s0(e){var h;const t=[];let n=!1,r,s=null,i=0,o=!1,a=0,l=0,u=Hn(e);do{if(o=Tr(u),(o.date||o.general)&&(o.int_pattern.length||o.frac_pattern.length||o.scale!==1||o.text))throw new Error("Illegal format");if(o.condition&&(l++,n=!0),o.text){if(s)throw new Error("Unexpected partition");s=o}o.locale&&(r=wo(o.locale)),t.push(o),i=((h=u[o.tokensUsed])==null?void 0:h.type)==="break"?1:0,u=u.slice(o.tokensUsed+i),a++}while(i&&a<4&&l<3);if(i)throw new Error("Unexpected partition");if(l>2)throw new Error("Unexpected condition");const c=t[3];if(c&&(c.int_pattern.length||c.frac_pattern.length||c.date))throw new Error("Unexpected partition");if(n){const d=t.length;if(d===1&&(t[1]=Tr(Hn("General")),t[1].generated=!0),d<3){const m=t[0],_=t[1];if(xo(m),_.condition)xo(_);else{const p=m.condition;(p[0]==="="||p[1]>=0&&(p[0]===">"||p[0]===">="))&&_.tokens.unshift({type:"minus",volatile:!0})}}else t.forEach(xo)}else{if(t.length<4&&s)for(let d=0,m=t.length;d<m;d++)t[d]===s&&t.splice(d,1);if(t.length<1&&s&&(t[0]=Tr(Hn("General")),t[0].generated=!0),t.length<2){const d={type:"minus",volatile:!0};t.push(Mc(t[0],d))}if(t.length<3&&t.push(Mc(t[0])),t.length<4)if(s)t.push(s);else{const d=Tr(Hn("@"));d.generated=!0,t.push(d)}t[0].condition=[">",0],t[1].condition=["<",0],t[2].condition=null}return{pattern:e,partitions:t,locale:r}}const Lc=Object.create({});function nn(e,t=!1){e||(e="General");let n=Lc[e];if(!n)try{n=s0(e),Lc[e]=n}catch(r){if(t)throw r;const s={tokens:[{type:"error"}],error:r.message};n={pattern:e,partitions:[s,s,s,s],error:r.message,locale:null}}return n}function Dc(e,t,n={}){var o;const r=Object.assign({},cc,n),s=nn(e,r.throws),i=(o=Mo(t,r))!=null?o:t;return KE(i,s,r)}function i0(e,t,n){var o;const r=Object.assign({},cc,n),s=nn(e,r.throws),i=(o=Mo(t,r))!=null?o:t;return zE(i,s,r)}function o0(e){const t=nn(e,!1);return Tc(t.partitions)}function a0(e){const t=nn(e,!1);return yc(t.partitions)}function l0(e){const t=nn(e,!1);return Nc(t.partitions)}function u0(e){try{return nn(e,!0),!0}catch{return!1}}function c0(e,t={}){const n=nn(e,!1);return n.info||(n.info=JE(n.partitions,t==null?void 0:t.currency)),n.info}function h0(e){const t=nn(e,!1);return t.dateInfo||(t.dateInfo=ZE(t.partitions)),t.dateInfo}const $n=Object.freeze({AMPM:mo,BREAK:eo,CALENDAR:io,CHAR:xs,COLOR:fo,COMMA:Qi,CONDITION:lo,DATETIME:oo,DBNUM:uo,DIGIT:Fs,DURATION:ao,ERROR:br,ESCAPED:go,EXP:Eo,FILL:Co,GENERAL:Xi,GROUP:wr,HASH:qi,LOCALE:ho,MINUS:no,MODIFIER:sc,NATNUM:co,PAREN:Ro,PERCENT:so,PLUS:to,POINT:ks,QMARK:Ji,SCALE:Us,SKIP:po,SLASH:Zi,SPACE:ro,STRING:_o,TEXT:Ps,ZERO:kn}),d0=Object.freeze(Object.defineProperty({__proto__:null,addLocale:ne,dateFromSerial:DE,dateToSerial:Mo,dec2frac:hc,format:Dc,formatColor:i0,getFormatDateInfo:h0,getFormatInfo:c0,getLocale:xn,isDateFormat:o0,isPercentFormat:a0,isTextFormat:l0,isValidFormat:u0,parseBool:Rc,parseDate:Po,parseLocale:vo,parseNumber:Uo,parseTime:Ws,parseValue:$E,round:It,tokenTypes:$n,tokenize:Hn},Symbol.toStringTag,{value:"Module"})),Uc="@@@",Pc="@",kc="General";function f0(e){return e===Uc||e===Pc}function m0(e){return e==null||e===kc}const g0=(e,t)=>{if(e&&!t||!e&&t)return!1;const n=i=>{const o=Hn(i);let a="",l=!1,u=!1;for(const c of o){if(c.type===$n.POINT){l=!0;continue}if(!(u&&c.type===$n.MINUS)&&c.type!==$n.SKIP){if(c.type===$n.COLOR){u=!0;continue}else u=!1;l&&c.type===$n.ZERO||(l=!1,l||(a+=c.value||""))}}return a},r=n(e),s=n(t);return r===s},_0=new Set(["m d"]),p0=new Set(["h:mm AM/PM","hh:mm AM/PM"]),E0=e=>{var s,i;const t=(i=(s=Po(e))!=null?s:Ws(e))!=null?i:Uo(e);if(!t)return null;const{v:n,z:r}=t;return r&&(_0.has(r)||p0.has(r)&&!/\s(A|AM|P|PM)$/i.test(e)||r.includes("#,##0")&&Dc(r,n)!==e)?null:t},C0={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},R0={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},I0={startRow:0,startColumn:0,endRow:0,endColumn:0},S0={row:0,column:0},st={ff:"Arial",fs:11,it:ae.FALSE,bl:ae.FALSE,ul:{s:ae.FALSE},st:{s:ae.FALSE},ol:{s:ae.FALSE},tr:{a:0,v:ae.FALSE},td:cr.UNSPECIFIED,cl:{rgb:"#000000"},bg:{rgb:"#fff"},ht:wt.UNSPECIFIED,vt:mn.UNSPECIFIED,tb:gn.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null,bd:{b:null,l:null,r:null,t:null}},Fc={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}},O0=[ai,Ca,li],v0={[qe.HEADING_1]:{fs:20,bl:1},[qe.HEADING_2]:{fs:18,bl:1},[qe.HEADING_3]:{fs:16,bl:1},[qe.HEADING_4]:{fs:14,bl:1},[qe.HEADING_5]:{fs:12,bl:1},[qe.NORMAL_TEXT]:null,[qe.TITLE]:{fs:26,bl:1},[qe.SUBTITLE]:{fs:15,cl:{rgb:"#999999"}},[qe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},jn=4,w0={[qe.HEADING_1]:{spaceAbove:{v:20},spaceBelow:{v:6+jn}},[qe.HEADING_2]:{spaceAbove:{v:18},spaceBelow:{v:6+jn}},[qe.HEADING_3]:{spaceAbove:{v:16},spaceBelow:{v:6+jn}},[qe.HEADING_4]:{spaceAbove:{v:14},spaceBelow:{v:4+jn}},[qe.HEADING_5]:{spaceAbove:{v:12},spaceBelow:{v:4+jn}},[qe.NORMAL_TEXT]:{spaceAbove:{v:0},spaceBelow:{v:0}},[qe.TITLE]:{spaceAbove:{v:0},spaceBelow:{v:3+jn}},[qe.SUBTITLE]:{spaceAbove:{v:0},spaceBelow:{v:16}},[qe.NAMED_STYLE_TYPE_UNSPECIFIED]:null},b0="univer-sheets-chart-print-chart",A0="univer-docs-drawing-printing";var xc=(e=>(e.ARRAY_CONVERTOR="ARRAY_CONVERTOR",e.MATRIX_CONVERTOR="MATRIX_CONVERTOR",e))(xc||{});const y0={[ct.A3]:{width:1123,height:1587},[ct.A4]:{width:794,height:1124},[ct.A5]:{width:559,height:794},[ct.B4]:{width:944,height:1344},[ct.B5]:{width:665,height:944},[ct.Executive]:{width:696,height:1008},[ct.Folio]:{width:816,height:1248},[ct.Legal]:{width:816,height:1344},[ct.Letter]:{width:816,height:1056},[ct.Statement]:{width:528,height:816},[ct.Tabloid]:{width:1056,height:1632}};function Ys(e,t){const{textRuns:n=[]}=t;let r=0;for(const i of n){const{ts:o={},st:a,ed:l}=i;if(o[e]==null)return ae.FALSE;switch(e){case"bl":case"it":{if(o[e]===ae.FALSE)return ae.FALSE;break}case"ul":case"st":{if(o[e].s===ae.FALSE)return ae.FALSE;break}default:throw new Error(`unknown style key: ${e} in IStyleBase`)}r+=l-a}return t.dataStream.indexOf(`\r
`)===r?ae.TRUE:ae.FALSE}const Kr=class Kr{constructor(t,n,r){E(this,"_range");E(this,"_worksheet");this._deps=r,this._range=n,this._worksheet=t}static foreach(t,n){const{startRow:r,startColumn:s,endRow:i,endColumn:o}=t;for(let a=r;a<=i;a++)for(let l=s;l<=o;l++)n(a,l)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=[];for(let o=t;o<=n;o++){const a=[];for(let l=r;l<=s;l++)a.push(this.getMatrix().getValue(o,l)||null);i.push(a)}return i}getMatrix(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=this._worksheet.getCellMatrix(),o=new lt;for(let a=t;a<=n;a++)for(let l=r;l<=s;l++)o.setValue(a,l,i.getValue(a,l)||null);return o}getMatrixObject(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range,i=this._worksheet.getCellMatrix(),o=new lt;for(let a=t;a<=n;a++)for(let l=r;l<=s;l++)o.setValue(a-t,l-r,i.getValue(a,l)||{});return o}getA1Notation(){const{startRow:t,endRow:n,startColumn:r,endColumn:s}=this._range;let i,o;return r<s?(i=Z.numToWord(r+1)+(t+1),o=Z.numToWord(s+1)+(n+1)):(i=Z.numToWord(s+1)+(n+1),o=Z.numToWord(r+1)+(t+1)),i===o?`${i}`:`${i}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const s=t.getStyleByCell(r);return((i=s==null?void 0:s.bg)==null?void 0:i.rgb)||st.bg.rgb}))}getCell(t,n){const{startRow:r,startColumn:s}=this._range,i={startRow:r+t,endRow:r+t,startColumn:s+n,endColumn:s+n};return new Kr(this._worksheet,i,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(t={}){return this.getObjectValues(t)[0][0]}getObjectValues(t={}){var a;const{startRow:n,endRow:r,startColumn:s,endColumn:i}=this._range,o=this._worksheet.getCellMatrix().getFragment(n,r,s,i).getData();if(t.isIncludeStyle){const l=this._deps.getStyles();for(let u=0;u<=r-n;u++)for(let c=0;c<=i-s;c++){if(o==null||((a=o==null?void 0:o[u])==null?void 0:a[c])==null)continue;const h=o[u][c].s;h&&(o[u][c].s=l.get(h))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const s=t.getStyleByCell(r);return((i=s==null?void 0:s.cl)==null?void 0:i.rgb)||st.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Ys("ul",t.body)===ae.TRUE?{s:ae.TRUE}:{s:ae.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Ys("st",t.body)===ae.TRUE?{s:ae.TRUE}:{s:ae.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var n,r;const t=((n=this.getValue())==null?void 0:n.p)||{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?t.body.textRuns.some(s=>{var i;return((i=s==null?void 0:s.ts)==null?void 0:i.fs)!=null})?Math.max(...t.body.textRuns.map(s=>{var i;return((i=s==null?void 0:s.ts)==null?void 0:i.fs)||0})):this.getFontSizes()[0][0]:this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Ys("it",t.body)===ae.TRUE?us.ITALIC:us.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var n,r;const{p:t}=(n=this.getValue())!=null?n:{};return t&&Array.isArray((r=t.body)==null?void 0:r.textRuns)&&t.body.textRuns.length>0?Ys("bl",t.body)===ae.TRUE?cs.BOLD:cs.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:t,_worksheet:n}=this,{startRow:r,endRow:s}=t;let i=0;for(let o=0;o<=s-r;o++){const a=n.getRowHeight(o);i+=a}return i}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:t,endColumn:n}=this._range;return n-t+1}getNumRows(){const{startRow:t,endRow:n}=this._range;return n-t+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(t=>t.map(n=>(n==null?void 0:n.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const t=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>t.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:t,_worksheet:n}=this,{startColumn:r,endColumn:s}=t;let i=0;for(let o=0;o<=s-r;o++)i+=n.getColumnWidth(o);return i}getWrap(){return this.getWrapStrategy()===gn.WRAP?ae.TRUE:ae.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(t){Kr.foreach(this._range,t)}_getStyles(t){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(s=>{const i=n&&n.getStyleByCell(s);return i&&i[t]||st[t]}))}};E(Kr,"transformRange",(t,n)=>{const r=n.getMaxColumns()-1,s=n.getMaxRows()-1;return t.rangeType===pe.ALL?{startColumn:0,startRow:0,endColumn:r,endRow:s}:t.rangeType===pe.COLUMN?{startRow:0,endRow:s,startColumn:t.startColumn,endColumn:t.endColumn}:t.rangeType===pe.ROW?{startColumn:0,endColumn:r,startRow:t.startRow,endRow:t.endRow}:{startColumn:t.startColumn,endColumn:Math.min(t.endColumn,r),startRow:t.startRow,endRow:Math.min(t.endRow,s)}});let Wn=Kr;function Bc(e,t,n=0,r=e.length-1,s=T0){for(;r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1),m=Math.max(n,Math.floor(t-u*h/l+d)),_=Math.min(r,Math.floor(t+(l-u)*h/l+d));Bc(e,t,m,_,s)}const i=e[t];let o=n,a=r;for(Mr(e,n,t),s(e[r],i)>0&&Mr(e,n,r);o<a;){for(Mr(e,o,a),o++,a--;s(e[o],i)<0;)o++;for(;s(e[a],i)>0;)a--}s(e[n],i)===0?Mr(e,n,a):(a++,Mr(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}}function Mr(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function T0(e,t){return e<t?-1:e>t?1:0}class Gs{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let n=this.data;const r=[];if(!zs(t,n))return r;const s=this.toBBox,i=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?s(a):a;zs(t,l)&&(n.leaf?r.push(a):Ho(t,l)?this._all(a,r):i.push(a))}n=i.pop()}return r}collides(t){let n=this.data;if(!zs(t,n))return!1;const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const i=n.children[s],o=n.leaf?this.toBBox(i):i;if(zs(t,o)){if(n.leaf||Ho(t,o))return!0;r.push(i)}}n=r.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return this}let n=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Gn([]),this}remove(t,n){if(!t)return this;let r=this.data;const s=this.toBBox(t),i=[],o=[];let a,l,u;for(;r||i.length;){if(r||(r=i.pop(),l=i[i.length-1],a=o.pop(),u=!0),r.leaf){const c=N0(t,r.children,n);if(c!==-1)return r.children.splice(c,1),i.push(r),this._condense(i),this}!u&&!r.leaf&&Ho(r,s)?(i.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],u=!1):r=null}return this}toBBox(t){return t}compareMinX(t,n){return t.minX-n.minX}compareMinY(t,n){return t.minY-n.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,n){const r=[];for(;t;)t.leaf?n.push(...t.children):r.push(...t.children),t=r.pop();return n}_build(t,n,r,s){const i=r-n+1;let o=this._maxEntries,a;if(i<=o)return a=Gn(t.slice(n,r+1)),Yn(a,this.toBBox),a;s||(s=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/Math.pow(o,s-1))),a=Gn([]),a.leaf=!1,a.height=s;const l=Math.ceil(i/o),u=l*Math.ceil(Math.sqrt(o));Hc(t,n,r,u,this.compareMinX);for(let c=n;c<=r;c+=u){const h=Math.min(c+u-1,r);Hc(t,c,h,l,this.compareMinY);for(let d=c;d<=h;d+=l){const m=Math.min(d+l-1,h);a.children.push(this._build(t,d,m,s-1))}}return Yn(a,this.toBBox),a}_chooseSubtree(t,n,r,s){for(;s.push(n),!(n.leaf||s.length-1===r);){let i=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const u=n.children[l],c=Bo(u),h=D0(t,u)-c;h<o?(o=h,i=c<i?c:i,a=u):h===o&&c<i&&(i=c,a=u)}n=a||n.children[0]}return n}_insert(t,n,r){const s=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(s,this.data,n,i);for(o.children.push(t),Dr(o,s);n>=0&&i[n].children.length>this._maxEntries;)this._split(i,n),n--;this._adjustParentBBoxes(s,i,n)}_split(t,n){const r=t[n],s=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,s);const o=this._chooseSplitIndex(r,i,s),a=Gn(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Yn(r,this.toBBox),Yn(a,this.toBBox),n?t[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(t,n){this.data=Gn([t,n]),this.data.height=t.height+1,this.data.leaf=!1,Yn(this.data,this.toBBox)}_chooseSplitIndex(t,n,r){let s,i=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=Lr(t,0,a,this.toBBox),u=Lr(t,a,r,this.toBBox),c=U0(l,u),h=Bo(l)+Bo(u);c<i?(i=c,s=a,o=h<o?h:o):c===i&&h<o&&(o=h,s=a)}return s||r-n}_chooseSplitAxis(t,n,r){const s=t.leaf?this.compareMinX:M0,i=t.leaf?this.compareMinY:L0,o=this._allDistMargin(t,n,r,s),a=this._allDistMargin(t,n,r,i);o<a&&t.children.sort(s)}_allDistMargin(t,n,r,s){t.children.sort(s);const i=this.toBBox,o=Lr(t,0,n,i),a=Lr(t,r-n,r,i);let l=Vs(o)+Vs(a);for(let u=n;u<r-n;u++){const c=t.children[u];Dr(o,t.leaf?i(c):c),l+=Vs(o)}for(let u=r-n-1;u>=n;u--){const c=t.children[u];Dr(a,t.leaf?i(c):c),l+=Vs(a)}return l}_adjustParentBBoxes(t,n,r){for(let s=r;s>=0;s--)Dr(n[s],t)}_condense(t){for(let n=t.length-1,r;n>=0;n--)t[n].children.length===0?n>0?(r=t[n-1].children,r.splice(r.indexOf(t[n]),1)):this.clear():Yn(t[n],this.toBBox)}}function N0(e,t,n){if(!n)return t.indexOf(e);for(let r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function Yn(e,t){Lr(e,0,e.children.length,t,e)}function Lr(e,t,n,r,s){s||(s=Gn(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let i=t;i<n;i++){const o=e.children[i];Dr(s,e.leaf?r(o):o)}return s}function Dr(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function M0(e,t){return e.minX-t.minX}function L0(e,t){return e.minY-t.minY}function Bo(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Vs(e){return e.maxX-e.minX+(e.maxY-e.minY)}function D0(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function U0(e,t){const n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,i-r)}function Ho(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function zs(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Gn(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Hc(e,t,n,r,s){const i=[t,n];for(;i.length;){if(n=i.pop(),t=i.pop(),n-t<=r)continue;const o=t+Math.ceil((n-t)/r/2)*r;Bc(e,o,t,n,s),i.push(t,o,o,n)}}function P0(e,t,n,r=!1){if(t===0&&n===0)return e;let s={...e};const i=s.startAbsoluteRefType||Ne.NONE,o=s.endAbsoluteRefType||Ne.NONE,a=s.rangeType||pe.NORMAL;if(!r&&i===Ne.ALL&&o===Ne.ALL)return s;const l=$c(s.startRow,n,s.startColumn,t,a),u=$c(s.endRow,n,s.endColumn,t,a);return r||i===Ne.NONE&&o===Ne.NONE?s={...s,startRow:l.row,startColumn:l.column,endRow:u.row,endColumn:u.column}:(i===Ne.NONE?s={...s,startRow:l.row,startColumn:l.column}:i===Ne.COLUMN?s={...s,startRow:l.row}:i===Ne.ROW&&(s={...s,startColumn:l.column}),o===Ne.NONE?s={...s,endRow:u.row,endColumn:u.column}:o===Ne.COLUMN?s={...s,endRow:u.row}:o===Ne.ROW&&(s={...s,endColumn:u.column}),s)}function $c(e,t,n,r,s){return s===pe.NORMAL?{row:e+t,column:n+r}:s===pe.ROW?{row:e+t,column:n}:s===pe.COLUMN?{row:e,column:n+r}:{row:e,column:n}}function $o(e){const t=new Set,n=new Set;for(const o of e)t.add(o.startColumn),t.add(o.endColumn+1),n.add(o.startRow),n.add(o.endRow+1);const r=Array.from(t).sort((o,a)=>o-a),s=Array.from(n).sort((o,a)=>o-a);e.sort((o,a)=>o.startRow-a.startRow||o.startColumn-a.startColumn);const i=[];for(let o=0;o<s.length-1;o++)for(let a=0;a<r.length-1;a++){const l=r[a],u=r[a+1]-1,c=s[o],h=s[o+1]-1;for(const d of e){if(d.startRow>h)break;if(d.startRow<=c&&d.endRow>=h&&d.startColumn<=l&&d.endColumn>=u){i.push({startColumn:l,endColumn:u,startRow:c,endRow:h});break}}}return i}function k0(e){e.sort((r,s)=>r.startRow-s.startRow||r.startColumn-s.startColumn);const t={};for(const r of e)t[r.startRow]||(t[r.startRow]=[]),t[r.startRow].push(r);const n=[];for(const r in t){const s=t[+r];s.sort((o,a)=>o.startColumn-a.startColumn);let i=s[0];for(let o=1;o<s.length;o++){const a=s[o];a.startColumn<=i.endColumn+1&&a.startRow===i.startRow&&a.endRow===i.endRow?i.endColumn=Math.max(i.endColumn,a.endColumn):(n.push(i),i=a)}n.push(i)}return n}function F0(e){e.sort((r,s)=>r.startColumn-s.startColumn||r.startRow-s.startRow);const t={};for(const r of e)t[r.startColumn]||(t[r.startColumn]=[]),t[r.startColumn].push(r);const n=[];for(const r in t){const s=t[+r];s.sort((o,a)=>o.startRow-a.startRow);let i=s[0];for(let o=1;o<s.length;o++){const a=s[o];a.startRow<=i.endRow+1&&a.startColumn===i.startColumn&&a.endColumn===i.endColumn?i.endRow=Math.max(i.endRow,a.endRow):(n.push(i),i=a)}n.push(i)}return n}function x0(e){const t=$o(e),n=k0(t);return F0(n)}function B0(e,t){const n=[];return e.forEach(r=>{n.push(...rn.subtract(r,t))}),rn.mergeRanges(n)}function jc(e,t){const n=Wc(e.startRow,e.endRow,t.startRow,t.endRow),r=Wc(e.startColumn,e.endColumn,t.startColumn,t.endColumn);if(!n||!r)return null;const[s,i]=n,[o,a]=r,l=H0(e.rangeType,t.rangeType,s,i,o,a);return{startRow:s,endRow:i,startColumn:o,endColumn:a,rangeType:l}}function Wc(e,t,n,r){const s=isNaN(e)?-1/0:e,i=isNaN(t)?1/0:t,o=isNaN(n)?-1/0:n,a=isNaN(r)?1/0:r,l=Math.max(s,o),u=Math.min(i,a);if(l<=u){const c=l===-1/0?Number.NaN:l,h=u===1/0?Number.NaN:u;return[c,h]}else return null}function H0(e,t,n,r,s,i){const o=e!==void 0?e:Yc(n,r,s,i),a=t!==void 0?t:Yc(n,r,s,i);return o===pe.ALL||a===pe.ALL?o===a?o:o===pe.ALL?a:o:o===a?o:(o===pe.NORMAL||a===pe.NORMAL,pe.NORMAL)}function Yc(e,t,n,r){const s=!isNaN(e)&&!isNaN(t),i=!isNaN(n)&&!isNaN(r);return s&&i?pe.NORMAL:s?pe.ROW:i?pe.COLUMN:pe.ALL}const Gt=class Gt{static clone(t){return t.rangeType!==void 0?{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:t.rangeType}:{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}static equals(t,n){return t==null||n==null?!1:t.endRow===n.endRow&&t.endColumn===n.endColumn&&t.startRow===n.startRow&&t.startColumn===n.startColumn&&(t.rangeType===n.rangeType||t.rangeType===void 0&&n.rangeType===pe.NORMAL||n.rangeType===void 0&&t.rangeType===pe.NORMAL)}static simpleRangesIntersect(t,n){const{startRow:r,endRow:s,startColumn:i,endColumn:o}=t,{startRow:a,endRow:l,startColumn:u,endColumn:c}=n,h=r<=l&&s>=a,d=i<=c&&o>=u;return h&&d}static intersects(t,n){if(t.rangeType===pe.ROW&&n.rangeType===pe.COLUMN||t.rangeType===pe.COLUMN&&n.rangeType===pe.ROW)return!0;if(t.rangeType===pe.ROW&&n.rangeType===pe.ROW)return t.startRow<=n.endRow&&t.endRow>=n.startRow;if(t.rangeType===pe.COLUMN&&n.rangeType===pe.COLUMN)return t.startColumn<=n.endColumn&&t.endColumn>=n.startColumn;const r=Math.floor(Number.MAX_SAFE_INTEGER/10),s=Number.isNaN(t.startRow)?0:t.startRow,i=Number.isNaN(t.endRow)?r:t.endRow,o=Number.isNaN(t.startColumn)?0:t.startColumn,a=Number.isNaN(t.endColumn)?r:t.endColumn,l=Number.isNaN(n.startRow)?0:n.startRow,u=Number.isNaN(n.endRow)?r:n.endRow,c=Number.isNaN(n.startColumn)?0:n.startColumn,h=Number.isNaN(n.endColumn)?r:n.endColumn,d=Math.abs(o+a-c-h),m=Math.abs(o-a)+Math.abs(c-h),_=Math.abs(s+i-l-u),p=Math.abs(s-i)+Math.abs(l-u);return d<=m&&_<=p}static doAnyRangesIntersect(t,n){const r=new Gs;return r.load(t.map(s=>({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}))),n.some(s=>r.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}).length>0)}static getIntersects(t,n){const r=t.startRow,s=t.endRow,i=t.startColumn,o=t.endColumn,a=n.startRow,l=n.endRow,u=n.startColumn,c=n.endColumn;let h,d,m,_;if(a<=s)a>=r?d=a:d=r;else return null;if(l>=r)l>=s?_=s:_=l;else return null;if(u<=o)u>i?h=u:h=i;else return null;if(c>=i)c>=o?m=o:m=c;else return null;return{startRow:d,endRow:_,startColumn:h,endColumn:m,rangeType:pe.NORMAL}}static contains(t,n){return t.startRow<=n.startRow&&t.endRow>=n.endRow&&t.startColumn<=n.startColumn&&t.endColumn>=n.endColumn}static realContain(t,n){return Gt.contains(t,n)&&(t.startRow<n.startRow||t.endRow>n.endRow||t.startColumn<n.startColumn||t.endColumn>n.endColumn)}static union(...t){return t.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:pe.NORMAL}),t[0])}static realUnion(...t){const n=t.some(i=>i.rangeType===pe.COLUMN),r=t.some(i=>i.rangeType===pe.ROW),s=Gt.union(...t);return{startColumn:r?Number.NaN:s.startColumn,endColumn:r?Number.NaN:s.endColumn,startRow:n?Number.NaN:s.startRow,endRow:n?Number.NaN:s.endRow,rangeType:r?pe.ROW:n?pe.COLUMN:pe.NORMAL}}static subtract(t,n){if(n.startRow>t.endRow||n.endRow<t.startRow||n.startColumn>t.endColumn||n.endColumn<t.startColumn)return[t];const r=[];n.startRow>=t.startRow&&r.push({startRow:t.startRow,startColumn:t.startColumn,endRow:n.startRow-1,endColumn:t.endColumn}),n.endRow<=t.endRow&&r.push({startRow:n.endRow+1,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn});const s=Math.max(t.startRow,n.startRow),i=Math.min(t.endRow,n.endRow);return n.startColumn>=t.startColumn&&r.push({startRow:s,startColumn:t.startColumn,endRow:i,endColumn:n.startColumn-1}),n.endColumn<=t.endColumn&&r.push({startRow:s,startColumn:n.endColumn+1,endRow:i,endColumn:t.endColumn}),r.filter(a=>a.startRow<=a.endRow&&a.startColumn<=a.endColumn)}static mergeRanges(t){return x0(t)}static splitIntoGrid(t){return $o(t)}static subtractMulti(t,n){if(!n.length)return t;let r=t;return n.forEach(s=>{r=B0(r,s)}),r}static hasIntersectionBetweenTwoRect(t,n){return!(t.left>n.right||t.right<n.left||t.top>n.bottom||t.bottom<n.top)}static getIntersectionBetweenTwoRect(t,n){const r=Math.max(t.left,n.left),s=Math.min(t.right,n.right),i=Math.max(t.top,n.top),o=Math.min(t.bottom,n.bottom);return s<=r||o<=i?null:{left:r,right:s,top:i,bottom:o,width:s-r,height:o-i}}static sort(t){return t.sort((n,r)=>n.startRow-r.startRow||n.startColumn-r.startColumn)}};E(Gt,"getRelativeRange",(t,n)=>({startRow:t.startRow-n.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-n.startColumn,endColumn:t.endColumn-t.startColumn})),E(Gt,"getPositionRange",(t,n,r)=>({...r||{},startRow:r&&[Ne.ROW,Ne.ALL].includes(r.startAbsoluteRefType||0)?r.startRow:t.startRow+n.startRow,endRow:r&&[Ne.ROW,Ne.ALL].includes(r.endAbsoluteRefType||0)?r.endRow:t.endRow+t.startRow+n.startRow,startColumn:r&&[Ne.COLUMN,Ne.ALL].includes(r.startAbsoluteRefType||0)?r.startColumn:t.startColumn+n.startColumn,endColumn:r&&[Ne.COLUMN,Ne.ALL].includes(r.endAbsoluteRefType||0)?r.endColumn:t.endColumn+t.startColumn+n.startColumn})),E(Gt,"moveHorizontal",(t,n=0,r=0)=>({...t,startColumn:t.startColumn+n,endColumn:t.endColumn+n+r})),E(Gt,"moveVertical",(t,n=0,r=0)=>({...t,startRow:t.startRow+n,endRow:t.endRow+n+r})),E(Gt,"moveOffset",(t,n,r)=>{const s={...t};switch(t.startAbsoluteRefType){case Ne.ROW:s.startColumn+=n;break;case Ne.COLUMN:s.startRow+=r;break;case Ne.ALL:break;case Ne.NONE:default:s.startRow+=r,s.startColumn+=n;break}switch(t.endAbsoluteRefType){case Ne.ROW:s.endColumn+=n;break;case Ne.COLUMN:s.endRow+=r;break;case Ne.ALL:break;case Ne.NONE:default:s.endRow+=r,s.endColumn+=n;break}return s});let rn=Gt;function $0(e,t){if(e.length===0||e[0].length===0)return null;const n=new Array(e[0].length).fill(0);let r=0,s=null;for(let i=0;i<e.length;i++){for(let a=0;a<e[0].length;a++)n[a]=t(e[i][a])?n[a]+1:0;const o=j0(n);o.area>r&&(r=o.area,s={startColumn:o.start,startRow:i-o.height+1,endColumn:o.end,endRow:i})}return s}function j0(e){const t=[];let n=0,r={area:0,height:0,start:0,end:0},s=0;for(;s<e.length;)if(t.length===0||e[s]>=e[t[t.length-1]])t.push(s++);else{const i=e[t.pop()],o=t.length===0?s:s-t[t.length-1]-1;i*o>n&&(n=i*o,r={area:n,height:i,start:t.length===0?0:t[t.length-1]+1,end:s-1})}for(;t.length>0;){const i=e[t.pop()],o=t.length===0?s:s-t[t.length-1]-1;i*o>n&&(n=i*o,r={area:n,height:i,start:t.length===0?0:t[t.length-1]+1,end:s-1})}return r}function W0(e,t){Wn.foreach(t,(n,r)=>{e[n][r]=void 0})}function Y0(e,t){const n=e.toFullArray(),r=[];for(;;){const s=$0(n,t);if(!s)break;r.push(s),W0(n,s)}return r}class G0{constructor(t,n){E(this,"_values",[]);E(this,"_keys",[]);E(this,"_keyMaps",new Map);this._values=t,this._keys=n,t.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(t){this._keys.forEach(n=>{const r=t[n],s=this._keyMaps.get(n)||new Map;s.set(r,t),this._keyMaps.set(n,s)})}getValue(t,n){const r=n||this._keys;for(let s=0;s<r.length;s++){const i=this._keyMaps.get(r[s]);if(i!=null&&i.has(t))return i.get(t)}return null}hasValue(t){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(t))return!0}return!1}addValue(t){this._values.push(t),this._initKeyMap(t)}setValue(t,n,r){const s=this.getValue(t);s&&Object.keys(s).includes(n)&&(s[n]=r)}deleteValue(t,n){const r=this.getValue(t,n);if(r){this._keys.forEach(i=>{const o=this._keyMaps.get(i),a=r[i];o==null||o.delete(a)});const s=this._values.findIndex(i=>i===r);this._values.splice(s,1)}}getValues(){return this._values}getKeyMap(t){var n;return[...((n=this._keyMaps.get(t))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}}function jo(e,t,n,r){return{forEach(s){for(let i=e;i<=t;i++)for(let o=n;o<=r;o++)s(i,o)}}}function V0(e){if(e==null||e.length===0)return Number.NaN;const t=e.toLowerCase().split(""),n=t.length,r=o=>o.charCodeAt(0)-96;let s=0,i=0;for(let o=0;o<n;o++)i=r(t[o]),s+=i*26**(n-o-1);return s===0?Number.NaN:s-1}const Ks=65,Gc=90,z0=97;function K0(e){const t=Gc-Ks+1;let n="";for(;e>=0;)n=String.fromCharCode(e%t+Ks)+n,e=Math.floor(e/t)-1;return n}function Vc(e,t){let n="";for(;t>0;)n+=e,t--;return n}function X0(e,t=!1){const n=Gc-Ks+1;let r=z0;t&&(r=Ks);const s=String.fromCharCode(e%n+r),i=Math.floor(e/n)+1;return Vc(s,i)}function q0(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function J0(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}function Ur(e="index",t=1){return(n,r)=>n[e]>r[e]?t:n[e]===r[e]?0:-t}function Pr(e,t=!1){const n=[];for(const r of e){const{st:s,ed:i,ts:o}=r;if(r.sId===void 0&&delete r.sId,s===i||!t&&Z.isEmptyObject(o)&&r.sId==null)continue;if(n.length===0){n.push(r);continue}const a=n.pop();Wu(r,a)&&Z.hasIntersectionBetweenTwoRanges(a.st,a.ed,r.st,r.ed)?n.push({...r,st:a.st,ed:i}):n.push(a,r)}return n}function zc(e,t,n,r){var u;const{textRuns:s}=e;if(s==null)return;const i=[],o=s.length;let a=!1;const l=(u=t.textRuns)!=null?u:[];if(l.length)for(const c of l)c.st+=r,c.ed+=r;for(let c=0;c<o;c++){const h=s[c],{st:d,ed:m}=h;if(m<=r)i.push(h);else if(r>d&&r<m){a=!0;const _={...h,ed:r};i.push(_),l.length&&i.push(...l);const p={...h,st:r+n,ed:m+n};i.push(p)}else h.st+=n,h.ed+=n,a||(a=!0,i.push(...l)),i.push(h)}a||(a=!0,i.push(...l)),e.textRuns=Pr(i)}function Kc(e,t,n,r){const{paragraphs:s}=e;if(s==null)return;const{paragraphs:i}=t,o=[];for(let l=0,u=s.length;l<u;l++){const c=s[l],{startIndex:h}=c;h>=r&&(c.startIndex+=n),o.push(c.startIndex)}let a=-1;if(i){for(let l=0,u=i.length;l<u;l++){const c=i[l];c.startIndex+=r;const h=c.startIndex;a=o.indexOf(h)}a!==-1&&s.splice(a,1),s.push(...i),s.sort(Ur("startIndex"))}}function Xc(e,t,n,r){const{sectionBreaks:s}=e;if(s==null)return;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const i=t.sectionBreaks;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r}s.push(...i),s.sort(Ur("startIndex"))}}function qc(e,t,n,r){const{customBlocks:s=[]}=e;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const i=t.customBlocks;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r}s.push(...i),s.sort(Ur("startIndex"))}s.length&&!e.customBlocks&&(e.customBlocks=s)}function Jc(e,t,n,r){const{tables:s}=e;if(s==null)return;for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:u,endIndex:c}=l;u>r?(l.startIndex+=n,l.endIndex+=n):c>r&&(l.endIndex+=n)}const i=t.tables;if(i){for(let o=0,a=i.length;o<a;o++){const l=i[o];l.startIndex+=r,l.endIndex+=r}s.push(...i),s.sort(Ur("startIndex"))}}const Zc="$",Qc=e=>e.split(Zc)[0];function Wo(e){if(e.length<=1)return e;e.sort((s,i)=>s.startIndex-i.startIndex);const t=[];let n={...e[0]};n.rangeId=Qc(n.rangeId);for(let s=1;s<e.length;s++){const i=e[s];i.rangeId=Qc(i.rangeId),i.rangeId===n.rangeId&&wa(n.properties,i.properties)&&n.endIndex+1>=i.startIndex?n.endIndex=i.endIndex:(t.push(n),n={...i})}t.push(n);const r=Object.create(null);for(let s=0,i=t.length;s<i;s++){const o=t[s],a=o.rangeId;r[a]?(o.rangeId=`${a}${Zc}${r[a]}`,r[a]=r[a]+1):r[a]=1}return t}function Yo(e,t){const n=e.findIndex(s=>s.startIndex<t&&s.endIndex>=t),r=e[n];r&&e.splice(n,1,{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:r.startIndex,endIndex:t-1,properties:{...r.properties}},{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:t,endIndex:r.endIndex,properties:{...r.properties}})}function eh(e){if(e.length<=1)return e;e.sort((r,s)=>r.startIndex-s.startIndex);const t=[];let n={...e[0]};for(let r=1;r<e.length;r++){const s=e[r];s.id===n.id&&n.endIndex+1>=s.startIndex?n.endIndex=s.endIndex:(t.push(n),n={...s})}return t.push(n),t}function Go(e,t){e.filter(r=>r.startIndex<t&&r.endIndex>=t).forEach(r=>{const s=e.indexOf(r);e.splice(s,1,{id:r.id,type:r.type,startIndex:r.startIndex,endIndex:t-1},{id:r.id,type:r.type,startIndex:t,endIndex:r.endIndex})})}function Z0(e,t,n,r){e.customRanges||(e.customRanges=[]);const{customRanges:s}=e;Yo(s,r);for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:u}=l;u>=r&&(l.startIndex+=n,l.endIndex+=n)}const i=[];if(t.customRanges){for(let o=0,a=t.customRanges.length;o<a;o++){const l=t.customRanges[o];l.startIndex+=r,l.endIndex+=r,i.push(l)}s.push(...i)}e.customRanges=Wo(s)}function Q0(e,t,n,r){e.customDecorations||(e.customDecorations=[]);const{customDecorations:s}=e;Go(s,r);for(let o=0,a=s.length;o<a;o++){const l=s[o],{startIndex:u}=l;u>=r&&(l.startIndex+=n,l.endIndex+=n)}const i=[];if(t.customDecorations){for(let o=0,a=t.customDecorations.length;o<a;o++){const l=t.customDecorations[o];l.startIndex+=r,l.endIndex+=r,i.push(l)}s.push(...i)}e.customDecorations=eh(s)}function th(e,t,n){const{textRuns:r}=e,s=n,i=n+t,o=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{st:h,ed:d}=c;if(s<=h&&i>=d){o.push({...c,st:h-s,ed:d-s});continue}else h<=s&&d>=i?(o.push({...c,st:s-s,ed:i-s}),c.ed-=t):s>=h&&s<d?(o.push({...c,st:s-s,ed:d-s}),c.ed=s):i>h&&i<=d?(o.push({...c,st:h-s,ed:i-s}),c.st=i-t,c.ed-=t):h>=i&&(c.st-=t,c.ed-=t);a.push(c)}e.textRuns=a}return o.length===0&&o.push({st:0,ed:t,ts:{}}),o}function nh(e,t,n){const{paragraphs:r}=e,s=n,i=n+t,o=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h}=c;if(h>=s&&h<i){o.push({...c,startIndex:h-n});continue}else h>=i&&(c.startIndex-=t);a.push(c)}e.paragraphs=a}return o}function rh(e,t,n){const{sectionBreaks:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h}=c;if(h>=s&&h<=i){o.push({...c,startIndex:h-n});continue}else h>i&&(c.startIndex-=t);a.push(c)}e.sectionBreaks=a}return o}function sh(e,t,n){const{customBlocks:r=[]}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h}=c;if(h>=s&&h<=i){o.push({...c,startIndex:h-n});continue}else h>i&&(c.startIndex-=t);a.push(c)}e.customBlocks=a}return r.length&&!e.customBlocks&&(e.customBlocks=r),o}function ih(e,t,n){const{tables:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h,endIndex:d}=c;if(s<=h&&i>=d){o.push({...c,startIndex:h-n,endIndex:d-n});continue}else if(h<=s&&d>=i){const m=Ls(h,d,s,i);if(m.length===0||(c.startIndex=m[0],c.endIndex=m[1],c.startIndex===c.endIndex))continue}else i<h&&(c.startIndex-=t,c.endIndex-=t);a.push(c)}e.tables=a}return o}function eC(e,t,n){const{customRanges:r}=e,s=n,i=n+t-1,o=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h,endIndex:d}=c;if(h>=s&&d<=i){o.push(c);continue}else if(Math.max(s,h)<=Math.min(i,d)){const m=Ls(h,d,s,i);if(m.length===0)continue;c.startIndex=m[0],c.endIndex=m[1]}else i<h&&(c.startIndex-=t,c.endIndex-=t);a.push(c)}e.customRanges=Wo(a)}return o}function tC(e,t,n,r=!0){const{customDecorations:s}=e,i=n,o=n+t-1,a=[];if(s){const l=[];for(let u=0,c=s.length;u<c;u++){const h=s[u],{startIndex:d,endIndex:m}=h;if(d>=i&&m<=o){a.push(h);continue}else if(Math.max(i,d)<=Math.min(o,m)){const _=Ls(d,m,i,o);if(_.length===0)continue;h.startIndex=_[0],h.endIndex=_[1]}else o<d&&r&&(h.startIndex-=t,h.endIndex-=t);l.push(h)}e.customDecorations=l}return a}var oh=(e=>(e.ORDER_LIST_QUICK_1="1.",e.ORDER_LIST_QUICK_2="a)",e.ORDER_LIST_QUICK_3="a.",e.ORDER_LIST_QUICK_4="i.",e.ORDER_LIST_QUICK_5="A.",e.ORDER_LIST_QUICK_6="I.",e.ORDER_LIST_QUICK_7="01.",e.BULLET_LIST="*",e))(oh||{}),xt=(e=>(e.BULLET_LIST="BULLET_LIST",e.BULLET_LIST_1="BULLET_LIST_1",e.BULLET_LIST_2="BULLET_LIST_2",e.BULLET_LIST_3="BULLET_LIST_3",e.BULLET_LIST_4="BULLET_LIST_4",e.BULLET_LIST_5="BULLET_LIST_5",e.ORDER_LIST="ORDER_LIST",e.ORDER_LIST_1="ORDER_LIST_1",e.ORDER_LIST_2="ORDER_LIST_2",e.ORDER_LIST_3="ORDER_LIST_3",e.ORDER_LIST_4="ORDER_LIST_4",e.ORDER_LIST_5="ORDER_LIST_5",e.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",e.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",e.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",e.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",e.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",e.CHECK_LIST="CHECK_LIST",e.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",e))(xt||{});const Xs={"a)":{glyphFormat:"%1)",glyphType:fe.DECIMAL},"1.":{glyphType:fe.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:fe.LOWER_LETTER},"A.":{glyphType:fe.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:fe.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER}},Vn=e=>[...e,...e,...e].map((t,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:t,bulletAlignment:hr.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),zn=e=>e.map((t,n)=>({...t,bulletAlignment:hr.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),ah=(e,t)=>new Array(9).fill(0).map((n,r)=>({glyphFormat:` %${r+1}`,glyphSymbol:e,bulletAlignment:hr.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*r},textStyle:t}})),kr={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:Vn(["●","○","■"])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:Vn(["❖","➢","■"])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:Vn(["✔","●","◆"])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:Vn(["■","◆","○"])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:Vn(["✧","○","■"])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:Vn(["➢","○","◆"])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:zn([{glyphFormat:"%1.",glyphType:fe.DECIMAL},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.DECIMAL},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.DECIMAL},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:zn([{glyphFormat:"%1)",glyphType:fe.DECIMAL},{glyphFormat:"%2)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3)",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:fe.DECIMAL},{glyphFormat:"%5)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6)",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:fe.DECIMAL},{glyphFormat:"%8)",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9)",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:zn(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(e=>({glyphFormat:e,glyphType:fe.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:zn([{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:zn([{glyphFormat:"%1.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%2.",glyphType:fe.DECIMAL},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%5.",glyphType:fe.DECIMAL},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.UPPER_LETTER},{glyphFormat:"%8.",glyphType:fe.DECIMAL},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:zn([{glyphFormat:"%1.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%3.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%6.",glyphType:fe.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:fe.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:fe.LOWER_LETTER},{glyphFormat:"%9.",glyphType:fe.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:ah("☐")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:ah("☑",{st:{s:ae.TRUE}})}},qs=e=>{const{glyphFormat:t,glyphType:n}=e,r=Z.deepClone(kr.ORDER_LIST);return r.nestingLevel[0].glyphFormat=t,r.nestingLevel[0].glyphType=n,r},nC={ORDER_LIST_QUICK_2:qs(Xs["a)"]),ORDER_LIST_QUICK_3:qs(Xs["a."]),ORDER_LIST_QUICK_4:qs(Xs["i."]),ORDER_LIST_QUICK_6:qs(Xs["I."])};Object.assign(kr,nC);const rC={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5","*":"BULLET_LIST"};function sC(e,t,n,r,s){const i=iC(e,t,n,r,s),o=oC(e,t,n,r,s),a=aC(e,t,n,r,s),l=lC(e,t,n,r,s),u=uC(e,t,n,r,s),c=cC(e,t,n,r),h=hC(e,t,n,r,s);return{dataStream:"",textRuns:i,paragraphs:o,sectionBreaks:a,customBlocks:l,tables:u,customRanges:c,customDecorations:h}}function iC(e,t,n,r,s){const{textRuns:i}=e,{textRuns:o}=t;if(i==null||o==null)return;const a=th(e,n,r);if(s!==Ce.REPLACE){const l=lh(o,a,s);t.textRuns=l}return zc(e,t,n,r),a}function lh(e,t,n){if(t.length===0)return e;e=Z.deepClone(e),t=Z.deepClone(t);const r=[],s=e.length,i=t.length;let o=0,a=0,l=null;function u(){return l?(r.push(l),l=null,!0):!1}for(;o<s&&a<i;){const{st:m,ed:_,ts:p}=e[o],{st:I,ed:A,ts:B,sId:x}=t[a];let Y;if(n===Ce.COVER?Y={...B,...p}:Y={...p},_<I)u()||r.push(e[o]),o++;else if(A<m)u()||r.push(t[a]),a++;else{const O={st:Math.min(m,I),ed:Math.max(m,I),ts:m<I?{...p}:{...B},sId:m<I?void 0:x};O.ed>O.st&&r.push(O),r.push({st:Math.max(m,I),ed:Math.min(_,A),ts:Y,sId:x}),_<A?(o++,t[a].st=_,t[a].st===t[a].ed&&a++):(a++,e[o].st=A,e[o].st===e[o].ed&&o++);const R={st:Math.min(_,A),ed:Math.max(_,A),ts:_<A?{...B}:{...p},sId:_<A?x:void 0};l=R.ed>R.st?R:null}}u();const c=r[r.length-1],h=e[s-1],d=t[i-1];return c&&c.ed!==Math.max(h.ed,d.ed)&&(h.ed>d.ed?r.push(h):r.push(d)),Pr(r)}function oC(e,t,n,r,s){const{paragraphs:i}=e,{paragraphs:o}=t;if(i==null||o==null)return;const a=nh(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const u of o){const{startIndex:c,paragraphStyle:h,bullet:d}=u;let m=[];for(const _ of a){const{startIndex:p,paragraphStyle:I,bullet:A}=_;let B,x;if(s===Ce.COVER?(B={...I,...h},x={listId:"",listType:xt.BULLET_LIST,nestingLevel:0,textStyle:{},...A,...d}):(B={...h,...I},x={listId:"",listType:xt.BULLET_LIST,nestingLevel:0,textStyle:{},...d,...A}),c===p){m.push({startIndex:c,paragraphStyle:B,bullet:x});break}}l.push(...m),m=[]}t.paragraphs=l}return Kc(e,t,n,r),a}function aC(e,t,n,r,s){const{sectionBreaks:i}=e,{sectionBreaks:o}=t;if(i==null||o==null)return;const a=rh(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const u of o){const{startIndex:c}=u;let h=[];for(const d of a){const{startIndex:m}=d;if(c===m){s===Ce.COVER?h.push({...d,...u}):h.push({...u,...d});break}}l.push(...h),h=[]}t.sectionBreaks=l}return Xc(e,t,n,r),a}function lC(e,t,n,r,s){const{customBlocks:i=[]}=e,{customBlocks:o}=t;if(i==null||o==null)return;const a=sh(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const u of o){const{startIndex:c}=u;let h=[];for(const d of a){const{startIndex:m}=d;if(c===m){s===Ce.COVER?h.push({...d,...u}):h.push({...u,...d});break}}l.push(...h),h=[]}t.customBlocks=l}return qc(e,t,n,r),i.length&&!e.customBlocks&&(e.customBlocks=i),a}function uC(e,t,n,r,s){const{tables:i}=e,{tables:o}=t;if(i==null||o==null)return;const a=ih(e,n,r);if(s!==Ce.REPLACE){const l=[];for(const u of o){const{startIndex:c,endIndex:h}=u;let d=[];for(const m of a){const{startIndex:_,endIndex:p}=m;if(_>=c&&p<=h){s===Ce.COVER?d.push({...m,...u}):d.push({...u,...m});break}}l.push(...d),d=[]}t.tables=l}return Jc(e,t,n,r),a}function cC(e,t,n,r,s){e.customRanges||(e.customRanges=[]),Yo(e.customRanges,r),Yo(e.customRanges,r+n);const i=r,o=r+n-1,{customRanges:a}=t,l=[],u=new Map;e.customRanges.forEach(h=>{const{startIndex:d,endIndex:m}=h;d>=i&&m<=o?u.set(h.rangeId,h):l.push(h)});const c=[];return a?(a.forEach(h=>{const{startIndex:d,endIndex:m}=h;l.push({...h,startIndex:d+r,endIndex:m+r})}),e.customRanges=Wo(l),c):[]}function hC(e,t,n,r,s){e.customDecorations||(e.customDecorations=[]),Go(e.customDecorations,r),Go(e.customDecorations,r+n);const i=[],{customDecorations:o}=e,{customDecorations:a=[]}=t;if(s===Ce.REPLACE){for(let l=0;l<o.length;l++){const u=o[l],{startIndex:c,endIndex:h}=u;c>=r&&h<=r+n-1&&i.push(u)}a.forEach(l=>{const{startIndex:u,endIndex:c}=l;o.push({...l,startIndex:u+r,endIndex:c+r})})}else for(const l of a){const{id:u}=l;if(l.type===_n.DELETED){const c=o.filter(h=>h.id===u);c.length&&i.push(...c)}else o.push({...l,startIndex:l.startIndex+r,endIndex:l.endIndex+r})}for(const l of i){const{id:u}=l,c=o.findIndex(h=>h.id===u);c!==-1&&o.splice(c,1)}return e.customDecorations=eh(o),i}var Vo=(e=>(e[e.copy=0]="copy",e[e.cut=1]="cut",e))(Vo||{});function Js(e,t,n,r=!0){const{textRuns:s}=e;if(s){const i=[];for(const o of s){const a=Z.deepClone(o),{st:l,ed:u}=a;Z.hasIntersectionBetweenTwoRanges(l,u,t,n)&&(t>=l&&t<=u?i.push({...a,st:t,ed:Math.min(n,u)}):n>=l&&n<=u?i.push({...a,st:Math.max(t,l),ed:n}):i.push(a))}return Pr(i.map(o=>{const{st:a,ed:l}=o;return{...o,st:a-t,ed:l-t}}))}else if(r)return[{st:0,ed:n-t,ts:{}}]}function uh(e,t,n){const{tables:r=[]}=e,s=[];for(const i of r){const o=Z.deepClone(i),{startIndex:a,endIndex:l}=o;a>=t&&l<=n&&s.push({...o,startIndex:a-t,endIndex:l-t})}return s}function ch(e,t,n){const{paragraphs:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;if(o>=t&&o<n){const a=Z.deepClone(i);s.push(a)}}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function dC(e,t,n){const{sectionBreaks:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;o>=t&&o<=n&&s.push(Z.deepClone(i))}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function hh(e,t,n){const{customBlocks:r=[]}=e,s=[];for(const i of r){const{startIndex:o}=i;o>=t&&o<n&&s.push(Z.deepClone(i))}if(s.length)return s.map(i=>({...i,startIndex:i.startIndex-t}))}function At(e,t,n,r=!0,s=1){const{dataStream:i}=e,o={dataStream:i.slice(t,n)};o.textRuns=Js(e,t,n,r);const a=uh(e,t,n);if(a.length&&(o.tables=a),o.paragraphs=ch(e,t,n),s===1){const u=fh(e,t,n);u?o.customDecorations=u:r&&(o.customDecorations=[])}const{customRanges:l}=dh(e,t,n);return l?o.customRanges=l:r&&(o.customRanges=[]),o.customBlocks=hh(e,t,n),o}function fC(e){const{dataStream:t,textRuns:n,paragraphs:r,customRanges:s,customDecorations:i,tables:o}=e;let a=0,l=0;s==null||s.forEach(c=>{c.startIndex<0&&(a=Math.max(a,-c.startIndex)),c.endIndex>t.length-1&&(l=Math.max(l,c.endIndex-t.length+1))});const u=`${t}`;return n&&(n[0]&&(n[0].st=n[0].st-a),n[n.length-1]&&(n[n.length-1].ed=n[n.length-1].ed+l)),n==null||n.forEach(c=>{c.st+=a,c.ed+=a}),r==null||r.forEach(c=>{c.startIndex+=a}),s==null||s.forEach(c=>{c.startIndex+=a,c.endIndex+=a}),i==null||i.forEach(c=>{c.startIndex+=a,c.endIndex+=l}),o==null||o.forEach(c=>{c.startIndex+=a,c.endIndex+=l}),{...e,dataStream:u,textRuns:n,paragraphs:r,customRanges:s,customDecorations:i,tables:o}}function dh(e,t,n){if(e.customRanges==null)return{};const{customRanges:r}=e;return{customRanges:r.filter(a=>Math.max(a.startIndex,t)<=Math.min(a.endIndex,n-1)).map(a=>({...a,startIndex:Math.max(a.startIndex,t),endIndex:Math.min(a.endIndex,n-1)})).map(a=>({...a,startIndex:a.startIndex-t,endIndex:a.endIndex-t})),leftOffset:0,rightOffset:0}}function fh(e,t,n){if(e.customDecorations==null)return;const{customDecorations:r=[]}=e,s=[];return r.forEach(i=>{if(Math.max(i.startIndex,t)<=Math.min(i.endIndex,n-1)){const o=Z.deepClone(i);s.push({...o,startIndex:Math.max(o.startIndex-t,0),endIndex:Math.min(o.endIndex,n-1)-t})}}),s}function mC(e,t,n){return e==null||t==null?e!=null?e:t:lh(e,t,n)}function gC(e,t,n){if(e==null||t==null)return e!=null?e:t;if(t.length===0||e.length===0)return e;if(t.length>1||e.length>1)throw new Error("Cannot cover multiple customRanges");return n===Ce.REPLACE?[{...e[0]}]:[{...t[0],...e[0]}]}function _C(e,t,n){return t.length===0||e.length===0||n===Ce.REPLACE?e:[...e,...t.filter(r=>!e.some(s=>r.id===s.id))]}function zo(e,t,n=Ce.COVER){if(t.dataStream!=="")throw new Error("Cannot compose other body with non-empty dataStream");const r={dataStream:e.dataStream},{textRuns:s,paragraphs:i=[],customRanges:o,customDecorations:a=[]}=e,{textRuns:l,paragraphs:u=[],customRanges:c,customDecorations:h=[]}=t;r.textRuns=mC(l,s,n),r.customRanges=gC(c,o,n);const d=_C(h,a,n);d.length&&(r.customDecorations=d);const m=[];let _=0,p=0;for(;_<i.length&&p<u.length;){const I=i[_],A=u[p],{startIndex:B}=I,{startIndex:x}=A;B===x?(m.push(Z.deepMerge(I,A)),_++,p++):B<x?(m.push(Z.deepClone(I)),_++):(m.push(Z.deepClone(A)),p++)}return _<i.length&&m.push(...i.slice(_)),p<u.length&&m.push(...u.slice(p)),m.length&&(r.paragraphs=m),r}function pC(e){const{body:t}=e;if(t==null)return!0;const{textRuns:n,paragraphs:r,customRanges:s,customBlocks:i,customDecorations:o,tables:a}=t;return n==null&&r==null&&s==null&&i==null&&o==null&&a==null}class Kn{constructor(t){E(this,"_index",0);E(this,"_offset",0);this._actions=t}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(t){t||(t=Number.POSITIVE_INFINITY);const n=this._actions[this._index];if(n){const r=this._offset,s=n.len;return t>=s-r?(t=s-r,this._index+=1,this._offset=0):this._offset+=t,n.t===J.DELETE||n.t===J.RETAIN&&n.body==null?Z.deepClone({...n,len:t}):Z.deepClone({...n,len:t,body:At(n.body,r,r+t,!1)})}else return{t:J.RETAIN,len:Number.POSITIVE_INFINITY}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){const t=this._actions[this._index];return t?t.t:J.RETAIN}rest(){if(this.hasNext()){if(this._offset===0)return this._actions.slice(this._index);{const t=this._offset,n=this._index,r=this.next(),s=this._actions.slice(this._index);return this._offset=t,this._index=n,[r].concat(s)}}else return[]}}function mh(e,t,n){const{dataStream:r}=e,s=n,i=n+t,o=th(e,t,n),a=nh(e,t,n),l=rh(e,t,n),u=sh(e,t,n),c=ih(e,t,n),h=eC(e,t,n),d=tC(e,t,n);let m="";return r&&(e.dataStream=tc(r,s,i),m=r.slice(s,i)),{dataStream:m,textRuns:o,paragraphs:a,sectionBreaks:l,customBlocks:u,tables:c,customRanges:h,customDecorations:d}}function gh(e,t,n,r){e.dataStream=ec(e.dataStream,r,t.dataStream),zc(e,t,n,r),Kc(e,t,n,r),Xc(e,t,n,r),qc(e,t,n,r),Jc(e,t,n,r),Z0(e,t,n,r),Q0(e,t,n,r)}function EC(e,t,n,r,s=Ce.COVER){return sC(e,t,n,r,s)}function CC(e,t,n){return t<=0?{dataStream:""}:mh(e,t,n)}function RC(e,t,n,r){n!==0&&gh(e,t,n,r)}function IC(e,t){const n=new fn;return n.reset(),t.forEach(r=>{const s=Z.deepClone(r);switch(s.t){case J.RETAIN:{const{coverType:i,body:o,len:a}=s;o!=null&&EC(e,o,a,n.cursor,i),n.moveCursor(a);break}case J.INSERT:{const{body:i,len:o}=s;RC(e,i,o,n.cursor),n.moveCursor(o);break}case J.DELETE:{const{len:i}=s;CC(e,i,n.cursor);break}default:throw new Error(`Unknown action type for action: ${s}.`)}}),e}function SC(e,t,n,r,s){if(e==null||t==null)return t;if(e.length===0||t.length===0)return[];t=Z.deepClone(t),e=Z.deepClone(e);const i=[],o=t.length,a=e.length;let l=0,u=0,c=null;function h(){return c?(i.push(c),c=null,!0):!1}for(;l<o&&u<a;){const{st:p,ed:I,ts:A}=t[l],{st:B,ed:x,ts:Y,sId:O}=e[u];let R={};if(s===0)R={...A},n===Ce.COVER&&r===Ce.REPLACE&&Y&&(R=Object.assign({},Y,R));else if(R={...A},n===Ce.REPLACE){if(r===Ce.REPLACE)R={...Y};else if(A&&Y){const b=Object.keys(A);for(const T of b)Y[T]&&delete R[T]}}else if(r===Ce.REPLACE){if(Y){const b=Object.keys(Y);for(const T of b)Y[T]!==void 0&&(R[T]=Y[T])}}else if(Y){const b=Object.keys(Y);for(const T of b)R[T]!==void 0&&delete R[T]}if(I<B)h()||i.push(t[l]),l++;else if(x<p)h()||i.push(e[u]),u++;else{const b={st:Math.min(p,B),ed:Math.max(p,B),ts:p<B?{...A}:{...Y}};b.ed>b.st&&i.push(),i.push({st:Math.max(p,B),ed:Math.min(I,x),ts:R,sId:O}),I<x?(l++,e[u].st=I,e[u].st===e[u].ed&&u++):(u++,t[l].st=x,t[l].st===t[l].ed&&l++);const T={st:Math.min(I,x),ed:Math.max(I,x),ts:I<x?{...Y}:{...A},sId:I<x?O:void 0};c=T.ed>T.st?T:null}}h();const d=i[i.length-1],m=t[o-1],_=e[a-1];return d.ed!==Math.max(m.ed,_.ed)&&(m.ed>_.ed?i.push(m):i.push(_)),Pr(i,!0)}function OC(e,t,n,r,s){if(e==null||t==null)return t;if(e.length===0||t.length===0)return[];if(e.length>1||t.length>1)throw new Error("CustomRanges is only supported transform for length one now.");const i=e[0],o=t[0];if(n===Ce.REPLACE)return s===1?[Z.deepClone(i)]:[Z.deepClone(o)];if(r===Ce.REPLACE){const a=Z.deepClone(o);return s===1&&Object.assign(a,Z.deepClone(i)),[a]}else{const a=Z.deepClone(o);return s===1&&Object.assign(a,Z.deepClone(i)),[a]}}function _h(e,t,n,r,s){const i={startIndex:t.startIndex};if(t.paragraphStyle&&(i.paragraphStyle=Z.deepClone(t.paragraphStyle),e.paragraphStyle)){if(n===Ce.REPLACE)if(r===Ce.REPLACE)s===1&&(i.paragraphStyle={...e.paragraphStyle});else if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)e.paragraphStyle[a]!==void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else{const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]===void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else if(r===Ce.REPLACE)if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)e.paragraphStyle[a]!==void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else{const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]===void 0&&(i.paragraphStyle[a]=e.paragraphStyle[a])}else if(s===1){const o=Object.keys(e.paragraphStyle);for(const a of o)i.paragraphStyle[a]&&delete i.paragraphStyle[a]}}return n===Ce.REPLACE&&r===Ce.REPLACE?i.bullet=s===1?Z.deepClone(e.bullet):Z.deepClone(t.bullet):e.bullet===void 0?i.bullet=Z.deepClone(t.bullet):n===Ce.REPLACE||r===Ce.REPLACE?i.bullet=s===0&&t.bullet?Z.deepClone(t.bullet):Z.deepClone(e.bullet):s===0&&t.bullet!==void 0&&(i.bullet=Z.deepClone(t.bullet)),i}function vC(e,t){if(e==null||t==null)return t;if(e.length===0||t.length===0)return Z.deepClone(t);const n=[];for(const r of t){const{id:s,type:i}=r;let o=!1;for(const a of e)if(a.id===s){(a.type===_n.DELETED||i===_n.DELETED)&&(o=!0,n.push({...r,type:_n.DELETED}));break}o||n.push(r)}return n}function wC(e,t,n=!1){const{body:r,coverType:s=Ce.COVER}=e,{body:i,coverType:o=Ce.COVER}=t;if(r==null||r.dataStream!==""||i==null||i.dataStream!=="")throw new Error("Data stream is not supported in retain transform.");const a={dataStream:""},l=o,{textRuns:u,paragraphs:c=[],customRanges:h,customDecorations:d}=r,{textRuns:m,paragraphs:_=[],customRanges:p,customDecorations:I}=i,A=SC(u,m,s,o,n?1:0);A&&(a.textRuns=A);const B=OC(h,p,s,o,n?1:0);B&&(a.customRanges=B);const x=vC(d,I);x&&(a.customDecorations=x);const Y=[];let O=0,R=0;for(;O<c.length&&R<_.length;){const b=c[O],T=_[R],{startIndex:H}=b,{startIndex:$}=T;if(H===$){let g={startIndex:H};n?g=_h(b,T,s,o,1):g=_h(b,T,s,o,0),Y.push(g),O++,R++}else H<$?O++:(Y.push(Z.deepClone(T)),R++)}return R<_.length&&Y.push(..._.slice(R)),Y.length&&(a.paragraphs=Y),{coverType:l,body:a}}function ph(e){return Object.keys(e).length===1}const Zn=class Zn{constructor(){E(this,"_actions",[])}static apply(t,n){return IC(t,n)}static compose(t,n){const r=new Kn(t),s=new Kn(n),i=new Zn;for(;r.hasNext()||s.hasNext();)if(s.peekType()===J.INSERT)i.push(s.next());else if(r.peekType()===J.DELETE)i.push(r.next());else{const o=Math.min(r.peekLength(),s.peekLength()),a=r.next(o),l=s.next(o);if(a.t===J.INSERT&&l.t===J.RETAIN)l.body==null?i.push(a):i.push({...a,body:zo(a.body,l.body,l.coverType)});else if(a.t===J.RETAIN&&l.t===J.RETAIN)if(a.body==null&&l.body==null)i.push(a.len!==Number.POSITIVE_INFINITY?a:l);else if(a.body&&l.body){const u=a.coverType===Ce.REPLACE||l.coverType===Ce.REPLACE?Ce.REPLACE:Ce.COVER;i.push({...a,t:J.RETAIN,coverType:u,body:zo(a.body,l.body,l.coverType)})}else i.push(a.body?a:l);else a.t===J.RETAIN&&l.t===J.DELETE?i.push(l):a.t===J.INSERT&&(l.t,J.DELETE)}return i.trimEndUselessRetainAction(),i.serialize()}static transform(t,n,r="right"){return this._transform(n,t,r==="left"?"right":"left")}static _transform(t,n,r="right"){const s=new Kn(t),i=new Kn(n),o=new Zn;for(;s.hasNext()||i.hasNext();)if(s.peekType()===J.INSERT&&(r==="left"||i.peekType()!==J.INSERT)){const a=s.next();o.retain(a.len)}else if(i.peekType()===J.INSERT)o.push(i.next());else{const a=Math.min(s.peekLength(),i.peekLength()),l=s.next(a),u=i.next(a);if(l.t===J.DELETE)continue;if(u.t===J.DELETE){o.push(u);continue}if(l.body==null||u.body==null)o.push(u);else{const{coverType:c,body:h}=wC(l,u,r==="left");o.push({...u,t:J.RETAIN,coverType:c,body:h})}}return o.trimEndUselessRetainAction(),o.serialize()}static transformPosition(t,n,r=!1){const s=new Kn(t);let i=0;for(;s.hasNext()&&i<=n;){const o=s.peekLength(),a=s.peekType();if(s.next(),a===J.DELETE){n-=Math.min(o,n-i);continue}else a===J.INSERT&&(i<n||!r)&&(n+=o);i+=o}return n}static isNoop(t){return t.length===0}static invert(t){const n=[];for(const r of t)if(r.t===J.INSERT)n.push({t:J.DELETE,len:r.len,body:r.body});else if(r.t===J.DELETE){if(r.body==null)throw new Error("Can not invert DELETE action without body property, makeInvertible must be called first.");n.push({t:J.INSERT,body:r.body,len:r.len})}else if(r.body!=null){if(r.oldBody==null)throw new Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");n.push({t:J.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:Ce.REPLACE})}else n.push(r);return n}static makeInvertible(t,n){const r=[];let s=0;for(const i of t){if(i.t===J.DELETE&&(i.body==null||i.body&&i.body.dataStream.length!==i.len)){const o=At(n,s,s+i.len,!1);i.len=o.dataStream.length,i.body=o}if(i.t===J.RETAIN&&i.body!=null){const o=At(n,s,s+i.len,!0);i.oldBody={...o,dataStream:""},i.len=o.dataStream.length}r.push(i),i.t!==J.INSERT&&(s+=i.len)}return r}insert(t,n){const r={t:J.INSERT,body:n,len:t};return this.push(r),this}retain(t,n,r){const s={t:J.RETAIN,len:t};return n!=null&&(s.body=n),r!=null&&(s.coverType=r),this.push(s),this}delete(t){const n={t:J.DELETE,len:t};return this.push(n),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...t){if(t.length>1){for(const i of t)this.push(i);return this}let n=this._actions.length,r=this._actions[n-1];const s=Z.deepClone(t[0]);if(s.t===J.RETAIN&&s.len===0&&s.body==null)return this;if(typeof r=="object"){if(r.t===J.DELETE&&s.t===J.DELETE)return r.len+=s.len,this;if(r.t===J.DELETE&&s.t===J.INSERT&&(n-=1,r=this._actions[n-1],r==null))return this._actions.unshift(s),this;if(r.t===J.RETAIN&&s.t===J.RETAIN&&r.body==null&&s.body==null)return r.len+=s.len,this;if(r.t===J.INSERT&&ph(r.body)&&s.t===J.INSERT&&ph(s.body))return r.len+=s.len,r.body.dataStream+=s.body.dataStream,this}return n===this._actions.length?this._actions.push(s):this._actions.splice(n,0,s),this}trimEndUselessRetainAction(){let t=this._actions[this._actions.length-1];for(;t&&t.t===J.RETAIN&&pC(t);)this._actions.pop(),t=this._actions[this._actions.length-1];return this}};E(Zn,"id","text-x"),E(Zn,"uri","https://github.com/dream-num/univer#text-x");let Me=Zn;Object.defineProperty(Me,"name",{value:"text-x"});const Qn=class Qn{static registerSubtype(t){var n;t==null||this._subTypes.has(t.name)&&((n=this._subTypes.get(t.name))==null?void 0:n.id)!==Me.id||(this._subTypes.set(t.name,t),at.type.registerSubtype(t))}static apply(t,n){if(!at.type.isNoop(n))return at.type.apply(t,n)}static compose(t,n){return at.type.compose(t,n)}static transform(t,n,r){return at.type.transform(t,n,r)}static transformPosition(t,n,r="right"){return t&&t.length===2&&t[0]==="body"&&t[1].et===Me.name?Me.transformPosition(t[1].e,n,r==="left"):n}static invertWithDoc(t,n){return at.type.invertWithDoc(t,n)}static isNoop(t){return at.type.isNoop(t)}static getInstance(){return this._instance==null&&(this._instance=new Qn),this._instance}removeOp(t,n){return at.removeOp(t,n)}moveOp(t,n){return at.moveOp(t,n)}insertOp(t,n){return at.insertOp(t,n)}replaceOp(t,n,r){return at.replaceOp(t,n,r)}editOp(t,n=["body"]){return at.editOp(n,Me.name,t)}};E(Qn,"uri","https://github.com/dream-num/univer#json-x"),E(Qn,"_subTypes",new Map),E(Qn,"_instance",null);let Yt=Qn;Yt.registerSubtype(Me);var Eh=(e=>(e.PARAGRAPH="PARAGRAPH",e.SECTION_BREAK="SECTION_BREAK",e.TABLE="TABLE",e.TABLE_ROW="TABLE_ROW",e.TABLE_CELL="TABLE_CELL",e.CUSTOM_BLOCK="CUSTOM_BLOCK",e))(Eh||{}),ut=(e=>(e.PARAGRAPH="\r",e.SECTION_BREAK=`
`,e.TABLE_START="",e.TABLE_ROW_START="\x1B",e.TABLE_CELL_START="",e.TABLE_CELL_END="",e.TABLE_ROW_END="",e.TABLE_END="",e.CUSTOM_RANGE_START="",e.CUSTOM_RANGE_END="",e.COLUMN_BREAK="\v",e.PAGE_BREAK="\f",e.DOCS_END="\0",e.TAB="	",e.CUSTOM_BLOCK="\b",e.LETTER="",e.SPACE=" ",e))(ut||{});function bC(e){return`${e}`}const AC=[ut.TABLE_START,ut.TABLE_ROW_START,ut.TABLE_CELL_START,ut.TABLE_CELL_END,ut.TABLE_ROW_END,ut.TABLE_END],Zs=e=>{const t=e.endsWith(`\r
`)?e.slice(0,-2):e;return AC.reduce((n,r)=>n.replaceAll(r,""),t)},yC=e=>e?Zs(e).replaceAll("\r","")==="":!0,TC=e=>{const t=e.replace(/\n/g,"\r"),n=[],r=[];let s=0,i="";const o=(l,u=!0)=>{const c=t.slice(s,l);if(Z.isLegalUrl(c)){const h=tt(),d=`${c}`,m={startIndex:s,endIndex:s+d.length-1,rangeId:h,rangeType:Qt.HYPERLINK,properties:{url:e}};r.push(m),i+=d,s=l+1,u&&(i+="\r",n.push({startIndex:l}))}else i+=t.slice(s,l+1),s=l+1,u&&n.push({startIndex:l})};let a=0;for(let l=0;l<t.length;l++)t[l]==="\r"&&(o(l),a=l);return(a!==t.length-1||t.length===1)&&o(t.length,!1),{dataStream:i,paragraphs:n,customRanges:r}},Ko={id:"default_doc",documentStyle:{}};class NC extends as{constructor(n){var r;super();E(this,"type",ve.UNIVER_DOC);E(this,"_name$",new oe.BehaviorSubject(""));E(this,"name$",this._name$.asObservable());E(this,"snapshot");this.snapshot={...Ko,...n},this._name$.next((r=this.snapshot.title)!=null?r:"No Title")}getUnitId(){throw new Error("Method not implemented.")}getRev(){var n;return(n=this.snapshot.rev)!=null?n:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(n){this.snapshot.rev=n}setName(n){this.snapshot.title=n,this._name$.next(n)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var n;return((n=this.snapshot.settings)==null?void 0:n.zoomRatio)||1}resetDrawing(n,r){this.snapshot.drawings=n,this.snapshot.drawingsOrder=r}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var s;const n=(s=this.snapshot.lists)!=null?s:{};return{...kr,...n}}updateDocumentId(n){this.snapshot.id=n}updateDocumentRenderConfig(n){const{documentStyle:r}=this.snapshot;r.renderConfig==null?r.renderConfig=n:r.renderConfig={...r.renderConfig,...n}}getDocumentStyle(){return this.snapshot.documentStyle}updateDocumentStyle(n){this.snapshot.documentStyle==null?this.snapshot.documentStyle=n:this.snapshot.documentStyle={...this.snapshot.documentStyle,...n}}updateDocumentDataMargin(n){const{t:r,l:s,b:i,r:o}=n,{documentStyle:a}=this.snapshot;r!=null&&(a.marginTop=r),s!=null&&(a.marginLeft=s),i!=null&&(a.marginBottom=i),o!=null&&(a.marginRight=o)}updateDocumentDataPageSize(n,r){const{documentStyle:s}=this.snapshot;if(!s.pageSize){s.pageSize={width:n!=null?n:Number.POSITIVE_INFINITY,height:r!=null?r:Number.POSITIVE_INFINITY};return}n!==void 0&&(s.pageSize.width=n),r!==void 0&&(s.pageSize.height=r)}updateDrawing(n,r){const{drawings:s}=this,{width:i,height:o,left:a,top:l}=r,u=s==null?void 0:s[n];if(!u)return;const c=u.docTransform;c.size.width=i,c.size.height=o,c.positionH.posOffset=a,c.positionV.posOffset=l}setZoomRatio(n=1){this.snapshot.settings?this.snapshot.settings.zoomRatio=n:this.snapshot.settings={zoomRatio:n}}setDisabled(n){this.snapshot.disabled=n}getDisabled(){return this.snapshot.disabled}getTitle(){return this.snapshot.title}}class yt extends NC{constructor(n){var s,i;super(Z.isEmptyObject(n)?N_():n);E(this,"_unitId");E(this,"headerModelMap",new Map);E(this,"footerModelMap",new Map);E(this,"change$",new oe.BehaviorSubject(0));const r=6;this._unitId=(s=this.snapshot.id)!=null?s:tt(r),this._initializeHeaderFooterModel(),this._name$.next((i=this.snapshot.title)!=null?i:"")}dispose(){super.dispose(),this.headerModelMap.forEach(n=>{n.dispose()}),this.footerModelMap.forEach(n=>{n.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var n;return(n=this.snapshot.body)==null?void 0:n.customRanges}getCustomDecorations(){var n;return(n=this.snapshot.body)==null?void 0:n.customDecorations}getSettings(){return this.snapshot.settings}reset(n){if(n.id&&n.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...Ko,...n},this._initializeHeaderFooterModel(),this.change$.next(this.change$.value+1)}getSelfOrHeaderFooterModel(n){if(n!=null){if(this.headerModelMap.has(n))return this.headerModelMap.get(n);if(this.footerModelMap.has(n))return this.footerModelMap.get(n)}return this}getUnitId(){return this._unitId}apply(n){if(!Yt.isNoop(n))return this.snapshot=Yt.apply(this.snapshot,n),n!=null&&n.some(r=>Array.isArray(r)&&((r==null?void 0:r[0])==="headers"||(r==null?void 0:r[0])==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.change$.next(this.change$.value+1),this.snapshot}sliceBody(n,r,s=Vo.copy){const i=this.getBody();if(i!=null)return At(i,n,r,!1,s)}_initializeHeaderFooterModel(){const{headers:n,footers:r}=this.getSnapshot();if(n)for(const s in n){const i=n[s];this.headerModelMap.set(s,new yt(i)),this.headerModelMap.get(s).updateDocumentId(this.getUnitId())}if(r)for(const s in r){const i=r[s];this.footerModelMap.set(s,new yt(i)),this.footerModelMap.get(s).updateDocumentId(this.getUnitId())}}updateDocumentId(n){super.updateDocumentId(n),this._unitId=n}getPlainText(){var n,r;return Zs((r=(n=this.getBody())==null?void 0:n.dataStream)!=null?r:"")}}function MC(e){const{ranges:t,id:n,type:r}=e,s=new Me;let i=0;for(let o=0;o<t.length;o++){const a=t[o],{startOffset:l,endOffset:u}=a;l>0&&s.push({t:J.RETAIN,len:l-i}),s.push({t:J.RETAIN,body:{dataStream:"",customDecorations:[{id:n,type:r,startIndex:0,endIndex:u-l-1}]},len:u-l}),i=u}return s}function LC(e){var c,h,d;const{id:t,segmentId:n,documentDataModel:r}=e,s=r==null?void 0:r.getBody();if(!r||!s)return!1;const i=(d=(h=(c=r.getSelfOrHeaderFooterModel(n))==null?void 0:c.getBody())==null?void 0:h.customDecorations)==null?void 0:d.find(m=>m.id===t);if(!i)return!1;const o=new Me,{startIndex:a,endIndex:l}=i,u=l-a+1;return o.push({t:J.RETAIN,len:a}),o.push({t:J.RETAIN,len:u,body:{dataStream:"",customDecorations:[{startIndex:0,endIndex:u-1,id:t,type:_n.DELETED}]}}),o}function Ch(e,t,n,r){return e<=n&&t>=n||e>=n&&e<=r}function DC(e,t){const n=[];for(let r=0,s=t.length;r<s;r++){const i=t[r];e.collapsed?i.startIndex<e.startOffset&&e.startOffset<=i.endIndex&&n.push(i):Ch(e.startOffset,e.endOffset-1,i.startIndex,i.endIndex)&&n.push(i)}return n}function UC(e){return{...Z.deepClone(e),rangeId:tt()}}function PC(e,t){const n=[];let r=e[0];for(const s of t)s<e[0]||s>e[1]||(r<s&&n.push([r,s-1]),r=s+1);return r<=e[1]&&n.push([r,e[1]]),n}function Rh(e,t,n,r){const s=[];for(let i=0,o=n.length;i<o;i++){const a=n[i];if((r===void 0||a.rangeType===r)&&Math.max(a.startIndex,e)<=Math.min(a.endIndex,t)&&s.push({...a}),a.startIndex>t)break}return s}function kC(e,t){var i,o,a,l,u;const n=Rh(e.startOffset,e.collapsed?e.startOffset:e.endOffset-1,(i=t.customRanges)!=null?i:[]),r=Math.min(e.startOffset,(a=(o=n[0])==null?void 0:o.startIndex)!=null?a:1/0),s=Math.max(e.endOffset,((u=(l=n[n.length-1])==null?void 0:l.endIndex)!=null?u:-1/0)+1);return{startOffset:r,endOffset:s,collapsed:r===s}}var Xo,Ih;function FC(){if(Ih)return Xo;Ih=1;var e=-1,t=1,n=0;function r(g,P,v,M,y){if(g===P)return g?[[n,g]]:[];if(v!=null){var w=H(g,P,v);if(w)return w}var N=a(g,P),L=g.substring(0,N);g=g.substring(N),P=P.substring(N),N=u(g,P);var D=g.substring(g.length-N);g=g.substring(0,g.length-N),P=P.substring(0,P.length-N);var F=s(g,P);return L&&F.unshift([n,L]),D&&F.push([n,D]),B(F,y),M&&h(F),F}function s(g,P){var v;if(!g)return[[t,P]];if(!P)return[[e,g]];var M=g.length>P.length?g:P,y=g.length>P.length?P:g,w=M.indexOf(y);if(w!==-1)return v=[[t,M.substring(0,w)],[n,y],[t,M.substring(w+y.length)]],g.length>P.length&&(v[0][0]=v[2][0]=e),v;if(y.length===1)return[[e,g],[t,P]];var N=c(g,P);if(N){var L=N[0],D=N[1],F=N[2],Q=N[3],z=N[4],le=r(L,F),ce=r(D,Q);return le.concat([[n,z]],ce)}return i(g,P)}function i(g,P){for(var v=g.length,M=P.length,y=Math.ceil((v+M)/2),w=y,N=2*y,L=new Array(N),D=new Array(N),F=0;F<N;F++)L[F]=-1,D[F]=-1;L[w+1]=0,D[w+1]=0;for(var Q=v-M,z=Q%2!==0,le=0,ce=0,S=0,U=0,G=0;G<y;G++){for(var V=-G+le;V<=G-ce;V+=2){var j=w+V,W;V===-G||V!==G&&L[j-1]<L[j+1]?W=L[j+1]:W=L[j-1]+1;for(var ee=W-V;W<v&&ee<M&&g.charAt(W)===P.charAt(ee);)W++,ee++;if(L[j]=W,W>v)ce+=2;else if(ee>M)le+=2;else if(z){var te=w+Q-V;if(te>=0&&te<N&&D[te]!==-1){var k=v-D[te];if(W>=k)return o(g,P,W,ee)}}}for(var K=-G+S;K<=G-U;K+=2){var te=w+K,k;K===-G||K!==G&&D[te-1]<D[te+1]?k=D[te+1]:k=D[te-1]+1;for(var q=k-K;k<v&&q<M&&g.charAt(v-k-1)===P.charAt(M-q-1);)k++,q++;if(D[te]=k,k>v)U+=2;else if(q>M)S+=2;else if(!z){var j=w+Q-K;if(j>=0&&j<N&&L[j]!==-1){var W=L[j],ee=w+W-j;if(k=v-k,W>=k)return o(g,P,W,ee)}}}}return[[e,g],[t,P]]}function o(g,P,v,M){var y=g.substring(0,v),w=P.substring(0,M),N=g.substring(v),L=P.substring(M),D=r(y,w),F=r(N,L);return D.concat(F)}function a(g,P){if(!g||!P||g.charAt(0)!==P.charAt(0))return 0;for(var v=0,M=Math.min(g.length,P.length),y=M,w=0;v<y;)g.substring(w,y)==P.substring(w,y)?(v=y,w=v):M=y,y=Math.floor((M-v)/2+v);return x(g.charCodeAt(y-1))&&y--,y}function l(g,P){var v=g.length,M=P.length;if(v==0||M==0)return 0;v>M?g=g.substring(v-M):v<M&&(P=P.substring(0,v));var y=Math.min(v,M);if(g==P)return y;for(var w=0,N=1;;){var L=g.substring(y-N),D=P.indexOf(L);if(D==-1)return w;N+=D,(D==0||g.substring(y-N)==P.substring(0,N))&&(w=N,N++)}}function u(g,P){if(!g||!P||g.slice(-1)!==P.slice(-1))return 0;for(var v=0,M=Math.min(g.length,P.length),y=M,w=0;v<y;)g.substring(g.length-y,g.length-w)==P.substring(P.length-y,P.length-w)?(v=y,w=v):M=y,y=Math.floor((M-v)/2+v);return Y(g.charCodeAt(g.length-y))&&y--,y}function c(g,P){var v=g.length>P.length?g:P,M=g.length>P.length?P:g;if(v.length<4||M.length*2<v.length)return null;function y(ce,S,U){for(var G=ce.substring(U,U+Math.floor(ce.length/4)),V=-1,j="",W,ee,te,k;(V=S.indexOf(G,V+1))!==-1;){var K=a(ce.substring(U),S.substring(V)),q=u(ce.substring(0,U),S.substring(0,V));j.length<q+K&&(j=S.substring(V-q,V)+S.substring(V,V+K),W=ce.substring(0,U-q),ee=ce.substring(U+K),te=S.substring(0,V-q),k=S.substring(V+K))}return j.length*2>=ce.length?[W,ee,te,k,j]:null}var w=y(v,M,Math.ceil(v.length/4)),N=y(v,M,Math.ceil(v.length/2)),L;if(!w&&!N)return null;N?w?L=w[4].length>N[4].length?w:N:L=N:L=w;var D,F,Q,z;g.length>P.length?(D=L[0],F=L[1],Q=L[2],z=L[3]):(Q=L[0],z=L[1],D=L[2],F=L[3]);var le=L[4];return[D,F,Q,z,le]}function h(g){for(var P=!1,v=[],M=0,y=null,w=0,N=0,L=0,D=0,F=0;w<g.length;)g[w][0]==n?(v[M++]=w,N=D,L=F,D=0,F=0,y=g[w][1]):(g[w][0]==t?D+=g[w][1].length:F+=g[w][1].length,y&&y.length<=Math.max(N,L)&&y.length<=Math.max(D,F)&&(g.splice(v[M-1],0,[e,y]),g[v[M-1]+1][0]=t,M--,M--,w=M>0?v[M-1]:-1,N=0,L=0,D=0,F=0,y=null,P=!0)),w++;for(P&&B(g),A(g),w=1;w<g.length;){if(g[w-1][0]==e&&g[w][0]==t){var Q=g[w-1][1],z=g[w][1],le=l(Q,z),ce=l(z,Q);le>=ce?(le>=Q.length/2||le>=z.length/2)&&(g.splice(w,0,[n,z.substring(0,le)]),g[w-1][1]=Q.substring(0,Q.length-le),g[w+1][1]=z.substring(le),w++):(ce>=Q.length/2||ce>=z.length/2)&&(g.splice(w,0,[n,Q.substring(0,ce)]),g[w-1][0]=t,g[w-1][1]=z.substring(0,z.length-ce),g[w+1][0]=e,g[w+1][1]=Q.substring(ce),w++),w++}w++}}var d=/[^a-zA-Z0-9]/,m=/\s/,_=/[\r\n]/,p=/\n\r?\n$/,I=/^\r?\n\r?\n/;function A(g){function P(ce,S){if(!ce||!S)return 6;var U=ce.charAt(ce.length-1),G=S.charAt(0),V=U.match(d),j=G.match(d),W=V&&U.match(m),ee=j&&G.match(m),te=W&&U.match(_),k=ee&&G.match(_),K=te&&ce.match(p),q=k&&S.match(I);return K||q?5:te||k?4:V&&!W&&ee?3:W||ee?2:V||j?1:0}for(var v=1;v<g.length-1;){if(g[v-1][0]==n&&g[v+1][0]==n){var M=g[v-1][1],y=g[v][1],w=g[v+1][1],N=u(M,y);if(N){var L=y.substring(y.length-N);M=M.substring(0,M.length-N),y=L+y.substring(0,y.length-N),w=L+w}for(var D=M,F=y,Q=w,z=P(M,y)+P(y,w);y.charAt(0)===w.charAt(0);){M+=y.charAt(0),y=y.substring(1)+w.charAt(0),w=w.substring(1);var le=P(M,y)+P(y,w);le>=z&&(z=le,D=M,F=y,Q=w)}g[v-1][1]!=D&&(D?g[v-1][1]=D:(g.splice(v-1,1),v--),g[v][1]=F,Q?g[v+1][1]=Q:(g.splice(v+1,1),v--))}v++}}function B(g,P){g.push([n,""]);for(var v=0,M=0,y=0,w="",N="",L;v<g.length;){if(v<g.length-1&&!g[v][1]){g.splice(v,1);continue}switch(g[v][0]){case t:y++,N+=g[v][1],v++;break;case e:M++,w+=g[v][1],v++;break;case n:var D=v-y-M-1;if(P){if(D>=0&&R(g[D][1])){var F=g[D][1].slice(-1);if(g[D][1]=g[D][1].slice(0,-1),w=F+w,N=F+N,!g[D][1]){g.splice(D,1),v--;var Q=D-1;g[Q]&&g[Q][0]===t&&(y++,N=g[Q][1]+N,Q--),g[Q]&&g[Q][0]===e&&(M++,w=g[Q][1]+w,Q--),D=Q}}if(O(g[v][1])){var F=g[v][1].charAt(0);g[v][1]=g[v][1].slice(1),w+=F,N+=F}}if(v<g.length-1&&!g[v][1]){g.splice(v,1);break}if(w.length>0||N.length>0){w.length>0&&N.length>0&&(L=a(N,w),L!==0&&(D>=0?g[D][1]+=N.substring(0,L):(g.splice(0,0,[n,N.substring(0,L)]),v++),N=N.substring(L),w=w.substring(L)),L=u(N,w),L!==0&&(g[v][1]=N.substring(N.length-L)+g[v][1],N=N.substring(0,N.length-L),w=w.substring(0,w.length-L)));var z=y+M;w.length===0&&N.length===0?(g.splice(v-z,z),v=v-z):w.length===0?(g.splice(v-z,z,[t,N]),v=v-z+1):N.length===0?(g.splice(v-z,z,[e,w]),v=v-z+1):(g.splice(v-z,z,[e,w],[t,N]),v=v-z+2)}v!==0&&g[v-1][0]===n?(g[v-1][1]+=g[v][1],g.splice(v,1)):v++,y=0,M=0,w="",N="";break}}g[g.length-1][1]===""&&g.pop();var le=!1;for(v=1;v<g.length-1;)g[v-1][0]===n&&g[v+1][0]===n&&(g[v][1].substring(g[v][1].length-g[v-1][1].length)===g[v-1][1]?(g[v][1]=g[v-1][1]+g[v][1].substring(0,g[v][1].length-g[v-1][1].length),g[v+1][1]=g[v-1][1]+g[v+1][1],g.splice(v-1,1),le=!0):g[v][1].substring(0,g[v+1][1].length)==g[v+1][1]&&(g[v-1][1]+=g[v+1][1],g[v][1]=g[v][1].substring(g[v+1][1].length)+g[v+1][1],g.splice(v+1,1),le=!0)),v++;le&&B(g,P)}function x(g){return g>=55296&&g<=56319}function Y(g){return g>=56320&&g<=57343}function O(g){return Y(g.charCodeAt(0))}function R(g){return x(g.charCodeAt(g.length-1))}function b(g){for(var P=[],v=0;v<g.length;v++)g[v][1].length>0&&P.push(g[v]);return P}function T(g,P,v,M){return R(g)||O(M)?null:b([[n,g],[e,P],[t,v],[n,M]])}function H(g,P,v){var M=typeof v=="number"?{index:v,length:0}:v.oldRange,y=typeof v=="number"?null:v.newRange,w=g.length,N=P.length;if(M.length===0&&(y===null||y.length===0)){var L=M.index,D=g.slice(0,L),F=g.slice(L),Q=y?y.index:null;e:{var z=L+N-w;if(Q!==null&&Q!==z||z<0||z>N)break e;var le=P.slice(0,z),ce=P.slice(z);if(ce!==F)break e;var S=Math.min(L,z),U=D.slice(0,S),G=le.slice(0,S);if(U!==G)break e;var V=D.slice(S),j=le.slice(S);return T(U,V,j,F)}e:{if(Q!==null&&Q!==L)break e;var W=L,le=P.slice(0,W),ce=P.slice(W);if(le!==D)break e;var ee=Math.min(w-W,N-W),te=F.slice(F.length-ee),k=ce.slice(ce.length-ee);if(te!==k)break e;var V=F.slice(0,F.length-ee),j=ce.slice(0,ce.length-ee);return T(D,V,j,te)}}if(M.length>0&&y&&y.length===0)e:{var U=g.slice(0,M.index),te=g.slice(M.index+M.length),S=U.length,ee=te.length;if(N<S+ee)break e;var G=P.slice(0,S),k=P.slice(N-ee);if(U!==G||te!==k)break e;var V=g.slice(S,w-ee),j=P.slice(S,N-ee);return T(U,V,j,te)}return null}function $(g,P,v,M){return r(g,P,v,M,!0)}return $.INSERT=t,$.DELETE=e,$.EQUAL=n,Xo=$,Xo}var xC=FC();const qo=gt(xC);function BC(e){var h,d,m;const{rangeId:t,segmentId:n,documentDataModel:r,insert:s}=e,i=(d=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.customRanges)==null?void 0:d.find(_=>_.rangeId===t);if(!i)return!1;const{startIndex:o,endIndex:a}=i,l=new Me,u=a-o+1;l.push({t:J.RETAIN,len:o}),l.push({t:J.RETAIN,len:u,body:{dataStream:"",customRanges:[]}}),s&&l.push({t:J.INSERT,body:s,len:s.dataStream.length});const c=a+1+((m=s==null?void 0:s.dataStream.length)!=null?m:0);return l.selections=[{startOffset:c,endOffset:c,collapsed:!0}],l}function HC(e){const{ranges:t,rangeId:n,rangeType:r,wholeEntity:s,properties:i,body:o}=e;let a=0;const l=new Me;let u=!1;return t.forEach(c=>{var x,Y,O;const h=kC(c,o);if(!h||!o)return!1;const{startOffset:d,endOffset:m}=h,_=(x=o.customRanges)!=null?x:[],p=(R,b,T)=>{var v,M,y,w;const H=Rh(R,b,_,r),$=Math.min((M=(v=H[0])==null?void 0:v.startIndex)!=null?M:1/0,R),g=Math.max((w=(y=H[H.length-1])==null?void 0:y.endIndex)!=null?w:-1/0,b),P={rangeId:T?`${n}$${T}`:n,rangeType:r,startIndex:0,endIndex:g-$,wholeEntity:s,properties:{...i}};l.push({t:J.RETAIN,len:$-a}),l.push({t:J.RETAIN,len:g-$+1,body:{dataStream:"",customRanges:[P]},coverType:Ce.COVER}),a=g+1},I=((Y=o.paragraphs)!=null?Y:[]).filter(R=>R.startIndex<m&&R.startIndex>d),A=((O=o.customBlocks)!=null?O:[]).filter(R=>R.startIndex<m&&R.startIndex>d);PC([d,m-1],[...I.map(R=>R.startIndex),...A.map(R=>R.startIndex)]).forEach(([R,b],T)=>p(R,b,T)),u=!0,l.selections=[{startOffset:h.endOffset,endOffset:h.endOffset,collapsed:!0}]}),u?l:!1}function Sh(e,t,n=0,r=null,s=!0){e.sort((u,c)=>u.startOffset-c.startOffset);const i=[],{paragraphs:o=[]}=t,a=o==null?void 0:o.find(u=>u.startIndex>=e[0].startOffset&&u.startIndex<e[0].endOffset);let l=n;if(e.forEach(u=>{const{startOffset:c,endOffset:h}=u;c>l&&(i.push({t:J.RETAIN,len:c-l}),l=c),l<h&&(i.push({t:J.DELETE,len:h-l}),l=h)}),r&&i.push({t:J.INSERT,body:r,len:r.dataStream.length}),a&&s){const u=o.find(c=>c.startIndex-n>=e[e.length-1].endOffset-1);u&&(u.startIndex>l&&(i.push({t:J.RETAIN,len:u.startIndex-l}),l=u.startIndex),i.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...u,startIndex:0,bullet:a==null?void 0:a.bullet}]},coverType:Ce.REPLACE}))}return i}function $C(e,t,n=0){const r=[];let s=n;return e.forEach(i=>{const{startOffset:o,endOffset:a}=i;o>s&&(r.push({t:J.RETAIN,len:o-s}),s=o),a>s&&(r.push({t:J.RETAIN,len:a-s,body:{...Z.deepClone(t),dataStream:""}}),s=a)}),r}const jC=e=>{var h;const{selection:t,body:n,doc:r}=e,s=t.segmentId,i=(h=r.getSelfOrHeaderFooterModel(s))==null?void 0:h.getBody();if(!i)return!1;const o=t.collapsed?null:At(i,t.startOffset,t.endOffset),a=qo(o?o.dataStream:"",n.dataStream);let l=0;const u=a.map(([d,m])=>{switch(d){case 0:{const _={t:J.RETAIN,body:{...At(n,l,l+m.length,!1),dataStream:""},len:m.length};return l+=m.length,_}case 1:{const _={t:J.INSERT,body:At(n,l,l+m.length),len:m.length};return l+=m.length,_}default:return{t:J.DELETE,len:m.length}}}),c=new Me;return c.push({t:J.RETAIN,len:t.startOffset}),c.push(...u),c};function WC(e,t){return!!((e==null?void 0:e.length)===(t==null?void 0:t.length)&&(e!=null&&e.every((n,r)=>JSON.stringify(n)===JSON.stringify(t==null?void 0:t[r]))))}const YC=e=>{var d;const{selection:t,body:n,doc:r,themeService:s}=e,i=t.segmentId,o=(d=r.getSelfOrHeaderFooterModel(i))==null?void 0:d.getBody();if(!o)return!1;const a=t.collapsed?null:At(o,t.startOffset,t.endOffset),l=qo(a?a.dataStream:"",n.dataStream);let u=0;const c=l.map(([m,_])=>{switch(m){case 0:{const p=Js(n,u,u+_.length,!1),I=Js(a,u,u+_.length,!1),A={t:J.RETAIN,body:WC(p,I)?void 0:{textRuns:p==null?void 0:p.map(B=>{var x,Y,O,R,b,T,H;return{...B,ts:{...B.ts,cl:(O=(Y=(x=B.ts)==null?void 0:x.cl)==null?void 0:Y.rgb)!=null&&O.includes(".")?{rgb:s.getColorFromTheme((T=(b=(R=B.ts)==null?void 0:R.cl)==null?void 0:b.rgb)!=null?T:"")}:(H=B.ts)==null?void 0:H.cl}}}),dataStream:""},len:_.length};return u+=_.length,A}case 1:{const p={t:J.INSERT,body:At(n,u,u+_.length),len:_.length};return u+=_.length,p}default:return{t:J.DELETE,len:_.length}}});if(c.every(m=>m.t===J.RETAIN&&!m.body))return!1;const h=new Me;return h.push({t:J.RETAIN,len:t.startOffset}),h.push(...c),h};function GC(e,t){const n=[],{customBlocks:r=[]}=e;for(const s of t){const{startOffset:i,endOffset:o}=s;if(!(i==null||o==null))for(const a of r){const{startIndex:l}=a;l>=i&&l<o&&n.push(a.blockId)}}return n}function VC(e,t=""){if(!t)return["body"];const{headers:n,footers:r}=e.getSnapshot();if(n==null&&r==null)throw new Error("Document data model must have headers or footers when update by segment id");if((n==null?void 0:n[t])!=null)return["headers",t,"body"];if((r==null?void 0:r[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}const zC=e=>{var p,I,A,B;const{selection:t,documentDataModel:n,drawings:r}=e,{collapsed:s,startOffset:i,segmentId:o}=t,a=new Me,l=Yt.getInstance(),u=[],c=n.getSelfOrHeaderFooterModel(o).getBody();if(!c)return!1;const h=(I=(p=n.getSnapshot().drawingsOrder)==null?void 0:p.length)!=null?I:0;let d=0;if(s)i>0&&a.push({t:J.RETAIN,len:i});else{const x=Sh([t],c,0,null,!1);a.push(...x);const Y=GC(c,[t]),O=(A=n.getDrawings())!=null?A:{},R=(B=n.getDrawingsOrder())!=null?B:[],b=Y.sort((T,H)=>R.indexOf(T)>R.indexOf(H)?-1:R.indexOf(T)<R.indexOf(H)?1:0);if(b.length>0)for(const T of b){const H=O[T],$=R.indexOf(T);if(H==null||$<0)continue;const g=l.removeOp(["drawings",T],H),P=l.removeOp(["drawingsOrder",$],T);u.push(g),u.push(P),d++}}a.push({t:J.INSERT,body:{dataStream:"\b".repeat(r.length),customBlocks:r.map((x,Y)=>({startIndex:Y,blockId:x.drawingId}))},len:r.length});const m=VC(n,o),_=l.editOp(a.serialize(),m);u.push(_);for(const x of r){const{drawingId:Y}=x,O=l.insertOp(["drawings",Y],x),R=l.insertOp(["drawingsOrder",h-d],Y);u.push(O),u.push(R)}return u.reduce((x,Y)=>Yt.compose(x,Y),null)};function KC(e,t){if(typeof t>"u")return{startOffset:e,endOffset:e,collapsed:!0};if(t<e)throw new Error(`Cannot make a doc selection when endOffset ${t} is less than startOffset ${e}.`);return{startOffset:e,endOffset:t,collapsed:e===t}}function XC(e){const{startOffset:t,endOffset:n,collapsed:r}=e,s=Math.min(t,n),i=Math.max(t,n);return{startOffset:s,endOffset:i,collapsed:r}}function qC(e,t,n,r){return Math.max(e,n)<=Math.min(t,r)}function Jo(e,t,n,r){const{startOffset:s,endOffset:i}=e,o=r!=null?r:Qo(t,n),a=[];let l=-1;for(let u=0;u<o.length;u++){const c=o[u],{startIndex:h}=c;(s>l&&s<=h||i>l&&i<=h||h>=s&&h<=i)&&a.push(c),l=h}return a}function Zo(e,t,n){const r=[],s=Qo(t,n);for(const i of e){const o=Jo(i,t,n,s);r.push(...o)}return r}const JC=[ut.PARAGRAPH,ut.TABLE_START,ut.TABLE_END,ut.TABLE_ROW_START,ut.TABLE_CELL_START,ut.TABLE_CELL_END];function Qo(e,t){const n=[];for(let r=0;r<e.length;r++){const s=e[r],{startIndex:i}=s;let o=i-1;for(;!JC.includes(t[o])&&o>=0;)o--;n.push({...s,paragraphStart:o+1,paragraphEnd:s.startIndex})}return n}const ZC=e=>{var h,d,m;const{paragraphs:t,segmentId:n,document:r}=e;let s=e.listType;const i=(d=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.paragraphs)!=null?d:[],o=t.every(_=>{var p;return((p=_.bullet)==null?void 0:p.listType.indexOf(s))===0});let l=tt(6);if(t.length===1){const _=i.indexOf(t[0]),p=i[_-1],I=i[_+1];p&&p.bullet&&p.bullet.listType.indexOf(s)===0?(l=p.bullet.listId,s!==xt.CHECK_LIST&&(s=p.bullet.listType)):I&&I.bullet&&I.bullet.listType.indexOf(s)===0&&(l=I.bullet.listId,s!==xt.CHECK_LIST&&(s=I.bullet.listType))}const u=new fn;u.reset();const c=new Me;for(const _ of t){const{startIndex:p,paragraphStyle:I={},bullet:A}=_;c.push({t:J.RETAIN,len:p-u.cursor}),c.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[o?{paragraphStyle:I,startIndex:0}:{startIndex:0,paragraphStyle:{...I},bullet:{nestingLevel:(m=A==null?void 0:A.nestingLevel)!=null?m:0,textStyle:{fs:20},listType:s,listId:l}}]},coverType:Ce.REPLACE}),u.moveCursorTo(p+1)}return c},QC=e=>{var h;const{paragraphIndex:t,segmentId:n,document:r}=e,s=(h=r.getSelfOrHeaderFooterModel(n).getBody())==null?void 0:h.paragraphs;if(s==null)return!1;const i=s.find(d=>d.startIndex===t);if(!(i!=null&&i.bullet)||i.bullet.listType.indexOf(xt.CHECK_LIST)===-1)return!1;const o=new fn;o.reset();const a=new Me,{startIndex:l,paragraphStyle:u={}}=i,c=i.bullet.listType===xt.CHECK_LIST?xt.CHECK_LIST_CHECKED:xt.CHECK_LIST;return a.push({t:J.RETAIN,len:l-o.cursor}),a.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...i,paragraphStyle:u,startIndex:0,bullet:{...i.bullet,listType:c}}]},coverType:Ce.REPLACE}),o.moveCursorTo(l+1),a},eR=e=>{var c,h;const{paragraphs:t,listType:n,segmentId:r,document:s}=e;if(((c=s.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:c.paragraphs)==null)return!1;const a=tt(6),l=new fn;l.reset();const u=new Me;for(const d of t){const{startIndex:m,paragraphStyle:_={},bullet:p}=d;u.push({t:J.RETAIN,len:m-l.cursor}),u.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:_,bullet:{nestingLevel:(h=p==null?void 0:p.nestingLevel)!=null?h:0,textStyle:(p==null?void 0:p.listType)===n?p.textStyle:{fs:20},listType:n,listId:a}}]},coverType:Ce.REPLACE}),l.moveCursorTo(m+1)}return u};function tR(e,t){return t.some(n=>e.startIndex>n.startIndex&&e.startIndex<n.endIndex)}const nR=e=>{var u,c,h;const{paragraphs:t,document:n,type:r}=e,s=new fn;s.reset();const i=new Me,o=(u=n.getSnapshot().lists)!=null?u:{},a=(h=(c=n.getBody())==null?void 0:c.tables)!=null?h:[],l={...kr,...o};for(const d of t){const{startIndex:m,paragraphStyle:_={},bullet:p}=d,I=tR(d,a);if(i.push({t:J.RETAIN,len:m-s.cursor}),p){const A=p.listType;let B=l[A].nestingLevel.length-1;I&&(B=Math.min(B,2)),i.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{..._},bullet:{...p,nestingLevel:Math.max(Math.min(p.nestingLevel+r,B),0)}}]},coverType:Ce.REPLACE})}else i.push({t:J.RETAIN,len:1});s.moveCursorTo(m+1)}return i},rR=e=>{var I,A,B,x;const{textRanges:t,segmentId:n,document:r,style:s,paragraphTextRun:i,cursor:o,deleteLen:a,textX:l}=e,u=r.getSelfOrHeaderFooterModel(n),c=(A=(I=u.getBody())==null?void 0:I.paragraphs)!=null?A:[],h=(x=(B=u.getBody())==null?void 0:B.dataStream)!=null?x:"",d=Zo(t,c,h),m=new fn;o&&m.moveCursorTo(o);const _=l!=null?l:new Me;d.sort((Y,O)=>Y.startIndex-O.startIndex);const p=Math.max(0,d[0].paragraphStart-1);p>m.cursor&&(_.push({t:J.RETAIN,len:p-m.cursor}),m.moveCursorTo(p)),a&&_.push({t:J.DELETE,len:a});for(const Y of d){const{startIndex:O,paragraphStyle:R={}}=Y,b=O-m.cursor;_.push({t:J.RETAIN,len:b,...i?{body:{dataStream:"",textRuns:[{ts:i,st:0,ed:b}]},coverType:Ce.REPLACE}:null}),_.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...R,...s}}]},coverType:Ce.REPLACE}),m.moveCursorTo(O+1)}return _};class Ze{}E(Ze,"customRange",{add:HC,delete:BC,copyCustomRange:UC,getCustomRangesInterestsWithSelection:DC,isIntersecting:Ch}),E(Ze,"customDecoration",{add:MC,delete:LC}),E(Ze,"selection",{replace:jC,makeSelection:KC,normalizeSelection:XC,delete:Sh,replaceTextRuns:YC,retain:$C}),E(Ze,"range",{isIntersects:qC,getParagraphsInRange:Jo,getParagraphsInRanges:Zo}),E(Ze,"transform",{getPlainText:Zs,fromPlainText:TC,isEmptyDocument:yC}),E(Ze,"paragraph",{bullet:{set:eR,switch:ZC,toggleChecklist:QC,changeNestLevel:nR},style:{set:rR},util:{transform:Qo,getParagraphsInRange:Jo,getParagraphsInRanges:Zo}}),E(Ze,"drawing",{add:zC});function sR(e,t,n,r){var u;if(t==="")return e;const s={id:"mock-id",body:e,documentStyle:{}},i=new yt(s),o=t.length;let a;for(;(a=(r?i.getBody().dataStream:i.getBody().dataStream.toLowerCase()).indexOf(t))>=0;){const c=new Me,h=Yt.getInstance();if(a>0&&c.retain(a),n.length>0){const d=i.sliceBody(a,a+o),m={dataStream:n};if(Array.isArray(d==null?void 0:d.textRuns)&&d.textRuns.length&&(m.textRuns=[{...d.textRuns[0],st:0,ed:n.length}]),(u=d==null?void 0:d.customRanges)!=null&&u.length){const _=d.customRanges[0];m.customRanges=[{..._,startIndex:0,endIndex:n.length-1}]}c.insert(n.length,m)}c.delete(o),i.apply(h.editOp(c.serialize()))}const l=i.getBody();return i.dispose(),l}function iR(e){if(e.customRanges||(e.customRanges=[]),!e.paragraphs){e.paragraphs=[];for(let t=0;t<e.dataStream.length;t++)e.dataStream[t]==="\r"&&e.paragraphs.push({startIndex:t})}return e.customBlocks||(e.customBlocks=[]),e.textRuns||(e.textRuns=[]),e.customDecorations||(e.customDecorations=[]),e.sectionBreaks||(e.sectionBreaks=[]),e.tables||(e.tables=[]),e}function Oh(e){var t;return e.body=iR((t=e.body)!=null?t:{dataStream:""}),e.drawingsOrder||(e.drawingsOrder=[]),e.drawings||(e.drawings={}),e.documentStyle||(e.documentStyle={}),e}class Fr{constructor(t={}){E(this,"_style");this._style=t}static create(t={}){return new Fr(t)}get fontFamily(){return this._style.ff}get fontSize(){return this._style.fs}get italic(){return this._style.it===ae.TRUE}get bold(){return this._style.bl===ae.TRUE}get underline(){return this._style.ul&&on.create(this._style.ul)}get bottomBorderLine(){return this._style.bbl&&on.create(this._style.bbl)}get strikethrough(){return this._style.st&&on.create(this._style.st)}get overline(){return this._style.ol&&on.create(this._style.ol)}get background(){return this._style.bg}get border(){return this._style.bd}get color(){return this._style.cl}get verticalAlign(){return this._style.va}get numberFormat(){return this._style.n}copy(){return sn.create(Z.deepClone(this._style))}getValue(){return{...this._style}}}class sn extends Fr{static create(t={}){return new sn(t)}constructor(t={}){super(t)}setFontFamily(t){return this._style.ff=t,this}setFontSize(t){return this._style.fs=t,this}setItalic(t){return this._style.it=t?1:0,this}setBold(t){return this._style.bl=t?1:0,this}setUnderline(t){return this._style.ul=t.build(),this}setBottomBorderLine(t){return this._style.bbl=t.build(),this}setStrikethrough(t){return this._style.st=t.build(),this}setOverline(t){return this._style.ol=t.build(),this}setBackground(t){return this._style.bg=t,this}setBorder(t){return this._style.bd=t,this}setColor(t){return this._style.cl=t,this}setVerticalAlign(t){return this._style.va=t,this}copy(){return sn.create(Z.deepClone(this._style))}build(){return this.getValue()}}class on{constructor(t={s:1}){E(this,"_decoration");this._decoration=t}static create(t={s:1}){return new on(t)}get show(){return this._decoration.s===ae.TRUE}get followFontColor(){return this._decoration.c===ae.TRUE}get color(){return this._decoration.cl}get type(){return this._decoration.t}setShow(t){return this._decoration.s=t?1:0,this}setFollowFontColor(t){return this._decoration.c=t?1:0,this}setColor(t){return this._decoration.cl=t,this}setLineType(t){return this._decoration.t=t,this}copy(){return on.create(Z.deepClone(this._decoration))}build(){return{...this._decoration}}}class xr{constructor(t={}){E(this,"_style");this._style=t}static create(t={}){return new xr(t)}get indentFirstLine(){return this._style.indentFirstLine}get hanging(){return this._style.hanging}get indentStart(){return this._style.indentStart}get tabStops(){return this._style.tabStops}get indentEnd(){return this._style.indentEnd}get textStyle(){return this._style.textStyle}get headingId(){return this._style.headingId}get namedStyleType(){return this._style.namedStyleType}get horizontalAlign(){return this._style.horizontalAlign}get lineSpacing(){return this._style.lineSpacing}get direction(){return this._style.direction}get spacingRule(){return this._style.spacingRule}get snapToGrid(){return this._style.snapToGrid}get spaceAbove(){return this._style.spaceAbove}get spaceBelow(){return this._style.spaceBelow}get borderBetween(){return this._style.borderBetween}get borderTop(){return this._style.borderTop}get borderBottom(){return this._style.borderBottom}get borderLeft(){return this._style.borderLeft}get borderRight(){return this._style.borderRight}get keepLines(){return this._style.keepLines===ae.TRUE}get keepNext(){return this._style.keepNext===ae.TRUE}get wordWrap(){return this._style.wordWrap===ae.TRUE}get widowControl(){return this._style.widowControl===ae.TRUE}get shading(){return this._style.shading}get suppressHyphenation(){return this._style.suppressHyphenation===ae.TRUE}copy(){return Br.create(Z.deepClone(this._style))}getValue(){return this._style}}class Br extends xr{static create(t={}){return new Br(t)}constructor(t={}){super(t)}setIndentFirstLine(t){return this._style.indentFirstLine=t,this}setHanging(t){return this._style.hanging=t,this}setIndentStart(t){return this._style.indentStart=t,this}setTabStops(t){return this._style.tabStops=t,this}setIndentEnd(t){return this._style.indentEnd=t,this}setTextStyle(t){return this._style.textStyle=t,this}setHeadingId(t){return this._style.headingId=t,this}setNamedStyleType(t){return this._style.namedStyleType=t,this}setHorizontalAlign(t){return this._style.horizontalAlign=t,this}setLineSpacing(t){return this._style.lineSpacing=t,this}setDirection(t){return this._style.direction=t,this}setSpacingRule(t){return this._style.spacingRule=t,this}setSnapToGrid(t){return this._style.snapToGrid=t?1:0,this}setSpaceAbove(t){return this._style.spaceAbove=t,this}setSpaceBelow(t){return this._style.spaceBelow=t,this}setBorderBetween(t){return this._style.borderBetween=t,this}setBorderTop(t){return this._style.borderTop=t,this}setBorderBottom(t){return this._style.borderBottom=t,this}setBorderLeft(t){return this._style.borderLeft=t,this}setBorderRight(t){return this._style.borderRight=t,this}setKeepLines(t){return this._style.keepLines=t?1:0,this}setKeepNext(t){return this._style.keepNext=t?1:0,this}setWordWrap(t){return this._style.wordWrap=t?1:0,this}setWidowControl(t){return this._style.widowControl=t?1:0,this}setShading(t){return this._style.shading=t,this}setSuppressHyphenation(t){return this._style.suppressHyphenation=t?1:0,this}copy(){return Br.create(Z.deepClone(this._style))}build(){return this.getValue()}}class an{constructor(t){E(this,"_data");if(!t.body)throw new Error("Invalid document data, body is required");this._data=Oh(t)}static create(t){return new an(t)}static createByBody(t){return new an({body:t,id:"d",documentStyle:{}})}copy(){return Sn.create(Z.deepClone(this._data))}slice(t,n){const{body:r,...s}=this._data;return Sn.create({...Z.deepClone(s),body:At(r,t,n)})}toPlainText(){var t,n;return Ze.transform.getPlainText((n=(t=this._data.body)==null?void 0:t.dataStream)!=null?n:"").replaceAll("\r",`
`)}getParagraphStyle(){var t,n;return xr.create((n=(t=this._data.body)==null?void 0:t.paragraphs)==null?void 0:n[0].paragraphStyle)}getParagraphBullet(){var t,n;return(n=(t=this._data.body)==null?void 0:t.paragraphs)==null?void 0:n[0].bullet}getParagraphs(){var r,s;const t=(s=(r=this._data.body)==null?void 0:r.paragraphs)!=null?s:[];let n=0;return t.map(i=>{const o=this.slice(n,i.startIndex);return n=i.startIndex,o})}getTextRuns(){var t,n;return((n=(t=this._data.body)==null?void 0:t.textRuns)!=null?n:[]).map(r=>({...r,ts:r.ts?Fr.create(r.ts):null}))}getLinks(){var t,n,r;return(r=(n=(t=this._data.body)==null?void 0:t.customRanges)==null?void 0:n.filter(s=>s.rangeType===Qt.HYPERLINK))!=null?r:[]}getData(){return this._data}}class Sn extends an{constructor(n){super(n);E(this,"_doc");this._doc=new yt(n)}static newEmptyData(){return Oh({id:"d",documentStyle:{},drawings:{},drawingsOrder:[],body:{dataStream:`\r
`,customBlocks:[],customRanges:[],paragraphs:[{startIndex:0}],textRuns:[],tables:[],sectionBreaks:[]}})}static create(n){return new Sn(n!=null?n:Sn.newEmptyData())}insertText(n,r,s){var c,h;let i=((h=(c=this._data.body)==null?void 0:c.dataStream.length)!=null?h:2)-2,o,a;if(typeof n=="string"?o=n:(i=Math.min(n,i),o=r),typeof r=="object"?a=r instanceof sn?r.build():r:a=s instanceof sn?s.build():s,!o)return this;const l={dataStream:o,textRuns:a?[{ts:a,st:i,ed:i+o.length}]:[]},u=Ze.selection.replace({doc:this._doc,selection:{startOffset:i,endOffset:i,collapsed:!0},body:l});if(!u)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),u.serialize()),this}insertRichText(n,r){var a,l;let s=((l=(a=this._data.body)==null?void 0:a.dataStream.length)!=null?l:2)-2,i;typeof n=="object"?i=n instanceof an?n.getData():n:(s=Math.min(n,s),i=r instanceof an?r.getData():r);const o=Ze.selection.replace({doc:this._doc,selection:{startOffset:s,endOffset:s,collapsed:!0},body:i.body});if(!o)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),o.serialize()),this}delete(n,r){if(r!==void 0){if(!r)return this;const s=Ze.selection.delete([{startOffset:n,endOffset:n+r,collapsed:!0}],this._data.body);Me.apply(this._doc.getBody(),s)}return this}setStyle(n,r,s){const i={dataStream:"",textRuns:[{ts:s instanceof sn?s.build():s,st:0,ed:r-n}]},o=Ze.selection.retain([{startOffset:n,endOffset:r,collapsed:!0}],i);return Me.apply(this._doc.getBody(),o),this}setLink(n,r,s){const i=Ze.customRange.add({rangeType:Qt.HYPERLINK,rangeId:tt(),properties:{url:s},ranges:[{startOffset:n,endOffset:r,collapsed:!1}],body:this._data.body});if(!i)throw new Error("Insert text failed, please check.");return Me.apply(this._doc.getBody(),i.serialize()),this}cancelLink(n,r){if(typeof n=="string"){const s=Ze.customRange.delete({rangeId:n,documentDataModel:this._doc});if(!s)throw new Error("Insert text failed, please check.");Me.apply(this._doc.getBody(),s.serialize())}else this.slice(n,r).getLinks().forEach(i=>{const o=Ze.customRange.delete({rangeId:i.rangeId,documentDataModel:this._doc});if(!o)throw new Error("Insert text failed, please check.");Me.apply(this._doc.getBody(),o.serialize())});return this}updateLink(n,r){var i,o;const s=(o=(i=this._data.body)==null?void 0:i.customRanges)==null?void 0:o.find(a=>a.rangeId===n);if(!s)throw new Error("Link not found");return s.properties.url=r,this}insertParagraph(n,r){var o,a;let s,i;return typeof n=="object"?(s={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:n.build()}]},i=((a=(o=this._data.body)==null?void 0:o.dataStream.length)!=null?a:2)-2):(i=n,s={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:r==null?void 0:r.build()}]}),this.insertRichText(i,an.create({body:s,id:"d",documentStyle:{}})),this}insertLink(n,r,s){let i="",o="";typeof n=="string"?(i=n,o=r):(i=r,o=s);const a=Sn.createByBody({dataStream:i,customRanges:[{rangeType:Qt.HYPERLINK,rangeId:tt(),properties:{url:o},startIndex:0,endIndex:i.length-1}]});return typeof n=="number"?this.insertRichText(n,a):this.insertRichText(a)}}const oR="__default_document_sub_component_id20231101__";class vh{constructor(){E(this,"skipNextObservers",!1);E(this,"lastReturnValue");E(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}}class aR extends oe.Subject{constructor(){super(...arguments);E(this,"_sortedObservers",[])}subscribe(){throw new Error("[EventSubject]: please use `subscribeEvent` instead of `subscribe` method for `EventSubject`.")}next(){throw new Error("[EventSubject]: please use `emitEvent` instead of `next` method for `EventSubject`.")}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(n){let r;typeof n=="function"?r={next:([i,o])=>n(i,o)}:r=n;const s=super.subscribe(r);return this._sortedObservers.push(r),this._sortedObservers.sort((i,o)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)}),s.add(()=>this._sortedObservers=this._sortedObservers.filter(i=>i!==r)),s}clearObservers(){this._sortedObservers.forEach(n=>{var r;return(r=n.complete)==null?void 0:r.call(n)}),this._sortedObservers.length=0}emitEvent(n){var r;if(!this.closed){const s=new vh;s.lastReturnValue=n;for(const i of this._sortedObservers){const o=(r=i.next)==null?void 0:r.call(i,[n,s]);if(s.lastReturnValue=o,s.skipNextObservers)return{handled:!0,lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}throw new Error("[EventSubject]: cannot emit event on a closed subject.")}}function lR(e){return new oe.Observable(t=>{const n=e.subscribeEvent(r=>{t.next(r)});return()=>n.unsubscribe()})}const Qs=Re.createIdentifier("core.resource-manager.service"),ea={[Ut.Editor]:"Editor",[Ut.Owner]:"Owner",[Ut.Reader]:"Reader",[Ut.UNRECOGNIZED]:"UNRECOGNIZED"},ei=e=>e?{userID:`${ea[e]}_${tt(8)}`,name:ea[e],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},uR=(e,t)=>e.startsWith(ea[t]);class Hr extends ze{constructor(){super(...arguments);E(this,"_model",new Map);E(this,"_userChange$",new oe.Subject);E(this,"userChange$",this._userChange$.asObservable());E(this,"_currentUser$",new oe.BehaviorSubject(ei()));E(this,"currentUser$",this._currentUser$.asObservable())}dispose(){super.dispose(),this._model.clear(),this._userChange$.complete(),this._currentUser$.complete()}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(n){this.addUser(n),this._currentUser$.next(n)}addUser(n){this._model.set(n.userID,n),this._userChange$.next({type:"add",user:n})}getUser(n,r){const s=this._model.get(n);if(s)return s;r&&r()}delete(n){const r=this.getUser(n);this._model.delete(n),r&&this._userChange$.next({type:"delete",user:r})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}}var cR=Object.getOwnPropertyDescriptor,hR=(e,t,n,r)=>{for(var s=r>1?void 0:r?cR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},wh=(e,t)=>(n,r)=>t(n,r,e);f.AuthzIoLocalService=class{constructor(t,n){E(this,"_permissionMap",new Map([]));this._resourceManagerService=t,this._userManagerService=n,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){const t=this._userManagerService.getCurrentUser();t&&t.userID||this._userManagerService.setCurrentUser(ei(Ut.Owner))}_getRole(t){const n=this._userManagerService.getCurrentUser();return n?uR(n.userID,t):!1}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:t=>{const n=[...this._permissionMap.keys()].reduce((r,s)=>{const i=this._permissionMap.get(s);return r[s]=i,r},{});return JSON.stringify(n)},parseJson:t=>JSON.parse(t),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[ve.UNIVER_SHEET,ve.UNIVER_DOC,ve.UNIVER_SLIDE],onLoad:(t,n)=>{for(const r in n)this._permissionMap.set(r,n[r])},onUnLoad:()=>{this._permissionMap.clear()}})}async create(t){return tt(8)}async allowed(t){return Promise.resolve([])}async batchAllowed(t){return Promise.resolve([])}async list(t){const n=[];return t.objectIDs.forEach(r=>{const s=this._permissionMap.get(r);if(s){const i={objectID:r,unitID:t.unitID,objectType:s.objectType,name:s.name,shareOn:!1,shareRole:Ut.Owner,shareScope:-1,scope:{read:bi.AllCollaborator,edit:bi.AllCollaborator},creator:ei(Ut.Owner),strategies:[{action:6,role:1},{action:16,role:1},{action:17,role:1},{action:18,role:1},{action:19,role:1},{action:33,role:1},{action:34,role:1},{action:35,role:1},{action:36,role:1},{action:37,role:1},{action:38,role:1},{action:39,role:1},{action:40,role:1}],actions:t.actions.map(o=>({action:o,allowed:this._getRole(Ut.Owner)||this._getRole(Ut.Editor)}))};n.push(i)}}),n}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(t){}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(t){}},f.AuthzIoLocalService=hR([wh(0,Qs),wh(1,Re.Inject(Hr))],f.AuthzIoLocalService);const bh=Re.createIdentifier("IAuthzIoIoService"),$r="FOCUSING_UNIT",Xn="FOCUSING_SHEET",jr="FOCUSING_DOC",Wr="FOCUSING_SLIDE",dR="FOCUSING_EDITOR_BUT_HIDDEN",Ah="EDITOR_ACTIVATED",fR="FOCUSING_EDITOR_INPUT_FORMULA",yh="FOCUSING_FX_BAR_EDITOR",mR="FOCUSING_UNIVER_EDITOR",gR="FOCUSING_EDITOR_INPUT_FORMULA",_R="FOCUSING_PANEL_EDITOR",pR="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",ER="FOCUSING_COMMON_DRAWINGS",CR="FORMULA_EDITOR_ACTIVATED";class Th extends ze{constructor(){super(...arguments);E(this,"_error$",new oe.Subject);E(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(n){this._error$.next({errorKey:n})}}var ta=(e=>(e.URL="URL",e.UUID="UUID",e.BASE64="BASE64",e))(ta||{}),Nh=(e=>(e.SUCCUSS="0",e.ERROR_EXCEED_SIZE="1",e.ERROR_IMAGE_TYPE="2",e.ERROR_UPLOAD_COUNT_LIMIT="3",e.ERROR_IMAGE="4",e))(Nh||{});const na=Re.createIdentifier("core.image-io.service"),RR={version:"0.12.4"};function IR(e="",t=ur.ZH_CN,n=""){return{id:e,sheetOrder:[],name:n,appVersion:RR.version,locale:t,styles:{},sheets:{},resources:[]}}class Mh{constructor(t={}){E(this,"_styles");E(this,"_cacheMap",new Er(1e5));this._styles=t,this._generateCacheMap()}each(t){return Object.entries(this._styles).forEach(t),this}search(t,n){if(this._cacheMap.has(n))return this._cacheMap.get(n);const r=this._getExistingStyleId(t);return r||"-1"}get(t){return typeof t!="string"?t:(t=String(t),this._styles[t])}add(t,n){const r=tt(6);return this._styles[r]=t,this._cacheMap.set(n,r),r}setValue(t){if(t==null)return;const n=JSON.stringify(t),r=this.search(t,n);return r!=="-1"?r:this.add(t,n)}addCustomStyle(t,n){n!=null&&(this._styles[t]=n,this._cacheMap.set(JSON.stringify(n),t))}remove(t){this._styles[t]&&(delete this._styles[t],this._cacheMap.delete(JSON.stringify(this._styles[t])))}toJSON(){return this._styles}getStyleByCell(t){let n;t&&Z.isObject(t.s)?n=t.s:n=(t==null?void 0:t.s)&&this.get(t.s);const r=t==null?void 0:t.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:t,_cacheMap:n}=this;for(const r in t){const s=JSON.stringify(t[r]);n.set(s,r)}}_getExistingStyleId(t){const{_styles:n}=this;for(const r in n)if(Z.diffValue(n[r],t))return r;return null}}const SR=(e,t)=>t.length===e.length&&!e.some(n=>t.some(r=>!rn.equals(r,n))),OR=(e,t)=>t.length===e.length&&e.every((n,r)=>{const s=t[r];return s.unitId===n.unitId&&s.sheetId===n.sheetId&&rn.equals(n.range,s.range)}),ra={t:0,b:2,l:2,r:2},vR=e=>({sbr:.6,sbo:e,spr:.6,spo:e}),Lh=90;function Yr(e,t,n={}){const r=e.length,{textRotation:s,paddingData:i,horizontalAlign:o=wt.UNSPECIFIED,verticalAlign:a=mn.UNSPECIFIED,wrapStrategy:l=gn.UNSPECIFIED,cellValueType:u}=n,{t:c,r:h,b:d,l:m}=i||ra,{vertexAngle:_,centerAngle:p}=Fh(s),I={id:"d",body:{dataStream:`${e}${Ra}`,textRuns:[{ts:t,st:0,ed:r}],paragraphs:[{startIndex:r,paragraphStyle:{horizontalAlign:o}}],sectionBreaks:[{startIndex:r+1}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:c,marginBottom:d,marginRight:h,marginLeft:m,renderConfig:{horizontalAlign:o,verticalAlign:a,centerAngle:p,vertexAngle:_,wrapStrategy:l,cellValueType:u}},drawings:{},drawingsOrder:[]};return new yt(I)}function wR(e){if(!e)return{};const{tr:t,td:n,ht:r,vt:s,tb:i,pd:o}=e;return{textRotation:t,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:i,paddingData:o}}function Dh(e){if(!e)return{};const{ff:t,fs:n,it:r,bl:s,ul:i,st:o,ol:a,cl:l,bg:u}=e,c={};return t&&(c.ff=t),n&&(c.fs=n),r&&(c.it=r),s&&(c.bl=s),i&&(c.ul=i),o&&(c.st=o),a&&(c.ol=a),l&&(c.cl=l),u&&(c.bg=u),c}function Uh(e,t,n){var i;const r=e.getBody();if((i=r.customRanges)!=null&&i.some(o=>o.rangeType===Qt.HYPERLINK))return;const s=Ze.customRange.add({ranges:[{startOffset:0,endOffset:r.dataStream.length-1,collapsed:!1}],rangeId:n,rangeType:Qt.HYPERLINK,body:r,properties:{url:t,refId:n}});s&&Me.apply(r,s.serialize())}function Ph(e){return e!=null}const bR='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';function kh(e){const t=st.ff,n=st.fs;if(!e){const h=`${n}pt  ${t}`;return{fontCache:h,fontString:h,fontSize:n,originFontSize:n,fontFamily:t}}let r=Ln.ITALIC;(e.it===0||e.it===void 0)&&(r=Ln.NORMAL);let s=Ln.BOLD;(e.bl===0||e.bl===void 0)&&(s=Ln.NORMAL);let i=n;e.fs&&(i=Math.ceil(e.fs));let o=t;if(e.ff){let h=e.ff;h=h.replace(/"/g,"").replace(/'/g,""),h.indexOf(" ")>-1&&(h=`"${h}"`),h==null&&(h=t),o=h}const{va:a}=e;let l=i;if(a===jt.SUBSCRIPT||a===jt.SUPERSCRIPT){const h=AR(o,l),{sbr:d,spr:m}=h;l*=a===jt.SUBSCRIPT?d:m}const u=`${r} ${s} ${l}pt ${o}`,c=`${u}, ${bR} `;return{fontCache:u,fontString:c,fontSize:l,originFontSize:i,fontFamily:o}}function AR(e,t){return vR(t)}function Fh(e){const{a:t=0,v:n=ae.FALSE}=e||{a:0,v:ae.FALSE};let r=0,s=t;return n===ae.TRUE&&(r=Lh,s=Lh),{centerAngle:r,vertexAngle:s}}class yR{constructor(t,n){E(this,"_columnData",{});this._config=t,this._columnData=n}getColumnData(){return this._columnData}getColVisible(t){const{_columnData:n}=this,r=n[t];return r?r.hd!==ae.TRUE:!0}getColumnStyle(t){var n;return(n=this._columnData[t])==null?void 0:n.s}setColumnStyle(t,n){const r=this.getColumnOrCreate(t);r.s=n}getHiddenCols(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getColVisible(o);s&&a?(s=!1,r.push({rangeType:pe.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!s&&!a&&(s=!0,i=o)}return s&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:n,rangeType:pe.COLUMN}),r}getVisibleCols(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getColVisible(o);s&&!a?(s=!1,r.push({rangeType:pe.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!s&&a&&(s=!0,i=o)}return s&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:n,rangeType:pe.COLUMN}),r}getColumnDatas(t,n){const r={};let s=0;for(let i=t;i<t+n;i++){const o=this.getColumn(i);r[s]=o!=null?o:{w:this._config.defaultColumnWidth,hd:ae.FALSE},s++}return r}getSize(){return en(this._columnData)}getColumnWidth(t){var n,r;return(r=(n=this._columnData[t])==null?void 0:n.w)!=null?r:this._config.defaultColumnWidth}setColumnWidth(t,n){const r=this._columnData[t];n===this._config.defaultColumnWidth?r&&(delete r.w,Object.keys(r).length===0&&delete this._columnData[t]):this._columnData[t]=r?{...r,w:n}:{w:n}}getColumn(t){return this._columnData[t]}removeColumn(t){delete this._columnData[t]}getColumnOrCreate(t){const{_columnData:n}=this,r=n[t];if(r)return r;const s={};return this._columnData[t]=s,s}setCustomMetadata(t,n){const r=this.getColumn(t);r&&(r.custom=n)}getCustomMetadata(t){var n;return(n=this.getColumn(t))==null?void 0:n.custom}}const TR=2e3;class NR{constructor(t,n,r){E(this,"_rowData");this._config=t,this._viewModel=n,this._rowData=r}getRowData(){return this._rowData}getRowStyle(t){var n;return(n=this._rowData[t])==null?void 0:n.s}setRowStyle(t,n){const r=this.getRowOrCreate(t);r.s=n}getRowDatas(t,n){const r={};let s=0;for(let i=t;i<t+n;i++){const o=this.getRow(i);r[s]=o!=null?o:{h:this._config.defaultRowHeight,hd:ae.FALSE},s++}return r}getRowHeight(t,n=1){const{_rowData:r}=this,s=this._config;let i=0;for(let o=0;o<n;o++){const a=r[o+t]||{hd:ae.FALSE,h:s.defaultRowHeight},{ia:l,ah:u,h:c=s.defaultRowHeight}=a;i+=(l==null||l===ae.TRUE)&&typeof u=="number"?u:c}return i}setRowHeight(t,n){const r=this._rowData[t];if(n===this._config.defaultRowHeight)r&&(delete r.h,Object.keys(r).length===0&&delete this._rowData[t]);else{const s=Math.min(n,TR);this._rowData[t]=r?{...r,h:s}:{h:s}}}getRow(t){return this._rowData[t]}removeRow(t){delete this._rowData[t]}getRowOrCreate(t){const{_rowData:n}=this,r=n[t];if(r)return r;const s={};return n[t]=s,s}getHiddenRows(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getRowRawVisible(o);s&&a?(s=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:pe.ROW})):!s&&!a&&(s=!0,i=o)}return s&&r.push({startRow:i,endRow:n,startColumn:0,endColumn:0,rangeType:pe.ROW}),r}getVisibleRows(t=0,n=this.getSize()-1){const r=[];let s=!1,i=-1;for(let o=t;o<=n;o++){const a=this.getRowRawVisible(o);s&&!a?(s=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:pe.ROW})):!s&&a&&(s=!0,i=o)}return s&&r.push({startRow:i,endRow:n,startColumn:0,endColumn:0,rangeType:pe.ROW}),r}getRowRawVisible(t){const n=this.getRow(t);return n?n.hd!==ae.TRUE:!0}getSize(){return en(this._rowData)}setCustomMetadata(t,n){const r=this.getRow(t);r&&(r.custom=n)}getCustomMetadata(t){var n;return(n=this.getRow(t))==null?void 0:n.custom}}const MR="DEFAULT_WORKSHEET_ROW_COUNT",xh=1e3,LR="DEFAULT_WORKSHEET_COLUMN_COUNT",Bh=20,DR="DEFAULT_WORKSHEET_ROW_HEIGHT",Hh=24,UR="DEFAULT_WORKSHEET_COLUMN_WIDTH",$h=88,PR="DEFAULT_WORKSHEET_ROW_TITLE_WIDTH",jh=46,kR="DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT",Wh=20;function Yh(e){const t={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:ae.FALSE,rowCount:xh,columnCount:Bh,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:$h,defaultRowHeight:Hh,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:ae.TRUE,rowHeader:{width:jh,hidden:ae.FALSE},columnHeader:{height:Wh,hidden:ae.FALSE},rightToLeft:ae.FALSE};return Object.keys(t).forEach(n=>{const r=n;typeof e[r]>"u"&&(e[r]=t[r])}),e}class FR extends ze{constructor(n){super();E(this,"_cellCache",new Map);E(this,"_rowCache",new Map);E(this,"_columnCache",new Map);E(this,"_hasRow",!1);E(this,"_hasColumn",!1);E(this,"_hasAll",!1);E(this,"_allIndex",-1);E(this,"_mergeData");E(this,"_rangeMap",new Er(5e4));E(this,"_skeletonCache",new Er(5e4));this._init(n.concat())}_init(n){this._mergeData=n,this._createCache(n)}_clearCache(){this._cellCache.clear(),this._rowCache.clear(),this._columnCache.clear(),this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._skeletonCache.clear(),this._hasColumn=!1,this._hasRow=!1}_createCache(n){let r=0;for(const s of n){const{rangeType:i}=s;i===pe.ROW?this._createRowCache(s,r):i===pe.COLUMN?this._createColumnCache(s,r):i===pe.ALL?this._createCellAllCache(r):this._createCellCache(s,r),r++}}rebuild(n){this._clearCache(),this._init(n.concat())}_createRowCache(n,r){const{startRow:s,endRow:i}=n;for(let o=s;o<=i;o++)this._rowCache.set(o,r),this._hasRow=!0}_createColumnCache(n,r){const{startColumn:s,endColumn:i}=n;for(let o=s;o<=i;o++)this._columnCache.set(o,r),this._hasColumn=!0}_createCellAllCache(n){this._hasAll=!0,this._allIndex=n}_createCellCache(n,r){for(let s=n.startRow;s<=n.endRow;s++){let i=this._cellCache.get(s);i==null&&(i=new Map,this._cellCache.set(s,i));for(let o=n.startColumn;o<=n.endColumn;o++)i.set(o,r)}}add(n){this._mergeData.push(n),this._clearCache(),this._createCache(this._mergeData)}remove(n,r){const s=this._getMergeDataIndex(n,r);s!==-1&&(this._mergeData.splice(s,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(n,r){const s=this._getMergeDataIndex(n,r);return s!==-1?this._mergeData[s]:null}getMergeDataIndex(n,r){return this._getMergeDataIndex(n,r)}isRowContainsMergedCell(n){return this._hasAll||!Z.isEmptyObject(this._columnCache)?!0:this._mergeData.some(r=>r.startRow<=n&&n<=r.endRow)}isColumnContainsMergedCell(n){return this._hasAll||!Z.isEmptyObject(this._rowCache)?!0:this._mergeData.some(r=>r.startColumn<=n&&n<=r.endColumn)}getMergedCellRange(n,r,s,i){const o=[],a=`${n}-${r}-${s}-${i}`;if(this._rangeMap.has(a))return this._getRangeFromCache(a);let l=0;const u=[];for(const c of this._mergeData||[])rn.intersects(c,{startRow:n,endRow:s,startColumn:r,endColumn:i})&&(o.push({...c}),u.push(l)),l++;return this._rangeMap.set(a,u),o}getMergedCellRangeForSkeleton(n,r,s,i){const o=[],a=this._mergeData,l=`${n}-${r}-${s}-${i}`;if(this._skeletonCache.has(l))return this._getSkeletonRangeFromCache(l);const u=[];for(let c=0;c<a.length;c++){const{startRow:h,endRow:d,startColumn:m,endColumn:_}=a[c];for(let p=n;p<=s;p++){let I=!1;for(let A=r;A<=i;A++)if(p>=h&&p<=d&&A>=m&&A<=_){o.push({startRow:h,endRow:d,startColumn:m,endColumn:_}),u.push(c),I=!0;break}if(I)break}}return this._skeletonCache.set(l,u),o}_getRangeFromCache(n){const r=this._rangeMap.get(n)||[],s=[];for(const i of r)s.push({...this._mergeData[i]});return s}_getSkeletonRangeFromCache(n){const r=this._skeletonCache.get(n)||[],s=[];for(const i of r)s.push({...this._mergeData[i]});return s}_getMergeDataIndex(n,r){var i;if(this._hasAll)return this._allIndex;if(this._hasRow){const o=this._rowCache.get(n);if(o!==void 0)return o}if(this._hasColumn){const o=this._columnCache.get(r);if(o!==void 0)return o}const s=(i=this._cellCache.get(n))==null?void 0:i.get(r);return s!==void 0?s:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}}class Gh extends ze{constructor(n){super();E(this,"_cellContentInterceptor",null);E(this,"_rowFilteredInterceptor",null);this.getRawCell=n}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(n,r,s,i){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,An.Value|An.Style,s,i):this.getRawCell(n,r)}getCellValueOnly(n,r){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,An.Value):this.getRawCell(n,r)}getCellStyleOnly(n,r){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(n,r,An.Style):this.getRawCell(n,r)}getRowFiltered(n){var r,s;return(s=(r=this._rowFilteredInterceptor)==null?void 0:r.getRowFiltered(n))!=null?s:!1}registerCellContentInterceptor(n){if(this._cellContentInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=n,He(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(n){if(this._rowFilteredInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=n,He(()=>this._rowFilteredInterceptor=null)}}function ft(e){if(e==null||typeof e!=="object")return e;if(Array.isArray(e)){const s=e.length,i=new Array(s);for(let o=0;o<s;o++)i[o]=ft(e[o]);return i}const n={},r=Object.keys(e);for(let s=0,i=r.length;s<i;s++){const o=r[s];n[o]=ft(e[o])}return n}function Vh(e){if(e==null)return e;const t={};return e.p!==void 0&&(t.p=e.p===null?null:ft(e.p)),e.s!==void 0&&(e.s===null||typeof e.s=="string"?t.s=e.s:t.s=ft(e.s)),e.v!==void 0&&(t.v=e.v),e.t!==void 0&&(t.t=e.t),e.f!==void 0&&(t.f=e.f),e.ref!==void 0&&(t.ref=e.ref),e.xf!==void 0&&(t.xf=e.xf),e.si!==void 0&&(t.si=e.si),e.custom!==void 0&&(t.custom=e.custom===null?null:ft(e.custom)),t}function xR(e){if(e==null)return e;const t={};return e.p!==void 0&&(t.p=e.p===null?null:ft(e.p)),e.s!==void 0&&(e.s===null||typeof e.s=="string"?t.s=e.s:t.s=ft(e.s)),e.v!==void 0&&(t.v=e.v),e.t!==void 0&&(t.t=e.t),e.f!==void 0&&(t.f=e.f),e.ref!==void 0&&(t.ref=e.ref),e.xf!==void 0&&(t.xf=e.xf),e.si!==void 0&&(t.si=e.si),e.custom!==void 0&&(t.custom=e.custom===null?null:ft(e.custom)),e.rowSpan!==void 0&&(t.rowSpan=e.rowSpan),e.colSpan!==void 0&&(t.colSpan=e.colSpan),e.displayV!==void 0&&(t.displayV=e.displayV),t}function zh(e){const t={},n=Object.keys(e);for(let r=0,s=n.length;r<s;r++){const i=n[r],o=Number(i),a=e[o];if(a===void 0)continue;const l={},u=Object.keys(a);for(let c=0,h=u.length;c<h;c++){const d=u[c],m=Number(d),_=a[m];_!=null&&(l[m]=Vh(_))}t[o]=l}return t}function Kh(e){const t={},n=Object.keys(e);for(let r=0,s=n.length;r<s;r++){const i=n[r],o=Number(i),a=e[o];if(a===void 0)continue;const l={};"h"in a&&a.h!==void 0&&(l.h=a.h),"ia"in a&&a.ia!==void 0&&(l.ia=a.ia),"ah"in a&&a.ah!==void 0&&(l.ah=a.ah),"hd"in a&&a.hd!==void 0&&(l.hd=a.hd),"w"in a&&a.w!==void 0&&(l.w=a.w),"s"in a&&a.s!==void 0&&(a.s===null||typeof a.s=="string"?l.s=a.s:l.s=ft(a.s)),"custom"in a&&a.custom!==void 0&&(l.custom=a.custom===null?null:ft(a.custom)),t[o]=l}return t}function BR(e){const t=e.length,n=new Array(t);for(let r=0;r<t;r++){const s=e[r];n[r]={startRow:s.startRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.endColumn,rangeType:s.rangeType,startAbsoluteRefType:s.startAbsoluteRefType,endAbsoluteRefType:s.endAbsoluteRefType}}return n}function Xh(e){const t={id:e.id,name:e.name,tabColor:e.tabColor,hidden:e.hidden,rowCount:e.rowCount,columnCount:e.columnCount,zoomRatio:e.zoomRatio,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,defaultColumnWidth:e.defaultColumnWidth,defaultRowHeight:e.defaultRowHeight,showGridlines:e.showGridlines,rightToLeft:e.rightToLeft,freeze:{xSplit:e.freeze.xSplit,ySplit:e.freeze.ySplit,startRow:e.freeze.startRow,startColumn:e.freeze.startColumn},rowHeader:{width:e.rowHeader.width,hidden:e.rowHeader.hidden},columnHeader:{height:e.columnHeader.height,hidden:e.columnHeader.hidden},mergeData:BR(e.mergeData),cellData:zh(e.cellData),rowData:Kh(e.rowData),columnData:Kh(e.columnData)};return e.gridlinesColor!==void 0&&(t.gridlinesColor=e.gridlinesColor),e.defaultStyle!==void 0&&(e.defaultStyle===null||typeof e.defaultStyle=="string"?t.defaultStyle=e.defaultStyle:t.defaultStyle=ft(e.defaultStyle)),e.custom!==void 0&&(t.custom=e.custom===null?null:ft(e.custom)),t}const qh={isDeepClone:!1,displayRawFormula:!1,ignoreTextRotation:!1};class Gr{constructor(t,n,r){E(this,"_sheetId");E(this,"_snapshot");E(this,"_cellData");E(this,"_rowManager");E(this,"_columnManager");E(this,"_viewModel");E(this,"_spanModel");E(this,"_isRowStylePrecedeColumnStyle",!0);E(this,"_getCellHeight");var a;this.unitId=t,this._styles=r,this._snapshot=Yh(n);const{columnData:s,rowData:i,cellData:o}=this._snapshot;this._sheetId=(a=this._snapshot.id)!=null?a:tt(6),this._cellData=new lt(o),this._viewModel=new Gh((l,u)=>this.getCellRaw(l,u)),this._rowManager=new NR(this._snapshot,this._viewModel,i),this._columnManager=new yR(this._snapshot,s),this._spanModel=new FR(this._snapshot.mergeData)}__interceptViewModel(t){t(this._viewModel)}__registerGetCellHeight(t){return this._getCellHeight=t,He(()=>{this._getCellHeight=null})}getSnapshot(){return this._snapshot}getCellHeight(t,n){return this._getCellHeight?this._getCellHeight(t,n):this._snapshot.defaultRowHeight}setMergeData(t){this._snapshot.mergeData=t,this.getSpanModel().rebuild(t)}getSpanModel(){return this._spanModel}setIsRowStylePrecedeColumnStyle(t){this._isRowStylePrecedeColumnStyle=t}getStyleDataByHash(t){return{...this._styles.get(t)}}setStyleData(t){return this._styles.setValue(t)}getColumnStyle(t,n=!1){return n?this._columnManager.getColumnStyle(t):this._styles.get(this._columnManager.getColumnStyle(t))}setColumnStyle(t,n){this._columnManager.setColumnStyle(t,n)}getRowStyle(t,n=!1){return n?this._rowManager.getRowStyle(t):this._styles.get(this._rowManager.getRowStyle(t))}setRowStyle(t,n){this._rowManager.setRowStyle(t,n)}getDefaultCellStyle(){return this._snapshot.defaultStyle}getDefaultCellStyleInternal(){const t=this._snapshot.defaultStyle;return this._styles.get(t)}setDefaultCellStyle(t){this._snapshot.defaultStyle=t}getCellStyle(t,n){const r=this.getCell(t,n);if(r){const s=r.s;return typeof s=="string"?this._styles.get(s):s}return null}getComposedCellStyle(t,n,r){const s=this.getDefaultCellStyleInternal(),i=this.getRowStyle(t),o=this.getColumnStyle(n),a=this.getCell(t,n),l=this._styles.getStyleByCell(a);return(r!=null?r:this._isRowStylePrecedeColumnStyle)?lr(s,o,i,a==null?void 0:a.themeStyle,l):lr(s,i,o,a==null?void 0:a.themeStyle,l)}getComposedCellStyleByCellData(t,n,r,s){const i=this.getDefaultCellStyleInternal(),o=this.getRowStyle(t),a=this.getColumnStyle(n),l=this._styles.getStyleByCell(r);return(s!=null?s:this._isRowStylePrecedeColumnStyle)?lr(i,a,o,r==null?void 0:r.themeStyle,l):lr(i,o,a,r==null?void 0:r.themeStyle,l)}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){const t=this.getCellMatrix(),n=this.getMergeData();let r=-1,s=-1,i=-1,o=-1,a=!1,l=!1;return t.forEach((u,c)=>{Object.keys(c).forEach(h=>{const d=+h,m=t.getValue(u,d),_=m!=null&&m.s?this._styles.get(m.s):null,p=(_==null?void 0:_.bd)&&(_.bd.b||_.bd.l||_.bd.r||_.bd.t||_.bd.bc_tr||_.bd.bl_tr||_.bd.ml_tr||_.bd.tl_bc||_.bd.tl_br||_.bd.tl_mr);(m&&(m.v!==null&&m.v!==void 0&&m.v!==""||m.p)||_!=null&&_.bg||p)&&(a?r=Math.min(r,u):(r=u,a=!0),s=Math.max(s,u),l?i=Math.min(i,d):(l=!0,i=d),o=Math.max(o,d))})}),n.forEach(u=>{a?r=Math.min(r,u.startRow):(r=u.startRow,a=!0),s=Math.max(s,u.endRow),l?i=Math.min(i,u.startColumn):(i=u.startColumn,a=!0),o=Math.max(o,u.endColumn)}),!a||!l?null:{startColumn:i,startRow:r,endColumn:o,endRow:s}}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:t}=this,n=Xh(t);return new Gr(this.unitId,n,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(t,n){return this._spanModel.getMergedCell(t,n)}getMergedCellRange(t,n,r,s){return this._spanModel.getMergedCellRange(t,n,r,s)}isRowContainsMergedCell(t){return this._spanModel.isRowContainsMergedCell(t)}isColumnContainsMergedCell(t){return this._spanModel.isColumnContainsMergedCell(t)}getCellInfoInMergeData(t,n){const r=this.getMergedCell(t,n);let s=!1,i=!1,o=t,a=n,l=t,u=n;if(r){const{startRow:c,endRow:h,startColumn:d,endColumn:m}=r;t===c&&n===d?(o=h,a=m,l=c,u=d,i=!0):t>=c&&t<=h&&n>=d&&n<=m&&(o=h,a=m,l=c,u=d,s=!0)}return{actualRow:t,actualColumn:n,isMergedMainCell:i,isMerged:s,endRow:o,endColumn:a,startRow:l,startColumn:u}}getCell(t,n){return t<0||n<0?null:this._viewModel.getCell(t,n)}getCellValueOnly(t,n){return t<0||n<0?null:this._viewModel.getCellValueOnly(t,n)}getCellStyleOnly(t,n){return t<0||n<0?null:this._viewModel.getCellStyleOnly(t,n)}getCellRaw(t,n){return this.getCellMatrix().getValue(t,n)}getCellWithFilteredInterceptors(t,n,r,s){return this._viewModel.getCell(t,n,r,s)}getRowFiltered(t){return this._viewModel.getRowFiltered(t)}getRangeFilterRows(t){const n=[];for(let r=t.startRow;r<=t.endRow;r++)this.getRowFiltered(r)&&n.push(r);return n}getMatrixWithMergedCells(t,n,r,s,i=Un.Raw){const o=this.getCellMatrix(),a=this._spanModel.getMergedCellRange(t,n,r,s),l=new lt;return jo(t,r,n,s).forEach((u,c)=>{var d;let h;if(i===Un.Raw)h=this.getCellRaw(u,c);else if(i===Un.Intercepted)h=this.getCell(u,c);else if(i===Un.Both){const m=this.getCellRaw(u,c);if(m){h={...m};const _=(d=this.getCell(u,c))==null?void 0:d.v;Ph(_)&&h&&(h.displayV=String(_))}}h&&l.setValue(u,c,h)}),a.forEach(u=>{const{startColumn:c,startRow:h,endColumn:d,endRow:m}=u;jo(h,m,c,d).forEach((_,p)=>{_===h&&p===c&&l.setValue(_,p,{...o.getValue(_,p),rowSpan:m-h+1,colSpan:d-c+1}),(_!==h||p!==c)&&l.realDeleteValue(_,p)})}),l}getRange(t,n,r,s){return typeof t=="object"?new Wn(this,t,{getStyles:()=>this._styles}):new Wn(this,{startRow:t,startColumn:n,endColumn:s||n,endRow:r||t},{getStyles:()=>this._styles})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:t}=this,{columnCount:n}=t;return n}getMaxRows(){const{_snapshot:t}=this,{rowCount:n}=t;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(t){this._snapshot.rowCount=t}getColumnCount(){return this._snapshot.columnCount}setColumnCount(t){this._snapshot.columnCount=t}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:t}=this,{showGridlines:n}=t;return n===0}getGridlinesColor(){return this.getConfig().gridlinesColor}getTabColor(){const{_snapshot:t}=this,{tabColor:n}=t;return n}getColumnWidth(t){return this.getColumnManager().getColumnWidth(t)}getRowHeight(t){return this._viewModel.getRowFiltered(t)?0:this.getRowManager().getRowHeight(t)}isRowFiltered(t){return this._viewModel.getRowFiltered(t)}getRowVisible(t){return!this.isRowFiltered(t)&&this.getRowRawVisible(t)}getRowRawVisible(t){return this.getRowManager().getRowRawVisible(t)}getHiddenRows(t,n){const r=this.getMaxColumns()-1,s=this._rowManager.getHiddenRows(t,n);return s.forEach(i=>i.endColumn=r),s}getColVisible(t){return this._columnManager.getColVisible(t)}getHiddenCols(t,n){const r=this.getMaxRows()-1,s=this._columnManager.getHiddenCols(t,n);return s.forEach(i=>i.endRow=r),s}getVisibleRows(){const t=this.getRowCount();return this._rowManager.getVisibleRows(0,t-1)}getVisibleCols(){const t=this.getColumnCount();return this._columnManager.getVisibleCols(0,t-1)}isRightToLeft(){const{_snapshot:t}=this,{rightToLeft:n}=t;return n}getLastRowWithContent(){return this._cellData.getRealRowRange().endRow}getLastColumnWithContent(){return this.getDataRealRange().endColumn}getDataRealRange(){return this._cellData.getRealRange()}getDataRangeScope(){return this._cellData.getStartEndScope()}cellHasValue(t){return t&&(t.v!==void 0||t.f!==void 0||t.p!==void 0)}iterateByRow(t,n=!0){const{startRow:r,startColumn:s,endRow:i,endColumn:o}=t,a=this;return{[Symbol.iterator]:()=>{let l=r,u=s;return{next(){for(;;){if(u>o&&(l+=1,u=s),l>i)return{done:!0,value:void 0};const c=a.getCell(l,u),h=!c,d=a.getMergedCell(l,u);if(d){if(l!==d.startRow||u!==d.startColumn){u=d.endColumn+1;continue}if(h&&n){u=d.endColumn+1;continue}const _={row:l,col:u,value:c};return _.colSpan=d.endColumn-d.startColumn+1,_.rowSpan=d.endRow-d.startRow+1,u=d.endColumn+1,{done:!1,value:_}}if(h&&n)u+=1;else{const m={row:l,col:u,value:c};return u+=1,{done:!1,value:m}}}}}}}}iterateByColumn(t,n=!0,r=!0){const{startRow:s,startColumn:i,endRow:o,endColumn:a}=t,l=this;return{[Symbol.iterator]:()=>{let u=s,c=i;return{next(){for(;;){if(u>o&&(c+=1,u=s),c>a)return{done:!0,value:void 0};const h=l.getMergedCell(u,c);if(h){const _=u!==h.startRow,p=_||c!==h.startColumn;if(r&&p||!r&&_){u=h.endRow+1;continue}const I=l.getCell(h.startRow,h.startColumn);if(!I&&n){u=h.endRow+1;continue}const B={row:u,col:h.startColumn,value:I};return B.colSpan=h.endColumn-h.startColumn+1,B.rowSpan=h.endRow-h.startRow+1,u=h.endRow+1,{done:!1,value:B}}const d=l.getCell(u,c);if(!d&&n)u+=1;else{const _={row:u,col:c,value:d};return u+=1,{done:!1,value:_}}}}}}}}getCellDocumentModel(t,n,r=qh){var p;if(!t)return;const{isDeepClone:s,displayRawFormula:i,ignoreTextRotation:o}={...qh,...r};let a,l="document";const u=wR(n),c=o?st.tr:u.textRotation||st.tr;let h=u.horizontalAlign||st.ht;const d=u.verticalAlign||st.vt,m=u.wrapStrategy||st.tb,_=u.paddingData||ra;if(t.f&&i)a=Yr(t.f.toString(),{},{verticalAlign:d}),h=st.ht;else if(t.p){const{centerAngle:I,vertexAngle:A}=Fh(c);a=this._updateConfigAndGetDocumentModel(s?Z.deepClone(t.p):t.p,h,_,{horizontalAlign:h,verticalAlign:d,centerAngle:I,vertexAngle:A,wrapStrategy:m,zeroWidthParagraphBreak:1})}else if(t.v!=null){const I=Dh(n);l=kh(I).fontCache;let A=Jh(t);t.t===Zt.FORCE_STRING&&i&&(A=`'${A}`),a=Yr(A,I,{...u,textRotation:c,cellValueType:t.t})}return a&&t.linkUrl&&t.linkId&&Uh(a,t.linkUrl,t.linkId),{documentModel:a,fontString:l,textRotation:c,wrapStrategy:m,verticalAlign:d,horizontalAlign:h,paddingData:_,fill:(p=n==null?void 0:n.bg)==null?void 0:p.rgb}}_updateConfigAndGetDocumentModel(t,n,r,s){var o,a,l,u,c;if(!s||!((o=t.body)!=null&&o.dataStream))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.marginTop=(a=r.t)!=null?a:0,t.documentStyle.marginBottom=(l=r.b)!=null?l:2,t.documentStyle.marginLeft=(u=r.l)!=null?u:2,t.documentStyle.marginRight=(c=r.r)!=null?c:2,t.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},t.documentStyle.renderConfig={...t.documentStyle.renderConfig,...s};const i=t.body.paragraphs||[];for(const h of i)h.paragraphStyle||(h.paragraphStyle={}),h.paragraphStyle.horizontalAlign=n;return new yt(t)}getBlankCellDocumentModel(t,n,r){const s=this.getComposedCellStyleByCellData(n,r,t),i=Dh(s),o=this.getCellDocumentModel(t,s,{ignoreTextRotation:!0});if(o!=null)return o.documentModel==null&&(o.documentModel=Yr("",i)),o;const a="";let l="document";const u=st.tr,c=st.ht,h=st.vt,d=st.tb,m=ra;return l=kh({}).fontCache,{documentModel:Yr(a,i),fontString:l,textRotation:u,wrapStrategy:d,verticalAlign:h,horizontalAlign:c,paddingData:m}}getCellDocumentModelWithFormula(t,n,r){const s=this.getComposedCellStyleByCellData(n,r,t);return this.getCellDocumentModel(t,s,{isDeepClone:!0,displayRawFormula:!0,ignoreTextRotation:!0})}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(t){this._snapshot.custom=t}}function Jh(e){var r,s;if(!e)return"";const t=(s=(r=e.p)==null?void 0:r.body)==null?void 0:s.dataStream;if(t)return Ze.transform.getPlainText(t);const n=e.v;return typeof n=="string"?e.t===Zt.BOOLEAN?n.toUpperCase():n.replace(/[\r\n]/g,""):typeof n=="number"?e.t===Zt.BOOLEAN?n?"TRUE":"FALSE":n.toString():typeof n=="boolean"?n?"TRUE":"FALSE":""}function HR(e){if(e===null)return"";if(e!=null&&e.p){const t=e==null?void 0:e.p.body;if(t==null)return"";const n=t.dataStream;return Ze.transform.getPlainText(n)}return e==null?void 0:e.v}var $R=Object.getOwnPropertyDescriptor,jR=(e,t,n,r)=>{for(var s=r>1?void 0:r?$R(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},WR=(e,t)=>(n,r)=>t(n,r,e);function YR(e,t){return`${e.getUnitId()}|${t.getSheetId()}`}f.Workbook=class extends as{constructor(n={},r){super();E(this,"type",ve.UNIVER_SHEET);E(this,"_sheetCreated$",new oe.Subject);E(this,"sheetCreated$",this._sheetCreated$.asObservable());E(this,"_sheetDisposed$",new oe.Subject);E(this,"sheetDisposed$",this._sheetDisposed$.asObservable());E(this,"_activeSheet$",new oe.BehaviorSubject(null));E(this,"activeSheet$",this._activeSheet$.asObservable());E(this,"_worksheets");E(this,"_styles");E(this,"_snapshot");E(this,"_unitId");E(this,"_count");E(this,"_name$");E(this,"name$");this._logService=r;const s=IR();Z.isEmptyObject(n)?this._snapshot=s:this._snapshot=Z.commonExtend(s,n);const{styles:i}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=tt(6)),this._unitId=this._snapshot.id,this._styles=new Mh(i),this._count=1,this._worksheets=new Map,this._name$=new oe.BehaviorSubject(n.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(n){return typeof n=="string"||"startRow"in n||"row"in n}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete()}save(){return Z.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(n){this._name$.next(n),this._snapshot.name=n}getUnitId(){return this._unitId}getRev(){var n;return(n=this._snapshot.rev)!=null?n:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(n){this._snapshot.rev=n}addWorksheet(n,r,s){const{sheets:i,sheetOrder:o}=this._snapshot;if(i[n])return!1;i[n]=s,o.splice(r,0,n);const a=new Gr(this._unitId,s,this._styles);return this._worksheets.set(n,a),this._sheetCreated$.next(a),!0}getSheetOrders(){return this._snapshot.sheetOrder}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}addStyles(n){Object.entries(n).forEach(([r,s])=>{this._styles.addCustomStyle(r,s)})}removeStyles(n){n.forEach(r=>{this._styles.remove(r)})}getConfig(){return this._snapshot}getIndexBySheetId(n){const{sheetOrder:r}=this._snapshot;return r.findIndex(s=>s===n)}getActiveSheet(n){if(!this._activeSheet&&typeof n>"u")throw new Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){const n=this._activeSheet;if(n)return n;const r=this._snapshot.sheetOrder;for(let i=0,o=r.length;i<o;i++){const a=this._worksheets.get(r[i]);if(a&&a.isSheetHidden()!==ae.TRUE)return this.setActiveSheet(a),a}const s=this._worksheets.get(r[0]);return this.setActiveSheet(s),s}setActiveSheet(n){this._activeSheet$.next(n)}removeSheet(n){const r=this._worksheets.get(n);return r?(this._worksheets.delete(n),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(n),1),delete this._snapshot.sheets[n],this._sheetDisposed$.next(r),!0):!1}getActiveSheetIndex(){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>this._worksheets.get(r)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){const{sheetOrder:n}=this._snapshot;return n.map(r=>this._worksheets.get(r))}getSheetsName(){const{sheetOrder:n}=this._snapshot,r=[];return n.forEach(s=>{const i=this._worksheets.get(s);i&&r.push(i.getName())}),r}getSheetIndex(n){const{sheetOrder:r}=this._snapshot;return r.findIndex(s=>n.getSheetId()===s)}getSheetBySheetName(n){const{sheetOrder:r}=this._snapshot,s=r.find(i=>this._worksheets.get(i).getName()===n);return this._worksheets.get(s)}getSheetBySheetId(n){return this._worksheets.get(n)}getSheetByIndex(n){const{sheetOrder:r}=this._snapshot;return this._worksheets.get(r[n])}getHiddenWorksheets(){return this.getSheets().filter(n=>n.getConfig().hidden===ae.TRUE).map(n=>n.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(n=>n.getConfig().hidden!==ae.TRUE).map(n=>n.getConfig().id)}load(n){this._snapshot=n}checkSheetName(n){return this.getSheetsName().includes(n)}uniqueSheetName(n="Sheet1"){let r=n;for(;this.checkSheetName(r);)r=n+this._count,this._count++;return r}generateNewSheetName(n){let r=n+this._count;for(;this.checkSheetName(r);)r=n+this._count,this._count++;return r}_parseWorksheetSnapshots(){const{_snapshot:n,_worksheets:r}=this,{sheets:s,sheetOrder:i}=n;if(Z.isEmptyObject(s)){const o=tt();s[o]={id:o}}for(const o in s){const a=s[o],{name:l}=a;a.name=this.uniqueSheetName(l),a.name!==l&&this._logService.debug("[Workbook]",`The worksheet name ${l} is duplicated, we changed it to ${a.name}. Please fix the problem in your snapshot.`);const u=new Gr(this._unitId,a,this._styles);r.set(o,u),i.includes(o)||i.push(o)}this.ensureActiveSheet()}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(n){this._snapshot.custom=n}},f.Workbook=jR([WR(1,Ct)],f.Workbook);class sa extends as{constructor(n){var r;super();E(this,"type",ve.UNIVER_SLIDE);E(this,"_activePage$",new oe.BehaviorSubject(null));E(this,"activePage$",this._activePage$.asObservable());E(this,"_name$");E(this,"name$");E(this,"_snapshot");E(this,"_unitId");this._snapshot={...Fc,...n},this._unitId=(r=this._snapshot.id)!=null?r:tt(6),this._name$=new oe.BehaviorSubject(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var r,s;const n=this._activePage$.getValue();if(!n){const i=(r=this.getPageOrder())==null?void 0:r[0];return i?(s=this.getPages())==null?void 0:s[i]:null}return n}setName(n){var r;this._snapshot.title=n,this._name$.next(n),this._unitId=(r=this._snapshot.id)!=null?r:tt(6)}getRev(){return 0}incrementRev(){}setRev(n){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var n;return(n=this._snapshot.body)==null?void 0:n.pages}getPageOrder(){var n;return(n=this._snapshot.body)==null?void 0:n.pageOrder}getPage(n){const r=this.getPages();return r==null?void 0:r[n]}getElementsByPage(n){var r;return(r=this.getPage(n))==null?void 0:r.pageElements}getElement(n,r){var s;return(s=this.getElementsByPage(n))==null?void 0:s[r]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){const n=tt(6);return{id:n,pageType:Ti.SLIDE,zIndex:10,title:n,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(n){this._activePage$.next(n)}getActivePage(){return this._activePage}updatePage(n,r){this._snapshot.body&&(this._snapshot.body.pages[n]=r)}appendPage(n){var i;if(!this._snapshot.body)return;this._snapshot.body.pages[n.id]=n;const r=this._activePage,s=this._snapshot.body.pageOrder.indexOf((i=r==null?void 0:r.id)!=null?i:"");this._snapshot.body.pageOrder.splice(s+1,0,n.id)}}var GR=Object.getOwnPropertyDescriptor,VR=(e,t,n,r)=>{for(var s=r>1?void 0:r?GR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},Zh=(e,t)=>(n,r)=>t(n,r,e);const qn=Re.createIdentifier("univer.current");f.UniverInstanceService=class extends ze{constructor(n,r){super();E(this,"_unitsByType",new Map);E(this,"_createHandler");E(this,"_ctorByType",new Map);E(this,"_currentUnits",new Map);E(this,"_currentUnits$",new oe.BehaviorSubject(this._currentUnits));E(this,"currentUnits$",this._currentUnits$.asObservable());E(this,"_unitAdded$",new oe.Subject);E(this,"unitAdded$",this._unitAdded$.asObservable());E(this,"_unitDisposed$",new oe.Subject);E(this,"unitDisposed$",this._unitDisposed$.asObservable());E(this,"_focused$",new oe.BehaviorSubject(null));E(this,"focused$",this._focused$.asObservable());this._injector=n,this._contextService=r}dispose(){super.dispose(),this._focused$.complete(),this._currentUnits$.complete(),this._unitAdded$.complete(),this._currentUnits.clear(),this._unitsByType.clear()}__setCreateHandler(n){this._createHandler=n}createUnit(n,r,s){return this._createHandler(n,r,this._ctorByType.get(n),s)}registerCtorForType(n,r){return this._ctorByType.set(n,r),{dispose:()=>{this._ctorByType.delete(n)}}}getCurrentTypeOfUnit$(n){return this.currentUnits$.pipe(oe.map(r=>{var s;return(s=r.get(n))!=null?s:null}),oe.distinctUntilChanged())}getCurrentUnitForType(n){return this._currentUnits.get(n)}getCurrentUnitOfType(n){return this.getCurrentUnitForType(n)}setCurrentUnitForType(n){const r=this._getUnitById(n);if(!r)throw new Error(`[UniverInstanceService]: no document with unitId ${n}!`);this._currentUnits.set(r[1],r[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(n){return this._unitAdded$.pipe(oe.filter(r=>r.type===n))}__addUnit(n,r){var a;const s=n.type;this._unitsByType.has(s)||this._unitsByType.set(s,[]);const i=this._unitsByType.get(s),o=n.getUnitId();if(i.findIndex(l=>l.getUnitId()===o)!==-1)throw new Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${o}.`);i.push(n),this._unitAdded$.next(n),((a=r==null?void 0:r.makeCurrent)==null||a)&&this.setCurrentUnitForType(n.getUnitId())}getTypeOfUnitDisposed$(n){return this.unitDisposed$.pipe(oe.filter(r=>r.type===n))}getUnit(n,r){var i;const s=(i=this._getUnitById(n))==null?void 0:i[0];return r&&(s==null?void 0:s.type)!==r?null:s}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(ve.UNIVER_DOC)}getUniverDocInstance(n){return this.getUnit(n,ve.UNIVER_DOC)}getUniverSheetInstance(n){return this.getUnit(n,ve.UNIVER_SHEET)}getAllUnitsForType(n){var r;return(r=this._unitsByType.get(n))!=null?r:[]}changeDoc(n,r){const s=this.getAllUnitsForType(ve.UNIVER_DOC),i=s.find(o=>o.getUnitId()===n);if(i!=null){const o=s.indexOf(i);s.splice(o,1)}this.__addUnit(r)}get focused(){var r;const n=this._focused$.getValue();return n?(r=this._getUnitById(n))==null?void 0:r[0]:null}focusUnit(n){this._focused$.next(n),this.focused instanceof f.Workbook?(this._contextService.setContextValue($r,!0),this._contextService.setContextValue(jr,!1),this._contextService.setContextValue(Xn,!0),this._contextService.setContextValue(Wr,!1),this.setCurrentUnitForType(n)):this.focused instanceof yt?(this._contextService.setContextValue($r,!0),this._contextService.setContextValue(jr,!0),this._contextService.setContextValue(Xn,!1),this._contextService.setContextValue(Wr,!1),this.setCurrentUnitForType(n)):this.focused instanceof sa?(this._contextService.setContextValue($r,!0),this._contextService.setContextValue(jr,!1),this._contextService.setContextValue(Xn,!1),this._contextService.setContextValue(Wr,!0),this.setCurrentUnitForType(n)):(this._contextService.setContextValue($r,!1),this._contextService.setContextValue(jr,!1),this._contextService.setContextValue(Xn,!1),this._contextService.setContextValue(Wr,!1))}getFocusedUnit(){return this.focused}getUnitType(n){const r=this._getUnitById(n);return r?r[1]:ve.UNRECOGNIZED}disposeUnit(n){const r=this._getUnitById(n);if(!r)return!1;const[s,i]=r,o=this._unitsByType.get(i),a=o.indexOf(s);return o.splice(a,1),this._tryResetCurrentOnRemoval(n,i),this._tryResetFocusOnRemoval(n),this._unitDisposed$.next(s),!0}_tryResetCurrentOnRemoval(n,r){const s=this.getCurrentUnitForType(r);(s==null?void 0:s.getUnitId())===n&&(this._currentUnits.set(r,null),this._currentUnits$.next(this._currentUnits))}_tryResetFocusOnRemoval(n){var r;((r=this.focused)==null?void 0:r.getUnitId())===n&&this._focused$.next(null)}_getUnitById(n){for(const[r,s]of this._unitsByType){const i=s.find(o=>o.getUnitId()===n);if(i)return[i,r]}}},f.UniverInstanceService=VR([Zh(0,Re.Inject(Re.Injector)),Zh(1,Dn)],f.UniverInstanceService);var ke=(e=>(e[e.Starting=0]="Starting",e[e.Ready=1]="Ready",e[e.Rendered=2]="Rendered",e[e.Steady=3]="Steady",e))(ke||{});const Qh={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"};var zR=Object.getOwnPropertyDescriptor,KR=(e,t,n,r)=>{for(var s=r>1?void 0:r?zR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},XR=(e,t)=>(n,r)=>t(n,r,e);class ed extends Error{constructor(t){super(`[LifecycleService]: lifecycle stage "${Qh[t]}" will never be reached!`),this.name="LifecycleUnreachableError"}}f.LifecycleService=class extends ze{constructor(n){super();E(this,"_lifecycle$",new oe.BehaviorSubject(ke.Starting));E(this,"lifecycle$",this._lifecycle$.asObservable());E(this,"_lock",!1);this._logService=n,this._reportProgress(ke.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(n){if(this._lock)throw new Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(n<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");n!==this.stage&&(this._lock=!0,this._reportProgress(n),this._lifecycle$.next(n),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}onStage(n){return oe.firstValueFrom(this.lifecycle$.pipe(oe.filter(r=>r>=n),ki(r=>r===n),oe.map(()=>{}))).catch(r=>r.name==="EmptyError"?Promise.reject(new ed(n)):Promise.reject(r))}subscribeWithPrevious(){return oe.merge(td(this.stage),this._lifecycle$.pipe(oe.skip(1))).pipe(ki(n=>n===ke.Steady))}_reportProgress(n){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${Qh[n]}".`)}},f.LifecycleService=KR([XR(0,Ct)],f.LifecycleService);function td(e){switch(e){case ke.Starting:return oe.of(ke.Starting);case ke.Ready:return oe.of(ke.Starting,ke.Ready);case ke.Rendered:return oe.of(ke.Starting,ke.Ready,ke.Rendered);default:return oe.of(ke.Starting,ke.Ready,ke.Rendered,ke.Steady)}}const qR=Re.createIdentifier("ILocalStorageService");class On extends ze{constructor(){super();E(this,"_currentLocale$",new oe.BehaviorSubject(ur.ZH_CN));E(this,"currentLocale$",this._currentLocale$.asObservable());E(this,"_locales",null);E(this,"localeChanged$",new oe.Subject);E(this,"t",(n,...r)=>{if(!this._locales)throw new Error("[LocaleService]: Locale not initialized");const s=n.split("."),i=this.resolveKeyPath(this._locales[this._currentLocale],s);if(typeof i=="string"){let o=i;return r.forEach((a,l)=>{o=o.replace(`{${l}}`,a)}),o}else return n});this.disposeWithMe(He(()=>{this._locales=null,this._currentLocale$.complete(),this.localeChanged$.complete()}))}get _currentLocale(){return this._currentLocale$.value}load(n){var r;this._locales=is((r=this._locales)!=null?r:{},n)}setLocale(n){this._currentLocale$.next(n),this.localeChanged$.next()}getLocales(){var n;return(n=this._locales)==null?void 0:n[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(n,r){const s=r.shift();if(s&&n&&s in n){const i=n[s];return r.length>0&&(typeof i=="object"||Array.isArray(i))?this.resolveKeyPath(i,r):i}return null}}var JR=Object.getOwnPropertyDescriptor,ZR=(e,t,n,r)=>{for(var s=r>1?void 0:r?JR(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},QR=(e,t)=>(n,r)=>t(n,r,e);f.MentionIOLocalService=class{constructor(t){this._userManagerService=t}async list(t){return{list:[{type:ls.PERSON,mentions:[{objectType:ls.PERSON,objectId:this._userManagerService.getCurrentUser().userID,label:this._userManagerService.getCurrentUser().name,metadata:{icon:this._userManagerService.getCurrentUser().avatar}}],metadata:{},title:"PEOPLE"}],page:t.page,size:t.size,total:1}}},f.MentionIOLocalService=ZR([QR(0,Re.Inject(Hr))],f.MentionIOLocalService);const nd=Re.createIdentifier("univer.service.mention-io");var ia=(e=>(e.INIT="init",e.FETCHING="fetching",e.DONE="done",e))(ia||{});const rd=Re.createIdentifier("univer.permission-service");class sd extends ze{constructor(){super(...arguments);E(this,"_permissionPointMap",new Map);E(this,"_permissionPointUpdate$",new oe.Subject);E(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable());E(this,"_showComponents",!0)}setShowComponents(n){this._showComponents=n}getShowComponents(){return this._showComponents}deletePermissionPoint(n){const r=this._permissionPointMap.get(n);r&&(r.complete(),this._permissionPointMap.delete(n))}addPermissionPoint(n){const r=n instanceof oe.BehaviorSubject,s=r?n.getValue():n;return s.id?this._permissionPointMap.get(s.id)?(console.warn(`${s.id} PermissionPoint already exists`),!1):(this._permissionPointMap.set(s.id,r?n:new oe.BehaviorSubject(s)),this._permissionPointUpdate$.next(s),!0):!1}updatePermissionPoint(n,r){const s=this._permissionPointMap.get(n);if(!s)return;const i=s.getValue();i.value=r,i.status=ia.DONE,s.next(i),this._permissionPointUpdate$.next(i)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(n){const r=this._permissionPointMap.get(n);if(r)return r.getValue()}getPermissionPoint$(n){const r=this._permissionPointMap.get(n);if(r)return r}composePermission$(n){const r=n.map(s=>{var o;const i=(o=this._permissionPointMap)==null?void 0:o.get(s);if(!i)throw new Error(`[PermissionService]: ${s} permissionPoint does not exist!`);return i.asObservable()});return oe.combineLatest(r).pipe(qr.map(s=>s))}composePermission(n){return n.map(s=>{var o;const i=(o=this._permissionPointMap)==null?void 0:o.get(s);if(!i)throw new Error(`[PermissionService]: ${s} permissionPoint does not exist!`);return i.getValue()})}getAllPermissionPoint(){const n=new Map;return this._permissionPointMap.forEach((r,s)=>{n.set(s,r)}),n}}function id(e,t){if(!t)return e;const n=[];for(const r of e){const s=t.find(([i])=>i===r[0]);if(s){if(s[1]===null)continue;n.push([r[0],s[1]])}else n.push(r)}return n}var eI=Object.getOwnPropertyDescriptor,tI=(e,t,n,r)=>{for(var s=r>1?void 0:r?eI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},oa=(e,t)=>(n,r)=>t(n,r,e);const nI=4,od=Symbol("DependentOn");class aa extends ze{onStarting(){}onReady(){}onRendered(){}onSteady(){}getUnitType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}}E(aa,"pluginName"),E(aa,"type",ve.UNIVER_UNKNOWN);class rI{constructor(){E(this,"_plugins",[])}addPlugin(t){this._plugins.push(t)}removePlugins(){const t=this._plugins.slice();return this._plugins.length=0,t}forEachPlugin(t){this._plugins.forEach(t)}}function sI(...e){return function(t){t[od]=e}}f.PluginService=class{constructor(t,n,r){E(this,"_pluginRegistry",new Map);E(this,"_pluginStore",new rI);E(this,"_seenPlugins",new Set);E(this,"_loadedPlugins",new Set);E(this,"_loadedPluginTypes",new Set([ve.UNIVER_UNKNOWN]));E(this,"_flushTimerByType",new Map);this._injector=t,this._lifecycleService=n,this._logService=r}dispose(){this._pluginStore.removePlugins().forEach(t=>t.dispose()),this._flushTimerByType.forEach(t=>clearTimeout(t))}registerPlugin(t,n){this._assertPluginValid(t);const r={plugin:t,options:n};this._pluginRegistry.set(t.pluginName,r),this._logService.debug("[PluginService]",`Plugin "${t.pluginName}" registered.`);const{type:s}=t;this._loadedPluginTypes.has(s)&&(s===ve.UNIVER_UNKNOWN?this._loadFromPlugins([r]):this._flushType(s))}startPluginsForType(t){this._loadedPluginTypes.has(t)||this._loadPluginsForType(t)}_loadPluginsForType(t){const n=Array.from(this._pluginRegistry.keys()),r=[];n.forEach(s=>{const i=this._pluginRegistry.get(s);i.plugin.type===t&&r.push(i)}),this._loadFromPlugins(r),this._loadedPluginTypes.add(t)}_assertPluginValid(t){const{type:n,pluginName:r}=t;if(n===ve.UNRECOGNIZED)throw new Error(`[PluginService]: invalid plugin type for ${t.name}. Please assign a "type" to your plugin.`);if(!r)throw new Error(`[PluginService]: no plugin name for ${t.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(r))throw new Error(`[PluginService]: duplicated plugin name for "${r}". Maybe a plugin that dependents on "${r} has already registered it. In that case please register "${r}" before the that plugin.`);this._seenPlugins.add(t.pluginName)}_flushType(t){this._flushTimerByType.get(t)===void 0&&this._flushTimerByType.set(t,setTimeout(()=>{this._loadPluginsForType(t),this._flushTimerByType.delete(t)},nI))}_loadFromPlugins(t){const n=[],r=new Set,s=o=>{const{plugin:a}=o,{pluginName:l}=a;if(this._loadedPlugins.has(l)||r.has(l))return;r.add(l),this._pluginRegistry.delete(l);const u=a[od];u&&u.forEach(c=>{const h=this._pluginRegistry.get(c.pluginName);if(h)s(h);else if(!this._seenPlugins.has(c.pluginName)&&!r.has(c.pluginName)){if(a.type===ve.UNIVER_UNKNOWN&&c.type!==ve.UNIVER_UNKNOWN)throw new Error(`[PluginService]: cannot register a plugin with Univer type that depends on a plugin with other type. The dependent is ${a.pluginName} and the dependency is ${c.pluginName}.`);a.type!==c.type&&c.type!==ve.UNIVER_UNKNOWN&&this._logService.debug("[PluginService]",`Plugin "${l}" depends on "${c.pluginName}" which has different type.`),this._logService.debug("[PluginService]",`Plugin "${l}" depends on "${c.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._assertPluginValid(c),s({plugin:c,options:void 0})}}),n.push(o)};t.forEach(o=>s(o));const i=n.map(o=>this._initPlugin(o.plugin,o.options));this._pluginsRunLifecycle(i)}_pluginsRunLifecycle(t){const n=this._lifecycleService.stage;if(td(n).subscribe(r=>this._runStage(t,r)),n!==ke.Steady){const r=this._lifecycleService.lifecycle$.pipe(oe.skip(1)).subscribe(s=>{this._runStage(t,s),s===ke.Steady&&r.unsubscribe()})}}_runStage(t,n){t.forEach(r=>{switch(n){case ke.Starting:r.onStarting();break;case ke.Ready:r.onReady();break;case ke.Rendered:r.onRendered();break;case ke.Steady:r.onSteady();break}})}_initPlugin(t,n){const r=this._injector.createInstance(t,n);return this._pluginStore.addPlugin(r),this._loadedPlugins.add(t.pluginName),this._logService.debug("[PluginService]",`Plugin "${r.getPluginName()}" loaded.`),r}},f.PluginService=tI([oa(0,Re.Inject(Re.Injector)),oa(1,Re.Inject(f.LifecycleService)),oa(2,Ct)],f.PluginService);const la=Re.createIdentifier("resource-loader-service");var iI=Object.getOwnPropertyDescriptor,oI=(e,t,n,r)=>{for(var s=r>1?void 0:r?iI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},aI=(e,t)=>(n,r)=>t(n,r,e);f.ResourceManagerService=class extends ze{constructor(n){super();E(this,"_resourceMap",new Map);E(this,"_register$",new oe.Subject);E(this,"register$",this._register$.asObservable());this._logService=n}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(n,r){return r?this.getResourcesByType(n,r):this.getAllResourceHooks().map(o=>{const a=o.toJson(n);return{name:o.pluginName,data:a}})}getResourcesByType(n,r){return this.getAllResourceHooks().filter(o=>o.businesses.includes(r)).map(o=>{const a=o.toJson(n);return{name:o.pluginName,data:a}})}registerPluginResource(n){const r=n.pluginName;if(this._resourceMap.has(r))throw new Error(`the pluginName is registered {${r}}`);return this._resourceMap.set(r,n),this._register$.next(n),He(()=>this._resourceMap.delete(r))}disposePluginResource(n){this._resourceMap.delete(n)}loadResources(n,r){this.getAllResourceHooks().forEach(s=>{var o;const i=(o=r==null?void 0:r.find(a=>a.name===s.pluginName))==null?void 0:o.data;if(i)try{const a=s.parseJson(i);s.onLoad(n,a)}catch(a){this._logService.error("[ResourceManagerService]","loadResources error",a)}})}unloadResources(n,r){this.getAllResourceHooks().filter(s=>s.businesses.includes(r)).forEach(s=>{s.onUnLoad(n)})}dispose(){this._register$.complete(),this._resourceMap.clear()}},f.ResourceManagerService=oI([aI(0,Ct)],f.ResourceManagerService);class ti extends ze{constructor(){super();E(this,"_darkMode$",new oe.BehaviorSubject(!1));E(this,"darkMode$",this._darkMode$.asObservable());E(this,"_validColorCache",new Map);E(this,"_currentTheme",Jr.defaultTheme);E(this,"_currentTheme$",new oe.BehaviorSubject(this._currentTheme));E(this,"currentTheme$",this._currentTheme$.asObservable());this.disposeWithMe(He(()=>{this._currentTheme=Jr.defaultTheme,this._currentTheme$.complete(),this._darkMode$.complete()}))}get darkMode(){return this._darkMode$.getValue()}isValidThemeColor(n){if(this._validColorCache.has(n))return this._validColorCache.get(n);let r=!1;const s=n.split(".");if(s.length===1)r=n in Jr.defaultTheme;else if(s.length===2){const[i,o]=s;r=i in Jr.defaultTheme&&o in this._currentTheme[i]}return this._validColorCache.set(n,r),r}getCurrentTheme(){return this._currentTheme}setTheme(n){this._currentTheme=n,this._currentTheme$.next(n)}setDarkMode(n){this._darkMode$.next(n)}getColorFromTheme(n){return ol(this._currentTheme,n)}}var lI=Object.getOwnPropertyDescriptor,uI=(e,t,n,r)=>{for(var s=r>1?void 0:r?lI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},ua=(e,t)=>(n,r)=>t(n,r,e);const ni=Re.createIdentifier("univer.undo-redo.service"),cI=20;class ad{dispose(){}async dispatchToHandlers(){return!1}}const ld="univer.command.redo",ud="univer.command.undo",cd=new class extends ad{constructor(){super(...arguments);E(this,"type",mr.COMMAND);E(this,"id",ud)}handler(t){const n=t.get(ni),r=n.pitchTopUndoElement();if(!r)return!1;const s=t.get(gr);return _s(r.undoMutations,s)?(n.popUndoToRedo(),!0):!1}},hd=new class extends ad{constructor(){super(...arguments);E(this,"type",mr.COMMAND);E(this,"id",ld)}handler(t){const n=t.get(ni),r=n.pitchTopRedoElement();if(!r)return!1;const s=t.get(gr);return _s(r.redoMutations,s)?(n.popRedoToUndo(),!0):!1}};f.LocalUndoRedoService=class extends ze{constructor(n,r,s){super();E(this,"undoRedoStatus$");E(this,"_undoRedoStatus$",new oe.BehaviorSubject({undos:0,redos:0}));E(this,"_undoStacks",new Map);E(this,"_redoStacks",new Map);E(this,"_batchingStatus",new Map);this._univerInstanceService=n,this._commandService=r,this._contextService=s,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(cd)),this.disposeWithMe(this._commandService.registerCommand(hd)),this.disposeWithMe(He(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(He(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(n){const{unitID:r}=n,s=this._getRedoStack(r,!0),i=this._getUndoStack(r,!0);if(s.length=0,this._batchingStatus.has(n.unitID)){const a=this._batchingStatus.get(n.unitID),l=this._pitchUndoElement(n.unitID);a===0||!l?(o(n),this._batchingStatus.set(n.unitID,1)):this._tryBatchingElements(l,n)}else o(n);function o(a){i.push(a),i.length>cI&&i.splice(0,1)}this._updateStatus()}clearUndoRedo(n){const r=this._getRedoStack(n);r&&(r.length=0);const s=this._getUndoStack(n);s&&(s.length=0),this._updateStatus()}pitchTopUndoElement(){const n=this._getFocusedUnitId();return this._pitchUndoElement(n)}pitchTopRedoElement(){const n=this._getFocusedUnitId();return this._pitchRedoElement(n)}_pitchUndoElement(n){const r=this._getUndoStack(n);return r!=null&&r.length?r[r.length-1]:null}_pitchRedoElement(n){const r=this._getRedoStack(n);return r!=null&&r.length?r[r.length-1]:null}popUndoToRedo(){const r=this._getUndoStackForFocused().pop();r&&(r.redoMutations.length>0&&this._getRedoStackForFocused().push(r),this._updateStatus())}popRedoToUndo(){const r=this._getRedoStackForFocused().pop();r&&(this._getUndoStackForFocused().push(r),this._updateStatus())}rollback(n,r){const s=r||this._getFocusedUnitId(),i=this._getUndoStack(s),o=i==null?void 0:i[(i==null?void 0:i.length)-1];o&&o.id===n&&(i.pop(),_s(o.undoMutations,this._commandService))}__tempBatchingUndoRedo(n){if(this._batchingStatus.has(n))throw new Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(n,0),He(()=>this._batchingStatus.delete(n))}_updateStatus(){var i,o;const n=this._getFocusedUnitId(),r=n&&((i=this._undoStacks.get(n))==null?void 0:i.length)||0,s=n&&((o=this._redoStacks.get(n))==null?void 0:o.length)||0;this._undoRedoStatus$.next({undos:r,redos:s})}_getUndoStack(n,r=!1){let s=this._undoStacks.get(n);return!s&&r&&(s=[],this._undoStacks.set(n,s)),s||null}_getRedoStack(n,r=!1){let s=this._redoStacks.get(n);return!s&&r&&(s=[],this._redoStacks.set(n,s)),s||null}_getUndoStackForFocused(){const n=this._getFocusedUnitId();if(!n)throw new Error("No focused univer instance!");return this._getUndoStack(n,!0)}_getRedoStackForFocused(){const n=this._getFocusedUnitId();if(!n)throw new Error("No focused univer instance!");return this._getRedoStack(n,!0)}_tryBatchingElements(n,r){n.redoMutations.push(...r.redoMutations),n.undoMutations.push(...r.undoMutations)}_getFocusedUnitId(){var o,a,l,u;let n="";const r=this._contextService.getContextValue(Xn),s=this._contextService.getContextValue(yh),i=this._contextService.getContextValue(Ah);return r?s?n=li:i?n=ai:n=(a=(o=this._univerInstanceService.getFocusedUnit())==null?void 0:o.getUnitId())!=null?a:"":n=(u=(l=this._univerInstanceService.getFocusedUnit())==null?void 0:l.getUnitId())!=null?u:"",n}},f.LocalUndoRedoService=uI([ua(0,qn),ua(1,gr),ua(2,Dn)],f.LocalUndoRedoService);class dd{constructor(t,n=100){E(this,"_imageCacheMap");this._injector=t,this._imageCacheMap=new Er(n)}_getImageCacheKey(t,n){return`${t}-${n}`}getImage(t,n,r,s){const i=this._getImageCacheKey(t,n),o=this._imageCacheMap.get(i);return o||((async()=>{const a=new Image,l=this._injector.has(na)?this._injector.get(na):null;if(t===ta.UUID)try{a.src=await(l==null?void 0:l.getImage(n))||""}catch(u){console.error(u)}else a.src=n;a.onload=()=>{a.removeAttribute("data-error"),r==null||r()},a.onerror=()=>{a.setAttribute("data-error","true"),s==null||s()},this._imageCacheMap.set(i,a)})(),null)}}function hI(e){return!(e.length===0||e.length>31||e.startsWith("'")||e.endsWith("'")||/[:\\\/\?\*\[\]]/.test(e))}function dI(e,t){return!(!e||e.length===0||e.length>255||t.has(e)||/[ :\\\/\?\*\[\]]/.test(e)||!/^[\p{L}_]/u.test(e)||/^\$?[A-Za-z]{1,3}\$?[0-9]+$/.test(e)||/^[rR]\d+[cC]\d+$/.test(e)||/^\d+$/.test(e))}const fd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ca=1,Vr=8;class ha{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=r>>4;if(s!==ca)throw new Error(`Got v${s} data when expected v${ca}.`);const i=fd[r&15];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new ha(a,o,i,t)}constructor(t,n=64,r=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const i=fd.indexOf(this.ArrayType),o=t*2*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,Vr,t),this.coords=new this.ArrayType(this.data,Vr+a+l,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Vr+o+a+l),this.ids=new this.IndexArrayType(this.data,Vr,t),this.coords=new this.ArrayType(this.data,Vr+a+l,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ca<<4)+i]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=n,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return da(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,l=[0,i.length-1,0],u=[];for(;l.length;){const c=l.pop()||0,h=l.pop()||0,d=l.pop()||0;if(h-d<=a){for(let I=d;I<=h;I++){const A=o[2*I],B=o[2*I+1];A>=t&&A<=r&&B>=n&&B<=s&&u.push(i[I])}continue}const m=d+h>>1,_=o[2*m],p=o[2*m+1];_>=t&&_<=r&&p>=n&&p<=s&&u.push(i[m]),(c===0?t<=_:n<=p)&&(l.push(d),l.push(m-1),l.push(1-c)),(c===0?r>=_:s>=p)&&(l.push(m+1),l.push(h),l.push(1-c))}return u}within(t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:i,nodeSize:o}=this,a=[0,s.length-1,0],l=[],u=r*r;for(;a.length;){const c=a.pop()||0,h=a.pop()||0,d=a.pop()||0;if(h-d<=o){for(let I=d;I<=h;I++)gd(i[2*I],i[2*I+1],t,n)<=u&&l.push(s[I]);continue}const m=d+h>>1,_=i[2*m],p=i[2*m+1];gd(_,p,t,n)<=u&&l.push(s[m]),(c===0?t-r<=_:n-r<=p)&&(a.push(d),a.push(m-1),a.push(1-c)),(c===0?t+r>=_:n+r>=p)&&(a.push(m+1),a.push(h),a.push(1-c))}return l}}function da(e,t,n,r,s,i){if(s-r<=n)return;const o=r+s>>1;md(e,t,o,r,s,i),da(e,t,n,r,o-1,1-i),da(e,t,n,o+1,s,1-i)}function md(e,t,n,r,s,i){for(;s>r;){if(s-r>600){const u=s-r+1,c=n-r+1,h=Math.log(u),d=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*d*(u-d)/u)*(c-u/2<0?-1:1),_=Math.max(r,Math.floor(n-c*d/u+m)),p=Math.min(s,Math.floor(n+(u-c)*d/u+m));md(e,t,n,_,p,i)}const o=t[2*n+i];let a=r,l=s;for(zr(e,t,r,n),t[2*s+i]>o&&zr(e,t,r,s);a<l;){for(zr(e,t,a,l),a++,l--;t[2*a+i]<o;)a++;for(;t[2*l+i]>o;)l--}t[2*r+i]===o?zr(e,t,r,l):(l++,zr(e,t,l,s)),l<=n&&(r=l+1),n<=l&&(s=l-1)}}function zr(e,t,n,r){fa(e,n,r),fa(t,2*n,2*r),fa(t,2*n+1,2*r+1)}function fa(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function gd(e,t,n,r){const s=e-n,i=t-r;return s*s+i*i}class fI{constructor(t=!1){E(this,"_tree",new Map);E(this,"_oneCellCache",new Map);E(this,"_kdTree",new Map);this._enableOneCellCache=t}dispose(){this.clear()}getTree(t,n){return this._tree.has(t)||this._tree.set(t,new Map),this._tree.get(t).has(n)||this._tree.get(t).set(n,new Gs),this._tree.get(t).get(n)}_getOneCellCache(t,n,r,s){return this._oneCellCache.has(t)||this._oneCellCache.set(t,new Map),this._oneCellCache.get(t).has(n)||this._oneCellCache.get(t).set(n,new Map),this._oneCellCache.get(t).get(n).has(r)||this._oneCellCache.get(t).get(n).set(r,new Map),this._oneCellCache.get(t).get(n).get(r).has(s)||this._oneCellCache.get(t).get(n).get(r).set(s,new Set),this._oneCellCache.get(t).get(n).get(r).get(s)}_removeOneCellCache(t,n,r,s,i){const o=this._oneCellCache.get(t);if(!o)return;const a=o.get(n);if(!a)return;const l=a.get(r);if(!l)return;const u=l.get(s);u&&u.delete(i)}_removeCellCacheByRange(t){const{unitId:n,sheetId:r,range:s,id:i}=t,o=this._oneCellCache.get(n);if(!o)return;const a=o.get(r);if(!a)return;const{startRow:l,startColumn:u,endRow:c,endColumn:h}=s;for(let d=l;d<=c;d++){const m=a.get(d);if(m)for(let _=u;_<=h;_++){const p=m.get(_);p&&p.delete(i)}}}_insertOneCellCache(t,n,r,s,i){this._getOneCellCache(t,n,r,s).add(i)}_getRdTreeItems(t){const n=[];for(const[r,s]of t)for(const[i,o]of s)n.push({x:i,y:r,ids:o});return n}_searchByOneCellCache(t){var _;const{unitId:n,sheetId:r,range:s}=t,{startRow:i,startColumn:o,endRow:a,endColumn:l}=s,u=(_=this._kdTree.get(n))==null?void 0:_.get(r);if(!u)return[];const{tree:c,items:h}=u,d=c.range(o,i,l,a),m=[];for(const p of d){const I=h[p];m.push(...Array.from(I.ids))}return m}openKdTree(){var t;for(const[n,r]of this._oneCellCache){this._kdTree.has(n)||this._kdTree.set(n,new Map);for(const[s,i]of r){const o=this._getRdTreeItems(i),a=new ha(o.length);(t=this._kdTree.get(n))==null||t.set(s,{tree:a,items:o});for(const l of o)a.add(l.x,l.y);a.finish()}}}closeKdTree(){var t;for(const[n,r]of this._oneCellCache)for(const[s,i]of r)(t=this._kdTree.get(n))==null||t.set(s,void 0)}insert(t){const{unitId:n,sheetId:r,range:s,id:i}=t;if(!n||n.length===0)return;let{startRow:o,endRow:a,startColumn:l,endColumn:u}=s;if(this._enableOneCellCache&&o===a&&l===u){this._insertOneCellCache(n,r,o,l,i);return}const c=this.getTree(n,r);Number.isNaN(o)&&(o=0),Number.isNaN(l)&&(l=0),Number.isNaN(a)&&(a=Number.POSITIVE_INFINITY),Number.isNaN(u)&&(u=Number.POSITIVE_INFINITY),c.insert({minX:l,minY:o,maxX:u,maxY:a,id:i})}bulkInsert(t){for(const n of t)this.insert(n)}*searchGenerator(t){var a;const{unitId:n,sheetId:r,range:s}=t;if(this._enableOneCellCache){const l=this._searchByOneCellCache(t);for(const u of l)yield u}const i=(a=this._tree.get(n))==null?void 0:a.get(r);if(!i)return;const o=i.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(const l of o)yield l.id}bulkSearch(t,n){const r=new Set;for(const s of t)for(const i of this.searchGenerator(s))(n==null?void 0:n.has(i))!==!0&&r.add(i);return r}removeById(t,n){var r,s;n?((r=this._tree.get(t))==null||r.delete(n),(s=this._oneCellCache.get(t))==null||s.delete(n)):(this._tree.delete(t),this._oneCellCache.delete(t))}_removeRTreeItem(t){const{unitId:n,sheetId:r,range:s,id:i}=t,o=this.getTree(n,r),a=o.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(let l=0;l<a.length;l++)a[l].id===i&&o.remove(a[l])}remove(t){const{unitId:n,sheetId:r,range:s,id:i}=t,{startRow:o,startColumn:a,endRow:l,endColumn:u}=s;this._enableOneCellCache?o===l&&a===u?this._removeOneCellCache(n,r,s.startRow,s.startColumn,i):(this._removeCellCacheByRange(t),this._removeRTreeItem(t)):this._removeRTreeItem(t)}bulkRemove(t){for(const n of t)this.remove(n)}clear(){this._tree.clear(),this._oneCellCache.clear()}toJSON(){const t={};return this._tree.forEach((n,r)=>{t[r]={},n.forEach((s,i)=>{t[r][i]=s.toJSON()})}),t}fromJSON(t){this._tree.clear();for(const n in t){this._tree.set(n,new Map);for(const r in t[n]){const s=new Gs;s.fromJSON(t[n][r]),this._tree.get(n).set(r,s)}}}}function mI(e){return new Promise(t=>setTimeout(t,e))}function gI(e=1){return new Promise(t=>{let n=0;const r=()=>{n++,n>=e?t():requestAnimationFrame(r)};requestAnimationFrame(r)})}var _I=Object.getOwnPropertyDescriptor,pI=(e,t,n,r)=>{for(var s=r>1?void 0:r?_I(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},EI=(e,t)=>(n,r)=>t(n,r,e);f.Skeleton=class extends ze{constructor(n){super();E(this,"_fontLocale");E(this,"_dirty",!0);this._localeService=n,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(n){this._dirty=n}dispose(){super.dispose(),this._fontLocale=null}_localeInitial(){}},f.Skeleton=pI([EI(0,Re.Inject(On))],f.Skeleton);var CI=Object.getOwnPropertyDescriptor,RI=(e,t,n,r)=>{for(var s=r>1?void 0:r?CI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},ri=(e,t)=>(n,r)=>t(n,r,e);f.SheetSkeleton=class extends f.Skeleton{constructor(n,r,s,i,o,a){super(s);E(this,"_worksheetData");E(this,"_renderRawFormula",!1);E(this,"_cellData");E(this,"_imageCacheMap");E(this,"_skipAutoHeightForMergedCells",!0);E(this,"_rowTotalHeight",0);E(this,"_columnTotalWidth",0);E(this,"_rowHeaderWidth",0);E(this,"_columnHeaderHeight",0);E(this,"_rowHeightAccumulation",[]);E(this,"_columnWidthAccumulation",[]);E(this,"_marginTop",0);E(this,"_marginLeft",0);E(this,"_scaleX");E(this,"_scaleY");E(this,"_scrollX");E(this,"_scrollY");this.worksheet=n,this._styles=r,this._contextService=i,this._configService=o,this._injector=a,this._worksheetData=this.worksheet.getConfig(),this._cellData=this.worksheet.getCellMatrix(),this._imageCacheMap=new dd(this._injector),this.initConfig()}initConfig(){var n,r;this._skipAutoHeightForMergedCells=!((n=this._configService.getConfig(Sa))!=null&&n),this.worksheet.setIsRowStylePrecedeColumnStyle((r=this._configService.getConfig(Ia))!=null?r:!1)}resetCache(){}getWorksheetConfig(){return this._worksheetData}getLocation(){return[this.worksheet.getUnitId(),this.worksheet.getSheetId()]}set columnHeaderHeight(n){this._columnHeaderHeight=n,this._worksheetData.columnHeader.height=n}set rowHeaderWidth(n){this._rowHeaderWidth=n,this._worksheetData.rowHeader.width=n}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}setMarginLeft(n){this._marginLeft=n}setMarginTop(n){this._marginTop=n}setScale(n,r){this._updateLayout(),this._scaleX=n,this._scaleY=r||n,this._updateLayout()}setScroll(n,r){Z.isDefine(n)&&(this._scrollX=n),Z.isDefine(r)&&(this._scrollY=r)}get scrollX(){return this._scrollX}get scrollY(){return this._scrollY}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}get imageCacheMap(){return this._imageCacheMap}_generateRowMatrixCache(n,r,s){let i=0;const o=[],a=r;for(let l=0;l<n;l++){let u=s;if(this.worksheet.getRowFiltered(l))u=0;else if(a[l]!=null){const c=a[l];if(!c)continue;const{h=s,ah:d,ia:m}=c;(m==null||m===ae.TRUE)&&typeof d=="number"?u=d:u=h,c.hd===ae.TRUE&&(u=0)}i+=u,o.push(i)}return{rowTotalHeight:i,rowHeightAccumulation:o}}_generateColumnMatrixCache(n,r,s){let i=0;const o=[],a=r;for(let l=0;l<n;l++){let u=s;if(a[l]!=null){const c=a[l];if(!c)continue;c.w!=null&&(u=c.w),c.hd===ae.TRUE&&(u=0)}i+=u,o.push(i)}return{columnTotalWidth:i,columnWidthAccumulation:o}}intersectMergeRange(n,r){return!!this.worksheet.getMergedCell(n,r)}_getOverflowBound(n,r,s,i,o=wt.LEFT){let a=0;if(r>s){const l=this._columnWidthAccumulation.length-1;for(let u=r;u>=s;u--){const c=u,h=this.worksheet.getCell(n,c);if(!Wi(h)&&c!==r||this.intersectMergeRange(n,c))return c===r?c:c+1>l?l:c+1;const{startX:d,endX:m}=Jn(n,c,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===wt.CENTER&&c===r?a+=(m-d)/2:a+=m-d,i<a)return c}return r}for(let l=r;l<=s;l++){const u=l,c=this.worksheet.getCell(n,u);if(!Wi(c)&&u!==r||this.intersectMergeRange(n,u))return u===r?u:u-1<0?0:u-1;const{startX:h,endX:d}=Jn(n,u,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===wt.CENTER&&u===r?a+=(d-h)/2:a+=d-h,i<a)return u}return s}_updateLayout(){if(!this.dirty)return;const{rowData:n,columnData:r,defaultRowHeight:s,defaultColumnWidth:i,rowCount:o,columnCount:a,rowHeader:l,columnHeader:u}=this._worksheetData,{rowTotalHeight:c,rowHeightAccumulation:h}=this._generateRowMatrixCache(o,n,s),{columnTotalWidth:d,columnWidthAccumulation:m}=this._generateColumnMatrixCache(a,r,i);this._rowHeaderWidth=l.hidden!==ae.TRUE?this._dynamicallyUpdateRowHeaderWidth(l):0,this._columnHeaderHeight=u.hidden!==ae.TRUE?u.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=h,this._columnTotalWidth=d,this._columnWidthAccumulation=m,this.makeDirty(!1)}calculate(){return this.resetCache(),this._updateLayout(),this}resetRangeCache(n){}_dynamicallyUpdateRowHeaderWidth(n){const s=`${this.worksheet.getRowCount()}`.length*8;return Math.max(n.width,s)}_hasUnMergedCellInRow(n,r,s){if(!this.worksheet.getMergeData())return!1;for(let o=r;o<=s;o++){const{isMerged:a,isMergedMainCell:l}=this.worksheet.getCellInfoInMergeData(n,o);if(!a&&!l)return!0}return!1}expandRangeByMerge(n){let{startRow:r,startColumn:s,endRow:i,endColumn:o}=n;const a=this._worksheetData.mergeData;if(!a)return{startRow:r,startColumn:s,endRow:i,endColumn:o};let l=!0;const u=new lt;for(;l;){l=!1;for(let c=0;c<a.length;c++){const{startRow:h,startColumn:d,endRow:m,endColumn:_}=a[c];if(u.getValue(h,d))continue;jc({startColumn:s,startRow:r,endColumn:o,endRow:i},{startColumn:d,startRow:h,endColumn:_,endRow:m})&&(r=Math.min(r,h),s=Math.min(s,d),i=Math.max(i,m),o=Math.max(o,_),u.setValue(h,d,!0),l=!0)}}return{startRow:r,startColumn:s,endRow:i,endColumn:o}}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}_getCellMergeInfo(n,r){return this.worksheet.getCellInfoInMergeData(n,r)}getNoMergeCellPositionByIndex(n,r,s=!0){return this.getNoMergeCellWithCoordByIndex(n,r,s)}getNoMergeCellWithCoordByIndex(n,r,s=!0){const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this;let{startY:u,endY:c,startX:h,endX:d}=Jn(n,r,i,o);return s&&(u+=l,c+=l,h+=a,d+=a),{startY:u,endY:c,startX:h,endX:d}}getNoMergeCellPositionByIndexWithNoHeader(n,r){const{rowHeightAccumulation:s,columnWidthAccumulation:i}=this,{startY:o,endY:a,startX:l,endX:u}=Jn(n,r,s,i);return{startY:o,endY:a,startX:l,endX:u}}getRowIndexByOffsetY(n,r,s,i){var l;const{rowHeightAccumulation:o}=this;n=pd(n,r,s,this.columnHeaderHeightAndMarginTop);let a=_r(o,n,i==null?void 0:i.firstMatch);return i!=null&&i.closeFirst&&Math.abs(o[a]-n)<Math.abs(n-((l=o[a-1])!=null?l:0))&&(a=a+1),a}getColumnIndexByOffsetX(n,r,s,i){var u;const o=_d(n,r,s,this.rowHeaderWidthAndMarginLeft),{columnWidthAccumulation:a}=this;let l=_r(a,o,i==null?void 0:i.firstMatch);return i!=null&&i.closeFirst&&Math.abs(a[l]-o)<Math.abs(o-((u=a[l-1])!=null?u:0))&&(l=l+1),l}getCellIndexByOffset(n,r,s,i,o,a){const l=this.getRowIndexByOffsetY(r,i,o,a),u=this.getColumnIndexByOffsetX(n,s,o,a);return{row:l,column:u}}getCellByOffset(n,r,s,i,o){const a=this==null?void 0:this.getCellIndexByOffset(n,r,s,i,o,{firstMatch:!0});return a?this.worksheet.getCellInfoInMergeData(a.row,a.column):null}getCellWithCoordByIndex(n,r,s=!0){const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:l}=this,u=Jn(n,r,i,o,this.worksheet.getCellInfoInMergeData(n,r)),{isMerged:c,isMergedMainCell:h}=u;let{startY:d,endY:m,startX:_,endX:p,mergeInfo:I}=u,A=a,B=l;return s===!1&&(A=0,B=0),d+=B,m+=B,_+=A,p+=A,I.startY+=B,I.endY+=B,I.startX+=A,I.endX+=A,{actualRow:n,actualColumn:r,startX:_,startY:d,endX:p,endY:m,isMerged:c,isMergedMainCell:h,mergeInfo:I}}getCellWithCoordByOffset(n,r,s,i,o,a){const{row:l,column:u}=this.getCellIndexByOffset(n,r,s,i,o,a);return this.getCellWithCoordByIndex(l,u)}getOffsetByColumn(n){const{columnWidthAccumulation:r,rowHeaderWidthAndMarginLeft:s}=this,i=r.length-1,o=r[n];return o!=null?o+s:n<0?s:r[i]+s}getOffsetByRow(n){const{rowHeightAccumulation:r,columnHeaderHeightAndMarginTop:s}=this,i=r.length-1,o=r[n];return o!=null?o+s:n<0?s:r[i]+s}getOffsetRelativeToRowCol(n,r){const s=_r(this.columnWidthAccumulation,n);let i=0;s===0?i=n:i=n-this._columnWidthAccumulation[s-1];const o=_r(this.rowHeightAccumulation,r);let a=0;return o===0?a=r:a=r-this._rowHeightAccumulation[o-1],{row:o,column:s,columnOffset:i,rowOffset:a}}_updateConfigAndGetDocumentModel(n,r,s,i){var a,l,u,c,h;if(!i||!((a=n.body)!=null&&a.dataStream))return;n.documentStyle||(n.documentStyle={}),n.documentStyle.marginTop=(l=s.t)!=null?l:0,n.documentStyle.marginBottom=(u=s.b)!=null?u:2,n.documentStyle.marginLeft=(c=s.l)!=null?c:2,n.documentStyle.marginRight=(h=s.r)!=null?h:2,n.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},n.documentStyle.renderConfig={...n.documentStyle.renderConfig,...i};const o=n.body.paragraphs||[];for(const d of o)d.paragraphStyle||(d.paragraphStyle={}),d.paragraphStyle.horizontalAlign=r;return new yt(n)}dispose(){super.dispose(),this._rowHeightAccumulation=[],this._columnWidthAccumulation=[],this._rowTotalHeight=0,this._columnTotalWidth=0,this._rowHeaderWidth=0,this._columnHeaderHeight=0,this._worksheetData=null,this._cellData=null,this._styles=null,this.worksheet=null}},f.SheetSkeleton=RI([ri(2,Re.Inject(On)),ri(3,Dn),ri(4,fr),ri(5,Re.Inject(Re.Injector))],f.SheetSkeleton);function ma(e,t,n,r){const s=e-1,i=t-1,o=n[s]||0;let a=n[e];a==null&&(a=n[n.length-1]);const l=r[i]||0;let u=r[t];return u==null&&(u=r[r.length-1]),{startY:o,endY:a,startX:l,endX:u}}function II(e,t,n,r){return ma(e,t,n,r)}function Jn(e,t,n,r,s){e=Z.clamp(e,0,n.length-1),t=Z.clamp(t,0,r.length-1);let{startY:i,endY:o,startX:a,endX:l}=ma(e,t,n,r);if(!s)return{startY:i,endY:o,startX:a,endX:l,isMerged:!1,isMergedMainCell:!1,actualRow:e,actualColumn:t,mergeInfo:{startY:i,endY:o,startX:a,endX:l,startRow:e,startColumn:t,endRow:e,endColumn:t}};const{isMerged:u,isMergedMainCell:c,startRow:h,startColumn:d,endRow:m,endColumn:_}=s;let p={startRow:h,startColumn:d,endRow:m,endColumn:_,startY:i,endY:o,startX:a,endX:l};const I=n.length-1,A=r.length-1;if(u&&h!==-1&&d!==-1){const B=n[h-1]||0,x=n[m]||n[I],Y=r[d-1]||0,O=r[_]||r[A];p={...p,startY:B,endY:x,startX:Y,endX:O}}else if(!u&&m!==-1&&_!==-1){const B=n[m]||n[I],x=r[_]||r[A];p={...p,startY:i,endY:B,startX:a,endX:x}}return{isMerged:u,isMergedMainCell:c,actualRow:e,actualColumn:t,startY:i,endY:o,startX:a,endX:l,mergeInfo:p}}function _d(e,t,n,r){const{x:s}=n;return e/t+s-r}function pd(e,t,n,r){const{y:s}=n;return e=e/t+s-r,e}const SI=["script","style","meta","comment","link"];var Ed=(e=>(e[e.INFO=0]="INFO",e[e.STOP=1]="STOP",e[e.WARNING=2]="WARNING",e))(Ed||{}),Cd=(e=>(e[e.DISABLED=0]="DISABLED",e[e.FULL_ALPHA=1]="FULL_ALPHA",e[e.FULL_HANGUL=2]="FULL_HANGUL",e[e.FULL_KATAKANA=3]="FULL_KATAKANA",e[e.HALF_ALPHA=4]="HALF_ALPHA",e[e.HALF_HANGUL=5]="HALF_HANGUL",e[e.HALF_KATAKANA=6]="HALF_KATAKANA",e[e.HIRAGANA=7]="HIRAGANA",e[e.NO_CONTROL=8]="NO_CONTROL",e[e.OFF=9]="OFF",e[e.ON=10]="ON",e))(Cd||{}),Rd=(e=>(e.BETWEEN="between",e.EQUAL="equal",e.GREATER_THAN="greaterThan",e.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e.LESS_THAN="lessThan",e.LESS_THAN_OR_EQUAL="lessThanOrEqual",e.NOT_BETWEEN="notBetween",e.NOT_EQUAL="notEqual",e))(Rd||{}),Id=(e=>(e[e.TEXT=0]="TEXT",e[e.ARROW=1]="ARROW",e[e.CUSTOM=2]="CUSTOM",e))(Id||{}),Sd=(e=>(e.VALID="valid",e.INVALID="invalid",e.VALIDATING="validating",e))(Sd||{}),Od=(e=>(e.CUSTOM="custom",e.LIST="list",e.LIST_MULTIPLE="listMultiple",e.NONE="none",e.TEXT_LENGTH="textLength",e.DATE="date",e.TIME="time",e.WHOLE="whole",e.DECIMAL="decimal",e.CHECKBOX="checkbox",e.ANY="any",e))(Od||{}),OI=Object.getOwnPropertyDescriptor,vI=(e,t,n,r)=>{for(var s=r>1?void 0:r?OI(t,n):t,i=e.length-1,o;i>=0;i--)(o=e[i])&&(s=o(s)||s);return s},vd=(e,t)=>(n,r)=>t(n,r,e);let ga=class extends ze{constructor(e,t){super(),this._resourceManagerService=e,this._univerInstanceService=t,this._init()}_init(){const e=n=>{n.businesses.forEach(r=>{switch(r){case ve.UNRECOGNIZED:case ve.UNIVER_UNKNOWN:case ve.UNIVER_SLIDE:case ve.UNIVER_DOC:{this._univerInstanceService.getAllUnitsForType(ve.UNIVER_DOC).forEach(s=>{const o=(s.getSnapshot().resources||[]).find(a=>a.name===n.pluginName);if(o)try{const a=n.parseJson(o.data);n.onLoad(s.getUnitId(),a)}catch{console.error(`Load Document{${s.getUnitId()}} Resources{${n.pluginName}} Data Error.`)}});break}case ve.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(ve.UNIVER_SHEET).forEach(s=>{const o=(s.getSnapshot().resources||[]).find(a=>a.name===n.pluginName);if(o)try{const a=n.parseJson(o.data);n.onLoad(s.getUnitId(),a)}catch{console.error(`Load Workbook{${s.getUnitId()}} Resources{${n.pluginName}} Data Error.`)}})}})};this._resourceManagerService.getAllResourceHooks().forEach(n=>e(n)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(n=>e(n))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(ve.UNIVER_SHEET).subscribe(n=>{this._resourceManagerService.loadResources(n.getUnitId(),n.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(ve.UNIVER_DOC).subscribe(n=>{const r=n.getUnitId();Oa(r)||this._resourceManagerService.loadResources(n.getUnitId(),n.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(ve.UNIVER_SHEET).subscribe(n=>{this._resourceManagerService.unloadResources(n.getUnitId(),ve.UNIVER_SHEET)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(ve.UNIVER_DOC).subscribe(n=>{this._resourceManagerService.unloadResources(n.getUnitId(),ve.UNIVER_DOC)}))}saveUnit(e){const t=this._univerInstanceService.getUnit(e);if(!t)return null;const n=this._resourceManagerService.getResources(e,t.type),r=Z.deepClone(t.getSnapshot());return r.resources=n,r}};ga=vI([vd(0,Re.Inject(Qs)),vd(1,Re.Inject(qn))],ga);class wI{constructor(t={},n){E(this,"_startedTypes",new Set);E(this,"_injector");E(this,"_disposingCallbacks",new os);const r=this._injector=bI(n,t==null?void 0:t.override),{theme:s,darkMode:i,locale:o,locales:a,logLevel:l,logCommandExecution:u}=t;s&&this._injector.get(ti).setTheme(s),i&&this._injector.get(ti).setDarkMode(i),a&&this._injector.get(On).load(a),o&&this._injector.get(On).setLocale(o),l&&this._injector.get(Ct).setLogLevel(l),u!==void 0&&this._injector.get(fr).setConfig(gs,u),this._init(r)}get _univerInstanceService(){return this._injector.get(qn)}get _pluginService(){return this._injector.get(f.PluginService)}__getInjector(){return this._injector}onDispose(t){const n=this._disposingCallbacks.add(He(t));return He(()=>n.dispose(!0))}dispose(){this._disposingCallbacks.dispose(),this._injector.dispose()}setLocale(t){this._injector.get(On).setLocale(t)}createUnit(t,n){return this._univerInstanceService.createUnit(t,n)}createUniverSheet(t){return this._injector.get(Ct).warn("[Univer]","Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(ve.UNIVER_SHEET,t)}createUniverDoc(t){return this._injector.get(Ct).warn("[Univer]","Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(ve.UNIVER_DOC,t)}createUniverSlide(t){return this._injector.get(Ct).warn("[Univer]","Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(ve.UNIVER_SLIDE,t)}_init(t){this._univerInstanceService.registerCtorForType(ve.UNIVER_SHEET,f.Workbook),this._univerInstanceService.registerCtorForType(ve.UNIVER_DOC,yt),this._univerInstanceService.registerCtorForType(ve.UNIVER_SLIDE,sa);const n=t.get(qn);n.__setCreateHandler((r,s,i,o)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginsForType(r),this._startedTypes.add(r);const l=t.createInstance(i,s);return n.__addUnit(l,o),this._tryProgressToReady(),l}const a=t.createInstance(i,s);return n.__addUnit(a,o),a})}_tryProgressToReady(){this._injector.get(f.LifecycleService).stage<ke.Ready&&(this._injector.get(f.LifecycleService).stage=ke.Ready)}registerPlugin(t,n){this._pluginService.registerPlugin(t,n)}registerPlugins(t){t.forEach(n=>{const[r,s]=n;this._pluginService.registerPlugin(r,s)})}}function bI(e,t){const n=id([[Th],[On],[ti],[f.LifecycleService],[f.PluginService],[Hr],[qn,{useClass:f.UniverInstanceService}],[rd,{useClass:sd}],[Ct,{useClass:Au,lazy:!0}],[gr,{useClass:f.CommandService}],[ni,{useClass:f.LocalUndoRedoService,lazy:!0}],[fr,{useClass:vu}],[Dn,{useClass:wu}],[Qs,{useClass:f.ResourceManagerService,lazy:!0}],[la,{useClass:ga,lazy:!0}],[bh,{useClass:f.AuthzIoLocalService}],[nd,{useClass:f.MentionIOLocalService,lazy:!0}]],t),r=e?e.createChild(n):new Re.Injector(n);return va(r,[[Hr],[la]]),r}Ld(),f.ABCToNumber=V0,f.AUTO_HEIGHT_FOR_MERGED_CELLS=Sa,f.AbsoluteRefType=Ne,f.ActionIterator=Kn,f.AlignTypeH=su,f.AlignTypeV=iu,f.ArrangeTypeEnum=lu,f.ArrowsAndMarkersShapes=Nl,f.AsyncInterceptorManager=Qd,f.AsyncLock=jd,f.AutoFillSeries=Cl,f.BaselineOffset=jt,f.BasicShapes=Tl,f.BlockType=xl,f.BooleanNumber=ae,f.BorderStyleTypes=Ue,f.BorderType=Rl,f.BuildTextUtils=Ze,f.BulletAlignment=hr,f.COLORS=xi,f.COMMAND_LOG_EXECUTION_CONFIG_KEY=gs,f.CanceledError=zd,f.CellModeEnum=Un,f.CellValueType=Zt,f.Color=Cn,f.ColorBuilder=Es,f.ColorKit=Rt,f.ColorType=Et,f.ColumnSeparatorType=$l,f.CommandType=mr,f.CommonHideTypes=Il,f.ConfigService=vu,f.ContextService=wu,f.CopyPasteType=Sl,f.CustomCommandExecutionError=Zr,f.CustomDecorationType=_n,f.CustomRangeType=Qt,f.DEFAULT_CELL=S0,f.DEFAULT_DOC=Ko,f.DEFAULT_DOCUMENT_SUB_COMPONENT_ID=oR,f.DEFAULT_EMPTY_DOCUMENT_VALUE=Ra,f.DEFAULT_NUMBER_FORMAT=kc,f.DEFAULT_RANGE=R0,f.DEFAULT_RANGE_ARRAY=C0,f.DEFAULT_SELECTION=I0,f.DEFAULT_SLIDE=Fc,f.DEFAULT_STYLES=st,f.DEFAULT_TEXT_FORMAT=Uc,f.DEFAULT_TEXT_FORMAT_EXCEL=Pc,f.DEFAULT_WORKSHEET_COLUMN_COUNT=Bh,f.DEFAULT_WORKSHEET_COLUMN_COUNT_KEY=LR,f.DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT=Wh,f.DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT_KEY=kR,f.DEFAULT_WORKSHEET_COLUMN_WIDTH=$h,f.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY=UR,f.DEFAULT_WORKSHEET_ROW_COUNT=xh,f.DEFAULT_WORKSHEET_ROW_COUNT_KEY=MR,f.DEFAULT_WORKSHEET_ROW_HEIGHT=Hh,f.DEFAULT_WORKSHEET_ROW_HEIGHT_KEY=DR,f.DEFAULT_WORKSHEET_ROW_TITLE_WIDTH=jh,f.DEFAULT_WORKSHEET_ROW_TITLE_WIDTH_KEY=PR,f.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY=li,f.DOCS_NORMAL_EDITOR_UNIT_ID_KEY=ai,f.DOCS_ZEN_EDITOR_UNIT_ID_KEY=Ca,f.DOC_DRAWING_PRINTING_COMPONENT_KEY=A0,f.DOC_RANGE_TYPE=Bu,f.DashStyleType=zl,f.DataStreamTreeNodeType=Eh,f.DataStreamTreeTokenType=ut,f.DataValidationErrorStyle=Ed,f.DataValidationImeMode=Cd,f.DataValidationOperator=Rd,f.DataValidationRenderMode=Id,f.DataValidationStatus=Sd,f.DataValidationType=Od,f.DeleteDirection=Ol,f.DependentOn=sI,f.DesktopLogService=Au,f.DeveloperMetadataVisibility=vl,f.Dimension=wl,f.Direction=bl,f.Disposable=ze,f.DisposableCollection=os,f.DocStyleType=kl,f.DocumentDataModel=yt,f.DocumentFlavor=yi,f.DrawingTypeEnum=uu,f.EDITOR_ACTIVATED=Ah,f.EXTENSION_NAMES=xc,f.ErrorService=Th,f.EventState=vh,f.EventSubject=aR,f.FOCUSING_COMMON_DRAWINGS=ER,f.FOCUSING_DOC=jr,f.FOCUSING_EDITOR_BUT_HIDDEN=dR,f.FOCUSING_EDITOR_INPUT_FORMULA=fR,f.FOCUSING_EDITOR_STANDALONE=gR,f.FOCUSING_FX_BAR_EDITOR=yh,f.FOCUSING_PANEL_EDITOR=_R,f.FOCUSING_SHEET=Xn,f.FOCUSING_SLIDE=Wr,f.FOCUSING_UNIT=$r,f.FOCUSING_UNIVER_EDITOR=mR,f.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE=pR,f.FORMULA_EDITOR_ACTIVATED=CR,f.FollowNumberWithType=Fl,f.FontItalic=us,f.FontStyleType=Ln,f.FontWeight=cs,f.GridType=Bl,f.HLSColor=Uu,f.HorizontalAlign=wt,f.IAuthzIoService=bh,f.ICommandService=gr,f.IConfigService=fr,f.IContextService=Dn,f.IImageIoService=na,f.ILocalStorageService=qR,f.ILogService=Ct,f.IMentionIOService=nd,f.IPermissionService=rd,f.IResourceLoaderService=la,f.IResourceManagerService=Qs,f.IS_ROW_STYLE_PRECEDE_COLUMN_STYLE=Ia,f.IUndoRedoService=ni,f.IUniverInstanceService=qn,f.ImageCacheMap=dd,f.ImageSourceType=ta,f.ImageUploadStatusType=Nh,f.InterceptorEffectEnum=An,f.InterceptorManager=qd,f.InterpolationPointType=Al,f.JSON1=F_,f.JSONX=Yt,f.LRUHelper=Cr,f.LRUMap=Er,f.LifecycleStages=ke,f.LifecycleUnreachableError=ed,f.ListGlyphType=fe,f.LocaleService=On,f.LocaleType=ur,f.LogLevel=bu,f.MOVE_BUFFER_VALUE=pr,f.MemoryCursor=fn,f.MentionType=ls,f.NAMED_STYLE_MAP=v0,f.NAMED_STYLE_SPACE_MAP=w0,f.NamedStyleType=qe,f.NilCommand=yu,f.NumberUnitType=ru,f.ObjectMatrix=lt,f.ObjectRelativeFromH=tu,f.ObjectRelativeFromV=nu,f.OtherShapes=Ml,f.PAGE_SIZE=y0,f.PAPER_TYPES=T_,f.PRESET_LIST_TYPE=kr,f.PRINT_CHART_COMPONENT_KEY=b0,f.PageElementType=cu,f.PageOrientType=au,f.PageType=Ti,f.PaperType=ct,f.ParagraphElementType=Wl,f.ParagraphStyleBuilder=Br,f.ParagraphStyleValue=xr,f.PermissionService=sd,f.PermissionStatus=ia,f.Plugin=aa,f.PositionedObjectLayoutType=Gl,f.PresetListType=xt,f.ProtectionType=yl,f.QuickListType=oh,f.QuickListTypeMap=rC,f.RANGE_DIRECTION=xu,f.RANGE_TYPE=pe,f.RBush=Gs,f.RCDisposable=g_,f.RGBA_PAREN=Q_,f.RGB_PAREN=Z_,f.ROTATE_BUFFER_VALUE=Lu,f.RTree=fI,f.Range=Wn,f.Rectangle=rn,f.RedoCommand=hd,f.RedoCommandId=ld,f.RefAlias=G0,f.Registry=vi,f.RegistryAsMap=wi,f.RelativeDate=Dl,f.RelativeSlideLink=hu,f.RgbColor=Cs,f.RichTextBuilder=Sn,f.RichTextValue=an,f.RxDisposable=m_,f.SHEET_EDITOR_UNITS=O0,f.SectionType=Hl,f.SheetTypes=Ul,f.SheetViewModel=Gh,f.SliceBodyType=Vo,f.SlideDataModel=sa,f.SpacingRule=Vl,f.SpecialShapes=Ll,f.Styles=Mh,f.THEME_COLORS=Du,f.TabStopAlignment=Kl,f.TableAlignmentType=ql,f.TableLayoutType=Jl,f.TableRowHeightRule=Ql,f.TableSizeType=Xl,f.TableTextWrapType=Zl,f.TextDecoration=Pl,f.TextDecorationBuilder=on,f.TextDirection=cr,f.TextDirectionType=jl,f.TextStyleBuilder=sn,f.TextStyleValue=Fr,f.TextX=Me,f.TextXActionType=J,f.ThemeColor=Rs,f.ThemeColorType=ot,f.ThemeColors=hs,f.ThemeService=ti,f.Tools=Z,f.UndoCommand=cd,f.UndoCommandId=ud,f.UnitModel=as,f.Univer=wI,f.UniverInstanceType=ve,f.UpdateDocsAttributeType=Ce,f.UserManagerService=Hr,f.VerticalAlign=mn,f.VerticalAlignmentType=eu,f.Worksheet=Gr,f.WrapStrategy=gn,f.WrapTextType=Yl,f.addLinkToDocumentModel=Uh,f.afterInitApply=z_,f.afterTime=G_,f.awaitTime=mI,f.binSearchFirstGreaterThanTarget=Mu,f.binarySearchArray=K_,f.bufferDebounceTime=Y_,f.cellToRange=Np,f.characterSpacingControlType=ou,f.checkForSubstrings=Lp,f.checkIfMove=q_,f.checkParagraphHasBullet=mE,f.checkParagraphHasIndent=gE,f.checkParagraphHasIndentByStyle=Qu,f.cloneCellData=Vh,f.cloneCellDataMatrix=zh,f.cloneCellDataWithSpanAndDisplay=xR,f.cloneValue=ft,f.cloneWorksheetData=Xh,f.codeToBlob=X_,f.composeBody=zo,f.composeInterceptors=ba,f.composeStyles=lr,f.concatMatrixArray=Cp,f.convertBodyToHtml=J_,f.convertCellToRange=Hu,f.convertObservableToBehaviorSubject=V_,f.covertCellValue=Yi,f.covertCellValues=Mp,f.covertTextRunToHtml=Fi,f.createAsyncInterceptorKey=Jd,f.createDefaultUser=ei,f.createDocumentModelWithStyle=Yr,f.createInterceptorKey=Xd,f.createInternalEditorID=Gd,f.createREGEXFromWildChar=A_,f.createRowColIter=jo,f.customNameCharacterCheck=dI,f.dayjs=Wt,f.debounce=e_,f.dedupe=Dd,f.dedupeBy=Ud,f.deepCompare=Gi,f.delayAnimationFrame=gI,f.deleteContent=tc,f.extractPureTextFromCell=Jh,f.fromCallback=Tu,f.fromEventSubject=lR,f.fromObservable=f_,f.generateRandomId=tt,f.get=ol,f.getArrayLength=en,f.getBodySlice=At,f.getBodySliceHtml=ps,f.getBorderStyleType=Ap,f.getCellCoordByIndexSimple=ma,f.getCellInfoInMergeData=_p,f.getCellPositionByIndexSimple=II,f.getCellValueType=fp,f.getCellWithCoordByIndexCore=Jn,f.getColorStyle=Pt,f.getCustomBlockSlice=hh,f.getCustomDecorationSlice=fh,f.getCustomRangeSlice=dh,f.getDocsUpdateBody=yp,f.getIntersectRange=jc,f.getNumfmtParseValueFilter=E0,f.getOriginCellValue=HR,f.getParagraphsSlice=ch,f.getPlainText=Zs,f.getReverseDirection=y_,f.getSectionBreakSlice=dC,f.getTableSlice=uh,f.getTextRunSlice=Js,f.getTransformOffsetX=_d,f.getTransformOffsetY=pd,f.getWorksheetUID=YR,f.groupBy=Fd,f.handleStyleToString=bp,f.hashAlgorithm=pE,f.horizontalLineSegmentsSubtraction=Ls,f.insertMatrixArray=Ep,f.insertTextToContent=ec,f.invertColorByHSL=of,f.invertColorByMatrix=lf,f.isBlackColor=hp,f.isBooleanString=Yd,f.isCellCoverable=Wi,f.isCellV=Fu,f.isDefaultFormat=m0,f.isEmptyCell=$u,f.isFormulaId=wp,f.isFormulaString=ju,f.isICellData=ku,f.isInternalEditorID=Oa,f.isNodeEnv=b_,f.isNotNullOrUndefined=Ph,f.isNullCell=mp,f.isNumeric=fl,f.isPatternEqualWithoutDecimal=g0,f.isRangesEqual=SR,f.isRealNum=_E,f.isSafeNumeric=l_,f.isSameStyleTextRun=Wu,f.isTextFormat=f0,f.isUnitRangesEqual=OR,f.isValidRange=Tp,f.isWhiteColor=dp,f.makeArray=xd,f.makeCellRangeToRangeData=vp,f.makeCellToSelection=Op,f.makeCustomRangeStream=bC,f.mapObjectMatrix=pp,f.merge=is,f.mergeLocales=EE,f.mergeOverrideWithDependencies=id,f.mergeSets=h_,f.mergeWith=s_,f.mergeWorksheetSnapshotWithDefault=Yh,f.mixinClass=a_,f.moveMatrixArray=ji,f.moveRangeByOffset=P0,f.nameCharacterCheck=hI,f.normalizeBody=fC,f.normalizeTextRuns=Pr,f.numberToABC=K0,f.numberToListABC=X0,f.numfmt=d0,f.queryObjectMatrix=Y0,f.registerDependencies=Vd,f.remove=nr,f.repeatStringNumTimes=Vc,f.replaceInDocumentBody=sR,f.requestImmediateMacroTask=c_,f.rotate=kd,f.searchArray=_r,f.searchInOrderedArray=Nu,f.selectionToArray=gp,f.sequence=gl,f.sequenceAsync=ml,f.sequenceExecute=_s,f.sequenceExecuteAsync=W_,f.set=o_,f.shallowEqual=wa,f.skipParseTagNames=SI,f.sliceMatrixArray=Rp,f.sortRules=q0,f.sortRulesByDesc=J0,f.sortRulesFactory=Ur,f.spliceArray=$i,f.splitIntoGrid=$o,f.takeAfter=ki,f.textDiff=qo,f.throttle=Kd,f.toDisposable=He,f.touchDependencies=va,f.updateAttributeByDelete=mh,f.updateAttributeByInsert=gh,f.willLoseNumericPrecision=u_,Object.keys(Re).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(f,e)&&Object.defineProperty(f,e,{enumerable:!0,get:()=>Re[e]})}),Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})}));
