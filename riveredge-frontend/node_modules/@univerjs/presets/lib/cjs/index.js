"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("@univerjs/core"),y=require("@univerjs/core/lib/facade"),f=require("@univerjs/design"),g=require("@univerjs/themes");function P(e){const{presets:l,plugins:s,collaboration:h,override:a=[],...b}=e;h&&(a.push([o.IUndoRedoService,null]),a.push([o.IAuthzIoService,null]),a.push([o.IMentionIOService,null]));const u=new o.Univer({logLevel:o.LogLevel.WARN,...b,override:a}),n=new Map;l==null||l.forEach(r=>{const t=Array.isArray(r)?r[0]:r,{plugins:p}=t;p.forEach(i=>{const[c,O]=Array.isArray(i)?[i[0],i[1]]:[i];n.has(c.pluginName)&&n.delete(c.pluginName),n.set(c.pluginName,{plugin:c,options:O})})}),s==null||s.forEach(r=>{const[t,p]=Array.isArray(r)?[r[0],r[1]]:[r];if(n.has(t.pluginName))throw new Error(`Plugin ${t.pluginName} already registered by presets or other ways! Repeated registration may cause potential problems, please check your code.`);n.set(t.pluginName,{plugin:t,options:p})}),n.forEach(({plugin:r,options:t})=>{u.registerPlugin(r,t)});const d=y.FUniver.newAPI(u);return{univer:u,univerAPI:d}}exports.createUniver=P;Object.keys(o).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(exports,e)&&Object.defineProperty(exports,e,{enumerable:!0,get:()=>o[e]})});Object.keys(y).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(exports,e)&&Object.defineProperty(exports,e,{enumerable:!0,get:()=>y[e]})});Object.keys(f).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(exports,e)&&Object.defineProperty(exports,e,{enumerable:!0,get:()=>f[e]})});Object.keys(g).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(exports,e)&&Object.defineProperty(exports,e,{enumerable:!0,get:()=>g[e]})});
