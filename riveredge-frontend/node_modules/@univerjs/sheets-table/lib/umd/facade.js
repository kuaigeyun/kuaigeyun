(function(r,i){typeof exports=="object"&&typeof module<"u"?i(require("@univerjs/core"),require("@univerjs/sheets-table"),require("@univerjs/sheets/facade"),require("@univerjs/sheets"),require("@univerjs/core/facade")):typeof define=="function"&&define.amd?define(["@univerjs/core","@univerjs/sheets-table","@univerjs/sheets/facade","@univerjs/sheets","@univerjs/core/facade"],i):(r=typeof globalThis<"u"?globalThis:r||self,i(r.UniverCore,r.UniverSheetsTable,r.UniverSheetsFacade,r.UniverSheets,r.UniverCoreFacade))})(this,(function(r,i,l,I,b){"use strict";class f extends l.FWorkbook{getTableInfo(e){const t=this.getId();return this._injector.get(i.SheetTableService).getTableInfo(t,e)}getTableList(){const e=this.getId();return this._injector.get(i.SheetTableService).getTableList(e)}async addTable(e,t,n,a,s){var T;const c=this._injector.get(i.SheetTableService),o=this._injector.get(r.LocaleService),m=this._injector.get(r.IUniverInstanceService).getCurrentUnitOfType(r.UniverInstanceType.UNIVER_SHEET),S=new Set;if(m&&m.getSheets().forEach(h=>{S.add(h.getName())}),!r.customNameCharacterCheck(t,S)){this._injector.get(r.ILogService).warn(o.t("sheets-table.tableNameError"));return}const u={unitId:this.getId(),name:t,subUnitId:e,range:n,options:s,id:a};if(await this._commandService.executeCommand(i.AddSheetTableCommand.id,u))return(T=c.getTableList(this.getId()).find(h=>h.name===t))==null?void 0:T.id}async removeTable(e){var a;const t=(a=this.getTableInfo(e))==null?void 0:a.subUnitId;if(!t)return!1;const n={unitId:this.getId(),subUnitId:t,tableId:e};return this._commandService.executeCommand(i.DeleteSheetTableCommand.id,n)}getTableInfoByName(e){return this.getTableList().find(n=>n.name===e)}setTableFilter(e,t,n){const a={unitId:this.getId(),tableId:e,column:t,tableFilter:n};return this._commandService.executeCommand(i.SetSheetTableFilterCommand.id,a)}}l.FWorkbook.extend(f);class C extends l.FWorksheet{addTable(e,t,n,a){const s=this.getSheetId(),c=this.getWorkbook(),o=c.getUnitId(),d=this._injector.get(r.LocaleService),m=new Set;if(c&&c.getSheets().forEach(u=>{m.add(u.getName())}),!r.customNameCharacterCheck(e,m))return this._injector.get(r.ILogService).warn(d.t("sheets-table.tableNameError")),!1;const v={unitId:o,subUnitId:s,name:e,range:t,id:n,options:a};return this._commandService.executeCommand(i.AddSheetTableCommand.id,v)}setTableFilter(e,t,n){const a={unitId:this.getWorkbook().getUnitId(),tableId:e,column:t,tableFilter:n};return this._commandService.executeCommand(i.SetSheetTableFilterCommand.id,a)}removeTable(e){const t={unitId:this._fWorkbook.getId(),subUnitId:this.getSheetId(),tableId:e};return this._commandService.executeCommand(i.DeleteSheetTableCommand.id,t)}setTableRange(e,t){const n={unitId:this.getWorkbook().getUnitId(),tableId:e,updateRange:{newRange:t}};return this._commandService.executeCommand(i.SetSheetTableCommand.id,n)}setTableName(e,t){const n=this.getWorkbook(),a=this._injector.get(r.LocaleService),s=new Set;if(n&&n.getSheets().forEach(d=>{s.add(d.getName())}),!r.customNameCharacterCheck(t,s))return this._injector.get(r.ILogService).warn(a.t("sheets-table.tableNameError")),!1;const o={unitId:this.getWorkbook().getUnitId(),tableId:e,name:t};return this._commandService.executeCommand(i.SetSheetTableCommand.id,o)}getSubTableInfos(){const e=this._fWorkbook.getId();return this._injector.get(i.SheetTableService).getTableList(e).filter(n=>n.subUnitId===this.getSheetId())}resetFilter(e,t){const n={unitId:this._fWorkbook.getId(),tableId:e,column:t,tableFilter:void 0};return this._commandService.executeCommand(i.SetSheetTableFilterCommand.id,n)}getTableByCell(e,t){const n=this._fWorkbook.getId(),s=this._injector.get(i.SheetTableService).getTableList(n).filter(o=>o.subUnitId===this.getSheetId()),c=r.cellToRange(e,t);return s.find(o=>{const d=o.range;return r.Rectangle.intersects(d,c)})}addTableTheme(e,t){const n=new I.RangeThemeStyle("table-style");return n.fromJson(t),this._commandService.executeCommand(i.AddTableThemeCommand.id,{unitId:this._fWorkbook.getId(),tableId:e,themeStyle:n})}}l.FWorksheet.extend(C);class k extends b.FEnum{get TableColumnFilterTypeEnum(){return i.TableColumnFilterTypeEnum}get TableConditionTypeEnum(){return i.TableConditionTypeEnum}get TableNumberCompareTypeEnum(){return i.TableNumberCompareTypeEnum}get TableStringCompareTypeEnum(){return i.TableStringCompareTypeEnum}get TableDateCompareTypeEnum(){return i.TableDateCompareTypeEnum}}b.FEnum.extend(k)}));
