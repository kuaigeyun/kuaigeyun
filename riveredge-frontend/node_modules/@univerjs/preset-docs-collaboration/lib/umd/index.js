// @univerjs-pro/collaboration-client/index
function _0x58ee(_0x44fb3f,_0x4b27c8){_0x44fb3f=_0x44fb3f-0x1d1;var _0x369286=_0x3692();var _0x58ee19=_0x369286[_0x44fb3f];return _0x58ee19;}function _0x3692(){var _0x58f79a=['UnitSnapshot','getOwnPropertyDescriptor','@univerjs/network','from','filter','ClipsheetFragments','LICENSE_MAX_UNITS_EXCEEDED','DEFAULT_WS_SESSION_TICKET_URL','registerDependencies','REDEMPTION_CODE_NOT_STARTED','getUnitStatus$','localCacheService','enableCollaboration','LIVESHARE_NEW_HOST','LIVESHARE_TERMINATE','ENTITLE_REPORT_LIMIT_EXCEED','getImageSourceCache','OTHER_CLIENTS_EDITING','_createInitialStateImpl','state$','emitEvent','&source=','unpad','_doProcessBlock','_unitID','_memberService','OTHER_CLIENT_EDITING','memberID','[SyncedState]:\x20received\x20rejection.','b64DecodeUnicode','NOT_FOUND','requireSession','[SyncedState]:\x20invalid\x20calling\x20to\x20`resend`.','onTransformRemoteChangesetByStateCache','get','ENTITLE_CHAT_LIMIT_EXCEED','\x20in\x20_schedule.','UNRECOGNIZED','_collaborationSessionService','error','min','charAt','slice','updateMember','onStarting','open$','ICommandService','getTime','values','_pendingMutations','USERS_ENTER','createDecryptor','sheets','JOIN_ROOM_NOT_EXISTS','getMember','socketService','CURRENT_STATUS_CANNOT_OPERATE','IUndoRedoService','fetch_missing','updatePermissionPoint','method','@univerjs-pro/collaboration','Disposable','AES','UniverCore','[serializeCombRequest]:\x20should\x20not\x20fall\x20into\x20default\x20branch!','apply','pending','_HTTPService','DataLoaderService','onRemoteRej','COMMENT_UPDATE','HELLO','getCurrentRevOfUnit','YUUMI_NO_CUBOID_FOR_QUESTION','hostname','close','MemberService','UNIVER_PROJECT','DATA_SOURCE_TOO_LARGE','_map','CollaborationStatus','/role','floor','ENTITLE_COUPON_USED_UP','OfflineState','now','UPDATE_PERMISSION_OBJ','transformUndoRedo','_getSendChangesetTimeout','_collaborationTimeoutTimer','executeCommand','CollaborationImageIoService','equals','putCollaborators','revision','HmacMD5','_keySchedule','parseChangesetToProtocol','9Gxsjvt','substr','createIdentifier','_nRounds','Plugin','type','CollaborationSocketService','REDEMPTION_USER_NOT_ELIGIBLE','buffer','uploadFileServerUrl','_transformStateCache','_userManagerService','[OfflineState]:\x20invalid\x20calling\x20to\x20`resend`.','parse','rev','concatMap','transformMutationsWithChangeset','_resendTimer','IUniverInstanceService','CollaborationUIEventService','conflict','AwaitingWithPendingState','[CollaborationController]:\x20invalid\x20univer\x20type:\x20','SheetsSelectionsService','_showConflictNotification','CollaborationEntity','RETRY_CONNECTING_MAX_COUNT','size','transformSelections','disposeWithMe','ConflictState','enableSingleActiveInstanceLock','SNAPSHOT_INVALID_SNAPSHOT','collabSubmitChangesetUrl','SNAPSHOT_HAS_BEEN_REMOVED','confirm','/allowed','init','8agZVPk','AWAITING_WITH_PENDING','offline','_clearCollaborationTimeoutTimer','_onCombEvent','ImageSourceType','BASE64','m2Prime','_initRequestHeader','SOCKET_FAILED','UNISCRIPT_RUN','EmptyMutationInfo','_retryConnectingTimer','IDLE','MSG_FOR_ERROR','changesets','session.room-not-exists','_tryReconnect','_clearRedo','UPDATE_CURSOR','_clearUndo','merge','UnitEmbedded','then','create','pad','65062KpAuTJ','LIVESHARE_REQUEST_HOST','getGlobalObject','ENTITLE_NEED_BILLING_ADDRESS','objectType','_type','members$','YUUMI_UNABLE_LOAD_URL','_onUserJoin','fromCharCode','UniverCollaborationClientPlugin','join','baseRev','INVALID_INVITE_CODE','_socket$','IAuthzIoService','_substituteRedoStack','ENTITLE_CAN_NOT_BUY_LOWER_OTP','_commentUpdate$','x-univer-host','fetchMiss','sendChangesetTimeout','FileId','_getAPIPrefixPath','CHANGESET_REJ','JOIN','_httpService','unit-cache-','getAllMembers','file','unitId','CommentService','session.room-full','CollaborationSessionService','_transformRemoteChangesetByIMECache','format','/unit/','roles','\x20-\x20','_onUserLeave','objects','885441ApWQEV','onMissedChangesetFetched','[OfflineState]:\x20received\x20changeset.','FetchingMissState','_exhaustRemoteChangesetQueue','formatter','ReplaySubject','shareReplay','_isPermissionRej','socket$','charCodeAt','liveShareNewHost','RichTextEditingMutation','OpenSSL','session.room-permission-denied','ERROR_IMAGE_TYPE','awaiting','originalMeta','readInt32LE','YUUMI_AI_RUN_FAILED','_syncEditingCollabCursor','/object/','CLOSE_ROOM','interceptor','onSendChangeset','GLOBAL_ROOMS_CNT_EXCEEDS','synced','_localCacheService','hasher','_xformMode','_univerInstanceService','_createHelper','routeKey','concat','_mode','reconnect','_schedule','fetchThroughInterceptors','/fetchmissing?from=','close$','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','SHA1','_event$','CompressMutationService','collabWebSocketUrl','random','readAsDataURL','_onRemoteChangeset','_onOffline','SheetPermissionInitController','responseType','href','3822486BAVjGV','__Key__','submit\x20changeset\x20error!','_sheetTransformSelectionsService','ERROR_IMAGE','LocalUndoRedoService','This\x20method\x20should\x20not\x20be\x20called\x20on\x20the\x20client\x20side!','_createInitialState','updateSnapshot','_socketService','subUnitId','[AuthServerService]:\x20you\x20should\x20provide\x20authentication\x20info\x20on\x20Node.js.','toStringTag','_removeRoom','_logService','_socketMessageSubscription','toDisposable','LICENSE_EXPORT_SIZE_EXCEEDED','_startTelemetryCollaborationNewChangeset','objectActions','_telemetryService','sin','onTransformRemoteChangesetByStateCache\x20callback\x20is\x20not\x20added\x20yet.','_retryCount','CollaborationUIEventId','_prevBlock','clone','reduce','telemetry\x20info\x20is\x20not\x20initialized','_onConnectionFailed','Utf8','[SyncedState]:\x20received\x20acknowledgement.','_configService','_unlockTransition','has','SetSelectionsOperation','isArray','src','mutations','_onConflict','__creator','_DEC_XFORM_MODE','sigBytes','loadSheet','Optional','mode','__splitChunk__','[FetchingMissState]:\x20not\x20expected\x20to\x20receive\x20ack\x20when\x20`this._awaitingChangeset`\x20is\x20null!','[DataLoaderService]','selections','commentUpdateEvent','infoRsp','saveSheetBlock','APPLY_PERMISSION_DENIED','list','not_collab','catch','@univerjs/docs','dispose','_changesetReqId','[CollaborationSocketService]:\x20failed\x20to\x20get\x20web\x20socket\x20factory!','ciphertext','PY_RUNTIME_SCRIPT_ERROR','LOCAL_CACHE_INTERVAL','[UniverCollaborationClientPlugin]:\x20you\x20must\x20provide\x20a\x20socketService\x20implementation\x20in\x20config!','_injector','_executeRemoteChangeset','Injector','_localeService','shouldCloseConn','_state','SHOULD_CLOSE_CONN','saveChangeset','AwaitingState','PasswordBasedCipher','onRemoteChangeset','map','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','?url=','setCurrentUser','LICENSE_IMPORT_SIZE_EXCEEDED','_transformService','takeUntil','$super','JOINING','_updateLocalCache','YUUMI_SUBSCRIPTION_NOT_FOUND','mapDocumentTypeToUniverType','_handler','SOCKET_FAILED_RETRY','ILogService','duration','override','createEncryptor','_sendHeartbeatTimer','loadDoc','_substituteUndoStack','_unitInfo$','SerializableCipher','unitInfo$','resend','crypto','reqId','loadUnitOfRevision','clamp','_remoteChangesetQueue','_commandService','_shouldReportTelemetry','CONNECTOR_DATA_TOO_LARGE','_createSocket','_startCollaboration','FETCH_MISSING','onMutationExecutedForCollab','/universer-api/uniscript','_getCtorByUniverType','OPTIONAL','_keyPriorReset','next','UNKNOWN_CMD','defineProperty','Subject','csAckEvent','onTransformState','/-/object/list','incrementRevOfUnit','fetchMissingChangesets','unitId\x20is\x20not\x20found','delay','HEARTBEAT_TIMEOUT','CollaborationController','downloadEndpointUrl','_getDownloadEndpointURL','PENDING','_handlerCallback','max','_incrementRevisionNumber','[CollaborationSessionService]:\x20socket\x20error','ENTITLE_USE_COUPON_NOT_1ST_TRADE','@univerjs/drawing','OFFLINE','onSyncEditingCollabCursor','_waitCount','textEncoder','_commentService','append','_toggleOffline','collaboration_new_changeset','[CollaborationState]:\x20apply\x20error!','INVITE_CODE_REQUIRED','_doCreateSocket','/rev/','JOIN_ROOM_FULL','_cipher','SUBMIT_CHANGESET_TIMEOUT','HttpImport','_undoRedoService','_permissionService','blockSize','WECHAT_HAS_BEEN_BOUND','_fetchMissChangesets','_replayCachedMutations','YUUMI_ALL_TABLES_IS_INVALID','result','getTypeOfUnitAdded$','reverse','ISocketService','YUUMI_CONNECTOR_URL_NOT_FOUND','APPLY_NON_SEQUENTIAL_REVISION','USER_NOT_INVITED_CODE','_socket','_emitMembers','DependentOn','REDEMPTION_INVALID_CODE','_acknowledgedAwaitingChangeset','_transformStack','SnapshotService','YUUMI_TABLE_NOT_FOUND_IN_UNIT','_config','{fileID}','addImageSourceCache','UniverProLicense','image/png','DocCollaborationEntity','[CollaborationSocketService]:\x20failed\x20to\x20create\x20socket!','snapshot','getTypeOfUnitDisposed$','_process','onRemoteRetry','ISingleActiveUnitService','\x0aAfter:\x20','Hex','YUUMI_ASYNCIO_CANCELLED','byteOffset','allowed','DEFAULT_FILE_NAME','Undefined','LOCAL_CACHE_INTERVAL_KEY','SheetTransformSelectionsService','PSEUDO_FETCH_MISSING_RESULT','_lockTransition','UUID','getSnapshotAPIPath','getDeserializedSheetBlock','exports','BehaviorSubject','_entities','complete','MOBILE_VERIFY_CODE_MISMATCH','socket\x20close','lib','key','_networkConditionService','put','session.room-cnt-exceeds','withCredentials','MD5','_getUndoStack','_entityInit$','debug','addHandlerCallback','_transitionLocked','repeat','reset','_hasher','CipherParams','collaborators','EMAIL_HAS_BEEN_BOUND','getCollabEntity','name','_singleActiveUnitService','reject','ENTITLE_COUPON_EXPIRED','onTransformRemoteChangesetByIMECache','_replaceFileID','onlyLocal','REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','setConfig','fromCollab','LEAVE','_checkMissing','params','/object','execute','_joinRoom','PERSON','cfg','UNIVER_UNKNOWN','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','APPLY_REJECT','awaiting_with_pending','IPermissionService','UNKNOWN_CODE','ALREADY_EXISTS','HEARTBEAT_INTERVAL','/collaborator','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=','updatePermissionObjEvent','@univerjs/core','_timeoutTimer','setShowComponents','@univerjs-pro/license','session','update','ERROR_AGAIN','_oKey','HMAC','prototype','_clearRetryConnectingTimer','/universer-api/user/session-ticket','subscribe','_initUnitPermissionChange','/universer-api/snapshot/','initWorkbookPermissionChange','_undoStacks','People','onRemoteAck','words','encryptBlock','CHANGESET_SHOULD_RETRY','_doFinalize','_reverseMap','8672432oOYLgA','UNIVER_SHEET','COMPRESS_MUTATION_APPLY','Cannot\x20assemble\x20a\x20changeset\x20from\x20multiple\x20mutations\x20of\x20different\x20types:\x20','textRanges','ws://127.0.0.1:8000/universer-api/comb/connect','code','csShouldRetryEvent','pipe','CHANGESET_REVISION_CONFILICT','finalize','toString','&to=','registerHTTPInterceptor','randomBytes','AUTHORIZE_CODE_ILLEGAL','EvpKDF','generateRandomId','UniverCollaborationPlugin','sequenceExecute','HTTPRequest','/new_changes','sid','Latin1','UNIVER_DOC','updateOfflineData','encode','CollaborationEvent','url','\x22.\x20Please\x20configure\x20the\x20dynamicRequireTargets\x20or/and\x20ignoreDynamicRequires\x20option\x20of\x20@rollup/plugin-commonjs\x20appropriately\x20for\x20this\x20require\x20call\x20to\x20work.','_onFetchMissResult','operators','RxDisposable','rxjs/operators','_eventService','_change$','ITransformService','[CollaborationEntity]:\x20invalid\x20state\x20transition!\x20State\x20transferred\x20from\x20is\x20not\x20the\x20current\x20state.\x0aBefore:\x20','APPLY_DUPLICATED','body','_transformRemoteChangesetByStateCache','COMPLETION_FINISHED','commentUpdate$','_collabSessionService','PendingState','Could\x20not\x20dynamically\x20require\x20\x22','WordArray','[CollaborationEntity]:\x20cannot\x20lock\x20transition\x20twice!\x20This\x20is\x20an\x20implementation\x20error,\x20meaning\x20you\x20transit\x20the\x20collaboration\x20state\x20again\x20in\x20the\x20process\x20of\x20a\x20previous\x20transition.\x20This\x20should\x20never\x20happen.','ICollaborationSocketService','symbol','_getLoginPath','getUnitOnRev','_stopTelemetryCollaborationNewChangeset','HttpExport','_getRedoStack','forEach','includes','_registerDependencies','MergeInterceptorFactory','\x20to\x20','AWAITING','_members','InsertSheetMutation','_status$','data','focused$','resolve','_tryEnsureSocket','UNAUTHENTICATED','REDEMPTION_CODE_FULLY_REDEEMED','[CollaborationSession]:\x20should\x20not\x20send\x20message\x20when\x20the\x20session\x20is\x20offline!','Native\x20crypto\x20module\x20could\x20not\x20be\x20used\x20to\x20get\x20secure\x20random\x20number.','Univer','getInterceptPoints','ILocalCacheService','_submitChangeset','image/jpg','POST','copyFileMeta','_redoStacks','_createHmacHelper','YUUMI_RATE_OVER_LIMIT','JOIN_ROOM_PERMISSION_DENIED','unknown','deepClone','_getUploadFileURL','getFocusedUnit','INVALID_ARGUMENT','YUUMI_URL_COL_OUT_OF_RANGE','_scheduleCompleteTimestamp','_revisionService','Workbook','getLatestCsReqIdBySid','MentionIoHttpService','DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT','event$','getSheetBlock','_hash','_candidateSocket','send','members','loadUnit','SnapshotServerOverHTTPService','_waitForHeartbeatResponse','JOIN_ROOM_FAILED','startsWith','newCsEvent','USER_NOT_FOUND','mixIn','SheetCollaborationEntity','splice','hasOwnProperty','enableAuthServer','_ENC_XFORM_MODE','add','getRandomValues','5327895zKmGmc','permissionRejEvent','Tools','/universer-api/stream/file/upload','[CollaborationSession]','awaitingChangeset','createSocket','?size=','Encryptor','encrypt','/universer-api/snapshot','getActiveSheet','USERS_LEAVE','Rectangle','replace','onStateChange','HTTPService','CHANGESET_ACK','Pkcs7','ISnapshotServerService','_nDataBytes','_onRecvEvent','removeMember','_onRemoteRejected','NEW_CHANGESETS','error$','/universer-api/file/{fileID}/sign-url','ONLINE','INVITE_CODE_ALREADY_BOUND','CollaborativeUndoRedoService','_getAPIPrefix','REDEMPTION_CODE_HAS_BEEN_CREATED','_resendTimeout','string','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','_listenToNetworkCondition','RECV','_invKeySchedule','post','[PendingState]:\x20received\x20rejection.','LocaleService','getValue','stopTime','getCollabEntity$','mergeOverrideWithDependencies','INVITE_CODE_HAS_BEEN_UES','[CollaborationSessionService]','parseProtocolChangeset','_collaborationPaused','Unknown\x20type.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.','_compressMutationService','_snapshotServerService','_resendWithTimeout','_clearTimeoutTimer','RevisionService','@univerjs/telemetry','getSheetId','PERMISSION_DENIED','toggleOffline','_onJoinRoomEvent','\x0aCurrent:\x20','getImage','PERMISSION_REJ','NOT_COLLAB','range','subject','FAIL','_key','FETCH_MISS','indexOf','startTime','UniverSheets','_clearHeartbeatTimer','_telemetryInfo','onLocalMutation','signUrlServerUrl','_onConnectionOpen','LICENSE_DISTRO_REJECTED','userID','_onLocalMutation','byteLength','_members$','EMAIL_VERIFY_CODE_MISMATCH','_onRemoteRetry','_rescheduleHeartbeat','enc','StreamCipher','joinEvent','&assign=','_doReset','INGEST','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','c1Prime','MOBILE_HAS_BEEN_BOUND','Inject','/universer-api/authz','_changesetSessionId','NoPadding','@univerjs/sheets','status$','unsubscribe','REDEMPTION_CODE_INACTIVE','/universer-api/comb','univer-pro.collaboration-client-socket-service','UniverProCollaboration','listCollaborators','getUnitId','entityInit$','_queuedRemoteChangesets','editingUnit','_updateState','/block/','enableOfflineEditing','function','7484596PGIXlp','[UniverCollaborationClientPlugin]','default','saveSnapshot','_sender','Base64','[FetchMissState]','CONFLICT','state','clear','action','USER_IS_ANONYMOUS','_getSignURL','LIVESHARE_FETCH_OPERATIONS','INTERNAL_ERROR','delete','appendMutation','_clearScheduledTask','rxjs','ceil','31629708bsvOLQ','asObservable','refreshPermission','salt','_transformUndoredo','_iv','unitID','AuthzIoHttpService','_getCurrentRevision','csRejEvent','amd','_sessionStatus$','_toggleOnline','IConfigService','extend','objectID','_sessions','image/jpeg','listRoles','closeSession','UNIVER_SLIDE','UNDEFINED','[OfflineState]:\x20received\x20acknowledgement.','uuidv4','_applyRemoteChangeset','/-/object/-/batch_allowed','findIndex','Decryptor','_parse','toggleOnline','univer-pro.collaboration-client.single-active-unit-service','UniverInstanceType','SNAPSHOT_URL_KEY','BlockCipher','getCurrentSelections','isInternalEditorID','SyncedState','ENSURE_SNAPSHOT_EXECUTION','LOGIN_TOKEN_PROCESSING_FAILED','LIVESHARE_OPERATION','kdf','transformChangesets','entries','auth.needGotoLoginAlert','UserProfileImg','_doCryptBlock','joinRsp','deleteCollaborator','UniverNetwork','[CollaborationUndoRedoService]','_decreaseWaiting','Hasher','set','pluginName','getRoom','collaboration-client.local-cache-service','requestParams','_onRemoteACK','_disableEditing','call','isTransformMutationsWithChangesetSuccess','status','actions','_awaitingChangeset','IMentionIOService','updateCollaborator','push','_initCloseConn','loadOfflineData','onTransformRemoteChangesetByIMECache\x20callback\x20is\x20not\x20added\x20yet.','_sendingTimer','leaveEvent','_collaborationUIEventService','NO_OTHER_CLIENTS_EDITING','ivSize','disableLocalCache','getConfig','_socketReady','cmd','HEARTBEAT_TIMEOUT_KEY','_data','take','_throwTelemetryCollaborationNewChangeset','HEARTBEAT','collaboration-client.config','WorkbookEditablePermission','_imageSourceCache','LOGIN_FAILED','every','onTransformSelections','authzUrl','_roomCreated$','onTransformIME','algo','save\x20fail\x20reason\x20is\x20','dispose$','_append','getMemberID','_sendHeartbeat','_initDependencies','getCurrentUser','eventID','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','REDEMPTION_USER_REDEEM_TIMES_EXCEED','Failed\x20to\x20update\x20permission\x20point','iterations','touchDependencies','online$','[CollaborationEntity]','onCommentUpdate','_onMessage','decrypt','createInstance','keySize','UNIVER_COLLABORATION_CLIENT_PLUGIN','find','sessionStatus','_snapshotService','isTransformMutationsWithChangesetFailure','processBlock','session.join-failed','_init','PAYMENT_CHANNEL_NOT_SUPPORT','ImageUploadStatusType','_createHandler','UserManagerService','abs','_roomMembers','BufferedBlockAlgorithm','_updateStatus','Base','updateCursorEvent','compute','headers','length','getUnitType','stringify','message$','IImageIoService','SUBMIT_CHANGESET','CollaborationSession','_clearLocalCache','isPermissionRej'];_0x3692=function(){return _0x58f79a;};return _0x3692();}(function(_0x5bec5f,_0x48c642){var _0x45d02d=_0x58ee,_0x2a8da4=_0x5bec5f();while(!![]){try{var _0x5323d0=parseInt(_0x45d02d(0x431))/0x1*(parseInt(_0x45d02d(0x471))/0x2)+-parseInt(_0x45d02d(0x49a))/0x3*(parseInt(_0x45d02d(0x457))/0x4)+-parseInt(_0x45d02d(0x2b9))/0x5+parseInt(_0x45d02d(0x4ce))/0x6+-parseInt(_0x45d02d(0x32b))/0x7+-parseInt(_0x45d02d(0x245))/0x8+parseInt(_0x45d02d(0x33f))/0x9;if(_0x5323d0===_0x48c642)break;else _0x2a8da4['push'](_0x2a8da4['shift']());}catch(_0x9521d5){_0x2a8da4['push'](_0x2a8da4['shift']());}}}(_0x3692,0x9b0ed),function(_0x448a4c,_0x427c09){var _0x2dce0d=_0x58ee;typeof exports=='object'&&typeof module<'u'?_0x427c09(exports,require('@univerjs-pro/collaboration'),require('@univerjs/core'),require('@univerjs/docs'),require('@univerjs/sheets'),require('rxjs'),require('@univerjs/telemetry'),require('rxjs/operators'),require('@univerjs/network'),require('@univerjs/drawing'),require('@univerjs-pro/license')):typeof define==_0x2dce0d(0x32a)&&define[_0x2dce0d(0x349)]?define([_0x2dce0d(0x1f7),_0x2dce0d(0x40b),_0x2dce0d(0x22d),_0x2dce0d(0x507),_0x2dce0d(0x31b),_0x2dce0d(0x33d),_0x2dce0d(0x2f0),_0x2dce0d(0x266),_0x2dce0d(0x3d0),_0x2dce0d(0x558),_0x2dce0d(0x230)],_0x427c09):(_0x448a4c=typeof globalThis<'u'?globalThis:_0x448a4c||self,_0x427c09(_0x448a4c['UniverProCollaborationClient']={},_0x448a4c[_0x2dce0d(0x321)],_0x448a4c[_0x2dce0d(0x40e)],_0x448a4c['UniverDocs'],_0x448a4c[_0x2dce0d(0x300)],_0x448a4c[_0x2dce0d(0x33d)],_0x448a4c['UniverTelemetry'],_0x448a4c[_0x2dce0d(0x33d)][_0x2dce0d(0x264)],_0x448a4c[_0x2dce0d(0x36f)],_0x448a4c['UniverDrawing'],_0x448a4c[_0x2dce0d(0x1e0)]));}(this,function(_0x1065a7,_0x3ab606,_0x5bafa4,_0x460538,_0x1c5262,_0x1a688c,_0x7d7753,_0xd6074,_0x24f178,_0x301beb,_0x6c7987){'use strict';var _0x3d1808=_0x58ee;var _0x1a1637=Object[_0x3d1808(0x545)],_0x1cd46d=(_0x2d8093,_0x68039f,_0x1282d2)=>_0x68039f in _0x2d8093?_0x1a1637(_0x2d8093,_0x68039f,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x1282d2}):_0x2d8093[_0x68039f]=_0x1282d2,_0x3fc7c7=(_0x1b1b92,_0xfbc833,_0xec63b5)=>_0x1cd46d(_0x1b1b92,typeof _0xfbc833!=_0x3d1808(0x276)?_0xfbc833+'':_0xfbc833,_0xec63b5);const _0x37e926=_0x3d1808(0x2c3),_0x268f01=_0x3d1808(0x35f),_0x38d231=_0x3d1808(0x24a),_0x480f18=_0x3d1808(0x238),_0x38c58d=_0x3d1808(0x229),_0x3d06ad=_0x3d1808(0x54e),_0x589908=_0x3d1808(0x44b),_0x36ba43=_0x3d1808(0x50d),_0x339a5b=_0x3d1808(0x31f),_0x35a1a3='/universer-api/oidc/authpage',_0x183c7f=_0x3d1808(0x217),_0x287679=_0x3d1808(0x53f);var _0x44514f=(_0x105845=>(_0x105845[_0x105845['UNDEFINED']=0x0]=_0x3d1808(0x354),_0x105845[_0x105845['OK']=0x1]='OK',_0x105845[_0x105845[_0x3d1808(0x339)]=0x2]=_0x3d1808(0x339),_0x105845[_0x105845['PERMISSION_DENIED']=0x3]=_0x3d1808(0x2f2),_0x105845[_0x105845['NOT_FOUND']=0x4]=_0x3d1808(0x3ec),_0x105845[_0x105845[_0x3d1808(0x289)]=0x5]='UNAUTHENTICATED',_0x105845[_0x105845[_0x3d1808(0x228)]=0x6]=_0x3d1808(0x228),_0x105845[_0x105845[_0x3d1808(0x29c)]=0x7]='INVALID_ARGUMENT',_0x105845[_0x105845['TOO_MANY_REQUESTS']=0x8]='TOO_MANY_REQUESTS',_0x105845[_0x105845[_0x3d1808(0x26e)]=0x9]=_0x3d1808(0x26e),_0x105845[_0x105845[_0x3d1808(0x396)]=0xa]=_0x3d1808(0x396),_0x105845[_0x105845[_0x3d1808(0x1fb)]=0xb]=_0x3d1808(0x1fb),_0x105845[_0x105845[_0x3d1808(0x3a5)]=0xc]=_0x3d1808(0x3a5),_0x105845[_0x105845[_0x3d1808(0x30b)]=0xd]=_0x3d1808(0x30b),_0x105845[_0x105845[_0x3d1808(0x2db)]=0xe]=_0x3d1808(0x2db),_0x105845[_0x105845[_0x3d1808(0x254)]=0xf]=_0x3d1808(0x254),_0x105845[_0x105845[_0x3d1808(0x365)]=0x10]=_0x3d1808(0x365),_0x105845[_0x105845[_0x3d1808(0x406)]=0x64]=_0x3d1808(0x406),_0x105845[_0x105845[_0x3d1808(0x233)]=0x65]=_0x3d1808(0x233),_0x105845[_0x105845[_0x3d1808(0x2b0)]=0xc9]=_0x3d1808(0x2b0),_0x105845[_0x105845[_0x3d1808(0x336)]=0xca]=_0x3d1808(0x336),_0x105845[_0x105845[_0x3d1808(0x24e)]=0x1389]='CHANGESET_REVISION_CONFILICT',_0x105845[_0x105845[_0x3d1808(0x451)]=0x1771]=_0x3d1808(0x451),_0x105845[_0x105845[_0x3d1808(0x453)]=0x1772]=_0x3d1808(0x453),_0x105845[_0x105845[_0x3d1808(0x364)]=0x1773]=_0x3d1808(0x364),_0x105845[_0x105845[_0x3d1808(0x224)]=0x1b59]=_0x3d1808(0x224),_0x105845[_0x105845[_0x3d1808(0x1d3)]=0x1b5a]='APPLY_NON_SEQUENTIAL_REVISION',_0x105845[_0x105845['APPLY_REVISION_CONFILICT']=0x1b5b]='APPLY_REVISION_CONFILICT',_0x105845[_0x105845['APPLY_PERMISSION_DENIED']=0x1b5c]=_0x3d1808(0x503),_0x105845[_0x105845[_0x3d1808(0x26b)]=0x1b5d]=_0x3d1808(0x26b),_0x105845[_0x105845[_0x3d1808(0x53a)]=0x1f41]=_0x3d1808(0x53a),_0x105845[_0x105845[_0x3d1808(0x3d4)]=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0x105845[_0x105845[_0x3d1808(0x314)]=0x232a]='LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED',_0x105845[_0x105845[_0x3d1808(0x51e)]=0x232b]='LICENSE_IMPORT_SIZE_EXCEEDED',_0x105845[_0x105845[_0x3d1808(0x4df)]=0x232c]=_0x3d1808(0x4df),_0x105845[_0x105845[_0x3d1808(0x306)]=0x232d]='LICENSE_DISTRO_REJECTED',_0x105845[_0x105845[_0x3d1808(0x478)]=0x2711]=_0x3d1808(0x478),_0x105845[_0x105845[_0x3d1808(0x29d)]=0x2712]='YUUMI_URL_COL_OUT_OF_RANGE',_0x105845[_0x105845[_0x3d1808(0x296)]=0x2713]=_0x3d1808(0x296),_0x105845[_0x105845[_0x3d1808(0x524)]=0x2714]=_0x3d1808(0x524),_0x105845[_0x105845[_0x3d1808(0x418)]=0x271a]=_0x3d1808(0x418),_0x105845[_0x105845[_0x3d1808(0x1eb)]=0x271b]=_0x3d1808(0x1eb),_0x105845[_0x105845[_0x3d1808(0x1dc)]=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0x105845[_0x105845[_0x3d1808(0x56f)]=0x271d]=_0x3d1808(0x56f),_0x105845[_0x105845[_0x3d1808(0x223)]=0x271e]=_0x3d1808(0x223),_0x105845[_0x105845['YUUMI_AI_RUN_FAILED']=0x271f]=_0x3d1808(0x4ad),_0x105845[_0x105845[_0x3d1808(0x1d2)]=0x2720]='YUUMI_CONNECTOR_URL_NOT_FOUND',_0x105845[_0x105845['PY_RUNTIME_SCRIPT_ERROR']=0x2af9]=_0x3d1808(0x50c),_0x105845[_0x105845[_0x3d1808(0x2e6)]=0x2ee1]=_0x3d1808(0x2e6),_0x105845[_0x105845[_0x3d1808(0x47e)]=0x2ee2]='INVALID_INVITE_CODE',_0x105845[_0x105845[_0x3d1808(0x562)]=0x2ee3]=_0x3d1808(0x562),_0x105845[_0x105845['USER_NOT_INVITED_CODE']=0x2ee4]=_0x3d1808(0x1d4),_0x105845[_0x105845[_0x3d1808(0x2d5)]=0x2ee5]=_0x3d1808(0x2d5),_0x105845[_0x105845['WECHAT_HAS_BEEN_BOUND']=0x32c9]=_0x3d1808(0x56c),_0x105845[_0x105845[_0x3d1808(0x316)]=0x32ca]=_0x3d1808(0x316),_0x105845[_0x105845['EMAIL_HAS_BEEN_BOUND']=0x32cb]=_0x3d1808(0x20e),_0x105845[_0x105845[_0x3d1808(0x482)]=0x36b1]=_0x3d1808(0x482),_0x105845[_0x105845[_0x3d1808(0x4c2)]=0x36b2]=_0x3d1808(0x4c2),_0x105845[_0x105845['ENTITLE_DUP_SUBSCRIPTION']=0x36b3]='ENTITLE_DUP_SUBSCRIPTION',_0x105845[_0x105845[_0x3d1808(0x3b9)]=0x36b4]=_0x3d1808(0x3b9),_0x105845[_0x105845['ENTITLE_INVALID_COUPON_CODE']=0x36b5]='ENTITLE_INVALID_COUPON_CODE',_0x105845[_0x105845[_0x3d1808(0x213)]=0x36b6]=_0x3d1808(0x213),_0x105845[_0x105845[_0x3d1808(0x422)]=0x36b7]='ENTITLE_COUPON_USED_UP',_0x105845[_0x105845[_0x3d1808(0x557)]=0x36b8]='ENTITLE_USE_COUPON_NOT_1ST_TRADE',_0x105845[_0x105845[_0x3d1808(0x3f1)]=0x3715]='ENTITLE_CHAT_LIMIT_EXCEED',_0x105845[_0x105845['ENTITLE_REPORT_LIMIT_EXCEED']=0x3716]=_0x3d1808(0x3dd),_0x105845[_0x105845['ENTITLE_INSUFFICIENT_QUOTA']=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0x105845[_0x105845[_0x3d1808(0x474)]=0x37dd]=_0x3d1808(0x474),_0x105845[_0x105845[_0x3d1808(0x1d8)]=0x3a99]='REDEMPTION_INVALID_CODE',_0x105845[_0x105845['REDEMPTION_CODE_INACTIVE']=0x3a9a]=_0x3d1808(0x31e),_0x105845[_0x105845[_0x3d1808(0x28a)]=0x3a9b]=_0x3d1808(0x28a),_0x105845[_0x105845[_0x3d1808(0x3d7)]=0x3a9c]=_0x3d1808(0x3d7),_0x105845[_0x105845[_0x3d1808(0x438)]=0x3a9d]=_0x3d1808(0x438),_0x105845[_0x105845['REDEMPTION_USER_REDEEM_TIMES_EXCEED']=0x3a9e]=_0x3d1808(0x3a6),_0x105845[_0x105845[_0x3d1808(0x2d8)]=0x3a9f]=_0x3d1808(0x2d8),_0x105845[_0x105845[_0x3d1808(0x41d)]=0x3e81]=_0x3d1808(0x41d),_0x105845[_0x105845[_0x3d1808(0x3f3)]=-0x1]='UNRECOGNIZED',_0x105845))(_0x44514f||{}),_0x32e542=(_0x81e17e=>(_0x81e17e[_0x81e17e[_0x3d1808(0x222)]=0x0]=_0x3d1808(0x222),_0x81e17e[_0x81e17e[_0x3d1808(0x25d)]=0x1]=_0x3d1808(0x25d),_0x81e17e[_0x81e17e[_0x3d1808(0x246)]=0x2]='UNIVER_SHEET',_0x81e17e[_0x81e17e[_0x3d1808(0x353)]=0x3]=_0x3d1808(0x353),_0x81e17e[_0x81e17e[_0x3d1808(0x41c)]=0x4]=_0x3d1808(0x41c),_0x81e17e[_0x81e17e[_0x3d1808(0x3f3)]=-0x1]=_0x3d1808(0x3f3),_0x81e17e))(_0x32e542||{}),_0x46dd39=(_0x418ef6=>(_0x418ef6[_0x418ef6['UNKNOWN_CMD']=0x0]=_0x3d1808(0x544),_0x418ef6[_0x418ef6['HELLO']=0x1]='HELLO',_0x418ef6[_0x418ef6[_0x3d1808(0x48a)]=0x2]='JOIN',_0x418ef6[_0x418ef6['LEAVE']=0x3]=_0x3d1808(0x21a),_0x418ef6[_0x418ef6[_0x3d1808(0x313)]=0x4]=_0x3d1808(0x313),_0x418ef6[_0x418ef6[_0x3d1808(0x392)]=0x5]='HEARTBEAT',_0x418ef6[_0x418ef6['RECV']=0x6]=_0x3d1808(0x2dd),_0x418ef6[_0x418ef6[_0x3d1808(0x3f3)]=-0x1]='UNRECOGNIZED',_0x418ef6))(_0x46dd39||{}),_0x25b6a7=(_0x19ba74=>(_0x19ba74[_0x19ba74['UNKNOWN_CODE']=0x0]=_0x3d1808(0x227),_0x19ba74[_0x19ba74['OK']=0x1]='OK',_0x19ba74[_0x19ba74[_0x3d1808(0x2fb)]=0x2]='FAIL',_0x19ba74[_0x19ba74[_0x3d1808(0x565)]=0x3e9]=_0x3d1808(0x565),_0x19ba74[_0x19ba74[_0x3d1808(0x403)]=0x3ea]=_0x3d1808(0x403),_0x19ba74[_0x19ba74[_0x3d1808(0x297)]=0x3eb]=_0x3d1808(0x297),_0x19ba74[_0x19ba74[_0x3d1808(0x4b3)]=0x3ec]=_0x3d1808(0x4b3),_0x19ba74[_0x19ba74[_0x3d1808(0x3f3)]=-0x1]=_0x3d1808(0x3f3),_0x19ba74))(_0x25b6a7||{}),_0x3fac12=(_0x9bc9bb=>(_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x1ef)]=0x0]=_0x3d1808(0x1ef),_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x568)]=0x1]=_0x3d1808(0x568),_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x27a)]=0x2]=_0x3d1808(0x27a),_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x46d)]=0x3]='UnitEmbedded',_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x3ce)]=0x4]='UnitSnapshot',_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x36b)]=0x5]=_0x3d1808(0x36b),_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x3d3)]=0x6]=_0x3d1808(0x3d3),_0x9bc9bb[_0x9bc9bb[_0x3d1808(0x3f3)]=-0x1]=_0x3d1808(0x3f3),_0x9bc9bb))(_0x3fac12||{});const _0xf9a9b0=_0x3d1808(0x560);function _0x41beff(_0x465c21){return JSON['stringify'](_0x465c21)['length'];}var _0x38090c=(_0x4c9ecf=>(_0x4c9ecf['OTHER_CLIENT_EDITING']=_0x3d1808(0x3e8),_0x4c9ecf[_0x3d1808(0x2f2)]=_0x3d1808(0x2f2),_0x4c9ecf['CONFLICT']=_0x3d1808(0x332),_0x4c9ecf['CLOSE_ROOM']=_0x3d1808(0x4b0),_0x4c9ecf[_0x3d1808(0x2ad)]='JOIN_ROOM_FAILED',_0x4c9ecf[_0x3d1808(0x527)]=_0x3d1808(0x527),_0x4c9ecf[_0x3d1808(0x460)]=_0x3d1808(0x460),_0x4c9ecf[_0x3d1808(0x567)]=_0x3d1808(0x567),_0x4c9ecf))(_0x38090c||{});class _0x10cfe4{constructor(){var _0x377f4e=_0x3d1808;_0x3fc7c7(this,_0x377f4e(0x4c4),new _0x1a688c[(_0x377f4e(0x546))]()),_0x3fc7c7(this,_0x377f4e(0x2a4),this['_event$']['asObservable']());}[_0x3d1808(0x3e2)](_0x318def){var _0x590928=_0x3d1808;this[_0x590928(0x4c4)][_0x590928(0x543)](_0x318def);}}class _0x178a41{constructor(){var _0x4fee2c=_0x3d1808;_0x3fc7c7(this,'_commentUpdate$',new _0x1a688c['Subject']()),_0x3fc7c7(this,_0x4fee2c(0x26f),this['_commentUpdate$'][_0x4fee2c(0x340)]());}[_0x3d1808(0x3ac)](_0x361430){var _0x5daa96=_0x3d1808;this[_0x5daa96(0x483)][_0x5daa96(0x543)](_0x361430);}}var _0x19caa8=Object['getOwnPropertyDescriptor'],_0x43c114=(_0x418a98,_0x43de15,_0x5801fa,_0x380d1d)=>{for(var _0x680825=_0x380d1d>0x1?void 0x0:_0x380d1d?_0x19caa8(_0x43de15,_0x5801fa):_0x43de15,_0x2a00f7=_0x418a98['length']-0x1,_0x5c2ad5;_0x2a00f7>=0x0;_0x2a00f7--)(_0x5c2ad5=_0x418a98[_0x2a00f7])&&(_0x680825=_0x5c2ad5(_0x680825)||_0x680825);return _0x680825;},_0x24dea7=(_0x426bc5,_0x37efc9)=>(_0x1734b4,_0x4560e0)=>_0x37efc9(_0x1734b4,_0x4560e0,_0x426bc5);_0x1065a7[_0x3d1808(0x41b)]=class extends _0x5bafa4[_0x3d1808(0x40c)]{constructor(_0x471cad,_0x46f01e){var _0x301019=_0x3d1808;super(),_0x3fc7c7(this,'_roomMembers',new Map()),_0x3fc7c7(this,_0x301019(0x39a),new _0x1a688c[(_0x301019(0x546))]()),(this[_0x301019(0x4b8)]=_0x471cad,this['_userManagerService']=_0x46f01e,this[_0x301019(0x44e)](_0x1a688c['merge'](this[_0x301019(0x4b8)][_0x301019(0x1e5)](_0x5bafa4['UniverInstanceType'][_0x301019(0x246)])[_0x301019(0x24d)](_0xd6074[_0x301019(0x51a)](_0x2c7baf=>_0x2c7baf['getUnitId']())),this[_0x301019(0x4b8)][_0x301019(0x1e5)](_0x5bafa4[_0x301019(0x35e)][_0x301019(0x25d)])[_0x301019(0x24d)](_0xd6074[_0x301019(0x51a)](_0x173ca9=>_0x173ca9['getUnitId']())),this[_0x301019(0x4b8)][_0x301019(0x1e5)](_0x5bafa4[_0x301019(0x35e)][_0x301019(0x353)])[_0x301019(0x24d)](_0xd6074[_0x301019(0x51a)](_0x549a19=>_0x549a19[_0x301019(0x323)]())))['subscribe'](_0x43d89c=>this[_0x301019(0x4db)](_0x43d89c))));}['waitForRoom$'](_0x49c210){var _0x602efc=_0x3d1808;return this[_0x602efc(0x3be)][_0x602efc(0x4f0)](_0x49c210)?_0x1a688c['of'](this[_0x602efc(0x3be)]['get'](_0x49c210)):this[_0x602efc(0x39a)][_0x602efc(0x24d)](_0xd6074[_0x602efc(0x51a)](_0xada1a2=>{var _0x4a6b4a=_0x602efc;if(_0xada1a2===_0x49c210)return this[_0x4a6b4a(0x3be)]['get'](_0xada1a2);}));}[_0x3d1808(0x51d)](_0x43d587){var _0x591950=_0x3d1808;this['_userManagerService'][_0x591950(0x51d)](_0x43d587);}['getCurrentUser'](){var _0x5ee8f8=_0x3d1808;return this[_0x5ee8f8(0x43c)]['getCurrentUser']();}[_0x3d1808(0x3f9)](_0xdc6375,_0x1d5803){var _0x3bda8e=_0x3d1808;let _0x558f08=this['_roomMembers'][_0x3bda8e(0x3f0)](_0xdc6375);_0x558f08||(_0x558f08=new _0x49b15c(),this[_0x3bda8e(0x3be)][_0x3bda8e(0x373)](_0xdc6375,_0x558f08),this[_0x3bda8e(0x39a)]['next'](_0xdc6375)),_0x558f08['updateMember'](_0x1d5803);}[_0x3d1808(0x2cf)](_0x3939b0,_0x4dd3a7){var _0x35f57b=_0x3d1808;const _0x5784a7=this[_0x35f57b(0x3be)][_0x35f57b(0x3f0)](_0x3939b0);_0x5784a7&&_0x5784a7['removeMember'](_0x4dd3a7);}[_0x3d1808(0x375)](_0x1ec379){var _0x1ca0cf=_0x3d1808;return this[_0x1ca0cf(0x3be)][_0x1ca0cf(0x3f0)](_0x1ec379);}[_0x3d1808(0x404)](_0x479f98,_0x556835){var _0x35d1a1=_0x3d1808;const _0x5e90c5=this['_roomMembers'][_0x35d1a1(0x3f0)](_0x479f98);if(_0x5e90c5)return _0x5e90c5[_0x35d1a1(0x404)](_0x556835);}[_0x3d1808(0x4db)](_0x5560e1){var _0x57fae3=_0x3d1808;const _0x530285=this[_0x57fae3(0x3be)][_0x57fae3(0x3f0)](_0x5560e1);_0x530285&&(_0x530285['dispose'](),this[_0x57fae3(0x3be)][_0x57fae3(0x33a)](_0x5560e1));}['dispose'](){var _0x35a675=_0x3d1808;this[_0x35a675(0x3be)]['forEach'](_0x1c5354=>_0x1c5354[_0x35a675(0x508)]()),this[_0x35a675(0x3be)]['clear'](),this[_0x35a675(0x39a)]['complete']();}},_0x1065a7['MemberService']=_0x43c114([_0x24dea7(0x0,_0x5bafa4[_0x3d1808(0x443)]),_0x24dea7(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x3bc)]))],_0x1065a7['MemberService']);class _0x49b15c extends _0x5bafa4[_0x3d1808(0x40c)]{constructor(){var _0x56544e=_0x3d1808;super(...arguments),_0x3fc7c7(this,'_members',new Map()),_0x3fc7c7(this,'_members$',new _0x1a688c[(_0x56544e(0x1f8))](this['_members'])),_0x3fc7c7(this,_0x56544e(0x477),this[_0x56544e(0x30a)][_0x56544e(0x340)]());}[_0x3d1808(0x508)](){var _0x24fc68=_0x3d1808;this['_members'][_0x24fc68(0x334)]();}[_0x3d1808(0x3f9)](_0x2c80a4){var _0x479801=_0x3d1808;this['_members'][_0x479801(0x373)](_0x2c80a4[_0x479801(0x3e9)],_0x2c80a4),this[_0x479801(0x1d6)]();}[_0x3d1808(0x2cf)](_0x3b9e39){var _0xc21ef1=_0x3d1808;this['_members'][_0xc21ef1(0x33a)](_0x3b9e39);}[_0x3d1808(0x404)](_0x4d7fcb){var _0x2258e1=_0x3d1808;return this[_0x2258e1(0x282)]['get'](_0x4d7fcb);}[_0x3d1808(0x48d)](){var _0x2cf6dd=_0x3d1808;return Array[_0x2cf6dd(0x3d1)](this[_0x2cf6dd(0x282)][_0x2cf6dd(0x3fe)]());}[_0x3d1808(0x1d6)](){var _0x4e0f29=_0x3d1808;this[_0x4e0f29(0x30a)]['next'](this[_0x4e0f29(0x282)]);}}var _0x3e5910=Object[_0x3d1808(0x3cf)],_0x17fa29=(_0x5acc78,_0xb1f751,_0x222482,_0x223fdc)=>{for(var _0x34f0af=_0x223fdc>0x1?void 0x0:_0x223fdc?_0x3e5910(_0xb1f751,_0x222482):_0xb1f751,_0x457ce7=_0x5acc78['length']-0x1,_0x408c94;_0x457ce7>=0x0;_0x457ce7--)(_0x408c94=_0x5acc78[_0x457ce7])&&(_0x34f0af=_0x408c94(_0x34f0af)||_0x34f0af);return _0x34f0af;},_0x59de70=(_0x2b61b9,_0x21d2aa)=>(_0x4d57e6,_0x5296c6)=>_0x21d2aa(_0x4d57e6,_0x5296c6,_0x2b61b9),_0x4b7463=(_0x39956e=>(_0x39956e[_0x39956e[_0x3d1808(0x464)]=0x0]=_0x3d1808(0x464),_0x39956e[_0x39956e[_0x3d1808(0x522)]=0x1]=_0x3d1808(0x522),_0x39956e[_0x39956e[_0x3d1808(0x559)]=0x2]=_0x3d1808(0x559),_0x39956e[_0x39956e[_0x3d1808(0x2d4)]=0x3]=_0x3d1808(0x2d4),_0x39956e))(_0x4b7463||{});const _0x33f4b2={[_0x25b6a7[_0x3d1808(0x2fb)]]:_0x3d1808(0x3b7),[_0x25b6a7[_0x3d1808(0x565)]]:_0x3d1808(0x491),[_0x25b6a7[_0x3d1808(0x403)]]:_0x3d1808(0x467),[_0x25b6a7[_0x3d1808(0x297)]]:_0x3d1808(0x4a8),[_0x25b6a7[_0x3d1808(0x4b3)]]:_0x3d1808(0x201)};_0x1065a7[_0x3d1808(0x3cb)]=class extends _0x5bafa4[_0x3d1808(0x265)]{constructor(_0x16ffb8,_0x287e64,_0x12775f,_0xae7d76,_0x53c8c3,_0x55885b,_0x5a77c6,_0x139850){var _0x547f6f=_0x3d1808;super(),_0x3fc7c7(this,_0x547f6f(0x34a),new _0x1a688c[(_0x547f6f(0x1f8))](0x0)),_0x3fc7c7(this,'sessionStatus$',this[_0x547f6f(0x34a)][_0x547f6f(0x340)]()),_0x3fc7c7(this,_0x547f6f(0x4c4),new _0x1a688c[(_0x547f6f(0x546))]()),_0x3fc7c7(this,_0x547f6f(0x2a4),this[_0x547f6f(0x4c4)][_0x547f6f(0x340)]()),_0x3fc7c7(this,'_socket'),_0x3fc7c7(this,_0x547f6f(0x4dd)),_0x3fc7c7(this,_0x547f6f(0x428)),_0x3fc7c7(this,_0x547f6f(0x539),!0x1),_0x3fc7c7(this,_0x547f6f(0x302),null),(this[_0x547f6f(0x3e6)]=_0x16ffb8,this[_0x547f6f(0x4dc)]=_0x12775f,this[_0x547f6f(0x4ee)]=_0xae7d76,this[_0x547f6f(0x3e7)]=_0x53c8c3,this[_0x547f6f(0x55d)]=_0x55885b,this[_0x547f6f(0x387)]=_0x5a77c6,this[_0x547f6f(0x4e2)]=_0x139850,this[_0x547f6f(0x539)]=!!this[_0x547f6f(0x4e2)],_0x287e64[_0x547f6f(0x24d)](_0x1a688c['takeUntil'](this['dispose$']))['subscribe'](_0x497893=>{var _0x1c3b60=_0x547f6f,_0x23c953;typeof _0x497893>'u'||(this[_0x1c3b60(0x1d5)]=_0x497893,_0x497893?(this[_0x1c3b60(0x21f)](_0x497893),this['_socketMessageSubscription']=_0x497893[_0x1c3b60(0x3c8)][_0x1c3b60(0x239)](_0x2550af=>{var _0x372a45=_0x1c3b60;_0x2550af[_0x372a45(0x4ba)]===this[_0x372a45(0x3e6)]&&this[_0x372a45(0x45b)](_0x2550af);})):(this[_0x1c3b60(0x391)](),this['_sessionStatus$'][_0x1c3b60(0x543)](0x2),(_0x23c953=this[_0x1c3b60(0x4dd)])==null||_0x23c953[_0x1c3b60(0x31d)](),this[_0x1c3b60(0x4dd)]=null));}));}get[_0x3d1808(0x3b3)](){var _0x5d604c=_0x3d1808;return this[_0x5d604c(0x34a)][_0x5d604c(0x2e2)]();}[_0x3d1808(0x3a0)](){var _0x396748=_0x3d1808,_0x4d1080,_0x494cbe;return(_0x494cbe=(_0x4d1080=this[_0x396748(0x1d5)])==null?void 0x0:_0x4d1080[_0x396748(0x3e9)])!=null?_0x494cbe:null;}[_0x3d1808(0x508)](){var _0x31656d=_0x3d1808;super['dispose'](),this[_0x31656d(0x39e)][_0x31656d(0x543)](),this[_0x31656d(0x39e)][_0x31656d(0x1fa)]();}[_0x3d1808(0x41a)](){var _0x48af3e=_0x3d1808,_0x4ce2ef,_0x43c7bf;this['_throwTelemetryCollaborationNewChangeset'](),(_0x4ce2ef=this[_0x48af3e(0x1d5)])==null||_0x4ce2ef[_0x48af3e(0x2a8)]({'cmd':_0x46dd39['LEAVE'],'data':{'roomID':this['_unitID']}}),(_0x43c7bf=this[_0x48af3e(0x1d5)])==null||_0x43c7bf[_0x48af3e(0x41a)](),this[_0x48af3e(0x4c4)][_0x48af3e(0x1fa)](),this[_0x48af3e(0x34a)][_0x48af3e(0x1fa)](),this['dispose']();}[_0x3d1808(0x45b)](_0x25e338){var _0x27febc=_0x3d1808;_0x25e338['cmd']===_0x46dd39[_0x27febc(0x48a)]?this[_0x27febc(0x2f4)](_0x25e338):_0x25e338[_0x27febc(0x38d)]===_0x46dd39[_0x27febc(0x2dd)]&&this[_0x27febc(0x2ce)](_0x25e338);}[_0x3d1808(0x21f)](_0xe0532d){var _0x5b8492=_0x3d1808;this[_0x5b8492(0x34a)][_0x5b8492(0x543)](0x1),_0xe0532d['send']({'cmd':_0x46dd39[_0x5b8492(0x48a)],'routeKey':this[_0x5b8492(0x3e6)],'routeType':'','data':{'rooms':[{'roomID':this[_0x5b8492(0x3e6)]}]}});}[_0x3d1808(0x2f4)](_0xf553e4){var _0x39bcbd=_0x3d1808,_0x867854;if(_0xf553e4[_0x39bcbd(0x24b)]in _0x33f4b2){this[_0x39bcbd(0x387)][_0x39bcbd(0x3e2)]({'id':_0x38090c[_0x39bcbd(0x2ad)],'data':_0x33f4b2[_0xf553e4[_0x39bcbd(0x24b)]]}),this[_0x39bcbd(0x34a)][_0x39bcbd(0x543)](0x2);return;}this[_0x39bcbd(0x34a)][_0x39bcbd(0x543)](0x3);const _0x362aac=(_0x867854=_0xf553e4[_0x39bcbd(0x285)]['roomInfos'][this[_0x39bcbd(0x3e6)]])==null?void 0x0:_0x867854[_0x39bcbd(0x2a9)];_0x362aac&&_0x362aac[_0x39bcbd(0x27c)](_0xb051a8=>this[_0x39bcbd(0x3e7)]['updateMember'](this[_0x39bcbd(0x3e6)],_0xb051a8));}[_0x3d1808(0x2ce)](_0x156a86){var _0x2b94c9=_0x3d1808;try{const _0x4269da=_0x156a86[_0x2b94c9(0x285)];switch(_0x4269da[_0x2b94c9(0x3a4)]){case _0x3ab606[_0x2b94c9(0x260)][_0x2b94c9(0x400)]:this[_0x2b94c9(0x479)](_0x4269da),this[_0x2b94c9(0x4c4)]['next'](_0x4269da);break;case _0x3ab606[_0x2b94c9(0x260)]['USERS_LEAVE']:this[_0x2b94c9(0x498)](_0x4269da),this[_0x2b94c9(0x4c4)]['next'](_0x4269da);break;case _0x3ab606[_0x2b94c9(0x260)][_0x2b94c9(0x2ca)]:case _0x3ab606[_0x2b94c9(0x260)][_0x2b94c9(0x242)]:this['_stopTelemetryCollaborationNewChangeset'](),this[_0x2b94c9(0x45a)](),this['_event$'][_0x2b94c9(0x543)](_0x4269da);break;case _0x3ab606[_0x2b94c9(0x260)][_0x2b94c9(0x465)]:this[_0x2b94c9(0x4dc)]['error'](_0x2b94c9(0x39d)+JSON['stringify'](_0x4269da)),this[_0x2b94c9(0x4c4)][_0x2b94c9(0x543)](_0x4269da);break;case _0x3ab606[_0x2b94c9(0x260)][_0x2b94c9(0x415)]:this[_0x2b94c9(0x55d)][_0x2b94c9(0x3ac)](_0x4269da[_0x2b94c9(0x285)]),this[_0x2b94c9(0x4c4)][_0x2b94c9(0x543)](_0x4269da);break;default:this[_0x2b94c9(0x4c4)][_0x2b94c9(0x543)](_0x4269da);}}catch(_0x1a1838){this[_0x2b94c9(0x4dc)][_0x2b94c9(0x3f5)](_0x1a1838,_0x156a86);}}['_onUserJoin'](_0xfe83e1){var _0x40716b=_0x3d1808;this['_memberService']['updateMember'](this[_0x40716b(0x3e6)],_0xfe83e1[_0x40716b(0x285)]);}[_0x3d1808(0x498)](_0x55a20f){var _0x5bb9f3=_0x3d1808;this[_0x5bb9f3(0x3e7)][_0x5bb9f3(0x2cf)](this[_0x5bb9f3(0x3e6)],_0x55a20f[_0x5bb9f3(0x285)]['memberID']);}async[_0x3d1808(0x2a8)](_0x16763,_0x5b8d9a){var _0x2a1a61=_0x3d1808;if(this[_0x2a1a61(0x3b3)]!==0x3||!this[_0x2a1a61(0x1d5)])throw new Error(_0x2a1a61(0x28b));try{_0x16763[_0x2a1a61(0x3a4)]===_0x3ab606['CollaborationEvent'][_0x2a1a61(0x3ca)]&&(this['_scheduleCollaborationTimeoutTimer'](),this[_0x2a1a61(0x4e0)](_0x16763)),this[_0x2a1a61(0x1d5)]['send']({'cmd':_0x46dd39['INGEST'],'routeKey':_0x5b8d9a,'routeType':'','data':_0x16763});}catch(_0x4a0d9d){this[_0x2a1a61(0x4dc)][_0x2a1a61(0x3f5)](_0x4a0d9d);}}['_scheduleCollaborationTimeoutTimer'](){var _0x5cc105=_0x3d1808,_0x4351b3;this['_collaborationTimeoutTimer']=setTimeout(()=>{var _0x5dcb52=_0x58ee;this[_0x5dcb52(0x428)]=null,this[_0x5dcb52(0x387)][_0x5dcb52(0x3e2)]({'id':_0x38090c[_0x5dcb52(0x567)]});},(_0x4351b3=this[_0x5cc105(0x4ee)][_0x5cc105(0x38b)](_0x3d06ad))!=null?_0x4351b3:0x4e20);}[_0x3d1808(0x45a)](){var _0x26843e=_0x3d1808;this[_0x26843e(0x428)]&&(clearTimeout(this[_0x26843e(0x428)]),this[_0x26843e(0x428)]=null);}['_startTelemetryCollaborationNewChangeset'](_0x192ba7){var _0x5f0b73=_0x3d1808;if(!this[_0x5f0b73(0x539)])return;const {data:_0x4f99ba}=_0x192ba7,{unitID:_0x2d13b2,changeset:_0x51faea}=_0x4f99ba,{mutations:_0x49e18c,type:_0x474a1a}=_0x51faea;this[_0x5f0b73(0x302)]={'unitId':_0x2d13b2,'type':_0x474a1a,'startTime':performance[_0x5f0b73(0x424)](),'stopTime':0x0,'duration':0x0,'size':_0x41beff(_0x49e18c)};}[_0x3d1808(0x279)](){var _0x279cfd=_0x3d1808;if(this[_0x279cfd(0x539)]){if(!this['_telemetryInfo']){this[_0x279cfd(0x4dc)][_0x279cfd(0x3f5)](_0x279cfd(0x2bd),_0x279cfd(0x4ea));return;}this[_0x279cfd(0x302)]['stopTime']=performance['now'](),this[_0x279cfd(0x302)][_0x279cfd(0x529)]=this[_0x279cfd(0x302)][_0x279cfd(0x2e3)]-this[_0x279cfd(0x302)][_0x279cfd(0x2ff)],this[_0x279cfd(0x4e2)]['capture'](_0xf9a9b0,this['_telemetryInfo']),this[_0x279cfd(0x302)]=null;}}[_0x3d1808(0x391)](){var _0x28f5d2=_0x3d1808;this[_0x28f5d2(0x302)]=null;}},_0x1065a7[_0x3d1808(0x3cb)]=_0x17fa29([_0x59de70(0x2,_0x5bafa4[_0x3d1808(0x528)]),_0x59de70(0x3,_0x5bafa4[_0x3d1808(0x34c)]),_0x59de70(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x1065a7[_0x3d1808(0x41b)])),_0x59de70(0x5,_0x5bafa4[_0x3d1808(0x317)](_0x178a41)),_0x59de70(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x10cfe4)),_0x59de70(0x7,_0x5bafa4[_0x3d1808(0x4fa)](_0x7d7753['ITelemetryService']))],_0x1065a7[_0x3d1808(0x3cb)]);const _0xd8e545=_0x5bafa4[_0x3d1808(0x433)](_0x3d1808(0x376));function _0x2d48c6(_0x78f954){var _0x419a35=_0x3d1808;return _0x419a35(0x48c)+_0x78f954;}var _0x111d94=Object['getOwnPropertyDescriptor'],_0x500906=(_0x30e63e,_0x40f67b,_0x624ece,_0x44cd65)=>{for(var _0x980fb7=_0x44cd65>0x1?void 0x0:_0x44cd65?_0x111d94(_0x40f67b,_0x624ece):_0x40f67b,_0x45244a=_0x30e63e['length']-0x1,_0x1bd589;_0x45244a>=0x0;_0x45244a--)(_0x1bd589=_0x30e63e[_0x45244a])&&(_0x980fb7=_0x1bd589(_0x980fb7)||_0x980fb7);return _0x980fb7;},_0x2009dd=(_0x34f9ed,_0x46ed96)=>(_0x343cbb,_0x38b2eb)=>_0x46ed96(_0x343cbb,_0x38b2eb,_0x34f9ed);function _0x395ea7(_0x37ed0e){var _0x418e54=_0x3d1808;const {unitID:_0x128212,mutations:_0x4c8654}=_0x37ed0e;return{'unitId':_0x128212,'subUnitId':_0x4c8654[_0x418e54(0x3c5)]>0x0?_0x4c8654[0x0]['params'][_0x418e54(0x4d8)]:null};}_0x1065a7[_0x3d1808(0x1f1)]=class{constructor(_0xc8322c,_0x5b383e,_0x5dbc65){var _0x858967=_0x3d1808;this[_0x858967(0x50f)]=_0xc8322c,this[_0x858967(0x51f)]=_0x5b383e,this['_instanceService']=_0x5dbc65;}[_0x3d1808(0x44d)](_0x2fdc6b){var _0x56425c=_0x3d1808,_0x7ecc84,_0x37ece1,_0x2e6db5,_0x483138;const _0x5cdd5f=this[_0x56425c(0x50f)][_0x56425c(0x3f0)](_0x1c5262[_0x56425c(0x448)]),{unitId:_0x4ac392,subUnitId:_0x4a711e}=_0x395ea7(_0x2fdc6b),_0x5ee0b6=_0x5cdd5f==null?void 0x0:_0x5cdd5f['getWorkbookSelections'](_0x4ac392)[_0x56425c(0x361)](),_0x4d4ba1=(_0x37ece1=(_0x7ecc84=this['_instanceService']['getUnit'](_0x4ac392))==null?void 0x0:_0x7ecc84[_0x56425c(0x2c4)]())==null?void 0x0:_0x37ece1[_0x56425c(0x2f1)]();if(_0x5ee0b6[_0x56425c(0x3c5)]===0x0||!_0x4ac392||!_0x4a711e)return;const _0x2a5bb9=[{'id':_0x1c5262[_0x56425c(0x4f1)]['id'],'params':{'unitId':_0x4ac392,'subUnitId':_0x4d4ba1,'selections':_0x5bafa4[_0x56425c(0x2bb)][_0x56425c(0x299)](_0x5ee0b6)}}],_0x562447=this[_0x56425c(0x51f)][_0x56425c(0x441)](_0x2fdc6b,_0x2a5bb9);if(!_0x3ab606[_0x56425c(0x37b)](_0x562447))throw _0x562447['error'];const _0x5785a9=(_0x483138=(_0x2e6db5=_0x562447['m2Prime'][0x0])==null?void 0x0:_0x2e6db5['params'])==null?void 0x0:_0x483138['selections'];if(Array[_0x56425c(0x4f2)](_0x5785a9)&&_0x5785a9[_0x56425c(0x3c5)]){if(_0x5785a9[_0x56425c(0x3c5)]===_0x2a5bb9[0x0][_0x56425c(0x21c)][_0x56425c(0x4ff)][_0x56425c(0x3c5)]&&_0x5785a9[_0x56425c(0x397)]((_0x508a77,_0x2c032f)=>_0x5bafa4[_0x56425c(0x2c6)][_0x56425c(0x42b)](_0x508a77[_0x56425c(0x2f9)],_0x2a5bb9[0x0][_0x56425c(0x21c)][_0x56425c(0x4ff)][_0x2c032f][_0x56425c(0x2f9)])))return;this[_0x56425c(0x50f)][_0x56425c(0x3f0)](_0x5bafa4[_0x56425c(0x3fc)])['executeCommand'](_0x1c5262['SetSelectionsOperation']['id'],{'unitId':_0x4ac392,'subUnitId':_0x4d4ba1,'selections':_0x5785a9});}}},_0x1065a7['SheetTransformSelectionsService']=_0x500906([_0x2009dd(0x0,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4['Injector'])),_0x2009dd(0x1,_0x3ab606[_0x3d1808(0x269)]),_0x2009dd(0x2,_0x5bafa4[_0x3d1808(0x443)])],_0x1065a7[_0x3d1808(0x1f1)]);const _0x175519=_0x5bafa4[_0x3d1808(0x433)](_0x3d1808(0x35d));var _0x166ac9=(_0x5f2920=>(_0x5f2920[_0x5f2920[_0x3d1808(0x388)]=0x0]=_0x3d1808(0x388),_0x5f2920[_0x5f2920[_0x3d1808(0x3df)]=0x1]=_0x3d1808(0x3df),_0x5f2920))(_0x166ac9||{});const _0x755dce=_0x3d1808(0x393),_0x38b249={};function _0x59b023(_0x233c54){var _0x4c9b47=_0x3d1808,_0x955910;return!!((_0x955910=_0x233c54[_0x4c9b47(0x21c)])!=null&&_0x955910[_0x4c9b47(0x4fc)]);}const _0x2e5f24=new Set([_0x1c5262[_0x3d1808(0x283)]['id']]);function _0x3cb94a(_0x4ab861,_0x348618,_0xda847a,_0x40adaa,_0x42be28){var _0x3cda63=_0x3d1808,_0x180e0e,_0x22b677,_0x892ce0,_0x1858ba;const _0x489664=[];for(const _0x22b0e1 of _0x4ab861){if(_0x2e5f24['has'](_0x22b0e1['id'])){if(_0x489664['length']>0x0)break;_0x489664['push'](_0x22b0e1);break;}if(_0x59b023(_0x22b0e1)){if(_0x489664['length']>0x0)break;_0x489664[_0x3cda63(0x381)](_0x22b0e1);break;}_0x489664[_0x3cda63(0x381)](_0x22b0e1);}const _0x25a193=(_0x22b677=(_0x180e0e=_0x42be28['getCurrentUser']())==null?void 0x0:_0x180e0e[_0x3cda63(0x307)])!=null?_0x22b677:'unknown',_0x3449d7=(_0x1858ba=(_0x892ce0=_0x42be28['getCurrentUser']())==null?void 0x0:_0x892ce0[_0x3cda63(0x3e9)])!=null?_0x1858ba:_0x3cda63(0x298);return{'changeset':{'unitID':_0x348618,'type':_0x3ab606[_0x3cda63(0x525)](_0xda847a[_0x3cda63(0x3c6)](_0x348618)),'baseRev':_0x40adaa[_0x3cda63(0x417)](_0x348618),'revision':0x0,'userID':_0x25a193,'memberID':_0x3449d7,'mutations':_0x489664},'pendingMutations':_0x4ab861[_0x3cda63(0x3f8)](_0x489664[_0x3cda63(0x3c5)])};}function _0x2ade53(_0x590e7e,_0x3aef97,_0x4a6a1f,_0x1aa7b7,_0x4b2653){var _0x26b803=_0x3d1808,_0x282600,_0x2b1bb2,_0x1603a2,_0x368468;const _0x22ad2f=[_0x590e7e['reduce']((_0x3e1ece,_0x2966da)=>{var _0x4a0e99=_0x58ee,_0x2ef0ea;const {id:_0x4b21bb}=_0x3e1ece,{id:_0x5dacab,type:_0x5f2f28}=_0x2966da,_0x38c747=(_0x2ef0ea=_0x3e1ece[_0x4a0e99(0x21c)])!=null?_0x2ef0ea:{'actions':null},_0x3d811c=_0x2966da[_0x4a0e99(0x21c)];if(_0x4b21bb&&_0x4b21bb!==_0x5dacab)throw new Error(_0x4a0e99(0x248)+_0x4b21bb+_0x4a0e99(0x497)+_0x5dacab+'.');return{..._0x3e1ece,'id':_0x5dacab,'type':_0x5f2f28,'params':{'unitId':_0x3d811c[_0x4a0e99(0x48f)],'textRanges':_0x3d811c['textRanges'],'actions':_0x5bafa4['JSONX']['compose'](_0x38c747['actions'],_0x3d811c[_0x4a0e99(0x37d)])}};},{})],_0x4f92b0=(_0x2b1bb2=(_0x282600=_0x4b2653[_0x26b803(0x3a3)]())==null?void 0x0:_0x282600[_0x26b803(0x307)])!=null?_0x2b1bb2:_0x26b803(0x298),_0x24db61=(_0x368468=(_0x1603a2=_0x4b2653[_0x26b803(0x3a3)]())==null?void 0x0:_0x1603a2['memberID'])!=null?_0x368468:_0x26b803(0x298);return{'changeset':{'unitID':_0x3aef97,'type':_0x3ab606['mapDocumentTypeToUniverType'](_0x4a6a1f[_0x26b803(0x3c6)](_0x3aef97)),'baseRev':_0x1aa7b7[_0x26b803(0x417)](_0x3aef97),'revision':0x0,'userID':_0x4f92b0,'memberID':_0x24db61,'mutations':_0x22ad2f},'pendingMutations':[]};}function _0x16a698(_0x16cee3,_0x414733){var _0x10b4f2=_0x3d1808;const _0x74427b=new _0x1a688c[(_0x10b4f2(0x4a0))](0x1);return setTimeout(()=>_0x74427b[_0x10b4f2(0x543)](_0x414733),_0x16cee3),_0x74427b[_0x10b4f2(0x340)]()[_0x10b4f2(0x24d)](_0x1a688c[_0x10b4f2(0x390)](0x1));}var _0x12cfd6=Object[_0x3d1808(0x3cf)],_0x456781=(_0x7a948,_0x2108e7,_0x4e52bf,_0x3f268b)=>{var _0x52a746=_0x3d1808;for(var _0x3a0588=_0x3f268b>0x1?void 0x0:_0x3f268b?_0x12cfd6(_0x2108e7,_0x4e52bf):_0x2108e7,_0x3a2c8d=_0x7a948[_0x52a746(0x3c5)]-0x1,_0x121460;_0x3a2c8d>=0x0;_0x3a2c8d--)(_0x121460=_0x7a948[_0x3a2c8d])&&(_0x3a0588=_0x121460(_0x3a0588)||_0x3a0588);return _0x3a0588;},_0xa6ca36=(_0x3e80bd,_0x341004)=>(_0x206dd5,_0x3f5884)=>_0x341004(_0x206dd5,_0x3f5884,_0x3e80bd),_0x293214=(_0x210552=>(_0x210552[_0x3d1808(0x2f8)]=_0x3d1808(0x505),_0x210552['SYNCED']=_0x3d1808(0x4b4),_0x210552[_0x3d1808(0x552)]=_0x3d1808(0x411),_0x210552[_0x3d1808(0x281)]='awaiting',_0x210552[_0x3d1808(0x458)]=_0x3d1808(0x225),_0x210552[_0x3d1808(0x2fd)]=_0x3d1808(0x408),_0x210552['CONFLICT']=_0x3d1808(0x445),_0x210552[_0x3d1808(0x559)]=_0x3d1808(0x459),_0x210552))(_0x293214||{});const _0x12c628=0xea60;class _0x312db3{constructor(_0x245ca1,_0x763950,_0x47192f,_0x5a2236,_0x4adad2,_0x551de4,_0x12f11c,_0x5e31ff,_0x41157a){var _0x294c5a=_0x3d1808;_0x3fc7c7(this,'_awaitingChangeset',null),_0x3fc7c7(this,_0x294c5a(0x3ff),[]),(this[_0x294c5a(0x345)]=_0x245ca1,this[_0x294c5a(0x436)]=_0x763950,this[_0x294c5a(0x526)]=_0x4adad2,this['_commandService']=_0x551de4,this['_undoRedoService']=_0x12f11c,this['_revisionService']=_0x5e31ff,this[_0x294c5a(0x4b5)]=_0x41157a,this[_0x294c5a(0x37e)]=_0x47192f,this[_0x294c5a(0x3ff)]=_0x5a2236);}[_0x3d1808(0x21b)](_0x3c5a9c){var _0x52540c=_0x3d1808;const _0x398723=this[_0x52540c(0x29f)][_0x52540c(0x417)](this[_0x52540c(0x345)]);return _0x3c5a9c['revision']>_0x398723+0x1?(this[_0x52540c(0x526)]['onMissingChangesets']({'from':_0x398723,'to':_0x3c5a9c[_0x52540c(0x42d)]-0x1}),!0x0):!0x1;}[_0x3d1808(0x343)](_0x10e3ea){var _0x55de7a=_0x3d1808;this[_0x55de7a(0x569)][_0x55de7a(0x426)](this[_0x55de7a(0x345)],_0x10e3ea);}['_transformSelections'](_0xa42b79){var _0x2f289e=_0x3d1808,_0x15423,_0x4de9b8;(_0x4de9b8=(_0x15423=this[_0x2f289e(0x526)])[_0x2f289e(0x398)])==null||_0x4de9b8[_0x2f289e(0x37a)](_0x15423,_0xa42b79);}['_transformIMECache'](_0x3abc99){var _0x254df0=_0x3d1808,_0x312366,_0x10c74c;return(_0x10c74c=(_0x312366=this['_handler'])[_0x254df0(0x39b)])==null?void 0x0:_0x10c74c[_0x254df0(0x37a)](_0x312366,_0x3abc99);}[_0x3d1808(0x43b)](_0x441e01){var _0x1261f1=_0x3d1808,_0x18346c,_0x243005;return(_0x243005=(_0x18346c=this[_0x1261f1(0x526)])[_0x1261f1(0x548)])==null?void 0x0:_0x243005['call'](_0x18346c,_0x441e01);}[_0x3d1808(0x493)](_0x415620){var _0x247aaa=_0x3d1808,_0x134aed,_0x404b4e,_0x4360e6;return(_0x4360e6=(_0x404b4e=(_0x134aed=this['_handler'])['onTransformRemoteChangesetByIMECache'])==null?void 0x0:_0x404b4e[_0x247aaa(0x37a)](_0x134aed,_0x415620))!=null?_0x4360e6:_0x415620;}[_0x3d1808(0x26d)](_0x3d6b4c){var _0x25052c=_0x3d1808,_0x16d3a5,_0x50be0a,_0xe9414c;return(_0xe9414c=(_0x50be0a=(_0x16d3a5=this['_handler'])[_0x25052c(0x3ef)])==null?void 0x0:_0x50be0a[_0x25052c(0x37a)](_0x16d3a5,_0x3d6b4c))!=null?_0xe9414c:_0x3d6b4c;}[_0x3d1808(0x4ae)](_0x3e95a0){var _0x30e655=_0x3d1808,_0x61f7e5,_0x56a89d;if(this['type']===_0x32e542[_0x30e655(0x25d)]){const {unitID:_0x48766e,mutations:_0x660b67,memberID:_0x34167a}=_0x3e95a0,_0x46429d=_0x660b67[_0x30e655(0x3c5)]>0x0?_0x660b67[0x0]['params'][_0x30e655(0x249)]:[];Array[_0x30e655(0x4f2)](_0x46429d)&&_0x46429d[_0x30e655(0x3c5)]>0x0&&((_0x56a89d=(_0x61f7e5=this['_handler'])[_0x30e655(0x55a)])==null||_0x56a89d['call'](_0x61f7e5,{'unitID':_0x48766e,'memberID':_0x34167a,'textRanges':_0x46429d}));}}[_0x3d1808(0x523)](){var _0x543cc4=_0x3d1808,_0xbf0321;(_0xbf0321=this[_0x543cc4(0x4b5)])==null||_0xbf0321[_0x543cc4(0x25e)](this[_0x543cc4(0x345)],this['type'],this[_0x543cc4(0x37e)],this[_0x543cc4(0x3ff)]);}[_0x3d1808(0x347)](){var _0x26dca0=_0x3d1808;return this[_0x26dca0(0x29f)][_0x26dca0(0x417)](this['unitID']);}[_0x3d1808(0x555)](){var _0x51b379=_0x3d1808;this[_0x51b379(0x29f)][_0x51b379(0x54a)](this[_0x51b379(0x345)]);}['_executeRemoteChangeset'](_0x31a721){var _0xbef9f4=_0x3d1808,_0x27600e;let _0x262f02=this[_0xbef9f4(0x493)](_0x31a721);_0x262f02=this['_transformRemoteChangesetByStateCache'](_0x262f02);const _0x579b25=_0x5bafa4[_0xbef9f4(0x258)](_0x262f02[_0xbef9f4(0x4f4)],this[_0xbef9f4(0x538)],{'fromCollab':!0x0});if(!_0x579b25['result'])throw _0x579b25[_0xbef9f4(0x3f5)]instanceof Error?_0x579b25[_0xbef9f4(0x3f5)]:new Error((_0x27600e=_0x579b25['error'])!=null?_0x27600e:_0xbef9f4(0x561));this['_transformIMECache'](_0x262f02),this[_0xbef9f4(0x43b)](_0x262f02),this[_0xbef9f4(0x343)](_0x31a721),this['_transformSelections'](_0x262f02),this['_syncEditingCollabCursor'](_0x262f02),this['_incrementRevisionNumber']();}}_0x1065a7[_0x3d1808(0x363)]=class extends _0x312db3{constructor(_0x345bad,_0x2061eb,_0x4e82dd,_0x1386d1,_0xfc5471,_0x2edb93,_0x1e59a6,_0x3cc1c8,_0x1b4fa4,_0x115390){var _0x291da1=_0x3d1808;super(_0x345bad,_0x2061eb,null,[],_0x4e82dd,_0x1e59a6,_0x2edb93,_0x1386d1,_0x115390),_0x3fc7c7(this,_0x291da1(0x37c),_0x291da1(0x4b4)),(this[_0x291da1(0x50f)]=_0xfc5471,this[_0x291da1(0x4dc)]=_0x3cc1c8,this[_0x291da1(0x51f)]=_0x1b4fa4,this[_0x291da1(0x3d9)]=_0x115390);}[_0x3d1808(0x33b)](_0xf4deab){var _0x17bb45=_0x3d1808;const _0x308134=this[_0x17bb45(0x50f)]['createInstance'](_0x1065a7[_0x17bb45(0x271)],this[_0x17bb45(0x345)],this[_0x17bb45(0x436)],[_0xf4deab],this[_0x17bb45(0x526)]);return _0x308134['_schedule'](),_0x308134[_0x17bb45(0x523)](),_0x308134;}[_0x3d1808(0x519)](_0x8bce81){var _0x1d624c=_0x3d1808;if(this[_0x1d624c(0x21b)](_0x8bce81))return this['_injector']['createInstance'](_0x1065a7[_0x1d624c(0x49d)],this[_0x1d624c(0x345)],this['type'],null,[],null,[_0x8bce81],this[_0x1d624c(0x526)]);try{const _0x2a1003=this[_0x1d624c(0x51f)][_0x1d624c(0x441)](_0x8bce81,[_0x3ab606[_0x1d624c(0x462)]]);if(_0x3ab606['isTransformMutationsWithChangesetSuccess'](_0x2a1003)){const {c1Prime:_0x3730db}=_0x2a1003;return this[_0x1d624c(0x510)](_0x3730db),this;}throw _0x2a1003['error'];}catch(_0xea505a){return this[_0x1d624c(0x4dc)][_0x1d624c(0x3f5)](_0xea505a),this[_0x1d624c(0x4f5)](!0x1);}}[_0x3d1808(0x4f5)](_0x5b7727){var _0x23cbc0=_0x3d1808;return this[_0x23cbc0(0x50f)][_0x23cbc0(0x3af)](_0x1065a7['ConflictState'],this['unitID'],this[_0x23cbc0(0x436)],null,[],this[_0x23cbc0(0x526)],_0x5b7727);}[_0x3d1808(0x23f)](){var _0x13e18f=_0x3d1808;throw new Error(_0x13e18f(0x4ed));}[_0x3d1808(0x414)](){var _0x135133=_0x3d1808;throw new Error(_0x135133(0x3ea));}['onRemoteRetry'](){return this;}[_0x3d1808(0x2f3)](){var _0x38d59a=_0x3d1808;return this[_0x38d59a(0x50f)][_0x38d59a(0x3af)](_0x1065a7['OfflineState'],this[_0x38d59a(0x345)],this['type'],null,[],this['_handler']);}[_0x3d1808(0x35c)](){return this;}['resend'](){var _0x451615=_0x3d1808;throw new Error(_0x451615(0x3ee));}['fetchMiss'](){var _0x1e9d1f=_0x3d1808;const _0x51104a=this[_0x1e9d1f(0x29f)][_0x1e9d1f(0x417)](this['unitID']);return this[_0x1e9d1f(0x526)]['onMissingChangesets']({'from':_0x51104a,'to':0x0}),this[_0x1e9d1f(0x50f)][_0x1e9d1f(0x3af)](_0x1065a7[_0x1e9d1f(0x49d)],this[_0x1e9d1f(0x345)],this[_0x1e9d1f(0x436)],null,[],null,[],this[_0x1e9d1f(0x526)]);}},_0x1065a7[_0x3d1808(0x363)]=_0x456781([_0xa6ca36(0x3,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x2ef)])),_0xa6ca36(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0xa6ca36(0x5,_0x5bafa4['IUndoRedoService']),_0xa6ca36(0x6,_0x5bafa4[_0x3d1808(0x3fc)]),_0xa6ca36(0x7,_0x5bafa4[_0x3d1808(0x528)]),_0xa6ca36(0x8,_0x3ab606['ITransformService']),_0xa6ca36(0x9,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7['SyncedState']),_0x1065a7['PendingState']=class extends _0x312db3{constructor(_0x42dbf1,_0x4eeb55,_0x16bdff,_0x4c5e2c,_0x3a7ee6,_0x35c6b6,_0x2e68d4,_0x4b2b8d,_0x1846f1,_0x1e62cc,_0x5cac2b,_0x54752a,_0x500244,_0x2a7238){var _0x59e87c=_0x3d1808;super(_0x42dbf1,_0x4eeb55,null,_0x16bdff,_0x4c5e2c,_0x1846f1,_0x500244,_0x35c6b6,_0x2a7238),_0x3fc7c7(this,_0x59e87c(0x37c),_0x59e87c(0x411)),_0x3fc7c7(this,_0x59e87c(0x29e),null),_0x3fc7c7(this,_0x59e87c(0x385),null),(this[_0x59e87c(0x50f)]=_0x3a7ee6,this[_0x59e87c(0x3e7)]=_0x2e68d4,this['_logService']=_0x4b2b8d,this['_configService']=_0x1e62cc,this['_transformService']=_0x5cac2b,this[_0x59e87c(0x4b8)]=_0x54752a);}[_0x3d1808(0x33b)](_0x581c9d){var _0x15e2c9=_0x3d1808;return this['_pendingMutations']['push'](_0x581c9d),this[_0x15e2c9(0x523)](),this;}['onRemoteChangeset'](_0x73cc2f){var _0x2d160c=_0x3d1808;if(this[_0x2d160c(0x21b)](_0x73cc2f))return this['_clearScheduledTask'](),this['_injector'][_0x2d160c(0x3af)](_0x1065a7[_0x2d160c(0x49d)],this[_0x2d160c(0x345)],this[_0x2d160c(0x436)],null,this[_0x2d160c(0x3ff)],null,[_0x73cc2f],this[_0x2d160c(0x526)]);try{const _0x1ccabb=this[_0x2d160c(0x51f)][_0x2d160c(0x441)](_0x73cc2f,this[_0x2d160c(0x3ff)]);if(_0x3ab606[_0x2d160c(0x37b)](_0x1ccabb)){const {c1Prime:_0x4a84dd,m2Prime:_0x4f037e}=_0x1ccabb;this[_0x2d160c(0x510)](_0x4a84dd);const _0x44f30c=this['_injector'][_0x2d160c(0x3af)](_0x1065a7['PendingState'],this[_0x2d160c(0x345)],this[_0x2d160c(0x436)],_0x4f037e,this[_0x2d160c(0x526)]);this['_clearScheduledTask']();const _0x4ba5e4=new Date()[_0x2d160c(0x3fd)](),_0x27bb7e=this[_0x2d160c(0x29e)]?Math[_0x2d160c(0x554)](this[_0x2d160c(0x29e)]-_0x4ba5e4,0x0):this[_0x2d160c(0x427)]();return _0x44f30c[_0x2d160c(0x4be)](_0x27bb7e),_0x44f30c;}throw _0x1ccabb[_0x2d160c(0x3f5)];}catch(_0x36303c){return this['_logService'][_0x2d160c(0x3f5)](_0x36303c),this['_onConflict'](!0x1);}}[_0x3d1808(0x23f)](){throw new Error('[PendingState]:\x20received\x20acknowledgement.');}[_0x3d1808(0x414)](){var _0x39ba98=_0x3d1808;throw new Error(_0x39ba98(0x2e0));}['onRemoteRetry'](){return this;}['toggleOffline'](){var _0x4cd8d7=_0x3d1808;return this[_0x4cd8d7(0x33c)](),this[_0x4cd8d7(0x50f)][_0x4cd8d7(0x3af)](_0x1065a7[_0x4cd8d7(0x423)],this[_0x4cd8d7(0x345)],this[_0x4cd8d7(0x436)],null,this['_pendingMutations'],this[_0x4cd8d7(0x526)]);}[_0x3d1808(0x35c)](){return this;}[_0x3d1808(0x4be)](_0x543fdd){var _0xb2c738=_0x3d1808;const _0x4d9fab=_0x543fdd!=null?_0x543fdd:this[_0xb2c738(0x427)]();this[_0xb2c738(0x29e)]=new Date()[_0xb2c738(0x3fd)]()+_0x4d9fab,this[_0xb2c738(0x385)]=setTimeout(()=>{var _0x3c07f3=_0xb2c738;this[_0x3c07f3(0x33c)]();let _0x2368fe=null;switch(this['type']){case _0x32e542['UNIVER_SHEET']:{_0x2368fe=_0x3cb94a(this[_0x3c07f3(0x3ff)],this[_0x3c07f3(0x345)],this[_0x3c07f3(0x4b8)],this[_0x3c07f3(0x29f)],this[_0x3c07f3(0x3e7)]);break;}case _0x32e542[_0x3c07f3(0x25d)]:{this['_pendingMutations'][_0x3c07f3(0x397)](_0x4480cd=>_0x4480cd['id']===_0x460538[_0x3c07f3(0x4a6)]['id'])?_0x2368fe=_0x2ade53(this[_0x3c07f3(0x3ff)],this['unitID'],this[_0x3c07f3(0x4b8)],this[_0x3c07f3(0x29f)],this['_memberService']):_0x2368fe=_0x3cb94a(this[_0x3c07f3(0x3ff)],this['unitID'],this['_univerInstanceService'],this[_0x3c07f3(0x29f)],this[_0x3c07f3(0x3e7)]);break;}default:throw new Error('[PendingState]:\x20unhandled\x20univer\x20type:\x20'+this[_0x3c07f3(0x436)]+_0x3c07f3(0x3f2));}const {changeset:_0x46f530,pendingMutations:_0x8e9810}=_0x2368fe;this[_0x3c07f3(0x526)][_0x3c07f3(0x4b2)](_0x46f530);const _0x255880=_0x8e9810[_0x3c07f3(0x3c5)]?this[_0x3c07f3(0x50f)][_0x3c07f3(0x3af)](_0x1065a7[_0x3c07f3(0x446)],this[_0x3c07f3(0x345)],this[_0x3c07f3(0x436)],_0x46f530,_0x8e9810,this['_handler'],void 0x0):this[_0x3c07f3(0x50f)][_0x3c07f3(0x3af)](_0x1065a7[_0x3c07f3(0x517)],this[_0x3c07f3(0x345)],this['type'],_0x46f530,this[_0x3c07f3(0x526)]);_0x255880[_0x3c07f3(0x523)](),this[_0x3c07f3(0x526)][_0x3c07f3(0x2c8)](this,_0x255880);},_0x4d9fab);}[_0x3d1808(0x427)](){var _0xdbe69=_0x3d1808,_0x476a08;const _0x22ac46=this[_0xdbe69(0x4ee)][_0xdbe69(0x38b)](_0x755dce);return(_0x476a08=_0x22ac46==null?void 0x0:_0x22ac46[_0xdbe69(0x486)])!=null?_0x476a08:0x7d0;}[_0x3d1808(0x532)](){throw new Error('[PendingState]:\x20invalid\x20calling\x20to\x20`resend`.');}['_clearScheduledTask'](){var _0xcf3a37=_0x3d1808;this[_0xcf3a37(0x385)]!=null&&(clearTimeout(this[_0xcf3a37(0x385)]),this[_0xcf3a37(0x385)]=null);}[_0x3d1808(0x4f5)](_0x341ae0){var _0x3089e9=_0x3d1808;return this['_clearScheduledTask'](),this[_0x3089e9(0x50f)][_0x3089e9(0x3af)](_0x1065a7[_0x3089e9(0x44f)],this[_0x3089e9(0x345)],this[_0x3089e9(0x436)],null,this[_0x3089e9(0x3ff)],this[_0x3089e9(0x526)],_0x341ae0);}},_0x1065a7[_0x3d1808(0x271)]=_0x456781([_0xa6ca36(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0xa6ca36(0x5,_0x5bafa4['Inject'](_0x3ab606['RevisionService'])),_0xa6ca36(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x1065a7[_0x3d1808(0x41b)])),_0xa6ca36(0x7,_0x5bafa4[_0x3d1808(0x528)]),_0xa6ca36(0x8,_0x5bafa4[_0x3d1808(0x3fc)]),_0xa6ca36(0x9,_0x5bafa4[_0x3d1808(0x34c)]),_0xa6ca36(0xa,_0x3ab606['ITransformService']),_0xa6ca36(0xb,_0x5bafa4[_0x3d1808(0x443)]),_0xa6ca36(0xc,_0x5bafa4[_0x3d1808(0x407)]),_0xa6ca36(0xd,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7[_0x3d1808(0x271)]),_0x1065a7[_0x3d1808(0x517)]=class extends _0x312db3{constructor(_0x305bba,_0x3c4585,_0x3698ee,_0x59d60d,_0x2d1161,_0x5476f3,_0x42f8f4,_0x4c0d4d,_0x490d8e,_0x871e87,_0x584e38){var _0x1dfb21=_0x3d1808;super(_0x305bba,_0x3c4585,_0x3698ee,[],_0x59d60d,_0x42f8f4,_0x871e87,_0x5476f3,_0x584e38),_0x3fc7c7(this,_0x1dfb21(0x37c),_0x1dfb21(0x4aa)),_0x3fc7c7(this,_0x1dfb21(0x2d9),0x0),_0x3fc7c7(this,_0x1dfb21(0x442)),_0x3fc7c7(this,_0x1dfb21(0x32f)),(this['_injector']=_0x2d1161,this['_logService']=_0x4c0d4d,this[_0x1dfb21(0x51f)]=_0x490d8e);}[_0x3d1808(0x33b)](_0x17dfd9){var _0x50c58e=_0x3d1808;this[_0x50c58e(0x33c)]();const _0x201273=this['_injector'][_0x50c58e(0x3af)](_0x1065a7[_0x50c58e(0x446)],this['unitID'],this[_0x50c58e(0x436)],this[_0x50c58e(0x37e)],[_0x17dfd9],this[_0x50c58e(0x526)],this[_0x50c58e(0x442)]);return _0x201273[_0x50c58e(0x523)](),_0x201273;}[_0x3d1808(0x519)](_0x38685c){var _0x13ab13=_0x3d1808;if(this[_0x13ab13(0x21b)](_0x38685c))return this[_0x13ab13(0x33c)](),this[_0x13ab13(0x50f)][_0x13ab13(0x3af)](_0x1065a7[_0x13ab13(0x49d)],this[_0x13ab13(0x345)],this[_0x13ab13(0x436)],this[_0x13ab13(0x37e)],[],null,[_0x38685c],this['_handler']);try{const _0x3caff9=this['_transformService'][_0x13ab13(0x368)]([_0x38685c],[this[_0x13ab13(0x37e)]],!0x1);if(_0x3ab606['isTransformChangesetsSuccess'](_0x3caff9)){const {c1Prime:_0x33733c,c2Prime:_0x3ce5c6}=_0x3caff9;this[_0x13ab13(0x510)](_0x33733c[0x0]),_0x3ce5c6[0x0][_0x13ab13(0x47d)]=this['_getCurrentRevision'](),this[_0x13ab13(0x33c)]();const _0x543000=this[_0x13ab13(0x50f)][_0x13ab13(0x3af)](_0x1065a7[_0x13ab13(0x517)],this[_0x13ab13(0x345)],this['type'],_0x3ce5c6[0x0],this[_0x13ab13(0x526)]);return _0x543000[_0x13ab13(0x523)](),_0x543000;}return this[_0x13ab13(0x4f5)](!0x1);}catch(_0x17c453){return this[_0x13ab13(0x4dc)][_0x13ab13(0x3f5)](_0x17c453),this[_0x13ab13(0x4f5)](!0x1);}}[_0x3d1808(0x23f)](_0x18a2fc){var _0x2a10d3=_0x3d1808;this[_0x2a10d3(0x33c)]();const _0x1bf420=this[_0x2a10d3(0x29f)][_0x2a10d3(0x417)](this['unitID']);if(_0x18a2fc[_0x2a10d3(0x42d)]<_0x1bf420-0x1)return this;if(this['_checkMissing'](_0x18a2fc))return this[_0x2a10d3(0x50f)][_0x2a10d3(0x3af)](_0x1065a7['FetchingMissState'],this[_0x2a10d3(0x345)],this['type'],null,[],this[_0x2a10d3(0x37e)],[],this[_0x2a10d3(0x526)]);this[_0x2a10d3(0x555)]();const _0x3d6144=this['_injector'][_0x2a10d3(0x3af)](_0x1065a7['SyncedState'],this[_0x2a10d3(0x345)],this[_0x2a10d3(0x436)],this[_0x2a10d3(0x526)]);return _0x3d6144[_0x2a10d3(0x523)](),_0x3d6144;}[_0x3d1808(0x414)](_0x5316b5){var _0x2095dc=_0x3d1808;return this[_0x2095dc(0x4f5)](!!(_0x5316b5!=null&&_0x5316b5[_0x2095dc(0x3cd)]));}[_0x3d1808(0x1e7)](_0x358b98){var _0x18873f=_0x3d1808;return this[_0x18873f(0x2d9)]>_0x12c628?this[_0x18873f(0x2f3)]():(this[_0x18873f(0x442)]=_0x16a698(this[_0x18873f(0x2d9)],{'timeout':this[_0x18873f(0x2d9)],'reqId':_0x358b98[_0x18873f(0x534)]}),this['_sender']=this[_0x18873f(0x442)][_0x18873f(0x239)](({reqId:_0x70a9c6,timeout:_0x2888d0})=>{var _0x444c9e=_0x18873f;this[_0x444c9e(0x2ed)](_0x70a9c6,_0x2888d0);}),this);}[_0x3d1808(0x2f3)](){var _0x3af181=_0x3d1808;return this['_clearScheduledTask'](),this[_0x3af181(0x50f)]['createInstance'](_0x1065a7[_0x3af181(0x423)],this[_0x3af181(0x345)],this[_0x3af181(0x436)],this[_0x3af181(0x37e)],[],this['_handler']);}[_0x3d1808(0x35c)](){return this;}[_0x3d1808(0x532)](){var _0x227be7=_0x3d1808;this[_0x227be7(0x526)][_0x227be7(0x4b2)](this['_awaitingChangeset']);}[_0x3d1808(0x4f5)](_0x104e91){var _0x336730=_0x3d1808;return this['_clearScheduledTask'](),this[_0x336730(0x50f)]['createInstance'](_0x1065a7[_0x336730(0x44f)],this[_0x336730(0x345)],this[_0x336730(0x436)],this[_0x336730(0x37e)],[],this[_0x336730(0x526)],_0x104e91);}[_0x3d1808(0x2ed)](_0x53dea1,_0x4f9541){var _0x311dfd=_0x3d1808,_0x37107d;_0x53dea1===((_0x37107d=this[_0x311dfd(0x37e)])==null?void 0x0:_0x37107d[_0x311dfd(0x534)])&&(this[_0x311dfd(0x532)](),this['_resendTimeout']=_0x4f9541===0x0?0x3e8:_0x4f9541*0x2);}['_clearScheduledTask'](){var _0x167375=_0x3d1808,_0x9afbc3;(_0x9afbc3=this[_0x167375(0x32f)])==null||_0x9afbc3[_0x167375(0x31d)](),this[_0x167375(0x2d9)]=0x0;}},_0x1065a7['AwaitingState']=_0x456781([_0xa6ca36(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0xa6ca36(0x5,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x2ef)])),_0xa6ca36(0x6,_0x5bafa4['ICommandService']),_0xa6ca36(0x7,_0x5bafa4['ILogService']),_0xa6ca36(0x8,_0x3ab606[_0x3d1808(0x269)]),_0xa6ca36(0x9,_0x5bafa4[_0x3d1808(0x407)]),_0xa6ca36(0xa,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7[_0x3d1808(0x517)]),_0x1065a7[_0x3d1808(0x446)]=class extends _0x312db3{constructor(_0x4eaa98,_0xedf8a0,_0x528791,_0x22d256,_0x2f304d,_0x2f2b2d,_0x3ccef0,_0x50d3ae,_0x4b1301,_0x684c8b,_0x3963f2,_0x3ad67e,_0x2a147e){var _0x28703b=_0x3d1808;super(_0x4eaa98,_0xedf8a0,_0x528791,_0x22d256,_0x2f304d,_0x4b1301,_0x3ad67e,_0x50d3ae,_0x2a147e),_0x3fc7c7(this,_0x28703b(0x37c),_0x28703b(0x225)),_0x3fc7c7(this,_0x28703b(0x2d9),0x0),_0x3fc7c7(this,_0x28703b(0x442)),_0x3fc7c7(this,_0x28703b(0x32f)),(this[_0x28703b(0x50f)]=_0x3ccef0,this[_0x28703b(0x4dc)]=_0x684c8b,this[_0x28703b(0x51f)]=_0x3963f2,this['localCacheService']=_0x2a147e,_0x2f2b2d&&(this[_0x28703b(0x442)]=_0x2f2b2d,this[_0x28703b(0x32f)]=this[_0x28703b(0x442)][_0x28703b(0x239)](({reqId:_0x166bf7,timeout:_0xc1a854})=>{var _0xd5fd49=_0x28703b;this[_0xd5fd49(0x2ed)](_0x166bf7,_0xc1a854);})));}[_0x3d1808(0x33b)](_0x5a8025){var _0x17bf2b=_0x3d1808;return this[_0x17bf2b(0x3ff)]['push'](_0x5a8025),this;}[_0x3d1808(0x519)](_0x518bf0){var _0x400328=_0x3d1808;if(this[_0x400328(0x21b)](_0x518bf0))return this[_0x400328(0x33c)](),this[_0x400328(0x50f)][_0x400328(0x3af)](_0x1065a7[_0x400328(0x49d)],this[_0x400328(0x345)],this[_0x400328(0x436)],this[_0x400328(0x37e)],this['_pendingMutations'],null,[_0x518bf0],this[_0x400328(0x526)]);try{const _0x367137=this[_0x400328(0x51f)][_0x400328(0x368)]([_0x518bf0],[this[_0x400328(0x37e)]],!0x1);if(_0x3ab606['isTransformChangesetsSuccess'](_0x367137)){const {c1Prime:_0x4ce054,c2Prime:_0x13ab89}=_0x367137,_0x50ca9c=this[_0x400328(0x51f)]['transformMutationsWithChangeset'](_0x4ce054[0x0],this[_0x400328(0x3ff)]);if(_0x3ab606[_0x400328(0x37b)](_0x50ca9c)){const {c1Prime:_0x29c9c7,m2Prime:_0x7b3a05}=_0x50ca9c;return this[_0x400328(0x510)](_0x29c9c7),_0x13ab89[0x0]['baseRev']=this[_0x400328(0x347)](),this['_clearScheduledTask'](),this[_0x400328(0x50f)][_0x400328(0x3af)](_0x1065a7[_0x400328(0x446)],this[_0x400328(0x345)],this[_0x400328(0x436)],_0x13ab89[0x0],_0x7b3a05,this[_0x400328(0x526)],void 0x0);}throw _0x50ca9c[_0x400328(0x3f5)];}throw _0x367137[_0x400328(0x3f5)];}catch(_0x3e51e4){return this[_0x400328(0x4dc)][_0x400328(0x3f5)](_0x3e51e4),this[_0x400328(0x4f5)](!0x1);}}[_0x3d1808(0x23f)](_0x42b3b7){var _0x1dd288=_0x3d1808;if(this[_0x1dd288(0x33c)](),this[_0x1dd288(0x21b)](_0x42b3b7))return this[_0x1dd288(0x50f)][_0x1dd288(0x3af)](_0x1065a7[_0x1dd288(0x49d)],this[_0x1dd288(0x345)],this['type'],null,this[_0x1dd288(0x3ff)],this['_awaitingChangeset'],[],this[_0x1dd288(0x526)]);this[_0x1dd288(0x555)]();const _0x29268e=this[_0x1dd288(0x50f)]['createInstance'](_0x1065a7[_0x1dd288(0x271)],this['unitID'],this[_0x1dd288(0x436)],this['_pendingMutations'],this[_0x1dd288(0x526)]);return _0x29268e[_0x1dd288(0x4be)](),_0x29268e[_0x1dd288(0x523)](),_0x29268e;}[_0x3d1808(0x414)](_0x228fda){return this['_onConflict'](!!(_0x228fda!=null&&_0x228fda['isPermissionRej']));}[_0x3d1808(0x1e7)](_0x15fb63){var _0x31722d=_0x3d1808;return this[_0x31722d(0x2d9)]>_0x12c628?this[_0x31722d(0x2f3)]():(this[_0x31722d(0x442)]=_0x16a698(this[_0x31722d(0x2d9)],{'timeout':this[_0x31722d(0x2d9)],'reqId':_0x15fb63['reqId']}),this[_0x31722d(0x32f)]=this[_0x31722d(0x442)]['subscribe'](({reqId:_0x5ee983,timeout:_0x37c49f})=>{var _0x56721e=_0x31722d;this[_0x56721e(0x2ed)](_0x5ee983,_0x37c49f);}),this);}['toggleOffline'](){var _0x468d0f=_0x3d1808;return this[_0x468d0f(0x33c)](),this[_0x468d0f(0x50f)][_0x468d0f(0x3af)](_0x1065a7[_0x468d0f(0x423)],this[_0x468d0f(0x345)],this['type'],this[_0x468d0f(0x37e)],this[_0x468d0f(0x3ff)],this[_0x468d0f(0x526)]);}['toggleOnline'](){return this;}['resend'](){var _0x448551=_0x3d1808;this[_0x448551(0x526)]['onSendChangeset'](this[_0x448551(0x37e)]);}[_0x3d1808(0x4f5)](_0x18c53c){var _0x3dd557=_0x3d1808;return this[_0x3dd557(0x33c)](),this['_injector'][_0x3dd557(0x3af)](_0x1065a7[_0x3dd557(0x44f)],this[_0x3dd557(0x345)],this[_0x3dd557(0x436)],null,this[_0x3dd557(0x3ff)],this[_0x3dd557(0x526)],_0x18c53c);}[_0x3d1808(0x2ed)](_0x2b4ab7,_0x3ed06b){var _0x1b4a7d=_0x3d1808,_0x3a9251;_0x2b4ab7===((_0x3a9251=this[_0x1b4a7d(0x37e)])==null?void 0x0:_0x3a9251[_0x1b4a7d(0x534)])&&(this[_0x1b4a7d(0x532)](),this[_0x1b4a7d(0x2d9)]=_0x3ed06b===0x0?0x3e8:_0x3ed06b*0x2);}[_0x3d1808(0x33c)](){var _0x1f81ab=_0x3d1808,_0x396232;(_0x396232=this[_0x1f81ab(0x32f)])==null||_0x396232['unsubscribe'](),this[_0x1f81ab(0x2d9)]=0x0;}},_0x1065a7[_0x3d1808(0x446)]=_0x456781([_0xa6ca36(0x6,_0x5bafa4['Inject'](_0x5bafa4[_0x3d1808(0x511)])),_0xa6ca36(0x7,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x2ef)])),_0xa6ca36(0x8,_0x5bafa4[_0x3d1808(0x3fc)]),_0xa6ca36(0x9,_0x5bafa4[_0x3d1808(0x528)]),_0xa6ca36(0xa,_0x3ab606[_0x3d1808(0x269)]),_0xa6ca36(0xb,_0x5bafa4['IUndoRedoService']),_0xa6ca36(0xc,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7[_0x3d1808(0x446)]),_0x1065a7['ConflictState']=class extends _0x312db3{constructor(_0x4e9b66,_0xbeef1c,_0x5568eb,_0x8b3a3b,_0x599577,_0x1e81e0=!0x1,_0x3c1a0f,_0x2ef3c2,_0x3bca03,_0x47ce5d,_0x5bc35b,_0x5c30e5,_0x13318d){var _0x2d3d75=_0x3d1808;super(_0x4e9b66,_0xbeef1c,_0x5568eb,_0x8b3a3b,_0x599577,_0x2ef3c2,_0x3bca03,_0x47ce5d,_0x13318d),_0x3fc7c7(this,_0x2d3d75(0x37c),'conflict'),(this[_0x2d3d75(0x4a2)]=_0x1e81e0,this[_0x2d3d75(0x56a)]=_0x3c1a0f,this[_0x2d3d75(0x512)]=_0x5bc35b,this['_collaborationUIEventService']=_0x5c30e5,this[_0x2d3d75(0x3d9)]=_0x13318d,this[_0x2d3d75(0x449)](),this[_0x2d3d75(0x3cc)](),this[_0x2d3d75(0x379)]());}['appendMutation'](){return this;}['onRemoteChangeset'](){return this;}[_0x3d1808(0x23f)](){return this;}[_0x3d1808(0x414)](){return this;}[_0x3d1808(0x1e7)](){return this;}['toggleOffline'](){return this;}['toggleOnline'](){return this;}[_0x3d1808(0x532)](){throw new Error('[ConflictState]:\x20invalid\x20calling\x20to\x20`resend`.');}[_0x3d1808(0x3cc)](){var _0x5e716f=_0x3d1808,_0x5cbe8b;(_0x5cbe8b=this[_0x5e716f(0x4b5)])==null||_0x5cbe8b[_0x5e716f(0x25e)](this['unitID'],this[_0x5e716f(0x436)],null,[]);}['_showConflictNotification'](){var _0x307d99=_0x3d1808;this[_0x307d99(0x4a2)]?this[_0x307d99(0x387)][_0x307d99(0x3e2)]({'id':_0x38090c[_0x307d99(0x2f2)]}):this[_0x307d99(0x387)][_0x307d99(0x3e2)]({'id':_0x38090c[_0x307d99(0x332)]});}[_0x3d1808(0x379)](){var _0x2f5fd2=_0x3d1808;this[_0x2f5fd2(0x56a)][_0x2f5fd2(0x409)](new _0x1c5262[(_0x2f5fd2(0x394))](this[_0x2f5fd2(0x345)])['id'],!0x1);}},_0x1065a7['ConflictState']=_0x456781([_0xa6ca36(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4['IPermissionService'])),_0xa6ca36(0x7,_0x5bafa4[_0x3d1808(0x3fc)]),_0xa6ca36(0x8,_0x5bafa4[_0x3d1808(0x407)]),_0xa6ca36(0x9,_0x5bafa4['Inject'](_0x3ab606[_0x3d1808(0x2ef)])),_0xa6ca36(0xa,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x2e1)])),_0xa6ca36(0xb,_0x5bafa4[_0x3d1808(0x317)](_0x10cfe4)),_0xa6ca36(0xc,_0x5bafa4['Optional'](_0xd8e545))],_0x1065a7[_0x3d1808(0x44f)]),_0x1065a7[_0x3d1808(0x423)]=class extends _0x312db3{constructor(_0x3ee0f3,_0x348872,_0x3392f2,_0x54692e,_0x4e2ed,_0x326293,_0x5a88fa,_0x251ee1,_0x1c77d5,_0x1bb8cb){var _0x5ae98e=_0x3d1808;super(_0x3ee0f3,_0x348872,_0x3392f2,_0x54692e,_0x4e2ed,_0x251ee1,_0x1c77d5,_0x5a88fa,_0x1bb8cb),_0x3fc7c7(this,_0x5ae98e(0x37c),_0x5ae98e(0x459)),this[_0x5ae98e(0x50f)]=_0x326293;}['appendMutation'](_0xb3d64c){var _0x492b50=_0x3d1808;return this['_pendingMutations'][_0x492b50(0x381)](_0xb3d64c),this[_0x492b50(0x523)](),this;}[_0x3d1808(0x519)](_0x22a986){var _0xe393b3=_0x3d1808;throw new Error(_0xe393b3(0x49c));}[_0x3d1808(0x23f)](){var _0x395122=_0x3d1808;throw new Error(_0x395122(0x355));}[_0x3d1808(0x414)](){throw new Error('[OfflineState]:\x20received\x20rejection.');}[_0x3d1808(0x1e7)](){return this;}[_0x3d1808(0x2f3)](){return this;}[_0x3d1808(0x35c)](){var _0x371bc5=_0x3d1808;const {_injector:_0x1852d1,_pendingMutations:_0x428c21,_awaitingChangeset:_0x23bb11,unitID:_0x1206c5,_handler:_0x49f361,type:_0x128e2b}=this,_0x5a6444=_0x16d863(_0x1852d1,_0x1206c5,_0x128e2b,_0x23bb11,_0x428c21,_0x49f361);return _0x5a6444 instanceof _0x1065a7[_0x371bc5(0x271)]?_0x5a6444['_schedule']():(_0x5a6444 instanceof _0x1065a7[_0x371bc5(0x446)]||_0x5a6444 instanceof _0x1065a7[_0x371bc5(0x517)])&&_0x5a6444['resend'](),_0x5a6444;}[_0x3d1808(0x532)](){var _0x54998a=_0x3d1808;throw new Error(_0x54998a(0x43d));}},_0x1065a7['OfflineState']=_0x456781([_0xa6ca36(0x5,_0x5bafa4['Inject'](_0x5bafa4[_0x3d1808(0x511)])),_0xa6ca36(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606['RevisionService'])),_0xa6ca36(0x7,_0x5bafa4[_0x3d1808(0x3fc)]),_0xa6ca36(0x8,_0x5bafa4['IUndoRedoService']),_0xa6ca36(0x9,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7['OfflineState']),_0x1065a7[_0x3d1808(0x49d)]=class extends _0x312db3{constructor(_0x53f4c9,_0x41435f,_0x5df672,_0x4f0141,_0x2f96f1,_0x4aadea,_0x1fcaa6,_0x36205c,_0x128ca7,_0x385bb4,_0x266fa8,_0x493d2e,_0x1c4dd4,_0x401f22){var _0x32354e=_0x3d1808;super(_0x53f4c9,_0x41435f,_0x5df672,_0x4f0141,_0x1fcaa6,_0x266fa8,_0x493d2e,_0x128ca7,_0x401f22),_0x3fc7c7(this,_0x32354e(0x37c),_0x32354e(0x408)),(this[_0x32354e(0x1d9)]=_0x2f96f1,this[_0x32354e(0x325)]=_0x4aadea,this[_0x32354e(0x50f)]=_0x36205c,this['_logService']=_0x385bb4,this[_0x32354e(0x51f)]=_0x1c4dd4,this[_0x32354e(0x3d9)]=_0x401f22);}[_0x3d1808(0x49b)](_0x5af1a5){var _0x255e72=_0x3d1808;try{const _0x2b275c=[..._0x5af1a5,...this[_0x255e72(0x325)]],_0x5a11ea=[this[_0x255e72(0x37e)]||this['_acknowledgedAwaitingChangeset']][_0x255e72(0x3d2)](_0x44c68f=>!!_0x44c68f);let _0x29ad6d,_0x576ccd;if(_0x5a11ea[_0x255e72(0x3c5)]){const _0xfe6ff1=this[_0x255e72(0x51f)]['transformChangesets'](_0x2b275c,_0x5a11ea,!0x1);if(!_0x3ab606['isTransformChangesetsSuccess'](_0xfe6ff1))throw _0xfe6ff1[_0x255e72(0x3f5)];_0x29ad6d=_0xfe6ff1['c1Prime'],_0x576ccd=_0xfe6ff1['c2Prime'];}else _0x29ad6d=_0x2b275c,_0x576ccd=[];let _0x9918fc=this[_0x255e72(0x3ff)];_0x29ad6d[_0x255e72(0x27c)](_0x5b8730=>{var _0x141bd5=_0x255e72;let _0x5a512c;if(_0x9918fc[_0x141bd5(0x3c5)]){const _0x2a25d2=this[_0x141bd5(0x51f)][_0x141bd5(0x441)](_0x5b8730,_0x9918fc);if(!_0x3ab606[_0x141bd5(0x37b)](_0x2a25d2))throw _0x2a25d2[_0x141bd5(0x3f5)];_0x5a512c=_0x2a25d2['c1Prime'],_0x9918fc=_0x2a25d2[_0x141bd5(0x45e)];}else _0x5a512c=_0x5b8730;this[_0x141bd5(0x510)](_0x5a512c);}),this[_0x255e72(0x1d9)]&&this[_0x255e72(0x555)](),this['_awaitingChangeset']&&_0x576ccd[_0x255e72(0x3c5)]&&(_0x576ccd[0x0][_0x255e72(0x47d)]=this['_getCurrentRevision']());let _0x30c150;if(this[_0x255e72(0x37e)]&&_0x9918fc[_0x255e72(0x3c5)]!==0x0)_0x30c150=this[_0x255e72(0x50f)]['createInstance'](_0x1065a7[_0x255e72(0x446)],this[_0x255e72(0x345)],this[_0x255e72(0x436)],_0x576ccd[0x0],_0x9918fc,this[_0x255e72(0x526)],void 0x0);else{if(this[_0x255e72(0x37e)]&&_0x9918fc[_0x255e72(0x3c5)]===0x0)_0x576ccd[0x0][_0x255e72(0x47d)]=this[_0x255e72(0x347)](),_0x30c150=this[_0x255e72(0x50f)][_0x255e72(0x3af)](_0x1065a7[_0x255e72(0x517)],this[_0x255e72(0x345)],this['type'],_0x576ccd[0x0],this['_handler']);else{if(_0x9918fc['length']!==0x0){const _0x107665=this[_0x255e72(0x50f)]['createInstance'](_0x1065a7[_0x255e72(0x271)],this['unitID'],this[_0x255e72(0x436)],_0x9918fc,this['_handler']);_0x107665[_0x255e72(0x4be)](),_0x30c150=_0x107665;}else _0x30c150=this['_injector'][_0x255e72(0x3af)](_0x1065a7['SyncedState'],this[_0x255e72(0x345)],this[_0x255e72(0x436)],this[_0x255e72(0x526)]);}}return _0x30c150[_0x255e72(0x523)](),_0x30c150;}catch(_0x44ebb8){return this[_0x255e72(0x4dc)][_0x255e72(0x3f5)](_0x255e72(0x331),'failed\x20to\x20apply\x20missed\x20changesets!',_0x44ebb8),this['_injector']['createInstance'](_0x1065a7[_0x255e72(0x44f)],this[_0x255e72(0x345)],this['type'],this['_awaitingChangeset'],this[_0x255e72(0x3ff)],this['_handler'],!0x1);}}[_0x3d1808(0x532)](){throw new Error('[FetchingMissState]:\x20invalid\x20calling\x20to\x20`resend`.');}[_0x3d1808(0x33b)](_0x27b34c){var _0x3a5bc6=_0x3d1808;return this[_0x3a5bc6(0x3ff)][_0x3a5bc6(0x381)](_0x27b34c),this;}['onRemoteChangeset'](_0x13c8d0){var _0x449e33=_0x3d1808;return this['_queuedRemoteChangesets'][_0x449e33(0x381)](_0x13c8d0),this;}['onRemoteAck'](_0x2891b9){var _0x405683=_0x3d1808;if(this[_0x405683(0x37e)])return this[_0x405683(0x1d9)]=this[_0x405683(0x37e)],this[_0x405683(0x37e)]=null,this;throw new Error(_0x405683(0x4fd));}['onRemoteRej'](_0x49f619){var _0x35de45=_0x3d1808;return this[_0x35de45(0x4f5)](!!(_0x49f619!=null&&_0x49f619['isPermissionRej']));}['onRemoteRetry'](){return this;}[_0x3d1808(0x2f3)](){var _0x224eb5=_0x3d1808;return this[_0x224eb5(0x50f)][_0x224eb5(0x3af)](_0x1065a7[_0x224eb5(0x423)],this[_0x224eb5(0x345)],this['type'],this['_awaitingChangeset'],this[_0x224eb5(0x3ff)],this[_0x224eb5(0x526)]);}['toggleOnline'](){return this;}[_0x3d1808(0x4f5)](_0x188bb5){var _0x570b0e=_0x3d1808;return this['_injector'][_0x570b0e(0x3af)](_0x1065a7['ConflictState'],this[_0x570b0e(0x345)],this[_0x570b0e(0x436)],this[_0x570b0e(0x37e)],this['_pendingMutations'],this[_0x570b0e(0x526)],_0x188bb5);}},_0x1065a7['FetchingMissState']=_0x456781([_0xa6ca36(0x7,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0xa6ca36(0x8,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x2ef)])),_0xa6ca36(0x9,_0x5bafa4['ILogService']),_0xa6ca36(0xa,_0x5bafa4['ICommandService']),_0xa6ca36(0xb,_0x5bafa4['IUndoRedoService']),_0xa6ca36(0xc,_0x3ab606[_0x3d1808(0x269)]),_0xa6ca36(0xd,_0x5bafa4['Optional'](_0xd8e545))],_0x1065a7[_0x3d1808(0x49d)]);function _0x16d863(_0x2284fd,_0x1f0636,_0x4c72b7,_0x496709,_0x50925e,_0x531e18){var _0x15f420=_0x3d1808;return _0x496709&&_0x50925e[_0x15f420(0x3c5)]?_0x2284fd['createInstance'](_0x1065a7[_0x15f420(0x446)],_0x1f0636,_0x4c72b7,_0x496709,_0x50925e,_0x531e18,void 0x0):_0x496709?_0x2284fd[_0x15f420(0x3af)](_0x1065a7[_0x15f420(0x517)],_0x1f0636,_0x4c72b7,_0x496709,_0x531e18):_0x50925e[_0x15f420(0x3c5)]?_0x2284fd[_0x15f420(0x3af)](_0x1065a7[_0x15f420(0x271)],_0x1f0636,_0x4c72b7,_0x50925e,_0x531e18):_0x2284fd[_0x15f420(0x3af)](_0x1065a7[_0x15f420(0x363)],_0x1f0636,_0x4c72b7,_0x531e18);}var _0x38cab5=Object[_0x3d1808(0x3cf)],_0x4fdb43=(_0x5ce4bc,_0x9ccc1d,_0x36cdca,_0x251467)=>{var _0x2bd085=_0x3d1808;for(var _0x3ba228=_0x251467>0x1?void 0x0:_0x251467?_0x38cab5(_0x9ccc1d,_0x36cdca):_0x9ccc1d,_0x1fe0cf=_0x5ce4bc[_0x2bd085(0x3c5)]-0x1,_0x103436;_0x1fe0cf>=0x0;_0x1fe0cf--)(_0x103436=_0x5ce4bc[_0x1fe0cf])&&(_0x3ba228=_0x103436(_0x3ba228)||_0x3ba228);return _0x3ba228;},_0x59d62f=(_0x220705,_0x3ff01f)=>(_0x1e13ae,_0x32bcc0)=>_0x3ff01f(_0x1e13ae,_0x32bcc0,_0x220705);_0x1065a7['CollaborationEntity']=class extends _0x5bafa4[_0x3d1808(0x265)]{constructor(_0x486dba,_0x232150,_0xc2371,_0x331e53,_0x45d05d,_0x24f5b9,_0x5009e1,_0x2e24a0,_0x39a06e,_0x18f40b,_0x57c0bf,_0x44d66f,_0x5c9619,_0x130ac3){var _0x2ba54b=_0x3d1808;super(),_0x3fc7c7(this,'_state$',new _0x1a688c[(_0x2ba54b(0x1f8))](null)),_0x3fc7c7(this,_0x2ba54b(0x3e1),this['_state$']['asObservable']()),_0x3fc7c7(this,_0x2ba54b(0x514)),_0x3fc7c7(this,_0x2ba54b(0x2e9),!0x1),_0x3fc7c7(this,_0x2ba54b(0x319),''),_0x3fc7c7(this,_0x2ba54b(0x509),0x0),_0x3fc7c7(this,'status$',this[_0x2ba54b(0x3e1)]['pipe'](_0x1a688c['map'](_0x1f2d6d=>_0x1f2d6d?_0x1f2d6d[_0x2ba54b(0x37c)]:_0x293214[_0x2ba54b(0x559)]),_0x1a688c[_0x2ba54b(0x4a1)](0x1))),_0x3fc7c7(this,'_transitionLocked',!0x1),_0x3fc7c7(this,_0x2ba54b(0x537),[]),(this['unitID']=_0x486dba,this[_0x2ba54b(0x231)]=_0x232150,this[_0x2ba54b(0x476)]=_0xc2371,this['_injector']=_0x331e53,this[_0x2ba54b(0x2eb)]=_0x45d05d,this[_0x2ba54b(0x512)]=_0x24f5b9,this[_0x2ba54b(0x29f)]=_0x5009e1,this[_0x2ba54b(0x267)]=_0x2e24a0,this['_univerInstanceService']=_0x39a06e,this[_0x2ba54b(0x4dc)]=_0x18f40b,this[_0x2ba54b(0x538)]=_0x57c0bf,this['_permissionService']=_0x44d66f,this[_0x2ba54b(0x211)]=_0x5c9619,this[_0x2ba54b(0x4b5)]=_0x130ac3);}get[_0x3d1808(0x333)](){return this['_state'];}async[_0x3d1808(0x456)](){var _0x56dd34=_0x3d1808;if(this[_0x56dd34(0x333)])throw new Error('[CollaborationEntity]:\x20initial\x20state\x20has\x20been\x20created\x20before.\x20You\x20should\x20not\x20call\x20\x22init\x22\x20twice.');await this[_0x56dd34(0x3b8)]();}['pauseCollaboration'](){var _0x58021a=_0x3d1808;return this[_0x58021a(0x2e9)]=!0x0,_0x5bafa4['toDisposable'](()=>{var _0x37dcc3=_0x58021a;this[_0x37dcc3(0x2e9)]=!0x1,this[_0x37dcc3(0x49e)]();});}[_0x3d1808(0x303)](_0x42f496){var _0x722267=_0x3d1808;this[_0x722267(0x308)](_0x42f496);}[_0x3d1808(0x327)](_0x58c807){var _0x51a792=_0x3d1808;this[_0x51a792(0x514)]=_0x58c807,this['_state$'][_0x51a792(0x543)](_0x58c807);}async['_init'](){var _0x23fb1a=_0x3d1808,_0x25b664;this[_0x23fb1a(0x327)](await this[_0x23fb1a(0x4d5)]()),this[_0x23fb1a(0x211)]&&((_0x25b664=this[_0x23fb1a(0x211)])==null||_0x25b664[_0x23fb1a(0x326)](this[_0x23fb1a(0x345)]),this[_0x23fb1a(0x44e)](this[_0x23fb1a(0x211)][_0x23fb1a(0x3d8)](this['unitID'])[_0x23fb1a(0x239)](_0x2f10ed=>{var _0x88d151=_0x23fb1a;this[_0x88d151(0x4dc)]['debug'](_0x88d151(0x3ab),'editing\x20status\x20changed\x20to',_0x2f10ed),_0x2f10ed===_0x166ac9['OTHER_CLIENTS_EDITING']?(this[_0x88d151(0x267)]['emitEvent']({'id':_0x38090c[_0x88d151(0x3e8)]}),this[_0x88d151(0x56a)][_0x88d151(0x409)](new _0x1c5262[(_0x88d151(0x394))](this[_0x88d151(0x345)])['id'],!0x1),this[_0x88d151(0x56a)]['setShowComponents'](!0x1)):(this[_0x88d151(0x56a)]['updatePermissionPoint'](new _0x1c5262[(_0x88d151(0x394))](this[_0x88d151(0x345)])['id'],!0x0),this[_0x88d151(0x56a)][_0x88d151(0x22f)](!0x0));})));let _0x42a79c=!0x1;return this[_0x23fb1a(0x44e)](this[_0x23fb1a(0x231)]['sessionStatus$']['subscribe'](_0x3f07e8=>{var _0x48b39a=_0x23fb1a;_0x3f07e8===_0x4b7463[_0x48b39a(0x2d4)]?this[_0x48b39a(0x34b)](_0x42a79c):_0x3f07e8===_0x4b7463[_0x48b39a(0x559)]&&(_0x42a79c=!0x0,this['_toggleOffline']());})),this['disposeWithMe'](this[_0x23fb1a(0x231)][_0x23fb1a(0x2a4)][_0x23fb1a(0x239)](_0x1d353c=>{var _0x46a1bc=_0x23fb1a;try{switch(_0x1d353c[_0x46a1bc(0x3a4)]){case _0x3ab606[_0x46a1bc(0x260)][_0x46a1bc(0x2d1)]:{this[_0x46a1bc(0x4c9)](_0x3ab606[_0x46a1bc(0x2e8)](_0x1d353c[_0x46a1bc(0x285)]));break;}case _0x3ab606['CollaborationEvent']['CHANGESET_ACK']:{this['_onRemoteACK'](_0x1d353c[_0x46a1bc(0x285)]);break;}case _0x3ab606[_0x46a1bc(0x260)][_0x46a1bc(0x489)]:{this[_0x46a1bc(0x2d0)]();break;}case _0x3ab606[_0x46a1bc(0x260)][_0x46a1bc(0x242)]:{this[_0x46a1bc(0x30c)](_0x1d353c['data']);break;}case _0x3ab606[_0x46a1bc(0x260)][_0x46a1bc(0x1f2)]:{this[_0x46a1bc(0x263)](_0x1d353c[_0x46a1bc(0x285)][_0x46a1bc(0x466)][_0x46a1bc(0x51a)](_0x3a23f6=>_0x3ab606[_0x46a1bc(0x2e8)](_0x3a23f6)));break;}case _0x3ab606[_0x46a1bc(0x260)][_0x46a1bc(0x2f7)]:{this[_0x46a1bc(0x2d0)]({'isPermissionRej':!0x0});break;}case _0x3ab606[_0x46a1bc(0x260)][_0x46a1bc(0x461)]:break;}}catch(_0x3572d7){throw console['error']('Error\x20on\x20receiving\x20event',_0x3572d7),_0x3572d7;}})),this[_0x23fb1a(0x514)];}['_unlockTransition'](){var _0x33a077=_0x3d1808;this[_0x33a077(0x208)]=!0x1;}[_0x3d1808(0x1f3)](){var _0x55b337=_0x3d1808;if(this[_0x55b337(0x208)])throw new Error(_0x55b337(0x274));this[_0x55b337(0x208)]=!0x0;}[_0x3d1808(0x308)](_0x4e7263){var _0x27554e=_0x3d1808;this[_0x27554e(0x1f3)](),this[_0x27554e(0x327)](this[_0x27554e(0x514)][_0x27554e(0x33b)](_0x4e7263)),this[_0x27554e(0x4ef)]();}[_0x3d1808(0x4c9)](_0x337a2d){var _0x3b54e6=_0x3d1808;if(!(_0x337a2d[_0x3b54e6(0x42d)]<=this['_revisionService']['getCurrentRevOfUnit'](this[_0x3b54e6(0x345)]))){if(this[_0x3b54e6(0x2e9)]){this['_remoteChangesetQueue'][_0x3b54e6(0x381)](_0x337a2d);return;}this[_0x3b54e6(0x357)](_0x337a2d);}}[_0x3d1808(0x49e)](){var _0x156806=_0x3d1808;this[_0x156806(0x537)]['forEach'](_0x36a331=>this[_0x156806(0x357)](_0x36a331)),this['_remoteChangesetQueue']=[];}['_applyRemoteChangeset'](_0x429e48){var _0x5f3842=_0x3d1808;const _0x38e3ab=this[_0x5f3842(0x2eb)][_0x5f3842(0x4b1)][_0x5f3842(0x4bf)](this[_0x5f3842(0x2eb)][_0x5f3842(0x4b1)][_0x5f3842(0x28e)]()[_0x5f3842(0x247)])(_0x429e48[_0x5f3842(0x4f4)],null)||_0x429e48[_0x5f3842(0x4f4)],_0x236c9e={..._0x429e48,'mutations':_0x38e3ab};this[_0x5f3842(0x1f3)](),this[_0x5f3842(0x327)](this[_0x5f3842(0x514)][_0x5f3842(0x519)](_0x236c9e)),this[_0x5f3842(0x4ef)]();}[_0x3d1808(0x378)](_0x1c1c24){var _0x489898=_0x3d1808;this[_0x489898(0x1f3)](),this['_updateState'](this[_0x489898(0x514)][_0x489898(0x23f)](_0x1c1c24)),this['_unlockTransition']();}[_0x3d1808(0x2d0)](_0x42fd88){var _0x3a1549=_0x3d1808;this['_lockTransition'](),this[_0x3a1549(0x327)](this[_0x3a1549(0x514)][_0x3a1549(0x414)](_0x42fd88)),this[_0x3a1549(0x4ef)]();}[_0x3d1808(0x30c)](_0x135e3e){var _0x359dd9=_0x3d1808;this[_0x359dd9(0x1f3)](),this[_0x359dd9(0x327)](this[_0x359dd9(0x514)][_0x359dd9(0x1e7)](_0x135e3e)),this[_0x359dd9(0x4ef)]();}[_0x3d1808(0x263)](_0x26099d){var _0x4afa98=_0x3d1808;if(!(this[_0x4afa98(0x514)]instanceof _0x1065a7[_0x4afa98(0x49d)]))throw new TypeError('[CollaborationEntity]:\x20cannot\x20apply\x20missing\x20results\x20on\x20other\x20states!');const _0x1a5979=_0x26099d[_0x4afa98(0x51a)](_0x15849d=>{var _0x2338b4=_0x4afa98;const _0x3d9363=this[_0x2338b4(0x2eb)][_0x2338b4(0x4b1)][_0x2338b4(0x4bf)](this[_0x2338b4(0x2eb)]['interceptor'][_0x2338b4(0x28e)]()[_0x2338b4(0x247)])(_0x15849d[_0x2338b4(0x4f4)],null)||_0x15849d[_0x2338b4(0x4f4)];return{..._0x15849d,'mutations':_0x3d9363};});this[_0x4afa98(0x1f3)](),this[_0x4afa98(0x327)](this[_0x4afa98(0x514)][_0x4afa98(0x49b)](_0x1a5979)),this[_0x4afa98(0x4ef)]();}[_0x3d1808(0x55f)](){var _0x1d78a4=_0x3d1808;this[_0x1d78a4(0x1f3)](),this['_updateState'](this[_0x1d78a4(0x514)]['toggleOffline']()),this[_0x1d78a4(0x4ef)]();}[_0x3d1808(0x34b)](_0x360efa=!0x1){var _0x271cfc=_0x3d1808;this['_lockTransition'](),this[_0x271cfc(0x327)](this['_state']['toggleOnline']()),this[_0x271cfc(0x4ef)]();const _0x17fa42=this[_0x271cfc(0x514)];_0x360efa&&_0x17fa42 instanceof _0x1065a7['SyncedState']&&(this['_lockTransition'](),this[_0x271cfc(0x327)](_0x17fa42[_0x271cfc(0x485)]()),this[_0x271cfc(0x4ef)]());}async[_0x3d1808(0x4d5)](){return new Promise(_0x1b4486=>{var _0xdd078a=_0x58ee;this[_0xdd078a(0x231)]['sessionStatus$']['pipe'](_0x1a688c['take'](0x1))[_0xdd078a(0x239)](async _0x961687=>{var _0x551882=_0xdd078a;_0x1b4486(await this[_0x551882(0x3e0)](_0x961687===_0x4b7463['ONLINE']));});});}['_createHandler'](){var _0x1d29da=_0x3d1808;const _0x320bfb=this[_0x1d29da(0x345)];return{'onStateChange':(_0x289d7f,_0x37aba2)=>{var _0x21cd62=_0x1d29da;if(_0x289d7f!==this[_0x21cd62(0x514)])throw new Error(_0x21cd62(0x26a)+_0x289d7f[_0x21cd62(0x37c)]+_0x21cd62(0x1e9)+_0x37aba2[_0x21cd62(0x37c)]+_0x21cd62(0x2f5)+this[_0x21cd62(0x514)][_0x21cd62(0x37c)]);this[_0x21cd62(0x327)](_0x37aba2);},'onSendChangeset':_0x39afe6=>{var _0x402724=_0x1d29da;_0x39afe6['sid']||(_0x39afe6[_0x402724(0x25b)]=this[_0x402724(0x319)],_0x39afe6['reqId']=++this[_0x402724(0x509)]);const _0x22bab3={'eventID':_0x3ab606[_0x402724(0x260)]['SUBMIT_CHANGESET'],'data':{'unitID':_0x39afe6[_0x402724(0x345)],'unitType':this[_0x402724(0x476)],'changeset':_0x39afe6,'memberID':this['session'][_0x402724(0x3a0)]()}};this[_0x402724(0x231)]['send'](_0x22bab3,this['unitID']);},'onMissingChangesets':({from:_0x4d03c2,to:_0x2b568f})=>{var _0x34633f=_0x1d29da;this[_0x34633f(0x4dc)][_0x34633f(0x206)](_0x34633f(0x3ab),'fetching\x20missing\x20changesets\x20from\x20'+_0x4d03c2+_0x34633f(0x280)+_0x2b568f);const _0x59b23b={'eventID':_0x3ab606[_0x34633f(0x260)]['FETCH_MISSING'],'data':{'unitID':_0x320bfb,'unitType':this[_0x34633f(0x476)],'from':_0x4d03c2,'to':_0x2b568f}};this['session'][_0x34633f(0x2a8)](_0x59b23b,this[_0x34633f(0x345)]);}};}async['_createInitialStateImpl'](_0x3c0df4){var _0xf8e264=_0x3d1808,_0x5cb213,_0x5370dd,_0x4245b4;const _0x4ba4c3=await((_0x5cb213=this[_0xf8e264(0x4b5)])==null?void 0x0:_0x5cb213[_0xf8e264(0x383)](this[_0xf8e264(0x345)])),_0x1175b5=(_0x5370dd=_0x4ba4c3==null?void 0x0:_0x4ba4c3['mutations'])!=null?_0x5370dd:[],_0x558b6e=(_0x4245b4=_0x4ba4c3==null?void 0x0:_0x4ba4c3[_0xf8e264(0x2be)])!=null?_0x4245b4:null,_0x5bde67=!!(_0x558b6e!=null&&_0x558b6e['sid'])&&!!(_0x558b6e!=null&&_0x558b6e[_0xf8e264(0x534)]);this[_0xf8e264(0x319)]=_0x5bde67?_0x558b6e['sid']:_0x3ab606[_0xf8e264(0x356)](),this[_0xf8e264(0x509)]=_0x5bde67?_0x558b6e[_0xf8e264(0x534)]:0x0;const _0x146723=this['unitID'];try{this[_0xf8e264(0x56e)](_0x558b6e,_0x1175b5);}catch(_0x4d312d){this[_0xf8e264(0x4dc)][_0xf8e264(0x3f5)](_0x4d312d);}const _0x34f72b=this[_0xf8e264(0x3bb)]();if(_0x3c0df4){const _0x3c68e0=_0x16d863(this['_injector'],_0x146723,this['_type'],_0x558b6e,_0x1175b5,_0x34f72b);return _0x3c68e0 instanceof _0x1065a7[_0xf8e264(0x271)]?_0x3c68e0[_0xf8e264(0x4be)]():(_0x3c68e0 instanceof _0x1065a7[_0xf8e264(0x446)]||_0x3c68e0 instanceof _0x1065a7['AwaitingState'])&&_0x3c68e0[_0xf8e264(0x532)](),_0x3c68e0;}return this[_0xf8e264(0x50f)]['createInstance'](_0x1065a7[_0xf8e264(0x423)],_0x146723,this['_type'],_0x558b6e,_0x1175b5,_0x34f72b);}[_0x3d1808(0x56e)](_0x2d33ce,_0x53f0fe){var _0x4f9f7e=_0x3d1808,_0x9fb0a3,_0xeb86b3;const _0x455cd2=this[_0x4f9f7e(0x2eb)]['interceptor'][_0x4f9f7e(0x4bf)](this[_0x4f9f7e(0x2eb)][_0x4f9f7e(0x4b1)]['getInterceptPoints']()[_0x4f9f7e(0x247)]);(_0x9fb0a3=_0x455cd2((_0x2d33ce==null?void 0x0:_0x2d33ce[_0x4f9f7e(0x4f4)])||[],null))==null||_0x9fb0a3[_0x4f9f7e(0x27c)](_0x4d9426=>this[_0x4f9f7e(0x538)][_0x4f9f7e(0x429)](_0x4d9426['id'],_0x4d9426[_0x4f9f7e(0x21c)])),(_0xeb86b3=_0x455cd2(_0x53f0fe||[],null))==null||_0xeb86b3['forEach'](_0x17e49d=>this['_commandService']['executeCommand'](_0x17e49d['id'],_0x17e49d[_0x4f9f7e(0x21c)]));}},_0x1065a7[_0x3d1808(0x44a)]=_0x4fdb43([_0x59d62f(0x3,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0x59d62f(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x4c5)])),_0x59d62f(0x5,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x2e1)])),_0x59d62f(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606['RevisionService'])),_0x59d62f(0x7,_0x5bafa4['Inject'](_0x10cfe4)),_0x59d62f(0x8,_0x5bafa4['IUniverInstanceService']),_0x59d62f(0x9,_0x5bafa4[_0x3d1808(0x528)]),_0x59d62f(0xa,_0x5bafa4[_0x3d1808(0x3fc)]),_0x59d62f(0xb,_0x5bafa4['IPermissionService']),_0x59d62f(0xc,_0x5bafa4[_0x3d1808(0x4fa)](_0x175519)),_0x59d62f(0xd,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7[_0x3d1808(0x44a)]),_0x1065a7[_0x3d1808(0x1e2)]=class extends _0x1065a7[_0x3d1808(0x44a)]{constructor(_0x409d9f,_0x5383ef,_0x529cde,_0x3aa3e1,_0x217bbe,_0xe8acbe,_0x59455d,_0x25042b,_0x510c7c,_0x11a5be,_0x5409be,_0x2553df,_0x47b1a8,_0xf41005){var _0x3208ee=_0x3d1808;super(_0x409d9f,_0x529cde,_0x5383ef,_0x3aa3e1,_0x217bbe,_0xe8acbe,_0x59455d,_0x25042b,_0x510c7c,_0x11a5be,_0x5409be,_0x2553df,_0x47b1a8,_0xf41005),_0x3fc7c7(this,_0x3208ee(0x553),null),(this[_0x3208ee(0x345)]=_0x409d9f,this[_0x3208ee(0x436)]=_0x5383ef);}[_0x3d1808(0x207)](_0x4bc487){this['_handlerCallback']=_0x4bc487;}['dispose'](){var _0x56187d=_0x3d1808;this[_0x56187d(0x553)]=null,super[_0x56187d(0x508)]();}[_0x3d1808(0x3bb)](){var _0x57d79d=_0x3d1808;const _0x730d17=super[_0x57d79d(0x3bb)]();return _0x730d17[_0x57d79d(0x39b)]=_0x4db11e=>{var _0x32ce7e=_0x57d79d,_0x39ab60,_0x23a30c;return(_0x23a30c=(_0x39ab60=this[_0x32ce7e(0x553)])==null?void 0x0:_0x39ab60[_0x32ce7e(0x39b)])==null?void 0x0:_0x23a30c['call'](_0x39ab60,_0x4db11e);},_0x730d17[_0x57d79d(0x548)]=_0x17396c=>{var _0x5d7789=_0x57d79d,_0x5f11a7,_0xa4e11d;return(_0xa4e11d=(_0x5f11a7=this[_0x5d7789(0x553)])==null?void 0x0:_0x5f11a7[_0x5d7789(0x548)])==null?void 0x0:_0xa4e11d[_0x5d7789(0x37a)](_0x5f11a7,_0x17396c);},_0x730d17[_0x57d79d(0x398)]=_0x19baca=>{var _0x42b3e3=_0x57d79d,_0x6b7595,_0x586edd;return(_0x586edd=(_0x6b7595=this[_0x42b3e3(0x553)])==null?void 0x0:_0x6b7595['onTransformSelections'])==null?void 0x0:_0x586edd[_0x42b3e3(0x37a)](_0x6b7595,_0x19baca);},_0x730d17['onSyncEditingCollabCursor']=_0x58bed0=>{var _0x16d3c6=_0x57d79d,_0x31500f,_0x28219a;return(_0x28219a=(_0x31500f=this[_0x16d3c6(0x553)])==null?void 0x0:_0x31500f[_0x16d3c6(0x55a)])==null?void 0x0:_0x28219a[_0x16d3c6(0x37a)](_0x31500f,_0x58bed0);},_0x730d17['onTransformRemoteChangesetByIMECache']=_0x31f1bc=>{var _0x457d1e=_0x57d79d,_0x332576,_0x2fdc4b,_0x453c8c;if(!((_0x332576=this['_handlerCallback'])!=null&&_0x332576[_0x457d1e(0x214)]))throw new Error(_0x457d1e(0x384));return(_0x453c8c=(_0x2fdc4b=this[_0x457d1e(0x553)])==null?void 0x0:_0x2fdc4b[_0x457d1e(0x214)])==null?void 0x0:_0x453c8c[_0x457d1e(0x37a)](_0x2fdc4b,_0x31f1bc);},_0x730d17[_0x57d79d(0x3ef)]=_0x3075ba=>{var _0x370eb1=_0x57d79d,_0x177c9a,_0x21d8b0,_0x2b6578;if(!((_0x177c9a=this[_0x370eb1(0x553)])!=null&&_0x177c9a[_0x370eb1(0x3ef)]))throw new Error(_0x370eb1(0x4e4));return(_0x2b6578=(_0x21d8b0=this['_handlerCallback'])==null?void 0x0:_0x21d8b0[_0x370eb1(0x3ef)])==null?void 0x0:_0x2b6578[_0x370eb1(0x37a)](_0x21d8b0,_0x3075ba);},_0x730d17;}async['_init'](){var _0x492cd6=_0x3d1808;const _0x3ac989=await super['_init']();return this[_0x492cd6(0x44e)](this[_0x492cd6(0x538)][_0x492cd6(0x53e)]((_0x2a44bc,_0x2a30b5)=>{var _0x2e3e98=_0x492cd6;if(_0x2a44bc[_0x2e3e98(0x436)]!==_0x5bafa4['CommandType']['MUTATION']||_0x2a30b5!=null&&_0x2a30b5['fromCollab']||_0x2a30b5!=null&&_0x2a30b5[_0x2e3e98(0x216)]||_0x2a44bc['id']===_0x460538[_0x2e3e98(0x4a6)]['id'])return;const _0x301f81=_0x2a44bc['params'];if((_0x301f81==null?void 0x0:_0x301f81[_0x2e3e98(0x48f)])!==this[_0x2e3e98(0x345)])return;const _0x3117b9=_0x2a44bc,_0x532ac5=this['_compressMutationService'][_0x2e3e98(0x4b1)][_0x2e3e98(0x4bf)](this['_compressMutationService'][_0x2e3e98(0x4b1)][_0x2e3e98(0x28e)]()['COMPRESS_MUTATION_SEND'])([_0x3117b9],this[_0x2e3e98(0x4b8)])||[_0x3117b9];this['_onLocalMutation'](_0x532ac5[0x0]);})),_0x3ac989;}},_0x1065a7['DocCollaborationEntity']=_0x4fdb43([_0x59d62f(0x3,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0x59d62f(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x4c5)])),_0x59d62f(0x5,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x2e1)])),_0x59d62f(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x2ef)])),_0x59d62f(0x7,_0x5bafa4[_0x3d1808(0x317)](_0x10cfe4)),_0x59d62f(0x8,_0x5bafa4['IUniverInstanceService']),_0x59d62f(0x9,_0x5bafa4['ILogService']),_0x59d62f(0xa,_0x5bafa4['ICommandService']),_0x59d62f(0xb,_0x5bafa4[_0x3d1808(0x226)]),_0x59d62f(0xc,_0x5bafa4[_0x3d1808(0x4fa)](_0x175519)),_0x59d62f(0xd,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7['DocCollaborationEntity']),_0x1065a7[_0x3d1808(0x2b2)]=class extends _0x1065a7[_0x3d1808(0x44a)]{constructor(_0x5167ce,_0x499a33,_0xedcc6b,_0x502827,_0x34d1cf,_0x5e5d82,_0x4611f5,_0x1f241d,_0x4fef9f,_0x40e66e,_0x52483e,_0x178609,_0x44609d,_0xe65953,_0x450e39){var _0x2b6d49=_0x3d1808;super(_0x5167ce,_0xedcc6b,_0x499a33,_0x502827,_0x34d1cf,_0x5e5d82,_0x4611f5,_0x4fef9f,_0x40e66e,_0x52483e,_0x178609,_0x44609d,_0xe65953,_0x450e39),this['unitID']=_0x5167ce,this[_0x2b6d49(0x436)]=_0x499a33,this[_0x2b6d49(0x4d1)]=_0x1f241d;}['_createHandler'](){var _0x3607f1=_0x3d1808;const _0x2e8351=super[_0x3607f1(0x3bb)]();return _0x2e8351[_0x3607f1(0x398)]=_0x26025e=>this[_0x3607f1(0x4d1)][_0x3607f1(0x44d)](_0x26025e),_0x2e8351;}async[_0x3d1808(0x3b8)](){var _0x26a789=_0x3d1808;const _0x3b55ee=await super['_init']();return this['disposeWithMe'](this[_0x26a789(0x538)][_0x26a789(0x53e)]((_0x1db877,_0x10bbfa)=>{var _0x313b23=_0x26a789;if(_0x1db877[_0x313b23(0x436)]!==_0x5bafa4['CommandType']['MUTATION']||_0x10bbfa!=null&&_0x10bbfa[_0x313b23(0x219)]||_0x10bbfa!=null&&_0x10bbfa[_0x313b23(0x216)])return;const _0x1e7d8a=_0x1db877['params'];if((_0x1e7d8a==null?void 0x0:_0x1e7d8a['unitId'])!==this[_0x313b23(0x345)])return;const _0x454335=_0x1db877,_0xfd48bb=this[_0x313b23(0x2eb)]['interceptor'][_0x313b23(0x4bf)](this[_0x313b23(0x2eb)][_0x313b23(0x4b1)][_0x313b23(0x28e)]()['COMPRESS_MUTATION_SEND'])([_0x454335],this[_0x313b23(0x4b8)])||[_0x454335];this[_0x313b23(0x308)](_0xfd48bb[0x0]);})),_0x3b55ee;}},_0x1065a7[_0x3d1808(0x2b2)]=_0x4fdb43([_0x59d62f(0x3,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0x59d62f(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606['CompressMutationService'])),_0x59d62f(0x5,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x2e1)])),_0x59d62f(0x6,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x2ef)])),_0x59d62f(0x7,_0x5bafa4[_0x3d1808(0x317)](_0x1065a7[_0x3d1808(0x1f1)])),_0x59d62f(0x8,_0x5bafa4['Inject'](_0x10cfe4)),_0x59d62f(0x9,_0x5bafa4[_0x3d1808(0x443)]),_0x59d62f(0xa,_0x5bafa4[_0x3d1808(0x528)]),_0x59d62f(0xb,_0x5bafa4[_0x3d1808(0x3fc)]),_0x59d62f(0xc,_0x5bafa4[_0x3d1808(0x226)]),_0x59d62f(0xd,_0x5bafa4[_0x3d1808(0x4fa)](_0x175519)),_0x59d62f(0xe,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7[_0x3d1808(0x2b2)]);const _0x206d80=_0x5bafa4[_0x3d1808(0x433)]('univer-pro.collaboration-client.network-condition.service');function _0x10e983(_0x2bf19f){var _0x3663d0=_0x3d1808,_0x675dd3,_0x1a91b2,_0x46d98e,_0x2447d1,_0x469c32;const _0x840a74=_0x2bf19f[_0x3663d0(0x285)],_0x5a5d9b=JSON['parse'](_0x840a74);switch(_0x5a5d9b[_0x3663d0(0x38d)]){case _0x46dd39['HEARTBEAT']:case _0x46dd39['HELLO']:{const _0x817424=_0x5a5d9b[_0x3663d0(0x501)];return{..._0x5a5d9b,'data':_0x817424,'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};}case _0x46dd39['JOIN']:{const _0x77d860=_0x5a5d9b[_0x3663d0(0x36d)];return{..._0x5a5d9b,'data':_0x77d860,'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};}case _0x46dd39['RECV']:{const _0x5764cf=_0x5a5d9b['collaMsg'];switch(_0x5764cf['eventID']){case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x2f7)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':(_0x675dd3=_0x5764cf[_0x3663d0(0x2ba)])==null?void 0x0:_0x675dd3['cs']},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)]['CHANGESET_ACK']:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':(_0x1a91b2=_0x5764cf[_0x3663d0(0x547)])==null?void 0x0:_0x1a91b2['cs']},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606['CollaborationEvent']['NEW_CHANGESETS']:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':(_0x46d98e=_0x5764cf[_0x3663d0(0x2af)])==null?void 0x0:_0x46d98e['cs']},'cmd':_0x5a5d9b['cmd']};case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x489)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':(_0x2447d1=_0x5764cf[_0x3663d0(0x348)])==null?void 0x0:_0x2447d1['cs']},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x242)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':(_0x469c32=_0x5764cf[_0x3663d0(0x24c)])==null?void 0x0:_0x469c32['cs']},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)]['UPDATE_CURSOR']:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x3c2)]},'cmd':_0x5a5d9b['cmd']};case _0x3ab606['CollaborationEvent'][_0x3663d0(0x400)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x310)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)]['USERS_LEAVE']:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x386)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x3db)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x4a5)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)]['LIVESHARE_FETCH_OPERATIONS']:case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x366)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf['liveShareOperation']},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606['CollaborationEvent'][_0x3663d0(0x3dc)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x4a5)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)]['MSG_FOR_ERROR']:return{..._0x5a5d9b,'data':_0x5764cf,'cmd':_0x5a5d9b['cmd']};case _0x3ab606['CollaborationEvent'][_0x3663d0(0x415)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x500)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)]['UPDATE_PERMISSION_OBJ']:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x22c)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x515)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf[_0x3663d0(0x513)]},'cmd':_0x5a5d9b[_0x3663d0(0x38d)]};case _0x3ab606[_0x3663d0(0x260)][_0x3663d0(0x461)]:return{..._0x5a5d9b,'data':{..._0x5764cf,'data':_0x5764cf['uniscriptRunEvent']},'cmd':_0x5a5d9b['cmd']};default:return _0x5a5d9b;}}default:return _0x5a5d9b;}}function _0x52cb3a(_0x1505a3){var _0x5a4438=_0x3d1808;switch(_0x1505a3[_0x5a4438(0x38d)]){case _0x46dd39['HEARTBEAT']:case _0x46dd39['HELLO']:return JSON['stringify']({'cmd':_0x1505a3[_0x5a4438(0x38d)],'routeKey':_0x1505a3[_0x5a4438(0x4ba)]});case _0x46dd39[_0x5a4438(0x313)]:{let _0x20a6c4;switch(_0x1505a3[_0x5a4438(0x285)][_0x5a4438(0x3a4)]){case _0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x46a)]:{_0x20a6c4={'eventID':_0x3ab606['CollaborationEvent'][_0x5a4438(0x46a)],'updateCursorEvent':_0x1505a3[_0x5a4438(0x285)]['data']};break;}case _0x3ab606['CollaborationEvent'][_0x5a4438(0x2c5)]:{_0x20a6c4={'eventID':_0x3ab606['CollaborationEvent'][_0x5a4438(0x2c5)],'leaveEvent':_0x1505a3[_0x5a4438(0x285)][_0x5a4438(0x285)]};break;}case _0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x400)]:{_0x20a6c4={'eventID':_0x3ab606['CollaborationEvent'][_0x5a4438(0x400)],'joinEvent':_0x1505a3['data'][_0x5a4438(0x285)]};break;}case _0x3ab606['CollaborationEvent'][_0x5a4438(0x3db)]:{_0x20a6c4={'eventID':_0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x3db)],'liveShareNewHost':_0x1505a3[_0x5a4438(0x285)][_0x5a4438(0x285)]};break;}case _0x3ab606['CollaborationEvent']['LIVESHARE_OPERATION']:{_0x20a6c4={'eventID':_0x3ab606['CollaborationEvent'][_0x5a4438(0x366)],'liveShareOperation':_0x1505a3[_0x5a4438(0x285)][_0x5a4438(0x285)]};break;}case _0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x3dc)]:{_0x20a6c4={'eventID':_0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x3dc)],'liveShareTerminate':_0x1505a3[_0x5a4438(0x285)]['data']};break;}case _0x3ab606['CollaborationEvent'][_0x5a4438(0x472)]:{_0x20a6c4={'eventID':_0x3ab606[_0x5a4438(0x260)]['LIVESHARE_REQUEST_HOST'],'liveShareRequestHost':_0x1505a3[_0x5a4438(0x285)][_0x5a4438(0x285)]};break;}case _0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x338)]:{_0x20a6c4={'eventID':_0x3ab606[_0x5a4438(0x260)][_0x5a4438(0x338)]};break;}default:_0x20a6c4={'eventID':_0x1505a3[_0x5a4438(0x285)]['eventID']};}return JSON['stringify']({'cmd':_0x1505a3[_0x5a4438(0x38d)],'routeKey':_0x1505a3[_0x5a4438(0x4ba)],'collaMsg':_0x20a6c4});}case _0x46dd39[_0x5a4438(0x48a)]:return JSON[_0x5a4438(0x3c7)]({'cmd':_0x1505a3['cmd'],'routeKey':_0x1505a3[_0x5a4438(0x4ba)],'joinReq':_0x1505a3['data']});case _0x46dd39[_0x5a4438(0x21a)]:return JSON[_0x5a4438(0x3c7)]({'cmd':_0x1505a3[_0x5a4438(0x38d)],'routeKey':_0x1505a3[_0x5a4438(0x4ba)],'leaveReq':_0x1505a3[_0x5a4438(0x285)]});default:throw new Error(_0x5a4438(0x40f));}}var _0x263c80=Object[_0x3d1808(0x3cf)],_0x4e4b0f=(_0x41625e,_0x32a41f,_0x7dbc2e,_0x2e6892)=>{var _0x379825=_0x3d1808;for(var _0x3b7342=_0x2e6892>0x1?void 0x0:_0x2e6892?_0x263c80(_0x32a41f,_0x7dbc2e):_0x32a41f,_0x31a1af=_0x41625e[_0x379825(0x3c5)]-0x1,_0xdb6178;_0x31a1af>=0x0;_0x31a1af--)(_0xdb6178=_0x41625e[_0x31a1af])&&(_0x3b7342=_0xdb6178(_0x3b7342)||_0x3b7342);return _0x3b7342;},_0xd7c4dc=(_0x1a305d,_0x57bff8)=>(_0x10e6df,_0x207503)=>_0x57bff8(_0x10e6df,_0x207503,_0x1a305d);const _0x3dca45=_0x5bafa4[_0x3d1808(0x433)](_0x3d1808(0x320));function _0x277bec(_0x111b2f,_0x57040f,_0x4d090d){var _0x17ca21=_0x3d1808;return _0x111b2f+'/'+_0x57040f+_0x17ca21(0x495)+_0x4d090d+_0x17ca21(0x25a);}_0x1065a7['CollaborationSocketService']=class extends _0x5bafa4[_0x3d1808(0x40c)]{constructor(_0x562fb6,_0x11f7d8,_0x3ed512,_0x592bba,_0x5e26fd){var _0x4a2715=_0x3d1808;super(),this[_0x4a2715(0x50f)]=_0x562fb6,this[_0x4a2715(0x48b)]=_0x11f7d8,this[_0x4a2715(0x4ee)]=_0x3ed512,this['_logService']=_0x592bba,this[_0x4a2715(0x2ec)]=_0x5e26fd;}[_0x3d1808(0x563)](_0x2d28de){var _0x2cb26d=_0x3d1808;const _0x35fda9=this[_0x2cb26d(0x50f)][_0x2cb26d(0x3f0)](_0x24f178[_0x2cb26d(0x1d1)]);if(!_0x35fda9)throw new Error(_0x2cb26d(0x50a));const _0x154405=_0x35fda9[_0x2cb26d(0x2bf)](_0x2d28de);if(!_0x154405)throw new Error(_0x2cb26d(0x1e3));const _0x3c3104=new _0x5bafa4['DisposableCollection'](),_0xe7cee=new _0x1a688c[(_0x2cb26d(0x546))]();_0x3c3104['add'](_0x154405[_0x2cb26d(0x4c1)][_0x2cb26d(0x239)](_0x20b4af=>_0xe7cee[_0x2cb26d(0x543)](_0x20b4af))),_0x3c3104[_0x2cb26d(0x2b7)](_0x5bafa4[_0x2cb26d(0x4de)](()=>_0xe7cee[_0x2cb26d(0x1fa)]()));const _0x460984=new _0x1a688c['Subject']();_0x3c3104[_0x2cb26d(0x2b7)](_0x154405[_0x2cb26d(0x2d2)]['subscribe'](_0x31edc3=>_0x460984[_0x2cb26d(0x543)](_0x31edc3))),_0x3c3104[_0x2cb26d(0x2b7)](_0x5bafa4[_0x2cb26d(0x4de)](()=>_0x460984['complete']()));const _0x3e3951=new _0x1a688c[(_0x2cb26d(0x546))]();_0x3c3104[_0x2cb26d(0x2b7)](_0x154405[_0x2cb26d(0x3c8)][_0x2cb26d(0x239)](_0x4d10a3=>{const _0x2077c2=_0x10e983(_0x4d10a3);_0x3e3951['next'](_0x2077c2);})),_0x3c3104[_0x2cb26d(0x2b7)](_0x5bafa4[_0x2cb26d(0x4de)](()=>_0x3e3951[_0x2cb26d(0x1fa)]()));let _0x2f5ca1;const _0x25c373=()=>{var _0x39846c=_0x2cb26d;_0x460984['next'](new Event('connection\x20error')),_0xe7cee[_0x39846c(0x543)](new Event('connection\x20error')),_0x2f5ca1['close']();};return _0x2f5ca1={'memberID':'','close$':_0xe7cee[_0x2cb26d(0x340)](),'error$':_0x460984[_0x2cb26d(0x340)](),'open$':_0x154405[_0x2cb26d(0x3fb)],'message$':_0x3e3951[_0x2cb26d(0x340)](),'send':_0x2aaa93=>{var _0x398870=_0x2cb26d;if(_0x2aaa93[_0x398870(0x38d)]===_0x46dd39[_0x398870(0x313)]){if(_0x2aaa93[_0x398870(0x285)]['eventID']===_0x3ab606[_0x398870(0x260)][_0x398870(0x3ca)]){this[_0x398870(0x290)](_0x2f5ca1,_0x2aaa93[_0x398870(0x285)])[_0x398870(0x506)](_0x137334=>{var _0x2ef660=_0x398870;this[_0x2ef660(0x4dc)][_0x2ef660(0x3f5)](_0x137334),_0x25c373();});return;}if(_0x2aaa93[_0x398870(0x285)]['eventID']===_0x3ab606['CollaborationEvent'][_0x398870(0x53d)]){const _0x185ae8=_0x2aaa93[_0x398870(0x285)];this[_0x398870(0x56d)](_0x185ae8)[_0x398870(0x46e)](_0x1b6a23=>{var _0x56ab13=_0x398870;_0x3e3951[_0x56ab13(0x543)]({'cmd':_0x46dd39[_0x56ab13(0x2dd)],'code':_0x25b6a7['OK'],'routeKey':_0x185ae8[_0x56ab13(0x285)][_0x56ab13(0x345)],'routeType':'','data':{'eventID':_0x3ab606[_0x56ab13(0x260)]['PSEUDO_FETCH_MISSING_RESULT'],'data':{'changesets':_0x1b6a23}}});})[_0x398870(0x506)](_0x1f8686=>{var _0x2ca454=_0x398870;this['_logService'][_0x2ca454(0x3f5)](_0x1f8686),_0x25c373();});return;}}_0x154405[_0x398870(0x2a8)](_0x52cb3a(_0x2aaa93));},'close':()=>{var _0x1df99a=_0x2cb26d;_0x154405[_0x1df99a(0x41a)](),_0x3c3104[_0x1df99a(0x508)]();}},_0x2f5ca1;}async[_0x3d1808(0x290)](_0x238533,_0x1c24b){var _0x151791=_0x3d1808,_0x10092b;const {unitType:_0x14ea5c,unitID:_0x5d5242,changeset:_0x4a2dee}=_0x1c24b[_0x151791(0x285)],_0x4e7ea8={'unitID':_0x5d5242,'memberID':_0x238533[_0x151791(0x3e9)],'type':_0x14ea5c,'changeset':_0x3ab606[_0x151791(0x430)](_0x4a2dee)},_0x28b844=this[_0x151791(0x4ee)][_0x151791(0x38b)](_0x755dce),_0xf3272a=_0x277bec((_0x10092b=_0x28b844==null?void 0x0:_0x28b844[_0x151791(0x452)])!=null?_0x10092b:_0x339a5b,_0x14ea5c,_0x5d5242);try{await this[_0x151791(0x48b)][_0x151791(0x2df)](_0xf3272a,{'body':_0x4e7ea8});}catch(_0x480deb){throw this[_0x151791(0x4dc)]['error'](_0x151791(0x2bd),_0x151791(0x4d0)),_0x480deb;}}async[_0x3d1808(0x56d)](_0x246e2b){var _0x5da50c=_0x3d1808;const {unitID:_0x31ec11,from:_0x54062c,to:_0x154199,unitType:_0x3ab83b}=_0x246e2b[_0x5da50c(0x285)];return(await this[_0x5da50c(0x2ec)][_0x5da50c(0x54b)]({'metadata':void 0x0},{'unitID':_0x31ec11,'type':_0x3ab83b,'from':_0x54062c,'to':_0x154199}))[_0x5da50c(0x466)][_0x5da50c(0x51a)](_0x365d3d=>((_0x365d3d[_0x5da50c(0x4f4)]===null||_0x365d3d[_0x5da50c(0x4f4)]===void 0x0)&&(_0x365d3d[_0x5da50c(0x4f4)]=[]),_0x365d3d));}},_0x1065a7['CollaborationSocketService']=_0x4e4b0f([_0xd7c4dc(0x0,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0xd7c4dc(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x24f178[_0x3d1808(0x2c9)])),_0xd7c4dc(0x2,_0x5bafa4['IConfigService']),_0xd7c4dc(0x3,_0x5bafa4[_0x3d1808(0x528)]),_0xd7c4dc(0x4,_0x3ab606[_0x3d1808(0x2cc)])],_0x1065a7[_0x3d1808(0x437)]);var _0x1b2be1=Object[_0x3d1808(0x3cf)],_0x4dbe5b=(_0x205809,_0x5cc6f9,_0x4b9930,_0x27fbfb)=>{var _0x2e6a8f=_0x3d1808;for(var _0x17b714=_0x27fbfb>0x1?void 0x0:_0x27fbfb?_0x1b2be1(_0x5cc6f9,_0x4b9930):_0x5cc6f9,_0x1a403e=_0x205809[_0x2e6a8f(0x3c5)]-0x1,_0x24d62f;_0x1a403e>=0x0;_0x1a403e--)(_0x24d62f=_0x205809[_0x1a403e])&&(_0x17b714=_0x24d62f(_0x17b714)||_0x17b714);return _0x17b714;},_0x3ff668=(_0x89c054,_0x147586)=>(_0xc29bab,_0x4c34d7)=>_0x147586(_0xc29bab,_0x4c34d7,_0x89c054);_0x1065a7[_0x3d1808(0x492)]=class extends _0x5bafa4[_0x3d1808(0x40c)]{constructor(_0x550df8,_0x240e33,_0x2ede03,_0x494b70,_0x3b6aec,_0x24f77f){var _0x19a584=_0x3d1808;super(),_0x3fc7c7(this,_0x19a584(0x47f),new _0x1a688c[(_0x19a584(0x1f8))](void 0x0)),_0x3fc7c7(this,_0x19a584(0x4a3),this[_0x19a584(0x47f)][_0x19a584(0x340)]()),_0x3fc7c7(this,_0x19a584(0x2a7),null),_0x3fc7c7(this,_0x19a584(0x34f),new Map()),_0x3fc7c7(this,_0x19a584(0x284),new _0x1a688c['BehaviorSubject'](_0x4b7463[_0x19a584(0x464)])),_0x3fc7c7(this,_0x19a584(0x31c),this[_0x19a584(0x284)][_0x19a584(0x340)]()),_0x3fc7c7(this,_0x19a584(0x38c),!0x1),_0x3fc7c7(this,_0x19a584(0x463)),_0x3fc7c7(this,_0x19a584(0x4e5),0x0),_0x3fc7c7(this,_0x19a584(0x52c)),_0x3fc7c7(this,_0x19a584(0x22e)),(this[_0x19a584(0x50f)]=_0x550df8,this[_0x19a584(0x4dc)]=_0x240e33,this[_0x19a584(0x4ee)]=_0x2ede03,this[_0x19a584(0x4d7)]=_0x494b70,this['_collaborationUIEventService']=_0x3b6aec,this[_0x19a584(0x1ff)]=_0x24f77f,this['_listenToNetworkCondition']());}get[_0x3d1808(0x1d5)](){var _0x3a9830=_0x3d1808;return this['_socket$'][_0x3a9830(0x2e2)]();}[_0x3d1808(0x2dc)](){var _0x4f7d55=_0x3d1808;this[_0x4f7d55(0x1ff)]&&this[_0x4f7d55(0x44e)](this['_networkConditionService'][_0x4f7d55(0x3aa)][_0x4f7d55(0x239)](_0x2a0557=>{var _0x5ab99a=_0x4f7d55;_0x2a0557&&!this[_0x5ab99a(0x1d5)]&&this[_0x5ab99a(0x4bd)](),_0x2a0557||this['_onOffline']();}));}[_0x3d1808(0x508)](){var _0x304e59=_0x3d1808;super['dispose'](),this[_0x304e59(0x237)](),this[_0x304e59(0x2ee)](),this[_0x304e59(0x301)](),this[_0x304e59(0x34f)][_0x304e59(0x27c)](_0x59cb6a=>_0x59cb6a[_0x304e59(0x508)]()),this[_0x304e59(0x34f)][_0x304e59(0x334)](),this['_status$']['complete']();}async[_0x3d1808(0x3ed)](_0x2878a3){var _0x4b51ec=_0x3d1808;if(this[_0x4b51ec(0x34f)]['has'](_0x2878a3))return this[_0x4b51ec(0x34f)][_0x4b51ec(0x3f0)](_0x2878a3);this['_tryEnsureSocket']();const _0x3d0098=this[_0x4b51ec(0x50f)][_0x4b51ec(0x3af)](_0x1065a7[_0x4b51ec(0x3cb)],_0x2878a3,this[_0x4b51ec(0x47f)][_0x4b51ec(0x340)]());return this[_0x4b51ec(0x34f)][_0x4b51ec(0x373)](_0x2878a3,_0x3d0098),_0x3d0098;}[_0x3d1808(0x352)](_0x4167e1){var _0xe300b9=_0x3d1808,_0x56d1c8;const _0xc48105=this['_sessions'][_0xe300b9(0x3f0)](_0x4167e1);_0xc48105&&(this[_0xe300b9(0x34f)][_0xe300b9(0x33a)](_0x4167e1),_0xc48105[_0xe300b9(0x41a)]()),this[_0xe300b9(0x34f)][_0xe300b9(0x44c)]||(_0x56d1c8=this[_0xe300b9(0x1d5)])==null||_0x56d1c8[_0xe300b9(0x41a)]();}[_0x3d1808(0x4bd)](){var _0x611633=_0x3d1808;this['_retryCount']=0x0,this['_clearRetryConnectingTimer'](),this[_0x611633(0x468)]();}[_0x3d1808(0x237)](){var _0x505ffa=_0x3d1808;this[_0x505ffa(0x463)]!=null&&(clearTimeout(this['_retryConnectingTimer']),this[_0x505ffa(0x463)]=null);}async['_createSocket'](){var _0x45d412=_0x3d1808,_0x455425;const _0x26e2a3=this['_configService']['getConfig'](_0x755dce),_0x497516=(_0x455425=_0x26e2a3==null?void 0x0:_0x26e2a3[_0x45d412(0x4c6)])!=null?_0x455425:_0x38d231,_0x2aa758=await this[_0x45d412(0x4d7)][_0x45d412(0x2bf)](_0x497516);return this[_0x45d412(0x2a7)]=_0x2aa758,_0x2aa758;}async[_0x3d1808(0x288)](){var _0x59d27a=_0x3d1808,_0x3b5ab6,_0x31225f;try{const _0x229c54=(_0x31225f=(_0x3b5ab6=this[_0x59d27a(0x1d5)])!=null?_0x3b5ab6:this['_candidateSocket'])!=null?_0x31225f:await this[_0x59d27a(0x53b)]();if(_0x229c54){const _0x39c3f1=_0x229c54['send'];_0x229c54[_0x59d27a(0x2a8)]=_0x167d5c=>(this[_0x59d27a(0x30d)](),_0x39c3f1[_0x59d27a(0x410)](_0x229c54,[_0x167d5c])),_0x229c54[_0x59d27a(0x3c8)]['subscribe'](_0x2a6744=>this[_0x59d27a(0x3ad)](_0x229c54,_0x2a6744)),_0x229c54[_0x59d27a(0x2d2)]['pipe'](_0xd6074['take'](0x1))[_0x59d27a(0x239)](_0x573487=>this[_0x59d27a(0x4dc)][_0x59d27a(0x3f5)](_0x59d27a(0x556),_0x573487)),_0x229c54[_0x59d27a(0x3fb)][_0x59d27a(0x24d)](_0xd6074[_0x59d27a(0x390)](0x1))[_0x59d27a(0x239)](()=>{var _0x5b8271=_0x59d27a;this[_0x5b8271(0x305)](_0x229c54);}),_0x229c54[_0x59d27a(0x4c1)][_0x59d27a(0x24d)](_0xd6074[_0x59d27a(0x390)](0x1))[_0x59d27a(0x239)](_0x2200f7=>{var _0x504bc3=_0x59d27a;this[_0x504bc3(0x4dc)][_0x504bc3(0x206)](_0x504bc3(0x2e7),_0x504bc3(0x1fc),_0x2200f7),this[_0x504bc3(0x4eb)]();});}}catch(_0x5e164f){this[_0x59d27a(0x4dc)][_0x59d27a(0x3f5)](_0x5e164f),this[_0x59d27a(0x4eb)]();}}[_0x3d1808(0x305)](_0x1988a9){var _0x2f08f4=_0x3d1808;this[_0x2f08f4(0x4dc)]['debug'](_0x2f08f4(0x2e7),'socket\x20open.'),_0x1988a9[_0x2f08f4(0x2a8)]({'cmd':_0x46dd39[_0x2f08f4(0x416)]}),this[_0x2f08f4(0x30d)]();}['_onOffline'](){var _0x52496b=_0x3d1808;this[_0x52496b(0x38c)]=!0x1,this[_0x52496b(0x2a7)]=null,this[_0x52496b(0x284)][_0x52496b(0x543)](_0x4b7463['OFFLINE']),this[_0x52496b(0x47f)][_0x52496b(0x543)](null),this[_0x52496b(0x2ee)](),this['_clearHeartbeatTimer']();}[_0x3d1808(0x4eb)](){var _0x24860e=_0x3d1808,_0xa7094c;this[_0x24860e(0x4ca)](),this['_retryCount']<((_0xa7094c=this[_0x24860e(0x4ee)][_0x24860e(0x38b)](_0x589908))!=null?_0xa7094c:0x3)?(this[_0x24860e(0x387)][_0x24860e(0x3e2)]({'id':_0x38090c['SOCKET_FAILED_RETRY']}),this[_0x24860e(0x468)]()):this['_collaborationUIEventService'][_0x24860e(0x3e2)]({'id':_0x38090c[_0x24860e(0x460)]});}[_0x3d1808(0x468)](){var _0x295feb=_0x3d1808,_0x5669c6;const _0x2f8c38=this[_0x295feb(0x4e5)],_0xf1c089=this[_0x295feb(0x4ee)][_0x295feb(0x38b)](_0x755dce),_0x1ebfbc=_0x2f8c38===0x0?0x0:((_0x5669c6=_0xf1c089==null?void 0x0:_0xf1c089['retryConnectingInterval'])!=null?_0x5669c6:0x4e20)*0x2**_0x2f8c38;this['_retryConnectingTimer']=setTimeout(()=>{var _0x427185=_0x295feb;clearTimeout(this[_0x427185(0x463)]),this[_0x427185(0x463)]=null,this[_0x427185(0x288)]();},_0x1ebfbc),this[_0x295feb(0x4e5)]+=0x1;}[_0x3d1808(0x3ad)](_0x42cd48,_0x4f3225){var _0x3e89cc=_0x3d1808;const {cmd:_0x5325b6}=_0x4f3225;_0x5325b6===_0x46dd39[_0x3e89cc(0x416)]&&!this[_0x3e89cc(0x38c)]&&(_0x42cd48[_0x3e89cc(0x3e9)]=_0x4f3225[_0x3e89cc(0x285)][_0x3e89cc(0x3e9)],this[_0x3e89cc(0x47f)][_0x3e89cc(0x543)](_0x42cd48),this[_0x3e89cc(0x284)]['next'](_0x4b7463[_0x3e89cc(0x2d4)]),this[_0x3e89cc(0x38c)]=!0x0,this[_0x3e89cc(0x2a7)]=null),_0x5325b6===_0x46dd39[_0x3e89cc(0x392)]&&this[_0x3e89cc(0x2ee)](),this[_0x3e89cc(0x30d)]();}[_0x3d1808(0x30d)](){var _0x2dc102=_0x3d1808,_0x51bfa8;this[_0x2dc102(0x301)](),this[_0x2dc102(0x52c)]=setTimeout(()=>this[_0x2dc102(0x3a1)](),(_0x51bfa8=this['_configService'][_0x2dc102(0x38b)](_0x38c58d))!=null?_0x51bfa8:0x7530);}['_sendHeartbeat'](){var _0x374c31=_0x3d1808;this['_socket'][_0x374c31(0x2a8)]({'cmd':_0x46dd39[_0x374c31(0x392)]}),this['_waitForHeartbeatResponse']();}[_0x3d1808(0x2ac)](){var _0x4cc43a=_0x3d1808,_0xc29997;this[_0x4cc43a(0x22e)]=setTimeout(()=>this[_0x4cc43a(0x4eb)](),(_0xc29997=this[_0x4cc43a(0x4ee)]['getConfig'](_0x3d06ad))!=null?_0xc29997:0x4e20);}[_0x3d1808(0x301)](){var _0x20a3ad=_0x3d1808;this[_0x20a3ad(0x52c)]!=null&&(clearTimeout(this['_sendHeartbeatTimer']),this[_0x20a3ad(0x52c)]=null);}[_0x3d1808(0x2ee)](){var _0x212729=_0x3d1808;this[_0x212729(0x22e)]!=null&&(clearTimeout(this['_timeoutTimer']),this[_0x212729(0x22e)]=null);}},_0x1065a7[_0x3d1808(0x492)]=_0x4dbe5b([_0x3ff668(0x0,_0x5bafa4['Inject'](_0x5bafa4[_0x3d1808(0x511)])),_0x3ff668(0x1,_0x5bafa4[_0x3d1808(0x528)]),_0x3ff668(0x2,_0x5bafa4['IConfigService']),_0x3ff668(0x3,_0x3dca45),_0x3ff668(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x10cfe4)),_0x3ff668(0x5,_0x5bafa4[_0x3d1808(0x4fa)](_0x206d80))],_0x1065a7[_0x3d1808(0x492)]);var _0x24590c=Object[_0x3d1808(0x3cf)],_0x31ea7e=(_0x125b51,_0x512cec,_0x4e09d1,_0x10b91f)=>{var _0x5281bf=_0x3d1808;for(var _0x49ec9b=_0x10b91f>0x1?void 0x0:_0x10b91f?_0x24590c(_0x512cec,_0x4e09d1):_0x512cec,_0x14564e=_0x125b51[_0x5281bf(0x3c5)]-0x1,_0x4f75e9;_0x14564e>=0x0;_0x14564e--)(_0x4f75e9=_0x125b51[_0x14564e])&&(_0x49ec9b=_0x4f75e9(_0x49ec9b)||_0x49ec9b);return _0x49ec9b;},_0x35aab3=(_0x5a85c8,_0x1b3c91)=>(_0x26b7d2,_0x5b3eb9)=>_0x1b3c91(_0x26b7d2,_0x5b3eb9,_0x5a85c8);_0x1065a7[_0x3d1808(0x54f)]=class extends _0x5bafa4['RxDisposable']{constructor(_0x160966,_0x1172ae,_0x565e86,_0x237004){var _0x167aa1=_0x3d1808,_0xf881fe;super(),_0x3fc7c7(this,_0x167aa1(0x1f9),new Map()),_0x3fc7c7(this,_0x167aa1(0x205),new _0x1a688c[(_0x167aa1(0x546))]()),_0x3fc7c7(this,_0x167aa1(0x324),this[_0x167aa1(0x205)][_0x167aa1(0x340)]()),(this['_injector']=_0x160966,this[_0x167aa1(0x270)]=_0x1172ae,this[_0x167aa1(0x4ee)]=_0x565e86,this[_0x167aa1(0x4b8)]=_0x237004,((_0xf881fe=this['_configService'][_0x167aa1(0x38b)](_0x755dce))==null?void 0x0:_0xf881fe[_0x167aa1(0x3da)])!==!0x1&&this[_0x167aa1(0x3b8)]());}[_0x3d1808(0x508)](){var _0x5a3c71=_0x3d1808;super[_0x5a3c71(0x508)](),this[_0x5a3c71(0x1f9)][_0x5a3c71(0x27c)](_0x6dbfd=>_0x6dbfd[_0x5a3c71(0x508)]()),this[_0x5a3c71(0x1f9)][_0x5a3c71(0x334)]();}[_0x3d1808(0x20f)](_0x12b64b){var _0x347663=_0x3d1808,_0x336c07;return(_0x336c07=this['_entities'][_0x347663(0x3f0)](_0x12b64b))!=null?_0x336c07:null;}['getCollabEntity$'](_0x412cf1){var _0x1b6b6a=_0x3d1808;const _0x2aa862=this[_0x1b6b6a(0x20f)](_0x412cf1);return _0x2aa862?_0x1a688c['of'](_0x2aa862):this['_entityInit$'][_0x1b6b6a(0x24d)](_0xd6074[_0x1b6b6a(0x3d2)](_0x5afbef=>_0x5afbef['unitID']===_0x412cf1));}['readyForCollab'](_0x2d4433){var _0x41db58=_0x3d1808;return _0x1a688c['firstValueFrom'](this[_0x41db58(0x2e4)](_0x2d4433)[_0x41db58(0x24d)](_0xd6074[_0x41db58(0x51a)](()=>{})));}[_0x3d1808(0x3b8)](){var _0x25996c=_0x3d1808;this[_0x25996c(0x4b8)][_0x25996c(0x571)](_0x5bafa4[_0x25996c(0x35e)][_0x25996c(0x246)])['pipe'](_0x1a688c[_0x25996c(0x520)](this[_0x25996c(0x39e)]),_0xd6074[_0x25996c(0x54d)](0x10))[_0x25996c(0x239)](async _0x4dc398=>{var _0xa223a1=_0x25996c;const _0x28e851=_0x4dc398[_0xa223a1(0x323)](),_0x31721a=await this['_startCollaboration'](_0x28e851,_0x32e542[_0xa223a1(0x246)]);this[_0xa223a1(0x1f9)][_0xa223a1(0x373)](_0x28e851,_0x31721a);}),this['_univerInstanceService'][_0x25996c(0x571)](_0x5bafa4[_0x25996c(0x35e)][_0x25996c(0x25d)])[_0x25996c(0x24d)](_0x1a688c['takeUntil'](this[_0x25996c(0x39e)]),_0xd6074[_0x25996c(0x54d)](0x10))[_0x25996c(0x24d)](_0xd6074[_0x25996c(0x3d2)](_0x515e9f=>!_0x515e9f['getUnitId']()[_0x25996c(0x2ae)]('__')))[_0x25996c(0x239)](async _0x3aea00=>{var _0x5b6324=_0x25996c;const _0x4d15ba=_0x3aea00['getUnitId'](),_0x14a46d=await this[_0x5b6324(0x53c)](_0x4d15ba,_0x32e542[_0x5b6324(0x25d)]);this[_0x5b6324(0x1f9)][_0x5b6324(0x373)](_0x4d15ba,_0x14a46d);}),_0x1a688c[_0x25996c(0x46c)](this['_univerInstanceService'][_0x25996c(0x1e5)](_0x5bafa4[_0x25996c(0x35e)][_0x25996c(0x246)]),this[_0x25996c(0x4b8)][_0x25996c(0x1e5)](_0x5bafa4[_0x25996c(0x35e)]['UNIVER_DOC']))['pipe'](_0x1a688c[_0x25996c(0x520)](this['dispose$']))[_0x25996c(0x239)](_0x48e986=>{var _0x3b15b9=_0x25996c;const _0x1ba1c2=_0x48e986['getUnitId'](),_0x1f61fd=this[_0x3b15b9(0x1f9)]['get'](_0x1ba1c2);_0x1f61fd&&(_0x1f61fd[_0x3b15b9(0x508)](),this[_0x3b15b9(0x1f9)][_0x3b15b9(0x33a)](_0x1ba1c2));});}async[_0x3d1808(0x53c)](_0xf20f6a,_0x533c0d){var _0x1d8398=_0x3d1808;const _0x2ca723=await this[_0x1d8398(0x270)]['requireSession'](_0xf20f6a),_0x519f4b=this['_injector'][_0x1d8398(0x3af)](this[_0x1d8398(0x540)](_0x533c0d),_0xf20f6a,_0x533c0d,_0x2ca723);return await _0x519f4b[_0x1d8398(0x456)](),this[_0x1d8398(0x205)][_0x1d8398(0x543)](_0x519f4b),_0x519f4b;}[_0x3d1808(0x540)](_0x85ebf1){var _0x39e085=_0x3d1808;switch(_0x85ebf1){case _0x32e542[_0x39e085(0x25d)]:return _0x1065a7[_0x39e085(0x1e2)];case _0x32e542[_0x39e085(0x246)]:return _0x1065a7[_0x39e085(0x2b2)];default:throw new Error(_0x39e085(0x447)+_0x85ebf1);}}},_0x1065a7[_0x3d1808(0x54f)]=_0x31ea7e([_0x35aab3(0x0,_0x5bafa4['Inject'](_0x5bafa4['Injector'])),_0x35aab3(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x1065a7[_0x3d1808(0x492)])),_0x35aab3(0x2,_0x5bafa4[_0x3d1808(0x34c)]),_0x35aab3(0x3,_0x5bafa4[_0x3d1808(0x443)])],_0x1065a7['CollaborationController']);var _0x41d182=Object[_0x3d1808(0x3cf)],_0x341c67=(_0x721b49,_0x4e299f,_0x3c6a6a,_0xa9fb3b)=>{var _0x4ccf4e=_0x3d1808;for(var _0x15ca73=_0xa9fb3b>0x1?void 0x0:_0xa9fb3b?_0x41d182(_0x4e299f,_0x3c6a6a):_0x4e299f,_0x4e7419=_0x721b49[_0x4ccf4e(0x3c5)]-0x1,_0x104ad6;_0x4e7419>=0x0;_0x4e7419--)(_0x104ad6=_0x721b49[_0x4e7419])&&(_0x15ca73=_0x104ad6(_0x15ca73)||_0x15ca73);return _0x15ca73;},_0xd837c3=(_0x54e0a8,_0x86a765)=>(_0x12aa1c,_0x4d96bc)=>_0x86a765(_0x12aa1c,_0x4d96bc,_0x54e0a8);const _0x24df6a=_0x3d1808(0x1ee),_0x12526f=_0x3d1808(0x28d);let _0x2ed31f=class extends _0x5bafa4['Disposable']{constructor(_0x27929e,_0x5d5d19){var _0x1ed889=_0x3d1808;super(),this[_0x1ed889(0x4b8)]=_0x27929e,this[_0x1ed889(0x4ee)]=_0x5d5d19,this[_0x1ed889(0x3b8)]();}['_init'](){var _0x51d8ad=_0x3d1808;this[_0x51d8ad(0x44e)](this[_0x51d8ad(0x4b8)][_0x51d8ad(0x286)]['subscribe'](()=>{var _0x813891=_0x51d8ad,_0x4596d8;const _0x20ac0b=this[_0x813891(0x4b8)][_0x813891(0x29b)]();let _0x4de574=(_0x4596d8=this['_configService']['getConfig'](_0x24df6a))!=null?_0x4596d8:_0x12526f;_0x20ac0b instanceof _0x5bafa4[_0x813891(0x2a0)]&&(_0x4de574=_0x20ac0b['name']),document['title']=_0x4de574;}));}};_0x2ed31f=_0x341c67([_0xd837c3(0x0,_0x5bafa4[_0x3d1808(0x443)]),_0xd837c3(0x1,_0x5bafa4[_0x3d1808(0x34c)])],_0x2ed31f);var _0x22fdc8=Object[_0x3d1808(0x3cf)],_0x2734d9=(_0x1294fd,_0x385177,_0x42a63a,_0x48284a)=>{var _0x2271cb=_0x3d1808;for(var _0x28a782=_0x48284a>0x1?void 0x0:_0x48284a?_0x22fdc8(_0x385177,_0x42a63a):_0x385177,_0xa1dfe5=_0x1294fd[_0x2271cb(0x3c5)]-0x1,_0x6e2a21;_0xa1dfe5>=0x0;_0xa1dfe5--)(_0x6e2a21=_0x1294fd[_0xa1dfe5])&&(_0x28a782=_0x6e2a21(_0x28a782)||_0x28a782);return _0x28a782;},_0x2405c2=(_0x335734,_0xc2cfe4)=>(_0x621cf9,_0x4ab810)=>_0xc2cfe4(_0x621cf9,_0x4ab810,_0x335734);let _0x4dd8be=class{constructor(_0xf43e4f,_0x50e488,_0x249a6c){var _0x397844=_0x3d1808;this[_0x397844(0x4ee)]=_0xf43e4f,this[_0x397844(0x48b)]=_0x50e488,this['localeService']=_0x249a6c,this[_0x397844(0x456)]();}[_0x3d1808(0x456)](){var _0x2b9eff=_0x3d1808;this[_0x2b9eff(0x48b)][_0x2b9eff(0x252)]({'priority':0x1,'interceptor':(_0x3d77e7,_0x4998f2)=>_0x4998f2(_0x3d77e7)[_0x2b9eff(0x24d)](_0x1a688c[_0x2b9eff(0x440)](async _0x2d858c=>{var _0x1631ad=_0x2b9eff;const _0x4df792=_0x2d858c;if(_0x4df792[_0x1631ad(0x37c)]===0x191){if(typeof window>'u')throw new Error(_0x1631ad(0x4d9));if(window[_0x1631ad(0x454)](this['localeService']['t'](_0x1631ad(0x36a)))){const _0x530c4c=window['encodeURIComponent'](window['location'][_0x1631ad(0x4cd)]);window['location'][_0x1631ad(0x4cd)]=this[_0x1631ad(0x277)]()+_0x1631ad(0x51c)+_0x530c4c;}}return _0x4df792;}))});}[_0x3d1808(0x277)](){var _0x9dfd5c=_0x3d1808,_0x17801d;const _0x3c9022=this[_0x9dfd5c(0x4ee)][_0x9dfd5c(0x38b)](_0x755dce);return(_0x17801d=_0x3c9022==null?void 0x0:_0x3c9022['loginUrlKey'])!=null?_0x17801d:_0x35a1a3;}};_0x4dd8be=_0x2734d9([_0x2405c2(0x0,_0x5bafa4[_0x3d1808(0x34c)]),_0x2405c2(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x24f178[_0x3d1808(0x2c9)])),_0x2405c2(0x2,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x2e1)]))],_0x4dd8be);var _0x10c815=Object[_0x3d1808(0x3cf)],_0xe0afab=(_0x4c0cce,_0x42f4a4,_0x52adc6,_0x200c87)=>{var _0x309c92=_0x3d1808;for(var _0x5edf4a=_0x200c87>0x1?void 0x0:_0x200c87?_0x10c815(_0x42f4a4,_0x52adc6):_0x42f4a4,_0x3b184b=_0x4c0cce[_0x309c92(0x3c5)]-0x1,_0x317211;_0x3b184b>=0x0;_0x3b184b--)(_0x317211=_0x4c0cce[_0x3b184b])&&(_0x5edf4a=_0x317211(_0x5edf4a)||_0x5edf4a);return _0x5edf4a;},_0xda3f86=(_0x453c39,_0x9894bd)=>(_0x93ea30,_0x371f0c)=>_0x9894bd(_0x93ea30,_0x371f0c,_0x453c39);const _0x31c5f9=_0x3d1808(0x318);_0x1065a7[_0x3d1808(0x346)]=class extends _0x5bafa4[_0x3d1808(0x40c)]{constructor(_0x3a1b60,_0x505eb1){var _0x45f17a=_0x3d1808;super(),this[_0x45f17a(0x412)]=_0x3a1b60,this[_0x45f17a(0x4ee)]=_0x505eb1,this['_initMergeInterceptor']();}['_initMergeInterceptor'](){var _0x1f6cba=_0x3d1808;const _0x16a756=this;this[_0x1f6cba(0x44e)](this[_0x1f6cba(0x412)]['registerHTTPInterceptor']({'priority':0x3e7,'interceptor':_0x24f178[_0x1f6cba(0x27f)]({'isMatch'(_0x377ef4){var _0x28f150=_0x1f6cba,_0x3dc056;if(_0x377ef4[_0x28f150(0x40a)]==='POST'&&((_0x3dc056=_0x377ef4[_0x28f150(0x377)])!=null&&_0x3dc056[_0x28f150(0x26c)])){const {objectID:_0x555f5c,objectType:_0x4f9e4f}=_0x377ef4[_0x28f150(0x377)][_0x28f150(0x26c)]||{};if(!_0x555f5c||_0x4f9e4f===void 0x0)return!0x1;const _0x7f08de=_0x16a756[_0x28f150(0x488)]()+'/'+_0x4f9e4f+_0x28f150(0x4af)+_0x555f5c+_0x28f150(0x455);if(_0x377ef4[_0x28f150(0x261)]===_0x7f08de)return!0x0;}return!0x1;},'getParamsFromRequest'(_0x329147){var _0x2bb1dd=_0x1f6cba,_0x2e47d5;return(_0x2e47d5=_0x329147[_0x2bb1dd(0x377)])==null?void 0x0:_0x2e47d5[_0x2bb1dd(0x26c)];},'mergeParamsToRequest'(_0x5600b2,_0xba5b59){var _0x1202a0=_0x1f6cba;const _0x57f406=_0x16a756['_getAPIPrefixPath']()+_0x1202a0(0x358),_0x760aa1=_0x5600b2[_0x1202a0(0x4e9)]((_0x3ae993,_0x27da0e)=>{var _0x115333=_0x1202a0;const {unitID:_0x34bcd8,objectID:_0xa4c730,objectType:_0x39a367,actions:_0x319031}=_0x27da0e;return _0x3ae993[_0x34bcd8]||(_0x3ae993[_0x34bcd8]={}),_0x3ae993[_0x34bcd8][_0xa4c730]||(_0x3ae993[_0x34bcd8][_0xa4c730]={'objectID':_0xa4c730,'objectType':_0x39a367,'actions':[]}),_0x3ae993[_0x34bcd8][_0xa4c730][_0x115333(0x37d)][_0x115333(0x381)](..._0x319031),_0x3ae993;},{}),_0x59702d=[];for(const _0x320ded in _0x760aa1)for(const _0x53c2e9 in _0x760aa1[_0x320ded]){const {actions:_0x3ef924,objectType:_0x18ad92}=_0x760aa1[_0x320ded][_0x53c2e9],_0x3bcc2a=[...new Set(_0x3ef924)];_0x59702d['push']({'unitID':_0x320ded,'objectID':_0x53c2e9,'objectType':_0x18ad92,'actions':_0x3bcc2a});}return new _0x24f178[(_0x1202a0(0x259))](_0x1202a0(0x292),_0x57f406,{'headers':_0xba5b59[_0x1202a0(0x3c4)],'withCredentials':_0xba5b59[_0x1202a0(0x202)],'responseType':_0xba5b59[_0x1202a0(0x4cc)],'body':{'requests':_0x59702d}});}},{'distributeResult'(_0x110cc1,_0x391ac6){var _0x5f4b62=_0x1f6cba;const {objectActions:_0x3af189}=_0x110cc1;return _0x391ac6[_0x5f4b62(0x51a)](_0x3aeca3=>{var _0xdedd4f=_0x5f4b62;const {unitID:_0x1f6b1c,objectID:_0x29656,actions:_0xac45f1}=_0x3aeca3,_0x259568=_0x3af189[_0xdedd4f(0x3b2)](_0x1849d5=>_0x1849d5[_0xdedd4f(0x345)]===_0x1f6b1c&&_0x1849d5[_0xdedd4f(0x34e)]===_0x29656),_0x4e936b=_0xac45f1[_0xdedd4f(0x51a)](_0x213761=>_0x259568==null?void 0x0:_0x259568[_0xdedd4f(0x37d)][_0xdedd4f(0x3b2)](_0x40b27b=>_0x40b27b[_0xdedd4f(0x335)]===_0x213761))[_0xdedd4f(0x3d2)](_0x3b6468=>!!_0x3b6468);return{'config':_0x3aeca3,'result':{'actions':_0x4e936b,'error':_0x110cc1[_0xdedd4f(0x3f5)]}};});}})}));}['_getAPIPrefixPath'](){var _0x4f3b6f=_0x3d1808,_0x22e101;const _0xdf9603=this[_0x4f3b6f(0x4ee)][_0x4f3b6f(0x38b)](_0x755dce);return(_0x22e101=_0xdf9603==null?void 0x0:_0xdf9603[_0x4f3b6f(0x399)])!=null?_0x22e101:_0x31c5f9;}async[_0x3d1808(0x46f)](_0x379736){var _0x189281=_0x3d1808;const _0x22ce2f=this[_0x189281(0x488)]()+'/'+_0x379736[_0x189281(0x475)]+_0x189281(0x21d);return(await this['_HTTPService'][_0x189281(0x2df)](_0x22ce2f,{'body':_0x379736}))[_0x189281(0x26c)][_0x189281(0x34e)]||'';}async[_0x3d1808(0x504)](_0x1026e1){var _0xeb1a32=_0x3d1808;const _0xdfbe5b=this['_getAPIPrefixPath']()+_0xeb1a32(0x549);return(await this[_0xeb1a32(0x412)][_0xeb1a32(0x2df)](_0xdfbe5b,{'body':_0x1026e1}))[_0xeb1a32(0x26c)][_0xeb1a32(0x499)];}async['update'](_0x9062a7){var _0x322fdb=_0x3d1808,_0x1fa674,_0x5b5466;const _0x4e79a5=this['_getAPIPrefixPath']()+'/'+_0x9062a7[_0x322fdb(0x475)]+'/object/'+_0x9062a7[_0x322fdb(0x34e)],_0x59038c=await this['_HTTPService'][_0x322fdb(0x200)](_0x4e79a5,{'body':_0x9062a7});if(((_0x5b5466=(_0x1fa674=_0x59038c==null?void 0x0:_0x59038c[_0x322fdb(0x26c)])==null?void 0x0:_0x1fa674[_0x322fdb(0x3f5)])==null?void 0x0:_0x5b5466[_0x322fdb(0x24b)])!==0x1)throw new Error(_0x322fdb(0x3a7));}async[_0x3d1808(0x1ed)](_0x5b0ae0){var _0x2c9968=_0x3d1808;const _0x28162f=this['_getAPIPrefixPath']()+'/'+_0x5b0ae0[_0x2c9968(0x475)]+_0x2c9968(0x4af)+_0x5b0ae0['objectID']+_0x2c9968(0x455);return(await this[_0x2c9968(0x412)][_0x2c9968(0x2df)](_0x28162f,{'body':_0x5b0ae0}))['body']['actions'];}async['batchAllowed'](_0x5bd9f4){var _0x569386=_0x3d1808;const _0x30eda5=this[_0x569386(0x488)]()+_0x569386(0x358);return(await this[_0x569386(0x412)][_0x569386(0x2df)](_0x30eda5,{'body':{'requests':_0x5bd9f4}}))[_0x569386(0x26c)][_0x569386(0x4e1)];}async[_0x3d1808(0x351)](_0x358d9d){var _0x1e669d=_0x3d1808;const _0x2a744f=this[_0x1e669d(0x488)]()+'/'+_0x358d9d[_0x1e669d(0x475)]+_0x1e669d(0x420),_0x59ada8=await this['_HTTPService']['post'](_0x2a744f,{'body':_0x358d9d});return{'roles':_0x59ada8[_0x1e669d(0x26c)][_0x1e669d(0x496)],'actions':_0x59ada8['body'][_0x1e669d(0x37d)]};}async[_0x3d1808(0x36e)](_0x70083e){var _0x3034fc=_0x3d1808;const _0x119331=this['_getAPIPrefixPath']()+_0x3034fc(0x22a);await this[_0x3034fc(0x412)]['delete'](_0x119331,{'params':{'collaboratorID':_0x70083e['collaboratorID'],'objectID':_0x70083e[_0x3034fc(0x34e)],'unitID':_0x70083e['unitID']}});}async[_0x3d1808(0x380)](_0x4234eb){var _0x154bfa=_0x3d1808;const _0x3df009=this[_0x154bfa(0x488)]()+_0x154bfa(0x22a);await this[_0x154bfa(0x412)]['patch'](_0x3df009,{'body':_0x4234eb});}async['createCollaborator'](_0x492608){var _0x157c77=_0x3d1808;const _0x27a264=this[_0x157c77(0x488)]()+_0x157c77(0x22a);await this[_0x157c77(0x412)][_0x157c77(0x2df)](_0x27a264,{'body':_0x492608});}async[_0x3d1808(0x322)](_0x128ef7){var _0x147dae=_0x3d1808;const _0x30efb3=this['_getAPIPrefixPath']()+_0x147dae(0x22a);return(await this[_0x147dae(0x412)][_0x147dae(0x3f0)](_0x30efb3,{'params':{'objectID':_0x128ef7[_0x147dae(0x34e)],'unitID':_0x128ef7[_0x147dae(0x345)]}}))[_0x147dae(0x26c)][_0x147dae(0x20d)];}async[_0x3d1808(0x42c)](_0x2d26af){var _0x76fb7=_0x3d1808;const _0x54e70b=this[_0x76fb7(0x488)]()+_0x76fb7(0x22a);await this[_0x76fb7(0x412)][_0x76fb7(0x200)](_0x54e70b,{'body':_0x2d26af});}},_0x1065a7[_0x3d1808(0x346)]=_0xe0afab([_0xda3f86(0x0,_0x5bafa4[_0x3d1808(0x317)](_0x24f178[_0x3d1808(0x2c9)])),_0xda3f86(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x34c)]))],_0x1065a7['AuthzIoHttpService']);var _0x9c23c3=typeof globalThis<'u'?globalThis:typeof window<'u'?window:typeof global<'u'?global:typeof self<'u'?self:{};function _0x14f116(_0x580e86){var _0x436093=_0x3d1808;return _0x580e86&&_0x580e86['__esModule']&&Object[_0x436093(0x236)][_0x436093(0x2b4)][_0x436093(0x37a)](_0x580e86,_0x436093(0x32d))?_0x580e86[_0x436093(0x32d)]:_0x580e86;}var _0x692448={'exports':{}};function _0x474c64(_0x35fd1b){var _0x238e0f=_0x3d1808;throw new Error(_0x238e0f(0x272)+_0x35fd1b+_0x238e0f(0x262));}var _0x3124de={'exports':{}},_0xd4d5c4=_0x3124de['exports'],_0x13502d;function _0x1257fc(){var _0x4735df=_0x3d1808;return _0x13502d||(_0x13502d=0x1,function(_0x4c0c69,_0x2d5646){(function(_0x33c5f6,_0x47a70d){var _0x2d9365=_0x58ee;_0x4c0c69[_0x2d9365(0x1f7)]=_0x47a70d();}(_0xd4d5c4,function(){var _0x593a86=_0x593a86||function(_0x44a2a1,_0xa49f6e){var _0x870886=_0x58ee,_0x52ce10;if(typeof window<'u'&&window['crypto']&&(_0x52ce10=window[_0x870886(0x533)]),typeof self<'u'&&self['crypto']&&(_0x52ce10=self[_0x870886(0x533)]),typeof globalThis<'u'&&globalThis[_0x870886(0x533)]&&(_0x52ce10=globalThis['crypto']),!_0x52ce10&&typeof window<'u'&&window['msCrypto']&&(_0x52ce10=window['msCrypto']),!_0x52ce10&&typeof _0x9c23c3<'u'&&_0x9c23c3[_0x870886(0x533)]&&(_0x52ce10=_0x9c23c3['crypto']),!_0x52ce10&&typeof _0x474c64==_0x870886(0x32a))try{_0x52ce10=require('crypto');}catch{}var _0x1cc06f=function(){var _0x1ca23a=_0x870886;if(_0x52ce10){if(typeof _0x52ce10[_0x1ca23a(0x2b8)]==_0x1ca23a(0x32a))try{return _0x52ce10['getRandomValues'](new Uint32Array(0x1))[0x0];}catch{}if(typeof _0x52ce10[_0x1ca23a(0x253)]==_0x1ca23a(0x32a))try{return _0x52ce10[_0x1ca23a(0x253)](0x4)[_0x1ca23a(0x4ac)]();}catch{}}throw new Error(_0x1ca23a(0x28c));},_0x2febba=Object[_0x870886(0x46f)]||(function(){function _0x3b00b3(){}return function(_0x5bd3a0){var _0x192c2f=_0x58ee,_0x4a61ba;return _0x3b00b3['prototype']=_0x5bd3a0,_0x4a61ba=new _0x3b00b3(),_0x3b00b3[_0x192c2f(0x236)]=null,_0x4a61ba;};}()),_0x55f658={},_0x3f21a7=_0x55f658[_0x870886(0x1fd)]={},_0x665ea4=_0x3f21a7[_0x870886(0x3c1)]=(function(){return{'extend':function(_0x7329ea){var _0x389d7c=_0x58ee,_0x73eec5=_0x2febba(this);return _0x7329ea&&_0x73eec5['mixIn'](_0x7329ea),(!_0x73eec5[_0x389d7c(0x2b4)](_0x389d7c(0x456))||this['init']===_0x73eec5[_0x389d7c(0x456)])&&(_0x73eec5['init']=function(){var _0x376206=_0x389d7c;_0x73eec5[_0x376206(0x521)][_0x376206(0x456)]['apply'](this,arguments);}),_0x73eec5['init'][_0x389d7c(0x236)]=_0x73eec5,_0x73eec5['$super']=this,_0x73eec5;},'create':function(){var _0x24c210=_0x58ee,_0x4eab8a=this[_0x24c210(0x34d)]();return _0x4eab8a[_0x24c210(0x456)]['apply'](_0x4eab8a,arguments),_0x4eab8a;},'init':function(){},'mixIn':function(_0x4926b5){var _0x24aeb0=_0x58ee;for(var _0x3e2934 in _0x4926b5)_0x4926b5[_0x24aeb0(0x2b4)](_0x3e2934)&&(this[_0x3e2934]=_0x4926b5[_0x3e2934]);_0x4926b5[_0x24aeb0(0x2b4)]('toString')&&(this[_0x24aeb0(0x250)]=_0x4926b5['toString']);},'clone':function(){var _0x1ddea4=_0x58ee;return this[_0x1ddea4(0x456)]['prototype'][_0x1ddea4(0x34d)](this);}};}()),_0x34dec6=_0x3f21a7[_0x870886(0x273)]=_0x665ea4[_0x870886(0x34d)]({'init':function(_0x106d21,_0x32c472){var _0x3646ed=_0x870886;_0x106d21=this[_0x3646ed(0x240)]=_0x106d21||[],_0x32c472!=_0xa49f6e?this['sigBytes']=_0x32c472:this['sigBytes']=_0x106d21[_0x3646ed(0x3c5)]*0x4;},'toString':function(_0x64d5f1){var _0x4adc33=_0x870886;return(_0x64d5f1||_0x5f1025)[_0x4adc33(0x3c7)](this);},'concat':function(_0x23b8ef){var _0x230156=_0x870886,_0x3859ed=this[_0x230156(0x240)],_0x5ebc2a=_0x23b8ef['words'],_0x59d1ec=this[_0x230156(0x4f8)],_0xf52a7c=_0x23b8ef[_0x230156(0x4f8)];if(this['clamp'](),_0x59d1ec%0x4)for(var _0x27423f=0x0;_0x27423f<_0xf52a7c;_0x27423f++){var _0x49ca17=_0x5ebc2a[_0x27423f>>>0x2]>>>0x18-_0x27423f%0x4*0x8&0xff;_0x3859ed[_0x59d1ec+_0x27423f>>>0x2]|=_0x49ca17<<0x18-(_0x59d1ec+_0x27423f)%0x4*0x8;}else{for(var _0x1635b3=0x0;_0x1635b3<_0xf52a7c;_0x1635b3+=0x4)_0x3859ed[_0x59d1ec+_0x1635b3>>>0x2]=_0x5ebc2a[_0x1635b3>>>0x2];}return this['sigBytes']+=_0xf52a7c,this;},'clamp':function(){var _0x56e115=_0x870886,_0x3cd423=this[_0x56e115(0x240)],_0x426ead=this[_0x56e115(0x4f8)];_0x3cd423[_0x426ead>>>0x2]&=0xffffffff<<0x20-_0x426ead%0x4*0x8,_0x3cd423['length']=_0x44a2a1[_0x56e115(0x33e)](_0x426ead/0x4);},'clone':function(){var _0x135899=_0x870886,_0x219c3f=_0x665ea4['clone']['call'](this);return _0x219c3f[_0x135899(0x240)]=this[_0x135899(0x240)][_0x135899(0x3f8)](0x0),_0x219c3f;},'random':function(_0x5b4652){var _0x2fad71=_0x870886;for(var _0x213a43=[],_0x11763a=0x0;_0x11763a<_0x5b4652;_0x11763a+=0x4)_0x213a43[_0x2fad71(0x381)](_0x1cc06f());return new _0x34dec6[(_0x2fad71(0x456))](_0x213a43,_0x5b4652);}}),_0x3e52e5=_0x55f658[_0x870886(0x30e)]={},_0x5f1025=_0x3e52e5[_0x870886(0x1ea)]={'stringify':function(_0x10083f){var _0x55d19e=_0x870886;for(var _0x35f6ec=_0x10083f['words'],_0x59b889=_0x10083f[_0x55d19e(0x4f8)],_0x27c3ca=[],_0x4f066b=0x0;_0x4f066b<_0x59b889;_0x4f066b++){var _0x33563f=_0x35f6ec[_0x4f066b>>>0x2]>>>0x18-_0x4f066b%0x4*0x8&0xff;_0x27c3ca[_0x55d19e(0x381)]((_0x33563f>>>0x4)[_0x55d19e(0x250)](0x10)),_0x27c3ca[_0x55d19e(0x381)]((_0x33563f&0xf)[_0x55d19e(0x250)](0x10));}return _0x27c3ca[_0x55d19e(0x47c)]('');},'parse':function(_0xb8ba1b){var _0xcbc14e=_0x870886;for(var _0x458a00=_0xb8ba1b[_0xcbc14e(0x3c5)],_0xca22f6=[],_0x361270=0x0;_0x361270<_0x458a00;_0x361270+=0x2)_0xca22f6[_0x361270>>>0x3]|=parseInt(_0xb8ba1b[_0xcbc14e(0x432)](_0x361270,0x2),0x10)<<0x18-_0x361270%0x8*0x4;return new _0x34dec6[(_0xcbc14e(0x456))](_0xca22f6,_0x458a00/0x2);}},_0x43aec1=_0x3e52e5[_0x870886(0x25c)]={'stringify':function(_0x1790d8){var _0x2bf803=_0x870886;for(var _0x38355a=_0x1790d8[_0x2bf803(0x240)],_0x10d382=_0x1790d8[_0x2bf803(0x4f8)],_0x5dc1ca=[],_0x3b8503=0x0;_0x3b8503<_0x10d382;_0x3b8503++){var _0x5c02e0=_0x38355a[_0x3b8503>>>0x2]>>>0x18-_0x3b8503%0x4*0x8&0xff;_0x5dc1ca[_0x2bf803(0x381)](String['fromCharCode'](_0x5c02e0));}return _0x5dc1ca['join']('');},'parse':function(_0x4beecd){var _0x308161=_0x870886;for(var _0x222ae2=_0x4beecd[_0x308161(0x3c5)],_0x437814=[],_0x273913=0x0;_0x273913<_0x222ae2;_0x273913++)_0x437814[_0x273913>>>0x2]|=(_0x4beecd[_0x308161(0x4a4)](_0x273913)&0xff)<<0x18-_0x273913%0x4*0x8;return new _0x34dec6['init'](_0x437814,_0x222ae2);}},_0x33da3c=_0x3e52e5[_0x870886(0x4ec)]={'stringify':function(_0x29deb9){var _0xaa1a8f=_0x870886;try{return decodeURIComponent(escape(_0x43aec1[_0xaa1a8f(0x3c7)](_0x29deb9)));}catch{throw new Error('Malformed\x20UTF-8\x20data');}},'parse':function(_0x51adec){return _0x43aec1['parse'](unescape(encodeURIComponent(_0x51adec)));}},_0x2ffae=_0x3f21a7[_0x870886(0x3bf)]=_0x665ea4[_0x870886(0x34d)]({'reset':function(){var _0x3fca07=_0x870886;this[_0x3fca07(0x38f)]=new _0x34dec6[(_0x3fca07(0x456))](),this[_0x3fca07(0x2cd)]=0x0;},'_append':function(_0x896e02){var _0x4e5e69=_0x870886;typeof _0x896e02==_0x4e5e69(0x2da)&&(_0x896e02=_0x33da3c[_0x4e5e69(0x43e)](_0x896e02)),this[_0x4e5e69(0x38f)][_0x4e5e69(0x4bb)](_0x896e02),this[_0x4e5e69(0x2cd)]+=_0x896e02[_0x4e5e69(0x4f8)];},'_process':function(_0x465472){var _0xffb040=_0x870886,_0x49084a,_0x35cd7d=this[_0xffb040(0x38f)],_0x5b28c4=_0x35cd7d['words'],_0xcfd9c4=_0x35cd7d[_0xffb040(0x4f8)],_0x5269d5=this[_0xffb040(0x56b)],_0x5b17ea=_0x5269d5*0x4,_0x133de8=_0xcfd9c4/_0x5b17ea;_0x465472?_0x133de8=_0x44a2a1['ceil'](_0x133de8):_0x133de8=_0x44a2a1['max']((_0x133de8|0x0)-this['_minBufferSize'],0x0);var _0x4b894b=_0x133de8*_0x5269d5,_0x1232ed=_0x44a2a1[_0xffb040(0x3f6)](_0x4b894b*0x4,_0xcfd9c4);if(_0x4b894b){for(var _0x1fcb26=0x0;_0x1fcb26<_0x4b894b;_0x1fcb26+=_0x5269d5)this[_0xffb040(0x3e5)](_0x5b28c4,_0x1fcb26);_0x49084a=_0x5b28c4[_0xffb040(0x2b3)](0x0,_0x4b894b),_0x35cd7d[_0xffb040(0x4f8)]-=_0x1232ed;}return new _0x34dec6[(_0xffb040(0x456))](_0x49084a,_0x1232ed);},'clone':function(){var _0x143f57=_0x870886,_0x384969=_0x665ea4[_0x143f57(0x4e8)]['call'](this);return _0x384969[_0x143f57(0x38f)]=this[_0x143f57(0x38f)][_0x143f57(0x4e8)](),_0x384969;},'_minBufferSize':0x0});_0x3f21a7[_0x870886(0x372)]=_0x2ffae[_0x870886(0x34d)]({'cfg':_0x665ea4[_0x870886(0x34d)](),'init':function(_0x197819){var _0x418244=_0x870886;this[_0x418244(0x221)]=this[_0x418244(0x221)][_0x418244(0x34d)](_0x197819),this[_0x418244(0x20a)]();},'reset':function(){var _0xd5efe7=_0x870886;_0x2ffae[_0xd5efe7(0x20a)][_0xd5efe7(0x37a)](this),this[_0xd5efe7(0x312)]();},'update':function(_0x2e5b30){var _0x1aa524=_0x870886;return this[_0x1aa524(0x39f)](_0x2e5b30),this[_0x1aa524(0x1e6)](),this;},'finalize':function(_0x40f87f){var _0x3ca933=_0x870886;_0x40f87f&&this[_0x3ca933(0x39f)](_0x40f87f);var _0x998f64=this[_0x3ca933(0x243)]();return _0x998f64;},'blockSize':0x10,'_createHelper':function(_0x3c1296){return function(_0x5da26b,_0x14e582){var _0x3d803=_0x58ee;return new _0x3c1296[(_0x3d803(0x456))](_0x14e582)['finalize'](_0x5da26b);};},'_createHmacHelper':function(_0x2f1e26){return function(_0x2c0676,_0xb89108){var _0x4c0b3c=_0x58ee;return new _0x1ce893['HMAC'][(_0x4c0b3c(0x456))](_0x2f1e26,_0xb89108)['finalize'](_0x2c0676);};}});var _0x1ce893=_0x55f658['algo']={};return _0x55f658;}(Math);return _0x593a86;}));}(_0x3124de)),_0x3124de[_0x4735df(0x1f7)];}var _0x3fbb19={'exports':{}},_0x55247a=_0x3fbb19[_0x3d1808(0x1f7)],_0x10875b;function _0x294be0(){var _0x4d3365=_0x3d1808;return _0x10875b||(_0x10875b=0x1,function(_0x4a9d46,_0x9901df){(function(_0x1fa050,_0x25fd2b){_0x4a9d46['exports']=_0x25fd2b(_0x1257fc());}(_0x55247a,function(_0x4f844b){var _0x48a4ac=_0x58ee;return(function(){var _0xdf0f8c=_0x58ee,_0x55942a=_0x4f844b,_0x11bafa=_0x55942a['lib'],_0x51b4e1=_0x11bafa[_0xdf0f8c(0x273)],_0x35a8a8=_0x55942a[_0xdf0f8c(0x30e)];_0x35a8a8['Base64']={'stringify':function(_0x23b49a){var _0x58cf14=_0xdf0f8c,_0xbedd1c=_0x23b49a[_0x58cf14(0x240)],_0x5537aa=_0x23b49a['sigBytes'],_0x462109=this[_0x58cf14(0x41e)];_0x23b49a[_0x58cf14(0x536)]();for(var _0xdd0c7a=[],_0x302fbd=0x0;_0x302fbd<_0x5537aa;_0x302fbd+=0x3)for(var _0x1906a9=_0xbedd1c[_0x302fbd>>>0x2]>>>0x18-_0x302fbd%0x4*0x8&0xff,_0x5d97a8=_0xbedd1c[_0x302fbd+0x1>>>0x2]>>>0x18-(_0x302fbd+0x1)%0x4*0x8&0xff,_0x70652a=_0xbedd1c[_0x302fbd+0x2>>>0x2]>>>0x18-(_0x302fbd+0x2)%0x4*0x8&0xff,_0x19166c=_0x1906a9<<0x10|_0x5d97a8<<0x8|_0x70652a,_0x1d8bd6=0x0;_0x1d8bd6<0x4&&_0x302fbd+_0x1d8bd6*0.75<_0x5537aa;_0x1d8bd6++)_0xdd0c7a[_0x58cf14(0x381)](_0x462109[_0x58cf14(0x3f7)](_0x19166c>>>0x6*(0x3-_0x1d8bd6)&0x3f));var _0x1e2928=_0x462109[_0x58cf14(0x3f7)](0x40);if(_0x1e2928){for(;_0xdd0c7a[_0x58cf14(0x3c5)]%0x4;)_0xdd0c7a[_0x58cf14(0x381)](_0x1e2928);}return _0xdd0c7a[_0x58cf14(0x47c)]('');},'parse':function(_0xed4b36){var _0x7adcf1=_0xdf0f8c,_0x3c8836=_0xed4b36[_0x7adcf1(0x3c5)],_0x37c270=this[_0x7adcf1(0x41e)],_0xaa8c9e=this[_0x7adcf1(0x244)];if(!_0xaa8c9e){_0xaa8c9e=this[_0x7adcf1(0x244)]=[];for(var _0x42060f=0x0;_0x42060f<_0x37c270['length'];_0x42060f++)_0xaa8c9e[_0x37c270['charCodeAt'](_0x42060f)]=_0x42060f;}var _0x426885=_0x37c270[_0x7adcf1(0x3f7)](0x40);if(_0x426885){var _0x5c3e81=_0xed4b36[_0x7adcf1(0x2fe)](_0x426885);_0x5c3e81!==-0x1&&(_0x3c8836=_0x5c3e81);}return _0x2313cb(_0xed4b36,_0x3c8836,_0xaa8c9e);},'_map':_0xdf0f8c(0x22b)};function _0x2313cb(_0x2e09bc,_0x4a0376,_0x30a472){var _0x3d092c=_0xdf0f8c;for(var _0x1cf1c2=[],_0x3584e4=0x0,_0x22d2d5=0x0;_0x22d2d5<_0x4a0376;_0x22d2d5++)if(_0x22d2d5%0x4){var _0x3d4b4f=_0x30a472[_0x2e09bc['charCodeAt'](_0x22d2d5-0x1)]<<_0x22d2d5%0x4*0x2,_0x541553=_0x30a472[_0x2e09bc[_0x3d092c(0x4a4)](_0x22d2d5)]>>>0x6-_0x22d2d5%0x4*0x2,_0x60f702=_0x3d4b4f|_0x541553;_0x1cf1c2[_0x3584e4>>>0x2]|=_0x60f702<<0x18-_0x3584e4%0x4*0x8,_0x3584e4++;}return _0x51b4e1['create'](_0x1cf1c2,_0x3584e4);}}()),_0x4f844b[_0x48a4ac(0x30e)][_0x48a4ac(0x330)];}));}(_0x3fbb19)),_0x3fbb19[_0x4d3365(0x1f7)];}var _0x1581bf={'exports':{}},_0x204bda=_0x1581bf['exports'],_0x371427;function _0x45d0e1(){var _0x8199d3=_0x3d1808;return _0x371427||(_0x371427=0x1,function(_0x49991f,_0x54f1de){(function(_0x583f5e,_0xa013ff){var _0x3373df=_0x58ee;_0x49991f[_0x3373df(0x1f7)]=_0xa013ff(_0x1257fc());}(_0x204bda,function(_0xc3dc6b){var _0x1bac3d=_0x58ee;return function(_0x4be436){var _0x11c2b7=_0x58ee,_0x16fe71=_0xc3dc6b,_0x4c3240=_0x16fe71[_0x11c2b7(0x1fd)],_0x568d87=_0x4c3240[_0x11c2b7(0x273)],_0x404e61=_0x4c3240['Hasher'],_0x38e8ba=_0x16fe71['algo'],_0x236537=[];(function(){var _0x51fa00=_0x11c2b7;for(var _0x1979a9=0x0;_0x1979a9<0x40;_0x1979a9++)_0x236537[_0x1979a9]=_0x4be436[_0x51fa00(0x3bd)](_0x4be436[_0x51fa00(0x4e3)](_0x1979a9+0x1))*0x100000000|0x0;}());var _0x431914=_0x38e8ba[_0x11c2b7(0x203)]=_0x404e61[_0x11c2b7(0x34d)]({'_doReset':function(){var _0x4b729c=_0x11c2b7;this[_0x4b729c(0x2a6)]=new _0x568d87[(_0x4b729c(0x456))]([0x67452301,0xefcdab89,0x98badcfe,0x10325476]);},'_doProcessBlock':function(_0x35ec24,_0x1a5359){for(var _0x4622f5=0x0;_0x4622f5<0x10;_0x4622f5++){var _0x6b09c7=_0x1a5359+_0x4622f5,_0x31d287=_0x35ec24[_0x6b09c7];_0x35ec24[_0x6b09c7]=(_0x31d287<<0x8|_0x31d287>>>0x18)&0xff00ff|(_0x31d287<<0x18|_0x31d287>>>0x8)&0xff00ff00;}var _0x1080ed=this['_hash']['words'],_0x4c94ea=_0x35ec24[_0x1a5359+0x0],_0xc46883=_0x35ec24[_0x1a5359+0x1],_0x5e667b=_0x35ec24[_0x1a5359+0x2],_0x25dd0d=_0x35ec24[_0x1a5359+0x3],_0x111e0f=_0x35ec24[_0x1a5359+0x4],_0x5cccdc=_0x35ec24[_0x1a5359+0x5],_0xc1a1f6=_0x35ec24[_0x1a5359+0x6],_0x34adb1=_0x35ec24[_0x1a5359+0x7],_0x3d7096=_0x35ec24[_0x1a5359+0x8],_0x39eeb8=_0x35ec24[_0x1a5359+0x9],_0x40eaeb=_0x35ec24[_0x1a5359+0xa],_0x375595=_0x35ec24[_0x1a5359+0xb],_0x4cf84d=_0x35ec24[_0x1a5359+0xc],_0x4d27d5=_0x35ec24[_0x1a5359+0xd],_0x4d0b1c=_0x35ec24[_0x1a5359+0xe],_0x9b7e92=_0x35ec24[_0x1a5359+0xf],_0x256f93=_0x1080ed[0x0],_0x22bc14=_0x1080ed[0x1],_0x30ceda=_0x1080ed[0x2],_0x3ccd38=_0x1080ed[0x3];_0x256f93=_0x21f60b(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x4c94ea,0x7,_0x236537[0x0]),_0x3ccd38=_0x21f60b(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0xc46883,0xc,_0x236537[0x1]),_0x30ceda=_0x21f60b(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x5e667b,0x11,_0x236537[0x2]),_0x22bc14=_0x21f60b(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x25dd0d,0x16,_0x236537[0x3]),_0x256f93=_0x21f60b(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x111e0f,0x7,_0x236537[0x4]),_0x3ccd38=_0x21f60b(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x5cccdc,0xc,_0x236537[0x5]),_0x30ceda=_0x21f60b(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0xc1a1f6,0x11,_0x236537[0x6]),_0x22bc14=_0x21f60b(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x34adb1,0x16,_0x236537[0x7]),_0x256f93=_0x21f60b(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x3d7096,0x7,_0x236537[0x8]),_0x3ccd38=_0x21f60b(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x39eeb8,0xc,_0x236537[0x9]),_0x30ceda=_0x21f60b(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x40eaeb,0x11,_0x236537[0xa]),_0x22bc14=_0x21f60b(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x375595,0x16,_0x236537[0xb]),_0x256f93=_0x21f60b(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x4cf84d,0x7,_0x236537[0xc]),_0x3ccd38=_0x21f60b(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x4d27d5,0xc,_0x236537[0xd]),_0x30ceda=_0x21f60b(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x4d0b1c,0x11,_0x236537[0xe]),_0x22bc14=_0x21f60b(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x9b7e92,0x16,_0x236537[0xf]),_0x256f93=_0x1cbe31(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0xc46883,0x5,_0x236537[0x10]),_0x3ccd38=_0x1cbe31(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0xc1a1f6,0x9,_0x236537[0x11]),_0x30ceda=_0x1cbe31(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x375595,0xe,_0x236537[0x12]),_0x22bc14=_0x1cbe31(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x4c94ea,0x14,_0x236537[0x13]),_0x256f93=_0x1cbe31(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x5cccdc,0x5,_0x236537[0x14]),_0x3ccd38=_0x1cbe31(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x40eaeb,0x9,_0x236537[0x15]),_0x30ceda=_0x1cbe31(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x9b7e92,0xe,_0x236537[0x16]),_0x22bc14=_0x1cbe31(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x111e0f,0x14,_0x236537[0x17]),_0x256f93=_0x1cbe31(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x39eeb8,0x5,_0x236537[0x18]),_0x3ccd38=_0x1cbe31(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x4d0b1c,0x9,_0x236537[0x19]),_0x30ceda=_0x1cbe31(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x25dd0d,0xe,_0x236537[0x1a]),_0x22bc14=_0x1cbe31(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x3d7096,0x14,_0x236537[0x1b]),_0x256f93=_0x1cbe31(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x4d27d5,0x5,_0x236537[0x1c]),_0x3ccd38=_0x1cbe31(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x5e667b,0x9,_0x236537[0x1d]),_0x30ceda=_0x1cbe31(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x34adb1,0xe,_0x236537[0x1e]),_0x22bc14=_0x1cbe31(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x4cf84d,0x14,_0x236537[0x1f]),_0x256f93=_0x550948(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x5cccdc,0x4,_0x236537[0x20]),_0x3ccd38=_0x550948(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x3d7096,0xb,_0x236537[0x21]),_0x30ceda=_0x550948(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x375595,0x10,_0x236537[0x22]),_0x22bc14=_0x550948(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x4d0b1c,0x17,_0x236537[0x23]),_0x256f93=_0x550948(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0xc46883,0x4,_0x236537[0x24]),_0x3ccd38=_0x550948(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x111e0f,0xb,_0x236537[0x25]),_0x30ceda=_0x550948(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x34adb1,0x10,_0x236537[0x26]),_0x22bc14=_0x550948(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x40eaeb,0x17,_0x236537[0x27]),_0x256f93=_0x550948(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x4d27d5,0x4,_0x236537[0x28]),_0x3ccd38=_0x550948(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x4c94ea,0xb,_0x236537[0x29]),_0x30ceda=_0x550948(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x25dd0d,0x10,_0x236537[0x2a]),_0x22bc14=_0x550948(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0xc1a1f6,0x17,_0x236537[0x2b]),_0x256f93=_0x550948(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x39eeb8,0x4,_0x236537[0x2c]),_0x3ccd38=_0x550948(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x4cf84d,0xb,_0x236537[0x2d]),_0x30ceda=_0x550948(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x9b7e92,0x10,_0x236537[0x2e]),_0x22bc14=_0x550948(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x5e667b,0x17,_0x236537[0x2f]),_0x256f93=_0x5f2b13(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x4c94ea,0x6,_0x236537[0x30]),_0x3ccd38=_0x5f2b13(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x34adb1,0xa,_0x236537[0x31]),_0x30ceda=_0x5f2b13(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x4d0b1c,0xf,_0x236537[0x32]),_0x22bc14=_0x5f2b13(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x5cccdc,0x15,_0x236537[0x33]),_0x256f93=_0x5f2b13(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x4cf84d,0x6,_0x236537[0x34]),_0x3ccd38=_0x5f2b13(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x25dd0d,0xa,_0x236537[0x35]),_0x30ceda=_0x5f2b13(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x40eaeb,0xf,_0x236537[0x36]),_0x22bc14=_0x5f2b13(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0xc46883,0x15,_0x236537[0x37]),_0x256f93=_0x5f2b13(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x3d7096,0x6,_0x236537[0x38]),_0x3ccd38=_0x5f2b13(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x9b7e92,0xa,_0x236537[0x39]),_0x30ceda=_0x5f2b13(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0xc1a1f6,0xf,_0x236537[0x3a]),_0x22bc14=_0x5f2b13(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x4d27d5,0x15,_0x236537[0x3b]),_0x256f93=_0x5f2b13(_0x256f93,_0x22bc14,_0x30ceda,_0x3ccd38,_0x111e0f,0x6,_0x236537[0x3c]),_0x3ccd38=_0x5f2b13(_0x3ccd38,_0x256f93,_0x22bc14,_0x30ceda,_0x375595,0xa,_0x236537[0x3d]),_0x30ceda=_0x5f2b13(_0x30ceda,_0x3ccd38,_0x256f93,_0x22bc14,_0x5e667b,0xf,_0x236537[0x3e]),_0x22bc14=_0x5f2b13(_0x22bc14,_0x30ceda,_0x3ccd38,_0x256f93,_0x39eeb8,0x15,_0x236537[0x3f]),_0x1080ed[0x0]=_0x1080ed[0x0]+_0x256f93|0x0,_0x1080ed[0x1]=_0x1080ed[0x1]+_0x22bc14|0x0,_0x1080ed[0x2]=_0x1080ed[0x2]+_0x30ceda|0x0,_0x1080ed[0x3]=_0x1080ed[0x3]+_0x3ccd38|0x0;},'_doFinalize':function(){var _0x5dc794=_0x11c2b7,_0x9b3c2a=this[_0x5dc794(0x38f)],_0x350e1f=_0x9b3c2a[_0x5dc794(0x240)],_0xe6c38d=this['_nDataBytes']*0x8,_0x3b00b4=_0x9b3c2a[_0x5dc794(0x4f8)]*0x8;_0x350e1f[_0x3b00b4>>>0x5]|=0x80<<0x18-_0x3b00b4%0x20;var _0x221976=_0x4be436['floor'](_0xe6c38d/0x100000000),_0x24c1e3=_0xe6c38d;_0x350e1f[(_0x3b00b4+0x40>>>0x9<<0x4)+0xf]=(_0x221976<<0x8|_0x221976>>>0x18)&0xff00ff|(_0x221976<<0x18|_0x221976>>>0x8)&0xff00ff00,_0x350e1f[(_0x3b00b4+0x40>>>0x9<<0x4)+0xe]=(_0x24c1e3<<0x8|_0x24c1e3>>>0x18)&0xff00ff|(_0x24c1e3<<0x18|_0x24c1e3>>>0x8)&0xff00ff00,_0x9b3c2a['sigBytes']=(_0x350e1f[_0x5dc794(0x3c5)]+0x1)*0x4,this[_0x5dc794(0x1e6)]();for(var _0x1e7899=this[_0x5dc794(0x2a6)],_0x14b805=_0x1e7899[_0x5dc794(0x240)],_0x4173d6=0x0;_0x4173d6<0x4;_0x4173d6++){var _0x3f975d=_0x14b805[_0x4173d6];_0x14b805[_0x4173d6]=(_0x3f975d<<0x8|_0x3f975d>>>0x18)&0xff00ff|(_0x3f975d<<0x18|_0x3f975d>>>0x8)&0xff00ff00;}return _0x1e7899;},'clone':function(){var _0x572ff4=_0x11c2b7,_0x3f19af=_0x404e61['clone'][_0x572ff4(0x37a)](this);return _0x3f19af[_0x572ff4(0x2a6)]=this[_0x572ff4(0x2a6)][_0x572ff4(0x4e8)](),_0x3f19af;}});function _0x21f60b(_0x223893,_0x28ae77,_0x4efeec,_0x34eaed,_0x5b1559,_0x39b5a8,_0x33a556){var _0x1f4d82=_0x223893+(_0x28ae77&_0x4efeec|~_0x28ae77&_0x34eaed)+_0x5b1559+_0x33a556;return(_0x1f4d82<<_0x39b5a8|_0x1f4d82>>>0x20-_0x39b5a8)+_0x28ae77;}function _0x1cbe31(_0x17e782,_0xf36746,_0x58831a,_0xe51ceb,_0x311334,_0x2e236c,_0x51f0bd){var _0x2123b8=_0x17e782+(_0xf36746&_0xe51ceb|_0x58831a&~_0xe51ceb)+_0x311334+_0x51f0bd;return(_0x2123b8<<_0x2e236c|_0x2123b8>>>0x20-_0x2e236c)+_0xf36746;}function _0x550948(_0x18b2e9,_0x325a19,_0x11a176,_0x330435,_0x59504f,_0x5204f9,_0x49b352){var _0x212b40=_0x18b2e9+(_0x325a19^_0x11a176^_0x330435)+_0x59504f+_0x49b352;return(_0x212b40<<_0x5204f9|_0x212b40>>>0x20-_0x5204f9)+_0x325a19;}function _0x5f2b13(_0x3425e3,_0x10c3cc,_0x3c38e2,_0x2ed59b,_0x3d847b,_0x80b9e4,_0xb83bc9){var _0x49256a=_0x3425e3+(_0x3c38e2^(_0x10c3cc|~_0x2ed59b))+_0x3d847b+_0xb83bc9;return(_0x49256a<<_0x80b9e4|_0x49256a>>>0x20-_0x80b9e4)+_0x10c3cc;}_0x16fe71[_0x11c2b7(0x203)]=_0x404e61[_0x11c2b7(0x4b9)](_0x431914),_0x16fe71[_0x11c2b7(0x42e)]=_0x404e61[_0x11c2b7(0x295)](_0x431914);}(Math),_0xc3dc6b[_0x1bac3d(0x203)];}));}(_0x1581bf)),_0x1581bf[_0x8199d3(0x1f7)];}var _0x303b85={'exports':{}},_0x7a0b83={'exports':{}},_0x991c76=_0x7a0b83['exports'],_0x443e8c;function _0x1e937a(){var _0x52ed46=_0x3d1808;return _0x443e8c||(_0x443e8c=0x1,function(_0x46e3b5,_0x659096){(function(_0x44b92f,_0x2c200c){var _0x2f6de6=_0x58ee;_0x46e3b5[_0x2f6de6(0x1f7)]=_0x2c200c(_0x1257fc());}(_0x991c76,function(_0x7a6685){var _0x181919=_0x58ee;return(function(){var _0x493299=_0x58ee,_0x1421e7=_0x7a6685,_0x1306d9=_0x1421e7[_0x493299(0x1fd)],_0x5a3d12=_0x1306d9[_0x493299(0x273)],_0x52908e=_0x1306d9['Hasher'],_0x36b5f5=_0x1421e7['algo'],_0x19daec=[],_0xc3bf2b=_0x36b5f5['SHA1']=_0x52908e[_0x493299(0x34d)]({'_doReset':function(){var _0xb95152=_0x493299;this[_0xb95152(0x2a6)]=new _0x5a3d12[(_0xb95152(0x456))]([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]);},'_doProcessBlock':function(_0x4fde72,_0x391e70){var _0x97160=_0x493299;for(var _0x3a02a3=this[_0x97160(0x2a6)][_0x97160(0x240)],_0x6563d8=_0x3a02a3[0x0],_0x42861e=_0x3a02a3[0x1],_0xbc19ef=_0x3a02a3[0x2],_0x195b53=_0x3a02a3[0x3],_0x199e07=_0x3a02a3[0x4],_0x25db5f=0x0;_0x25db5f<0x50;_0x25db5f++){if(_0x25db5f<0x10)_0x19daec[_0x25db5f]=_0x4fde72[_0x391e70+_0x25db5f]|0x0;else{var _0x59d3c5=_0x19daec[_0x25db5f-0x3]^_0x19daec[_0x25db5f-0x8]^_0x19daec[_0x25db5f-0xe]^_0x19daec[_0x25db5f-0x10];_0x19daec[_0x25db5f]=_0x59d3c5<<0x1|_0x59d3c5>>>0x1f;}var _0x1b9f5d=(_0x6563d8<<0x5|_0x6563d8>>>0x1b)+_0x199e07+_0x19daec[_0x25db5f];_0x25db5f<0x14?_0x1b9f5d+=(_0x42861e&_0xbc19ef|~_0x42861e&_0x195b53)+0x5a827999:_0x25db5f<0x28?_0x1b9f5d+=(_0x42861e^_0xbc19ef^_0x195b53)+0x6ed9eba1:_0x25db5f<0x3c?_0x1b9f5d+=(_0x42861e&_0xbc19ef|_0x42861e&_0x195b53|_0xbc19ef&_0x195b53)-0x70e44324:_0x1b9f5d+=(_0x42861e^_0xbc19ef^_0x195b53)-0x359d3e2a,_0x199e07=_0x195b53,_0x195b53=_0xbc19ef,_0xbc19ef=_0x42861e<<0x1e|_0x42861e>>>0x2,_0x42861e=_0x6563d8,_0x6563d8=_0x1b9f5d;}_0x3a02a3[0x0]=_0x3a02a3[0x0]+_0x6563d8|0x0,_0x3a02a3[0x1]=_0x3a02a3[0x1]+_0x42861e|0x0,_0x3a02a3[0x2]=_0x3a02a3[0x2]+_0xbc19ef|0x0,_0x3a02a3[0x3]=_0x3a02a3[0x3]+_0x195b53|0x0,_0x3a02a3[0x4]=_0x3a02a3[0x4]+_0x199e07|0x0;},'_doFinalize':function(){var _0x3a7968=_0x493299,_0x2ee2c2=this['_data'],_0x1f3f0c=_0x2ee2c2[_0x3a7968(0x240)],_0x51858f=this['_nDataBytes']*0x8,_0x4c5fad=_0x2ee2c2[_0x3a7968(0x4f8)]*0x8;return _0x1f3f0c[_0x4c5fad>>>0x5]|=0x80<<0x18-_0x4c5fad%0x20,_0x1f3f0c[(_0x4c5fad+0x40>>>0x9<<0x4)+0xe]=Math[_0x3a7968(0x421)](_0x51858f/0x100000000),_0x1f3f0c[(_0x4c5fad+0x40>>>0x9<<0x4)+0xf]=_0x51858f,_0x2ee2c2[_0x3a7968(0x4f8)]=_0x1f3f0c['length']*0x4,this[_0x3a7968(0x1e6)](),this[_0x3a7968(0x2a6)];},'clone':function(){var _0x4b6de4=_0x493299,_0x244829=_0x52908e[_0x4b6de4(0x4e8)][_0x4b6de4(0x37a)](this);return _0x244829['_hash']=this[_0x4b6de4(0x2a6)][_0x4b6de4(0x4e8)](),_0x244829;}});_0x1421e7[_0x493299(0x4c3)]=_0x52908e[_0x493299(0x4b9)](_0xc3bf2b),_0x1421e7['HmacSHA1']=_0x52908e[_0x493299(0x295)](_0xc3bf2b);}()),_0x7a6685[_0x181919(0x4c3)];}));}(_0x7a0b83)),_0x7a0b83[_0x52ed46(0x1f7)];}var _0x10e0db={'exports':{}},_0x153e40=_0x10e0db[_0x3d1808(0x1f7)],_0x4aa903;function _0x513044(){var _0x4fe2e6=_0x3d1808;return _0x4aa903||(_0x4aa903=0x1,function(_0x5ff188,_0x17dbc5){(function(_0x341ad8,_0x27020a){var _0x1a535b=_0x58ee;_0x5ff188[_0x1a535b(0x1f7)]=_0x27020a(_0x1257fc());}(_0x153e40,function(_0x21748a){(function(){var _0x141e49=_0x58ee,_0xbce18a=_0x21748a,_0x2217a5=_0xbce18a['lib'],_0x56d66b=_0x2217a5[_0x141e49(0x3c1)],_0x12efb5=_0xbce18a[_0x141e49(0x30e)],_0x55970d=_0x12efb5[_0x141e49(0x4ec)],_0x509655=_0xbce18a['algo'];_0x509655[_0x141e49(0x235)]=_0x56d66b[_0x141e49(0x34d)]({'init':function(_0x16967b,_0x300074){var _0x3098ea=_0x141e49;_0x16967b=this[_0x3098ea(0x20b)]=new _0x16967b[(_0x3098ea(0x456))](),typeof _0x300074==_0x3098ea(0x2da)&&(_0x300074=_0x55970d['parse'](_0x300074));var _0x5ade42=_0x16967b['blockSize'],_0x5835f2=_0x5ade42*0x4;_0x300074[_0x3098ea(0x4f8)]>_0x5835f2&&(_0x300074=_0x16967b[_0x3098ea(0x24f)](_0x300074)),_0x300074[_0x3098ea(0x536)]();for(var _0x1062e2=this[_0x3098ea(0x234)]=_0x300074[_0x3098ea(0x4e8)](),_0x18929d=this['_iKey']=_0x300074[_0x3098ea(0x4e8)](),_0x5ef9cc=_0x1062e2[_0x3098ea(0x240)],_0xad955f=_0x18929d[_0x3098ea(0x240)],_0x552e1d=0x0;_0x552e1d<_0x5ade42;_0x552e1d++)_0x5ef9cc[_0x552e1d]^=0x5c5c5c5c,_0xad955f[_0x552e1d]^=0x36363636;_0x1062e2[_0x3098ea(0x4f8)]=_0x18929d[_0x3098ea(0x4f8)]=_0x5835f2,this[_0x3098ea(0x20a)]();},'reset':function(){var _0x50cea9=_0x141e49,_0x2515ed=this['_hasher'];_0x2515ed[_0x50cea9(0x20a)](),_0x2515ed[_0x50cea9(0x232)](this['_iKey']);},'update':function(_0x248831){var _0x1ed35a=_0x141e49;return this[_0x1ed35a(0x20b)][_0x1ed35a(0x232)](_0x248831),this;},'finalize':function(_0x3e7748){var _0xe2765d=_0x141e49,_0x2ea81a=this[_0xe2765d(0x20b)],_0x46fde7=_0x2ea81a[_0xe2765d(0x24f)](_0x3e7748);_0x2ea81a['reset']();var _0xf2b483=_0x2ea81a[_0xe2765d(0x24f)](this['_oKey'][_0xe2765d(0x4e8)]()['concat'](_0x46fde7));return _0xf2b483;}});}());}));}(_0x10e0db)),_0x10e0db[_0x4fe2e6(0x1f7)];}var _0xb33875=_0x303b85[_0x3d1808(0x1f7)],_0x12f47b;function _0x136f19(){var _0x33399e=_0x3d1808;return _0x12f47b||(_0x12f47b=0x1,function(_0x4e658d,_0x28384f){(function(_0x27ca1e,_0x1886e7,_0x111709){var _0x32dc9e=_0x58ee;_0x4e658d[_0x32dc9e(0x1f7)]=_0x1886e7(_0x1257fc(),_0x1e937a(),_0x513044());}(_0xb33875,function(_0xcb0d89){var _0x643ea5=_0x58ee;return(function(){var _0x361520=_0x58ee,_0x45ee9a=_0xcb0d89,_0x38d812=_0x45ee9a[_0x361520(0x1fd)],_0x358cba=_0x38d812[_0x361520(0x3c1)],_0x419eb3=_0x38d812[_0x361520(0x273)],_0x3cf3d9=_0x45ee9a[_0x361520(0x39c)],_0x49ec68=_0x3cf3d9[_0x361520(0x203)],_0x5496df=_0x3cf3d9[_0x361520(0x255)]=_0x358cba[_0x361520(0x34d)]({'cfg':_0x358cba[_0x361520(0x34d)]({'keySize':0x80/0x20,'hasher':_0x49ec68,'iterations':0x1}),'init':function(_0x11f08f){var _0x5469d6=_0x361520;this[_0x5469d6(0x221)]=this[_0x5469d6(0x221)][_0x5469d6(0x34d)](_0x11f08f);},'compute':function(_0x1cf384,_0x1b5b9a){var _0xd9a576=_0x361520;for(var _0xfa98aa,_0x2d6242=this[_0xd9a576(0x221)],_0x56241f=_0x2d6242[_0xd9a576(0x4b6)][_0xd9a576(0x46f)](),_0x46e251=_0x419eb3[_0xd9a576(0x46f)](),_0x51e081=_0x46e251[_0xd9a576(0x240)],_0x5eb4f2=_0x2d6242[_0xd9a576(0x3b0)],_0x3e571b=_0x2d6242[_0xd9a576(0x3a8)];_0x51e081[_0xd9a576(0x3c5)]<_0x5eb4f2;){_0xfa98aa&&_0x56241f[_0xd9a576(0x232)](_0xfa98aa),_0xfa98aa=_0x56241f[_0xd9a576(0x232)](_0x1cf384)[_0xd9a576(0x24f)](_0x1b5b9a),_0x56241f[_0xd9a576(0x20a)]();for(var _0x9b699c=0x1;_0x9b699c<_0x3e571b;_0x9b699c++)_0xfa98aa=_0x56241f[_0xd9a576(0x24f)](_0xfa98aa),_0x56241f['reset']();_0x46e251[_0xd9a576(0x4bb)](_0xfa98aa);}return _0x46e251['sigBytes']=_0x5eb4f2*0x4,_0x46e251;}});_0x45ee9a[_0x361520(0x255)]=function(_0x5ff2bb,_0x243d1d,_0x49524b){var _0x158409=_0x361520;return _0x5496df[_0x158409(0x46f)](_0x49524b)[_0x158409(0x3c3)](_0x5ff2bb,_0x243d1d);};}()),_0xcb0d89[_0x643ea5(0x255)];}));}(_0x303b85)),_0x303b85[_0x33399e(0x1f7)];}var _0xac8e34={'exports':{}},_0xc78ee=_0xac8e34['exports'],_0x5119dc;function _0x49b936(){var _0x3e198b=_0x3d1808;return _0x5119dc||(_0x5119dc=0x1,function(_0x8b1aeb,_0x266e0b){(function(_0x3280f3,_0x58561d,_0x28efc0){var _0x3d03f7=_0x58ee;_0x8b1aeb[_0x3d03f7(0x1f7)]=_0x58561d(_0x1257fc(),_0x136f19());}(_0xc78ee,function(_0x2a7362){var _0x37d16c=_0x58ee;_0x2a7362[_0x37d16c(0x1fd)]['Cipher']||function(_0x1b2ad1){var _0x1fd6fa=_0x37d16c,_0x25c037=_0x2a7362,_0x43d07f=_0x25c037['lib'],_0x26eb69=_0x43d07f[_0x1fd6fa(0x3c1)],_0x14422c=_0x43d07f['WordArray'],_0xdaf6f6=_0x43d07f[_0x1fd6fa(0x3bf)],_0x21e6aa=_0x25c037[_0x1fd6fa(0x30e)];_0x21e6aa[_0x1fd6fa(0x4ec)];var _0x4fe9b7=_0x21e6aa[_0x1fd6fa(0x330)],_0x2407c2=_0x25c037['algo'],_0x6fb0fd=_0x2407c2['EvpKDF'],_0x2751f7=_0x43d07f['Cipher']=_0xdaf6f6[_0x1fd6fa(0x34d)]({'cfg':_0x26eb69['extend'](),'createEncryptor':function(_0x10f551,_0x596bd3){var _0x270023=_0x1fd6fa;return this[_0x270023(0x46f)](this[_0x270023(0x2b6)],_0x10f551,_0x596bd3);},'createDecryptor':function(_0x31074e,_0x1896ce){var _0x339c93=_0x1fd6fa;return this[_0x339c93(0x46f)](this[_0x339c93(0x4f7)],_0x31074e,_0x1896ce);},'init':function(_0x1bf467,_0x29e04c,_0x34fe27){var _0x52ff94=_0x1fd6fa;this[_0x52ff94(0x221)]=this[_0x52ff94(0x221)][_0x52ff94(0x34d)](_0x34fe27),this[_0x52ff94(0x4b7)]=_0x1bf467,this[_0x52ff94(0x2fc)]=_0x29e04c,this[_0x52ff94(0x20a)]();},'reset':function(){var _0x1f4c28=_0x1fd6fa;_0xdaf6f6[_0x1f4c28(0x20a)][_0x1f4c28(0x37a)](this),this[_0x1f4c28(0x312)]();},'process':function(_0x430145){var _0x2d0d1a=_0x1fd6fa;return this[_0x2d0d1a(0x39f)](_0x430145),this[_0x2d0d1a(0x1e6)]();},'finalize':function(_0x11c6e8){var _0x23e95b=_0x1fd6fa;_0x11c6e8&&this[_0x23e95b(0x39f)](_0x11c6e8);var _0x34b62a=this[_0x23e95b(0x243)]();return _0x34b62a;},'keySize':0x80/0x20,'ivSize':0x80/0x20,'_ENC_XFORM_MODE':0x1,'_DEC_XFORM_MODE':0x2,'_createHelper':(function(){function _0x2cb833(_0x782961){return typeof _0x782961=='string'?_0x460ac3:_0x123e28;}return function(_0x54ae5f){return{'encrypt':function(_0x38d011,_0x26d4eb,_0x3c41e2){var _0x4d284e=_0x58ee;return _0x2cb833(_0x26d4eb)[_0x4d284e(0x2c2)](_0x54ae5f,_0x38d011,_0x26d4eb,_0x3c41e2);},'decrypt':function(_0x228077,_0x14d93f,_0x175629){var _0x135b06=_0x58ee;return _0x2cb833(_0x14d93f)[_0x135b06(0x3ae)](_0x54ae5f,_0x228077,_0x14d93f,_0x175629);}};};}())});_0x43d07f[_0x1fd6fa(0x30f)]=_0x2751f7[_0x1fd6fa(0x34d)]({'_doFinalize':function(){var _0x5d6daf=_0x1fd6fa,_0x2732c3=this[_0x5d6daf(0x1e6)](!0x0);return _0x2732c3;},'blockSize':0x1});var _0x3dc723=_0x25c037['mode']={},_0x16c326=_0x43d07f['BlockCipherMode']=_0x26eb69[_0x1fd6fa(0x34d)]({'createEncryptor':function(_0x17c5ca,_0x59c834){var _0x25f5bd=_0x1fd6fa;return this[_0x25f5bd(0x2c1)][_0x25f5bd(0x46f)](_0x17c5ca,_0x59c834);},'createDecryptor':function(_0x4c0549,_0x2b512e){var _0x4e68ea=_0x1fd6fa;return this[_0x4e68ea(0x35a)]['create'](_0x4c0549,_0x2b512e);},'init':function(_0x2cd55d,_0x32f639){var _0x42d0ed=_0x1fd6fa;this[_0x42d0ed(0x566)]=_0x2cd55d,this[_0x42d0ed(0x344)]=_0x32f639;}}),_0x256e4b=_0x3dc723['CBC']=(function(){var _0x4daf27=_0x1fd6fa,_0x2524f2=_0x16c326[_0x4daf27(0x34d)]();_0x2524f2[_0x4daf27(0x2c1)]=_0x2524f2[_0x4daf27(0x34d)]({'processBlock':function(_0x3f9e0a,_0x56edc2){var _0x4227f3=_0x4daf27,_0x492b13=this['_cipher'],_0xbb73c2=_0x492b13[_0x4227f3(0x56b)];_0x1ff7a7['call'](this,_0x3f9e0a,_0x56edc2,_0xbb73c2),_0x492b13[_0x4227f3(0x241)](_0x3f9e0a,_0x56edc2),this[_0x4227f3(0x4e7)]=_0x3f9e0a[_0x4227f3(0x3f8)](_0x56edc2,_0x56edc2+_0xbb73c2);}}),_0x2524f2['Decryptor']=_0x2524f2[_0x4daf27(0x34d)]({'processBlock':function(_0x5ed597,_0x4d0b21){var _0x5cf548=_0x4daf27,_0x366e91=this[_0x5cf548(0x566)],_0x2f1f37=_0x366e91[_0x5cf548(0x56b)],_0x1f1c8e=_0x5ed597[_0x5cf548(0x3f8)](_0x4d0b21,_0x4d0b21+_0x2f1f37);_0x366e91['decryptBlock'](_0x5ed597,_0x4d0b21),_0x1ff7a7[_0x5cf548(0x37a)](this,_0x5ed597,_0x4d0b21,_0x2f1f37),this[_0x5cf548(0x4e7)]=_0x1f1c8e;}});function _0x1ff7a7(_0x290335,_0x1f8adc,_0x2174c9){var _0x423af8=_0x4daf27,_0x5770a4,_0x1a3bd4=this['_iv'];_0x1a3bd4?(_0x5770a4=_0x1a3bd4,this['_iv']=_0x1b2ad1):_0x5770a4=this[_0x423af8(0x4e7)];for(var _0x144b65=0x0;_0x144b65<_0x2174c9;_0x144b65++)_0x290335[_0x1f8adc+_0x144b65]^=_0x5770a4[_0x144b65];}return _0x2524f2;}()),_0x2d65c0=_0x25c037[_0x1fd6fa(0x470)]={},_0x59a34f=_0x2d65c0[_0x1fd6fa(0x2cb)]={'pad':function(_0xf047d,_0x3bb401){var _0x2a6dc5=_0x1fd6fa;for(var _0x440813=_0x3bb401*0x4,_0x3216c5=_0x440813-_0xf047d['sigBytes']%_0x440813,_0x397549=_0x3216c5<<0x18|_0x3216c5<<0x10|_0x3216c5<<0x8|_0x3216c5,_0x2ee61d=[],_0x47ee4e=0x0;_0x47ee4e<_0x3216c5;_0x47ee4e+=0x4)_0x2ee61d[_0x2a6dc5(0x381)](_0x397549);var _0xab9cad=_0x14422c['create'](_0x2ee61d,_0x3216c5);_0xf047d['concat'](_0xab9cad);},'unpad':function(_0x11cb34){var _0x94978b=_0x1fd6fa,_0x5c4b0c=_0x11cb34[_0x94978b(0x240)][_0x11cb34[_0x94978b(0x4f8)]-0x1>>>0x2]&0xff;_0x11cb34[_0x94978b(0x4f8)]-=_0x5c4b0c;}};_0x43d07f[_0x1fd6fa(0x360)]=_0x2751f7[_0x1fd6fa(0x34d)]({'cfg':_0x2751f7[_0x1fd6fa(0x221)][_0x1fd6fa(0x34d)]({'mode':_0x256e4b,'padding':_0x59a34f}),'reset':function(){var _0x1c11cd=_0x1fd6fa,_0x2667a0;_0x2751f7['reset'][_0x1c11cd(0x37a)](this);var _0x2f7e1b=this[_0x1c11cd(0x221)],_0x5d2e33=_0x2f7e1b['iv'],_0x49f70a=_0x2f7e1b[_0x1c11cd(0x4fb)];this['_xformMode']==this[_0x1c11cd(0x2b6)]?_0x2667a0=_0x49f70a[_0x1c11cd(0x52b)]:(_0x2667a0=_0x49f70a[_0x1c11cd(0x401)],this['_minBufferSize']=0x1),this[_0x1c11cd(0x4bc)]&&this[_0x1c11cd(0x4bc)]['__creator']==_0x2667a0?this[_0x1c11cd(0x4bc)][_0x1c11cd(0x456)](this,_0x5d2e33&&_0x5d2e33[_0x1c11cd(0x240)]):(this[_0x1c11cd(0x4bc)]=_0x2667a0[_0x1c11cd(0x37a)](_0x49f70a,this,_0x5d2e33&&_0x5d2e33[_0x1c11cd(0x240)]),this[_0x1c11cd(0x4bc)][_0x1c11cd(0x4f6)]=_0x2667a0);},'_doProcessBlock':function(_0x2c8e5e,_0x396c41){var _0x15ff49=_0x1fd6fa;this[_0x15ff49(0x4bc)][_0x15ff49(0x3b6)](_0x2c8e5e,_0x396c41);},'_doFinalize':function(){var _0x3613e5=_0x1fd6fa,_0x2dc50c,_0x121825=this['cfg']['padding'];return this[_0x3613e5(0x4b7)]==this[_0x3613e5(0x2b6)]?(_0x121825['pad'](this[_0x3613e5(0x38f)],this['blockSize']),_0x2dc50c=this[_0x3613e5(0x1e6)](!0x0)):(_0x2dc50c=this['_process'](!0x0),_0x121825[_0x3613e5(0x3e4)](_0x2dc50c)),_0x2dc50c;},'blockSize':0x80/0x20});var _0x52cf47=_0x43d07f[_0x1fd6fa(0x20c)]=_0x26eb69[_0x1fd6fa(0x34d)]({'init':function(_0x36b276){var _0x8f4004=_0x1fd6fa;this[_0x8f4004(0x2b1)](_0x36b276);},'toString':function(_0x4c07ad){var _0x268375=_0x1fd6fa;return(_0x4c07ad||this[_0x268375(0x49f)])[_0x268375(0x3c7)](this);}}),_0x3b750f=_0x25c037[_0x1fd6fa(0x494)]={},_0x499edd=_0x3b750f[_0x1fd6fa(0x4a7)]={'stringify':function(_0xb8c2a5){var _0x5ccb47=_0x1fd6fa,_0x43e044,_0x1fee83=_0xb8c2a5[_0x5ccb47(0x50b)],_0x3967c8=_0xb8c2a5[_0x5ccb47(0x342)];return _0x3967c8?_0x43e044=_0x14422c[_0x5ccb47(0x46f)]([0x53616c74,0x65645f5f])[_0x5ccb47(0x4bb)](_0x3967c8)['concat'](_0x1fee83):_0x43e044=_0x1fee83,_0x43e044[_0x5ccb47(0x250)](_0x4fe9b7);},'parse':function(_0x5f4054){var _0x34d155=_0x1fd6fa,_0x249622,_0x4e6e4f=_0x4fe9b7[_0x34d155(0x43e)](_0x5f4054),_0x24d160=_0x4e6e4f[_0x34d155(0x240)];return _0x24d160[0x0]==0x53616c74&&_0x24d160[0x1]==0x65645f5f&&(_0x249622=_0x14422c[_0x34d155(0x46f)](_0x24d160['slice'](0x2,0x4)),_0x24d160[_0x34d155(0x2b3)](0x0,0x4),_0x4e6e4f['sigBytes']-=0x10),_0x52cf47[_0x34d155(0x46f)]({'ciphertext':_0x4e6e4f,'salt':_0x249622});}},_0x123e28=_0x43d07f[_0x1fd6fa(0x530)]=_0x26eb69[_0x1fd6fa(0x34d)]({'cfg':_0x26eb69[_0x1fd6fa(0x34d)]({'format':_0x499edd}),'encrypt':function(_0x29dfad,_0x44c863,_0x4dc6ae,_0x5474fe){var _0x341e44=_0x1fd6fa;_0x5474fe=this[_0x341e44(0x221)]['extend'](_0x5474fe);var _0x53fd46=_0x29dfad[_0x341e44(0x52b)](_0x4dc6ae,_0x5474fe),_0x1028f4=_0x53fd46['finalize'](_0x44c863),_0x2fd107=_0x53fd46[_0x341e44(0x221)];return _0x52cf47[_0x341e44(0x46f)]({'ciphertext':_0x1028f4,'key':_0x4dc6ae,'iv':_0x2fd107['iv'],'algorithm':_0x29dfad,'mode':_0x2fd107[_0x341e44(0x4fb)],'padding':_0x2fd107['padding'],'blockSize':_0x29dfad[_0x341e44(0x56b)],'formatter':_0x5474fe[_0x341e44(0x494)]});},'decrypt':function(_0x257c29,_0x4c0a51,_0x2ea6c4,_0x49c4e8){var _0x3a437e=_0x1fd6fa;_0x49c4e8=this[_0x3a437e(0x221)][_0x3a437e(0x34d)](_0x49c4e8),_0x4c0a51=this[_0x3a437e(0x35b)](_0x4c0a51,_0x49c4e8[_0x3a437e(0x494)]);var _0x29f5b3=_0x257c29['createDecryptor'](_0x2ea6c4,_0x49c4e8)[_0x3a437e(0x24f)](_0x4c0a51[_0x3a437e(0x50b)]);return _0x29f5b3;},'_parse':function(_0x5d44c6,_0x3b3caa){return typeof _0x5d44c6=='string'?_0x3b3caa['parse'](_0x5d44c6,this):_0x5d44c6;}}),_0x14d29a=_0x25c037[_0x1fd6fa(0x367)]={},_0x52e2a4=_0x14d29a[_0x1fd6fa(0x4a7)]={'execute':function(_0x407646,_0xd7c453,_0x50ec8f,_0x1759fe,_0x2de7c4){var _0x57ccd8=_0x1fd6fa;if(_0x1759fe||(_0x1759fe=_0x14422c[_0x57ccd8(0x4c7)](0x40/0x8)),_0x2de7c4)var _0x65f6d9=_0x6fb0fd[_0x57ccd8(0x46f)]({'keySize':_0xd7c453+_0x50ec8f,'hasher':_0x2de7c4})['compute'](_0x407646,_0x1759fe);else var _0x65f6d9=_0x6fb0fd[_0x57ccd8(0x46f)]({'keySize':_0xd7c453+_0x50ec8f})[_0x57ccd8(0x3c3)](_0x407646,_0x1759fe);var _0x536836=_0x14422c['create'](_0x65f6d9[_0x57ccd8(0x240)][_0x57ccd8(0x3f8)](_0xd7c453),_0x50ec8f*0x4);return _0x65f6d9[_0x57ccd8(0x4f8)]=_0xd7c453*0x4,_0x52cf47[_0x57ccd8(0x46f)]({'key':_0x65f6d9,'iv':_0x536836,'salt':_0x1759fe});}},_0x460ac3=_0x43d07f[_0x1fd6fa(0x518)]=_0x123e28['extend']({'cfg':_0x123e28['cfg']['extend']({'kdf':_0x52e2a4}),'encrypt':function(_0x307466,_0x274cf3,_0x360382,_0x2aee33){var _0x3c3ff4=_0x1fd6fa;_0x2aee33=this[_0x3c3ff4(0x221)][_0x3c3ff4(0x34d)](_0x2aee33);var _0x4f4b61=_0x2aee33[_0x3c3ff4(0x367)][_0x3c3ff4(0x21e)](_0x360382,_0x307466['keySize'],_0x307466[_0x3c3ff4(0x389)],_0x2aee33['salt'],_0x2aee33[_0x3c3ff4(0x4b6)]);_0x2aee33['iv']=_0x4f4b61['iv'];var _0x43b5eb=_0x123e28[_0x3c3ff4(0x2c2)][_0x3c3ff4(0x37a)](this,_0x307466,_0x274cf3,_0x4f4b61[_0x3c3ff4(0x1fe)],_0x2aee33);return _0x43b5eb[_0x3c3ff4(0x2b1)](_0x4f4b61),_0x43b5eb;},'decrypt':function(_0x5b1fdd,_0x25f506,_0x23c84a,_0x27c613){var _0x14d212=_0x1fd6fa;_0x27c613=this['cfg'][_0x14d212(0x34d)](_0x27c613),_0x25f506=this['_parse'](_0x25f506,_0x27c613[_0x14d212(0x494)]);var _0x336dbe=_0x27c613['kdf'][_0x14d212(0x21e)](_0x23c84a,_0x5b1fdd[_0x14d212(0x3b0)],_0x5b1fdd[_0x14d212(0x389)],_0x25f506[_0x14d212(0x342)],_0x27c613['hasher']);_0x27c613['iv']=_0x336dbe['iv'];var _0x5cacb9=_0x123e28[_0x14d212(0x3ae)]['call'](this,_0x5b1fdd,_0x25f506,_0x336dbe['key'],_0x27c613);return _0x5cacb9;}});}();}));}(_0xac8e34)),_0xac8e34[_0x3e198b(0x1f7)];}var _0x4a600c=_0x692448[_0x3d1808(0x1f7)],_0x7dbad3;function _0x3b2d3a(){var _0x1a7789=_0x3d1808;return _0x7dbad3||(_0x7dbad3=0x1,function(_0x188f44,_0x3e50b2){(function(_0x4474c0,_0x47deae,_0x3afe6f){var _0x25f905=_0x58ee;_0x188f44[_0x25f905(0x1f7)]=_0x47deae(_0x1257fc(),_0x294be0(),_0x45d0e1(),_0x136f19(),_0x49b936());}(_0x4a600c,function(_0x1fae5b){var _0x3f4d66=_0x58ee;return(function(){var _0x590f16=_0x58ee,_0x337841=_0x1fae5b,_0xb9c3e4=_0x337841[_0x590f16(0x1fd)],_0x441b81=_0xb9c3e4[_0x590f16(0x360)],_0xc25a85=_0x337841[_0x590f16(0x39c)],_0x59fbc4=[],_0x229543=[],_0x21bec2=[],_0x2ff2bf=[],_0x3e06b6=[],_0x197291=[],_0x20897a=[],_0x516198=[],_0x3e82e0=[],_0xc3e664=[];(function(){for(var _0x185771=[],_0x5a4e2a=0x0;_0x5a4e2a<0x100;_0x5a4e2a++)_0x5a4e2a<0x80?_0x185771[_0x5a4e2a]=_0x5a4e2a<<0x1:_0x185771[_0x5a4e2a]=_0x5a4e2a<<0x1^0x11b;for(var _0x1ff800=0x0,_0x489c66=0x0,_0x5a4e2a=0x0;_0x5a4e2a<0x100;_0x5a4e2a++){var _0xe3aacd=_0x489c66^_0x489c66<<0x1^_0x489c66<<0x2^_0x489c66<<0x3^_0x489c66<<0x4;_0xe3aacd=_0xe3aacd>>>0x8^_0xe3aacd&0xff^0x63,_0x59fbc4[_0x1ff800]=_0xe3aacd,_0x229543[_0xe3aacd]=_0x1ff800;var _0xa02d87=_0x185771[_0x1ff800],_0x4cd165=_0x185771[_0xa02d87],_0x44e064=_0x185771[_0x4cd165],_0x9b06a2=_0x185771[_0xe3aacd]*0x101^_0xe3aacd*0x1010100;_0x21bec2[_0x1ff800]=_0x9b06a2<<0x18|_0x9b06a2>>>0x8,_0x2ff2bf[_0x1ff800]=_0x9b06a2<<0x10|_0x9b06a2>>>0x10,_0x3e06b6[_0x1ff800]=_0x9b06a2<<0x8|_0x9b06a2>>>0x18,_0x197291[_0x1ff800]=_0x9b06a2;var _0x9b06a2=_0x44e064*0x1010101^_0x4cd165*0x10001^_0xa02d87*0x101^_0x1ff800*0x1010100;_0x20897a[_0xe3aacd]=_0x9b06a2<<0x18|_0x9b06a2>>>0x8,_0x516198[_0xe3aacd]=_0x9b06a2<<0x10|_0x9b06a2>>>0x10,_0x3e82e0[_0xe3aacd]=_0x9b06a2<<0x8|_0x9b06a2>>>0x18,_0xc3e664[_0xe3aacd]=_0x9b06a2,_0x1ff800?(_0x1ff800=_0xa02d87^_0x185771[_0x185771[_0x185771[_0x44e064^_0xa02d87]]],_0x489c66^=_0x185771[_0x185771[_0x489c66]]):_0x1ff800=_0x489c66=0x1;}}());var _0x3aa764=[0x0,0x1,0x2,0x4,0x8,0x10,0x20,0x40,0x80,0x1b,0x36],_0x5f54c8=_0xc25a85[_0x590f16(0x40d)]=_0x441b81[_0x590f16(0x34d)]({'_doReset':function(){var _0x13e10f=_0x590f16,_0xbb47c8;if(!(this['_nRounds']&&this[_0x13e10f(0x542)]===this[_0x13e10f(0x2fc)])){for(var _0x3892f6=this[_0x13e10f(0x542)]=this['_key'],_0x48e82b=_0x3892f6[_0x13e10f(0x240)],_0x34570e=_0x3892f6[_0x13e10f(0x4f8)]/0x4,_0x1347cf=this[_0x13e10f(0x434)]=_0x34570e+0x6,_0x5bba64=(_0x1347cf+0x1)*0x4,_0x52f6fa=this[_0x13e10f(0x42f)]=[],_0x2c48ff=0x0;_0x2c48ff<_0x5bba64;_0x2c48ff++)_0x2c48ff<_0x34570e?_0x52f6fa[_0x2c48ff]=_0x48e82b[_0x2c48ff]:(_0xbb47c8=_0x52f6fa[_0x2c48ff-0x1],_0x2c48ff%_0x34570e?_0x34570e>0x6&&_0x2c48ff%_0x34570e==0x4&&(_0xbb47c8=_0x59fbc4[_0xbb47c8>>>0x18]<<0x18|_0x59fbc4[_0xbb47c8>>>0x10&0xff]<<0x10|_0x59fbc4[_0xbb47c8>>>0x8&0xff]<<0x8|_0x59fbc4[_0xbb47c8&0xff]):(_0xbb47c8=_0xbb47c8<<0x8|_0xbb47c8>>>0x18,_0xbb47c8=_0x59fbc4[_0xbb47c8>>>0x18]<<0x18|_0x59fbc4[_0xbb47c8>>>0x10&0xff]<<0x10|_0x59fbc4[_0xbb47c8>>>0x8&0xff]<<0x8|_0x59fbc4[_0xbb47c8&0xff],_0xbb47c8^=_0x3aa764[_0x2c48ff/_0x34570e|0x0]<<0x18),_0x52f6fa[_0x2c48ff]=_0x52f6fa[_0x2c48ff-_0x34570e]^_0xbb47c8);for(var _0x4ca93b=this[_0x13e10f(0x2de)]=[],_0x4d197c=0x0;_0x4d197c<_0x5bba64;_0x4d197c++){var _0x2c48ff=_0x5bba64-_0x4d197c;if(_0x4d197c%0x4)var _0xbb47c8=_0x52f6fa[_0x2c48ff];else var _0xbb47c8=_0x52f6fa[_0x2c48ff-0x4];_0x4d197c<0x4||_0x2c48ff<=0x4?_0x4ca93b[_0x4d197c]=_0xbb47c8:_0x4ca93b[_0x4d197c]=_0x20897a[_0x59fbc4[_0xbb47c8>>>0x18]]^_0x516198[_0x59fbc4[_0xbb47c8>>>0x10&0xff]]^_0x3e82e0[_0x59fbc4[_0xbb47c8>>>0x8&0xff]]^_0xc3e664[_0x59fbc4[_0xbb47c8&0xff]];}}},'encryptBlock':function(_0x3fb3f8,_0x367fa4){var _0x50b8cd=_0x590f16;this[_0x50b8cd(0x36c)](_0x3fb3f8,_0x367fa4,this[_0x50b8cd(0x42f)],_0x21bec2,_0x2ff2bf,_0x3e06b6,_0x197291,_0x59fbc4);},'decryptBlock':function(_0x39b719,_0x388235){var _0x2857e7=_0x590f16,_0x2881fd=_0x39b719[_0x388235+0x1];_0x39b719[_0x388235+0x1]=_0x39b719[_0x388235+0x3],_0x39b719[_0x388235+0x3]=_0x2881fd,this[_0x2857e7(0x36c)](_0x39b719,_0x388235,this[_0x2857e7(0x2de)],_0x20897a,_0x516198,_0x3e82e0,_0xc3e664,_0x229543);var _0x2881fd=_0x39b719[_0x388235+0x1];_0x39b719[_0x388235+0x1]=_0x39b719[_0x388235+0x3],_0x39b719[_0x388235+0x3]=_0x2881fd;},'_doCryptBlock':function(_0x5f2ec4,_0x3956e2,_0x49fd23,_0x50426e,_0x6afda3,_0x4f3345,_0x37c857,_0x38b598){for(var _0x3eb6de=this['_nRounds'],_0x11eeb9=_0x5f2ec4[_0x3956e2]^_0x49fd23[0x0],_0x455369=_0x5f2ec4[_0x3956e2+0x1]^_0x49fd23[0x1],_0x3c177f=_0x5f2ec4[_0x3956e2+0x2]^_0x49fd23[0x2],_0x334379=_0x5f2ec4[_0x3956e2+0x3]^_0x49fd23[0x3],_0x1eb5b8=0x4,_0x28c1c4=0x1;_0x28c1c4<_0x3eb6de;_0x28c1c4++){var _0xd94c85=_0x50426e[_0x11eeb9>>>0x18]^_0x6afda3[_0x455369>>>0x10&0xff]^_0x4f3345[_0x3c177f>>>0x8&0xff]^_0x37c857[_0x334379&0xff]^_0x49fd23[_0x1eb5b8++],_0x168ec5=_0x50426e[_0x455369>>>0x18]^_0x6afda3[_0x3c177f>>>0x10&0xff]^_0x4f3345[_0x334379>>>0x8&0xff]^_0x37c857[_0x11eeb9&0xff]^_0x49fd23[_0x1eb5b8++],_0x54976a=_0x50426e[_0x3c177f>>>0x18]^_0x6afda3[_0x334379>>>0x10&0xff]^_0x4f3345[_0x11eeb9>>>0x8&0xff]^_0x37c857[_0x455369&0xff]^_0x49fd23[_0x1eb5b8++],_0x6e5c3d=_0x50426e[_0x334379>>>0x18]^_0x6afda3[_0x11eeb9>>>0x10&0xff]^_0x4f3345[_0x455369>>>0x8&0xff]^_0x37c857[_0x3c177f&0xff]^_0x49fd23[_0x1eb5b8++];_0x11eeb9=_0xd94c85,_0x455369=_0x168ec5,_0x3c177f=_0x54976a,_0x334379=_0x6e5c3d;}var _0xd94c85=(_0x38b598[_0x11eeb9>>>0x18]<<0x18|_0x38b598[_0x455369>>>0x10&0xff]<<0x10|_0x38b598[_0x3c177f>>>0x8&0xff]<<0x8|_0x38b598[_0x334379&0xff])^_0x49fd23[_0x1eb5b8++],_0x168ec5=(_0x38b598[_0x455369>>>0x18]<<0x18|_0x38b598[_0x3c177f>>>0x10&0xff]<<0x10|_0x38b598[_0x334379>>>0x8&0xff]<<0x8|_0x38b598[_0x11eeb9&0xff])^_0x49fd23[_0x1eb5b8++],_0x54976a=(_0x38b598[_0x3c177f>>>0x18]<<0x18|_0x38b598[_0x334379>>>0x10&0xff]<<0x10|_0x38b598[_0x11eeb9>>>0x8&0xff]<<0x8|_0x38b598[_0x455369&0xff])^_0x49fd23[_0x1eb5b8++],_0x6e5c3d=(_0x38b598[_0x334379>>>0x18]<<0x18|_0x38b598[_0x11eeb9>>>0x10&0xff]<<0x10|_0x38b598[_0x455369>>>0x8&0xff]<<0x8|_0x38b598[_0x3c177f&0xff])^_0x49fd23[_0x1eb5b8++];_0x5f2ec4[_0x3956e2]=_0xd94c85,_0x5f2ec4[_0x3956e2+0x1]=_0x168ec5,_0x5f2ec4[_0x3956e2+0x2]=_0x54976a,_0x5f2ec4[_0x3956e2+0x3]=_0x6e5c3d;},'keySize':0x100/0x20});_0x337841[_0x590f16(0x40d)]=_0x441b81[_0x590f16(0x4b9)](_0x5f54c8);}()),_0x1fae5b[_0x3f4d66(0x40d)];}));}(_0x692448)),_0x692448[_0x1a7789(0x1f7)];}var _0x5839ab=_0x3b2d3a();const _0x27d9f3=_0x14f116(_0x5839ab);var _0x519875=_0x294be0();const _0x4efe1d=_0x14f116(_0x519875);var _0x2444b1={'exports':{}},_0x321799=_0x2444b1[_0x3d1808(0x1f7)],_0x152e60;function _0x1cf2ea(){return _0x152e60||(_0x152e60=0x1,function(_0x44886e,_0x1e6e30){(function(_0x3b5e97,_0x4ee44f){var _0x364e12=_0x58ee;_0x44886e[_0x364e12(0x1f7)]=_0x4ee44f(_0x1257fc());}(_0x321799,function(_0x52067f){var _0x11d371=_0x58ee;return _0x52067f[_0x11d371(0x30e)][_0x11d371(0x4ec)];}));}(_0x2444b1)),_0x2444b1['exports'];}var _0x40c1f0=_0x1cf2ea();const _0x2d1329=_0x14f116(_0x40c1f0);var _0x430e24={'exports':{}},_0x2fc28a=_0x430e24[_0x3d1808(0x1f7)],_0x700eab;function _0x193af2(){var _0x15240=_0x3d1808;return _0x700eab||(_0x700eab=0x1,function(_0x3f78c3,_0x3b1309){(function(_0x515de3,_0x5a8ac7){var _0x1fe9ed=_0x58ee;_0x3f78c3[_0x1fe9ed(0x1f7)]=_0x5a8ac7(_0x1257fc());}(_0x2fc28a,function(_0x377810){var _0x11701c=_0x58ee;return(function(){var _0x390e8b=_0x58ee;if(typeof ArrayBuffer==_0x390e8b(0x32a)){var _0x560e50=_0x377810,_0x34de29=_0x560e50[_0x390e8b(0x1fd)],_0x151c2e=_0x34de29['WordArray'],_0x45595b=_0x151c2e[_0x390e8b(0x456)],_0x44d9b8=_0x151c2e['init']=function(_0x3a7adf){var _0x51cc50=_0x390e8b;if(_0x3a7adf instanceof ArrayBuffer&&(_0x3a7adf=new Uint8Array(_0x3a7adf)),(_0x3a7adf instanceof Int8Array||typeof Uint8ClampedArray<'u'&&_0x3a7adf instanceof Uint8ClampedArray||_0x3a7adf instanceof Int16Array||_0x3a7adf instanceof Uint16Array||_0x3a7adf instanceof Int32Array||_0x3a7adf instanceof Uint32Array||_0x3a7adf instanceof Float32Array||_0x3a7adf instanceof Float64Array)&&(_0x3a7adf=new Uint8Array(_0x3a7adf[_0x51cc50(0x439)],_0x3a7adf[_0x51cc50(0x1ec)],_0x3a7adf[_0x51cc50(0x309)])),_0x3a7adf instanceof Uint8Array){for(var _0x47eb95=_0x3a7adf[_0x51cc50(0x309)],_0x6d6544=[],_0x3bdd0e=0x0;_0x3bdd0e<_0x47eb95;_0x3bdd0e++)_0x6d6544[_0x3bdd0e>>>0x2]|=_0x3a7adf[_0x3bdd0e]<<0x18-_0x3bdd0e%0x4*0x8;_0x45595b[_0x51cc50(0x37a)](this,_0x6d6544,_0x47eb95);}else _0x45595b[_0x51cc50(0x410)](this,arguments);};_0x44d9b8[_0x390e8b(0x236)]=_0x151c2e;}}()),_0x377810[_0x11701c(0x1fd)][_0x11701c(0x273)];}));}(_0x430e24)),_0x430e24[_0x15240(0x1f7)];}var _0x1ccd7f=_0x193af2();const _0x3b05e7=_0x14f116(_0x1ccd7f);var _0x3d245e={'exports':{}},_0x114215=_0x3d245e[_0x3d1808(0x1f7)],_0x30093d;function _0x33a963(){var _0x4522a9=_0x3d1808;return _0x30093d||(_0x30093d=0x1,function(_0x5451ec,_0x3cd948){(function(_0x21128d,_0x1f4ea8,_0x10960f){var _0x589127=_0x58ee;_0x5451ec[_0x589127(0x1f7)]=_0x1f4ea8(_0x1257fc(),_0x49b936());}(_0x114215,function(_0x46dcf0){var _0x194a51=_0x58ee;return _0x46dcf0['pad'][_0x194a51(0x31a)]={'pad':function(){},'unpad':function(){}},_0x46dcf0[_0x194a51(0x470)][_0x194a51(0x31a)];}));}(_0x3d245e)),_0x3d245e[_0x4522a9(0x1f7)];}var _0x222cbf=_0x33a963();const _0x1f3567=_0x14f116(_0x222cbf);function _0x3c093e(_0x143445,_0x2d7a2b){var _0x171517=_0x3d1808;const _0x1ebb8b=_0x2d7a2b-_0x143445[_0x171517(0x3c5)]%_0x2d7a2b,_0x2707b8=String[_0x171517(0x47a)](_0x1ebb8b)[_0x171517(0x209)](_0x1ebb8b);return _0x143445+_0x2707b8;}function _0x1ce828(_0x11cbdb,_0x3af569){var _0x56226d=_0x3d1808;const _0x119b9f=_0x3b05e7['random'](0x10),_0x2b5729=_0x3c093e(_0x11cbdb,0x10),_0x453af3=_0x27d9f3['encrypt'](_0x2d1329[_0x56226d(0x43e)](_0x2b5729),_0x4efe1d[_0x56226d(0x43e)](_0x3af569),{'iv':_0x119b9f,'padding':_0x1f3567});return _0x119b9f[_0x56226d(0x4bb)](_0x453af3['ciphertext'])[_0x56226d(0x250)](_0x4efe1d);}function _0xcb16ff(){var _0x2cb265=_0x3d1808;const _0x5a944f=_0x6c7987[_0x2cb265(0x473)]()[_0x2cb265(0x4cf)];if(_0x5a944f){const _0x52ec56={'time':Math['floor'](Date[_0x2cb265(0x424)]()/0x3e8),'domain':location[_0x2cb265(0x419)]};return _0x1ce828(JSON[_0x2cb265(0x3c7)](_0x52ec56),_0x5a944f);}}var _0xa78598=Object[_0x3d1808(0x3cf)],_0xa477a4=(_0x2715b6,_0x5ec7c5,_0x48f1e3,_0x1e94a5)=>{var _0x9b2572=_0x3d1808;for(var _0x22a3db=_0x1e94a5>0x1?void 0x0:_0x1e94a5?_0xa78598(_0x5ec7c5,_0x48f1e3):_0x5ec7c5,_0x456739=_0x2715b6[_0x9b2572(0x3c5)]-0x1,_0x39a1e6;_0x456739>=0x0;_0x456739--)(_0x39a1e6=_0x2715b6[_0x456739])&&(_0x22a3db=_0x39a1e6(_0x22a3db)||_0x22a3db);return _0x22a3db;},_0x28fcf2=(_0x45a9de,_0x3958ab)=>(_0x3b5fd8,_0x4009e9)=>_0x3958ab(_0x3b5fd8,_0x4009e9,_0x45a9de);let _0x282438=class{constructor(_0x378ebb){var _0x48cae3=_0x3d1808;this[_0x48cae3(0x48b)]=_0x378ebb,this['_initRequestHeader']();}[_0x3d1808(0x45f)](){var _0x5e154c=_0x3d1808;this[_0x5e154c(0x48b)][_0x5e154c(0x252)]({'interceptor':(_0x22307e,_0x2fbd24)=>{var _0xe7345=_0x5e154c;const _0x339316=_0x22307e[_0xe7345(0x3c4)],_0x2b8030=_0xcb16ff();return _0x2b8030&&_0x339316[_0xe7345(0x373)](_0xe7345(0x484),_0x2b8030),_0x2fbd24(_0x22307e);}});}};_0x282438=_0xa477a4([_0x28fcf2(0x0,_0x5bafa4['Inject'](_0x24f178[_0x3d1808(0x2c9)]))],_0x282438);var _0x25c8eb=Object[_0x3d1808(0x3cf)],_0x255246=(_0x53428a,_0x502550,_0x3ef29b,_0x4d562e)=>{var _0x8047f0=_0x3d1808;for(var _0x1bc8d6=_0x4d562e>0x1?void 0x0:_0x4d562e?_0x25c8eb(_0x502550,_0x3ef29b):_0x502550,_0x547332=_0x53428a[_0x8047f0(0x3c5)]-0x1,_0x42283b;_0x547332>=0x0;_0x547332--)(_0x42283b=_0x53428a[_0x547332])&&(_0x1bc8d6=_0x42283b(_0x1bc8d6)||_0x1bc8d6);return _0x1bc8d6;},_0x3da950=(_0x403c28,_0x13ff43)=>(_0x2d071e,_0x2a55d6)=>_0x13ff43(_0x2d071e,_0x2a55d6,_0x403c28);_0x1065a7['DataLoaderService']=class extends _0x5bafa4[_0x3d1808(0x265)]{constructor(_0x3cffdf,_0x23253d,_0x51b417){var _0x2a7a3f=_0x3d1808;super(),_0x3fc7c7(this,'_unitInfo$',new _0x1a688c[(_0x2a7a3f(0x1f8))](null)),_0x3fc7c7(this,_0x2a7a3f(0x531),this['_unitInfo$'][_0x2a7a3f(0x340)]()),(this[_0x2a7a3f(0x4dc)]=_0x3cffdf,this[_0x2a7a3f(0x3b4)]=_0x23253d,this[_0x2a7a3f(0x4b5)]=_0x51b417);}async[_0x3d1808(0x535)](_0x10e5cb,_0x420bbe,_0x4242d5){var _0x1ed5b0=_0x3d1808;this[_0x1ed5b0(0x52f)][_0x1ed5b0(0x543)]({'unitId':_0x10e5cb,'type':_0x420bbe});let _0x517e0a=null;switch(_0x420bbe){case _0x32e542['UNIVER_SHEET']:{_0x517e0a=await this[_0x1ed5b0(0x3b4)][_0x1ed5b0(0x4f9)](_0x10e5cb,_0x4242d5);break;}case _0x32e542[_0x1ed5b0(0x25d)]:{_0x517e0a=await this['_snapshotService'][_0x1ed5b0(0x52d)](_0x10e5cb,_0x4242d5);break;}default:{this[_0x1ed5b0(0x4dc)][_0x1ed5b0(0x3f5)](_0x1ed5b0(0x4fe),_0x1ed5b0(0x2ea));break;}}return _0x517e0a;}async[_0x3d1808(0x2aa)](_0x271fa3,_0xdcaec1,_0xcd2091){var _0x333ee2=_0x3d1808,_0x1d2b37;this[_0x333ee2(0x52f)][_0x333ee2(0x543)]({'unitId':_0x271fa3,'type':_0xdcaec1,'subUnitId':_0xcd2091});let _0x3e4939=0x0;const _0x7eef07=await((_0x1d2b37=this[_0x333ee2(0x4b5)])==null?void 0x0:_0x1d2b37[_0x333ee2(0x383)](_0x271fa3));return _0x7eef07&&(_0x7eef07[_0x333ee2(0x2be)]||_0x7eef07['mutations'][_0x333ee2(0x3c5)]!==0x0)&&(_0x3e4939=_0x7eef07[_0x333ee2(0x43f)]),_0x3e4939===0x0&&this[_0x333ee2(0x4dc)][_0x333ee2(0x206)]('[DataLoaderService]','fetching\x20the\x20latest\x20document\x20from\x20the\x20server.'),this[_0x333ee2(0x535)](_0x271fa3,_0xdcaec1,_0x3e4939);}},_0x1065a7[_0x3d1808(0x413)]=_0x255246([_0x3da950(0x0,_0x5bafa4['ILogService']),_0x3da950(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x3ab606[_0x3d1808(0x1db)])),_0x3da950(0x2,_0x5bafa4[_0x3d1808(0x4fa)](_0xd8e545))],_0x1065a7['DataLoaderService']);var _0x523fd9=Object[_0x3d1808(0x3cf)],_0x1d309c=(_0x146fda,_0x5191a4,_0x2c00f2,_0x518633)=>{for(var _0x5438f2=_0x518633>0x1?void 0x0:_0x518633?_0x523fd9(_0x5191a4,_0x2c00f2):_0x5191a4,_0x13ea30=_0x146fda['length']-0x1,_0xee6498;_0x13ea30>=0x0;_0x13ea30--)(_0xee6498=_0x146fda[_0x13ea30])&&(_0x5438f2=_0xee6498(_0x5438f2)||_0x5438f2);return _0x5438f2;},_0x4a8609=(_0xd65665,_0x509593)=>(_0x2152cb,_0xb6695a)=>_0x509593(_0x2152cb,_0xb6695a,_0xd65665);const _0x4d3e1a=[_0x3d1808(0x1e1),_0x3d1808(0x350),_0x3d1808(0x291),'image/gif','image/bmp'],_0x1df508=0x5*0x400*0x400,_0xdec7c3=_0x3d1808(0x2bc),_0x4e2d65=_0x3d1808(0x2d3);_0x1065a7[_0x3d1808(0x42a)]=class{constructor(_0x2a1eb1,_0x36adb2,_0x3afc36){var _0x270215=_0x3d1808;_0x3fc7c7(this,_0x270215(0x55b),0x0),_0x3fc7c7(this,_0x270215(0x268),new _0x1a688c['Subject']()),_0x3fc7c7(this,'change$',this['_change$']),_0x3fc7c7(this,'_imageSourceCache',new Map()),(this[_0x270215(0x48b)]=_0x2a1eb1,this[_0x270215(0x4ee)]=_0x36adb2,this[_0x270215(0x4b8)]=_0x3afc36);}['setWaitCount'](_0x1d0366){var _0x5689f2=_0x3d1808;this[_0x5689f2(0x55b)]=_0x1d0366,this[_0x5689f2(0x268)]['next'](_0x1d0366);}[_0x3d1808(0x3de)](_0xac9bb6,_0x5568e6){var _0x2cf2ca=_0x3d1808;if(_0x5568e6===_0x301beb[_0x2cf2ca(0x45c)][_0x2cf2ca(0x45d)]){const _0x1f4999=new Image();return _0x1f4999[_0x2cf2ca(0x4f3)]=_0xac9bb6,_0x1f4999;}return this['_imageSourceCache']['get'](_0xac9bb6);}[_0x3d1808(0x1df)](_0x23063e,_0x4de03f,_0x1ab5d6){var _0x2d608e=_0x3d1808;_0x4de03f===_0x301beb[_0x2d608e(0x45c)]['BASE64']||_0x1ab5d6==null||this[_0x2d608e(0x395)][_0x2d608e(0x373)](_0x23063e,_0x1ab5d6);}async[_0x3d1808(0x2f6)](_0xf58b7){var _0x5b5795=_0x3d1808;try{const _0x5971bf=this['_replaceFileID'](this[_0x5b5795(0x337)](),''+_0xf58b7),_0x2ef863=(await this[_0x5b5795(0x48b)]['get'](_0x5971bf))[_0x5b5795(0x26c)];if(_0x2ef863[_0x5b5795(0x3f5)]&&_0x2ef863[_0x5b5795(0x3f5)][_0x5b5795(0x24b)]===_0x44514f['OK']){const _0x1297c7=new URL(_0x2ef863['url'],this[_0x5b5795(0x551)]())[_0x5b5795(0x250)]();return Promise[_0x5b5795(0x287)](_0x1297c7);}return Promise[_0x5b5795(0x212)](_0x2ef863[_0x5b5795(0x3f5)]);}catch(_0x5be6d9){return Promise['reject'](_0x5be6d9);}}async['saveImage'](_0x293ada){var _0x1d6e69=_0x3d1808;let _0xa6744b='';if(!_0x4d3e1a[_0x1d6e69(0x27d)](_0x293ada['type']))return this[_0x1d6e69(0x371)](),Promise[_0x1d6e69(0x212)](new Error(_0x301beb['ImageUploadStatusType'][_0x1d6e69(0x4a9)]));if(_0x293ada['size']>_0x1df508)return this[_0x1d6e69(0x371)](),Promise[_0x1d6e69(0x212)](new Error(_0x301beb[_0x1d6e69(0x3ba)]['ERROR_EXCEED_SIZE']));try{const _0xed83bb=new FormData();_0xed83bb[_0x1d6e69(0x55e)](_0x1d6e69(0x48e),_0x293ada);const _0x44ccad=this[_0x1d6e69(0x4b8)][_0x1d6e69(0x29b)](),_0xb3e952=_0x44ccad==null?void 0x0:_0x44ccad['getUnitId']();if(!_0xb3e952)throw new Error(_0x1d6e69(0x54c));const _0x389491=this['_getUploadFileURL']()+_0x1d6e69(0x2c0)+_0x293ada['size']['toString']()+_0x1d6e69(0x3e3)+_0x3fac12[_0x1d6e69(0x46d)]+_0x1d6e69(0x311)+encodeURIComponent(_0xb3e952),_0x3d97af={'body':_0xed83bb},_0x4d1f89=(await this[_0x1d6e69(0x48b)][_0x1d6e69(0x2df)](_0x389491,_0x3d97af))['body'];if(typeof _0x4d1f89[_0x1d6e69(0x487)]!=_0x1d6e69(0x2da))return this['_decreaseWaiting'](),Promise[_0x1d6e69(0x212)](new Error(_0x301beb['ImageUploadStatusType'][_0x1d6e69(0x4d2)]));_0xa6744b=_0x4d1f89[_0x1d6e69(0x487)];}catch{return this[_0x1d6e69(0x371)](),Promise[_0x1d6e69(0x212)](new Error(_0x301beb[_0x1d6e69(0x3ba)][_0x1d6e69(0x4d2)]));}return new Promise((_0x68ebfd,_0x5d4c08)=>{var _0x19fdc9=_0x1d6e69;const _0x8dab84=new FileReader();_0x8dab84[_0x19fdc9(0x4c8)](_0x293ada),_0x8dab84['onload']=_0x460649=>{var _0x38c869=_0x19fdc9,_0x7c1195;const _0x52bfbf=(_0x7c1195=_0x460649['target'])==null?void 0x0:_0x7c1195[_0x38c869(0x570)];if(_0x52bfbf==null){this[_0x38c869(0x371)](),_0x5d4c08(new Error(_0x301beb[_0x38c869(0x3ba)][_0x38c869(0x4d2)]));return;}const _0x3af40e=_0x5bafa4[_0x38c869(0x256)](0x6);_0x68ebfd({'imageId':_0x3af40e,'imageSourceType':_0x301beb[_0x38c869(0x45c)][_0x38c869(0x1f4)],'source':_0xa6744b,'base64Cache':_0x52bfbf,'status':_0x301beb[_0x38c869(0x3ba)]['SUCCUSS']}),this[_0x38c869(0x371)]();};});}[_0x3d1808(0x29a)](){var _0x3aabae=_0x3d1808,_0x43558a;const _0xe20307=this[_0x3aabae(0x4ee)][_0x3aabae(0x38b)](_0x755dce);return(_0x43558a=_0xe20307==null?void 0x0:_0xe20307[_0x3aabae(0x43a)])!=null?_0x43558a:_0xdec7c3;}[_0x3d1808(0x337)](){var _0x5b07bf=_0x3d1808,_0x30a779;const _0x2caffe=this['_configService'][_0x5b07bf(0x38b)](_0x755dce);return(_0x30a779=_0x2caffe==null?void 0x0:_0x2caffe[_0x5b07bf(0x304)])!=null?_0x30a779:_0x4e2d65;}[_0x3d1808(0x551)](){var _0x353d4d=_0x3d1808,_0x272bae;const _0x5cad88=this[_0x353d4d(0x4ee)][_0x353d4d(0x38b)](_0x755dce);return(_0x272bae=_0x5cad88==null?void 0x0:_0x5cad88[_0x353d4d(0x550)])!=null?_0x272bae:location['origin'];}[_0x3d1808(0x215)](_0x3f18ed,_0x3a1900){var _0x1b6eaa=_0x3d1808;return _0x3f18ed[_0x1b6eaa(0x2c7)](_0x1b6eaa(0x1de),_0x3a1900);}[_0x3d1808(0x371)](){var _0x60d8c7=_0x3d1808;this['_waitCount']-=0x1,this[_0x60d8c7(0x268)][_0x60d8c7(0x543)](this[_0x60d8c7(0x55b)]);}},_0x1065a7[_0x3d1808(0x42a)]=_0x1d309c([_0x4a8609(0x0,_0x5bafa4[_0x3d1808(0x317)](_0x24f178['HTTPService'])),_0x4a8609(0x1,_0x5bafa4['IConfigService']),_0x4a8609(0x2,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x443)]))],_0x1065a7['CollaborationImageIoService']);var _0x1037fb=Object[_0x3d1808(0x3cf)],_0x31a5b1=(_0x31f8c3,_0x13f05e,_0x2885e9,_0xb107b2)=>{var _0x17ce10=_0x3d1808;for(var _0x468c01=_0xb107b2>0x1?void 0x0:_0xb107b2?_0x1037fb(_0x13f05e,_0x2885e9):_0x13f05e,_0x5c8715=_0x31f8c3[_0x17ce10(0x3c5)]-0x1,_0x2b694a;_0x5c8715>=0x0;_0x5c8715--)(_0x2b694a=_0x31f8c3[_0x5c8715])&&(_0x468c01=_0x2b694a(_0x468c01)||_0x468c01);return _0x468c01;},_0x224652=(_0x190f88,_0x5a8905)=>(_0xced2c2,_0x3dbe20)=>_0x5a8905(_0xced2c2,_0x3dbe20,_0x190f88);const _0x37fe8f=_0x3d1808(0x318);_0x1065a7[_0x3d1808(0x2a2)]=class{constructor(_0x2531a3,_0x29b2e8){var _0x4b7e82=_0x3d1808;this[_0x4b7e82(0x4ee)]=_0x2531a3,this[_0x4b7e82(0x412)]=_0x29b2e8;}['_getAPIPrefixPath'](){var _0x20c531=_0x3d1808,_0x1bf560;const _0x163870=this[_0x20c531(0x4ee)][_0x20c531(0x38b)](_0x755dce);return(_0x1bf560=_0x163870==null?void 0x0:_0x163870[_0x20c531(0x399)])!=null?_0x1bf560:_0x37fe8f;}async[_0x3d1808(0x504)](_0x4ffdd5){var _0x2d64f9=_0x3d1808;const _0x25f9ff=this[_0x2d64f9(0x488)]()+_0x2d64f9(0x22a);return{'list':[{'title':_0x2d64f9(0x23e),'mentions':(await this[_0x2d64f9(0x412)][_0x2d64f9(0x3f0)](_0x25f9ff,{'params':{'objectID':_0x4ffdd5[_0x2d64f9(0x48f)],'unitID':_0x4ffdd5[_0x2d64f9(0x48f)]}}))[_0x2d64f9(0x26c)]['collaborators'][_0x2d64f9(0x51a)](_0xde67c3=>({'objectId':_0xde67c3['id'],'name':_0xde67c3[_0x2d64f9(0x2fa)]['name'],'metadata':{'icon':_0xde67c3[_0x2d64f9(0x2fa)]['avatar']},'label':_0xde67c3[_0x2d64f9(0x2fa)][_0x2d64f9(0x210)],'objectType':_0x5bafa4['MentionType']['PERSON']})),'metadata':{},'type':_0x5bafa4['MentionType'][_0x2d64f9(0x220)]}]};}},_0x1065a7[_0x3d1808(0x2a2)]=_0x31a5b1([_0x224652(0x0,_0x5bafa4['Inject'](_0x5bafa4[_0x3d1808(0x34c)])),_0x224652(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x24f178[_0x3d1808(0x2c9)]))],_0x1065a7[_0x3d1808(0x2a2)]);var _0x109f39=Object[_0x3d1808(0x3cf)],_0x7619f1=(_0x53f1ff,_0x3d222f,_0xb34fc0,_0x1d2a50)=>{for(var _0xbedf2e=_0x1d2a50>0x1?void 0x0:_0x1d2a50?_0x109f39(_0x3d222f,_0xb34fc0):_0x3d222f,_0x412e8c=_0x53f1ff['length']-0x1,_0x51aa8b;_0x412e8c>=0x0;_0x412e8c--)(_0x51aa8b=_0x53f1ff[_0x412e8c])&&(_0xbedf2e=_0x51aa8b(_0xbedf2e)||_0xbedf2e);return _0xbedf2e;},_0x3049c5=(_0x1c2ac7,_0x19c7cf)=>(_0x346ed6,_0x545bb6)=>_0x19c7cf(_0x346ed6,_0x545bb6,_0x1c2ac7);let _0x145b10=class extends _0x5bafa4[_0x3d1808(0x265)]{constructor(_0x584cd5,_0x176428,_0x2509fb,_0x5c93a3,_0x405765){var _0x2eabaa=_0x3d1808;super(),this[_0x2eabaa(0x50f)]=_0x584cd5,this[_0x2eabaa(0x4b8)]=_0x176428,this[_0x2eabaa(0x56a)]=_0x2509fb,this['_collaborationSessionService']=_0x5c93a3,this['_collaborationUIEventService']=_0x405765,this[_0x2eabaa(0x23a)](),this[_0x2eabaa(0x382)]();}[_0x3d1808(0x382)](){var _0x545d3f=_0x3d1808;const _0x196b49=async _0x4b2ed4=>{var _0x3d7334=_0x58ee;(await this[_0x3d7334(0x3f4)][_0x3d7334(0x3ed)](_0x4b2ed4))['event$']['pipe'](_0xd6074['filter'](_0x14f033=>_0x14f033[_0x3d7334(0x3a4)]===_0x3ab606[_0x3d7334(0x260)][_0x3d7334(0x515)]),_0xd6074[_0x3d7334(0x520)](this[_0x3d7334(0x39e)]))[_0x3d7334(0x239)](_0x531e6a=>{var _0x1661d4=_0x3d7334;const _0x582b01=_0x531e6a,{reason:_0x49daaa}=_0x582b01['data'];this['_collaborationUIEventService'][_0x1661d4(0x3e2)]({'id':_0x38090c['CLOSE_ROOM'],'data':_0x49daaa}),this[_0x1661d4(0x56a)]['updatePermissionPoint'](new _0x1c5262['WorkbookEditablePermission'](_0x4b2ed4)['id'],!0x1),this[_0x1661d4(0x3f4)][_0x1661d4(0x352)](_0x4b2ed4);});};_0x1a688c[_0x545d3f(0x46c)](this[_0x545d3f(0x4b8)]['getTypeOfUnitAdded$'](_0x5bafa4[_0x545d3f(0x35e)][_0x545d3f(0x246)]),this[_0x545d3f(0x4b8)][_0x545d3f(0x571)](_0x5bafa4[_0x545d3f(0x35e)][_0x545d3f(0x25d)]))['pipe'](_0xd6074['map'](_0x267899=>_0x267899[_0x545d3f(0x323)]()),_0xd6074['filter'](_0x9c75a2=>!_0x5bafa4[_0x545d3f(0x362)](_0x9c75a2)),_0xd6074[_0x545d3f(0x520)](this['dispose$']))['subscribe'](_0x5f4756=>{_0x196b49(_0x5f4756);});}[_0x3d1808(0x23a)](){var _0x43bdc0=_0x3d1808;const _0x19b3a8=async _0x5dff46=>{var _0xb09e0f=_0x58ee;const _0xdf5b9d=await this['_collaborationSessionService'][_0xb09e0f(0x3ed)](_0x5dff46),_0x19f45d=this[_0xb09e0f(0x50f)][_0xb09e0f(0x3f0)](_0x1c5262[_0xb09e0f(0x4cb)]);_0xdf5b9d[_0xb09e0f(0x2a4)][_0xb09e0f(0x24d)](_0xd6074[_0xb09e0f(0x3d2)](_0x2f3dde=>_0x2f3dde[_0xb09e0f(0x3a4)]===_0x3ab606[_0xb09e0f(0x260)][_0xb09e0f(0x425)]),_0xd6074[_0xb09e0f(0x520)](this['dispose$']))[_0xb09e0f(0x239)](_0x5e5d89=>{var _0x562a49=_0xb09e0f;const _0x3953db=_0x5e5d89,{objectId:_0x1b63a7}=_0x3953db[_0x562a49(0x285)];_0x1b63a7===_0x5dff46?_0x19f45d[_0x562a49(0x23c)](_0x5dff46):_0x19f45d[_0x562a49(0x341)](_0x5dff46,_0x1b63a7);});};_0x1a688c[_0x43bdc0(0x46c)](this['_univerInstanceService'][_0x43bdc0(0x571)](_0x5bafa4['UniverInstanceType'][_0x43bdc0(0x246)]))[_0x43bdc0(0x24d)](_0xd6074['map'](_0x14f091=>_0x14f091[_0x43bdc0(0x323)]()),_0xd6074[_0x43bdc0(0x3d2)](_0x47f599=>!_0x5bafa4[_0x43bdc0(0x362)](_0x47f599)),_0xd6074['takeUntil'](this[_0x43bdc0(0x39e)]))[_0x43bdc0(0x239)](_0x526182=>{_0x19b3a8(_0x526182);});}};_0x145b10=_0x7619f1([_0x3049c5(0x0,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0x3049c5(0x1,_0x5bafa4['IUniverInstanceService']),_0x3049c5(0x2,_0x5bafa4[_0x3d1808(0x226)]),_0x3049c5(0x3,_0x5bafa4['Inject'](_0x1065a7[_0x3d1808(0x492)])),_0x3049c5(0x4,_0x5bafa4[_0x3d1808(0x317)](_0x10cfe4))],_0x145b10);var _0x38f54c=Object[_0x3d1808(0x3cf)],_0x53e960=(_0x22c089,_0x875c4,_0xf04b40,_0x56054f)=>{var _0x4d7e6e=_0x3d1808;for(var _0x109a91=_0x56054f>0x1?void 0x0:_0x56054f?_0x38f54c(_0x875c4,_0xf04b40):_0x875c4,_0x30e12f=_0x22c089[_0x4d7e6e(0x3c5)]-0x1,_0x179842;_0x30e12f>=0x0;_0x30e12f--)(_0x179842=_0x22c089[_0x30e12f])&&(_0x109a91=_0x179842(_0x109a91)||_0x109a91);return _0x109a91;},_0x335754=(_0x466086,_0x7cd02)=>(_0x404f0c,_0x40682f)=>_0x7cd02(_0x404f0c,_0x40682f,_0x466086);_0x1065a7[_0x3d1808(0x2ab)]=class{constructor(_0x56cce2,_0x20567d){var _0x4f72cf=_0x3d1808;this[_0x4f72cf(0x4ee)]=_0x56cce2,this[_0x4f72cf(0x48b)]=_0x20567d;}async[_0x3d1808(0x278)](_0xc86ac1,_0xb7e9e9){var _0x14a1c1=_0x3d1808,_0x11bbf4;const {unitID:_0x162340,type:_0x38b8b3,revision:_0x2a7c34=0x0}=_0xb7e9e9,_0x2fb995=this[_0x14a1c1(0x1f5)]()+'/'+_0x38b8b3+_0x14a1c1(0x495)+_0x162340+_0x14a1c1(0x564)+_0x2a7c34,_0x14024a=(await this[_0x14a1c1(0x48b)][_0x14a1c1(0x3f0)](_0x2fb995))[_0x14a1c1(0x26c)],_0x2800a1=(_0x11bbf4=_0x14024a[_0x14a1c1(0x1e4)])==null?void 0x0:_0x11bbf4['workbook'];if(_0x2800a1){const _0xe54bfe=_0x2800a1==null?void 0x0:_0x2800a1[_0x14a1c1(0x4ab)],_0x41eb47=_0x3ab606[_0x14a1c1(0x55c)]['encode'](_0x3ab606[_0x14a1c1(0x3eb)](_0xe54bfe));_0x2800a1[_0x14a1c1(0x4ab)]=_0x41eb47,Object[_0x14a1c1(0x369)](_0x2800a1[_0x14a1c1(0x402)])['forEach'](([,_0x447244])=>{var _0x1368e7=_0x14a1c1;const _0x44fc88=_0x447244['originalMeta'],_0xa9350=_0x3ab606[_0x1368e7(0x55c)][_0x1368e7(0x25f)](_0x3ab606[_0x1368e7(0x3eb)](_0x44fc88));_0x447244['originalMeta']=_0xa9350;});}return _0x14024a;}async[_0x3d1808(0x2a5)](_0x5146ed,_0x1274fc){var _0x39987b=_0x3d1808;const {unitID:_0x35f810,type:_0x324ea8,blockID:_0x585c63}=_0x1274fc,_0xffff94=this[_0x39987b(0x2d7)]()+'/'+_0x324ea8+'/unit/'+_0x35f810+_0x39987b(0x328)+_0x585c63;return(await this[_0x39987b(0x48b)]['get'](_0xffff94))['body'];}async[_0x3d1808(0x1f6)](_0x1a2744,_0x3ecf93){var _0x50779d=_0x3d1808;const {unitID:_0x2e9aa2,type:_0x564f1e,blockID:_0x46bc26}=_0x3ecf93,_0x1460f8=this[_0x50779d(0x2d7)]()+_0x50779d(0x328)+_0x564f1e+_0x50779d(0x495)+_0x2e9aa2+_0x50779d(0x328)+_0x46bc26;return(await this[_0x50779d(0x48b)][_0x50779d(0x3f0)](_0x1460f8))[_0x50779d(0x26c)];}async[_0x3d1808(0x54b)](_0x4a67e4,_0x269d69){var _0x4bc09d=_0x3d1808;const {unitID:_0x5a29df,type:_0x429d33,from:_0x525710,to:_0x3bdbab}=_0x269d69,_0x3f0b09=this['_getAPIPrefix']()+'/'+_0x429d33+_0x4bc09d(0x495)+_0x5a29df+_0x4bc09d(0x4c0)+_0x525710+_0x4bc09d(0x251)+_0x3bdbab;return(await this[_0x4bc09d(0x48b)][_0x4bc09d(0x3f0)](_0x3f0b09))[_0x4bc09d(0x26c)];}[_0x3d1808(0x1f5)](){var _0x3e2161=_0x3d1808,_0x3599f4;return(_0x3599f4=this['_configService'][_0x3e2161(0x38b)](_0x268f01))!=null?_0x3599f4:this[_0x3e2161(0x2d7)]();}[_0x3d1808(0x2d7)](){var _0x49a621=_0x3d1808,_0x419c05;const _0x51c36f=this[_0x49a621(0x4ee)][_0x49a621(0x38b)](_0x755dce);return(_0x419c05=_0x51c36f==null?void 0x0:_0x51c36f['snapshotServerUrl'])!=null?_0x419c05:_0x37e926;}async['getResourcesRequest'](_0x28c325,_0x35916c){var _0x2bb43b=_0x3d1808;const _0x59b1d6=_0x2bb43b(0x23b)+_0x35916c[_0x2bb43b(0x436)]+'/unit/'+_0x35916c[_0x2bb43b(0x345)]+'/resources';return(await this[_0x2bb43b(0x48b)]['get'](_0x59b1d6,{'params':{'resourceId':JSON[_0x2bb43b(0x3c7)](_0x35916c['resourceIDs'])}}))[_0x2bb43b(0x26c)];}[_0x3d1808(0x32e)](){var _0x22a8ca=_0x3d1808;throw new Error(_0x22a8ca(0x4d4));}[_0x3d1808(0x4d6)](){var _0x588b8d=_0x3d1808;throw new Error(_0x588b8d(0x4d4));}[_0x3d1808(0x502)](){var _0x3e3358=_0x3d1808;throw new Error(_0x3e3358(0x4d4));}[_0x3d1808(0x516)](){var _0x83989=_0x3d1808;throw new Error(_0x83989(0x4d4));}[_0x3d1808(0x293)](){var _0x56890d=_0x3d1808;throw new Error(_0x56890d(0x4d4));}[_0x3d1808(0x2a1)](){var _0x232e82=_0x3d1808;throw new Error(_0x232e82(0x4d4));}},_0x1065a7[_0x3d1808(0x2ab)]=_0x53e960([_0x335754(0x0,_0x5bafa4[_0x3d1808(0x34c)]),_0x335754(0x1,_0x5bafa4[_0x3d1808(0x317)](_0x24f178[_0x3d1808(0x2c9)]))],_0x1065a7[_0x3d1808(0x2ab)]);var _0x2d42a1=Object[_0x3d1808(0x3cf)],_0x51079e=(_0x3b2634,_0x18c674,_0x32d1f2,_0x4d11e)=>{var _0x3fcda8=_0x3d1808;for(var _0x594f3d=_0x4d11e>0x1?void 0x0:_0x4d11e?_0x2d42a1(_0x18c674,_0x32d1f2):_0x18c674,_0x16ef88=_0x3b2634[_0x3fcda8(0x3c5)]-0x1,_0x4b4d84;_0x16ef88>=0x0;_0x16ef88--)(_0x4b4d84=_0x3b2634[_0x16ef88])&&(_0x594f3d=_0x4b4d84(_0x594f3d)||_0x594f3d);return _0x594f3d;},_0x1344c8=(_0x474f8f,_0x17fabf)=>(_0x3efe28,_0x1d365a)=>_0x17fabf(_0x3efe28,_0x1d365a,_0x474f8f);_0x1065a7[_0x3d1808(0x2d6)]=class extends _0x5bafa4[_0x3d1808(0x4d3)]{constructor(_0x2c4b45,_0x328b32,_0x3fd5d7,_0x39ee1c,_0x4f100d){var _0x51bda5=_0x3d1808;super(_0x2c4b45,_0x328b32,_0x3fd5d7),this[_0x51bda5(0x51f)]=_0x39ee1c,this[_0x51bda5(0x4dc)]=_0x4f100d;}[_0x3d1808(0x426)](_0x3d8515,_0x45f4d3){var _0xd15512=_0x3d1808;const _0x5f3fb4=this[_0xd15512(0x204)](_0x3d8515);if(_0x5f3fb4)try{const _0x6365ea=this[_0xd15512(0x1da)](_0x5f3fb4,_0x45f4d3);this[_0xd15512(0x52e)](_0x3d8515,_0x6365ea);}catch(_0x18db9d){this[_0xd15512(0x4dc)][_0xd15512(0x3f5)](_0xd15512(0x370),_0x18db9d),this[_0xd15512(0x46b)](_0x3d8515);}const _0x1c9852=this['_getRedoStack'](_0x3d8515);if(_0x1c9852)try{const _0x57e778=this[_0xd15512(0x1da)](_0x1c9852,_0x45f4d3);this[_0xd15512(0x481)](_0x3d8515,_0x57e778);}catch(_0x4a6b87){this[_0xd15512(0x4dc)][_0xd15512(0x3f5)](_0x4a6b87),this[_0xd15512(0x469)](_0x3d8515);}}['_clearUndo'](_0x52977b){var _0x1f0ae5=_0x3d1808;const _0x3b7efd=this[_0x1f0ae5(0x204)](_0x52977b);_0x3b7efd&&(_0x3b7efd[_0x1f0ae5(0x3c5)]=0x0,this['_updateStatus']());}['_clearRedo'](_0x23f28f){var _0x403add=_0x3d1808;const _0x5b532a=this[_0x403add(0x27b)](_0x23f28f);_0x5b532a&&(_0x5b532a[_0x403add(0x3c5)]=0x0,this[_0x403add(0x3c0)]());}[_0x3d1808(0x52e)](_0x33520b,_0x51d34a){var _0x1ebe97=_0x3d1808;this[_0x1ebe97(0x23d)]['set'](_0x33520b,_0x51d34a),this[_0x1ebe97(0x3c0)]();}['_substituteRedoStack'](_0x37a2ff,_0x16df2b){var _0x20fcbc=_0x3d1808;this[_0x20fcbc(0x294)][_0x20fcbc(0x373)](_0x37a2ff,_0x16df2b),this[_0x20fcbc(0x3c0)]();}['_transformStack'](_0x3840b0,_0xe7d440){var _0x3331ce=_0x3d1808;const _0x5ea966=[];let _0x383ce7=_0xe7d440,_0x1ea2dc=_0xe7d440;for(let _0x5d3cd1=_0x3840b0[_0x3331ce(0x3c5)]-0x1;_0x5d3cd1>=0x0;_0x5d3cd1--){const {unitID:_0x3f9279,undoMutations:_0x89a88c,redoMutations:_0x285f93}=_0x3840b0[_0x5d3cd1],_0x2ee5d8=this['_transformService'][_0x3331ce(0x441)](_0x383ce7,_0x89a88c),_0x13c515=this[_0x3331ce(0x51f)][_0x3331ce(0x441)](_0x1ea2dc,_0x285f93);if(_0x3ab606[_0x3331ce(0x3b5)](_0x2ee5d8)||_0x3ab606['isTransformMutationsWithChangesetFailure'](_0x13c515)){this[_0x3331ce(0x4dc)][_0x3331ce(0x3f5)](_0x3331ce(0x370),'transformStack\x20failed!',_0x2ee5d8,_0x13c515);break;}_0x383ce7=_0x2ee5d8[_0x3331ce(0x315)],_0x1ea2dc=_0x13c515['c1Prime'],_0x5ea966[_0x3331ce(0x381)]({'unitID':_0x3f9279,'undoMutations':_0x2ee5d8[_0x3331ce(0x45e)],'redoMutations':_0x13c515[_0x3331ce(0x45e)]});}return _0x5ea966[_0x3331ce(0x572)]();}},_0x1065a7[_0x3d1808(0x2d6)]=_0x51079e([_0x1344c8(0x0,_0x5bafa4[_0x3d1808(0x443)]),_0x1344c8(0x1,_0x5bafa4[_0x3d1808(0x3fc)]),_0x1344c8(0x2,_0x5bafa4['IContextService']),_0x1344c8(0x3,_0x3ab606[_0x3d1808(0x269)]),_0x1344c8(0x4,_0x5bafa4['ILogService'])],_0x1065a7[_0x3d1808(0x2d6)]);var _0x2c4fe1=Object[_0x3d1808(0x545)],_0x45d8d4=Object[_0x3d1808(0x3cf)],_0x314185=(_0x31a04d,_0x347a65,_0x5b510e)=>_0x347a65 in _0x31a04d?_0x2c4fe1(_0x31a04d,_0x347a65,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x5b510e}):_0x31a04d[_0x347a65]=_0x5b510e,_0x111b1f=(_0x594fe5,_0x5c7805,_0x1948a1,_0x2400ce)=>{for(var _0x4a797a=_0x2400ce>0x1?void 0x0:_0x2400ce?_0x45d8d4(_0x5c7805,_0x1948a1):_0x5c7805,_0x1169a1=_0x594fe5['length']-0x1,_0x34fd8b;_0x1169a1>=0x0;_0x1169a1--)(_0x34fd8b=_0x594fe5[_0x1169a1])&&(_0x4a797a=_0x34fd8b(_0x4a797a)||_0x4a797a);return _0x4a797a;},_0xe640ec=(_0x59f90c,_0x20059a)=>(_0x13c624,_0x203fca)=>_0x20059a(_0x13c624,_0x203fca,_0x59f90c),_0x5ebeaf=(_0x3cd4e5,_0x567ed9,_0x48e249)=>_0x314185(_0x3cd4e5,_0x567ed9+'',_0x48e249);const _0x242d36=_0x3d1808(0x3b1);_0x1065a7['UniverCollaborationClientPlugin']=class extends _0x5bafa4[_0x3d1808(0x435)]{constructor(_0x34cb82,_0x1f4ac6,_0x3a70fe,_0x4f6ceb){var _0x14076e=_0x3d1808;super(),_0x3fc7c7(this,_0x14076e(0x1dd)),(this[_0x14076e(0x4dc)]=_0x1f4ac6,this[_0x14076e(0x50f)]=_0x3a70fe,this['_configService']=_0x4f6ceb);const {..._0x27d525}=_0x5bafa4[_0x14076e(0x46c)]({},_0x38b249,_0x34cb82);if(!_0x27d525[_0x14076e(0x405)])throw new Error(_0x14076e(0x50e));this[_0x14076e(0x1dd)]=_0x27d525,this[_0x14076e(0x4ee)][_0x14076e(0x218)](_0x755dce,_0x27d525);}[_0x3d1808(0x3fa)](){var _0x28602e=_0x3d1808;this['_registerDependencies'](),this[_0x28602e(0x3a2)]();}[_0x3d1808(0x27e)](){var _0x128432=_0x3d1808,_0x5c0ee4,_0x4f1e40;this[_0x128432(0x50f)][_0x128432(0x4f0)](_0x5bafa4[_0x128432(0x407)])&&this[_0x128432(0x4dc)][_0x128432(0x3f5)](_0x128432(0x32c),'you\x20should\x20override\x20\x22IUndoRedoService\x22\x20provided\x20in\x20\x22core\x22\x20package!');const _0x3eea88=_0x5bafa4[_0x128432(0x2e5)]([[_0x5bafa4[_0x128432(0x407)],{'useClass':_0x1065a7[_0x128432(0x2d6)]}],[_0x1065a7['CollaborationSessionService']],[_0x1065a7[_0x128432(0x41b)]],[_0x1065a7[_0x128432(0x1f1)]],[_0x4dd8be],[_0x282438],[_0x178a41],[_0x145b10],[_0x10cfe4],[_0x1065a7[_0x128432(0x413)]],[_0x3dca45,{'useClass':this[_0x128432(0x1dd)][_0x128432(0x405)]}],[_0x3ab606['ISnapshotServerService'],{'useClass':_0x1065a7['SnapshotServerOverHTTPService']}],[_0x5bafa4[_0x128432(0x480)],{'useClass':_0x1065a7[_0x128432(0x346)]}],[_0x301beb[_0x128432(0x3c9)],{'useClass':_0x1065a7[_0x128432(0x42a)]}],[_0x5bafa4[_0x128432(0x37f)],{'useClass':_0x1065a7[_0x128432(0x2a2)]}],[_0x1065a7[_0x128432(0x54f)]],[_0x2ed31f]],(_0x5c0ee4=this['_config'])==null?void 0x0:_0x5c0ee4[_0x128432(0x52a)]);if(!((_0x4f1e40=this['_config'])!=null&&_0x4f1e40[_0x128432(0x450)])){const _0x456779=_0x3eea88[_0x128432(0x359)](([_0x3cb21f])=>_0x3cb21f===_0x175519);_0x456779!==-0x1&&_0x3eea88[_0x128432(0x2b3)](_0x456779,0x1);}_0x5bafa4[_0x128432(0x3d6)](this[_0x128432(0x50f)],_0x3eea88);}[_0x3d1808(0x3a2)](){var _0x27b27d=_0x3d1808,_0x38c5fd,_0xf5320d,_0x799697;this[_0x27b27d(0x50f)][_0x27b27d(0x3f0)](_0x24f178[_0x27b27d(0x2c9)])[_0x27b27d(0x252)]({'priority':0x14,'interceptor':_0x24f178['ThresholdInterceptorFactory']({'maxParallel':0x6})}),(_0x38c5fd=this[_0x27b27d(0x1dd)])!=null&&_0x38c5fd[_0x27b27d(0x329)]||(_0xf5320d=this[_0x27b27d(0x50f)]['get'](_0xd8e545,_0x5bafa4['Quantity'][_0x27b27d(0x541)]))==null||_0xf5320d[_0x27b27d(0x38a)](),(_0x799697=this[_0x27b27d(0x1dd)])!=null&&_0x799697[_0x27b27d(0x2b5)]&&_0x5bafa4['touchDependencies'](this[_0x27b27d(0x50f)],[[_0x4dd8be]]),_0x5bafa4[_0x27b27d(0x3a9)](this[_0x27b27d(0x50f)],[[_0x282438],[_0x1065a7[_0x27b27d(0x54f)]],[_0x145b10]]);}},_0x5ebeaf(_0x1065a7['UniverCollaborationClientPlugin'],_0x3d1808(0x374),_0x242d36),_0x1065a7[_0x3d1808(0x47b)]=_0x111b1f([_0x5bafa4[_0x3d1808(0x1d7)](_0x3ab606[_0x3d1808(0x257)],_0x24f178['UniverNetworkPlugin']),_0xe640ec(0x1,_0x5bafa4[_0x3d1808(0x528)]),_0xe640ec(0x2,_0x5bafa4[_0x3d1808(0x317)](_0x5bafa4[_0x3d1808(0x511)])),_0xe640ec(0x3,_0x5bafa4[_0x3d1808(0x34c)])],_0x1065a7[_0x3d1808(0x47b)]),_0x1065a7[_0x3d1808(0x51b)]=_0x755dce,_0x1065a7[_0x3d1808(0x41f)]=_0x293214,_0x1065a7[_0x3d1808(0x4e6)]=_0x38090c,_0x1065a7[_0x3d1808(0x444)]=_0x10cfe4,_0x1065a7[_0x3d1808(0x490)]=_0x178a41,_0x1065a7['DEFAULT_COLLAB_WEB_SOCKET_URL']=_0x38d231,_0x1065a7[_0x3d1808(0x2a3)]=_0x287679,_0x1065a7[_0x3d1808(0x3d5)]=_0x480f18,_0x1065a7['HEARTBEAT_INTERVAL_KEY']=_0x38c58d,_0x1065a7[_0x3d1808(0x38e)]=_0x3d06ad,_0x1065a7[_0x3d1808(0x275)]=_0x3dca45,_0x1065a7[_0x3d1808(0x28f)]=_0xd8e545,_0x1065a7['INetworkConditionService']=_0x206d80,_0x1065a7[_0x3d1808(0x1e8)]=_0x175519,_0x1065a7['LOCAL_CACHE_INTERVAL']=0x3e8,_0x1065a7[_0x3d1808(0x1f0)]=_0x36ba43,_0x1065a7['REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY']=_0x183c7f,_0x1065a7['RETRY_CONNECTING_MAX_COUNT_KEY']=_0x589908,_0x1065a7['SessionStatus']=_0x4b7463,_0x1065a7['UnitStatus']=_0x166ac9,_0x1065a7['deserializeToCombResponse']=_0x10e983,_0x1065a7['getLocalCacheKey']=_0x2d48c6,_0x1065a7['serializeCombRequest']=_0x52cb3a,Object[_0x3d1808(0x545)](_0x1065a7,Symbol[_0x3d1808(0x4da)],{'value':'Module'});}));

// @univerjs-pro/collaboration-client/facade
(function(_0x202dca,_0x5a65b8){const _0x3521a1=_0x459a,_0x59c1a0=_0x202dca();while(!![]){try{const _0x2e69c7=parseInt(_0x3521a1(0x1b6))/0x1+parseInt(_0x3521a1(0x1b0))/0x2+-parseInt(_0x3521a1(0x1a5))/0x3+parseInt(_0x3521a1(0x1bd))/0x4+parseInt(_0x3521a1(0x1be))/0x5*(parseInt(_0x3521a1(0x1c2))/0x6)+-parseInt(_0x3521a1(0x1d2))/0x7+-parseInt(_0x3521a1(0x1d7))/0x8;if(_0x2e69c7===_0x5a65b8)break;else _0x59c1a0['push'](_0x59c1a0['shift']());}catch(_0x5fb4bd){_0x59c1a0['push'](_0x59c1a0['shift']());}}}(_0x5c6b,0x9cd3d),function(_0x4e06ad,_0x3afa52){const _0x281be3=_0x459a;typeof exports==_0x281be3(0x1b8)&&typeof module<'u'?_0x3afa52(exports,require('@univerjs-pro/collaboration-client'),require('@univerjs/core/facade'),require('@univerjs-pro/collaboration'),require('@univerjs/core'),require('rxjs')):typeof define=='function'&&define[_0x281be3(0x1e3)]?define([_0x281be3(0x1b1),_0x281be3(0x1ab),_0x281be3(0x1a8),_0x281be3(0x1b2),_0x281be3(0x1d1),_0x281be3(0x1d8)],_0x3afa52):(_0x4e06ad=typeof globalThis<'u'?globalThis:_0x4e06ad||self,_0x3afa52(_0x4e06ad['UniverProCollaborationClientFacade']={},_0x4e06ad[_0x281be3(0x1aa)],_0x4e06ad[_0x281be3(0x1e0)],_0x4e06ad[_0x281be3(0x1a4)],_0x4e06ad[_0x281be3(0x1ad)],_0x4e06ad[_0x281be3(0x1d8)]));}(this,function(_0x18aba4,_0x502f45,_0x52d772,_0x4eb75a,_0x1d069b,_0x40b356){'use strict';const _0x5b9850=_0x459a;class _0x55c592 extends _0x52d772[_0x5b9850(0x1bb)]{get[_0x5b9850(0x1ce)](){return _0x502f45['CollaborationStatus'];}}_0x52d772[_0x5b9850(0x1bb)][_0x5b9850(0x1d0)](_0x55c592);var _0x50fa9c=Object[_0x5b9850(0x1a3)],_0x4931e3=(_0x2da02a,_0x3fe406,_0x43fed7,_0x5636aa)=>{const _0x4ab119=_0x5b9850;for(var _0x247781=_0x5636aa>0x1?void 0x0:_0x5636aa?_0x50fa9c(_0x3fe406,_0x43fed7):_0x3fe406,_0x5a8e60=_0x2da02a[_0x4ab119(0x1a7)]-0x1,_0x52d2cd;_0x5a8e60>=0x0;_0x5a8e60--)(_0x52d2cd=_0x2da02a[_0x5a8e60])&&(_0x247781=_0x52d2cd(_0x247781)||_0x247781);return _0x247781;},_0x351144=(_0x1fad11,_0x1f6912)=>(_0x11b048,_0x57e6f1)=>_0x1f6912(_0x11b048,_0x57e6f1,_0x1fad11);_0x18aba4[_0x5b9850(0x1db)]=class extends _0x52d772[_0x5b9850(0x1c6)]{constructor(_0x3c3f61,_0x29dd5e,_0x4f53ef,_0x12feac,_0x3cd9b7){const _0x200e5a=_0x5b9850;super(),this[_0x200e5a(0x1cb)]=_0x3c3f61,this[_0x200e5a(0x1c7)]=_0x29dd5e,this[_0x200e5a(0x1b4)]=_0x4f53ef,this[_0x200e5a(0x1d4)]=_0x12feac,this[_0x200e5a(0x1cd)]=_0x3cd9b7;}async[_0x5b9850(0x1a9)](){return this['loadActiveSheetAsync']();}async[_0x5b9850(0x1a6)](){const _0x152235=_0x5b9850;throw new Error(_0x152235(0x1bc));}async[_0x5b9850(0x1d9)](_0x360711){return this['loadSheetAsync'](_0x360711);}async[_0x5b9850(0x1cf)](_0x56ebd7,_0x459109){const _0x230063=_0x5b9850;return await this[_0x230063(0x1d4)]['loadSheet'](_0x56ebd7,0x0,_0x459109)?(await this[_0x230063(0x1cd)][_0x230063(0x1d6)](_0x56ebd7),this[_0x230063(0x1cb)]['getUniverSheet'](_0x56ebd7)):null;}[_0x5b9850(0x1bf)](_0x529719,_0x1d3931){const _0x1f9790=_0x5b9850,_0x3201a0=this['_injector'][_0x1f9790(0x1b9)](_0x502f45[_0x1f9790(0x1a2)])[_0x1f9790(0x1ca)](_0x529719)[_0x1f9790(0x1df)](_0x40b356[_0x1f9790(0x1b5)](_0x1fd115=>_0x1fd115[_0x1f9790(0x1e1)]))[_0x1f9790(0x1c0)](_0x2d938f=>_0x1d3931(Array[_0x1f9790(0x1c3)](_0x2d938f[_0x1f9790(0x1c4)]())));return _0x1d069b[_0x1f9790(0x1dc)](_0x3201a0);}[_0x5b9850(0x1dd)](){const _0xa956c3=_0x5b9850,_0x4d1a9b=this['_univerInstanceService'][_0xa956c3(0x1b3)]();if(!_0x4d1a9b)return _0x502f45[_0xa956c3(0x1ce)][_0xa956c3(0x1c8)];const _0x5ee2c0=this['_collaborationController'][_0xa956c3(0x1af)](_0x4d1a9b[_0xa956c3(0x1cc)]());return _0x5ee2c0?_0x5ee2c0['state']['status']:_0x502f45[_0xa956c3(0x1ce)][_0xa956c3(0x1c8)];}},_0x18aba4['FCollaboration']=_0x4931e3([_0x351144(0x1,_0x1d069b['Inject'](_0x1d069b[_0x5b9850(0x1ba)])),_0x351144(0x2,_0x1d069b['IUniverInstanceService']),_0x351144(0x3,_0x1d069b['Inject'](_0x4eb75a[_0x5b9850(0x1ac)])),_0x351144(0x4,_0x1d069b[_0x5b9850(0x1ae)](_0x502f45[_0x5b9850(0x1de)]))],_0x18aba4[_0x5b9850(0x1db)]);class _0x283ede extends _0x52d772['FUniver']{['getCollaboration'](){const _0x179c9f=_0x5b9850;return this[_0x179c9f(0x1c7)][_0x179c9f(0x1d5)](_0x18aba4[_0x179c9f(0x1db)],{'getUniverSheet':_0x14d4c3=>this[_0x179c9f(0x1d3)](_0x14d4c3)});}[_0x5b9850(0x1b7)](_0x16c3b3,_0x423ae3,_0x2133c5){const _0x1022ad=_0x5b9850;return this['_injector'][_0x1022ad(0x1b9)](_0x502f45[_0x1022ad(0x1e2)])[_0x1022ad(0x1c9)](_0x16c3b3,_0x423ae3,_0x2133c5);}[_0x5b9850(0x1da)](_0x4ae5fc,_0xd363dc,_0x12369b){const _0x304826=_0x5b9850;return this[_0x304826(0x1c7)][_0x304826(0x1b9)](_0x502f45[_0x304826(0x1e2)])[_0x304826(0x1c5)](_0x4ae5fc,_0xd363dc,_0x12369b);}}_0x52d772['FUniver'][_0x5b9850(0x1d0)](_0x283ede),Object[_0x5b9850(0x1c1)](_0x18aba4,Symbol['toStringTag'],{'value':'Module'});}));function _0x459a(_0x4271d8,_0x5ce185){_0x4271d8=_0x4271d8-0x1a2;const _0x5c6b06=_0x5c6b();let _0x459af2=_0x5c6b06[_0x4271d8];return _0x459af2;}function _0x5c6b(){const _0x3a9338=['MemberService','getOwnPropertyDescriptor','UniverProCollaboration','2070366gcDClw','loadActiveSheetAsync','length','@univerjs/core/facade','loadActiveSheet','UniverProCollaborationClient','@univerjs-pro/collaboration-client','SnapshotService','UniverCore','Inject','getCollabEntity','2020564sEmAfh','exports','@univerjs-pro/collaboration','getFocusedUnit','_univerInstanceService','switchMap','449748OSKcIH','loadServerUnit','object','get','Injector','FEnum','[FCollaboration]:\x20this\x20method\x20should\x20be\x20override.','1252804BXWKty','94390Sxafzl','subscribeCollaborators','subscribe','defineProperty','318SiKabK','from','values','loadUnitOfRevision','FBase','_injector','NOT_COLLAB','loadUnit','waitForRoom$','_handler','getUnitId','_collaborationController','CollaborationStatus','loadSheetAsync','extend','@univerjs/core','3724966sHNBUV','getUniverSheet','_snapshotService','createInstance','readyForCollab','7273120lyXzMp','rxjs','loadSheet','loadServerUnitOfRevision','FCollaboration','toDisposable','getCollaborationStatus','CollaborationController','pipe','UniverCoreFacade','members$','DataLoaderService','amd'];_0x5c6b=function(){return _0x3a9338;};return _0x5c6b();}

// @univerjs-pro/collaboration-client-ui/index
(function(_0x53cbe3,_0x45a409){const _0xd64623=_0x48a1,_0x2e1bb5=_0x53cbe3();while(!![]){try{const _0x2d8638=-parseInt(_0xd64623(0x2b1))/0x1+parseInt(_0xd64623(0x2d6))/0x2*(parseInt(_0xd64623(0x406))/0x3)+parseInt(_0xd64623(0x224))/0x4+parseInt(_0xd64623(0x438))/0x5+-parseInt(_0xd64623(0x399))/0x6*(-parseInt(_0xd64623(0x25f))/0x7)+-parseInt(_0xd64623(0x35a))/0x8+-parseInt(_0xd64623(0x1e5))/0x9;if(_0x2d8638===_0x45a409)break;else _0x2e1bb5['push'](_0x2e1bb5['shift']());}catch(_0x205f14){_0x2e1bb5['push'](_0x2e1bb5['shift']());}}}(_0xe035,0xc0460),function(_0xd4d077,_0x3d21c3){const _0x2c1a53=_0x48a1;typeof exports==_0x2c1a53(0x21e)&&typeof module<'u'?_0x3d21c3(exports,require('react/jsx-runtime'),require('@univerjs-pro/collaboration-client'),require('@univerjs/core'),require('@univerjs/ui'),require('rxjs'),require('@univerjs/design'),require('react'),require('@univerjs/rpc'),require('@univerjs/sheets'),require('@univerjs/engine-render'),require('@univerjs/network'),require('@univerjs/docs-ui'),require('@univerjs/drawing'),require('@univerjs-pro/collaboration'),require('@univerjs/docs'),require('@univerjs/engine-formula'),require('rxjs/operators'),require('@univerjs/sheets-ui')):typeof define=='function'&&define['amd']?define([_0x2c1a53(0x3d9),_0x2c1a53(0x427),_0x2c1a53(0x2b5),_0x2c1a53(0x256),_0x2c1a53(0x2c4),_0x2c1a53(0x2e9),_0x2c1a53(0x49e),_0x2c1a53(0x202),_0x2c1a53(0x2fe),'@univerjs/sheets',_0x2c1a53(0x281),_0x2c1a53(0x214),_0x2c1a53(0x1e3),_0x2c1a53(0x3b3),_0x2c1a53(0x371),_0x2c1a53(0x439),_0x2c1a53(0x1fe),_0x2c1a53(0x424),_0x2c1a53(0x311)],_0x3d21c3):(_0xd4d077=typeof globalThis<'u'?globalThis:_0xd4d077||self,_0x3d21c3(_0xd4d077[_0x2c1a53(0x27f)]={},_0xd4d077[_0x2c1a53(0x3ed)],_0xd4d077[_0x2c1a53(0x1b5)],_0xd4d077[_0x2c1a53(0x2ca)],_0xd4d077['UniverUi'],_0xd4d077[_0x2c1a53(0x2e9)],_0xd4d077[_0x2c1a53(0x2b2)],_0xd4d077[_0x2c1a53(0x3ed)],_0xd4d077[_0x2c1a53(0x2c0)],_0xd4d077[_0x2c1a53(0x337)],_0xd4d077['UniverEngineRender'],_0xd4d077[_0x2c1a53(0x405)],_0xd4d077[_0x2c1a53(0x2e4)],_0xd4d077[_0x2c1a53(0x3e4)],_0xd4d077[_0x2c1a53(0x213)],_0xd4d077[_0x2c1a53(0x47b)],_0xd4d077['UniverEngineFormula'],_0xd4d077[_0x2c1a53(0x2e9)][_0x2c1a53(0x2f6)],_0xd4d077[_0x2c1a53(0x269)]));}(this,function(_0x44b1a7,_0x89e71e,_0x3fe1f0,_0x39304f,_0x4c3b5c,_0x404575,_0x31598f,_0x13ddda,_0x256d9b,_0x3203ce,_0x46a3bd,_0x4e0fb2,_0x2abae2,_0x389a81,_0x560361,_0x59af06,_0x284237,_0x11a31a,_0x5ee9c5){'use strict';const _0x5de549=_0x48a1;var _0x28f531=Object[_0x5de549(0x412)],_0xeb5bc4=(_0x2733a3,_0x41b2d4,_0x2d1c3c)=>_0x41b2d4 in _0x2733a3?_0x28f531(_0x2733a3,_0x41b2d4,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0x2d1c3c}):_0x2733a3[_0x41b2d4]=_0x2d1c3c,_0x41fabe=(_0x5acffd,_0x4ebf5c,_0x312e32)=>_0xeb5bc4(_0x5acffd,typeof _0x4ebf5c!=_0x5de549(0x277)?_0x4ebf5c+'':_0x4ebf5c,_0x312e32);function _0x5a6335({ref:_0x5983e8,..._0x1b53bb}){const _0x490bb7=_0x5de549,{icon:_0x557ba5,id:_0x434f45,className:_0x1be508,extend:_0x52e838,..._0x500606}=_0x1b53bb,_0x54f7a1=(_0x490bb7(0x450)+_0x434f45+'\x20'+(_0x1be508||''))[_0x490bb7(0x27a)](),_0x5e7743=_0x13ddda[_0x490bb7(0x27b)]('_'+_0x3b89e2());return _0x3b00c8(_0x557ba5,''+_0x434f45,{'defIds':_0x557ba5[_0x490bb7(0x417)],'idSuffix':_0x5e7743['current']},{'ref':_0x5983e8,'className':_0x54f7a1,..._0x500606},_0x52e838);}function _0x3b00c8(_0x26274b,_0x290b1c,_0x3c26de,_0x5661d8,_0x397cf7){const _0x5c6126=_0x5de549;return _0x13ddda['createElement'](_0x26274b[_0x5c6126(0x483)],{'key':_0x290b1c,..._0x4f9e0c(_0x26274b,_0x3c26de,_0x397cf7),..._0x5661d8},(_0x120f5f(_0x26274b,_0x3c26de)[_0x5c6126(0x497)]||[])[_0x5c6126(0x309)]((_0x17c1e5,_0x8db2f7)=>_0x3b00c8(_0x17c1e5,_0x290b1c+'-'+_0x26274b[_0x5c6126(0x483)]+'-'+_0x8db2f7,_0x3c26de,void 0x0,_0x397cf7)));}function _0x4f9e0c(_0x4dab37,_0x278bbd,_0x5ea664){const _0xf1e258=_0x5de549,_0x1002ea={..._0x4dab37['attrs']};_0x5ea664!=null&&_0x5ea664[_0xf1e258(0x30c)]&&_0x1002ea[_0xf1e258(0x402)]==='colorChannel1'&&(_0x1002ea[_0xf1e258(0x402)]=_0x5ea664[_0xf1e258(0x30c)]),_0x4dab37[_0xf1e258(0x483)]===_0xf1e258(0x292)&&_0x1002ea['id']&&(_0x1002ea['id']=_0x1002ea['id']+_0x278bbd[_0xf1e258(0x336)]),Object[_0xf1e258(0x400)](_0x1002ea)[_0xf1e258(0x22a)](([_0x53cc8a,_0x35906d])=>{const _0x5a4df8=_0xf1e258;_0x53cc8a===_0x5a4df8(0x292)&&typeof _0x35906d==_0x5a4df8(0x1cd)&&(_0x1002ea[_0x53cc8a]=_0x35906d['replace'](/url\(#(.*)\)/,'url(#$1'+_0x278bbd[_0x5a4df8(0x336)]+')'));});const {defIds:_0xc96725}=_0x278bbd;return!_0xc96725||_0xc96725[_0xf1e258(0x3b7)]===0x0||(_0x4dab37['tag']===_0xf1e258(0x313)&&_0x1002ea[_0xf1e258(0x3e3)]&&(_0x1002ea[_0xf1e258(0x3e3)]=_0x1002ea[_0xf1e258(0x3e3)]+_0x278bbd[_0xf1e258(0x336)]),Object['entries'](_0x1002ea)[_0xf1e258(0x22a)](([_0x372105,_0x8d17f1])=>{const _0x160136=_0xf1e258;typeof _0x8d17f1==_0x160136(0x1cd)&&(_0x1002ea[_0x372105]=_0x8d17f1[_0x160136(0x1dd)](/url\(#(.*)\)/,_0x160136(0x3cb)+_0x278bbd['idSuffix']+')'));})),_0x1002ea;}function _0x120f5f(_0x3ce3c3,_0xd70c4f){const _0x295a7c=_0x5de549;var _0x154b3e;const {defIds:_0x539ae8}=_0xd70c4f;return!_0x539ae8||_0x539ae8['length']===0x0?_0x3ce3c3:_0x3ce3c3[_0x295a7c(0x483)]===_0x295a7c(0x463)&&((_0x154b3e=_0x3ce3c3[_0x295a7c(0x497)])!=null&&_0x154b3e['length'])?{..._0x3ce3c3,'children':_0x3ce3c3[_0x295a7c(0x497)]['map'](_0x2010cc=>typeof _0x2010cc[_0x295a7c(0x454)]['id']==_0x295a7c(0x1cd)&&_0x539ae8&&_0x539ae8[_0x295a7c(0x410)](_0x2010cc[_0x295a7c(0x454)]['id'])?{..._0x2010cc,'attrs':{..._0x2010cc['attrs'],'id':_0x2010cc['attrs']['id']+_0xd70c4f['idSuffix']}}:_0x2010cc)}:_0x3ce3c3;}function _0x3b89e2(){const _0x18975c=_0x5de549;return Math[_0x18975c(0x46c)]()[_0x18975c(0x492)](0x24)[_0x18975c(0x301)](0x2,0x8);}_0x5a6335[_0x5de549(0x3bd)]='UniverIcon';const _0x343eae={'tag':_0x5de549(0x2a1),'attrs':{'xmlns':_0x5de549(0x2a9),'fill':'none','viewBox':_0x5de549(0x31f),'width':_0x5de549(0x2f5),'height':'1em'},'children':[{'tag':'g','attrs':{'clipPath':_0x5de549(0x389)},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'stroke':_0x5de549(0x46a),'d':_0x5de549(0x4a9),'strokeLinecap':_0x5de549(0x3bb),'strokeLinejoin':_0x5de549(0x3bb),'strokeWidth':1.2}}]},{'tag':_0x5de549(0x463),'attrs':{},'children':[{'tag':'clipPath','attrs':{'id':_0x5de549(0x3ec)},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'fill':_0x5de549(0x392),'d':_0x5de549(0x375)}}]}]}],'defIds':[_0x5de549(0x3ec)]},_0x2bc78d=_0x13ddda[_0x5de549(0x234)](function(_0x40a036,_0x29d2be){const _0x579388=_0x5de549;return _0x13ddda[_0x579388(0x45e)](_0x5a6335,Object[_0x579388(0x283)]({},_0x40a036,{'id':_0x579388(0x3d3),'ref':_0x29d2be,'icon':_0x343eae}));});_0x2bc78d[_0x5de549(0x3bd)]=_0x5de549(0x2a2);const _0x181b5c={'tag':'svg','attrs':{'xmlns':'http://www.w3.org/2000/svg','fill':'none','viewBox':_0x5de549(0x217),'width':_0x5de549(0x2f5),'height':_0x5de549(0x2f5)},'children':[{'tag':'g','attrs':{'clipPath':_0x5de549(0x233)},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'stroke':_0x5de549(0x46a),'d':_0x5de549(0x232),'strokeLinecap':_0x5de549(0x3bb),'strokeLinejoin':_0x5de549(0x3bb),'strokeWidth':1.2}}]},{'tag':'defs','attrs':{},'children':[{'tag':'clipPath','attrs':{'id':'on-line-icon_clip0_910_349'},'children':[{'tag':_0x5de549(0x2f3),'attrs':{'fill':'white','d':_0x5de549(0x375),'transform':'translate(.97)'}}]}]}],'defIds':['on-line-icon_clip0_910_349']},_0x5c0237=_0x13ddda[_0x5de549(0x234)](function(_0x43c65,_0x42df77){const _0x3e76cb=_0x5de549;return _0x13ddda['createElement'](_0x5a6335,Object[_0x3e76cb(0x283)]({},_0x43c65,{'id':_0x3e76cb(0x478),'ref':_0x42df77,'icon':_0x181b5c}));});_0x5c0237[_0x5de549(0x3bd)]=_0x5de549(0x1e4);function _0x19e725(_0x1d9633){const _0x159eb4=_0x5de549;switch(_0x1d9633){case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x327)]:return _0x159eb4(0x220);case _0x3fe1f0['CollaborationStatus']['CONFLICT']:return _0x159eb4(0x4a0);case _0x3fe1f0['CollaborationStatus'][_0x159eb4(0x2ef)]:return _0x159eb4(0x1fc);case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x475)]:return _0x159eb4(0x2aa);case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x2cd)]:case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x2e2)]:return _0x159eb4(0x216);case _0x3fe1f0['CollaborationStatus'][_0x159eb4(0x2a5)]:case _0x3fe1f0[_0x159eb4(0x329)][_0x159eb4(0x363)]:return _0x159eb4(0x276);}}function _0x15d907(_0x511b81){const _0x404306=_0x5de549,{status$:_0x35106c}=_0x511b81,_0x1b1f2d=_0x4c3b5c[_0x404306(0x33c)](_0x35106c,_0x3fe1f0[_0x404306(0x329)][_0x404306(0x475)]),_0x1603f2=_0x4c3b5c[_0x404306(0x3d1)](_0x39304f[_0x404306(0x3f4)]),_0x5e4aad=_0x4c3b5c['useDependency'](_0x3fe1f0['CollaborationSessionService']),_0x1e0d9a=_0x1b1f2d!==_0x3fe1f0['CollaborationStatus'][_0x404306(0x327)],_0x4539da=_0x1603f2['t'](_0x19e725(_0x1b1f2d)),_0x4b059e=_0x1e0d9a?_0x89e71e['jsx'](_0x5c0237,{}):_0x89e71e[_0x404306(0x460)](_0x2bc78d,{}),_0x5d6804=_0x13ddda['useCallback'](()=>{const _0x59beb7=_0x404306;_0x1e0d9a||_0x5e4aad[_0x59beb7(0x1b3)]();},[_0x1e0d9a,_0x5e4aad]);function _0xc6b601(){const _0x3ef2ac=_0x404306;return _0x89e71e[_0x3ef2ac(0x20d)]('div',{'className':_0x3ef2ac(0x2e0),'onClick':_0x5d6804,'children':[_0x89e71e[_0x3ef2ac(0x460)](_0x3ef2ac(0x359),{'className':_0x31598f[_0x3ef2ac(0x409)]('univer-mr-2\x20univer-flex\x20univer-text-xl',{'univer-text-green-500':_0x1e0d9a,'univer-text-red-500':!_0x1e0d9a}),'children':_0x4b059e}),_0x89e71e[_0x3ef2ac(0x460)](_0x3ef2ac(0x359),{'className':_0x3ef2ac(0x489),'children':_0x4539da})]});}return _0x1e0d9a?_0xc6b601():_0x89e71e['jsx'](_0x31598f[_0x404306(0x3d2)],{'title':_0x1603f2['t'](_0x404306(0x268)),'children':_0xc6b601()});}var _0x2782bb=Object[_0x5de549(0x49f)],_0x172f07=(_0x2f8ea9,_0x42f4c9,_0xb09d29,_0x3e3cc2)=>{const _0x17cba1=_0x5de549;for(var _0x5a1a0c=_0x3e3cc2>0x1?void 0x0:_0x3e3cc2?_0x2782bb(_0x42f4c9,_0xb09d29):_0x42f4c9,_0x4d00b7=_0x2f8ea9[_0x17cba1(0x3b7)]-0x1,_0x2ba80b;_0x4d00b7>=0x0;_0x4d00b7--)(_0x2ba80b=_0x2f8ea9[_0x4d00b7])&&(_0x5a1a0c=_0x2ba80b(_0x5a1a0c)||_0x5a1a0c);return _0x5a1a0c;},_0x2ef9d2=(_0x1c68b5,_0x50f188)=>(_0x388ff8,_0x178ce4)=>_0x50f188(_0x388ff8,_0x178ce4,_0x1c68b5);_0x44b1a7['DesktopCollaborationStatusDisplayController']=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x9d4c5e,_0x4e52f0,_0x45af5d,_0x53a7da){const _0x5dd0af=_0x5de549;super(),_0x41fabe(this,_0x5dd0af(0x2e8),new _0x404575[(_0x5dd0af(0x25b))](_0x3fe1f0[_0x5dd0af(0x329)][_0x5dd0af(0x475)])),(this['_univerInstanceService']=_0x9d4c5e,this['_injector']=_0x4e52f0,this[_0x5dd0af(0x1fd)]=_0x45af5d,this[_0x5dd0af(0x30a)]=_0x53a7da,this['_initStatusComponent'](),this[_0x5dd0af(0x1b4)]());}[_0x5de549(0x1b4)](){const _0x2b536a=_0x5de549;this['disposeWithMe'](this[_0x2b536a(0x26e)][_0x2b536a(0x29c)][_0x2b536a(0x498)](_0x404575['switchMap'](()=>{const _0x4e64b3=_0x2b536a,_0x4cdc61=this['_univerInstanceService'][_0x4e64b3(0x3ae)]();return _0x4cdc61?this[_0x4e64b3(0x1fd)][_0x4e64b3(0x3a5)](_0x4cdc61[_0x4e64b3(0x41e)]()):_0x404575['of'](null);}),_0x404575[_0x2b536a(0x287)](_0x2bf472=>_0x2bf472?_0x2bf472[_0x2b536a(0x240)]:_0x404575['of'](_0x3fe1f0[_0x2b536a(0x329)][_0x2b536a(0x475)])))[_0x2b536a(0x38e)](_0x169db7=>{const _0x718656=_0x2b536a;this[_0x718656(0x2e8)][_0x718656(0x345)](_0x169db7);}));}['_initStatusComponent'](){const _0x1445a4=_0x5de549;this['disposeWithMe'](this[_0x1445a4(0x30a)][_0x1445a4(0x40c)](_0x4c3b5c['BuiltInUIPart'][_0x1445a4(0x40d)],()=>_0x4c3b5c[_0x1445a4(0x351)](_0x10ae48({'status$':this[_0x1445a4(0x2e8)]['asObservable']()}),this[_0x1445a4(0x31d)])));}},_0x44b1a7['DesktopCollaborationStatusDisplayController']=_0x172f07([_0x2ef9d2(0x0,_0x39304f[_0x5de549(0x2cc)]),_0x2ef9d2(0x1,_0x39304f[_0x5de549(0x356)](_0x39304f['Injector'])),_0x2ef9d2(0x2,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x28d)])),_0x2ef9d2(0x3,_0x4c3b5c[_0x5de549(0x2e3)])],_0x44b1a7['DesktopCollaborationStatusDisplayController']);function _0x10ae48(_0x337431){const {status$:_0x346179}=_0x337431;return function(){const _0x30f706=_0x48a1;return _0x89e71e[_0x30f706(0x460)](_0x15d907,{'status$':_0x346179});};}const _0x4d8922=_0x39304f[_0x5de549(0x221)](_0x5de549(0x3b6));var _0x57b2b1=Object[_0x5de549(0x49f)],_0x2c13d4=(_0x4713ca,_0x19cb17,_0x3a42ec,_0x4cc95d)=>{const _0x41e5f7=_0x5de549;for(var _0x1fe1ed=_0x4cc95d>0x1?void 0x0:_0x4cc95d?_0x57b2b1(_0x19cb17,_0x3a42ec):_0x19cb17,_0x30dac4=_0x4713ca[_0x41e5f7(0x3b7)]-0x1,_0x5457d8;_0x30dac4>=0x0;_0x30dac4--)(_0x5457d8=_0x4713ca[_0x30dac4])&&(_0x1fe1ed=_0x5457d8(_0x1fe1ed)||_0x1fe1ed);return _0x1fe1ed;},_0x7cdaa=(_0xae5d12,_0x257faf)=>(_0x502f07,_0x34f8c9)=>_0x257faf(_0x502f07,_0x34f8c9,_0xae5d12);_0x44b1a7[_0x5de549(0x315)]=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x491a08,_0x290500,_0x16efd3,_0x5705e6,_0x487e3f){const _0x152e86=_0x5de549;super(),this[_0x152e86(0x321)]=_0x491a08,this[_0x152e86(0x43a)]=_0x290500,this[_0x152e86(0x33e)]=_0x16efd3,this[_0x152e86(0x31c)]=_0x5705e6,_0x487e3f?_0x487e3f==null||_0x487e3f[_0x152e86(0x383)]()[_0x152e86(0x2f8)](()=>this[_0x152e86(0x48f)]()):(this['_logService'][_0x152e86(0x45b)]('[CollaborationDataLoaderController]',_0x152e86(0x24b)),this[_0x152e86(0x48f)]());}async['_init'](){const _0x3029a7=_0x5de549,_0x35fadc=this[_0x3029a7(0x321)]['getParam']('unit'),_0xf4bb82=this[_0x3029a7(0x321)]['getParam']('type'),_0x3cf74d=this[_0x3029a7(0x321)]['getParam']('subunit');if(!_0x35fadc||!_0xf4bb82){this[_0x3029a7(0x43a)]['debug'](_0x3029a7(0x1a6),'No\x20unitID\x20or\x20type\x20in\x20URL.\x20Will\x20not\x20load\x20files\x20from\x20remote\x20address.');return;}const _0x4b3782=await this[_0x3029a7(0x31c)]['loadUnit'](_0x35fadc,Number(_0xf4bb82),_0x3cf74d);_0x4b3782&&_0x4b3782 instanceof _0x39304f[_0x3029a7(0x2b6)]&&this[_0x3029a7(0x3df)](_0x4b3782);}async[_0x5de549(0x3df)](_0x4133d9){const _0x54b59d=_0x5de549;await this[_0x54b59d(0x456)](_0x4133d9),_0x4133d9[_0x54b59d(0x31a)][_0x54b59d(0x498)](_0x404575[_0x54b59d(0x387)](this[_0x54b59d(0x241)]))[_0x54b59d(0x38e)](_0x28e88e=>{const _0x4efb4c=_0x54b59d;_0x28e88e&&this[_0x4efb4c(0x1a5)](_0x28e88e);}),this[_0x54b59d(0x321)]['urlChange$']['pipe'](_0x404575[_0x54b59d(0x387)](this['dispose$']))['subscribe'](()=>this['_updateSubUnitFromURLParams'](_0x4133d9));}['_updateURLWithCurrentState'](_0x2bdbf7,_0x15645a=!0x1){const _0x314741=_0x5de549,_0x210265=this[_0x314741(0x321)][_0x314741(0x350)](_0x314741(0x28a));_0x2bdbf7[_0x314741(0x308)]()!==_0x210265&&this[_0x314741(0x321)][_0x314741(0x374)]('subunit',_0x2bdbf7['getSheetId'](),_0x15645a);}async[_0x5de549(0x456)](_0x20347b){const _0x37baf1=_0x5de549;var _0x581549;const _0x77f874=this[_0x37baf1(0x321)]['getParam'](_0x37baf1(0x28a));if(!_0x77f874||!_0x20347b[_0x37baf1(0x296)](_0x77f874)){const _0xb2cc7c=_0x20347b[_0x37baf1(0x239)]()[0x0],_0xe42655=_0x20347b[_0x37baf1(0x296)](_0xb2cc7c);if(!_0xe42655)return;this[_0x37baf1(0x1a5)](_0xe42655,!0x0),await this[_0x37baf1(0x33e)][_0x37baf1(0x275)](_0x3203ce[_0x37baf1(0x264)]['id'],{'unitId':_0x20347b[_0x37baf1(0x41e)](),'subUnitId':_0xb2cc7c});return;}((_0x581549=_0x20347b[_0x37baf1(0x2e1)]())==null?void 0x0:_0x581549[_0x37baf1(0x308)]())!==_0x77f874&&await this[_0x37baf1(0x33e)][_0x37baf1(0x275)](_0x3203ce['SetWorksheetActivateCommand']['id'],{'unitId':_0x20347b[_0x37baf1(0x41e)](),'subUnitId':_0x77f874});}},_0x44b1a7[_0x5de549(0x315)]=_0x2c13d4([_0x7cdaa(0x0,_0x4d8922),_0x7cdaa(0x1,_0x39304f['ILogService']),_0x7cdaa(0x2,_0x39304f[_0x5de549(0x3bf)]),_0x7cdaa(0x3,_0x39304f['Inject'](_0x3fe1f0[_0x5de549(0x207)])),_0x7cdaa(0x4,_0x39304f[_0x5de549(0x24c)](_0x256d9b[_0x5de549(0x487)]))],_0x44b1a7[_0x5de549(0x315)]);var _0x3c4fad=Object['getOwnPropertyDescriptor'],_0x2b952c=(_0x648ea9,_0x557039,_0x274d8d,_0x18fb20)=>{const _0x241925=_0x5de549;for(var _0x3182db=_0x18fb20>0x1?void 0x0:_0x18fb20?_0x3c4fad(_0x557039,_0x274d8d):_0x557039,_0x1d0be2=_0x648ea9[_0x241925(0x3b7)]-0x1,_0x4f3e33;_0x1d0be2>=0x0;_0x1d0be2--)(_0x4f3e33=_0x648ea9[_0x1d0be2])&&(_0x3182db=_0x4f3e33(_0x3182db)||_0x3182db);return _0x3182db;},_0x3c0f37=(_0x5a1f75,_0x3916ee)=>(_0x506672,_0x370ffd)=>_0x3916ee(_0x506672,_0x370ffd,_0x5a1f75);let _0x171e0f=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x364fcf,_0x38b9d8){const _0x402ad5=_0x5de549;super(),this['_docClipboardService']=_0x364fcf,this[_0x402ad5(0x473)]=_0x38b9d8,this[_0x402ad5(0x48f)]();}[_0x5de549(0x48f)](){const _0x231316=_0x5de549,_0x1b0d45=this;this[_0x231316(0x24e)](this['_docClipboardService']['addClipboardHook']({'onBeforePasteImage':async _0x48031a=>{const _0x196072=_0x231316,_0x286f51=await _0x1b0d45[_0x196072(0x473)][_0x196072(0x3d8)](_0x48031a);return _0x286f51?{'source':_0x286f51[_0x196072(0x26f)],'imageSourceType':_0x286f51[_0x196072(0x304)]}:null;}}));}};_0x171e0f=_0x2b952c([_0x3c0f37(0x0,_0x2abae2[_0x5de549(0x396)]),_0x3c0f37(0x1,_0x389a81[_0x5de549(0x300)])],_0x171e0f);const _0x184156=[_0x5de549(0x23b),_0x5de549(0x480),'green.600','red.300',_0x5de549(0x420),_0x5de549(0x481)];class _0x34f587 extends _0x39304f[_0x5de549(0x1ba)]{constructor(){const _0x393454=_0x5de549;super(...arguments),_0x41fabe(this,_0x393454(0x3a8),new Map()),_0x41fabe(this,_0x393454(0x2c2),0x0);}[_0x5de549(0x21f)](_0x1f22d0){const _0xfed589=_0x5de549;if(this[_0xfed589(0x3a8)][_0xfed589(0x3f7)](_0x1f22d0))return this['_assignedColors'][_0xfed589(0x1c0)](_0x1f22d0);const _0x91c12b=_0x184156[this['_colorIndex']];return this[_0xfed589(0x2c2)]=(this[_0xfed589(0x2c2)]+0x1)%_0x184156['length'],this[_0xfed589(0x3a8)][_0xfed589(0x361)](_0x1f22d0,_0x91c12b),_0x91c12b;}}function _0x439a24(_0x259630){const _0x4da925=_0x5de549;let _0x3daa07='';for(const _0x436e67 of _0x259630){const {startOffset:_0x4652c5,endOffset:_0x2f99d4,isActive:_0x252a20,rangeType:_0x5c65c8,segmentId:_0x36eab7,segmentPage:_0x55d4e3}=_0x436e67;_0x3daa07[_0x4da925(0x3b7)]&&(_0x3daa07+=','),_0x3daa07+=_0x4652c5+':'+_0x2f99d4+':'+(_0x252a20?'1':'0')+':'+_0x5c65c8+':'+_0x36eab7+':'+_0x55d4e3;}return _0x3daa07;}function _0x170153(_0x1644a8){const _0x25a4cd=_0x5de549,_0x363718=_0x1644a8[_0x25a4cd(0x46f)](','),_0x19f8b6=[];for(const _0x327288 of _0x363718){const [_0x468207,_0x7a3396,_0x20faf0,_0x4c8c1c,_0x220a71,_0x4e214c]=_0x327288[_0x25a4cd(0x46f)](':');_0x19f8b6[_0x25a4cd(0x44d)]({'startOffset':Number(_0x468207),'endOffset':Number(_0x7a3396),'collapsed':_0x468207===_0x7a3396,'isActive':_0x20faf0==='1','rangeType':_0x4c8c1c===_0x39304f[_0x25a4cd(0x431)][_0x25a4cd(0x49a)]?_0x39304f[_0x25a4cd(0x431)][_0x25a4cd(0x49a)]:_0x39304f[_0x25a4cd(0x431)][_0x25a4cd(0x1b1)],'segmentId':typeof _0x220a71==_0x25a4cd(0x1cd)?String(_0x220a71):'','segmentPage':Number(_0x4e214c!=null?_0x4e214c:-0x1)});}return _0x19f8b6[_0x25a4cd(0x34f)](_0x36fd55=>_0x36fd55[_0x25a4cd(0x453)])||(_0x19f8b6[0x0][_0x25a4cd(0x453)]=!0x0),_0x19f8b6;}class _0x4c3a54 extends _0x39304f[_0x5de549(0x423)]{constructor(){const _0x818271=_0x5de549;super(...arguments),_0x41fabe(this,_0x818271(0x486),new _0x404575['BehaviorSubject'](null)),_0x41fabe(this,_0x818271(0x2c1),this[_0x818271(0x486)][_0x818271(0x2a6)]());}[_0x5de549(0x3e0)](_0x4487cb){const _0x20cda3=_0x5de549,{unitID:_0x1776b4,memberID:_0x419375,textRanges:_0x2c24ce}=_0x4487cb,_0x4c0a75=_0x439a24(_0x2c24ce);if(_0x4c0a75==='')return;const _0x2851ab={'unitID':_0x1776b4,'memberID':_0x419375,'selection':_0x4c0a75};this['_collabCursorState$'][_0x20cda3(0x345)](_0x2851ab);}}var _0x4b039e=Object[_0x5de549(0x49f)],_0x2b4f16=(_0x1ee426,_0x343cde,_0x51c387,_0x4a3382)=>{for(var _0x2f4148=_0x4a3382>0x1?void 0x0:_0x4a3382?_0x4b039e(_0x343cde,_0x51c387):_0x343cde,_0x2057a0=_0x1ee426['length']-0x1,_0x5ab883;_0x2057a0>=0x0;_0x2057a0--)(_0x5ab883=_0x1ee426[_0x2057a0])&&(_0x2f4148=_0x5ab883(_0x2f4148)||_0x2f4148);return _0x2f4148;},_0x25a220=(_0x4229ee,_0x3dd898)=>(_0x4a4d69,_0x18e7e8)=>_0x3dd898(_0x4a4d69,_0x18e7e8,_0x4229ee);const _0x50d76f=0x12c,_0x579577=0x64;let _0x427717=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x5cc96f,_0x511f38,_0x3c7219,_0x4ebb82,_0x2ed724,_0x5a3b98,_0x4f25d1,_0x257482,_0x2c5807){const _0x5dc9b2=_0x5de549;super(),_0x41fabe(this,_0x5dc9b2(0x1b7),!0x1),_0x41fabe(this,'_init',!0x1),_0x41fabe(this,_0x5dc9b2(0x35f),new _0x404575['BehaviorSubject'](new Map())),_0x41fabe(this,_0x5dc9b2(0x2af),this[_0x5dc9b2(0x35f)]['asObservable']()),_0x41fabe(this,'_roomMembers$',new _0x404575['BehaviorSubject']([])),_0x41fabe(this,_0x5dc9b2(0x35e),this[_0x5dc9b2(0x376)][_0x5dc9b2(0x498)](_0x404575['debounceTime'](_0x50d76f))),_0x41fabe(this,_0x5dc9b2(0x1dc),_0x39304f[_0x5dc9b2(0x484)](_0x9b4cd6=>{const _0xdb5b0e=_0x5dc9b2,_0x123dd5={'eventID':_0x560361[_0xdb5b0e(0x1da)]['UPDATE_CURSOR'],'data':{'unitID':this['unitID'],'memberID':this['_session'][_0xdb5b0e(0x1af)](),'selection':_0x439a24(_0x9b4cd6)}};this['_session'][_0xdb5b0e(0x200)](_0x123dd5,this['unitID']);},_0x579577)),(this[_0x5dc9b2(0x42f)]=_0x5cc96f,this[_0x5dc9b2(0x422)]=_0x511f38,this[_0x5dc9b2(0x31d)]=_0x3c7219,this[_0x5dc9b2(0x1c7)]=_0x4ebb82,this[_0x5dc9b2(0x413)]=_0x2ed724,this[_0x5dc9b2(0x45a)]=_0x5a3b98,this[_0x5dc9b2(0x403)]=_0x4f25d1,this['_univerInstanceService']=_0x257482,this[_0x5dc9b2(0x33e)]=_0x2c5807);}get[_0x5de549(0x3d7)](){const _0x6b97ed=_0x5de549;return this['_cursorInfo$'][_0x6b97ed(0x3fc)]();}get[_0x5de549(0x2a8)](){const _0x228bd5=_0x5de549;return this[_0x228bd5(0x376)]['getValue']();}['dispose'](){const _0x358f2f=_0x5de549;super[_0x358f2f(0x2c3)](),this[_0x358f2f(0x35f)][_0x358f2f(0x345)](new Map()),this['_cursorInfo$']['complete'](),this[_0x358f2f(0x376)]['next']([]),this[_0x358f2f(0x376)][_0x358f2f(0x2d4)]();}[_0x5de549(0x482)](){const _0x5f2253=_0x5de549;this[_0x5f2253(0x48f)]||(this[_0x5f2253(0x48f)]=!0x0,this['_session'][_0x5f2253(0x34c)]['pipe'](_0x404575[_0x5f2253(0x387)](this['dispose$']))[_0x5f2253(0x38e)](_0x10ba68=>{const _0xdd6168=_0x5f2253;_0x10ba68===_0x3fe1f0[_0xdd6168(0x434)]['ONLINE']?this[_0xdd6168(0x34e)]():this['_toggleOffline']();}),this[_0x5f2253(0x422)]['event$']['pipe'](_0x404575[_0x5f2253(0x387)](this[_0x5f2253(0x241)]))[_0x5f2253(0x38e)](_0x354de2=>{const _0x4fc56c=_0x5f2253,_0xdfa53=_0x354de2[_0x4fc56c(0x3f2)];_0xdfa53===_0x560361[_0x4fc56c(0x1da)][_0x4fc56c(0x2db)]&&this['_onCursorUpdate'](_0x354de2),_0xdfa53===_0x560361[_0x4fc56c(0x1da)][_0x4fc56c(0x4a5)]&&this[_0x4fc56c(0x346)](_0x354de2);}),this['disposeWithMe'](this[_0x5f2253(0x33e)]['onCommandExecuted'](_0x293813=>{const _0x2b5a7f=_0x5f2253,_0x4fc6b1=_0x293813[_0x2b5a7f(0x448)];_0x4fc6b1!=null&&this[_0x2b5a7f(0x1b7)]&&_0x293813['id']===_0x59af06[_0x2b5a7f(0x488)]['id']&&_0x4fc6b1[_0x2b5a7f(0x2fb)]===this[_0x2b5a7f(0x42f)]&&_0x4fc6b1[_0x2b5a7f(0x2f1)]===!0x1&&_0x4fc6b1[_0x2b5a7f(0x3a0)][_0x2b5a7f(0x3b7)]>0x0&&this[_0x2b5a7f(0x1dc)](_0x4fc6b1['ranges']);})),this[_0x5f2253(0x45a)][_0x5f2253(0x2c1)][_0x5f2253(0x498)](_0x404575[_0x5f2253(0x387)](this['dispose$']))['subscribe'](_0x10bf48=>{const _0x4fad2e=_0x5f2253;if((_0x10bf48==null?void 0x0:_0x10bf48[_0x4fad2e(0x42f)])!==this[_0x4fad2e(0x42f)])return;const _0x1599b2={'eventID':_0x560361[_0x4fad2e(0x1da)][_0x4fad2e(0x2db)],'data':_0x10bf48};this[_0x4fad2e(0x44b)](_0x1599b2);}),this['disposeWithMe'](this[_0x5f2253(0x33e)][_0x5f2253(0x2fd)](_0x52ddde=>{const _0x4ed14b=_0x5f2253;if(_0x52ddde[_0x4ed14b(0x448)]==null)return;const _0x1cd317=_0x52ddde[_0x4ed14b(0x448)];if(_0x52ddde['id']!==_0x59af06[_0x4ed14b(0x2f4)]['id']||_0x1cd317[_0x4ed14b(0x2fb)]!==this['unitID'])return;const _0x52a4a0={'id':'doc.mutation.rich-text-editing','params':_0x1cd317},_0x305405=this[_0x4ed14b(0x3d7)];for(const [_0x141407,_0x4d98b9]of _0x305405){const _0x2a9b3e={'id':'doc.mutation.rich-text-editing','params':{'unitId':this[_0x4ed14b(0x42f)],'actions':null,'textRanges':_0x4d98b9[_0x4ed14b(0x3a0)]}},_0x8bc51a=this[_0x4ed14b(0x403)]['transformMutation'](_0x52a4a0,_0x2a9b3e,!0x1);if(_0x560361['isTransformMutationFailure'](_0x8bc51a))throw _0x8bc51a[_0x4ed14b(0x2ee)];_0x305405['set'](_0x141407,{..._0x4d98b9,'ranges':_0x8bc51a[_0x4ed14b(0x1e0)][_0x4ed14b(0x448)]['textRanges']});}queueMicrotask(()=>{const _0x5ab3df=_0x4ed14b;this[_0x5ab3df(0x35f)]['next'](_0x305405);});})));}[_0x5de549(0x44b)](_0x13ee69){const _0x46ee3e=_0x5de549;var _0x33b71b,_0x1086ed;const {memberID:_0x518804,selection:_0x282b69}=_0x13ee69[_0x46ee3e(0x298)],_0x11c1d0=_0x170153(_0x282b69),_0x6bc7fd=(_0x1086ed=(_0x33b71b=this[_0x46ee3e(0x413)][_0x46ee3e(0x1de)](this[_0x46ee3e(0x42f)],_0x518804))==null?void 0x0:_0x33b71b[_0x46ee3e(0x231)])!=null?_0x1086ed:_0x46ee3e(0x490),_0x48f595={'color':this[_0x46ee3e(0x1c7)][_0x46ee3e(0x21f)](_0x518804),'name':_0x6bc7fd,'ranges':_0x11c1d0},_0x4ec7c4=this['cursorInfo'];_0x4ec7c4['set'](_0x518804,_0x48f595),this[_0x46ee3e(0x35f)][_0x46ee3e(0x345)](_0x4ec7c4);}[_0x5de549(0x346)](_0x57b3f9){const _0x2caa1e=_0x5de549,{memberID:_0x3d29e7}=_0x57b3f9[_0x2caa1e(0x298)],_0x2a72f6=this['cursorInfo'];_0x2a72f6[_0x2caa1e(0x421)](_0x3d29e7),this[_0x2caa1e(0x35f)][_0x2caa1e(0x345)](_0x2a72f6);}[_0x5de549(0x34e)](){const _0x23935e=_0x5de549;var _0x3c9e8b;if(this[_0x23935e(0x1b7)]=!0x0,((_0x3c9e8b=this[_0x23935e(0x26e)]['getFocusedUnit']())==null?void 0x0:_0x3c9e8b[_0x23935e(0x41e)]())!==this[_0x23935e(0x42f)])return;const _0x237f6a=this[_0x23935e(0x31d)][_0x23935e(0x1c0)](_0x59af06[_0x23935e(0x20c)])[_0x23935e(0x1e6)]();Array['isArray'](_0x237f6a)&&_0x237f6a[_0x23935e(0x3b7)]>0x0&&this['_updateLocalCursor'](_0x237f6a);}[_0x5de549(0x430)](){const _0x586f10=_0x5de549;this[_0x586f10(0x1b7)]=!0x1;}};_0x427717=_0x2b4f16([_0x25a220(0x2,_0x39304f[_0x5de549(0x356)](_0x39304f['Injector'])),_0x25a220(0x3,_0x39304f[_0x5de549(0x356)](_0x34f587)),_0x25a220(0x4,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x3f5)])),_0x25a220(0x5,_0x39304f[_0x5de549(0x356)](_0x4c3a54)),_0x25a220(0x6,_0x560361[_0x5de549(0x37e)]),_0x25a220(0x7,_0x39304f[_0x5de549(0x2cc)]),_0x25a220(0x8,_0x39304f['ICommandService'])],_0x427717);var _0x3c3f72=Object[_0x5de549(0x49f)],_0x3089b1=(_0x165894,_0x5cb4e1,_0x550b38,_0x440fb6)=>{const _0x20d186=_0x5de549;for(var _0x366366=_0x440fb6>0x1?void 0x0:_0x440fb6?_0x3c3f72(_0x5cb4e1,_0x550b38):_0x5cb4e1,_0x3530f7=_0x165894[_0x20d186(0x3b7)]-0x1,_0x4b461a;_0x3530f7>=0x0;_0x3530f7--)(_0x4b461a=_0x165894[_0x3530f7])&&(_0x366366=_0x4b461a(_0x366366)||_0x366366);return _0x366366;},_0x14e2e0=(_0xa840ba,_0x65aa15)=>(_0x1a3988,_0x30cbeb)=>_0x65aa15(_0x1a3988,_0x30cbeb,_0xa840ba);const _0x4cbb03=0x12c,_0x124466=0x64,_0x354494=()=>{let _0x22fd9e=[],_0x3c1eed=!0x1;return _0x27656e=>{const _0x5ccbec=_0x48a1;_0x22fd9e[_0x5ccbec(0x44d)](_0x27656e),_0x3c1eed||(_0x3c1eed=!0x0,setTimeout(()=>{_0x22fd9e['forEach'](_0x4915fe=>_0x4915fe()),_0x22fd9e=[],_0x3c1eed=!0x1;}));};};let _0x171417=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x3de082,_0x4bdd02,_0x2ae341,_0x1d6fbf,_0x3a24c3,_0x4add8c,_0x44f8df,_0x3fc5df){const _0x37772f=_0x5de549;super(),_0x41fabe(this,_0x37772f(0x1b7),!0x1),_0x41fabe(this,_0x37772f(0x48f),!0x1),_0x41fabe(this,_0x37772f(0x35f),new _0x404575['BehaviorSubject'](new Map())),_0x41fabe(this,_0x37772f(0x2af),this[_0x37772f(0x35f)][_0x37772f(0x2a6)]()),_0x41fabe(this,_0x37772f(0x376),new _0x404575[(_0x37772f(0x25b))]([])),_0x41fabe(this,_0x37772f(0x35e),this[_0x37772f(0x376)][_0x37772f(0x498)](_0x404575[_0x37772f(0x247)](_0x4cbb03))),_0x41fabe(this,_0x37772f(0x1dc),_0x39304f['debounce']((_0x48d9a3,_0x5c3fa9)=>{const _0x30aca0=_0x37772f,_0x15a49c={'eventID':_0x560361[_0x30aca0(0x1da)][_0x30aca0(0x2db)],'data':{'unitID':this['unitID'],'memberID':this[_0x30aca0(0x422)][_0x30aca0(0x1af)](),'selection':_0x284237['serializeRangeWithSheet'](_0x48d9a3,_0x5c3fa9[_0x30aca0(0x1f6)])}};this['_session']['send'](_0x15a49c,this[_0x30aca0(0x42f)]);},_0x124466)),(this[_0x37772f(0x42f)]=_0x3de082,this[_0x37772f(0x422)]=_0x4bdd02,this[_0x37772f(0x31d)]=_0x2ae341,this['_colorAssignService']=_0x1d6fbf,this[_0x37772f(0x413)]=_0x3a24c3,this[_0x37772f(0x26e)]=_0x4add8c,this['_commandService']=_0x44f8df,this['_refRangeService']=_0x3fc5df);}get['cursorInfo'](){return this['_cursorInfo$']['getValue']();}get[_0x5de549(0x2a8)](){const _0x45e3fb=_0x5de549;return this[_0x45e3fb(0x376)][_0x45e3fb(0x3fc)]();}['dispose'](){const _0x170e98=_0x5de549;super[_0x170e98(0x2c3)](),this['_cursorInfo$'][_0x170e98(0x345)](new Map()),this[_0x170e98(0x35f)][_0x170e98(0x2d4)](),this[_0x170e98(0x376)]['next']([]),this[_0x170e98(0x376)]['complete']();}[_0x5de549(0x482)](){const _0x790dae=_0x5de549;this[_0x790dae(0x48f)]||(this[_0x790dae(0x48f)]=!0x0,this['_session'][_0x790dae(0x34c)]['pipe'](_0x404575[_0x790dae(0x387)](this['dispose$']))[_0x790dae(0x38e)](_0x5e6b69=>{const _0x441bd0=_0x790dae;_0x5e6b69===_0x3fe1f0['SessionStatus'][_0x441bd0(0x43d)]?this[_0x441bd0(0x34e)]():this[_0x441bd0(0x430)]();}),this['_session'][_0x790dae(0x2dc)][_0x790dae(0x498)](_0x404575['takeUntil'](this[_0x790dae(0x241)]))['subscribe'](_0x52659c=>{const _0x39973e=_0x790dae,_0x113811=_0x52659c[_0x39973e(0x3f2)];_0x113811===_0x560361[_0x39973e(0x1da)][_0x39973e(0x2db)]&&this[_0x39973e(0x44b)](_0x52659c),_0x113811===_0x560361[_0x39973e(0x1da)][_0x39973e(0x4a5)]&&this[_0x39973e(0x346)](_0x52659c);}),this[_0x790dae(0x2be)](),this[_0x790dae(0x24e)](this[_0x790dae(0x33e)][_0x790dae(0x2fd)](_0x2eded9=>{const _0x4734c0=_0x790dae;if(this[_0x4734c0(0x1b7)]&&_0x2eded9['id']===_0x3203ce[_0x4734c0(0x33b)]['id']&&_0x2eded9['params'][_0x4734c0(0x2fb)]===this['unitID']){const _0x50941a=_0x2eded9[_0x4734c0(0x448)];this[_0x4734c0(0x1dc)](_0x50941a[_0x4734c0(0x330)],_0x50941a[_0x4734c0(0x380)][0x0]);}})));}[_0x5de549(0x44b)](_0x4858de){const _0x55d2aa=_0x5de549;var _0x19c5f8,_0x27c86f;const {memberID:_0x3b3776,selection:_0x592f19}=_0x4858de['data'],{sheetName:_0x5a0a11,range:_0x5eedff}=_0x284237['deserializeRangeWithSheet'](_0x592f19),_0x5ce1a6={'name':(_0x27c86f=(_0x19c5f8=this[_0x55d2aa(0x413)][_0x55d2aa(0x1de)](this[_0x55d2aa(0x42f)],_0x3b3776))==null?void 0x0:_0x19c5f8[_0x55d2aa(0x231)])!=null?_0x27c86f:_0x55d2aa(0x490),'range':this[_0x55d2aa(0x1e1)](_0x5a0a11,_0x5eedff),'sheetID':_0x5a0a11,'color':this[_0x55d2aa(0x1c7)]['assignAColorForMemberID'](_0x3b3776),'selection':_0x592f19},_0x34d223=this[_0x55d2aa(0x3d7)];_0x34d223[_0x55d2aa(0x361)](_0x3b3776,_0x5ce1a6),this[_0x55d2aa(0x35f)]['next'](_0x34d223);}[_0x5de549(0x346)](_0x22ae81){const _0x4cf9d2=_0x5de549,{memberID:_0x595391}=_0x22ae81['data'],_0x42369a=this[_0x4cf9d2(0x3d7)];_0x42369a[_0x4cf9d2(0x421)](_0x595391),this[_0x4cf9d2(0x35f)][_0x4cf9d2(0x345)](_0x42369a);}[_0x5de549(0x1e1)](_0x2f9462,_0x2f0632){const _0xdb392a=_0x5de549;var _0x37c4e9,_0x4ecb91;const _0x4bf17c=(_0x4ecb91=(_0x37c4e9=this['_univerInstanceService'][_0xdb392a(0x2b9)](this['unitID']))==null?void 0x0:_0x37c4e9[_0xdb392a(0x296)](_0x2f9462))==null?void 0x0:_0x4ecb91[_0xdb392a(0x3ba)]();return(_0x4bf17c==null?void 0x0:_0x4bf17c['find'](_0x25a92e=>_0x39304f['Rectangle'][_0xdb392a(0x44a)](_0x25a92e,_0x2f0632)))||_0x2f0632;}[_0x5de549(0x2be)](){const _0x4df4a1=_0x5de549,_0x4f9aae=new _0x39304f[(_0x4df4a1(0x325))](),_0x46bf14=_0x354494(),_0x5b52bf=()=>{const _0x3d0ae0=_0x4df4a1;_0x4f9aae[_0x3d0ae0(0x2c3)]();const _0x39e3c8=(_0x6650e8,_0x32690d,_0x445c19,_0xe3c6ef)=>{const _0x235348=_0x3d0ae0;let _0x599a7b=[];switch(_0x6650e8['id']){case _0x3203ce[_0x235348(0x2f7)]['DeleteRangeMoveLeftCommandId']:{_0x599a7b=_0x3203ce[_0x235348(0x20a)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x1ad)]:{_0x599a7b=_0x3203ce[_0x235348(0x3ee)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x419)]:{_0x599a7b=_0x3203ce[_0x235348(0x27d)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x255)]:{_0x599a7b=_0x3203ce['handleInsertRangeMoveDown'](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x37a)]:{_0x599a7b=_0x3203ce[_0x235348(0x291)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce['EffectRefRangId']['InsertRowCommandId']:{_0x599a7b=_0x3203ce[_0x235348(0x1cb)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x40e)]:{_0x599a7b=_0x3203ce[_0x235348(0x1c9)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x29b)]:{_0x599a7b=_0x3203ce[_0x235348(0x2b3)](_0x6650e8,_0xe3c6ef);break;}case _0x3203ce[_0x235348(0x2f7)][_0x235348(0x251)]:{_0x599a7b=_0x3203ce[_0x235348(0x3d5)](_0x6650e8,_0xe3c6ef);break;}}const _0x589d86=_0x3203ce['runRefRangeMutations'](_0x599a7b,_0xe3c6ef),_0x4ec50e=this['cursorInfo']['get'](_0x32690d);if(_0x4ec50e&&_0x589d86){const _0x49182b={..._0x4ec50e,'range':_0x589d86};this[_0x235348(0x3d7)]['set'](_0x32690d,_0x49182b),_0x46bf14(()=>{const _0x17d8d1=_0x235348,_0x232a68=this[_0x17d8d1(0x432)][_0x17d8d1(0x219)](_0x589d86,_0x482d1d=>(_0x232a68[_0x17d8d1(0x2c3)](),_0x39e3c8(_0x482d1d,_0x32690d,_0x445c19,_0x589d86)));_0x4f9aae[_0x17d8d1(0x26c)](_0x232a68);});}return{'redos':[],'undos':[]};};this[_0x3d0ae0(0x3d7)][_0x3d0ae0(0x22a)]((_0x35e273,_0x3172bd)=>{const _0x10e45c=_0x3d0ae0,{range:_0x2ddd06,sheetID:_0x1fe7fb}=_0x35e273,_0x33136=this['_refRangeService'][_0x10e45c(0x219)](_0x2ddd06,_0x39bfb2=>(_0x33136['dispose'](),_0x39e3c8(_0x39bfb2,_0x3172bd,_0x1fe7fb,_0x2ddd06)));_0x4f9aae[_0x10e45c(0x26c)](_0x33136);});};this[_0x4df4a1(0x24e)](_0x39304f['toDisposable'](this['_cursorInfo$'][_0x4df4a1(0x38e)](()=>{_0x5b52bf();})));}[_0x5de549(0x34e)](){const _0x1e1ef5=_0x5de549;var _0x4c4330,_0x594a62;if(this[_0x1e1ef5(0x1b7)]=!0x0,((_0x4c4330=this[_0x1e1ef5(0x26e)][_0x1e1ef5(0x3ae)]())==null?void 0x0:_0x4c4330['getUnitId']())!==this[_0x1e1ef5(0x42f)])return;const _0x5920b4=(_0x594a62=this[_0x1e1ef5(0x31d)][_0x1e1ef5(0x1c0)](_0x3203ce[_0x1e1ef5(0x204)])[_0x1e1ef5(0x2f9)]())==null?void 0x0:_0x594a62[0x0],_0x31d54c=this['_univerInstanceService']['getCurrentUnitForType'](_0x39304f[_0x1e1ef5(0x1cf)][_0x1e1ef5(0x211)])['getActiveSheet']();_0x5920b4&&_0x31d54c&&this[_0x1e1ef5(0x1dc)](_0x31d54c[_0x1e1ef5(0x308)](),_0x5920b4);}['_toggleOffline'](){this['_online']=!0x1;}};_0x171417=_0x3089b1([_0x14e2e0(0x2,_0x39304f['Inject'](_0x39304f[_0x5de549(0x2bd)])),_0x14e2e0(0x3,_0x39304f[_0x5de549(0x356)](_0x34f587)),_0x14e2e0(0x4,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x3f5)])),_0x14e2e0(0x5,_0x39304f[_0x5de549(0x2cc)]),_0x14e2e0(0x6,_0x39304f['ICommandService']),_0x14e2e0(0x7,_0x39304f[_0x5de549(0x356)](_0x3203ce[_0x5de549(0x228)]))],_0x171417);var _0x36f971=Object[_0x5de549(0x49f)],_0x4edad9=(_0x459c25,_0x57f159,_0x2faa0f,_0x28faa4)=>{const _0x558189=_0x5de549;for(var _0x579b87=_0x28faa4>0x1?void 0x0:_0x28faa4?_0x36f971(_0x57f159,_0x2faa0f):_0x57f159,_0x3a244a=_0x459c25[_0x558189(0x3b7)]-0x1,_0x2910cc;_0x3a244a>=0x0;_0x3a244a--)(_0x2910cc=_0x459c25[_0x3a244a])&&(_0x579b87=_0x2910cc(_0x579b87)||_0x579b87);return _0x579b87;},_0xc50099=(_0x51fe5a,_0x276257)=>(_0x245ce3,_0x474b71)=>_0x276257(_0x245ce3,_0x474b71,_0x51fe5a);let _0x1af4cc=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x156319,_0x33db77,_0x5a5d4f){const _0x23dff5=_0x5de549;super(),_0x41fabe(this,_0x23dff5(0x360),new Map()),_0x41fabe(this,_0x23dff5(0x3e7),new _0x404575['Subject']()),(this[_0x23dff5(0x26e)]=_0x156319,this['_injector']=_0x33db77,this[_0x23dff5(0x24f)]=_0x5a5d4f,this[_0x23dff5(0x48f)]());}['dispose'](){const _0x323840=_0x5de549;super[_0x323840(0x2c3)](),this['_entityInit$'][_0x323840(0x2d4)](),this[_0x323840(0x360)][_0x323840(0x22a)](_0x33a849=>_0x33a849['dispose']());}[_0x5de549(0x3eb)](_0x2370e8){const _0x43b04a=_0x5de549;return this[_0x43b04a(0x360)][_0x43b04a(0x3f7)](_0x2370e8)?this[_0x43b04a(0x360)][_0x43b04a(0x1c0)](_0x2370e8)[_0x43b04a(0x2af)]:this[_0x43b04a(0x3e7)]['pipe'](_0x404575[_0x43b04a(0x1c6)](_0x2204cf=>_0x2204cf['unitID']===_0x2370e8),_0x404575[_0x43b04a(0x287)](_0x2ae6b2=>_0x2ae6b2[_0x43b04a(0x2af)]));}[_0x5de549(0x48f)](){const _0xb3cfb=_0x5de549;this['_univerInstanceService'][_0xb3cfb(0x364)](_0x39304f['UniverInstanceType'][_0xb3cfb(0x211)])[_0xb3cfb(0x498)](_0x404575['takeUntil'](this['dispose$']))['subscribe'](async _0x41e332=>{const _0x5f2055=_0xb3cfb,_0x525769=_0x41e332['getUnitId'](),_0x5b1c2c=await this[_0x5f2055(0x472)](_0x525769);this[_0x5f2055(0x3e7)]['next'](_0x5b1c2c),this[_0x5f2055(0x360)][_0x5f2055(0x361)](_0x525769,_0x5b1c2c);}),this[_0xb3cfb(0x26e)][_0xb3cfb(0x364)](_0x39304f['UniverInstanceType'][_0xb3cfb(0x418)])[_0xb3cfb(0x498)](_0x404575[_0xb3cfb(0x387)](this[_0xb3cfb(0x241)]))[_0xb3cfb(0x498)](_0x404575[_0xb3cfb(0x1c6)](_0x12324f=>!_0x12324f['getUnitId']()[_0xb3cfb(0x3b2)]('__')))[_0xb3cfb(0x38e)](async _0x1bbb4d=>{const _0x54f3df=_0xb3cfb,_0x5779ad=_0x1bbb4d[_0x54f3df(0x41e)](),_0x3d2b2e=await this[_0x54f3df(0x354)](_0x5779ad);this['_entityInit$'][_0x54f3df(0x345)](_0x3d2b2e),this['_entities']['set'](_0x5779ad,_0x3d2b2e);}),_0x404575[_0xb3cfb(0x394)](this[_0xb3cfb(0x26e)][_0xb3cfb(0x414)](_0x39304f[_0xb3cfb(0x1cf)]['UNIVER_DOC']),this['_univerInstanceService'][_0xb3cfb(0x414)](_0x39304f[_0xb3cfb(0x1cf)]['UNIVER_SHEET']))[_0xb3cfb(0x498)](_0x404575[_0xb3cfb(0x387)](this[_0xb3cfb(0x241)]))[_0xb3cfb(0x38e)](_0x55ad45=>{const _0x5bdbf3=_0xb3cfb,_0x2fd4e6=_0x55ad45[_0x5bdbf3(0x41e)](),_0x1b7f12=this[_0x5bdbf3(0x360)]['get'](_0x2fd4e6);_0x1b7f12&&(_0x1b7f12[_0x5bdbf3(0x2c3)](),this[_0x5bdbf3(0x360)][_0x5bdbf3(0x421)](_0x2fd4e6));});}async[_0x5de549(0x472)](_0xec4fb0){const _0x43da82=_0x5de549,_0x285d01=await this[_0x43da82(0x24f)][_0x43da82(0x2d5)](_0xec4fb0),_0x20b519=this[_0x43da82(0x31d)]['createInstance'](_0x171417,_0xec4fb0,_0x285d01);return _0x20b519['init'](),_0x20b519;}async[_0x5de549(0x354)](_0x3c7e1e){const _0x25a314=_0x5de549,_0x2b49c3=await this[_0x25a314(0x24f)][_0x25a314(0x2d5)](_0x3c7e1e),_0x1e1351=this[_0x25a314(0x31d)]['createInstance'](_0x427717,_0x3c7e1e,_0x2b49c3);return _0x1e1351[_0x25a314(0x482)](),_0x1e1351;}};_0x1af4cc=_0x4edad9([_0xc50099(0x0,_0x39304f[_0x5de549(0x2cc)]),_0xc50099(0x1,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0xc50099(0x2,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x22f)]))],_0x1af4cc);const _0xcfdad9=0x14,_0x6bd10f=0xc8,_0x2fc9bb=0x4,_0x57bc63=0x5;function _0x3d96e9(_0xcb2a3d,_0x183d67){const _0x1904d0=_0x5de549;let {radius:_0x97250a,width:_0x479a33,height:_0x5b0c2a}=_0x183d67;_0x97250a=_0x97250a!=null?_0x97250a:0x0,_0x479a33=_0x479a33!=null?_0x479a33:0x1e,_0x5b0c2a=_0x5b0c2a!=null?_0x5b0c2a:0x1e;let _0x306330=0x0,_0x2d57a3=0x0,_0x24cd86=0x0;_0x306330=_0x2d57a3=_0x24cd86=Math[_0x1904d0(0x316)](_0x97250a,_0x479a33/0x2,_0x5b0c2a/0x2),_0xcb2a3d[_0x1904d0(0x252)](),_0xcb2a3d[_0x1904d0(0x23f)](_0x306330,0x0),_0xcb2a3d[_0x1904d0(0x470)](_0x479a33-_0x2d57a3,0x0),_0xcb2a3d[_0x1904d0(0x45f)](_0x479a33-_0x2d57a3,_0x2d57a3,_0x2d57a3,Math['PI']*0x3/0x2,0x0,!0x1),_0xcb2a3d[_0x1904d0(0x470)](_0x479a33,_0x5b0c2a-_0x24cd86),_0xcb2a3d[_0x1904d0(0x45f)](_0x479a33-_0x24cd86,_0x5b0c2a-_0x24cd86,_0x24cd86,0x0,Math['PI']/0x2,!0x1),_0xcb2a3d['lineTo'](0x0,_0x5b0c2a),_0xcb2a3d[_0x1904d0(0x470)](0x0,_0x306330),_0xcb2a3d[_0x1904d0(0x45f)](_0x306330,_0x306330,_0x306330,Math['PI'],Math['PI']*0x3/0x2,!0x1),_0xcb2a3d[_0x1904d0(0x4a2)](),_0x183d67[_0x1904d0(0x402)]&&(_0xcb2a3d[_0x1904d0(0x1d8)](),_0xcb2a3d['fillStyle']=_0x183d67[_0x1904d0(0x402)],_0x183d67[_0x1904d0(0x1fb)]===_0x1904d0(0x3fe)?_0xcb2a3d[_0x1904d0(0x402)]('evenodd'):_0xcb2a3d[_0x1904d0(0x402)](),_0xcb2a3d[_0x1904d0(0x320)]());}class _0x92597c extends _0x46a3bd[_0x5de549(0x451)]{constructor(_0x5356dc,_0xa10320){const _0x1038ac=_0x5de549;super(_0x5356dc,_0xa10320),_0x41fabe(this,_0x1038ac(0x477)),_0x41fabe(this,_0x1038ac(0x28f)),(this[_0x1038ac(0x477)]=_0xa10320==null?void 0x0:_0xa10320[_0x1038ac(0x477)],this[_0x1038ac(0x28f)]=_0xa10320==null?void 0x0:_0xa10320[_0x1038ac(0x28f)]);}static[_0x5de549(0x3c3)](_0x3b0a94,_0x2cfe44){const _0x3fda34=_0x5de549,{text:_0x18fa42,color:_0x13dda0}=_0x2cfe44;_0x3b0a94['save'](),_0x3b0a94['font']='bold\x2013px\x20Source\x20Han\x20Sans\x20CN';const _0x5cbd12=_0x3b0a94[_0x3fda34(0x388)](_0x18fa42)[_0x3fda34(0x3d6)],_0x116a13=Math[_0x3fda34(0x316)](_0x5cbd12+0x2*_0x2fc9bb,_0x6bd10f);_0x3d96e9(_0x3b0a94,{'height':_0xcfdad9,'radius':0x4,'width':_0x116a13,'fill':_0x13dda0}),_0x3b0a94[_0x3fda34(0x31b)]=_0x3fda34(0x4a7);const _0x24f1a4=_0x2fc9bb,_0x3a024a=_0xcfdad9-_0x57bc63,_0x5480b5=_0x6bd10f-0x2*_0x2fc9bb;if(_0x5cbd12>_0x5480b5){let _0x3298a5='',_0x93164e=0x0;for(const _0xf25e93 of _0x18fa42){const _0x124fb6=_0x3b0a94[_0x3fda34(0x388)](_0xf25e93)[_0x3fda34(0x3d6)];if(_0x93164e+_0x124fb6<=_0x5480b5-_0x3b0a94['measureText'](_0x3fda34(0x36f))[_0x3fda34(0x3d6)])_0x3298a5+=_0xf25e93,_0x93164e+=_0x124fb6;else{_0x3298a5+=_0x3fda34(0x36f);break;}}_0x3b0a94[_0x3fda34(0x35b)](_0x3298a5,_0x24f1a4,_0x3a024a);}else _0x3b0a94[_0x3fda34(0x35b)](_0x18fa42,_0x24f1a4,_0x3a024a);_0x3b0a94[_0x3fda34(0x320)]();}[_0x5de549(0x3e6)](_0x3f6b23){const _0x446f3c=_0x5de549;_0x92597c[_0x446f3c(0x3c3)](_0x3f6b23,this);}}const _0x4a99ec=_0x5de549(0x1b6),_0x100123=_0x5de549(0x1bd),_0x1c8aab=_0x5de549(0x3ac),_0xd9bc96=0x6,_0x1a5323=1.5,_0x2a36ad=0x4,_0x3b9359=1.5,_0x2ad9df=_0x5de549(0x2b7);class _0x5b7907{constructor(_0x2d2ced,_0x3e7ed1,_0x3be581,_0x1ae4fe){const _0x508250=_0x5de549;_0x41fabe(this,_0x508250(0x290),[]),_0x41fabe(this,_0x508250(0x25c),null),_0x41fabe(this,_0x508250(0x22c),null),_0x41fabe(this,'_anchorDot',null),_0x41fabe(this,_0x508250(0x465),null),_0x41fabe(this,_0x508250(0x47d),null),(this[_0x508250(0x40a)]=_0x2d2ced,this[_0x508250(0x2c9)]=_0x3e7ed1,this[_0x508250(0x344)]=_0x3be581,this['_document']=_0x1ae4fe,this[_0x508250(0x348)]());}set[_0x5de549(0x1ca)](_0x3961dd){const _0x3e507e=_0x5de549;_0x3961dd?(this[_0x3e507e(0x3c8)]&&this[_0x3e507e(0x3c8)]['hide'](),this[_0x3e507e(0x22c)]&&this[_0x3e507e(0x22c)]['show']()):(this[_0x3e507e(0x3c8)]&&this['_anchorDot'][_0x3e507e(0x38d)](),this[_0x3e507e(0x22c)]&&this[_0x3e507e(0x22c)][_0x3e507e(0x212)]());}[_0x5de549(0x2c3)](){const _0x36db7f=_0x5de549;for(const _0x46573 of this['_shapes'])_0x46573['dispose']();this['_textBubble']&&this[_0x36db7f(0x22c)]['dispose'](),this[_0x36db7f(0x3c8)]&&this[_0x36db7f(0x3c8)]['dispose'](),this[_0x36db7f(0x25c)]&&this[_0x36db7f(0x25c)][_0x36db7f(0x2c3)](),this[_0x36db7f(0x47d)]&&this[_0x36db7f(0x47d)]();}[_0x5de549(0x348)](){const _0x4a2af5=_0x5de549;var _0xa1f67;const {_docSkeleton:_0x17bd03,_document:_0x3be0a9}=this,{color:_0x58f61f,name:_0x4f73fb,ranges:_0x260f31}=this[_0x4a2af5(0x40a)],_0x5a2d9f=_0x3be0a9[_0x4a2af5(0x3a1)](),{docsLeft:_0x300f99,docsTop:_0x372a1c}=_0x5a2d9f,_0x47664c=new _0x2abae2[(_0x4a2af5(0x38a))](_0x5a2d9f,_0x17bd03);for(const {startOffset:_0x1478ca,endOffset:_0x3c9071,rangeType:_0x39d987,segmentId:_0x3edc49,segmentPage:_0x4e8a38,collapsed:_0x396ae8,isActive:_0x3c1dce}of _0x260f31){const _0x52e774=_0x17bd03[_0x4a2af5(0x479)](_0x1478ca,!0x0,_0x3edc49,_0x4e8a38);let _0x4bd408=_0x17bd03['findNodePositionByCharIndex'](_0x3c9071,!0x0,_0x3edc49,_0x4e8a38);if(_0x4bd408==null&&(_0x4bd408=_0x17bd03[_0x4a2af5(0x479)](_0x3c9071-0x1,!0x1,_0x3edc49,_0x4e8a38)),_0x3c1dce){const {contentBoxPointGroup:_0x261525}=_0x47664c['getRangePointData'](_0x4bd408,_0x4bd408);if(_0x261525['length']===0x0)continue;this[_0x4a2af5(0x2ec)](_0x58f61f,_0x261525,_0x300f99,_0x372a1c,_0x4f73fb),this[_0x4a2af5(0x47d)]=this[_0x4a2af5(0x339)]();}if(_0x52e774&&_0x4bd408){if(_0x39d987===_0x39304f[_0x4a2af5(0x431)][_0x4a2af5(0x1b1)]){const _0x3ae3dd=new _0x2abae2[(_0x4a2af5(0x1cc))](_0x5a2d9f,_0x17bd03),{pointGroup:_0x58ea40}=(_0xa1f67=_0x3ae3dd[_0x4a2af5(0x42d)](_0x52e774,_0x4bd408))!=null?_0xa1f67:{};if(_0x58ea40==null||_0x58ea40[_0x4a2af5(0x3b7)]===0x0)continue;this[_0x4a2af5(0x3b8)](_0x58f61f,_0x58ea40,_0x300f99,_0x372a1c);}else{if(!_0x396ae8){const {borderBoxPointGroup:_0x5c37fe}=_0x47664c[_0x4a2af5(0x42d)](_0x52e774,_0x4bd408);if(_0x5c37fe[_0x4a2af5(0x3b7)]===0x0)continue;this[_0x4a2af5(0x442)](_0x58f61f,_0x5c37fe,_0x300f99,_0x372a1c);}}}}}[_0x5de549(0x2ec)](_0x14cff7,_0x1791e1,_0x20adee,_0x135caf,_0x59fe52){const _0x2a5d26=_0x5de549,_0x4f150b=this[_0x2a5d26(0x46b)](_0x1791e1),{left:_0x4bb375,top:_0x2fe17c,height:_0x223888}=_0x4f150b,_0x5b807a=this[_0x2a5d26(0x3fa)](),_0x4f1b91=_0x3b9359/_0x5b807a,_0x1c01e2=new _0x46a3bd[(_0x2a5d26(0x39c))](_0x4a99ec+_0x39304f[_0x2a5d26(0x26d)](_0xd9bc96),{'left':_0x4bb375+_0x20adee-_0x4f1b91,'top':_0x2fe17c+_0x135caf,'height':_0x223888,'width':_0x1a5323,'fill':_0x14cff7||_0x46a3bd[_0x2a5d26(0x2c6)](_0x39304f[_0x2a5d26(0x3de)][_0x2a5d26(0x260)],0x0),'strokeWidth':_0x4f1b91,'stroke':_0x2ad9df,'evented':!0x0});this['_anchor']=_0x1c01e2,this[_0x2a5d26(0x2c9)]['addObject'](_0x1c01e2,_0x2abae2[_0x2a5d26(0x2d3)]);const _0x567ce3=new _0x46a3bd[(_0x2a5d26(0x39c))](_0x4a99ec+_0x39304f[_0x2a5d26(0x26d)](_0xd9bc96),{'left':_0x4bb375+_0x20adee-_0x4f1b91,'top':_0x2fe17c+_0x135caf-_0x2a36ad/0x2,'height':_0x2a36ad,'width':_0x2a36ad,'fill':_0x14cff7||_0x46a3bd[_0x2a5d26(0x2c6)](_0x39304f[_0x2a5d26(0x3de)][_0x2a5d26(0x260)],0x0),'strokeWidth':0x0,'stroke':_0x14cff7||_0x46a3bd[_0x2a5d26(0x2c6)](_0x39304f[_0x2a5d26(0x3de)][_0x2a5d26(0x260)],0x0),'evented':!0x1});this[_0x2a5d26(0x3c8)]=_0x567ce3,this[_0x2a5d26(0x2c9)][_0x2a5d26(0x468)](_0x567ce3,_0x2abae2[_0x2a5d26(0x2d3)]);const _0x329c78=new _0x92597c(_0x4a99ec+_0x39304f['generateRandomId'](_0xd9bc96),{'left':_0x4bb375+_0x20adee-_0x4f1b91,'top':_0x2fe17c+_0x135caf-_0xcfdad9,'text':_0x59fe52,'color':_0x14cff7});this[_0x2a5d26(0x22c)]=_0x329c78,this[_0x2a5d26(0x2c9)][_0x2a5d26(0x468)](_0x329c78,_0x2abae2[_0x2a5d26(0x2d3)]),this[_0x2a5d26(0x1ca)]=!0x1;}[_0x5de549(0x339)](){const _0xcc7211=_0x5de549,_0x2d7913=this[_0xcc7211(0x25c)][_0xcc7211(0x2f2)]['subscribeEvent'](()=>{const _0x102ea4=_0xcc7211;this[_0x102ea4(0x1ca)]=!0x0;}),_0x31fe76=this[_0xcc7211(0x25c)][_0xcc7211(0x21d)][_0xcc7211(0x3f9)](()=>{const _0x32ebe7=_0xcc7211;this[_0x32ebe7(0x465)]&&clearTimeout(this[_0x32ebe7(0x465)]),this[_0x32ebe7(0x465)]=setTimeout(()=>{const _0x33eb58=_0x32ebe7;this[_0x33eb58(0x1ca)]=!0x1;},0x7d0);});return()=>{const _0x356aa8=_0xcc7211;_0x2d7913['unsubscribe'](),_0x31fe76[_0x356aa8(0x1c2)]();};}[_0x5de549(0x442)](_0x3fbae7,_0x22b19d,_0x19e3d1,_0x5eaa4d){const _0x4433d3=_0x5de549,_0xd59fc2=new _0x39304f[(_0x4433d3(0x253))](_0x3fbae7)[_0x4433d3(0x307)](0.2)[_0x4433d3(0x3f0)](),_0x17a0b9=new _0x46a3bd['RegularPolygon'](_0x100123+_0x39304f[_0x4433d3(0x26d)](_0xd9bc96),{'pointsGroup':_0x22b19d,'fill':_0xd59fc2||_0x46a3bd['getColor'](_0x39304f[_0x4433d3(0x3de)][_0x4433d3(0x260)],0.2),'left':_0x19e3d1,'top':_0x5eaa4d,'evented':!0x1,'debounceParentDirty':!0x1});this[_0x4433d3(0x290)][_0x4433d3(0x44d)](_0x17a0b9),this[_0x4433d3(0x2c9)][_0x4433d3(0x468)](_0x17a0b9,_0x2abae2[_0x4433d3(0x2d3)]);}['_drawRectRange'](_0x1a96c6,_0x5691d7,_0x1ccb46,_0x3a9512){const _0xeedda7=_0x5de549,_0x5acb48=new _0x39304f[(_0xeedda7(0x253))](_0x1a96c6)[_0xeedda7(0x307)](0.2)[_0xeedda7(0x3f0)](),_0xd82177=new _0x46a3bd[(_0xeedda7(0x2e5))](_0x1c8aab+_0x39304f[_0xeedda7(0x26d)](_0xd9bc96),{'pointsGroup':_0x5691d7,'fill':_0x5acb48||_0x46a3bd[_0xeedda7(0x2c6)](_0x39304f['COLORS']['black'],0.2),'left':_0x1ccb46,'top':_0x3a9512,'evented':!0x1,'debounceParentDirty':!0x1});this[_0xeedda7(0x290)][_0xeedda7(0x44d)](_0xd82177),this[_0xeedda7(0x2c9)][_0xeedda7(0x468)](_0xd82177,_0x2abae2['TEXT_RANGE_LAYER_INDEX']);}[_0x5de549(0x46b)](_0x346a9a){const _0x1bc1a9=_0x346a9a[0x0],_0x2fb662=_0x1bc1a9[0x0],_0x3e6129=_0x1bc1a9[0x2],{x:_0x412132,y:_0x52da6b}=_0x2fb662,{x:_0x42a6ac,y:_0x414699}=_0x3e6129;return{'left':_0x412132,'top':_0x52da6b,'width':_0x42a6ac-_0x412132,'height':_0x414699-_0x52da6b};}[_0x5de549(0x3fa)](){const _0x371404=_0x5de549,{scaleX:_0xf1f0f3,scaleY:_0x14c6cf}=this[_0x371404(0x2c9)][_0x371404(0x3da)]();return Math[_0x371404(0x2c5)](_0xf1f0f3,_0x14c6cf);}}var _0x1cb7ff=Object[_0x5de549(0x49f)],_0x523c23=(_0x336df6,_0x5f5360,_0x569c56,_0xd71dab)=>{const _0x112fec=_0x5de549;for(var _0x5b79a3=_0xd71dab>0x1?void 0x0:_0xd71dab?_0x1cb7ff(_0x5f5360,_0x569c56):_0x5f5360,_0x31363c=_0x336df6[_0x112fec(0x3b7)]-0x1,_0x32adb4;_0x31363c>=0x0;_0x31363c--)(_0x32adb4=_0x336df6[_0x31363c])&&(_0x5b79a3=_0x32adb4(_0x5b79a3)||_0x5b79a3);return _0x5b79a3;},_0x4242c1=(_0x3e0550,_0xe9728e)=>(_0x1cc2b4,_0x4feed2)=>_0xe9728e(_0x1cc2b4,_0x4feed2,_0x3e0550);let _0x43034b=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0x32fe80,_0x28a186,_0x4c2716,_0x29e4f6,_0xe5c98c){const _0x689ab3=_0x5de549;super(),_0x41fabe(this,_0x689ab3(0x3c0),[]),_0x41fabe(this,'_cursors',[]),(this[_0x689ab3(0x33f)]=_0x32fe80,this[_0x689ab3(0x317)]=_0x28a186,this[_0x689ab3(0x1c5)]=_0x4c2716,this['_commandService']=_0x29e4f6,this['_themeService']=_0xe5c98c,this[_0x689ab3(0x48f)]());}[_0x5de549(0x48f)](){const _0x53fd71=_0x5de549,_0xfd9696=this['_context'][_0x53fd71(0x2fb)],_0x58587f=this[_0x53fd71(0x317)];this[_0x53fd71(0x24e)](_0x404575['combineLatest']([this['_collabCursorController']['getCollabCursors$'](_0xfd9696),this['_themeService'][_0x53fd71(0x382)]])[_0x53fd71(0x498)](_0x11a31a[_0x53fd71(0x309)](([_0x1752f7,_0x34b36a])=>({'skeleton':_0x58587f[_0x53fd71(0x30d)](),'cursors':[..._0x1752f7[_0x53fd71(0x2ba)]()][_0x53fd71(0x1b2)](_0x24b8e3=>({..._0x24b8e3,'color':this[_0x53fd71(0x333)][_0x53fd71(0x302)](_0x24b8e3['color'])}))})))[_0x53fd71(0x38e)](_0x24f0e9=>{const _0x49f758=_0x53fd71;if(this[_0x49f758(0x369)](),_0x24f0e9){const {skeleton:_0x4c719d,cursors:_0x841627}=_0x24f0e9;this['_updateCollabCursors'](_0x4c719d,_0x841627);}})),this[_0x53fd71(0x441)](),this[_0x53fd71(0x2ac)]();}['_updateCollabCursors'](_0x5d1d11,_0x3da123){const _0x4fde4f=_0x5de549,{scene:_0x374fa5,mainComponent:_0x567e20}=this[_0x4fde4f(0x33f)],_0x5a9395=_0x3da123[_0x4fde4f(0x309)](_0x3f28a6=>new _0x5b7907(_0x3f28a6,_0x374fa5,_0x5d1d11,_0x567e20));this[_0x4fde4f(0x3c0)]=_0x5a9395,this[_0x4fde4f(0x2ad)]=_0x3da123;}[_0x5de549(0x295)](){const _0x50e70e=_0x5de549;this[_0x50e70e(0x369)]();const {scene:_0x33a49b,mainComponent:_0x1d2307}=this[_0x50e70e(0x33f)],_0x376e36=this['_docSkeletonManagerService'][_0x50e70e(0x30d)](),_0x2dc872=this[_0x50e70e(0x2ad)][_0x50e70e(0x309)](_0x2d7dd9=>new _0x5b7907(_0x2d7dd9,_0x33a49b,_0x376e36,_0x1d2307));this[_0x50e70e(0x3c0)]=_0x2dc872;}[_0x5de549(0x369)](){const _0x29e4ed=_0x5de549;this['_cursorShapes'][_0x29e4ed(0x22a)](_0xe30281=>_0xe30281[_0x29e4ed(0x2c3)]()),this[_0x29e4ed(0x3c0)]=[];}[_0x5de549(0x2ac)](){const _0x285d1b=_0x5de549,_0x1a6be0=[_0x2abae2[_0x285d1b(0x1ef)]['id']];this[_0x285d1b(0x24e)](this['_commandService'][_0x285d1b(0x2fd)](_0x63284e=>{const _0x1a0d99=_0x285d1b;_0x1a6be0[_0x1a0d99(0x410)](_0x63284e['id'])&&_0x63284e['params'][_0x1a0d99(0x2fb)]===this[_0x1a0d99(0x33f)][_0x1a0d99(0x2fb)]&&this['_refreshCollabCursors']();}));}[_0x5de549(0x441)](){const _0xf390af=_0x5de549;this[_0xf390af(0x24e)](_0x39304f[_0xf390af(0x1a4)](this[_0xf390af(0x33f)]['engine']['onTransformChange$'])[_0xf390af(0x498)](_0x11a31a[_0xf390af(0x1c6)](_0x29f320=>_0x29f320[_0xf390af(0x328)]===_0x46a3bd[_0xf390af(0x39d)]['resize']),_0x11a31a[_0xf390af(0x3fb)](0x10))['subscribe'](()=>{this['_refreshCollabCursors']();}));}};_0x43034b=_0x523c23([_0x4242c1(0x1,_0x39304f['Inject'](_0x59af06[_0x5de549(0x30b)])),_0x4242c1(0x2,_0x39304f[_0x5de549(0x356)](_0x1af4cc)),_0x4242c1(0x3,_0x39304f['ICommandService']),_0x4242c1(0x4,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x297)]))],_0x43034b);const _0x2e2110=0x1,_0x43d861=1.5;class _0x3ed0a extends _0x46a3bd[_0x5de549(0x451)]{constructor(_0x5dafd7,_0x3d1a35){const _0x23c2ff=_0x5de549;super(_0x5dafd7,_0x3d1a35),_0x41fabe(this,'_color'),_0x41fabe(this,_0x23c2ff(0x1e9),!0x1),_0x41fabe(this,'_range'),_0x41fabe(this,_0x23c2ff(0x47c),''),_0x41fabe(this,_0x23c2ff(0x206),_0x23c2ff(0x1d5)),_0x41fabe(this,_0x23c2ff(0x36a)),(_0x3d1a35&&this[_0x23c2ff(0x3e2)](_0x3d1a35),this[_0x23c2ff(0x2f2)][_0x23c2ff(0x3f9)](()=>this[_0x23c2ff(0x3e2)]({'hovered':!0x0})),this[_0x23c2ff(0x21d)][_0x23c2ff(0x3f9)](()=>this[_0x23c2ff(0x3e2)]({'hovered':!0x1})));}[_0x5de549(0x3e2)](_0x1f759b){const _0x2ce398=_0x5de549;var _0x28ec5b,_0x5550bb,_0x1d8c1f,_0x4e5e4f,_0x34ad7e,_0x25d370;this[_0x2ce398(0x436)]=(_0x28ec5b=_0x1f759b[_0x2ce398(0x477)])!=null?_0x28ec5b:this[_0x2ce398(0x436)],this[_0x2ce398(0x1e9)]=(_0x5550bb=_0x1f759b[_0x2ce398(0x272)])!=null?_0x5550bb:this['_hovered'],this['_range']=(_0x1d8c1f=_0x1f759b[_0x2ce398(0x1f6)])!=null?_0x1d8c1f:this[_0x2ce398(0x2d2)],this[_0x2ce398(0x47c)]=(_0x4e5e4f=_0x1f759b['name'])!=null?_0x4e5e4f:this[_0x2ce398(0x47c)],this[_0x2ce398(0x206)]=(_0x34ad7e=_0x1f759b[_0x2ce398(0x203)])!=null?_0x34ad7e:this['_labelPosition'],this['_backgroundColor']=(_0x25d370=_0x1f759b[_0x2ce398(0x42e)])!=null?_0x25d370:this[_0x2ce398(0x36a)],this[_0x2ce398(0x3f1)]({'width':_0x1f759b[_0x2ce398(0x3d6)],'height':_0x1f759b[_0x2ce398(0x381)]});}['onMouseMove'](_0xa16a8a){const _0x557c76=_0x5de549,{row:_0x487c3f,column:_0x194cfc}=_0xa16a8a;if(_0x487c3f>=this['_range'][_0x557c76(0x1a7)]&&_0x487c3f<=this[_0x557c76(0x2d2)][_0x557c76(0x1b9)]&&_0x194cfc>=this[_0x557c76(0x2d2)][_0x557c76(0x286)]&&_0x194cfc<=this[_0x557c76(0x2d2)][_0x557c76(0x305)]){this['setShapeProps']({'hovered':!0x0});return;}this[_0x557c76(0x3e2)]({'hovered':!0x1});}[_0x5de549(0x32e)](_0x4e0061){return!0x1;}['_draw'](_0x213ffc){const _0x405669=_0x5de549;_0x46a3bd[_0x405669(0x39c)][_0x405669(0x3c3)](_0x213ffc,{'width':this['width'],'height':this[_0x405669(0x381)],'strokeWidth':_0x43d861,'stroke':this[_0x405669(0x436)],'evented':!0x1,'fill':this['_backgroundColor']}),this[_0x405669(0x1e9)]&&(_0x213ffc[_0x405669(0x1d8)](),_0x213ffc['transform'](0x1,0x0,0x0,0x1,this[_0x405669(0x3d6)],this['_labelPosition']===_0x405669(0x2c7)?0x0:-_0xcfdad9),_0x92597c[_0x405669(0x3c3)](_0x213ffc,{'text':this[_0x405669(0x47c)],'color':this[_0x405669(0x436)]}),_0x213ffc[_0x405669(0x320)]());}}var _0x4c5c8d=Object[_0x5de549(0x49f)],_0x1af073=(_0x2e75b2,_0x11cf96,_0x3c727f,_0xa711d7)=>{const _0x1538f5=_0x5de549;for(var _0x1b8c04=_0xa711d7>0x1?void 0x0:_0xa711d7?_0x4c5c8d(_0x11cf96,_0x3c727f):_0x11cf96,_0x130c96=_0x2e75b2[_0x1538f5(0x3b7)]-0x1,_0x38f2fa;_0x130c96>=0x0;_0x130c96--)(_0x38f2fa=_0x2e75b2[_0x130c96])&&(_0x1b8c04=_0x38f2fa(_0x1b8c04)||_0x1b8c04);return _0x1b8c04;},_0x407ac8=(_0x6f515c,_0x2a0fcb)=>(_0x22eb03,_0x1cd18d)=>_0x2a0fcb(_0x22eb03,_0x1cd18d,_0x6f515c);const _0x296aa0=0x1389;let _0x338784=class extends _0x39304f[_0x5de549(0x423)]{constructor(_0xfa3cc9,_0x5d9368,_0x2e72af,_0x8d6026){const _0x55dd9a=_0x5de549;super(),_0x41fabe(this,_0x55dd9a(0x2ad),new Set()),_0x41fabe(this,_0x55dd9a(0x3a4),null),(this[_0x55dd9a(0x33f)]=_0xfa3cc9,this[_0x55dd9a(0x271)]=_0x5d9368,this[_0x55dd9a(0x1c5)]=_0x2e72af,this['_themeService']=_0x8d6026,this[_0x55dd9a(0x48f)]());}[_0x5de549(0x48f)](){const _0x33700d=_0x5de549;this[_0x33700d(0x271)][_0x33700d(0x318)]['pipe'](_0x11a31a[_0x33700d(0x387)](this['dispose$']),_0x11a31a[_0x33700d(0x287)](_0x524101=>{const _0x46fc6c=_0x33700d;if(_0x524101){const _0x429a1b=_0x524101[_0x46fc6c(0x289)];return _0x404575['combineLatest'](this['_collabCursorController'][_0x46fc6c(0x3eb)](this['_context'][_0x46fc6c(0x2fb)]),this[_0x46fc6c(0x333)]['currentTheme$'])[_0x46fc6c(0x498)](_0x11a31a['map'](([_0x93bfa2,_0x5f3768])=>{const _0x22ac9c=new Map();return _0x93bfa2['forEach']((_0x16b3a5,_0x14029b)=>{const _0x154a14=_0x48a1;if(_0x16b3a5[_0x154a14(0x485)]===_0x429a1b){const _0x543876={..._0x16b3a5};_0x543876[_0x154a14(0x477)]=this[_0x154a14(0x333)][_0x154a14(0x302)](_0x16b3a5['color']),_0x22ac9c['set'](_0x14029b,_0x543876);}}),{'skeleton':_0x524101,'cursors':_0x22ac9c};}));}return _0x404575['of']({'skeleton':null,'cursors':new Map()});}))[_0x33700d(0x38e)](({skeleton:_0x1cec6f,cursors:_0x3b655b})=>{const _0x3cc9b4=_0x33700d;this[_0x3cc9b4(0x369)](),_0x1cec6f&&this[_0x3cc9b4(0x4a1)](_0x1cec6f,_0x3b655b);}),this['_sheetSkeletonManagerService']['currentSkeleton$'][_0x33700d(0x38e)](_0x9c2207=>{const _0x34b7bb=_0x33700d;if(_0x9c2207==null)return;const {skeleton:_0x5b7505}=_0x9c2207,{scene:_0x4ef404}=this[_0x34b7bb(0x33f)];_0x4ef404[_0x34b7bb(0x3ff)]['subscribeEvent'](_0x39304f[_0x34b7bb(0x484)](_0x44f8e6=>{const _0xc71997=_0x34b7bb;var _0x4044b9,_0x5b69a8;const {offsetX:_0x102f16,offsetY:_0x17620b}=_0x44f8e6,{x:_0x9eff90,y:_0x332573}=_0x4ef404[_0xc71997(0x425)](_0x46a3bd[_0xc71997(0x24a)][_0xc71997(0x2e7)]([_0x102f16,_0x17620b])),{scaleX:_0x54d343,scaleY:_0x3546e8}=_0x4ef404[_0xc71997(0x3da)](),_0x356396=_0x4ef404['getViewport'](_0x46a3bd[_0xc71997(0x3b9)][_0xc71997(0x263)]),_0x511ff6=_0x4ef404[_0xc71997(0x1d2)](_0x46a3bd[_0xc71997(0x24a)][_0xc71997(0x2e7)]([_0x9eff90,_0x332573]),_0x356396),_0xb67cb9=_0x5b7505['getCellPositionByOffset'](_0x102f16,_0x17620b,_0x54d343,_0x3546e8,_0x511ff6);((_0x4044b9=this[_0xc71997(0x3a4)])==null?void 0x0:_0x4044b9['column'])===_0xb67cb9[_0xc71997(0x2a3)]&&((_0x5b69a8=this[_0xc71997(0x3a4)])==null?void 0x0:_0x5b69a8[_0xc71997(0x367)])===_0xb67cb9[_0xc71997(0x367)]||this[_0xc71997(0x2ad)][_0xc71997(0x22a)](_0x3f8b92=>{const _0x3efc1c=_0xc71997;_0x3f8b92[_0x3efc1c(0x245)](_0xb67cb9);});},0x64));});}['_updateCollabCursors'](_0x13b2bd,_0x4a4ad3){const _0x2e8be7=_0x5de549;var _0x5bd5d9;const _0x5f29ac=(_0x5bd5d9=this[_0x2e8be7(0x271)][_0x2e8be7(0x335)]())==null?void 0x0:_0x5bd5d9[_0x2e8be7(0x280)];if(!_0x5f29ac)return;const _0x48d6df=this['_getSheetObject']();if(!_0x48d6df)return;this['_cursors'][_0x2e8be7(0x22a)](_0x3d5995=>{const _0x5eddb5=_0x2e8be7;_0x3d5995[_0x5eddb5(0x1bc)]();});const {scene:_0x59efc3}=_0x48d6df,_0x12e36a=_0x458cd3(Array['from'](_0x4a4ad3[_0x2e8be7(0x2ba)]()))[_0x2e8be7(0x309)](_0x332993=>{const _0x4b4fa2=_0x2e8be7,{color:_0x423810,range:_0x5d8786,name:_0x36a385,selection:_0xbce8e9,sheetID:_0xc42bbd}=_0x332993,{startColumn:_0x2f42e9,startRow:_0x2a9440,endColumn:_0x2e2a87,endRow:_0x258fdd}=_0x5d8786,_0x5ccc56=_0x5ee9c5['getCoordByCell'](_0x2a9440,_0x2f42e9,_0x59efc3,_0x5f29ac),_0x190278=_0x5ee9c5[_0x4b4fa2(0x365)](_0x258fdd,_0x2e2a87,_0x59efc3,_0x5f29ac),{columnHeaderHeightAndMarginTop:_0x453139}=_0x5f29ac,{startX:_0x3d919e,startY:_0x5d4228}=_0x5ccc56,{endX:_0x1cd7c2,endY:_0x32ae5f}=_0x190278,_0xa47f22=_0x1cd7c2-_0x3d919e,_0x45c369=_0x32ae5f-_0x5d4228,_0x4b9f99={'labelPosition':_0x5d4228-_0x453139>=_0xcfdad9?_0x4b4fa2(0x1d5):_0x4b4fa2(0x2c7),'sheetID':_0xc42bbd,'range':_0x5d8786,'color':_0x423810,'name':_0x36a385,'selection':_0xbce8e9,'left':_0x3d919e,'top':_0x5d4228,'width':_0xa47f22,'height':_0x45c369,'evented':!0x1,'zIndex':_0x296aa0};return new _0x3ed0a(_0x36a385,_0x4b9f99);});_0x59efc3['addObjects'](_0x12e36a,_0x2e2110),this[_0x2e8be7(0x2ad)]=new Set(_0x12e36a);}[_0x5de549(0x369)](){const _0x4d06a3=_0x5de549;var _0x4afb16;(_0x4afb16=this[_0x4d06a3(0x2ad)])==null||_0x4afb16[_0x4d06a3(0x22a)](_0x55ef26=>_0x55ef26['dispose']());}[_0x5de549(0x440)](){const _0x1c3382=_0x5de549;return _0x5ee9c5[_0x1c3382(0x415)](this[_0x1c3382(0x33f)][_0x1c3382(0x3c7)],this[_0x1c3382(0x33f)]);}};_0x338784=_0x1af073([_0x407ac8(0x1,_0x39304f['Inject'](_0x5ee9c5[_0x5de549(0x366)])),_0x407ac8(0x2,_0x39304f[_0x5de549(0x356)](_0x1af4cc)),_0x407ac8(0x3,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x297)]))],_0x338784);function _0x458cd3(_0x34cb49){const _0x2fda3d=_0x5de549,_0x421203=new Map();return _0x34cb49[_0x2fda3d(0x22a)](_0x10836f=>{const _0x237ca0=_0x2fda3d;if(_0x421203[_0x237ca0(0x3f7)](_0x10836f[_0x237ca0(0x368)])){const _0x4f7de6=_0x421203[_0x237ca0(0x1c0)](_0x10836f[_0x237ca0(0x368)]);_0x4f7de6[_0x237ca0(0x231)]+=',\x20'+_0x10836f[_0x237ca0(0x231)];}else _0x421203[_0x237ca0(0x361)](_0x10836f[_0x237ca0(0x368)],_0x10836f);}),Array[_0x2fda3d(0x1bf)](_0x421203[_0x2fda3d(0x2ba)]());}var _0xf8c215=Object[_0x5de549(0x49f)],_0x3b3685=(_0x2adfa4,_0xd61da1,_0x3f4c76,_0x9c023b)=>{const _0x489f5f=_0x5de549;for(var _0x49697e=_0x9c023b>0x1?void 0x0:_0x9c023b?_0xf8c215(_0xd61da1,_0x3f4c76):_0xd61da1,_0x8296a6=_0x2adfa4[_0x489f5f(0x3b7)]-0x1,_0xbb1cb7;_0x8296a6>=0x0;_0x8296a6--)(_0xbb1cb7=_0x2adfa4[_0x8296a6])&&(_0x49697e=_0xbb1cb7(_0x49697e)||_0x49697e);return _0x49697e;},_0x37b7aa=(_0x36f074,_0x11124c)=>(_0x327122,_0x3e10b4)=>_0x11124c(_0x327122,_0x3e10b4,_0x36f074);let _0x261734=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x4b7b0f,_0x3c15a6,_0x3e05b3,_0x1ae48b,_0x32186c,_0x51b570){const _0x2c7531=_0x5de549;super(),this[_0x2c7531(0x3d4)]=_0x4b7b0f,this['_localCacheService']=_0x3c15a6,this[_0x2c7531(0x250)]=_0x3e05b3,this[_0x2c7531(0x22d)]=_0x1ae48b,this['_notificationService']=_0x32186c,this[_0x2c7531(0x3c1)]=_0x51b570,this[_0x2c7531(0x229)](),this['_initEvent']();}[_0x5de549(0x229)](){const _0x428eab=_0x5de549;this[_0x428eab(0x24e)](this['_beforeCloseService'][_0x428eab(0x265)](()=>{const _0x51994e=_0x428eab;if(this[_0x51994e(0x2e6)][_0x51994e(0x32c)]['size'])return this[_0x51994e(0x3c1)]['t'](_0x51994e(0x39b));}));}[_0x5de549(0x23a)](){const _0x34beee=_0x5de549;this[_0x34beee(0x24e)](this[_0x34beee(0x250)][_0x34beee(0x2dc)][_0x34beee(0x38e)](_0x50e32e=>{const _0x2b8cdd=_0x34beee;_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x352)]&&this['_messageService'][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x370)],'content':this['_localeService']['t'](_0x2b8cdd(0x377))}),_0x50e32e['id']===_0x3fe1f0['CollaborationUIEventId'][_0x2b8cdd(0x326)]&&this[_0x2b8cdd(0x22d)]['show']({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x370)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x31e))}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x43e)]&&this['_notificationService'][_0x2b8cdd(0x38d)]({'title':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x257)),'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x254)),'type':'error','duration':0x0}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x3ad)]&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x385)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x31e))+'('+_0x50e32e['data']+')'}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)]['JOIN_ROOM_FAILED']&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)][_0x2b8cdd(0x370)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x50e32e[_0x2b8cdd(0x298)]||'')}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)][_0x2b8cdd(0x1f3)]&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f['MessageType'][_0x2b8cdd(0x370)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x243))}),_0x50e32e['id']===_0x3fe1f0[_0x2b8cdd(0x33d)]['SOCKET_FAILED']&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f[_0x2b8cdd(0x242)]['Error'],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x1db))}),_0x50e32e['id']===_0x3fe1f0['CollaborationUIEventId'][_0x2b8cdd(0x20b)]&&this[_0x2b8cdd(0x22d)][_0x2b8cdd(0x38d)]({'type':_0x31598f['MessageType'][_0x2b8cdd(0x385)],'content':this[_0x2b8cdd(0x3c1)]['t'](_0x2b8cdd(0x28e))});}));}};_0x261734=_0x3b3685([_0x37b7aa(0x0,_0x4c3b5c[_0x5de549(0x30f)]),_0x37b7aa(0x1,_0x3fe1f0['ILocalCacheService']),_0x37b7aa(0x2,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x49b)])),_0x37b7aa(0x3,_0x4c3b5c[_0x5de549(0x323)]),_0x37b7aa(0x4,_0x4c3b5c['INotificationService']),_0x37b7aa(0x5,_0x39304f['Inject'](_0x39304f[_0x5de549(0x3f4)]))],_0x261734);var _0x13e2d4=Object[_0x5de549(0x49f)],_0x10ba81=(_0x124bf3,_0x249681,_0x1806b9,_0x28810f)=>{const _0x5a8ec4=_0x5de549;for(var _0x48deb7=_0x28810f>0x1?void 0x0:_0x28810f?_0x13e2d4(_0x249681,_0x1806b9):_0x249681,_0x257f51=_0x124bf3[_0x5a8ec4(0x3b7)]-0x1,_0x4b7a52;_0x257f51>=0x0;_0x257f51--)(_0x4b7a52=_0x124bf3[_0x257f51])&&(_0x48deb7=_0x4b7a52(_0x48deb7)||_0x48deb7);return _0x48deb7;},_0x44586c=(_0x54155a,_0x3e77ee)=>(_0x5375eb,_0x2e343a)=>_0x3e77ee(_0x5375eb,_0x2e343a,_0x54155a);let _0x33fdc9=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x27263d,_0x260cd1,_0x5a6dd8,_0x395262){const _0x16a84f=_0x5de549;super(),_0x41fabe(this,_0x16a84f(0x1b8)),(this[_0x16a84f(0x31d)]=_0x27263d,this['_httpService']=_0x260cd1,this['_logService']=_0x5a6dd8,this[_0x16a84f(0x2cf)]=_0x395262,this[_0x16a84f(0x48f)]());}['_init'](){const _0x5b4ba0=_0x5de549;this[_0x5b4ba0(0x28b)](),this[_0x5b4ba0(0x343)](),this['_monkeyPatchLogService'](),this[_0x5b4ba0(0x39e)]();}['_initUserListener'](){const _0x5a9aae=_0x5de549;this[_0x5a9aae(0x24e)](this[_0x5a9aae(0x2cf)][_0x5a9aae(0x41f)]['subscribe'](_0x45ec33=>{const _0x222947=_0x5a9aae;this[_0x222947(0x1b8)]=_0x45ec33==null?void 0x0:_0x45ec33['memberID'];}));}['_initWindowErrorListener'](){const _0x141c9e=_0x5de549,_0x509417=_0xaaddbd=>{const _0x3d4797=_0x48a1;var _0x4115a5;this[_0x3d4797(0x45c)](_0x3d4797(0x2ee),'[Window\x20Error]:\x20'+_0xaaddbd[_0x3d4797(0x1c3)]+_0x3d4797(0x3b4)+_0xaaddbd[_0x3d4797(0x2d1)]+':'+_0xaaddbd[_0x3d4797(0x285)]+':'+_0xaaddbd['colno']+'\x0a'+(((_0x4115a5=_0xaaddbd[_0x3d4797(0x2ee)])==null?void 0x0:_0x4115a5[_0x3d4797(0x23d)])||''));};window[_0x141c9e(0x34d)]('error',_0x509417),this[_0x141c9e(0x24e)](()=>{const _0x356c8a=_0x141c9e;window['removeEventListener'](_0x356c8a(0x2ee),_0x509417);});}[_0x5de549(0x343)](){const _0xe27f4a=_0x5de549,_0x6bb16e=_0x189d06=>{const _0x392500=_0x48a1;this[_0x392500(0x45c)](_0x392500(0x2ee),_0x392500(0x4a6)+_0x189d06[_0x392500(0x218)]);};window[_0xe27f4a(0x34d)](_0xe27f4a(0x493),_0x6bb16e),this[_0xe27f4a(0x24e)](()=>{const _0x19d106=_0xe27f4a;window[_0x19d106(0x47e)]('unhandledrejection',_0x6bb16e);});}[_0x5de549(0x384)](){const _0x283af5=_0x5de549,_0x3ed876=this[_0x283af5(0x43a)]['error'][_0x283af5(0x3c6)](this[_0x283af5(0x43a)]);this[_0x283af5(0x43a)][_0x283af5(0x2ee)]=(..._0x4e7e78)=>{const _0x2bfa96=_0x283af5,_0x199123=_0x4e7e78[_0x2bfa96(0x309)](_0x564425=>_0x564425 instanceof Error?_0x564425[_0x2bfa96(0x1c3)]+'\x0a'+_0x564425[_0x2bfa96(0x23d)]:String(_0x564425))[_0x2bfa96(0x3b0)]('\x20');this[_0x2bfa96(0x45c)](_0x2bfa96(0x2ee),_0x2bfa96(0x2d7)+_0x199123),_0x3ed876(..._0x4e7e78);},this['disposeWithMe'](()=>{const _0x2baff1=_0x283af5;this[_0x2baff1(0x43a)][_0x2baff1(0x2ee)]=_0x3ed876;});}['_uploadLog'](_0xe0ad67,_0x53523f){const _0x234b66=_0x5de549;try{const _0x5015b7={'userId':this['_memberID'],'logLabel':_0xe0ad67,'content':_0x53523f};this[_0x234b66(0x40f)][_0x234b66(0x2b8)](_0x234b66(0x401),{'body':_0x5015b7})[_0x234b66(0x47a)](()=>{});}catch{}}};_0x33fdc9=_0x10ba81([_0x44586c(0x0,_0x39304f['Inject'](_0x39304f[_0x5de549(0x2bd)])),_0x44586c(0x1,_0x39304f[_0x5de549(0x356)](_0x4e0fb2[_0x5de549(0x469)])),_0x44586c(0x2,_0x39304f[_0x5de549(0x25e)]),_0x44586c(0x3,_0x39304f['Inject'](_0x3fe1f0[_0x5de549(0x22f)]))],_0x33fdc9);const _0x13b4e5='collaboration-client-ui.config',_0x469697={};var _0x2d8b6a=Object[_0x5de549(0x49f)],_0x5144bc=(_0x2e9deb,_0x49fce7,_0x2796ee,_0x5a5c38)=>{for(var _0x3add98=_0x5a5c38>0x1?void 0x0:_0x5a5c38?_0x2d8b6a(_0x49fce7,_0x2796ee):_0x49fce7,_0x583c85=_0x2e9deb['length']-0x1,_0x26f12f;_0x583c85>=0x0;_0x583c85--)(_0x26f12f=_0x2e9deb[_0x583c85])&&(_0x3add98=_0x26f12f(_0x3add98)||_0x3add98);return _0x3add98;},_0xaf46f4=(_0x318beb,_0x184d72)=>(_0x538d89,_0x556cb5)=>_0x184d72(_0x538d89,_0x556cb5,_0x318beb);let _0x547126=class{constructor(_0x1cdea0,_0x36fbef){const _0x38e088=_0x5de549;this[_0x38e088(0x403)]=_0x1cdea0,this['_renderManagerService']=_0x36fbef;}[_0x5de549(0x342)](_0x4542d6){this['_transformUndoRedoStack'](_0x4542d6),this['_transformPreviousActiveRange'](_0x4542d6);}['transformRemoteChangeset'](_0x55e528){const _0x53e068=_0x5de549,{unitID:_0x4b29d1}=_0x55e528,_0x362b15=this['_renderManagerService'][_0x53e068(0x21a)](_0x4b29d1)['with'](_0x2abae2[_0x53e068(0x278)]),{redoCache:_0x2d8887}=_0x362b15[_0x53e068(0x2dd)]();if(_0x2d8887[_0x53e068(0x3b7)]===0x0)return _0x55e528;let _0x8af97c=_0x39304f[_0x53e068(0x1ec)][_0x53e068(0x3ab)](_0x55e528[_0x53e068(0x404)][0x0]);for(let _0x5f4fd3=0x0;_0x5f4fd3<_0x2d8887['length'];_0x5f4fd3++){const _0x48cd37={'id':'doc.mutation.rich-text-editing','params':{..._0x2d8887[_0x5f4fd3]}},_0x4c9974=this[_0x53e068(0x403)][_0x53e068(0x37d)](_0x8af97c,_0x48cd37,!0x1);if(_0x560361['isTransformMutationFailure'](_0x4c9974))throw _0x4c9974['error'];_0x8af97c=_0x4c9974[_0x53e068(0x1d7)];}return{..._0x39304f[_0x53e068(0x1ec)][_0x53e068(0x3ab)](_0x55e528),'mutations':[_0x8af97c]};}[_0x5de549(0x1eb)](_0xa0a2df){const _0x2185bc=_0x5de549,{unitID:_0x34638f}=_0xa0a2df,_0x4fcd09=this[_0x2185bc(0x349)][_0x2185bc(0x21a)](_0x34638f)[_0x2185bc(0x29e)](_0x2abae2[_0x2185bc(0x278)]),{undoCache:_0x392f4c,redoCache:_0x28d1ef}=_0x4fcd09[_0x2185bc(0x2dd)]();if(_0x392f4c[_0x2185bc(0x3b7)]===0x0||_0x28d1ef[_0x2185bc(0x3b7)]===0x0)return;const _0x8c4423=[],_0x2d8532=[];let _0x4a9868=_0x39304f[_0x2185bc(0x1ec)][_0x2185bc(0x3ab)](_0xa0a2df[_0x2185bc(0x404)][0x0]),_0x259e9c=_0x39304f[_0x2185bc(0x1ec)][_0x2185bc(0x3ab)](_0xa0a2df[_0x2185bc(0x404)][0x0]);for(let _0x3e7a7b=_0x392f4c['length']-0x1;_0x3e7a7b>=0x0;_0x3e7a7b--){const _0x37ec47={'id':'doc.mutation.rich-text-editing','params':{..._0x392f4c[_0x3e7a7b]}},_0x5b75cf={'id':_0x2185bc(0x476),'params':{..._0x28d1ef[_0x3e7a7b]}},_0x3b4497=this[_0x2185bc(0x403)][_0x2185bc(0x37d)](_0x4a9868,_0x37ec47,!0x1),_0x4c6a4a=this['_transformService'][_0x2185bc(0x37d)](_0x259e9c,_0x5b75cf,!0x1);if(_0x560361[_0x2185bc(0x3fd)](_0x3b4497))throw _0x3b4497[_0x2185bc(0x2ee)];if(_0x560361[_0x2185bc(0x3fd)](_0x4c6a4a))throw _0x4c6a4a[_0x2185bc(0x2ee)];_0x8c4423[_0x2185bc(0x282)](_0x3b4497[_0x2185bc(0x1e0)][_0x2185bc(0x448)]),_0x2d8532[_0x2185bc(0x282)](_0x4c6a4a[_0x2185bc(0x1e0)][_0x2185bc(0x448)]),_0x4a9868=_0x3b4497[_0x2185bc(0x1d7)],_0x259e9c=_0x4c6a4a[_0x2185bc(0x1d7)];}_0x4fcd09[_0x2185bc(0x38f)]({'undoCache':_0x8c4423,'redoCache':_0x2d8532});}['_transformPreviousActiveRange'](_0x2cb7f2){const _0x1d2229=_0x5de549,{unitID:_0x575294}=_0x2cb7f2,_0x26100d=this[_0x1d2229(0x349)]['getRenderById'](_0x575294)[_0x1d2229(0x29e)](_0x2abae2['DocIMEInputManagerService']),_0x4e2705=_0x26100d[_0x1d2229(0x464)]();if(_0x4e2705==null)return;const _0x45d90f=[{'id':_0x1d2229(0x476),'params':{'unitId':_0x2cb7f2[_0x1d2229(0x42f)],'actions':null,'textRanges':[_0x4e2705]}}],_0x535b1b=this[_0x1d2229(0x403)][_0x1d2229(0x3c4)](_0x2cb7f2,_0x45d90f);if(!_0x560361[_0x1d2229(0x2ce)](_0x535b1b))throw _0x535b1b[_0x1d2229(0x2ee)];const _0x22a910=_0x535b1b[_0x1d2229(0x1e0)][0x0][_0x1d2229(0x448)]['textRanges'];Array[_0x1d2229(0x372)](_0x22a910)&&_0x22a910[_0x1d2229(0x3b7)]&&_0x26100d[_0x1d2229(0x2a0)](_0x22a910[0x0]);}};_0x547126=_0x5144bc([_0xaf46f4(0x0,_0x560361[_0x5de549(0x37e)]),_0xaf46f4(0x1,_0x46a3bd['IRenderManagerService'])],_0x547126);var _0x494865=Object[_0x5de549(0x49f)],_0x33054a=(_0x2b793d,_0x395f2,_0x41015,_0x3c2c33)=>{const _0x20b2a4=_0x5de549;for(var _0x3a49a3=_0x3c2c33>0x1?void 0x0:_0x3c2c33?_0x494865(_0x395f2,_0x41015):_0x395f2,_0x594a98=_0x2b793d[_0x20b2a4(0x3b7)]-0x1,_0x26bebd;_0x594a98>=0x0;_0x594a98--)(_0x26bebd=_0x2b793d[_0x594a98])&&(_0x3a49a3=_0x26bebd(_0x3a49a3)||_0x3a49a3);return _0x3a49a3;},_0x216ee=(_0x133e54,_0x50da81)=>(_0x35743c,_0x50739a)=>_0x50da81(_0x35743c,_0x50739a,_0x133e54);let _0xacb853=class{constructor(_0x293e0b,_0x1d7f52,_0x2b5dd9){const _0x1279b7=_0x5de549;this[_0x1279b7(0x31d)]=_0x293e0b,this[_0x1279b7(0x403)]=_0x1d7f52,this[_0x1279b7(0x3b1)]=_0x2b5dd9;}[_0x5de549(0x444)](_0x330ee9){const _0x55e2e4=_0x5de549;this[_0x55e2e4(0x201)](_0x330ee9);}[_0x5de549(0x46e)](_0x223ef2){const _0xa5f205=_0x5de549,{unitID:_0x4560d2}=_0x223ef2,{collaboration:_0x3442fd}=this[_0xa5f205(0x3b1)][_0xa5f205(0x261)](_0x4560d2);if(_0x3442fd[_0xa5f205(0x3b7)]===0x0)return _0x223ef2;let _0x28a2ab=_0x39304f[_0xa5f205(0x1ec)][_0xa5f205(0x3ab)](_0x223ef2[_0xa5f205(0x404)][0x0]);for(let _0x9a05d4=0x0;_0x9a05d4<_0x3442fd[_0xa5f205(0x3b7)];_0x9a05d4++){const _0x293e26={'id':_0xa5f205(0x476),'params':{'unitId':_0x3442fd[_0x9a05d4]['unitId'],..._0x3442fd[_0x9a05d4][_0xa5f205(0x293)]}},_0x19c041=this[_0xa5f205(0x403)][_0xa5f205(0x37d)](_0x28a2ab,_0x293e26,!0x1);if(_0x560361[_0xa5f205(0x3fd)](_0x19c041))throw _0x19c041['error'];_0x28a2ab=_0x19c041[_0xa5f205(0x1d7)];}return{..._0x39304f[_0xa5f205(0x1ec)][_0xa5f205(0x3ab)](_0x223ef2),'mutations':[_0x28a2ab]};}[_0x5de549(0x201)](_0x1aa0af){const _0x38d35a=_0x5de549,{unitID:_0x16e33e}=_0x1aa0af,{history:_0x50ff57,collaboration:_0x30be94}=this['_docStateChangeManagerService'][_0x38d35a(0x261)](_0x16e33e);if(_0x50ff57['length']===0x0&&_0x30be94['length']===0x0)return;const _0x3759f8=[],_0x3a8e7f=[];let _0x45acc6=_0x39304f[_0x38d35a(0x1ec)][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]),_0x14a992=_0x39304f[_0x38d35a(0x1ec)][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]);for(let _0x58bccd=_0x50ff57['length']-0x1;_0x58bccd>=0x0;_0x58bccd--){const _0x30130b={'id':_0x38d35a(0x476),'params':{'unitId':_0x50ff57[_0x58bccd][_0x38d35a(0x2fb)],..._0x50ff57[_0x58bccd][_0x38d35a(0x222)]}},_0x36d30e={'id':_0x38d35a(0x476),'params':{'unitId':_0x50ff57[_0x58bccd]['unitId'],..._0x50ff57[_0x58bccd][_0x38d35a(0x293)]}},_0x45fc5a=this[_0x38d35a(0x403)]['transformMutation'](_0x45acc6,_0x30130b,!0x1),_0x375666=this[_0x38d35a(0x403)]['transformMutation'](_0x14a992,_0x36d30e,!0x1);if(_0x560361[_0x38d35a(0x3fd)](_0x45fc5a))throw _0x45fc5a['error'];if(_0x560361['isTransformMutationFailure'](_0x375666))throw _0x375666[_0x38d35a(0x2ee)];_0x3759f8['unshift']({..._0x50ff57[_0x58bccd],'undoState':_0x45fc5a['m2Prime']['params'],'redoState':_0x375666['m2Prime']['params']}),_0x45acc6=_0x45fc5a[_0x38d35a(0x1d7)],_0x14a992=_0x375666['m1Prime'];}_0x45acc6=_0x39304f['Tools'][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]),_0x14a992=_0x39304f[_0x38d35a(0x1ec)][_0x38d35a(0x3ab)](_0x1aa0af[_0x38d35a(0x404)][0x0]);for(let _0x286738=_0x30be94[_0x38d35a(0x3b7)]-0x1;_0x286738>=0x0;_0x286738--){const _0xb43fcc={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x30be94[_0x286738][_0x38d35a(0x2fb)],..._0x30be94[_0x286738][_0x38d35a(0x222)]}},_0xeb8c01={'id':'doc.mutation.rich-text-editing','params':{'unitId':_0x30be94[_0x286738][_0x38d35a(0x2fb)],..._0x30be94[_0x286738]['redoState']}},_0x3e48ae=this[_0x38d35a(0x403)][_0x38d35a(0x37d)](_0x45acc6,_0xb43fcc,!0x1),_0x34fa47=this[_0x38d35a(0x403)][_0x38d35a(0x37d)](_0x14a992,_0xeb8c01,!0x1);if(_0x560361['isTransformMutationFailure'](_0x3e48ae))throw _0x3e48ae[_0x38d35a(0x2ee)];if(_0x560361[_0x38d35a(0x3fd)](_0x34fa47))throw _0x34fa47[_0x38d35a(0x2ee)];_0x3a8e7f[_0x38d35a(0x282)]({..._0x30be94[_0x286738],'undoState':_0x3e48ae[_0x38d35a(0x1e0)]['params'],'redoState':_0x34fa47['m2Prime'][_0x38d35a(0x448)]}),_0x45acc6=_0x3e48ae['m1Prime'],_0x14a992=_0x34fa47[_0x38d35a(0x1d7)];}this[_0x38d35a(0x3b1)][_0x38d35a(0x461)](_0x16e33e,{'history':_0x3759f8,'collaboration':_0x3a8e7f});}};_0xacb853=_0x33054a([_0x216ee(0x0,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0x216ee(0x1,_0x560361[_0x5de549(0x37e)]),_0x216ee(0x2,_0x39304f['Inject'](_0x2abae2['DocStateChangeManagerService']))],_0xacb853);var _0x31e565=Object[_0x5de549(0x49f)],_0x523a3c=(_0x348d58,_0x4650b6,_0x5119a9,_0x47f61a)=>{const _0x5ec6a5=_0x5de549;for(var _0x6e6609=_0x47f61a>0x1?void 0x0:_0x47f61a?_0x31e565(_0x4650b6,_0x5119a9):_0x4650b6,_0x59d0df=_0x348d58[_0x5ec6a5(0x3b7)]-0x1,_0x2ad891;_0x59d0df>=0x0;_0x59d0df--)(_0x2ad891=_0x348d58[_0x59d0df])&&(_0x6e6609=_0x2ad891(_0x6e6609)||_0x6e6609);return _0x6e6609;},_0x70a35b=(_0x5b4eba,_0x42a892)=>(_0x187036,_0x26c230)=>_0x42a892(_0x187036,_0x26c230,_0x5b4eba);let _0x372ab3=class{constructor(_0x2477b5,_0x4e64cc){const _0x215a38=_0x5de549;this['_injector']=_0x2477b5,this[_0x215a38(0x403)]=_0x4e64cc;}[_0x5de549(0x33a)](_0x279231){const _0x4cc896=_0x5de549;var _0x4a012d;const _0x5b7d66=this[_0x4cc896(0x31d)][_0x4cc896(0x1c0)](_0x59af06[_0x4cc896(0x20c)]),_0x23f385=(_0x4a012d=_0x5b7d66['getDocRanges']())!=null?_0x4a012d:[];if(_0x23f385[_0x4cc896(0x3b7)]===0x0)return;const _0x4a8a0f=_0x279231[_0x4cc896(0x42f)],_0x4f0a48=[{'id':_0x4cc896(0x476),'params':{'unitId':_0x4a8a0f,'actions':null,'textRanges':_0x23f385}}],_0x49f637=this[_0x4cc896(0x403)]['transformMutationsWithChangeset'](_0x279231,_0x4f0a48);if(!_0x560361[_0x4cc896(0x2ce)](_0x49f637))throw _0x49f637['error'];const _0x24010c=_0x49f637[_0x4cc896(0x1e0)][0x0][_0x4cc896(0x448)][_0x4cc896(0x225)];Array[_0x4cc896(0x372)](_0x24010c)&&_0x24010c[_0x4cc896(0x3b7)]&&_0x5b7d66['replaceDocRanges'](_0x24010c,{'unitId':_0x4a8a0f,'subUnitId':_0x4a8a0f},!0x1);}};_0x372ab3=_0x523a3c([_0x70a35b(0x0,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0x70a35b(0x1,_0x560361[_0x5de549(0x37e)])],_0x372ab3);var _0x42e7e9=Object[_0x5de549(0x49f)],_0x1eb956=(_0x2f4774,_0x23a028,_0x284e45,_0x2ade7a)=>{const _0x514a23=_0x5de549;for(var _0x57d420=_0x2ade7a>0x1?void 0x0:_0x2ade7a?_0x42e7e9(_0x23a028,_0x284e45):_0x23a028,_0x26019d=_0x2f4774[_0x514a23(0x3b7)]-0x1,_0x29cd74;_0x26019d>=0x0;_0x26019d--)(_0x29cd74=_0x2f4774[_0x26019d])&&(_0x57d420=_0x29cd74(_0x57d420)||_0x57d420);return _0x57d420;},_0x23a64a=(_0x3e85bb,_0x439965)=>(_0x4c3a6f,_0x39596f)=>_0x439965(_0x4c3a6f,_0x39596f,_0x3e85bb);let _0x516750=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0xa203a5,_0x346642,_0xfd203f,_0x4ae842,_0x56b45b,_0x11cd3,_0x3d79de,_0x4a94bb){const _0x27f0ad=_0x5de549;super(),_0x41fabe(this,_0x27f0ad(0x2e8),new _0x404575[(_0x27f0ad(0x25b))](_0x3fe1f0[_0x27f0ad(0x329)]['NOT_COLLAB'])),(this[_0x27f0ad(0x3b1)]=_0xa203a5,this['_collaborationController']=_0x346642,this[_0x27f0ad(0x23e)]=_0xfd203f,this[_0x27f0ad(0x3e8)]=_0x4ae842,this['_docTransformSelectionsService']=_0x56b45b,this[_0x27f0ad(0x2ff)]=_0x11cd3,this['_messageService']=_0x3d79de,this['_localeService']=_0x4a94bb,this[_0x27f0ad(0x3cc)]());}[_0x5de549(0x3cc)](){const _0x10a33c=_0x5de549;this[_0x10a33c(0x24e)](this[_0x10a33c(0x1fd)][_0x10a33c(0x312)][_0x10a33c(0x38e)](_0x3445a6=>{const _0x4a5315=_0x10a33c,_0x15fce7=this['_docStateChangeManagerService'][_0x4a5315(0x30e)]['subscribe'](_0x5b8b55=>{const _0x47c270=_0x4a5315;if(_0x5b8b55==null)return;const {unitId:_0x471479,redoState:_0x20066d,commandId:_0x43a32a}=_0x5b8b55;if(_0x471479!==_0x3445a6[_0x47c270(0x42f)])return;const _0x47a486={'id':_0x43a32a,'type':_0x39304f[_0x47c270(0x208)][_0x47c270(0x397)],'params':{'unitId':_0x471479,'actions':_0x20066d[_0x47c270(0x42c)],'textRanges':null}};_0x3445a6[_0x47c270(0x1ea)](_0x47a486);});if(_0x3445a6[_0x4a5315(0x24e)](_0x15fce7),_0x3445a6 instanceof _0x3fe1f0[_0x4a5315(0x1ce)]){const _0x222696={'onTransformIME':_0x4d3723=>this[_0x4a5315(0x23e)][_0x4a5315(0x342)](_0x4d3723),'onTransformState':_0x6d6f9e=>this[_0x4a5315(0x3e8)][_0x4a5315(0x444)](_0x6d6f9e),'onTransformSelections':_0x3b1dae=>this['_docTransformSelectionsService'][_0x4a5315(0x33a)](_0x3b1dae),'onSyncEditingCollabCursor':_0x5cc744=>this['_docSyncEditingCollabCursorService'][_0x4a5315(0x3e0)](_0x5cc744),'onTransformRemoteChangesetByIMECache':_0x599616=>this['_docTransformIMECacheService'][_0x4a5315(0x46e)](_0x599616),'onTransformRemoteChangesetByStateCache':_0x4a3212=>this[_0x4a5315(0x3e8)][_0x4a5315(0x46e)](_0x4a3212)};_0x3445a6[_0x4a5315(0x3c9)](_0x222696);}}));}};_0x516750=_0x1eb956([_0x23a64a(0x0,_0x39304f[_0x5de549(0x356)](_0x2abae2[_0x5de549(0x48c)])),_0x23a64a(0x1,_0x39304f[_0x5de549(0x356)](_0x3fe1f0[_0x5de549(0x28d)])),_0x23a64a(0x2,_0x39304f['Inject'](_0x547126)),_0x23a64a(0x3,_0x39304f[_0x5de549(0x356)](_0xacb853)),_0x23a64a(0x4,_0x39304f[_0x5de549(0x356)](_0x372ab3)),_0x23a64a(0x5,_0x39304f['Inject'](_0x4c3a54)),_0x23a64a(0x6,_0x4c3b5c[_0x5de549(0x323)]),_0x23a64a(0x7,_0x39304f[_0x5de549(0x356)](_0x39304f['LocaleService']))],_0x516750);var _0x277c13=(_0xa63f82=>(_0xa63f82[_0xa63f82[_0x5de549(0x2ed)]=0x0]='UNDEFINED',_0xa63f82[_0xa63f82['OK']=0x1]='OK',_0xa63f82[_0xa63f82[_0x5de549(0x3a3)]=0x2]=_0x5de549(0x3a3),_0xa63f82[_0xa63f82[_0x5de549(0x43e)]=0x3]='PERMISSION_DENIED',_0xa63f82[_0xa63f82[_0x5de549(0x1bb)]=0x4]=_0x5de549(0x1bb),_0xa63f82[_0xa63f82[_0x5de549(0x306)]=0x5]=_0x5de549(0x306),_0xa63f82[_0xa63f82[_0x5de549(0x496)]=0x6]='ALREADY_EXISTS',_0xa63f82[_0xa63f82['INVALID_ARGUMENT']=0x7]=_0x5de549(0x3a2),_0xa63f82[_0xa63f82['TOO_MANY_REQUESTS']=0x8]=_0x5de549(0x331),_0xa63f82[_0xa63f82[_0x5de549(0x433)]=0x9]=_0x5de549(0x433),_0xa63f82[_0xa63f82['LOGIN_FAILED']=0xa]=_0x5de549(0x46d),_0xa63f82[_0xa63f82[_0x5de549(0x2da)]=0xb]='MOBILE_VERIFY_CODE_MISMATCH',_0xa63f82[_0xa63f82[_0x5de549(0x1d1)]=0xc]=_0x5de549(0x1d1),_0xa63f82[_0xa63f82['EMAIL_VERIFY_CODE_MISMATCH']=0xd]=_0x5de549(0x270),_0xa63f82[_0xa63f82[_0x5de549(0x1f9)]=0xe]='EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED',_0xa63f82[_0xa63f82[_0x5de549(0x1d3)]=0xf]=_0x5de549(0x1d3),_0xa63f82[_0xa63f82[_0x5de549(0x324)]=0x10]=_0x5de549(0x324),_0xa63f82[_0xa63f82[_0x5de549(0x379)]=0x64]=_0x5de549(0x379),_0xa63f82[_0xa63f82[_0x5de549(0x1c1)]=0x65]='ERROR_AGAIN',_0xa63f82[_0xa63f82[_0x5de549(0x445)]=0xc9]=_0x5de549(0x445),_0xa63f82[_0xa63f82[_0x5de549(0x40b)]=0xca]=_0x5de549(0x40b),_0xa63f82[_0xa63f82[_0x5de549(0x45d)]=0x1389]='CHANGESET_REVISION_CONFILICT',_0xa63f82[_0xa63f82[_0x5de549(0x499)]=0x1771]=_0x5de549(0x499),_0xa63f82[_0xa63f82[_0x5de549(0x1ed)]=0x1772]=_0x5de549(0x1ed),_0xa63f82[_0xa63f82[_0x5de549(0x491)]=0x1773]=_0x5de549(0x491),_0xa63f82[_0xa63f82[_0x5de549(0x25a)]=0x1b59]='APPLY_REJECT',_0xa63f82[_0xa63f82[_0x5de549(0x3bc)]=0x1b5a]=_0x5de549(0x3bc),_0xa63f82[_0xa63f82[_0x5de549(0x258)]=0x1b5b]='APPLY_REVISION_CONFILICT',_0xa63f82[_0xa63f82[_0x5de549(0x23c)]=0x1b5c]=_0x5de549(0x23c),_0xa63f82[_0xa63f82[_0x5de549(0x407)]=0x1b5d]=_0x5de549(0x407),_0xa63f82[_0xa63f82[_0x5de549(0x3aa)]=0x1f41]=_0x5de549(0x3aa),_0xa63f82[_0xa63f82['LICENSE_MAX_UNITS_EXCEEDED']=0x2329]='LICENSE_MAX_UNITS_EXCEEDED',_0xa63f82[_0xa63f82[_0x5de549(0x4a4)]=0x232a]=_0x5de549(0x4a4),_0xa63f82[_0xa63f82[_0x5de549(0x429)]=0x232b]='LICENSE_IMPORT_SIZE_EXCEEDED',_0xa63f82[_0xa63f82[_0x5de549(0x246)]=0x232c]='LICENSE_EXPORT_SIZE_EXCEEDED',_0xa63f82[_0xa63f82[_0x5de549(0x1ff)]=0x232d]='LICENSE_DISTRO_REJECTED',_0xa63f82[_0xa63f82[_0x5de549(0x2fc)]=0x2711]='YUUMI_UNABLE_LOAD_URL',_0xa63f82[_0xa63f82[_0x5de549(0x386)]=0x2712]=_0x5de549(0x386),_0xa63f82[_0xa63f82[_0x5de549(0x37b)]=0x2713]='YUUMI_RATE_OVER_LIMIT',_0xa63f82[_0xa63f82[_0x5de549(0x447)]=0x2714]=_0x5de549(0x447),_0xa63f82[_0xa63f82[_0x5de549(0x1d9)]=0x271a]=_0x5de549(0x1d9),_0xa63f82[_0xa63f82[_0x5de549(0x244)]=0x271b]='YUUMI_ASYNCIO_CANCELLED',_0xa63f82[_0xa63f82['YUUMI_TABLE_NOT_FOUND_IN_UNIT']=0x271c]='YUUMI_TABLE_NOT_FOUND_IN_UNIT',_0xa63f82[_0xa63f82[_0x5de549(0x2f0)]=0x271d]='YUUMI_ALL_TABLES_IS_INVALID',_0xa63f82[_0xa63f82[_0x5de549(0x3af)]=0x271e]=_0x5de549(0x3af),_0xa63f82[_0xa63f82['YUUMI_AI_RUN_FAILED']=0x271f]=_0x5de549(0x471),_0xa63f82[_0xa63f82[_0x5de549(0x494)]=0x2720]=_0x5de549(0x494),_0xa63f82[_0xa63f82[_0x5de549(0x36e)]=0x2af9]=_0x5de549(0x36e),_0xa63f82[_0xa63f82['INVITE_CODE_HAS_BEEN_UES']=0x2ee1]='INVITE_CODE_HAS_BEEN_UES',_0xa63f82[_0xa63f82[_0x5de549(0x2fa)]=0x2ee2]='INVALID_INVITE_CODE',_0xa63f82[_0xa63f82['INVITE_CODE_REQUIRED']=0x2ee3]=_0x5de549(0x235),_0xa63f82[_0xa63f82[_0x5de549(0x3c5)]=0x2ee4]=_0x5de549(0x3c5),_0xa63f82[_0xa63f82[_0x5de549(0x2ab)]=0x2ee5]=_0x5de549(0x2ab),_0xa63f82[_0xa63f82[_0x5de549(0x262)]=0x32c9]=_0x5de549(0x262),_0xa63f82[_0xa63f82[_0x5de549(0x3c2)]=0x32ca]=_0x5de549(0x3c2),_0xa63f82[_0xa63f82[_0x5de549(0x38c)]=0x32cb]=_0x5de549(0x38c),_0xa63f82[_0xa63f82[_0x5de549(0x209)]=0x36b1]='ENTITLE_CAN_NOT_BUY_LOWER_OTP',_0xa63f82[_0xa63f82[_0x5de549(0x274)]=0x36b2]=_0x5de549(0x274),_0xa63f82[_0xa63f82[_0x5de549(0x35d)]=0x36b3]=_0x5de549(0x35d),_0xa63f82[_0xa63f82[_0x5de549(0x3a9)]=0x36b4]='PAYMENT_CHANNEL_NOT_SUPPORT',_0xa63f82[_0xa63f82[_0x5de549(0x3ea)]=0x36b5]=_0x5de549(0x3ea),_0xa63f82[_0xa63f82[_0x5de549(0x35c)]=0x36b6]=_0x5de549(0x35c),_0xa63f82[_0xa63f82[_0x5de549(0x249)]=0x36b7]=_0x5de549(0x249),_0xa63f82[_0xa63f82[_0x5de549(0x2a7)]=0x36b8]=_0x5de549(0x2a7),_0xa63f82[_0xa63f82[_0x5de549(0x340)]=0x3715]=_0x5de549(0x340),_0xa63f82[_0xa63f82[_0x5de549(0x38b)]=0x3716]=_0x5de549(0x38b),_0xa63f82[_0xa63f82[_0x5de549(0x362)]=0x3717]='ENTITLE_INSUFFICIENT_QUOTA',_0xa63f82[_0xa63f82[_0x5de549(0x2b4)]=0x37dd]='ENTITLE_NEED_BILLING_ADDRESS',_0xa63f82[_0xa63f82[_0x5de549(0x3f6)]=0x3a99]=_0x5de549(0x3f6),_0xa63f82[_0xa63f82[_0x5de549(0x462)]=0x3a9a]='REDEMPTION_CODE_INACTIVE',_0xa63f82[_0xa63f82[_0x5de549(0x39a)]=0x3a9b]='REDEMPTION_CODE_FULLY_REDEEMED',_0xa63f82[_0xa63f82[_0x5de549(0x279)]=0x3a9c]=_0x5de549(0x279),_0xa63f82[_0xa63f82['REDEMPTION_USER_NOT_ELIGIBLE']=0x3a9d]=_0x5de549(0x284),_0xa63f82[_0xa63f82[_0x5de549(0x1df)]=0x3a9e]=_0x5de549(0x1df),_0xa63f82[_0xa63f82[_0x5de549(0x22b)]=0x3a9f]=_0x5de549(0x22b),_0xa63f82[_0xa63f82[_0x5de549(0x408)]=0x3e81]=_0x5de549(0x408),_0xa63f82[_0xa63f82[_0x5de549(0x426)]=-0x1]=_0x5de549(0x426),_0xa63f82))(_0x277c13||{});function _0x204ffd(_0x1aeb0b){const _0x5f5d38=_0x5de549;var _0x5f1f09,_0x2d4e76;const _0x4b47dd=(_0x5f1f09=_0x1aeb0b[_0x5f5d38(0x41a)])==null?void 0x0:_0x5f1f09[_0x5f5d38(0x1be)],_0x5c2619=((_0x2d4e76=_0x1aeb0b['stageInfo'])==null?void 0x0:_0x2d4e76[_0x5f5d38(0x355)])||0x0;return _0x4b47dd===_0x284237[_0x5f5d38(0x3f3)][_0x5f5d38(0x3a6)]&&_0x5c2619>0x0;}function _0x2be4ae(_0x5dbe80){const _0x18ab4f=_0x5de549;return _0x5dbe80['functionsExecutedState']===_0x284237[_0x18ab4f(0x21c)][_0x18ab4f(0x248)];}var _0x412897=Object[_0x5de549(0x49f)],_0x11c584=(_0x34f1b4,_0x87d016,_0x20889c,_0x48923a)=>{const _0x45afe6=_0x5de549;for(var _0x275158=_0x48923a>0x1?void 0x0:_0x48923a?_0x412897(_0x87d016,_0x20889c):_0x87d016,_0x21f6e0=_0x34f1b4[_0x45afe6(0x3b7)]-0x1,_0x40de39;_0x21f6e0>=0x0;_0x21f6e0--)(_0x40de39=_0x34f1b4[_0x21f6e0])&&(_0x275158=_0x40de39(_0x275158)||_0x275158);return _0x275158;},_0x56ccd2=(_0x17a95f,_0x264b58)=>(_0x229b07,_0x401e57)=>_0x264b58(_0x229b07,_0x401e57,_0x17a95f);const _0xdbcb5d=_0x5de549(0x416),_0x342981=_0x5de549(0x1d4),_0x4fe584=_0x5de549(0x1d0);let _0x2bfa89=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0xc45c9a,_0x5a8e7e,_0x5c4015,_0x9bc080,_0x26c66f,_0x1862f8,_0x266bfe){const _0x13e764=_0x5de549;super(),_0x41fabe(this,_0x13e764(0x29f),null),_0x41fabe(this,_0x13e764(0x27c),0x0),_0x41fabe(this,_0x13e764(0x467),0x0),_0x41fabe(this,_0x13e764(0x215),[]),_0x41fabe(this,_0x13e764(0x411),0x0),(this['_messageService']=_0xc45c9a,this[_0x13e764(0x33e)]=_0x5a8e7e,this[_0x13e764(0x20f)]=_0x5c4015,this[_0x13e764(0x40f)]=_0x9bc080,this[_0x13e764(0x26e)]=_0x26c66f,this['_logService']=_0x1862f8,this[_0x13e764(0x3c1)]=_0x266bfe,this[_0x13e764(0x3cd)]());}['_initCommandInterceptor'](){const _0x4ae39c=_0x5de549;this[_0x4ae39c(0x24e)](this['_commandService'][_0x4ae39c(0x259)]((_0x5c38ab,_0x5308fb)=>{const _0x11e224=_0x4ae39c;var _0x18f9ea;if(_0x5c38ab['id']!==_0x284237[_0x11e224(0x1b0)]['id'])return;const _0x3c812b=_0x5c38ab[_0x11e224(0x448)];if(!this[_0x11e224(0x1e7)]((_0x18f9ea=_0x3c812b[_0x11e224(0x2d9)])!=null?_0x18f9ea:[]))return;if(!this['_checkCalculationAvailable']())throw this['_checkAndWaitForCalculationPermission'](_0x5c38ab,_0x5308fb),this['_showGuardMessage'](),new _0x39304f[(_0x11e224(0x358))]();})),this[_0x4ae39c(0x24e)](this[_0x4ae39c(0x33e)][_0x4ae39c(0x2fd)]((_0x2ebb2b,_0x3cba68)=>{const _0x94105d=_0x4ae39c;if(_0x2ebb2b['id']!==_0x284237[_0x94105d(0x29a)]['id'])return;const _0x460af8=_0x2ebb2b['params'];if(_0x204ffd(_0x460af8)){const _0x19c934=_0x39304f[_0x94105d(0x26d)]();this[_0x94105d(0x215)]['push'](_0x19c934),this['_startCalculationLimit'](_0x19c934);}else{if(_0x2be4ae(_0x460af8)&&this[_0x94105d(0x215)][_0x94105d(0x3b7)]>0x0){const _0x57f7db=this[_0x94105d(0x215)]['shift']();this[_0x94105d(0x1f2)](_0x57f7db);}}}));}[_0x5de549(0x2c3)](){const _0x36d0b2=_0x5de549;super[_0x36d0b2(0x2c3)](),this['_clearPolling'](),this[_0x36d0b2(0x215)]=[],this['_currentUsage']=0x0,this[_0x36d0b2(0x27c)]=0x0,this[_0x36d0b2(0x411)]=0x0;}async[_0x5de549(0x28c)](_0x11193a,_0x4c158e){const _0x5b8513=_0x5de549;for(let _0x59a0a5=0x0;_0x59a0a5<0x1e;_0x59a0a5++)try{if(await this[_0x5b8513(0x341)](),this[_0x5b8513(0x44e)]()){this[_0x5b8513(0x227)](_0x11193a,_0x4c158e),this[_0x5b8513(0x22d)]['show']({'content':this[_0x5b8513(0x3c1)]['t'](_0x5b8513(0x3db)),'type':_0x31598f[_0x5b8513(0x242)][_0x5b8513(0x2bb)]});return;}await new Promise(_0x4a44ed=>{const _0x13a0c0=_0x5b8513;this[_0x13a0c0(0x29f)]=window['setTimeout'](_0x4a44ed,0x3e8);});}catch(_0x3ff704){this['_logService'][_0x5b8513(0x2ee)](_0x3ff704);}this[_0x5b8513(0x22d)][_0x5b8513(0x38d)]({'content':this[_0x5b8513(0x3c1)]['t'](_0x5b8513(0x1e2)),'type':_0x31598f[_0x5b8513(0x242)][_0x5b8513(0x385)]});}[_0x5de549(0x227)](_0x355d39,_0x32122a){const _0x1a302c=_0x5de549;try{this[_0x1a302c(0x33e)][_0x1a302c(0x275)](_0x355d39['id'],_0x355d39['params'],_0x32122a);}catch(_0x5673ae){this['_logService']['error'](_0x5673ae);}}[_0x5de549(0x314)](_0x4c56e0,_0x40933b){const _0x2f7308=_0x5de549;_0x40933b<this[_0x2f7308(0x411)]||(this[_0x2f7308(0x411)]=_0x40933b,this[_0x2f7308(0x27c)]=Number[_0x2f7308(0x435)](_0x4c56e0[_0x2f7308(0x44c)]),this['_currentUsage']=Number['parseInt'](_0x4c56e0[_0x2f7308(0x273)]));}async['_startCalculationLimit'](_0x360c93){const _0x38a34d=_0x5de549;var _0x1523eb,_0x114b81;const _0x36d26c=Date[_0x38a34d(0x48e)]();try{const _0x375feb=((_0x1523eb=this[_0x38a34d(0x20f)][_0x38a34d(0x47f)](_0x3fe1f0[_0x38a34d(0x4a3)]))==null?void 0x0:_0x1523eb['startFormulaLimitUrl'])||_0x342981,_0xb7f446=(await this[_0x38a34d(0x40f)][_0x38a34d(0x2b8)](_0x375feb,{'body':JSON[_0x38a34d(0x230)]({'taskId':_0x360c93})}))[_0x38a34d(0x20e)];if(((_0x114b81=_0xb7f446['error'])==null?void 0x0:_0x114b81[_0x38a34d(0x36c)])!==_0x277c13['OK'])return;this[_0x38a34d(0x314)](_0xb7f446[_0x38a34d(0x353)],_0x36d26c);}catch(_0x4faa4f){this[_0x38a34d(0x43a)][_0x38a34d(0x2ee)](_0x4faa4f);}}async[_0x5de549(0x341)](_0x459a7a){const _0x55499b=_0x5de549;var _0x36c0d9,_0x394628;const _0x43f0f6=Date[_0x55499b(0x48e)]();try{const _0x2d7397=((_0x36c0d9=this['_configService']['getConfig'](_0x3fe1f0['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']))==null?void 0x0:_0x36c0d9[_0x55499b(0x2ae)])||_0xdbcb5d,_0x4c147a=_0x459a7a?_0x2d7397+_0x55499b(0x29d)+encodeURIComponent(_0x459a7a):_0x2d7397,_0x51ba83=(await this[_0x55499b(0x40f)][_0x55499b(0x1c0)](_0x4c147a))['body'];if(((_0x394628=_0x51ba83['error'])==null?void 0x0:_0x394628['code'])!==_0x277c13['OK'])return;this[_0x55499b(0x314)](_0x51ba83['limitInfo'],_0x43f0f6);}catch(_0x3530c4){this[_0x55499b(0x43a)]['error'](_0x3530c4);}}async[_0x5de549(0x1f2)](_0x49b644){const _0x354f67=_0x5de549;var _0x353367,_0x4f4024;const _0x46a5c5=Date['now']();try{const _0x30c98e=((_0x353367=this[_0x354f67(0x20f)]['getConfig'](_0x3fe1f0[_0x354f67(0x4a3)]))==null?void 0x0:_0x353367[_0x354f67(0x223)])||_0x4fe584,_0x4a6b7a=(await this[_0x354f67(0x40f)]['post'](_0x30c98e,{'body':JSON[_0x354f67(0x230)]({'taskId':_0x49b644})}))[_0x354f67(0x20e)];if(((_0x4f4024=_0x4a6b7a[_0x354f67(0x2ee)])==null?void 0x0:_0x4f4024[_0x354f67(0x36c)])!==_0x277c13['OK'])return;this[_0x354f67(0x314)](_0x4a6b7a[_0x354f67(0x353)],_0x46a5c5);}catch(_0x23d8e4){this[_0x354f67(0x43a)]['error'](_0x23d8e4);}}[_0x5de549(0x44e)](){const _0x2eb8da=_0x5de549;return this[_0x2eb8da(0x27c)]===0x0?!0x0:this['_maxFormulaLimit']-this['_currentUsage']>0x0;}[_0x5de549(0x2bf)](){const _0x58d377=_0x5de549;this[_0x58d377(0x29f)]&&(clearTimeout(this['_pollingInterval']),this[_0x58d377(0x29f)]=null);}['_showGuardMessage'](){const _0x15b792=_0x5de549;this[_0x15b792(0x22d)][_0x15b792(0x38d)]({'content':this[_0x15b792(0x3c1)]['t'](_0x15b792(0x2ea)),'type':_0x31598f[_0x15b792(0x242)][_0x15b792(0x299)]});}[_0x5de549(0x1e7)](_0x59bac8){const _0x21cc59=_0x5de549;for(const _0x336633 of _0x59bac8){const {unitId:_0x2e15d4,sheetId:_0x36ec57,range:_0x335d5c}=_0x336633,_0x53da8e=this[_0x21cc59(0x26e)]['getUnit'](_0x2e15d4);if(!_0x53da8e)continue;const _0x4de68f=_0x53da8e[_0x21cc59(0x296)](_0x36ec57);if(!_0x4de68f)continue;const _0x1a79af=_0x4de68f[_0x21cc59(0x1f0)]();for(let _0x1894dd=_0x335d5c[_0x21cc59(0x1a7)];_0x1894dd<=_0x335d5c['endRow'];_0x1894dd++)for(let _0x2c7713=_0x335d5c[_0x21cc59(0x286)];_0x2c7713<=_0x335d5c[_0x21cc59(0x305)];_0x2c7713++){const _0x54b125=_0x1a79af[_0x21cc59(0x3fc)](_0x1894dd,_0x2c7713);if(_0x54b125&&(_0x39304f[_0x21cc59(0x37f)](_0x54b125['f'])||_0x39304f[_0x21cc59(0x43c)](_0x54b125['si'])))return!0x0;}}return!0x1;}};_0x2bfa89=_0x11c584([_0x56ccd2(0x0,_0x39304f[_0x5de549(0x356)](_0x4c3b5c[_0x5de549(0x323)])),_0x56ccd2(0x1,_0x39304f[_0x5de549(0x3bf)]),_0x56ccd2(0x2,_0x39304f[_0x5de549(0x205)]),_0x56ccd2(0x3,_0x39304f[_0x5de549(0x356)](_0x4e0fb2[_0x5de549(0x469)])),_0x56ccd2(0x4,_0x39304f[_0x5de549(0x2cc)]),_0x56ccd2(0x5,_0x39304f[_0x5de549(0x25e)]),_0x56ccd2(0x6,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x3f4)]))],_0x2bfa89);var _0x74e318=Object[_0x5de549(0x49f)],_0x4d192b=(_0x29401a,_0xe9a37f,_0x1c8c03,_0x16e567)=>{const _0x50a798=_0x5de549;for(var _0x276cec=_0x16e567>0x1?void 0x0:_0x16e567?_0x74e318(_0xe9a37f,_0x1c8c03):_0xe9a37f,_0x51dbb0=_0x29401a[_0x50a798(0x3b7)]-0x1,_0x19ff64;_0x51dbb0>=0x0;_0x51dbb0--)(_0x19ff64=_0x29401a[_0x51dbb0])&&(_0x276cec=_0x19ff64(_0x276cec)||_0x276cec);return _0x276cec;},_0x226814=(_0x243898,_0x35dc32)=>(_0x26824d,_0x267ea1)=>_0x35dc32(_0x26824d,_0x267ea1,_0x243898);let _0x1e23b0=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x53ae89,_0x30eed9,_0x7dbf61){const _0x40c75f=_0x5de549;super(),_0x41fabe(this,_0x40c75f(0x2df),new Map()),_0x41fabe(this,_0x40c75f(0x288),new Map()),_0x41fabe(this,'_disabled',!0x1),(this[_0x40c75f(0x20f)]=_0x53ae89,this[_0x40c75f(0x310)]=_0x30eed9,this['_revisionService']=_0x7dbf61);}[_0x5de549(0x42a)](){this['_disabled']=!0x0;}[_0x5de549(0x41c)](){const _0x379fb2=_0x5de549;this[_0x379fb2(0x1d6)]=!0x1;}get[_0x5de549(0x32c)](){const _0x3c8e27=_0x5de549;return this[_0x3c8e27(0x288)];}['dispose'](){const _0x3a3ac2=_0x5de549;this[_0x3a3ac2(0x34b)]()[_0x3a3ac2(0x2f8)](()=>super['dispose']());}async[_0x5de549(0x43b)](_0xa6dd78){const _0x5e49f8=_0x5de549;return this['_disabled']?null:this[_0x5e49f8(0x310)]['getItem'](_0x3fe1f0[_0x5e49f8(0x357)](_0xa6dd78));}async[_0x5de549(0x32f)](_0x15f1e6,_0x3e06a5){const _0x2adad1=_0x5de549;return!!this[_0x2adad1(0x310)][_0x2adad1(0x3ca)](_0x15f1e6,_0x3e06a5);}[_0x5de549(0x378)](_0x28549c,_0x303503,_0x27b3bc,_0x3914ae){const _0x2dcf15=_0x5de549,_0x217b03=this[_0x2dcf15(0x48b)][_0x2dcf15(0x303)](_0x28549c);this[_0x2dcf15(0x2df)]['set'](_0x28549c,{'unitID':_0x28549c,'type':_0x303503,'awaitingChangeset':_0x27b3bc,'mutations':_0x3914ae,'rev':_0x217b03}),this[_0x2dcf15(0x288)][_0x2dcf15(0x3f7)](_0x28549c)||this[_0x2dcf15(0x266)](_0x28549c);}[_0x5de549(0x266)](_0x42d18f){const _0x4c6d06=_0x5de549,_0x116b92=this[_0x4c6d06(0x294)]();_0x116b92===0x0?this[_0x4c6d06(0x34a)](_0x42d18f):this[_0x4c6d06(0x288)][_0x4c6d06(0x361)](_0x42d18f,setTimeout(()=>this['_saveCache'](_0x42d18f),_0x116b92));}[_0x5de549(0x294)](){const _0x4afe10=_0x5de549;var _0x2ad5df;return(_0x2ad5df=this[_0x4afe10(0x20f)][_0x4afe10(0x47f)](_0x3fe1f0[_0x4afe10(0x459)]))!=null?_0x2ad5df:_0x3fe1f0['LOCAL_CACHE_INTERVAL'];}[_0x5de549(0x34a)](_0x42be44){const _0x464e42=_0x5de549,_0x3c4ec2=this[_0x464e42(0x288)][_0x464e42(0x1c0)](_0x42be44);return _0x3c4ec2!==void 0x0&&window[_0x464e42(0x3e9)](_0x3c4ec2),this['_localStorageService'][_0x464e42(0x3ca)](_0x3fe1f0[_0x464e42(0x357)](_0x42be44),this[_0x464e42(0x2df)]['get'](_0x42be44))[_0x464e42(0x2f8)](()=>this[_0x464e42(0x288)]['delete'](_0x42be44));}async[_0x5de549(0x34b)](){const _0x3dda55=_0x5de549,_0x4db39a=[];this[_0x3dda55(0x288)][_0x3dda55(0x22a)]((_0x8fe20c,_0x3036df)=>{const _0x5539d0=_0x3dda55;window[_0x5539d0(0x3e9)](_0x8fe20c),_0x4db39a[_0x5539d0(0x44d)](this[_0x5539d0(0x34a)](_0x3036df)[_0x5539d0(0x2f8)](()=>{const _0x353b52=_0x5539d0;this[_0x353b52(0x288)][_0x353b52(0x421)](_0x3036df);}));}),await Promise[_0x3dda55(0x22e)](_0x4db39a);}};_0x1e23b0=_0x4d192b([_0x226814(0x0,_0x39304f[_0x5de549(0x205)]),_0x226814(0x1,_0x39304f[_0x5de549(0x1f1)]),_0x226814(0x2,_0x39304f['Inject'](_0x560361[_0x5de549(0x458)]))],_0x1e23b0);class _0x12ecfd extends _0x39304f[_0x5de549(0x423)]{constructor(){const _0x8ad5c4=_0x5de549;super(),_0x41fabe(this,_0x8ad5c4(0x322)),this['urlChange$']=_0x404575[_0x8ad5c4(0x2de)](window,_0x8ad5c4(0x3cf))[_0x8ad5c4(0x498)](_0x404575['takeUntil'](this[_0x8ad5c4(0x241)]),_0x404575['shareReplay'](0x1),_0x404575['mapTo'](void 0x0));}[_0x5de549(0x374)](_0x260e80,_0x5bbeac,_0x5ac81b=!0x1){const _0x23a40d=_0x5de549,_0x4f0936=new URL(window['location'][_0x23a40d(0x25d)]);_0x4f0936[_0x23a40d(0x3ce)][_0x23a40d(0x361)](_0x260e80,_0x5bbeac),_0x5ac81b?window[_0x23a40d(0x3be)][_0x23a40d(0x27e)]('','',_0x4f0936[_0x23a40d(0x492)]()):window['history'][_0x23a40d(0x3d0)]('','',_0x4f0936[_0x23a40d(0x492)]());}[_0x5de549(0x2b0)](_0x29f086,_0x1c05bc=!0x1){const _0x337c7c=_0x5de549,_0x5e228f=new URL(window['location'][_0x337c7c(0x25d)]);_0x5e228f[_0x337c7c(0x3ce)][_0x337c7c(0x421)](_0x29f086),_0x1c05bc?window[_0x337c7c(0x3be)][_0x337c7c(0x27e)]('','',_0x5e228f[_0x337c7c(0x492)]()):window['history']['pushState']('','',_0x5e228f['toString']());}[_0x5de549(0x350)](_0x59356f){const _0x535fde=_0x5de549;var _0x4fb76a;return(_0x4fb76a=new URL(window[_0x535fde(0x457)][_0x535fde(0x25d)])[_0x535fde(0x3ce)][_0x535fde(0x1c0)](_0x59356f))!=null?_0x4fb76a:void 0x0;}}var _0x393bbe=Object['defineProperty'],_0x5fc207=Object[_0x5de549(0x49f)],_0x3adff3=(_0x4b5892,_0x50c80b,_0xfaae4f)=>_0x50c80b in _0x4b5892?_0x393bbe(_0x4b5892,_0x50c80b,{'enumerable':!0x0,'configurable':!0x0,'writable':!0x0,'value':_0xfaae4f}):_0x4b5892[_0x50c80b]=_0xfaae4f,_0x53693c=(_0x1aa74c,_0x34dbf7,_0xc7596e,_0x5bfe0f)=>{const _0x44c64a=_0x5de549;for(var _0x56ef79=_0x5bfe0f>0x1?void 0x0:_0x5bfe0f?_0x5fc207(_0x34dbf7,_0xc7596e):_0x34dbf7,_0x28b8fb=_0x1aa74c[_0x44c64a(0x3b7)]-0x1,_0x56626a;_0x28b8fb>=0x0;_0x28b8fb--)(_0x56626a=_0x1aa74c[_0x28b8fb])&&(_0x56ef79=_0x56626a(_0x56ef79)||_0x56ef79);return _0x56ef79;},_0x13208c=(_0x38cded,_0x35fbe9)=>(_0x184873,_0x21a03e)=>_0x35fbe9(_0x184873,_0x21a03e,_0x38cded),_0x4c9030=(_0x2b51a4,_0x345a2f,_0x4596cf)=>_0x3adff3(_0x2b51a4,_0x345a2f+'',_0x4596cf);const _0x1dade5=_0x5de549(0x267);_0x44b1a7['UniverCollaborationClientUIPlugin']=class extends _0x39304f[_0x5de549(0x41d)]{constructor(_0x4ff6f7=_0x469697,_0x11c5b3,_0x3b87c3,_0xace2cd){const _0x2c1a5f=_0x5de549;super(),this[_0x2c1a5f(0x2cb)]=_0x4ff6f7,this[_0x2c1a5f(0x349)]=_0x11c5b3,this[_0x2c1a5f(0x31d)]=_0x3b87c3,this[_0x2c1a5f(0x20f)]=_0xace2cd;const {..._0x3e1a9a}=_0x39304f[_0x2c1a5f(0x394)]({},_0x469697,this[_0x2c1a5f(0x2cb)]);this[_0x2c1a5f(0x20f)]['setConfig'](_0x13b4e5,_0x3e1a9a);}[_0x5de549(0x3ef)](){this['_registerDependencies'](),this['_initDependencies']();}[_0x5de549(0x238)](){this['_registerRenderDependencies']();}[_0x5de549(0x1ac)](){const _0x2fa01c=_0x5de549;var _0x1eef1a;const _0x54a336=[[_0x34f587],[_0x2bfa89],[_0x372ab3],[_0x547126],[_0xacb853],[_0x4c3a54],[_0x4d8922,{'useClass':_0x12ecfd}],[_0x4e0fb2[_0x2fa01c(0x43f)],{'useClass':_0x4e0fb2[_0x2fa01c(0x236)]}],[_0x3fe1f0[_0x2fa01c(0x443)],{'useClass':_0x1e23b0}],[_0x44b1a7[_0x2fa01c(0x319)]],[_0x516750],[_0x261734],[_0x1af4cc],[_0x171e0f],[_0x44b1a7[_0x2fa01c(0x315)]]];this['_config'][_0x2fa01c(0x455)]&&_0x54a336['push']([_0x33fdc9]),_0x39304f[_0x2fa01c(0x1c4)](this['_injector'],_0x39304f[_0x2fa01c(0x1fa)](_0x54a336,(_0x1eef1a=this[_0x2fa01c(0x2cb)])==null?void 0x0:_0x1eef1a[_0x2fa01c(0x1a8)]));}[_0x5de549(0x398)](){const _0x1d16a1=_0x5de549;this['disposeWithMe'](this[_0x1d16a1(0x349)][_0x1d16a1(0x390)](_0x39304f[_0x1d16a1(0x1cf)][_0x1d16a1(0x418)],[_0x43034b])),this[_0x1d16a1(0x24e)](this[_0x1d16a1(0x349)][_0x1d16a1(0x390)](_0x39304f[_0x1d16a1(0x1cf)][_0x1d16a1(0x211)],[_0x338784]));}[_0x5de549(0x1f4)](){const _0x2555f0=_0x5de549;_0x39304f[_0x2555f0(0x452)](this[_0x2555f0(0x31d)],[[_0x1af4cc],[_0x44b1a7[_0x2555f0(0x319)]],[_0x516750],[_0x261734],[_0x44b1a7[_0x2555f0(0x315)]],[_0x2bfa89]]),this['_config'][_0x2555f0(0x455)]&&_0x39304f['touchDependencies'](this[_0x2555f0(0x31d)],[[_0x33fdc9]]);}},_0x4c9030(_0x44b1a7['UniverCollaborationClientUIPlugin'],'pluginName',_0x1dade5),_0x44b1a7[_0x5de549(0x21b)]=_0x53693c([_0x39304f[_0x5de549(0x3e1)](_0x3fe1f0[_0x5de549(0x1ab)]),_0x13208c(0x1,_0x46a3bd[_0x5de549(0x334)]),_0x13208c(0x2,_0x39304f[_0x5de549(0x356)](_0x39304f[_0x5de549(0x2bd)])),_0x13208c(0x3,_0x39304f[_0x5de549(0x205)])],_0x44b1a7[_0x5de549(0x21b)]);var _0xc03d57=Object[_0x5de549(0x49f)],_0x1b004e=(_0x3df999,_0x5d5603,_0x25f6bb,_0x4ccd40)=>{for(var _0xfa5ea5=_0x4ccd40>0x1?void 0x0:_0x4ccd40?_0xc03d57(_0x5d5603,_0x25f6bb):_0x5d5603,_0x30cae6=_0x3df999['length']-0x1,_0x1dbfe6;_0x30cae6>=0x0;_0x30cae6--)(_0x1dbfe6=_0x3df999[_0x30cae6])&&(_0xfa5ea5=_0x1dbfe6(_0xfa5ea5)||_0xfa5ea5);return _0xfa5ea5;},_0x3ee60e=(_0x217cb7,_0x14f25e)=>(_0x5c2b3e,_0x31fa64)=>_0x14f25e(_0x5c2b3e,_0x31fa64,_0x217cb7);_0x44b1a7['BrowserCollaborationSocketService']=class extends _0x3fe1f0['CollaborationSocketService']{constructor(_0x355588,_0x5ef208,_0x30a48a,_0x12a4e8,_0x10b2bd){super(_0x355588,_0x5ef208,_0x30a48a,_0x12a4e8,_0x10b2bd);}async[_0x5de549(0x1c8)](_0x519145){const _0x12df93=_0x5de549,_0x5347c1=await this['_getSessionTicket'](),_0x582d17=this[_0x12df93(0x3a7)](_0x519145,_0x5347c1);return this[_0x12df93(0x1f5)](_0x582d17);}['_createSocketURL'](_0xbc9b45,_0x5ade35){const _0x546c21=_0x5de549,_0x2f90a0=typeof window>'u'?new URL(_0xbc9b45):new URL(_0xbc9b45,window[_0x546c21(0x457)]['origin']);_0x2f90a0[_0x546c21(0x3ce)]['set'](_0x546c21(0x1ee),_0x5ade35);const _0x408a83=typeof window>'u'?new URLSearchParams():new URLSearchParams(window['location'][_0x546c21(0x48d)]);return _0x408a83[_0x546c21(0x1c0)](_0x546c21(0x428))&&_0x2f90a0[_0x546c21(0x3ce)][_0x546c21(0x361)](_0x546c21(0x428),_0x408a83[_0x546c21(0x1c0)](_0x546c21(0x428))),_0x2f90a0['toString']();}async[_0x5de549(0x2bc)](){const _0x487afd=_0x5de549;var _0x2d2241,_0x4de4fc,_0x4cb55c;const _0x3b8ae0=this[_0x487afd(0x20f)][_0x487afd(0x47f)](_0x3fe1f0['COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY']),_0x283e1d=(_0x2d2241=_0x3b8ae0==null?void 0x0:_0x3b8ae0['wsSessionTicketUrl'])!=null?_0x2d2241:_0x3fe1f0[_0x487afd(0x1f7)];return(_0x4cb55c=(_0x4de4fc=(await this[_0x487afd(0x40f)][_0x487afd(0x1c0)](_0x283e1d,{'headers':{'Content-Type':_0x487afd(0x466)}}))[_0x487afd(0x20e)])==null?void 0x0:_0x4de4fc['ticket'])!=null?_0x4cb55c:'';}},_0x44b1a7['BrowserCollaborationSocketService']=_0x1b004e([_0x3ee60e(0x0,_0x39304f['Inject'](_0x39304f['Injector'])),_0x3ee60e(0x1,_0x39304f[_0x5de549(0x356)](_0x4e0fb2[_0x5de549(0x469)])),_0x3ee60e(0x2,_0x39304f['IConfigService']),_0x3ee60e(0x3,_0x39304f[_0x5de549(0x25e)]),_0x3ee60e(0x4,_0x560361[_0x5de549(0x4a8)])],_0x44b1a7[_0x5de549(0x3dc)]);var _0x596e83=Object[_0x5de549(0x49f)],_0xe44d28=(_0x531ff5,_0x2dac1b,_0x4d96ec,_0x52ec5e)=>{const _0x52d9e3=_0x5de549;for(var _0x4aae2f=_0x52ec5e>0x1?void 0x0:_0x52ec5e?_0x596e83(_0x2dac1b,_0x4d96ec):_0x2dac1b,_0x27e07e=_0x531ff5[_0x52d9e3(0x3b7)]-0x1,_0x4014d1;_0x27e07e>=0x0;_0x27e07e--)(_0x4014d1=_0x531ff5[_0x27e07e])&&(_0x4aae2f=_0x4014d1(_0x4aae2f)||_0x4aae2f);return _0x4aae2f;},_0x2b5778=(_0x225c71,_0x518d67)=>(_0x45ba7b,_0x28f9cd)=>_0x518d67(_0x45ba7b,_0x28f9cd,_0x225c71);_0x44b1a7[_0x5de549(0x446)]=class extends _0x39304f[_0x5de549(0x1ba)]{constructor(_0x1694d9,_0x36112b,_0x536998){const _0x509258=_0x5de549;super(),this['_instanceService']=_0x1694d9,this[_0x509258(0x40f)]=_0x36112b,this[_0x509258(0x20f)]=_0x536998;}async[_0x5de549(0x395)](_0x2addc0,_0x16ee4c,_0x302d1b,..._0x53ef91){const _0x3d8e43=_0x5de549;var _0xe08d3d,_0x12e47d,_0x53d692,_0x285287;const _0x48e4c2=this['_instanceService'][_0x3d8e43(0x3ae)]();if(!_0x48e4c2)throw new Error(_0x3d8e43(0x49d));const _0x4ceca7=((_0xe08d3d=this[_0x3d8e43(0x20f)][_0x3d8e43(0x47f)](_0x3fe1f0['REMOTE_UNISCRIPT_EXECUTION_ENDPOINT_KEY']))!=null?_0xe08d3d:_0x3fe1f0['DEFAULT_REMOTE_UNISCRIPT_EXECUTION_ENDPOINT'])+'/'+_0x2addc0+_0x3d8e43(0x2a4)+_0x16ee4c,_0x19e7e3=new URL(window['location']['href']),_0x4abfb9={'scriptId':_0x2addc0,'runId':(_0x12e47d=_0x19e7e3[_0x3d8e43(0x3ce)][_0x3d8e43(0x1c0)](_0x3d8e43(0x428)))!=null?_0x12e47d:'','function':_0x16ee4c,'unitId':_0x48e4c2[_0x3d8e43(0x41e)](),'argsOfFunction':JSON['stringify'](_0x53ef91),'invokeId':(_0x53d692=_0x302d1b[_0x3d8e43(0x49c)])!=null?_0x53d692:'','executionId':(_0x285287=_0x302d1b[_0x3d8e43(0x3b5)])!=null?_0x285287:''};try{const _0x318230=await this[_0x3d8e43(0x40f)][_0x3d8e43(0x2b8)](_0x4ceca7,{'body':_0x4abfb9});return _0x318230['body']['error']&&_0x318230[_0x3d8e43(0x20e)][_0x3d8e43(0x2ee)]['code']!==_0x277c13['OK']?'Failed':_0x318230['body'][_0x3d8e43(0x3e5)];}catch{return'Failed';}}},_0x44b1a7['RemoteUniscriptService']=_0xe44d28([_0x2b5778(0x0,_0x39304f[_0x5de549(0x2cc)]),_0x2b5778(0x1,_0x39304f[_0x5de549(0x356)](_0x4e0fb2['HTTPService'])),_0x2b5778(0x2,_0x39304f[_0x5de549(0x205)])],_0x44b1a7[_0x5de549(0x446)]);const _0x13780e=0x7530,_0x3e2726=_0x5de549(0x1f8);class _0x55eb3c extends _0x39304f[_0x5de549(0x1ba)]{constructor(){const _0x46c6b3=_0x5de549;super(),_0x41fabe(this,_0x46c6b3(0x2c8),_0x39304f[_0x46c6b3(0x26d)]()),_0x41fabe(this,_0x46c6b3(0x39f),new Set()),_0x41fabe(this,_0x46c6b3(0x437),new Map()),_0x41fabe(this,_0x46c6b3(0x3f8),null),_0x41fabe(this,_0x46c6b3(0x2eb),new Map()),_0x41fabe(this,'_unitStatus',new Map()),this['_init']();}[_0x5de549(0x2c3)](){const _0x44108d=_0x5de549;super[_0x44108d(0x2c3)](),this[_0x44108d(0x2eb)][_0x44108d(0x22a)]((_0x298182,_0x4ce0b5)=>this[_0x44108d(0x26b)](_0x4ce0b5)),this[_0x44108d(0x3f8)]&&window[_0x44108d(0x24d)](this[_0x44108d(0x3f8)]);}[_0x5de549(0x332)](_0x461314){const _0x1d7467=_0x5de549;return this[_0x1d7467(0x32a)](_0x461314)[_0x1d7467(0x498)](_0x404575[_0x1d7467(0x393)]());}[_0x5de549(0x42b)](_0x303a47){const _0x1aa934=_0x5de549;this['_selfUnitIDs']['size']===0x0&&this['_scheduleHeartbeat'](),this['_selfUnitIDs'][_0x1aa934(0x26c)](_0x303a47),this[_0x1aa934(0x373)]({'type':0x0,'memberID':this[_0x1aa934(0x2c8)],'unitIDs':[_0x303a47],'isForwarded':!0x1});}['disposeUnit'](_0x2182bb){const _0x47ca30=_0x5de549;this[_0x47ca30(0x39f)][_0x47ca30(0x421)](_0x2182bb),this['_selfUnitIDs'][_0x47ca30(0x1ae)]===0x0&&this[_0x47ca30(0x3f8)]&&window['clearInterval'](this[_0x47ca30(0x3f8)]);}[_0x5de549(0x48f)](){const _0x161035=_0x5de549;this['disposeWithMe'](_0x39304f[_0x161035(0x391)](_0x404575[_0x161035(0x2de)](window,_0x161035(0x3dd))['subscribe'](_0x2e1448=>{const _0x586850=_0x161035;if(_0x2e1448[_0x586850(0x1aa)]!==_0x3e2726||!_0x2e1448[_0x586850(0x32b)])return;const _0x11d679=JSON[_0x586850(0x48a)](_0x2e1448['newValue']);this[_0x586850(0x495)](_0x11d679);}))),window[_0x161035(0x34d)](_0x161035(0x226),()=>this['_send']({'type':0x1,'memberID':this['_id'],'unitIDs':Array[_0x161035(0x1bf)](this[_0x161035(0x39f)])}));}[_0x5de549(0x495)](_0x20dfc4){const _0x53e8eb=_0x5de549;switch(_0x20dfc4['type']){case 0x0:this[_0x53e8eb(0x36b)](_0x20dfc4);break;case 0x1:this[_0x53e8eb(0x347)](_0x20dfc4);break;case 0x2:this[_0x53e8eb(0x32d)](_0x20dfc4);break;}}[_0x5de549(0x36b)](_0x28512c){const _0x3fc83a=_0x5de549,{unitIDs:_0x3f2d64,memberID:_0x3d4b1f,isForwarded:_0x3d43ef}=_0x28512c;_0x3f2d64[_0x3fc83a(0x22a)](_0x17cdea=>{const _0x14bf4a=_0x3fc83a;if(!_0x3d43ef&&this[_0x14bf4a(0x437)][_0x14bf4a(0x3f7)](_0x17cdea)&&this[_0x14bf4a(0x32a)](_0x17cdea)[_0x14bf4a(0x345)](_0x3fe1f0[_0x14bf4a(0x1e8)][_0x14bf4a(0x237)]),!this[_0x14bf4a(0x437)][_0x14bf4a(0x3f7)](_0x17cdea)||!this[_0x14bf4a(0x437)][_0x14bf4a(0x1c0)](_0x17cdea)['has'](_0x3d4b1f)){const _0x3355ab=this[_0x14bf4a(0x437)][_0x14bf4a(0x1c0)](_0x17cdea)||new Set();_0x3355ab[_0x14bf4a(0x26c)](_0x3d4b1f),this[_0x14bf4a(0x437)][_0x14bf4a(0x361)](_0x17cdea,_0x3355ab),this['_scheduleClearOtherTimer'](_0x3d4b1f);}}),_0x3d43ef||this[_0x3fc83a(0x373)]({'type':0x0,'memberID':this['_id'],'unitIDs':[...this[_0x3fc83a(0x39f)]],'isForwarded':!0x0});}['_scheduleClearOtherTimer'](_0x275457){const _0xd48f44=_0x5de549;this[_0xd48f44(0x26b)](_0x275457);const _0x75ff0b=window[_0xd48f44(0x338)](()=>{const _0x178dd7=_0xd48f44;this[_0x178dd7(0x437)][_0x178dd7(0x22a)](_0x1c34c5=>{_0x1c34c5['delete'](_0x275457);});},_0x13780e*0x2);this['_clearOtherTimers'][_0xd48f44(0x361)](_0x275457,_0x75ff0b);}[_0x5de549(0x26b)](_0x3f8741){const _0x12bb70=_0x5de549;if(this[_0x12bb70(0x2eb)][_0x12bb70(0x3f7)](_0x3f8741)){const _0x34a8e3=this['_clearOtherTimers']['get'](_0x3f8741);_0x34a8e3&&window[_0x12bb70(0x3e9)](_0x34a8e3),this[_0x12bb70(0x2eb)][_0x12bb70(0x361)](_0x3f8741,null);}}[_0x5de549(0x347)](_0xaa8649){const _0x578c32=_0x5de549,{memberID:_0x2f97ec,unitIDs:_0x178157}=_0xaa8649;_0x178157['forEach'](_0x577486=>{const _0x5702f4=_0x48a1;var _0x55b5c4;const _0x296cd4=this['_unitOnClients'][_0x5702f4(0x1c0)](_0x577486);_0x296cd4&&(_0x296cd4[_0x5702f4(0x421)](_0x2f97ec),(_0x55b5c4=this[_0x5702f4(0x32a)](_0x577486))==null||_0x55b5c4[_0x5702f4(0x345)](_0x296cd4['size']===0x0?_0x3fe1f0['UnitStatus'][_0x5702f4(0x449)]:_0x3fe1f0['UnitStatus']['OTHER_CLIENTS_EDITING']));}),this[_0x578c32(0x26b)](_0x2f97ec);}[_0x5de549(0x32d)](_0x3f05f4){const _0x20f25b=_0x5de549;this[_0x20f25b(0x2d8)](_0x3f05f4[_0x20f25b(0x210)]);}[_0x5de549(0x373)](_0x5a0ca5){localStorage['setItem'](_0x3e2726,JSON['stringify'](_0x5a0ca5));}[_0x5de549(0x41b)](){const _0x206322=_0x5de549;this[_0x206322(0x3f8)]=window[_0x206322(0x37c)](()=>{this['_send']({'type':0x2,'memberID':this['_id']});},_0x13780e);}[_0x5de549(0x32a)](_0x531b08){const _0x291cd1=_0x5de549;return this[_0x291cd1(0x1a9)][_0x291cd1(0x3f7)](_0x531b08)||this['_unitStatus'][_0x291cd1(0x361)](_0x531b08,new _0x404575['BehaviorSubject'](_0x3fe1f0[_0x291cd1(0x1e8)]['NO_OTHER_CLIENTS_EDITING'])),this[_0x291cd1(0x1a9)][_0x291cd1(0x1c0)](_0x531b08);}}_0x44b1a7[_0x5de549(0x26a)]=_0x4d8922,_0x44b1a7[_0x5de549(0x44f)]=_0x3ed0a,_0x44b1a7[_0x5de549(0x474)]=_0x55eb3c,_0x44b1a7[_0x5de549(0x2d0)]=_0x12ecfd,Object[_0x5de549(0x412)](_0x44b1a7,Symbol[_0x5de549(0x36d)],{'value':'Module'});}));function _0x48a1(_0x3ec77b,_0x2f799c){_0x3ec77b=_0x3ec77b-0x1a4;const _0xe03509=_0xe035();let _0x48a183=_0xe03509[_0x3ec77b];return _0x48a183;}function _0xe035(){const _0x514721=['getColor','bottom','_id','_scene','UniverCore','_config','IUniverInstanceService','AWAITING','isTransformMutationsWithChangesetSuccess','_collaborationSessionService','WebURLService','filename','_range','TEXT_RANGE_LAYER_INDEX','complete','requireSession','38uXbool','[LogService\x20Error]:\x20','_scheduleClearOtherTimer','dirtyRanges','MOBILE_VERIFY_CODE_MISMATCH','UPDATE_CURSOR','event$','getUndoRedoMutationParamsCache','fromEvent','_cachedData','univer-flex\x20univer-items-center','getActiveSheet','AWAITING_WITH_PENDING','IUIPartsService','UniverDocsUi','RegularPolygon','_localCacheService','FromArray','_status$','rxjs','formula.calculation.waiting','_clearOtherTimers','_drawAnchor','UNDEFINED','error','FETCH_MISS','YUUMI_ALL_TABLES_IS_INVALID','isEditing','onPointerEnter$','path','RichTextEditingMutation','1em','operators','EffectRefRangId','then','getCurrentSelections','INVALID_INVITE_CODE','unitId','YUUMI_UNABLE_LOAD_URL','onCommandExecuted','@univerjs/rpc','_docSyncEditingCollabCursorService','IImageIoService','substring','getColorFromTheme','getCurrentRevOfUnit','imageSourceType','endColumn','UNAUTHENTICATED','setAlpha','getSheetId','map','_uiPartsService','DocSkeletonManagerService','colorChannel1','getSkeleton','docStateChange$','IBeforeCloseService','_localStorageService','@univerjs/sheets-ui','entityInit$','use','_setFormulaLimitStatus','CollaborationDataLoaderController','min','_docSkeletonManagerService','currentSkeleton$','DesktopCollaborationStatusDisplayController','activeSheet$','fillStyle','_dataLoaderService','_injector','collaboration.closeRoom','0\x200\x2016\x2016','restore','_urlService','urlChange$','IMessageService','LOGIN_TOKEN_PROCESSING_FAILED','DisposableCollection','CLOSE_ROOM','OFFLINE','type','CollaborationStatus','_ensureSubject','newValue','saveTaskMap','_handleHeartbeatEvent','triggerDblclick','saveOfflineData','subUnitId','TOO_MANY_REQUESTS','getUnitStatus$','_themeService','IRenderManagerService','getCurrent','idSuffix','UniverSheets','setTimeout','_handleHover','transformSelections','SetSelectionsOperation','useObservable','CollaborationUIEventId','_commandService','_context','ENTITLE_CHAT_LIMIT_EXCEED','_getFormulaLimitStatus','transformIMECache','_initUnhandledRejectionListener','_docSkeleton','next','_onCursorDelete','_handleLeaveEvent','_render','_renderManagerService','_saveCache','exhaustSavingTask','sessionStatus$','addEventListener','_toggleOnline','some','getParam','connectInjector','OTHER_CLIENT_EDITING','limitInfo','_startDocCollabCursor','totalFormulasToCalculate','Inject','getLocalCacheKey','CanceledError','div','3542600xJygBe','fillText','ENTITLE_COUPON_EXPIRED','ENTITLE_DUP_SUBSCRIPTION','roomMembers$','_cursorInfo$','_entities','set','ENTITLE_INSUFFICIENT_QUOTA','PENDING','getTypeOfUnitAdded$','getCoordByCell','SheetSkeletonManagerService','row','selection','_removeCollabCursors','_backgroundColor','_handleJoinEvent','code','toStringTag','PY_RUNTIME_SCRIPT_ERROR','...','Warning','@univerjs-pro/collaboration','isArray','_send','setParam','M0\x200H16V16H0z','_roomMembers$','collaboration.single-unit.warning','updateOfflineData','CURRENT_STATUS_CANNOT_OPERATE','InsertRangeMoveRightCommandId','YUUMI_RATE_OVER_LIMIT','setInterval','transformMutation','ITransformService','isFormulaString','selections','height','currentTheme$','whenReady','_monkeyPatchLogService','Error','YUUMI_URL_COL_OUT_OF_RANGE','takeUntil','measureText','url(#off-line-icon_clip0_910_343)','NodePositionConvertToCursor','ENTITLE_REPORT_LIMIT_EXCEED','EMAIL_HAS_BEEN_BOUND','show','subscribe','setUndoRedoMutationParamsCache','registerRenderModule','toDisposable','white','distinctUntilChanged','merge','runOnServer','IDocClipboardService','MUTATION','_registerRenderDependencies','6XetXdA','REDEMPTION_CODE_FULLY_REDEEMED','collaboration.offline-data-not-saved','Rect','TRANSFORM_CHANGE_OBSERVABLE_TYPE','_initUserListener','_selfUnitIDs','ranges','getOffsetConfig','INVALID_ARGUMENT','INTERNAL_ERROR','_lastPointer','getCollabEntity$','START_CALCULATION','_createSocketURL','_assignedColors','PAYMENT_CHANNEL_NOT_SUPPORT','CONNECTOR_DATA_TOO_LARGE','deepClone','collab-rect-range-','CONFLICT','getFocusedUnit','YUUMI_PROMPT_MAX_TOKENS_EXCEEDED','join','_docStateChangeManagerService','startsWith','@univerjs/drawing','\x20at\x20','executionId','uni.network.url-service','length','_drawRectRange','SHEET_VIEWPORT_KEY','getMergeData','round','APPLY_NON_SEQUENTIAL_REVISION','displayName','history','ICommandService','_cursorShapes','_localeService','MOBILE_HAS_BEEN_BOUND','drawWith','transformMutationsWithChangeset','USER_NOT_INVITED_CODE','bind','unit','_anchorDot','addHandlerCallback','setItem','url(#$1','_initEntityListener','_initCommandInterceptor','searchParams','popstate','pushState','useDependency','Tooltip','off-line-icon','_beforeCloseService','handleIRemoveRow','width','cursorInfo','saveImage','exports','getAncestorScale','formula.calculation.started','BrowserCollaborationSocketService','storage','COLORS','_setupSubUnitSync','syncEditingCollabCursor','DependentOn','setShapeProps','xlink:href','UniverDrawing','result','_draw','_entityInit$','_docTransformStateCacheService','clearTimeout','ENTITLE_INVALID_COUPON_CODE','getCollabCursors$','off-line-icon_clip0_910_343','React','handleDeleteRangeMoveUp','onStarting','toRgbString','transformByState','eventID','FormulaExecuteStageType','LocaleService','MemberService','REDEMPTION_INVALID_CODE','has','_heartbeatTimer','subscribeEvent','_getScale','throttleTime','getValue','isTransformMutationFailure','evenodd','onPointerMove$','entries','/universer-api/frontend/logs','fill','_transformService','mutations','UniverNetwork','16806gYtOTL','APPLY_DUPLICATED','DATA_SOURCE_TOO_LARGE','clsx','_cursor','USER_IS_ANONYMOUS','registerComponent','HEADER_MENU','MoveRangeCommandId','_httpService','includes','_lastResponseTimestamp','defineProperty','_memberService','getTypeOfUnitDisposed$','getSheetObject','/universer-api/license/formula/limit/status','defIds','UNIVER_DOC','InsertColCommandId','stageInfo','_scheduleHeartbeat','enableLocalCache','Plugin','getUnitId','socket$','blue.400','delete','_session','RxDisposable','rxjs/operators','getRelativeToViewportCoord','UNRECOGNIZED','react/jsx-runtime','runId','LICENSE_IMPORT_SIZE_EXCEEDED','disableLocalCache','editingUnit','actions','getRangePointData','backgroundColor','unitID','_toggleOffline','DOC_RANGE_TYPE','_refRangeService','COMPLETION_FINISHED','SessionStatus','parseInt','_color','_unitOnClients','3582780XfDNln','@univerjs/docs','_logService','loadOfflineData','isFormulaId','ONLINE','PERMISSION_DENIED','ISocketService','_getSheetObject','_initResize','_drawTextRange','ILocalCacheService','transformStateCache','USER_NOT_FOUND','RemoteUniscriptService','YUUMI_SUBSCRIPTION_NOT_FOUND','params','NO_OTHER_CLIENTS_EDITING','contains','_onCursorUpdate','maxFormulaLimit','push','_checkCalculationAvailable','SheetCollabCursorShape','univerjs-icon\x20univerjs-icon-','Shape','touchDependencies','isActive','attrs','enableFrontendLog','_updateSubUnitFromURLParams','location','RevisionService','LOCAL_CACHE_INTERVAL_KEY','_syncEditingCollabCursorService','debug','_uploadLog','CHANGESET_REVISION_CONFILICT','createElement','arc','jsx','setStateCache','REDEMPTION_CODE_INACTIVE','defs','getActiveRange','_hideTimer','application/json','_currentUsage','addObject','HTTPService','currentColor','_getAnchorBounding','random','LOGIN_FAILED','transformRemoteChangeset','split','lineTo','YUUMI_AI_RUN_FAILED','_startSheetCollabCursor','_imageIoService','WebBrowserSingleActiveUnitService','NOT_COLLAB','doc.mutation.rich-text-editing','color','on-line-icon','findNodePositionByCharIndex','catch','UniverDocs','_name','_eventUnsubscribe','removeEventListener','getConfig','jiqing.500','yellow.400','init','tag','debounce','sheetID','_collabCursorState$','IRemoteInstanceService','SetTextSelectionsOperation','univer-text-sm\x20univer-leading-8\x20univer-text-gray-600\x20dark:!univer-text-gray-200','parse','_revisionService','DocStateChangeManagerService','search','now','_init','Unknown\x20user','ENSURE_SNAPSHOT_EXECUTION','toString','unhandledrejection','YUUMI_CONNECTOR_URL_NOT_FOUND','_handleEvent','ALREADY_EXISTS','children','pipe','SNAPSHOT_INVALID_SNAPSHOT','TEXT','CollaborationUIEventService','invokeId','[RemoteUniscriptService]:\x20no\x20focused\x20unit','@univerjs/design','getOwnPropertyDescriptor','collabStatus.conflict','_updateCollabCursors','closePath','COLLABORATION_CLIENT_PLUGIN_CONFIG_KEY','LICENSE_MAX_MEMBERS_PER_UNIT_EXCEEDED','USERS_LEAVE','[Unhandled\x20Rejection]:\x20','#FFF','ISnapshotServerService','M3.61971\x2011.6499C2.40304\x2011.6499\x200.699707\x2011.1024\x200.699707\x208.9124C0.699707\x206.3574\x203.25471\x205.8099\x203.98471\x205.8099C4.34971\x204.5324\x205.07971\x202.5249\x207.99971\x202.5249C10.5547\x202.5249\x2011.6497\x203.9849\x2012.0147\x205.2624C12.0147\x205.2624\x2015.2997\x205.6274\x2015.2997\x208.7299C15.2997\x2010.9199\x2013.8397\x2011.6499\x2012.3797\x2011.6499M9.82471\x209.82466L6.17471\x2013.4747M6.17471\x209.82466L9.82471\x2013.4747','fromEventSubject','_updateURLWithCurrentState','[CollaborationDataLoaderController]','startRow','override','_unitStatus','key','UniverCollaborationClientPlugin','_registerDependencies','DeleteRangeMoveUpCommandId','size','getMemberID','SetFormulaCalculationStartMutation','RECT','flatMap','reconnect','_initStatusListener','UniverProCollaborationClient','collab-text-anchor-','_online','_memberID','endRow','Disposable','NOT_FOUND','makeDirty','collab-text-range-','stage','from','get','ERROR_AGAIN','unsubscribe','message','registerDependencies','_collabCursorController','filter','_colorAssignService','createSocket','handleMoveRange','_hover','handleInsertRow','NodePositionConvertToRectRange','string','DocCollaborationEntity','UniverInstanceType','/universer-api/license/formula/limit/done','MOBILE_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','getVpScrollXYInfoByPosToVp','AUTHORIZE_CODE_ILLEGAL','/universer-api/license/formula/limit/start','top','_disabled','m1Prime','save','YUUMI_NO_CUBOID_FOR_QUESTION','CollaborationEvent','session.connection-failed','_updateLocalCursor','replace','getMember','REDEMPTION_USER_REDEEM_TIMES_EXCEED','m2Prime','_getMergeRange','formula.calculation.unable','@univerjs/docs-ui','OnLineIcon','6509889OWujhq','getDocRanges','_hasFormulaInDirtyRanges','UnitStatus','_hovered','onLocalMutation','_transformUndoRedoStack','Tools','SNAPSHOT_HAS_BEEN_REMOVED','sessionTicket','SetDocZoomRatioOperation','getCellMatrix','ILocalStorageService','_releaseCalculationLimit','SOCKET_FAILED_RETRY','_initDependencies','_doCreateSocket','range','DEFAULT_WS_SESSION_TICKET_URL','ACTIVE_UNIT_EVENT_CHANNEL','EMAIL_VERIFY_CODE_NOT_FOUND_OR_EXPIRED','mergeOverrideWithDependencies','fillRule','collabStatus.fetchMiss','_collaborationController','@univerjs/engine-formula','LICENSE_DISTRO_REJECTED','send','_transformHistoryAndStateStack','react','labelPosition','SheetsSelectionsService','IConfigService','_labelPosition','DataLoaderService','CommandType','ENTITLE_CAN_NOT_BUY_LOWER_OTP','handleDeleteRangeMoveLeft','SUBMIT_CHANGESET_TIMEOUT','DocSelectionManagerService','jsxs','body','_configService','memberID','UNIVER_SHEET','hide','UniverProCollaboration','@univerjs/network','_taskIds','collabStatus.syncing','0\x200\x2017\x2016','reason','registerRefRange','getRenderById','UniverCollaborationClientUIPlugin','FormulaExecutedStateType','onPointerLeave$','object','assignAColorForMemberID','collabStatus.offline','createIdentifier','undoState','releaseFormulaLimitUrl','5443844DxUaeI','textRanges','unload','_applyCommand','RefRangeService','_setupBeforeClosingHandler','forEach','REDEMPTION_CODE_HAS_BEEN_CREATED','_textBubble','_messageService','all','CollaborationSessionService','stringify','name','M4.5865\x2011.6499C3.36983\x2011.6499\x201.6665\x2011.1024\x201.6665\x208.9124C1.6665\x206.3574\x204.2215\x205.8099\x204.9515\x205.8099C5.3165\x204.5324\x206.0465\x202.5249\x208.9665\x202.5249C11.5215\x202.5249\x2012.6165\x203.9849\x2012.9815\x205.2624C12.9815\x205.2624\x2016.2665\x205.6274\x2016.2665\x208.7299C16.2665\x2010.9199\x2014.8065\x2011.6499\x2013.3465\x2011.6499M6.7767\x2011.6497L8.9667\x2013.4747L11.8867\x209.82466','url(#on-line-icon_clip0_910_349)','forwardRef','INVITE_CODE_REQUIRED','WebSocketService','OTHER_CLIENTS_EDITING','onRendered','getUnhiddenWorksheets','_initEvent','purple.300','APPLY_PERMISSION_DENIED','stack','_docTransformIMECacheService','moveTo','status$','dispose$','MessageType','session.will-retry','YUUMI_ASYNCIO_CANCELLED','onMouseMove','LICENSE_EXPORT_SIZE_EXCEEDED','debounceTime','SUCCESS','ENTITLE_COUPON_USED_UP','Vector2','No\x20remote\x20instance\x20service\x20injected.\x20May\x20not\x20syncing\x20edits\x20to\x20the\x20web\x20worker.','Optional','clearInterval','disposeWithMe','_collabSessionService','_collaborationUIEventService','RemoveRowCommandId','beginPath','ColorKit','permission.content','InsertRangeMoveDownCommandId','@univerjs/core','permission.title','APPLY_REVISION_CONFILICT','beforeCommandExecuted','APPLY_REJECT','BehaviorSubject','_anchor','href','ILogService','3703021xAPbgu','black','getStateCache','WECHAT_HAS_BEEN_BOUND','VIEW_MAIN','SetWorksheetActivateCommand','registerBeforeClose','_scheduleSaving','UNIVER_COLLABORATION_CLIENT_WEB_PLUGIN','collab-client.tooltip.reconnect','UniverSheetsUi','IURLService','_removeClearOtherTimer','add','generateRandomId','_univerInstanceService','source','EMAIL_VERIFY_CODE_MISMATCH','_sheetSkeletonManagerService','hovered','currentUsage','ENTITLE_UPDOWN_GRADE_NOT_SUPPORT','executeCommand','collabStatus.synced','symbol','DocIMEInputManagerService','REDEMPTION_CODE_NOT_STARTED','trim','useRef','_maxFormulaLimit','handleInsertCol','replaceState','UniverProCollaborationClientUi','skeleton','@univerjs/engine-render','unshift','assign','REDEMPTION_USER_NOT_ELIGIBLE','lineno','startColumn','switchMap','_saveTaskMap','sheetId','subunit','_initWindowErrorListener','_checkAndWaitForCalculationPermission','CollaborationController','session.collaboration-timeout','text','_shapes','handleInsertRangeMoveRight','mask','redoState','_getSaveTimeout','_refreshCollabCursors','getSheetBySheetId','ThemeService','data','Loading','SetFormulaCalculationNotificationMutation','RemoveColCommandId','focused$','?taskId=','with','_pollingInterval','setActiveRange','svg','OffLineIcon','column','/run/','SYNCED','asObservable','ENTITLE_USE_COUPON_NOT_1ST_TRADE','roomMembers','http://www.w3.org/2000/svg','collabStatus.notCollab','INVITE_CODE_ALREADY_BOUND','_initCommandExecutedListener','_cursors','getformulaLimitStatusUrl','cursorInfo$','removeParam','759260kWJjFy','UniverDesign','handleIRemoveCol','ENTITLE_NEED_BILLING_ADDRESS','@univerjs-pro/collaboration-client','Workbook','rgba(255,\x20255,\x20255,\x200.01)','post','getUniverSheetInstance','values','Success','_getSessionTicket','Injector','_onRefRangeChange','_clearPolling','UniverRpc','collabCursorState$','_colorIndex','dispose','@univerjs/ui','max'];_0xe035=function(){return _0x514721;};return _0xe035();}

// @univerjs-pro/collaboration-client-ui/facade
function _0x2e27(_0x264558,_0x5954b7){_0x264558=_0x264558-0x1e3;var _0x5c08a2=_0x5c08();var _0x2e2756=_0x5c08a2[_0x264558];return _0x2e2756;}(function(_0x4e43cc,_0xb1c4ad){var _0x23e980=_0x2e27,_0x2e6ed6=_0x4e43cc();while(!![]){try{var _0x23cb77=-parseInt(_0x23e980(0x1f8))/0x1+-parseInt(_0x23e980(0x1f0))/0x2*(-parseInt(_0x23e980(0x1ed))/0x3)+-parseInt(_0x23e980(0x1e3))/0x4+-parseInt(_0x23e980(0x1ea))/0x5*(-parseInt(_0x23e980(0x1e5))/0x6)+-parseInt(_0x23e980(0x1f1))/0x7*(-parseInt(_0x23e980(0x1ef))/0x8)+parseInt(_0x23e980(0x1f2))/0x9+-parseInt(_0x23e980(0x1eb))/0xa;if(_0x23cb77===_0xb1c4ad)break;else _0x2e6ed6['push'](_0x2e6ed6['shift']());}catch(_0x426e6d){_0x2e6ed6['push'](_0x2e6ed6['shift']());}}}(_0x5c08,0xb024e),function(_0x14445d,_0x1a30a9){var _0x122bf0=_0x2e27;typeof exports==_0x122bf0(0x1f5)&&typeof module<'u'?_0x1a30a9(require('@univerjs-pro/collaboration-client-ui'),require('@univerjs/core/facade')):typeof define==_0x122bf0(0x1e6)&&define[_0x122bf0(0x1f3)]?define([_0x122bf0(0x1f6),_0x122bf0(0x1f4)],_0x1a30a9):(_0x14445d=typeof globalThis<'u'?globalThis:_0x14445d||self,_0x1a30a9(_0x14445d[_0x122bf0(0x1e8)],_0x14445d[_0x122bf0(0x1ee)]));}(this,function(_0x17fc8c,_0xf4f41f){'use strict';var _0x3c1f15=_0x2e27;class _0x4451a9 extends _0xf4f41f[_0x3c1f15(0x1e7)]{[_0x3c1f15(0x1ec)](_0x4fa4a4,_0x54acfd,..._0x3b22dd){var _0x642272=_0x3c1f15;return this[_0x642272(0x1e4)]['get'](_0x17fc8c[_0x642272(0x1e9)])['runOnServer'](_0x4fa4a4,_0x54acfd,{},..._0x3b22dd);}}_0xf4f41f['FUniver'][_0x3c1f15(0x1f7)](_0x4451a9);}));function _0x5c08(){var _0x5d79ce=['3333400UMRBYM','runOnServer','163257uuqxBi','UniverCoreFacade','3595912MNKiae','14qLLFbm','7hjtmkQ','8689905HWnkXr','amd','@univerjs/core/facade','object','@univerjs-pro/collaboration-client-ui','extend','196660oxOTkp','5582676VoOIAm','_injector','156PmNBQD','function','FUniver','UniverProCollaborationClientUi','RemoteUniscriptService','163690ElRjSP'];_0x5c08=function(){return _0x5d79ce;};return _0x5c08();}

// index
(function(e,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("@univerjs-pro/collaboration"),require("@univerjs-pro/collaboration-client"),require("@univerjs-pro/collaboration-client-ui"),require("@univerjs-pro/collaboration-client/lib/facade")):typeof define=="function"&&define.amd?define(["exports","@univerjs-pro/collaboration","@univerjs-pro/collaboration-client","@univerjs-pro/collaboration-client-ui","@univerjs-pro/collaboration-client/lib/facade"],i):(e=typeof globalThis<"u"?globalThis:e||self,i(e.UniverPresetDocsCollaboration={},e.UniverProCollaboration,e.UniverProCollaborationClient,e.UniverProCollaborationClientUi))})(this,(function(e,i,l,t){"use strict";function a(n){const r=new URL(n,window.location.origin);switch(r.protocol){case"https:":r.protocol="wss:";break;case"http:":r.protocol="ws:";break}return r.toString()}function s(n={}){const{universerEndpoint:r}=n,o=r!=null?r:`${window.location.protocol}//${window.location.host}`;return{plugins:[i.UniverCollaborationPlugin,[l.UniverCollaborationClientPlugin,{socketService:t.BrowserCollaborationSocketService,enableOfflineEditing:!0,enableSingleActiveInstanceLock:!0,enableAuthServer:!0,authzUrl:`${o}/universer-api/authz`,snapshotServerUrl:`${o}/universer-api/snapshot`,collabSubmitChangesetUrl:`${o}/universer-api/comb`,collabWebSocketUrl:a(`${o}/universer-api/comb/connect`),loginUrlKey:`${o}/universer-api/oidc/authpage`,uploadFileServerUrl:`${o}/universer-api/stream/file/upload`,signUrlServerUrl:`${o}/universer-api/file/{fileID}/sign-url`,downloadEndpointUrl:`${o}/`,wsSessionTicketUrl:`${o}/universer-api/user/session-ticket`,sendChangesetTimeout:200}],t.UniverCollaborationClientUIPlugin]}}e.UniverDocsCollaborationPreset=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
