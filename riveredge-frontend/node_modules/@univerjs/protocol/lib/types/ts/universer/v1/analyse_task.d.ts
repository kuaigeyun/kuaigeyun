import { Metadata } from '@grpc/grpc-js';
import { Observable } from 'rxjs';
import { Error } from '../../univer/constants/errors';
import { UniverType } from '../../univer/constants/univer';
import { UnitRole, UnitShareScope } from '../../univer/permission';
import { DataFragmentationType, SystemRemark } from './analyse_cmn';
export declare const protobufPackage = "universer.v1";
export declare enum AnalyseTaskStatus {
    AnalyseTaskStatus_None = 0,
    AnalyseTaskStatus_Analysing = 1,
    AnalyseTaskStatus_Failed = 2,
    AnalyseTaskStatus_Completed = 3,
    UNRECOGNIZED = -1
}
export declare enum ProgressNodeType {
    /** NodeType_Unknown - unknown */
    NodeType_Unknown = 0,
    /** NodeType_Start - start analysing */
    NodeType_Start = 1,
    /** NodeType_Think - start thinking */
    NodeType_Think = 2,
    /** NodeType_Generate - generate report */
    NodeType_Generate = 3,
    /** NodeType_End - completed */
    NodeType_End = 4,
    UNRECOGNIZED = -1
}
export interface SummarizeSourceDataRequest {
    unitId: string;
    modelId: string;
    locale: string;
    dataSourceId: string;
}
export interface SummarizeSourceDataResponse {
    summary: string;
    error: Error | undefined;
}
export interface GetGoalRecommendationsRequest {
    unitId: string;
    dataSummary: string;
    modelId: string;
    locale: string;
    /** how many recommendations needed, default is 10 */
    count: number;
    dataSourceId: string;
}
export interface GetGoalRecommendationsResponse {
    goals: string[];
    error: Error | undefined;
}
export interface AnalyseTask {
    taskId: string;
    title: string;
    /** unix timestamp milli seconds */
    createTime: string;
    modelId: string;
    /** unix timestamp milli seconds */
    lastRunTimeBegin: string;
    /** unix timestamp milli seconds */
    lastRunTimeEnd: string;
    /** unix timestamp milli seconds */
    lastUpdateTime: string;
    dataSummary: string;
    goal: string;
    status: AnalyseTaskStatus;
    /** set if status is Completed */
    reportUnitId: string;
    /** set if status is Completed */
    reportUnitType: UniverType;
    /** set if status is Completed */
    reportSummary: string;
    /** set if task executed before, whether success, failure, or executing */
    sysRemarks: SystemRemark[];
    /** set if status is failed */
    reason: Error | undefined;
    /**
     * support use datasource or unit directly,
     * and datasource is preferential.
     */
    dataSourceId: string;
    unitId: string;
}
export interface SubmitAnalyseTaskRequest {
    unitId: string;
    dataSummary: string;
    goal: string;
    modelId: string;
    dataSourceId: string;
}
export interface SubmitAnalyseTaskResponse {
    task: AnalyseTask | undefined;
    error: Error | undefined;
}
export interface RerunAnalyseTaskRequest {
    taskId: string;
    dataSummary: string;
    goal: string;
    modelId: string;
}
export interface RerunAnalyseTaskResponse {
    error: Error | undefined;
}
export interface ListAnalyseTasksRequest {
    /**
     * batchId,
     * set to empty in the 1st scroller request,
     * then set to nextBatchId(which was returned by the previous request) in the following scroller request.
     */
    batchId: string;
    /** limit, specify how many records needed. */
    limit: number;
}
export interface ListAnalyseTasksResponse {
    tasks: AnalyseTask[];
    hasMore: boolean;
    nextBatchId: string;
    error: Error | undefined;
}
export interface GetAnalyseTaskRequest {
    taskId: string;
}
export interface GetAnalyseTaskResponse {
    task: AnalyseTask | undefined;
    error: Error | undefined;
}
export interface RenameAnalyseTaskRequest {
    taskId: string;
    newTitle: string;
}
export interface RenameAnalyseTaskResponse {
    error: Error | undefined;
}
export interface DeleteAnalyseTaskRequest {
    taskId: string;
}
export interface DeleteAnalyseTaskResponse {
    error: Error | undefined;
}
export interface ShareReportRequest {
    reportUnitId: string;
    role: UnitRole;
    scope: UnitShareScope;
}
export interface ShareReportResponse {
    error: Error | undefined;
}
export interface ReportDataFragmentation {
    fragmentationId: string;
    type: DataFragmentationType;
    title: string;
    unitId: string;
    subUnitId: string;
}
export interface GetReportDataFragmentationRequest {
    reportUnitId: string;
    fragmentationId: string;
}
export interface GetReportDataFragmentationResponse {
    /**
     * content, vary with the type,
     * DataFragmentationType_Charts -> charts raw body;
     */
    content: string;
    error: Error | undefined;
}
export interface ListReportDataFragmentationsRequest {
    reportUnitId: string;
}
export interface ListReportDataFragmentationsResponse {
    fragmentations: ReportDataFragmentation[];
    error: Error | undefined;
}
export interface UpdateReportDataFragmentationRequest {
    reportUnitId: string;
    fragmentationId: string;
    newContent: string;
}
export interface UpdateReportDataFragmentationResponse {
    error: Error | undefined;
}
export interface GetAnalyseTaskProgressRequest {
    taskId: string;
}
export interface GetAnalyseTaskProgressResponse {
    progress: AnalyseTaskProgressNode[];
    sysRemarks: SystemRemark[];
    error: Error | undefined;
}
export interface StartNodeData {
    dataSourceName: string;
    dataSummary: string;
}
export interface ThinkNodeData {
    userPrompt: string;
    thinkData: string;
}
export interface OutlineTitleNode {
    level: number;
    content: string;
}
export interface GenerateNodeData {
    outline: OutlineTitleNode[];
}
export interface AnalyseTaskProgressNode {
    beginTime: string;
    endTime: string;
    nodeType: ProgressNodeType;
    /**
     * nodeType=Start -> content json is StartNodeData
     * nodeType=Think ->  content json is ThinkNodeData
     * nodeType=Generate ->  content json is GenerateNodeData
     * nodeType=End ->  content json is univer.constants.Error
     */
    content: string;
    /** 0 unknown 1 start 2 end */
    status: number;
}
export interface AnalyseTaskService {
    SummarizeSourceData(request: SummarizeSourceDataRequest, metadata?: Metadata): Observable<SummarizeSourceDataResponse>;
    GetGoalRecommendations(request: GetGoalRecommendationsRequest, metadata?: Metadata): Observable<GetGoalRecommendationsResponse>;
    SubmitAnalyseTask(request: SubmitAnalyseTaskRequest, metadata?: Metadata): Observable<SubmitAnalyseTaskResponse>;
    RerunAnalyseTask(request: RerunAnalyseTaskRequest, metadata?: Metadata): Observable<RerunAnalyseTaskResponse>;
    RenameAnalyseTask(request: RenameAnalyseTaskRequest, metadata?: Metadata): Observable<RenameAnalyseTaskResponse>;
    DeleteAnalyseTask(request: DeleteAnalyseTaskRequest, metadata?: Metadata): Observable<DeleteAnalyseTaskResponse>;
    GetAnalyseTask(request: GetAnalyseTaskRequest, metadata?: Metadata): Observable<GetAnalyseTaskResponse>;
    ListAnalyseTasks(request: ListAnalyseTasksRequest, metadata?: Metadata): Observable<ListAnalyseTasksResponse>;
    ShareReport(request: ShareReportRequest, metadata?: Metadata): Observable<ShareReportResponse>;
    GetReportDataFragmentation(request: GetReportDataFragmentationRequest, metadata?: Metadata): Observable<GetReportDataFragmentationResponse>;
    ListReportDataFragmentations(request: ListReportDataFragmentationsRequest, metadata?: Metadata): Observable<ListReportDataFragmentationsResponse>;
    UpdateReportDataFragmentation(request: UpdateReportDataFragmentationRequest, metadata?: Metadata): Observable<UpdateReportDataFragmentationResponse>;
    GetAnalyseTaskProgress(request: GetAnalyseTaskProgressRequest, metadata?: Metadata): Observable<GetAnalyseTaskProgressResponse>;
}
