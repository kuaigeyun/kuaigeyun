import { Metadata } from '@grpc/grpc-js';
import { Observable } from 'rxjs';
import { Error } from '../../univer/constants/errors';
import { UniverType } from '../../univer/constants/univer';
import { Snapshot } from '../../univer/snapshot';
import { SheetBlock } from '../../univer/workbook';
export declare const protobufPackage = "universer.v1";
export declare enum ImportOutputType {
    UNDEFINED = 0,
    /** UNIT - Import to univer unit, unit is store in the database */
    UNIT = 1,
    /** JSON - Import and convert to a json file which represents a univer unit, not store in the database */
    JSON = 2,
    UNRECOGNIZED = -1
}
export declare enum ImportScene {
    ImportScene_Unspecified = 0,
    ImportScene_General = 1,
    ImportScene_AIAnalyse = 2,
    UNRECOGNIZED = -1
}
export interface ImportRequest {
    fileID: string;
    type: UniverType;
    outputType: ImportOutputType;
    /** not supported yet */
    fileUrl: string;
    scene: ImportScene;
    minSheetColumnCount: number;
    minSheetRowCount: number;
}
export interface ImportResponse {
    error: Error | undefined;
    taskID: string;
}
export interface ExportRequest {
    /** if unitID is specified, the input is the unit in the database */
    unitID: string;
    /** if jsonID is specified, the input is the json file which represents a univer unit */
    jsonID: string;
    type: UniverType;
    /** whether to use the SSC switch, default is false not use ssc */
    sscSwitch: boolean;
    /** whether to use the image url in the exported file */
    useImageUrl: boolean;
    ignoreTableExport: boolean;
}
export interface ExportResponse {
    error: Error | undefined;
    taskID: string;
}
export interface GetTaskRequest {
    taskID: string;
}
export interface GetTaskResponse {
    error: Error | undefined;
    taskID: string;
    status: string;
    import?: ImportTaskResult | undefined;
    export?: ExportTaskResult | undefined;
}
export interface ImportTaskResult {
    outputType: ImportOutputType;
    unitID: string;
    jsonID: string;
}
export interface ExportTaskResult {
    fileID: string;
    fileUrl: string;
}
export interface UpdateTaskRequest {
    taskID: string;
    status: string;
    data: Uint8Array;
}
export interface UpdateTaskResponse {
    error: Error | undefined;
}
/** The json file which represents a univer unit */
export interface UniverFileInJsonFmt {
    /** TODO: need to consider more than one snapshot in a univer file */
    snapshot: Snapshot | undefined;
    /** key is the blockID, value is the sheet block */
    sheetBlocks: {
        [key: string]: SheetBlock;
    };
}
export interface UniverFileInJsonFmt_SheetBlocksEntry {
    key: string;
    value: SheetBlock | undefined;
}
export interface ExchangeService {
    Import(request: ImportRequest, metadata?: Metadata): Observable<ImportResponse>;
    Export(request: ExportRequest, metadata?: Metadata): Observable<ExportResponse>;
    GetTask(request: GetTaskRequest, metadata?: Metadata): Observable<GetTaskResponse>;
    UpdateTask(request: UpdateTaskRequest, metadata?: Metadata): Observable<UpdateTaskResponse>;
}
