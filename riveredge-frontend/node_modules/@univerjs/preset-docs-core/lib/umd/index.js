// @univerjs/ui/index
(function(h,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("@univerjs/core"),require("rxjs"),require("react"),require("react/jsx-runtime"),require("@wendellhu/redi/react-bindings"),require("@univerjs/design"),require("rxjs/operators"),require("@univerjs/engine-render"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","rxjs","react","react/jsx-runtime","@wendellhu/redi/react-bindings","@univerjs/design","rxjs/operators","@univerjs/engine-render","react-dom"],f):(h=typeof globalThis<"u"?globalThis:h||self,f(h.UniverUi={},h.UniverCore,h.rxjs,h.React,h.React,h["@wendellhu/redi/react-bindings"],h.UniverDesign,h.rxjs.operators,h.UniverEngineRender,h.ReactDOM))})(this,(function(h,f,B,s,v,V,x,_3,U1,S3){"use strict";var D5=Object.defineProperty;var O5=h=>{throw TypeError(h)};var R5=(h,f,B)=>f in h?D5(h,f,{enumerable:!0,configurable:!0,writable:!0,value:B}):h[f]=B;var j=(h,f,B)=>R5(h,typeof f!="symbol"?f+"":f,B);var M3=(h,f,B)=>f.has(h)?O5("Cannot add the same private member more than once"):f instanceof WeakSet?f.add(h):f.set(h,B);var h3,C3;class ie extends f.Disposable{constructor(){super(...arguments);j(this,"_open$",new B.BehaviorSubject(!1));j(this,"open$",this._open$.pipe(B.distinctUntilChanged()))}get isOpen(){return this._open$.getValue()}dispose(){super.dispose(),this._open$.next(!1),this._open$.complete()}open(){this._open$.next(!0)}close(){this._open$.next(!1)}}const dn=f.createIdentifier("ui.left-sidebar.service"),x1=f.createIdentifier("ui.sidebar.service"),H3="ShortcutPanel",j1={id:"base-ui.operation.toggle-shortcut-panel",type:f.CommandType.OPERATION,handler:e=>{const n=e.get(ie),t=e.get(x1);return n.isOpen?(n.close(),t.close()):(n.open(),t.open({header:{title:"shortcut-panel.title"},children:{label:H3}})),!0}};function H({ref:e,...n}){const{icon:t,id:r,className:o,extend:i,...l}=n,c=`univerjs-icon univerjs-icon-${r} ${o||""}`.trim(),C=s.useRef(`_${Cn()}`);return E3(t,`${r}`,{defIds:t.defIds,idSuffix:C.current},{ref:e,className:c,...l},i)}function E3(e,n,t,r,o){return s.createElement(e.tag,{key:n,...fn(e,t,o),...r},(hn(e,t).children||[]).map((i,l)=>E3(i,`${n}-${e.tag}-${l}`,t,void 0,o)))}function fn(e,n,t){const r={...e.attrs};t!=null&&t.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=t.colorChannel1),e.tag==="mask"&&r.id&&(r.id=r.id+n.idSuffix),Object.entries(r).forEach(([i,l])=>{i==="mask"&&typeof l=="string"&&(r[i]=l.replace(/url\(#(.*)\)/,`url(#$1${n.idSuffix})`))});const{defIds:o}=n;return!o||o.length===0||(e.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+n.idSuffix),Object.entries(r).forEach(([i,l])=>{typeof l=="string"&&(r[i]=l.replace(/url\(#(.*)\)/,`url(#$1${n.idSuffix})`))})),r}function hn(e,n){var r;const{defIds:t}=n;return!t||t.length===0?e:e.tag==="defs"&&((r=e.children)!=null&&r.length)?{...e,children:e.children.map(o=>typeof o.attrs.id=="string"&&t&&t.includes(o.attrs.id)?{...o,attrs:{...o.attrs,id:o.attrs.id+n.idSuffix}}:o)}:e}function Cn(){return Math.random().toString(36).substring(2,8)}H.displayName="UniverIcon";const vn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.06641 3.49366C4.06641 2.27555 5.14145 1.3916 6.33307 1.3916C7.52469 1.3916 8.59974 2.27555 8.59974 3.49366V6.49777C8.59974 7.71586 7.52469 8.59982 6.33307 8.59982C5.14145 8.59982 4.06641 7.71586 4.06641 6.49777V3.49366ZM6.33307 2.5916C5.68376 2.5916 5.26641 3.05264 5.26641 3.49366V6.49777C5.26641 6.93878 5.68376 7.39982 6.33307 7.39982C6.98239 7.39982 7.39974 6.93878 7.39974 6.49777V3.49366C7.39974 3.05264 6.98239 2.5916 6.33307 2.5916Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.0664 3.49366C10.0664 2.27555 11.1415 1.3916 12.3331 1.3916C13.5247 1.3916 14.5997 2.27555 14.5997 3.49366V6.49777C14.5997 7.71586 13.5247 8.59982 12.3331 8.59982C11.1415 8.59982 10.0664 7.71586 10.0664 6.49777V3.49366ZM12.3331 2.5916C11.6838 2.5916 11.2664 3.05264 11.2664 3.49366V6.49777C11.2664 6.93878 11.6838 7.39982 12.3331 7.39982C12.9824 7.39982 13.3997 6.93878 13.3997 6.49777V3.49366C13.3997 3.05264 12.9824 2.5916 12.3331 2.5916Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4242 9.5417C12.1899 9.30739 11.81 9.30739 11.5756 9.5417C11.3413 9.77602 11.3413 10.1559 11.5756 10.3902L12.5514 11.366H6.3334C6.00203 11.366 5.7334 11.6346 5.7334 11.966C5.7334 12.2973 6.00203 12.566 6.3334 12.566H12.5514L11.5756 13.5417C11.3413 13.776 11.3413 14.1559 11.5756 14.3902C11.81 14.6245 12.1899 14.6245 12.4242 14.3902L14.4159 12.3985C14.5294 12.2893 14.6001 12.1359 14.6001 11.966C14.6001 11.796 14.5294 11.6426 14.4159 11.5334L12.4242 9.5417Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 8.3002C1.3999 7.96882 1.66853 7.7002 1.9999 7.7002H2.33324C2.66461 7.7002 2.93324 7.96882 2.93324 8.3002C2.93324 8.63157 2.66461 8.9002 2.33324 8.9002H1.9999C1.66853 8.9002 1.3999 8.63157 1.3999 8.3002Z"}}]},D3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"add-digits-icon",ref:t,icon:vn}))});D3.displayName="AddDigitsIcon";const gn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.2498 3.65005C2.2498 2.87685 2.87661 2.25005 3.64981 2.25005H7.9998C8.33118 2.25005 8.5998 1.98142 8.5998 1.65005C8.5998 1.31868 8.33118 1.05005 7.9998 1.05005H3.64981C2.21387 1.05005 1.0498 2.21411 1.0498 3.65005V12.35C1.0498 13.786 2.21386 14.95 3.6498 14.95H12.3498C13.7857 14.95 14.9498 13.786 14.9498 12.3501V8.00005C14.9498 7.66868 14.6812 7.40005 14.3498 7.40005C14.0184 7.40005 13.7498 7.66868 13.7498 8.00005V9.23974L12.2385 8.1063C11.7252 7.72129 11.0068 7.7723 10.5531 8.22605L9.00869 9.77041L6.73916 7.8251C6.24387 7.40055 5.5095 7.41278 5.02864 7.85359L2.2498 10.4009V3.65005ZM2.2498 12.0287V12.35C2.2498 13.1232 2.87661 13.75 3.6498 13.75H12.3498C13.123 13.75 13.7498 13.1232 13.7498 12.3501V10.7397L11.5186 9.06631C11.4829 9.03956 11.433 9.04314 11.4016 9.07458L9.92249 10.5537L11.1015 11.5642C11.3531 11.7799 11.3822 12.1587 11.1666 12.4103C10.9509 12.6619 10.5721 12.691 10.3205 12.4753L5.9582 8.7362C5.92384 8.70674 5.87288 8.70758 5.83952 8.73816L2.2498 12.0287Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.8097 1.14783C12.1411 1.14783 12.4097 1.41646 12.4097 1.74783V3.297H14.1541C14.4855 3.297 14.7541 3.56563 14.7541 3.897C14.7541 4.22837 14.4855 4.497 14.1541 4.497H12.4097V6.24167C12.4097 6.57304 12.1411 6.84167 11.8097 6.84167C11.4783 6.84167 11.2097 6.57304 11.2097 6.24167V4.497H9.6603C9.32893 4.497 9.0603 4.22837 9.0603 3.897C9.0603 3.56563 9.32893 3.297 9.6603 3.297H11.2097V1.74783C11.2097 1.41646 11.4783 1.14783 11.8097 1.14783Z"}}]},O3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"add-image-icon",ref:t,icon:gn}))});O3.displayName="AddImageIcon";const pn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3606 3.74168C11.6086 3.49373 12.0106 3.49373 12.2585 3.74168C12.5065 3.98963 12.5065 4.39164 12.2585 4.6396L4.63947 12.2586C4.39152 12.5066 3.98951 12.5066 3.74156 12.2586C3.49361 12.0107 3.49361 11.6087 3.74156 11.3607L11.3606 3.74168Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.82544 4.82556H4.19052C3.83986 4.82556 3.5556 5.10982 3.5556 5.46048C3.5556 5.81114 3.83986 6.0954 4.19052 6.0954H4.82544V6.73032C4.82544 7.08098 5.1097 7.36524 5.46036 7.36524C5.81102 7.36524 6.09528 7.08098 6.09528 6.73032V6.0954H6.7302C7.08086 6.0954 7.36512 5.81114 7.36512 5.46048C7.36512 5.10982 7.08086 4.82556 6.7302 4.82556H6.09528V4.19064C6.09528 3.83998 5.81102 3.55572 5.46036 3.55572C5.1097 3.55572 4.82544 3.83998 4.82544 4.19064V4.82556Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.3175 10.8573C8.3175 10.5066 8.60176 10.2224 8.95242 10.2224H11.4921C11.8428 10.2224 12.127 10.5066 12.127 10.8573C12.127 11.208 11.8428 11.4922 11.4921 11.4922H8.95242C8.60176 11.4922 8.3175 11.208 8.3175 10.8573Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33337 2.9208C1.33337 2.04416 2.04403 1.3335 2.92068 1.3335H13.0794C13.9561 1.3335 14.6667 2.04416 14.6667 2.9208V13.0795C14.6667 13.9562 13.9561 14.6668 13.0794 14.6668H2.92068C2.04404 14.6668 1.33337 13.9562 1.33337 13.0795V2.9208ZM2.92068 2.60334C2.74535 2.60334 2.60322 2.74547 2.60322 2.9208V13.0795C2.60322 13.2549 2.74534 13.397 2.92068 13.397H13.0794C13.2547 13.397 13.3969 13.2549 13.3969 13.0795V2.9208C13.3969 2.74546 13.2547 2.60334 13.0794 2.60334H2.92068Z",fillRule:"evenodd",clipRule:"evenodd"}}]},R3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"addition-and-subtraction-icon",ref:t,icon:pn}))});R3.displayName="AdditionAndSubtractionIcon";const mn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 13.6999C1.3999 13.3685 1.66853 13.0999 1.9999 13.0999H13.9999C14.3313 13.0999 14.5999 13.3685 14.5999 13.6999C14.5999 14.0312 14.3313 14.2999 13.9999 14.2999H1.9999C1.66853 14.2999 1.3999 14.0312 1.3999 13.6999Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.57564 10.3914C7.80995 10.6257 8.18985 10.6257 8.42417 10.3914L10.4242 8.3914C10.6585 8.15709 10.6585 7.77719 10.4242 7.54287C10.1899 7.30856 9.80995 7.30856 9.57564 7.54287L7.9999 9.11861L6.42417 7.54287C6.18985 7.30856 5.80995 7.30856 5.57564 7.54287C5.34132 7.77719 5.34132 8.15709 5.57564 8.3914L7.57564 10.3914Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 10.5671C8.33127 10.5671 8.5999 10.2985 8.5999 9.96714V2.30047C8.5999 1.9691 8.33127 1.70047 7.9999 1.70047C7.66853 1.70047 7.3999 1.9691 7.3999 2.30047V9.96714C7.3999 10.2985 7.66853 10.5671 7.9999 10.5671Z",fillRule:"evenodd",clipRule:"evenodd"}}]},V3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"align-bottom-icon",ref:t,icon:mn}))});V3.displayName="AlignBottomIcon";const bn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},N3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"align-text-both-icon",ref:t,icon:bn}))});N3.displayName="AlignTextBothIcon";const Ln={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 2.3002C1.3999 2.63157 1.66853 2.9002 1.9999 2.9002H13.9999C14.3313 2.9002 14.5999 2.63157 14.5999 2.3002C14.5999 1.96882 14.3313 1.7002 13.9999 1.7002H1.9999C1.66853 1.7002 1.3999 1.96882 1.3999 2.3002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.22957 5.47839C8.30034 5.50767 8.36664 5.55107 8.42417 5.6086L10.4242 7.6086C10.6585 7.84291 10.6585 8.22281 10.4242 8.45713C10.1899 8.69144 9.80995 8.69144 9.57564 8.45713L8.5999 7.48139V13.6995C8.5999 14.0309 8.33127 14.2995 7.9999 14.2995C7.66853 14.2995 7.3999 14.0309 7.3999 13.6995V7.48139L6.42417 8.45713C6.18985 8.69144 5.80995 8.69144 5.57564 8.45713C5.34132 8.22281 5.34132 7.84291 5.57564 7.6086L7.57541 5.60882C7.7522 5.43203 8.01209 5.38841 8.22957 5.47839Z"}}]},T3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"align-top-icon",ref:t,icon:Ln}))});T3.displayName="AlignTopIcon";const wn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 1.12915C8.03875 1.12915 8.07673 1.13284 8.11352 1.13989H12.2599C13.6958 1.13989 14.8599 2.30395 14.8599 3.73989V7.88619C14.867 7.92301 14.8707 7.96102 14.8707 7.9999C14.8707 8.03878 14.867 8.0768 14.8599 8.11362V12.2599C14.8599 13.6958 13.6958 14.8599 12.2599 14.8599H8.11362C8.0768 14.867 8.03878 14.8707 7.9999 14.8707C7.96102 14.8707 7.92301 14.867 7.88619 14.8599H3.73989C2.30396 14.8599 1.13989 13.6958 1.13989 12.2599V8.11352C1.13284 8.07673 1.12915 8.03875 1.12915 7.9999C1.12915 7.96106 1.13284 7.92308 1.13989 7.88629V3.73989C1.13989 2.30396 2.30395 1.13989 3.73989 1.13989H7.88629C7.92308 1.13284 7.96106 1.12915 7.9999 1.12915ZM2.33989 8.5999V12.2599C2.33989 13.0331 2.9667 13.6599 3.73989 13.6599H7.3999V8.5999H2.33989ZM7.3999 7.3999H2.33989V3.73989C2.33989 2.9667 2.96669 2.33989 3.73989 2.33989H7.3999V7.3999ZM8.5999 8.5999V13.6599H12.2599C13.0331 13.6599 13.6599 13.0331 13.6599 12.2599V8.5999H8.5999ZM13.6599 7.3999H8.5999V2.33989H12.2599C13.0331 2.33989 13.6599 2.96669 13.6599 3.73989V7.3999Z",fillRule:"evenodd",clipRule:"evenodd"}}]},x3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"all-border-icon",ref:t,icon:wn}))});x3.displayName="AllBorderIcon";const yn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.5999 5.9999C8.5999 5.66853 8.33127 5.3999 7.9999 5.3999C7.66853 5.3999 7.3999 5.66853 7.3999 5.9999V7.40329L6.004 7.4051C5.67263 7.40553 5.40435 7.67451 5.40479 8.00588C5.40522 8.33725 5.6742 8.60553 6.00557 8.6051L7.3999 8.60329V9.9999C7.3999 10.3313 7.66853 10.5999 7.9999 10.5999C8.33127 10.5999 8.5999 10.3313 8.5999 9.9999V8.60172L10.0004 8.5999C10.3317 8.59947 10.6 8.33049 10.5996 7.99912C10.5992 7.66775 10.3302 7.39947 9.9988 7.3999L8.5999 7.40172V5.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.99958 1.73315C4.53861 1.73315 1.73291 4.53885 1.73291 7.99982C1.73291 11.4608 4.53861 14.2665 7.99958 14.2665C9.51395 14.2665 10.9029 13.7293 11.9862 12.8351L13.2422 14.0908C13.4765 14.3251 13.8564 14.3251 14.0907 14.0907C14.325 13.8564 14.325 13.4765 14.0906 13.2422L12.8347 11.9866C13.729 10.9033 14.2662 9.51428 14.2662 7.99982C14.2662 4.53885 11.4605 1.73315 7.99958 1.73315ZM2.93291 7.99982C2.93291 5.20159 5.20135 2.93315 7.99958 2.93315C10.7978 2.93315 13.0662 5.20159 13.0662 7.99982C13.0662 10.7981 10.7978 13.0665 7.99958 13.0665C5.20135 13.0665 2.93291 10.7981 2.93291 7.99982Z",fillRule:"evenodd",clipRule:"evenodd"}}]},$3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"amplify-icon",ref:t,icon:yn}))});$3.displayName="AmplifyIcon";const In={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.2001C2.5999 1.86873 2.33127 1.6001 1.9999 1.6001C1.66853 1.6001 1.3999 1.86873 1.3999 2.2001V13.8001C1.3999 14.1315 1.66853 14.4001 1.9999 14.4001C2.33127 14.4001 2.5999 14.1315 2.5999 13.8001V2.2001Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.5999 2.2001C14.5999 1.86873 14.3313 1.6001 13.9999 1.6001C13.6685 1.6001 13.3999 1.86873 13.3999 2.2001V13.8001C13.3999 14.1315 13.6685 14.4001 13.9999 14.4001C14.3313 14.4001 14.5999 14.1315 14.5999 13.8001V2.2001Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.424 8.24239C6.65832 8.4767 6.65832 8.8566 6.424 9.09091L6.11502 9.3999H9.33307C10.1063 9.3999 10.7331 8.7731 10.7331 7.9999C10.7331 7.22671 10.1063 6.5999 9.33307 6.5999H4.6666L4.66645 5.3999H9.33307C10.769 5.3999 11.9331 6.56396 11.9331 7.9999C11.9331 9.43584 10.769 10.5999 9.33307 10.5999H6.11485L6.424 10.9091C6.65832 11.1434 6.65832 11.5233 6.424 11.7576C6.18969 11.9919 5.80979 11.9919 5.57548 11.7576L4.24214 10.4242C4.00783 10.1899 4.00783 9.81003 4.24214 9.57572L5.57548 8.24239C5.80979 8.00807 6.18969 8.00807 6.424 8.24239Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.6666 6.5999C4.33523 6.5999 4.06641 6.33127 4.06641 5.9999C4.06641 5.66853 4.33508 5.3999 4.66645 5.3999L4.6666 6.5999Z"}}]},Z3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"autowrap-icon",ref:t,icon:In}))});Z3.displayName="AutowrapIcon";const Mn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.36977 4.66364C2.67525 3.75535 3.95995 3.75535 4.26543 4.66364L6.0261 9.89866C6.13173 10.2127 5.96275 10.553 5.64867 10.6586C5.33459 10.7643 4.99434 10.5953 4.8887 10.2812L3.3176 5.60982L1.7465 10.2812C1.64086 10.5953 1.30062 10.7643 0.986532 10.6586C0.672449 10.553 0.503468 10.2127 0.609102 9.89866L2.36977 4.66364Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.6333 7.87051C1.6333 7.53914 1.90193 7.27051 2.2333 7.27051H4.52594C4.85732 7.27051 5.12594 7.53914 5.12594 7.87051C5.12594 8.20188 4.85732 8.47051 4.52594 8.47051H2.2333C1.90193 8.47051 1.6333 8.20188 1.6333 7.87051Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.26385 10.0162C8.9281 10.853 7.74343 10.853 7.40768 10.0162L6.02978 6.58181C5.90639 6.27427 6.05568 5.92493 6.36322 5.80154C6.67076 5.67815 7.0201 5.82744 7.14349 6.13498L8.33577 9.10668L9.52805 6.13498C9.65143 5.82744 10.0008 5.67815 10.3083 5.80154C10.6159 5.92493 10.7651 6.27427 10.6418 6.58181L9.26385 10.0162Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.8178 5.68628C15.1491 5.68628 15.4178 5.95491 15.4178 6.28628L15.4178 10.845C15.4178 11.9648 14.51 12.8726 13.3901 12.8726H12.8888C11.8122 12.8726 10.9395 11.9999 10.9395 10.9233C10.9395 10.5919 11.2081 10.3233 11.5395 10.3233C11.8708 10.3233 12.1395 10.5919 12.1395 10.9233C12.1395 11.3371 12.4749 11.6726 12.8888 11.6726H13.3901C13.8472 11.6726 14.2178 11.3021 14.2178 10.845L14.2178 6.28628C14.2178 5.95491 14.4864 5.68628 14.8178 5.68628Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.9395 7.82632C10.9395 6.58966 11.942 5.58716 13.1786 5.58716C14.4153 5.58716 15.4178 6.58966 15.4178 7.82632C15.4178 9.06297 14.4153 10.0655 13.1786 10.0655C11.942 10.0655 10.9395 9.06297 10.9395 7.82632ZM13.1786 6.78716C12.6047 6.78716 12.1395 7.2524 12.1395 7.82632C12.1395 8.40023 12.6047 8.86547 13.1786 8.86547C13.7525 8.86547 14.2178 8.40023 14.2178 7.82632C14.2178 7.2524 13.7525 6.78716 13.1786 6.78716Z",fillRule:"evenodd",clipRule:"evenodd"}}]},A3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"avg-icon",ref:t,icon:Mn}))});A3.displayName="AvgIcon";const _n={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.65791 1.30005C3.77355 1.30005 3.05664 2.01696 3.05664 2.90132V12.8588C3.05664 13.8755 3.88086 14.6998 4.89759 14.6998H9.1016C11.2233 14.6998 12.9433 12.9798 12.9433 10.8581C12.9433 9.13925 11.8145 7.68407 10.2578 7.1934C10.8806 6.56856 11.2655 5.70659 11.2655 4.75472C11.2655 2.84676 9.71883 1.30005 7.81087 1.30005H4.65791ZM4.25664 2.90132C4.25664 2.6797 4.4363 2.50005 4.65791 2.50005H7.81087C9.05609 2.50005 10.0655 3.5095 10.0655 4.75472C10.0655 5.99993 9.05609 7.00938 7.81087 7.00938H4.25664V2.90132ZM4.25664 12.8588V8.21636H9.1016C10.5606 8.21636 11.7433 9.39909 11.7433 10.8581C11.7433 12.317 10.5606 13.4998 9.1016 13.4998H4.89759C4.5436 13.4998 4.25664 13.2128 4.25664 12.8588Z",fillRule:"evenodd",clipRule:"evenodd"}}]},P3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"bold-icon",ref:t,icon:_n}))});P3.displayName="BoldIcon";const Sn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.59219 1.3667C1.70853 1.3667 0.992188 2.08304 0.992188 2.9667V4.9667C0.992188 5.85036 1.70853 6.5667 2.59219 6.5667H11.2694C12.1531 6.5667 12.8694 5.85036 12.8694 4.9667V4.79985H13.8075V8.18642C13.8075 8.38777 13.6579 8.55773 13.4581 8.58321L7.10511 9.39341C6.30618 9.4953 5.70752 10.1752 5.70752 10.9806V14.0332C5.70752 14.3646 5.97615 14.6332 6.30752 14.6332C6.63889 14.6332 6.90752 14.3646 6.90752 14.0332V10.9806C6.90752 10.7792 7.05718 10.6092 7.25692 10.5838L13.6099 9.77356C14.4089 9.67168 15.0075 8.99182 15.0075 8.18642V4.19985C15.0075 3.86848 14.7389 3.59985 14.4075 3.59985H12.8694V2.9667C12.8694 2.08304 12.1531 1.3667 11.2694 1.3667H2.59219ZM2.19219 2.9667C2.19219 2.74579 2.37127 2.5667 2.59219 2.5667H11.2694C11.4903 2.5667 11.6694 2.74579 11.6694 2.9667V4.9667C11.6694 5.18761 11.4903 5.3667 11.2694 5.3667H2.59219C2.37127 5.3667 2.19219 5.18761 2.19219 4.9667V2.9667Z",fillRule:"evenodd",clipRule:"evenodd"}}]},F3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"brush-icon",ref:t,icon:Sn}))});F3.displayName="BrushIcon";const Hn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C13.6961 1.13989 14.8601 2.30395 14.8601 3.73989V4.86989C14.8601 5.20126 14.5915 5.46989 14.2601 5.46989C13.9288 5.46989 13.6601 5.20126 13.6601 4.86989V3.73989C13.6601 2.96669 13.0333 2.33989 12.2601 2.33989H8.34014V3.20284C8.34014 3.20446 8.34014 3.20608 8.34014 3.2077V6.73989C8.34014 7.62355 7.62379 8.33989 6.74014 8.33989H2.70277C2.70112 8.3399 2.69947 8.3399 2.69781 8.33989H2.34014V12.2599C2.34014 13.0331 2.96694 13.6599 3.74014 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V11.7299C13.6601 11.3985 13.9288 11.1299 14.2601 11.1299C14.5915 11.1299 14.8601 11.3985 14.8601 11.7299V12.2599C14.8601 13.6958 13.6961 14.8599 12.2601 14.8599H3.74014C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM4.26409 7.13989H6.74014C6.96105 7.13989 7.14014 6.96081 7.14014 6.73989V4.55237L4.26409 7.13989ZM7.14014 2.93819V2.33989H6.28159L2.34044 5.614L2.34056 7.13989H2.46992L7.14014 2.93819ZM2.34032 4.05403L4.40368 2.33989H3.74029C2.96705 2.33989 2.34023 2.96676 2.34029 3.74L2.34032 4.05403Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.73877 9.00298C8.73877 9.55526 9.18649 10.003 9.73877 10.003H11.7792C12.1106 10.003 12.3792 9.73435 12.3792 9.40298C12.3792 9.07161 12.1106 8.80298 11.7792 8.80298H10.7874L12.2304 7.36157C12.7051 6.88734 13.4743 6.88754 13.9488 7.36202C14.4234 7.83667 14.4234 8.60624 13.9488 9.0809L13.2095 9.82016C12.9752 10.0545 12.9752 10.4344 13.2095 10.6687C13.4439 10.903 13.8238 10.903 14.0581 10.6687L14.7973 9.92943C15.7406 8.98614 15.7406 7.45678 14.7973 6.51349C13.8544 5.57056 12.3257 5.57015 11.3823 6.51259L9.93877 7.95459V6.96255C9.93877 6.63118 9.67014 6.36255 9.33877 6.36255C9.0074 6.36255 8.73877 6.63118 8.73877 6.96255V9.00298Z"}}]},k3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cancel-freeze-icon",ref:t,icon:Hn}))});k3.displayName="CancelFreezeIcon";const En={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.5939 1.13916L10.6607 1.1392C9.55628 1.13922 8.66093 2.03448 8.66077 3.13893L8.66063 4.19191C8.66059 4.52328 8.92918 4.79194 9.26055 4.79199C9.59192 4.79204 9.86059 4.52344 9.86063 4.19207L9.86077 3.13909C9.86084 2.69731 10.219 2.33921 10.6608 2.3392L12.594 2.33916C13.0358 2.33915 13.394 2.69732 13.394 3.13916L13.394 12.8612C13.394 13.303 13.0358 13.6612 12.594 13.6612H10.6606C10.2188 13.6612 9.86063 13.303 9.86063 12.8612V11.8084C9.86063 11.4771 9.592 11.2084 9.26063 11.2084C8.92926 11.2084 8.66063 11.4771 8.66063 11.8084V12.8612C8.66063 13.9658 9.55606 14.8612 10.6606 14.8612H12.594C13.6986 14.8612 14.594 13.9658 14.594 12.8612L14.594 3.13915C14.594 2.03457 13.6985 1.13914 12.5939 1.13916Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.33888 1.13919L3.40568 1.13926C2.30114 1.13931 1.40575 2.03474 1.40576 3.13928L1.40586 12.8612C1.40587 13.9658 2.3013 14.8612 3.40586 14.8612H5.33896C6.44353 14.8612 7.33896 13.9658 7.33896 12.8612V11.8084C7.33896 11.4771 7.07033 11.2084 6.73896 11.2084C6.40759 11.2084 6.13896 11.4771 6.13896 11.8084V12.8612C6.13896 13.303 5.78079 13.6612 5.33896 13.6612H3.40586C2.96403 13.6612 2.60586 13.303 2.60586 12.8612L2.60576 3.13927C2.60576 2.69745 2.96391 2.33928 3.40573 2.33926L5.33893 2.33919C5.78077 2.33917 6.13896 2.69735 6.13896 3.13919V4.192C6.13896 4.52337 6.40759 4.792 6.73896 4.792C7.07033 4.792 7.33896 4.52337 7.33896 4.192V3.13919C7.33896 2.03459 6.44348 1.13914 5.33888 1.13919Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.20731 5.99993C8.973 6.23424 8.973 6.61414 9.20731 6.84845L10.0912 7.73235C10.2474 7.88856 10.2474 8.14182 10.0912 8.29803L9.20731 9.18192C8.973 9.41624 8.973 9.79614 9.20731 10.0305C9.44163 10.2648 9.82153 10.2648 10.0558 10.0305L10.9397 9.14654C11.5646 8.52171 11.5646 7.50867 10.9397 6.88384L10.0558 5.99993C9.82153 5.76561 9.44163 5.76561 9.20731 5.99993Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.94379 5.99993C6.1781 5.76561 6.558 5.76561 6.79232 5.99993C7.02663 6.23424 7.02663 6.61414 6.79232 6.84845L5.90842 7.73235C5.75221 7.88856 5.75221 8.14182 5.90842 8.29803L6.79232 9.18193C7.02663 9.41624 7.02663 9.79614 6.79232 10.0305C6.558 10.2648 6.1781 10.2648 5.94379 10.0305L5.0599 9.14656C4.43506 8.52172 4.43506 7.50866 5.0599 6.88382L5.94379 5.99993Z"}}]},B3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cancel-merge-icon",ref:t,icon:En}))});B3.displayName="CancelMergeIcon";const Dn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},De=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"check-mark-icon",ref:t,icon:Dn}))});De.displayName="CheckMarkIcon";const On={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},Oe=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"close-icon",ref:t,icon:On}))});Oe.displayName="CloseIcon";const Rn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.361328 7.79626C0.361328 6.0459 1.78028 4.62695 3.53064 4.62695C4.18424 4.62695 4.80612 4.90867 5.23714 5.40001L5.30149 5.47337C5.52001 5.72247 5.49522 6.10156 5.24612 6.32009C4.99701 6.53861 4.61792 6.51382 4.3994 6.26471L4.33504 6.19135C4.13187 5.95975 3.83873 5.82695 3.53064 5.82695C2.44302 5.82695 1.56133 6.70864 1.56133 7.79626V8.21416C1.56133 9.29594 2.43828 10.1729 3.52006 10.1729C3.83123 10.1729 4.12678 10.0366 4.32877 9.79988L4.39405 9.72339C4.60916 9.47133 4.98788 9.44138 5.23994 9.65649C5.492 9.8716 5.52195 10.2503 5.30684 10.5024L5.24156 10.5789C4.81157 11.0827 4.18244 11.3729 3.52006 11.3729C1.77554 11.3729 0.361328 9.95868 0.361328 8.21416V7.79626Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.2084 4.92822C13.5398 4.92822 13.8084 5.19685 13.8084 5.52822V9.97297C13.8084 10.0834 13.8979 10.173 14.0084 10.173H15.0384C15.3698 10.173 15.6384 10.4416 15.6384 10.773C15.6384 11.1043 15.3698 11.373 15.0384 11.373H14.0084C13.2352 11.373 12.6084 10.7462 12.6084 9.97297V5.52822C12.6084 5.19685 12.877 4.92822 13.2084 4.92822Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.9893 7.42715C10.9893 7.09578 11.2579 6.82715 11.5893 6.82715H14.9428C15.2742 6.82715 15.5428 7.09578 15.5428 7.42715C15.5428 7.75852 15.2742 8.02715 14.9428 8.02715H11.5893C11.2579 8.02715 10.9893 7.75852 10.9893 7.42715Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.46366 8.71622C9.46366 8.18879 8.9622 7.80569 8.45332 7.94436L8.12019 8.03514C7.68503 8.15373 7.38311 8.54894 7.38311 8.99996V10.7731C7.38311 11.1044 7.11448 11.3731 6.78311 11.3731C6.45173 11.3731 6.18311 11.1044 6.18311 10.7731V8.99996C6.18311 8.0077 6.84733 7.13825 7.80469 6.87736L8.13782 6.78658C9.41001 6.43991 10.6637 7.39764 10.6637 8.71622V10.7731C10.6637 11.1044 10.395 11.3731 10.0637 11.3731C9.73229 11.3731 9.46366 11.1044 9.46366 10.7731V8.71622Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.79079 6.75531C7.12216 6.75528 7.39081 7.02389 7.39084 7.35526L7.39109 10.773C7.39112 11.1043 7.12251 11.373 6.79114 11.373C6.45977 11.373 6.19112 11.1044 6.19109 10.7731L6.19084 7.35535C6.19081 7.02398 6.45942 6.75533 6.79079 6.75531Z",fillRule:"evenodd",clipRule:"evenodd"}}]},U3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"cnt-icon",ref:t,icon:Rn}))});U3.displayName="CntIcon";const Vn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.92206 2.45064C9.98634 2.12556 9.77492 1.80992 9.44984 1.74564C9.12477 1.68136 8.80913 1.89278 8.74485 2.21785L6.41152 14.0179C6.34724 14.3429 6.55865 14.6586 6.88373 14.7228C7.20881 14.7871 7.52444 14.5757 7.58872 14.2506L9.92206 2.45064Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.14972 3.90157C5.38815 4.1317 5.39487 4.51154 5.16473 4.74996L2.55461 7.45409C2.01739 8.01066 2.03336 8.89745 2.59029 9.43431L5.14944 11.9013C5.38802 12.1313 5.39498 12.5111 5.165 12.7497C4.93502 12.9883 4.55519 12.9952 4.31662 12.7652L1.75746 10.2983C0.723174 9.30122 0.693506 7.65434 1.69121 6.6207L4.30133 3.91657C4.53146 3.67815 4.9113 3.67143 5.14972 3.90157Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.8505 3.90157C11.0889 3.67143 11.4688 3.67815 11.6989 3.91657L14.309 6.6207C15.3067 7.65434 15.2771 9.30122 14.2428 10.2983L11.6836 12.7652C11.4451 12.9952 11.0652 12.9883 10.8352 12.7497C10.6053 12.5111 10.6122 12.1313 10.8508 11.9013L13.41 9.43431C13.9669 8.89745 13.9829 8.01066 13.4456 7.45409L10.8355 4.74996C10.6054 4.51154 10.6121 4.1317 10.8505 3.90157Z"}}]},j3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"code-icon",ref:t,icon:Vn}))});j3.displayName="CodeIcon";const Nn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8 0.866961C5.018 0.866961 2 1.78296 2 3.53363V12.3675C2 14.1182 5.018 15.0342 8 15.0342C10.982 15.0342 14 14.1182 14 12.3675V3.53363C14 1.78296 10.982 0.866961 8 0.866961ZM12.6667 12.3675C12.6667 12.7542 11.0313 13.7008 8 13.7008C4.96867 13.7008 3.33333 12.7542 3.33333 12.3675V9.86434C4.49067 10.4797 6.24933 10.7977 8 10.7977C9.75067 10.7977 11.5093 10.4797 12.6667 9.86434V12.3675ZM12.6667 8.131C12.6667 8.51767 11.0313 9.46434 8 9.46434C4.96867 9.46434 3.33333 8.51767 3.33333 8.131L3.33333 5.26696C4.49067 5.88229 6.24933 6.20029 8 6.20029C9.75067 6.20029 11.5093 5.88229 12.6667 5.26696V8.131ZM8 4.86696C4.96867 4.86696 3.33333 3.92029 3.33333 3.53363C3.33333 3.14696 4.96867 2.20029 8 2.20029C11.0313 2.20029 12.6667 3.14696 12.6667 3.53363C12.6667 3.92029 11.0313 4.86696 8 4.86696Z"}}]},z3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"database-icon",ref:t,icon:Nn}))});z3.displayName="DatabaseIcon";const Tn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.00004 1.3335C2.07957 1.3335 1.33337 2.07969 1.33337 3.00016V13.0002C1.33337 13.9143 2.06935 14.6566 2.98108 14.6667C2.99252 14.6671 3.00399 14.6671 3.01547 14.6668H13C13.9205 14.6668 14.6667 13.9207 14.6667 13.0002V11.8335C14.6667 11.4653 14.3682 11.1668 14 11.1668C13.6319 11.1668 13.3334 11.4653 13.3334 11.8335V13.0002C13.3334 13.1843 13.1842 13.3335 13 13.3335H5.25636C5.61522 13.016 5.95119 12.6637 6.25105 12.2868C7.06748 11.2609 7.66671 9.98799 7.66671 8.66683V2.66683H13C13.1841 2.66683 13.3334 2.81606 13.3334 3.00016V4.66683C13.3334 5.03502 13.6319 5.3335 14 5.3335C14.3682 5.3335 14.6667 5.03502 14.6667 4.66683V3.00016C14.6667 2.0797 13.9205 1.3335 13 1.3335H3.00004ZM6.33337 2.66683H3.00004C2.81595 2.66683 2.66671 2.81607 2.66671 3.00016V13.0002C2.66671 13.1484 2.76345 13.274 2.89725 13.3173C3.70845 12.9437 4.55406 12.2781 5.20773 11.4566C5.90507 10.5803 6.33337 9.59203 6.33337 8.66683V2.66683Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4714 5.86209C12.2111 5.60174 11.789 5.60174 11.5286 5.86209C11.2683 6.12244 11.2683 6.54455 11.5286 6.8049L12.3906 7.66683H10C9.63185 7.66683 9.33337 7.96531 9.33337 8.3335C9.33337 8.70169 9.63185 9.00016 10 9.00016H12.3906L11.5286 9.86209C11.2683 10.1224 11.2683 10.5446 11.5286 10.8049C11.789 11.0653 12.2111 11.0653 12.4714 10.8049L14.4714 8.8049C14.5935 8.68286 14.6583 8.52528 14.6659 8.36548C14.6665 8.35482 14.6667 8.34416 14.6667 8.3335L12.4714 5.86209Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4714 5.86209L14.4714 7.86209C14.6001 7.9907 14.6651 8.15878 14.6667 8.32734L12.4714 5.86209Z"}}]},W3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"direct-export-icon",ref:t,icon:Tn}))});W3.displayName="DirectExportIcon";const xn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.3999 2.8999V1.6C7.3999 1.26863 7.66853 1 7.9999 1C8.33127 1 8.5999 1.26863 8.5999 1.6V2.8999H10.2044C11.6655 2.8999 12.8499 4.08431 12.8499 5.54536C12.8499 5.87673 12.5813 6.14536 12.2499 6.14536C11.9185 6.14536 11.6499 5.87673 11.6499 5.54536C11.6499 4.74705 11.0028 4.0999 10.2044 4.0999H5.7384C4.97155 4.0999 4.3499 4.72155 4.3499 5.4884C4.3499 6.14439 4.80899 6.71087 5.45074 6.84677L10.7977 7.97906C11.994 8.23242 12.8499 9.28849 12.8499 10.5114C12.8499 11.941 11.691 13.0999 10.2614 13.0999H8.5999V14.4C8.5999 14.7314 8.33127 15 7.9999 15C7.66853 15 7.3999 14.7314 7.3999 14.4V13.0999H5.79536C4.33431 13.0999 3.1499 11.9155 3.1499 10.4544C3.1499 10.1231 3.41853 9.85445 3.7499 9.85445C4.08127 9.85445 4.3499 10.1231 4.3499 10.4544C4.3499 11.2527 4.99705 11.8999 5.79536 11.8999H10.2614C11.0283 11.8999 11.6499 11.2782 11.6499 10.5114C11.6499 9.85542 11.1908 9.28893 10.5491 9.15303L5.20214 8.02074C4.00575 7.76739 3.1499 6.71132 3.1499 5.4884C3.1499 4.05881 4.30881 2.8999 5.7384 2.8999H7.3999Z"}}]},G3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"dollar-icon",ref:t,icon:xn}))});G3.displayName="DollarIcon";const $n={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.84964 5.80918C6.71946 3.63548 8.84516 2.2 11.3295 2.2C11.8324 2.2 12.3198 2.26279 12.7846 2.38065C13.1058 2.46209 13.4322 2.26773 13.5137 1.94652C13.5951 1.62532 13.4008 1.2989 13.0795 1.21746C12.5191 1.07535 11.9327 1 11.3295 1C8.17278 1 5.49724 2.96009 4.57394 5.80918H3.06582C2.73445 5.80918 2.46582 6.07781 2.46582 6.40918C2.46582 6.74055 2.73445 7.00918 3.06582 7.00918H4.29808C4.25287 7.33297 4.22949 7.66376 4.22949 8C4.22949 8.33608 4.25284 8.6667 4.29801 8.99033H3.06582C2.73445 8.99033 2.46582 9.25896 2.46582 9.59033C2.46582 9.9217 2.73445 10.1903 3.06582 10.1903H4.57378C5.49693 13.0397 8.1726 15 11.3295 15C11.9336 15 12.5209 14.9244 13.0821 14.7819C13.4033 14.7003 13.5975 14.3738 13.5159 14.0527C13.4344 13.7315 13.1079 13.5373 12.7867 13.6188C12.3213 13.737 11.8332 13.8 11.3295 13.8C8.84497 13.8 6.71914 12.3643 5.84944 10.1903H11.4291C11.7605 10.1903 12.0291 9.9217 12.0291 9.59033C12.0291 9.25896 11.7605 8.99033 11.4291 8.99033H5.51225C5.45783 8.66834 5.42949 8.33748 5.42949 8C5.42949 7.66235 5.45786 7.33133 5.51233 7.00918H11.4291C11.7605 7.00918 12.0291 6.74055 12.0291 6.40918C12.0291 6.07781 11.7605 5.80918 11.4291 5.80918H5.84964Z"}}]},Y3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"euro-icon",ref:t,icon:$n}))});Y3.displayName="EuroIcon";const Zn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.65005 1.05005C2.21411 1.05005 1.05005 2.21411 1.05005 3.65005V12.35C1.05005 13.7859 2.21411 14.95 3.65005 14.95H14.35C14.6813 14.95 14.95 14.6813 14.95 14.35C14.95 14.0186 14.6813 13.75 14.35 13.75H3.65005C2.87685 13.75 2.25005 13.1232 2.25005 12.35V3.65005C2.25005 2.87685 2.87685 2.25005 3.65005 2.25005H14.35C14.6813 2.25005 14.95 1.98142 14.95 1.65005C14.95 1.31868 14.6813 1.05005 14.35 1.05005H3.65005Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.6167 5.26668C11.851 5.03236 12.2309 5.03236 12.4652 5.26668L14.7743 7.57575C15.0086 7.81007 15.0086 8.18997 14.7743 8.42428L12.4652 10.7334C12.2309 10.9677 11.851 10.9677 11.6167 10.7334C11.3823 10.499 11.3823 10.1191 11.6167 9.88483L12.9015 8.60002H6.63784C6.30647 8.60002 6.03784 8.3314 6.03784 8.00002C6.03784 7.66865 6.30647 7.40002 6.63784 7.40002H12.9015L11.6167 6.11521C11.3823 5.88089 11.3823 5.50099 11.6167 5.26668Z"}}]},X3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"export-icon",ref:t,icon:Zn}))});X3.displayName="ExportIcon";const An={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.46613 5.2614C7.99641 5.15377 8.54607 5.209 9.04566 5.42016C9.54527 5.63133 9.9725 5.98902 10.2732 6.44821C10.5739 6.90741 10.7345 7.44742 10.7345 7.99994C10.7345 8.74088 10.446 9.45122 9.93293 9.97475C9.41991 10.4982 8.72439 10.7921 7.99945 10.7921C7.45882 10.7921 6.93021 10.6285 6.48047 10.3219C6.03072 10.0152 5.67998 9.57922 5.47282 9.06887C5.26565 8.55852 5.21142 7.99686 5.31705 7.45498C5.42268 6.9131 5.68338 6.41554 6.06598 6.02513C6.44856 5.63474 6.93584 5.36903 7.46613 5.2614ZM7.99945 6.50637C7.70941 6.50637 7.42599 6.59414 7.18504 6.75842C6.94411 6.92269 6.75652 7.15604 6.64579 7.4288C6.53508 7.70156 6.50613 8.00161 6.56255 8.29108C6.61898 8.58055 6.7583 8.84663 6.96308 9.05559C7.16788 9.26456 7.42896 9.40703 7.7134 9.46476C7.99784 9.5225 8.29266 9.49286 8.56052 9.37964C8.82836 9.26643 9.05707 9.07481 9.21789 8.82922C9.3787 8.58364 9.46445 8.29505 9.46445 7.99994C9.46445 7.60424 9.31042 7.22449 9.03583 6.94429C8.76119 6.66405 8.38842 6.50637 7.99945 6.50637Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.06445 7.99994C1.06445 7.86432 1.111 7.68433 1.20506 7.46997C1.29865 7.25669 1.43723 7.01393 1.61634 6.75416C1.97451 6.23466 2.49209 5.65088 3.12753 5.10347C4.3995 4.00771 6.13495 3.06494 7.99945 3.06494C9.86395 3.06494 11.5994 4.00771 12.8714 5.10347C13.5068 5.65088 14.0244 6.23466 14.3826 6.75416C14.5617 7.01393 14.7003 7.25669 14.7938 7.46997C14.8879 7.68433 14.9345 7.86432 14.9345 7.99994C14.9345 8.29406 14.7859 8.75016 14.4847 9.27371C14.1847 9.79497 13.7374 10.3759 13.1495 10.9188C11.974 12.0042 10.2392 12.9349 7.99945 12.9349C5.75972 12.9349 4.02489 12.0042 2.84937 10.9188C2.26147 10.3759 1.81418 9.79497 1.51423 9.27371C1.21296 8.75016 1.06445 8.29406 1.06445 7.99994ZM7.99945 4.36351C6.48933 4.36351 5.14092 5.09788 4.14125 5.91406C3.64087 6.32258 3.22616 6.75295 2.92026 7.12521C2.61595 7.49554 2.415 7.81359 2.34753 7.99756L2.33827 8.0228L2.34954 8.0472C2.85275 9.13669 3.65354 10.055 4.65594 10.6918C5.65805 11.3283 6.81899 11.6563 7.99945 11.6364C9.17991 11.6563 10.3409 11.3283 11.343 10.6918C12.3454 10.055 13.1462 9.13669 13.6494 8.0472L13.6606 8.0228L13.6514 7.99756C13.5839 7.81359 13.383 7.49554 13.0786 7.12521C12.7727 6.75295 12.358 6.32258 11.8577 5.91406C10.858 5.09788 9.50957 4.36351 7.99945 4.36351Z",fillRule:"evenodd",clipRule:"evenodd"}}]},q3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"eye-icon",ref:t,icon:An}))});q3.displayName="EyeIcon";const Pn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.99967 10.6663C7.47226 10.6663 6.95669 10.5099 6.51815 10.2169C6.07962 9.92391 5.73783 9.50743 5.536 9.02016C5.33416 8.53289 5.28135 7.99672 5.38425 7.47943C5.48714 6.96215 5.74112 6.487 6.11406 6.11406C6.487 5.74112 6.96215 5.48714 7.47943 5.38425C7.99672 5.28135 8.53289 5.33416 9.02016 5.536C9.50743 5.73783 9.92391 6.07962 10.2169 6.51815C10.5099 6.95669 10.6663 7.47226 10.6663 7.99967C10.6663 8.70692 10.3854 9.3852 9.88529 9.88529C9.3852 10.3854 8.70692 10.6663 7.99967 10.6663ZM7.99967 6.66634C7.73597 6.66634 7.47818 6.74454 7.25891 6.89105C7.03965 7.03756 6.86875 7.2458 6.76784 7.48943C6.66692 7.73306 6.64051 8.00115 6.69196 8.25979C6.74341 8.51844 6.8704 8.75601 7.05687 8.94248C7.24334 9.12895 7.48091 9.25594 7.73955 9.30739C7.9982 9.35883 8.26628 9.33243 8.50992 9.23151C8.75355 9.1306 8.96179 8.9597 9.1083 8.74043C9.25481 8.52117 9.33301 8.26338 9.33301 7.99967C9.33301 7.64605 9.19253 7.30691 8.94248 7.05687C8.69243 6.80682 8.3533 6.66634 7.99967 6.66634Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.99967 12.6663C3.69701 12.6663 1.33301 9.16101 1.33301 7.99967C1.33301 6.89034 4.40767 3.33301 7.99967 3.33301C11.5917 3.33301 14.6663 6.89034 14.6663 7.99967C14.6663 9.16101 12.3023 12.6663 7.99967 12.6663ZM2.67501 8.01834C3.14932 9.02475 3.90405 9.87286 4.84857 10.4608C5.79309 11.0488 6.88725 11.3517 7.99967 11.333C9.1121 11.3517 10.2063 11.0488 11.1508 10.4608C12.0953 9.87286 12.85 9.02475 13.3243 8.01834C13.0823 7.37167 10.8363 4.66634 7.99967 4.66634C5.16301 4.66634 2.91701 7.37167 2.67501 8.01834Z"}}]},J3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"eye-outline-icon",ref:t,icon:Pn}))});J3.displayName="EyeOutlineIcon";const Fn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.571533 12.0016V4.69797C0.571533 3.37249 1.64605 2.29797 2.97153 2.29797H5.00397C5.90947 2.29797 6.77882 2.65328 7.42511 3.2875C7.84704 3.70155 8.4146 3.93351 9.00576 3.93351H11.6938C12.8536 3.93351 13.7938 4.87372 13.7938 6.03351V6.83533H13.8982C15.064 6.83533 15.8384 8.04207 15.3527 9.10188L13.6724 12.7686C13.4118 13.3374 12.8435 13.702 12.2179 13.702H2.17045C1.20587 13.702 0.515561 12.8793 0.571533 12.0016ZM1.77153 4.69797C1.77153 4.03523 2.30879 3.49797 2.97153 3.49797H5.00397C5.59513 3.49797 6.16269 3.72993 6.58462 4.14399C7.23091 4.77821 8.10026 5.13351 9.00576 5.13351H11.6938C12.1909 5.13351 12.5938 5.53646 12.5938 6.03351V6.83533H4.64069C3.6604 6.83533 2.76344 7.38669 2.32081 8.26136L1.77153 9.34679V4.69797ZM1.77153 12.1373V12.0664C1.77594 12.0179 1.78952 11.9689 1.81355 11.9214L3.39152 8.80319C3.62986 8.33222 4.11284 8.03533 4.64069 8.03533H13.8982C14.1896 8.03533 14.3832 8.33701 14.2618 8.60197L12.5815 12.2687C12.5164 12.4109 12.3743 12.502 12.2179 12.502H2.17045C1.95161 12.502 1.78924 12.3326 1.77153 12.1373Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Q3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"folder-icon",ref:t,icon:Fn}))});Q3.displayName="FolderIcon";const kn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.92494 2.4224C5.37364 1.19807 7.10523 1.19807 7.55394 2.4224L11.7284 13.8128C11.8425 14.124 11.6827 14.4686 11.3716 14.5827C11.0604 14.6967 10.7158 14.5369 10.6017 14.2258L9.02773 9.93099C9.02555 9.93101 9.02338 9.93102 9.0212 9.93102H3.74372C3.6469 9.93102 3.55544 9.90809 3.47447 9.86736L1.87714 14.2258C1.76312 14.5369 1.41845 14.6967 1.10732 14.5827C0.796186 14.4686 0.636401 14.124 0.750429 13.8128L4.92494 2.4224ZM3.89093 8.73102H8.58795L6.42722 2.83533C6.36312 2.66043 6.11576 2.66042 6.05165 2.83533L3.89093 8.73102Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.0504 2.47954C13.0504 2.14817 12.7818 1.87954 12.4504 1.87954C12.1191 1.87954 11.8504 2.14817 11.8504 2.47954V4.11554H10.2144C9.88305 4.11554 9.61442 4.38417 9.61442 4.71554C9.61442 5.04691 9.88305 5.31554 10.2144 5.31554H11.8504V6.95155C11.8504 7.28292 12.1191 7.55155 12.4504 7.55155C12.7818 7.55155 13.0504 7.28292 13.0504 6.95155V5.31554H14.6864C15.0178 5.31554 15.2864 5.04691 15.2864 4.71554C15.2864 4.38417 15.0178 4.11554 14.6864 4.11554H13.0504V2.47954Z"}}]},K3=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"font-size-increase-icon",ref:t,icon:kn}))});K3.displayName="FontSizeIncreaseIcon";const Bn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.92469 2.4224C5.3734 1.19807 7.10499 1.19807 7.5537 2.4224L11.7282 13.8128C11.8422 14.124 11.6824 14.4686 11.3713 14.5827C11.0602 14.6967 10.7155 14.5369 10.6015 14.2258L9.02748 9.93099C9.02539 9.93101 9.0233 9.93102 9.0212 9.93102H3.74372C3.64682 9.93102 3.55528 9.90805 3.47426 9.86726L1.8769 14.2258C1.76287 14.5369 1.41821 14.6967 1.10708 14.5827C0.795942 14.4686 0.636156 14.124 0.750185 13.8128L4.92469 2.4224ZM3.89068 8.73102H8.58771L6.42698 2.83533C6.36288 2.66043 6.11551 2.66042 6.05141 2.83533L3.89068 8.73102Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.61442 4.71554C9.61442 4.38417 9.88305 4.11554 10.2144 4.11554H14.6864C15.0178 4.11554 15.2864 4.38417 15.2864 4.71554C15.2864 5.04691 15.0178 5.31554 14.6864 5.31554H10.2144C9.88305 5.31554 9.61442 5.04691 9.61442 4.71554Z"}}]},et=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"font-size-reduce-icon",ref:t,icon:Bn}))});et.displayName="FontSizeReduceIcon";const Un={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.14014 12.2599C1.14014 13.6958 2.3042 14.8599 3.74014 14.8599H12.2601C13.6961 14.8599 14.8601 13.6958 14.8601 12.2599V3.73989C14.8601 2.30395 13.6961 1.13989 12.2601 1.13989H3.74014C2.3042 1.13989 1.14014 2.30396 1.14014 3.73989V12.2599ZM2.68766 13.1831C2.47131 12.9367 2.34014 12.6136 2.34014 12.2599V11.9756L5.68213 8.21656V9.69237L2.68766 13.1831ZM3.85969 13.6599H5.68213V11.5354L3.85969 13.6599ZM6.88213 13.6599H12.2601C13.0333 13.6599 13.6601 13.0331 13.6601 12.2599V3.73989C13.6601 2.96669 13.0333 2.33989 12.2601 2.33989H6.88213V13.6599ZM5.68213 2.33989H5.10563L2.34014 5.5448V6.99379L5.68213 3.23472V2.33989ZM2.34014 8.79985V10.1696L5.68213 6.4105V5.04078L2.34014 8.79985ZM2.3405 3.70754L3.50344 2.35982C2.85328 2.47053 2.35588 3.02952 2.3405 3.70754Z",fillRule:"evenodd",clipRule:"evenodd"}}]},tt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"freeze-column-icon",ref:t,icon:Un}))});tt.displayName="FreezeColumnIcon";const jn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.74015 1.13989C2.30421 1.13989 1.14015 2.30396 1.14015 3.73989V5.32866C1.14013 5.33155 1.14013 5.33444 1.14015 5.33732V12.2599C1.14015 13.6958 2.30421 14.8599 3.74015 14.8599H12.2602C13.6961 14.8599 14.8602 13.6958 14.8602 12.2599V3.73989C14.8602 2.46491 13.9424 1.40427 12.7315 1.18251C12.6397 1.14703 12.5407 1.13477 12.4436 1.14626C12.383 1.14204 12.3218 1.13989 12.2602 1.13989H3.74015ZM10.9392 2.33989H9.5695L5.81042 5.68188H7.18015L10.9392 2.33989ZM7.76344 2.33989H6.2816L2.34015 5.61425V5.68188H4.00437L7.76344 2.33989ZM2.34015 6.88188V12.2599C2.34015 13.0331 2.96695 13.6599 3.74015 13.6599H12.2602C13.0334 13.6599 13.6602 13.0331 13.6602 12.2599V6.88188H2.34015ZM13.6602 5.68188V4.48357L12.2714 5.68188H13.6602ZM13.4806 3.05349C13.3067 2.745 13.0193 2.50905 12.675 2.40238L8.98621 5.68188H10.4346L13.4806 3.05349ZM2.34015 4.05418L4.4037 2.33989H3.74015C2.96695 2.33989 2.34015 2.9667 2.34015 3.73989V4.05418Z",fillRule:"evenodd",clipRule:"evenodd"}}]},nt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"freeze-row-icon",ref:t,icon:jn}))});nt.displayName="FreezeRowIcon";const zn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.14014 3.73989C1.14014 2.30396 2.3042 1.13989 3.74014 1.13989H12.2601C12.3218 1.13989 12.383 1.14204 12.4436 1.14627C12.5406 1.13479 12.6397 1.14699 12.7315 1.18252C13.9424 1.4043 14.8601 2.46492 14.8601 3.73989V12.2599C14.8601 13.6905 13.7047 14.8513 12.2761 14.8598L12.2572 14.8599L3.74014 14.8599C2.3042 14.8599 1.14014 13.6958 1.14014 12.2599V3.73989ZM12.2677 13.6599L12.2601 13.6599H7.99297L7.99256 8.10687C7.99254 7.88594 8.17163 7.70684 8.39256 7.70684H13.6572V12.2599C13.6572 13.0296 13.0361 13.6542 12.2677 13.6599ZM8.39256 6.50684H9.82177L13.4929 3.07581C13.3217 2.75868 13.0317 2.51513 12.6826 2.40475L8.25499 6.51267C8.30033 6.50881 8.34621 6.50684 8.39256 6.50684ZM13.6601 4.56202L11.5792 6.50684H13.6601V4.56202ZM6.81297 7.85057C6.79953 7.93405 6.79255 8.01969 6.79256 8.10696L6.79265 9.36615L2.72441 13.2234C2.48625 12.9724 2.34014 12.6332 2.34014 12.2599V12.0005L6.81297 7.85057ZM4.00811 13.6599H6.79297L6.79277 11.0197L4.00811 13.6599ZM9.57168 2.33989H10.9882L2.34014 10.3635V8.8534L9.57168 2.33989ZM7.77864 2.33989L2.34014 7.2384V5.61425L6.28159 2.33989H7.77864ZM4.40368 2.33989L2.34014 4.05418V3.73989C2.34014 2.9667 2.96694 2.33989 3.74014 2.33989H4.40368Z",fillRule:"evenodd",clipRule:"evenodd"}}]},rt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"freeze-to-selected-icon",ref:t,icon:zn}))});rt.displayName="FreezeToSelectedIcon";const Wn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.09318 3.78608C2.21639 2.9026 2.84219 1.3999 4.08689 1.3999H11.2079C11.7676 1.3999 12.3041 1.62335 12.6984 2.02063L13.2584 2.58488C13.4918 2.82009 13.4904 3.19998 13.2552 3.4334C13.02 3.66683 12.6401 3.66538 12.4066 3.43018L11.8467 2.86593C11.6777 2.69566 11.4477 2.5999 11.2079 2.5999H4.08689C3.90907 2.5999 3.81967 2.81458 3.94493 2.94079L8.24218 7.27082C8.66782 7.69971 8.66782 8.39164 8.24218 8.82053L3.94493 13.1506C3.81967 13.2768 3.90907 13.4915 4.08689 13.4915H11.2079C11.4477 13.4915 11.6777 13.3957 11.8467 13.2254L12.4066 12.6612C12.6401 12.426 13.02 12.4245 13.2552 12.658C13.4904 12.8914 13.4918 13.2713 13.2584 13.5065L12.6984 14.0707C12.3041 14.468 11.7676 14.6915 11.2079 14.6915H4.08689C2.84218 14.6915 2.2164 13.1888 3.09318 12.3053L7.32053 8.04568L3.09318 3.78608Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Re=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"function-icon",ref:t,icon:Wn}))});Re.displayName="FunctionIcon";const Gn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.33325 2.60309C1.33325 1.90178 1.90178 1.33325 2.60309 1.33325H13.3967C14.0981 1.33325 14.6666 1.90178 14.6666 2.60309V13.3967C14.6666 14.0981 14.0981 14.6666 13.3967 14.6666H2.60309C1.90178 14.6666 1.33325 14.0981 1.33325 13.3967V2.60309ZM10.5396 13.3967H13.3967V10.5396H10.5396V13.3967ZM9.26976 10.5396V13.3967H6.41262V10.5396H9.26976ZM10.5396 9.26976H13.3967V6.73008H10.5396V9.26976ZM9.26976 6.73008V9.26976H6.41262V6.73008H9.26976ZM10.5396 5.46024H13.3967V2.60309H10.5396V5.46024ZM9.26976 2.60309V5.46024H6.41262V2.60309H9.26976ZM2.60309 2.60309H5.14278V5.46024H2.60309V2.60309ZM2.60309 6.73008H5.14278V9.26976H2.60309V6.73008ZM2.60309 10.5396H5.14278V13.3967H2.60309V10.5396Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ot=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"grid-icon",ref:t,icon:Gn}))});ot.displayName="GridIcon";const Yn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.9999 3.90137C4.66853 3.90137 4.3999 4.17 4.3999 4.50137C4.3999 4.83274 4.66853 5.10137 4.9999 5.10137H10.9999C11.3313 5.10137 11.5999 4.83274 11.5999 4.50137C11.5999 4.17 11.3313 3.90137 10.9999 3.90137H4.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.9999 10.8987C4.66853 10.8987 4.3999 11.1673 4.3999 11.4987C4.3999 11.8301 4.66853 12.0987 4.9999 12.0987H10.9999C11.3313 12.0987 11.5999 11.8301 11.5999 11.4987C11.5999 11.1673 11.3313 10.8987 10.9999 10.8987H4.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.7 2.0999H3.30005C2.85822 2.0999 2.50005 2.45807 2.50005 2.8999V13.0999C2.50005 13.5417 2.85822 13.8999 3.30005 13.8999H12.7C13.1419 13.8999 13.5 13.5417 13.5 13.0999V2.8999C13.5 2.45808 13.1419 2.0999 12.7 2.0999ZM3.30005 0.899902C2.19548 0.899902 1.30005 1.79533 1.30005 2.8999V13.0999C1.30005 14.2045 2.19548 15.0999 3.30005 15.0999H12.7C13.8046 15.0999 14.7 14.2045 14.7 13.0999V2.8999C14.7 1.79533 13.8046 0.899902 12.7 0.899902H3.30005Z",fillRule:"evenodd",clipRule:"evenodd"}}]},it=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"header-footer-icon",ref:t,icon:Yn}))});it.displayName="HeaderFooterIcon";const Xn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.811013 7.27739C0.533711 7.51821 0.50413 7.93822 0.744942 8.21552C0.985753 8.49283 1.40577 8.52241 1.68307 8.28159L1.89249 8.09973V13.0201C1.89249 13.9397 2.63793 14.6851 3.55749 14.6851H5.32136C6.24091 14.6851 6.98636 13.9397 6.98636 13.0201V9.84218C6.98636 9.65717 7.13634 9.50718 7.32136 9.50718H8.67823C8.86325 9.50718 9.01323 9.65716 9.01323 9.84218V13.0201C9.01323 13.9397 9.75868 14.6851 10.6782 14.6851H12.4421C13.3617 14.6851 14.1071 13.9397 14.1071 13.0201V8.09963L14.3165 8.28148C14.5938 8.52229 15.0138 8.49271 15.2546 8.21541C15.4954 7.93811 15.4659 7.51809 15.1886 7.27728L8.567 1.52707C8.24167 1.24456 7.75801 1.24455 7.43267 1.52708L0.811013 7.27739ZM12.7771 6.94465L7.99984 2.79605L3.22249 6.94475V13.0201C3.22249 13.2051 3.37247 13.3551 3.55749 13.3551H5.32136C5.50637 13.3551 5.65636 13.2051 5.65636 13.0201V9.84218C5.65636 8.92263 6.4018 8.17718 7.32136 8.17718H8.67823C9.59779 8.17718 10.3432 8.92263 10.3432 9.84218V13.0201C10.3432 13.2051 10.4932 13.3551 10.6782 13.3551H12.4421C12.6271 13.3551 12.7771 13.2051 12.7771 13.0201V6.94465Z",fillRule:"evenodd",clipRule:"evenodd"}}]},lt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"home-icon",ref:t,icon:Xn}))});lt.displayName="HomeIcon";const qn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.91296 6.82256L5.89774 6.82237L2.83868 6.8223C1.89982 6.82228 1.13874 6.06119 1.13872 5.12234L1.13867 3.32265C1.13865 2.38375 1.89977 1.62261 2.83866 1.62261L5.90639 1.62259L5.91296 1.62256L5.91953 1.62259L10.0821 1.62258L10.0868 1.62256L10.0914 1.62258L13.1607 1.62256C14.0996 1.62256 14.8607 2.38368 14.8607 3.32256V5.12253C14.8607 6.06143 14.0996 6.82256 13.1607 6.82253L10.0975 6.82246L10.0868 6.82256L10.076 6.82246L5.92815 6.82237L5.91296 6.82256ZM10.6868 5.62248L13.1607 5.62253C13.4368 5.62254 13.6607 5.39868 13.6607 5.12253V3.32256C13.6607 3.04642 13.4368 2.82256 13.1607 2.82256L10.6868 2.82257V5.62248ZM9.48679 2.82258V5.62245L6.51296 5.62238V2.82259L9.48679 2.82258ZM5.31296 2.8226V5.62236L2.8387 5.6223C2.56257 5.62229 2.33872 5.39845 2.33872 5.12231L2.33867 3.32262C2.33867 3.04647 2.56252 2.82261 2.83867 2.82261L5.31296 2.8226Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.1387 10.8773L1.13878 12.6773C1.13883 13.6162 1.89994 14.3772 2.8388 14.3772L5.90638 14.3772L5.91296 14.3772L5.91955 14.3772L10.0775 14.3772C10.0806 14.3772 10.0837 14.3772 10.0868 14.3772C10.0899 14.3772 10.093 14.3772 10.0961 14.3772L13.1607 14.3772C14.0996 14.3771 14.8607 13.616 14.8607 12.6772V10.8772C14.8607 9.93836 14.0996 9.17725 13.1607 9.17725H2.8387C1.89978 9.17725 1.13865 9.93841 1.1387 10.8773ZM9.48679 10.3772H6.51296V13.1772L9.48679 13.1772V10.3772ZM10.6868 13.1772V10.3772H13.1607C13.4369 10.3772 13.6607 10.6011 13.6607 10.8772V12.6772C13.6607 12.9533 13.4369 13.1771 13.1607 13.1772L10.6868 13.1772ZM5.31296 13.1772V10.3772H2.8387C2.56254 10.3772 2.33868 10.6011 2.3387 10.8773L2.33878 12.6773C2.33879 12.9534 2.56265 13.1772 2.83879 13.1772L5.31296 13.1772Z",fillRule:"evenodd",clipRule:"evenodd"}}]},st=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"horizontal-merge-icon",ref:t,icon:qn}))});st.displayName="HorizontalMergeIcon";const Jn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},at=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"horizontally-icon",ref:t,icon:Jn}))});at.displayName="HorizontallyIcon";const Qn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},ct=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"increase-icon",ref:t,icon:Qn}))});ct.displayName="IncreaseIcon";const Kn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.00016 1.33203C6.68162 1.33203 5.39269 1.72302 4.29636 2.45557C3.20004 3.18811 2.34555 4.2293 1.84097 5.44747C1.33638 6.66565 1.20436 8.00609 1.4616 9.2993C1.71883 10.5925 2.35377 11.7804 3.28612 12.7127C4.21847 13.6451 5.40636 14.28 6.69956 14.5373C7.99277 14.7945 9.33321 14.6625 10.5514 14.1579C11.7696 13.6533 12.8108 12.7988 13.5433 11.7025C14.2758 10.6062 14.6668 9.31724 14.6668 7.9987C14.6649 6.23118 13.9619 4.53662 12.7121 3.2868C11.4622 2.03697 9.76768 1.33397 8.00016 1.33203ZM7.66683 3.9987C7.86461 3.9987 8.05795 4.05735 8.2224 4.16723C8.38685 4.27711 8.51502 4.43329 8.59071 4.61601C8.6664 4.79874 8.6862 4.99981 8.64762 5.19379C8.60903 5.38777 8.51379 5.56595 8.37394 5.7058C8.23409 5.84566 8.0559 5.9409 7.86192 5.97948C7.66794 6.01807 7.46687 5.99826 7.28415 5.92258C7.10142 5.84689 6.94524 5.71872 6.83536 5.55427C6.72548 5.38982 6.66683 5.19648 6.66683 4.9987C6.66683 4.73348 6.77219 4.47913 6.95972 4.29159C7.14726 4.10405 7.40162 3.9987 7.66683 3.9987ZM9.3335 11.332H6.66683C6.49002 11.332 6.32045 11.2618 6.19543 11.1368C6.0704 11.0117 6.00016 10.8422 6.00016 10.6654C6.00016 10.4886 6.0704 10.319 6.19543 10.194C6.32045 10.0689 6.49002 9.9987 6.66683 9.9987H7.3335V7.9987H6.66683C6.49002 7.9987 6.32045 7.92846 6.19543 7.80343C6.0704 7.67841 6.00016 7.50884 6.00016 7.33203C6.00016 7.15522 6.0704 6.98565 6.19543 6.86063C6.32045 6.7356 6.49002 6.66536 6.66683 6.66536H8.00016C8.17698 6.66536 8.34655 6.7356 8.47157 6.86063C8.59659 6.98565 8.66683 7.15522 8.66683 7.33203V9.9987H9.3335C9.51031 9.9987 9.67988 10.0689 9.8049 10.194C9.92993 10.319 10.0002 10.4886 10.0002 10.6654C10.0002 10.8422 9.92993 11.0117 9.8049 11.1368C9.67988 11.2618 9.51031 11.332 9.3335 11.332Z"}}]},ut=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"info-icon",ref:t,icon:Kn}))});ut.displayName="InfoIcon";const er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.3667C1.66853 1.3667 1.3999 1.63533 1.3999 1.9667C1.3999 2.29807 1.66853 2.5667 1.9999 2.5667H13.9999C14.3313 2.5667 14.5999 2.29807 14.5999 1.9667C14.5999 1.63533 14.3313 1.3667 13.9999 1.3667H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 13.4334C1.66853 13.4334 1.3999 13.7021 1.3999 14.0334C1.3999 14.3648 1.66853 14.6334 1.9999 14.6334H13.9999C14.3313 14.6334 14.5999 14.3648 14.5999 14.0334C14.5999 13.7021 14.3313 13.4334 13.9999 13.4334H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.49336 10.4244C9.25905 10.19 9.25905 9.81015 9.49336 9.57583L10.4691 8.6001L4.08291 8.6001C3.75154 8.6001 3.48291 8.33147 3.48291 8.0001C3.48291 7.66873 3.75154 7.4001 4.08291 7.4001L10.4691 7.4001L9.49336 6.42436C9.25905 6.19005 9.25905 5.81015 9.49336 5.57583C9.72767 5.34152 10.1076 5.34152 10.3419 5.57583L12.3419 7.57583C12.5762 7.81015 12.5762 8.19005 12.3419 8.42436L10.3419 10.4244C10.1076 10.6587 9.72767 10.6587 9.49336 10.4244Z"}}]},dt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-icon",ref:t,icon:er}))});dt.displayName="InsertIcon";const tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.80385 1.40005H11.9997C12.3311 1.40005 12.5997 1.66868 12.5997 2.00005C12.5997 2.33143 12.3311 2.60005 11.9997 2.60005H10.1185L7.12251 13.4001H9.33324C9.66461 13.4001 9.93324 13.6687 9.93324 14.0001C9.93324 14.3314 9.66461 14.6001 9.33324 14.6001H6.34785C6.33847 14.6003 6.32905 14.6003 6.31962 14.6001H3.9999C3.66853 14.6001 3.3999 14.3314 3.3999 14.0001C3.3999 13.6687 3.66853 13.4001 3.9999 13.4001H5.87719L8.87322 2.60005H6.66641C6.33504 2.60005 6.06641 2.33143 6.06641 2.00005C6.06641 1.66868 6.33504 1.40005 6.66641 1.40005H9.52916C9.61698 1.37929 9.71064 1.3781 9.80385 1.40005Z"}}]},ft=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"italic-icon",ref:t,icon:tr}))});ft.displayName="ItalicIcon";const nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.39986 6.33339C3.39986 6.00202 3.66849 5.73339 3.99986 5.73339H4.66652C4.99789 5.73339 5.26652 6.00202 5.26652 6.33339C5.26652 6.66476 4.99789 6.93339 4.66652 6.93339H3.99986C3.66849 6.93339 3.39986 6.66476 3.39986 6.33339Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.99986 5.73339C6.66849 5.73339 6.39986 6.00202 6.39986 6.33339C6.39986 6.66476 6.66849 6.93339 6.99986 6.93339H7.66652C7.99789 6.93339 8.26652 6.66476 8.26652 6.33339C8.26652 6.00202 7.99789 5.73339 7.66652 5.73339H6.99986Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.06636 6.33339C9.06636 6.00202 9.33499 5.73339 9.66636 5.73339H11.9997C12.3311 5.73339 12.5997 6.00202 12.5997 6.33339C12.5997 6.66476 12.3311 6.93339 11.9997 6.93339H9.66636C9.33499 6.93339 9.06636 6.66476 9.06636 6.33339Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.99986 8.73339C3.66849 8.73339 3.39986 9.00202 3.39986 9.33339C3.39986 9.66476 3.66849 9.93339 3.99986 9.93339H11.9999C12.3312 9.93339 12.5999 9.66476 12.5999 9.33339C12.5999 9.00202 12.3312 8.73339 11.9999 8.73339H3.99986Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33338 1.73345L12.6667 1.7334C14.1026 1.73339 15.2667 2.89745 15.2667 4.3334V11C15.2667 12.4359 14.1027 13.6 12.6667 13.6H3.33355C1.89763 13.6 0.733583 12.4359 0.73355 11L0.733398 4.33351C0.733366 2.89755 1.89742 1.73346 3.33338 1.73345ZM12.6667 2.9334L3.33339 2.93345C2.56018 2.93346 1.93338 3.56028 1.9334 4.33348L1.93355 11C1.93357 11.7732 2.56036 12.4 3.33355 12.4H12.6667C13.4399 12.4 14.0667 11.7732 14.0667 11V4.3334C14.0667 3.5602 13.4399 2.93339 12.6667 2.9334Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ht=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"keyboard-icon",ref:t,icon:nr}))});ht.displayName="KeyboardIcon";const rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},Ct=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-justifying-icon",ref:t,icon:rr}))});Ct.displayName="LeftJustifyingIcon";const or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3732 3.94019C0.82475 2.75718 2.04917 1.53276 3.23218 2.0812L10.0657 5.24921C10.3663 5.38859 10.497 5.74529 10.3576 6.04592C10.2183 6.34656 9.86157 6.47728 9.56094 6.33791L6.86664 5.08883L4.42613 7.52934C4.41111 7.54436 4.3955 7.55841 4.37936 7.5715L5.6299 10.2689C5.76928 10.5696 5.63855 10.9263 5.33791 11.0656C5.03728 11.205 4.68058 11.0743 4.54121 10.7737L1.3732 3.94019ZM2.72746 3.1699L5.70713 4.55128L3.84327 6.41514L2.46189 3.43547C2.38354 3.26647 2.55846 3.09155 2.72746 3.1699Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.56311 13.7359C4.32879 13.9702 4.32879 14.3501 4.56311 14.5844C4.79742 14.8188 5.17732 14.8188 5.41163 14.5844L13.3083 6.68776L13.3842 8.21165C13.4006 8.54261 13.6823 8.79755 14.0133 8.78108C14.3442 8.76461 14.5992 8.48295 14.5827 8.15199L14.4844 6.17786C14.4413 5.3118 13.3917 4.90732 12.7786 5.52046L4.56311 13.7359Z"}}]},vt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-rotation-forty-five-degrees-icon",ref:t,icon:or}))});vt.displayName="LeftRotationFortyFiveDegreesIcon";const ir={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.4046 13.9395C11.4046 14.2708 11.6732 14.5395 12.0046 14.5395C12.336 14.5395 12.6046 14.2708 12.6046 13.9395V2.77186L13.7358 3.79578C13.9815 4.01815 14.3609 3.99927 14.5833 3.75359C14.8057 3.50792 14.7868 3.12849 14.5411 2.90612L13.0757 1.57967C12.4328 0.997761 11.4046 1.45394 11.4046 2.32106V13.9395Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.22244 9.26836C0.998116 8.81966 0.998119 7.08807 2.22245 6.63936L9.29456 4.04749C9.60569 3.93346 9.95036 4.09325 10.0644 4.40438C10.1784 4.71551 10.0186 5.06018 9.70749 5.1742L6.91911 6.19613V9.64753C6.91911 9.66877 6.918 9.68974 6.91585 9.71041L9.70749 10.7335C10.0186 10.8476 10.1784 11.1922 10.0644 11.5033C9.95036 11.8145 9.60569 11.9743 9.29456 11.8602L2.22244 9.26836ZM2.63538 7.76608L5.71911 6.63592V9.27181L2.63538 8.14165C2.46047 8.07755 2.46047 7.83018 2.63538 7.76608Z",fillRule:"evenodd",clipRule:"evenodd"}}]},gt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-rotation-ninety-degrees-icon",ref:t,icon:ir}))});gt.displayName="LeftRotationNinetyDegreesIcon";const lr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96708 8.23432V11.6842C4.96708 12.0156 5.2357 12.2842 5.56708 12.2842C5.89845 12.2842 6.16708 12.0156 6.16708 11.6842V5.62199C6.16708 4.70621 4.87775 4.5088 4.60373 5.38261L3.2564 9.67905L1.90905 5.3826C1.64268 4.53318 0.345703 4.6789 0.345703 5.62021V11.6842C0.345703 12.0156 0.614332 12.2842 0.945703 12.2842C1.27707 12.2842 1.5457 12.0156 1.5457 11.6842V8.23428L2.49305 11.2552C2.72747 12.0027 3.78534 12.0027 4.01975 11.2552L4.96708 8.23432Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.59409 8.3393C9.59409 7.86618 9.18572 7.49641 8.71492 7.54323L7.64429 7.64971C7.31454 7.6825 7.02065 7.44178 6.98785 7.11203C6.95506 6.78229 7.19578 6.48839 7.52553 6.4556L8.59616 6.34912C9.77317 6.23206 10.7941 7.15649 10.7941 8.3393V11.684C10.7941 12.0154 10.5255 12.284 10.1941 12.284C9.86272 12.284 9.59409 12.0154 9.59409 11.684V8.3393Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.79541 10.2064C6.79541 9.10233 7.69047 8.20728 8.79458 8.20728C9.89869 8.20728 10.7938 9.10233 10.7938 10.2064C10.7938 11.3106 9.89869 12.2056 8.79458 12.2056C7.69047 12.2056 6.79541 11.3106 6.79541 10.2064ZM8.79458 9.40728C8.35321 9.40728 7.99541 9.76508 7.99541 10.2064C7.99541 10.6478 8.35321 11.0056 8.79458 11.0056C9.23595 11.0056 9.59375 10.6478 9.59375 10.2064C9.59375 9.76508 9.23595 9.40728 8.79458 9.40728Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.386 6.62139C15.6666 6.79764 15.7454 7.16426 15.562 7.44024L12.5296 12.0032C12.3462 12.2791 11.9701 12.36 11.6894 12.1837C11.4088 12.0075 11.33 11.6409 11.5135 11.3649L14.5458 6.80196C14.7292 6.52598 15.1054 6.44513 15.386 6.62139Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.6892 6.62139C11.4086 6.79764 11.3298 7.16426 11.5132 7.44024L14.5456 12.0032C14.729 12.2791 15.1051 12.36 15.3857 12.1837C15.6664 12.0075 15.7451 11.6409 15.5617 11.3649L12.5294 6.80196C12.3459 6.52598 11.9698 6.44513 11.6892 6.62139Z",fillRule:"evenodd",clipRule:"evenodd"}}]},pt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"max-icon",ref:t,icon:lr}))});pt.displayName="MaxIcon";const sr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.66504 2.8666C1.66504 2.53523 1.93367 2.2666 2.26504 2.2666H13.735C14.0664 2.2666 14.335 2.53523 14.335 2.8666C14.335 3.19797 14.0664 3.4666 13.735 3.4666H2.26504C1.93367 3.4666 1.66504 3.19797 1.66504 2.8666Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.66504 8.00002C1.66504 7.66865 1.93367 7.40002 2.26504 7.40002H13.735C14.0664 7.40002 14.335 7.66865 14.335 8.00002C14.335 8.3314 14.0664 8.60002 13.735 8.60002H2.26504C1.93367 8.60002 1.66504 8.3314 1.66504 8.00002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.26504 12.5334C1.93367 12.5334 1.66504 12.8021 1.66504 13.1334C1.66504 13.4648 1.93367 13.7334 2.26504 13.7334H13.735C14.0664 13.7334 14.335 13.4648 14.335 13.1334C14.335 12.8021 14.0664 12.5334 13.735 12.5334H2.26504Z"}}]},mt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"menu-icon",ref:t,icon:sr}))});mt.displayName="MenuIcon";const ar={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.5939 1.13916L10.6607 1.1392C9.5563 1.13922 8.66094 2.03448 8.66079 3.13893L8.66064 4.19191C8.6606 4.52328 8.92919 4.79194 9.26056 4.79199C9.59193 4.79204 9.8606 4.52344 9.86064 4.19207L9.86079 3.13909C9.86085 2.69731 10.219 2.33921 10.6608 2.3392L12.594 2.33916C13.0358 2.33915 13.394 2.69732 13.394 3.13916L13.394 7.40012H10.4947L11.0464 6.84845C11.2807 6.61414 11.2807 6.23424 11.0464 5.99993C10.8121 5.76561 10.4322 5.76561 10.1979 5.99993L9.31395 6.88384C8.68914 7.50867 8.68914 8.52171 9.31396 9.14654L10.1979 10.0305C10.4322 10.2648 10.8121 10.2648 11.0464 10.0305C11.2807 9.79614 11.2807 9.41624 11.0464 9.18192L10.4646 8.60012H13.394L13.394 12.8612C13.394 13.303 13.0359 13.6612 12.594 13.6612H10.6606C10.2188 13.6612 9.86064 13.303 9.86064 12.8612V11.8084C9.86064 11.4771 9.59202 11.2084 9.26064 11.2084C8.92927 11.2084 8.66064 11.4771 8.66064 11.8084V12.8612C8.66064 13.9658 9.55607 14.8612 10.6606 14.8612H12.594C13.6986 14.8612 14.594 13.9658 14.594 12.8612L14.594 8.0066L14.594 8.00012L14.594 7.99363L14.594 3.13915C14.594 2.03457 13.6985 1.13914 12.5939 1.13916Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.33889 1.13919L3.4057 1.13926C2.30115 1.13931 1.40576 2.03474 1.40578 3.13928L1.40582 7.99139L1.40576 8.00012L1.40582 8.00886L1.40587 12.8612C1.40588 13.9658 2.30131 14.8612 3.40587 14.8612H5.33897C6.44354 14.8612 7.33897 13.9658 7.33897 12.8612V11.8084C7.33897 11.4771 7.07034 11.2084 6.73897 11.2084C6.4076 11.2084 6.13897 11.4771 6.13897 11.8084V12.8612C6.13897 13.303 5.7808 13.6612 5.33897 13.6612H3.40587C2.96405 13.6612 2.60588 13.303 2.60587 12.8612L2.60583 8.60012H5.53538L4.95357 9.18193C4.71925 9.41624 4.71925 9.79614 4.95357 10.0305C5.18788 10.2648 5.56778 10.2648 5.8021 10.0305L6.68599 9.14656C7.31083 8.52172 7.31083 7.50866 6.68599 6.88382L5.8021 5.99993C5.56778 5.76561 5.18788 5.76561 4.95357 5.99993C4.71925 6.23424 4.71925 6.61414 4.95357 6.84845L5.50523 7.40012H2.60582L2.60578 3.13927C2.60577 2.69745 2.96393 2.33928 3.40574 2.33926L5.33894 2.33919C5.78078 2.33917 6.13897 2.69735 6.13897 3.13919V4.192C6.13897 4.52337 6.4076 4.792 6.73897 4.792C7.07034 4.792 7.33897 4.52337 7.33897 4.192V3.13919C7.33897 2.03459 6.44349 1.13914 5.33889 1.13919Z"}}]},bt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"merge-all-icon",ref:t,icon:ar}))});bt.displayName="MergeAllIcon";const cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6707 7.03525C9.0573 7.03525 9.3707 6.72185 9.3707 6.33525C9.3707 5.94866 9.0573 5.63525 8.6707 5.63525C8.28411 5.63525 7.9707 5.94866 7.9707 6.33525C7.9707 6.72185 8.28411 7.03525 8.6707 7.03525Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.671 12.2842C8.33963 12.2842 8.071 12.0156 8.071 11.6842L8.071 8.20615C8.071 7.87478 8.33962 7.60615 8.671 7.60615C9.00237 7.60615 9.271 7.87478 9.271 8.20615L9.271 11.6842C9.271 12.0156 9.00237 12.2842 8.671 12.2842Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5105 9.62735C13.5105 9.09992 13.0091 8.71683 12.5002 8.8555L12.1671 8.94628C11.7319 9.06486 11.43 9.46007 11.43 9.9111V11.6842C11.43 12.0156 11.1614 12.2842 10.83 12.2842C10.4986 12.2842 10.23 12.0156 10.23 11.6842V9.9111C10.23 8.91884 10.8942 8.04938 11.8516 7.7885L12.1847 7.69771C13.4569 7.35104 14.7105 8.30878 14.7105 9.62735V11.6842C14.7105 12.0156 14.4419 12.2842 14.1105 12.2842C13.7792 12.2842 13.5105 12.0156 13.5105 11.6842V9.62735Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.8377 7.66644C11.169 7.66642 11.4377 7.93503 11.4377 8.2664L11.438 11.6841C11.438 12.0155 11.1694 12.2841 10.838 12.2842C10.5066 12.2842 10.238 12.0156 10.238 11.6842L10.2377 8.26649C10.2377 7.93512 10.5063 7.66647 10.8377 7.66644Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.91043 8.23408V11.684C5.91043 12.0154 6.17906 12.284 6.51043 12.284C6.84181 12.284 7.11043 12.0154 7.11043 11.684V5.62174C7.11043 4.70597 5.82111 4.50856 5.54709 5.38237L4.19976 9.67881L2.85241 5.38235C2.58604 4.53293 1.28906 4.67865 1.28906 5.61997V11.684C1.28906 12.0154 1.55769 12.284 1.88906 12.284C2.22043 12.284 2.48906 12.0154 2.48906 11.684V8.23404L3.43641 11.255C3.67082 12.0025 4.7287 12.0025 4.9631 11.255L5.91043 8.23408Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Lt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"min-icon",ref:t,icon:cr}))});Lt.displayName="MinIcon";const ur={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",fillRule:"evenodd",clipRule:"evenodd"}}]},z1=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"more-down-icon",ref:t,icon:ur}))});z1.displayName="MoreDownIcon";const dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8 3.30078C8.55228 3.30078 9 2.85307 9 2.30078C9 1.7485 8.55228 1.30078 8 1.30078C7.44772 1.30078 7 1.7485 7 2.30078C7 2.85307 7.44772 3.30078 8 3.30078Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8 9.00012C8.55228 9.00012 9 8.55241 9 8.00012C9 7.44784 8.55228 7.00012 8 7.00012C7.44772 7.00012 7 7.44784 7 8.00012C7 8.55241 7.44772 9.00012 8 9.00012Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9 13.6995C9 14.2517 8.55228 14.6995 8 14.6995C7.44772 14.6995 7 14.2517 7 13.6995C7 13.1472 7.44772 12.6995 8 12.6995C8.55228 12.6995 9 13.1472 9 13.6995Z"}}]},Ve=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"more-function-icon",ref:t,icon:dr}))});Ve.displayName="MoreFunctionIcon";const fr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ne=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"more-icon",ref:t,icon:fr}))});Ne.displayName="MoreIcon";const hr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.1349 1.3999C6.80353 1.3999 6.5349 1.66853 6.5349 1.9999C6.5349 2.33127 6.80353 2.5999 7.1349 2.5999H7.67993V4.55065C7.67993 4.88203 7.94856 5.15065 8.27993 5.15065C8.6113 5.15065 8.87993 4.88203 8.87993 4.55065V2.5999H9.4049C9.73627 2.5999 10.0049 2.33127 10.0049 1.9999C10.0049 1.66853 9.73627 1.3999 9.4049 1.3999H7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 7.1349C2.5999 6.80353 2.33127 6.5349 1.9999 6.5349C1.66853 6.5349 1.3999 6.80353 1.3999 7.1349V9.4049C1.3999 9.73627 1.66853 10.0049 1.9999 10.0049C2.33127 10.0049 2.5999 9.73627 2.5999 9.4049V8.86968H4.54992C4.88129 8.86968 5.14992 8.60105 5.14992 8.26968C5.14992 7.93831 4.88129 7.66968 4.54992 7.66968H2.5999V7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.1399 7.1349C15.1399 6.80353 14.8713 6.5349 14.5399 6.5349C14.2085 6.5349 13.9399 6.80353 13.9399 7.1349V7.66968H12.0099C11.6786 7.66968 11.4099 7.93831 11.4099 8.26968C11.4099 8.60105 11.6786 8.86968 12.0099 8.86968H13.9399V9.4049C13.9399 9.73627 14.2085 10.0049 14.5399 10.0049C14.8713 10.0049 15.1399 9.73627 15.1399 9.4049V8.27463L15.1399 8.26968L15.1399 8.26472V7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.1349 13.9399C6.80353 13.9399 6.5349 14.2085 6.5349 14.5399C6.5349 14.8713 6.80353 15.1399 7.1349 15.1399H8.24962C8.25966 15.1404 8.26977 15.1407 8.27993 15.1407C8.2901 15.1407 8.3002 15.1404 8.31024 15.1399H9.4049C9.73627 15.1399 10.0049 14.8713 10.0049 14.5399C10.0049 14.2085 9.73627 13.9399 9.4049 13.9399H8.87993V12.0107C8.87993 11.6793 8.6113 11.4107 8.27993 11.4107C7.94856 11.4107 7.67993 11.6793 7.67993 12.0107V13.9399H7.1349Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.60991 4.00967C2.60991 3.23647 3.23671 2.60967 4.00991 2.60967H4.33991C4.67128 2.60967 4.93991 2.34104 4.93991 2.00967C4.93991 1.6783 4.67128 1.40967 4.33991 1.40967H4.00991C2.57397 1.40967 1.40991 2.57373 1.40991 4.00967V4.33967C1.40991 4.67104 1.67854 4.93967 2.00991 4.93967C2.34128 4.93967 2.60991 4.67104 2.60991 4.33967V4.00967Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.1999 1.40967C11.8685 1.40967 11.5999 1.6783 11.5999 2.00967C11.5999 2.34104 11.8685 2.60967 12.1999 2.60967H12.5299C13.3031 2.60967 13.9299 3.23647 13.9299 4.00967V4.33967C13.9299 4.67104 14.1985 4.93967 14.5299 4.93967C14.8613 4.93967 15.1299 4.67104 15.1299 4.33967V4.00967C15.1299 2.57373 13.9659 1.40967 12.5299 1.40967H12.1999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.60991 12.1997C2.60991 11.8683 2.34128 11.5997 2.00991 11.5997C1.67854 11.5997 1.40991 11.8683 1.40991 12.1997V12.5297C1.40991 13.9656 2.57397 15.1297 4.00991 15.1297H4.33991C4.67128 15.1297 4.93991 14.861 4.93991 14.5297C4.93991 14.1983 4.67128 13.9297 4.33991 13.9297H4.00991C3.23671 13.9297 2.60991 13.3029 2.60991 12.5297V12.1997Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.1299 12.1997C15.1299 11.8683 14.8613 11.5997 14.5299 11.5997C14.1985 11.5997 13.9299 11.8683 13.9299 12.1997V12.5297C13.9299 13.3029 13.3031 13.9297 12.5299 13.9297H12.1999C11.8685 13.9297 11.5999 14.1983 11.5999 14.5297C11.5999 14.861 11.8685 15.1297 12.1999 15.1297H12.5299C13.9659 15.1297 15.1299 13.9656 15.1299 12.5297V12.1997Z"}}]},wt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"no-border-icon",ref:t,icon:hr}))});wt.displayName="NoBorderIcon";const Cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.671 2.24246C7.1197 1.01814 8.85129 1.01814 9.3 2.24246L11.8919 9.31458C12.0059 9.62571 11.8461 9.97038 11.535 10.0844C11.2238 10.1984 10.8792 10.0386 10.7652 9.72751L9.74324 6.93913H6.29183C6.2706 6.93913 6.24962 6.93802 6.22895 6.93587L5.20584 9.72751C5.09181 10.0386 4.74715 10.1984 4.43601 10.0844C4.12488 9.97038 3.96509 9.62571 4.07912 9.31458L6.671 2.24246ZM8.17328 2.6554L9.30345 5.73913H6.66755L7.79771 2.6554C7.86181 2.48049 8.10918 2.48049 8.17328 2.6554Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 11.4246C1.66853 11.4246 1.3999 11.6933 1.3999 12.0246C1.3999 12.356 1.66853 12.6246 1.9999 12.6246H13.1675L12.1436 13.7558C11.9212 14.0015 11.9401 14.3809 12.1858 14.6033C12.4314 14.8257 12.8109 14.8068 13.0332 14.5611L14.3597 13.0957C14.9416 12.4528 14.4854 11.4246 13.6183 11.4246H1.9999Z"}}]},yt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"no-rotation-icon",ref:t,icon:Cr}))});yt.displayName="NoRotationIcon";const vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.65465 3.96697V2.9942C1.65465 2.9188 1.64353 2.86563 1.62465 2.83387C1.61052 2.81011 1.58943 2.79243 1.53852 2.79243H1.44483C1.23836 2.79243 1.07099 2.62506 1.07099 2.41859C1.07099 2.23956 1.19714 2.09152 1.36369 2.04728C1.4425 2.02634 1.51336 2.00423 1.57642 1.98104C1.65529 1.94986 1.73286 1.91381 1.80913 1.87285C1.8974 1.82544 1.99768 1.79517 2.10303 1.79517C2.41692 1.79517 2.67137 2.04962 2.67137 2.36351V4.02047C2.67137 4.12385 2.75517 4.20765 2.85855 4.20765C3.0614 4.20765 3.22585 4.3721 3.22585 4.57495V4.63332C3.22585 4.86842 3.03527 5.059 2.80018 5.059H1.41884C1.1829 5.059 0.993164 4.86511 0.993164 4.63087C0.993164 4.39932 1.18072 4.20765 1.41398 4.20765C1.5469 4.20765 1.65465 4.09989 1.65465 3.96697Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.949709 9.2145C1.14957 9.02907 1.33226 8.85497 1.49677 8.69321C1.6914 8.50496 1.84244 8.33306 1.95136 8.17747C2.05826 8.02476 2.10492 7.89219 2.10492 7.77781C2.10492 7.65255 2.07293 7.57986 2.02759 7.53865L2.0245 7.5357C1.97641 7.48761 1.9103 7.46013 1.81635 7.46013C1.71986 7.46013 1.6383 7.47348 1.5822 7.51611L1.58034 7.51749C1.42279 7.63092 1.19425 7.67086 1.03149 7.50811L1.02187 7.49849C0.868433 7.34505 0.852261 7.07998 1.03819 6.93364C1.12802 6.86293 1.21897 6.8051 1.31109 6.76081C1.48788 6.67257 1.69616 6.63037 1.93278 6.63037C2.15191 6.63037 2.34929 6.67491 2.52246 6.76665C2.69563 6.85514 2.83257 6.98323 2.93172 7.14966C3.03175 7.31758 3.08022 7.51184 3.08022 7.72929C3.08022 7.91104 3.03028 8.09333 2.93429 8.27521C2.84374 8.45283 2.72797 8.62691 2.58859 8.79616C2.51109 8.88842 2.43304 8.97759 2.35442 9.06369C2.34919 9.06941 2.34388 9.07573 2.33892 9.08228C2.34542 9.08201 2.35268 9.08151 2.36075 9.08073C2.46266 9.07087 2.54985 9.06576 2.62168 9.06576H2.78662C3.02915 9.06576 3.22576 9.26237 3.22576 9.5049C3.22576 9.74742 3.02915 9.94403 2.78662 9.94403H1.23472C1.00261 9.94403 0.814453 9.75587 0.814453 9.52376C0.814453 9.40615 0.86379 9.29421 0.949709 9.2145Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.2579 14.674C1.45109 14.7553 1.67487 14.7946 1.92711 14.7946C2.1451 14.7946 2.34841 14.7599 2.53619 14.6895L2.53746 14.689C2.7264 14.6148 2.88145 14.5071 2.99952 14.3647L3.00018 14.3639C3.12167 14.2138 3.18089 14.0326 3.18089 13.8252C3.18089 13.6181 3.12169 13.4411 2.99737 13.3022C2.91596 13.2112 2.81864 13.1388 2.70642 13.0846C2.80611 13.023 2.88805 12.9505 2.95017 12.8661C3.04138 12.7422 3.08609 12.5977 3.08609 12.4365C3.08609 12.1403 2.97594 11.9041 2.7521 11.7404C2.53645 11.5772 2.25212 11.5002 1.90815 11.5002C1.7136 11.5002 1.52963 11.5372 1.35712 11.6115C1.28512 11.6418 1.21426 11.6776 1.14456 11.7188C0.938688 11.8404 0.928034 12.1099 1.06649 12.2774C1.21291 12.4544 1.46028 12.4561 1.63989 12.363C1.70891 12.3286 1.78521 12.3109 1.87023 12.3109C1.96356 12.3109 2.01717 12.3317 2.04691 12.3578C2.07449 12.3821 2.09529 12.4231 2.09529 12.4981C2.09529 12.5709 2.0658 12.6284 1.99667 12.6764C1.96042 12.6999 1.8978 12.7216 1.80025 12.7355C1.61051 12.7625 1.44118 12.9145 1.44118 13.1237C1.44118 13.3319 1.60937 13.4885 1.80489 13.5068C1.87785 13.5136 1.93575 13.5234 1.97985 13.5355C2.07997 13.562 2.12905 13.596 2.14927 13.6246C2.17519 13.6614 2.19008 13.7078 2.19008 13.7684C2.19008 13.8334 2.16583 13.8754 2.1142 13.9064C2.05357 13.9428 1.96521 13.965 1.84179 13.965C1.749 13.965 1.6547 13.9433 1.55817 13.8981C1.363 13.7983 1.08846 13.8083 0.942801 14.01L0.936366 14.0189C0.827321 14.1699 0.821861 14.401 0.994678 14.5262C1.07406 14.5836 1.16225 14.633 1.2579 14.674Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.13037 2.827C4.799 2.827 4.53037 3.09563 4.53037 3.427C4.53037 3.75837 4.799 4.027 5.13037 4.027H15.1489C15.4803 4.027 15.7489 3.75837 15.7489 3.427C15.7489 3.09563 15.4803 2.827 15.1489 2.827H5.13037Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53037 8.28711C4.53037 7.95574 4.799 7.68711 5.13037 7.68711H15.1489C15.4803 7.68711 15.7489 7.95574 15.7489 8.28711C15.7489 8.61848 15.4803 8.88711 15.1489 8.88711H5.13037C4.799 8.88711 4.53037 8.61848 4.53037 8.28711Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.13037 12.5475C4.799 12.5475 4.53037 12.8161 4.53037 13.1475C4.53037 13.4788 4.799 13.7475 5.13037 13.7475H15.1489C15.4803 13.7475 15.7489 13.4788 15.7489 13.1475C15.7489 12.8161 15.4803 12.5475 15.1489 12.5475H5.13037Z"}}]},It=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"order-icon",ref:t,icon:vr}))});It.displayName="OrderIcon";const gr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 0.733154C8.33127 0.733154 8.5999 1.00178 8.5999 1.33315V5.33315C8.5999 5.66453 8.33127 5.93315 7.9999 5.93315C7.66853 5.93315 7.3999 5.66453 7.3999 5.33315V1.33315C7.3999 1.00178 7.66853 0.733154 7.9999 0.733154Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.46621 2.73315C2.79758 2.73315 3.06621 3.00178 3.06621 3.33315V12.6665C3.06621 12.9979 2.79758 13.2665 2.46621 13.2665C2.13484 13.2665 1.86621 12.9979 1.86621 12.6665V3.33315C1.86621 3.00178 2.13484 2.73315 2.46621 2.73315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.3334 7.3999C5.00203 7.3999 4.7334 7.66853 4.7334 7.9999C4.7334 8.33127 5.00203 8.5999 5.3334 8.5999H12.603L11.9252 9.28591C11.6922 9.52163 11.6945 9.90152 11.9302 10.1344C12.166 10.3673 12.5458 10.3651 12.7788 10.1293L14.4577 8.43018C14.69 8.19509 14.6884 7.81641 14.4542 7.58324L12.7753 5.91184C12.5404 5.67806 12.1605 5.67891 11.9267 5.91375C11.6929 6.14859 11.6938 6.52849 11.9286 6.76228L12.5691 7.3999H5.3334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.5999 10.6667C8.5999 10.3353 8.33127 10.0667 7.9999 10.0667C7.66853 10.0667 7.3999 10.3353 7.3999 10.6667V14.6667C7.3999 14.998 7.66853 15.2667 7.9999 15.2667C8.33127 15.2667 8.5999 14.998 8.5999 14.6667V10.6667Z"}}]},Mt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"overflow-icon",ref:t,icon:gr}))});Mt.displayName="OverflowIcon";const pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.85059 4.06725C1.85059 2.84302 2.84302 1.85059 4.06725 1.85059C5.29148 1.85059 6.28392 2.84302 6.28392 4.06725C6.28392 5.29148 5.29148 6.28392 4.06725 6.28392C2.84302 6.28392 1.85059 5.29148 1.85059 4.06725ZM4.06725 2.95059C3.45053 2.95059 2.95059 3.45053 2.95059 4.06725C2.95059 4.68397 3.45053 5.18392 4.06725 5.18392C4.68397 5.18392 5.18392 4.68397 5.18392 4.06725C5.18392 3.45053 4.68397 2.95059 4.06725 2.95059Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.7168 11.933C9.7168 10.7087 10.7092 9.71631 11.9335 9.71631C13.1577 9.71631 14.1501 10.7087 14.1501 11.933C14.1501 13.1572 13.1577 14.1496 11.9335 14.1496C10.7092 14.1496 9.7168 13.1572 9.7168 11.933ZM11.9335 10.8163C11.3167 10.8163 10.8168 11.3163 10.8168 11.933C10.8168 12.5497 11.3167 13.0496 11.9335 13.0496C12.5502 13.0496 13.0501 12.5497 13.0501 11.933C13.0501 11.3163 12.5502 10.8163 11.9335 10.8163Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.5241 3.32407C13.7584 3.08975 13.7584 2.70986 13.5241 2.47554C13.2898 2.24123 12.9099 2.24123 12.6755 2.47554L2.47554 12.6755C2.24123 12.9099 2.24123 13.2898 2.47554 13.5241C2.70986 13.7584 3.08975 13.7584 3.32407 13.5241L13.5241 3.32407Z"}}]},_t=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"percent-icon",ref:t,icon:pr}))});_t.displayName="PercentIcon";const mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.35928 2.57764C3.61338 1.77872 4.36128 1.19995 5.24437 1.19995C6.12746 1.19995 6.87537 1.77872 7.12947 2.57764H11.7885C13.4928 2.57764 14.7999 3.8461 14.7997 5.5888C14.7995 7.33129 13.4929 8.59984 11.7885 8.59984H6.63121L6.6224 8.5999H4.21143C3.16019 8.5999 2.4001 9.34071 2.4002 10.4109C2.40029 11.4814 3.16029 12.2221 4.21143 12.2221H8.87045C9.12449 11.4231 9.87245 10.8442 10.7556 10.8442C11.6388 10.8442 12.3868 11.4231 12.6408 12.2222H14.1999C14.5312 12.2222 14.7999 12.4908 14.7999 12.8222C14.7999 13.1535 14.5312 13.4222 14.1999 13.4222H12.6407C12.3866 14.221 11.6387 14.7998 10.7556 14.7998C9.87252 14.7998 9.12461 14.221 8.87051 13.4221H4.21143C2.50701 13.4221 1.20035 12.1536 1.2002 10.4111C1.20004 8.66836 2.50712 7.3999 4.21143 7.3999H6.61326L6.62208 7.39984H11.7885C12.8396 7.39984 13.5996 6.65912 13.5997 5.58868C13.5998 4.51844 12.8397 3.77764 11.7885 3.77764H7.12952C6.87548 4.57664 6.12753 5.1555 5.24437 5.1555C4.36122 5.1555 3.61327 4.57664 3.35922 3.77764H1.8002C1.46882 3.77764 1.2002 3.50901 1.2002 3.17764C1.2002 2.84627 1.46882 2.57764 1.8002 2.57764H3.35928ZM4.46671 3.16449C4.47377 2.74105 4.81924 2.39995 5.24437 2.39995C5.67026 2.39995 6.0162 2.74226 6.02207 3.16675L6.02197 3.17764L6.02207 3.1886C6.01625 3.61314 5.67029 3.95549 5.24437 3.95549C4.81921 3.95549 4.47372 3.61435 4.46671 3.19085L4.46685 3.17764L4.46671 3.16449ZM9.97788 12.8307C9.98254 13.2562 10.329 13.5998 10.7556 13.5998C11.1815 13.5998 11.5274 13.2575 11.5333 12.8331C11.5332 12.8294 11.5332 12.8258 11.5332 12.8222C11.5332 12.8185 11.5332 12.8148 11.5333 12.8111C11.5275 12.3866 11.1815 12.0442 10.7556 12.0442C10.3289 12.0442 9.98248 12.3878 9.97788 12.8134C9.97792 12.8163 9.97794 12.8192 9.97794 12.8221C9.97794 12.825 9.97792 12.8278 9.97788 12.8307Z",fillRule:"evenodd",clipRule:"evenodd"}}]},St=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"piping-icon",ref:t,icon:mr}))});St.displayName="PipingIcon";const br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.273 2.72206C11.0214 2.50641 10.9922 2.12763 11.2079 1.87603C11.4235 1.62444 11.8023 1.59531 12.0539 1.81097L14.3833 3.80761C14.5134 3.91733 14.5962 4.08137 14.5967 4.26477L14.5967 4.2665C14.5967 4.41745 14.541 4.55538 14.4489 4.66083C14.44 4.67109 14.4307 4.68108 14.421 4.69077L12.0877 7.02411C11.8534 7.25842 11.4735 7.25843 11.2392 7.02412C11.0049 6.78981 11.0049 6.40991 11.2392 6.17559L12.5482 4.8665H6.63324C4.40569 4.8665 2.5999 6.67229 2.5999 8.89984C2.5999 11.1274 4.40569 12.9332 6.63324 12.9332H11.9972C12.3286 12.9332 12.5972 13.2018 12.5972 13.5332C12.5972 13.8645 12.3286 14.1332 11.9972 14.1332H6.63324C3.74295 14.1332 1.3999 11.7901 1.3999 8.89984C1.3999 6.00955 3.74295 3.6665 6.63324 3.6665H12.3748L11.273 2.72206Z"}}]},Ht=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"redo-icon",ref:t,icon:br}))});Ht.displayName="RedoIcon";const Lr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.33307 1.3916C5.14145 1.3916 4.06641 2.27555 4.06641 3.49366V6.49777C4.06641 7.71586 5.14145 8.59982 6.33307 8.59982C7.52469 8.59982 8.59974 7.71586 8.59974 6.49777V3.49366C8.59974 2.27555 7.52469 1.3916 6.33307 1.3916ZM5.26641 3.49366C5.26641 3.05264 5.68376 2.5916 6.33307 2.5916C6.98239 2.5916 7.39974 3.05264 7.39974 3.49366V6.49777C7.39974 6.93878 6.98239 7.39982 6.33307 7.39982C5.68376 7.39982 5.26641 6.93878 5.26641 6.49777V3.49366Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.90913 9.5417C8.14345 9.30739 8.52335 9.30739 8.75766 9.5417C8.99198 9.77602 8.99198 10.1559 8.75766 10.3902L7.78193 11.366H13.9999C14.3313 11.366 14.5999 11.6346 14.5999 11.966C14.5999 12.2973 14.3313 12.566 13.9999 12.566H7.78193L8.75766 13.5417C8.99198 13.776 8.99198 14.1559 8.75766 14.3902C8.52335 14.6245 8.14345 14.6245 7.90913 14.3902L5.91739 12.3985C5.80388 12.2893 5.73324 12.1359 5.73324 11.966C5.73324 11.796 5.80388 11.6426 5.91739 11.5334L7.90913 9.5417Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 8.3002C1.3999 7.96882 1.66853 7.7002 1.9999 7.7002H2.33324C2.66461 7.7002 2.93324 7.96882 2.93324 8.3002C2.93324 8.63157 2.66461 8.9002 2.33324 8.9002H1.9999C1.66853 8.9002 1.3999 8.63157 1.3999 8.3002Z"}}]},Et=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"reduce-digits-icon",ref:t,icon:Lr}))});Et.displayName="ReduceDigitsIcon";const wr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 7.9999C1.3999 7.66853 1.66853 7.3999 1.9999 7.3999H13.9999C14.3313 7.3999 14.5999 7.66853 14.5999 7.9999C14.5999 8.33127 14.3313 8.5999 13.9999 8.5999H1.9999C1.66853 8.5999 1.3999 8.33127 1.3999 7.9999Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Te=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"reduce-icon",ref:t,icon:wr}))});Te.displayName="ReduceIcon";const yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},Dt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-justifying-icon",ref:t,icon:yr}))});Dt.displayName="RightJustifyingIcon";const Ir={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.1994 1.49307C13.3824 0.944623 14.6068 2.16904 14.0584 3.35206L10.8904 10.1855C10.751 10.4862 10.3943 10.6169 10.0937 10.4775C9.79302 10.3381 9.66229 9.98144 9.80166 9.68081L11.0507 6.98651L8.61023 4.546C8.59522 4.53098 8.58116 4.51537 8.56807 4.49924L5.87063 5.74977C5.57 5.88915 5.2133 5.75842 5.07392 5.45779C4.93455 5.15715 5.06528 4.80045 5.36591 4.66108L12.1994 1.49307ZM12.9697 2.84734L11.5883 5.82701L9.72443 3.96315L12.7041 2.58177C12.8731 2.50342 13.048 2.67833 12.9697 2.84734Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.40366 4.68273C2.16934 4.44842 1.78945 4.44842 1.55513 4.68273C1.32082 4.91705 1.32082 5.29695 1.55513 5.53126L9.45182 13.4279L7.92792 13.5038C7.59696 13.5203 7.34202 13.8019 7.35849 14.1329C7.37497 14.4639 7.65662 14.7188 7.98758 14.7023L9.96172 14.6041C10.8278 14.5609 11.2323 13.5113 10.6191 12.8982L2.40366 4.68273Z"}}]},Ot=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-rotation-forty-five-degrees-icon",ref:t,icon:Ir}))});Ot.displayName="RightRotationFortyFiveDegreesIcon";const Mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"g",attrs:{fill:"currentColor",clipPath:"url(#right-rotation-ninety-degrees-icon_clip0_927_166)"},children:[{tag:"path",attrs:{d:"M3.11339 1.41934C3.11339 1.08797 2.84476 0.819336 2.51339 0.819336C2.18201 0.819336 1.91338 1.08797 1.91338 1.41934V12.5869L0.782193 11.563C0.53652 11.3406 0.157091 11.3595 -0.0652855 11.6052C-0.287662 11.8509 -0.268776 12.2303 -0.0231021 12.4527L1.44231 13.7791C2.08518 14.361 3.11338 13.9049 3.11338 13.0377L3.11339 1.41934Z"}},{tag:"path",attrs:{d:"M12.2955 9.26826C13.5199 8.81955 13.5199 7.08797 12.2955 6.63926L5.22343 4.04738C4.9123 3.93336 4.56763 4.09314 4.45361 4.40428C4.33958 4.71541 4.49936 5.06007 4.8105 5.1741L7.59888 6.19602V9.64743C7.59888 9.66866 7.59999 9.68964 7.60214 9.71031L4.8105 10.7334C4.49936 10.8474 4.33958 11.1921 4.45361 11.5032C4.56763 11.8144 4.9123 11.9742 5.22343 11.8601L12.2955 9.26826ZM11.8826 7.76597L8.79888 6.63581V9.27171L11.8826 8.14155C12.0575 8.07745 12.0575 7.83008 11.8826 7.76597Z",fillRule:"evenodd",clipRule:"evenodd"}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"right-rotation-ninety-degrees-icon_clip0_927_166"},children:[{tag:"path",attrs:{fill:"white",d:"M0 0H16V16H0z"}}]}]}],defIds:["right-rotation-ninety-degrees-icon_clip0_927_166"]},Rt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-rotation-ninety-degrees-icon",ref:t,icon:Mr}))});Rt.displayName="RightRotationNinetyDegreesIcon";const _r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.9445 1.55649C12.2184 1.744 12.2895 2.11755 12.1033 2.39085L9.24342 6.58659H12.8001C13.1315 6.58659 13.4001 6.85522 13.4001 7.18659C13.4001 7.51796 13.1315 7.78659 12.8001 7.78659H8.5999V9.91276H13.2221C13.5534 9.91276 13.8221 10.1814 13.8221 10.5128C13.8221 10.8441 13.5534 11.1128 13.2221 11.1128H8.5999V14.0877C8.5999 14.4191 8.33127 14.6877 7.9999 14.6877C7.66853 14.6877 7.3999 14.4191 7.3999 14.0877V11.1128H2.77773C2.44636 11.1128 2.17773 10.8441 2.17773 10.5128C2.17773 10.1814 2.44636 9.91276 2.77773 9.91276H7.3999V7.78659H3.2001C2.86873 7.78659 2.6001 7.51796 2.6001 7.18659C2.6001 6.85522 2.86873 6.58659 3.2001 6.58659H6.75736L3.89753 2.39085C3.71125 2.11755 3.78234 1.744 4.05631 1.55649C4.33029 1.36899 4.7034 1.43854 4.88968 1.71184L7.94595 6.19577C7.96752 6.22741 7.98564 6.2604 8.00039 6.29429C8.01514 6.2604 8.03326 6.22741 8.05483 6.19577L11.1111 1.71184C11.2974 1.43854 11.6705 1.36899 11.9445 1.55649Z"}}]},Vt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"rmb-icon",ref:t,icon:_r}))});Vt.displayName="RmbIcon";const Sr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.72502 1.02051H6.07803C4.97346 1.02051 4.07803 1.91594 4.07803 3.02051V7.57046H3.00039C2.66902 7.57046 2.40039 7.83909 2.40039 8.17046C2.40039 8.50183 2.66902 8.77046 3.00039 8.77046H4.07803V10.4854H3.00039C2.66902 10.4854 2.40039 10.754 2.40039 11.0854C2.40039 11.4167 2.66902 11.6854 3.00039 11.6854H4.07803V14.3795C4.07803 14.7108 4.34666 14.9795 4.67803 14.9795C5.0094 14.9795 5.27803 14.7108 5.27803 14.3795V11.6854H10.3637C10.695 11.6854 10.9637 11.4167 10.9637 11.0854C10.9637 10.754 10.695 10.4854 10.3637 10.4854H5.27803V8.77046H9.72503C11.8651 8.77046 13.6 7.03557 13.6 4.89548C13.6 2.75539 11.8651 1.02051 9.72502 1.02051ZM9.72503 7.57046H5.27803V3.12051C5.27803 2.62345 5.68097 2.22051 6.17803 2.22051H9.72502C11.2024 2.22051 12.4 3.41814 12.4 4.89548C12.4 6.37283 11.2024 7.57046 9.72503 7.57046Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Nt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"rouble-icon",ref:t,icon:Sr}))});Nt.displayName="RoubleIcon";const Hr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.66628 8.66683C5.03447 8.66683 5.33294 8.36835 5.33294 8.00016C5.33294 7.63197 5.03447 7.3335 4.66628 7.3335C4.29809 7.3335 3.99961 7.63197 3.99961 8.00016C3.99961 8.36835 4.29809 8.66683 4.66628 8.66683Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.99935 10.0002C5.99935 10.3684 5.70087 10.6668 5.33268 10.6668C4.96449 10.6668 4.66602 10.3684 4.66602 10.0002C4.66602 9.63197 4.96449 9.3335 5.33268 9.3335C5.70087 9.3335 5.99935 9.63197 5.99935 10.0002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33268 10.6668C3.70087 10.6668 3.99935 10.3684 3.99935 10.0002C3.99935 9.63197 3.70087 9.3335 3.33268 9.3335C2.96449 9.3335 2.66602 9.63197 2.66602 10.0002C2.66602 10.3684 2.96449 10.6668 3.33268 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.33294 8.00016C7.33294 8.36835 7.03447 8.66683 6.66628 8.66683C6.29809 8.66683 5.99961 8.36835 5.99961 8.00016C5.99961 7.63197 6.29809 7.3335 6.66628 7.3335C7.03447 7.3335 7.33294 7.63197 7.33294 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7.33268 10.6668C7.70087 10.6668 7.99935 10.3684 7.99935 10.0002C7.99935 9.63197 7.70087 9.3335 7.33268 9.3335C6.96449 9.3335 6.66602 9.63197 6.66602 10.0002C6.66602 10.3684 6.96449 10.6668 7.33268 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.33294 8.00016C9.33294 8.36835 9.03447 8.66683 8.66628 8.66683C8.29809 8.66683 7.99961 8.36835 7.99961 8.00016C7.99961 7.63197 8.29809 7.3335 8.66628 7.3335C9.03447 7.3335 9.33294 7.63197 9.33294 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.33268 10.6668C9.70087 10.6668 9.99935 10.3684 9.99935 10.0002C9.99935 9.63197 9.70087 9.3335 9.33268 9.3335C8.96449 9.3335 8.66602 9.63197 8.66602 10.0002C8.66602 10.3684 8.96449 10.6668 9.33268 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.3329 8.00016C11.3329 8.36835 11.0345 8.66683 10.6663 8.66683C10.2981 8.66683 9.99961 8.36835 9.99961 8.00016C9.99961 7.63197 10.2981 7.3335 10.6663 7.3335C11.0345 7.3335 11.3329 7.63197 11.3329 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.3327 10.6668C11.7009 10.6668 11.9993 10.3684 11.9993 10.0002C11.9993 9.63197 11.7009 9.3335 11.3327 9.3335C10.9645 9.3335 10.666 9.63197 10.666 10.0002C10.666 10.3684 10.9645 10.6668 11.3327 10.6668Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.3329 8.00016C13.3329 8.36835 13.0345 8.66683 12.6663 8.66683C12.2981 8.66683 11.9996 8.36835 11.9996 8.00016C11.9996 7.63197 12.2981 7.3335 12.6663 7.3335C13.0345 7.3335 13.3329 7.63197 13.3329 8.00016Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.99961 12.0002C4.99961 11.632 5.29809 11.3335 5.66628 11.3335H10.3329C10.7011 11.3335 10.9996 11.632 10.9996 12.0002C10.9996 12.3684 10.7011 12.6668 10.3329 12.6668H5.66628C5.29809 12.6668 4.99961 12.3684 4.99961 12.0002Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.9999 2.00016C13.9999 1.63197 13.7014 1.3335 13.3332 1.3335C12.965 1.3335 12.6665 1.63197 12.6665 2.00016V3.37516H11.3332C10.7809 3.37516 10.3332 3.82287 10.3332 4.37516V5.3335H1.99935C1.26297 5.3335 0.666016 5.93045 0.666016 6.66683V13.3335C0.666016 14.0699 1.26297 14.6668 1.99935 14.6668H13.9993C14.7357 14.6668 15.3327 14.0699 15.3327 13.3335V6.66683C15.3327 5.93045 14.7357 5.3335 13.9993 5.3335H11.6665V4.7085H12.9999C13.5522 4.7085 13.9999 4.26079 13.9999 3.7085V2.00016ZM1.99935 6.66683V13.3335H13.9993V6.66683H1.99935Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Tt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"shortcut-icon",ref:t,icon:Hr}))});Tt.displayName="ShortcutIcon";const Er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.00033 1.20996C6.43345 1.20996 5.23596 1.88077 4.64804 2.94304C4.06338 3.99943 4.15123 5.32084 4.90099 6.47062C5.08199 6.7482 5.45374 6.82648 5.73131 6.64548C6.00888 6.46448 6.08716 6.09273 5.90616 5.81516C5.36418 4.98402 5.35768 4.13897 5.69797 3.52412C6.035 2.91515 6.78176 2.40996 8.00033 2.40996C9.19423 2.40996 10.0017 2.93409 10.5236 3.46755C10.7871 3.73682 10.9756 4.00712 11.0974 4.20903C11.158 4.30951 11.2013 4.39164 11.2284 4.44625C11.2419 4.47351 11.2514 4.49377 11.2568 4.50588L11.2621 4.51771C11.3901 4.82216 11.7407 4.96686 12.046 4.83992C12.3519 4.71267 12.4968 4.36149 12.3695 4.05552L11.8231 4.28278C12.3695 4.05552 12.3697 4.0558 12.3695 4.05552L12.3691 4.05437L12.3685 4.05298L12.367 4.04953L12.3629 4.03993L12.3498 4.01036C12.3388 3.98619 12.3234 3.95326 12.3033 3.91282C12.2632 3.83203 12.2043 3.72072 12.1249 3.58908C11.9666 3.32674 11.7235 2.97805 11.3814 2.62834C10.6921 1.92381 9.59192 1.20996 8.00033 1.20996Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.11953 8.5999H7.88935C10.1109 9.46549 10.5895 10.7649 10.4268 11.6869C10.2475 12.703 9.26939 13.5898 8.00009 13.5898C6.63323 13.5898 5.77631 13.0502 5.25534 12.528C4.99021 12.2623 4.80823 11.9965 4.69365 11.7993C4.63659 11.7011 4.59698 11.6211 4.5727 11.5686C4.56059 11.5424 4.55236 11.5231 4.54774 11.512L4.54352 11.5016C4.4267 11.193 4.0823 11.0363 3.77279 11.1516C3.46228 11.2673 3.30438 11.6129 3.4201 11.9234L3.9649 11.7203C3.4201 11.9234 3.41998 11.9231 3.4201 11.9234L3.4206 11.9247L3.42118 11.9263L3.42262 11.9301L3.42661 11.9403C3.42977 11.9484 3.43394 11.9588 3.43914 11.9713C3.44956 11.9965 3.46418 12.0304 3.48334 12.0719C3.52161 12.1547 3.57828 12.2682 3.65608 12.4021C3.81124 12.6692 4.0534 13.0223 4.40584 13.3756C5.12 14.0914 6.27196 14.7898 8.00009 14.7898C9.82574 14.7898 11.3236 13.5101 11.6085 11.8955C11.812 10.7422 11.3901 9.55402 10.2665 8.5999H13.8804C14.2117 8.5999 14.4803 8.33127 14.4803 7.9999C14.4803 7.66853 14.2117 7.3999 13.8804 7.3999H8.01411C8.0048 7.39968 7.99551 7.39969 7.98625 7.3999H2.11953C1.78816 7.3999 1.51953 7.66853 1.51953 7.9999C1.51953 8.33127 1.78816 8.5999 2.11953 8.5999Z"}}]},xt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"strikethrough-icon",ref:t,icon:Er}))});xt.displayName="StrikethroughIcon";const Dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{stroke:"currentColor",d:"M2.08596 14.1387L10.3379 2.66873",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M10.3379 14.1387L2.08596 2.66873",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M12.8098 10.0174C13.4565 9.45285 14.781 9.44507 15.0272 10.5759C15.2798 11.736 13.8101 13.2515 12.7376 14.1033C12.7227 14.1151 12.7315 14.1389 12.7505 14.1388L15.2251 14.1388",strokeLinecap:"round",strokeWidth:1.2}}]},$t=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"subscript-icon",ref:t,icon:Dr}))});$t.displayName="SubscriptIcon";const Or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.394135 6.52121C0.394135 5.4474 1.26463 4.5769 2.33844 4.5769H3.90929C4.24066 4.5769 4.50929 4.84553 4.50929 5.1769C4.50929 5.50828 4.24066 5.7769 3.90929 5.7769H2.33844C1.92737 5.7769 1.59414 6.11014 1.59414 6.52121C1.59414 6.93228 1.92737 7.26552 2.33844 7.26552H2.45171C3.59368 7.26552 4.50929 8.20288 4.50929 9.33362C4.50929 10.4761 3.58419 11.4231 2.43051 11.4231H0.893457C0.562086 11.4231 0.293457 11.1544 0.293457 10.8231C0.293457 10.4917 0.562086 10.2231 0.893457 10.2231H2.43051C2.91024 10.2231 3.30929 9.82458 3.30929 9.33362C3.30929 8.85437 2.91974 8.46552 2.45171 8.46552H2.33844C1.26463 8.46552 0.394135 7.59502 0.394135 6.52121Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M15.1061 11.4231C14.7747 11.4231 14.5061 11.1545 14.5061 10.8231L14.5061 8.31006C14.5061 7.97762 14.2366 7.70812 13.9041 7.70812C13.5717 7.70812 13.3022 7.97762 13.3022 8.31006L13.3022 10.8231C13.3022 11.1545 13.0335 11.4231 12.7022 11.4231C12.3708 11.4231 12.1022 11.1545 12.1022 10.8231L12.1022 8.31006C12.1022 7.31488 12.9089 6.50812 13.9041 6.50812C14.8993 6.50812 15.7061 7.31488 15.7061 8.31006L15.7061 10.8231C15.7061 11.1545 15.4374 11.4231 15.1061 11.4231Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.7022 11.4231C12.3709 11.4231 12.1022 11.1545 12.1022 10.8231L12.1022 8.31006C12.1022 7.97762 11.8327 7.70812 11.5003 7.70812C11.1679 7.70812 10.8984 7.97762 10.8984 8.31006L10.8984 10.8231C10.8984 11.1545 10.6297 11.4231 10.2984 11.4231C9.967 11.4231 9.69837 11.1545 9.69837 10.8231L9.69837 8.31006C9.69837 7.31488 10.5051 6.50812 11.5003 6.50812C12.4955 6.50812 13.3022 7.31488 13.3022 8.31006L13.3022 10.8231C13.3022 11.1545 13.0336 11.4231 12.7022 11.4231Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.58193 6.69556C5.9133 6.69556 6.18193 6.96419 6.18193 7.29556L6.18193 9.43683C6.18193 9.87101 6.53391 10.223 6.96809 10.223C7.40228 10.223 7.75425 9.87101 7.75425 9.43683L7.75425 7.29556C7.75425 6.96419 8.02288 6.69556 8.35425 6.69556C8.68563 6.69556 8.95425 6.96419 8.95425 7.29556L8.95425 9.43683C8.95425 10.5338 8.06502 11.423 6.96809 11.423C5.87117 11.423 4.98193 10.5338 4.98193 9.43683L4.98193 7.29556C4.98193 6.96419 5.25056 6.69556 5.58193 6.69556Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Zt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"sum-icon",ref:t,icon:Or}))});Zt.displayName="SumIcon";const Rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{stroke:"currentColor",d:"M2.10904 14.4537L10.299 3.06987",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M10.2989 14.4537L2.10899 3.06987",strokeLinecap:"round",strokeWidth:1.2}},{tag:"path",attrs:{stroke:"currentColor",d:"M12.7525 3.35933C13.3943 2.79901 14.7089 2.79129 14.9533 3.91363C15.204 5.06487 13.7456 6.56876 12.6812 7.41429C12.6663 7.4261 12.6751 7.44982 12.6941 7.44982L15.1497 7.44977",strokeLinecap:"round",strokeWidth:1.2}}]},At=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"superscript-icon",ref:t,icon:Rr}))});At.displayName="SuperscriptIcon";const Vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.21572 1.80029C2.54709 1.80029 2.81572 2.06892 2.81572 2.40029V14.0003C2.81572 14.3317 2.54709 14.6003 2.21572 14.6003C1.88435 14.6003 1.61572 14.3317 1.61572 14.0003V2.40029C1.61572 2.06892 1.88435 1.80029 2.21572 1.80029Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7841 1.80029C14.1155 1.80029 14.3841 2.06892 14.3841 2.40029V14.0003C14.3841 14.3317 14.1155 14.6003 13.7841 14.6003C13.4527 14.6003 13.1841 14.3317 13.1841 14.0003V8.60259H7.13467C6.8033 8.60259 6.53467 8.33396 6.53467 8.00259C6.53467 7.67122 6.8033 7.40259 7.13467 7.40259H13.1841V2.40029C13.1841 2.06892 13.4527 1.80029 13.7841 1.80029Z"}}]},Pt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"truncation-icon",ref:t,icon:Vr}))});Pt.displayName="TruncationIcon";const Nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.46416 2.03237C4.46416 1.701 4.19553 1.43237 3.86416 1.43237C3.53279 1.43237 3.26416 1.701 3.26416 2.03237V7.33338C3.26416 10.0313 5.35834 12.2667 7.9999 12.2667C10.6415 12.2667 12.7356 10.0313 12.7356 7.33338V2.03237C12.7356 1.701 12.467 1.43237 12.1356 1.43237C11.8043 1.43237 11.5356 1.701 11.5356 2.03237V7.33338C11.5356 9.42194 9.92656 11.0667 7.9999 11.0667C6.07325 11.0667 4.46416 9.42194 4.46416 7.33338V2.03237Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.66641 13.4663C2.33504 13.4663 2.06641 13.7349 2.06641 14.0663C2.06641 14.3977 2.33504 14.6663 2.66641 14.6663H13.3331C13.6644 14.6663 13.9331 14.3977 13.9331 14.0663C13.9331 13.7349 13.6644 13.4663 13.3331 13.4663H2.66641Z"}}]},Ft=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"underline-icon",ref:t,icon:Nr}))});Ft.displayName="UnderlineIcon";const Tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.72365 2.72206C4.97524 2.50641 5.00437 2.12763 4.78872 1.87603C4.57306 1.62444 4.19428 1.59531 3.94269 1.81097L1.61333 3.80761C1.48281 3.91768 1.3999 4.08241 1.3999 4.2665C1.3999 4.41745 1.45564 4.55538 1.54766 4.66083C1.55661 4.67109 1.56594 4.68108 1.57563 4.69077L3.9089 7.02411C4.14321 7.25842 4.52311 7.25843 4.75743 7.02412C4.99175 6.78981 4.99175 6.40991 4.75744 6.17559L3.44839 4.8665H9.36337C11.5909 4.8665 13.3967 6.67229 13.3967 8.89984C13.3967 11.1274 11.5909 12.9332 9.36337 12.9332H3.99937C3.668 12.9332 3.39937 13.2018 3.39937 13.5332C3.39937 13.8645 3.668 14.1332 3.99937 14.1332H9.36337C12.2537 14.1332 14.5967 11.7901 14.5967 8.89984C14.5967 6.00955 12.2537 3.6665 9.36337 3.6665H3.62183L4.72365 2.72206Z"}}]},kt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"undo-icon",ref:t,icon:Tr}))});kt.displayName="UndoIcon";const xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.03012 3.14006C3.03012 3.59845 2.65851 3.97006 2.20012 3.97006C1.74172 3.97006 1.37012 3.59845 1.37012 3.14006C1.37012 2.68166 1.74172 2.31006 2.20012 2.31006C2.65851 2.31006 3.03012 2.68166 3.03012 3.14006Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53027 2.54014C4.1989 2.54014 3.93027 2.80877 3.93027 3.14014C3.93027 3.47151 4.1989 3.74014 4.53027 3.74014H14.5488C14.8802 3.74014 15.1488 3.47151 15.1488 3.14014C15.1488 2.80877 14.8802 2.54014 14.5488 2.54014H4.53027Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.20012 8.82992C2.65851 8.82992 3.03012 8.45832 3.03012 7.99992C3.03012 7.54153 2.65851 7.16992 2.20012 7.16992C1.74172 7.16992 1.37012 7.54153 1.37012 7.99992C1.37012 8.45832 1.74172 8.82992 2.20012 8.82992Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53027 7.4C4.1989 7.4 3.93027 7.66863 3.93027 8C3.93027 8.33137 4.1989 8.6 4.53027 8.6H14.5488C14.8802 8.6 15.1488 8.33137 15.1488 8C15.1488 7.66863 14.8802 7.4 14.5488 7.4H4.53027Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.20012 13.6905C2.65851 13.6905 3.03012 13.3189 3.03012 12.8605C3.03012 12.4021 2.65851 12.0305 2.20012 12.0305C1.74172 12.0305 1.37012 12.4021 1.37012 12.8605C1.37012 13.3189 1.74172 13.6905 2.20012 13.6905Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.53027 12.2604C4.1989 12.2604 3.93027 12.529 3.93027 12.8604C3.93027 13.1917 4.1989 13.4604 4.53027 13.4604H14.5488C14.8802 13.4604 15.1488 13.1917 15.1488 12.8604C15.1488 12.529 14.8802 12.2604 14.5488 12.2604H4.53027Z"}}]},Bt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"unorder-icon",ref:t,icon:xr}))});Bt.displayName="UnorderIcon";const $r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.9999 0.733398C8.33127 0.733398 8.5999 1.00203 8.5999 1.3334V4.55137L9.57564 3.57564C9.80995 3.34132 10.1899 3.34132 10.4242 3.57564C10.6585 3.80995 10.6585 4.18985 10.4242 4.42417L8.42417 6.42417C8.18985 6.65848 7.80995 6.65848 7.57564 6.42417L5.57564 4.42417C5.34132 4.18985 5.34132 3.80995 5.57564 3.57564C5.80995 3.34132 6.18985 3.34132 6.42417 3.57564L7.3999 4.55137V1.3334C7.3999 1.00203 7.66853 0.733398 7.9999 0.733398Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.57564 11.5756L7.57564 9.57564C7.80995 9.34132 8.18985 9.34132 8.42417 9.57564L10.4242 11.5756C10.6585 11.81 10.6585 12.1899 10.4242 12.4242C10.1899 12.6585 9.80995 12.6585 9.57564 12.4242L8.5999 11.4484V14.6665C8.5999 14.9979 8.33127 15.2665 7.9999 15.2665C7.66853 15.2665 7.3999 14.9979 7.3999 14.6665V11.4484L6.42417 12.4242C6.18985 12.6585 5.80995 12.6585 5.57564 12.4242C5.34132 12.1899 5.34132 11.81 5.57564 11.5756Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 7.40015C1.66853 7.40015 1.3999 7.66878 1.3999 8.00015C1.3999 8.33152 1.66853 8.60015 1.9999 8.60015H13.9999C14.3313 8.60015 14.5999 8.33152 14.5999 8.00015C14.5999 7.66878 14.3313 7.40015 13.9999 7.40015H1.9999Z"}}]},Ut=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-center-icon",ref:t,icon:$r}))});Ut.displayName="VerticalCenterIcon";const Zr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.2157 2.90265C2.2157 2.16628 2.81264 1.56934 3.54901 1.56934H6.21565C6.95202 1.56934 7.54896 2.16628 7.54896 2.90265V13.5692C7.54896 14.3056 6.95202 14.9025 6.21565 14.9025H3.54901C2.81264 14.9025 2.2157 14.3056 2.2157 13.5692V2.90265ZM3.54901 2.90265H6.21565V5.5622H3.54901V2.90265ZM3.54901 6.89552V9.57631H6.21565V6.89552H3.54901ZM3.54901 13.5692V10.9096H6.21565V13.5692H3.54901Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.2156 2.90265C10.2156 2.16628 10.8125 1.56934 11.5489 1.56934H14.2155C14.9519 1.56934 15.5489 2.16628 15.5489 2.90265V13.5692C15.5489 14.3056 14.9519 14.9025 14.2155 14.9025H11.5489C10.8125 14.9025 10.2156 14.3056 10.2156 13.5692V2.90265ZM11.5489 2.90265H14.2155V5.5622H11.5489V2.90265ZM11.5489 6.89552V9.57631H14.2155V6.89552H11.5489ZM11.5489 13.5692V10.9096H14.2155V13.5692H11.5489Z",fillRule:"evenodd",clipRule:"evenodd"}}]},jt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-integration-icon",ref:t,icon:Zr}))});jt.displayName="VerticalIntegrationIcon";const Ar={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.55504 2.73208C4.55504 2.40071 4.28641 2.13208 3.95504 2.13208C3.62367 2.13208 3.35504 2.40071 3.35504 2.73208V12.5172L2.21439 11.5276C1.96409 11.3104 1.58515 11.3373 1.36799 11.5876C1.15084 11.8379 1.17771 12.2169 1.42801 12.434L2.89972 13.7108C3.54718 14.2726 4.55504 13.8127 4.55504 12.9555L4.55504 2.73208Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M9.00725 4.01095C9.45595 2.78663 11.1875 2.78662 11.6362 4.01095L14.743 12.488C14.8571 12.7992 14.6973 13.1438 14.3861 13.2578C14.075 13.3719 13.7303 13.2121 13.6163 12.9009L12.4148 9.62242H8.36729C8.32154 9.62242 8.27699 9.6173 8.23417 9.6076L7.02719 12.9009C6.91316 13.2121 6.5685 13.3719 6.25736 13.2578C5.94623 13.1438 5.78644 12.7992 5.90047 12.488L9.00725 4.01095ZM10.5095 4.42388L11.975 8.42242H8.66853L10.134 4.42389C10.1981 4.24898 10.4454 4.24898 10.5095 4.42388Z",fillRule:"evenodd",clipRule:"evenodd"}}]},zt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-text-icon",ref:t,icon:Ar}))});zt.displayName="VerticalTextIcon";const Pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M8.60231 5.77597L9.38125 6.55432C9.61658 6.78947 9.99797 6.78932 10.2331 6.554C10.4683 6.31867 10.4681 5.93728 10.2328 5.70214L8.44939 3.92009C8.33908 3.79657 8.1786 3.7188 7.99995 3.7188C7.84562 3.71861 7.6906 3.77736 7.57281 3.89506L5.76712 5.69933C5.5318 5.93447 5.53165 6.31587 5.76679 6.55119C6.00193 6.78652 6.38332 6.78667 6.61865 6.55153L7.3976 5.77319L7.3976 10.2246L6.61865 9.44621C6.38333 9.21107 6.00194 9.21121 5.76679 9.44654C5.53165 9.68186 5.53179 10.0633 5.76712 10.2984L7.55051 12.0804C7.66082 12.204 7.82131 12.2817 7.99995 12.2817L8.00089 12.2817C8.15512 12.2819 8.30939 12.2231 8.4271 12.1055L10.2328 10.3012C10.4681 10.0661 10.4683 9.68467 10.2331 9.44934C9.99798 9.21402 9.61659 9.21387 9.38126 9.44901L8.60231 10.2274L8.60231 5.77597Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7039 3.24701C14.0539 3.24701 14.3377 2.96327 14.3377 2.61325C14.3377 2.26324 14.0539 1.97949 13.7039 1.97949L2.29627 1.97949C1.94625 1.97949 1.66251 2.26324 1.66251 2.61325C1.66251 2.96327 1.94625 3.24701 2.29627 3.24701L13.7039 3.24701Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7039 14.0209C14.0539 14.0209 14.3377 13.7372 14.3377 13.3872C14.3377 13.0371 14.0539 12.7534 13.7039 12.7534L2.29627 12.7534C1.94625 12.7534 1.66251 13.0371 1.66251 13.3872C1.66251 13.7372 1.94625 14.0209 2.29627 14.0209L13.7039 14.0209Z"}}]},Wt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"adjust-height-double-icon",ref:t,icon:Pr}))});Wt.displayName="AdjustHeightDoubleIcon";const Fr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.77574 7.3974L6.5541 6.61846C6.78924 6.38313 6.78909 6.00174 6.55377 5.7666C6.31844 5.53145 5.93705 5.5316 5.70191 5.76692L3.91987 7.55032C3.79634 7.66063 3.71857 7.82111 3.71857 7.99976C3.71838 8.15409 3.77713 8.30912 3.89483 8.42691L5.6991 10.2326C5.93425 10.4679 6.31564 10.4681 6.55096 10.2329C6.78629 9.99778 6.78644 9.61639 6.5513 9.38106L5.77296 8.60211L10.2243 8.60211L9.44598 9.38106C9.21084 9.61638 9.21099 9.99777 9.44631 10.2329C9.68164 10.4681 10.063 10.4679 10.2982 10.2326L12.0802 8.4492C12.2037 8.33889 12.2815 8.1784 12.2815 7.99976L12.2815 7.99882C12.2816 7.84459 12.2229 7.69032 12.1052 7.57261L10.301 5.76693C10.0658 5.5316 9.68444 5.53145 9.44911 5.76659C9.21379 6.00173 9.21364 6.38312 9.44878 6.61845L10.2271 7.3974L5.77574 7.3974Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.24683 2.29598C3.24683 1.94596 2.96308 1.66222 2.61307 1.66222C2.26305 1.66222 1.97931 1.94596 1.97931 2.29598L1.97931 13.7036C1.97931 14.0537 2.26305 14.3374 2.61307 14.3374C2.96308 14.3374 3.24683 14.0537 3.24683 13.7036L3.24683 2.29598Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0207 2.29598C14.0207 1.94596 13.737 1.66222 13.387 1.66222C13.037 1.66222 12.7532 1.94596 12.7532 2.29598L12.7532 13.7036C12.7532 14.0537 13.037 14.3374 13.387 14.3374C13.737 14.3374 14.0207 14.0537 14.0207 13.7036L14.0207 2.29598Z"}}]},Gt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"adjust-width-double-icon",ref:t,icon:Fr}))});Gt.displayName="AdjustWidthDoubleIcon";const kr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.29713 1.98047C1.94717 1.98047 1.66348 2.26416 1.66348 2.61412C1.66348 2.96408 1.94717 3.24777 2.29713 3.24777H13.7028C14.0528 3.24777 14.3365 2.96408 14.3365 2.61412C14.3365 2.26416 14.0528 1.98047 13.7028 1.98047H2.29713Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.29713 12.7525C1.94717 12.7525 1.66348 13.0362 1.66348 13.3862C1.66348 13.7361 1.94717 14.0198 2.29713 14.0198H13.7028C14.0528 14.0198 14.3365 13.7361 14.3365 13.3862C14.3365 13.0362 14.0528 12.7525 13.7028 12.7525H2.29713Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.42163 4.25588L4.25471 11.2231C4.10989 11.5417 4.25077 11.9174 4.56935 12.0622C4.88794 12.207 5.2636 12.0661 5.40841 11.7475L6.24766 9.90119H9.75197L10.5912 11.7475C10.736 12.0661 11.1117 12.207 11.4303 12.0622C11.7489 11.9174 11.8897 11.5417 11.7449 11.2231L8.578 4.25589C8.5675 4.23244 8.55557 4.20961 8.54227 4.18755C8.49012 4.10102 8.41688 4.0262 8.32579 3.97171C8.301 3.95688 8.27527 3.94377 8.24878 3.93246C8.16764 3.89775 8.08309 3.8813 7.99981 3.88135C7.88457 3.88142 7.77177 3.91309 7.67384 3.97171C7.58714 4.02361 7.5121 4.09664 7.45735 4.18755C7.44406 4.20961 7.43213 4.23244 7.42163 4.25588ZM9.17592 8.63388L7.99981 6.04644L6.8237 8.63388H9.17592Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Yt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"auto-height-double-icon",ref:t,icon:kr}))});Yt.displayName="AutoHeightDoubleIcon";const Br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.98032 13.7028C1.98032 14.0527 2.26401 14.3364 2.61397 14.3364C2.96392 14.3364 3.24762 14.0527 3.24762 13.7028L3.24762 2.29706C3.24762 1.9471 2.96392 1.66341 2.61397 1.66341C2.26401 1.66341 1.98032 1.9471 1.98032 2.29706L1.98032 13.7028Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.7524 13.7028C12.7524 14.0527 13.0361 14.3364 13.386 14.3364C13.736 14.3364 14.0197 14.0527 14.0197 13.7028L14.0197 2.29706C14.0197 1.9471 13.736 1.66341 13.386 1.66341C13.0361 1.66341 12.7524 1.9471 12.7524 2.29706L12.7524 13.7028Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.42187 4.25588L4.25495 11.2231C4.11014 11.5417 4.25101 11.9174 4.5696 12.0622C4.88819 12.207 5.26385 12.0661 5.40866 11.7475L6.2479 9.90119H9.75222L10.5915 11.7475C10.7363 12.0661 11.1119 12.207 11.4305 12.0622C11.7491 11.9174 11.89 11.5417 11.7452 11.2231L8.57825 4.25589C8.56775 4.23244 8.55582 4.20961 8.54252 4.18755C8.49037 4.10102 8.41713 4.0262 8.32603 3.97171C8.30125 3.95688 8.27551 3.94377 8.24902 3.93246C8.16788 3.89775 8.08333 3.8813 8.00006 3.88135C7.88481 3.88142 7.77201 3.91309 7.67409 3.97171C7.58739 4.02361 7.51235 4.09664 7.4576 4.18755C7.4443 4.20961 7.43237 4.23244 7.42187 4.25588ZM9.17617 8.63388L8.00006 6.04644L6.82395 8.63388H9.17617Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Xt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"auto-width-double-icon",ref:t,icon:Br}))});Xt.displayName="AutoWidthDoubleIcon";const Ur={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.5853 14.7987L2.27159 3.485L3.12012 2.63647L14.4338 13.9502L13.5853 14.7987Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.69629 12.8102L1.69629 14.1743C1.69629 14.8371 2.23355 15.3743 2.89629 15.3743L4.26042 15.3743L4.26042 14.0443L3.02629 14.0443L3.02629 12.8102L1.69629 12.8102ZM4.26042 2.06128L2.89629 2.06128C2.23355 2.06128 1.69629 2.59854 1.69629 3.26128L1.69629 4.62541L3.02629 4.62541L3.02629 3.39128L4.26042 3.39128L4.26042 2.06128ZM1.69629 10.0819L3.02629 10.0819L3.02629 7.35367L1.69629 7.35367L1.69629 10.0819ZM6.98868 2.06128L6.98868 3.39128L9.71693 3.39128L9.71693 2.06128L6.98868 2.06128ZM12.4452 2.06128L12.4452 3.39128L13.6793 3.39128L13.6793 4.62541L15.0093 4.62541L15.0093 3.26128C15.0093 2.59854 14.4721 2.06128 13.8093 2.06128L12.4452 2.06128ZM15.0093 7.35367L13.6793 7.35367L13.6793 10.0819L15.0093 10.0819L15.0093 7.35367ZM15.0093 12.8102L13.6793 12.8102L13.6793 14.0443L12.4452 14.0443L12.4452 15.3743L13.8093 15.3743C14.4721 15.3743 15.0093 14.8371 15.0093 14.1743L15.0093 12.8102ZM9.71693 15.3743L9.71693 14.0443L6.98868 14.0443L6.98868 15.3743L9.71693 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]},qt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"back-slash-double-icon",ref:t,icon:Ur}))});qt.displayName="BackSlashDoubleIcon";const jr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.36831 3.22148C5.36831 1.94497 6.40313 0.910156 7.67964 0.910156C8.95615 0.910156 9.99097 1.94497 9.99097 3.22149V6.74754H8.72649V3.22149C8.72649 2.64333 8.2578 2.17464 7.67964 2.17464C7.10148 2.17464 6.63279 2.64333 6.63279 3.22148V6.74754H5.36831V3.22148Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.00091 5.47314C3.33644 5.47314 1.9499 6.74914 1.81192 8.40788L1.54428 11.6254C1.38911 13.4909 2.86133 15.0906 4.73327 15.0906H13.6667C14.175 15.0906 14.5544 14.6228 14.4495 14.1255L13.0262 7.37781C12.792 6.26766 11.8125 5.47314 10.6779 5.47314H5.00091ZM10.6779 6.75314H5.00091C4.00223 6.75314 3.1703 7.51874 3.08751 8.51399L2.81988 11.7315C2.72677 12.8508 3.61011 13.8106 4.73327 13.8106H5.7695C5.26362 13.0554 5.05585 12.0527 5.31224 11.047C5.40861 10.6689 5.76242 10.4493 6.10249 10.5564C6.44256 10.6636 6.64012 11.0569 6.54374 11.4349C6.27517 12.4885 6.92898 13.6738 7.87916 13.8106H9.01412C8.50824 13.0554 8.30047 12.0527 8.55686 11.047C8.65324 10.6689 9.00704 10.4493 9.34711 10.5564C9.68719 10.6636 9.88474 11.0569 9.78837 11.4349C9.51979 12.4885 10.1736 13.6738 11.1238 13.8106H13.0749L11.7738 7.64199C11.6645 7.12392 11.2073 6.75314 10.6779 6.75314Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Jt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"clear-format-double-icon",ref:t,icon:jr}))});Jt.displayName="ClearFormatDoubleIcon";const zr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.59 1.51H10.46V14.46H5.59z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.34863 2.53325C1.34863 1.87051 1.88589 1.33325 2.54863 1.33325H13.482C14.1447 1.33325 14.682 1.87051 14.682 2.53325V13.4666C14.682 14.1294 14.1447 14.6666 13.482 14.6666H2.54863C1.88589 14.6666 1.34863 14.1294 1.34863 13.4666V2.53325ZM13.082 2.63325C13.2477 2.63325 13.382 2.76757 13.382 2.93325V5.09946C13.382 5.26515 13.2477 5.39946 13.082 5.39946H10.9708C10.8052 5.39946 10.6708 5.26515 10.6708 5.09946V2.93325C10.6708 2.76757 10.8052 2.63325 10.9708 2.63325H13.082ZM9.37085 2.93325C9.37085 2.76757 9.23653 2.63325 9.07085 2.63325H6.95974C6.79406 2.63325 6.65974 2.76757 6.65974 2.93325V5.09946C6.65974 5.26515 6.79406 5.39946 6.95974 5.39946L9.07085 5.39946C9.23654 5.39946 9.37085 5.26515 9.37085 5.09946V2.93325ZM5.35974 2.93325C5.35974 2.76757 5.22543 2.63325 5.05974 2.63325H2.94863C2.78295 2.63325 2.64863 2.76757 2.64863 2.93325V5.09946C2.64863 5.26515 2.78295 5.39946 2.94863 5.39946H5.05974C5.22543 5.39946 5.35974 5.26515 5.35974 5.09946V2.93325ZM2.94863 6.69946C2.78295 6.69946 2.64863 6.83378 2.64863 6.99946V9.11045C2.64863 9.27613 2.78295 9.41045 2.94863 9.41045H5.05974C5.22543 9.41045 5.35974 9.27613 5.35974 9.11045V6.99946C5.35974 6.83378 5.22543 6.69946 5.05974 6.69946H2.94863ZM2.94863 10.7104C2.78295 10.7104 2.64863 10.8448 2.64863 11.0104V13.0666C2.64863 13.2323 2.78295 13.3666 2.94863 13.3666H5.05974C5.22543 13.3666 5.35974 13.2323 5.35974 13.0666V11.0104C5.35974 10.8448 5.22543 10.7104 5.05974 10.7104H2.94863ZM6.65974 13.0666C6.65974 13.2323 6.79406 13.3666 6.95974 13.3666H9.07085C9.23653 13.3666 9.37085 13.2323 9.37085 13.0666V11.0104C9.37085 10.8448 9.23653 10.7104 9.07085 10.7104L6.95974 10.7104C6.79406 10.7104 6.65974 10.8448 6.65974 11.0104V13.0666ZM10.6708 13.0666C10.6708 13.2323 10.8052 13.3666 10.9708 13.3666H13.082C13.2477 13.3666 13.382 13.2323 13.382 13.0666V11.0104C13.382 10.8448 13.2477 10.7104 13.082 10.7104H10.9708C10.8052 10.7104 10.6708 10.8448 10.6708 11.0104V13.0666ZM13.082 9.41045C13.2477 9.41045 13.382 9.27613 13.382 9.11045V6.99946C13.382 6.83378 13.2477 6.69946 13.082 6.69946H10.9708C10.8052 6.69946 10.6708 6.83378 10.6708 6.99946V9.11045C10.6708 9.27613 10.8052 9.41045 10.9708 9.41045H13.082ZM6.95974 9.41045C6.79406 9.41045 6.65974 9.27613 6.65974 9.11045V6.99946C6.65974 6.83378 6.79406 6.69946 6.95974 6.69946L9.07085 6.69946C9.23653 6.69946 9.37085 6.83378 9.37085 6.99946V9.11045C9.37085 9.27613 9.23653 9.41045 9.07085 9.41045H6.95974Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Qt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"conditions-double-icon",ref:t,icon:zr}))});Qt.displayName="ConditionsDoubleIcon";const Wr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.4004 2.60213C5.25792 2.60213 5.14241 2.71763 5.14241 2.86011V4.32679C5.14241 4.67752 4.85809 4.96184 4.50736 4.96184C4.15663 4.96184 3.87231 4.67752 3.87231 4.32679V2.86011C3.87231 2.01618 4.55646 1.33203 5.4004 1.33203H13.14C13.984 1.33203 14.6681 2.01618 14.6681 2.86011V10.5998C14.6681 11.4437 13.984 12.1278 13.14 12.1278H11.6568C11.3061 12.1278 11.0218 11.8435 11.0218 11.4928C11.0218 11.1421 11.3061 10.8577 11.6568 10.8577H13.14C13.2825 10.8577 13.398 10.7422 13.398 10.5998V2.86011C13.398 2.71763 13.2825 2.60213 13.14 2.60213H5.4004Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33203 5.40015C1.33203 4.55622 2.01618 3.87207 2.86011 3.87207H10.5998C11.4437 3.87207 12.1278 4.55622 12.1278 5.40015V13.1398C12.1278 13.9837 11.4437 14.6679 10.5998 14.6679H2.86011C2.01618 14.6679 1.33203 13.9837 1.33203 13.1398V5.40015ZM2.86011 5.14217C2.71763 5.14217 2.60213 5.25767 2.60213 5.40015V13.1398C2.60213 13.2823 2.71763 13.3978 2.86011 13.3978H10.5998C10.7422 13.3978 10.8577 13.2823 10.8577 13.1398V5.40015C10.8577 5.25767 10.7422 5.14217 10.5998 5.14217H2.86011Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Kt=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"copy-double-icon",ref:t,icon:Wr}))});Kt.displayName="CopyDoubleIcon";const Gr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.69148 5.44796C7.69148 5.07977 7.393 4.7813 7.02481 4.7813H3.25445C2.88626 4.7813 2.58779 5.07977 2.58779 5.44796V10.5516C2.58779 10.9198 2.88626 11.2183 3.25445 11.2183H7.02481C7.393 11.2183 7.69148 10.9198 7.69148 10.5516V5.44796ZM2.58779 3.50537C1.88311 3.50537 1.31186 4.07662 1.31186 4.7813V11.2183C1.31186 11.923 1.88311 12.4942 2.58779 12.4942H7.69148C8.39613 12.4942 8.96739 11.923 8.96739 11.2183V4.7813C8.96739 4.07662 8.39613 3.50537 7.69148 3.50537H2.58779Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.8919 10.4557C11.9671 10.4869 12.0496 10.5041 12.1361 10.5041C12.2226 10.5041 12.3051 10.4869 12.3803 10.4557C12.4555 10.4246 12.526 10.3784 12.5872 10.3172L14.5011 8.40335C14.7502 8.15421 14.7502 7.75028 14.5011 7.50114C14.2519 7.252 13.848 7.252 13.5989 7.50114L12.774 8.32595V6.13406C12.774 5.78172 12.4884 5.49609 12.1361 5.49609C11.7837 5.49609 11.4981 5.78172 11.4981 6.13406V8.32595L10.6733 7.50114C10.4241 7.252 10.0202 7.252 9.77106 7.50114C9.52192 7.75028 9.52192 8.15421 9.77106 8.40335L11.6847 10.3169M6.97288 9.84189C6.69858 10.1235 6.25386 10.1235 5.97956 9.84189L5.17866 9.01974L4.37769 9.84195C4.1034 10.1235 3.65867 10.1235 3.38437 9.84195C3.11008 9.56038 3.11008 9.10385 3.38437 8.82228L4.18534 8.00007L3.38439 7.17787C3.11009 6.8963 3.11009 6.43977 3.38439 6.1582C3.65869 5.87663 4.10341 5.87663 4.37771 6.1582L5.17866 6.9804L5.97954 6.15826C6.25384 5.87669 6.69857 5.87669 6.97287 6.15826C7.24716 6.43984 7.24716 6.89636 6.97286 7.17793L6.17198 8.00007L6.97288 8.82222C7.24718 9.10379 7.24718 9.56031 6.97288 9.84189Z",fillRule:"evenodd",clipRule:"evenodd"}}]},e9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-move-down-double-icon",ref:t,icon:Gr}))});e9.displayName="DeleteCellMoveDownDoubleIcon";const Yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.29012 10.552C8.29012 10.9202 8.5886 11.2187 8.95679 11.2187L12.7271 11.2187C13.0953 11.2187 13.3938 10.9202 13.3938 10.552L13.3938 5.44836C13.3938 5.08016 13.0953 4.7817 12.7271 4.7817L8.95678 4.7817C8.5886 4.7817 8.29012 5.08016 8.29012 5.44836L8.29012 10.552ZM13.3938 12.4946C14.0985 12.4946 14.6697 11.9234 14.6697 11.2187L14.6697 4.7817C14.6697 4.07703 14.0985 3.50576 13.3938 3.50576L8.29012 3.50576C7.58547 3.50576 7.0142 4.07703 7.0142 4.7817L7.0142 11.2187C7.0142 11.9234 7.58547 12.4946 8.29012 12.4946L13.3938 12.4946Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.37899 7.7562C1.34779 7.83142 1.33053 7.9139 1.33053 8.0004C1.33053 8.0869 1.34779 8.16938 1.37899 8.2446C1.41013 8.31985 1.45626 8.39034 1.51739 8.45151L3.43133 10.3654C3.68046 10.6145 4.08439 10.6145 4.33353 10.3654C4.58266 10.1163 4.58266 9.71232 4.33353 9.46318L3.50873 8.63836L5.70059 8.63836C6.05293 8.63836 6.33855 8.35273 6.33855 8.0004C6.33855 7.64806 6.05293 7.36244 5.70059 7.36244L3.50873 7.36244L4.33353 6.53762C4.58266 6.28848 4.58266 5.88455 4.33353 5.63541C4.08439 5.38627 3.68046 5.38627 3.43133 5.63541L1.51773 7.54899M9.00896 6.15858C9.28326 5.87701 9.72798 5.87701 10.0023 6.15858L10.8032 6.98073L11.6042 6.15852C11.8784 5.87695 12.3232 5.87695 12.5975 6.15852C12.8718 6.44009 12.8718 6.89661 12.5975 7.17819L11.7965 8.00041L12.5975 8.8226C12.8718 9.10417 12.8718 9.56069 12.5975 9.84227C12.3232 10.1238 11.8784 10.1238 11.6041 9.84227L10.8032 9.02007L10.0023 9.84221C9.728 10.1238 9.28327 10.1238 9.00897 9.84221C8.73468 9.56063 8.73468 9.10411 9.00898 8.82254L9.80987 8.00041L9.00896 7.17825C8.73466 6.89668 8.73466 6.44016 9.00896 6.15858Z",fillRule:"evenodd",clipRule:"evenodd"}}]},t9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-shift-left-double-icon",ref:t,icon:Yr}))});t9.displayName="DeleteCellShiftLeftDoubleIcon";const Xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.70985 5.44796C7.70985 5.07977 7.41137 4.7813 7.04318 4.7813H3.27282C2.90463 4.7813 2.60616 5.07977 2.60616 5.44796V10.5516C2.60616 10.9198 2.90463 11.2183 3.27282 11.2183H7.04318C7.41137 11.2183 7.70985 10.9198 7.70985 10.5516V5.44796ZM2.60616 3.50537C1.90148 3.50537 1.33023 4.07662 1.33023 4.7813V11.2183C1.33023 11.923 1.90148 12.4942 2.60616 12.4942H7.70985C8.4145 12.4942 8.98576 11.923 8.98576 11.2183V4.7813C8.98576 4.07662 8.4145 3.50537 7.70985 3.50537H2.60616Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.621 8.2438C14.6522 8.16858 14.6695 8.0861 14.6695 7.9996C14.6695 7.9131 14.6522 7.83062 14.621 7.7554C14.5899 7.68015 14.5438 7.60966 14.4826 7.54849L12.5687 5.63461C12.3196 5.38547 11.9156 5.38547 11.6665 5.63461C11.4174 5.88375 11.4174 6.28768 11.6665 6.53682L12.4913 7.36164H10.2994C9.94711 7.36164 9.66148 7.64727 9.66148 7.9996C9.66148 8.35194 9.94711 8.63756 10.2994 8.63756H12.4913L11.6665 9.46238C11.4174 9.71152 11.4174 10.1155 11.6665 10.3646C11.9156 10.6137 12.3196 10.6137 12.5687 10.3646L14.4823 8.45101M6.99107 9.84142C6.71677 10.123 6.27205 10.123 5.99775 9.84142L5.19685 9.01927L4.39588 9.84148C4.12159 10.1231 3.67686 10.1231 3.40256 9.84148C3.12826 9.55991 3.12826 9.10339 3.40256 8.82181L4.20353 7.99959L3.40258 7.1774C3.12828 6.89583 3.12828 6.43931 3.40258 6.15773C3.67688 5.87616 4.1216 5.87616 4.3959 6.15773L5.19685 6.97993L5.99773 6.15779C6.27203 5.87622 6.71676 5.87622 6.99106 6.15779C7.26535 6.43937 7.26535 6.89589 6.99105 7.17746L6.19017 7.99959L6.99107 8.82175C7.26537 9.10332 7.26537 9.55984 6.99107 9.84142Z",fillRule:"evenodd",clipRule:"evenodd"}}]},n9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-shift-right-double-icon",ref:t,icon:Xr}))});n9.displayName="DeleteCellShiftRightDoubleIcon";const qr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.69172 10.552C7.69172 10.9202 7.39324 11.2187 7.02506 11.2187H3.2547C2.8865 11.2187 2.58803 10.9202 2.58803 10.552V5.44836C2.58803 5.08016 2.8865 4.7817 3.2547 4.7817H7.02506C7.39324 4.7817 7.69172 5.08016 7.69172 5.44836V10.552ZM2.58803 12.4946C1.88335 12.4946 1.3121 11.9234 1.3121 11.2187V4.7817C1.3121 4.07703 1.88335 3.50576 2.58803 3.50576H7.69172C8.39637 3.50576 8.96764 4.07703 8.96764 4.7817V11.2187C8.96764 11.9234 8.39637 12.4946 7.69172 12.4946H2.58803Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.892 5.54431C11.9672 5.51312 12.0497 5.49591 12.1362 5.49591C12.2227 5.49591 12.3052 5.51312 12.3804 5.54431C12.4557 5.57545 12.5261 5.62159 12.5873 5.68276L14.5012 7.59665C14.7503 7.84579 14.7503 8.24972 14.5012 8.49886C14.2521 8.748 13.8481 8.748 13.599 8.49886L12.7741 7.67405V9.86594C12.7741 10.2183 12.4885 10.5039 12.1362 10.5039C11.7839 10.5039 11.4983 10.2183 11.4983 9.86594V7.67405L10.6734 8.49886C10.4243 8.748 10.0203 8.748 9.77121 8.49886C9.52207 8.24972 9.52207 7.84579 9.77121 7.59665L11.6848 5.68305M6.97304 6.15811C6.69874 5.87653 6.25401 5.87654 5.97972 6.15811L5.17881 6.98026L4.37784 6.15805C4.10355 5.87647 3.65882 5.87647 3.38453 6.15805C3.11023 6.43962 3.11023 6.89615 3.38453 7.17772L4.18549 7.99993L3.38454 8.82213C3.11024 9.1037 3.11024 9.56023 3.38454 9.8418C3.65884 10.1234 4.10356 10.1234 4.37786 9.8418L5.17881 9.0196L5.9797 9.84174C6.254 10.1233 6.69872 10.1233 6.97302 9.84174C7.24732 9.56016 7.24732 9.10364 6.97302 8.82207L6.17213 7.99993L6.97304 7.17778C7.24734 6.89621 7.24734 6.43969 6.97304 6.15811Z",fillRule:"evenodd",clipRule:"evenodd"}}]},r9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-cell-shift-up-double-icon",ref:t,icon:qr}))});r9.displayName="DeleteCellShiftUpDoubleIcon";const Jr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.9503 1.33317C12.6866 1.33317 13.2836 1.9301 13.2836 2.6665V13.3332C13.2836 14.0695 12.6866 14.6665 11.9503 14.6665H9.28359C8.54721 14.6665 7.95026 14.0696 7.95026 13.3332L7.95026 2.6665C7.95026 1.9301 8.54721 1.33317 9.28359 1.33317H11.9503ZM11.9503 2.6665V13.3332H9.28359V2.6665H11.9503Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.8542 6.29716C3.59385 6.03681 3.17174 6.03681 2.91139 6.29716C2.65104 6.55751 2.65104 6.97962 2.91139 7.23997L3.67157 8.00014L2.9114 8.76031C2.65105 9.02066 2.65105 9.44277 2.9114 9.70312C3.17175 9.96347 3.59387 9.96347 3.85421 9.70312L4.61437 8.94296L5.37459 9.70318C5.63494 9.96352 6.05705 9.96353 6.31741 9.70318C6.57775 9.44283 6.57775 9.02072 6.31741 8.76036L5.55718 8.00014L6.31742 7.23991C6.57777 6.97956 6.57777 6.55745 6.31742 6.2971C6.05707 6.03675 5.63496 6.03675 5.37461 6.2971L4.61437 7.05734L3.8542 6.29716Z",fillRule:"evenodd",clipRule:"evenodd"}}]},o9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-column-double-icon",ref:t,icon:Jr}))});o9.displayName="DeleteColumnDoubleIcon";const Qr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6666 11.9502C14.6666 12.6866 14.0697 13.2835 13.3333 13.2835H2.66665C1.93027 13.2835 1.33331 12.6866 1.33331 11.9502V9.28353C1.33331 8.54715 1.93027 7.9502 2.66665 7.9502L13.3333 7.9502C14.0697 7.9502 14.6666 8.54715 14.6666 9.28353V11.9502ZM13.3333 11.9502H2.66665V9.28353H13.3333V11.9502Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.60134 3.85438C9.86169 3.59403 9.86169 3.17192 9.60134 2.91157C9.34099 2.65122 8.91888 2.65122 8.65853 2.91157L7.89835 3.67175L7.13819 2.91159C6.87784 2.65124 6.45573 2.65124 6.19538 2.91159C5.93503 3.17194 5.93503 3.59405 6.19538 3.8544L6.95554 4.61456L6.19532 5.37478C5.93497 5.63513 5.93497 6.05724 6.19532 6.31759C6.45567 6.57794 6.87778 6.57794 7.13813 6.31759L7.89835 5.55737L8.65859 6.3176C8.91893 6.57796 9.34105 6.57796 9.60139 6.3176C9.86175 6.05726 9.86175 5.63514 9.60139 5.3748L8.84116 4.61456L9.60134 3.85438Z",fillRule:"evenodd",clipRule:"evenodd"}}]},i9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"delete-row-double-icon",ref:t,icon:Qr}))});i9.displayName="DeleteRowDoubleIcon";const Kr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 9.33301H2.66659V6.66634H1.33325V9.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66659 1.33301V2.66634H7.33325V5.33301H8.66659V2.66634H9.33325V1.33301H6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6666 6.66634H13.3333V7.33301H10.6666V8.66634H13.3333V9.33301H14.6666V6.66634Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33325 13.333V10.6663H8.66659V13.333H7.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M5.33325 7.33301H2.66659V8.66634H5.33325V7.33301Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33325 13.3333V12H2.66659L2.66659 13.3333H13.3333V12H14.6666V13.3333C14.6666 14.0697 14.0696 14.6667 13.3333 14.6667H2.66659C1.93021 14.6667 1.33325 14.0697 1.33325 13.3333Z"}}]},l9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"down-border-double-icon",ref:t,icon:Kr}))});l9.displayName="DownBorderDoubleIcon";const e2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.3014 1.70389C9.85268 0.479568 8.12109 0.479557 7.67238 1.70389L4.72235 9.75326C4.60832 10.0644 4.76811 10.4091 5.07924 10.5231C5.39038 10.6371 5.73504 10.4773 5.84907 10.1662L6.99975 7.02646C7.03588 7.03324 7.07314 7.03679 7.11123 7.03679H10.9778L12.1247 10.1662C12.2387 10.4773 12.5834 10.6371 12.8945 10.5231C13.2057 10.4091 13.3654 10.0644 13.2514 9.75326L10.3014 1.70389ZM10.538 5.83679L9.17467 2.11682C9.11057 1.94192 8.8632 1.94192 8.7991 2.11682L7.43576 5.83679H10.538Z",fillRule:"evenodd",clipRule:"evenodd"}}]},s9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"font-color-double-icon",ref:t,icon:e2}))});s9.displayName="FontColorDoubleIcon";const t2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01519 4.9156C7.65059 4.9156 7.29055 4.96431 6.93757 5.05194C6.6062 5.1342 6.2709 4.93226 6.18864 4.60089C6.10638 4.26953 6.30831 3.93422 6.63968 3.85196C7.0796 3.74275 7.53991 3.6792 8.01519 3.6792C9.93752 3.6792 11.6225 4.71575 12.781 5.67605C13.3691 6.16346 13.8434 6.64946 14.171 7.01358C14.3351 7.19604 14.4633 7.34895 14.5515 7.45755C14.5956 7.51187 14.6298 7.5552 14.6535 7.58568C14.6653 7.60092 14.6745 7.61296 14.6811 7.62157L14.6889 7.63188L14.6913 7.63506L14.6921 7.63614C14.6921 7.63614 14.6927 7.63689 14.1972 8.0066C14.6927 8.37631 14.6925 8.37646 14.6925 8.37646L14.6921 8.37705L14.6913 8.37814L14.6889 8.38131L14.6811 8.39163C14.6745 8.40023 14.6653 8.41227 14.6535 8.42752C14.6298 8.458 14.5956 8.50132 14.5515 8.55565C14.4633 8.66425 14.3351 8.81715 14.171 8.99961C13.8434 9.36373 13.3691 9.84973 12.781 10.3371C12.5182 10.555 12.1284 10.5186 11.9106 10.2557C11.6927 9.99285 11.7291 9.60313 11.992 9.38524C12.5227 8.94536 12.9537 8.50406 13.2518 8.1727C13.3051 8.11347 13.354 8.05788 13.3984 8.0066C13.354 7.95531 13.3051 7.89972 13.2518 7.84049C12.9537 7.50913 12.5227 7.06783 11.992 6.62795C10.9131 5.73365 9.50709 4.9156 8.01519 4.9156ZM14.1972 8.0066L14.6925 8.37646C14.8562 8.15715 14.8563 7.8562 14.6927 7.63689L14.1972 8.0066ZM4.11981 5.75748C4.3377 6.02035 4.30123 6.41007 4.03837 6.62795C3.50769 7.06783 3.07669 7.50913 2.7786 7.84049C2.72531 7.89972 2.67639 7.95531 2.63203 8.0066C2.67639 8.05788 2.72531 8.11347 2.7786 8.17271C3.07669 8.50406 3.50769 8.94536 4.03837 9.38524C5.11729 10.2795 6.5233 11.0976 8.01519 11.0976C8.38283 11.0976 8.74582 11.0481 9.10157 10.9591C9.43279 10.8762 9.76846 11.0776 9.85131 11.4088C9.93417 11.74 9.73283 12.0757 9.40162 12.1585C8.95841 12.2694 8.49443 12.334 8.01519 12.334C6.09287 12.334 4.40788 11.2974 3.24935 10.3371C2.66132 9.84973 2.18698 9.36373 1.85941 8.99961C1.69527 8.81715 1.56704 8.66425 1.47887 8.55565C1.43476 8.50132 1.4006 8.458 1.37692 8.42752C1.36508 8.41227 1.35585 8.40023 1.3493 8.39162L1.34149 8.38131L1.3391 8.37813L1.33829 8.37705C1.33829 8.37705 1.33773 8.37631 1.8332 8.0066C1.33773 7.63689 1.33785 7.63673 1.33785 7.63673L1.3391 7.63506L1.34149 7.63188L1.3493 7.62157C1.35585 7.61296 1.36508 7.60092 1.37692 7.58568C1.4006 7.5552 1.43476 7.51187 1.47887 7.45755C1.56704 7.34895 1.69527 7.19604 1.85941 7.01358C2.18698 6.64946 2.66132 6.16346 3.24935 5.67605C3.51221 5.45816 3.90193 5.49462 4.11981 5.75748ZM1.8332 8.0066L1.33785 7.63673C1.1742 7.85604 1.17464 8.15774 1.33829 8.37705L1.8332 8.0066Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.8775 2.99454C3.63608 2.75312 3.24466 2.75312 3.00323 2.99454C2.76181 3.23596 2.76181 3.62739 3.00323 3.86881L6.11167 6.97725C5.94588 7.28339 5.85153 7.63423 5.85153 8.00647C5.85153 9.20144 6.82025 10.1702 8.01523 10.1702C8.38756 10.1702 8.73834 10.0758 9.04444 9.91001L12.1095 12.9751C12.3509 13.2165 12.7424 13.2165 12.9838 12.9751C13.2252 12.7337 13.2252 12.3422 12.9838 12.1008L3.8775 2.99454ZM8.0668 8.93237L7.08932 7.9549C7.0884 7.97197 7.08793 7.98916 7.08793 8.00647C7.08793 8.5186 7.5031 8.93377 8.01523 8.93377C8.03254 8.93377 8.04973 8.9333 8.0668 8.93237Z",fillRule:"evenodd",clipRule:"evenodd"}}]},a9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"hide-double-icon",ref:t,icon:t2}))});a9.displayName="HideDoubleIcon";const n2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 13.333V11.9997H2.66659L2.66659 13.333H3.99992V14.6663H2.66659C1.93021 14.6663 1.33325 14.0694 1.33325 13.333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66659 1.33301H3.99992V2.66634L2.66659 2.66634V3.99967H1.33325V2.66634C1.33325 1.92996 1.93021 1.33301 2.66659 1.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66659 9.33301H1.33325V6.66634H2.66659V9.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66659 2.66634V1.33301H9.33325V2.66634H8.66496V3.9855H7.33496V2.66634H6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9999 2.66634V1.33301H13.3333C14.0696 1.33301 14.6666 1.92996 14.6666 2.66634V3.99967H13.3333V2.66634H11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3333 6.66634H14.6666V9.33301H13.3333V6.66634Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3333 11.9997H14.6666V13.333C14.6666 14.0694 14.0696 14.6663 13.3333 14.6663H11.9999V13.333H13.3333V11.9997Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33325 13.333V14.6663H6.66659V13.333H7.33496V12.0138H8.66496V13.333H9.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33496 6.66159L7.33496 9.33768H8.66496V6.66159H7.33496Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66687 7.33423H7.33354L2.66687 7.33431V8.66764H7.33354L8.66687 8.66756L13.3335 8.66764V7.33431L8.66687 7.33423Z"}}]},c9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"horizontal-border-double-icon",ref:t,icon:n2}))});c9.displayName="HorizontalBorderDoubleIcon";const r2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 11.9997V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H3.99992V13.333H2.66659L2.66659 11.9997H1.33325ZM3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301ZM1.33325 9.33301H2.66659V6.66634H1.33325V9.33301ZM6.66659 1.33301V2.66634H9.33325V1.33301H6.66659ZM11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999ZM14.6666 6.66634H13.3333V9.33301H14.6666V6.66634ZM14.6666 11.9997H13.3333V13.333H11.9999V14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V11.9997ZM9.33325 14.6663V13.333H6.66659V14.6663H9.33325Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66693 7.33415V2.66748H7.3336V7.33415H2.66693V8.66748H7.3336V13.3341H8.66693V8.66748H13.3336V7.33415H8.66693Z"}}]},u9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"inner-border-double-icon",ref:t,icon:r2}))});u9.displayName="InnerBorderDoubleIcon";const o2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.66105 5.44796C7.66105 5.07977 7.36257 4.7813 6.99439 4.7813H3.22403C2.85583 4.7813 2.55736 5.07977 2.55736 5.44796V10.5516C2.55736 10.9198 2.85583 11.2183 3.22403 11.2183H6.99439C7.36257 11.2183 7.66105 10.9198 7.66105 10.5516V5.44796ZM2.55736 3.50537C1.85268 3.50537 1.28143 4.07662 1.28143 4.7813V11.2183C1.28143 11.923 1.85268 12.4942 2.55736 12.4942H7.66105C8.3657 12.4942 8.93697 11.923 8.93697 11.2183V4.7813C8.93697 4.07662 8.3657 3.50537 7.66105 3.50537H2.55736Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9225 10.465C11.9977 10.4962 12.0802 10.5134 12.1667 10.5134C12.2532 10.5134 12.3357 10.4962 12.4109 10.465C12.4862 10.4338 12.5567 10.3877 12.6178 10.3265L14.5317 8.41263C14.7808 8.16349 14.7808 7.75956 14.5317 7.51042C14.2826 7.26128 13.8786 7.26128 13.6295 7.51042L12.8047 8.33523V6.14333C12.8047 5.791 12.5191 5.50537 12.1667 5.50537C11.8144 5.50537 11.5288 5.791 11.5288 6.14333V8.33523L10.7039 7.51042C10.4548 7.26128 10.0509 7.26128 9.80172 7.51042C9.55258 7.75956 9.55258 8.16349 9.80172 8.41263L11.7153 10.3262",fillRule:"evenodd",clipRule:"evenodd"}}]},d9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-cell-down-double-icon",ref:t,icon:o2}))});d9.displayName="InsertCellDownDoubleIcon";const i2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.56614 5.44796C7.56614 5.07977 7.26766 4.7813 6.89948 4.7813H3.12912C2.76092 4.7813 2.46245 5.07977 2.46245 5.44796V10.5516C2.46245 10.9198 2.76092 11.2183 3.12912 11.2183H6.89948C7.26766 11.2183 7.56614 10.9198 7.56614 10.5516V5.44796ZM2.46245 3.50537C1.75777 3.50537 1.18652 4.07662 1.18652 4.7813V11.2183C1.18652 11.923 1.75777 12.4942 2.46245 12.4942H7.56614C8.27079 12.4942 8.84206 11.923 8.84206 11.2183V4.7813C8.84206 4.07662 8.27079 3.50537 7.56614 3.50537H2.46245Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.7651 8.2438C14.7963 8.16858 14.8135 8.0861 14.8135 7.9996C14.8135 7.9131 14.7963 7.83062 14.7651 7.7554C14.7339 7.68015 14.6878 7.60966 14.6266 7.54849L12.7127 5.63461C12.4636 5.38547 12.0597 5.38547 11.8105 5.63461C11.5614 5.88375 11.5614 6.28768 11.8105 6.53682L12.6353 7.36164H10.4434C10.0911 7.36164 9.80548 7.64727 9.80548 7.9996C9.80548 8.35194 10.0911 8.63756 10.4434 8.63756H12.6353L11.8105 9.46238C11.5614 9.71152 11.5614 10.1155 11.8105 10.3646C12.0597 10.6137 12.4636 10.6137 12.7127 10.3646L14.6263 8.45101",fillRule:"evenodd",clipRule:"evenodd"}}]},f9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-cell-shift-right-double-icon",ref:t,icon:i2}))});f9.displayName="InsertCellShiftRightDoubleIcon";const l2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.53337 14C2.35658 14 2.18704 13.9297 2.06203 13.8047C1.93703 13.6797 1.86681 13.5101 1.86681 13.3333C1.86681 13.1565 1.93703 12.987 2.06203 12.862C2.18704 12.7369 2.35658 12.6667 2.53337 12.6667L13.4667 12.6667C13.6435 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1333 13.1565 14.1333 13.3333C14.1333 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6435 14 13.4667 14L2.53337 14ZM2.53337 3.33333C2.35658 3.33331 2.18703 3.26306 2.06203 3.13804C1.93703 3.01301 1.86681 2.84346 1.86681 2.66667C1.86681 2.48987 1.93703 2.32032 2.06203 2.1953C2.18703 2.07028 2.35658 2.00003 2.53337 2L13.4667 2C13.6435 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1333 2.48987 14.1333 2.66667C14.1333 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6435 3.33331 13.4667 3.33333L2.53337 3.33333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.0573 7.33327L10.1953 6.47127C10.0703 6.34627 10.0001 6.17672 10.0001 5.99994C10.0001 5.82315 10.0703 5.65361 10.1953 5.52861C10.3203 5.4036 10.4899 5.33337 10.6667 5.33337C10.8434 5.33337 11.013 5.4036 11.138 5.52861L13.138 7.5286C13.2 7.59046 13.2491 7.66393 13.2827 7.74481C13.3162 7.82569 13.3335 7.91238 13.3335 7.99994C13.3335 8.08749 13.3162 8.17419 13.2827 8.25507C13.2491 8.33594 13.2 8.40941 13.138 8.47127L11.138 10.4713C11.0761 10.5332 11.0026 10.5823 10.9217 10.6158C10.8409 10.6493 10.7542 10.6665 10.6667 10.6665C10.5791 10.6665 10.4925 10.6493 10.4116 10.6158C10.3307 10.5823 10.2572 10.5332 10.1953 10.4713C10.1334 10.4094 10.0843 10.3359 10.0508 10.255C10.0173 10.1742 10.0001 10.0875 10.0001 9.99994C10.0001 9.9124 10.0173 9.82573 10.0508 9.74486C10.0843 9.66398 10.1334 9.5905 10.1953 9.52861L11.0573 8.6666L3.33333 8.66661C3.15652 8.66661 2.98695 8.59637 2.86193 8.47134C2.7369 8.34632 2.66666 8.17675 2.66666 7.99994C2.66666 7.82313 2.7369 7.65356 2.86193 7.52853C2.98695 7.40351 3.15652 7.33327 3.33333 7.33327L11.0573 7.33327Z"}}]},h9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-double-icon",ref:t,icon:l2}))});h9.displayName="InsertDoubleIcon";const s2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 13.4087C14.0697 13.4087 14.6666 12.8117 14.6666 12.0754L14.6666 9.40869C14.6666 8.67231 14.0697 8.07536 13.3333 8.07536L2.66663 8.07536C1.93023 8.07536 1.33329 8.67231 1.33329 9.40869L1.33329 12.0754C1.33329 12.8117 1.93023 13.4087 2.66663 13.4087L13.3333 13.4087ZM2.66663 12.0754L13.3333 12.0754L13.3333 9.40869L2.66663 9.40869L2.66663 12.0754Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74168 2.59137C8.10987 2.59137 8.40835 2.88984 8.40835 3.25804L8.40835 4.33309L9.48348 4.33309C9.85167 4.33309 10.1501 4.63156 10.1501 4.99976C10.1501 5.36794 9.85167 5.66642 9.48348 5.66642L8.40835 5.66642L8.40835 6.74154C8.40835 7.10973 8.10987 7.4082 7.74168 7.4082C7.37349 7.4082 7.07501 7.10973 7.07501 6.74154L7.07501 5.66642L5.99998 5.66642C5.63179 5.66642 5.33331 5.36794 5.33331 4.99976C5.33331 4.63156 5.63179 4.33309 5.99998 4.33309L7.07501 4.33309L7.07501 3.25804C7.07501 2.88984 7.37349 2.59137 7.74168 2.59137Z",fillRule:"evenodd",clipRule:"evenodd"}}]},C9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-row-above-double-icon",ref:t,icon:s2}))});C9.displayName="InsertRowAboveDoubleIcon";const a2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.66671 2.59131C1.93033 2.59131 1.33337 3.18826 1.33337 3.92464L1.33337 6.59131C1.33337 7.32769 1.93033 7.92464 2.66671 7.92464L13.3334 7.92464C14.0698 7.92464 14.6667 7.32769 14.6667 6.59131L14.6667 3.92464C14.6667 3.18826 14.0698 2.59131 13.3334 2.59131L2.66671 2.59131ZM13.3334 3.92464L2.66671 3.92464L2.66671 6.59131L13.3334 6.59131L13.3334 3.92464Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.25838 13.4086C7.8902 13.4086 7.59172 13.1102 7.59172 12.742L7.59172 11.6669L6.51658 11.6669C6.14839 11.6669 5.84992 11.3684 5.84991 11.0002C5.84991 10.6321 6.14839 10.3336 6.51658 10.3336L7.59172 10.3336L7.59171 9.25846C7.59171 8.89027 7.89019 8.5918 8.25838 8.5918C8.62657 8.5918 8.92505 8.89027 8.92505 9.25846L8.92505 10.3336L10.0001 10.3336C10.3683 10.3336 10.6667 10.6321 10.6667 11.0002C10.6667 11.3684 10.3683 11.6669 10.0001 11.6669L8.92505 11.6669L8.92505 12.742C8.92505 13.1102 8.62658 13.4086 8.25838 13.4086Z",fillRule:"evenodd",clipRule:"evenodd"}}]},v9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"insert-row-below-double-icon",ref:t,icon:a2}))});v9.displayName="InsertRowBelowDoubleIcon";const c2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 3.99967L14.6664 2.66634C14.6664 1.92996 14.0694 1.33301 13.333 1.33301L11.9997 1.33301L11.9997 2.66634L13.333 2.66634L13.333 3.99967L14.6664 3.99967Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66638 1.33301L6.66638 2.66634L9.33305 2.66634L9.33305 1.33301L6.66638 1.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 6.66634L13.333 6.66634L13.333 7.33301L10.6664 7.33301L10.6664 8.66634L13.333 8.66634L13.333 9.33301L14.6664 9.33301L14.6664 6.66634Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 11.9997L13.333 11.9997L13.333 13.333L11.9997 13.333L11.9997 14.6663L13.333 14.6663C14.0694 14.6663 14.6664 14.0694 14.6664 13.333L14.6664 11.9997Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33305 14.6663L9.33305 13.333L8.66638 13.333L8.66638 10.6663L7.33305 10.6663L7.33305 13.333L6.66638 13.333L6.66638 14.6663L9.33305 14.6663Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66638 7.33301L5.33305 7.33301L5.33305 8.66634L2.66638 8.66634L2.66638 7.33301Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.66638 5.33301L8.66638 2.66634L7.33305 2.66634L7.33305 5.33301L8.66638 5.33301Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.66667 1.33301L4 1.33301L4 2.66634L2.66667 2.66634L2.66667 13.333L4 13.333L4 14.6663L2.66667 14.6663C1.93029 14.6663 1.33333 14.0694 1.33333 13.333L1.33333 2.66634C1.33333 1.92996 1.93029 1.33301 2.66667 1.33301Z"}}]},g9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-border-double-icon",ref:t,icon:c2}))});g9.displayName="LeftBorderDoubleIcon";const u2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.2987 2.39556L14.424 7.49259L13.9241 8.58354L4.06409 4.06617L8.58147 13.9262L7.49051 14.426L2.39348 3.30078L2.08524 3.15956L2.20701 2.89377L2.06653 2.58713L2.42214 2.42421L2.58506 2.0686L2.89169 2.20909L3.15748 2.08732L3.2987 2.39556Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.34351 12.0924L1.34351 13.4565C1.34351 14.1193 1.88077 14.6565 2.54351 14.6565L3.90764 14.6565L3.90764 13.3265L2.67351 13.3265L2.67351 12.0924L1.34351 12.0924ZM3.90763 1.34351L2.54351 1.34351C1.88076 1.34351 1.34351 1.88076 1.34351 2.54351L1.34351 3.90764L2.67351 3.90764L2.67351 2.67351L3.90763 2.67351L3.90763 1.34351ZM1.34351 9.36415L2.67351 9.36415L2.67351 6.63589L1.34351 6.63589L1.34351 9.36415ZM6.63589 1.34351L6.63589 2.67351L9.36415 2.67351L9.36415 1.34351L6.63589 1.34351ZM12.0924 1.34351L12.0924 2.67351L13.3265 2.67351L13.3265 3.90763L14.6565 3.90763L14.6565 2.54351C14.6565 1.88076 14.1193 1.34351 13.4565 1.34351L12.0924 1.34351ZM14.6565 6.63589L13.3265 6.63589L13.3265 9.36415L14.6565 9.36415L14.6565 6.63589ZM14.6565 12.0924L13.3265 12.0924L13.3265 13.3265L12.0924 13.3265L12.0924 14.6565L13.4565 14.6565C14.1193 14.6565 14.6565 14.1193 14.6565 13.4565L14.6565 12.0924ZM9.36415 14.6565L9.36415 13.3265L6.63589 13.3265L6.63589 14.6565L9.36415 14.6565Z",fillRule:"evenodd",clipRule:"evenodd"}}]},p9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-double-diagonal-double-icon",ref:t,icon:u2}))});p9.displayName="LeftDoubleDiagonalDoubleIcon";const d2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.4322 2.66683C13.4322 1.93045 12.8352 1.3335 12.0989 1.3335H9.43219C8.69581 1.3335 8.09886 1.93045 8.09886 2.66683V13.3335C8.09886 14.0699 8.69581 14.6668 9.43219 14.6668H12.0989C12.8352 14.6668 13.4322 14.0699 13.4322 13.3335V2.66683ZM12.0989 13.3335V2.66683H9.43219V13.3335H12.0989Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.56769 7.99978C2.56769 7.63159 2.86616 7.33311 3.23435 7.33311H4.30941V6.25798C4.30941 5.88979 4.60788 5.59131 4.97607 5.59131C5.34426 5.59131 5.64274 5.88979 5.64274 6.25798V7.33311H6.71785C7.08604 7.33311 7.38452 7.63159 7.38452 7.99978C7.38452 8.36797 7.08604 8.66644 6.71785 8.66644H5.64274V9.74148C5.64274 10.1097 5.34426 10.4081 4.97607 10.4081C4.60788 10.4081 4.30941 10.1097 4.30941 9.74148V8.66644H3.23435C2.86616 8.66644 2.56769 8.36797 2.56769 7.99978Z",fillRule:"evenodd",clipRule:"evenodd"}}]},m9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-insert-column-double-icon",ref:t,icon:d2}))});m9.displayName="LeftInsertColumnDoubleIcon";const f2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.33875 3.57255L2.23657 3.79614L2.72883 4.0211L7.58275 14.6428L8.67419 14.144L5.10931 6.34311L13.5649 14.7987L14.4134 13.9502L5.96172 5.49847L13.7573 9.0609L14.2561 7.96947L3.63438 3.11555L3.40942 2.62329L3.18782 2.72456L3.09973 2.63647L2.93861 2.7976L2.73534 2.70471L2.60444 2.99116L2.31799 3.12206L2.41088 3.32533L2.2512 3.485L2.33875 3.57255Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.6759 12.8102L1.6759 14.1743C1.6759 14.8371 2.21316 15.3743 2.8759 15.3743L4.24003 15.3743L4.24003 14.0443L3.0059 14.0443L3.0059 12.8102L1.6759 12.8102ZM4.24003 2.06128L2.8759 2.06128C2.21316 2.06128 1.6759 2.59854 1.6759 3.26128L1.6759 4.62541L3.0059 4.62541L3.0059 3.39128L4.24003 3.39128L4.24003 2.06128ZM1.6759 10.0819L3.0059 10.0819L3.0059 7.35367L1.6759 7.35367L1.6759 10.0819ZM6.96829 2.06128L6.96829 3.39128L9.69655 3.39128L9.69655 2.06128L6.96829 2.06128ZM12.4248 2.06128L12.4248 3.39128L13.6589 3.39128L13.6589 4.62541L14.9889 4.62541L14.9889 3.26128C14.9889 2.59854 14.4517 2.06128 13.7889 2.06128L12.4248 2.06128ZM14.9889 7.35367L13.6589 7.35367L13.6589 10.0819L14.9889 10.0819L14.9889 7.35367ZM14.9889 12.8102L13.6589 12.8102L13.6589 14.0443L12.4248 14.0443L12.4248 15.3743L13.7889 15.3743C14.4517 15.3743 14.9889 14.8371 14.9889 14.1743L14.9889 12.8102ZM9.69655 15.3743L9.69655 14.0443L6.96829 14.0443L6.96829 15.3743L9.69655 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]},b9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"left-tridiagonal-double-icon",ref:t,icon:f2}))});b9.displayName="LeftTridiagonalDoubleIcon";const h2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.665 2.66496H3.33496C2.96493 2.66496 2.66496 2.96493 2.66496 3.33496V12.665C2.66496 13.035 2.96493 13.335 3.33496 13.335H12.665C13.035 13.335 13.335 13.035 13.335 12.665V3.33496C13.335 2.96493 13.035 2.66496 12.665 2.66496ZM3.33496 1.33496C2.23039 1.33496 1.33496 2.23039 1.33496 3.33496V12.665C1.33496 13.7695 2.23039 14.665 3.33496 14.665H12.665C13.7695 14.665 14.665 13.7695 14.665 12.665V3.33496C14.665 2.23039 13.7695 1.33496 12.665 1.33496H3.33496Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.2559 14.1963L1.64941 2.58984L2.58987 1.64939L14.1963 13.2558L13.2559 14.1963Z",fillRule:"evenodd",clipRule:"evenodd"}}]},L9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"no-color-double-icon",ref:t,icon:h2}))});L9.displayName="NoColorDoubleIcon";const C2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 2.66634H2.66659V13.333H13.3333V2.66634ZM2.66659 1.33301C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H2.66659Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33311 2.66748V5.33415H8.66644V2.66748H7.33311Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33311 10.6675V13.3341H8.66644V10.6675H7.33311Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3331 7.33415H10.6664V8.66748H13.3331V7.33415Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M5.33311 7.33415H2.66644V8.66748H5.33311V7.33415Z"}}]},w9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"outer-border-double-icon",ref:t,icon:C2}))});w9.displayName="OuterBorderDoubleIcon";const v2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01281 1.36643C8.79386 0.585377 10.0602 0.585378 10.8412 1.36643L12.9223 3.44752C13.7034 4.22857 13.7034 5.4949 12.9223 6.27595L9.36445 9.83383C8.5834 10.6149 7.31707 10.6149 6.53602 9.83383L4.45493 7.75273C3.67388 6.97168 3.67388 5.70535 4.45493 4.9243L8.01281 1.36643ZM9.9927 2.21495C9.68028 1.90253 9.17375 1.90253 8.86133 2.21495L5.30346 5.77283L5.29671 5.77966L10.839 6.66224L12.0738 5.42742C12.3862 5.115 12.3862 4.60847 12.0738 4.29605L9.9927 2.21495Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.5179 9.48875C14.5179 9.99175 14.1101 10.3995 13.607 10.3995C13.1041 10.3995 12.6963 9.99175 12.6963 9.48875C12.6963 9.1773 13.0455 8.59966 13.3114 8.20487C13.4549 7.99177 13.7591 7.99177 13.9027 8.20486C14.1687 8.59965 14.5179 9.1773 14.5179 9.48875Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}}]},y9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"paint-bucket-double-icon",ref:t,icon:v2}))});y9.displayName="PaintBucketDoubleIcon";const g2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74692 9.12463C7.74692 9.46018 8.01893 9.73219 8.35448 9.73219H11.4933C11.8288 9.73219 12.1009 9.46018 12.1009 9.12463C12.1009 8.78909 11.8288 8.51707 11.4933 8.51707H8.35448C8.01893 8.51707 7.74692 8.78909 7.74692 9.12463Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.8636 10.8523C10.8636 11.1879 10.5915 11.4599 10.256 11.4599H8.35448C8.01893 11.4599 7.74692 11.1879 7.74692 10.8523C7.74692 10.5168 8.01893 10.2447 8.35448 10.2447H10.256C10.5915 10.2447 10.8636 10.5168 10.8636 10.8523Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.4791 1.98268C5.47913 1.71529 5.87912 1.49854 6.37252 1.49854C6.86593 1.49854 7.26592 1.71529 7.26595 1.98268H7.62187C8.22277 1.98268 8.72459 2.39534 8.84412 2.9452H9.39563C10.0856 2.9452 10.6449 3.48923 10.6449 4.16032V6.00569H12.1261C13.161 6.00569 14 6.82174 14 7.82838V11.334C14 11.8174 13.8025 12.281 13.4511 12.6228L12.0693 13.9647C11.7179 14.3065 11.2412 14.4985 10.7442 14.4985H7.91116C7.05024 14.4985 6.32492 14.0431 6.10535 13.2737H3.34925C2.6593 13.2737 2.09998 12.7297 2.09998 12.0586V4.16032C2.09998 3.48923 2.6593 2.9452 3.34925 2.9452H3.90107C4.0206 2.39534 4.52241 1.98268 5.12332 1.98268H5.4791ZM3.97249 4.16032H3.24925L3.24925 12.0586H6.03725V7.82838C6.03725 6.82174 6.87623 6.00569 7.91116 6.00569H9.49563V4.16032H8.7727C8.58289 4.59611 8.13909 4.90183 7.62187 4.90183H5.12332C4.6061 4.90183 4.1623 4.59611 3.97249 4.16032ZM5.12332 2.89403H7.62187C7.79436 2.89403 7.93419 3.03003 7.93419 3.19781V3.68671C7.93419 3.85448 7.79436 3.99049 7.62187 3.99049H5.12332C4.95083 3.99049 4.811 3.85448 4.811 3.68671V3.19781C4.811 3.03003 4.95083 2.89403 5.12332 2.89403ZM7.91116 7.11157C7.56618 7.11157 7.28652 7.38359 7.28652 7.71913V12.7851C7.28652 13.1206 7.56618 13.3927 7.91116 13.3927H10.7442C10.8401 13.3927 10.9337 13.3712 11.0182 13.3311C11.1373 13.2746 11.1859 13.1423 11.1859 13.0134V12.0066C11.1859 11.8724 11.2978 11.7636 11.4358 11.7636H12.4709C12.6034 11.7636 12.7394 11.7163 12.7975 11.6004C12.8388 11.5182 12.8608 11.4272 12.8608 11.334V7.71913C12.8608 7.38359 12.5811 7.11157 12.2362 7.11157H7.91116Z",fillRule:"evenodd",clipRule:"evenodd"}}]},I9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"paste-special-double-icon",ref:t,icon:g2}))});I9.displayName="PasteSpecialDoubleIcon";const p2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.53331 14C2.35652 14 2.18697 13.9297 2.06197 13.8047C1.93697 13.6797 1.86675 13.5101 1.86675 13.3333C1.86675 13.1565 1.93697 12.987 2.06197 12.862C2.18697 12.7369 2.35652 12.6667 2.53331 12.6667L13.4666 12.6667C13.6434 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1332 13.1565 14.1332 13.3333C14.1332 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6434 14 13.4666 14L2.53331 14ZM2.53331 3.33333C2.35652 3.33331 2.18697 3.26306 2.06197 3.13804C1.93697 3.01301 1.86675 2.84346 1.86675 2.66667C1.86675 2.48987 1.93697 2.32032 2.06197 2.1953C2.18697 2.07028 2.35652 2.00003 2.53331 2L13.4666 2C13.6434 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1332 2.48987 14.1332 2.66667C14.1332 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6434 3.33331 13.4666 3.33333L2.53331 3.33333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.8142 10.8141C10.5588 11.0695 10.1447 11.0695 9.88929 10.8141L7.97868 8.90354L6.14021 10.742C5.89652 10.9857 5.50142 10.9857 5.25774 10.742C5.01405 10.4983 5.01405 10.1032 5.25774 9.85955L7.09621 8.02107L5.18561 6.11047C4.93021 5.85507 4.93021 5.44098 5.18561 5.18557C5.44101 4.93017 5.8551 4.93017 6.11051 5.18557L8.02111 7.09618L9.85959 5.2577C10.1033 5.01401 10.4984 5.01401 10.7421 5.2577C10.9857 5.50139 10.9857 5.89648 10.7421 6.14017L8.90358 7.97865L10.8142 9.88925C11.0696 10.1447 11.0696 10.5587 10.8142 10.8141Z"}}]},M9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"reduce-double-icon",ref:t,icon:p2}))});M9.displayName="ReduceDoubleIcon";const m2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 3.99992L1.33325 2.66659C1.33325 1.93021 1.93021 1.33325 2.66659 1.33325L3.99992 1.33325L3.99992 2.66659L2.66659 2.66659L2.66659 3.99992L1.33325 3.99992Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33325 1.33325L9.33325 2.66658L6.66659 2.66659L6.66659 1.33325L9.33325 1.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 6.66659L2.66659 6.66659L2.66659 7.33325L5.33325 7.33325L5.33325 8.66659L2.66659 8.66659L2.66659 9.33325L1.33325 9.33325L1.33325 6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 11.9999L2.66659 11.9999L2.66659 13.3333L3.99992 13.3333L3.99992 14.6666L2.66659 14.6666C1.93021 14.6666 1.33325 14.0696 1.33325 13.3333L1.33325 11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66659 14.6666L6.66659 13.3333L7.33325 13.3333L7.33325 10.6666L8.66659 10.6666L8.66659 13.3333L9.33325 13.3333L9.33325 14.6666L6.66659 14.6666Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3333 7.33325L10.6666 7.33325L10.6666 8.66659L13.3333 8.66658L13.3333 7.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33325 5.33325L7.33325 2.66659L8.66659 2.66659L8.66659 5.33325L7.33325 5.33325Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 1.33325L12 1.33325L12 2.66659L13.3333 2.66659L13.3333 13.3333L12 13.3333L12 14.6666L13.3333 14.6666C14.0697 14.6666 14.6667 14.0696 14.6667 13.3333L14.6667 2.66659C14.6667 1.93021 14.0697 1.33325 13.3333 1.33325Z"}}]},_9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-border-double-icon",ref:t,icon:m2}))});_9.displayName="RightBorderDoubleIcon";const b2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.2368 2.87507L2.11162 7.97208L2.61144 9.06304L12.4714 4.54568L7.95409 14.4057L9.04505 14.9055L14.1421 3.78029L14.4503 3.63905L14.3286 3.37322L14.469 3.0666L14.1134 2.90369L13.9505 2.5481L13.6439 2.68857L13.3781 2.56678L13.2368 2.87507Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.44524 1.82495L3.08111 1.82495C2.41837 1.82495 1.88111 2.36221 1.88111 3.02495L1.88111 4.38908L3.21111 4.38908L3.21111 3.15495L4.44524 3.15495L4.44524 1.82495ZM15.1941 4.38908L15.1941 3.02495C15.1941 2.36221 14.6569 1.82495 13.9941 1.82495L12.63 1.82495L12.63 3.15495L13.8641 3.15495L13.8641 4.38908L15.1941 4.38908ZM7.17349 1.82495L7.17349 3.15495L9.90175 3.15495L9.90175 1.82495L7.17349 1.82495ZM15.1941 7.11734L13.8641 7.11734L13.8641 9.84559L15.1941 9.84559L15.1941 7.11734ZM15.1941 12.5739L13.8641 12.5739L13.8641 13.808L12.63 13.808L12.63 15.138L13.9941 15.138C14.6569 15.138 15.1941 14.6007 15.1941 13.938L15.1941 12.5739ZM9.90175 15.138L9.90175 13.808L7.17349 13.808L7.17349 15.138L9.90175 15.138ZM4.44524 15.138L4.44524 13.808L3.21111 13.808L3.21111 12.5739L1.88111 12.5739L1.88111 13.938C1.88111 14.6007 2.41837 15.138 3.08111 15.138L4.44524 15.138ZM1.88111 9.8456L3.21111 9.8456L3.21111 7.11734L1.88111 7.11734L1.88111 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]},S9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-double-diagonal-double-icon",ref:t,icon:b2}))});S9.displayName="RightDoubleDiagonalDoubleIcon";const L2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.56781 13.3332C2.56781 14.0695 3.16476 14.6665 3.90114 14.6665L6.56781 14.6665C7.30419 14.6665 7.90114 14.0695 7.90114 13.3332L7.90114 2.6665C7.90114 1.9301 7.30419 1.33317 6.56781 1.33317L3.90114 1.33317C3.16476 1.33317 2.56781 1.9301 2.56781 2.6665L2.56781 13.3332ZM3.90114 2.6665L3.90114 13.3332L6.56781 13.3332L6.56781 2.6665L3.90114 2.6665Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.4323 8.00022C13.4323 8.36841 13.1338 8.66689 12.7656 8.66689L11.6906 8.66689L11.6906 9.74202C11.6906 10.1102 11.3921 10.4087 11.0239 10.4087C10.6557 10.4087 10.3573 10.1102 10.3573 9.74202L10.3573 8.66689L9.28215 8.66689C8.91396 8.66689 8.61548 8.36841 8.61548 8.00022C8.61548 7.63203 8.91396 7.33356 9.28214 7.33356L10.3573 7.33356L10.3573 6.25852C10.3573 5.89033 10.6557 5.59186 11.0239 5.59186C11.3921 5.59186 11.6906 5.89033 11.6906 6.25852L11.6906 7.33356L12.7656 7.33356C13.1338 7.33356 13.4323 7.63203 13.4323 8.00022Z",fillRule:"evenodd",clipRule:"evenodd"}}]},H9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"right-insert-column-double-icon",ref:t,icon:L2}))});H9.displayName="RightInsertColumnDoubleIcon";const w2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.27177 13.714L13.5855 2.40025L14.434 3.24878L3.1203 14.5625L2.27177 13.714Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.2603 1.82495L2.89617 1.82495C2.23343 1.82495 1.69617 2.36221 1.69617 3.02495L1.69617 4.38908L3.02617 4.38908L3.02617 3.15495L4.2603 3.15495L4.2603 1.82495ZM15.0092 4.38908L15.0092 3.02495C15.0092 2.36221 14.4719 1.82495 13.8092 1.82495L12.4451 1.82495L12.4451 3.15495L13.6792 3.15495L13.6792 4.38908L15.0092 4.38908ZM6.98856 1.82495L6.98856 3.15495L9.71681 3.15495L9.71681 1.82495L6.98856 1.82495ZM15.0092 7.11734L13.6792 7.11734L13.6792 9.84559L15.0092 9.84559L15.0092 7.11734ZM15.0092 12.5739L13.6792 12.5739L13.6792 13.808L12.4451 13.808L12.4451 15.138L13.8092 15.138C14.4719 15.138 15.0092 14.6007 15.0092 13.938L15.0092 12.5739ZM9.71681 15.138L9.71681 13.808L6.98856 13.808L6.98856 15.138L9.71681 15.138ZM4.2603 15.138L4.2603 13.808L3.02617 13.808L3.02617 12.5739L1.69617 12.5739L1.69617 13.938C1.69617 14.6007 2.23343 15.138 2.89617 15.138L4.2603 15.138ZM1.69617 9.8456L3.02617 9.8456L3.02617 7.11734L1.69617 7.11734L1.69617 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]},E9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"slash-double-icon",ref:t,icon:w2}))});E9.displayName="SlashDoubleIcon";const y2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M4.0001 14.667H2.66677C1.93039 14.667 1.33344 14.07 1.33344 13.3337V12.0003H2.66677V13.3337L4.0001 13.3337V14.667Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33344 6.66699H2.66677V9.33366H1.33344V6.66699Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66677 14.667V13.3337H7.33344V10.667H8.66677V13.3337H9.33344V14.667H6.66677Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M12.0001 14.667V13.3337H13.3334V12.0003H14.6668V13.3337C14.6668 14.07 14.0698 14.667 13.3334 14.667H12.0001Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6668 9.33366H13.3334V8.66699H10.6668V7.33366H13.3334V6.66699H14.6668V9.33366Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33344 2.66699V5.33366H8.66677V2.66699H7.33344Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M5.33344 8.66699H2.66677V7.33366H5.33344V8.66699Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33344 2.66789V4.00122H2.66677L2.66677 2.66789H13.3334V4.00122H14.6668V2.66789C14.6668 1.93151 14.0698 1.33455 13.3334 1.33455H2.66677C1.93039 1.33455 1.33344 1.93151 1.33344 2.66789Z"}}]},D9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"up-border-double-icon",ref:t,icon:y2}))});D9.displayName="UpBorderDoubleIcon";const I2={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66699 1.33325L4.00033 1.33325L4.00033 2.66658L2.66699 2.66659L2.66699 3.99992L1.33366 3.99992L1.33366 2.66659C1.33366 1.93021 1.93061 1.33325 2.66699 1.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.667 2.66659L14.667 3.99992L13.3337 3.99992L13.3337 2.66659L12.0003 2.66659L12.0003 1.33325L13.3337 1.33325C14.07 1.33325 14.667 1.93021 14.667 2.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M6.66699 2.66658L6.66699 1.33325L9.33366 1.33325L9.33366 2.66659L6.66699 2.66658Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3337 6.66659L14.667 6.66659L14.667 9.33325L13.3337 9.33325L13.3337 8.66496L12.0145 8.66496L12.0145 7.33496L13.3337 7.33496L13.3337 6.66659Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.3337 11.9999L14.667 11.9999L14.667 13.3333C14.667 14.0696 14.07 14.6666 13.3337 14.6666L12.0003 14.6666L12.0003 13.3333L13.3337 13.3333L13.3337 11.9999Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33366 13.3333L9.33366 14.6666L6.66699 14.6666L6.66699 13.3333L9.33366 13.3333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.00032 13.3333L4.00032 14.6666L2.66699 14.6666C1.93061 14.6666 1.33366 14.0696 1.33366 13.3333L1.33366 11.9999L2.66699 11.9999L2.66699 13.3333L4.00032 13.3333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.66699 9.33325L1.33366 9.33325L1.33366 6.66658L2.66699 6.66658L2.66699 7.33496L3.98624 7.33496L3.98624 8.66496L2.66699 8.66496L2.66699 9.33325Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.33841 7.33496L6.66232 7.33496L6.66232 8.66496L9.33841 8.66496L9.33841 7.33496Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66577 8.66675L8.66577 7.33342L8.66569 2.66675L7.33236 2.66675L7.33236 7.33341L7.33244 8.66675L7.33236 13.3334L8.66569 13.3334L8.66577 8.66675Z"}}]},O9=s.forwardRef(function(n,t){return s.createElement(H,Object.assign({},n,{id:"vertical-border-double-icon",ref:t,icon:I2}))});O9.displayName="VerticalBorderDoubleIcon";const le={AddDigitsIcon:D3,AddImageIcon:O3,AdditionAndSubtractionIcon:R3,AdjustHeightDoubleIcon:Wt,AdjustWidthDoubleIcon:Gt,AlignBottomIcon:V3,AlignTextBothIcon:N3,AlignTopIcon:T3,AllBorderIcon:x3,AmplifyIcon:$3,AutoHeightDoubleIcon:Yt,AutoWidthDoubleIcon:Xt,AutowrapIcon:Z3,AvgIcon:A3,BackSlashDoubleIcon:qt,BoldIcon:P3,BrushIcon:F3,CancelFreezeIcon:k3,CancelMergeIcon:B3,ClearFormatDoubleIcon:Jt,CntIcon:U3,CodeIcon:j3,ConditionsDoubleIcon:Qt,CopyDoubleIcon:Kt,DeleteCellMoveDownDoubleIcon:e9,DeleteCellShiftLeftDoubleIcon:t9,DeleteCellShiftRightDoubleIcon:n9,DeleteCellShiftUpDoubleIcon:r9,DeleteColumnDoubleIcon:o9,DeleteRowDoubleIcon:i9,DirectExportIcon:W3,DollarIcon:G3,DownBorderDoubleIcon:l9,EuroIcon:Y3,ExportIcon:X3,EyeOutlineIcon:J3,FolderIcon:Q3,FontColorDoubleIcon:s9,FontSizeIncreaseIcon:K3,FontSizeReduceIcon:et,FreezeColumnIcon:tt,FreezeRowIcon:nt,FreezeToSelectedIcon:rt,FunctionIcon:Re,GridIcon:ot,HeaderFooterIcon:it,HideDoubleIcon:a9,HorizontalBorderDoubleIcon:c9,HorizontallyIcon:at,HorizontalMergeIcon:st,InnerBorderDoubleIcon:u9,InsertCellDownDoubleIcon:d9,InsertCellShiftRightDoubleIcon:f9,InsertDoubleIcon:h9,InsertRowAboveDoubleIcon:C9,InsertRowBelowDoubleIcon:v9,ItalicIcon:ft,KeyboardIcon:ht,LeftBorderDoubleIcon:g9,LeftDoubleDiagonalDoubleIcon:p9,LeftInsertColumnDoubleIcon:m9,LeftJustifyingIcon:Ct,LeftRotationFortyFiveDegreesIcon:vt,LeftRotationNinetyDegreesIcon:gt,LeftTridiagonalDoubleIcon:b9,MaxIcon:pt,MenuIcon:mt,MergeAllIcon:bt,MinIcon:Lt,MoreDownIcon:z1,NoBorderIcon:wt,NoColorDoubleIcon:L9,NoRotationIcon:yt,OrderIcon:It,OuterBorderDoubleIcon:w9,OverflowIcon:Mt,PaintBucketDoubleIcon:y9,PasteSpecialDoubleIcon:I9,PercentIcon:_t,PipingIcon:St,RedoIcon:Ht,ReduceDigitsIcon:Et,ReduceDoubleIcon:M9,ReduceIcon:Te,RightBorderDoubleIcon:_9,RightDoubleDiagonalDoubleIcon:S9,RightInsertColumnDoubleIcon:H9,RightJustifyingIcon:Dt,RightRotationFortyFiveDegreesIcon:Ot,RightRotationNinetyDegreesIcon:Rt,RmbIcon:Vt,RoubleIcon:Nt,ShortcutIcon:Tt,SlashDoubleIcon:E9,StrikethroughIcon:xt,SubscriptIcon:$t,SumIcon:Zt,SuperscriptIcon:At,TruncationIcon:Pt,UnderlineIcon:Ft,UndoIcon:kt,UnorderIcon:Bt,UpBorderDoubleIcon:D9,VerticalBorderDoubleIcon:O9,VerticalCenterIcon:Ut,VerticalIntegrationIcon:jt,VerticalTextIcon:zt};class v1 extends f.Disposable{constructor(){super();j(this,"_components",new Map);j(this,"_componentsReverse",new Map);j(this,"reactUtils",{createElement:s.createElement,useEffect:s.useEffect,useRef:s.useRef});j(this,"_handler",{react:t=>t});for(const t in le)this.register(t,le[t]);this.disposeWithMe(f.toDisposable(()=>{for(const t in le)this._components.delete(t),this._componentsReverse.delete(le[t])}))}register(t,r,o){const{framework:i="react"}=o||{};if(i==="vue3"&&!this._handler.vue3)throw new Error("[ComponentManager] Vue3 support is no longer built-in since v0.9.0, please install @univerjs/ui-adapter-vue3 plugin.");return this._components.has(t)&&console.warn(`Component ${t} already exists.`),this._components.set(t,{framework:i,component:r}),this._componentsReverse.set(r,t),f.toDisposable(()=>{this._components.delete(t),this._componentsReverse.delete(r)})}getKey(t){return this._componentsReverse.get(t)}setHandler(t,r){this._handler[t]=r}get(t){if(!t)return;const r=this._components.get(t);if(!r)return;const o=this._handler[r.framework];if(!o)throw new Error(`[ComponentManager] No handler found for framework: ${r.framework}`);return o(r.component,t)}delete(t){this._components.delete(t)}}class W1{constructor(){j(this,"_list",new Map)}setIndex(n,t){this._list.set(n,t)}getIndex(n){return this._list.get(n)}removeIndex(n){this._list.delete(n)}getMaxIndex(){let n=-9999999;return this._list.forEach(t=>{+t>n&&(n=+t)}),n}}h3=new WeakMap,C3=new WeakMap,M3(W1,h3,2147483647),M3(W1,C3,-2147483647);function M2(e,n,t,r){const o=e.get(f.IUniverInstanceService);return new B.Observable(i=>{const l=o.focused$.subscribe(p=>{if(p==null||t&&t!==p||r&&(Array.isArray(r)?r.includes(p):r===p))return i.next(!0);const b=o.getUnitType(p);i.next(b!==n)}),c=o.getFocusedUnit();if(c==null)return i.next(!0);const C=o.getUnitType(c.getUnitId());return i.next(C!==n),()=>l.unsubscribe()})}function _2(e){const n=e.get(f.IUniverInstanceService);return new B.Observable(t=>{const r=n.focused$.subscribe(l=>{if(l==null)return t.next(!0);const c=n.getUniverDocInstance(l),C=c==null?void 0:c.getSnapshot().documentStyle.documentFlavor;t.next(C!==f.DocumentFlavor.TRADITIONAL)}),o=n.getCurrentUniverDocInstance();if(o==null)return t.next(!0);const i=o==null?void 0:o.getSnapshot().documentStyle.documentFlavor;return t.next(i!==f.DocumentFlavor.TRADITIONAL),()=>r.unsubscribe()})}function R9(e,n){return!n||!e||(["type","icon","title","tooltip"].forEach(o=>{n[o]!==void 0&&(e[o]=n[o])}),["hidden","disabled","activated"].forEach(o=>{S2(e,`${o}$`,n[o])})),e}function S2(e,n,t){if(t!==void 0)if(e[n]){const r=e[n].pipe(B.switchMap(()=>new B.BehaviorSubject(t)));e[n]=r}else e[n]=new B.Observable(r=>{r.next(t)})}function H2(e){return typeof e=="function"?e():e}function V9(e,n){const t=s.useRef(n);return s.useEffect(()=>{if(e){const r=H2(e).subscribe(o=>{t.current=o});return()=>r.unsubscribe()}},[e]),t}const N9=e=>{const{value:n,selections:t}=e,r=V.useDependency(f.LocaleService),o=s.useMemo(()=>{var i,l;return n==null?"":r.t((l=(i=t.find(c=>c.value===n))==null?void 0:i.label)!=null?l:"")},[n,t]);return v.jsx("div",{className:"univer-truncate univer-text-sm",children:o})},T9="UI_PLUGIN_COMMON_LABEL_COMPONENT";function f1(e){const{className:n,title:t,icon:r,label:o,value:i,value$:l}=e,c=V.useDependency(f.LocaleService),C=V.useDependency(v1),[p,b]=s.useState(i),[d,w]=s.useState(""),I=[];let _=0;s.useEffect(()=>{if(l){const S=l.subscribe(A=>{b(A)});return()=>{S.unsubscribe()}}},[l]);const T=s.useMemo(()=>i!=null?i:p,[p,i]);s.useEffect(()=>{let S=null;return B.isObservable(r)?S=r.subscribe(A=>{w(A)}):w(r!=null?r:""),()=>{S==null||S.unsubscribe()}},[r]);const O=s.useMemo(()=>T&&typeof T=="string"?new f.ColorKit(T).isValid:!1,[T]);if(r){const S=C.get(d!=null?d:"");S&&I.push(v.jsx(S,{className:"univer-text-base",extend:{colorChannel1:O?T:"var(--univer-primary-600)"}},_++))}if(o){const S=typeof o=="string",A=S?{...e}:{...o==null?void 0:o.props,...e},R=S?o:o==null?void 0:o.name,k=C.get(R);k?I.push(v.jsx(k,{...A,className:n,value:T},_++)):I.push(v.jsx("span",{className:n,children:c.t(R)},_++))}return t&&I.push(v.jsx("span",{className:n,children:typeof t=="string"?c.t(t):t},_++)),v.jsx(v.Fragment,{children:I})}const x9=e=>{var i,l;const{value:n,text:t}=e,r=f.NAMED_STYLE_MAP[n],o=V.useDependency(f.LocaleService);return v.jsx("span",{className:x.clsx("univer-text-sm",{"univer-font-bold":r==null?void 0:r.bl}),style:{fontSize:r==null?void 0:r.fs,color:(l=(i=r==null?void 0:r.cl)==null?void 0:i.rgb)!=null?l:void 0},children:o.t(t)})},$9="UI_COMPONENT_HEADING_ITEM";function R1(e){const n=s.useRef(e);return n.current=e,s.useCallback(((...t)=>{var r;return(r=n.current)==null?void 0:r.call(n,...t)}),[])}function Z9(e,n){const t=R1(()=>{if(!e||!n)return;const r=e.style,o=e.getBoundingClientRect(),{y:i,height:l}=o,c=n.getBoundingClientRect(),C=e.scrollHeight>l,p=i<0||i+l>c.height;if(!p&&!C){r.overflowY="",r.maxHeight="";return}p&&(r.overflowY="auto",r.maxHeight=i<0?`${e.scrollHeight+i}px`:`${c.height-i}px`)});s.useEffect(()=>{if(!x.isBrowser()||!e||!n)return;t();const r=x.resizeObserverCtor(t);return r.observe(e),()=>{r.unobserve(e)}},[e,n])}function A9(e){const n=V.useDependency(f.IConfigService);return V.useObservable(s.useMemo(()=>n.subscribeConfigValue$(e),[n]),n.getConfig(e))}const se=116;function E2(e){V.useDependency(f.LocaleService);const{value:n,min:t=0,max:r=400,disabled:o=!1,resetPoint:i=100,shortcuts:l,onChange:c}=e,C=s.useRef(null),[p,b]=s.useState(!1);function d(){o||c&&c(i)}function w(S){if(o)return;let A=n+S;n+S<=t?A=t:n+S>=r&&(A=r),c&&c(A)}const I=s.useMemo(()=>{if(n<=i){const S=50/(i-t);return(n-t)*S}if(n<=r)return i*.5+(n-i)/(r-i)*50},[t,r,i,n]);function _(S){if(o)return;S.preventDefault();const A=C.current;let R=!0;function k(D){if(R){let W=D.clientX-A.getBoundingClientRect().x;W<=0?W=0:W>=se&&(W=se);const Y=W/se;let q=0;Y<=.5?q=t+Y*(i-t)*2:q=i+(Y-.5)*(r-i)*2,c&&c(Math.ceil(q))}}function M(){R=!1,document.removeEventListener("pointermove",k),window.removeEventListener("pointerup",M)}function $(D){D.relatedTarget===null&&M()}window.addEventListener("pointermove",k),window.addEventListener("pointerup",M),window.addEventListener("pointerout",$)}function T(S){o||(b(!1),c&&c(S))}const O=[{type:"radio",value:n.toString(),options:l.map(S=>({value:S.toString(),label:`${S}%`})),onSelect:S=>T(+S)}];return v.jsxs("div",{className:x.clsx("univer-flex univer-select-none univer-items-center univer-gap-1",{"univer-cursor-not-allowed":o}),children:[v.jsx(x.Button,{className:"univer-size-6 univer-p-0",size:"small",variant:"text",disabled:n<=t||o,onClick:()=>w(-10),children:v.jsx(Te,{})}),v.jsx("div",{className:"univer-relative univer-hidden univer-h-0.5 univer-rounded-2xl univer-bg-gray-400 univer-px-1.5 sm:!univer-block",style:{width:`${se}px`},children:v.jsxs("div",{ref:C,role:"track",className:"univer-relative univer-h-0.5",children:[v.jsx("a",{className:"univer-absolute univer-left-1/2 univer-top-1/2 univer-box-border univer-block univer-h-0.5 univer-w-0.5 -univer-translate-x-1/2 -univer-translate-y-1/2 univer-cursor-pointer univer-rounded-full univer-bg-white",role:"button",onClick:d},"reset-button"),v.jsx("button",{className:x.clsx("univer-absolute univer-top-[calc(50%-6px)] univer-size-3 -univer-translate-x-1/2 univer-rounded-full univer-border-none univer-bg-white univer-shadow univer-transition-colors",{"hover:univer-gray-200 univer-cursor-pointer":!o,"univer-cursor-not-allowed":o}),role:"handle",type:"button",style:{left:`${I}%`},onPointerDown:_})]})}),v.jsx(x.Button,{className:"univer-size-6 univer-p-0",size:"small",variant:"text",disabled:n>=r||o,onClick:()=>w(10),children:v.jsx(ct,{})}),v.jsx(x.DropdownMenu,{align:"end",items:O,open:p,onOpenChange:b,children:v.jsxs(x.Button,{size:"small",variant:"text",children:[n,"%"]})})]})}const P9="UI_COLOR_PICKER_COMPONENT",F9=e=>{const{value:n}=e,t=V.useDependency(f.LocaleService),r=s.useMemo(()=>{if(n==null)return"";let o=t.t(`fontFamily.${`${n!=null?n:""}`.replace(/\s/g,"")}`);return o.startsWith("fontFamily.")&&typeof n=="string"&&(o=n.split(",")[0]),o},[n]);return v.jsx("div",{className:"univer-w-32 univer-truncate univer-text-sm",style:{fontFamily:n},children:r})},V1="ui.config",ae={};var D2=Object.getOwnPropertyDescriptor,O2=(e,n,t,r)=>{for(var o=r>1?void 0:r?D2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},R2=(e,n)=>(t,r)=>n(t,r,e);const xe=f.createIdentifier("univer.font-service"),k9=[{value:"Arial",label:"fontFamily.arial",category:"sans-serif"},{value:"Times New Roman",label:"fontFamily.times-new-roman",category:"serif"},{value:"Tahoma",label:"fontFamily.tahoma",category:"sans-serif"},{value:"Verdana",label:"fontFamily.verdana",category:"sans-serif"},{value:"Microsoft YaHei",label:"fontFamily.microsoft-yahei",category:"sans-serif"},{value:"SimSun",label:"fontFamily.simsun",category:"serif"},{value:"SimHei",label:"fontFamily.simhei",category:"sans-serif"},{value:"Kaiti",label:"fontFamily.kaiti",category:"serif"},{value:"FangSong",label:"fontFamily.fangsong",category:"serif"},{value:"NSimSun",label:"fontFamily.nsimsun",category:"serif"},{value:"STXinwei",label:"fontFamily.stxinwei",category:"serif"},{value:"STXingkai",label:"fontFamily.stxingkai",category:"serif"},{value:"STLiti",label:"fontFamily.stliti",category:"serif"}];let $e=class{constructor(e){j(this,"fonts$",new B.BehaviorSubject([...k9]));this._configService=e;const n=this._configService.getConfig(V1),{customFontFamily:t=[]}=n!=null?n:{};t.length&&t.forEach(r=>this.addFont({...r,isCustom:!0}))}dispose(){this.resetToDefaults(),this.fonts$.complete()}getFonts(){return this.fonts$.getValue()}getFontByValue(e){return this.getFonts().find(n=>n.value===e)}isFontSupported(e){const t=document.createElement("canvas").getContext("2d");if(!t)return!1;const r="abcdefghijklmnopqrstuvwxyz0123456789";t.font="12px monospace";const o=t.measureText(r).width;return t.font=`12px "${e}", monospace`,t.measureText(r).width!==o}addFont(e){if(this.getFontByValue(e.value))throw new Error(`[FontService]: Font with value "${e.value}" already exists.`);const t=[...this.getFonts(),e].sort();this.fonts$.next(t)}updateFont(e,n){const t=this.getFonts(),r=t.findIndex(l=>l.value===e);if(r===-1)throw new Error(`Font with value "${e}" not found.`);const o={...t[r],...n},i=[...t];i[r]=o,this.fonts$.next(i)}removeFont(e){const n=this.getFonts(),t=n.findIndex(i=>i.value===e);if(t===-1||!n[t].isCustom)return!1;const o=n.filter(i=>i.value!==e);return this.fonts$.next(o),!0}resetToDefaults(){this.fonts$.next([...k9])}};$e=O2([R2(0,f.IConfigService)],$e);const B9=({id:e,value:n})=>{const t=V.useDependency(f.ICommandService),r=V.useDependency(xe),[o,i]=s.useState([]);s.useEffect(()=>{const C=r.fonts$.subscribe(p=>{i(p)});return()=>{C.unsubscribe()}},[]);const l=V.useDependency(f.LocaleService);function c(C){t.executeCommand(e,{value:C})}return v.jsx("ul",{className:"univer-m-0 univer-list-none univer-p-0 univer-text-sm",style:{fontFamily:n},children:o.map(C=>v.jsx("li",{children:v.jsxs("button",{className:"univer-flex univer-h-7 univer-w-full univer-appearance-none univer-items-center univer-justify-between univer-gap-6 univer-rounded univer-border-none univer-bg-transparent univer-px-2 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",style:{fontFamily:C.value},type:"button",onClick:()=>c(C.value),children:[l.t(C.label),!r.isFontSupported(C.value)&&v.jsx(x.Tooltip,{title:l.t("fontFamily.not-supported"),children:v.jsx(ut,{className:"univer-text-gray-300 dark:univer-text-gray-700"})})]})},C.value))})},U9="UI_FONT_FAMILY_COMPONENT",j9="UI_FONT_FAMILY_ITEM_COMPONENT",z9=e=>{const{value:n,min:t,max:r,onChange:o,disabled$:i}=e,l=V.useObservable(i),[c,C]=s.useState(Number(n!=null?n:0)),p=s.useMemo(()=>Number(n!=null?n:c),[n]);function b(w){w!==null&&C(w)}function d(w){w.stopPropagation(),w.code==="Enter"&&o(c.toString())}return v.jsx("div",{className:"univer-h-6 univer-w-7 univer-text-sm",children:v.jsx(x.InputNumber,{className:"univer-block univer-h-6 univer-border-none univer-bg-transparent univer-leading-6 [&_input:focus]:!univer-ring-0 [&_input]:univer-h-6 [&_input]:univer-w-7 [&_input]:univer-border-none [&_input]:!univer-bg-transparent [&_input]:univer-p-0 [&_input]:univer-text-sm",value:p,controls:!1,min:t,max:r,onKeyDown:d,onChange:b,disabled:l})})},V2=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],N2=[{label:"toolbar.heading.normal",value:f.NamedStyleType.NORMAL_TEXT},{label:"toolbar.heading.title",value:f.NamedStyleType.TITLE},{label:"toolbar.heading.subTitle",value:f.NamedStyleType.SUBTITLE},{label:"toolbar.heading.1",value:f.NamedStyleType.HEADING_1},{label:"toolbar.heading.2",value:f.NamedStyleType.HEADING_2},{label:"toolbar.heading.3",value:f.NamedStyleType.HEADING_3},{label:"toolbar.heading.4",value:f.NamedStyleType.HEADING_4},{label:"toolbar.heading.5",value:f.NamedStyleType.HEADING_5}],W9="UI_FONT_SIZE_COMPONENT",T2=(e,n)=>{const t=s.useRef(!1);s.useEffect(()=>{if(t.current)return e();t.current=!0},n)};function x2(e,n){const t=R1(n.handler);s.useEffect(()=>{const r=o=>{e.current&&o.target&&!e.current.contains(o.target)&&t()};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[t,e])}function $2(e,n=300){const t=s.useRef(null);return s.useCallback((...r)=>{t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{e(...r)},n)},[e,n])}const G9=e=>typeof e=="number";function Z2(e){const n=s.useRef(e);return n.current=e,n}const A2=(e,n)=>{const{containerTarget:t,itemHeight:r,overscan:o=5}=n,i=Z2(r),[l,c]=s.useState(null),C=s.useRef(!1),[p,b]=s.useState([]),[d,w]=s.useState({height:void 0,marginTop:void 0}),I=(R,k)=>{if(typeof i.current=="number")return Math.ceil(R/i.current);let M=0,$=0;for(let D=k;D<e.length;D++){const U=i.current(D,e[D]);if(M+=U,$=D,M>=R)break}return $-k},_=R=>{if(G9(i.current))return Math.floor(R/i.current);let k=0,M=0;for(let $=0;$<e.length;$++){const D=i.current($,e[$]);if(k+=D,k>=R){M=$;break}}return M+1},T=R=>typeof i.current=="number"?R*i.current:e.slice(0,R).reduce((M,$,D)=>M+i.current(D,e[D]),0),O=s.useMemo(()=>G9(i.current)?e.length*i.current:e.reduce((R,k,M)=>R+i.current(M,e[M]),0),[e]),S=()=>{const R=t.current;if(R){const{scrollTop:k,clientHeight:M}=R,$=_(k),D=I(M,$),U=Math.max(0,$-o),W=Math.min(e.length,$+D+o),Y=T(U);w({height:`${O-Y}px`,marginTop:`${Y}px`}),b(e.slice(U,W).map((q,G)=>({data:q,index:G+U})))}};return s.useEffect(()=>{if(t.current){const R=()=>{const M=t.current.clientWidth,$=t.current.clientHeight;(M!==(l==null?void 0:l.width)||$!==(l==null?void 0:l.height))&&c({width:M,height:$})};R();const k=new ResizeObserver(R);return k.observe(t.current),()=>{k.disconnect()}}},[]),s.useEffect(()=>{!(l!=null&&l.width)||!(l!=null&&l.height)||S()},[l==null?void 0:l.width,l==null?void 0:l.height,e]),[p,{wrapperStyle:d,scrollTo:R1(R=>{const k=t.current;k&&(C.current=!0,k.scrollTop=T(R),S())}),containerProps:{onScroll:R=>{if(C.current){C.current=!1;return}R.preventDefault(),S()}}}]};function P2(e,n,...t){return e.t(n)}var F2=Object.getOwnPropertyDescriptor,k2=(e,n,t,r)=>{for(var o=r>1?void 0:r?F2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},Y9=(e,n)=>(t,r)=>n(t,r,e);const B2="FOCUSING_UNIVER",U2=["app-layout","button","sheet-bar-append-button","render-canvas","workbench-layout"],M1=f.createIdentifier("ui.layout-service");h.DesktopLayoutService=class extends f.Disposable{constructor(t,r){super();j(this,"_rootContainerElement",null);j(this,"_isFocused",!1);j(this,"_focusHandlers",new Map);j(this,"_contentElements",[]);j(this,"_allContainers",[]);this._contextService=t,this._univerInstanceService=r,this._initUniverFocusListener(),this._initEditorStatus()}get isFocused(){return this._isFocused}get rootContainerElement(){return this._rootContainerElement}focus(){const t=this._univerInstanceService.getFocusedUnit();if(!t)return;let r;t instanceof f.Workbook?r=this._focusHandlers.get(f.UniverInstanceType.UNIVER_SHEET):t instanceof f.DocumentDataModel?r=this._focusHandlers.get(f.UniverInstanceType.UNIVER_DOC):t instanceof f.SlideDataModel&&(r=this._focusHandlers.get(f.UniverInstanceType.UNIVER_SLIDE)),r&&r(t.getUnitId())}registerFocusHandler(t,r){if(this._focusHandlers.has(t))throw new Error(`[DesktopLayoutService]: handler of type ${t} bas been registered!`);return this._focusHandlers.set(t,r),f.toDisposable(()=>this._focusHandlers.delete(t))}registerContentElement(t){if(this._contentElements.indexOf(t)===-1)return this._contentElements.push(t),f.toDisposable(()=>f.remove(this._contentElements,t));throw new Error("[DesktopLayoutService]: content container already registered!")}getContentElement(){return this._contentElements[0]}registerRootContainerElement(t){if(this._rootContainerElement)throw new Error("[DesktopLayoutService]: root container already registered!");this._rootContainerElement=t;const r=this.registerContainerElement(t);return f.toDisposable(()=>{this._rootContainerElement=null,r.dispose()})}registerContainerElement(t){if(this._allContainers.indexOf(t)===-1)return this._allContainers.push(t),f.toDisposable(()=>f.remove(this._allContainers,t));throw new Error("[LayoutService]: container already registered!")}checkElementInCurrentContainers(t){return this._allContainers.some(r=>r.contains(t))}checkContentIsFocused(){return this._contentElements.some(t=>t===document.activeElement||t.contains(document.activeElement))}_initUniverFocusListener(){this.disposeWithMe(B.fromEvent(window,"focusin").subscribe(t=>{var o;const r=t.target;if((o=this._rootContainerElement)!=null&&o.contains(r)&&U2.some(i=>r.dataset.uComp===i)){queueMicrotask(()=>this.focus());return}r&&this.checkElementInCurrentContainers(r)?this._isFocused=!0:this._isFocused=!1,this._contextService.setContextValue(B2,this._isFocused),this._contextService.setContextValue(f.FOCUSING_UNIVER_EDITOR,X9())}))}_initEditorStatus(){this._contextService.setContextValue(f.FOCUSING_UNIVER_EDITOR,X9())}},h.DesktopLayoutService=k2([Y9(0,f.IContextService),Y9(1,f.IUniverInstanceService)],h.DesktopLayoutService);function X9(){var e;return((e=document.activeElement)==null?void 0:e.dataset.uComp)==="editor"}var g1=(e=>(e[e.BUTTON=0]="BUTTON",e[e.SELECTOR=1]="SELECTOR",e[e.BUTTON_SELECTOR=2]="BUTTON_SELECTOR",e[e.SUBITEMS=3]="SUBITEMS",e))(g1||{}),G1=(e=>(e.RIBBON="ribbon",e.CONTEXT_MENU="contextMenu",e))(G1||{}),h1=(e=>(e.START="ribbon.start",e.INSERT="ribbon.insert",e.FORMULAS="ribbon.formulas",e.DATA="ribbon.data",e.VIEW="ribbon.view",e.OTHERS="ribbon.others",e))(h1||{}),_1=(e=>(e.HISTORY="ribbon.start.history",e.FORMAT="ribbon.start.format",e.LAYOUT="ribbon.start.layout",e.OTHERS="ribbon.start.others",e))(_1||{}),Y1=(e=>(e.EDIT="ribbon.insert.edit",e.MEDIA="ribbon.insert.media",e.OTHERS="ribbon.insert.others",e))(Y1||{}),ce=(e=>(e.BASIC="ribbon.formulas.basic",e.OTHERS="ribbon.formulas.others",e))(ce||{}),$1=(e=>(e.FORMULAS="ribbon.data.formulas",e.RULES="ribbon.data.rules",e.ORGANIZATION="ribbon.data.organization",e.OTHERS="ribbon.data.others",e))($1||{}),X1=(e=>(e.DISPLAY="ribbon.view.display",e.VISIBILITY="ribbon.view.Visibility",e.OTHERS="ribbon.view.others",e))(X1||{}),Ze=(e=>(e.OTHERS="ribbon.others.others",e))(Ze||{}),S1=(e=>(e.MAIN_AREA="contextMenu.mainArea",e.COL_HEADER="contextMenu.colHeader",e.ROW_HEADER="contextMenu.rowHeader",e.FOOTER_TABS="contextMenu.footerTabs",e.FOOTER_MENU="contextMenu.footerMenu",e.PARAGRAPH="contextMenu.paragraph",e))(S1||{}),o1=(e=>(e.QUICK="contextMenu.quick",e.FORMAT="contextMenu.format",e.LAYOUT="contextMenu.layout",e.DATA="contextMenu.data",e.OTHERS="contextMenu.others",e))(o1||{}),j2=Object.getOwnPropertyDescriptor,z2=(e,n,t,r)=>{for(var o=r>1?void 0:r?j2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},q9=(e,n)=>(t,r)=>n(t,r,e);const I1=f.createIdentifier("univer.menu-manager-service");h.MenuManagerService=class extends f.Disposable{constructor(t,r){super();j(this,"menuChanged$",new B.Subject);j(this,"_menu",{[G1.RIBBON]:{[h1.START]:{order:0,[_1.HISTORY]:{order:0},[_1.FORMAT]:{order:1},[_1.LAYOUT]:{order:2},[_1.OTHERS]:{order:3}},[h1.INSERT]:{order:1,[Y1.EDIT]:{order:0},[Y1.MEDIA]:{order:1},[Y1.OTHERS]:{order:2}},[h1.FORMULAS]:{order:2,[ce.BASIC]:{order:0},[ce.OTHERS]:{order:1}},[h1.DATA]:{order:3,[$1.FORMULAS]:{order:0},[$1.RULES]:{order:1},[$1.ORGANIZATION]:{order:2},[$1.OTHERS]:{order:3}},[h1.VIEW]:{order:4,[X1.DISPLAY]:{order:0},[X1.VISIBILITY]:{order:0},[X1.OTHERS]:{order:0}},[h1.OTHERS]:{order:5,[Ze.OTHERS]:{order:0}}},[G1.CONTEXT_MENU]:{[S1.MAIN_AREA]:{order:0,[o1.QUICK]:{order:-1},[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.PARAGRAPH]:{order:0,[o1.QUICK]:{order:-1},[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.COL_HEADER]:{order:1,[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.ROW_HEADER]:{order:2,[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.FOOTER_TABS]:{order:3,[o1.FORMAT]:{order:0},[o1.LAYOUT]:{order:1},[o1.DATA]:{order:2},[o1.OTHERS]:{order:3}},[S1.FOOTER_MENU]:{order:4,[o1.OTHERS]:{order:3}}}});this._injector=t,this._configService=r}dispose(){this.menuChanged$.complete()}mergeMenu(t,r){const o=r!=null?r:this._menu;for(const[i,l]of Object.entries(o))if(i in t){const c=i;o[c]=f.merge({},o[c],t[c]),this.menuChanged$.next()}else typeof l=="object"&&this.mergeMenu(t,l)}appendRootMenu(t){this._menu=f.merge({},this._menu,t),this.menuChanged$.next()}_buildMenuSchema(t){const r=[];for(const[o,i]of Object.entries(t)){const l={key:o,order:i.order,title:i.title};if(i.menuItemFactory){const c=this._injector.invoke(i.menuItemFactory);if(c){const C=this._configService.getConfig("menu");if(C&&c.id in C){const p=c.id;l.item=R9(c,C[p])}else l.item=c}}if(typeof i=="object"){const c=this._buildMenuSchema(i);c.length>0&&(l.children=c.sort((C,p)=>C.order-p.order)),(l.item||l.children)&&r.push(l)}}return r}getMenuByPositionKey(t){const r=o=>{if(t in o)return this._buildMenuSchema(o[t]);for(const i in o){if(i===t)return this._buildMenuSchema(o[i]);if(typeof o[i]=="object"){const l=r(o[i]);if(l)return l}}};return r(this._menu)}getFlatMenuByPositionKey(t){const r=this.getMenuByPositionKey(t);function o(i){return i.reduce((l,c)=>c.children?[...l,c,...o(c.children)]:[...l,c],[])}return o(r)}},h.MenuManagerService=z2([q9(0,f.Inject(f.Injector)),q9(1,f.IConfigService)],h.MenuManagerService);function W2(e){const{item:n,onOptionSelect:t}=e,[r,o]=s.useState([]),i=V.useDependency(v1),l=V.useDependency(f.LocaleService);return s.useEffect(()=>{if(!n.children)return;const c=n.children.map(p=>{var b,d;return f.convertObservableToBehaviorSubject((d=(b=p.item)==null?void 0:b.activated$)!=null?d:B.of(!1),!1)}),C=B.combineLatest(c).subscribe(p=>{const b=p.map((d,w)=>({actived:d,item:n.children[w].item.id})).filter(d=>d.actived);b.length===0?o([]):o(b.map(d=>d.item))});return()=>{C.unsubscribe(),c.forEach(p=>{p.complete()})}},[n]),n.children?v.jsx(x.TinyMenuGroup,{items:n.children.map(c=>{var C,p;return{key:c.key,onClick:()=>{var b,d,w,I;t==null||t({value:"",label:c.key,commandId:(b=c.item)==null?void 0:b.commandId,id:(d=c.item)==null?void 0:d.id,tooltip:((w=c.item)==null?void 0:w.tooltip)&&l.t((I=c.item)==null?void 0:I.tooltip)})},className:"",Icon:i.get(c.item.icon),active:r.includes((p=(C=c.item)==null?void 0:C.id)!=null?p:"")}})}):null}const q1="univer-inline-flex univer-gap-2 univer-items-center",J9="univer-size-3.5 univer-text-gray-900 dark:!univer-text-white";function Q9(e){const{menuType:n,onOptionSelect:t}=e,r=V.useDependency(f.LocaleService),o=V.useDependency(I1),i=s.useMemo(()=>n?o.getMenuByPositionKey(n):[],[n,o]),[l,c]=s.useState({}),C=s.useMemo(()=>i.filter(p=>{var d;if(!p.children)return p;const b=((d=p.key)==null?void 0:d.toString())||"";return!l[b]}),[i,l]);return s.useEffect(()=>{const p=i.map(b=>{if(!b.children)return null;const d=b.children.map(w=>{var I,_;return(_=(I=w.item)==null?void 0:I.hidden$)!=null?_:B.of(!1)});return B.combineLatest(d).subscribe(w=>{const I=w.every(_=>_===!0);c(_=>({..._,[b.key]:I}))})});return()=>{p.forEach(b=>b==null?void 0:b.unsubscribe()),c({})}},[i]),n?C&&C.map(p=>{var b;return p.item?v.jsx(e6,{menuItem:p.item,onClick:d=>{t==null||t({value:"",label:p.key,...d})}},p.key):(b=p.children)!=null&&b.length?p.key===o1.QUICK?v.jsx(W2,{item:p,onOptionSelect:t},p.key):v.jsx(x.MenuItemGroup,{eventKey:p.key,title:p.title?r.t(p.title):void 0,children:p.children.map(d=>d.item&&v.jsx(e6,{menuItem:d.item,onClick:w=>{t==null||t({value:"",label:d.key,...w})}},d.key))},p.key):null}):null}function K9(e){var i;const{options:n,value:t,onOptionSelect:r,parentKey:o}=e;return(i=n==null?void 0:n.map((l,c)=>{var w,I,_;const C=`${o}-${(w=l.label)!=null?w:l.id}-${c}`,p=T=>{r==null||r({value:T,label:l==null?void 0:l.label,commandId:l==null?void 0:l.commandId})},b=()=>{typeof l.value>"u"||r==null||r({...l})},d=x.clsx({"univer-bg-none":typeof l.label!="string"&&!((I=l.label)!=null&&I.hoverable)});return v.jsx(x.MenuItem,{disabled:l.disabled,eventKey:C,className:d,onClick:b,children:v.jsxs("span",{className:x.clsx(q1,{"univer-relative univer-pl-5":!(typeof l.label!="string"&&!((_=l.label)!=null&&_.hoverable))}),children:[typeof t<"u"&&String(t)===String(l.value)&&v.jsx("span",{className:"univer-absolute univer-left-0 univer-inline-flex univer-items-center",children:v.jsx(De,{className:"univer-text-primary-600"})}),v.jsx(f1,{value$:l.value$,value:l.value,label:l.label,icon:l.icon,onChange:p})]})},C)}))!=null?i:null}const Ae=e=>{const{overViewport:n,style:t,...r}=e,[o,i]=s.useState(),l=V.useDependency(M1);Z9(n==="scroll"?o:null,l.rootContainerElement);function c(C){C&&i(C.list)}return v.jsxs(x.Menu,{style:t,ref:c,selectable:!1,children:[v.jsx(K9,{...r}),v.jsx(Q9,{...r})]})};function e6({menuItem:e,onClick:n}){const t=V.useDependency(I1),r=V.useObservable(e.disabled$,!1),o=V.useObservable(e.activated$,!1),i=V.useObservable(e.hidden$,!1),l=V.useObservable(e.value$),c=e,C=V.useObservable(B.isObservable(c.selections)?c.selections:void 0),[p,b]=s.useState(l);if(s.useEffect(()=>{b(l)},[l]),i)return null;const d=O=>{const S=f.isRealNum(O)&&typeof O=="string"?Number.parseInt(O):O;b(S)},w=()=>{const O=e,{title:S,label:A}=O;return v.jsx(x.MenuItem,{eventKey:O.id,disabled:r,className:x.clsx({"univer-bg-gray-200":o}),onClick:()=>{n({commandId:O.commandId,value:p,id:O.id})},children:v.jsx("span",{className:q1,children:v.jsx(f1,{value:l,title:S,label:A,icon:O.icon,onChange:d})})},O.id)},I=()=>{var S;const O=(S=C!=null?C:c.selections)!=null?S:[];return O.length>0?v.jsx(x.SubMenu,{eventKey:c.id,popupOffset:[18,0],title:v.jsxs("span",{className:q1,children:[v.jsx(f1,{title:c.title,value:p,onChange:d,icon:c.icon,label:c.label}),c.shortcut&&` (${c.shortcut})`]}),expandIcon:v.jsx(Ne,{className:J9}),children:v.jsx(x.MenuItemGroup,{children:O.length>0&&v.jsx(K9,{parentKey:c.id,menuType:c.id,options:O,onOptionSelect:A=>{n({value:A.value,id:c.id,commandId:A.commandId})}})})},c.id):v.jsx(x.MenuItem,{eventKey:c.id,children:v.jsxs("span",{className:q1,children:[v.jsx(f1,{title:c.title,value:p,icon:c.icon,label:c.label,onChange:d}),c.shortcut&&` (${c.shortcut})`]})},c.id)},_=e.id?t.getMenuByPositionKey(e.id):[],T=()=>{const O=e;return v.jsx(x.SubMenu,{eventKey:O.id,popupOffset:[18,0],title:v.jsx("span",{className:q1,children:v.jsx(f1,{title:O.title,icon:O.icon,label:O.label,onChange:d})}),expandIcon:v.jsx(Ne,{className:J9}),children:v.jsx(x.MenuItemGroup,{children:_.length&&v.jsx(Q9,{menuType:O.id,parentKey:O.id,onOptionSelect:n})})},O.id)};return v.jsxs(v.Fragment,{children:[e.type===g1.SELECTOR&&I(),e.type===g1.SUBITEMS&&T(),e.type===g1.BUTTON&&w()]})}function G2(e){const{barColor:n,progress:t,onTerminate:r,onClearProgress:o}=e,{count:i,done:l,label:c=""}=t,C=s.useRef(null),[p,b]=s.useState(!1);return s.useEffect(()=>{const d=C.current;if(i===0&&l===0){b(!1),d.style.width="0%";return}else if(i>0){b(!0);const I=Math.floor(l/i*100);l===i?requestAnimationFrame(()=>{d.style.width=`${I-1}%`,requestAnimationFrame(()=>{d.style.width=`${I}%`})}):d.style.width=`${I}%`}const w=()=>{l===i&&(b(!1),o&&o())};return d.addEventListener("transitionend",w),()=>{d.removeEventListener("transitionend",w)}},[i,l]),v.jsxs("div",{className:x.clsx("univer-mx-2 univer-flex univer-items-center univer-gap-2",{"univer-flex":p,"univer-hidden univer-w-0":!p}),children:[v.jsx(x.Tooltip,{showIfEllipsis:!0,title:c,children:v.jsx("span",{className:"univer-w-24 univer-truncate univer-text-right univer-text-xs",children:c})}),v.jsx("div",{className:"univer-h-1 univer-w-40 univer-overflow-hidden univer-rounded-lg univer-bg-gray-200",children:v.jsx("div",{ref:C,className:"univer-h-full univer-bg-primary-600 univer-transition-[width]",style:{backgroundColor:n}})}),v.jsx("button",{className:"univer-flex univer-size-4 univer-cursor-pointer univer-items-center univer-justify-center univer-border-none univer-bg-transparent univer-p-0 hover:univer-opacity-50",type:"button",onClick:r,children:v.jsx(Oe,{className:"univer-size-3.5 dark:!univer-text-white"})})]})}const Y2="UNI_DISABLE_CHANGING_FOCUS",ue=f.createIdentifier("ui.message.service");var X2=Object.getOwnPropertyDescriptor,q2=(e,n,t,r)=>{for(var o=r>1?void 0:r?X2(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},t6=(e,n)=>(t,r)=>n(t,r,e);h.ErrorController=class extends f.Disposable{constructor(n,t){super(),this._errorService=n,this._messageService=t,this.disposeWithMe(this._errorService.error$.subscribe(r=>{this._messageService.show({content:r.errorKey,type:x.MessageType.Error})}))}},h.ErrorController=q2([t6(0,f.Inject(f.ErrorService)),t6(1,ue)],h.ErrorController);function J2(){return{id:j1.id,title:"toggle-shortcut-panel",tooltip:"toggle-shortcut-panel",icon:"ShortcutIcon",type:g1.BUTTON}}const n6=(e,n)=>{const t=e.get(f.IUndoRedoService),r=e.get(f.IContextService);return B.combineLatest([t.undoRedoStatus$.pipe(_3.map(o=>n?o.undos<=0:o.redos<=0)),B.merge([B.of({}),r.contextChanged$])]).pipe(_3.map(([o])=>o||r.getContextValue(f.EDITOR_ACTIVATED)||r.getContextValue(f.FOCUSING_FX_BAR_EDITOR)))};function Q2(e){return{id:f.UndoCommand.id,type:g1.BUTTON,icon:"UndoIcon",title:"Undo",tooltip:"toolbar.undo",disabled$:n6(e,!0)}}function K2(e){return{id:f.RedoCommand.id,type:g1.BUTTON,icon:"RedoIcon",title:"Redo",tooltip:"toolbar.redo",disabled$:n6(e,!1)}}const r6={[_1.HISTORY]:{[f.UndoCommand.id]:{order:0,menuItemFactory:Q2},[f.RedoCommand.id]:{order:1,menuItemFactory:K2}},[_1.OTHERS]:{[j1.id]:{order:1,menuItemFactory:J2}}},o6="univer.command.copy",Pe={id:o6,name:o6,multi:!0,priority:0,type:f.CommandType.COMMAND,preconditions:()=>!1,handler:()=>!0},i6="univer.command.cut",Fe={id:i6,name:i6,multi:!0,priority:0,type:f.CommandType.COMMAND,preconditions:()=>!1,handler:async()=>!0},l6="univer.command.paste",ke={id:l6,name:l6,multi:!0,priority:0,type:f.CommandType.COMMAND,preconditions:()=>!1,handler:()=>!0},e4="sheet.command.paste-by-short-key";var H1=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.ARROW_LEFT=37]="ARROW_LEFT",e[e.ARROW_UP=38]="ARROW_UP",e[e.ARROW_RIGHT=39]="ARROW_RIGHT",e[e.ARROW_DOWN=40]="ARROW_DOWN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.Digit0=48]="Digit0",e[e.Digit1=49]="Digit1",e[e.Digit2=50]="Digit2",e[e.Digit3=51]="Digit3",e[e.Digit4=52]="Digit4",e[e.Digit5=53]="Digit5",e[e.Digit6=54]="Digit6",e[e.Digit7=55]="Digit7",e[e.Digit8=56]="Digit8",e[e.Digit9=57]="Digit9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.EQUAL=187]="EQUAL",e[e.COMMA=188]="COMMA",e[e.MINUS=189]="MINUS",e[e.PERIOD=190]="PERIOD",e[e.BACK_SLASH=220]="BACK_SLASH",e))(H1||{});const t4={8:"Backspace",9:"Tab",13:"Enter",46:"Del",27:"Esc",32:"Space",37:"",39:"",38:"",40:"",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",189:"-",187:"=",190:".",188:",",220:"\\"};var C1=(e=>(e[e.SHIFT=1024]="SHIFT",e[e.ALT=2048]="ALT",e[e.CTRL_COMMAND=4096]="CTRL_COMMAND",e[e.MAC_CTRL=8192]="MAC_CTRL",e))(C1||{});function n4(e,n,t){return window.addEventListener(e,n,t),f.toDisposable(()=>window.removeEventListener(e,n,t))}const de=f.createIdentifier("ui.platform.service");class Be{get isMac(){return/Mac/.test(navigator.appVersion)}get isWindows(){return/Windows/.test(navigator.appVersion)}get isLinux(){return/Linux/.test(navigator.appVersion)}}var r4=Object.getOwnPropertyDescriptor,o4=(e,n,t,r)=>{for(var o=r>1?void 0:r?r4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},fe=(e,n)=>(t,r)=>n(t,r,e);const Z1=f.createIdentifier("ui.shortcut.service");h.ShortcutService=class extends f.Disposable{constructor(t,r,o,i){super();j(this,"_shortCutMapping",new Map);j(this,"_commandIDMapping",new Map);j(this,"_shortcutChanged$",new B.Subject);j(this,"shortcutChanged$",this._shortcutChanged$.asObservable());j(this,"_forceEscaped",!1);j(this,"_forceDisabled",!1);this._commandService=t,this._platformService=r,this._contextService=o,this._layoutService=i,this.disposeWithMe(n4("keydown",l=>{this._resolveKeyboardEvent(l)},{capture:!0}))}getAllShortcuts(){return Array.from(this._shortCutMapping.values()).map(t=>Array.from(t.values())).flat()}registerShortcut(t){const r=this._getBindingFromItem(t);if(!r)return f.toDisposable(()=>{});const o=this._shortCutMapping.get(r);o?o.add(t):this._shortCutMapping.set(r,new Set([t]));const i=t.id,l=this._commandIDMapping.get(i);return l?l.add(t):this._commandIDMapping.set(i,new Set([t])),this._emitShortcutChanged(),f.toDisposable(()=>{var c,C,p,b;(c=this._shortCutMapping.get(r))==null||c.delete(t),((C=this._shortCutMapping.get(r))==null?void 0:C.size)===0&&this._shortCutMapping.delete(r),(p=this._commandIDMapping.get(i))==null||p.delete(t),((b=this._commandIDMapping.get(i))==null?void 0:b.size)===0&&this._commandIDMapping.delete(i),this._emitShortcutChanged()})}getShortcutDisplayOfCommand(t){const r=this._commandIDMapping.get(t);if(!r)return null;const o=r.values().next().value;return o?this.getShortcutDisplay(o):null}getShortcutDisplay(t){var p;const r=this._getBindingFromItem(t);if(!r)return null;const o=r&C1.CTRL_COMMAND,i=r&C1.SHIFT,l=r&C1.ALT,c=r&C1.MAC_CTRL,C=(p=t4[r&255])!=null?p:"<->";return this._platformService.isMac?`${o?"+":""}${i?"+":""}${l?"+":""}${c?"+":""}${C}`:`${o?"Ctrl+":""}${i?"Shift+":""}${l?"Alt+":""}${C}`}_emitShortcutChanged(){this._shortcutChanged$.next()}forceEscape(){return this._forceEscaped=!0,f.toDisposable(()=>this._forceEscaped=!1)}forceDisable(){return this._forceDisabled=!0,f.toDisposable(()=>{this._forceDisabled=!1})}_resolveKeyboardEvent(t){const r=this.dispatch(t);r&&(this._commandService.executeCommand(r.id,r.staticParameters),t.preventDefault())}dispatch(t){if(this._forceEscaped||this._forceDisabled||this._layoutService&&!this._layoutService.checkElementInCurrentContainers(t.target))return;const r=this._deriveBindingFromEvent(t);if(r===null)return;const o=this._shortCutMapping.get(r);return o===void 0?void 0:Array.from(o).sort((l,c)=>{var C,p;return((C=c.priority)!=null?C:0)-((p=l.priority)!=null?p:0)}).find(l=>{var c,C;return(C=(c=l.preconditions)==null?void 0:c.call(l,this._contextService))!=null?C:!0})}_getBindingFromItem(t){return this._platformService.isMac&&t.mac?t.mac:this._platformService.isWindows&&t.win?t.win:this._platformService.isLinux&&t.linux?t.linux:t.binding}_deriveBindingFromEvent(t){const{shiftKey:r,metaKey:o,altKey:i,keyCode:l}=t;let c=l;return r&&(c|=C1.SHIFT),i&&(c|=C1.ALT),(this._platformService.isMac?o:t.ctrlKey)&&(c|=C1.CTRL_COMMAND),this._platformService.isMac&&t.ctrlKey&&(c|=C1.MAC_CTRL),c}},h.ShortcutService=o4([fe(0,f.ICommandService),fe(1,de),fe(2,f.IContextService),fe(3,f.Optional(M1))],h.ShortcutService);var i4=Object.getOwnPropertyDescriptor,l4=(e,n,t,r)=>{for(var o=r>1?void 0:r?i4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},s6=(e,n)=>(t,r)=>n(t,r,e);function a6(e){return e.getContextValue(f.FOCUSING_UNIVER_EDITOR)}function c6(e){return e.getContextValue(f.FOCUSING_UNIVER_EDITOR)&&!(e.getContextValue(f.EDITOR_ACTIVATED)||e.getContextValue(f.FOCUSING_FX_BAR_EDITOR))}const u6={id:Pe.id,description:"shortcut.copy",group:"1_common-edit",binding:H1.C|C1.CTRL_COMMAND,preconditions:a6},d6={id:Fe.id,description:"shortcut.cut",group:"1_common-edit",binding:H1.X|C1.CTRL_COMMAND,preconditions:a6},s4={id:ke.id,description:"shortcut.paste",group:"1_common-edit",binding:H1.V|C1.CTRL_COMMAND,preconditions:()=>!1},f6={id:f.UndoCommand.id,description:"shortcut.undo",group:"1_common-edit",binding:H1.Z|C1.CTRL_COMMAND,preconditions:c6},h6={id:f.RedoCommand.id,description:"shortcut.redo",group:"1_common-edit",binding:H1.Y|C1.CTRL_COMMAND,preconditions:c6};h.SharedController=class extends f.Disposable{constructor(n,t){super(),this._shortcutService=n,this._commandService=t,this.initialize()}initialize(){this._registerCommands(),this._registerShortcuts()}_registerCommands(){[Fe,Pe,ke].forEach(n=>this.disposeWithMe(this._commandService.registerMultipleCommand(n)))}_registerShortcuts(){const n=[f6,h6];n.push(d6,u6,s4),n.forEach(t=>this.disposeWithMe(this._shortcutService.registerShortcut(t)))}},h.SharedController=l4([s6(0,Z1),s6(1,f.ICommandService)],h.SharedController);function a4(){const e=V.useDependency(Z1),n=V.useDependency(f.LocaleService),t=V.useObservable(n.currentLocale$),[r,o]=s.useState([]),i=s.useCallback(()=>{var p;const l=new Map,c=e.getAllShortcuts().filter(b=>!!b.group);for(const b of c){const d=b.group,w={title:n.t((p=b.description)!=null?p:b.id),shortcut:e.getShortcutDisplay(b)};if(!/\d+_[a-zA-Z0-9]/.test(d))throw new Error(`[ShortcutPanel]: Invalid shortcut group: ${d}!`);l.has(d)||l.set(d,[]),l.get(d).push(w)}const C=Array.from(l.entries()).map(([b,d])=>{const w=b.split("_")[0],I=b.slice(w.length+1);return{sequence:+w,name:n.t(I),items:f.dedupeBy(d,_=>_.title+_.shortcut)}}).sort((b,d)=>b.sequence-d.sequence);o(C)},[e,n,t]);return s.useEffect(()=>{i();const l=e.shortcutChanged$.subscribe(()=>i());return()=>l.unsubscribe()},[e,i]),v.jsx("ul",{className:"univer-m-0 univer-list-none univer-p-0 univer-text-gray-900 dark:!univer-text-white",children:r.map(l=>v.jsxs("li",{children:[v.jsx("div",{className:"univer-flex univer-h-10 univer-items-center univer-text-sm univer-font-semibold",children:l.name}),v.jsx("ul",{className:x.clsx("univer-list-none univer-p-0",x.divideYClassName),children:l.items.map(c=>v.jsxs("li",{className:"univer-flex univer-h-10 univer-items-center univer-justify-between univer-py-0.5 univer-text-sm last:univer-border-b-0",children:[v.jsx("span",{className:"univer-line-clamp-2",children:c.title}),c.shortcut&&v.jsx(x.KBD,{keyboard:c.shortcut})]},`${c.title}-${c.shortcut}`))})]},l.name))})}var c4=Object.getOwnPropertyDescriptor,u4=(e,n,t,r)=>{for(var o=r>1?void 0:r?c4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},J1=(e,n)=>(t,r)=>n(t,r,e);const d4={id:j1.id,binding:C1.CTRL_COMMAND|H1.BACK_SLASH,description:"shortcut.shortcut-panel",group:"10_global-shortcut"};h.ShortcutPanelController=class extends f.Disposable{constructor(n,t,r,o,i){super(),this._menuManagerService=o,this.disposeWithMe(t.register(H3,a4)),this.disposeWithMe(i.registerCommand(j1)),this.disposeWithMe(r.registerShortcut(d4))}},h.ShortcutPanelController=u4([J1(0,f.Inject(f.Injector)),J1(1,f.Inject(v1)),J1(2,Z1),J1(3,I1),J1(4,f.ICommandService)],h.ShortcutPanelController);var i1=(e=>(e.GLOBAL="global",e.HEADER="header",e.HEADER_MENU="header-menu",e.CONTENT="content",e.FOOTER="footer",e.LEFT_SIDEBAR="left-sidebar",e.FLOATING="floating",e.UNIT="unit",e.CUSTOM_HEADER="custom-header",e.CUSTOM_LEFT="custom-left",e.CUSTOM_RIGHT="custom-right",e.CUSTOM_FOOTER="custom-footer",e.TOOLBAR="toolbar",e))(i1||{});const w1=f.createIdentifier("ui.parts.service");class Ue extends f.Disposable{constructor(){super(...arguments);j(this,"_componentsByPart",new Map);j(this,"_componentRegistered$",new B.Subject);j(this,"componentRegistered$",this._componentRegistered$.asObservable());j(this,"_uiVisible",new Map);j(this,"_uiVisibleChange$",new B.Subject);j(this,"uiVisibleChange$",this._uiVisibleChange$.asObservable())}dispose(){super.dispose(),this._componentsByPart.clear(),this._uiVisible.clear(),this._componentRegistered$.complete(),this._uiVisibleChange$.complete()}setUIVisible(t,r){this._uiVisible.set(t,r),this._uiVisibleChange$.next({ui:t,visible:r})}isUIVisible(t){var r;return(r=this._uiVisible.get(t))!=null?r:!0}registerComponent(t,r){const o=r(),i=(this._componentsByPart.get(t)||this._componentsByPart.set(t,new Set).get(t)).add(o);return this._componentRegistered$.next(t),f.toDisposable(()=>{i.delete(o),i.size===0&&this._componentsByPart.delete(t),this._componentRegistered$.next(t)})}getComponents(t){return new Set([...this._componentsByPart.get(t)||new Set])}}class he{constructor(){j(this,"_domLayerMap",new Map);j(this,"_domLayers$",new B.BehaviorSubject([]));j(this,"domLayers$",this._domLayers$.asObservable())}get domLayers(){return Array.from(this._domLayerMap.entries())}_notice(){this._domLayers$.next(Array.from(this._domLayerMap.entries()))}updateFloatDom(n,t){const r=this._domLayerMap.get(n);r&&(this._domLayerMap.set(n,{...r,...t}),this._notice())}addFloatDom(n){this._domLayerMap.set(n.id,n),this._notice()}removeFloatDom(n){this._domLayerMap.delete(n)&&this._notice()}removeAll(){this._domLayerMap.clear(),this._notice()}}const C6=s.memo(e=>{var S,A;const{layer:n,id:t}=e,r=s.useMemo(()=>n.position$.pipe(B.distinctUntilChanged((R,k)=>R.absolute.left===k.absolute.left&&R.absolute.top===k.absolute.top&&R.endX-R.startX===k.endX-k.startX&&R.endY-R.startY===k.endY-k.startY)),[n.position$]),o=V.useDependency(f.IUniverInstanceService),i=V.useObservable(s.useMemo(()=>n.position$.pipe(B.first()),[n.position$])),l=s.useRef(null),c=s.useRef(null),C=s.useRef(`transform: rotate(${i==null?void 0:i.rotate}deg) translate(${i==null?void 0:i.startX}px, ${i==null?void 0:i.startY}px)`),p=s.useRef((S=i==null?void 0:i.startY)!=null?S:0),b=s.useRef((A=i==null?void 0:i.startX)!=null?A:0),d=s.useRef({}),w=typeof n.componentKey=="string"?V.useDependency(v1).get(n.componentKey):n.componentKey,I=s.useMemo(()=>({data:n.data,...n.props}),[n.data,n.props]);s.useEffect(()=>{const R=n.position$.subscribe(M=>{var $;C.current=`rotate(${M.rotate}deg)`,p.current=M.startY,b.current=M.startX,l.current&&(l.current.style.transform=C.current,l.current.style.top=`${p.current}px`,l.current.style.left=`${b.current}px`,l.current.style.opacity=`${($=M.opacity)!=null?$:1}`)}),k=r.subscribe(M=>{if(l.current&&(l.current.style.width=`${Math.max(M.endX-M.startX-2,0)}px`,l.current.style.height=`${Math.max(M.endY-M.startY-2,0)}px`),c.current){const $={width:`${M.width-4}px`,height:`${M.height-4}px`,left:`${M.absolute.left?0:"auto"}`,top:`${M.absolute.top?0:"auto"}`,right:`${M.absolute.left?"auto":0}`,bottom:`${M.absolute.top?"auto":0}`};c.current.style.width=$.width,c.current.style.height=$.height,c.current.style.left=$.left,c.current.style.top=$.top,c.current.style.right=$.right,c.current.style.bottom=$.bottom,d.current=$}});return()=>{R.unsubscribe(),k.unsubscribe()}},[n.position$,r]);const _=o.getUnit(n.unitId),T=_ instanceof f.DocumentDataModel?_.getDisabled():void 0,O=s.useMemo(()=>w?v.jsx(w,{...I,unitId:n.unitId,unit:_,floatDomId:n.id,context:{docDisabled:T,root:c}}):null,[w,I]);return i?v.jsx("div",{ref:l,className:"univer-z-10",style:{position:"absolute",top:p.current,left:b.current,width:Math.max(i.endX-i.startX-2,0),height:Math.max(i.endY-i.startY-2,0),transform:C.current,overflow:"hidden",transformOrigin:"center center"},onPointerMove:R=>{n.onPointerMove(R.nativeEvent)},onPointerDown:R=>{n.onPointerDown(R.nativeEvent)},onPointerUp:R=>{n.onPointerUp(R.nativeEvent)},onWheel:R=>{n.onWheel(R.nativeEvent)},children:v.jsx("div",{id:t,ref:c,className:"univer-absolute univer-overflow-hidden",style:{...d.current},children:O})}):null}),je=({unitId:e})=>{var l;const n=V.useDependency(f.IUniverInstanceService),t=V.useDependency(he),r=V.useObservable(t.domLayers$),o=V.useObservable(n.focused$),i=e||o;return(l=r==null?void 0:r.filter(c=>c[1].unitId===i))==null?void 0:l.map(c=>{var C;return v.jsx(C6,{id:(C=c[1].domId)!=null?C:c[0],layer:c[1]},c[0])})},Ce=f.createIdentifier("ui.popup.service");class ze extends f.Disposable{constructor(){super(...arguments);j(this,"_popupMap",new Map);j(this,"_popups$",new B.BehaviorSubject([]));j(this,"popups$",this._popups$.asObservable());j(this,"_activePopupId",null)}get popups(){return Array.from(this._popupMap.entries())}get activePopupId(){return this._activePopupId}_update(){this._popups$.next(Array.from(this._popupMap.entries()))}dispose(){super.dispose(),this._popups$.next([]),this._popups$.complete(),this._popupMap.clear()}addPopup(t){const r=f.generateRandomId();return this._popupMap.set(r,{...t,onActiveChange:o=>{o?this._activePopupId=r:this._activePopupId===r&&(this._activePopupId=null)}}),this._update(),r}removePopup(t){this._popupMap.delete(t)&&this._update()}removeAll(){this._popupMap.clear(),this._update()}}const v6=s.createContext({current:void 0}),A1=8;function g6(e){const{position:n,width:t,height:r,containerHeight:o,containerWidth:i,direction:l="vertical",noPushMinimumGap:c=!1}=e,C=c?-1/0:A1,p=c?1/0:o-r-A1,b=c?-1/0:A1,d=c?1/0:i-t-A1;if(l==="vertical"||l.indexOf("top")===0||l.indexOf("bottom")===0){const{left:A,top:R,right:k,bottom:M}=n,$=l==="vertical"&&M>p||l.indexOf("top")>-1?{top:Math.max(R-r,C)}:{top:Math.min(M,p)};let D;if(l.includes("center")){const W=(k-A-t)/2;D=Math.max(A+W,b)+t>i?{left:Math.max(Math.min(d,k-t-W),b)}:{left:Math.max(b,Math.min(A+W,d))}}else l.includes("right")?D={left:Math.max(k-t,b)}:l.includes("left")?D={left:Math.min(A,d)}:D=A+t>i?Math.max(k-t,b)<A1?{left:Math.min(A,d)}:{left:Math.max(k-t,b)}:{left:Math.min(A,d)};return{...$,...D}}const{left:w,top:I,right:_,bottom:T}=n,O=l.includes("left")?{left:Math.max(w-t,b)}:{left:Math.min(_,d)};let S;if(l.includes("center")){const R=(T-I-r)/2;S=Math.max(I+R,C)+r>o?{top:Math.max(Math.min(p,T-r-R),C)}:{top:Math.max(C,Math.min(I+R,p))}}else l.includes("top")?S={top:Math.min(I,p)}:l.includes("bottom")?S={top:Math.max(T-r,C)}:S=I+r>o?Math.max(T-r,C)<A1?{top:Math.min(I,p)}:{top:Math.max(T-r,C)}:{top:Math.min(I,p)};return{...S,...O}}function ve(e){var J;const{mask:n,portal:t,children:r,anchorRect$:o,direction:i="vertical",onClickOutside:l,excludeOutside:c,excludeRects:C,onPointerEnter:p,onPointerLeave:b,onClick:d,hidden:w,onContextMenu:I,zIndex:_=1020,maskZIndex:T=100,onMaskClick:O,noPushMinimumGap:S,autoRelayout:A=!0}=e,R=s.useRef(null),k=R1(l!=null?l:(()=>{})),M=R1(I!=null?I:(()=>{})),$=s.useRef({top:-9999,left:-9999}),D=C,U=V.useDependency(f.IConfigService),W=s.useRef(void 0),Y=U.getConfig(V1),q=(J=Y==null?void 0:Y.popupRootId)!=null?J:"univer-popup-portal",G=R1(X=>{requestAnimationFrame(()=>{if(!R.current)return;const{clientWidth:n1,clientHeight:s1}=R.current,d1=window.innerWidth,b1=window.innerHeight;$.current=g6({position:X,width:n1,height:s1,containerWidth:d1,containerHeight:b1,direction:i,noPushMinimumGap:S}),R.current.style.top=`${$.current.top}px`,R.current.style.left=`${$.current.left}px`})});s.useEffect(()=>{let X;return R.current&&(X=new ResizeObserver(()=>{A&&W.current&&G(W.current)}),X.observe(R.current)),()=>{X==null||X.disconnect()}},[R.current,A]),s.useEffect(()=>{const X=o.subscribe(n1=>{W.current=n1,G(n1)});return()=>X.unsubscribe()},[o,i]),s.useEffect(()=>{const X=n1=>{var l1;if(c&&(c.indexOf(n1.target)>-1||c.some(K=>K.contains(n1.target))))return;const s1=n1.clientX,d1=n1.clientY,b1=[...(l1=D==null?void 0:D.current)!=null?l1:[]];W.current&&b1.push(W.current);for(const K of b1)if(s1<=K.right&&s1>=K.left&&d1<=K.bottom&&d1>=K.top)return;k(n1)};return window.addEventListener("pointerdown",X),()=>{window.removeEventListener("pointerdown",X)}},[k,c,D]),s.useEffect(()=>{const X=n1=>{n1.ctrlKey&&n1.button===0||M()};return window.addEventListener("contextmenu",X),()=>{window.removeEventListener("contextmenu",X)}},[M]);const t1=v.jsxs(v.Fragment,{children:[n&&v.jsx("div",{"data-u-comp":"rect-popup-mask",className:"univer-fixed univer-bottom-0 univer-left-0 univer-right-0 univer-top-0 univer-z-[100]",style:{zIndex:T},onClick:O}),v.jsx("section",{"data-u-comp":"rect-popup",ref:R,className:x.clsx("univer-pointer-events-auto univer-fixed univer-left-[-9999px] univer-top-[-9999px] univer-z-[1020]",{"univer-hidden":w,"univer-animate-in univer-fade-in-70":!w}),style:{...$.current,zIndex:_},onPointerDown:X=>X.stopPropagation(),onClick:d,onPointerEnter:p,onPointerLeave:b,children:v.jsx(v6.Provider,{value:W,children:r})})]});return t?document.getElementById(q)?S3.createPortal(t1,document.getElementById(q)):null:t1}ve.calcPopupPosition=g6,ve.useContext=()=>s.useContext(v6);const p6=({popup:e,children:n})=>{const[t,r]=s.useState(!1),o=s.useMemo(()=>e.anchorRect$.pipe(B.throttleTime(0,B.animationFrameScheduler),B.map(d=>{var A;const{bottom:w,left:I,right:_,top:T}=d,[O=0,S=0]=(A=e.offset)!=null?A:[];return{left:I-O,right:_+O,top:T-S,bottom:w+S}})),[e.anchorRect$,e.offset]),i=s.useMemo(()=>{var d,w;return(w=(d=e.hiddenRects$)==null?void 0:d.pipe(B.throttleTime(0,B.animationFrameScheduler)))!=null?w:B.of([])},[e.hiddenRects$]),l=s.useMemo(()=>{var d;return(d=e.excludeRects$)==null?void 0:d.pipe(B.throttleTime(0,B.animationFrameScheduler))},[e.excludeRects$]),c=V9(l,e.excludeRects),{canvasElement:C,hideOnInvisible:p=!0,hiddenType:b="destroy"}=e;return s.useEffect(()=>{if(!p)return;const d=B.combineLatest([o,i]).subscribe(([w,I])=>{const _=C.getBoundingClientRect(),{top:T,left:O,bottom:S,right:A}=_,R=w.bottom-w.top,k=w.right-w.left,M=I.some($=>w.top>=$.top-.5*R&&w.bottom<=$.bottom+.5*R&&w.left>=$.left-.5*k&&w.right<=$.right+.5*k);w.bottom<T||w.top>S||w.right<O||w.left>A||M?r(!0):r(!1)});return()=>d.unsubscribe()},[C,p,o,i]),t&&b==="destroy"?null:v.jsx(ve,{...e,hidden:t,anchorRect$:o,direction:e.direction,onClickOutside:e.onClickOutside,excludeOutside:e.excludeOutside,excludeRects:c,...e.customActive?null:{onPointerEnter:()=>{var d;return(d=e.onActiveChange)==null?void 0:d.call(e,!0)},onPointerLeave:()=>{var d;return(d=e.onActiveChange)==null?void 0:d.call(e,!1)}},onClick:e.onClick,onContextMenu:e.onContextMenu,children:n})};function We(){const e=V.useDependency(Ce),n=V.useDependency(v1);return V.useObservable(e.popups$,void 0,!0).map(r=>{const[o,i]=r,l=n.get(i.componentKey);return v.jsx(p6,{popup:i,children:l?v.jsx(l,{popup:i}):null},o)})}function p1(e){const{components:n,fallback:t,sharedProps:r}=e;return!n||n.size===0?t!=null?t:null:Array.from(n.values()).map((o,i)=>{var l;return s.createElement(o,{key:`${(l=o.displayName)!=null?l:i}`,...r})})}function m1(e,n){var c;const t=(c=n==null?void 0:n.get(w1))!=null?c:V.useDependency(w1),r=s.useMemo(()=>t.uiVisibleChange$.pipe(B.filter(C=>C.ui===e)),[e,t]),o=V.useObservable(r),i=s.useRef(0),l=V.useObservable(()=>t.componentRegistered$.pipe(B.filter(C=>C===e),B.debounceTime(200),B.map(()=>i.current+=1),B.startWith(i.current+=1)),void 0,void 0,[t,e,o]);return s.useMemo(()=>t.isUIVisible(e)?t.getComponents(e):new Set,[l])}function f4({ribbon:e,activatedTab:n,onSelectTab:t}){const r=V.useDependency(f.LocaleService);return v.jsx("div",{className:"univer-flex univer-h-full univer-w-full univer-items-center univer-justify-center univer-gap-1 univer-overflow-x-auto univer-rounded-md univer-bg-gray-50 univer-px-3 dark:!univer-bg-gray-900",role:"tablist","aria-label":r.t("ribbon.menu"),children:e.map(o=>{const i=n===o.key;return v.jsx("button",{type:"button",role:"tab","aria-selected":i,title:r.t(o.key),onClick:()=>t(o),className:x.clsx("univer-focus:outline-none univer-focus:ring-2 univer-focus:ring-primary-500 dark:!univer-focus:ring-primary-300 univer-flex univer-cursor-pointer univer-appearance-none univer-items-center univer-gap-1 univer-rounded-sm univer-border-none univer-px-2 univer-py-1 univer-text-sm univer-transition-colors",i?`
                              univer-bg-primary-50 univer-font-semibold univer-text-primary-600 univer-shadow-sm
                              dark:!univer-bg-primary-900 dark:!univer-text-primary-300
                            `:`
                              univer-hover:bg-gray-100
                              dark:!univer-hover:bg-gray-700
                              univer-bg-transparent univer-text-gray-700
                              dark:!univer-text-gray-200
                            `),children:r.t(o.key)},o.key)})})}const h4={[h1.START]:lt,[h1.INSERT]:dt,[h1.FORMULAS]:Re,[h1.DATA]:z3,[h1.VIEW]:q3,[h1.OTHERS]:Ve};function C4({ribbon:e,activatedTab:n,onSelectTab:t}){const r=V.useDependency(f.LocaleService),[o,i]=s.useState(!1);function l(c){t(c),i(!1)}return v.jsx(x.HoverCard,{className:"univer-max-w-96 !univer-rounded-xl",align:"start",open:o,overlay:v.jsx("div",{className:"univer-grid univer-gap-1 univer-px-2 univer-py-1",children:e.map(c=>{const C=h4[c.key];return v.jsxs("a",{"data-u-comp":"ribbon-group-btn",className:"univer-box-border univer-flex univer-cursor-pointer univer-items-center univer-gap-2.5 univer-rounded-lg univer-px-2 univer-py-1.5 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",role:"button",onClick:()=>l(c),children:[v.jsx("span",{className:x.clsx("univer-box-border univer-flex univer-size-9 univer-flex-shrink-0 univer-items-center univer-justify-center univer-rounded-lg",x.borderClassName),children:v.jsx(C,{className:"univer-text-gray-500 dark:!univer-text-gray-300"})}),v.jsxs("span",{className:"univer-flex univer-flex-col",children:[v.jsx("strong",{className:"univer-text-sm univer-font-semibold univer-text-gray-800 dark:!univer-text-gray-200",children:r.t(c.key)}),v.jsx("span",{className:"univer-text-xs univer-text-gray-400",children:r.t(`${c.key}Desc`)})]})]},c.key)})}),onOpenChange:i,children:v.jsxs("a",{className:"univer-mr-2 univer-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1.5 univer-whitespace-nowrap !univer-rounded-full univer-bg-gray-700 univer-pl-3 univer-pr-2 univer-text-sm univer-text-white dark:!univer-bg-gray-200 dark:!univer-text-gray-800",onClick:()=>i(!0),children:[r.t(n),v.jsx(z1,{className:"univer-text-gray-200 dark:!univer-text-gray-500"})]})})}const m6=`
univer-box-border univer-flex univer-h-6 univer-min-w-6 univer-cursor-pointer univer-items-center
univer-justify-center univer-rounded univer-border-none univer-bg-transparent univer-p-0
univer-text-gray-900 univer-outline-none univer-transition-colors univer-animate-in univer-fade-in
dark:!univer-text-white dark:hover:!univer-bg-gray-700 dark:disabled:!univer-text-gray-600
disabled:univer-cursor-not-allowed disabled:univer-text-gray-300 disabled:hover:univer-bg-transparent
hover:univer-bg-gray-100 whitespace-nowrap univer-w-max
`;function b6(e){const{children:n,className:t,style:r,disabled:o=!1,active:i=!1,noIcon:l,onClick:c,onDoubleClick:C,...p}=e,b=w=>{if(o){w.preventDefault();return}c&&c(w)},d=w=>{if(o){w.preventDefault();return}C&&C(w)};return v.jsx("button",{type:"button",className:x.clsx(m6,{"univer-px-2":l,"!univer-bg-gray-200 dark:!univer-bg-gray-500":i}),style:r,disabled:o,onClick:b,onDoubleClick:d,...p,children:n})}function L6(e){const{disabled$:n,hidden$:t,activated$:r,value$:o}=e,[i,l]=s.useState(),[c,C]=s.useState(!1),[p,b]=s.useState(!1),[d,w]=s.useState(!1);return s.useEffect(()=>{const I=[];return n&&I.push(n.subscribe(_=>C(_))),t&&I.push(t.subscribe(_=>w(_))),r&&I.push(r.subscribe(_=>b(_))),o&&I.push(o.subscribe(_=>l(_))),()=>I.forEach(_=>_.unsubscribe())},[r,n,t,o]),{disabled:c,value:i,activated:p,hidden:d}}const Ge=s.createContext({dropdownVisible:!1,setDropdownVisible:e=>{}}),v4=s.forwardRef((e,n)=>{const{children:t,...r}=e,o=s.useRef(null),[i,l]=s.useState(!1),[c,C]=s.useState(!1);function p(w){l(c?!1:w)}function b(w){C(w),l(!1)}const d=s.useMemo(()=>({dropdownVisible:c,setDropdownVisible:b}),[c]);return s.useImperativeHandle(n,()=>({el:o.current})),r.title?v.jsx(x.Tooltip,{visible:i,onVisibleChange:p,...r,children:v.jsx("span",{ref:o,children:v.jsx(Ge.Provider,{value:d,children:t})})}):v.jsx("span",{ref:o,children:t})});function g4(e){const{children:n,overlay:t,disabled:r,align:o="start"}=e,{dropdownVisible:i,setDropdownVisible:l}=s.useContext(Ge);function c(C){l(C)}return v.jsx(x.Dropdown,{align:o,overlay:v.jsx("div",{className:"univer-grid univer-gap-2",children:t}),disabled:r,open:i,onOpenChange:c,children:v.jsx("div",{className:"univer-h-full",onClick:C=>C.stopPropagation(),children:n})})}function ge({icon:e,value:n,option:t,onOptionSelect:r}){var l;const o=c=>{r==null||r({value:c,label:t==null?void 0:t.label,commandId:t==null?void 0:t.commandId})},i=typeof t.label=="string"||typeof t.label=="object"&&((l=t.label)==null?void 0:l.selectable)!==!1;return v.jsxs("div",{className:x.clsx("univer-relative univer-flex univer-items-center univer-gap-2",{"univer-pl-6":i}),children:[i&&String(n)===String(t.value)&&v.jsx(De,{className:"univer-absolute univer-left-1 univer-top-0.5 univer-text-primary-600"}),v.jsx(f1,{className:"univer-text-sm",icon:e,value$:t.value$,value:t.value,label:t.label,onChange:o})]})}function w6({menuId:e,slot:n,value:t,options:r,children:o,disabled:i,onOptionSelect:l}){var T;const{dropdownVisible:c,setDropdownVisible:C}=s.useContext(Ge),p=V.useDependency(I1),[b,d]=s.useState({}),w=s.useMemo(()=>e?p.getMenuByPositionKey(e):[],[e]),I=s.useMemo(()=>w.filter(O=>{var A;if(!O.children)return!b[O.key];const S=((A=O.key)==null?void 0:A.toString())||"";return!b[S]}),[w,b]);function _(O){C(O)}if(s.useEffect(()=>{const O=[];return w.forEach(S=>{var A;if(S.children){const R=S.children.map(M=>{var $,D;return(D=($=M.item)==null?void 0:$.hidden$)!=null?D:B.of(!1)}),k=B.combineLatest(R).subscribe(M=>{const $=M.every(D=>D===!0);d(D=>({...D,[S.key]:$}))});O.push(k)}else if((A=S.item)!=null&&A.hidden$){const R=S.item.hidden$.subscribe(k=>{d(M=>({...M,[S.key]:k}))});O.push(R)}}),()=>{O.forEach(S=>S==null?void 0:S.unsubscribe()),d({})}},[w]),n)return v.jsx(g4,{disabled:i,overlay:r.map((O,S)=>v.jsx(ge,{value:t,option:O,onOptionSelect:l},S)),children:o});if(r!=null&&r.length){const O=r.map(S=>{var A;return{type:"item",className:x.clsx({"focus:univer-bg-white":typeof S.label!="string"&&((A=S.label)==null?void 0:A.hoverable)===!1}),children:v.jsx(ge,{icon:S.icon,value:t,option:S,onOptionSelect:l}),disabled:S.disabled,onSelect:()=>{typeof S.value>"u"||l==null||l({...S})}}});for(const S of I){if(!S.item)continue;const{title:A,id:R,commandId:k,icon:M}=S.item;if(!A)throw new Error("Menu item title is required");O.push({type:"item",children:v.jsx(ge,{icon:M,value:t,option:{label:{name:A,selectable:!1}}}),onSelect:()=>{l==null||l({commandId:k,id:R})}})}return v.jsx(x.DropdownMenu,{align:"start",items:O,disabled:i,open:c,onOpenChange:_,children:o})}else{const O=[];for(const S of I)if(S.item){const{title:A,id:R,commandId:k,icon:M}=S.item;if(!A)throw new Error("Menu item title is required");O.push({type:"item",children:v.jsx(ge,{icon:M,value:t,option:{label:{name:A,selectable:!1}}}),onSelect:()=>{l==null||l({commandId:k,id:R})}})}else(T=S.children)!=null&&T.length;return v.jsx(x.DropdownMenu,{align:"start",items:O,disabled:i,open:c,onOpenChange:_,children:o})}}const Q1=s.forwardRef((e,n)=>{const t=V.useDependency(f.LocaleService),r=V.useDependency(f.ICommandService),o=V.useDependency(M1),i=V.useDependency(v1),{value:l,hidden:c,disabled:C,activated:p}=L6(e),b=(J,X)=>{o.focus(),r.executeCommand(J,X)},{tooltip:d,shortcut:w,icon:I,title:_,label:T,id:O,commandId:S,type:A,slot:R,params:k}=e,M=t.t(d!=null?d:"")+(w?` (${w})`:""),{selections:$}=e,D=s.useMemo(()=>B.isObservable($)?$:new B.Observable(J=>{J.next($)}),[$]),U=V.useObservable(D),W=s.useMemo(()=>B.isObservable(I)?I:new B.Observable(J=>{var n1,s1;const X=(s1=(n1=U==null?void 0:U.find(d1=>d1.value===l))==null?void 0:n1.icon)!=null?s1:I;J.next(X)}),[I,U,l]),Y=V.useObservable(W,void 0,!0);function q(J){var K;const X=e.selectionsCommandId,n1=S!=null?S:O,s1=(K=X!=null?X:S)!=null?K:O;function d1(c1){if(C)return;let L1=s1;c1.id&&(L1=c1.id),b(L1,{value:c1.value})}function b1(c1){C||b(s1,{value:c1})}function l1(){C||J===g1.BUTTON_SELECTOR&&b(n1,{value:l})}return J===g1.BUTTON_SELECTOR?v.jsxs("div",{"data-u-command":O,"data-disabled":C,className:x.clsx("univer-animate-in univer-fade-in univer-group univer-relative univer-flex univer-h-6 univer-cursor-pointer univer-items-center univer-rounded univer-pr-5 univer-text-sm univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",{"univer-text-gray-900 dark:!univer-text-white":!C,"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":C}),children:[v.jsx("div",{className:x.clsx("univer-relative univer-z-[1] univer-flex univer-h-full univer-items-center univer-rounded-l univer-px-1 univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600",{"univer-bg-gray-200 dark:!univer-bg-gray-500":p,"univer-bg-gray-100":p&&C}),onClick:l1,children:v.jsx(f1,{icon:Y,title:_,value:l,label:T,onChange:b1})}),v.jsx(w6,{menuId:O,slot:R,value:l,options:U,disabled:C,onOptionSelect:d1,children:v.jsx("div",{className:x.clsx("univer-absolute univer-right-0 univer-top-0 univer-box-border univer-flex univer-h-6 univer-w-5 univer-items-center univer-justify-center univer-rounded-r univer-transition-colors hover:univer-bg-gray-200 dark:hover:!univer-bg-gray-600",{"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":C,"univer-bg-gray-200 dark:!univer-bg-gray-500":p,"univer-bg-gray-100":p&&C}),"data-disabled":C,children:v.jsx(z1,{})})})]}):v.jsx(w6,{menuId:O,slot:R,value:l,options:U,disabled:C,onOptionSelect:d1,children:v.jsxs("div",{"data-u-command":O,className:x.clsx("univer-animate-in univer-fade-in univer-relative univer-flex univer-h-6 univer-cursor-pointer univer-items-center univer-gap-2 univer-whitespace-nowrap univer-rounded univer-px-1 univer-transition-colors hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",{"univer-text-gray-900 dark:!univer-text-white":!C,"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":C,"univer-bg-gray-200":p,"univer-bg-gray-100":p&&C}),children:[v.jsx(f1,{icon:Y,title:_,value:l,label:T,onChange:b1}),v.jsx("div",{className:x.clsx("univer-flex univer-h-full univer-items-center",{"univer-pointer-events-none univer-cursor-not-allowed univer-text-gray-300 dark:!univer-text-gray-600":C}),children:v.jsx(z1,{})})]})})}function G(){var n1;const J=i.get(typeof T=="string"?T:(n1=T==null?void 0:T.name)!=null?n1:""),X=(l!=null?l:typeof k=="function")?k():k;return v.jsx(b6,{"data-u-command":O,className:"univer-text-sm",noIcon:!I,active:p,disabled:C,onClick:()=>{var s1;return b((s1=e.commandId)!=null?s1:e.id,X)},onDoubleClick:()=>e.subId&&b(e.subId),children:J?v.jsx(f1,{title:_,value:l,label:T}):I?v.jsx(f1,{icon:I}):v.jsx(f1,{title:_})})}function t1(){switch(A){case g1.BUTTON_SELECTOR:case g1.SELECTOR:case g1.SUBITEMS:return q(A);case g1.BUTTON:default:return G()}}return!c&&v.jsx(v4,{ref:n,title:M,placement:"bottom",children:t1()})});function y6(e){const{ribbonType:n,headerMenuComponents:t,headerMenu:r=!0}=e,o=V.useDependency(I1),i=V.useDependency(f.IUniverInstanceService),l=V.useDependency(f.LocaleService),[c,C]=s.useState(0),p=V.useObservable(i.focused$);s.useEffect(()=>{const D=o.menuChanged$.subscribe(()=>{C(U=>U+1)});return()=>{D.unsubscribe()}},[]);const b=s.useRef(null),d=s.useRef({}),[w,I]=s.useState([]),[_,T]=s.useState(h1.START),[O,S]=s.useState([]),[A,R]=s.useState(!1),k=s.useCallback(D=>{d.current={},T(D.key)},[]);s.useEffect(()=>{var Y;const D=o.getMenuByPositionKey(G1.RIBBON),U=[],W=[];for(const q of D)if(q.children){for(const G of q.children)if(G.children)for(const t1 of G.children)(Y=t1.item)!=null&&Y.hidden$&&(U.push(t1.item.hidden$),W.push(`${q.key}/${G.key}/${t1.key}`))}B.combineLatest(U).subscribe(q=>{var J,X,n1,s1,d1,b1;const G=[],t1=q.map((l1,K)=>l1?W[K]:null).filter(l1=>!!l1);for(const l1 of D){const K={...l1,children:[]};if((J=l1.children)!=null&&J.length)for(const c1 of l1.children){const L1={...c1,children:[]};let T1=!0;if((X=c1.children)!=null&&X.length){for(const F1 of c1.children){const k1=`${l1.key}/${c1.key}/${F1.key}`;t1.includes(k1)||(n1=L1.children)==null||n1.push(F1)}(s1=L1.children)!=null&&s1.every(F1=>{var k1;return((k1=F1.children)==null?void 0:k1.length)===0})&&(T1=!1)}T1&&((d1=K.children)==null||d1.push(L1))}(b1=K.children)!=null&&b1.length&&K.children.every(c1=>{var L1;return(L1=c1.children)==null?void 0:L1.length})&&G.push(K)}if(n==="simple"){const l1=[{key:h1.START,children:[],order:0}];G.forEach(K=>{var c1;(c1=K.children)==null||c1.forEach(L1=>{var T1;(T1=l1[0].children)==null||T1.push(L1)})}),I(l1)}else I(G)}).unsubscribe()},[c,p]);const M=s.useMemo(()=>{var Y,q;const D=(q=(Y=w.find(G=>G.key===_))==null?void 0:Y.children)!=null?q:[],U=[],W=[];for(const G of D)if(G.children){const t1=G.children.filter(J=>!O.includes(J.key));t1.length>0&&U.push({...G,children:t1}),t1.length<G.children.length&&W.push({...G,children:G.children.filter(J=>O.includes(J.key))})}return{allGroups:D,visibleGroups:U,hiddenGroups:W}},[O,w,_]);s.useEffect(()=>{let D=null;const U=new ResizeObserver(f.throttle(W=>{for(const Y of W)R(!0),D=requestAnimationFrame(()=>{var d1,b1;const{width:q}=Y.contentRect,t1=Object.values(d.current).sort((l1,K)=>l1.order-K.order||l1.groupOrder-K.groupOrder||l1.itemOrder-K.itemOrder),J=[];let X=32;const s1=(((b1=(d1=w.find(l1=>l1.key===_))==null?void 0:d1.children)!=null?b1:[]).length-1)*8;X+=s1;for(const{el:l1,key:K}of t1){const{width:c1}=l1.getBoundingClientRect();X+=c1+8,X>q&&J.push(K)}S(J),R(!1)})},100));return U.observe(b.current),()=>{D&&cancelAnimationFrame(D),U.disconnect()}},[w,_]);const $=s.useMemo(()=>v.jsx("div",{"aria-hidden":"true",className:x.clsx("univer-invisible univer-absolute -univer-left-[99999] -univer-top-[99999] univer-box-border univer-flex univer-h-10 univer-min-w-min univer-items-center univer-px-3 univer-opacity-0",{"univer-hidden":!A},x.divideXClassName,x.borderBottomClassName),children:M.allGroups.map((D,U)=>{var W,Y;return(((W=D.children)==null?void 0:W.length)||D.item)&&v.jsx(s.Fragment,{children:v.jsx("div",{className:"univer-grid univer-shrink-0 univer-grid-flow-col univer-gap-2 univer-px-2",children:D.children&&((Y=D.children)==null?void 0:Y.map(q=>q.item&&v.jsx(Q1,{...q.item,ref:G=>{G!=null&&G.el&&(d.current[q.key]={el:G.el,key:q.key,order:U,groupOrder:D.order,itemOrder:q.order})}},q.key)))})},D.key)})}),[M.allGroups,A]);return v.jsxs(v.Fragment,{children:[v.jsxs("div",{"data-u-comp":"ribbon-header-menu",className:x.clsx("univer-relative univer-select-none",{"univer-h-9":n==="classic"||t&&t.size>0}),children:[n==="classic"&&w.length>1&&v.jsx(f4,{ribbon:w,activatedTab:_,onSelectTab:k}),r&&t&&t.size>0&&v.jsx("div",{className:"univer-absolute univer-right-2 univer-top-0 univer-flex univer-h-full univer-items-center univer-gap-2 [&>*]:univer-inline-flex [&>*]:univer-h-6 [&>*]:univer-items-center [&>*]:univer-rounded [&>*]:univer-px-1 [&>*]:univer-transition-colors hover:[&>*]:univer-bg-gray-100",children:v.jsx(p1,{components:t})})]}),v.jsxs("div",{className:x.clsx("univer-box-border univer-grid univer-h-10 univer-grid-flow-col univer-items-center univer-px-3",{"univer-grid-cols-[1fr] univer-justify-center":n==="classic","univer-grid-cols-[auto,1fr]":w.length>1&&n!=="classic","univer-grid-cols-none":w.length===1},x.borderBottomClassName),children:[n==="default"&&w.length>1&&v.jsx(C4,{ribbon:w,activatedTab:_,onSelectTab:k}),v.jsxs("div",{"data-u-comp":"ribbon-toolbar",ref:b,className:x.clsx("univer-flex univer-overflow-hidden",x.divideXClassName,{"univer-justify-center":n==="classic"}),role:"toolbar","aria-label":l.t(_),children:[M.visibleGroups.map(D=>{var U,W;return(((U=D.children)==null?void 0:U.length)||D.item)&&v.jsx(s.Fragment,{children:v.jsx("div",{className:"univer-grid univer-shrink-0 univer-grid-flow-col univer-gap-2 univer-px-2",children:D.children&&((W=D.children)==null?void 0:W.map(Y=>Y.item&&v.jsx(Q1,{...Y.item},Y.key)))})},D.key)}),O.length>0&&v.jsx("div",{"data-u-comp":"ribbon-toolbar-more",className:"univer-pl-2 rtl:univer-pr-2",children:v.jsx(x.Dropdown,{collisionPadding:{right:12,left:12},overlay:v.jsx("div",{className:"univer-box-border univer-grid univer-max-w-[var(--radix-popper-available-width)] univer-gap-2 univer-p-2",children:M.hiddenGroups.map(D=>{var U;return v.jsx("div",{className:"univer-flex univer-items-center univer-gap-2",children:v.jsx("div",{className:"univer-flex univer-flex-wrap univer-gap-2",children:D.children?(U=D.children)==null?void 0:U.map(W=>W.item&&v.jsx(Q1,{...W.item},W.key)):D.item&&v.jsx(Q1,{...D.item},D.key)})},D.key)})}),children:v.jsx("button",{type:"button",className:m6,"aria-label":l.t("ribbon.more"),"aria-haspopup":"true",children:v.jsx(Ve,{})})})})]})]}),$]})}class K1 extends f.Disposable{constructor(){super(...arguments);j(this,"_styleSheetId","univer-theme-css-variables")}injectThemeToHead(t){function r(c,C="--univer"){const p=[];function b(d,w=""){for(const I in d){const _=d[I],T=w?`${w}-${I}`:I;typeof _=="object"&&_!==null?b(_,T):p.push(`${C}-${T}: ${_};`)}}return b(c),p.join(`
`)}const o=r(t),i=document.getElementById(this._styleSheetId);i&&i.remove();const l=document.createElement("style");l.setAttribute("id",this._styleSheetId),l.innerHTML=`:root {
${o}
}`,document.head.appendChild(l)}dispose(){super.dispose()}}const ee=f.createIdentifier("ui.contextmenu.service");class Ye extends f.Disposable{constructor(){super(...arguments);j(this,"_currentHandler",null);j(this,"disabled",!1)}get visible(){var t,r;return(r=(t=this._currentHandler)==null?void 0:t.visible)!=null?r:!1}disable(){this.disabled=!0}enable(){this.disabled=!1}triggerContextMenu(t,r){var o;t.stopPropagation(),!this.disabled&&((o=this._currentHandler)==null||o.handleContextMenu(t,r))}hideContextMenu(){var t;(t=this._currentHandler)==null||t.hideContextMenu()}registerContextMenuHandler(t){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=t,f.toDisposable(()=>this._currentHandler=null)}}function I6(){const e=s.useRef(null),[n,t]=s.useState(!1),[r,o]=s.useState(""),[i,l]=s.useState([0,0]),c=s.useRef(n),C=V.useDependency(ee),p=V.useDependency(f.ICommandService),b=V.useInjector();c.current=n,s.useEffect(()=>{const I=C.registerContextMenuHandler({handleContextMenu:d,hideContextMenu(){t(!1)},get visible(){return c.current}});function _(T){e.current&&!e.current.contains(T.target)&&w()}return document.addEventListener("pointerdown",_),document.addEventListener("wheel",w),()=>{document.removeEventListener("pointerdown",_),document.removeEventListener("wheel",w),I.dispose()}},[C]);function d(I,_){t(!1),requestAnimationFrame(()=>{o(_),l([I.clientX,I.clientY]),t(!0)})}function w(){t(!1)}return v.jsx(x.Popup,{visible:n,offset:i,children:v.jsx("section",{ref:e,children:r&&v.jsx(Ae,{menuType:r,onOptionSelect:I=>{const{label:_,commandId:T,value:O}=I;p&&p.executeCommand(T!=null?T:_,{value:O}),b.get(M1).focus(),t(!1)}})})})}const pe=f.createIdentifier("univer.global-zone-service");function Xe(){const e=V.useDependency(pe),[n,t]=s.useState(!1),r=V.useObservable(e.componentKey$,e.componentKey),o=V.useDependency(v1),i=s.useMemo(()=>{const l=o.get(r!=null?r:"");if(l)return l},[r,o]);return s.useEffect(()=>{const l=e.visible$.subscribe(c=>{t(c)});return()=>{l.unsubscribe()}},[e.visible$]),n?v.jsx("section",{className:x.clsx("univer-absolute univer-bg-gray-100",{"univer-hidden":!n,"univer-inset-0 univer-z-[100] univer-block univer-size-full":n}),children:i&&v.jsx(i,{})}):null}function qe(){const e=V.useDependency(x1),n=V.useObservable(e.sidebarOptions$),t=s.useRef(null),r=s.useMemo(()=>{if(!n)return null;const l={...n};for(const c of["children","header","footer"]){const C=c;if(n[C]){const{key:p,...b}=n[C];b&&(l[C]=v.jsx(f1,{...b},p))}}return l},[n]);s.useEffect(()=>(t.current&&e.setContainer(t.current),()=>{e.setContainer(void 0)}),[e]),s.useEffect(()=>{const l=C=>{e.scrollEvent$.next(C)},c=t.current;return c&&c.addEventListener("scroll",l),()=>{c==null||c.removeEventListener("scroll",l)}},[e]);const o=s.useMemo(()=>r!=null&&r.visible?typeof r.width=="number"?`${r.width}px`:r.width:0,[r]);function i(){var c;const l={...n,visible:!1};e.options.visible=!1,e.sidebarOptions$.next(l),(c=l==null?void 0:l.onClose)==null||c.call(l)}return v.jsx("section",{"data-u-comp":"sidebar",className:x.clsx("univer-relative univer-h-full univer-bg-white univer-text-gray-900 dark:!univer-bg-gray-900 dark:!univer-text-white",{"univer-w-96 univer-translate-x-0":r==null?void 0:r.visible,"univer-w-0 univer-translate-x-full":!(r!=null&&r.visible)}),style:{width:o},children:v.jsxs("section",{ref:t,className:x.clsx("univer-box-border univer-grid univer-h-0 univer-min-h-full univer-grid-rows-[auto_1fr_auto] univer-overflow-y-auto",x.borderLeftBottomClassName,x.scrollbarClassName),children:[v.jsxs("header",{className:"univer-sticky univer-top-0 univer-z-10 univer-box-border univer-flex univer-items-center univer-justify-between univer-bg-white univer-p-4 univer-pb-2 univer-text-base univer-font-medium univer-text-gray-800 dark:!univer-bg-gray-900 dark:!univer-text-white",children:[r==null?void 0:r.header,v.jsx("a",{className:"univer-cursor-pointer univer-text-gray-500 dark:!univer-text-gray-300",onClick:i,children:v.jsx(Oe,{})})]}),v.jsx("section",{className:"univer-box-border univer-px-4",style:r==null?void 0:r.bodyStyle,children:r==null?void 0:r.children}),(r==null?void 0:r.footer)&&v.jsx("footer",{className:"univer-sticky univer-bottom-0 univer-box-border univer-bg-white univer-p-4 dark:!univer-bg-gray-900",children:r.footer})]})})}const me=f.createIdentifier("univer.zen-zone-service");function Je(){const e=V.useDependency(me),[n,t]=s.useState(!1),[r,o]=s.useState(),i=V.useObservable(e.temporaryHidden$),l=V.useDependency(v1);s.useEffect(()=>{const C=[e.visible$.subscribe(p=>{t(p)}),e.componentKey$.subscribe(p=>{o(p)})];return()=>{C.forEach(p=>{p.unsubscribe()})}},[]);const c=s.useMemo(()=>{const C=l.get(r!=null?r:"");if(C)return C},[r]);return v.jsx("section",{className:x.clsx("univer-absolute univer-z-[-1] univer-flex",{"univer-animate-in univer-fade-in univer-inset-0 univer-z-[100] univer-bg-gray-100":n,"univer-hidden":i}),children:v.jsx("div",{className:"univer-relative univer-flex-1",children:c&&v.jsx(c,{})})})}function p4(e){const n=A9(V1);return v.jsx(m4,{...e,...n})}function m4(e){var t1;const{header:n=!0,toolbar:t=!0,footer:r=!0,headerMenu:o=!0,contextMenu:i=!0,ribbonType:l="default",mountContainer:c,onRendered:C}=e,p=V.useDependency(f.LocaleService),b=V.useDependency(f.ThemeService),d=V.useDependency(K1),w=s.useRef(null),_=V.useDependency(f.IConfigService).getConfig(V1),T=m1(i1.CUSTOM_HEADER),O=m1(i1.FOOTER),S=m1(i1.HEADER),A=m1(i1.HEADER_MENU),R=m1(i1.CONTENT),k=m1(i1.LEFT_SIDEBAR),M=m1(i1.GLOBAL),$=m1(i1.TOOLBAR),D=(t1=_==null?void 0:_.popupRootId)!=null?t1:"univer-popup-portal";s.useLayoutEffect(()=>{const J=b.currentTheme$.subscribe(X=>{d.injectThemeToHead(X)});return()=>{J.unsubscribe()}},[]);const[U,W]=s.useState(!1);s.useLayoutEffect(()=>{const J=b.darkMode$.subscribe(X=>{W(X),X?document.documentElement.classList.add("univer-dark"):document.documentElement.classList.remove("univer-dark")});return()=>{J.unsubscribe()}},[]),s.useEffect(()=>{w.current&&(C==null||C(w.current))},[C]);const[Y,q]=s.useState(p.getLocales()),G=s.useMemo(()=>document.createElement("div"),[]);return s.useEffect(()=>{document.body.appendChild(G);const J=[p.localeChanged$.subscribe(()=>{q(p.getLocales())})];return()=>{J.forEach(X=>X.unsubscribe()),document.body.removeChild(G)}},[p,c,G]),v.jsxs(x.ConfigProvider,{locale:Y==null?void 0:Y.design,mountContainer:G,children:[v.jsxs("div",{"data-u-comp":"workbench-layout",className:x.clsx("univer-flex univer-h-full univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",{"univer-dark":U}),tabIndex:-1,onBlur:J=>J.stopPropagation(),onContextMenu:J=>J.preventDefault(),children:[v.jsx("div",{className:"univer-relative univer-flex univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",children:v.jsx(p1,{components:T},"custom-header")}),n&&t&&v.jsx("header",{"data-u-comp":"headerbar",className:"univer-relative univer-z-10 univer-w-full univer-overflow-hidden",children:v.jsx(p1,{components:$,sharedProps:{ribbonType:l,headerMenuComponents:A,headerMenu:o}},"toolbar")}),v.jsxs("section",{className:"univer-relative univer-flex univer-min-h-0 univer-flex-1 univer-flex-col",children:[v.jsxs("div",{className:"univer-grid univer-h-full univer-grid-cols-[auto_1fr_auto] univer-grid-rows-[100%] univer-overflow-hidden",children:[v.jsx("aside",{"data-u-comp":"left-sidebar",className:"univer-h-full",children:v.jsx(p1,{components:k},"left-sidebar")}),v.jsxs("section",{className:x.clsx("univer-relative univer-grid univer-flex-1 univer-grid-rows-[auto_1fr] univer-overflow-hidden univer-bg-white dark:!univer-bg-gray-800",x.borderBottomClassName),children:[v.jsx("header",{children:n&&v.jsx(p1,{components:S},"header")}),v.jsx("section",{className:"univer-relative univer-overflow-hidden dark:!univer-bg-gray-900",ref:w,"data-range-selector":!0,onContextMenu:J=>J.preventDefault(),children:v.jsx(p1,{components:R},"content")})]}),v.jsx("aside",{"data-u-comp":"right-sidebar",className:"univer-h-full",children:v.jsx(qe,{})})]}),r&&v.jsx("footer",{children:v.jsx(p1,{components:O,sharedProps:{contextMenu:i}},"footer")}),v.jsx(Je,{})]})]}),v.jsx(p1,{components:M},"global"),v.jsx(Xe,{}),i&&v.jsx(I6,{}),v.jsx(b4,{}),v.jsx("div",{id:D})]})}function b4(){const{mountContainer:e}=s.useContext(x.ConfigContext),n=m1(i1.FLOATING);return S3.createPortal(v.jsx(p1,{components:n},"floating"),e)}const L4=3e3;class Qe extends f.Disposable{constructor(t,r,o,i,l){super();j(this,"_steadyTimeout");j(this,"_renderTimeout");j(this,"_currentRenderId",null);this._injector=t,this._instanceService=r,this._layoutService=o,this._lifecycleService=i,this._renderManagerService=l}dispose(){super.dispose(),clearTimeout(this._steadyTimeout),clearTimeout(this._renderTimeout),delete this._instanceService,delete this._layoutService,delete this._lifecycleService,delete this._renderManagerService}_bootstrapWorkbench(){this.disposeWithMe(this.bootstrap(async(t,r)=>{this._layoutService&&(this.disposeWithMe(this._layoutService.registerRootContainerElement(r)),this.disposeWithMe(this._layoutService.registerContentElement(t)));try{await this._lifecycleService.onStage(f.LifecycleStages.Ready),this._renderTimeout=window.setTimeout(()=>{const o=this._renderManagerService.getRenderAll();for(const[i]of o)if(this._changeRenderUnit(i,t))break;this.disposeWithMe(this._instanceService.focused$.subscribe(i=>{i&&this._changeRenderUnit(i,t)})),this.disposeWithMe(this._renderManagerService.created$.subscribe(i=>{var l;i.unitId===((l=this._instanceService.getFocusedUnit())==null?void 0:l.getUnitId())&&this._changeRenderUnit(i.unitId,t)})),this.disposeWithMe(this._renderManagerService.disposed$.subscribe(i=>{this._currentRenderId===i&&(this._currentRenderId=null)})),this._lifecycleService.stage=f.LifecycleStages.Rendered,this._steadyTimeout=window.setTimeout(()=>{this._lifecycleService.stage=f.LifecycleStages.Steady},L4)},300)}catch(o){if(o instanceof f.LifecycleUnreachableError)return;throw o}}))}_changeRenderUnit(t,r){if(this._currentRenderId===t)return!1;const o=this._renderManagerService.getRenderById(t);if(!o||!o.unitId||f.isInternalEditorID(o.unitId))return!1;const i=this._currentRenderId?this._renderManagerService.getRenderById(this._currentRenderId):null;return i==null||i.deactivate(),i==null||i.engine.unmount(),o.engine.mount(r),o.activate(),this._currentRenderId=t,!0}}var w4=Object.getOwnPropertyDescriptor,y4=(e,n,t,r)=>{for(var o=r>1?void 0:r?w4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},E1=(e,n)=>(t,r)=>n(t,r,e);h.DesktopUIController=class extends Qe{constructor(n,t,r,o,i,l,c,C,p){super(t,l,i,r,o),this._config=n,this._componentManager=p,c.mergeMenu(r6),this._initBuiltinComponents(C),this._registerComponents(),this._bootstrapWorkbench()}_registerComponents(){[[T9,N9],[$9,x9],[U9,F9],[j9,B9],[W9,z9],[P9,x.ColorPicker]].forEach(([n,t])=>{this.disposeWithMe(this._componentManager.register(n,t))})}dispose(){super.dispose(),this._componentManager.dispose()}bootstrap(n){return I4(this._injector,this._config,n)}_initBuiltinComponents(n){this.disposeWithMe(n.registerComponent(i1.FLOATING,()=>V.connectInjector(We,this._injector))),this.disposeWithMe(n.registerComponent(i1.CONTENT,()=>V.connectInjector(je,this._injector))),this.disposeWithMe(n.registerComponent(i1.TOOLBAR,()=>V.connectInjector(y6,this._injector)))}},h.DesktopUIController=y4([E1(1,f.Inject(f.Injector)),E1(2,f.Inject(f.LifecycleService)),E1(3,U1.IRenderManagerService),E1(4,M1),E1(5,f.IUniverInstanceService),E1(6,I1),E1(7,w1),E1(8,f.Inject(v1))],h.DesktopUIController);function I4(e,n,t){let r;const o=n.container;if(typeof o=="string"){const C=document.getElementById(o);C?r=C:r=M6(o)}else o instanceof HTMLElement?r=o:r=M6("univer");const i=V.connectInjector(p4,e),l=C=>t(C,r);function c(){x.render(v.jsx(i,{...n,mountContainer:r,onRendered:l}),r)}return c(),f.toDisposable(()=>{x.render(v.jsx("div",{}),r),setTimeout(()=>x.render(v.jsx("div",{}),r),200),setTimeout(()=>x.unmount(r),500)})}function M6(e){const n=document.createElement("div");return n.id=e,n}const te=f.createIdentifier("univer.ui.ui-controller");function M4(e){const{menuType:n,onOptionSelect:t}=e,r=V.useDependency(I1);if(!n)return null;const o=s.useMemo(()=>{const i=r.getMenuByPositionKey(n);function l(c){return c.reduce((C,p)=>p.children?[...C,...l(p.children)]:[...C,p],[])}return l(i)},[n]);return v.jsx("div",{className:"univer-box-border univer-grid univer-min-w-8 univer-max-w-52 univer-gap-1 univer-rounded univer-bg-gray-900 univer-px-2 univer-py-1",style:{gridTemplateColumns:`repeat(${Math.min(2,o.length)},  72px)`},children:o.map(i=>i.item&&v.jsx(_4,{menuItem:i.item,onClick:l=>t==null?void 0:t({value:"",label:i.key,...l})},i.key))})}function _4(e){const{menuItem:n,onClick:t}=e,{id:r,type:o,title:i,label:l,icon:c}=n;if(o!==g1.BUTTON)throw new Error(`[MobileMenuItem]: on mobile devices only "BUTTON" type menu items are supported. Please check "${r}".`);const C=V.useObservable(n.disabled$,!1),p=V.useObservable(n.value$);return v.jsx("button",{type:"button",className:x.clsx("univer-w-18 univer-flex univer-flex-col univer-items-center univer-justify-center univer-border-none univer-bg-transparent univer-text-white [&>span]:univer-mt-0.5 [&>span]:univer-w-full [&>span]:univer-truncate [&>span]:univer-text-sm [&>svg]:univer-size-[18px] [&>svg]:univer-text-lg"),disabled:C,onClick:()=>t({id:r}),children:v.jsx(f1,{value:p,title:i,label:l,icon:c})},r)}function _6(){const[e,n]=s.useState(!1),[t,r]=s.useState(""),[o,i]=s.useState([0,0]),l=s.useRef(e),c=V.useDependency(ee),C=V.useDependency(f.ICommandService);l.current=e,s.useEffect(()=>{const d=c.registerContextMenuHandler({handleContextMenu:p,hideContextMenu(){n(!1)},get visible(){return l.current}});return document.addEventListener("pointerdown",b),document.addEventListener("wheel",b),()=>{document.removeEventListener("pointerdown",b),document.removeEventListener("wheel",b),d.dispose()}},[c]);function p(d,w){r(w),i([d.clientX,d.clientY]),n(!0)}function b(){n(!1)}return v.jsx(x.Popup,{visible:e,offset:o,children:v.jsx("section",{onPointerDown:d=>d.stopPropagation(),children:t&&v.jsx(M4,{menuType:t,onOptionSelect:d=>{const{label:w,value:I,commandId:_}=d;C&&C.executeCommand(_!=null?_:w,{value:I}),n(!1)}})})})}function S4(e){const{header:n=!0,footer:t=!0,contextMenu:r=!0,mountContainer:o,onRendered:i}=e,l=V.useDependency(f.LocaleService),c=V.useDependency(f.ThemeService),C=V.useDependency(K1),p=s.useRef(null),b=m1(i1.FOOTER),d=m1(i1.HEADER),w=m1(i1.CONTENT),I=m1(i1.LEFT_SIDEBAR),_=m1(i1.GLOBAL),[T,O]=s.useState(!1);s.useEffect(()=>{const k=c.darkMode$.subscribe(M=>{O(M)});return()=>{k.unsubscribe()}},[]),s.useEffect(()=>{p.current&&(i==null||i(p.current))},[i]);const[S,A]=s.useState(l.getLocales()),R=s.useMemo(()=>document.createElement("div"),[]);return s.useLayoutEffect(()=>{const k=c.currentTheme$.subscribe(M=>{C.injectThemeToHead(M)});return()=>{k.unsubscribe()}},[]),s.useEffect(()=>{document.body.appendChild(R);const k=[l.localeChanged$.subscribe(()=>{A(l.getLocales())})];return()=>{k.forEach(M=>M.unsubscribe()),document.body.removeChild(R)}},[l,o,R]),v.jsxs(x.ConfigProvider,{locale:S==null?void 0:S.design,mountContainer:R,children:[v.jsxs("div",{"data-u-comp":"app-layout",className:x.clsx("univer-relative univer-flex univer-h-full univer-min-h-0 univer-flex-col univer-bg-white dark:!univer-bg-gray-800",{"univer-dark":T}),tabIndex:-1,onBlur:k=>k.stopPropagation(),children:[n&&v.jsx("header",{className:"univer-relative univer-z-10 univer-w-full"}),v.jsxs("section",{className:"univer-relative univer-flex univer-min-h-0 univer-flex-1 univer-flex-col",children:[v.jsxs("div",{className:"univer-grid univer-h-full univer-grid-cols-[auto_1fr_auto] univer-grid-rows-[100%] univer-overflow-hidden",children:[v.jsx("aside",{className:"univer-h-full",children:v.jsx(p1,{components:I},"left-sidebar")}),v.jsxs("section",{className:x.clsx("univer-relative univer-grid univer-flex-1 univer-grid-rows-[auto_1fr] univer-overflow-hidden univer-bg-white dark:!univer-bg-gray-800",x.borderBottomClassName),children:[v.jsx("header",{className:"univer-w-screen",children:n&&v.jsx(p1,{components:d},"header")}),v.jsx("section",{ref:p,className:"univer-relative univer-overflow-hidden","data-range-selector":!0,onContextMenu:k=>k.preventDefault(),children:v.jsx(p1,{components:w},"content")})]}),v.jsx("aside",{className:"univer-h-full",children:v.jsx(qe,{})})]}),t&&v.jsx("footer",{children:v.jsx(p1,{components:b},"footer")}),v.jsx(Xe,{}),v.jsx(Je,{})]})]}),v.jsx(p1,{components:_},"global"),r&&v.jsx(_6,{})]})}var H4=Object.getOwnPropertyDescriptor,E4=(e,n,t,r)=>{for(var o=r>1?void 0:r?H4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},P1=(e,n)=>(t,r)=>n(t,r,e);let Ke=class extends Qe{constructor(e,n,t,r,o,i,l){super(n,i,o,t,r),this._config=e,this._initBuiltinComponents(l),this._bootstrapWorkbench()}bootstrap(e){return D4(this._injector,this._config,e)}_initBuiltinComponents(e){this.disposeWithMe(e.registerComponent(i1.CONTENT,()=>V.connectInjector(We,this._injector))),this.disposeWithMe(e.registerComponent(i1.CONTENT,()=>V.connectInjector(je,this._injector)))}};Ke=E4([P1(1,f.Inject(f.Injector)),P1(2,f.Inject(f.LifecycleService)),P1(3,U1.IRenderManagerService),P1(4,M1),P1(5,f.IUniverInstanceService),P1(6,w1)],Ke);function D4(e,n,t){let r;const o=n.container;if(typeof o=="string"){const C=document.getElementById(o);C?r=C:r=S6(o)}else o instanceof HTMLElement?r=o:r=S6("univer");const i=V.connectInjector(S4,e),l=C=>t(C,r);function c(){x.render(v.jsx(i,{...n,mountContainer:r,onRendered:l}),r)}return c(),f.toDisposable(()=>{x.unmount(r)})}function S6(e){const n=document.createElement("div");return n.id=e,n}const ne=f.createIdentifier("ui.notification.service");var O4=Object.getOwnPropertyDescriptor,R4=(e,n,t,r)=>{for(var o=r>1?void 0:r?O4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},V4=(e,n)=>(t,r)=>n(t,r,e);const e3=f.createIdentifier("univer.ui.before-close-service");h.DesktopBeforeCloseService=class{constructor(n){j(this,"_beforeUnloadCallbacks",[]);j(this,"_onCloseCallbacks",[]);this._notificationService=n,this._init()}registerBeforeClose(n){return this._beforeUnloadCallbacks.push(n),{dispose:()=>{this._beforeUnloadCallbacks=this._beforeUnloadCallbacks.filter(t=>t!==n)}}}registerOnClose(n){return this._onCloseCallbacks.push(n),{dispose:()=>{this._onCloseCallbacks=this._onCloseCallbacks.filter(t=>t!==n)}}}_init(){window.addEventListener("beforeunload",n=>{let t=n;const r=this._beforeUnloadCallbacks.map(o=>o()).filter(o=>!!o).join(`
`);if(r)return this._notificationService.show({type:"error",title:"Some changes are not saved",content:r}),typeof t>"u"&&(t=window.event),t.returnValue=r,r}),window.addEventListener("unload",()=>{this._onCloseCallbacks.forEach(n=>n())})}},h.DesktopBeforeCloseService=R4([V4(0,ne)],h.DesktopBeforeCloseService);function H6(){return typeof navigator.clipboard<"u"&&typeof navigator.clipboard.readText<"u"}var N4=Object.getOwnPropertyDescriptor,T4=(e,n,t,r)=>{for(var o=r>1?void 0:r?N4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},t3=(e,n)=>(t,r)=>n(t,r,e);const n3="text/plain",r3="text/html",E6="image/png",D6="image/jpeg",O6="image/bmp",R6="image/webp",x4="image/svg+xml",$4=new Set([O6,D6,R6,E6]),o3=f.createIdentifier("univer.clipboard-interface-service");h.BrowserClipboardService=class extends f.Disposable{constructor(n,t,r){super(),this._localeService=n,this._logService=t,this._notificationService=r}get supportClipboard(){return H6()}async write(n,t){if(!this.supportClipboard)return this._legacyCopyHtml(t);try{return await navigator.clipboard.write([new ClipboardItem({[n3]:new Blob([n],{type:n3}),[r3]:new Blob([t],{type:r3})})])}catch(r){this._logService.error("[BrowserClipboardService]",r),this._showClipboardAuthenticationNotification()}}async writeText(n){if(!this.supportClipboard)return this._legacyCopyText(n);try{return await navigator.clipboard.writeText(n)}catch(t){this._logService.error("[BrowserClipboardService]",t),this._showClipboardAuthenticationNotification()}}async read(){if(!this.supportClipboard)throw new Error("[BrowserClipboardService] read() is not supported on this platform.");try{return navigator.clipboard.read()}catch(n){return this._logService.error("[BrowserClipboardService]",n),this._showClipboardAuthenticationNotification(),[]}}async readText(){if(!this.supportClipboard)throw new Error("[BrowserClipboardService] read() is not supported on this platform.");try{return await navigator.clipboard.readText()}catch(n){return this._logService.error("[BrowserClipboardService]",n),this._showClipboardAuthenticationNotification(),""}}_legacyCopyHtml(n){const t=document.activeElement,r=A4();document.body.appendChild(r),r.innerHTML=n;try{V6(r),document.execCommand("copy")}finally{t instanceof HTMLElement&&t.focus(),document.body.removeChild(r)}}_legacyCopyText(n){const t=document.activeElement,r=Z4();document.body.appendChild(r),r.value=n;try{V6(r),document.execCommand("copy")}finally{t instanceof HTMLElement&&t.focus(),document.body.removeChild(r)}}_showClipboardAuthenticationNotification(){var n;(n=this._notificationService)==null||n.show({type:"warning",title:this._localeService.t("clipboard.authentication.title"),content:this._localeService.t("clipboard.authentication.content")})}},h.BrowserClipboardService=T4([t3(0,f.Inject(f.LocaleService)),t3(1,f.ILogService),t3(2,f.Optional(ne))],h.BrowserClipboardService);function Z4(){const e=document.createElement("textarea");return e.style.position="absolute",e.style.height="1px",e.style.width="1px",e.style.opacity="0",e.readOnly=!0,e}function A4(){const e=document.createElement("div");return e.contentEditable="true",e.style.position="absolute",e.style.opacity="0",e.style.height="1px",e.style.width="1px",e}function V6(e){if(e instanceof HTMLTextAreaElement){const r=e.hasAttribute("readonly");return r||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),r||e.removeAttribute("readonly"),e.value}e.hasAttribute("contenteditable")&&e.focus();const n=document.createRange();n.selectNodeContents(e);const t=window.getSelection();if(!t)throw new Error;return t.removeAllRanges(),t.addRange(n),t.toString()}const be=f.createIdentifier("univer.confirm-service");class P4{constructor(){j(this,"confirmOptions$",new B.Subject)}dispose(){this.confirmOptions$.complete()}open(n){throw new Error("This is not implemented in the test service!")}confirm(n){return Promise.resolve(!0)}close(n){throw new Error("This is not implemented in the test service!")}}const F4=e=>{const{children:n,onClose:t,onConfirm:r}=e,[o]=s.useState({}),i=n?s.cloneElement(n,{hooks:o}):null;return v.jsx(x.Confirm,{...e,children:i,onClose:()=>{const l=o.beforeClose;if(l){const c=l();if(c.cancel)return;t==null||t(c);return}t==null||t()},onConfirm:()=>{const l=o.beforeConfirm;if(l){const c=l();if(c.cancel)return;r==null||r(c);return}r==null||r()}})};function k4(){const e=V.useDependency(be),[n,t]=s.useState([]);s.useEffect(()=>{const o=e.confirmOptions$.subscribe(i=>{t(i)});return()=>{o.unsubscribe()}},[]);const r=n.map(o=>{const{children:i,title:l,...c}=o,C=c;for(const p of["children","title"]){const b=p,d=o[b];d&&(C[b]=v.jsx(f1,{...d}))}return C});return r==null?void 0:r.map((o,i)=>v.jsx(F4,{...o,children:o.children},i))}var B4=Object.getOwnPropertyDescriptor,U4=(e,n,t,r)=>{for(var o=r>1?void 0:r?B4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},N6=(e,n)=>(t,r)=>n(t,r,e);h.DesktopConfirmService=class extends f.Disposable{constructor(t,r){super();j(this,"_confirmOptions",[]);j(this,"confirmOptions$",new B.BehaviorSubject([]));this._injector=t,this._uiPartsService=r,this._initUIPart()}open(t){return this._confirmOptions.find(r=>r.id===t.id)?this._confirmOptions=this._confirmOptions.map(r=>({...r.id===t.id?t:r,visible:r.id===t.id?!0:r.visible})):this._confirmOptions.push({...t,visible:!0}),this.confirmOptions$.next(this._confirmOptions),f.toDisposable(()=>{this._confirmOptions=[],this.confirmOptions$.next([])})}confirm(t){return new Promise(r=>{const o=this.open({...t,onConfirm:()=>{o.dispose(),r(!0)},onClose:()=>{o.dispose(),r(!1)}})})}close(t){this._confirmOptions=this._confirmOptions.map(r=>({...r,visible:r.id===t?!1:r.visible})),this.confirmOptions$.next([...this._confirmOptions])}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(k4,this._injector)))}},h.DesktopConfirmService=U4([N6(0,f.Inject(f.Injector)),N6(1,w1)],h.DesktopConfirmService);const Le=f.createIdentifier("univer.ui.dialog-service");function j4(){const e=V.useDependency(Le),[n,t]=s.useState([]);s.useEffect(()=>{const i=e.getDialogs$().subscribe(l=>{t(l)});return()=>i.unsubscribe()},[]);const r=s.useMemo(()=>n.map(o=>{const{children:i,title:l,footer:c,...C}=o,p=C;for(const b of["children","title","footer"]){const d=b,w=o[d];w&&(p[d]=v.jsx(f1,{...w}))}return p}),[n]);return r==null?void 0:r.map(o=>v.jsx(x.Dialog,{...o},o.id))}var z4=Object.getOwnPropertyDescriptor,W4=(e,n,t,r)=>{for(var o=r>1?void 0:r?z4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},T6=(e,n)=>(t,r)=>n(t,r,e);h.DesktopDialogService=class extends f.Disposable{constructor(t,r){super();j(this,"_dialogOptions",[]);j(this,"_dialogOptions$",new B.Subject);this._injector=t,this._uiPartsService=r,this._initUIPart()}dispose(){super.dispose(),this._dialogOptions=[],this._dialogOptions$.complete()}open(t){return this._dialogOptions.find(r=>r.id===t.id)?this._dialogOptions=this._dialogOptions.map(r=>({...r.id===t.id?t:r,open:r.id===t.id?!0:r.open})):this._dialogOptions.push({...t,open:!0}),this._dialogOptions$.next(this._dialogOptions),f.toDisposable(()=>{this._dialogOptions=[],this._dialogOptions$.next([])})}close(t){this._dialogOptions=this._dialogOptions.map(r=>({...r,open:r.id===t?!1:r.open})),this._dialogOptions$.next([...this._dialogOptions])}closeAll(t){const r=new Set(t);this._dialogOptions=this._dialogOptions.map(o=>({...o,open:r.has(o.id)?o.open:!1})),this._dialogOptions$.next([...this._dialogOptions])}getDialogs$(){return this._dialogOptions$.asObservable()}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(j4,this._injector)))}},h.DesktopDialogService=W4([T6(0,f.Inject(f.Injector)),T6(1,w1)],h.DesktopDialogService);const we=f.createIdentifier("univer.ui.gallery-service");function G4(){const e=V.useDependency(we),n=V.useObservable(e.gallery$);return n?v.jsx(x.Gallery,{...n}):null}var Y4=Object.getOwnPropertyDescriptor,X4=(e,n,t,r)=>{for(var o=r>1?void 0:r?Y4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},x6=(e,n)=>(t,r)=>n(t,r,e);h.DesktopGalleryService=class extends f.Disposable{constructor(t,r){super();j(this,"gallery$",new B.Subject);this._injector=t,this._uiPartsService=r,this._initUIPart()}dispose(){super.dispose()}open(t){return this.gallery$.next({open:!0,...t}),f.toDisposable(()=>{this.gallery$.complete()})}close(){this.gallery$.next({open:!1,images:[]})}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(G4,this._injector)))}},h.DesktopGalleryService=X4([x6(0,f.Inject(f.Injector)),x6(1,w1)],h.DesktopGalleryService);var q4=Object.getOwnPropertyDescriptor,J4=(e,n,t,r)=>{for(var o=r>1?void 0:r?q4(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},Q4=(e,n)=>(t,r)=>n(t,r,e);h.DesktopGlobalZoneService=class{constructor(n){j(this,"visible$",new B.Subject);j(this,"componentKey$",new B.Subject);j(this,"_componentKey","");this._componentManager=n}get componentKey(){return this._componentKey}set(n,t){return this._componentManager.register(n,t),this.componentKey$.next(n),this._componentKey=n,f.toDisposable(()=>{this._componentManager.delete(n),this.visible$.complete(),this.componentKey$.complete()})}open(){this.visible$.next(!0)}close(){this.visible$.next(!1)}},h.DesktopGlobalZoneService=J4([Q4(0,f.Inject(v1))],h.DesktopGlobalZoneService);class i3 extends f.Disposable{openFile(n){return new Promise(t=>{var o,i;const r=document.createElement("input");r.type="file",r.accept=(o=n==null?void 0:n.accept)!=null?o:"",r.multiple=(i=n==null?void 0:n.multiple)!=null?i:!1,r.onchange=l=>{const c=l.target.files;c&&t(Array.from(c))},r.click()})}downloadFile(n,t){const r=document.createElement("a");r.download=t,r.href=window.URL.createObjectURL(n),r.click()}}const l3=f.createIdentifier("univer-ui.local-file.service");var ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function K4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ie(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var s3={exports:{}};var $6;function e0(){return $6||($6=1,(function(e,n){(function(t){e.exports=t()})(function(){return(function t(r,o,i){function l(p,b){if(!o[p]){if(!r[p]){var d=typeof Ie=="function"&&Ie;if(!b&&d)return d(p,!0);if(c)return c(p,!0);var w=new Error("Cannot find module '"+p+"'");throw w.code="MODULE_NOT_FOUND",w}var I=o[p]={exports:{}};r[p][0].call(I.exports,function(_){var T=r[p][1][_];return l(T||_)},I,I.exports,t,r,o,i)}return o[p].exports}for(var c=typeof Ie=="function"&&Ie,C=0;C<i.length;C++)l(i[C]);return l})({1:[function(t,r,o){(function(i){var l=i.MutationObserver||i.WebKitMutationObserver,c;if(l){var C=0,p=new l(_),b=i.document.createTextNode("");p.observe(b,{characterData:!0}),c=function(){b.data=C=++C%2}}else if(!i.setImmediate&&typeof i.MessageChannel<"u"){var d=new i.MessageChannel;d.port1.onmessage=_,c=function(){d.port2.postMessage(0)}}else"document"in i&&"onreadystatechange"in i.document.createElement("script")?c=function(){var O=i.document.createElement("script");O.onreadystatechange=function(){_(),O.onreadystatechange=null,O.parentNode.removeChild(O),O=null},i.document.documentElement.appendChild(O)}:c=function(){setTimeout(_,0)};var w,I=[];function _(){w=!0;for(var O,S,A=I.length;A;){for(S=I,I=[],O=-1;++O<A;)S[O]();A=I.length}w=!1}r.exports=T;function T(O){I.push(O)===1&&!w&&c()}}).call(this,typeof ye<"u"?ye:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,o){var i=t(1);function l(){}var c={},C=["REJECTED"],p=["FULFILLED"],b=["PENDING"];r.exports=d;function d(M){if(typeof M!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,M!==l&&T(this,M)}d.prototype.catch=function(M){return this.then(null,M)},d.prototype.then=function(M,$){if(typeof M!="function"&&this.state===p||typeof $!="function"&&this.state===C)return this;var D=new this.constructor(l);if(this.state!==b){var U=this.state===p?M:$;I(D,U,this.outcome)}else this.queue.push(new w(D,M,$));return D};function w(M,$,D){this.promise=M,typeof $=="function"&&(this.onFulfilled=$,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}w.prototype.callFulfilled=function(M){c.resolve(this.promise,M)},w.prototype.otherCallFulfilled=function(M){I(this.promise,this.onFulfilled,M)},w.prototype.callRejected=function(M){c.reject(this.promise,M)},w.prototype.otherCallRejected=function(M){I(this.promise,this.onRejected,M)};function I(M,$,D){i(function(){var U;try{U=$(D)}catch(W){return c.reject(M,W)}U===M?c.reject(M,new TypeError("Cannot resolve promise with itself")):c.resolve(M,U)})}c.resolve=function(M,$){var D=O(_,$);if(D.status==="error")return c.reject(M,D.value);var U=D.value;if(U)T(M,U);else{M.state=p,M.outcome=$;for(var W=-1,Y=M.queue.length;++W<Y;)M.queue[W].callFulfilled($)}return M},c.reject=function(M,$){M.state=C,M.outcome=$;for(var D=-1,U=M.queue.length;++D<U;)M.queue[D].callRejected($);return M};function _(M){var $=M&&M.then;if(M&&(typeof M=="object"||typeof M=="function")&&typeof $=="function")return function(){$.apply(M,arguments)}}function T(M,$){var D=!1;function U(G){D||(D=!0,c.reject(M,G))}function W(G){D||(D=!0,c.resolve(M,G))}function Y(){$(W,U)}var q=O(Y);q.status==="error"&&U(q.value)}function O(M,$){var D={};try{D.value=M($),D.status="success"}catch(U){D.status="error",D.value=U}return D}d.resolve=S;function S(M){return M instanceof this?M:c.resolve(new this(l),M)}d.reject=A;function A(M){var $=new this(l);return c.reject($,M)}d.all=R;function R(M){var $=this;if(Object.prototype.toString.call(M)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=M.length,U=!1;if(!D)return this.resolve([]);for(var W=new Array(D),Y=0,q=-1,G=new this(l);++q<D;)t1(M[q],q);return G;function t1(J,X){$.resolve(J).then(n1,function(s1){U||(U=!0,c.reject(G,s1))});function n1(s1){W[X]=s1,++Y===D&&!U&&(U=!0,c.resolve(G,W))}}}d.race=k;function k(M){var $=this;if(Object.prototype.toString.call(M)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=M.length,U=!1;if(!D)return this.resolve([]);for(var W=-1,Y=new this(l);++W<D;)q(M[W]);return Y;function q(G){$.resolve(G).then(function(t1){U||(U=!0,c.resolve(Y,t1))},function(t1){U||(U=!0,c.reject(Y,t1))})}}},{1:1}],3:[function(t,r,o){(function(i){typeof i.Promise!="function"&&(i.Promise=t(2))}).call(this,typeof ye<"u"?ye:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,o){var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function l(a,g){if(!(a instanceof g))throw new TypeError("Cannot call a class as a function")}function c(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var C=c();function p(){try{if(!C||!C.open)return!1;var a=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),g=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!a||g)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function b(a,g){a=a||[],g=g||{};try{return new Blob(a,g)}catch(m){if(m.name!=="TypeError")throw m;for(var u=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,L=new u,y=0;y<a.length;y+=1)L.append(a[y]);return L.getBlob(g.type)}}typeof Promise>"u"&&t(3);var d=Promise;function w(a,g){g&&a.then(function(u){g(null,u)},function(u){g(u)})}function I(a,g,u){typeof g=="function"&&a.then(g),typeof u=="function"&&a.catch(u)}function _(a){return typeof a!="string"&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function T(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var O="local-forage-detect-blob-support",S=void 0,A={},R=Object.prototype.toString,k="readonly",M="readwrite";function $(a){for(var g=a.length,u=new ArrayBuffer(g),L=new Uint8Array(u),y=0;y<g;y++)L[y]=a.charCodeAt(y);return u}function D(a){return new d(function(g){var u=a.transaction(O,M),L=b([""]);u.objectStore(O).put(L,"key"),u.onabort=function(y){y.preventDefault(),y.stopPropagation(),g(!1)},u.oncomplete=function(){var y=navigator.userAgent.match(/Chrome\/(\d+)/),m=navigator.userAgent.match(/Edge\//);g(m||!y||parseInt(y[1],10)>=43)}}).catch(function(){return!1})}function U(a){return typeof S=="boolean"?d.resolve(S):D(a).then(function(g){return S=g,S})}function W(a){var g=A[a.name],u={};u.promise=new d(function(L,y){u.resolve=L,u.reject=y}),g.deferredOperations.push(u),g.dbReady?g.dbReady=g.dbReady.then(function(){return u.promise}):g.dbReady=u.promise}function Y(a){var g=A[a.name],u=g.deferredOperations.pop();if(u)return u.resolve(),u.promise}function q(a,g){var u=A[a.name],L=u.deferredOperations.pop();if(L)return L.reject(g),L.promise}function G(a,g){return new d(function(u,L){if(A[a.name]=A[a.name]||c1(),a.db)if(g)W(a),a.db.close();else return u(a.db);var y=[a.name];g&&y.push(a.version);var m=C.open.apply(C,y);g&&(m.onupgradeneeded=function(E){var N=m.result;try{N.createObjectStore(a.storeName),E.oldVersion<=1&&N.createObjectStore(O)}catch(Z){if(Z.name==="ConstraintError")console.warn('The database "'+a.name+'" has been upgraded from version '+E.oldVersion+" to version "+E.newVersion+', but the storage "'+a.storeName+'" already exists.');else throw Z}}),m.onerror=function(E){E.preventDefault(),L(m.error)},m.onsuccess=function(){var E=m.result;E.onversionchange=function(N){N.target.close()},u(E),Y(a)}})}function t1(a){return G(a,!1)}function J(a){return G(a,!0)}function X(a,g){if(!a.db)return!0;var u=!a.db.objectStoreNames.contains(a.storeName),L=a.version<a.db.version,y=a.version>a.db.version;if(L&&(a.version!==g&&console.warn('The database "'+a.name+`" can't be downgraded from version `+a.db.version+" to version "+a.version+"."),a.version=a.db.version),y||u){if(u){var m=a.db.version+1;m>a.version&&(a.version=m)}return!0}return!1}function n1(a){return new d(function(g,u){var L=new FileReader;L.onerror=u,L.onloadend=function(y){var m=btoa(y.target.result||"");g({__local_forage_encoded_blob:!0,data:m,type:a.type})},L.readAsBinaryString(a)})}function s1(a){var g=$(atob(a.data));return b([g],{type:a.type})}function d1(a){return a&&a.__local_forage_encoded_blob}function b1(a){var g=this,u=g._initReady().then(function(){var L=A[g._dbInfo.name];if(L&&L.dbReady)return L.dbReady});return I(u,a,a),u}function l1(a){W(a);for(var g=A[a.name],u=g.forages,L=0;L<u.length;L++){var y=u[L];y._dbInfo.db&&(y._dbInfo.db.close(),y._dbInfo.db=null)}return a.db=null,t1(a).then(function(m){return a.db=m,X(a)?J(a):m}).then(function(m){a.db=g.db=m;for(var E=0;E<u.length;E++)u[E]._dbInfo.db=m}).catch(function(m){throw q(a,m),m})}function K(a,g,u,L){L===void 0&&(L=1);try{var y=a.db.transaction(a.storeName,g);u(null,y)}catch(m){if(L>0&&(!a.db||m.name==="InvalidStateError"||m.name==="NotFoundError"))return d.resolve().then(function(){if(!a.db||m.name==="NotFoundError"&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),J(a)}).then(function(){return l1(a).then(function(){K(a,g,u,L-1)})}).catch(u);u(m)}}function c1(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function L1(a){var g=this,u={db:null};if(a)for(var L in a)u[L]=a[L];var y=A[u.name];y||(y=c1(),A[u.name]=y),y.forages.push(g),g._initReady||(g._initReady=g.ready,g.ready=b1);var m=[];function E(){return d.resolve()}for(var N=0;N<y.forages.length;N++){var Z=y.forages[N];Z!==g&&m.push(Z._initReady().catch(E))}var P=y.forages.slice(0);return d.all(m).then(function(){return u.db=y.db,t1(u)}).then(function(F){return u.db=F,X(u,g._defaultConfig.version)?J(u):F}).then(function(F){u.db=y.db=F,g._dbInfo=u;for(var z=0;z<P.length;z++){var Q=P[z];Q!==g&&(Q._dbInfo.db=u.db,Q._dbInfo.version=u.version)}})}function T1(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){K(u._dbInfo,k,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=Z.get(a);P.onsuccess=function(){var F=P.result;F===void 0&&(F=null),d1(F)&&(F=s1(F)),y(F)},P.onerror=function(){m(P.error)}}catch(F){m(F)}})}).catch(m)});return w(L,g),L}function F1(a,g){var u=this,L=new d(function(y,m){u.ready().then(function(){K(u._dbInfo,k,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=Z.openCursor(),F=1;P.onsuccess=function(){var z=P.result;if(z){var Q=z.value;d1(Q)&&(Q=s1(Q));var e1=a(Q,z.key,F++);e1!==void 0?y(e1):z.continue()}else y()},P.onerror=function(){m(P.error)}}catch(z){m(z)}})}).catch(m)});return w(L,g),L}function k1(a,g,u){var L=this;a=_(a);var y=new d(function(m,E){var N;L.ready().then(function(){return N=L._dbInfo,R.call(g)==="[object Blob]"?U(N.db).then(function(Z){return Z?g:n1(g)}):g}).then(function(Z){K(L._dbInfo,M,function(P,F){if(P)return E(P);try{var z=F.objectStore(L._dbInfo.storeName);Z===null&&(Z=void 0);var Q=z.put(Z,a);F.oncomplete=function(){Z===void 0&&(Z=null),m(Z)},F.onabort=F.onerror=function(){var e1=Q.error?Q.error:Q.transaction.error;E(e1)}}catch(e1){E(e1)}})}).catch(E)});return w(y,u),y}function $0(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){K(u._dbInfo,M,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=Z.delete(a);N.oncomplete=function(){y()},N.onerror=function(){m(P.error)},N.onabort=function(){var F=P.error?P.error:P.transaction.error;m(F)}}catch(F){m(F)}})}).catch(m)});return w(L,g),L}function Z0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){K(g._dbInfo,M,function(m,E){if(m)return y(m);try{var N=E.objectStore(g._dbInfo.storeName),Z=N.clear();E.oncomplete=function(){L()},E.onabort=E.onerror=function(){var P=Z.error?Z.error:Z.transaction.error;y(P)}}catch(P){y(P)}})}).catch(y)});return w(u,a),u}function A0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){K(g._dbInfo,k,function(m,E){if(m)return y(m);try{var N=E.objectStore(g._dbInfo.storeName),Z=N.count();Z.onsuccess=function(){L(Z.result)},Z.onerror=function(){y(Z.error)}}catch(P){y(P)}})}).catch(y)});return w(u,a),u}function P0(a,g){var u=this,L=new d(function(y,m){if(a<0){y(null);return}u.ready().then(function(){K(u._dbInfo,k,function(E,N){if(E)return m(E);try{var Z=N.objectStore(u._dbInfo.storeName),P=!1,F=Z.openKeyCursor();F.onsuccess=function(){var z=F.result;if(!z){y(null);return}a===0||P?y(z.key):(P=!0,z.advance(a))},F.onerror=function(){m(F.error)}}catch(z){m(z)}})}).catch(m)});return w(L,g),L}function F0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){K(g._dbInfo,k,function(m,E){if(m)return y(m);try{var N=E.objectStore(g._dbInfo.storeName),Z=N.openKeyCursor(),P=[];Z.onsuccess=function(){var F=Z.result;if(!F){L(P);return}P.push(F.key),F.continue()},Z.onerror=function(){y(Z.error)}}catch(F){y(F)}})}).catch(y)});return w(u,a),u}function k0(a,g){g=T.apply(this,arguments);var u=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||u.name,a.storeName=a.storeName||u.storeName);var L=this,y;if(!a.name)y=d.reject("Invalid arguments");else{var m=a.name===u.name&&L._dbInfo.db,E=m?d.resolve(L._dbInfo.db):t1(a).then(function(N){var Z=A[a.name],P=Z.forages;Z.db=N;for(var F=0;F<P.length;F++)P[F]._dbInfo.db=N;return N});a.storeName?y=E.then(function(N){if(N.objectStoreNames.contains(a.storeName)){var Z=N.version+1;W(a);var P=A[a.name],F=P.forages;N.close();for(var z=0;z<F.length;z++){var Q=F[z];Q._dbInfo.db=null,Q._dbInfo.version=Z}var e1=new d(function(r1,u1){var a1=C.open(a.name,Z);a1.onerror=function(y1){var oe=a1.result;oe.close(),u1(y1)},a1.onupgradeneeded=function(){var y1=a1.result;y1.deleteObjectStore(a.storeName)},a1.onsuccess=function(){var y1=a1.result;y1.close(),r1(y1)}});return e1.then(function(r1){P.db=r1;for(var u1=0;u1<F.length;u1++){var a1=F[u1];a1._dbInfo.db=r1,Y(a1._dbInfo)}}).catch(function(r1){throw(q(a,r1)||d.resolve()).catch(function(){}),r1})}}):y=E.then(function(N){W(a);var Z=A[a.name],P=Z.forages;N.close();for(var F=0;F<P.length;F++){var z=P[F];z._dbInfo.db=null}var Q=new d(function(e1,r1){var u1=C.deleteDatabase(a.name);u1.onerror=function(){var a1=u1.result;a1&&a1.close(),r1(u1.error)},u1.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},u1.onsuccess=function(){var a1=u1.result;a1&&a1.close(),e1(a1)}});return Q.then(function(e1){Z.db=e1;for(var r1=0;r1<P.length;r1++){var u1=P[r1];Y(u1._dbInfo)}}).catch(function(e1){throw(q(a,e1)||d.resolve()).catch(function(){}),e1})})}return w(y,g),y}var B0={_driver:"asyncStorage",_initStorage:L1,_support:p(),iterate:F1,getItem:T1,setItem:k1,removeItem:$0,clear:Z0,length:A0,key:P0,keys:F0,dropInstance:k0};function U0(){return typeof openDatabase=="function"}var D1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j0="~~local_forage_type~",z6=/^~~local_forage_type~([^~]+)~/,He="__lfsc__:",v3=He.length,g3="arbf",p3="blob",W6="si08",G6="ui08",Y6="uic8",X6="si16",q6="si32",J6="ur16",Q6="ui32",K6="fl32",en="fl64",tn=v3+g3.length,nn=Object.prototype.toString;function rn(a){var g=a.length*.75,u=a.length,L,y=0,m,E,N,Z;a[a.length-1]==="="&&(g--,a[a.length-2]==="="&&g--);var P=new ArrayBuffer(g),F=new Uint8Array(P);for(L=0;L<u;L+=4)m=D1.indexOf(a[L]),E=D1.indexOf(a[L+1]),N=D1.indexOf(a[L+2]),Z=D1.indexOf(a[L+3]),F[y++]=m<<2|E>>4,F[y++]=(E&15)<<4|N>>2,F[y++]=(N&3)<<6|Z&63;return P}function m3(a){var g=new Uint8Array(a),u="",L;for(L=0;L<g.length;L+=3)u+=D1[g[L]>>2],u+=D1[(g[L]&3)<<4|g[L+1]>>4],u+=D1[(g[L+1]&15)<<2|g[L+2]>>6],u+=D1[g[L+2]&63];return g.length%3===2?u=u.substring(0,u.length-1)+"=":g.length%3===1&&(u=u.substring(0,u.length-2)+"=="),u}function z0(a,g){var u="";if(a&&(u=nn.call(a)),a&&(u==="[object ArrayBuffer]"||a.buffer&&nn.call(a.buffer)==="[object ArrayBuffer]")){var L,y=He;a instanceof ArrayBuffer?(L=a,y+=g3):(L=a.buffer,u==="[object Int8Array]"?y+=W6:u==="[object Uint8Array]"?y+=G6:u==="[object Uint8ClampedArray]"?y+=Y6:u==="[object Int16Array]"?y+=X6:u==="[object Uint16Array]"?y+=J6:u==="[object Int32Array]"?y+=q6:u==="[object Uint32Array]"?y+=Q6:u==="[object Float32Array]"?y+=K6:u==="[object Float64Array]"?y+=en:g(new Error("Failed to get type for BinaryArray"))),g(y+m3(L))}else if(u==="[object Blob]"){var m=new FileReader;m.onload=function(){var E=j0+a.type+"~"+m3(this.result);g(He+p3+E)},m.readAsArrayBuffer(a)}else try{g(JSON.stringify(a))}catch(E){console.error("Couldn't convert value into a JSON string: ",a),g(null,E)}}function W0(a){if(a.substring(0,v3)!==He)return JSON.parse(a);var g=a.substring(tn),u=a.substring(v3,tn),L;if(u===p3&&z6.test(g)){var y=g.match(z6);L=y[1],g=g.substring(y[0].length)}var m=rn(g);switch(u){case g3:return m;case p3:return b([m],{type:L});case W6:return new Int8Array(m);case G6:return new Uint8Array(m);case Y6:return new Uint8ClampedArray(m);case X6:return new Int16Array(m);case J6:return new Uint16Array(m);case q6:return new Int32Array(m);case Q6:return new Uint32Array(m);case K6:return new Float32Array(m);case en:return new Float64Array(m);default:throw new Error("Unkown type: "+u)}}var b3={serialize:z0,deserialize:W0,stringToBuffer:rn,bufferToString:m3};function on(a,g,u,L){a.executeSql("CREATE TABLE IF NOT EXISTS "+g.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],u,L)}function G0(a){var g=this,u={db:null};if(a)for(var L in a)u[L]=typeof a[L]!="string"?a[L].toString():a[L];var y=new d(function(m,E){try{u.db=openDatabase(u.name,String(u.version),u.description,u.size)}catch(N){return E(N)}u.db.transaction(function(N){on(N,u,function(){g._dbInfo=u,m()},function(Z,P){E(P)})},E)});return u.serializer=b3,y}function O1(a,g,u,L,y,m){a.executeSql(u,L,y,function(E,N){N.code===N.SYNTAX_ERR?E.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[g.storeName],function(Z,P){P.rows.length?m(Z,N):on(Z,g,function(){Z.executeSql(u,L,y,m)},m)},m):m(E,N)},m)}function Y0(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"SELECT * FROM "+E.storeName+" WHERE key = ? LIMIT 1",[a],function(Z,P){var F=P.rows.length?P.rows.item(0).value:null;F&&(F=E.serializer.deserialize(F)),y(F)},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function X0(a,g){var u=this,L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"SELECT * FROM "+E.storeName,[],function(Z,P){for(var F=P.rows,z=F.length,Q=0;Q<z;Q++){var e1=F.item(Q),r1=e1.value;if(r1&&(r1=E.serializer.deserialize(r1)),r1=a(r1,e1.key,Q+1),r1!==void 0){y(r1);return}}y()},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function ln(a,g,u,L){var y=this;a=_(a);var m=new d(function(E,N){y.ready().then(function(){g===void 0&&(g=null);var Z=g,P=y._dbInfo;P.serializer.serialize(g,function(F,z){z?N(z):P.db.transaction(function(Q){O1(Q,P,"INSERT OR REPLACE INTO "+P.storeName+" (key, value) VALUES (?, ?)",[a,F],function(){E(Z)},function(e1,r1){N(r1)})},function(Q){if(Q.code===Q.QUOTA_ERR){if(L>0){E(ln.apply(y,[a,Z,u,L-1]));return}N(Q)}})})}).catch(N)});return w(m,u),m}function q0(a,g,u){return ln.apply(this,[a,g,u,1])}function J0(a,g){var u=this;a=_(a);var L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"DELETE FROM "+E.storeName+" WHERE key = ?",[a],function(){y()},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function Q0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){var m=g._dbInfo;m.db.transaction(function(E){O1(E,m,"DELETE FROM "+m.storeName,[],function(){L()},function(N,Z){y(Z)})})}).catch(y)});return w(u,a),u}function K0(a){var g=this,u=new d(function(L,y){g.ready().then(function(){var m=g._dbInfo;m.db.transaction(function(E){O1(E,m,"SELECT COUNT(key) as c FROM "+m.storeName,[],function(N,Z){var P=Z.rows.item(0).c;L(P)},function(N,Z){y(Z)})})}).catch(y)});return w(u,a),u}function e5(a,g){var u=this,L=new d(function(y,m){u.ready().then(function(){var E=u._dbInfo;E.db.transaction(function(N){O1(N,E,"SELECT key FROM "+E.storeName+" WHERE id = ? LIMIT 1",[a+1],function(Z,P){var F=P.rows.length?P.rows.item(0).key:null;y(F)},function(Z,P){m(P)})})}).catch(m)});return w(L,g),L}function t5(a){var g=this,u=new d(function(L,y){g.ready().then(function(){var m=g._dbInfo;m.db.transaction(function(E){O1(E,m,"SELECT key FROM "+m.storeName,[],function(N,Z){for(var P=[],F=0;F<Z.rows.length;F++)P.push(Z.rows.item(F).key);L(P)},function(N,Z){y(Z)})})}).catch(y)});return w(u,a),u}function n5(a){return new d(function(g,u){a.transaction(function(L){L.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(y,m){for(var E=[],N=0;N<m.rows.length;N++)E.push(m.rows.item(N).name);g({db:a,storeNames:E})},function(y,m){u(m)})},function(L){u(L)})})}function r5(a,g){g=T.apply(this,arguments);var u=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||u.name,a.storeName=a.storeName||u.storeName);var L=this,y;return a.name?y=new d(function(m){var E;a.name===u.name?E=L._dbInfo.db:E=openDatabase(a.name,"","",0),a.storeName?m({db:E,storeNames:[a.storeName]}):m(n5(E))}).then(function(m){return new d(function(E,N){m.db.transaction(function(Z){function P(e1){return new d(function(r1,u1){Z.executeSql("DROP TABLE IF EXISTS "+e1,[],function(){r1()},function(a1,y1){u1(y1)})})}for(var F=[],z=0,Q=m.storeNames.length;z<Q;z++)F.push(P(m.storeNames[z]));d.all(F).then(function(){E()}).catch(function(e1){N(e1)})},function(Z){N(Z)})})}):y=d.reject("Invalid arguments"),w(y,g),y}var o5={_driver:"webSQLStorage",_initStorage:G0,_support:U0(),iterate:X0,getItem:Y0,setItem:q0,removeItem:J0,clear:Q0,length:K0,key:e5,keys:t5,dropInstance:r5};function i5(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function sn(a,g){var u=a.name+"/";return a.storeName!==g.storeName&&(u+=a.storeName+"/"),u}function l5(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch{return!0}}function s5(){return!l5()||localStorage.length>0}function a5(a){var g=this,u={};if(a)for(var L in a)u[L]=a[L];return u.keyPrefix=sn(a,g._defaultConfig),s5()?(g._dbInfo=u,u.serializer=b3,d.resolve()):d.reject()}function c5(a){var g=this,u=g.ready().then(function(){for(var L=g._dbInfo.keyPrefix,y=localStorage.length-1;y>=0;y--){var m=localStorage.key(y);m.indexOf(L)===0&&localStorage.removeItem(m)}});return w(u,a),u}function u5(a,g){var u=this;a=_(a);var L=u.ready().then(function(){var y=u._dbInfo,m=localStorage.getItem(y.keyPrefix+a);return m&&(m=y.serializer.deserialize(m)),m});return w(L,g),L}function d5(a,g){var u=this,L=u.ready().then(function(){for(var y=u._dbInfo,m=y.keyPrefix,E=m.length,N=localStorage.length,Z=1,P=0;P<N;P++){var F=localStorage.key(P);if(F.indexOf(m)===0){var z=localStorage.getItem(F);if(z&&(z=y.serializer.deserialize(z)),z=a(z,F.substring(E),Z++),z!==void 0)return z}}});return w(L,g),L}function f5(a,g){var u=this,L=u.ready().then(function(){var y=u._dbInfo,m;try{m=localStorage.key(a)}catch{m=null}return m&&(m=m.substring(y.keyPrefix.length)),m});return w(L,g),L}function h5(a){var g=this,u=g.ready().then(function(){for(var L=g._dbInfo,y=localStorage.length,m=[],E=0;E<y;E++){var N=localStorage.key(E);N.indexOf(L.keyPrefix)===0&&m.push(N.substring(L.keyPrefix.length))}return m});return w(u,a),u}function C5(a){var g=this,u=g.keys().then(function(L){return L.length});return w(u,a),u}function v5(a,g){var u=this;a=_(a);var L=u.ready().then(function(){var y=u._dbInfo;localStorage.removeItem(y.keyPrefix+a)});return w(L,g),L}function g5(a,g,u){var L=this;a=_(a);var y=L.ready().then(function(){g===void 0&&(g=null);var m=g;return new d(function(E,N){var Z=L._dbInfo;Z.serializer.serialize(g,function(P,F){if(F)N(F);else try{localStorage.setItem(Z.keyPrefix+a,P),E(m)}catch(z){(z.name==="QuotaExceededError"||z.name==="NS_ERROR_DOM_QUOTA_REACHED")&&N(z),N(z)}})})});return w(y,u),y}function p5(a,g){if(g=T.apply(this,arguments),a=typeof a!="function"&&a||{},!a.name){var u=this.config();a.name=a.name||u.name,a.storeName=a.storeName||u.storeName}var L=this,y;return a.name?y=new d(function(m){a.storeName?m(sn(a,L._defaultConfig)):m(a.name+"/")}).then(function(m){for(var E=localStorage.length-1;E>=0;E--){var N=localStorage.key(E);N.indexOf(m)===0&&localStorage.removeItem(N)}}):y=d.reject("Invalid arguments"),w(y,g),y}var m5={_driver:"localStorageWrapper",_initStorage:a5,_support:i5(),iterate:d5,getItem:u5,setItem:g5,removeItem:v5,clear:c5,length:C5,key:f5,keys:h5,dropInstance:p5},b5=function(g,u){return g===u||typeof g=="number"&&typeof u=="number"&&isNaN(g)&&isNaN(u)},L5=function(g,u){for(var L=g.length,y=0;y<L;){if(b5(g[y],u))return!0;y++}return!1},an=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},re={},cn={},B1={INDEXEDDB:B0,WEBSQL:o5,LOCALSTORAGE:m5},w5=[B1.INDEXEDDB._driver,B1.WEBSQL._driver,B1.LOCALSTORAGE._driver],Ee=["dropInstance"],L3=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ee),y5={description:"",driver:w5.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function I5(a,g){a[g]=function(){var u=arguments;return a.ready().then(function(){return a[g].apply(a,u)})}}function w3(){for(var a=1;a<arguments.length;a++){var g=arguments[a];if(g)for(var u in g)g.hasOwnProperty(u)&&(an(g[u])?arguments[0][u]=g[u].slice():arguments[0][u]=g[u])}return arguments[0]}var M5=(function(){function a(g){l(this,a);for(var u in B1)if(B1.hasOwnProperty(u)){var L=B1[u],y=L._driver;this[u]=y,re[y]||this.defineDriver(L)}this._defaultConfig=w3({},y5),this._config=w3({},this._defaultConfig,g),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(u){if((typeof u>"u"?"undefined":i(u))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var L in u){if(L==="storeName"&&(u[L]=u[L].replace(/\W/g,"_")),L==="version"&&typeof u[L]!="number")return new Error("Database version must be a number.");this._config[L]=u[L]}return"driver"in u&&u.driver?this.setDriver(this._config.driver):!0}else return typeof u=="string"?this._config[u]:this._config},a.prototype.defineDriver=function(u,L,y){var m=new d(function(E,N){try{var Z=u._driver,P=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!u._driver){N(P);return}for(var F=L3.concat("_initStorage"),z=0,Q=F.length;z<Q;z++){var e1=F[z],r1=!L5(Ee,e1);if((r1||u[e1])&&typeof u[e1]!="function"){N(P);return}}var u1=function(){for(var oe=function(H5){return function(){var E5=new Error("Method "+H5+" is not implemented by the current driver"),un=d.reject(E5);return w(un,arguments[arguments.length-1]),un}},y3=0,S5=Ee.length;y3<S5;y3++){var I3=Ee[y3];u[I3]||(u[I3]=oe(I3))}};u1();var a1=function(oe){re[Z]&&console.info("Redefining LocalForage driver: "+Z),re[Z]=u,cn[Z]=oe,E()};"_support"in u?u._support&&typeof u._support=="function"?u._support().then(a1,N):a1(!!u._support):a1(!0)}catch(y1){N(y1)}});return I(m,L,y),m},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(u,L,y){var m=re[u]?d.resolve(re[u]):d.reject(new Error("Driver not found."));return I(m,L,y),m},a.prototype.getSerializer=function(u){var L=d.resolve(b3);return I(L,u),L},a.prototype.ready=function(u){var L=this,y=L._driverSet.then(function(){return L._ready===null&&(L._ready=L._initDriver()),L._ready});return I(y,u,u),y},a.prototype.setDriver=function(u,L,y){var m=this;an(u)||(u=[u]);var E=this._getSupportedDrivers(u);function N(){m._config.driver=m.driver()}function Z(z){return m._extend(z),N(),m._ready=m._initStorage(m._config),m._ready}function P(z){return function(){var Q=0;function e1(){for(;Q<z.length;){var r1=z[Q];return Q++,m._dbInfo=null,m._ready=null,m.getDriver(r1).then(Z).catch(e1)}N();var u1=new Error("No available storage method found.");return m._driverSet=d.reject(u1),m._driverSet}return e1()}}var F=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=F.then(function(){var z=E[0];return m._dbInfo=null,m._ready=null,m.getDriver(z).then(function(Q){m._driver=Q._driver,N(),m._wrapLibraryMethodsWithReady(),m._initDriver=P(E)})}).catch(function(){N();var z=new Error("No available storage method found.");return m._driverSet=d.reject(z),m._driverSet}),I(this._driverSet,L,y),this._driverSet},a.prototype.supports=function(u){return!!cn[u]},a.prototype._extend=function(u){w3(this,u)},a.prototype._getSupportedDrivers=function(u){for(var L=[],y=0,m=u.length;y<m;y++){var E=u[y];this.supports(E)&&L.push(E)}return L},a.prototype._wrapLibraryMethodsWithReady=function(){for(var u=0,L=L3.length;u<L;u++)I5(this,L3[u])},a.prototype.createInstance=function(u){return new a(u)},a})(),_5=new M5;r.exports=_5},{3:3}]},{},[4])(4)})})(s3)),s3.exports}var t0=e0();const N1=K4(t0);class a3{getItem(n){return N1.getItem(n)}setItem(n,t){return N1.setItem(n,t)}removeItem(n){return N1.removeItem(n)}clear(){return N1.clear()}key(n){return N1.key(n)}keys(){return N1.keys()}iterate(n){return N1.iterate(n)}}var n0=Object.getOwnPropertyDescriptor,r0=(e,n,t,r)=>{for(var o=r>1?void 0:r?n0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},Z6=(e,n)=>(t,r)=>n(t,r,e);h.DesktopMessageService=class extends f.Disposable{constructor(n,t){super(),this._injector=n,this._uiPartsService=t,this._initUIPart()}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(x.Messager,this._injector)))}dispose(){x.removeMessage()}show(n){let t=n;return typeof n.id>"u"&&(t=Object.assign({},n,{id:`message-${Date.now()}`})),x.message(t),f.toDisposable(()=>x.removeMessage(t.id))}remove(n){x.removeMessage(n)}removeAll(){x.removeMessage()}},h.DesktopMessageService=r0([Z6(0,f.Inject(f.Injector)),Z6(1,w1)],h.DesktopMessageService);function o0(){const e=V.useDependency(f.ThemeService),n=V.useObservable(e.darkMode$);return v.jsx(x.Toaster,{theme:n?"dark":"light"})}const i0={show:e=>{const{type:n="message",title:t,content:r,duration:o,closable:i=!0,position:l="top-right"}=e;x.toast[n](t,{position:l,description:r,duration:o,closeButton:i})}};var l0=Object.getOwnPropertyDescriptor,s0=(e,n,t,r)=>{for(var o=r>1?void 0:r?l0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},A6=(e,n)=>(t,r)=>n(t,r,e);h.DesktopNotificationService=class extends f.Disposable{constructor(n,t){super(),this._injector=n,this._uiPartsService=t,this._initUIPart()}show(n){return i0.show(n),f.toDisposable(()=>{})}_initUIPart(){this.disposeWithMe(this._uiPartsService.registerComponent(i1.GLOBAL,()=>V.connectInjector(o0,this._injector)))}},h.DesktopNotificationService=s0([A6(0,f.Inject(f.Injector)),A6(1,w1)],h.DesktopNotificationService);class c3{constructor(){j(this,"_sidebarOptions",{});j(this,"sidebarOptions$",new B.Subject);j(this,"scrollEvent$",new B.Subject);j(this,"_container")}get visible(){return this._sidebarOptions.visible||!1}get options(){return this._sidebarOptions}open(n){return this._sidebarOptions={...n,id:n.id,visible:!0},this.sidebarOptions$.next(this._sidebarOptions),f.toDisposable(()=>{this.close()})}close(n){n&&this._sidebarOptions.id!==n||(this._sidebarOptions={...this._sidebarOptions,visible:!1},this.sidebarOptions$.next(this._sidebarOptions),this._sidebarOptions.onClose&&this._sidebarOptions.onClose())}getContainer(){return this._container}setContainer(n){this._container=n}}var a0=Object.getOwnPropertyDescriptor,c0=(e,n,t,r)=>{for(var o=r>1?void 0:r?a0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},u0=(e,n)=>(t,r)=>n(t,r,e);h.DesktopZenZoneService=class{constructor(n){j(this,"visible$",new B.BehaviorSubject(!1));j(this,"componentKey$",new B.ReplaySubject);j(this,"_temporaryHidden$",new B.BehaviorSubject(!1));j(this,"temporaryHidden$",this._temporaryHidden$.asObservable());j(this,"_visible",!1);this._componentManager=n}get visible(){return this._visible}get temporaryHidden(){return this._temporaryHidden$.getValue()}dispose(){this.visible$.next(!1),this.visible$.complete(),this.componentKey$.complete()}hide(){this._temporaryHidden$.next(!0)}show(){this._temporaryHidden$.next(!1)}set(n,t){return this._componentManager.register(n,t),this.componentKey$.next(n),f.toDisposable(()=>{this._componentManager.delete(n),this.visible$.complete(),this.componentKey$.complete()})}open(){this._visible=!0,this.visible$.next(!0)}close(){this._visible=!1,this.visible$.next(!1)}},h.DesktopZenZoneService=c0([u0(0,f.Inject(v1))],h.DesktopZenZoneService);var d0=Object.defineProperty,f0=Object.getOwnPropertyDescriptor,h0=(e,n,t)=>n in e?d0(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,C0=(e,n,t,r)=>{for(var o=r>1?void 0:r?f0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},u3=(e,n)=>(t,r)=>n(t,r,e),v0=(e,n,t)=>h0(e,n+"",t);const g0="UNIVER_MOBILE_UI_PLUGIN",p0="DISABLE_AUTO_FOCUS";h.UniverMobileUIPlugin=class extends f.Plugin{constructor(n=ae,t,r,o){super(),this._config=n,this._contextService=t,this._injector=r,this._configService=o;const{menu:i,...l}=f.merge({popupRootId:`univer-popup-portal-${f.generateRandomId(6)}`},ae,this._config);l.disableAutoFocus&&this._contextService.setContextValue(p0,!0),i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(V1,l)}onStarting(){f.registerDependencies(this._injector,f.mergeOverrideWithDependencies([[v1],[K1],[W1],[ie],[w1,{useClass:Ue}],[M1,{useClass:h.DesktopLayoutService}],[Z1,{useClass:h.ShortcutService}],[de,{useClass:Be}],[I1,{useClass:h.MenuManagerService}],[ee,{useClass:Ye}],[o3,{useClass:h.BrowserClipboardService,lazy:!0}],[ne,{useClass:h.DesktopNotificationService,lazy:!0}],[we,{useClass:h.DesktopGalleryService,lazy:!0}],[Le,{useClass:h.DesktopDialogService,lazy:!0}],[be,{useClass:h.DesktopConfirmService,lazy:!0}],[x1,{useClass:c3,lazy:!0}],[me,{useClass:h.DesktopZenZoneService,lazy:!0}],[pe,{useClass:h.DesktopGlobalZoneService,lazy:!0}],[ue,{useClass:h.DesktopMessageService,lazy:!0}],[f.ILocalStorageService,{useClass:a3,lazy:!0}],[e3,{useClass:h.DesktopBeforeCloseService}],[l3,{useClass:i3}],[Ce,{useClass:ze}],[he],[te,{useFactory:n=>n.createInstance(Ke,this._config),deps:[f.Injector]}],[h.SharedController],[h.ErrorController],[h.ShortcutPanelController]],this._config.override)),f.touchDependencies(this._injector,[[te],[h.ErrorController]])}onReady(){f.touchDependencies(this._injector,[[h.SharedController]])}onSteady(){f.touchDependencies(this._injector,[[h.ShortcutPanelController]])}},v0(h.UniverMobileUIPlugin,"pluginName",g0),h.UniverMobileUIPlugin=C0([f.DependentOn(U1.UniverRenderEnginePlugin),u3(1,f.IContextService),u3(2,f.Inject(f.Injector)),u3(3,f.IConfigService)],h.UniverMobileUIPlugin);var m0=Object.defineProperty,b0=Object.getOwnPropertyDescriptor,L0=(e,n,t)=>n in e?m0(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,w0=(e,n,t,r)=>{for(var o=r>1?void 0:r?b0(n,t):n,i=e.length-1,l;i>=0;i--)(l=e[i])&&(o=l(o)||o);return o},d3=(e,n)=>(t,r)=>n(t,r,e),y0=(e,n,t)=>L0(e,n+"",t);const P6="UNIVER_UI_PLUGIN",F6="DISABLE_AUTO_FOCUS";h.UniverUIPlugin=class extends f.Plugin{constructor(n=ae,t,r,o){super(),this._config=n,this._contextService=t,this._injector=r,this._configService=o;const{menu:i,...l}=f.merge({popupRootId:`univer-popup-portal-${f.generateRandomId(6)}`},ae,this._config);l.disableAutoFocus&&this._contextService.setContextValue(F6,!0),i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(V1,l)}onStarting(){f.registerDependencies(this._injector,f.mergeOverrideWithDependencies([[v1],[K1],[W1],[ie],[w1,{useClass:Ue}],[M1,{useClass:h.DesktopLayoutService}],[Z1,{useClass:h.ShortcutService}],[de,{useClass:Be}],[I1,{useClass:h.MenuManagerService}],[ee,{useClass:Ye}],[o3,{useClass:h.BrowserClipboardService,lazy:!0}],[ne,{useClass:h.DesktopNotificationService,lazy:!0}],[we,{useClass:h.DesktopGalleryService,lazy:!0}],[Le,{useClass:h.DesktopDialogService,lazy:!0}],[be,{useClass:h.DesktopConfirmService,lazy:!0}],[x1,{useClass:c3,lazy:!0}],[me,{useClass:h.DesktopZenZoneService,lazy:!0}],[pe,{useClass:h.DesktopGlobalZoneService,lazy:!0}],[ue,{useClass:h.DesktopMessageService,lazy:!0}],[f.ILocalStorageService,{useClass:a3,lazy:!0}],[e3,{useClass:h.DesktopBeforeCloseService}],[l3,{useClass:i3}],[Ce,{useClass:ze}],[xe,{useClass:$e}],[he],[te,{useFactory:n=>n.createInstance(h.DesktopUIController,this._config),deps:[f.Injector]}],[h.SharedController],[h.ErrorController],[h.ShortcutPanelController]],this._config.override)),f.touchDependencies(this._injector,[[te],[h.ErrorController]])}onReady(){f.touchDependencies(this._injector,[[h.SharedController]])}onSteady(){f.touchDependencies(this._injector,[[h.ShortcutPanelController]])}},y0(h.UniverUIPlugin,"pluginName",P6),h.UniverUIPlugin=w0([f.DependentOn(U1.UniverRenderEnginePlugin),d3(1,f.IContextService),d3(2,f.Inject(f.Injector)),d3(3,f.IConfigService)],h.UniverUIPlugin);class I0{show(n){return f.toDisposable(()=>{})}remove(n){}removeAll(){}setContainer(){}getContainer(){}}const M0=e=>{const t=V.useDependency(x1).getContainer();s.useEffect(()=>{if(t)return t.addEventListener("mousedown",e),()=>{t.removeEventListener("mousedown",e)}},[e,t])};function Me(e){return e.length===0?e:e.replace(/^\s+|\s+$/gm,"")}const _0=.75,k6=78,B6=9;function f3(e){var c;let n=e.childNodes;if(n.length===0)return e.textContent;if(n[0].nodeName==="DIV"&&(n=n[0].childNodes),n.length===1&&n[0].nodeName==="#text")return n[0].textContent;const t=[];let r=0,o=0,i=e.textContent||"";i+=`\r
`;for(let C=0;C<n.length;C++){let p=n[`${C}`],b;p.nodeName==="#text"?(b=(c=p.textContent)!=null?c:"",p=p.parentElement):b=p.innerText;const d=_e(p);j6(b).forEach(I=>{const _=I.length;o+=_,r=o-_;const T=f.generateRandomId(6);t.push({sId:T,st:r,ed:o-1,ts:d})})}return{id:f.generateRandomId(6),body:{dataStream:i,textRuns:t},documentStyle:{}}}function _e(e,n=""){var l,c;let t=(c=(l=e==null?void 0:e.style)==null?void 0:l.cssText)!=null?c:"";if(t+=n,t=t.replace(/[\r\n]+/g,""),t.length===0)return{};const r=t.split(";"),o={},i={t:"",r:"",b:"",l:""};return r.forEach(C=>{var w;const p=C.toLowerCase(),b=Me(p.substr(0,p.indexOf(":"))),d=Me(p.substr(p.indexOf(":")+1));if(b==="font-weight")d==="bold"||d==="700"?o.bl=1:o.bl=0;else if(b==="font-style")d==="italic"?o.it=1:o.it=0;else if(b==="font-family"){const I=Me(C),_=T0(I);o.ff=_}else if(b==="font-size"){let I=Number.parseInt(d);t.indexOf("vertical-align")>-1&&(t.indexOf("sub")>-1||t.indexOf("sup")>-1)&&(I*=2),d.indexOf("px")!==-1&&(I=N0(Number.parseInt(d,10))),o.fs=I}else if(b==="color"){const I=new f.ColorKit(d);o.cl={rgb:I.isValid?I.toRgbString():"rgb(0,0,0)"}}else if(b==="background"||b==="background-color"){const I=new f.ColorKit(d);I.isValid&&(o.bg={rgb:I.toRgbString()})}else if(b==="text-decoration-line")d==="underline"?(o.ul||(o.ul={s:1}),o.ul.s=1):d==="line-through"?(o.st||(o.st={s:1}),o.st.s=1):d==="overline"&&(o.ol||(o.ol={s:1}),o.ol.s=1);else if(b==="text-decoration-color")o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,cl:{rgb:d}}),o.ul.cl={rgb:d}),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,cl:{rgb:d}}),o.st.cl={rgb:d}),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,cl:{rgb:d}}),o.ol.cl={rgb:d});else if(b==="text-decoration-style")o.hasOwnProperty("ul")&&(o.ul||(o.ul={s:1,t:Number(d)}),o.ul.t=Number(d)),o.hasOwnProperty("st")&&(o.st||(o.st={s:1,t:Number(d)}),o.st.t=Number(d)),o.hasOwnProperty("ol")&&(o.ol||(o.ol={s:1,t:Number(d)}),o.ol.t=Number(d));else if(b==="text-decoration"||b==="univer-strike"){const I=(w=d.split(" "))==null?void 0:w[0];I==="underline"?(o.ul||(o.ul={s:1}),o.ul.s=1):I==="line-through"?(o.st||(o.st={s:1}),o.st.s=1):I==="overline"&&(o.ol||(o.ol={s:1}),o.ol.s=1)}if(b==="univer-underline"&&(o.ul={s:1}),b==="vertical-align"&&(d==="sub"?o.va=f.BaselineOffset.SUBSCRIPT:d==="super"?o.va=f.BaselineOffset.SUPERSCRIPT:d==="top"?o.vt=1:d==="middle"?o.vt=2:d==="bottom"?o.vt=3:o.va=f.BaselineOffset.NORMAL),b==="transform"){const I=d.split(")"),_=I.findIndex(T=>T.includes("rotate"));if(_>-1){const T=I[_].match(/\d+/g);let O=0,S=0;T!=null&&T.length&&(O=+T[0]),e!=null&&e.dataset.vertical&&(S=+e.dataset.vertical),o.tr={a:O,v:S}}}if(b==="text-align"&&(d==="left"?o.ht=1:d==="center"?o.ht=2:d==="right"?o.ht=3:d==="justify"?o.ht=4:o.ht=0),o.tb!==1&&(b==="overflow-wrap"||b==="word-wrap"?d==="break-word"&&(o.tb=3):b==="text-overflow"?d==="clip"&&(o.tb=2):b==="text-break"&&d==="overflow"&&(o.tb=1)),b==="white-space"&&(d==="nowrap"?o.tb=1:d==="normal"?o.tb=3:d==="clip"&&(o.tb=2)),b==="border-color"){const I=U6(d,")");if(o.bd)for(const _ in I)o.bd[_].cl.rgb=I[_];else{o.bd={b:{cl:{rgb:"#000"},s:0},t:{cl:{rgb:"#000"},s:0},l:{cl:{rgb:"#000"},s:0},r:{cl:{rgb:"#000"},s:0}};for(const _ in I)o.bd[_].cl.rgb=I[_]}}if(b==="border-width"||b==="border-style"){const I=U6(d," ");for(const _ in I)i[_]+=` ${I[_]}`;o.bd?(o.bd.b.s=f.getBorderStyleType(i.b),o.bd.t.s=f.getBorderStyleType(i.t),o.bd.l.s=f.getBorderStyleType(i.l),o.bd.r.s=f.getBorderStyleType(i.r)):o.bd={b:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.b)},t:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.t)},l:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.l)},r:{cl:{rgb:"#000"},s:f.getBorderStyleType(i.r)}}}if(b==="border-bottom"||b==="border-top"||b==="border-left"||b==="border-right"||b==="border"){o.bd||(o.bd={});const I=d.split(" "),_=`${I[0]} ${I[1]}`;I.splice(0,2);const T=I.join("");if(f.getBorderStyleType(_)!==f.BorderStyleTypes.NONE&&T){const S={cl:{rgb:T},s:f.getBorderStyleType(_)};b==="border-bottom"?o.bd.b=d==="none"?null:S:b==="border-top"?o.bd.t=d==="none"?null:S:b==="border-left"?o.bd.l=d==="none"?null:S:b==="border-right"?o.bd.r=d==="none"?null:S:b==="border"&&(o.bd={r:d==="none"?null:S,t:d==="none"?null:S,b:d==="none"?null:S,l:d==="none"?null:S})}}else if(b==="--data-rotate"){const I=/[+-]?\d+/,_=d.match(I);d==="(0deg ,1)"?o.tr={a:0,v:1}:_&&(o.tr={a:Number(_[0])})}}),Object.keys(o).forEach(C=>{typeof o[C]=="object"&&!Object.keys(o[C]).length&&delete o[C]}),o}function U6(e,n){let t;n===" "?t=e.trim().split(n):t=e.trim().split(n).slice(0,-1),t.forEach(o=>`${o.trim()})`);let r={};return t.length===1?r={t:t[0],r:t[0],b:t[0],l:t[0]}:t.length===2?r={t:t[0],r:t[1],b:t[0],l:t[1]}:t.length===3?r={t:t[0],r:t[1],b:t[2],l:t[1]}:t.length===4&&(r={t:t[0],r:t[1],b:t[2],l:t[3]}),r}function j6(e){if(e==="")return[e];const n=/(?:(\n+.+)|(.+))/g;return e.match(n).map(o=>o.replace(/\n/g,`\r
`))}function S0(e){const n=document.createElement("DIV"),t=[];n.innerHTML=e;const r=n.querySelectorAll("table col");if(!r.length)return[];for(let o=0;o<r.length;o++){const i=r[o],l=i.getAttribute("span");if(l&&+l>1)for(let c=0;c<+l;c++){const C=Se(i.getAttribute("width"),72);t.push(C)}else{const c=Se(i.getAttribute("width"),72);t.push(c)}}return t}function Se(e,n){if(!e)return n;let t;return e.includes("pt")?t=U1.ptToPx(Number.parseFloat(e)):e.includes("px")?t=Number.parseFloat(e):t=Number.parseFloat(e)*72/96,t}function H0(e){const n=document.createElement("DIV"),t=[];n.innerHTML=e;const r=n.querySelectorAll("table tr");if(!r.length)return[];for(let o=0;o<r.length;o++){const l=r[o].querySelectorAll("td");let c=Se(l[0].style.height,19);for(let C=0;C<l.length;C++){const p=l[C].getAttribute("rowSpan");if(!(p&&+p>1)){c=Se(l[C].style.height,19);break}}t.push(c)}return t}function E0(e){let n=[];const t=document.createElement("DIV");if(t.innerHTML=e,n=new Array(t.querySelectorAll("table tr").length),!n.length)return[];let r=0;const o=t.querySelectorAll("table tr");o[0].querySelectorAll("td").forEach(c=>{let C=0;const p=c.getAttribute("colSpan");p!==null?C=+p:C=1,r+=C});for(let c=0;c<n.length;c++)n[c]=new Array(r);let l=0;return o.forEach(c=>{let C=0;c.querySelectorAll("td").forEach(p=>{var I,_;const b={};if(p.querySelectorAll("span").length||p.querySelectorAll("font").length){const T=f3(p);typeof T!="string"&&(b.p=T)}const d=p.innerText;d.trim().length===0?b.v="":b.v=d;const w=_e(p);for(f.Tools.isPlainObject(w)&&(b.s=w);C<r&&n[l][C]!=null;)C++;if(C!==r){if(n[l][C]==null){n[l][C]=b;const T=(I=Number(p.getAttribute("rowSpan")))!=null?I:1,O=(_=Number(p.getAttribute("colSpan")))!=null?_:1;if(T>1||O>1){const S={rs:+T-1,cs:+O-1,r:l,c:C};n[l][C].mc=S;for(let A=0;A<T;A++)for(let R=0;R<O;R++)A===0&&R===0||(n[l+A][C+R]={mc:null})}}C++}}),l++}),n}function D0(e){const n=[],t=document.createElement("DIV");t.innerHTML=e;const o=e.replace(/\r/g,"").split(`
`),i=o[0].split("	").length;for(let l=0;l<o.length;l++)o[l].split("	").length<i||n.push(o[l].split("	"));for(let l=0;l<n.length;l++)for(let c=0;c<n[l].length;c++)n[l][c].length?n[l][c]={v:n[l][c]||"",m:n[l][c]||""}:n[l][c]=null;return n}function O0(e,n){e.length,e[0].length;let t=0,r=0;n&&(t=n.startRow,r=n.startColumn);const o=[];for(let i=0;i<e.length;i++)for(let l=0;l<e[i].length;l++)if(e[i][l]&&typeof e[i][l]=="object"&&"mc"in e[i][l])if(e[i][l].mc){const c=e[i][l].mc,C=c.r+t,p=C+c.rs,b=c.c+r,d=b+c.cs;o.push({startRow:C,endRow:p,startColumn:b,endColumn:d}),delete e[i][l].mc}else e[i][l]=null;return{data:e,mergeData:o}}function R0(e){var p;let n=[];const t=document.createElement("html");t.innerHTML=e;const r=(p=t.querySelector("style"))==null?void 0:p.innerText;if(!r)return;const o=V0(r);if(n=new Array(t.querySelectorAll("table tr").length),!n.length)return[];let i=0;const l=t.querySelectorAll("table tr");l[0].querySelectorAll("td").forEach(b=>{let d=0;const w=b.getAttribute("colSpan");w!==null?d=+w:d=1,i+=d});for(let b=0;b<n.length;b++)n[b]=new Array(i);let C=0;return l.forEach(b=>{let d=0;b.querySelectorAll("td").forEach(w=>{var S,A;const I={};if(w.querySelectorAll("span").length||w.querySelectorAll("font").length){const R=f3(w);typeof R!="string"&&(I.p=R)}const _=w.innerText;_.trim().length===0?I.v="":I.v=_;let T="";for(const R in o)w.classList.contains(R)&&(T+=o[R]);const O=_e(w,T);for(f.Tools.isPlainObject(O)&&(I.s=O);d<i&&n[C][d]!=null;)d++;if(d!==i){if(n[C][d]==null){n[C][d]=I;const R=(S=Number(w.getAttribute("rowSpan")))!=null?S:1,k=(A=Number(w.getAttribute("colSpan")))!=null?A:1;if(R>1||k>1){const M={rs:+R-1,cs:+k-1,r:C,c:d};n[C][d].mc=M;for(let $=0;$<R;$++)for(let D=0;D<k;D++)$===0&&D===0||(n[C+$][d+D]={mc:null})}}d++}}),C++}),n}function V0(e){const n={},t=e.replaceAll("<!--","").replaceAll("-->","").trim(),r=t==null?void 0:t.replaceAll("	","").replaceAll(`
`,"").split("}");for(let o=0;o<r.length;o++){if(!r[o])continue;let i=r[o].split("{")[0].trim();i.includes(".")&&(i=i.slice(1));const l=r[o].split("{")[1].trim();n[i]=l}return n}function N0(e){const n=Math.round(e*_0);return n<B6?B6:n>k6?k6:n}function T0(e){const n=/font-family:\s*(?:"([^"]+)"|'([^']+)'|([^;]+))/i,t=e.match(n);return t?(t[1]||t[2]||t[3]).trim():null}const x0=s.memo(e=>{var T,O;const{layer:n,id:t,position:r}=e,o=V.useDependency(f.IUniverInstanceService),i=s.useRef(null),l=s.useRef(null),c=s.useRef(`transform: rotate(${r==null?void 0:r.rotate}deg) translate(${r==null?void 0:r.startX}px, ${r==null?void 0:r.startY}px)`),C=s.useRef((T=r==null?void 0:r.startY)!=null?T:0),p=s.useRef((O=r==null?void 0:r.startX)!=null?O:0),b=typeof n.componentKey=="string"?V.useDependency(v1).get(n.componentKey):n.componentKey,d=s.useMemo(()=>({data:n.data,...n.props}),[n.data,n.props]),w={width:`${r.width-4}px`,height:`${r.height-4}px`,left:`${r.absolute.left?0:"auto"}`,top:`${r.absolute.top?0:"auto"}`,right:`${r.absolute.left?"auto":0}`,bottom:`${r.absolute.top?"auto":0}`};c.current=`rotate(${r.rotate}deg)`,C.current=r.startY,p.current=r.startX;const I=o.getUnit(n.unitId),_=s.useMemo(()=>b?v.jsx(b,{...d,unitId:n.unitId,unit:I,floatDomId:n.id,context:{root:l}}):null,[b,d]);return r?v.jsx("div",{ref:i,className:"univer-absolute univer-z-10 univer-origin-center univer-overflow-hidden",style:{top:C.current,left:p.current,width:Math.max(r.endX-r.startX-2,0),height:Math.max(r.endY-r.startY-2,0),transform:c.current},onPointerMove:S=>{n.onPointerMove(S.nativeEvent)},onPointerDown:S=>{n.onPointerDown(S.nativeEvent)},onPointerUp:S=>{n.onPointerUp(S.nativeEvent)},onWheel:S=>{n.onWheel(S.nativeEvent)},children:v.jsx("div",{ref:l,id:t,className:"univer-absolute univer-overflow-hidden",style:{...w},children:_})}):null});h.BuiltInUIPart=i1,h.COLOR_PICKER_COMPONENT=P9,h.COMMON_LABEL_COMPONENT=T9,h.CanvasFloatDomService=he,h.CanvasPopup=We,h.CanvasPopupService=ze,h.CommonLabel=N9,h.ComponentContainer=p1,h.ComponentManager=v1,h.ContextMenu=I6,h.ContextMenuGroup=o1,h.ContextMenuPosition=S1,h.ContextMenuService=Ye,h.CopyCommand=Pe,h.CopyShortcutItem=u6,h.CustomLabel=f1,h.CutCommand=Fe,h.CutShortcutItem=d6,h.DISABLE_AUTO_FOCUS_KEY=F6,h.DesktopLocalFileService=i3,h.DesktopLocalStorageService=a3,h.DesktopMenu=Ae,h.DesktopSidebarService=c3,h.FILE_PNG_CLIPBOARD_MIME_TYPE=E6,h.FILE_SVG_XML_CLIPBOARD_MIME_TYPE=x4,h.FILE__BMP_CLIPBOARD_MIME_TYPE=O6,h.FILE__JPEG_CLIPBOARD_MIME_TYPE=D6,h.FILE__WEBP_CLIPBOARD_MIME_TYPE=R6,h.FONT_FAMILY_COMPONENT=U9,h.FONT_FAMILY_ITEM_COMPONENT=j9,h.FONT_SIZE_COMPONENT=W9,h.FONT_SIZE_LIST=V2,h.FloatDom=je,h.FloatDomSingle=C6,h.FontFamily=F9,h.FontFamilyItem=B9,h.FontSize=z9,h.GlobalZone=Xe,h.HEADING_ITEM_COMPONENT=$9,h.HEADING_LIST=N2,h.HTML_CLIPBOARD_MIME_TYPE=r3,h.HeadingItem=x9,h.IBeforeCloseService=e3,h.ICanvasPopupService=Ce,h.IClipboardInterfaceService=o3,h.IConfirmService=be,h.IContextMenuService=ee,h.IDialogService=Le,h.IFontService=xe,h.IGalleryService=we,h.IGlobalZoneService=pe,h.ILayoutService=M1,h.ILeftSidebarService=dn,h.ILocalFileService=l3,h.IMenuManagerService=I1,h.IMessageService=ue,h.INotificationService=ne,h.IPlatformService=de,h.IShortcutService=Z1,h.ISidebarService=x1,h.IUIController=te,h.IUIPartsService=w1,h.IZenZoneService=me,h.KeyCode=H1,h.MenuItemType=g1,h.MenuManagerPosition=G1,h.MetaKeys=C1,h.MobileContextMenu=_6,h.MockMessageService=I0,h.PLAIN_TEXT_CLIPBOARD_MIME_TYPE=n3,h.PasteCommand=ke,h.PlatformService=Be,h.PrintFloatDomSingle=x0,h.ProgressBar=G2,h.RectPopup=ve,h.RedoShortcutItem=h6,h.Ribbon=y6,h.RibbonDataGroup=$1,h.RibbonFormulasGroup=ce,h.RibbonInsertGroup=Y1,h.RibbonOthersGroup=Ze,h.RibbonPosition=h1,h.RibbonStartGroup=_1,h.RibbonViewGroup=X1,h.SheetPasteShortKeyCommandName=e4,h.ShortcutPanelService=ie,h.Sidebar=qe,h.SingleCanvasPopup=p6,h.SingleUnitUIController=Qe,h.Slider=E2,h.TestConfirmService=P4,h.ThemeSwitcherService=K1,h.ToggleShortcutPanelOperation=j1,h.ToolbarButton=b6,h.ToolbarItem=Q1,h.UIMenu=Ae,h.UIMenuSchema=r6,h.UIPartsService=Ue,h.UI_PLUGIN_CONFIG_KEY=V1,h.UNIVER_UI_PLUGIN_NAME=P6,h.UNI_DISABLE_CHANGING_FOCUS_KEY=Y2,h.UndoShortcutItem=f6,h.ZIndexManager=W1,h.ZenZone=Je,h.getHeaderFooterMenuHiddenObservable=_2,h.getMenuHiddenObservable=M2,h.handelExcelToJson=R0,h.handelTableToJson=E0,h.handleDomToJson=f3,h.handlePlainToJson=D0,h.handleStringToStyle=_e,h.handleTableColgroup=S0,h.handleTableMergeData=O0,h.handleTableRowGroup=H0,h.imageMimeTypeSet=$4,h.mergeMenuConfigs=R9,h.splitSpanText=j6,h.supportClipboardAPI=H6,h.t=P2,h.textTrim=Me,h.useClickOutSide=x2,h.useComponentsOfPart=m1,h.useConfigValue=A9,h.useDebounceFn=$2,h.useEvent=R1,h.useObservableRef=V9,h.useScrollYOverContainer=Z9,h.useSidebarClick=M0,h.useToolbarItemStatus=L6,h.useUpdateEffect=T2,h.useVirtualList=A2,Object.keys(V).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(h,e)&&Object.defineProperty(h,e,{enumerable:!0,get:()=>V[e]})}),Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/ui/facade
(function(s,d){typeof exports=="object"&&typeof module<"u"?d(require("@univerjs/core/facade"),require("@univerjs/engine-render"),require("@univerjs/ui"),require("@univerjs/core")):typeof define=="function"&&define.amd?define(["@univerjs/core/facade","@univerjs/engine-render","@univerjs/ui","@univerjs/core"],d):(s=typeof globalThis<"u"?globalThis:s||self,d(s.UniverCoreFacade,s.UniverEngineRender,s.UniverUi,s.UniverCore))})(this,(function(s,d,r,c){"use strict";var F=Object.defineProperty;var E=(s,d,r)=>d in s?F(s,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[d]=r;var u=(s,d,r)=>E(s,typeof d!="symbol"?d+"":d,r);var v;var f=Object.getOwnPropertyDescriptor,I=(a,e,t,n)=>{for(var i=n>1?void 0:n?f(e,t):e,o=a.length-1,h;o>=0;o--)(h=a[o])&&(i=h(i)||i);return i},m=(a,e)=>(t,n)=>e(t,n,a);class b extends s.FBase{appendTo(e){const t=typeof e=="string"?e.split("|"):e,n=t.length,i={};let o=i;const h=this.__getSchema();t.forEach((l,P)=>{P===n-1?o[l]=h:o[l]={},o=o[l]}),this._menuManagerService.mergeMenu(i)}}let g=(v=class extends b{constructor(e,t,n,i){super();u(this,"_commandToRegister",new Map);u(this,"_buildingSchema");this._item=e,this._injector=t,this._commandService=n,this._menuManagerService=i;const o=typeof e.action=="string"?e.action:c.generateRandomId(12);o!==e.action&&this._commandToRegister.set(o,e.action),this._buildingSchema={menuItemFactory:()=>({id:e.id,type:r.MenuItemType.BUTTON,icon:e.icon,title:e.title,tooltip:e.tooltip,commandId:o})},typeof e.order<"u"&&(this._buildingSchema.order=e.order)}__getSchema(){return this._commandToRegister.forEach((e,t)=>{this._commandService.hasCommand(t)||this._commandService.registerCommand({id:t,type:c.CommandType.COMMAND,handler:e})}),{[this._item.id]:this._buildingSchema}}},u(v,"RibbonStartGroup",r.RibbonStartGroup),u(v,"RibbonPosition",r.RibbonPosition),u(v,"MenuManagerPosition",r.MenuManagerPosition),v);g=I([m(1,c.Inject(c.Injector)),m(2,c.ICommandService),m(3,r.IMenuManagerService)],g);let p=class extends b{constructor(e,t,n){super();u(this,"_menuByGroups",[]);u(this,"_submenus",[]);u(this,"_buildingSchema");this._item=e,this._injector=t,this._menuManagerService=n,this._buildingSchema={menuItemFactory:()=>({id:e.id,type:r.MenuItemType.SUBITEMS,icon:e.icon,title:e.title,tooltip:e.tooltip})},typeof e.order<"u"&&(this._buildingSchema.order=e.order)}addSubmenu(e){return this._submenus.push(e),this}addSeparator(){return this._menuByGroups.push(this._submenus),this._submenus=[],this}__getSchema(){const e={};return this.addSeparator(),this._menuByGroups.forEach((t,n)=>{const i={};t.forEach(o=>{Object.assign(i,o.__getSchema())}),e[`${this._item.id}-group-${n}`]=i}),{[this._item.id]:Object.assign(this._buildingSchema,e)}}};p=I([m(1,c.Inject(c.Injector)),m(2,r.IMenuManagerService)],p);var C=Object.getOwnPropertyDescriptor,j=(a,e,t,n)=>{for(var i=n>1?void 0:n?C(e,t):e,o=a.length-1,h;o>=0;o--)(h=a[o])&&(i=h(i)||i);return i},S=(a,e)=>(t,n)=>e(t,n,a);let _=class extends s.FBase{constructor(e,t,n,i){super();u(this,"_forceDisableDisposable",null);this._injector=e,this._renderManagerService=t,this._univerInstanceService=n,this._shortcutService=i}enableShortcut(){var e;return(e=this._forceDisableDisposable)==null||e.dispose(),this._forceDisableDisposable=null,this}disableShortcut(){return this._forceDisableDisposable||(this._forceDisableDisposable=this._shortcutService.forceDisable()),this}triggerShortcut(e){const t=this._univerInstanceService.getCurrentUnitForType(c.UniverInstanceType.UNIVER_SHEET);if(!t)return;const n=this._renderManagerService.getRenderById(t.getUnitId());return n?(n.engine.getCanvasElement().dispatchEvent(e),this._shortcutService.dispatch(e)):void 0}dispatchShortcutEvent(e){return this._shortcutService.dispatch(e)}};_=j([S(0,c.Inject(c.Injector)),S(1,c.Inject(d.IRenderManagerService)),S(2,c.IUniverInstanceService),S(3,r.IShortcutService)],_);class M extends s.FUniver{getURL(){return new URL(window.location.href)}getShortcut(){return this._injector.createInstance(_)}copy(){return this._commandService.executeCommand(r.CopyCommand.id)}paste(){return this._commandService.executeCommand(r.PasteCommand.id)}createMenu(e){return this._injector.createInstance(g,e)}createSubmenu(e){return this._injector.createInstance(p,e)}openSiderbar(e){return this._injector.get(r.ISidebarService).open(e)}openSidebar(e){return this.openSiderbar(e)}openDialog(e){const n=this._injector.get(r.IDialogService).open({...e,onClose:()=>{n.dispose()}});return n}getComponentManager(){return this._injector.get(r.ComponentManager)}showMessage(e){return this._injector.get(r.IMessageService).show(e),this}setUIVisible(e,t){return this._injector.get(r.IUIPartsService).setUIVisible(e,t),this}isUIVisible(e){return this._injector.get(r.IUIPartsService).isUIVisible(e)}registerUIPart(e,t){return this._injector.get(r.IUIPartsService).registerComponent(e,()=>r.connectInjector(t,this._injector))}registerComponent(e,t,n){const i=this._injector.get(r.ComponentManager);return this.disposeWithMe(i.register(e,t,n))}setCurrent(e){if(!this._injector.get(d.IRenderManagerService).getRenderById(e))throw new Error("Unit not found");this._univerInstanceService.setCurrentUnitForType(e)}addFonts(e){const t=this._injector.get(r.IFontService);e.forEach(n=>{t.addFont({...n,isCustom:!0})})}}s.FUniver.extend(M);class U extends s.FHooks{onBeforeCopy(e){return this._injector.get(c.ICommandService).beforeCommandExecuted(n=>{n.id===r.CopyCommand.id&&e()})}onCopy(e){return this._injector.get(c.ICommandService).onCommandExecuted(n=>{n.id===r.CopyCommand.id&&e()})}onBeforePaste(e){return this._injector.get(c.ICommandService).beforeCommandExecuted(n=>{n.id===r.PasteCommand.id&&e()})}onPaste(e){return this._injector.get(c.ICommandService).onCommandExecuted(n=>{(n.id===r.PasteCommand.id||n.id===r.SheetPasteShortKeyCommandName)&&e()})}}s.FHooks.extend(U);class y extends s.FEnum{get BuiltInUIPart(){return r.BuiltInUIPart}get KeyCode(){return r.KeyCode}}s.FEnum.extend(y)}));


// @univerjs/docs/index
(function(l,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("@univerjs/core"),require("@univerjs/engine-render"),require("rxjs")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/engine-render","rxjs"],r):(l=typeof globalThis<"u"?globalThis:l||self,r(l.UniverDocs={},l.UniverCore,l.UniverEngineRender,l.rxjs))})(this,(function(l,r,v,p){"use strict";var de=Object.defineProperty;var ge=(l,r,v)=>r in l?de(l,r,{enumerable:!0,configurable:!0,writable:!0,value:v}):l[r]=v;var g=(l,r,v)=>ge(l,typeof r!="symbol"?r+"":r,v);var w;const M={id:"doc.operation.set-selections",type:r.CommandType.OPERATION,handler:()=>!0};var L=Object.getOwnPropertyDescriptor,G=(c,s,e,t)=>{for(var n=t>1?void 0:t?L(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},N=(c,s)=>(e,t)=>s(e,t,c);l.DocSelectionManagerService=class extends r.RxDisposable{constructor(e,t){super();g(this,"_currentSelection",null);g(this,"_textSelectionInfo",new Map);g(this,"_textSelection$",new p.Subject);g(this,"textSelection$",this._textSelection$.asObservable());g(this,"_refreshSelection$",new p.BehaviorSubject(null));g(this,"refreshSelection$",this._refreshSelection$.asObservable());this._commandService=e,this._univerInstanceService=t,this._listenCurrentUnit()}_listenCurrentUnit(){this._univerInstanceService.getCurrentTypeOfUnit$(r.UniverInstanceType.UNIVER_DOC).pipe(p.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;const t=e.getUnitId();this._setCurrentSelectionNotRefresh({unitId:t,subUnitId:t})})}__getCurrentSelection(){return this._currentSelection}getSelectionInfo(e=this._currentSelection){return this._getTextRanges(e)}refreshSelection(e=this._currentSelection){e!=null&&this._refresh(e)}__TEST_ONLY_setCurrentSelection(e){this._currentSelection=e,this._refresh(e)}getTextRanges(e=this._currentSelection){var t;return(t=this._getTextRanges(e))==null?void 0:t.textRanges}getRectRanges(e=this._currentSelection){var t;return(t=this._getTextRanges(e))==null?void 0:t.rectRanges}getDocRanges(e=this._currentSelection){var o,a;const t=(o=this.getTextRanges(e))!=null?o:[],n=(a=this.getRectRanges(e))!=null?a:[];return[...t,...n].filter(u=>u.startOffset!=null&&u.endOffset!=null).sort((u,d)=>u.startOffset>d.startOffset?1:u.startOffset<d.startOffset?-1:0)}getActiveTextRange(){const e=this._getTextRanges(this._currentSelection);if(e==null)return;const{textRanges:t}=e;return t.find(n=>n.isActive)}getActiveRectRange(){const e=this._getTextRanges(this._currentSelection);if(e==null)return;const{rectRanges:t}=e;return t.find(n=>n.isActive)}__TEST_ONLY_add(e,t=!0){this._currentSelection!=null&&this._addByParam({...this._currentSelection,textRanges:e,rectRanges:[],segmentId:"",segmentPage:-1,isEditing:t,style:v.NORMAL_TEXT_SELECTION_PLUGIN_STYLE})}replaceTextRanges(e,t=!0,n){return this.replaceDocRanges(e,this._currentSelection,t,n)}replaceDocRanges(e,t=this._currentSelection,n=!0,i){if(t==null)return;const{unitId:o,subUnitId:a}=t;this._refreshSelection$.next({unitId:o,subUnitId:a,docRanges:e,isEditing:n,options:i})}__replaceTextRangesWithNoRefresh(e,t){if(this._currentSelection==null)return;const n={...e,...t};this._replaceByParam(n),this._textSelection$.next(n);const{unitId:i,subUnitId:o,segmentId:a,style:u,textRanges:d,rectRanges:h,isEditing:S}=n,I=[...d,...h].filter(_=>_.startOffset!=null&&_.endOffset!=null).sort((_,f)=>_.startOffset>f.startOffset?1:_.startOffset<f.startOffset?-1:0);this._commandService.executeCommand(M.id,{unitId:i,subUnitId:o,segmentId:a,style:u,isEditing:S,ranges:I})}dispose(){this._textSelection$.complete(),this._refreshSelection$.complete()}_setCurrentSelectionNotRefresh(e){this._currentSelection=e}_getTextRanges(e){var i;if(e==null)return;const{unitId:t,subUnitId:n=""}=e;return(i=this._textSelectionInfo.get(t))==null?void 0:i.get(n)}_refresh(e){const t=this._getTextRanges(e);if(t==null)return;const{textRanges:n,rectRanges:i}=t,o=[...n,...i],{unitId:a,subUnitId:u}=e;this._refreshSelection$.next({unitId:a,subUnitId:u,docRanges:o,isEditing:!1})}_replaceByParam(e){const{unitId:t,subUnitId:n,...i}=e;this._textSelectionInfo.has(t)||this._textSelectionInfo.set(t,new Map),this._textSelectionInfo.get(t).set(n,{...i})}_addByParam(e){const{unitId:t,subUnitId:n,...i}=e;this._textSelectionInfo.has(t)||this._textSelectionInfo.set(t,new Map);const o=this._textSelectionInfo.get(t);o.has(n)?o.get(n).textRanges.push(...e.textRanges):o.set(n,{...i})}},l.DocSelectionManagerService=G([N(0,r.ICommandService),N(1,r.IUniverInstanceService)],l.DocSelectionManagerService);var z=Object.getOwnPropertyDescriptor,W=(c,s,e,t)=>{for(var n=t>1?void 0:t?z(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},$=(c,s)=>(e,t)=>s(e,t,c);l.DocSkeletonManagerService=class extends r.RxDisposable{constructor(e,t,n){super();g(this,"_skeleton");g(this,"_docViewModel");g(this,"_currentSkeleton$",new p.BehaviorSubject(null));g(this,"currentSkeleton$",this._currentSkeleton$.asObservable());g(this,"_currentSkeletonBefore$",new p.BehaviorSubject(null));g(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable());g(this,"_currentViewModel$",new p.BehaviorSubject(null));g(this,"currentViewModel$",this._currentViewModel$.asObservable());this._context=e,this._localeService=t,this._univerInstanceService=n,this._init(),this._univerInstanceService.getCurrentTypeOfUnit$(r.UniverInstanceType.UNIVER_DOC).pipe(p.takeUntil(this.dispose$)).subscribe(i=>{i&&i.getUnitId()===this._context.unitId&&this._update(i)})}dispose(){super.dispose(),this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete()}getSkeleton(){return this._skeleton}getViewModel(){return this._docViewModel}_init(){const e=this._context.unit;this._update(e)}_update(e){const t=this._context.unitId;if(e.getBody()==null)return;this._docViewModel&&r.isInternalEditorID(t)?(this._docViewModel.reset(e),this._context.unit=e):this._docViewModel||(this._docViewModel=this._buildDocViewModel(e)),this._skeleton||(this._skeleton=this._buildSkeleton(this._docViewModel));const n=this._skeleton;n.calculate(),this._currentSkeletonBefore$.next(n),this._currentSkeleton$.next(n),this._currentViewModel$.next(this._docViewModel)}_buildSkeleton(e){return v.DocumentSkeleton.create(e,this._localeService)}_buildDocViewModel(e){return new v.DocumentViewModel(e)}},l.DocSkeletonManagerService=W([$(1,r.Inject(r.LocaleService)),$(2,r.IUniverInstanceService)],l.DocSkeletonManagerService);class y extends r.RxDisposable{constructor(){super();g(this,"_docStateChangeParams$",new p.BehaviorSubject(null));g(this,"docStateChangeParams$",this._docStateChangeParams$.asObservable())}emitStateChangeInfo(e){this._docStateChangeParams$.next(e)}dispose(){super.dispose(),this._docStateChangeParams$.complete()}}const P="doc.mutation.rich-text-editing",O={id:P,type:r.CommandType.MUTATION,handler:(c,s)=>{var X,F;const{unitId:e,segmentId:t="",actions:n,textRanges:i,prevTextRanges:o,trigger:a,noHistory:u,isCompositionEnd:d,noNeedSetTextRange:h,debounce:S,isEditing:I=!0,isSync:_,syncer:f}=s,D=c.get(r.IUniverInstanceService),R=c.get(v.IRenderManagerService),C=c.get(y),m=D.getUniverDocInstance(e),V=(X=R.getRenderById(e))==null?void 0:X.with(l.DocSkeletonManagerService).getViewModel();if(m==null||V==null)throw new Error(`DocumentDataModel or documentViewModel not found for unitId: ${e}`);const j=c.get(l.DocSelectionManagerService),E=(F=j.getDocRanges())!=null?F:[],le=!!m.getSnapshot().disabled;if(r.JSONX.isNoop(n)||n&&n.length===0||le)return{unitId:e,actions:[],textRanges:E};const A=r.JSONX.invertWithDoc(n,m.getSnapshot());m.apply(n),V.reset(m),!h&&i&&a!=null&&!_&&queueMicrotask(()=>{j.replaceDocRanges(i,{unitId:e,subUnitId:e},I,s.options)});const ue={commandId:P,unitId:e,segmentId:t,trigger:a,noHistory:u,debounce:S,redoState:{actions:n,textRanges:i},undoState:{actions:A,textRanges:o!=null?o:E},isCompositionEnd:d,isSync:_,syncer:f};return C.emitStateChangeInfo(ue),{unitId:e,actions:A,textRanges:E}}},J={id:"doc.mutation.rename-doc",type:r.CommandType.MUTATION,handler:(c,s)=>{const t=c.get(r.IUniverInstanceService).getUnit(s.unitId,r.UniverInstanceType.UNIVER_DOC);return t?(t.setName(s.name),!0):!1}},Y="docs.config",B={};var K=Object.getOwnPropertyDescriptor,q=(c,s,e,t)=>{for(var n=t>1?void 0:t?K(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},U=(c,s)=>(e,t)=>s(e,t,c);let T=class extends r.Disposable{constructor(c,s,e){super(),this._commandService=c,this._textSelectionManagerService=s,this._univerInstanceService=e,this._initSelectionChange()}_transformCustomRange(c,s){var o;const{startOffset:e,endOffset:t,collapsed:n}=s,i=(o=c.getCustomRanges())==null?void 0:o.filter(a=>!a.wholeEntity||e<=a.startIndex&&t>a.endIndex?!1:n?a.startIndex<e&&a.endIndex>=t:r.BuildTextUtils.range.isIntersects(e,t-1,a.startIndex,a.endIndex));if(i!=null&&i.length){let a=e,u=t;return i.forEach(d=>{a=Math.min(d.startIndex,a),u=Math.max(d.endIndex+1,u)}),{...s,startOffset:a,endOffset:u,collapsed:a===u}}return s}_initSelectionChange(){this.disposeWithMe(this._commandService.onCommandExecuted(c=>{if(c.id===M.id){const s=c.params,{unitId:e,ranges:t,isEditing:n}=s,i=this._univerInstanceService.getUnit(e);if(!i)return;const o=t.map(a=>this._transformCustomRange(i,a));o.some((a,u)=>t[u]!==a)&&this._textSelectionManagerService.replaceTextRanges(o,n)}}))}};T=q([U(0,r.ICommandService),U(1,r.Inject(l.DocSelectionManagerService)),U(2,r.IUniverInstanceService)],T);var H=Object.getOwnPropertyDescriptor,Q=(c,s,e,t)=>{for(var n=t>1?void 0:t?H(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},k=(c,s)=>(e,t)=>s(e,t,c);const Z="DOCS_PLUGIN";l.UniverDocsPlugin=(w=class extends r.Plugin{constructor(s=B,e,t){super(),this._config=s,this._injector=e,this._configService=t;const{...n}=r.merge({},B,this._config);this._configService.setConfig(Y,n)}onStarting(){this._initializeDependencies(),this._initializeCommands()}_initializeCommands(){[O,J,M].forEach(s=>{this._injector.get(r.ICommandService).registerCommand(s)})}_initializeDependencies(){[[l.DocSelectionManagerService],[y],[T]].forEach(s=>this._injector.add(s))}onReady(){this._injector.get(T)}},g(w,"pluginName",Z),w),l.UniverDocsPlugin=Q([k(1,r.Inject(r.Injector)),k(2,r.IConfigService)],l.UniverDocsPlugin);const ee=r.createInterceptorKey("CUSTOM_RANGE"),te=r.createInterceptorKey("CUSTOM_DECORATION"),x={CUSTOM_RANGE:ee,CUSTOM_DECORATION:te};var ne=Object.getOwnPropertyDescriptor,ie=(c,s,e,t)=>{for(var n=t>1?void 0:t?ne(s,e):s,i=c.length-1,o;i>=0;i--)(o=c[i])&&(n=o(n)||n);return n},se=(c,s)=>(e,t)=>s(e,t,c);l.DocInterceptorService=class extends r.Disposable{constructor(e,t){super();g(this,"_interceptorsByName",new Map);this._context=e,this._docSkeletonManagerService=t;const n=this._docSkeletonManagerService.getViewModel(),i=n.getDataModel().getUnitId();if(i===r.DOCS_NORMAL_EDITOR_UNIT_ID_KEY||i===r.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)return;this.disposeWithMe(this.interceptDocumentViewModel(n)),this.disposeWithMe(this.intercept(x.CUSTOM_RANGE,{priority:-1,handler:(a,u,d)=>d(a)}));let o=new r.DisposableCollection;n.segmentViewModels$.subscribe(a=>{o.dispose(),o=new r.DisposableCollection,a.forEach(u=>{o.add(this.interceptDocumentViewModel(u))})}),this.disposeWithMe(o)}intercept(e,t){const n=e;this._interceptorsByName.has(n)||this._interceptorsByName.set(n,[]);const i=this._interceptorsByName.get(n);return i.push(t),this._interceptorsByName.set(n,i.sort((o,a)=>{var u,d;return((u=a.priority)!=null?u:0)-((d=o.priority)!=null?d:0)})),this.disposeWithMe(r.toDisposable(()=>r.remove(this._interceptorsByName.get(n),t)))}fetchThroughInterceptors(e){const t=e,n=this._interceptorsByName.get(t);return r.composeInterceptors(n||[])}interceptDocumentViewModel(e){const t=new r.DisposableCollection;return t.add(e.registerCustomRangeInterceptor({getCustomRange:n=>{var i;return this.fetchThroughInterceptors(x.CUSTOM_RANGE)(e.getCustomRangeRaw(n),{index:n,unitId:e.getDataModel().getUnitId(),customRanges:(i=e.getDataModel().getCustomRanges())!=null?i:[]})},getCustomDecoration:n=>{var i;return this.fetchThroughInterceptors(x.CUSTOM_DECORATION)(e.getCustomDecorationRaw(n),{index:n,unitId:e.getDataModel().getUnitId(),customDecorations:(i=e.getDataModel().getCustomDecorations())!=null?i:[]})}})),t}},l.DocInterceptorService=ie([se(1,r.Inject(l.DocSkeletonManagerService))],l.DocInterceptorService);function b(c,s=""){if(!s)return["body"];const{headers:e,footers:t}=c.getSnapshot();if(e==null&&t==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[s])!=null)return["headers",s,"body"];if((t==null?void 0:t[s])!=null)return["footers",s,"body"];throw new Error("Segment id not found in headers or footers")}function re(c,s,e){const{unitId:t,segmentId:n}=s,o=c.get(r.IUniverInstanceService).getUnit(t);if(!o)return!1;const a={id:O.id,params:{unitId:s.unitId,actions:[],textRanges:void 0}},u=r.JSONX.getInstance(),d=r.BuildTextUtils.customRange.add({...s,body:e});if(!d)return!1;const h=b(o,n);return a.params.actions=u.editOp(d.serialize(),h),a}function oe(c,s){var m;const{rangeId:e,rangeType:t,wholeEntity:n,properties:i,unitId:o,selections:a}=s,u=c.get(l.DocSelectionManagerService),d=c.get(r.IUniverInstanceService),h=a!=null?a:u.getTextRanges({unitId:o,subUnitId:o}),S=(m=h==null?void 0:h[0])==null?void 0:m.segmentId;if(!(h!=null&&h.length))return!1;const I=d.getUnit(o,r.UniverInstanceType.UNIVER_DOC);if(!I)return!1;const _=I.getSelfOrHeaderFooterModel(S).getBody();if(!_)return!1;const f=r.BuildTextUtils.customRange.add({ranges:h,rangeId:e,rangeType:t,segmentId:S,wholeEntity:n,properties:i,body:_});if(!f)return!1;const D=r.JSONX.getInstance(),R={id:O.id,params:{unitId:o,actions:[],textRanges:f.selections,segmentId:S},textX:f},C=b(I,S);return R.params.actions=D.editOp(f.serialize(),C),R}function ce(c,s){const{unitId:e,segmentId:t,insert:n}=s,o=c.get(r.IUniverInstanceService).getUnit(e);if(!o)return!1;const a={id:O.id,params:{unitId:s.unitId,actions:[],textRanges:void 0,segmentId:t}},u=r.JSONX.getInstance(),d=r.BuildTextUtils.customRange.delete({documentDataModel:o,rangeId:s.rangeId,insert:n,segmentId:t});if(!d)return!1;const h=b(o,t);return a.params.actions=u.editOp(d.serialize(),h),a.params.textRanges=d.selections,a}function ae(c,s){var f,D,R,C;const{unitId:e,body:t,doc:n}=s;let i=n;if(i||(i=c.get(r.IUniverInstanceService).getUnit(e)),!i)return!1;const o=(f=s.selection)==null?void 0:f.segmentId,a=(D=i.getSelfOrHeaderFooterModel(o))==null?void 0:D.getBody();if(!a)return!1;const u=c.get(l.DocSelectionManagerService),d=(R=s.selection)!=null?R:u.getActiveTextRange();if(!d||!a)return!1;const h=(C=s.textRanges)!=null?C:[{startOffset:d.startOffset+t.dataStream.length,endOffset:d.startOffset+t.dataStream.length,collapsed:!0,segmentId:o}],S=r.BuildTextUtils.selection.replace({selection:d,body:t,doc:i});if(!S)return!1;const I={id:O.id,params:{unitId:e,actions:[],textRanges:h,debounce:!0,segmentId:o},textX:S},_=r.JSONX.getInstance();return I.params.actions=_.editOp(S.serialize()),I}l.DOC_INTERCEPTOR_POINT=x,l.DocStateEmitService=y,l.RichTextEditingMutation=O,l.SetTextSelectionsOperation=M,l.addCustomRangeBySelectionFactory=oe,l.addCustomRangeFactory=re,l.deleteCustomRangeFactory=ce,l.replaceSelectionFactory=ae,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/docs-ui/index
(function(y,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("@univerjs/core"),require("@univerjs/docs"),require("@univerjs/engine-render"),require("@univerjs/ui"),require("@univerjs/drawing"),require("rxjs"),require("react"),require("rxjs/operators"),require("react/jsx-runtime"),require("@univerjs/design")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/docs","@univerjs/engine-render","@univerjs/ui","@univerjs/drawing","rxjs","react","rxjs/operators","react/jsx-runtime","@univerjs/design"],s):(y=typeof globalThis<"u"?globalThis:y||self,s(y.UniverDocsUi={},y.UniverCore,y.UniverDocs,y.UniverEngineRender,y.UniverUi,y.UniverDrawing,y.rxjs,y.React,y.rxjs.operators,y.React,y.UniverDesign))})(this,(function(y,s,D,_,I,Mn,L,w,lt,P,J){"use strict";var MA=Object.defineProperty;var xA=(y,s,D)=>s in y?MA(y,s,{enumerable:!0,configurable:!0,writable:!0,value:D}):y[s]=D;var B=(y,s,D)=>xA(y,typeof s!="symbol"?s+"":s,D);var ga=Object.getOwnPropertyDescriptor,ma=(o,t,e,n)=>{for(var i=n>1?void 0:n?ga(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ni=(o,t)=>(e,n)=>t(e,n,o);y.DocAutoFormatService=class extends s.Disposable{constructor(e,n){super();B(this,"_matches",new Map);this._univerInstanceService=e,this._textSelectionManagerService=n}registerAutoFormat(e){const n=this._matches.get(e.id);return n?(n.push(e),n.sort((i,a)=>{var r,c;return((r=a.priority)!=null?r:0)-((c=i.priority)!=null?c:0)})):this._matches.set(e.id,[e]),s.toDisposable(()=>{const i=this._matches.get(e.id);if(i){const a=i.findIndex(r=>r===e);a>=0&&i.splice(a,1)}})}onAutoFormat(e,n){var l,A,d,u,m,h,g,p,f;const i=(l=this._matches.get(e))!=null?l:[],a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=this._textSelectionManagerService.getDocRanges(),c=(A=r.find(S=>S.isActive))!=null?A:r[0];if(a&&c){const S=a.getSelfOrHeaderFooterModel(c.segmentId),E={unit:S,selection:c,isBody:!c.segmentId,paragraphs:s.BuildTextUtils.range.getParagraphsInRange(c,(u=(d=S.getBody())==null?void 0:d.paragraphs)!=null?u:[],(h=(m=S.getBody())==null?void 0:m.dataStream)!=null?h:""),customRanges:s.BuildTextUtils.customRange.getCustomRangesInterestsWithSelection(c,(p=(g=S.getBody())==null?void 0:g.customRanges)!=null?p:[]),commandId:e,commandParams:n},C=i.find(T=>T.match(E));return(f=C==null?void 0:C.getMutations(E))!=null?f:[]}return[]}},y.DocAutoFormatService=ma([ni(0,s.IUniverInstanceService),ni(1,s.Inject(D.DocSelectionManagerService))],y.DocAutoFormatService);const oi={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},ii={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},si="DOC_UI_PLUGIN";var de=(o=>(o.MAIN="__Document_Render_Main__",o.BACKGROUND="__Document_Render_Background__",o))(de||{}),ae=(o=>(o.VIEW_MAIN="viewMain",o.VIEW_TOP="viewTop",o.VIEW_LEFT="viewLeft",o.VIEW_LEFT_TOP="viewLeftTop",o))(ae||{});const ai=0,wt=2,ri=4,xn=10,pa="normalTextSelectionPluginName";function Ie(o){const{mainComponent:t,scene:e,engine:n,components:i}=o,a=t,r=i.get(de.BACKGROUND);return{document:a,docBackground:r,scene:e,engine:n}}function ci(o,t){const e=o.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!e)return null;const n=e.getUnitId(),i=t.getRenderById(n);if(i==null)return;const{mainComponent:a,scene:r,engine:c,components:l}=i,A=a,d=l.get(de.BACKGROUND);return{document:A,docBackground:d,scene:r,engine:c}}function fa(o,t){const e=t.getRenderById(o);if(e==null)return;const{mainComponent:n,scene:i,engine:a,components:r}=e,c=n,l=r.get(de.BACKGROUND);return{document:c,docBackground:l,scene:i,engine:a}}function li(o){const{unitId:t,ranges:e,id:n,type:i,segmentId:a}=o,r={id:D.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0,segmentId:a}},c=s.JSONX.getInstance(),l=s.BuildTextUtils.customDecoration.add({ranges:e,id:n,type:i});return r.params.actions=c.editOp(l.serialize()),r}function Sa(o,t){const{segmentId:e,id:n,type:i,unitId:a}=t,r=o.get(D.DocSelectionManagerService),c=o.get(s.IUniverInstanceService),l=a?c.getUnit(a,s.UniverInstanceType.UNIVER_DOC):c.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!l)return!1;const A=l.getUnitId(),d=r.getTextRanges({unitId:A,subUnitId:A});return!d||!l.getBody()?!1:li({unitId:A,ranges:d,id:n,type:i,segmentId:e})}function Ia(o,t){const{unitId:e,id:n,segmentId:i}=t,r=o.get(s.IUniverInstanceService).getUnit(e);if(!r)return!1;const c={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:void 0,segmentId:i}},l=s.BuildTextUtils.customDecoration.delete({id:n,segmentId:i,documentDataModel:r});if(!l)return!1;const A=s.JSONX.getInstance();return c.params.actions=A.editOp(l.serialize()),c}function va(o,t){return t.some(e=>o.startIndex>e.startIndex&&o.startIndex<e.endIndex)}function Ut(o,t,e,n,i){const{textRuns:a=[],dataStream:r}=o,c=i&&r.startsWith("="),l={st:0,ed:0,ts:{}};if(c)return l;for(let A=a.length-1;A>=0;A--){const d=a[A],{st:u,ed:m}=d;t>u&&t<=m&&(l.st=u,l.ed=m,l.ts={...l.ts,...d.ts})}if(t===0){const A=a==null?void 0:a[0];A&&A.st===0&&(l.ts={...l.ts,...A.ts})}return n&&(l.ts={...l.ts,...n}),l}function Dn(o,t,e){if(e){const i=o.find(a=>t>=a.startIndex&&t<=a.endIndex+1);return i!=null&&i.wholeEntity?null:i}const n=o.find(i=>t>i.startIndex&&t<=i.endIndex);return n!=null&&n.wholeEntity?null:n}function Bn(o,t){return o.filter(e=>t>e.startIndex&&t<=e.endIndex)}function Ea(o){return{left:o.positionH.posOffset,top:o.positionV.posOffset,width:o.size.width,height:o.size.height}}function Ca(o,t=0,e=0){return{size:{width:o.width,height:o.height},positionH:{relativeFrom:s.ObjectRelativeFromH.MARGIN,posOffset:(o.left||0)-t},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:(o.top||0)-e},angle:o.angle||0}}const ke={id:"doc.command.tab",type:s.CommandType.COMMAND,async handler(o,t){const n=o.get(y.DocAutoFormatService).onAutoFormat(ke.id,t);return(await s.sequenceExecuteAsync(n,o.get(s.ICommandService))).result}},dt={id:"doc.command.after-space",type:s.CommandType.COMMAND,async handler(o){const e=o.get(y.DocAutoFormatService).onAutoFormat(dt.id);return(await s.sequenceExecuteAsync(e,o.get(s.ICommandService))).result}},ze={id:"doc.command.enter",type:s.CommandType.COMMAND,async handler(o){const e=o.get(y.DocAutoFormatService).onAutoFormat(ze.id);return(await s.sequenceExecuteAsync(e,o.get(s.ICommandService))).result}};var Ta=Object.getOwnPropertyDescriptor,ya=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ta(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},_n=(o,t)=>(e,n)=>t(e,n,o);const ba=11,Oa=9,Lt={ff:"Arial",fs:ba};let ve=class extends s.Disposable{constructor(t,e,n){super();B(this,"_cacheStyle",null);this._textSelectionManagerService=t,this._univerInstanceService=e,this._renderManagerService=n,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){var r;const t=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(t==null)return{...Lt};const e=t==null?void 0:t.getUnitId(),n=(r=this._renderManagerService.getRenderById(e))==null?void 0:r.with(D.DocSkeletonManagerService),i=n==null?void 0:n.getViewModel();return i==null?{...Lt}:i.getEditArea()===_.DocumentEditArea.BODY?{...Lt}:{...Lt,fs:Oa}}setStyleCache(t){this._cacheStyle={...this._cacheStyle,...t}}_clearStyleCache(){this._cacheStyle=null}};ve=ya([_n(0,s.Inject(D.DocSelectionManagerService)),_n(1,s.IUniverInstanceService),_n(2,_.IRenderManagerService)],ve);function re(o,t){var n;return(n=o.get(_.IRenderManagerService).getRenderById(t))==null?void 0:n.with(D.DocSkeletonManagerService)}function Z(o,t=""){if(!t)return["body"];const{headers:e,footers:n}=o.getSnapshot();if(e==null&&n==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[t])!=null)return["headers",t,"body"];if((n==null?void 0:n[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}function Nn(o,t,e){const n=[];for(let i=0,a=o.length;i<a;i++)o[i]===s.DataStreamTreeTokenType.PARAGRAPH&&n.push({startIndex:i});if(t)for(const i of n)t.bullet&&(i.bullet=s.Tools.deepClone(t.bullet)),t.paragraphStyle&&(i.paragraphStyle=s.Tools.deepClone(t.paragraphStyle),delete i.paragraphStyle.borderBottom,t.paragraphStyle.headingId&&(i.paragraphStyle.headingId=s.generateRandomId(6)));if(e)for(const i of n)i.paragraphStyle||(i.paragraphStyle={}),i.paragraphStyle.borderBottom=e;return n}const Qt={id:"doc.command.break-line",type:s.CommandType.COMMAND,handler:(o,t)=>{var Q,j,X,k,W;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=o.get(ve),r=(Q=t==null?void 0:t.textRange)!=null?Q:e.getActiveTextRange(),c=e.getRectRanges();if(r==null)return!1;if(c&&c.length){const{startOffset:G}=r;return e.replaceDocRanges([{startOffset:G,endOffset:G}]),!0}const{horizontalLine:l}=t!=null?t:{},{segmentId:A}=r,d=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A!=null?A:"").getBody();if(d==null||u==null)return!1;const m=d.getUnitId(),{startOffset:h,endOffset:g}=r,f=((j=u.paragraphs)!=null?j:[]).find(G=>G.startIndex>=h);if(!f)return!1;const S=h===f.startIndex,E=f.startIndex,C=a.getDefaultStyle(),T=a.getStyleCache(),R=Ut(u,g,C,T),v={dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Nn(s.DataStreamTreeTokenType.PARAGRAPH,f,l),textRuns:[{st:0,ed:1,ts:{...R.ts}}]};if(d==null)return!1;const O=e.getActiveTextRange();if(u==null)return!1;const{collapsed:M}=r,b=v.dataStream.length,N=[{startOffset:h+b,endOffset:h+b,style:O==null?void 0:O.style,collapsed:M}],x={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:N,debounce:!0}},U=new s.TextX,F=s.JSONX.getInstance();if(M)h>0&&U.push({t:s.TextXActionType.RETAIN,len:h}),U.push({t:s.TextXActionType.INSERT,body:v,len:v.dataStream.length});else{const G=s.BuildTextUtils.selection.delete([r],u,0,v);U.push(...G)}(((X=f.bullet)==null?void 0:X.listType)===s.PresetListType.CHECK_LIST_CHECKED||(k=f.paragraphStyle)!=null&&k.headingId)&&(r.endOffset<E&&U.push({t:s.TextXActionType.RETAIN,len:E-r.endOffset}),U.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...f,paragraphStyle:{...f.paragraphStyle,...S?{headingId:void 0,namedStyleType:void 0}:null},startIndex:0,bullet:(W=f.paragraphStyle)!=null&&W.headingId?void 0:{...f.bullet,listType:s.PresetListType.CHECK_LIST}}]},coverType:s.UpdateDocsAttributeType.REPLACE})),x.params.textRanges=[{startOffset:h+b,endOffset:h+b,collapsed:M}];const V=Z(d,A);return x.params.actions=F.editOp(U.serialize(),V),!!i.syncExecuteCommand(x.id,x.params)}};var Ft=(o=>(o[o.ABOVE=0]="ABOVE",o[o.BELLOW=1]="BELLOW",o))(Ft||{}),Pn=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(Pn||{});function Ra(o,t){let e=s.DataStreamTreeTokenType.TABLE_START;const n=[],i=[];for(let a=0;a<o;a++){e+=s.DataStreamTreeTokenType.TABLE_ROW_START;for(let r=0;r<t;r++)e+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,n.push({startIndex:e.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),i.push({startIndex:e.length-2});e+=s.DataStreamTreeTokenType.TABLE_ROW_END}return e+=s.DataStreamTreeTokenType.TABLE_END,{dataStream:e,paragraphs:n,sectionBreaks:i}}function Ht(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function kt(o){const t=Ht();return{tableCells:[...new Array(o).fill(null).map(()=>s.Tools.deepClone(t))],trHeight:{val:{v:30},hRule:s.TableRowHeightRule.AUTO}}}function Vt(o){return{size:{type:s.TableSizeType.SPECIFIED,width:{v:o}}}}function wn(o,t,e){const n=Vt(e/t),i=kt(t),a=[...new Array(o).fill(null).map(()=>s.Tools.deepClone(i))],r=[...new Array(t).fill(null).map(()=>s.Tools.deepClone(n))],c=s.generateRandomId(6);return{tableRows:a,tableColumns:r,tableId:c,align:s.TableAlignmentType.START,indent:{v:0},textWrap:s.TableTextWrapType.NONE,position:{positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:s.TableSizeType.UNSPECIFIED,width:{v:e}}}}function At(o,t){if(!o&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const i="";for(const a of t){const{startOffset:r,endOffset:c,segmentId:l}=a;r==null||c==null||l==null||(e=Math.min(e,r),n=Math.max(n,c))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:i}}else if(o){const{startOffset:e,endOffset:n,segmentId:i}=o;return e==null||n==null||i==null?null:{startOffset:e,endOffset:n,segmentId:i}}}function Ma(o){let t=s.DataStreamTreeTokenType.TABLE_ROW_START;const e=[],n=[];for(let i=0;i<o;i++)t+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,e.push({startIndex:t.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:t.length-2});return t+=s.DataStreamTreeTokenType.TABLE_ROW_END,{dataStream:t,paragraphs:e,sectionBreaks:n}}function xa(){const o=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],e=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),e.push({startIndex:2}),{dataStream:o,paragraphs:t,sectionBreaks:e}}function Da(o,t,e){var u,m,h;const{startOffset:n,endOffset:i,segmentId:a}=o,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:i;let l=null;const A=(h=(m=(u=e.getBody())==null?void 0:u.tables)==null?void 0:m.find(g=>c>=g.startIndex&&c<=g.endIndex))==null?void 0:h.tableId;let d=0;for(const g of r.getChildren()){for(const p of g.children){const{children:f}=p,S=f[0];if(S){for(const E of S.children)if(E.startIndex<=c&&c<=E.endIndex){d=S.children.indexOf(E),l=E;break}}if(l)break}if(l)break}return l==null||A==null?null:{offset:t===0?l.startIndex:l.endIndex+1,colCount:l.children.length,tableId:A,insertRowIndex:t===0?d:d+1}}function Ba(o,t,e){var h,g,p;const{startOffset:n,endOffset:i,segmentId:a}=o,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:i,l=(p=(g=(h=e.getBody())==null?void 0:h.tables)==null?void 0:g.find(f=>c>=f.startIndex&&c<=f.endIndex))==null?void 0:p.tableId,A=[];let d=null,u=-1;for(const f of r.getChildren()){for(const S of f.children){const{children:E}=S,C=E[0];if(C){if(c<C.startIndex||c>C.endIndex)continue;d=C;for(const T of C.children){for(const R of T.children){const v=T.children.indexOf(R);if(c>=R.startIndex&&c<=R.endIndex){u=v;break}}if(u!==-1)break}}if(d)break}if(d)break}if(d==null||l==null||u===-1)return null;let m=0;for(const f of d.children){const S=f.children[u],E=t===0?S.startIndex:S.endIndex+1;A.push(E-m),m=E}return{offsets:A,tableId:l,columnIndex:u,rowCount:d.children.length}}function _a(o,t,e){const n=[];let i=t[e].size.width.v,a=0;for(let r=0;r<t.length;r++)a+=t[r].size.width.v;a+=i;for(let r=0;r<t.length;r++)n.push(t[r].size.width.v/a*o);return i=i/a*o,{widths:n,newColWidth:i}}function di(o,t){var m,h,g;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(g=(h=(m=t.getBody())==null?void 0:m.tables)==null?void 0:h.find(p=>e>=p.startIndex&&n<=p.endIndex))==null?void 0:g.tableId,c=[];let l=-1,A=0,d=-1,u=!1;for(const p of a.getChildren()){for(const f of p.children){const{children:S}=f,E=S[0];if(E){if(e<E.startIndex||n>E.endIndex)continue;d=E.startIndex+3;for(const C of E.children){const T=E.children.indexOf(C),{startIndex:R,endIndex:v}=C;e>=R&&e<=v?(l=R,c.push(T),A+=v-R+1):(R>e&&v<n||n>=R&&n<=v)&&(c.push(T),A+=v-R+1),c.length===E.children.length&&(u=!0)}}if(c.length)break}if(c.length)break}return r==null||c.length===0?null:{tableId:r,rowIndexes:c,offset:l,len:A,cursor:d,selectWholeTable:u}}function Na(o,t){var g,p,f;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(f=(p=(g=t.getBody())==null?void 0:g.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null;const A=[];let d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children)for(const v of R.children){const O=R.children.indexOf(v);e>=v.startIndex&&e<=v.endIndex&&(u=O),n>=v.startIndex&&n<=v.endIndex&&(m=O)}}if(l)break}if(l)break}if(l==null||r==null)return null;for(let S=u;S<=m;S++)A.push(S);let h=0;for(const S of l.children){const E=S.children[u],C=S.children[m];c.push({retain:E.startIndex-h,delete:C.endIndex-E.startIndex+1}),h=C.endIndex+1}return d=l.startIndex+3,{offsets:c,tableId:r,columnIndexes:A,cursor:d,selectWholeTable:A.length===l.children[0].children.length,rowCount:l.children.length}}function Ai(o,t){var d,u,m;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(m=(u=(d=t.getBody())==null?void 0:d.tables)==null?void 0:u.find(h=>e>=h.startIndex&&n<=h.endIndex))==null?void 0:m.tableId;let c=-1,l=0,A=-1;for(const h of a.getChildren()){for(const g of h.children){const{children:p}=g,f=p[0];if(f){if(e<f.startIndex||n>f.endIndex)continue;c=f.startIndex,l=f.endIndex-f.startIndex+1,A=f.startIndex}if(f)break}if(l>0)break}return r==null?null:{tableId:r,offset:c,len:l,cursor:A}}function Pa(o,t){var g,p,f;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(f=(p=(g=t.getBody())==null?void 0:g.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null,A=-1,d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children){const v=T.children.indexOf(R);for(const O of R.children){const M=R.children.indexOf(O);e>=O.startIndex&&e<=O.endIndex&&(d=v,u=M),n>=O.startIndex&&n<=O.endIndex&&(m=M)}}}if(l)break}if(l)break}if(l==null||r==null||d===-1)return null;const h=l.children[d];for(let S=u;S<=m;S++){const E=h.children[S];c.push({retain:E.startIndex+1,delete:E.endIndex-E.startIndex-3})}return A=l.startIndex+3,{offsets:c,tableId:r,cursor:A,rowCount:l.children.length}}var Un=(o=>(o[o.NEXT=0]="NEXT",o[o.PREV=1]="PREV",o))(Un||{});function ui(o,t,e){const{startOffset:n}=t;let i=null;for(const A of o.getChildren()){for(const d of A.children){const u=d.children[0];if(u&&n>u.startIndex&&n<u.endIndex){i=u;break}}if(i)break}if(i==null)return null;let a=-1,r=-1,c=null;for(const A of i.children){for(const d of A.children)if(n>d.startIndex&&n<d.endIndex){a=A.children.indexOf(d),r=i.children.indexOf(A),c=A;break}if(a>-1)break}if(a===-1||r===-1||c==null)return null;let l=null;if(e===0){if(l=c.children[a+1],!l){const A=i.children[r+1];A&&(l=A.children[0])}}else if(l=c.children[a-1],!l){const A=i.children[r-1];A&&(l=A.children[A.children.length-1])}if(l){const{startIndex:A,endIndex:d}=l;return{startOffset:A+1,endOffset:d-2}}}function hi(o,t){const e=[],{customBlocks:n=[]}=o;for(const i of t){const{startOffset:a,endOffset:r}=i;if(!(a==null||r==null))for(const c of n){const{startIndex:l}=c;l>=a&&l<r&&e.push(c.blockId)}}return e}function wa(o){return o.some(t=>{const{startNodePosition:e}=t;return e?(e==null?void 0:e.path.indexOf("cells"))>-1:!1})}const Ua=s.SHEET_EDITOR_UNITS,Ln={id:"doc.command.inner-paste",type:s.CommandType.COMMAND,handler:async(o,t)=>{var b,N,x,U,F,V;const{segmentId:e,textRanges:n,doc:i}=t,a=o.get(s.ICommandService),r=o.get(D.DocSelectionManagerService),c=o.get(s.IUniverInstanceService),l=r.getTextRanges(),A=r.getRectRanges(),{body:d,tableSource:u,drawings:m}=i;if(!Array.isArray(l)||l.length===0||d==null)return!1;const h=c.getCurrentUniverDocInstance(),g=h==null?void 0:h.getSelfOrHeaderFooterModel(e).getBody();if(h==null||g==null)return!1;const p=h.getUnitId(),f={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:n,segmentId:e}},S=new s.MemoryCursor;S.reset();const E=new s.TextX,C=s.JSONX.getInstance(),T=[],R=!!((b=d.tables)!=null&&b.length),v=!!((N=d.customBlocks)!=null&&N.length);if(R&&e||R&&wa(l)||l.length&&(A!=null&&A.length))return!1;for(let H=0;H<l.length;H++){const Q=l[H],{startOffset:j,endOffset:X,collapsed:k}=Q,W=j-S.cursor,G=s.Tools.deepClone(d);if(R)for(const q of G.tables){const{tableId:z}=q,$=s.generateRandomId(6);q.tableId=$;const ie=s.Tools.deepClone(u[z]);ie.tableId=$;const fe=C.insertOp(["tableSource",$],ie);T.push(fe)}if(v&&m){const q=(U=(x=h.getSnapshot().drawingsOrder)==null?void 0:x.length)!=null?U:0;for(const z of G.customBlocks){const{blockId:$}=z,ie=s.generateRandomId(6);z.blockId=ie;const fe=s.Tools.deepClone(m[$]);fe.drawingId=ie;const He=C.insertOp(["drawings",ie],fe),Se=C.insertOp(["drawingsOrder",q],ie);T.push(He),T.push(Se)}}const K=Dn((F=g.customRanges)!=null?F:[],X,Ua.includes(p)),Y=Bn((V=g.customDecorations)!=null?V:[],X);if(K&&(G.customRanges=[{...K,startIndex:0,endIndex:d.dataStream.length-1}]),Y.length&&(G.customDecorations=Y.map(q=>({...q,startIndex:0,endIndex:d.dataStream.length-1}))),k)E.push({t:s.TextXActionType.RETAIN,len:W}),E.push({t:s.TextXActionType.INSERT,body:G,len:d.dataStream.length});else{const q=s.BuildTextUtils.selection.delete([Q],d,S.cursor,G,l.length===1);E.push(...q)}S.reset(),S.moveCursor(X)}const O=Z(h,e);return T.push(C.editOp(E.serialize(),O)),f.params.actions=T.reduce((H,Q)=>s.JSONX.compose(H,Q),null),!!a.syncExecuteCommand(f.id,f.params)}};function La(o,t){const{startOffset:e,endOffset:n}=o,i=t.some(r=>r.startIndex===n),a=Math.max(e,i?n-1:n);return{...o,endOffset:a,collapsed:e===a}}function Qa(o,t,e){var g,p;const n=t.getSelfOrHeaderFooterModel(e).getBody(),i=new s.TextX,a=s.JSONX.getInstance(),r=[];if(n==null)return r;const{tables:c=[]}=n,l=new s.MemoryCursor;l.reset();for(let f=0;f<o.length;f++){const S=La(o[f],c),{startOffset:E,endOffset:C,collapsed:T}=S,R=E-l.cursor;T?i.push({t:s.TextXActionType.RETAIN,len:R}):i.push(...s.BuildTextUtils.selection.delete([S],n,l.cursor,null,!1)),l.reset(),l.moveCursor(C)}const A=Z(t,e);r.push(a.editOp(i.serialize(),A));const d=hi(n,o),u=(g=t.getDrawings())!=null?g:{},m=(p=t.getDrawingsOrder())!=null?p:[],h=d.sort((f,S)=>m.indexOf(f)>m.indexOf(S)?-1:m.indexOf(f)<m.indexOf(S)?1:0);if(h.length>0)for(const f of h){const S=u[f],E=m.indexOf(f);if(S==null||E<0)continue;const C=a.removeOp(["drawings",f],S),T=a.removeOp(["drawingsOrder",E],f);r.push(C),r.push(T)}return r.reduce((f,S)=>s.JSONX.compose(f,S),null)}function Fa(o,t,e,n){const i=[];if(t.getSelfOrHeaderFooterModel(n).getBody()==null)return i;const r=new s.TextX,c=s.JSONX.getInstance(),l=new s.MemoryCursor;l.reset();for(const d of o){const{startOffset:u,endOffset:m,spanEntireRow:h,spanEntireTable:g}=d;if(!(u==null||m==null))if(g){const p=Ai({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,len:S,tableId:E}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:S});const C=c.removeOp(["tableSource",E]);i.push(C),l.moveCursorTo(f+S)}else if(h){const p=di({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,rowIndexes:S,len:E,tableId:C}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:E});for(const T of S.reverse()){const R=c.removeOp(["tableSource",C,"tableRows",T]);i.push(R)}l.moveCursorTo(f+E)}else{const p=Pa({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offsets:f}=p;for(const S of f){const{retain:E,delete:C}=S;E-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:E-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:C}),l.moveCursorTo(E+C)}}}const A=Z(t,n);return i.push(c.editOp(r.serialize(),A)),i.reduce((d,u)=>s.JSONX.compose(d,u),null)}function gi(o,t,e,n,i){let a=[];if(Array.isArray(o)&&(o==null?void 0:o.length)!==0&&(a=Qa(o,e,i)),Array.isArray(t)&&(t==null?void 0:t.length)!==0){const r=Fa(t,e,n,i);a==null||a.length===0?a=r:a=s.JSONX.compose(a,s.JSONX.transform(r,a,"right"))}return a}const Ve={id:"doc.command.inner-cut",type:s.CommandType.COMMAND,handler:(o,t)=>{var p;const e=o.get(D.DocSelectionManagerService),n=o.get(s.ICommandService),i=o.get(s.IUniverInstanceService),{segmentId:a,textRanges:r,selections:c=e.getTextRanges(),rectRanges:l=e.getRectRanges()}=t;if((!Array.isArray(c)||c.length===0)&&(!Array.isArray(l)||l.length===0))return!1;const A=(p=i.getCurrentUniverDocInstance())==null?void 0:p.getUnitId();if(!A)return!1;const d=i.getUniverDocInstance(A);if(d==null)return!1;const u=re(o,A);if(u==null)return!1;const m=u.getViewModel(),h={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r}};return h.params.actions=gi(c,l,d,m,a),!!n.syncExecuteCommand(h.id,h.params)}};var oe=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(oe||{});const mi="doc.command.insert-text",Qn={id:mi,type:s.CommandType.COMMAND,handler:async(o,t)=>{var v;const e=o.get(s.ICommandService),{range:n,segmentId:i,body:a,unitId:r,cursorOffset:c}=t,l=o.get(D.DocSelectionManagerService),d=o.get(s.IUniverInstanceService).getUnit(r,s.UniverInstanceType.UNIVER_DOC);if(d==null)return!1;const u=l.getActiveTextRange(),m=d.getSelfOrHeaderFooterModel((v=u==null?void 0:u.segmentId)!=null?v:"").getBody();if(m==null)return!1;const{startOffset:h,collapsed:g}=n,p=c!=null?c:a.dataStream.length,f=[{startOffset:h+p,endOffset:h+p,style:u==null?void 0:u.style,collapsed:g}],S={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:f,debounce:!0}},E=new s.TextX,C=s.JSONX.getInstance();if(g)h>0&&E.push({t:s.TextXActionType.RETAIN,len:h}),E.push({t:s.TextXActionType.INSERT,body:a,len:a.dataStream.length});else{const O=s.BuildTextUtils.selection.delete([n],m,0,a);E.push(...O)}S.params.textRanges=[{startOffset:h+p,endOffset:h+p,collapsed:g}];const T=Z(d,i);return S.params.actions=C.editOp(E.serialize(),T),!!e.syncExecuteCommand(S.id,S.params)}},Ye={id:"doc.command.delete-text",type:s.CommandType.COMMAND,handler:async(o,t)=>{var R;const e=o.get(s.ICommandService),n=o.get(s.IUniverInstanceService),{range:i,segmentId:a,unitId:r,direction:c,len:l=1}=t,A=n.getUnit(r,s.UniverInstanceType.UNIVER_DOC),d=A==null?void 0:A.getSelfOrHeaderFooterModel(a).getBody();if(A==null||d==null)return!1;const{startOffset:u}=i;let m=c===oe.LEFT?u-l:u,h=c===oe.LEFT?u-1:u+l-1;const g=(R=d.customRanges)==null?void 0:R.find(v=>v.startIndex<=m&&v.endIndex>=h);g!=null&&g.wholeEntity&&(m=g.startIndex,h=Math.max(h,g.endIndex));const p={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:[{startOffset:m,endOffset:m,collapsed:!0}],debounce:!0}},f=new s.TextX,S=s.JSONX.getInstance();f.push({t:s.TextXActionType.RETAIN,len:m-0}),f.push({t:s.TextXActionType.DELETE,len:h-m+1});const C=Z(A,a);return p.params.actions=S.editOp(f.serialize(),C),!!e.syncExecuteCommand(p.id,p.params)}},Fn={id:"doc.command.update-text",type:s.CommandType.COMMAND,handler:async(o,t)=>{const{range:e,segmentId:n,updateBody:i,coverType:a,unitId:r,textRanges:c}=t,l=o.get(s.ICommandService),d=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(d==null)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:c}},m=new s.TextX,h=s.JSONX.getInstance(),{startOffset:g,endOffset:p}=e;m.push({t:s.TextXActionType.RETAIN,len:g}),m.push({t:s.TextXActionType.RETAIN,body:i,len:p-g,coverType:a});const f=Z(d,n);return u.params.actions=h.editOp(m.serialize(),f),!!l.syncExecuteCommand(u.id,u.params)}};function ut(o){var r,c,l,A;const t=o.get(s.IUniverInstanceService),n=o.get(D.DocSelectionManagerService).getActiveTextRange(),i=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);return!n||!n.collapsed||!i||n.segmentId?!1:s.BuildTextUtils.range.getParagraphsInRange(n,(c=(r=i.getBody())==null?void 0:r.paragraphs)!=null?c:[],(A=(l=i.getBody())==null?void 0:l.dataStream)!=null?A:"")[0]}const Wt={id:"doc.command.delete-custom-block",type:s.CommandType.COMMAND,handler:async(o,t)=>{var x;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=e.getActiveTextRange(),r=n.getCurrentUniverDocInstance();if(a==null||r==null)return!1;const{direction:c,range:l,unitId:A,drawingId:d}=t,{startOffset:u,segmentId:m,style:h}=a,g=c===oe.LEFT?u-1:u,p=[{startOffset:g,endOffset:g,style:h}],f={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:p,prevTextRanges:[l]}},S=new s.TextX,E=s.JSONX.getInstance(),C=[];u>0&&S.push({t:s.TextXActionType.RETAIN,len:c===oe.LEFT?u-1:u}),S.push({t:s.TextXActionType.DELETE,len:1});const T=Z(r,m);C.push(E.editOp(S.serialize(),T));const R=((x=r.getDrawings())!=null?x:{})[d],O=r.getDrawingsOrder().indexOf(d),M=E.removeOp(["drawings",d],R),b=E.removeOp(["drawingsOrder",O],d);return C.push(M),C.push(b),f.params.actions=C.reduce((U,F)=>s.JSONX.compose(U,F),null),!!i.syncExecuteCommand(f.id,f.params)}},Gt={id:"doc.command.merge-two-paragraph",type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{direction:a,range:r}=t,c=e.getActiveTextRange(),l=e.getTextRanges();if(c==null||l==null)return!1;const{segmentId:A,style:d}=c,u=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const h=m.dataStream,g=c,p=u.getUnitId(),{startOffset:f,collapsed:S}=g;if(!S)return!1;const E=a===oe.LEFT?f:f+1;let C,T;for(const V of m.paragraphs){if(V.startIndex>=E){T=V;break}C=V}if(C==null||T==null)return!1;const R=a===oe.LEFT?f-1:f,v=[{startOffset:R,endOffset:R,style:d}],O={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:v,prevTextRanges:[r]}},M=new s.TextX,b=s.JSONX.getInstance();C.startIndex>0&&M.push({t:s.TextXActionType.RETAIN,len:C.startIndex}),M.push({t:s.TextXActionType.DELETE,len:1}),T.startIndex>C.startIndex+1&&M.push({t:s.TextXActionType.RETAIN,len:T.startIndex-C.startIndex-1});const N=Object.values(s.DataStreamTreeTokenType),x=h[C.startIndex-1];(x&&!N.includes(x)||x===" ")&&M.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone(C),startIndex:0}]}});const U=Z(u,A);return O.params.actions=b.editOp(M.serialize(),U),!!i.syncExecuteCommand(O.id,O.params)}},pi={id:"doc.command.remove-horizontal-line",type:s.CommandType.COMMAND,handler:async o=>{var R;const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getActiveTextRange(),a=t.getTextRanges();if(i==null||a==null)return!1;const{segmentId:r,style:c}=i,l=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),A=l==null?void 0:l.getSelfOrHeaderFooterModel(r).getBody();if(l==null||A==null)return!1;const d=i,u=l.getUnitId(),{startOffset:m,collapsed:h}=d;if(!h)return!1;const g=(R=A.paragraphs)==null?void 0:R.find(v=>v.startIndex===m-1);if(g==null)return!1;const p=[{startOffset:m,endOffset:m,style:c}],f={id:D.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:p}},S=new s.TextX,E=s.JSONX.getInstance();g.startIndex>0&&S.push({t:s.TextXActionType.RETAIN,len:g.startIndex}),S.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone({...g,paragraphStyle:{...g.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const C=Z(l,r);return f.params.actions=E.editOp(S.serialize(),C),!!n.syncExecuteCommand(f.id,f.params)}};function Xt(o,t){let e=0;if(o==null||o.length===0){if(typeof t[0].startOffset=="number"){const n=t[0],{spanEntireRow:i,spanEntireTable:a}=n;a?e=n.startOffset-3:i?n.startRow>0?e=n.startOffset-6:e=n.startOffset:e=t[0].startOffset}}else if(o.length>0&&t.length>0){const n=o[0],i=t[0];if(n.startOffset!=null&&i.startOffset!=null){if(n.startOffset<i.startOffset)e=n.startOffset;else if(n.startOffset>=i.startOffset){const{spanEntireRow:a,spanEntireTable:r}=i;r?e=i.startOffset-3:a&&(e=i.startOffset-6)}}}return e}const ht={id:"doc.command.delete-left",type:s.CommandType.COMMAND,handler:async o=>{var b,N,x,U,F,V;const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService);let i=!0;const a=e.getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=re(o,r),l=t.getActiveTextRange(),A=t.getRectRanges(),d=t.getTextRanges(),u=c==null?void 0:c.getSkeleton();if(u==null)return!1;if(A!=null&&A.length){const H=Xt(d,A),Q=A[0].segmentId,j=[{startOffset:H,endOffset:H}];return n.executeCommand(Ve.id,{segmentId:Q,textRanges:j})}if(l==null||d==null)return!1;const{segmentId:m,style:h,segmentPage:g}=l,p=a.getSelfOrHeaderFooterModel(m).getBody();if(p==null)return!1;const f=l,{startOffset:S,collapsed:E}=f,C=u.findNodeByCharIndex(S,m,g),T=_.hasListGlyph(C),R=_.isIndentByGlyph(C,p);let v=S;const O=u.findNodeByCharIndex(S-1,m,g);if(_.isFirstGlyph(C)&&O!==C&&(T===!0||R===!0)&&E){const H=_.getParagraphByGlyph(C,p);if(H==null)return!1;const Q=H==null?void 0:H.startIndex,j={startIndex:0},X=H.paragraphStyle;if(T===!0){const W=H.paragraphStyle;if(W){j.paragraphStyle=W;const{hanging:G}=W;G&&(j.paragraphStyle.indentStart=G,j.paragraphStyle.hanging=void 0)}}else if(R===!0){const W=H.bullet;W&&(j.bullet=W),X!=null&&(j.paragraphStyle={...X},delete j.paragraphStyle.hanging,delete j.paragraphStyle.indentStart)}const k=[{startOffset:v,endOffset:v,style:h}];i=await n.executeCommand(Fn.id,{unitId:a.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...j}]},range:{startOffset:Q,endOffset:Q+1},textRanges:k,coverType:s.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(E===!0){if(O==null)return!0;if(O.content==="\r"){const H=(b=p.paragraphs)==null?void 0:b.find(Q=>Q.startIndex===S-1);(N=H==null?void 0:H.paragraphStyle)!=null&&N.borderBottom?i=await n.executeCommand(pi.id):i=await n.executeCommand(Gt.id,{direction:oe.LEFT,range:f})}else if(O.streamType==="\b"){const H=(U=a.getSnapshot().drawings)==null?void 0:U[(x=O.drawingId)!=null?x:""];if(H==null)return!0;const Q=(V=(F=a.getBody())==null?void 0:F.customBlocks)==null?void 0:V.find(X=>X.blockId===O.drawingId);if(H.layoutType===s.PositionedObjectLayoutType.INLINE||(Q==null?void 0:Q.blockType)===s.BlockType.CUSTOM){const X=a.getUnitId();i=await n.executeCommand(Wt.id,{direction:oe.LEFT,range:l,unitId:X,drawingId:O.drawingId})}else{const X=u.findNodeByCharIndex(S-2);if(X==null)return!0;v-=O.count,v-=X.count;const k=[{startOffset:v,endOffset:v,style:h}];i=await n.executeCommand(Ye.id,{unitId:a.getUnitId(),range:{...l,startOffset:l.startOffset-1,endOffset:l.endOffset-1},segmentId:m,direction:oe.LEFT,len:X.count,textRanges:k})}}else v-=O.count,i=await n.executeCommand(Ye.id,{unitId:a.getUnitId(),range:f,segmentId:m,direction:oe.LEFT,len:O.count})}else{const H=fi(f,[f]);i=await n.executeCommand(Ve.id,{segmentId:m,textRanges:H,selections:[f]})}return i}},Hn={id:"doc.command.delete-right",type:s.CommandType.COMMAND,handler:async o=>{var C,T;const t=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!n)return!1;const i=re(o,n.getUnitId()),a=o.get(s.ICommandService),r=t.getActiveTextRange(),c=t.getRectRanges(),l=t.getTextRanges(),A=i==null?void 0:i.getSkeleton();if(c!=null&&c.length){const R=Xt(l,c),v=c[0].segmentId,O=[{startOffset:R,endOffset:R}];return a.executeCommand(Ve.id,{segmentId:v,textRanges:O})}if(r==null||A==null||l==null)return!1;const{segmentId:d,style:u,segmentPage:m}=r,h=n==null?void 0:n.getSelfOrHeaderFooterModel(d).getBody();if(!n||!h)return!1;const g=r,{startOffset:p,endOffset:f,collapsed:S}=g;if(p===h.dataStream.length-2&&S)return!0;let E=!1;if(S===!0){const R=A.findNodeByCharIndex(p,d,m),v=A.findNodeByCharIndex(p+1);if(R.streamType===s.DataStreamTreeTokenType.PARAGRAPH&&(v==null?void 0:v.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK)return!1;if(R.content==="\r")E=await a.executeCommand(Gt.id,{direction:oe.RIGHT,range:r});else if(R.streamType==="\b"){const O=(T=n.getSnapshot().drawings)==null?void 0:T[(C=R.drawingId)!=null?C:""];if(O==null)return!0;if(O.layoutType===s.PositionedObjectLayoutType.INLINE){const b=n.getUnitId();E=await a.executeCommand(Wt.id,{direction:oe.RIGHT,range:r,unitId:b,drawingId:R.drawingId})}else{if(v==null)return!0;const b=[{startOffset:p+1,endOffset:p+1,style:u}];E=await a.executeCommand(Ye.id,{unitId:n.getUnitId(),range:{...r,startOffset:p+1,endOffset:f+1},segmentId:d,direction:oe.RIGHT,textRanges:b,len:v.count})}}else{const O=[{startOffset:p,endOffset:p,style:u}];E=await a.executeCommand(Ye.id,{unitId:n.getUnitId(),range:g,segmentId:d,direction:oe.RIGHT,textRanges:O,len:R.count})}}else{const R=fi(g,[g]);E=await a.executeCommand(Ve.id,{segmentId:d,textRanges:R,selections:[g]})}return E}};function fi(o,t){let e=o.endOffset;for(const i of t){const{startOffset:a,endOffset:r}=i;a==null||r==null||r<=o.endOffset&&(e-=r-a)}return[{startOffset:e,endOffset:e,style:o.style}]}const kn={id:"doc.command.delete-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{var A,d;const t=o.get(s.IUniverInstanceService),e=o.get(s.ICommandService),n=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const i=(d=(A=n.getBody())==null?void 0:A.dataStream)!=null?d:"",a=ut(o);if(!a)return!1;const r=s.BuildTextUtils.selection.delete([{startOffset:a.paragraphStart,endOffset:i[a.paragraphEnd+1]===`
`?a.paragraphEnd:a.paragraphEnd+1,collapsed:!1}],n.getBody(),0,void 0,!0),c=Z(n),l={unitId:n.getUnitId(),actions:s.JSONX.getInstance().editOp(r,c),textRanges:[{startOffset:a.paragraphStart,endOffset:a.paragraphStart,collapsed:!0}]};return e.syncExecuteCommand(D.RichTextEditingMutation.id,l)}},Ha=10,ka=6;function Va(){return s.generateRandomId(ka)}function Wa(o){const t=o.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}class Ga{constructor(){B(this,"_cache",new s.LRUMap(Ha))}set(t,e){this._cache.set(t,e)}get(t){return this._cache.get(t)}clear(){this._cache.clear()}}const Vn=new Ga;function Wn(o){const t=o.style,e={},n=o.tagName.toLowerCase();switch(n){case"b":case"em":case"strong":{e.bl=s.BooleanNumber.TRUE;break}case"s":{e.st={s:s.BooleanNumber.TRUE};break}case"u":{e.ul={s:s.BooleanNumber.TRUE};break}case"i":{e.it=s.BooleanNumber.TRUE;break}case"sub":case"sup":{e.va=n==="sup"?s.BaselineOffset.SUPERSCRIPT:s.BaselineOffset.SUBSCRIPT;break}}for(let i=0;i<t.length;i++){const a=t[i],r=t.getPropertyValue(a);switch(a){case"font-family":{e.ff=r.replace(/^"/g,"").replace(/"$/g,"");break}case"font-size":{const c=Number.parseInt(r);Number.isNaN(c)||(r.endsWith("pt")?e.fs=c:r.endsWith("px")&&(e.fs=_.pixelToPt(c)));break}case"font-style":{r==="italic"&&(e.it=s.BooleanNumber.TRUE);break}case"font-weight":{(Number(r)>400||String(r)==="bold")&&(e.bl=s.BooleanNumber.TRUE);break}case"text-decoration":{/underline/.test(r)?e.ul={s:s.BooleanNumber.TRUE}:/overline/.test(r)?e.ol={s:s.BooleanNumber.TRUE}:/line-through/.test(r)&&(e.st={s:s.BooleanNumber.TRUE});break}case"color":{try{const c=new s.ColorKit(r);c.isValid&&(e.cl={rgb:c.toRgbString()})}catch{}break}case"background-color":{const c=new s.ColorKit(r);c.isValid&&(e.bg={rgb:c.toRgbString()});break}}}return e}function Xa(o){const t=new DOMParser,e=`<x-univer id="univer-root">${o}</x-univer>`;return t.parseFromString(e,"text/html").querySelector("#univer-root")}function Si(o,t){const e=o.tagName.toLowerCase();return typeof t=="string"?e===t:Array.isArray(t)?t.some(n=>n===e):t(o)}const Ii=660,Rn=class Rn{constructor(){B(this,"_tableCache",[]);B(this,"_styleCache",new Map);B(this,"_styleRules",[]);B(this,"_afterProcessRules",[])}static use(t){if(this._pluginList.includes(t))throw new Error(`Univer paste plugin ${t.name} already added`);this._pluginList.push(t)}convert(t,e={}){var c;const n=Rn._pluginList.find(l=>l.checkPasteType(t)),i=Xa(t),r={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:(c=e==null?void 0:e.unitId)!=null?c:""};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,i.childNodes,r),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],r}_process(t,e,n){var a,r,c,l;const i=n.body;for(const A of e)if(A.nodeType===Node.TEXT_NODE){if(((a=A.nodeValue)==null?void 0:a.trim())==="")continue;const d=(r=A.nodeValue)==null?void 0:r.replace(/[\r\n]/g,"");let u;t&&this._styleCache.has(t)&&(u=this._styleCache.get(t)),i.dataStream+=d,u&&Object.getOwnPropertyNames(u).length&&i.textRuns.push({st:i.dataStream.length-d.length,ed:i.dataStream.length,ts:u})}else if(A.nodeName==="IMG"){const d=A,u=d.dataset.imageSourceType,m=u===Mn.ImageSourceType.UUID?d.dataset.source:d.src;if(m&&u){const h=Number(d.dataset.width||100),g=Number(d.dataset.height||100),p=Number(d.dataset.docTransformWidth||h),f=Number(d.dataset.docTransformHeight||g),S=s.generateRandomId(6);(l=(c=n.body)==null?void 0:c.customBlocks)==null||l.push({startIndex:i.dataStream.length,blockId:S}),i.dataStream+="\b",n.drawings||(n.drawings={}),n.drawings[S]={drawingId:S,title:"",description:"",imageSourceType:u,source:m,transform:{width:h,height:g,left:0},docTransform:{size:{width:p,height:f},angle:0,positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:0}},layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,unitId:n.id||"",subUnitId:n.id||""}}}else{if(s.skipParseTagNames.includes(A.nodeName.toLowerCase()))continue;if(A.nodeType===Node.ELEMENT_NODE){const d=A,u=this._processBeforeLink(d,n),m=t?this._styleCache.get(t):{},h=this._styleRules.find(({filter:S})=>Si(A,S)),g=h?h.getStyle(A):Wn(A);this._styleCache.set(A,{...m,...g});const{childNodes:p}=A;this._processBeforeTable(A,n),this._process(A,p,n),this._processAfterTable(A,n);const f=this._afterProcessRules.find(({filter:S})=>Si(A,S));f&&f.handler(n,A),this._processAfterLink(d,n,u)}}}_processBeforeTable(t,e){var a;const n=t.tagName.toUpperCase(),i=e.body;switch(n){case"TABLE":{i.dataStream[i.dataStream.length-1]!=="\r"&&(i.dataStream+="\r",i.paragraphs==null&&(i.paragraphs=[]),(a=i.paragraphs)==null||a.push({startIndex:i.dataStream.length-1}));const r=wn(0,0,Ii);this._tableCache.push({table:r,startIndex:i.dataStream.length}),i.dataStream+=s.DataStreamTreeTokenType.TABLE_START;break}case"TR":{const r=kt(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(r),i.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{const r=Ht(),c=this._tableCache[this._tableCache.length-1].table;c.tableRows[c.tableRows.length-1].tableCells.push(r),i.dataStream+=s.DataStreamTreeTokenType.TABLE_CELL_START;break}}}_processAfterTable(t,e){var r,c;const n=t.tagName.toUpperCase(),i=e.body;e.tableSource==null&&(e.tableSource={}),i.tables==null&&(i.tables=[]),i.sectionBreaks==null&&(i.sectionBreaks=[]);const{tableSource:a}=e;switch(n){case"TABLE":{const l=this._tableCache.pop(),{startIndex:A,table:d}=l,u=d.tableRows[0].tableCells.length,m=Vt(Ii/u),h=[...new Array(u).fill(null).map(()=>s.Tools.deepClone(m))];d.tableColumns=h,a[d.tableId]=d,i.dataStream+=s.DataStreamTreeTokenType.TABLE_END,i.tables.push({startIndex:A,endIndex:i.dataStream.length,tableId:d.tableId});break}case"TR":{i.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_END;break}case"TD":{i.dataStream[i.dataStream.length-1]!=="\r"&&((r=i.paragraphs)==null||r.push({startIndex:i.dataStream.length}),i.dataStream+="\r"),(c=i.sectionBreaks)==null||c.push({startIndex:i.dataStream.length}),i.dataStream+=`
${s.DataStreamTreeTokenType.TABLE_CELL_END}`;break}}}_processBeforeLink(t,e){return e.body.dataStream.length}_processAfterLink(t,e,n){var r,c;const i=e.body,a=t;a.tagName.toUpperCase()==="A"&&(i.customRanges=(r=i.customRanges)!=null?r:[],i.customRanges.push({startIndex:n,endIndex:i.dataStream.length-1,rangeId:(c=a.dataset.rangeid)!=null?c:s.generateRandomId(),rangeType:s.CustomRangeType.HYPERLINK,properties:{url:a.href}}))}};B(Rn,"_pluginList",[]);let qe=Rn;const vi={name:"univer-doc-paste-plugin-lark",checkPasteType(o){return/lark-record-clipboard/i.test(o)},stylesRules:[{filter:["s"],getStyle(o){const t=Wn(o);return{st:{s:s.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter(o){return o.tagName==="DIV"&&/ace-line/i.test(o.className)},handler(o){const t=o.body;t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function Ei(o){const t=o.style,e={};for(let n=0;n<t.length;n++){const i=t[n],a=t.getPropertyValue(i);switch(i){case"margin-top":{const r=Number.parseInt(a);e.spaceAbove={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"margin-bottom":{const r=Number.parseInt(a);e.spaceBelow={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"line-height":{let r=Number.parseFloat(a);a.endsWith("%")&&(r/=100),e.lineSpacing=r;break}}}return Object.getOwnPropertyNames(e).length?e:null}const Ci={name:"univer-doc-paste-plugin-univer",checkPasteType(o){return/UniverNormal/i.test(o)},stylesRules:[],afterProcessRules:[{filter(o){return o.tagName==="P"&&/UniverNormal/i.test(o.className)},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},i=Ei(t);i&&(n.paragraphStyle=i),e.paragraphs.push(n),e.dataStream+="\r"}}]},Ti={name:"univer-doc-paste-plugin-word",checkPasteType(o){return/word|mso/i.test(o)},stylesRules:[{filter:["b"],getStyle(o){const t=Wn(o);return{bl:s.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter(o){return o.tagName==="P"},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},i=Ei(t);i&&(n.paragraphStyle=i),e.paragraphs.push(n),e.dataStream+="\r"}}]};function ja(o){var n,i;const t=a=>{let r="";return Object.keys(a).forEach(c=>{a[c]!==void 0&&(r+=` ${c}=${a[c]}`)}),r},e={"data-doc-transform-height":o.docTransform.size.height,"data-doc-transform-width":o.docTransform.size.width,"data-width":(n=o.transform)==null?void 0:n.width,"data-height":(i=o.transform)==null?void 0:i.height,"data-image-source-type":o.imageSourceType,"data-source":o.imageSourceType===Mn.ImageSourceType.UUID?o.source:void 0,src:o.source};return`<img  ${t(e)}></img>`}function yi(o,t){const{st:e,ed:n,ts:i={}}=t,{ff:a,fs:r,it:c,bl:l,ul:A,st:d,ol:u,bg:m,cl:h,va:g}=i;let p=o.slice(e,n);const f=[];return c===s.BooleanNumber.TRUE&&(p=`<i>${p}</i>`),g===s.BaselineOffset.SUPERSCRIPT?p=`<sup>${p}</sup>`:g===s.BaselineOffset.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(A==null?void 0:A.s)===s.BooleanNumber.TRUE&&(p=`<u>${p}</u>`),(d==null?void 0:d.s)===s.BooleanNumber.TRUE&&(p=`<s>${p}</s>`),l===s.BooleanNumber.TRUE&&(p=`<strong>${p}</strong>`),a&&f.push(`font-family: ${a}`),h&&f.push(`color: ${h.rgb}`),r&&f.push(`font-size: ${r}pt`),u&&f.push("text-decoration: overline"),m&&f.push(`background: ${m.rgb}`),f.length?`<span style="${f.join("; ")};">${p}</span>`:p}function Gn(o,t,e){const{dataStream:n,textRuns:i=[]}=o;if(t===e)return"";let a=t;const r=[];for(const c of i){const{st:l,ed:A}=c;s.Tools.hasIntersectionBetweenTwoRanges(t,e,l,A)&&(l>a?(r.push(n.slice(a,l)),r.push(yi(n,{...c,ed:Math.min(A,e)}))):r.push(yi(n,{...c,st:a,ed:Math.min(A,e)}))),a=Math.max(t,Math.min(A,e))}return a!==e&&r.push(n.slice(a,e)),r.join("")}function Ka(o,t,e){const n=o.body,i=o.drawings||{},{customRanges:a=[],customBlocks:r=[]}=n||{},c=[...r],l=a.filter(h=>h.startIndex>=t&&h.endIndex<=e);let A=t,d="";const u=(h,g)=>{let p="",f=0,S=h,E=c.findIndex(C=>h<=C.startIndex&&g>=C.startIndex);if(E===-1)return p=Gn(n,h,g),{sliceHtml:p,customBlockLength:f};for(;E!==-1;){const C=c[E];c.splice(E,1),p+=Gn(n,S,C.startIndex);const T=i[C.blockId];if(T)switch(T.drawingType){case s.DrawingTypeEnum.DRAWING_IMAGE:{p+=ja(T),f++;break}}S=C.startIndex+1,E=c.findIndex(R=>S<=R.startIndex&&g>=R.startIndex)}return p=p+Gn(n,S,g+1),{sliceHtml:p,customBlockLength:f}};l.forEach(h=>{var T,R;const{startIndex:g,endIndex:p,rangeType:f,rangeId:S}=h,E=u(A,g);d+=E.sliceHtml;const C=u(g,p+1);switch(f){case s.CustomRangeType.HYPERLINK:{d+=`<a data-rangeid="${S}" href="${(R=(T=h.properties)==null?void 0:T.url)!=null?R:""}">${C.sliceHtml}</a>`;break}default:{d+=C.sliceHtml;break}}A=p+1+(E.customBlockLength+C.customBlockLength)});const m=u(A,e);return d+=m.sliceHtml,d}function bi(o){const t=o.body||{},{paragraphs:e=[],sectionBreaks:n=[]}=t;let{dataStream:i=""}=t;i.endsWith(`\r
`)||(i+=`\r
`,e.push({startIndex:i.length-2}),n.push({startIndex:i.length-1}),t.dataStream=i,t.paragraphs=e,t.sectionBreaks=n);const a={html:""},r=_.parseDataStreamToTree(i).sectionList;for(const c of r)Je(c,o,a);return a.html}function Je(o,t,e){var n,i;switch(o.nodeType){case s.DataStreamTreeNodeType.SECTION_BREAK:{for(const a of o.children)Je(a,t,e);break}case s.DataStreamTreeNodeType.PARAGRAPH:{const{children:a,startIndex:r,endIndex:c}=o,l=(i=(n=t.body)==null?void 0:n.paragraphs.find(g=>g.startIndex===c))!=null?i:{},{paragraphStyle:A={}}=l,{spaceAbove:d,spaceBelow:u,lineSpacing:m}=A,h=[];if(d!=null&&(typeof d=="number"?h.push(`margin-top: ${d}px`):h.push(`margin-top: ${d.v}px`)),u!=null&&(typeof u=="number"?h.push(`margin-bottom: ${u}px`):h.push(`margin-bottom: ${u.v}px`)),m!=null&&h.push(`line-height: ${m}`),e.html+=`<p class="UniverNormal" ${h.length?`style="${h.join("; ")};"`:""}>`,a.length)for(const g of a)Je(g,t,e);e.html+=`${Ka(t,r,c)}</p>`;break}case s.DataStreamTreeNodeType.TABLE:{const{children:a}=o;e.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const r of a)Je(r,t,e);e.html+="</tbody></table>";break}case s.DataStreamTreeNodeType.TABLE_ROW:{const{children:a}=o;e.html+='<tr class="UniverTableRow">';for(const r of a)Je(r,t,e);e.html+="</tr>";break}case s.DataStreamTreeNodeType.TABLE_CELL:{const{children:a}=o;e.html+='<td class="UniverTableCell">';for(const r of a)Je(r,t,e);e.html+="</td>";break}default:throw new Error(`Unknown node type: ${o.nodeType}`)}}class za{convert(t){if(t.length===0)throw new Error("The bodyList length at least to be 1");let e="";for(const n of s.Tools.deepClone(t))e+=bi(n);return e}}var Ya=Object.getOwnPropertyDescriptor,qa=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ya(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},gt=(o,t)=>(e,n)=>t(e,n,o);qe.use(Ti),qe.use(vi),qe.use(Ci);function Oi(o,t,e){var a,r,c;const n=s.getBodySlice(o,t,e+2),i=s.DataStreamTreeTokenType.TABLE_START+s.DataStreamTreeTokenType.TABLE_ROW_START+s.DataStreamTreeTokenType.TABLE_CELL_START+n.dataStream+s.DataStreamTreeTokenType.TABLE_CELL_END+s.DataStreamTreeTokenType.TABLE_ROW_END+s.DataStreamTreeTokenType.TABLE_END;return n.dataStream=i,(a=n.textRuns)==null||a.forEach(l=>{const{st:A,ed:d}=l;l.st=A+3,l.ed=d+3}),(r=n.tables)==null||r.forEach(l=>{const{startIndex:A,endIndex:d}=l;l.startIndex=A+3,l.endIndex=d+3}),(c=n.paragraphs)==null||c.forEach(l=>{const{startIndex:A}=l;l.startIndex=A+3}),n}const De=s.createIdentifier("doc.clipboard-service");let Xn=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_clipboardHooks",[]);B(this,"_htmlToUDM",new qe);B(this,"_umdToHtml",new za);this._univerInstanceService=t,this._logService=e,this._commandService=n,this._clipboardInterfaceService=i,this._docSelectionManagerService=a}async copy(t=s.SliceBodyType.copy,e){var c,l;const{newSnapshotList:n=[],needCache:i=!1,snapshot:a,ranges:r}=(c=this._getDocumentBodyInRanges(t,e))!=null?c:{};if(n.length===0||a==null)return!1;try{const A=!!((l=r==null?void 0:r[0])!=null&&l.segmentId);this._setClipboardData(n,!A&&i)}catch(A){return this._logService.error("[DocClipboardService] copy failed",A),!1}return!0}async cut(t){return this._cut(t)}async paste(t){const e=await this._genDocDataFromClipboardItems(t);return this._paste(e)}async legacyPaste(t){let{html:e,text:n,files:i}=t;const a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=(a==null?void 0:a.getUnitId())||"";if(!e&&!n&&i.length&&(e=await this._createImagePasteHtml(i)),!e&&!n)return this._logService.warn("[DocClipboardController] html and text cannot be both empty!"),!1;const c=this._genDocDataFromHtmlAndText(e,n,r);if(r===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)if(n){const l=s.BuildTextUtils.transform.fromPlainText(n);return this._paste({body:l})}else c.body.textRuns=[];return this._paste(c)}async _cut(t){var c,l,A,d,u;const e=(l=(c=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.TEXT))!=null?c:this._docSelectionManagerService.getTextRanges())!=null?l:[],n=(d=(A=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.RECT))!=null?A:this._docSelectionManagerService.getRectRanges())!=null?d:[],{segmentId:i,endOffset:a,style:r}=(u=e[0])!=null?u:{};if(i==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),e.length===0&&n.length===0)return!1;this.copy(s.SliceBodyType.cut,t);try{let m=0;if(n.length>0)m=Xt(e,n);else if(a!=null){m=a;for(const g of e){const{startOffset:p,endOffset:f}=g;p==null||f==null||f<=a&&(m-=f-p)}}const h=[{startOffset:m,endOffset:m,style:r}];return this._commandService.executeCommand(Ve.id,{segmentId:i,textRanges:h,rectRanges:n,selections:e})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(t){var d,u,m;const{body:e}=t;if(e==null)return!1;let n=s.normalizeBody(e);if(!((d=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:d.getUnitId()))return!1;this._clipboardHooks.forEach(h=>{h.onBeforePaste&&(n=h.onBeforePaste(n))}),n.customRanges=(u=n.customRanges)==null?void 0:u.map(s.BuildTextUtils.customRange.copyCustomRange),(m=n.paragraphs)==null||m.forEach(h=>{var g;(g=h.paragraphStyle)!=null&&g.headingId&&(h.paragraphStyle.headingId=s.generateRandomId(6))});const a=this._docSelectionManagerService.getActiveTextRange(),{segmentId:r,endOffset:c,style:l}=a||{},A=this._docSelectionManagerService.getTextRanges();if(r==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),c==null||A==null)return!1;try{let h=c;for(const p of A){const{startOffset:f,endOffset:S}=p;f==null||S==null||S<=c&&(h+=n.dataStream.length-(S-f))}const g=[{startOffset:h,endOffset:h,style:l}];return this._commandService.executeCommand(Ln.id,{doc:{...t,body:n},segmentId:r,textRanges:g})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(t,e=!0){var r,c,l,A;const n=Va(),i=(t.length>1?t.map(d=>{var u;return((u=d.body)==null?void 0:u.dataStream)||""}).join(`
`):((r=t[0].body)==null?void 0:r.dataStream)||"").replaceAll(s.DataStreamTreeTokenType.TABLE_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_END,"").replaceAll(`\r
`," ");let a=this._umdToHtml.convert(t);if(t.length===1&&e){a=a.replace(/(<[a-z]+)/,(m,h)=>`${h} data-copy-id="${n}"`);const d=t[0],u={body:d.body};if((l=(c=d.body)==null?void 0:c.customBlocks)!=null&&l.length){u.drawings={};for(const m of d.body.customBlocks){const{blockId:h}=m,g=(A=d.drawings)==null?void 0:A[h];if(g){const p=s.generateRandomId(6);m.blockId=p,u.drawings[p]={...s.Tools.deepClone(g),drawingId:p}}}}Vn.set(n,u)}return this._clipboardInterfaceService.write(i,a)}addClipboardHook(t){return this._clipboardHooks.push(t),s.toDisposable(()=>{const e=this._clipboardHooks.indexOf(t);e>-1&&this._clipboardHooks.splice(e,1)})}_getDocumentBodyInRanges(t,e){var d;const n=this._univerInstanceService.getCurrentUniverDocInstance(),i=e!=null?e:this._docSelectionManagerService.getDocRanges(),a=[];let r=!0;if(n==null||i.length===0)return;const c=i[0].segmentId,l=(d=n==null?void 0:n.getSelfOrHeaderFooterModel(c))==null?void 0:d.getBody(),A=n.getSnapshot();if(l!=null){for(const u of i){const{startOffset:m,endOffset:h,collapsed:g,rangeType:p}=u;if(g||m==null||h==null)continue;if(p===s.DOC_RANGE_TYPE.RECT){r=!1;const{spanEntireRow:E}=u;let C;C=Oi(l,m,h),a.push(C);continue}const f={startOffset:m,endOffset:h},S=n.getSelfOrHeaderFooterModel(c).sliceBody(f.startOffset,f.endOffset,t);S!=null&&a.push(S)}return{newSnapshotList:a.map(u=>({...A,body:u})),needCache:r,snapshot:A,ranges:i}}}async _genDocDataFromClipboardItems(t){try{let e="",n="";const i=[];for(const a of t)for(const r of a.types)switch(r){case I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE:{n=await a.getType(r).then(c=>c&&c.text());break}case I.HTML_CLIPBOARD_MIME_TYPE:{e=await a.getType(r).then(c=>c&&c.text());break}case I.FILE__BMP_CLIPBOARD_MIME_TYPE:case I.FILE__JPEG_CLIPBOARD_MIME_TYPE:case I.FILE__WEBP_CLIPBOARD_MIME_TYPE:case I.FILE_PNG_CLIPBOARD_MIME_TYPE:{const c=await a.getType(r),l=new File([c],`pasted_image.${r.split("/")[1]}`,{type:r});i.push(l);break}}return!e&&!n&&i.length&&(e=await this._createImagePasteHtml(i)),this._genDocDataFromHtmlAndText(e,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(t,e,n){if(!t){if(e)return{body:s.BuildTextUtils.transform.fromPlainText(e)};throw new Error("[DocClipboardService] html and text cannot be both empty!")}const i=Wa(t);if(i){const r=Vn.get(i);if(r)return r}if(!n){const r=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n=(r==null?void 0:r.getUnitId())||""}const a=this._htmlToUDM.convert(t,{unitId:n});return i&&Vn.set(i,a),a}async _createImagePasteHtml(t){var c,l;const e={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},n=async A=>{const d=new FileReader;return new Promise(u=>{d.onloadend=function(){u({source:d.result,imageSourceType:Mn.ImageSourceType.BASE64})},d.readAsDataURL(A)})},i=A=>{const d=new Image,u=500;return new Promise(m=>{d.src=typeof A=="string"?A:URL.createObjectURL(A),d.onload=()=>{const h=Math.min(u,d.naturalWidth),g=d.naturalHeight/d.naturalWidth;m({width:h,height:h*g})}})},a=(l=(c=this._clipboardHooks.find(A=>A.onBeforePasteImage))==null?void 0:c.onBeforePasteImage)!=null?l:n;return await Promise.all(t.map(async(A,d)=>{var S;const u=await a(A);if(!u)return Promise.resolve();const{width:m=100,height:h=100}=await i(A),g=`paste_image_id_${d}`,p=e.body,f=e.drawings;p.dataStream+="\b",(S=p.customBlocks)==null||S.push({startIndex:d,blockId:g}),f[g]={drawingId:g,unitId:"",subUnitId:"",imageSourceType:u.imageSourceType,title:"",source:u.source,description:"",layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,transform:{width:m,height:h,angle:0},docTransform:{angle:0,size:{width:m,height:h},positionH:{relativeFrom:s.ObjectRelativeFromH.CHARACTER,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.LINE,posOffset:0}}}})),this._umdToHtml.convert([e])}};Xn=qa([gt(0,s.IUniverInstanceService),gt(1,s.ILogService),gt(2,s.ICommandService),gt(3,I.IClipboardInterfaceService),gt(4,s.Inject(D.DocSelectionManagerService))],Xn);function jt(o){return o.getContextValue(s.FOCUSING_DOC)||o.getContextValue(s.EDITOR_ACTIVATED)}const jn=999,mt={id:I.CopyCommand.id,name:"doc.command.copy",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>o.get(De).copy()},Kn={id:"doc.command.copy-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(De),e=ut(o);return e?t.copy(s.SliceBodyType.copy,[{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1}]):!1}},Kt={id:I.CutCommand.id,name:"doc.command.cut",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>o.get(De).cut()},zn={id:"doc.command.cut-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(De),e=ut(o);return e?t.cut([{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1,rangeType:s.DOC_RANGE_TYPE.TEXT}]):!1}},zt={id:I.PasteCommand.id,name:"doc.command.paste",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>{const t=o.get(De),n=await o.get(I.IClipboardInterfaceService).read();return n.length===0?!1:t.paste(n)}},pt={id:"doc.command.horizontal-line",type:s.CommandType.COMMAND,handler:(o,t)=>o.get(s.ICommandService).syncExecuteCommand(Qt.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:s.DashStyleType.SOLID},textRange:t==null?void 0:t.insertRange})},Yn={id:"doc.command.insert-horizontal-line-bellow",type:s.CommandType.COMMAND,handler:o=>{const t=o.get(s.ICommandService),e=ut(o);return e?t.syncExecuteCommand(pt.id,{insertRange:{startOffset:e.startIndex+1,endOffset:e.startIndex+1}}):!1}},qn={id:"doc.command.select-all",type:s.CommandType.COMMAND,handler:async o=>{var h;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),i=e.getDocRanges(),a=(h=i.find(g=>g.isActive))!=null?h:i[0];if(n==null||a==null)return!1;const{segmentId:r}=a,c=n.getUnitId(),l=n.getSelfOrHeaderFooterModel(r).getSnapshot().body;if(l==null)return!1;const{tables:A=[],dataStream:d}=l;if(d===`\r
`)return!0;const u=[];let m=0;for(const g of A){const{startIndex:p,endIndex:f}=g;m!==p&&u.push({startOffset:m,endOffset:p-1,rangeType:s.DOC_RANGE_TYPE.TEXT}),u.push({startOffset:p+3,endOffset:f-5,rangeType:s.DOC_RANGE_TYPE.RECT}),m=f}return m!==l.dataStream.length-2&&u.push({startOffset:m,endOffset:l.dataStream.length-2,rangeType:s.DOC_RANGE_TYPE.TEXT}),e.replaceDocRanges(u,{unitId:c,subUnitId:c},!1),!0}};class ft extends s.RxDisposable{constructor(e){super();B(this,"_previousActiveRange",null);B(this,"_undoMutationParamsCache",[]);B(this,"_redoMutationParamsCache",[]);this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:n=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:e}=this._undoMutationParamsCache[0],n={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}const Jn={id:"doc.command.ime-input",type:s.CommandType.COMMAND,handler:async(o,t)=>{var Q,j,X;const{unitId:e,newText:n,oldTextLen:i,isCompositionEnd:a,isCompositionStart:r}=t,c=o.get(s.ICommandService),l=o.get(_.IRenderManagerService),A=o.get(s.IUniverInstanceService),d=o.get(ve),u=(Q=l.getRenderById(e))==null?void 0:Q.with(ft),m=A.getUnit(e,s.UniverInstanceType.UNIVER_DOC);if(m==null||u==null)return!1;const h=u.getActiveRange();if(h==null)return!1;const{style:g,segmentId:p}=h,f=m.getSelfOrHeaderFooterModel(p).getBody();if(f==null)return!1;Object.assign(h,h);const{startOffset:E,endOffset:C}=h,T=n.length,R=[{startOffset:E+T,endOffset:E+T,collapsed:!0,style:g}],v={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:R}},O=d.getDefaultStyle(),M=d.getStyleCache(),b=Dn((j=f.customRanges)!=null?j:[],E+i,s.SHEET_EDITOR_UNITS.includes(e)),N=Ut(f,r?C:E+i,O,M,s.SHEET_EDITOR_UNITS.includes(e)),x=Bn((X=f.customDecorations)!=null?X:[],E+i),U=new s.TextX,F=s.JSONX.getInstance();if(!h.collapsed&&r){const k=s.BuildTextUtils.selection.delete([h],f,0,null,!1);U.push(...k),v.params.textRanges=[{startOffset:E+T,endOffset:E+T,collapsed:!0}]}else U.push({t:s.TextXActionType.RETAIN,len:E});i>0&&U.push({t:s.TextXActionType.DELETE,len:i}),U.push({t:s.TextXActionType.INSERT,body:{dataStream:n,textRuns:N?[{...N,st:0,ed:n.length}]:[],customRanges:b?[{...b,startIndex:0,endIndex:n.length-1}]:[],customDecorations:x.map(k=>({...k,startIndex:0,endIndex:n.length-1}))},len:n.length});const V=Z(m,p);v.params.actions=F.editOp(U.serialize(),V),v.params.noHistory=!a,v.params.isCompositionEnd=a;const H=c.syncExecuteCommand(v.id,v.params);return u.pushUndoRedoMutationParams(H,v.params),!!H}};function Ae(o,t,e){return e.executeCommand(ye.id,{preCommandId:o,...t!=null?t:{}})}const Ri="doc.command.set-inline-format-bold",Be={id:Ri,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ri,t,e)}},Mi="doc.command.set-inline-format-italic",_e={id:Mi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Mi,t,e)}},xi="doc.command.set-inline-format-underline",Ne={id:xi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(xi,t,e)}},Di="doc.command.set-inline-format-strikethrough",Pe={id:Di,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Di,t,e)}},Bi="doc.command.set-inline-format-subscript",Ee={id:Bi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Bi,t,e)}},_i="doc.command.set-inline-format-superscript",we={id:_i,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(_i,t,e)}},Ni="doc.command.set-inline-format-fontsize",he={id:Ni,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ni,t,e)}},Pi="doc.command.set-inline-format-font-family",Ue={id:Pi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Pi,t,e)}},wi="doc.command.set-inline-format-text-color",Ce={id:wi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(wi,t,e)}},Ui="doc.command.set-inline-format-text-background-color",Te={id:Ui,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ui,t,e)}},Li="doc.command.reset-inline-format-text-background-color",Ze={id:Li,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Li,t,e)}},Zn={[Be.id]:"bl",[_e.id]:"it",[Ne.id]:"ul",[Pe.id]:"st",[he.id]:"fs",[Ue.id]:"ff",[Ce.id]:"cl",[Te.id]:"bg",[Ze.id]:"bg",[Ee.id]:"va",[we.id]:"va"},ye={id:"doc.command.set-inline-format",type:s.CommandType.COMMAND,handler:async(o,t)=>{var R;const{value:e,preCommandId:n}=t,i=o.get(s.ICommandService),a=o.get(D.DocSelectionManagerService),r=o.get(s.IUniverInstanceService),c=o.get(ve),l=a.getDocRanges(),A=(R=l.find(v=>v.isActive))!=null?R:l[0];if(l.length===0)return!1;const{segmentId:d}=l[0],u=r.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(u==null)return!1;const m=u.getSelfOrHeaderFooterModel(d).getBody();if(m==null)return!1;const h=u.getUnitId();let g;switch(n){case Be.id:case _e.id:case Ne.id:case Pe.id:case Ee.id:case we.id:{const v=c.getDefaultStyle(),O=Fi(m,A,v);g=Za(O,n);break}case he.id:case Ue.id:{g=e;break}case Ce.id:case Te.id:{g={rgb:e};break}case Ze.id:{g={rgb:null};break}default:throw new Error(`Unknown command: ${n} in handleInlineFormat`)}const p={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:l}},f=new s.TextX,S=s.JSONX.getInstance(),E=new s.MemoryCursor;E.reset();for(const v of l){let{startOffset:O,endOffset:M,rangeType:b}=v;if(O==null||M==null)continue;if(b===s.DOC_RANGE_TYPE.RECT&&(O=O-1),O===M){const U=c.getStyleCache(),F=Zn[n];c.setStyleCache({[F]:(U==null?void 0:U[F])!==void 0?Qi(U,F,n):g});continue}const N={dataStream:"",textRuns:[{st:0,ed:M-O,ts:{[Zn[n]]:g}}]},x=O-E.cursor;x!==0&&f.push({t:s.TextXActionType.RETAIN,len:x}),f.push({t:s.TextXActionType.RETAIN,body:N,len:M-O}),E.reset(),E.moveCursor(M)}const C=Z(u,d);return p.params.actions=S.editOp(f.serialize(),C),!!i.syncExecuteCommand(p.id,p.params)}};function Ja(o){return o!==null&&typeof o=="object"}function Qi(o,t,e){if(/bl|it/.test(t))return(o==null?void 0:o[t])===s.BooleanNumber.TRUE?s.BooleanNumber.FALSE:s.BooleanNumber.TRUE;if(/ul|st/.test(t))return Ja(o==null?void 0:o[t])&&(o==null?void 0:o[t]).s===s.BooleanNumber.TRUE?{s:s.BooleanNumber.FALSE}:{s:s.BooleanNumber.TRUE};if(/va/.test(t))return e===Ee.id?(o==null?void 0:o[t])===s.BaselineOffset.SUBSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUBSCRIPT:(o==null?void 0:o[t])===s.BaselineOffset.SUPERSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUPERSCRIPT}function Fi(o,t,e){var d,u,m,h,g,p,f,S,E,C,T,R,v,O;const{startOffset:n,endOffset:i,collapsed:a}=t;if(a){const M=(d=o.textRuns)!=null?d:[];let b=null;for(let N=M.length-1;N>=0;N--){const x=M[N];if(x.st<n&&n<=x.ed){b=x;break}}return b!=null&&b.ts?{...e,...b.ts}:e}const{textRuns:r=[]}=s.getBodySlice(o,n,i),c=s.Tools.deepClone(e),l=r.map(M=>{var b;return(b=M==null?void 0:M.ts)==null?void 0:b.fs}).filter(Boolean);c.fs=c.fs?Math.max(c.fs,...l):l.length?Math.max(...l):void 0,c.fs=!c.fs||Number.isNaN(c.fs)?void 0:c.fs,c.ff=(h=(m=(u=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.ff)!=null}))==null?void 0:u.ts)==null?void 0:m.ff)!=null?h:c.ff,c.it=r.length&&r.every(M=>{var b;return((b=M.ts)==null?void 0:b.it)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.bl=r.length&&r.every(M=>{var b;return((b=M.ts)==null?void 0:b.bl)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.ul=r.length&&r.every(M=>{var b,N;return((N=(b=M.ts)==null?void 0:b.ul)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(g=r[0].ts)==null?void 0:g.ul:c.ul,c.st=r.length&&r.every(M=>{var b,N;return((N=(b=M.ts)==null?void 0:b.st)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(p=r[0].ts)==null?void 0:p.st:c.st,c.bg=(E=(S=(f=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.bg)!=null}))==null?void 0:f.ts)==null?void 0:S.bg)!=null?E:c.bg,c.cl=(R=(T=(C=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.cl)!=null}))==null?void 0:C.ts)==null?void 0:T.cl)!=null?R:c.cl;const A=r.filter(M=>{var b;return((b=M==null?void 0:M.ts)==null?void 0:b.va)!=null});if(A.length>0&&A.length===r.length){const M=(v=A[0].ts)==null?void 0:v.va;let b=!0;for(let N=1;N<A.length;N++)if(((O=A[N].ts)==null?void 0:O.va)!==M){b=!1;break}b&&(c.va=M)}return c}function Za(o,t){const e=Zn[t];return Qi(o,e,t)}const $n={id:"doc.command-replace-snapshot",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,snapshot:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot();if(d==null||u==null)return!1;const{body:m,tableSource:h,footers:g,headers:p,lists:f,drawings:S,drawingsOrder:E,documentStyle:C}=s.Tools.deepClone(n),{body:T,tableSource:R,footers:v,headers:O,lists:M,drawings:b,drawingsOrder:N,documentStyle:x}=u;if(m==null||T==null)return!1;if(s.Tools.diffValue(m,T)&&i)return A.replaceDocRanges(i,{unitId:e,subUnitId:e},!1),!0;const U={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:i}};r&&(U.params.options=r);const F=[],V=s.JSONX.getInstance();if(!s.Tools.diffValue(x,C)){const Q=V.replaceOp(["documentStyle"],x,C);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(m,T)){const Q=V.replaceOp(["body"],T,m);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(h,R)){const Q=V.replaceOp(["tableSource"],R,h);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(g,v)){const Q=V.replaceOp(["footers"],v,g);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(p,O)){const Q=V.replaceOp(["headers"],O,p);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(f,M)){const Q=V.replaceOp(["lists"],M,f);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(S,b)){const Q=V.replaceOp(["drawings"],b,S);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(E,N)){const Q=V.replaceOp(["drawingsOrder"],N,E);Q!=null&&F.push(Q)}return U.params.actions=F.reduce((Q,j)=>s.JSONX.compose(Q,j),null),!!l.syncExecuteCommand(U.id,U.params)}},Hi={id:"doc.command-replace-content",type:s.CommandType.COMMAND,handler:async(o,t)=>{const{unitId:e,body:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=Vi(e,a,d,u,n);return m.params.textRanges=i,r&&(m.params.options=r),m.params.actions==null&&i?(A.replaceDocRanges(i,{unitId:e,subUnitId:e},!1),!0):!!l.syncExecuteCommand(m.id,m.params)}},ki={id:"doc.command-cover-content",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,segmentId:i="",textRanges:a}=t,r=o.get(s.IUniverInstanceService),c=o.get(s.ICommandService),l=o.get(s.IUndoRedoService),A=r.getUniverDocInstance(e),d=A==null?void 0:A.getSnapshot().body;if(A==null||d==null)return!1;const u=Vi(e,i,A,d,n);return u.params.noNeedSetTextRange=!0,u.params.noHistory=!0,u.params.textRanges=a,c.syncExecuteCommand(u.id,u.params),l.clearUndoRedo(e),!0}};function $a(o,t,e,n){const i=new s.TextX,a=s.JSONX.getInstance(),r=(e==null?void 0:e.dataStream.length)-2;r>0&&i.push({t:s.TextXActionType.DELETE,len:r}),n.dataStream.length>0&&i.push({t:s.TextXActionType.INSERT,body:n,len:n.dataStream.length});const c=Z(t,o);return a.editOp(i.serialize(),c)}function Vi(o,t,e,n,i){const a={id:D.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:[]}},r=$a(t,e,n,i);return a.params.actions=r,a}const eo={id:"doc.command.replace-selection",type:s.CommandType.COMMAND,handler(o,t){var g;if(!t)return!1;const e=o.get(s.ICommandService),{unitId:n,body:i,textRanges:a}=t,c=o.get(s.IUniverInstanceService).getUnit(n),l=o.get(D.DocSelectionManagerService);if(!c)return!1;const A=c.getBody(),d=(g=t.selection)!=null?g:l.getActiveTextRange();if(!d||!A)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:n,actions:[],textRanges:a,debounce:!0}},m=new s.TextX,h=s.JSONX.getInstance();return m.push(...s.BuildTextUtils.selection.delete([d],A,0,i)),u.params.actions=h.editOp(m.serialize()),e.syncExecuteCommand(u.id,u.params)}},Wi={id:"doc.command.replace-text-runs",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(s.ThemeService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=s.BuildTextUtils.selection.replaceTextRuns({doc:d,body:n,selection:{startOffset:0,endOffset:u.dataStream.length-2,collapsed:!1},themeService:A});if(!m)return!1;const h={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:i,noHistory:!0}},g=s.JSONX.getInstance(),p=Z(d,a);return h.params.actions=g.editOp(m.serialize(),p),h.params.textRanges=i,r&&(h.params.options=r),!!l.syncExecuteCommand(h.id,h.params)}},Gi={id:"doc.command.insert-custom-range",type:s.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(s.ICommandService),{unitId:n,rangeId:i=s.generateRandomId(),textRanges:a,properties:r,text:c,wholeEntity:l}=t,A={unitId:n,textRanges:a,body:{dataStream:c,customRanges:[{startIndex:0,endIndex:c.length-1,rangeId:i,rangeType:s.CustomRangeType.CUSTOM,properties:r,wholeEntity:l}]}};return e.syncExecuteCommand(eo.id,A)}},$e={id:"doc.command.list-operation",type:s.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,O,M,b;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=t.listType,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(R=(T=t.docRange)!=null?T:e.getDocRanges())!=null?R:[];if(r==null||c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(O=(v=A.getBody())==null?void 0:v.paragraphs)!=null?O:[],u=(b=(M=A.getBody())==null?void 0:M.dataStream)!=null?b:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c,isEditing:!1}};new s.MemoryCursor().reset();const f=s.BuildTextUtils.paragraph.bullet.switch({paragraphs:m,listType:a,document:r,segmentId:l}),S=s.JSONX.getInstance(),E=Z(r,l);return g.params.actions=S.editOp(f.serialize(),E),!!i.syncExecuteCommand(g.id,g.params)}},St={id:"doc.command.change-list-type",type:s.CommandType.COMMAND,handler:(o,t)=>{var C,T,R,v,O;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{listType:a}=t,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(C=t.docRange)!=null?C:e.getDocRanges();if(r==null||c==null||!c.length)return!1;const{segmentId:l}=c[0],A=r.getSelfOrHeaderFooterModel(l),d=(R=(T=A.getBody())==null?void 0:T.paragraphs)!=null?R:[],u=(O=(v=A.getBody())==null?void 0:v.dataStream)!=null?O:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g=s.BuildTextUtils.paragraph.bullet.set({paragraphs:m,listType:a,segmentId:l,document:r});if(!g)return!1;const p=s.JSONX.getInstance(),f={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c,isEditing:!1}},S=Z(r,l);return f.params.actions=p.editOp(g.serialize(),S),!!i.syncExecuteCommand(f.id,f.params)}};var It=(o=>(o[o.increase=1]="increase",o[o.decrease=-1]="decrease",o))(It||{});const Yt={id:"doc.command.change-list-nesting-level",type:s.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,O,M;if(!t)return!1;const{type:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null)return!1;const{segmentId:l}=c,A=(T=n.getDocRanges())!=null?T:[],d=r.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"";if(!u.length)return!1;const h=s.BuildTextUtils.range.getParagraphsInRange(c,u,m),g=r.getUnitId(),p=s.JSONX.getInstance(),f=s.BuildTextUtils.paragraph.bullet.changeNestLevel({paragraphs:h,type:e,segmentId:l,document:r}),S={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:A,isEditing:!1}},E=Z(r,l);return S.params.actions=p.editOp(f.serialize(),E),!!a.syncExecuteCommand(S.id,S.params)}},et={id:"doc.command.bullet-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.BULLET_LIST,docRange:t==null?void 0:t.docRange})}},vt={id:"doc.command.check-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.CHECK_LIST,docRange:t==null?void 0:t.docRange})}},to={id:"doc.command.toggle-check-list",type:s.CommandType.COMMAND,handler:(o,t)=>{var p;if(!t)return!1;const e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),{index:i,segmentId:a,textRanges:r}=t,c=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(c==null||((p=c.getSelfOrHeaderFooterModel(a).getBody())==null?void 0:p.paragraphs)==null)return!1;const A=c.getUnitId(),d={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r!=null?r:[],segmentId:a,isEditing:!1}},u=s.BuildTextUtils.paragraph.bullet.toggleChecklist({document:c,paragraphIndex:i,segmentId:a});if(!u)return!1;const m=s.JSONX.getInstance(),h=Z(c,a);return d.params.actions=m.editOp(u.serialize(),h),!!n.syncExecuteCommand(d.id,d.params)}},tt={id:"doc.command.order-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.ORDER_LIST})}},no={id:"doc.command.quick-list",type:s.CommandType.COMMAND,handler(o,t){var x,U,F;if(!t)return!1;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getActiveTextRange();if(a==null||r==null)return!1;const{segmentId:c,startOffset:l}=r,{listType:A,paragraph:d}=t,{paragraphStart:u,paragraphEnd:m}=d,h=new s.TextX,g=s.JSONX.getInstance(),{paragraphStyle:p={}}=d,S=(s.PRESET_LIST_TYPE[A].nestingLevel[0].paragraphProperties||{}).textStyle;let C=s.generateRandomId(6);const T=(U=(x=a.getBody())==null?void 0:x.paragraphs)!=null?U:[],R=T.findIndex(V=>V.startIndex===d.startIndex),v=T[R-1],O=T[R+1];v&&v.bullet&&v.bullet.listType.indexOf(A)===0?C=v.bullet.listId:O&&O.bullet&&O.bullet.listType.indexOf(A)===0&&(C=O.bullet.listId);const M={id:D.RichTextEditingMutation.id,params:{unitId:a.getUnitId(),actions:[],textRanges:[{startOffset:u,endOffset:u,collapsed:!0}],isEditing:!1}};h.push({t:s.TextXActionType.RETAIN,len:u}),h.push({t:s.TextXActionType.DELETE,len:l-u}),m>l&&h.push({t:s.TextXActionType.RETAIN,len:m-l}),h.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...p,textStyle:{...p.textStyle,...S},indentFirstLine:void 0},bullet:{...(F=d.bullet)!=null?F:{nestingLevel:0,textStyle:{fs:20}},listType:A,listId:C}}]}});const b=Z(a,c);return M.params.actions=g.editOp(h.serialize(),b),!!i.syncExecuteCommand(M.id,M.params)}};function oo(o,t){var d,u;const e=o.get(s.ICommandService),n=ut(o);if(!n)return!1;const i=o.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!i)return!1;const a=s.BuildTextUtils.selection.replace({doc:i,selection:{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0},body:{dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:{...n.paragraphStyle},bullet:{listType:t,listId:((d=n.bullet)==null?void 0:d.listType)===t?n.bullet.listId:s.generateRandomId(6),nestingLevel:((u=n.bullet)==null?void 0:u.listType)===t?n.bullet.nestingLevel:0}}]}});if(!a)return!1;const r={id:D.RichTextEditingMutation.id,params:{unitId:i.getUnitId(),actions:[],textRanges:[{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0}],isEditing:!1}},c=s.JSONX.getInstance(),l=Z(i);return r.params.actions=c.editOp(a.serialize(),l),!!e.syncExecuteCommand(r.id,r.params)}const io={id:"doc.command.insert-bullet-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.BULLET_LIST)},so={id:"doc.command.insert-order-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.ORDER_LIST)},ao={id:"doc.command.insert-check-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.CHECK_LIST)},ge={id:"doc.command.align-action",type:s.CommandType.COMMAND,handler:(o,t)=>{var R,v,O,M;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{alignType:a}=t,r=n.getCurrentUniverDocInstance();if(r==null)return!1;const c=e.getDocRanges();if(c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(v=(R=A.getBody())==null?void 0:R.paragraphs)!=null?v:[],u=(M=(O=A.getBody())==null?void 0:O.dataStream)!=null?M:"";if(d==null)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g=m.every(b=>{var N;return((N=b.paragraphStyle)==null?void 0:N.horizontalAlign)===a}),p={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c}},f=new s.MemoryCursor;f.reset();const S=new s.TextX,E=s.JSONX.getInstance();for(const b of m){const{startIndex:N}=b;S.push({t:s.TextXActionType.RETAIN,len:N-f.cursor});const x={...b.paragraphStyle,horizontalAlign:g?s.HorizontalAlign.UNSPECIFIED:a};S.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...b,paragraphStyle:x,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(N+1)}const C=Z(r,l);return p.params.actions=E.editOp(S.serialize(),C),!!i.syncExecuteCommand(p.id,p.params)}},Et={id:"doc.command.align-left",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.LEFT})},Ct={id:"doc.command.align-center",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.CENTER})},Tt={id:"doc.command.align-right",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.RIGHT})},yt={id:"doc.command.align-justify",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.JUSTIFIED})},er=(o,t)=>{const n=o.get(s.IUniverInstanceService).getUnit(t.unitId,s.UniverInstanceType.UNIVER_DOC);return n==null||n.setZoomRatio(t.zoomRatio),{...t}},ue={id:"doc.operation.set-zoom-ratio",type:s.CommandType.OPERATION,handler:(o,t)=>{const n=o.get(s.IUniverInstanceService).getUnit(t.unitId,s.UniverInstanceType.UNIVER_DOC);return n?(n.setZoomRatio(t.zoomRatio),!0):!1}},bt={type:s.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(o,t)=>{var u,m,h;const e=o.get(s.ICommandService),n=o.get(s.IUndoRedoService),i=o.get(s.IUniverInstanceService);let a=(u=i.getCurrentUniverDocInstance())==null?void 0:u.getUnitId();if(!a)return!1;let r=1;if(t&&(a=(m=t.documentId)!=null?m:a,r=(h=t.zoomRatio)!=null?h:r),!i.getUniverDocInstance(a))return!1;const l={zoomRatio:r,unitId:a},A=er(o,l);return e.syncExecuteCommand(ue.id,l)?(n.pushUndoRedo({unitID:a,undoMutations:[{id:ue.id,params:A}],redoMutations:[{id:ue.id,params:l}]}),!0):!1}},ce={id:"doc.command.set-paragraph-named-style",type:s.CommandType.COMMAND,handler(o,t){var g;if(!t)return!1;const n=o.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const i=n.getUnitId(),a=o.get(D.DocSelectionManagerService),r=(g=t.textRanges)!=null?g:a.getTextRanges({unitId:i,subUnitId:i});if(!(r!=null&&r.length))return!1;const c=r[0].segmentId,l=s.BuildTextUtils.paragraph.style.set({document:n.getSelfOrHeaderFooterModel(c),textRanges:r,style:{namedStyleType:t.value,headingId:!t.value||t.value===s.NamedStyleType.NORMAL_TEXT?void 0:s.generateRandomId(6),spaceAbove:void 0,spaceBelow:void 0,lineSpacing:void 0},paragraphTextRun:{}}),A={id:D.RichTextEditingMutation.id,params:{actions:[],textRanges:r,unitId:i,segmentId:c}},d=s.JSONX.getInstance(),u=Z(n,c);return A.params.actions=d.editOp(l.serialize(),u),!!o.get(s.ICommandService).syncExecuteCommand(A.id,A.params)}},Xi={id:"doc.command.quick-heading",type:s.CommandType.COMMAND,handler(o,t){var R,v,O,M;if(!t)return!1;const{value:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null||!c.collapsed)return!1;const{segmentId:l,startOffset:A}=c,d=r.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"",h=s.BuildTextUtils.paragraph.util.getParagraphsInRange(c,u,m)[0];if(!h)return!1;const{paragraphStart:g}=h,p=new s.TextX,f=s.JSONX.getInstance(),{paragraphStyle:S={}}=h,E={id:D.RichTextEditingMutation.id,params:{unitId:r.getUnitId(),actions:[],textRanges:[{startOffset:g,endOffset:g,collapsed:!0}],isEditing:!1}};p.push({t:s.TextXActionType.RETAIN,len:g}),s.BuildTextUtils.paragraph.style.set({textRanges:[c],document:r,style:{...S,headingId:s.generateRandomId(6),namedStyleType:e},cursor:A,deleteLen:A-g,textX:p,paragraphTextRun:{}});const C=Z(r,l);return E.params.actions=f.editOp(p.serialize(),C),!!a.syncExecuteCommand(E.id,E.params)}},ro={"#":s.NamedStyleType.HEADING_1,"##":s.NamedStyleType.HEADING_2,"###":s.NamedStyleType.HEADING_3,"####":s.NamedStyleType.HEADING_4,"#####":s.NamedStyleType.HEADING_5},co={id:"doc.command.h1-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_1})},lo={id:"doc.command.h2-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_2})},Ao={id:"doc.command.h3-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_3})},uo={id:"doc.command.h4-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_4})},ho={id:"doc.command.h5-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_5})},qt={id:"doc.command.normal-text-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.NORMAL_TEXT})},ji={id:"doc.command.title",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.TITLE})},Ki={id:"doc.command.subtitle-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.SUBTITLE})};var Jt=(o=>(o[o.page=0]="page",o[o.section=1]="section",o[o.column=2]="column",o[o.line=3]="line",o[o.divide=4]="divide",o[o.glyph=5]="glyph",o))(Jt||{});const nt={page:0,section:1,column:2,line:3,divide:4,glyph:5};function go(o,t){return o.page>t.page?!1:o.page<t.page?!0:o.section>t.section?!1:o.section<t.section?!0:o.column>t.column?!1:o.column<t.column?!0:o.line>t.line?!1:o.line<t.line?!0:o.divide>t.divide?!1:o.divide<t.divide?!0:o.glyph>t.glyph?!1:(o.glyph<t.glyph,!0)}function mo(o,t){return go(o,t)?{start:o,end:t}:{start:t,end:o}}function po(o){const t=o.length;if(t===0)return;const e=o[0],n=o[t-1],i=o.length===1&&e.collapsed;return{startOffset:e.startOffset,endOffset:n.endOffset,collapsed:i}}function tr(o,t,e,n){let i=n,a=n;for(let r=0;r<o.length;r++){const l=o[r].count;r<t&&(i+=l),r<e&&(a+=l)}return{startOffset:i,endOffset:a}}function fo(o){const{startX:t,startY:e,endX:n,endY:i}=o,a=[];return a.push({x:t,y:e}),a.push({x:n,y:e}),a.push({x:n,y:i}),a.push({x:t,y:i}),a.push({x:t,y:e}),a}class be{constructor(t,e){B(this,"_liquid",new _.Liquid);B(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});B(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],i=[],a=[];if(t==null||e==null)return{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:a};if(!this._isValidPosition(t,e))throw new Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);const{start:c,end:l}=mo(t,e);return this._selectionIterator(c,l,(A,d,u,m,h,g)=>{const{lineHeight:p,asc:f,paddingTop:S,marginTop:E,marginBottom:C}=g,{glyphGroup:T,st:R}=h;if(T.length===0)return;const{x:v,y:O}=this._liquid;let M,b;const N=T[A],x=T[d],U=T[A-1],F=(N==null?void 0:N.left)||0,V=(N==null?void 0:N.width)||0,H=(x==null?void 0:x.left)||0,Q=(x==null?void 0:x.width)||0,j=(N==null?void 0:N.glyphType)===_.GlyphType.LIST,{startOffset:X,endOffset:k}=tr(T,A,d,R),W=c.glyph===A&&u?c.isBack:!0,G=l.glyph===d&&m?l.isBack:!1,K=c===l,Y=W&&U!=null?U:N;if(A===0&&d===T.length-1)M={startX:v+F+(j?V:0),startY:O,endX:v+H+(G?0:Q),endY:O+p-E-C},b={startX:v+F+(j?V:0),startY:O+S+f-Y.bBox.ba,endX:v+H+(G?0:Q),endY:O+S+f+Y.bBox.bd};else{const q=W&&!j;M={startX:v+F+(q?0:V),startY:O,endX:v+H+(G?0:Q),endY:O+p-E-C},b={startX:v+F+(q?0:V),startY:O+S+f-Y.bBox.ba,endX:v+H+(G?0:Q),endY:O+S+f+Y.bBox.bd}}n.push(fo(M)),i.push(fo(b)),a.push({startOffset:W?X:X+N.count,endOffset:G?k:k+x.count,collapsed:K})}),{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:a}}_isValidPosition(t,e){const{segmentPage:n,pageType:i}=t,{segmentPage:a,pageType:r}=e;return i!==r?!1:i===_.DocumentSkeletonPageType.HEADER||i===_.DocumentSkeletonPageType.FOOTER?n===a:!0}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(t=0,e,n,i){i===e?this._currentStartState[t]=1:this._currentStartState[t]=0,i===n?this._currentEndState[t]=2:this._currentEndState[t]=0}_checkPreviousNodePositionState(t,e=!0){let n=t,i;for(;n>=0;){const a=Jt[n];let r;if(e?r=this._currentStartState[a]:r=this._currentEndState[a],r===void 0)return;if(i===void 0&&(i=r),r!==i)return 0;n--}return i}_getSelectionRuler(t,e,n,i,a){let r=0,c=i;const l=Jt[t],A=Jt[t+1];if(A===null||l===null)return{start_next:r,end_next:c};const d=e[l],u=n[l];this._setNodePositionState(l,d,u,a);const m=this._checkPreviousNodePositionState(t),h=this._checkPreviousNodePositionState(t,!1);return m===1&&(r=e[A]),h===2&&(c=n[A]),{start_next:r,end_next:c}}_selectionIterator(t,e,n){var T,R;const i=this._docSkeleton;if(!i)return[];const{pageType:a,path:r}=t;this._liquid.reset();const c=i.getSkeletonData();if(c==null)return[];const{pages:l,skeHeaders:A,skeFooters:d}=c,{page:u,segmentPage:m}=t,{page:h,segmentPage:g}=e;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:p,pageMarginLeft:f,pageMarginTop:S}=this._documentOffsetConfig,E=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?u:m;for(let v=0;v<E;v++){const O=l[v];this._liquid.translatePage(O,p,f,S)}const C=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?h:g;for(let v=E;v<=C;v++){const O=l[v],{headerId:M,footerId:b,pageWidth:N}=O;let x=O;if(a===_.DocumentSkeletonPageType.HEADER?x=(T=A.get(M))==null?void 0:T.get(N):a===_.DocumentSkeletonPageType.FOOTER?x=(R=d.get(b))==null?void 0:R.get(N):a===_.DocumentSkeletonPageType.CELL&&(x=_.getPageFromPath(c,r)),x==null){this._liquid.translatePage(O,p,f,S);continue}const U=x.sections,{start_next:F,end_next:V}=this._getSelectionRuler(nt.page,t,e,U.length-1,a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?v:0);switch(this._liquid.translateSave(),a){case _.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...x,marginLeft:O.marginLeft});break;case _.DocumentSkeletonPageType.FOOTER:{const H=O.pageHeight-x.height-x.marginBottom;this._liquid.translate(O.marginLeft,H);break}case _.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(O);const H=x.parent,Q=H.parent,{left:j}=x,{top:X,left:k}=Q,{top:W}=H;this._liquid.translate(k+j,X+W),this._liquid.translatePagePadding(x);break}default:this._liquid.translatePagePadding(O);break}for(let H=F;H<=V;H++){const Q=U[H],j=Q.columns,{start_next:X,end_next:k}=this._getSelectionRuler(nt.section,t,e,j.length-1,H);this._liquid.translateSection(Q);for(let W=X;W<=k;W++){const G=j[W],K=G.lines,{start_next:Y,end_next:q}=this._getSelectionRuler(nt.column,t,e,K.length-1,W);this._liquid.translateColumn(G);for(let z=Y;z<=q;z++){const $=K[z],{divides:ie}=$,{start_next:fe,end_next:He}=this._getSelectionRuler(nt.line,t,e,ie.length-1,z);this._liquid.translateSave(),this._liquid.translateLine($,!0,!1);for(let Se=fe;Se<=He;Se++){const ti=ie[Se];this._liquid.translateSave(),this._liquid.translateDivide(ti);const{glyphGroup:bA}=ti,{start_next:OA,end_next:RA}=this._getSelectionRuler(nt.divide,t,e,bA.length-1,Se);let ua=!1,ha=!1;v===E&&H===F&&W===X&&z===Y&&Se===fe&&(ua=!0),v===C&&H===V&&W===k&&z===q&&Se===He&&(ha=!0),n&&n(OA,RA,ua,ha,ti,$,G,Q,x),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(O,p,f,S)}}}function zi(o,t){const{path:e}=o,{path:n}=t;if(e.length!==n.length||e.indexOf("cells")===-1)return!1;const i=e.indexOf("skeTables")+1,a=e.indexOf("rows")+1,r=e.indexOf("cells")+1,{tableId:c,sliceIndex:l}=_.getTableIdAndSliceIndex(e[i]),{tableId:A,sliceIndex:d}=_.getTableIdAndSliceIndex(n[i]);if(c!==A)return!1;const u=e[a],m=n[a],h=e[r],g=n[r];return!(u===m&&h===g&&l===d)}function So(o,t){const{path:e}=o,{path:n}=t;return e.indexOf("cells")===-1||n.indexOf("cells")===-1||e.length!==n.length?!1:s.Tools.diffValue(e,n)}function Yi(o,t,e){var h,g,p,f,S,E,C,T;const{path:n}=t,{path:i}=e;if(n.indexOf("cells")===-1||i.indexOf("cells")===-1)return!1;const a=o.findGlyphByPosition(t),r=o.findGlyphByPosition(e),c=(f=(p=(g=(h=a==null?void 0:a.parent)==null?void 0:h.parent)==null?void 0:g.parent)==null?void 0:p.parent)==null?void 0:f.parent,l=(T=(C=(E=(S=r==null?void 0:r.parent)==null?void 0:S.parent)==null?void 0:E.parent)==null?void 0:C.parent)==null?void 0:T.parent;if(c==null||l==null)return!1;const A=c.parent,d=l.parent,u=A.cells.indexOf(c),m=d.cells.indexOf(l);return u===m&&A.index===d.index}function Io(o,t){if(So(o,t))return go(o,t);const{path:e}=o,{path:n}=t,i=e[e.length-5],a=n[n.length-5];if(i!==a&&typeof i=="string"&&typeof a=="string"){const d=i.split("#-#")[1],u=a.split("#-#")[1];return+d<+u}const r=e[e.length-3],c=n[n.length-3],l=e[e.length-1],A=n[n.length-1];return r<c?!0:r>c?!1:l<=A}function ot(o){return o.sections[0].columns[0].lines.length===0}function nr(o,t,e){let n=t,i=e,a=o[n],r=o[i];for(;n<i&&(ot(a)||ot(r));)ot(a)?(n++,a=o[n]):ot(r)&&(i--,r=o[i]);if(!ot(a)&&!ot(r))return[a,r]}class vo{constructor(t,e){B(this,"_liquid",new _.Liquid);this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],a=this._docSkeleton.getSkeletonData();if(a==null)return;const{pages:r}=a,{segmentPage:c,page:l,pageType:A}=t,d=this._getTableRectRangeInfo(t,e);if(d==null)return;const{tableId:u,startRowIndex:m,startColumnIndex:h,endRowIndex:g,endColumnIndex:p}=d;this._liquid.reset();const{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:E}=this._documentOffsetConfig,C=A===_.DocumentSkeletonPageType.BODY||A===_.DocumentSkeletonPageType.CELL?l:c;for(let T=0;T<C;T++){const R=r[T];this._liquid.translatePage(R,f,S,E)}for(let T=C;T<r.length;T++){const R=r[T];this._liquid.translatePagePadding(R);const{skeTables:v}=R;let O=null;for(const[x,U]of v.entries())x.startsWith(u)&&(O=U);if(O==null){this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E);continue}this._liquid.translateSave(),this._liquid.translate(0,O.top);const{x:M,y:b}=this._liquid,{left:N}=O;for(const x of O.rows)if(x.index>=m&&x.index<=g){const U=nr(x.cells,h,p);if(U==null)continue;const[F,V]=U,H={startX:M+F.left+N,startY:b+x.top,endX:M+V.left+V.pageWidth+N,endY:b+x.top+x.height};n.push(fo(H))}this._liquid.translateRestore(),this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E)}return{pointGroup:n,startRow:m,startColumn:h,endRow:g,endColumn:p,tableId:u}}getNodePositionGroup(t,e){const n=[],i=this._docSkeleton.findCharIndexByPosition(t),a=this._docSkeleton.findCharIndexByPosition(e);if(i==null||a==null)return;const r=i<a,c=this._getTableRectRangeInfo(t,e);if(c==null)return;const{tableId:l,startRowIndex:A,startColumnIndex:d,endRowIndex:u,endColumnIndex:m}=c,h=this._docSkeleton.getViewModel().findTableNodeById(l);if(h==null)return;const g=h.children[0].children.length;if(d===0&&m===g-1){const f=h.children[A].children[d],S=this._docSkeleton.findNodePositionByCharIndex(f.startIndex+1),E=h.children[u].children[m],C=this._docSkeleton.findNodePositionByCharIndex(E.endIndex-2);if(S==null||C==null)return;n.push({anchor:r?S:C,focus:r?C:S})}else for(let f=A;f<=u;f++){const S=h.children[f],E=S.children[d],C=S.children[m],T=this._docSkeleton.findNodePositionByCharIndex(E.startIndex+1),R=this._docSkeleton.findNodePositionByCharIndex(C.endIndex-2);if(T==null||R==null)return;n.push({anchor:r?T:R,focus:r?R:T})}return n}_getTableRectRangeInfo(t,e){const i=this._docSkeleton.getSkeletonData();if(i==null)return;const{pages:a}=i,{path:r}=t,{path:c}=e,l=_.getPageFromPath(i,r),A=_.getPageFromPath(i,c);if(l==null||A==null)return;const d=l.segmentId,u=l.parent.index,m=l.parent.cells.indexOf(l),h=(A==null?void 0:A.parent).index,g=(A==null?void 0:A.parent).cells.indexOf(A),p=Math.min(u,h),f=Math.max(u,h),S=Math.min(m,g),E=Math.max(m,g);return{pages:a,tableId:d,startRowIndex:p,startColumnIndex:S,endRowIndex:f,endColumnIndex:E}}}const or="__TestSelectionRange__",ir="__TestSelectionAnchor__",qi=6,Eo=500,sr=500,Zt=3;function Ot(o){const t=o[0],e=t[0],n=t[2],{x:i,y:a}=e,{x:r,y:c}=n;return{left:i,top:a,width:r-i,height:c-a}}function $t(o){return o.map(t=>{let e=1/0,n=-1/0,i=1/0,a=-1/0;return t.forEach(r=>{e=Math.min(r.x,e),n=Math.max(r.x,n),a=Math.max(r.y,a),i=Math.min(r.y,i)}),{left:e,right:n,top:i,bottom:a}})}class We{constructor(t,e,n,i,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.TEXT);B(this,"_current",!1);B(this,"_rangeShape");B(this,"_anchorShape");B(this,"_cursorList",[]);B(this,"_anchorBlinkTimer",null);this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},Eo),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},Eo))},sr+Eo)}get startOffset(){var i;const{startOffset:t}=(i=po(this._cursorList))!=null?i:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(n,t)}get endOffset(){var i;const{endOffset:t}=(i=po(this._cursorList))!=null?i:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(t,n)}get collapsed(){const{startOffset:t,endOffset:e}=this;return t!=null&&t===e}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:t}=mo(this.anchorNodePosition,this.focusNodePosition);return t}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:t}=mo(this.anchorNodePosition,this.focusNodePosition);return t}get direction(){const{collapsed:t,anchorNodePosition:e,focusNodePosition:n}=this;return t||e==null||n==null?s.RANGE_DIRECTION.NONE:go(e,n)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(this._isEmpty())return;const n=this._document.getOffsetConfig(),{docsLeft:i,docsTop:a}=n,r=new be(n,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup:d,cursorList:u}=r.getRangePointData(t,t);if(this._setCursorList(u),d.length===0)return;const m=Ot(d);return{...m,left:m.left+i,top:m.top+a}}const{borderBoxPointGroup:c,cursorList:l}=r.getRangePointData(t,e);if(this._setCursorList(l),c.length===0)return;const A=Ot(c);return{...A,left:A.left+i,top:A.top+a}}getAnchor(){return this._anchorShape}activeStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.strokeActive)||_.getColor(s.COLORS.black,1)})}deactivateStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.stroke)||_.getColor(s.COLORS.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t,e;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null,(e=this._anchorShape)==null||e.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(t){const{startOffset:e,endOffset:n}=this,{startOffset:i,endOffset:a}=t;return e==null||n==null||i==null||a==null?!1:e<=a&&n>=i}refresh(){var u,m;const{_document:t,_docSkeleton:e}=this,n=this.anchorNodePosition,i=this.focusNodePosition;if((u=this._anchorShape)==null||u.hide(),(m=this._rangeShape)==null||m.hide(),this._isEmpty())return;const a=t.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,l=new be(a,e);if(this._isCollapsed()){const{contentBoxPointGroup:h,cursorList:g}=l.getRangePointData(n,n);if(this._setCursorList(g),h.length>0){const p=e.findGlyphByPosition(n);this._createOrUpdateAnchor(h,r,c,p)}return}const{borderBoxPointGroup:A,cursorList:d}=l.getRangePointData(n,i);this._setCursorList(d),A.length>0&&this._createOrUpdateRange(A,r,c)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(t!=null&&e==null)return!0;if(t==null||e==null)return!1;const n=Object.keys(nt);for(const i of n){const a=t[i],r=e[i];if(a!==r)return!1}return t.isBack===e.isBack}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const i=.3,a=new _.RegularPolygon(or+s.generateRandomId(qi),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,i),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Zt)}_createOrUpdateAnchor(t,e,n,i){var p,f,S;const a=Ot(t),{left:r}=a;let{top:c,height:l}=a;const A=14;l<A&&(c-=A-l,l=A);const d=12;let u=r+e;const m=c+n,h=((p=i==null?void 0:i.ts)==null?void 0:p.it)===s.BooleanNumber.TRUE;if(h&&(u+=l*Math.tan(d*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:u,top:m,height:l}),this._anchorShape.show(),h?this._anchorShape.skew(-d,0):this._anchorShape.skew(0,0);return}const g=new _.Rect(ir+s.generateRandomId(qi),{left:u,top:m,height:l,strokeWidth:((f=this.style)==null?void 0:f.strokeWidth)||1,stroke:((S=this.style)==null?void 0:S.strokeActive)||_.getColor(s.COLORS.black,1),evented:!1});h&&g.skew(-d,0),this._anchorShape=g,this._scene.addObject(g,Zt),this.activeStatic()}_setCursorList(t){t.length!==0&&(this._cursorList=t)}}const ar="__DocTableRectRange__",rr=6;function en(o,t,e,n,i,a=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,r="",c=-1){const l=t.getOffsetConfig(),d=new vo(l,e).getNodePositionGroup(n,i);return(d!=null?d:[]).map(u=>new Co(o,t,e,u.anchor,u.focus,a,r,c))}class Co{constructor(t,e,n,i,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.RECT);B(this,"_rangeShape");B(this,"_current",!1);B(this,"_startRow");B(this,"_startCol");B(this,"_endRow");B(this,"_endCol");B(this,"_tableId");this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this.refresh()}get startOffset(){const{startNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get endOffset(){const{endNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startCol:n,_endCol:i}=this;if(e==null)throw new Error("Table is not found.");const{tableColumns:a}=e;return n===0&&i===a.length-1}get spanEntireColumn(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startRow:n,_endRow:i}=this;if(e==null)throw new Error("Table is not found.");const{tableRows:a}=e;return n===0&&i===a.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?t:e}get endNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?e:t}get direction(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null}isIntersection(t){const{startRow:e,startColumn:n,endRow:i,endColumn:a}=this,{startRow:r,startColumn:c,endRow:l,endColumn:A}=t,d={left:n,top:e,right:a,bottom:i},u={left:c,top:r,right:A,bottom:l};return s.Rectangle.hasIntersectionBetweenTwoRect(d,u)}refresh(){var f;(f=this._rangeShape)==null||f.hide();const{startNodePosition:t,endNodePosition:e,_document:n,_docSkeleton:i}=this,a=n.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,A=new vo(a,i).getRangePointData(t,e);if(A==null)return;const{pointGroup:d=[],startRow:u,endRow:m,startColumn:h,endColumn:g,tableId:p}=A;(d==null?void 0:d.length)>0&&this._createOrUpdateRange(d,r,c),this._updateTableInfo(u,m,h,g,p)}_updateTableInfo(t,e,n,i,a){this._startRow=t,this._endRow=e,this._startCol=n,this._endCol=i,this._tableId=a}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const i=.3,a=new _.RegularPolygon(ar+s.generateRandomId(rr),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,i),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Zt)}}function Ji(o,t,e,n,i,a,r,c,l=!0,A=!0){const d=i.findNodePositionByCharIndex(o,l,r,c),u=i.findNodePositionByCharIndex(t,A,r,c);if(!(d==null||u==null))return new We(e,n,i,d,u,a,r,c)}function cr(o,t,e,n,i,a,r,c){const l=i.findNodePositionByCharIndex(o,!0,r,c),A=i.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return new Co(e,n,i,l,A,a,r,c)}function lr(o,t,e,n,i,a,r,c){const l=i.findNodePositionByCharIndex(o,!0,r,c),A=i.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return To(l,A,e,n,i,a,r,c)}function To(o,t,e,n,i,a,r,c){const l=[],A=[],d=[e,n,i,o,t,a,r,c];if(Yi(i,o,t)){if(So(o,t))return l.push(new We(...d)),{textRanges:l,rectRanges:A};{const C=en(...d);return A.push(...C),{textRanges:l,rectRanges:A}}}if(zi(o,t)){const C=en(...d);return A.push(...C),{textRanges:l,rectRanges:A}}const u=i.getViewModel().getSelfOrHeaderFooterViewModel(r),m=i.findCharIndexByPosition(o),h=i.findCharIndexByPosition(t);if(m==null||h==null)return;const g=m<=h?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD,p=Math.min(m,h),f=Math.max(m,h);let S=p,E=f;for(const C of u.getChildren())for(const T of C.children){const{startIndex:R,endIndex:v,children:O}=T,M=C.children.indexOf(T),b=C.children[M+1],N=O[0];let x=!1;if(N){const{startIndex:U,endIndex:F,children:V}=N;let H=null,Q=null;const j=V.find(k=>k.startIndex<=p&&k.endIndex>=p),X=V.find(k=>k.startIndex<=f&&k.endIndex>=f);if(p>U&&p<F)H=i.findNodePositionByCharIndex(j.startIndex+2,!0,r,c),Q=i.findNodePositionByCharIndex(F-4,!0,r,c),S=F+1;else if(f>U&&f<F)H=i.findNodePositionByCharIndex(U+3,!0,r,c),Q=i.findNodePositionByCharIndex(X.endIndex-3,!0,r,c),E=U-1,x=!0;else if(U>p&&F<f){if(H=i.findNodePositionByCharIndex(U+3,!0,r,c),Q=i.findNodePositionByCharIndex(F-4,!0,r,c),S<=U-1){const k=i.findNodePositionByCharIndex(S,!0,r,c),W=i.findNodePositionByCharIndex(U-1,!1,r,c),G=g===s.RANGE_DIRECTION.FORWARD?k:W,K=g===s.RANGE_DIRECTION.FORWARD?W:k;l.push(new We(e,n,i,G,K,a,r,c))}S=F+1}if(H&&Q){const k=g===s.RANGE_DIRECTION.FORWARD?H:Q,W=g===s.RANGE_DIRECTION.FORWARD?Q:H;A.push(...en(e,n,i,k,W,a,r,c))}}if(E===v+1&&!x&&b&&b.children.length&&(E=v,x=!0),E>=R&&E<=v||x){const U=i.findNodePositionByCharIndex(S,!0,r,c),F=i.findNodePositionByCharIndex(E,!x,r,c),V=g===s.RANGE_DIRECTION.FORWARD?U:F,H=g===s.RANGE_DIRECTION.FORWARD?F:U;if(A.length&&s.Tools.diffValue(V,H))continue;l.push(new We(e,n,i,V,H,a,r,c))}}return{textRanges:l,rectRanges:A}}function Zi(o){const t=o==null?void 0:o.getCanvasElement();if(!t)return{left:0,top:0};const{top:e,left:n}=_.getOffsetRectForDom(t);return{left:n,top:e}}function $i(o){var l;const t=(l=o.parent)==null?void 0:l.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const{paragraphIndex:n}=t,i=e.lines.filter(A=>A.paragraphIndex===n);let a=-1,r="",c=!1;for(const A of i)for(const d of A.divides)for(const u of d.glyphGroup)c||(a+=u.count),u===o&&(c=!0),r+=u.count>0?u.content:"";return{st:i[0].st,ed:n,content:r,nodeIndex:a}}function yo(o){const{startOffset:t,endOffset:e,collapsed:n,rangeType:i,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A}=o;return{startOffset:t,endOffset:e,collapsed:n,rangeType:i,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A,isActive:o.isActive()}}function dr(o){const t=yo(o),{startRow:e,startColumn:n,endRow:i,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}=o;return{...t,startRow:e,startColumn:n,endRow:i,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}}var Ar=Object.getOwnPropertyDescriptor,ur=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ar(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},tn=(o,t)=>(e,n)=>t(e,n,o);y.DocSelectionRenderService=class extends s.RxDisposable{constructor(e,n,i,a,r){super();B(this,"_onInputBefore$",new L.Subject);B(this,"onInputBefore$",this._onInputBefore$.asObservable());B(this,"_onKeydown$",new L.Subject);B(this,"onKeydown$",this._onKeydown$.asObservable());B(this,"_onInput$",new L.Subject);B(this,"onInput$",this._onInput$.asObservable());B(this,"_onCompositionstart$",new L.BehaviorSubject(null));B(this,"onCompositionstart$",this._onCompositionstart$.asObservable());B(this,"_onCompositionupdate$",new L.BehaviorSubject(null));B(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable());B(this,"_onCompositionend$",new L.BehaviorSubject(null));B(this,"onCompositionend$",this._onCompositionend$.asObservable());B(this,"_onSelectionStart$",new L.BehaviorSubject(null));B(this,"onSelectionStart$",this._onSelectionStart$.asObservable());B(this,"onChangeByEvent$",L.merge(this._onInput$,this._onKeydown$.pipe(L.filter(e=>e.event.keyCode===I.KeyCode.BACKSPACE)),this._onCompositionend$));B(this,"_onPaste$",new L.Subject);B(this,"onPaste$",this._onPaste$.asObservable());B(this,"_textSelectionInner$",new L.BehaviorSubject(null));B(this,"textSelectionInner$",this._textSelectionInner$.asObservable());B(this,"_onFocus$",new L.Subject);B(this,"onFocus$",this._onFocus$.asObservable());B(this,"_onBlur$",new L.Subject);B(this,"onBlur$",this._onBlur$.asObservable());B(this,"_onPointerDown$",new L.Subject);B(this,"onPointerDown$",this._onPointerDown$.asObservable());B(this,"_container");B(this,"_inputParent");B(this,"_input");B(this,"_scrollTimers",[]);B(this,"_rangeList",[]);B(this,"_rangeListCache",[]);B(this,"_rectRangeList",[]);B(this,"_rectRangeListCache",[]);B(this,"_anchorNodePosition",null);B(this,"_focusNodePosition",null);B(this,"_currentSegmentId","");B(this,"_currentSegmentPage",-1);B(this,"_selectionStyle",_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE);B(this,"_onPointerEvent",!1);B(this,"_viewPortObserverMap",new Map);B(this,"_isIMEInputApply",!1);B(this,"_scenePointerMoveSubs",[]);B(this,"_scenePointerUpSubs",[]);B(this,"_reserveRanges",!1);this._context=e,this._layoutService=n,this._logService=i,this._univerInstanceService=a,this._docSkeletonManagerService=r,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||document.activeElement===null}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;e.getUnitId()!==this._context.unitId&&!this._reserveRanges&&this.removeAllRanges()})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,n=!0,i){const{_currentSegmentId:a,_currentSegmentPage:r,_selectionStyle:c}=this,{scene:l,mainComponent:A}=this._context,d=A,u=this._docSkeletonManagerService.getSkeleton(),m=(h,g)=>{const p=lr(h,g,l,d,u,c,a,r);if(p==null)return;const{textRanges:f,rectRanges:S}=p;for(const E of f)this._addTextRange(E);this._addRectRanges(S)};for(const h of e){const{startOffset:g,endOffset:p,rangeType:f,startNodePosition:S,endNodePosition:E}=h;if(f===s.DOC_RANGE_TYPE.RECT){const C=cr(g,p,l,d,u,c,a,r);C&&this._addRectRanges([C])}else if(f===s.DOC_RANGE_TYPE.TEXT)try{let C=null;S&&E?C=Ji(S.isBack?g:g-1,E.isBack?p:p-1,l,d,u,c,a,r,S.isBack,E.isBack):C=Ji(g,p,l,d,u,c,a,r),C&&this._addTextRange(C)}catch{m(g,p)}else m(g,p)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:a,segmentPage:r,style:c,isEditing:n,options:i}),!(!e.length||(i==null?void 0:i.shouldFocus)===!1)&&this._updateInputPosition(i==null?void 0:i.forceFocus)}setCursorManually(e,n){const i=this._findNodeByCoord(e,n,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),a=this._getNodePosition(i);if(a==null){this._removeAllRanges();return}(i==null?void 0:i.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(a.isBack=!0),this._createTextRangeByAnchorPosition(a),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,n,i=!1){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",(this.canFocusing||i)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){const{offsetX:n,offsetY:i}=e,a=this._findNodeByCoord(n,i,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=$i(a.node);if(r==null)return;const{content:c,st:l,nodeIndex:A}=r;if(A===-1||Intl.Segmenter==null)return;const u=new Intl.Segmenter(void 0,{granularity:"word"}).segment(c);let m=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(const{segment:g,index:p,isWordLike:f}of u)if(p<=A&&A<p+g.length&&f){m=p+l,h=p+l+g.length;break}if(Number.isFinite(m)&&Number.isFinite(h)){this.removeAllRanges();const g=[{startOffset:m,endOffset:h}];this.addDocRanges(g,!1,{forceFocus:!0})}}__handleTripleClick(e){const{offsetX:n,offsetY:i}=e,a=this._findNodeByCoord(n,i,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=$i(a.node);if(r==null)return;this.removeAllRanges();const{st:c,ed:l}=r,A=[{startOffset:c,endOffset:l}];this.addDocRanges(A,!1,{forceFocus:!0})}__onPointDown(e){var f,S;const{scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{offsetX:r,offsetY:c}=e,l=this._findNodeByCoord(r,c,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(A==null||l==null){this._removeAllRanges();return}(l==null?void 0:l.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);const d=this._textSelectionInner$.value;if(l&&e.button===2&&d){const E=a.findCharIndexByPosition(A);if(typeof E=="number"&&d.textRanges.some(C=>C.startOffset<=E&&C.endOffset>E)||typeof E=="number"&&d.rectRanges.some(C=>C.startOffset<=E&&C.endOffset>=E))return}const{segmentId:u,segmentPage:m}=l;u&&this._currentSegmentId&&u!==this._currentSegmentId&&this.setSegment(u),u&&m!==this._currentSegmentPage&&this.setSegmentPage(m),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),n.disableObjectsEvent();const h=_.ScrollTimer.create(n);this._scrollTimers.push(h),h.startScroll(r,c),this._onSelectionStart$.next((f=this._getActiveRangeInstance())==null?void 0:f.startNodePosition),(S=n.getTransformer())==null||S.clearSelectedObjects();let g=r,p=c;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(n.onPointerMove$.subscribeEvent(E=>{const{offsetX:C,offsetY:T}=E;n.setCursor(_.CURSOR_TYPE.TEXT),!(Math.sqrt((C-g)**2+(T-p)**2)<3)&&(this._moving(C,T),h.scrolling(C,T,()=>{this._moving(C,T)}),g=C,p=T)})),this._scenePointerUpSubs.push(n.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(C=>{C.unsubscribe()}),this._onPointerEvent=!1,n.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}const C=new We(n,i,a,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(C)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const C of this._rangeListCache)e.ctrlKey?C.collapsed?C.dispose():this._addTextRange(C):this._addTextRange(C);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const E={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(E),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{e==null||e.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r:e,g:n,b:i,a}=_.getSystemHighlightColor(),r={strokeWidth:1,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${n}, ${i}, ${a!=null?a:.3})`};this._setRangeStyle(r)}_getAllTextRanges(){return this._rangeList.map(yo)}_getAllRectRanges(){return this._rectRangeList.map(dr)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const e=this._rangeList.find(a=>a.isActive());if(e==null)return null;const{startOffset:n,endOffset:i}=e;return n==null||i==null?null:yo(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId:e}=this._context,n=document.createElement("div");n.style.position="fixed",n.style.left="0px",n.style.top="0px",n.id=`univer-doc-selection-container-${e}`;const i=document.createElement("div"),a=document.createElement("div");i.appendChild(a),n.appendChild(i),this._container=n,this._inputParent=i,this._input=a,this._initInput(),this._initInputEvents(),document.body.appendChild(n)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.dataset.uComp="editor",this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(e==null)return;const{node:n,ratioX:i,segmentPage:a}=e,c=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(n,a);if(c==null)return;let A=i<.5;return n.glyphType===_.GlyphType.LIST&&(A=!0),{...c,isBack:A}}_interactTextRanges(e){const n=[];for(const i of this._rangeList){if(e.some(a=>a.isIntersection(i))){i.dispose();continue}n.push(i)}this._rangeList=n}_interactRectRanges(e){const n=[];for(const i of this._rectRangeList){if(e.some(a=>a.isIntersection(i))){i.dispose();continue}n.push(i)}this._rectRangeList=n}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){e.length!==0&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();const{scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton(),r=new We(n,i,a,e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(r)}_updateActiveRangePosition(e){const n=this._getActiveRangeInstance();if(n==null||n.anchorNodePosition==null){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=n.anchorNodePosition,this._focusNodePosition=e;const{scene:i,mainComponent:a}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:c,_focusNodePosition:l,_selectionStyle:A,_currentSegmentId:d,_currentSegmentPage:u}=this;if(c==null||l==null||a==null)return;const m=To(c,l,i,a,r,A,d,u);if(m==null)return;const{textRanges:h,rectRanges:g}=m;this._addTextRangesToCache(h),this._addRectRangesToCache(g),this.deactivate()}_isEmpty(){return this._rangeList.length===0&&this._rectRangeList.length===0}_getCanvasOffset(){var n;const e=(n=this._context.scene)==null?void 0:n.getEngine();return Zi(e)}_updateInputPosition(e=!1){const n=this._getActiveRangeInstance(),i=n==null?void 0:n.getAnchor();if(!i||i&&!i.visible||this.activeViewPort==null){this.focus();return}const{left:a,top:r}=i,c=this.activeViewPort.getAbsoluteVector(_.Vector2.FromArray([a,r])),{x:l,y:A}=c;let{left:d,top:u}=this._getCanvasOffset();d+=l,u+=A,this.activate(d,u,e)}_moving(e,n){var E,C;const{_currentSegmentId:i,_currentSegmentPage:a}=this,r=this._findNodeByCoord(e,n,{strict:!0,segmentId:i,segmentPage:a}),c=this._getNodePosition(r);if(c==null||r==null)return;const l=r==null?void 0:r.node.parent,A=l==null?void 0:l.glyphGroup[l.glyphGroup.indexOf(r.node)+1];(r==null?void 0:r.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A==null?void 0:A.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK&&(c.isBack=!0),this._focusNodePosition=c,this._removeAllCacheRanges();const{_anchorNodePosition:d,_selectionStyle:u}=this,{scene:m,mainComponent:h}=this._context,g=this._docSkeletonManagerService.getSkeleton();if(d==null||h==null)return;const p=To(d,c,m,h,g,u,i,a);if(p==null)return;const{textRanges:f,rectRanges:S}=p;this._rangeList.length>0&&f.length>0&&this._interactTextRanges(f),this._rectRangeList.length>0&&S.length>0&&this._interactRectRanges(S),this._addTextRangesToCache(f),this._addRectRangesToCache(S),this.deactivate(),(C=(E=this._context.scene)==null?void 0:E.getEngine())==null||C.setCapture()}__attachScrollEvent(){const e=this.activeViewPort;if(!e)return;const{unitId:n}=this._context;if(this._viewPortObserverMap.has(n))return;const i=e.onScrollAfter$.subscribeEvent(r=>{if(!r.viewport)return;const l=this._getActiveRangeInstance();l==null||l.activeStatic()}),a=e.onScrollEnd$.subscribeEvent(r=>{const c=r.viewport;if(!c)return;const l=c.getBounding(),A=this._getActiveRangeInstance(),d=A==null?void 0:A.getAnchor();if(!(!d||d&&!d.visible)){if(l){const{left:u,top:m,right:h,bottom:g}=l.viewBound;if(d.left<u||d.left>h||d.top<m||d.top>g){A==null||A.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(n,{scrollBefore:i,scrollStop:a})}_initInputEvents(){this.disposeWithMe(L.fromEvent(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"input").subscribe(e=>{if(!(e.inputType==="historyUndo"||e.inputType==="historyRedo")){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}})),this.disposeWithMe(L.fromEvent(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"paste").subscribe(e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"focus").subscribe(e=>{this._eventHandle(e,n=>{this._onFocus$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"blur").subscribe(e=>{this._eventHandle(e,n=>{this._onBlur$.next(n)})}))}_eventHandle(e,n){const i=this._input.textContent||"";this._input.innerHTML="";const a=this._getActiveRange(),r=this._getAllTextRanges();n({event:e,content:i,activeRange:a,rangeList:r})}_getTransformCoordForDocumentOffset(e,n){const i=this._context.mainComponent,{documentTransform:a}=i.getOffsetConfig();if(this.activeViewPort==null||a==null)return;const r=this.activeViewPort.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(r)return a.clone().invert().applyPoint(r)}_findNodeByCoord(e,n,i){const a=this._getTransformCoordForDocumentOffset(e,n);if(a==null)return;const r=this._context.mainComponent,c=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:l=_.PageLayoutType.VERTICAL,pageMarginLeft:A,pageMarginTop:d}=r.getOffsetConfig();return c.findNodeByCoord(a,l,A,d,i)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}},y.DocSelectionRenderService=ur([tn(1,I.ILayoutService),tn(2,s.ILogService),tn(3,s.IUniverInstanceService),tn(4,s.Inject(D.DocSkeletonManagerService))],y.DocSelectionRenderService);const Rt={id:"doc.command.switch-mode",type:s.CommandType.COMMAND,handler:o=>{var E,C,T,R,v;const t=o.get(s.ICommandService),e=o.get(_.IRenderManagerService),n=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=(E=e.getRenderById(r))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),l=(C=e.getRenderById(r))==null?void 0:C.with(y.DocSelectionRenderService);if(c==null||l==null)return!1;const A=l==null?void 0:l.getSegment(),d=l==null?void 0:l.getSegmentPage(),u=a.getSnapshot().documentStyle.documentFlavor,m=n.getDocRanges(),h={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:u===s.DocumentFlavor.TRADITIONAL&&A?[]:m}},g=s.JSONX.getInstance(),p=[];let f;if(u===void 0?f=g.insertOp(["documentStyle","documentFlavor"],s.DocumentFlavor.MODERN):u===s.DocumentFlavor.MODERN?f=g.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.TRADITIONAL):f=g.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.MODERN),f)p.push(f);else return!1;if(u!==s.DocumentFlavor.MODERN){const O=a.getSnapshot(),{drawings:M={},body:b}=O,N=(T=b==null?void 0:b.customBlocks)!=null?T:[];for(const x in M){const U=M[x],F=N.find($=>$.blockId===x);if(F==null)continue;const V=U.docTransform.positionV,{relativeFrom:H,posOffset:Q}=V;if(H===s.ObjectRelativeFromV.PARAGRAPH)continue;const{startIndex:j}=F,X=c.findNodeByCharIndex(j,A,d),k=(R=X==null?void 0:X.parent)==null?void 0:R.parent,W=k==null?void 0:k.parent,G=W==null?void 0:W.lines.find($=>$.paragraphIndex===(k==null?void 0:k.paragraphIndex)&&$.paragraphStart),K=(v=W==null?void 0:W.parent)==null?void 0:v.parent;if(X==null||k==null||G==null||W==null||K==null)continue;let Y=0;H===s.ObjectRelativeFromV.LINE?Y-=k.top:H===s.ObjectRelativeFromV.PAGE&&(Y+=K.marginTop),Y+=G.top;const q={...V,relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:(Q!=null?Q:0)-Y},z=g.replaceOp(["drawings",x,"docTransform","positionV"],V,q);z&&p.push(z)}}return h.params.actions=p.reduce((O,M)=>s.JSONX.compose(O,M),null),!!t.syncExecuteCommand(h.id,h.params)}},bo={id:"doc.command.create-table",type:s.CommandType.COMMAND,handler:async(o,t)=>{var q,z,$,ie,fe;const{rowCount:e,colCount:n}=t,i=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService),r=o.get(s.ICommandService),c=o.get(ve),l=i.getActiveTextRange();if(l==null)return!1;const{segmentId:A,segmentPage:d}=l,u=a.getCurrentUniverDocInstance(),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const h=u.getUnitId(),g=re(o,h),p=g==null?void 0:g.getSkeleton();if(p==null)return!1;const{startOffset:f}=l,E=((q=m.paragraphs)!=null?q:[]).find(He=>He.startIndex>=f),C=p.findNodeByCharIndex(f,A,d);if(C==null)return!1;const T=new s.TextX,R=s.JSONX.getInstance(),v=[],O=f+4,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:M}};f>0&&T.push({t:s.TextXActionType.RETAIN,len:f}),T.push({t:s.TextXActionType.INSERT,body:{dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Nn(s.DataStreamTreeTokenType.PARAGRAPH,E)},len:1});const N=c.getDefaultStyle(),x=c.getStyleCache(),U=Ut(m,f,N,x),{dataStream:F,paragraphs:V,sectionBreaks:H}=Ra(e,n),Q=(fe=(ie=($=(z=C.parent)==null?void 0:z.parent)==null?void 0:$.parent)==null?void 0:ie.parent)==null?void 0:fe.parent;if(Q==null)return!1;const{pageWidth:j,marginLeft:X,marginRight:k}=Q,W=wn(e,n,j-X-k);T.push({t:s.TextXActionType.INSERT,body:{dataStream:F,paragraphs:V,sectionBreaks:H,textRuns:[{...U,st:0,ed:F.length}],tables:[{startIndex:0,endIndex:F.length,tableId:W.tableId}]},len:F.length});const G=Z(u,A);v.push(R.editOp(T.serialize(),G));const K=R.insertOp(["tableSource",W.tableId],W);return v.push(K),b.params.actions=v.reduce((He,Se)=>s.JSONX.compose(He,Se),null),!!r.syncExecuteCommand(b.id,b.params)}},nn={id:"doc.table.delete-rows",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=di(r,u);if(p==null)return!1;const{offset:f,rowIndexes:S,len:E,tableId:C,cursor:T,selectWholeTable:R}=p;if(R)return n.executeCommand(it.id);const v=[],O=[{startOffset:T,endOffset:T,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};f>0&&h.push({t:s.TextXActionType.RETAIN,len:f}),h.push({t:s.TextXActionType.DELETE,len:E});const b=Z(l,c);v.push(g.editOp(h.serialize(),b));for(const x of S.reverse()){const U=g.removeOp(["tableSource",C,"tableRows",x]);v.push(U)}return M.params.actions=v.reduce((x,U)=>s.JSONX.compose(x,U),null),!!n.syncExecuteCommand(M.id,M.params)}},on={id:"doc.table.delete-columns",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=Na(r,u);if(p==null)return!1;const{offsets:f,columnIndexes:S,tableId:E,cursor:C,rowCount:T,selectWholeTable:R}=p;if(R)return n.executeCommand(it.id);const v=[],O=[{startOffset:C,endOffset:C,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};for(const x of f){const{retain:U,delete:F}=x;U>0&&h.push({t:s.TextXActionType.RETAIN,len:U}),h.push({t:s.TextXActionType.DELETE,len:F})}const b=Z(l,c);v.push(g.editOp(h.serialize(),b)),S.reverse();for(let x=0;x<T;x++)for(const U of S){const F=g.removeOp(["tableSource",E,"tableRows",x,"tableCells",U]);v.push(F)}for(const x of S){const U=g.removeOp(["tableSource",E,"tableColumns",x]);v.push(U)}return M.params.actions=v.reduce((x,U)=>s.JSONX.compose(x,U),null),!!n.syncExecuteCommand(M.id,M.params)}},it={id:"doc.table.delete-table",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=Ai(r,u);if(p==null)return!1;const{offset:f,len:S,tableId:E,cursor:C}=p,T=[],R=[{startOffset:C,endOffset:C,collapsed:!0}],v={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:R}};f>0&&h.push({t:s.TextXActionType.RETAIN,len:f}),h.push({t:s.TextXActionType.DELETE,len:S});const O=Z(l,c);T.push(g.editOp(h.serialize(),O));const M=g.removeOp(["tableSource",E]);return T.push(M),v.params.actions=T.reduce((N,x)=>s.JSONX.compose(N,x),null),!!n.syncExecuteCommand(v.id,v.params)}},Oo="doc.command.table-insert-row",Ro="doc.command.table-insert-column",hr="doc.command.table-insert-row-above",gr="doc.command.table-insert-row-bellow",mr="doc.command.table-insert-column-left",pr="doc.command.table-insert-column-right",sn={id:hr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Oo,{position:Ft.ABOVE})},an={id:gr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Oo,{position:Ft.BELLOW})},rn={id:mr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Ro,{position:Pn.LEFT})},cn={id:pr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Ro,{position:Pn.RIGHT})},Mo={id:Oo,type:s.CommandType.COMMAND,handler:async(o,t)=>{const{position:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=At(c,r);if(l==null)return!1;const{segmentId:A}=l,d=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(o,d.getUnitId());if(m==null)return!1;const h=m.getViewModel(),g=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Da(l,e,h);if(S==null)return!1;const{offset:E,colCount:C,tableId:T,insertRowIndex:R}=S,v=[],O=E+2,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};E>0&&p.push({t:s.TextXActionType.RETAIN,len:E});const N=Ma(C);p.push({t:s.TextXActionType.INSERT,body:N,len:N.dataStream.length});const x=Z(d,A);v.push(f.editOp(p.serialize(),x));const U=kt(C),F=f.insertOp(["tableSource",T,"tableRows",R],U);return v.push(F),b.params.actions=v.reduce((H,Q)=>s.JSONX.compose(H,Q),null),!!a.syncExecuteCommand(b.id,b.params)}},es={id:Ro,type:s.CommandType.COMMAND,handler:async(o,t)=>{var K,Y,q;const{position:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=At(c,r);if(l==null)return!1;const{segmentId:A}=l,d=i.getCurrentUniverDocInstance(),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(o,d.getUnitId());if(m==null)return!1;const h=m.getViewModel(),g=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Ba(l,e,h);if(S==null)return!1;const{offsets:E,columnIndex:C,tableId:T,rowCount:R}=S,v=[],O=E[0]+1,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};for(const z of E){p.push({t:s.TextXActionType.RETAIN,len:z});const $=xa();p.push({t:s.TextXActionType.INSERT,body:$,len:$.dataStream.length})}const N=Z(d,A);v.push(f.editOp(p.serialize(),N));for(let z=0;z<R;z++){const $=Ht(),ie=f.insertOp(["tableSource",T,"tableRows",z,"tableCells",C],$);v.push(ie)}const x=d.getSnapshot(),U=x.documentStyle,{marginLeft:F=0,marginRight:V=0}=U,H=((Y=(K=U.pageSize)==null?void 0:K.width)!=null?Y:800)-F-V,Q=(q=x==null?void 0:x.tableSource)==null?void 0:q[T].tableColumns,{newColWidth:j,widths:X}=_a(H,Q,C);for(let z=0;z<X.length;z++){const $=f.replaceOp(["tableSource",T,"tableColumns",z,"size","width","v"],Q[z].size.width.v,X[z]);v.push($)}const k=Vt(j),W=f.insertOp(["tableSource",T,"tableColumns",C],k);return v.push(W),b.params.actions=v.reduce((z,$)=>s.JSONX.compose(z,$),null),!!a.syncExecuteCommand(b.id,b.params)}},xo={id:"doc.table.tab-in-table",type:s.CommandType.COMMAND,handler:async(o,t)=>{var g;const{shift:e}=t,n=o.get(D.DocSelectionManagerService),i=n.getDocRanges(),a=o.get(s.ICommandService),c=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!c)return!1;const l=(g=i.find(p=>p.isActive))!=null?g:i[0],A=c.getUnitId(),d=re(o,A),u=d==null?void 0:d.getSkeleton(),m=u==null?void 0:u.getViewModel().getSelfOrHeaderFooterViewModel(l==null?void 0:l.segmentId);if(m==null||l==null)return!1;let h=null;if(e?h=ui(m,l,Un.PREV):h=ui(m,l,Un.NEXT),h){const{startOffset:p,endOffset:f}=h,S=[{startOffset:p,endOffset:f}];return n.replaceDocRanges(S),!0}return e===!1?await a.executeCommand(Mo.id,{position:Ft.BELLOW}):!0}},ts="COMPONENT_DOC_CREATE_TABLE_CONFIRM",Do="doc.component.create-table-confirm",ln={id:"doc.operation.create-table",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(s.LocaleService),e=o.get(I.IConfirmService),n=o.get(s.ICommandService),i={rowCount:3,colCount:5},a=(r,c)=>{i.rowCount=r,i.colCount=c};return await e.open({id:Do,children:{label:{name:ts,props:{handleRowColChange:a,tableCreateParams:i}}},width:"auto",title:{title:t.t("toolbar.table.insert")},onConfirm:()=>{n.executeCommand(bo.id,i),e.close(Do)},onClose:()=>{e.close(Do)}}),!0}},Oe={id:"doc.operation.move-cursor",type:s.CommandType.OPERATION,handler:(o,t)=>!!t},Re={id:"doc.operation.move-selection",type:s.CommandType.OPERATION,handler:(o,t)=>!!t};function ne({ref:o,...t}){const{icon:e,id:n,className:i,extend:a,...r}=t,c=`univerjs-icon univerjs-icon-${n} ${i||""}`.trim(),l=w.useRef(`_${Ir()}`);return ns(e,`${n}`,{defIds:e.defIds,idSuffix:l.current},{ref:o,className:c,...r},a)}function ns(o,t,e,n,i){return w.createElement(o.tag,{key:t,...fr(o,e,i),...n},(Sr(o,e).children||[]).map((a,r)=>ns(a,`${t}-${o.tag}-${r}`,e,void 0,i)))}function fr(o,t,e){const n={...o.attrs};e!=null&&e.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=e.colorChannel1),o.tag==="mask"&&n.id&&(n.id=n.id+t.idSuffix),Object.entries(n).forEach(([a,r])=>{a==="mask"&&typeof r=="string"&&(n[a]=r.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:i}=t;return!i||i.length===0||(o.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(([a,r])=>{typeof r=="string"&&(n[a]=r.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),n}function Sr(o,t){var n;const{defIds:e}=t;return!e||e.length===0?o:o.tag==="defs"&&((n=o.children)!=null&&n.length)?{...o,children:o.children.map(i=>typeof i.attrs.id=="string"&&e&&e.includes(i.attrs.id)?{...i,attrs:{...i.attrs,id:i.attrs.id+t.idSuffix}}:i)}:o}function Ir(){return Math.random().toString(36).substring(2,8)}ne.displayName="UniverIcon";const vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},os=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"align-text-both-icon",ref:e,icon:vr}))});os.displayName="AlignTextBothIcon";const Er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332C13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267C11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827C1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827C8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007Z"}}]},is=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"catalogue-icon",ref:e,icon:Er}))});is.displayName="CatalogueIcon";const Cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.50095 1.84399C2.73322 1.60765 3.11311 1.60435 3.34945 1.83662L8.00012 6.40726L12.6508 1.83662C12.8871 1.60435 13.267 1.60765 13.4993 1.84399C13.7316 2.08032 13.7283 2.46021 13.4919 2.69248L8.85611 7.24852L10.8941 9.25146C11.1382 9.17563 11.3976 9.13477 11.6667 9.13477C13.1026 9.13477 14.2667 10.2988 14.2667 11.7348C14.2667 13.1707 13.1026 14.3348 11.6667 14.3348C10.2307 14.3348 9.06665 13.1707 9.06665 11.7348C9.06665 11.0143 9.35973 10.3622 9.83319 9.89129L8.00012 8.08978L6.16708 9.89127C6.64055 10.3622 6.93364 11.0142 6.93364 11.7348C6.93364 13.1707 5.76958 14.3348 4.33364 14.3348C2.8977 14.3348 1.73364 13.1707 1.73364 11.7348C1.73364 10.2988 2.8977 9.13477 4.33364 9.13477C4.60263 9.13477 4.86208 9.17562 5.10612 9.25145L7.14413 7.24852L2.50831 2.69248C2.27197 2.46021 2.26868 2.08032 2.50095 1.84399ZM2.93364 11.7348C2.93364 10.9616 3.56044 10.3348 4.33364 10.3348C5.10684 10.3348 5.73364 10.9616 5.73364 11.7348C5.73364 12.508 5.10684 13.1348 4.33364 13.1348C3.56044 13.1348 2.93364 12.508 2.93364 11.7348ZM10.2667 11.7348C10.2667 10.9616 10.8935 10.3348 11.6667 10.3348C12.4398 10.3348 13.0667 10.9616 13.0667 11.7348C13.0667 12.508 12.4398 13.1348 11.6667 13.1348C10.8935 13.1348 10.2667 12.508 10.2667 11.7348Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ss=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"cut-icon",ref:e,icon:Cr}))});ss.displayName="CutIcon";const Tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},as=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"delete-icon",ref:e,icon:Tr}))});as.displayName="DeleteIcon";const yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105C8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105C4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324C10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324C4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188Z"}}]},rs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"doc-setting-icon",ref:e,icon:yr}))});rs.displayName="DocSettingIcon";const br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"}}]},cs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"down-icon",ref:e,icon:br}))});cs.displayName="DownIcon";const Or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689C2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336C2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336C9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689C8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203C13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319C11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333C13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879Z"}}]},ls=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h1-icon",ref:e,icon:Or}))});ls.displayName="H1Icon";const Rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689C12.8465 7.26689 13.4 7.67244 13.4 8.33356C13.4 8.62807 13.2712 8.94814 12.9954 9.32391C12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373C10.3718 12.1759 10.0667 12.7122 10.0667 13.3336C10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336C14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767C11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338C14.3122 9.55787 14.6 8.98906 14.6 8.33356C14.6 6.88362 13.3757 6.06689 12.3333 6.06689C11.291 6.06689 10.0667 6.88361 10.0667 8.33356C10.0667 8.66493 10.3353 8.93356 10.6667 8.93356C10.998 8.93356 11.2667 8.66493 11.2667 8.33356Z"}}]},ds=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h2-icon",ref:e,icon:Rr}))});ds.displayName="H2Icon";const Mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689C10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051C11.2283 10.1364 11.4375 10.2669 11.6667 10.2669C12.2418 10.2669 12.6786 10.4115 12.9585 10.6354C13.2204 10.845 13.4 11.166 13.4 11.6669C13.4 12.1622 13.2254 12.3937 13.0567 12.5202C12.8588 12.6686 12.5829 12.7336 12.3333 12.7336C11.7271 12.7336 11.3432 12.4858 11.1106 12.23C10.8877 11.9848 10.5082 11.9667 10.2631 12.1896C10.0179 12.4125 9.99979 12.792 10.2227 13.0372C10.6568 13.5147 11.3522 13.9336 12.3333 13.9336C12.7504 13.9336 13.3078 13.8319 13.7767 13.4802C14.2746 13.1068 14.6 12.5049 14.6 11.6669C14.6 10.8345 14.2796 10.1555 13.7081 9.69837C13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328C14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667Z"}}]},As=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h3-icon",ref:e,icon:Mr}))});As.displayName="H3Icon";const xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",fillRule:"evenodd",clipRule:"evenodd"}}]},us=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h4-icon",ref:e,icon:xr}))});us.displayName="H4Icon";const Dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492C10.7822 9.94492 10.8899 9.91238 10.9814 9.85599C10.9901 9.85195 11.0027 9.84632 11.0192 9.83936C11.0764 9.81533 11.1692 9.78033 11.2927 9.74447C11.5397 9.67268 11.8996 9.60022 12.3336 9.60022C12.4975 9.60022 12.5978 9.63412 12.6624 9.67167C12.7263 9.70877 12.79 9.76953 12.8503 9.87834C12.983 10.1181 13.0669 10.5337 13.0669 11.1669C13.0669 11.8061 12.9802 12.1936 12.8338 12.414C12.7252 12.5775 12.5275 12.7336 12.0002 12.7336C11.6445 12.7336 11.4936 12.622 11.4192 12.5328C11.3289 12.4245 11.2669 12.2453 11.2669 12.0028C11.2669 11.6714 10.9983 11.4028 10.6669 11.4028C10.3355 11.4028 10.0669 11.6714 10.0669 12.0028C10.0669 12.4244 10.1716 12.9106 10.4979 13.3016C10.8401 13.7118 11.356 13.9336 12.0002 13.9336C12.8063 13.9336 13.4419 13.6673 13.8334 13.0779C14.1869 12.5456 14.2669 11.8497 14.2669 11.1669C14.2669 10.4781 14.1841 9.81027 13.9002 9.29724C13.7521 9.02964 13.545 8.79662 13.2651 8.63403C12.986 8.4719 12.6697 8.40022 12.3336 8.40022C11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332C13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669Z"}}]},hs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h5-icon",ref:e,icon:Dr}))});hs.displayName="H5Icon";const Br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},gs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"horizontally-icon",ref:e,icon:Br}))});gs.displayName="HorizontallyIcon";const _r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ms=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"left-icon",ref:e,icon:_r}))});ms.displayName="LeftIcon";const Nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},ps=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"left-justifying-icon",ref:e,icon:Nr}))});ps.displayName="LeftJustifyingIcon";const Pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},fs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"right-justifying-icon",ref:e,icon:Pr}))});fs.displayName="RightJustifyingIcon";const wr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"}}]},Mt=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"text-type-icon",ref:e,icon:wr}))});Mt.displayName="TextTypeIcon";const Ur={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263C4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837L1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263C0.880874 2.97695 0.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689C6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689C15.0605 2.83552 14.7918 2.56689 14.4605 2.56689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334C6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334C15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999C15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999 0.939453 6.76549 0.939453 7.83324C0.939453 8.90099 1.80504 9.76657 2.87279 9.76657C3.94054 9.76657 4.80612 8.90099 4.80612 7.83324C4.80612 6.76549 3.94054 5.8999 2.87279 5.8999ZM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999C3.2778 7.0999 3.60612 7.42823 3.60612 7.83324C3.60612 8.23824 3.2778 8.56657 2.87279 8.56657C2.46778 8.56657 2.13945 8.23824 2.13945 7.83324Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.939453 12.5002C0.939453 11.4325 1.80504 10.5669 2.87279 10.5669C3.94054 10.5669 4.80612 11.4325 4.80612 12.5002C4.80612 13.568 3.94054 14.4336 2.87279 14.4336C1.80504 14.4336 0.939453 13.568 0.939453 12.5002ZM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002C2.13945 12.9052 2.46778 13.2336 2.87279 13.2336C3.2778 13.2336 3.60612 12.9052 3.60612 12.5002C3.60612 12.0952 3.2778 11.7669 2.87279 11.7669Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ss=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"todo-list-double-icon",ref:e,icon:Ur}))});Ss.displayName="TodoListDoubleIcon";function Is(o){var n;const{dataStream:t}=(n=o.body)!=null?n:{},e=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.COLUMN_BREAK,s.DataStreamTreeTokenType.PAGE_BREAK,s.DataStreamTreeTokenType.TAB,s.DataStreamTreeTokenType.DOCS_END,s.DataStreamTreeTokenType.CUSTOM_BLOCK];if(typeof t=="string")for(let i=0;i<t.length;i++){const a=t[i];if(!e.includes(a))return i}return 0}class vs extends s.Disposable{constructor(e,n,i,a,r,c){super();B(this,"_change$",new L.Subject);B(this,"change$",this._change$.asObservable());B(this,"_input$",new L.Subject);B(this,"input$",this._input$.asObservable());B(this,"_paste$",new L.Subject);B(this,"paste$",this._paste$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_selectionChange$",new L.Subject);B(this,"selectionChange$",this._selectionChange$.asObservable());this._param=e,this._univerInstanceService=n,this._docSelectionManagerService=i,this._commandService=a,this._undoRedoService=r,this._injector=c,this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(y.DocSelectionRenderService)}_listenSelection(){const e=this._param.render.with(y.DocSelectionRenderService);this.disposeWithMe(e.onBlur$.subscribe(n=>{this._blur$.next(n);const i=this.getDocumentData();this._change$.next({target:this,data:i})})),this.disposeWithMe(e.onFocus$.subscribe(n=>{this._focus$.next(n)})),this.disposeWithMe(e.onPaste$.subscribe(n=>{this._paste$.next(n)})),this.disposeWithMe(L.merge(e.onInput$,e.onKeydown$.pipe(lt.filter(n=>{const i=n.event;return i.ctrlKey||i.metaKey?[I.KeyCode.X,I.KeyCode.V].includes(i.keyCode):[I.KeyCode.BACKSPACE].includes(i.keyCode)})),e.onCompositionupdate$,e.onCompositionend$,e.onPaste$).subscribe(n=>{if(n==null)return;const{content:i=""}=n,a=this.getDocumentData();this._input$.next({target:this,content:i,data:a,isComposing:n.event.type==="compositionupdate"})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(n=>{if(n==null)return;const{unitId:i,subUnitId:a,...r}=n,c=this.getEditorId();i===c&&this._selectionChange$.next(r)}))}isFocus(){const e=this._param.render.with(y.DocSelectionRenderService);return e.isFocusing&&!!e.getActiveTextRange()}focus(){const e=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),n=this.getEditorId();(e==null||e.getUnitId()!==n)&&this._univerInstanceService.setCurrentUnitForType(n),this._param.render.with(y.DocSelectionRenderService).focus()}blur(){this._param.render.with(y.DocSelectionRenderService).blur()}select(){const e=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:e.body?e.body.dataStream.length-2:0}])}setSelectionRanges(e,n=!0){const i=this.getEditorId(),a={unitId:i,subUnitId:i};return this._docSelectionManagerService.replaceDocRanges(e,a,!1,{shouldFocus:n})}getSelectionRanges(){const e=this.getEditorId(),n={unitId:e,subUnitId:e};return this._docSelectionManagerService.getDocRanges(n)}getCursorPosition(){var n,i;return(i=(n=this.getSelectionRanges().find(a=>a.collapsed))==null?void 0:n.startOffset)!=null?i:-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(e,n){this._commandService.syncExecuteCommand($n.id,{unitId:this.getEditorId(),snapshot:e,textRanges:n})}replaceText(e,n=!0){const i=this.getDocumentData();this.setDocumentData({...i,body:{dataStream:`${e}\r
`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},typeof n=="object"?n:n?[{startOffset:e.length,endOffset:e.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const e=this.getEditorId();return this._undoRedoService.clearUndoRedo(e)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return this._param.readonly===!0}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}getSkeleton(){var n;return(n=this._injector.get(_.IRenderManagerService).getRenderById(this._getEditorId()))==null?void 0:n.with(D.DocSkeletonManagerService).getSkeleton()}isSheetEditor(){return s.isInternalEditorID(this._getEditorId())}getValue(){var i;return(((i=this._getDocDataModel().getBody())==null?void 0:i.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(e){this._param={...this._param,...e}}updateCanvasStyle(){var i;const e=this._getDocDataModel();if(e==null)return;const n={};(i=this._param.canvasStyle)!=null&&i.fontSize&&(n.textStyle==null&&(n.textStyle={}),n.textStyle.fs=this._param.canvasStyle.fontSize),e.updateDocumentStyle(n)}_getDocDataModel(){const e=this._getEditorId();return this._univerInstanceService.getUnit(e,s.UniverInstanceType.UNIVER_DOC)}_getEditorId(){var e;return((e=this._param.initialSnapshot)==null?void 0:e.id)||this._param.editorUnitId||""}}var Lr=Object.getOwnPropertyDescriptor,Qr=(o,t,e,n)=>{for(var i=n>1?void 0:n?Lr(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Ge=(o,t)=>(e,n)=>t(e,n,o);const Fr=["editor","render-canvas"];y.EditorService=class extends s.Disposable{constructor(e,n,i,a,r,c,l){super();B(this,"_editors",new Map);B(this,"_focusEditorUnitId");B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());this._univerInstanceService=e,this._renderManagerService=n,this._docSelectionManagerService=i,this._contextService=a,this._commandService=r,this._undoRedoService=c,this._injector=l,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe(L.fromEvent(window,"focusin").subscribe(e=>{const n=e.target;this._blurSheetEditor(n)}))}_blurSheetEditor(e){if(Fr.some(i=>e.dataset.uComp===i))return;const n=this.getFocusEditor();n&&n.isSheetEditor()!==!0&&this.blur()}_setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){const n=this._editors.get(e);return!!(n&&n.isSheetEditor())}blur(e){const n=this.getFocusEditor();e&&(n==null||n.setSelectionRanges([])),n==null||n.blur(),this._contextService.setContextValue(s.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!1),this._setFocusId(null),this._blur$.next(null)}focus(e){if(e===this._focusEditorUnitId||(this._focusEditorUnitId&&this.blur(),e==null))return;const n=this.getEditor(e);if(n==null)return;this._univerInstanceService.setCurrentUnitForType(e);const i=n.getValue().length;this._contextService.setContextValue(s.EDITOR_ACTIVATED,!0),s.isInternalEditorID(e)||this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!0),n.focus(),this._setFocusId(e),this._focus$.next({startOffset:i,endOffset:i})}dispose(){this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}register(e,n){var A,d,u,m;const{initialSnapshot:i,canvasStyle:a={}}=e,r=i.id;this._univerInstanceService.getUnit(r,s.UniverInstanceType.UNIVER_DOC)==null&&this._univerInstanceService.createUnit(s.UniverInstanceType.UNIVER_DOC,i||this._getBlank(r),{makeCurrent:!1});let l=this._renderManagerService.getRenderById(r);if(l==null&&(this._renderManagerService.create(r),l=this._renderManagerService.getRenderById(r)),l){l.engine.setContainer(n);const h=new vs({...e,render:l,editorDom:n,canvasStyle:a},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService,this._injector);this._editors.set(r,h),e.scrollBar||(m=(u=(d=(A=l.mainComponent)==null?void 0:A.getScene())==null?void 0:d.getViewports())==null?void 0:u[0].getScrollBar())==null||m.dispose()}return s.toDisposable(()=>{this._unRegister(r)})}_unRegister(e){const n=this._editors.get(e);n!=null&&(this._renderManagerService.removeRender(e),n.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${s.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:s.VerticalAlign.TOP,horizontalAlign:s.HorizontalAlign.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}},y.EditorService=Qr([Ge(0,s.IUniverInstanceService),Ge(1,_.IRenderManagerService),Ge(2,s.Inject(D.DocSelectionManagerService)),Ge(3,s.IContextService),Ge(4,s.ICommandService),Ge(5,s.IUndoRedoService),Ge(6,s.Inject(s.Injector))],y.EditorService);const le=s.createIdentifier("univer.editor.service"),Bo="COMPONENT_DOC_HEADER_FOOTER_PANEL";function Hr(o,t,e){const{useFirstPageHeaderFooter:n,evenAndOddHeaders:i,defaultHeaderId:a,defaultFooterId:r,firstPageHeaderId:c,firstPageFooterId:l,evenPageHeaderId:A,evenPageFooterId:d}=o;return t===_.DocumentEditArea.HEADER?n===s.BooleanNumber.TRUE&&e===0?c:i===s.BooleanNumber.TRUE&&e%2===1?A:a:n===s.BooleanNumber.TRUE&&e===0?l:i===s.BooleanNumber.TRUE&&e%2===1?d:r}const kr=o=>{const t=I.useDependency(s.LocaleService),e=I.useDependency(s.IUniverInstanceService),n=I.useDependency(_.IRenderManagerService),i=I.useDependency(s.ICommandService),a=I.useDependency(I.ILayoutService),{unitId:r}=o,c=n.getRenderById(r).with(y.DocSelectionRenderService),[l,A]=w.useState({}),d=(h,g)=>{var O;A(M=>({...M,[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}));const p=e.getUniverDocInstance(r),f=p==null?void 0:p.getSnapshot().documentStyle,S=(O=n.getRenderById(r))==null?void 0:O.with(D.DocSkeletonManagerService),E=S==null?void 0:S.getViewModel();if(f==null||E==null)return;const C=E.getEditArea();let T=!1;const R=c.getSegmentPage();let v=!1;if(g==="useFirstPageHeaderFooter"&&h===!0&&((C===_.DocumentEditArea.HEADER&&!f.firstPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.firstPageFooterId)&&(T=!0),T&&R===0&&(v=!0)),g==="evenAndOddHeaders"&&h===!0&&((C===_.DocumentEditArea.HEADER&&!f.evenPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.evenPageFooterId)&&(T=!0),T&&R%2===1&&(v=!0)),T){const b=s.generateRandomId(6);v&&c.setSegment(b),i.executeCommand(An,{unitId:r,segmentId:b,headerFooterProps:{[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}else{const M=c.getSegmentPage(),b=c.getSegment(),N=Hr({...f,[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE},C,M);N&&N!==b&&c.setSegment(N),i.executeCommand(An,{unitId:r,headerFooterProps:{[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}a.focus()},u=async(h,g)=>{A(p=>({...p,[g]:h})),await i.executeCommand(An,{unitId:r,headerFooterProps:{[g]:h}}),c.removeAllRanges(),c.blur()},m=()=>{i.executeCommand(Lo.id,{unitId:r})};return w.useEffect(()=>{const h=e.getUniverDocInstance(r),g=h==null?void 0:h.getSnapshot().documentStyle;if(g){const{marginHeader:p=0,marginFooter:f=0,useFirstPageHeaderFooter:S=s.BooleanNumber.FALSE,evenAndOddHeaders:E=s.BooleanNumber.FALSE}=g;A({marginHeader:p,marginFooter:f,useFirstPageHeaderFooter:S,evenAndOddHeaders:E})}},[r]),P.jsxs("div",{className:"univer-grid univer-gap-4",children:[P.jsxs("div",{className:"univer-grid univer-gap-2",children:[P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.useFirstPageHeaderFooter===s.BooleanNumber.TRUE,onChange:h=>{d(h,"useFirstPageHeaderFooter")},children:t.t("headerFooter.firstPageCheckBox")})}),P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.evenAndOddHeaders===s.BooleanNumber.TRUE,onChange:h=>{d(h,"evenAndOddHeaders")},children:t.t("headerFooter.oddEvenCheckBox")})})]}),P.jsxs("div",{className:"univer-mb-1 univer-flex",children:[P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginHeader,onChange:h=>{u(h,"marginHeader")}})]}),P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginFooter,onChange:h=>{u(h,"marginFooter")}})]})]}),P.jsx("div",{className:"univer-flex univer-justify-end",children:P.jsx(J.Button,{onClick:m,children:t.t("headerFooter.closeHeaderFooter")})})]})},Vr=()=>{var A;const o=I.useDependency(s.LocaleService),t=I.useDependency(_.IRenderManagerService),i=I.useDependency(s.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),r=((A=t.getRenderById(i))==null?void 0:A.with(D.DocSkeletonManagerService)).getViewModel(),[c,l]=w.useState(!0);return w.useEffect(()=>{const d=r.getEditArea();l(d!==_.DocumentEditArea.BODY);const u=r.editAreaChange$.subscribe(m=>{m!=null&&l(m!==_.DocumentEditArea.BODY)});return()=>{u.unsubscribe()}},[]),P.jsx("div",{className:"univer-text-sm",children:c?P.jsx(kr,{unitId:i}):P.jsx("div",{className:"univer-text-gray-400",children:o.t("headerFooter.disableText")})})},Es=18,Cs=200,_o=6,Wr=4;function Gr(o,t){let{radius:e,width:n,height:i}=t;e=e!=null?e:0,n=n!=null?n:30,i=i!=null?i:30;let a=0;a=Math.min(e,n/2,i/2),o.beginPath(),o.moveTo(0,0),o.lineTo(n,0),o.lineTo(n,i-a),o.arc(n-a,i-a,a,0,Math.PI/2,!1),o.lineTo(0,i),o.lineTo(0,0),o.closePath(),t.fill&&(o.save(),o.fillStyle=t.fill,t.fillRule==="evenodd"?o.fill("evenodd"):o.fill(),o.restore())}class dn extends _.Shape{constructor(e,n){super(e,n);B(this,"color");B(this,"text");this.color=n==null?void 0:n.color,this.text=n==null?void 0:n.text}static drawWith(e,n){const{text:i,color:a}=n;e.save(),e.font="13px Source Han Sans CN";const r=e.measureText(i).width,c=Math.min(r+2*_o,Cs);Gr(e,{height:Es,width:c,radius:4,fill:a}),e.fillStyle="rgba(58, 96, 247, 1)";const l=_o,A=Es-Wr,d=Cs-2*_o;if(r>d){let u="",m=0;for(const h of i){const g=e.measureText(h).width;if(m+g<=d-e.measureText("...").width)u+=h,m+=g;else{u+="...";break}}e.fillText(u,l,A)}else e.fillText(i,l,A);e.restore()}_draw(e){dn.drawWith(e,this)}}var Xr=Object.getOwnPropertyDescriptor,jr=(o,t,e,n)=>{for(var i=n>1?void 0:n?Xr(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Le=(o,t)=>(e,n)=>t(e,n,o);const Ts="rgba(58, 96, 247, 1)",ys="rgba(58, 96, 247, 0.08)";var se=(o=>(o[o.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",o[o.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",o[o.DEFAULT_HEADER=2]="DEFAULT_HEADER",o[o.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",o[o.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",o[o.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",o))(se||{});function Kr(o,t,e){const{documentStyle:n}=o.getDataModel().getSnapshot(),{defaultHeaderId:i,defaultFooterId:a,evenPageHeaderId:r,evenPageFooterId:c,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:u}=n;switch(t){case _.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case _.DocumentEditArea.HEADER:return u===s.BooleanNumber.TRUE&&!l?{createType:0,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!r?{createType:4,headerFooterId:null}:i?{createType:null,headerFooterId:i}:{createType:2,headerFooterId:null};case _.DocumentEditArea.FOOTER:return u===s.BooleanNumber.TRUE&&!A?{createType:1,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!c?{createType:5,headerFooterId:null}:a?{createType:null,headerFooterId:a}:{createType:3,headerFooterId:null};default:throw new Error(`Invalid editArea: ${t}`)}}let No=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=i,this._renderManagerService=a,this._docSkeletonManagerService=r,this._docSelectionRenderService=c,this._localeService=l,this._componentManager=A,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}dispose(){super.dispose()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(D.RichTextEditingMutation.id===t.id){const e=this._context.unit,i=this._docSkeletonManagerService.getViewModel().getEditArea(),a=e.getSnapshot().documentStyle.documentFlavor;i!==_.DocumentEditArea.BODY&&a===s.DocumentFlavor.MODERN&&this._commandService.executeCommand(Lo.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){this._componentManager.get(Bo)||this.disposeWithMe(this._componentManager.register(Bo,Vr))}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_initialMain(t){const e=Ie(this._context),{document:n}=e;this.disposeWithMe(n.onDblclick$.subscribeEvent(async i=>{if(this._isEditorReadOnly(t)||!this._isTraditionalMode())return;const{offsetX:a,offsetY:r}=i,{pageLayoutType:c=_.PageLayoutType.VERTICAL,pageMarginLeft:l,pageMarginTop:A}=n.getOffsetConfig(),d=this._getTransformCoordForDocumentOffset(a,r);if(d==null)return;const u=this._docSkeletonManagerService.getViewModel(),m=this._docSkeletonManagerService.getSkeleton(),h=u.getEditArea(),{editArea:g,pageNumber:p}=m.findEditAreaByCoord(d,c,l,A);if(h===g)return;u.setEditArea(g);const{createType:f,headerFooterId:S}=Kr(u,g,p);if(g===_.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(a,r);else if(f!=null){const C=s.generateRandomId(6);this._docSelectionRenderService.setSegment(C),this._docSelectionRenderService.setSegmentPage(p),await this._commandService.executeCommand(Os.id,{unitId:t,createType:f,segmentId:C})}else S!=null&&(this._docSelectionRenderService.setSegment(S),this._docSelectionRenderService.setSegmentPage(p),this._docSelectionRenderService.setCursorManually(a,r))}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:i,scene:a}=n,{documentTransform:r}=i.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_drawHeaderFooterLabel(){const t=this._localeService;this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).subscribe(e=>{if(e==null)return;const n=e.getUnitId(),i=this._renderManagerService.getRenderById(n);if(this._editorService.isEditor(n)||this._instanceSrv.getUniverDocInstance(n)==null||i==null)return;const{mainComponent:a}=i,r=a;this.disposeWithMe(s.toDisposable(r.pageRender$.subscribe(c=>{if(this._editorService.isEditor(n)||!this._isTraditionalMode())return;const d=this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY,{page:u,pageLeft:m,pageTop:h,ctx:g}=c,{pageWidth:p,pageHeight:f,marginTop:S,marginBottom:E}=u;if(g.save(),g.translate(m-.5,h-.5),d?(_.Rect.drawWith(g,{left:0,top:0,width:p,height:S,fill:"rgba(255, 255, 255, 0.5)"}),g.save(),g.translate(0,f-E),_.Rect.drawWith(g,{left:0,top:0,width:p,height:E,fill:"rgba(255, 255, 255, 0.5)"}),g.restore()):(g.save(),g.translate(0,S),_.Rect.drawWith(g,{left:0,top:S,width:p,height:f-S-E,fill:"rgba(255, 255, 255, 0.5)"}),g.restore()),!d){const C={dataArray:[{command:"M",points:[0,S]},{command:"L",points:[p,S]}],strokeWidth:1,stroke:Ts},T={dataArray:[{command:"M",points:[0,f-E]},{command:"L",points:[p,f-E]}],strokeWidth:1,stroke:Ts};_.Path.drawWith(g,C),_.Path.drawWith(g,T),g.translate(0,S+1),dn.drawWith(g,{text:t.t("headerFooter.header"),color:ys}),g.translate(0,f-S-E),dn.drawWith(g,{text:t.t("headerFooter.footer"),color:ys})}g.restore()})))}))}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===s.DocumentFlavor.TRADITIONAL}};No=jr([Le(1,s.ICommandService),Le(2,le),Le(3,s.IUniverInstanceService),Le(4,_.IRenderManagerService),Le(5,s.Inject(D.DocSkeletonManagerService)),Le(6,s.Inject(y.DocSelectionRenderService)),Le(7,s.Inject(s.LocaleService)),Le(8,s.Inject(I.ComponentManager))],No);const Po={id:"sidebar.operation.doc-header-footer-panel",type:s.CommandType.OPERATION,handler:async(o,t)=>{const e=o.get(I.ISidebarService),n=o.get(s.LocaleService);switch(t.value){case"open":e.open({header:{title:n.t("headerFooter.panel")},children:{label:Bo},onClose:()=>{},width:400});break;case"close":default:e.close();break}return!0}};function bs(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function wo(o,t,e,n){const i=s.JSONX.getInstance(),a=6,r=o!=null?o:s.generateRandomId(a),c=t===se.DEFAULT_HEADER||t===se.FIRST_PAGE_HEADER||t===se.EVEN_PAGE_HEADER,l=i.insertOp([c?"headers":"footers",r],{[c?"headerId":"footerId"]:r,body:bs()});n.push(l);const A=s.generateRandomId(a),d=i.insertOp([c?"footers":"headers",A],{[c?"footerId":"headerId"]:A,body:bs()});n.push(d);let u="defaultHeaderId",m="defaultFooterId";switch(t){case se.DEFAULT_HEADER:u="defaultHeaderId",m="defaultFooterId";break;case se.DEFAULT_FOOTER:u="defaultFooterId",m="defaultHeaderId";break;case se.FIRST_PAGE_HEADER:u="firstPageHeaderId",m="firstPageFooterId";break;case se.FIRST_PAGE_FOOTER:u="firstPageFooterId",m="firstPageHeaderId";break;case se.EVEN_PAGE_HEADER:u="evenPageHeaderId",m="evenPageFooterId";break;case se.EVEN_PAGE_FOOTER:u="evenPageFooterId",m="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${t}`)}for(const[h,g]of[[u,r],[m,A]])if(e[h]!=null){const p=i.replaceOp(["documentStyle",h],e[h],g);n.push(p)}else{const p=i.insertOp(["documentStyle",h],g);n.push(p)}return n}const An="doc.command.core-header-footer",Os={id:An,type:s.CommandType.COMMAND,handler:async(o,t)=>{var T;const e=o.get(s.ICommandService),n=o.get(s.IUniverInstanceService),i=o.get(_.IRenderManagerService),{unitId:a,segmentId:r,createType:c,headerFooterProps:l}=t,A=(T=i.getRenderById(a))==null?void 0:T.with(D.DocSkeletonManagerService),d=n.getUniverDocInstance(a),u=A==null?void 0:A.getViewModel();if(d==null||u==null)return!1;const m=u.getEditArea(),{documentStyle:h}=d.getSnapshot(),g=(l==null?void 0:l.marginFooter)!=null||(l==null?void 0:l.marginHeader)!=null,p=[{startOffset:0,endOffset:0,collapsed:!0}],f={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:p,debounce:!0}};g&&(f.params.noNeedSetTextRange=!0);const S=s.JSONX.getInstance(),E=[];return c!=null&&wo(r,c,h,E),l!=null&&Object.keys(l).forEach(R=>{const v=l[R],O=h[R];if(v===O)return;let M;if(O===void 0?M=S.insertOp(["documentStyle",R],v):M=S.replaceOp(["documentStyle",R],O,v),E.push(M),R==="useFirstPageHeaderFooter"&&v===s.BooleanNumber.TRUE&&!h.firstPageHeaderId){const b=m===_.DocumentEditArea.HEADER?se.FIRST_PAGE_HEADER:se.FIRST_PAGE_FOOTER;wo(r,b,h,E)}else if(R==="evenAndOddHeaders"&&v===s.BooleanNumber.TRUE&&!h.evenPageHeaderId){const b=m===_.DocumentEditArea.HEADER?se.EVEN_PAGE_HEADER:se.EVEN_PAGE_FOOTER;wo(r,b,h,E)}}),E.length===0?!1:(f.params.actions=E.reduce((R,v)=>s.JSONX.compose(R,v),null),!!e.syncExecuteCommand(f.id,f.params))}},Uo={id:"doc.command.open-header-footer-panel",type:s.CommandType.COMMAND,handler:async(o,t)=>o.get(s.ICommandService).executeCommand(Po.id,{value:"open"})},Lo={id:"doc.command.close-header-footer",type:s.CommandType.COMMAND,handler:async(o,t)=>{var g;const e=o.get(s.ICommandService),n=o.get(_.IRenderManagerService),i=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService),{unitId:r}=t,c=n.getRenderById(r);if(c==null)return!1;const{scene:l}=c,A=l.getTransformerByCreate(),d=c.with(D.DocSkeletonManagerService),u=c.with(y.DocSelectionRenderService),m=d==null?void 0:d.getSkeleton(),h=d==null?void 0:d.getViewModel();return h==null||m==null?!1:(i.replaceDocRanges([]),A.clearSelectedObjects(),u.setSegment(""),u.setSegmentPage(-1),h.setEditArea(_.DocumentEditArea.BODY),m.calculate(),(g=c.mainComponent)==null||g.makeDirty(!0),queueMicrotask(()=>{const p=a.getUnit(r),f=p==null?void 0:p.getSnapshot();if(f==null)return;const S=Is(f);i.replaceDocRanges([{startOffset:S,endOffset:S}])}),e.executeCommand(Po.id,{value:"close"}),!0)}},Rs="UI_PLUGIN_DOCS",Ms=o=>{const{value:t,onChange:e,options:n}=o;return P.jsx("div",{className:"univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5",children:n.map(i=>P.jsx("a",{className:J.clsx("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500",J.borderClassName,{"univer-border-primary-500":t===i.value}),onClick:()=>{e(i.value)},children:P.jsx("img",{className:"univer-size-full",src:i.img,draggable:!1})},i.value))})},zr=[{value:s.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],Yr=o=>P.jsx(Ms,{...o,options:zr}),qr=[{value:s.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],Jr=o=>P.jsx(Ms,{...o,options:qr}),xs=`${Rs}_ORDER_LIST_TYPE_COMPONENT`,Ds=`${Rs}_BULLET_LIST_TYPE_COMPONENT`,Zr=o=>{const e=Object.keys(s.PAGE_SIZE).find(n=>{const{width:i,height:a}=s.PAGE_SIZE[n];return o.width===i&&o.height===a});return e!=null?e:"A4"};function $r(o){const{hooks:t}=o,i=I.useDependency(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC).getDocumentStyle(),a=I.useDependency(s.LocaleService),[r,c]=w.useState(()=>{var d,u,m,h,g;return{paperSize:Zr(i.pageSize),orientation:(d=i.pageOrient)!=null?d:s.PageOrientType.PORTRAIT,margins:{top:(u=i.marginTop)!=null?u:0,bottom:(m=i.marginBottom)!=null?m:0,left:(h=i.marginLeft)!=null?h:0,right:(g=i.marginRight)!=null?g:0}}});w.useEffect(()=>{t.beforeClose=()=>r,t.beforeConfirm=()=>r},[r]);const l=d=>{c(u=>({...u,paperSize:d}))},A=(d,u)=>{c(m=>({...m,margins:{...m.margins,[d]:u||0}}))};return P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-4",children:[P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:a.t("page-settings.paper-size")}),P.jsx(J.Select,{value:r.paperSize,onChange:l,options:s.PAPER_TYPES.map(d=>({label:a.t(`page-settings.page-size.${d.toLocaleLowerCase()}`),value:d}))})]}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:a.t("page-settings.custom-paper-size")}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.top")}),P.jsx(J.InputNumber,{value:r.margins.top,onChange:d=>A("top",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.bottom")}),P.jsx(J.InputNumber,{value:r.margins.bottom,onChange:d=>A("bottom",d)})]})]}),P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.left")}),P.jsx(J.InputNumber,{value:r.margins.left,onChange:d=>A("left",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.right")}),P.jsx(J.InputNumber,{value:r.margins.right,onChange:d=>A("right",d)})]})]})]})]})]})}const Qo="docs.component.page-setting",Bs={id:"docs.command.page-setup",type:s.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=e.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!i)return!1;const{marginLeft:a,marginRight:r,marginBottom:c,marginTop:l,pageOrient:A,pageSize:d}=t,u=s.JSONX.getInstance(),m=i.getDocumentStyle(),{marginBottom:h,marginLeft:g,marginRight:p,marginTop:f,pageOrient:S,pageSize:E}=m,C=[];if(h===void 0){const v=u.insertOp(["documentStyle","marginBottom"],c);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginBottom"],h,c);v&&C.push(v)}if(g===void 0){const v=u.insertOp(["documentStyle","marginLeft"],a);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginLeft"],g,a);v&&C.push(v)}if(p===void 0){const v=u.insertOp(["documentStyle","marginRight"],r);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginRight"],p,r);v&&C.push(v)}if(f===void 0){const v=u.insertOp(["documentStyle","marginTop"],l);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginTop"],f,l);v&&C.push(v)}if(E===void 0){const v=u.insertOp(["documentStyle","pageSize"],d);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageSize"],E,d);v&&C.push(v)}if(S===void 0){const v=u.insertOp(["documentStyle","pageOrient"],A);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageOrient"],S,A);v&&C.push(v)}const T={id:D.RichTextEditingMutation.id,params:{unitId:i.getUnitId(),actions:[],textRanges:void 0}};return T.params.actions=C.reduce((v,O)=>s.JSONX.compose(v,O),null),!!n.syncExecuteCommand(T.id,T.params)}},Fo={id:"docs.operation.open-page-setting",type:s.CommandType.OPERATION,handler:o=>{const t=o.get(I.IConfirmService),e=o.get(s.ICommandService),n=o.get(s.LocaleService),i=t.open({id:Qo,title:{label:n.t("page-settings.document-setting")},children:{label:Qo},width:528,onClose:()=>{i.dispose()},onConfirm:a=>{if(i.dispose(),!a)return;const r=s.PAGE_SIZE[a.paperSize];e.executeCommand(Bs.id,{pageOrient:a.orientation,marginTop:a.margins.top,marginBottom:a.margins.bottom,marginLeft:a.margins.left,marginRight:a.margins.right,pageSize:r})},confirmText:n.t("page-settings.confirm"),cancelText:n.t("page-settings.cancel")});return!0}};function ec(o){const t=o.get(s.IUniverInstanceService),e=o.get(_.IRenderManagerService);return new L.Observable(n=>{const i=t.focused$.subscribe(a=>{if(a==null||t.getUnitType(a)!==s.UniverInstanceType.UNIVER_DOC)return n.next(!0);const c=e.getRenderById(a);if(c==null)return n.next(!0);c.with(D.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(A=>{n.next(A===_.DocumentEditArea.HEADER||A===_.DocumentEditArea.FOOTER)})});return()=>i.unsubscribe()})}function tc(o){const t=o.get(s.IUniverInstanceService),e=o.get(s.ICommandService);return new L.Observable(n=>{const i=e.onCommandExecuted(l=>{if(l.id===D.RichTextEditingMutation.id){const{unitId:A}=l.params,d=t.getUnit(A);if(d==null){n.next(!0);return}const{documentStyle:u}=d.getSnapshot();n.next((u==null?void 0:u.documentFlavor)!==s.DocumentFlavor.TRADITIONAL)}}),a=t.focused$.subscribe(l=>{if(l==null)return n.next(!0);const A=t.getUniverDocInstance(l),d=A==null?void 0:A.getSnapshot().documentStyle.documentFlavor;n.next(d!==s.DocumentFlavor.TRADITIONAL)}),r=t.getCurrentUniverDocInstance();if(r==null)return n.next(!0);const c=r==null?void 0:r.getSnapshot().documentStyle.documentFlavor;return n.next(c!==s.DocumentFlavor.TRADITIONAL),()=>{i.dispose(),a.unsubscribe()}})}function nc(o){const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService);return new L.Observable(n=>{const i=t.textSelection$.subscribe(a=>{if(a==null){n.next(!0);return}const{textRanges:r}=a;if(r.length!==1){n.next(!0);return}const c=r[0],{collapsed:l,startNodePosition:A,startOffset:d}=c;if(!l||d==null){n.next(!0);return}const u=e.getCurrentUniverDocInstance();if(u==null){n.next(!0);return}const m=re(o,u.getUnitId());if(m==null){n.next(!0);return}if(m.getViewModel().getCustomRangeRaw(d)){n.next(!0);return}if(A!=null){const{path:p}=A;if(p.indexOf("cells")!==-1){n.next(!0);return}}n.next(!1)});return()=>i.unsubscribe()})}function te(o){const t=o.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(i=>{if(i==null){e.next(!0);return}const{textRanges:a,rectRanges:r}=i;if(a.length===0&&r.length===0){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function oc(o){const t=o.get(s.ICommandService);return{id:Be.id,type:I.MenuItemType.BUTTON,icon:"BoldIcon",title:"Set bold",tooltip:"toolbar.bold",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.bl;e.next(r===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ic(o){const t=o.get(s.ICommandService);return{id:_e.id,type:I.MenuItemType.BUTTON,icon:"ItalicIcon",title:"Set italic",tooltip:"toolbar.italic",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.it;e.next(r===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function sc(o){const t=o.get(s.ICommandService);return{id:Ne.id,type:I.MenuItemType.BUTTON,icon:"UnderlineIcon",title:"Set underline",tooltip:"toolbar.underline",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.ul;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ac(o){const t=o.get(s.ICommandService);return{id:Pe.id,type:I.MenuItemType.BUTTON,icon:"StrikethroughIcon",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.st;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function rc(o){const t=o.get(s.ICommandService);return{id:Ee.id,type:I.MenuItemType.BUTTON,icon:"SubscriptIcon",tooltip:"toolbar.subscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUBSCRIPT)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function cc(o){const t=o.get(s.ICommandService);return{id:we.id,type:I.MenuItemType.BUTTON,icon:"SuperscriptIcon",tooltip:"toolbar.superscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUPERSCRIPT)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function lc(o){const t=o.get(s.ICommandService);return{id:Ue.id,tooltip:"toolbar.font",type:I.MenuItemType.SELECTOR,label:I.FONT_FAMILY_COMPONENT,selections:[{label:{name:I.FONT_FAMILY_ITEM_COMPONENT,hoverable:!1,selectable:!1,props:{id:Ue.id}}}],value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.ff,i=()=>{var l;const r=me(o);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.ff;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===Ue.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function dc(o){const t=o.get(s.ICommandService);return{id:he.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:I.FONT_SIZE_COMPONENT,props:{min:1,max:400}},selections:I.FONT_SIZE_LIST,value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.fs,i=()=>{var l;const r=me(o);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.fs;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function Ac(o){const t=o.get(s.ICommandService);return{id:ce.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.heading.tooltip",label:{name:I.COMMON_LABEL_COMPONENT,props:{selections:I.HEADING_LIST}},selections:I.HEADING_LIST.map(e=>({label:{name:I.HEADING_ITEM_COMPONENT,props:{value:e.value,text:e.label}},value:e.value})),value$:new L.Observable(e=>{const n=s.NamedStyleType.NORMAL_TEXT,i=()=>{var l,A;const r=Xe(o);if(r==null){e.next(n);return}const c=(A=(l=r.paragraphStyle)==null?void 0:l.namedStyleType)!=null?A:n;e.next(c)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function uc(o){const t=o.get(s.ICommandService),e=o.get(s.ThemeService);return{id:Ce.id,icon:"FontColorDoubleIcon",tooltip:"toolbar.textColor.main",type:I.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new L.Observable(n=>{const i=s.DEFAULT_STYLES.cl.rgb,a=()=>{var A,d;const c=me(o);if(!c){n.next(i);return}const l=(d=(A=c.ts)==null?void 0:A.cl)==null?void 0:d.rgb;n.next(l!=null?l:i)},r=t.onCommandExecuted(c=>{c.id===Ce.id&&a()});return a(),r.dispose})}],value$:new L.Observable(n=>{const i=e.getColorFromTheme("gray.900"),a=t.onCommandExecuted(r=>{if(r.id===Ce.id){const c=r.params.value;n.next(c!=null?c:i)}});return n.next(i),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function hc(o){return{id:Uo.id,type:I.MenuItemType.BUTTON,icon:"HeaderFooterIcon",tooltip:"toolbar.headerFooter",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),tc(o),(t,e)=>t||e)}}const gc="GridIcon",_s="doc.menu.table";function mc(o){return{id:_s,type:I.MenuItemType.SUBITEMS,icon:gc,tooltip:"toolbar.table.main",disabled$:nc(o),hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),ec(o),(t,e)=>t||e)}}function pc(o){return{id:ln.id,title:"toolbar.table.insert",type:I.MenuItemType.BUTTON,hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function fc(o){const t=o.get(s.ICommandService);return{id:Et.id,type:I.MenuItemType.BUTTON,icon:"LeftJustifyingIcon",tooltip:"toolbar.alignLeft",disabled$:te(o),activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.LEFT)}});return e.next(!1),n.dispose}),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Sc(o){const t=o.get(s.ICommandService);return{id:Ct.id,type:I.MenuItemType.BUTTON,icon:"HorizontallyIcon",tooltip:"toolbar.alignCenter",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.CENTER)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Ic(o){const t=o.get(s.ICommandService);return{id:Tt.id,type:I.MenuItemType.BUTTON,icon:"RightJustifyingIcon",tooltip:"toolbar.alignRight",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.RIGHT)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function vc(o){const t=o.get(s.ICommandService);return{id:yt.id,type:I.MenuItemType.BUTTON,icon:"AlignTextBothIcon",tooltip:"toolbar.alignJustify",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.JUSTIFIED)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Ec(o){return{id:pt.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",tooltip:"toolbar.horizontalLine",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}const xt=o=>new L.Observable(t=>{const e=o.get(s.IUniverInstanceService),n=o.get(D.DocSelectionManagerService);let i;const a=e.focused$.subscribe(r=>{if(i==null||i.unsubscribe(),r==null)return;const c=e.getUniverDocInstance(r);c!=null&&(i=n.textSelection$.subscribe(()=>{var d,u,m,h,g;const l=n.getDocRanges(),A=(d=l.find(p=>p.isActive))!=null?d:l[0];if(A){const p=c.getSelfOrHeaderFooterModel(A==null?void 0:A.segmentId),f=s.BuildTextUtils.range.getParagraphsInRange(A,(m=(u=p.getBody())==null?void 0:u.paragraphs)!=null?m:[],(g=(h=p.getBody())==null?void 0:h.dataStream)!=null?g:"");let S;if(f.every(E=>{var C;return S||(S=(C=E.bullet)==null?void 0:C.listType),E.bullet&&E.bullet.listType===S})){t.next(S);return}}t.next(void 0)}))});return()=>{a.unsubscribe(),i==null||i.unsubscribe()}});function Ns(o){return{id:tt.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:xs,hoverable:!1,selectable:!1},value$:xt(o)}],icon:"OrderIcon",tooltip:"toolbar.order",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),disabled$:te(o),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("ORDER_LIST")===0)))}}function Ps(o){return{id:et.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:Ds,hoverable:!1,selectable:!1},value$:xt(o)}],icon:"UnorderIcon",tooltip:"toolbar.unorder",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("BULLET_LIST")===0)))}}function ws(o){return{id:vt.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",tooltip:"toolbar.checklist",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("CHECK_LIST")===0)))}}function Cc(o){const t=o.get(s.ICommandService),e=o.get(s.IUniverInstanceService);return{id:Rt.id,type:I.MenuItemType.BUTTON,icon:"KeyboardIcon",tooltip:"toolbar.documentFlavor",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),activated$:new L.Observable(n=>{var r;const i=t.onCommandExecuted(c=>{var l;if(c.id===D.RichTextEditingMutation.id){const A=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n.next(((l=A==null?void 0:A.getSnapshot())==null?void 0:l.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN)}}),a=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);return n.next(((r=a==null?void 0:a.getSnapshot())==null?void 0:r.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN),()=>i.dispose()})}}function Tc(o){return{id:Ze.id,type:I.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon"}}function yc(o){const t=o.get(s.ICommandService),e=o.get(s.ThemeService);return{id:Te.id,tooltip:"toolbar.fillColor.main",type:I.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucketDoubleIcon",selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new L.Observable(n=>{const i=s.DEFAULT_STYLES.bg.rgb,a=()=>{var A,d;const c=me(o);if(!c){n.next(i);return}const l=(d=(A=c.ts)==null?void 0:A.bg)==null?void 0:d.rgb;n.next(l!=null?l:i)},r=t.onCommandExecuted(c=>{c.id===Te.id&&a()});return a(),r.dispose})}],value$:new L.Observable(n=>{const i=e.getColorFromTheme("primary.600"),a=t.onCommandExecuted(r=>{if(r.id===Te.id){const c=r.params.value;n.next(c!=null?c:i)}});return n.next(i),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function me(o){var g,p,f,S;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=o.get(ve),i=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),a=e.getDocRanges(),r=(g=a.find(E=>E.isActive))!=null?g:a[0],c=n.getDefaultStyle(),l=(p=n.getStyleCache())!=null?p:{},A=Xe(o),d=(f=A==null?void 0:A.paragraphStyle)!=null&&f.namedStyleType?s.NAMED_STYLE_MAP[(S=A==null?void 0:A.paragraphStyle)==null?void 0:S.namedStyleType]:null;if(i==null||r==null)return{ts:{...c,...d,...l}};const{segmentId:u}=r,m=i.getSelfOrHeaderFooterModel(u).getBody();if(m==null)return{ts:{...c,...d,...l}};const h=Fi(m,r,{});return s.Tools.deleteNull(h),{ts:{...c,...d,...h,...l}}}function Xe(o){var d,u;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUniverDocInstance(),i=e.getDocRanges(),a=(d=i.find(m=>m.isActive))!=null?d:i[0];if(n==null||a==null)return;const{startOffset:r,segmentId:c}=a,l=(u=n.getSelfOrHeaderFooterModel(c).getBody())==null?void 0:u.paragraphs;if(l==null)return;let A=-1;for(const m of l){const{startIndex:h}=m;if(r>A&&r<=h)return m;A=h}return null}function bc(o){return{id:Fo.id,type:I.MenuItemType.BUTTON,icon:"DocumentSettingIcon",tooltip:"toolbar.pageSetup",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const Oc={[s.NamedStyleType.HEADING_1]:co,[s.NamedStyleType.HEADING_2]:lo,[s.NamedStyleType.HEADING_3]:Ao,[s.NamedStyleType.HEADING_4]:uo,[s.NamedStyleType.HEADING_5]:ho,[s.NamedStyleType.NORMAL_TEXT]:qt,[s.NamedStyleType.TITLE]:ji,[s.NamedStyleType.SUBTITLE]:Ki,[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:qt},Us={[s.NamedStyleType.HEADING_1]:{key:"H1Icon",component:ls},[s.NamedStyleType.HEADING_2]:{key:"H2Icon",component:ds},[s.NamedStyleType.HEADING_3]:{key:"H3Icon",component:As},[s.NamedStyleType.HEADING_4]:{key:"H4Icon",component:us},[s.NamedStyleType.HEADING_5]:{key:"H5Icon",component:hs},[s.NamedStyleType.NORMAL_TEXT]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.TITLE]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.SUBTITLE]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:{key:"TextTypeIcon",component:Mt}},Qe=o=>t=>{const e=t.get(s.ICommandService),n=t.get(I.ComponentManager),i=Us[o];return n.get(i.key)||n.register(i.key,i.component),{id:Oc[o].id,type:I.MenuItemType.BUTTON,icon:i.key,tooltip:"toolbar.heading.tooltip",disabled$:te(t),hidden$:I.getMenuHiddenObservable(t,s.UniverInstanceType.UNIVER_DOC),activated$:new L.Observable(a=>{const r=s.NamedStyleType.NORMAL_TEXT,c=()=>{var u,m;const A=Xe(t);if(A==null){a.next(r===o);return}const d=(m=(u=A.paragraphStyle)==null?void 0:u.namedStyleType)!=null?m:r;a.next(d===o)},l=e.onCommandExecuted(A=>{const d=A.id;(d===D.SetTextSelectionsOperation.id||d===he.id)&&c()});return c(),l.dispose})}},Rc=Qe(s.NamedStyleType.HEADING_1),Mc=Qe(s.NamedStyleType.HEADING_2),xc=Qe(s.NamedStyleType.HEADING_3),Dc=Qe(s.NamedStyleType.HEADING_4),Bc=Qe(s.NamedStyleType.HEADING_5),_c=Qe(s.NamedStyleType.NORMAL_TEXT);Qe(s.NamedStyleType.TITLE),Qe(s.NamedStyleType.SUBTITLE);const Nc=o=>({id:Kn.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy"}),Pc=o=>({id:zn.id,type:I.MenuItemType.BUTTON,icon:"CutIcon",title:"rightClick.cut"}),wc=o=>({id:kn.id,type:I.MenuItemType.BUTTON,icon:"DeleteIcon",title:"rightClick.delete"}),Uc=o=>({id:io.id,type:I.MenuItemType.BUTTON,icon:"UnorderIcon",title:"rightClick.bulletList"}),Lc=o=>({id:so.id,type:I.MenuItemType.BUTTON,icon:"OrderIcon",title:"rightClick.orderList"}),Qc=o=>({id:ao.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",title:"rightClick.checkList"}),Fc=o=>({id:Yn.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",title:"toolbar.horizontalLine"}),Ls="doc.menu.insert-bellow";function Hc(o){return{id:Ls,type:I.MenuItemType.SUBITEMS,title:"rightClick.insertBellow"}}const Ho=4;var kc=Object.getOwnPropertyDescriptor,Vc=(o,t,e,n)=>{for(var i=n>1?void 0:n?kc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},un=(o,t)=>(e,n)=>t(e,n,o);function Qs(o,t){const e=Fs(o.left,o.top,t),n=Fs(o.right,o.bottom,t);return{left:e.x,top:e.y,right:n.x,bottom:n.y}}function Fs(o,t,e){const{scaleX:n,scaleY:i}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:o,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=(o-r)*n,A=(t-c)*i;return{x:l,y:A}}function Hs(o,t,e){const{scaleX:n,scaleY:i}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:o,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=o/n+r,A=t/i+c;return{x:l,y:A}}const hn=(o,t)=>{const{scene:e,mainComponent:n,engine:i}=t,a=t.with(D.DocSkeletonManagerService).getSkeleton(),r=a.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,o.segmentPage),c=o.collapsed?o.startOffset:o.endOffset-1,l=a.findNodePositionByCharIndex(c,!0,o.segmentId,o.segmentPage),A=n;if(!l||!r)return;const d=A.getOffsetConfig(),{docsLeft:u,docsTop:m}=d,h=i.getCanvasElement(),g=h.getBoundingClientRect(),p=_.pxToNum(h.style.width),{top:f,left:S,width:E}=g,C=E/p,{scaleX:T,scaleY:R}=e.getAncestorScale(),v=new be(d,a),{borderBoxPointGroup:O}=v.getRangePointData(r,l);return $t(O).map(N=>Qs(N,e)).map(N=>({left:(N.left+u*T)*C+S,right:(N.right+u*T)*C+S,top:(N.top+m*R)*C+f,bottom:(N.bottom+m*R)*C+f}))};y.DocCanvasPopManagerService=class extends s.Disposable{constructor(t,e,n,i){super(),this._globalPopupManagerService=t,this._renderManagerService=e,this._univerInstanceService=n,this._commandService=i}_createRectPositionObserver(t,e){const n=()=>{const{scene:l,engine:A}=e,d=typeof t=="function"?t():t,u=A.getCanvasElement(),m=u.getBoundingClientRect(),h=_.pxToNum(u.style.width),g=Qs(d,l),{top:p,left:f,width:S}=m,E=S/h;return{left:g.left*E+f,right:g.right*E+f,top:g.top*E+p,bottom:g.bottom*E+p}},i=n(),a=new L.BehaviorSubject(i),r=new s.DisposableCollection;r.add(this._commandService.onCommandExecuted(l=>{if(l.id===ue.id||l.id===D.RichTextEditingMutation.id){const A=n();A&&a.next(A)}}));const c=e.scene.getViewport(ae.VIEW_MAIN);return c&&r.add(c.onScrollAfter$.subscribeEvent(()=>{a.next(n())})),{position:i,position$:a,disposable:r}}_createObjectPositionObserver(t,e){const n=()=>{const{left:i,top:a,width:r,height:c}=t;return{left:i,right:i+r,top:a,bottom:a+c}};return this._createRectPositionObserver(n,e)}_createRangePositionObserver(t,e){var c;const n=(c=hn(t,e))!=null?c:[],i=new L.BehaviorSubject(n),a=new s.DisposableCollection;a.add(this._commandService.onCommandExecuted(l=>{if((l.id===ue.id||l.id===D.RichTextEditingMutation.id)&&l.params.unitId===e.unitId){const d=hn(t,e);d&&i.next(d)}}));const r=e.scene.getViewport(ae.VIEW_MAIN);return r&&a.add(r.onScrollAfter$.subscribeEvent(()=>{const l=hn(t,e);l&&i.next(l)})),{positions:n,positions$:i,disposable:a}}attachPopupToRect(t,e,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createRectPositionObserver(t,i),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToObject(t,e,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createObjectPositionObserver(t,i),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToRange(t,e,n){if(!this._univerInstanceService.getUnit(n))throw new Error(`Document not found, unitId: ${n}`);const{direction:a="top",multipleDirection:r}=e,c=this._renderManagerService.getRenderById(n);if(!c)throw new Error(`Current render not found, unitId: ${n}`);const{positions:l,positions$:A,disposable:d}=this._createRangePositionObserver(t,c),u=A.pipe(L.map(h=>a.includes("top")?h[0]:h[h.length-1])),m=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a.includes("top")?l[0]:l[l.length-1],anchorRect$:u,excludeRects:l,excludeRects$:A,direction:["top","bottom","horizontal"].some(h=>a.includes(h))&&l.length>1&&r!=null?r:a,canvasElement:c.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(m),A.complete(),d.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==m}}},y.DocCanvasPopManagerService=Vc([un(0,s.Inject(I.ICanvasPopupService)),un(1,_.IRenderManagerService),un(2,s.IUniverInstanceService),un(3,s.ICommandService)],y.DocCanvasPopManagerService);var Wc=Object.getOwnPropertyDescriptor,Gc=(o,t,e,n)=>{for(var i=n>1?void 0:n?Wc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Xc=(o,t)=>(e,n)=>t(e,n,o);const jc=(o,t,e,n)=>{var m,h,g,p,f;const i=e.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,n),a=e.getSkeletonData();let r=o.endOffset-1;if(o.segmentId){const S=(f=Array.from((h=(m=a==null?void 0:a.skeFooters.get(o.segmentId))==null?void 0:m.values())!=null?h:[])[0])!=null?f:Array.from((p=(g=a==null?void 0:a.skeHeaders.get(o.segmentId))==null?void 0:g.values())!=null?p:[])[0];S&&(r=Math.min(S.ed,r))}const c=e.findNodePositionByCharIndex(r,!0,o.segmentId,n);if(!c||!i)return;const l=t.getOffsetConfig(),A=new be(l,e),{borderBoxPointGroup:d}=A.getRangePointData(i,c);return $t(d).map(S=>({top:S.top+l.docsTop-Ho,bottom:S.bottom+l.docsTop+Ho,left:S.left+l.docsLeft,right:S.right+l.docsLeft}))},ks=(o,t,e,n)=>{const i=[];for(const a of o){const r=a.top;for(const c of a.columns){const l=c.left,A=a.colCount===1?n:c.width;let d=null;for(const u of c.lines){const m=u.paragraphIndex;if(u.paragraphStart){d&&(i.push(d),d=null);const h={top:t+r+u.top,left:e+l,right:e+l+A,bottom:t+r+u.top+u.lineHeight};d={paragraphStart:u.st,paragraphEnd:m,startIndex:m,rect:h,fisrtLine:{top:t+r+u.top+u.marginTop+u.paddingTop,left:e+l,right:e+l+A,bottom:t+r+u.top+u.marginTop+u.paddingTop+u.contentHeight}}}else d&&d.startIndex===m&&(d.rect.bottom=t+r+u.top+u.lineHeight)}d&&i.push(d)}}return i},Kc=(o,t,e,n=-1)=>{const i=e.findPositionByGlyph(o,n);if(!i)return;const a=t.getOffsetConfig(),r={...i,isBack:!0},c=new be(a,e),{borderBoxPointGroup:l}=c.getRangePointData(r,r),d=$t(l)[0];return{top:d.top+a.docsTop,bottom:d.bottom+a.docsTop,left:d.left+a.docsLeft,right:d.left+a.docsLeft+o.width}};function je(o,t,e){const{left:n,right:i,top:a,bottom:r}=e;return o>=n&&o<=i&&t>=a&&t<=r}y.DocEventManagerService=class extends s.Disposable{constructor(e,n){super();B(this,"_hoverCustomRanges$",new L.BehaviorSubject([]));B(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe(L.distinctUntilChanged((e,n)=>e.length===n.length&&e.every((i,a)=>n[a].range.rangeId===i.range.rangeId&&n[a].segmentId===i.segmentId&&n[a].segmentPageIndex===i.segmentPageIndex&&n[a].range.startIndex===i.range.startIndex))));B(this,"_clickCustomRanges$",new L.Subject);B(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable());B(this,"_hoverBullet$",new L.Subject);B(this,"hoverBullet$",this._hoverBullet$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.paragraph.startIndex)===(n==null?void 0:n.paragraph.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.segmentPageIndex)===(n==null?void 0:n.segmentPageIndex))));B(this,"_clickBullet$",new L.Subject);B(this,"clickBullets$",this._clickBullet$.asObservable());B(this,"_hoverParagraph$",new L.BehaviorSubject(null));B(this,"hoverParagraph$",this._hoverParagraph$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphRealTime$",this._hoverParagraph$.asObservable());B(this,"_hoverParagraphLeft$",new L.BehaviorSubject(null));B(this,"hoverParagraphLeft$",this._hoverParagraphLeft$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphLeftRealTime$",this._hoverParagraphLeft$.asObservable());B(this,"_hoverTableCell$",new L.Subject);B(this,"hoverTableCell$",this._hoverTableCell$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.rowIndex)===(n==null?void 0:n.rowIndex)&&(e==null?void 0:e.colIndex)===(n==null?void 0:n.colIndex)&&(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableCellRealTime$",this._hoverTableCell$.asObservable());B(this,"_hoverTable$",new L.Subject);B(this,"hoverTable$",this._hoverTable$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableRealTime$",this._hoverTable$.asObservable());B(this,"_customRangeDirty",!0);B(this,"_bulletDirty",!0);B(this,"_paragraphDirty",!0);B(this,"_customRangeBounds",[]);B(this,"_bulletBounds",[]);B(this,"_paragraphBounds",new Map);B(this,"_paragraphLeftBounds",[]);B(this,"_tableParagraphBounds",new Map);B(this,"_segmentParagraphBounds",new Map);B(this,"_tableCellBounds",new Map);B(this,"_tableBounds",new Map);this._context=e,this._docSkeletonManagerService=n,this._initResetDirty(),this._initEvents(),this._initPointer()}get hoverParagraph(){return this._hoverParagraph$.value}get hoverParagraphLeft(){return this._hoverParagraphLeft$.value}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=_.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(n=>{n.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(_.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0})),this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(e=>e.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0}))}_initEvents(){this.disposeWithMe(s.fromEventSubject(this._context.scene.onPointerMove$).pipe(L.throttleTime(30)).subscribe(i=>{if(i.buttons>0){this._hoverBullet$.next(null),this._hoverCustomRanges$.next([]),this._hoverParagraph$.next(null),this._hoverParagraphLeft$.next(null),this._hoverTableCell$.next(null),this._hoverTable$.next(null);return}const{x:a,y:r}=Hs(i.offsetX,i.offsetY,this._context.scene);this._hoverCustomRanges$.next(this._calcActiveRanges({x:a,y:r})),this._hoverParagraph$.next(this._calcActiveParagraph({x:a,y:r})),this._hoverParagraphLeft$.next(this._calcActiveParagraphLeft({x:a,y:r})),this._hoverBullet$.next(this._calcActiveBullet({x:a,y:r}))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));const e=s.fromEventSubject(this._context.mainComponent.onPointerDown$),n=s.fromEventSubject(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe(L.switchMap(i=>n.pipe(L.take(1),L.map(a=>({down:i,up:a})))),L.filter(({down:i,up:a})=>i.target===a.target&&a.timeStamp-i.timeStamp<300)).subscribe(({down:i})=>{if(i.button===2)return;const a=Hs(i.offsetX,i.offsetY,this._context.scene),r=this._calcActiveRanges(a);r.length&&this._clickCustomRanges$.next(r.pop());const c=this._calcActiveBullet(a);c&&this._clickBullet$.next(c)}))}_buildCustomRangeBoundsBySegment(e,n=-1){var r,c,l;const i=(l=(c=(r=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:r.getBody())==null?void 0:c.customRanges)!=null?l:[],a=[];return i.forEach(A=>{const d={startOffset:A.startIndex,endOffset:A.endIndex+1,segmentId:e},u=jc(d,this._documents,this._skeleton,n);if(!u)return null;a.push({customRange:A,rects:u,segmentId:e,segmentPageIndex:n})}),a}_buildCustomRangeBounds(){var n;if(!this._customRangeDirty)return;this._customRangeDirty=!1;const e=[];e.push(...this._buildCustomRangeBoundsBySegment()),(n=this._skeleton.getSkeletonData())==null||n.pages.forEach((i,a)=>{i.headerId&&e.push(...this._buildCustomRangeBoundsBySegment(i.headerId,a)),i.footerId&&e.push(...this._buildCustomRangeBoundsBySegment(i.footerId,a))}),this._customRangeBounds=e}_calcActiveRanges(e){this._buildCustomRangeBounds();const{x:n,y:i}=e;return this._customRangeBounds.filter(r=>r.rects.some(c=>je(n,i,c))).map(r=>({segmentId:r.segmentId,range:r.customRange,segmentPageIndex:r.segmentPageIndex,rects:r.rects}))}_buildBulletBoundsBySegment(e,n=-1){var A,d,u,m,h;const i=(A=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:A.getBody(),a=((d=i==null?void 0:i.paragraphs)!=null?d:[]).filter(g=>g.bullet&&g.bullet.listType.indexOf("CHECK_LIST")===0),r=[],c=this._skeleton.getSkeletonData();if(!c)return r;const l=g=>{var p,f,S;for(const E of g){const C=[...E.sections];if(E.skeTables){const T=Array.from(E.skeTables.values());C.push(...T.map(R=>R.rows.map(v=>v.cells.map(O=>O.sections))).flat(4))}for(const T of C)for(const R of T.columns)for(const v of R.lines)if(v.paragraphStart){const O=a.find(M=>M.startIndex===v.paragraphIndex);if(O){const M=v,b=(S=(f=(p=M==null?void 0:M.divides)==null?void 0:p[0])==null?void 0:f.glyphGroup)==null?void 0:S[0];if(!b)continue;const N=Kc(b,this._documents,this._skeleton,n);if(!N)continue;r.push({rect:N,segmentId:e,segmentPageIndex:n,paragraph:O})}}}return r};if(e){const g=(h=(u=c.skeFooters.get(e))==null?void 0:u.values())!=null?h:(m=c.skeHeaders.get(e))==null?void 0:m.values();return g?l(Array.from(g)):r}return l(c.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((n,i)=>{n.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.headerId,i)),n.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.footerId,i))}))}_calcActiveBullet(e){this._buildBulletBounds();const{x:n,y:i}=e;return this._bulletBounds.find(r=>je(n,i,r.rect))}_buildParagraphBoundsBySegment(e){var c,l,A;const n=this._skeleton.getSkeletonData(),a=this._documents.getOffsetConfig();if(!n)return null;const r=d=>{const u=new Map,m=(h,g,p,f)=>{ks(h.sections,p,f,h.pageWidth-h.marginLeft-h.marginRight).forEach(E=>{if(!u.has(E.startIndex))u.set(E.startIndex,{rect:E.rect,paragraphStart:E.paragraphStart,paragraphEnd:E.paragraphEnd,startIndex:E.startIndex,rects:[E.rect],pageIndex:g,segmentId:e,firstLine:E.fisrtLine});else{const C=u.get(E.startIndex);C&&(C.rect.bottom=E.rect.bottom,C.rects.push(E.rect))}})};for(let h=0;h<d.length;h++){const g=d[h],p=((g.pageHeight===1/0?0:g.pageHeight)+a.pageMarginTop)*h+g.marginTop+a.docsTop,f=g.marginLeft+a.docsLeft;g.skeTables&&Array.from(g.skeTables.values()).forEach(S=>{const E=S.left+f,C=S.top+p,T=E+S.width,R=C+S.height,v=S.tableId;this._tableBounds.set(v,{rect:{left:E,top:C,right:T,bottom:R},pageIndex:h,tableId:v}),S.rows.forEach((O,M)=>{O.cells.forEach((b,N)=>{const x=((g.pageHeight===1/0?0:g.pageHeight)+a.pageMarginTop)*h+S.top+a.docsTop+g.marginTop+O.top+b.marginTop,U=S.left+a.docsLeft+g.marginLeft+b.left+b.marginLeft,F=ks(b.sections,x,U,b.pageWidth-b.marginLeft-b.marginRight);let V=this._tableParagraphBounds.get(v);V||(V=[],this._tableParagraphBounds.set(v,V)),V.push(...F.map(Q=>({rect:Q.rect,paragraphStart:Q.paragraphStart,paragraphEnd:Q.paragraphEnd,startIndex:Q.startIndex,pageIndex:h,segmentId:e,rowIndex:M,colIndex:N,firstLine:Q.fisrtLine,tableId:v})));let H=this._tableCellBounds.get(v);H||(H=[],this._tableCellBounds.set(v,H)),H.push({rect:{top:x,left:U,right:U+b.pageWidth-b.marginLeft-b.marginRight,bottom:x+b.pageHeight-b.marginBottom-b.marginTop},pageIndex:h,rowIndex:M,colIndex:N,tableId:v})})})}),m(g,h,p,f)}return u};if(e){const d=(A=(c=n.skeFooters.get(e))==null?void 0:c.values())!=null?A:(l=n.skeHeaders.get(e))==null?void 0:l.values();return d?r(Array.from(d)):null}return r(n.pages)}_buildParagraphBounds(){var n,i;if(!this._paragraphDirty)return;this._paragraphDirty=!1,this._tableParagraphBounds=new Map,this._tableCellBounds=new Map,this._tableBounds=new Map,this._paragraphBounds=(n=this._buildParagraphBoundsBySegment())!=null?n:new Map,this._paragraphLeftBounds=Array.from(this._paragraphBounds.values()).map(a=>({...a,rect:{left:a.rect.left-60,right:a.rect.left,top:a.rect.top,bottom:a.rect.bottom}}));const e=a=>{var r;this._segmentParagraphBounds.set(a,(r=this._buildParagraphBoundsBySegment(a))!=null?r:new Map)};(i=this._skeleton.getSkeletonData())==null||i.pages.forEach(a=>{a.headerId&&e(a.headerId),a.footerId&&e(a.footerId)})}_calcActiveParagraph(e){var c,l;this._buildParagraphBounds();const{x:n,y:i}=e,a=Array.from(this._tableBounds.values()).find(A=>je(n,i,A.rect));if(this._hoverTable$.next(a),a){const A=(c=this._tableCellBounds.get(a.tableId))==null?void 0:c.find(m=>je(n,i,m.rect));if(this._hoverTableCell$.next(A),!A)return null;const d=(l=this._tableParagraphBounds.get(A.tableId))==null?void 0:l.filter(m=>m.colIndex===A.colIndex&&m.rowIndex===A.rowIndex),u=d==null?void 0:d.find(m=>je(n,i,m.rect));return u&&{...u,rects:[u.rect]}}let r;for(const A of this._paragraphBounds){const d=A[1];if(d.rects.some(u=>je(n,i,u))){r=d;break}}return r}_calcActiveParagraphLeft(e){this._buildParagraphBounds();const{x:n,y:i}=e;return this._paragraphLeftBounds.find(r=>je(n,i,r.rect))}get paragraphBounds(){return this._buildParagraphBounds(),this._paragraphBounds}findParagraphBoundByIndex(e){this._buildParagraphBounds();const n=this._paragraphBounds.get(e);return n||Array.from(this._tableParagraphBounds.values()).flat().find(a=>a.startIndex===e)}},y.DocEventManagerService=Gc([Xc(1,s.Inject(D.DocSkeletonManagerService))],y.DocEventManagerService);const zc=[he.id,Be.id,_e.id,Ne.id,Pe.id,Ee.id,we.id,Ce.id,Te.id];function Yc(o){const{avaliableMenus:t=zc}=o,e=I.useDependency(I.IMenuManagerService),[n,i]=w.useState([]);return w.useEffect(()=>{function a(){const c=e.getFlatMenuByPositionKey(I.MenuManagerPosition.RIBBON),l=[];for(const A of t){const d=c.find(u=>u.key===A);d&&l.push(d)}i(l)}a();const r=e.menuChanged$.subscribe(a);return()=>{r.unsubscribe()}},[e]),P.jsx("div",{className:J.clsx("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:!univer-border-gray-700 dark:!univer-bg-gray-900",J.borderClassName),children:n.map(a=>a.item&&P.jsx("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:P.jsx(I.ToolbarItem,{...a.item},a.key)},a.key))})}var qc=Object.getOwnPropertyDescriptor,Jc=(o,t,e,n)=>{for(var i=n>1?void 0:n?qc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Dt=(o,t)=>(e,n)=>t(e,n,o);const Vs="univer.doc.float-menu";function Zc(o,t){if(o==null||t==null)return!1;const{glyph:e,...n}=o,{glyph:i,...a}=t;return s.deepCompare(n,a)}const $c=[s.DataStreamTreeTokenType.CUSTOM_BLOCK,s.DataStreamTreeTokenType.PARAGRAPH];let gn=class extends s.Disposable{constructor(t,e,n,i,a,r){super();B(this,"_floatMenu",null);this._context=t,this._docSelectionManagerService=e,this._docCanvasPopManagerService=n,this._componentManager=i,this._univerInstanceService=a,this._docSelectionRenderService=r,!s.isInternalEditorID(this._context.unitId)&&(this._registerFloatMenu(),this._initSelectionChange(),this.disposeWithMe(()=>{this._hideFloatMenu()}))}get floatMenu(){return this._floatMenu}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register(Vs,Yc))}_initSelectionChange(){this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(()=>{this._hideFloatMenu()})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(t=>{var a,r;const{unitId:e,textRanges:n}=t;if(e!==this._context.unitId)return;const i=n.length>0&&n.find(c=>!c.collapsed);if(i){if(i.startOffset===((a=this._floatMenu)==null?void 0:a.start)&&i.endOffset===((r=this._floatMenu)==null?void 0:r.end))return;this._hideFloatMenu(),this._showFloatMenu(e,i);return}this._hideFloatMenu()}))}_hideFloatMenu(){var t;(t=this._floatMenu)==null||t.disposable.dispose(),this._floatMenu=null}_showFloatMenu(t,e){var r,c,l;const n=this._univerInstanceService.getUnit(t,s.UniverInstanceType.UNIVER_DOC);if(!n||n.getDisabled())return;const i=(r=n.getBody())==null?void 0:r.dataStream[e.startOffset];if(e.endOffset-e.startOffset===1&&i&&$c.includes(i))return;const a=(l=(c=n.getBody())==null?void 0:c.customRanges)==null?void 0:l.filter(A=>A.wholeEntity);if(!(a!=null&&a.some(A=>A.startIndex===e.startOffset&&A.endIndex===e.endOffset-1)))return this._floatMenu={disposable:this._docCanvasPopManagerService.attachPopupToRange(e,{componentKey:Vs,direction:e.direction==="backward"||Zc(e.startNodePosition,e.endNodePosition)?"top-center":"bottom-center",offset:[0,4]},t),start:e.startOffset,end:e.endOffset},s.toDisposable(()=>this._hideFloatMenu())}};gn=Jc([Dt(1,s.Inject(D.DocSelectionManagerService)),Dt(2,s.Inject(y.DocCanvasPopManagerService)),Dt(3,s.Inject(I.ComponentManager)),Dt(4,s.Inject(s.IUniverInstanceService)),Dt(5,s.Inject(y.DocSelectionRenderService))],gn);var el=Object.getOwnPropertyDescriptor,tl=(o,t,e,n)=>{for(var i=n>1?void 0:n?el(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Bt=(o,t)=>(e,n)=>t(e,n,o);let mn=class extends s.Disposable{constructor(t,e,n,i,a,r){super();B(this,"_paragrahMenu",null);this._context=t,this._docSelectionManagerService=e,this._docEventManagerService=n,this._docPopupManagerService=i,this._docSkeletonManagerService=a,this._floatMenuService=r,!s.isInternalEditorID(this._context.unitId)&&this._init()}get activeParagraph(){var t;return(t=this._paragrahMenu)==null?void 0:t.paragraph}_isCursorInActiveParagraph(){if(!this._paragrahMenu)return!1;const t=this._docSelectionManagerService.getActiveTextRange();return!(!(t!=null&&t.collapsed)||!(t!=null&&t.collapsed)||t.startOffset<this._paragrahMenu.paragraph.paragraphStart||t.startOffset>this._paragrahMenu.paragraph.paragraphEnd)}setParagraphMenuActive(t){this._paragrahMenu&&(this._paragrahMenu.active=t,this._isCursorInActiveParagraph()||this._docSelectionManagerService.replaceDocRanges([{startOffset:this._paragrahMenu.paragraph.paragraphStart,endOffset:this._paragrahMenu.paragraph.paragraphStart}]))}_init(){const t=n=>{var a;if(this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY&&!this._floatMenuService.floatMenu&&!this._context.unit.getDisabled()){if((a=this._paragrahMenu)!=null&&a.active)return;if(n){this.showParagraphMenu(n);return}}this.hideParagraphMenu(!0)};this.disposeWithMe(L.combineLatest([this._docEventManagerService.hoverParagraphRealTime$,this._docEventManagerService.hoverParagraphLeft$]).pipe(L.throttleTime(16)).subscribe(([n,i])=>{const a=n!=null?n:i;t(a)}));let e=0;this.disposeWithMe(this._context.scene.getViewport(ae.VIEW_MAIN).onScrollAfter$.subscribeEvent(n=>{e!==n.scrollY&&(e=n.scrollY,this.hideParagraphMenu(!0))})),this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(()=>{this.hideParagraphMenu(!0)}))}showParagraphMenu(t){var l,A,d;if(((l=this._paragrahMenu)==null?void 0:l.paragraph.startIndex)===t.startIndex)return;this.hideParagraphMenu(!0);const e=(d=(A=this._context.unit.getBody())==null?void 0:A.dataStream)!=null?d:"",n=t?e.slice(t.paragraphStart,t.paragraphEnd):"";if(n==="\b"||n==="")return;const c=this._docPopupManagerService.attachPopupToRect(t.firstLine,{componentKey:"doc.paragraph.menu",direction:"left-center",onClickOutside:()=>{this._docSelectionManagerService.textSelection$.pipe(L.first()).subscribe(()=>{this._isCursorInActiveParagraph()||this.hideParagraphMenu(!0)})},zIndex:101},this._context.unitId);this._paragrahMenu={paragraph:t,disposable:c,active:!1}}hideParagraphMenu(t=!1){this._paragrahMenu&&(this._paragrahMenu.disposable.canDispose()||t)&&(this._paragrahMenu.disposable.dispose(),this._paragrahMenu=null)}};mn=tl([Bt(1,s.Inject(D.DocSelectionManagerService)),Bt(2,s.Inject(y.DocEventManagerService)),Bt(3,s.Inject(y.DocCanvasPopManagerService)),Bt(4,s.Inject(D.DocSkeletonManagerService)),Bt(5,s.Inject(gn))],mn);const nl=({popup:o})=>{var v,O;const[t,e]=w.useState(!1),n=w.useRef(null),i=I.useDependency(s.ICommandService),a=I.useDependency(I.ILayoutService),r=w.useRef(null),c=w.useRef(!1),l=I.useDependency(_.IRenderManagerService),A=I.useDependency(s.IUniverInstanceService),d=l.getRenderById(o.unitId),u=A.getUnit(o.unitId,s.UniverInstanceType.UNIVER_DOC),m=d==null?void 0:d.with(mn),h=d==null?void 0:d.with(y.DocEventManagerService),g=I.useObservable(h==null?void 0:h.hoverParagraph$),p=I.useObservable(h==null?void 0:h.hoverParagraphLeft$),f=(v=g!=null?g:p)==null?void 0:v.startIndex,S=w.useMemo(()=>{var M,b;return(b=(M=u==null?void 0:u.getBody())==null?void 0:M.paragraphs)==null?void 0:b.find(N=>N.startIndex===f)},[u,g]),E=(O=S==null?void 0:S.paragraphStyle)==null?void 0:O.namedStyleType,C=Us[E!=null?E:s.NamedStyleType.NORMAL_TEXT],T=w.useMemo(()=>new L.BehaviorSubject({left:0,right:0,top:0,bottom:0}),[]),R=()=>{e(!1),m==null||m.hideParagraphMenu(!0)};return P.jsxs(P.Fragment,{children:[P.jsxs("div",{"data-u-comp":"paragraph-menu",ref:r,className:J.clsx("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",J.borderClassName,{"univer-bg-gray-100 dark:!univer-bg-gray-700":t,"univer-bg-white dark:!univer-bg-gray-700":!t}),onMouseEnter:M=>{var N,x,U,F,V,H;(N=o.onPointerEnter)==null||N.call(o,M),c.current=!0;const b=(x=r.current)==null?void 0:x.getBoundingClientRect();T.next({left:((U=b==null?void 0:b.left)!=null?U:0)-4,right:(F=b==null?void 0:b.right)!=null?F:0,top:(V=b==null?void 0:b.top)!=null?V:0,bottom:(H=b==null?void 0:b.bottom)!=null?H:0})},onMouseLeave:()=>{c.current=!1},onClick:()=>{e(!0),m==null||m.setParagraphMenuActive(!0)},children:[P.jsx(C.component,{className:"univer-size-4 univer-text-gray-900 dark:!univer-text-white"}),P.jsx(cs,{className:"univer-size-3 univer-text-gray-600 dark:!univer-text-gray-200"})]}),t&&P.jsx(I.RectPopup,{portal:!0,mask:!0,maskZIndex:100,anchorRect$:T,direction:"left",onMaskClick:R,children:P.jsx("section",{ref:n,onMouseEnter:M=>{var b;(b=o.onPointerEnter)==null||b.call(o,M),c.current=!0},onMouseLeave:()=>{c.current=!1},children:P.jsx(I.DesktopMenu,{style:{width:212},menuType:I.ContextMenuPosition.PARAGRAPH,onOptionSelect:M=>{const{label:b,commandId:N,value:x}=M;i&&i.executeCommand(N!=null?N:b,{value:x}),a.focus(),R()}})})})]})};function ee(o){return o.getContextValue(s.FOCUSING_DOC)&&o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}function ol(o){return o.getContextValue(s.FOCUSING_DOC)&&o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}const il={id:ke.id,binding:I.KeyCode.TAB,preconditions:ee},sl={id:ke.id,binding:I.KeyCode.TAB|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{shift:!0}},al={id:Be.id,binding:I.KeyCode.B|I.MetaKeys.CTRL_COMMAND,preconditions:ee},rl={id:_e.id,binding:I.KeyCode.I|I.MetaKeys.CTRL_COMMAND,preconditions:ee},cl={id:Ne.id,binding:I.KeyCode.U|I.MetaKeys.CTRL_COMMAND,preconditions:ee},ll={id:Pe.id,binding:I.KeyCode.X|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ee},dl={id:Ee.id,binding:I.KeyCode.COMMA|I.MetaKeys.CTRL_COMMAND,preconditions:ee},Al={id:we.id,binding:I.KeyCode.PERIOD|I.MetaKeys.CTRL_COMMAND,preconditions:ee},ul={id:Et.id,binding:I.KeyCode.L|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},hl={id:Tt.id,binding:I.KeyCode.R|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},gl={id:Ct.id,binding:I.KeyCode.E|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},ml={id:yt.id,binding:I.KeyCode.J|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},pl={id:tt.id,binding:I.KeyCode.Digit7|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},fl={id:et.id,binding:I.KeyCode.Digit8|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},pn="docs-ui.config",Ws={layout:{docContainerConfig:ii,toolbarConfig:oi}},Sl=[50,80,100,130,150,170,200,400],Il=[10,400];function vl(){const o=I.useDependency(s.ICommandService),t=I.useDependency(s.IUniverInstanceService),e=w.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[]),n=I.useObservable(e),i=w.useCallback(()=>{var A,d;if(!n)return 100;const l=((d=(A=n.getSettings())==null?void 0:A.zoomRatio)!=null?d:1)*100;return Math.round(l)},[n]),[a,r]=w.useState(()=>i());w.useEffect(()=>(r(i()),o.onCommandExecuted(A=>{if(A.id===ue.id){const d=i();r(d)}}).dispose),[o,i]);function c(l){if(r(l),n==null)return;const A=l/100;o.executeCommand(ue.id,{unitId:n.getUnitId(),zoomRatio:A})}return P.jsx(I.Slider,{min:Il[0],value:a,shortcuts:Sl,onChange:c})}function El(o){return P.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:P.jsx(vl,{})})}function Cl(){var i,a,r;const o=I.useDependency(s.IUniverInstanceService),t=I.useConfigValue(pn),e=I.useObservable(()=>o.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),n=(r=(a=(i=t==null?void 0:t.layout)==null?void 0:i.docContainerConfig)==null?void 0:a.footer)!=null?r:!0;return e?null:n&&P.jsxs("div",{className:"univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5 univer-py-1.5",children:[P.jsx("div",{}),P.jsx(El,{})]})}const Tl="univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-cursor-pointer univer-pr-1 ",yl="univer-text-base univer-font-semibold",bl="univer-text-sm univer-font-semibold",Ol="univer-text-sm",Rl=w.forwardRef((o,t)=>{const{menus:e,onClick:n,className:i,style:a,mode:r,maxHeight:c,activeId:l,open:A,onOpenChange:d,maxWidth:u,wrapperClass:m,wrapperStyle:h,iconClass:g,iconStyle:p}=o,f=r==="side-bar",S=w.useRef(null),E=w.useRef(e);E.current=e;const C=w.useMemo(()=>({scrollTo:T=>{var x;if(!E.current||E.current.findIndex(U=>U.id===T)===-1||!S.current)return;const v=document.getElementById(`univer-side-menu-${T}`);if(!v)return;const O=v.offsetTop,M=S.current.clientHeight,b=S.current.scrollHeight-M,N=Math.max(0,Math.min(O-M/2+v.clientHeight/2,b));(x=S.current)==null||x.scrollTo({behavior:"smooth",top:N})}}),[]);return w.useImperativeHandle(t,()=>C),w.useEffect(()=>{l&&C.scrollTo(l)},[l,C]),P.jsxs("div",{className:J.clsx("univer-relative",m),style:h,children:[P.jsx("div",{onClick:()=>d==null?void 0:d(!A),className:J.clsx("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-h-8 univer-w-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-sm dark:!univer-bg-gray-600 dark:!univer-text-gray-200",g),style:p,children:A?P.jsx(ms,{}):P.jsx(is,{})}),P.jsx("div",{className:J.clsx(i,`
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-px-4 univer-pb-4 univer-pt-14 univer-transition-all univer-duration-300
                    `,{"univer-rounded-r-2xl univer-bg-white univer-shadow univer-backdrop-blur-[10px] dark:!univer-bg-gray-900":f}),style:{...a,transform:A?"translateX(0)":"translateX(-100%)",maxHeight:c,opacity:A?1:0,maxWidth:u!=null?u:r==="side-bar"?320:180,paddingRight:r==="float"?void 0:0},children:P.jsx("div",{ref:S,className:J.clsx("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden",J.scrollbarClassName),children:e==null?void 0:e.map(T=>P.jsx("div",{id:`univer-side-menu-${T.id}`,className:J.clsx(Tl,{[yl]:T.isTitle,[bl]:T.level===1,[Ol]:T.level>1,"univer-text-gray-500 dark:!univer-text-gray-400":T.id!==l,"univer-text-gray-800 dark:!univer-text-gray-200":T.id===l}),style:{paddingLeft:(T.level-1)*12},onClick:()=>{n==null||n(T)},children:T.text},T.id))})})]})}),Ml=o=>{switch(o){case s.NamedStyleType.HEADING_1:return 1;case s.NamedStyleType.HEADING_2:return 2;case s.NamedStyleType.HEADING_3:return 3;case s.NamedStyleType.HEADING_4:return 4;case s.NamedStyleType.HEADING_5:return 5;case s.NamedStyleType.TITLE:return 1;default:return 1}};function xl(o,t,e,n){var c,l;if(!o)return;const i=Array.from(o.values()),a=i.findIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);if(a===-1)return;const r=i==null?void 0:i.findLastIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);for(let A=a;A<=r;A++){const d=i[A],u=t.get(d.startIndex);if((c=u==null?void 0:u.paragraphStyle)!=null&&c.headingId)return u.paragraphStyle.headingId}for(let A=a;A>=0;A--){const d=i[A],u=t.get(d.startIndex);if((l=u==null?void 0:u.paragraphStyle)!=null&&l.headingId)return u.paragraphStyle.headingId}}const Gs="__title";function Dl(){var t,e,n;const o=I.useConfigValue(pn);return(n=(e=(t=o==null?void 0:o.layout)==null?void 0:t.docContainerConfig)==null?void 0:e.sideMenu)==null||n?P.jsx(Bl,{}):null}function Bl(){var N,x,U,F,V,H,Q,j,X;const o=I.useDependency(s.ICommandService),t=I.useDependency(s.IUniverInstanceService),e=I.useObservable(w.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[])),n=I.useDependency(_.IRenderManagerService),i=(x=(N=e==null?void 0:e.getBody())==null?void 0:N.dataStream)!=null?x:"",[a,r]=w.useState(0),[c,l]=w.useState(void 0),A=(U=e==null?void 0:e.getUnitId())!=null?U:"",d=n.getRenderById(A),u=e==null?void 0:e.getTitle(),m=d==null?void 0:d.with(y.DocEventManagerService),h=m==null?void 0:m.paragraphBounds,g=(V=(F=d==null?void 0:d.mainComponent)==null?void 0:F.left)!=null?V:0,p=(H=d==null?void 0:d.engine.height)!=null?H:0,f=(Q=d==null?void 0:d.scene.scaleY)!=null?Q:1,S=(X=(j=e==null?void 0:e.getBody())==null?void 0:j.paragraphs)!=null?X:[],E=w.useMemo(()=>{const k=new Map;return S.forEach(W=>{k.set(W.startIndex,W)}),k},[S]);I.useObservable(w.useMemo(()=>d!=null&&d.engine.onTransformChange$?s.fromEventSubject(d==null?void 0:d.engine.onTransformChange$).pipe(L.throttleTime(33)):L.of(null),[d==null?void 0:d.engine.onTransformChange$]));const C=g<180?"float":"side-bar",T=S==null?void 0:S.filter(k=>{var W;return((W=k.paragraphStyle)==null?void 0:W.namedStyleType)!==void 0&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.SUBTITLE&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.NORMAL_TEXT}).map(k=>{var q;const W=Ml(k.paragraphStyle.namedStyleType),G=h==null?void 0:h.get(k.startIndex);if(!G)return null;const{paragraphStart:K,paragraphEnd:Y}=G;return{id:k.paragraphStyle.headingId,text:s.getPlainText(i.slice(K,Y)),level:W,isTitle:((q=k.paragraphStyle)==null?void 0:q.namedStyleType)===s.NamedStyleType.TITLE}}).filter(k=>k==null?void 0:k.text),R=I.useEvent(k=>{const W=k.viewportScrollY,G=W+p/f,K=xl(h,E,W,G);K&&l(K)}),v=T!=null&&T.find(k=>k.isTitle)?T:[...u?[{id:Gs,text:u,level:1,isTitle:!0}]:[],...T!=null?T:[]].filter(Boolean),[O,M]=w.useState(!0);w.useEffect(()=>{const k=s.debounce(r,100),W=o.onCommandExecuted(G=>{G.id===D.RichTextEditingMutation.id&&G.params.unitId===(e==null?void 0:e.getUnitId())&&k(Y=>Y+1)});return()=>{W.dispose()}},[o,e]),w.useEffect(()=>{const k=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!k)return;const W=s.fromEventSubject(k.onScrollAfter$).pipe(L.throttleTime(33)).subscribe(R);return()=>{W.unsubscribe()}},[d]);const b=I.useEvent(k=>{const W=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!W)return;if(k.id===Gs){W.scrollToViewportPos({viewportScrollY:0});return}const G=S.find(Y=>{var q;return((q=Y.paragraphStyle)==null?void 0:q.headingId)===k.id});if(!G)return;const K=h==null?void 0:h.get(G.startIndex);K&&(W.scrollToViewportPos({viewportScrollY:K.rect.top}),l(k.id))});return!e||s.isInternalEditorID(A)||!(v!=null&&v.length)?null:P.jsx("div",{className:"univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",children:P.jsx(Rl,{menus:v,open:O,onOpenChange:M,mode:C,maxWidth:C==="float"?void 0:Math.floor(g)-10,wrapperClass:"univer-mt-12",activeId:c,onClick:b,maxHeight:p-48})})}const pe={id:"doc-paragraph-setting.command",type:s.CommandType.COMMAND,handler:async(o,t)=>{var C,T,R,v,O;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getDocRanges();if(!a||r.length===0||!t)return!1;const c=r[0].segmentId,l=a.getUnitId(),A=a.getSelfOrHeaderFooterModel(c),d=(T=(C=A.getBody())==null?void 0:C.paragraphs)!=null?T:[],u=(v=(R=A.getBody())==null?void 0:R.dataStream)!=null?v:"",m=(O=s.BuildTextUtils.range.getParagraphsInRanges(r,d,u))!=null?O:[],h={id:D.RichTextEditingMutation.id,params:{unitId:l,actions:[],textRanges:r}},g=new s.MemoryCursor;g.reset();const p=new s.TextX,f=s.JSONX.getInstance();for(const M of m){const{startIndex:b}=M;p.push({t:s.TextXActionType.RETAIN,len:b-g.cursor});const N={...M.paragraphStyle,...t.paragraph};p.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...M,paragraphStyle:N,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),g.moveCursorTo(b+1)}const S=Z(a,c);return h.params.actions=f.editOp(p.serialize(),S),!!i.syncExecuteCommand(h.id,h.params)}},_l=()=>{const o=I.useDependency(D.DocSelectionManagerService),t=I.useDependency(st),e=w.useMemo(()=>o.getDocRanges(),[]);return w.useEffect(()=>{e.length||t.closePanel()},[e]),e},Nl=()=>{var l,A,d,u,m;const t=I.useDependency(s.IUniverInstanceService).getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),e=_l();if(!t||e.length===0)return[];const n=e[0].segmentId,i=t.getSelfOrHeaderFooterModel(n),a=(A=(l=i.getBody())==null?void 0:l.paragraphs)!=null?A:[],r=(u=(d=i.getBody())==null?void 0:d.dataStream)!=null?u:"";return(m=s.BuildTextUtils.range.getParagraphsInRanges(e,a,r))!=null?m:[]},Pl=(o,t)=>{const e=I.useDependency(s.ICommandService),[n,i]=w.useState(()=>{var c,l;const r=o[0];return r?String((l=(c=r.paragraphStyle)==null?void 0:c.horizontalAlign)!=null?l:t):t});return[n,r=>(i(r),e.executeCommand(pe.id,{paragraph:{horizontalAlign:Number(r)}}))]},wl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentStart,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentStart:{v:a}}}))]},Ul=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentEnd,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentEnd:{v:a}}}))]},Ll=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentFirstLine,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentFirstLine:{v:a}}}))]},Ql=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.hanging,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{hanging:{v:a}}}))]},Fl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceAbove,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceAbove:{v:a}}}))]},Hl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceBelow,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceBelow:{v:a}}}))]},kl=o=>{const t=I.useDependency(s.ICommandService),e=I.useDependency(_.IRenderManagerService),n=I.useDependency(s.IUniverInstanceService),i=w.useMemo(()=>{var g;const h=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(h)return(g=e.getRenderById(h==null?void 0:h.getUnitId()))==null?void 0:g.with(D.DocSkeletonManagerService).getSkeleton()},[]),a=w.useMemo(()=>new L.BehaviorSubject({}),[]),[r,c]=w.useState(()=>{var g,p;const h=o[0];return h&&(p=(g=h.paragraphStyle)==null?void 0:g.lineSpacing)!=null?p:1}),l=w.useRef(r),[A,d]=w.useState(()=>{var g,p;const h=o[0];return h&&(p=(g=h.paragraphStyle)==null?void 0:g.spacingRule)!=null?p:s.SpacingRule.AUTO}),u=async h=>{c(h),a.next({lineSpacing:h,spacingRule:A})},m=async h=>{if(h!==A){let g=l.current;if(h===s.SpacingRule.AT_LEAST){const p=i==null?void 0:i.findNodeByCharIndex(o[0].startIndex),f=p==null?void 0:p.parent,S=f==null?void 0:f.parent;(S==null?void 0:S.contentHeight)!==void 0&&(g=Math.max(S.contentHeight,g))}else g>5&&(g=2);l.current=r,u(g),d(h),a.next({spacingRule:h})}};return w.useEffect(()=>{const h=a.pipe(lt.filter(g=>!!Object.keys(g).length),lt.bufferTime(16),lt.filter(g=>!!g.length),lt.map(g=>g.reduce((p,f)=>(Object.keys(f).forEach(S=>{p[S]=f[S]}),p),{}))).subscribe(g=>t.executeCommand(pe.id,{paragraph:{...g}}));return()=>h.unsubscribe()},[]),{lineSpacing:[r,u],spacingRule:[A,m]}},Ke=o=>{const{value:t,onChange:e,className:n="",min:i=0,max:a=100,step:r=1}=o,c=w.useRef(null);return P.jsx(J.InputNumber,{step:r,ref:c,min:i,max:a,value:t,onChange:l=>{e(l!=null?l:0).finally(()=>{setTimeout(()=>{var A;(A=c.current)==null||A.focus()},30)})},className:n})};function Vl(){const o=I.useDependency(s.LocaleService),t=w.useMemo(()=>[{label:o.t("toolbar.alignLeft"),value:String(s.HorizontalAlign.LEFT),icon:P.jsx(ps,{})},{label:o.t("toolbar.alignCenter"),value:String(s.HorizontalAlign.CENTER),icon:P.jsx(gs,{})},{label:o.t("toolbar.alignRight"),value:String(s.HorizontalAlign.RIGHT),icon:P.jsx(fs,{})},{label:o.t("toolbar.alignJustify"),value:String(s.HorizontalAlign.JUSTIFIED),icon:P.jsx(os,{})}],[]),e=Nl(),[n,i]=Pl(e,t[0].value),[a,r]=wl(e),[c,l]=Ul(e),[A,d]=Ll(e),[u,m]=Ql(e),[h,g]=Fl(e),[p,f]=Hl(e),{lineSpacing:[S,E],spacingRule:[C,T]}=kl(e),R=w.useMemo(()=>C===s.SpacingRule.AUTO?{min:1,max:5,step:S<2?.5:1}:{min:1,max:100},[C,S]);return P.jsxs("div",{children:[P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.alignment")}),P.jsx("div",{className:J.clsx("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1",J.borderClassName),children:t.map(v=>P.jsx(J.Tooltip,{title:v.label,placement:"bottom",children:P.jsx("span",{className:J.clsx("hover:univer-bg-black/60 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1",{"univer-bg-blend-color-dodge/90":n===v.value}),onClick:()=>i(v.value),children:v.icon})},v.value))}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.indentation")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.left"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:a,onChange:v=>r(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.right"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:c,onChange:v=>l(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.firstLine"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:A,onChange:v=>d(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.hanging"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:u,onChange:v=>m(v!=null?v:0)})]})]}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.spacing")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-justify-betweenuniver-item-center univer-flex",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.before"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:h,onChange:v=>g(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.after"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:p,onChange:v=>f(v!=null?v:0)})]}),P.jsxs("div",{className:"item-center univer-flex univer-justify-between",children:[P.jsx("div",{className:"univer-mt-3 univer-text-xs",children:o.t("doc.paragraphSetting.lineSpace")}),P.jsxs("div",{className:"univer-mt-4 univer-flex univer-w-[162px] univer-flex-col univer-gap-1.5",children:[P.jsx(J.Select,{value:`${C}`,options:[{label:o.t("doc.paragraphSetting.multiSpace"),value:`${s.SpacingRule.AUTO}`},{label:o.t("doc.paragraphSetting.fixedValue"),value:`${s.SpacingRule.AT_LEAST}`}],onChange:v=>T(Number(v))}),P.jsx(Ke,{...R,value:S,onChange:v=>E(v!=null?v:0)})]})]})]})]})}const Wl=(o,t)=>t.length===o.length&&o.some(e=>t.some(n=>n.startOffset===e.startOffset&&n.endOffset===e.endOffset));function Gl(){const o=I.useDependency(s.ICommandService),t=I.useDependency(s.LocaleService),e=I.useObservable(t.currentLocale$),[n,i]=w.useState(""),a=w.useMemo(()=>s.debounce(()=>i(s.generateRandomId(4)),300),[]),r=w.useRef([]);return w.useEffect(()=>{const c=o.onCommandExecuted(l=>{if(D.SetTextSelectionsOperation.id===l.id){const A=l.params.ranges;Wl(A,r.current)||i(s.generateRandomId(4)),r.current=A}D.RichTextEditingMutation.id===l.id&&l.params.trigger!==pe.id&&a()});return()=>c.dispose()},[a]),w.useEffect(()=>{i(s.generateRandomId(4))},[e]),w.useEffect(()=>()=>a.cancel(),[a]),P.jsx(Vl,{},n)}var Xl=Object.getOwnPropertyDescriptor,jl=(o,t,e,n)=>{for(var i=n>1?void 0:n?Xl(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ko=(o,t)=>(e,n)=>t(e,n,o);const Xs="doc_ui_paragraph-setting-panel";let st=class extends s.Disposable{constructor(t,e,n){super();B(this,"_id");this._commandService=t,this._componentManager=e,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(Xs,Gl))}openPanel(){const t={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:Xs},width:300};this._sidebarService.open(t)}closePanel(){this._sidebarService.close(this._id)}};st=jl([ko(0,s.ICommandService),ko(1,s.Inject(I.ComponentManager)),ko(2,s.Inject(I.ISidebarService))],st);const Vo={id:"sidebar.operation.doc-paragraph-setting-panel",type:s.CommandType.OPERATION,handler:o=>(o.get(st).openPanel(),!0)},Wo=o=>{const t=o.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(()=>{t.getDocRanges().some(r=>r.collapsed===!1||r.rangeType===s.DOC_RANGE_TYPE.RECT)?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})};function Kl(o){if(o.length<2)return!0;const t=o.map(e=>e.tableId);return t.every(e=>e===t[0])}function js(o,t,e){var a;const n=t.getRectRanges(),i=t.getActiveTextRange();if(n&&n.length&&Kl(n)&&i==null){o.next(!1);return}if(i&&(n==null||n.length===0)){const{segmentId:r,startOffset:c,endOffset:l}=i,A=e.getCurrentUniverDocInstance(),d=(a=A==null?void 0:A.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:a.tables;if(d&&d.length&&d.some(u=>{const{startIndex:m,endIndex:h}=u;return c>m&&c<h||l>m&&l<h})){o.next(!1);return}}o.next(!0)}const Me=o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService);return new L.Observable(n=>{const i=t.textSelection$.subscribe(()=>{js(n,t,e)});return js(n,t,e),()=>i.unsubscribe()})},zl=o=>({id:mt.name,commandId:mt.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Yl=o=>({id:Vo.id,type:I.MenuItemType.BUTTON,icon:"MenuIcon",title:"doc.menu.paragraphSetting",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),ql=o=>({id:Kt.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.cut",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Jl=o=>({id:zt.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.paste",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Zl=o=>({id:ht.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.delete",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Ks="doc.menu.table-insert";function $l(o){return{id:Ks,type:I.MenuItemType.SUBITEMS,title:"table.insert",icon:"InsertDoubleIcon",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),Me(o),(t,e)=>t||e)}}function ed(o){return{id:sn.id,type:I.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAboveDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function td(o){return{id:an.id,type:I.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelowDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function nd(o){return{id:rn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function od(o){return{id:cn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const zs="doc.menu.table-delete";function id(o){return{id:zs,type:I.MenuItemType.SUBITEMS,title:"table.delete",icon:"ReduceDoubleIcon",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),Me(o),(t,e)=>t||e)}}function sd(o){return{id:nn.id,type:I.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRowDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ad(o){return{id:on.id,type:I.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function rd(o){return{id:it.id,type:I.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const Ys={[I.RibbonStartGroup.FORMAT]:{[Be.id]:{order:0,menuItemFactory:oc},[_e.id]:{order:1,menuItemFactory:ic},[Ne.id]:{order:2,menuItemFactory:sc},[Pe.id]:{order:3,menuItemFactory:ac},[Ee.id]:{order:4,menuItemFactory:rc},[we.id]:{order:5,menuItemFactory:cc},[ce.id]:{order:5.5,menuItemFactory:Ac},[he.id]:{order:6,menuItemFactory:dc},[Ue.id]:{order:7,menuItemFactory:lc},[Ce.id]:{order:8,menuItemFactory:uc},[Te.id]:{order:9,menuItemFactory:yc,[Ze.id]:{order:0,menuItemFactory:Tc}}},[I.RibbonStartGroup.LAYOUT]:{[Et.id]:{order:2,menuItemFactory:fc},[Ct.id]:{order:3,menuItemFactory:Sc},[Tt.id]:{order:4,menuItemFactory:Ic},[yt.id]:{order:5,menuItemFactory:vc},[pt.id]:{order:6,menuItemFactory:Ec},[tt.id]:{order:7,menuItemFactory:Ns},[et.id]:{order:8,menuItemFactory:Ps},[vt.id]:{order:9,menuItemFactory:ws},[Uo.id]:{order:10,menuItemFactory:hc},[Rt.id]:{order:11,menuItemFactory:Cc},[Fo.id]:{order:12,menuItemFactory:bc}},[I.RibbonInsertGroup.MEDIA]:{[_s]:{order:2,menuItemFactory:mc,[ln.id]:{order:0,menuItemFactory:pc}}},[I.ContextMenuPosition.MAIN_AREA]:{[I.ContextMenuGroup.FORMAT]:{[mt.name]:{order:0,menuItemFactory:zl},[Kt.id]:{order:1,menuItemFactory:ql},[zt.id]:{order:2,menuItemFactory:Jl},[ht.id]:{order:3,menuItemFactory:Zl}},[I.ContextMenuGroup.LAYOUT]:{[Vo.id]:{order:0,menuItemFactory:Yl},[Ks]:{order:1,menuItemFactory:$l,[sn.id]:{order:1,menuItemFactory:ed},[an.id]:{order:2,menuItemFactory:td},[rn.id]:{order:3,menuItemFactory:nd},[cn.id]:{order:4,menuItemFactory:od}},[zs]:{order:2,menuItemFactory:id,[nn.id]:{order:1,menuItemFactory:sd},[on.id]:{order:2,menuItemFactory:ad},[it.id]:{order:3,menuItemFactory:rd}}}},[I.ContextMenuPosition.PARAGRAPH]:{[I.ContextMenuGroup.QUICK]:{[co.id]:{order:0,menuItemFactory:Rc},[lo.id]:{order:1,menuItemFactory:Mc},[Ao.id]:{order:2,menuItemFactory:xc},[uo.id]:{order:3,menuItemFactory:Dc},[ho.id]:{order:4,menuItemFactory:Bc},[qt.id]:{order:5,menuItemFactory:_c},[tt.id]:{order:6,menuItemFactory:Ns},[et.id]:{order:7,menuItemFactory:Ps},[vt.id]:{order:8,menuItemFactory:ws}},[I.ContextMenuGroup.FORMAT]:{[Kn.id]:{order:0,menuItemFactory:Nc},[zn.id]:{order:1,menuItemFactory:Pc},[kn.id]:{order:2,menuItemFactory:wc}},[I.ContextMenuGroup.LAYOUT]:{[Ls]:{menuItemFactory:Hc,[io.id]:{order:0,menuItemFactory:Uc},[so.id]:{order:1,menuItemFactory:Lc},[ao.id]:{order:2,menuItemFactory:Qc},[Yn.id]:{order:3,menuItemFactory:Fc}}}}};var cd=Object.getOwnPropertyDescriptor,ld=(o,t,e,n)=>{for(var i=n>1?void 0:n?cd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},xe=(o,t)=>(e,n)=>t(e,n,o);y.DocUIController=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super(),this._injector=t,this._componentManager=e,this._commandService=n,this._layoutService=i,this._menuManagerService=a,this._uiPartsService=r,this._univerInstanceService=c,this._shortcutService=l,this._configService=A,this._init()}_initCustomComponents(){[[Ds,Jr],[xs,Yr],["TodoListDoubleIcon",Ss],["doc.paragraph.menu",nl],["CutIcon",ss],["DeleteIcon",as],[Qo,$r],["DocumentSettingIcon",rs]].forEach(([t,e])=>{this.disposeWithMe(this._componentManager.register(t,e))})}_initUiParts(){this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.FOOTER,()=>I.connectInjector(Cl,this._injector))),this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Dl,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(Ys)}_initShortCut(){[al,rl,cl,ll,dl,Al,gl,ml,hl,ul,pl,fl,il].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[Os,Uo,Po].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(s.UniverInstanceType.UNIVER_DOC,t=>{this._injector.get(_.IRenderManagerService).getRenderById(t).with(y.DocSelectionRenderService).focus()}))}},y.DocUIController=ld([xe(0,s.Inject(s.Injector)),xe(1,s.Inject(I.ComponentManager)),xe(2,s.ICommandService),xe(3,I.ILayoutService),xe(4,I.IMenuManagerService),xe(5,I.IUIPartsService),xe(6,s.IUniverInstanceService),xe(7,I.IShortcutService),xe(8,s.IConfigService)],y.DocUIController);var dd=Object.getOwnPropertyDescriptor,Ad=(o,t,e,n)=>{for(var i=n>1?void 0:n?dd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Go=(o,t)=>(e,n)=>t(e,n,o);const qs=1.5;y.DocBackScrollRenderController=class extends s.RxDisposable{constructor(t,e,n,i){super(),this._context=t,this._textSelectionManagerService=e,this._editorService=n,this._docSkeletonManagerService=i,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{if(t==null)return;const{isEditing:e,unitId:n}=t;n!==this._context.unitId||!e||this._context.unitId!==s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._scrollToSelection()})}scrollToRange(t){const e=this._docSkeletonManagerService.getSkeleton();if(!e)return;const{startOffset:n}=t,i=e.findNodePositionByCharIndex(n);i&&this.scrollToNode(i)}scrollToNode(t){var N;const{unitId:e,scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton();if(i==null||a==null)return;const r=i.getOffsetConfig(),{docsLeft:c,docsTop:l}=r,A=new be(r,a),{contentBoxPointGroup:d}=A.getRangePointData(t,t),{left:u,top:m,height:h}=Ot(d),g=u+c,p=m+l,f=n.getViewport(ae.VIEW_MAIN),S=this._editorService.getEditor(e);if(f==null)return;const{left:E,top:C,right:T,bottom:R}=f.getBounding().viewBound;let v=0,O=0;const M=S?(N=S.params.backScrollOffset)!=null?N:0:100;p<C?v=p-C-M:p>R-h&&(v=p-R+h+M),g<E?O=g-E:g>T-qs&&(O=g-T+qs);const b=f.transViewportScroll2ScrollValue(O,v);f.scrollByBarDeltaValue(b)}_scrollToSelection(){const t=this._textSelectionManagerService.getActiveTextRange();if(t==null)return;const{collapsed:e,startNodePosition:n}=t;e&&this.scrollToNode(n)}},y.DocBackScrollRenderController=Ad([Go(1,s.Inject(D.DocSelectionManagerService)),Go(2,le),Go(3,s.Inject(D.DocSkeletonManagerService))],y.DocBackScrollRenderController);var ud=Object.getOwnPropertyDescriptor,hd=(o,t,e,n)=>{for(var i=n>1?void 0:n?ud(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},at=(o,t)=>(e,n)=>t(e,n,o);y.DocRenderController=class extends s.RxDisposable{constructor(t,e,n,i,a,r,c){super(),this._context=t,this._commandService=e,this._docSelectionRenderService=n,this._docSkeletonManagerService=i,this._editorService=a,this._renderManagerService=r,this._univerInstanceService=c,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(t){var r,c;const e=(r=this._renderManagerService.getRenderById(t))==null?void 0:r.with(D.DocSkeletonManagerService),n=e==null?void 0:e.getSkeleton();if(!n||!!n.getViewModel().getDataModel().getSnapshot().disabled)return;n.calculate();const a=this._editorService.getEditor(t);if(this._editorService.isEditor(t)&&!(a!=null&&a.params.scrollBar)){(c=this._context.mainComponent)==null||c.makeDirty();return}this._recalculateSizeBySkeleton(n)}_addNewRender(){const{scene:t,engine:e}=this._context,n=new _.Viewport(ae.VIEW_MAIN,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.attachControl(),t.onMouseWheel$.subscribeEvent((a,r)=>{const c=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if((c==null?void 0:c.getUnitId())!==this._context.unitId)return;const l=a;if(l.ctrlKey){const A=Math.abs(l.deltaX);let d=A<40?.2:A<80?.4:.2;d*=l.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):l.preventDefault()}else n.onMouseWheel(l,r)}),new _.ScrollBar(n),t.addLayer(new _.Layer(t,[],wt),new _.Layer(t,[],ri)),this._addComponent();const i=()=>t.render();this.disposeWithMe(this._context.activated$.subscribe(a=>{a?e.runRenderLoop(i):e.stopRenderLoop(i)})),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene:t,unit:e,components:n}=this._context,r={pageMarginLeft:20,pageMarginTop:20},c=new _.Documents(de.MAIN,void 0,r);c.zIndex=xn;const l=new _.DocBackground(de.BACKGROUND,void 0,r);l.zIndex=xn,this._context.mainComponent=c,n.set(de.MAIN,c),n.set(de.BACKGROUND,l),t.addObjects([c],wt),t.addObjects([l],ai),this._editorService.getEditor(e.getUnitId())==null&&t.enableLayerCache(wt)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{this._create(t)})}_create(t){var l;if(!t)return;const{mainComponent:e,components:n}=this._context,i=e,a=n.get(de.BACKGROUND);i.changeSkeleton(t),a.changeSkeleton(t);const{unitId:r}=this._context,c=this._editorService.getEditor(r);if(this._editorService.isEditor(r)&&!(c!=null&&c.params.scrollBar)){(l=this._context.mainComponent)==null||l.makeDirty();return}this._recalculateSizeBySkeleton(t)}_initCommandListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:i}=n;this.reRender(i)}}))}_recalculateSizeBySkeleton(t){var g;const{mainComponent:e,scene:n,unitId:i,components:a}=this._context,r=e,c=a.get(de.BACKGROUND),l=(g=t.getSkeletonData())==null?void 0:g.pages;if(l==null)return;let A=0,d=0;const m=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let p=0,f=l.length;p<f;p++){const S=l[p];let{pageWidth:E,pageHeight:C}=S;if(m===s.DocumentFlavor.MODERN){const T=gd(S);E=T.pageWidth,C=T.pageHeight}r.pageLayoutType===_.PageLayoutType.VERTICAL?(d+=C,d+=r.pageMarginTop,p===f-1&&(d+=r.pageMarginTop),A=Math.max(A,E)):r.pageLayoutType===_.PageLayoutType.HORIZONTAL&&(A+=E,p!==f-1&&(A+=r.pageMarginLeft),d=Math.max(d,C))}r.resize(A,d),c.resize(A,d);const h=this._editorService.getEditor(i);(!this._editorService.isEditor(i)||h!=null&&h.params.scrollBar)&&n.resize(A,d)}},y.DocRenderController=hd([at(1,s.ICommandService),at(2,s.Inject(y.DocSelectionRenderService)),at(3,s.Inject(D.DocSkeletonManagerService)),at(4,le),at(5,_.IRenderManagerService),at(6,s.IUniverInstanceService)],y.DocRenderController);function gd(o){let{pageWidth:t,pageHeight:e}=o;const{marginLeft:n,marginRight:i,marginTop:a,marginBottom:r,skeDrawings:c,skeTables:l}=o;t===Number.POSITIVE_INFINITY&&(t=o.width+n+i),e===Number.POSITIVE_INFINITY&&(e=o.height+a+r);for(const A of c.values())t=Math.max(t,A.aLeft+A.width+n+i),e=Math.max(e,A.aTop+A.height+a+r);for(const A of l.values())t=Math.max(t,A.left+A.width+n+i),e=Math.max(e,A.top+A.height+a+r);return{pageWidth:t,pageHeight:e}}var md=Object.getOwnPropertyDescriptor,pd=(o,t,e,n)=>{for(var i=n>1?void 0:n?md(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Xo=(o,t)=>(e,n)=>t(e,n,o);let jo=class{constructor(o,t,e){B(this,"_docContainer");B(this,"getComponent",o=>{if(this._docContainer=o,!o.getContentRef().current)throw new Error("container is not ready")});B(this,"changeLocale",o=>{this._localeService.setLocale(o)});this._localeService=o,this._injector=t,this._configService=e}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(pn),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(o){if(this._docContainer)return o(this._docContainer)}getDocContainer(){return this._docContainer}};jo=pd([Xo(0,s.Inject(s.LocaleService)),Xo(1,s.Inject(s.Injector)),Xo(2,s.IConfigService)],jo);var fd=Object.getOwnPropertyDescriptor,Sd=(o,t,e,n)=>{for(var i=n>1?void 0:n?fd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Id=(o,t)=>(e,n)=>t(e,n,o);let fn=class extends s.RxDisposable{constructor(t){super();B(this,"_docContainerController");this._injector=t,this._docContainerController=this._injector.createInstance(jo)}};fn=Sd([Id(0,s.Inject(s.Injector))],fn);var vd=Object.getOwnPropertyDescriptor,Ed=(o,t,e,n)=>{for(var i=n>1?void 0:n?vd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Js=(o,t)=>(e,n)=>t(e,n,o);let Sn=class extends s.Disposable{constructor(o,t){super(),this._docAutoFormatService=o,this._renderManagerService=t,this._initListTabAutoFormat(),this._initSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ke.id,match:o=>{var i;const{selection:t,paragraphs:e,unit:n}=o;if(e.length===1&&t.startOffset===e[0].paragraphStart&&e[0].bullet){const a=(i=n.getBody())==null?void 0:i.paragraphs,r=a==null?void 0:a.filter(c=>{var l;return((l=c.bullet)==null?void 0:l.listId)===e[0].bullet.listId});return(r==null?void 0:r.findIndex(c=>c.startIndex===e[0].startIndex))!==0}else if(e.length>1&&e.some(a=>a.bullet))return!0;return!1},getMutations(o){const t=o.commandParams;return[{id:Yt.id,params:{type:t!=null&&t.shift?It.decrease:It.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ke.id,match:o=>{const{selection:t,unit:e}=o,{startNodePosition:n,endNodePosition:i}=t,a=this._renderManagerService.getRenderById(e.getUnitId()),r=a==null?void 0:a.with(D.DocSkeletonManagerService).getSkeleton();return r==null?!1:!!(n&&i&&Yi(r,n,i)||n&&!i&&n.path.indexOf("cells")>-1)},getMutations(o){const t=o.commandParams;return[{id:xo.id,params:{shift:!!(t!=null&&t.shift)}}]},priority:99}))}_initSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:dt.id,match:o=>{var a;const{selection:t,paragraphs:e,unit:n}=o;if(!t.collapsed||e.length!==1||!t.collapsed)return!1;const i=(a=n.getBody())==null?void 0:a.dataStream.slice(e[0].paragraphStart,t.startOffset-1);return!!(i&&(Object.keys(s.QuickListTypeMap).includes(i)||Object.keys(ro).includes(i)))},getMutations(o){var a;const{paragraphs:t,unit:e,selection:n}=o,i=(a=e.getBody())==null?void 0:a.dataStream.slice(t[0].paragraphStart,n.startOffset-1);if(i&&Object.keys(s.QuickListTypeMap).includes(i)){const r=s.QuickListTypeMap[i];return[{id:no.id,params:{listType:r,paragraph:t[0]}}]}if(i&&Object.keys(ro).includes(i)){const r=ro[i];return[{id:Xi.id,params:{value:r}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ze.id,match:o=>{const{paragraphs:t}=o;return!!(t.length===1&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},getMutations:o=>{const t=o.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:Yt.id,params:{type:It.decrease}}]:[{id:$e.id,params:{listType:o.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ze.id,match:()=>!0,getMutations(){return[{id:Qt.id}]},priority:-9999}))}};Sn=Ed([Js(0,s.Inject(y.DocAutoFormatService)),Js(1,_.IRenderManagerService)],Sn);function Cd(o){return o.rows[0].cells[0].sections[0].columns[0].lines[0]}function Td(o){const t=o.rows[o.rows.length-1],e=t.cells[t.cells.length-1];return _.getLastLine(e)}function yd(o,t){const{ed:e}=o,{skeTables:n}=t;let i=null;for(const a of n.values())if(a.st===e+1){i=a;break}return i}function Zs(o){const t=o==null?void 0:o.parent;let e=null,n=null;if(o==null||t==null)return{lineBeforeTable:e,lineAfterTable:n};const{st:i,ed:a}=o,r=t.type===_.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return _.lineIterator(r,c=>{c.st===a+1?n=c:c.ed===i-1&&(e=c)}),{lineBeforeTable:e,lineAfterTable:n}}function $s(o){return o.sections[0].columns[0].lines.length===0}function ea(o){var r,c;const t=o.parent,e=t==null?void 0:t.parent,n=e==null?void 0:e.tableId;if(t==null||e==null)return;const i=t.cells.indexOf(o);let a=e.rows[e.rows.indexOf(t)+1];if(a==null&&n.indexOf("#-#")){const[l,A]=n.split("#-#"),d=(c=(r=e.parent)==null?void 0:r.parent)==null?void 0:c.pages,u=`${l}#-#${Number.parseInt(A)+1}`;if(d)for(const m of d){const{skeTables:h}=m;if(h.has(u)){const g=h.get(u);if(g!=null&&g.rows.length){a=g.rows.find(p=>!p.isRepeatRow);break}}}}if(a!=null){const l=a.cells[i];return $s(l)?ea(l):l}}function ta(o){var a,r;const t=o.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;let n=e.rows[e.rows.indexOf(t)-1];const i=t.cells.indexOf(o);if((n==null||n.isRepeatRow)&&e.tableId.indexOf("#-#")){const[c,l]=e.tableId.split("#-#"),A=(r=(a=e.parent)==null?void 0:a.parent)==null?void 0:r.pages,d=`${c}#-#${Number.parseInt(l)-1}`;if(A)for(const u of A){const{skeTables:m}=u;if(m.has(d)){const h=m.get(d);if(h!=null&&h.rows.length){n=h.rows[h.rows.length-1];break}}}}if(n!=null){const c=n.cells[i];return $s(c)?ta(c):c}}function bd(o,t){const{st:e}=o,{skeTables:n}=t;let i=null;for(const a of n.values())if(a.ed===e-1){i=a;break}return i}function Od(o){return o.sections[0].columns[0].lines[0]}function Rd(o){const t=_.getLastColumn(o);return t.lines[t.lines.length-1]}var Md=Object.getOwnPropertyDescriptor,xd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Md(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},In=(o,t)=>(e,n)=>t(e,n,o);let vn=class extends s.Disposable{constructor(t,e,n,i){super();B(this,"_onInputSubscription");this._univerInstanceService=t,this._renderManagerService=e,this._textSelectionManagerService=n,this._commandService=i,this._commandExecutedListener()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_commandExecutedListener(){const t=[Oe.id,Re.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(!t.includes(e.id))return;const n=e.params;switch(e.id){case Oe.id:return this._handleMoveCursor(n.direction);case Re.id:return this._handleShiftMoveSelection(n.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(t){var C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),i=this._univerInstanceService.getCurrentUniverDocInstance();if(i==null)return;const a=(C=this._renderManagerService.getRenderById(i.getUnitId()))==null?void 0:C.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,direction:u,segmentId:m,startNodePosition:h,endNodePosition:g,segmentPage:p}=e;if(n.length>1){let v=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(const M of n)v=Math.min(v,M.startOffset),O=Math.max(O,M.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:t===s.Direction.LEFT||t===s.Direction.UP?O:v,endOffset:t===s.Direction.LEFT||t===s.Direction.UP?v:O,style:A}],!1);return}const f=d||u===s.RANGE_DIRECTION.FORWARD?c:l;let S=d||u===s.RANGE_DIRECTION.FORWARD?l:c;const E=(T=i.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)!=null?T:Number.POSITIVE_INFINITY;if(t===s.Direction.LEFT||t===s.Direction.RIGHT){const v=a.findNodeByCharIndex(S-1,m,p),O=a.findNodeByCharIndex(S,m,p);S=t===s.Direction.RIGHT?S+O.count:S-((R=v==null?void 0:v.count)!=null?R:0),S=Math.min(E-2,Math.max(0,S)),this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:S,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),S)}else{const v=a.findNodeByCharIndex(S,m,p),O=r.document.getOffsetConfig(),M=d?h:u===s.RANGE_DIRECTION.FORWARD?g:h,b=this._getTopOrBottomPosition(a,v,M,t===s.Direction.DOWN,!0);if(b==null){const x=t===s.Direction.UP?0:E-2;if(x===S)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:x,style:A}],!1);return}const N=new be(O,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:N.endOffset,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),N.endOffset)}}_handleMoveCursor(t){var E,C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),i=this._univerInstanceService.getCurrentUniverDocInstance();if(i==null)return!1;const a=(E=this._renderManagerService.getRenderById(i.getUnitId()))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null||n==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,segmentId:u,startNodePosition:m,endNodePosition:h,segmentPage:g}=e,p=i.getSelfOrHeaderFooterModel(u).getBody();if(p==null)return;const f=(C=p.dataStream.length)!=null?C:Number.POSITIVE_INFINITY,S=(T=i.getCustomRanges())!=null?T:[];if(t===s.Direction.LEFT||t===s.Direction.RIGHT){let v;if(!e.collapsed||n.length>1){let b=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(const x of n)b=Math.min(b,x.startOffset),N=Math.max(N,x.endOffset);v=t===s.Direction.LEFT?b:N}else{const b=a.findNodeByCharIndex(c-1,u,g),N=a.findNodeByCharIndex(c,u,g),x=a.findNodeByCharIndex(c+1,u,g);t===s.Direction.LEFT?v=Math.max(0,c-((R=b==null?void 0:b.count)!=null?R:1)):v=Math.min(f-2,l+N.count+((x==null?void 0:x.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK?1:0))}const O=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.SECTION_BREAK];if(t===s.Direction.LEFT)for(;O.includes(p.dataStream[v]);)v--;else for(;O.includes(p.dataStream[v]);)v++;S.filter(b=>b.wholeEntity&&b.startIndex<v&&b.endIndex>=v).forEach(b=>{t===s.Direction.LEFT?v=Math.min(b.startIndex,v):v=Math.max(b.endIndex+1,v)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,v),endOffset:Math.max(0,v),style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),v)}else{const v=a.findNodeByCharIndex(c,u,g),O=a.findNodeByCharIndex(l,u,g),M=r.document.getOffsetConfig(),b=this._getTopOrBottomPosition(a,t===s.Direction.UP||d?v:O,t===s.Direction.UP||d?m:h,t===s.Direction.DOWN);if(b==null){let x;d?x=t===s.Direction.UP?0:f-2:x=t===s.Direction.UP?c:l,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,x),endOffset:Math.max(0,x),style:A}],!1);return}const N=new be(M,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...N,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),N.endOffset)}}_getTopOrBottomPosition(t,e,n,i,a=!1){if(e==null||n==null)return;const r=this._getGlyphLeftOffsetInLine(e),c=this._getNextOrPrevLine(e,i,a);if(c==null)return;const l=this._matchPositionByLeftOffset(t,c,r,n);if(l!=null)return{...l,isBack:!0}}_getGlyphLeftOffsetInLine(t){const e=t.parent;if(e==null)return Number.NEGATIVE_INFINITY;const n=e.left,{left:i}=t;return n+i}_matchPositionByLeftOffset(t,e,n,i){const a={distance:Number.POSITIVE_INFINITY};for(const c of e.divides){const l=c.left;for(const A of c.glyphGroup){if(A.streamType===s.DataStreamTreeTokenType.SECTION_BREAK)continue;const{left:d}=A,u=l+d,m=Math.abs(n-u);m<a.distance&&(a.glyph=A,a.distance=m)}}if(a.glyph==null)return;const{segmentPage:r}=i;return t.findPositionByGlyph(a.glyph,r)}_getNextOrPrevLine(t,e,n=!1){var p,f,S,E,C,T,R,v,O,M,b,N;const i=t.parent,a=i==null?void 0:i.parent,r=a==null?void 0:a.parent,c=r==null?void 0:r.parent,l=c==null?void 0:c.parent;if(i==null||a==null||r==null||c==null||l==null)return;const A=r.lines.indexOf(a);if(A===-1)return;let d;if(l.type===_.DocumentSkeletonPageType.CELL&&n){const x=na(l,e);if(x)return x}if(e===!0){d=r.lines[A+1];const x=yd(a,l);if(x){const U=Cd(x);U&&(d=U)}}else{d=r.lines[A-1];const x=bd(a,l);if(x){const U=Td(x);U&&(d=U)}}if(d!=null)return d;const u=c.columns.indexOf(r);if(u===-1)return;if(e===!0)d=(p=c.columns[u+1])==null?void 0:p.lines[0];else{const x=(S=(f=c.columns)==null?void 0:f[u-1])==null?void 0:S.lines;d=x==null?void 0:x[x.length-1]}if(d!=null)return d;const m=l.sections.indexOf(c);if(m===-1)return;if(e===!0)d=(C=(E=l.sections[m-1])==null?void 0:E.columns[0])==null?void 0:C.lines[0];else{const x=(R=(T=l.sections)==null?void 0:T[m-1])==null?void 0:R.columns,U=x==null?void 0:x[x.length-1],F=U==null?void 0:U.lines;d=F==null?void 0:F[F.length-1]}if(d!=null)return d;if(l.type===_.DocumentSkeletonPageType.CELL)return na(l,e);const h=l.parent;if(h==null)return;const g=h.pages.indexOf(l);if(g!==-1){if(e===!0)d=(M=(O=(v=h.pages[g+1])==null?void 0:v.sections[0])==null?void 0:O.columns[0])==null?void 0:M.lines[0];else{const x=(b=h.pages[g-1])==null?void 0:b.sections;if(x==null)return;const U=(N=x[x.length-1])==null?void 0:N.columns,F=U[U.length-1],V=F==null?void 0:F.lines;d=V[V.length-1]}if(d!=null)return d}}_scrollToFocusNodePosition(t,e){var i;const n=(i=this._renderManagerService.getRenderById(t))==null?void 0:i.with(y.DocBackScrollRenderController);n!=null&&n.scrollToRange({startOffset:e,endOffset:e,collapsed:!0})}_getDocObject(){return ci(this._univerInstanceService,this._renderManagerService)}};vn=xd([In(0,s.IUniverInstanceService),In(1,_.IRenderManagerService),In(2,s.Inject(D.DocSelectionManagerService)),In(3,s.ICommandService)],vn);function na(o,t){var n,i;let e=null;if(t===!0){const a=ea(o);if(a)e=Od(a);else{const r=(n=o.parent)==null?void 0:n.parent,{lineAfterTable:c}=Zs(r);c&&(e=c)}}else{const a=ta(o);if(a)e=Rd(a);else{const r=(i=o.parent)==null?void 0:i.parent,{lineBeforeTable:c}=Zs(r);c&&(e=c)}}return e}const Dd=({handleRowColChange:o,tableCreateParams:t})=>{const e=I.useDependency(s.LocaleService),[n,i]=w.useState(3),[a,r]=w.useState(5);function c(l,A){i(l),r(A),o(l,A)}return w.useEffect(()=>{i(t.rowCount),r(t.colCount)},[t]),P.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2",children:[P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.rowCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:n,onChange:l=>{c(l,a)}})]}),P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.colCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:a,onChange:l=>{c(n,l)}})]})]})};var Bd=Object.getOwnPropertyDescriptor,_d=(o,t,e,n)=>{for(var i=n>1?void 0:n?Bd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},oa=(o,t)=>(e,n)=>t(e,n,o);let En=class extends s.Disposable{constructor(o,t){super(),this._commandService=o,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[ln].forEach(o=>this.disposeWithMe(this._commandService.registerCommand(o)))}_initCustomComponents(){const o=this._componentManager;this.disposeWithMe(o.register(ts,Dd))}_init(){}};En=_d([oa(0,s.ICommandService),oa(1,s.Inject(I.ComponentManager))],En);var Nd=Object.getOwnPropertyDescriptor,Pd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Nd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Cn=(o,t)=>(e,n)=>t(e,n,o);let Ko=class extends s.Disposable{constructor(o,t,e,n,i){super(),this._context=o,this._docSkeletonManagerService=t,this._commandService=e,this._docEventManagerService=n,this._textSelectionManagerService=i,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(o=>{const t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(to.id,{index:o.paragraph.startIndex,segmentId:o.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(o=>{o?this._context.mainComponent.setCursor(_.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(_.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(o,t,e,n){const{documentTransform:i}=o.getOffsetConfig(),a=t.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(a)return i.clone().invert().applyPoint(a)}};Ko=Pd([Cn(1,s.Inject(D.DocSkeletonManagerService)),Cn(2,s.ICommandService),Cn(3,s.Inject(y.DocEventManagerService)),Cn(4,s.Inject(D.DocSelectionManagerService))],Ko);var wd=Object.getOwnPropertyDescriptor,Ud=(o,t,e,n)=>{for(var i=n>1?void 0:n?wd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},_t=(o,t)=>(e,n)=>t(e,n,o);let Tn=class extends s.RxDisposable{constructor(o,t,e,n,i,a){super(),this._context=o,this._commandService=t,this._docClipboardService=e,this._docSelectionRenderService=n,this._contextService=i,this._editorService=a,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var o;(o=this._docSelectionRenderService)==null||o.onPaste$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{var c,l,A;if(!jt(this._contextService))return;t.event.preventDefault();const e=t.event;let n=(c=e.clipboardData)==null?void 0:c.getData(I.HTML_CLIPBOARD_MIME_TYPE);const i=(l=e.clipboardData)==null?void 0:l.getData(I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE),a=[...((A=e.clipboardData)==null?void 0:A.items)||[]].filter(d=>I.imageMimeTypeSet.has(d.type)).map(d=>d.getAsFile()).filter(d=>!!d);this._editorService.getEditor(this._context.unitId)&&(n!=null?n:"").indexOf("</table>")>-1&&(n=""),this._docClipboardService.legacyPaste({html:n,text:i,files:a})})}};Tn=Ud([_t(1,s.ICommandService),_t(2,De),_t(3,s.Inject(y.DocSelectionRenderService)),_t(4,s.IContextService),_t(5,le)],Tn);var Ld=Object.getOwnPropertyDescriptor,Qd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ld(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ia=(o,t)=>(e,n)=>t(e,n,o);const Fd=[s.DEFAULT_EMPTY_DOCUMENT_VALUE,s.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY];let zo=class extends s.Disposable{constructor(o,t,e){super(),this._context=o,this._contextMenuService=t,this._commandService=e,Fd.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,n;const t=((n=(e=this._context)==null?void 0:e.mainComponent)==null?void 0:n.onPointerDown$).subscribeEvent(i=>{i.button===2&&this._contextMenuService.triggerContextMenu(i,I.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(t)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(o=>{o.id===D.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}};zo=Qd([ia(1,I.IContextMenuService),ia(2,s.ICommandService)],zo);var Hd=Object.getOwnPropertyDescriptor,kd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Hd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},rt=(o,t)=>(e,n)=>t(e,n,o);let yn=class extends s.Disposable{constructor(t,e,n,i,a,r,c){super();B(this,"_initialEditors",new Set);this._context=t,this._univerInstanceService=e,this._editorService=n,this._commandService=i,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._renderManagerService=c,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach(t=>{const e=t.getEditorId();e===this._context.unitId&&(this._initialEditors.has(e)||(this._initialEditors.add(e),this._resize(e)))}),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(t){if(t==null)return;const e=this._editorService.getEditor(t);if((e==null?void 0:e.cancelDefaultResizeListener)===!0)return;const n=this._univerInstanceService.getUniverDocInstance(t);if(!n)return;const i=this._docSkeletonManagerService.getSkeleton();if(e==null||e.render==null||i==null||n==null)return;i.calculate();const{marginTop:a=0,marginBottom:r=0,marginLeft:c=0,marginRight:l=0}=n.getSnapshot().documentStyle,{scene:A,mainComponent:d}=e.render;let{actualHeight:u,actualWidth:m}=i.getActualSize();u+=a+r,m+=c+l;const{width:h,height:g}=e.getBoundingClientRect(),p=Math.max(m,h),f=Math.max(u,g);A.transformByState({width:p,height:f}),d==null||d.resize(p,f)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{const{unitId:t}=this._context,e=this._editorService.getEditor(t),n=this._editorService.getFocusEditor();e==null||e.isSheetEditor()||n&&n.getEditorId()===t||t.includes("range_selector")||t.includes("embedding_formula_editor")||this._editorService.blur()}))}_initialFocus(){const t=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe(L.fromEvent(window,"mousedown").subscribe(n=>{const a=n.target.classList[0]||"";s.checkForSubstrings(a,t)&&n.stopPropagation()}));const e=new s.DisposableCollection;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{if(e.dispose(),!n)return;const i=n.getUnitId(),a=this._renderManagerService.getRenderById(i),r=a==null?void 0:a.engine.getCanvas().getCanvasEle();if(r==null)return;const c=L.fromEvent(r,"mousedown").subscribe(l=>{l.stopPropagation()});e.add(c)})),this.disposeWithMe(()=>e.dispose())}_commandExecutedListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:i}=n;if(this._editorService.isSheetEditor(i)||i!==this._context.unitId)return;const a=this._editorService.getEditor(i);a&&!a.params.scrollBar&&this._resize(i)}}))}};yn=kd([rt(1,s.IUniverInstanceService),rt(2,le),rt(3,s.ICommandService),rt(4,s.Inject(y.DocSelectionRenderService)),rt(5,s.Inject(D.DocSkeletonManagerService)),rt(6,_.IRenderManagerService)],yn);var Vd=Object.getOwnPropertyDescriptor,Wd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Vd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},bn=(o,t)=>(e,n)=>t(e,n,o);let Yo=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_previousIMEContent","");B(this,"_isCompositionStart",!0);B(this,"_onStartSubscription");B(this,"_onUpdateSubscription");B(this,"_onEndSubscription");this._context=t,this._docSelectionRenderService=e,this._docImeInputManagerService=n,this._docSkeletonManagerService=i,this._commandService=a,this._initialize()}dispose(){var t,e,n;(t=this._onStartSubscription)==null||t.unsubscribe(),(e=this._onUpdateSubscription)==null||e.unsubscribe(),(n=this._onEndSubscription)==null||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(t=>{if(t==null)return;this._resetIME();const{activeRange:e}=t;e!=null&&this._docImeInputManagerService.setActiveRange(s.Tools.deepClone(e))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(t=>{this._updateContent(t,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(t=>{this._updateContent(t,!1)})}async _updateContent(t,e){if(t==null)return;const n=this._context.unitId,i=this._docSkeletonManagerService.getSkeleton(),{event:a,activeRange:r}=t;if(i==null||r==null)return;const l=a.data;l===this._previousIMEContent&&e||(await this._commandService.executeCommand(Jn.id,{unitId:n,newText:l,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!e}),e?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=l):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}};Yo=Wd([bn(1,s.Inject(y.DocSelectionRenderService)),bn(2,s.Inject(ft)),bn(3,s.Inject(D.DocSkeletonManagerService)),bn(4,s.ICommandService)],Yo);var Gd=Object.getOwnPropertyDescriptor,Xd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Gd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},On=(o,t)=>(e,n)=>t(e,n,o);let qo=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_onInputSubscription");this._context=t,this._docSelectionRenderService=e,this._docSkeletonManagerService=n,this._commandService=i,this._docMenuStyleService=a,this._init()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async t=>{var f,S;if(t==null)return;const{unitId:e}=this._context,{event:n,content:i="",activeRange:a}=t,r=n,c=this._docSkeletonManagerService.getSkeleton();if(r.data==null||c==null||a==null)return;const{segmentId:l}=a,d=this._context.unit.getSelfOrHeaderFooterModel(l).getBody(),u=this._docMenuStyleService.getDefaultStyle(),m=this._docMenuStyleService.getStyleCache(),h=Dn((f=d==null?void 0:d.customRanges)!=null?f:[],a.endOffset,s.SHEET_EDITOR_UNITS.includes(e)),g=Ut(d,a.endOffset,u,m,s.SHEET_EDITOR_UNITS.includes(e)),p=Bn((S=d==null?void 0:d.customDecorations)!=null?S:[],a.endOffset);await this._commandService.executeCommand(Qn.id,{unitId:e,body:{dataStream:i,textRuns:g?[{...g,st:0,ed:i.length}]:[],customRanges:h?[{...h,startIndex:0,endIndex:i.length-1}]:[],customDecorations:p.map(E=>({...E,startIndex:0,endIndex:i.length-1}))},range:a,segmentId:l}),i===" "&&await this._commandService.executeCommand(dt.id)})}};qo=Xd([On(1,s.Inject(y.DocSelectionRenderService)),On(2,s.Inject(D.DocSkeletonManagerService)),On(3,s.ICommandService),On(4,s.Inject(ve))],qo);class Jo extends s.Disposable{constructor(t){super(),this._context=t}calculatePagePosition(){var T,R;const t=Ie(this._context),n=(R=(T=this._context.unit.getSettings())==null?void 0:T.zoomRatio)!=null?R:1,{document:i,scene:a,docBackground:r}=t,c=a==null?void 0:a.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:u}=i;if(c==null||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;const{width:m,height:h}=c;let g=0,p=u,f=0,S=0,E=Number.POSITIVE_INFINITY;m>(l+d*2)*n?(g=m/2-l*n/2,g/=n,f=(m-d*2)/n,E=0):(g=d,f=l+d*2,E=(f-m/n)/2),h>A?S=(h-u*2)/n:S=A+u*2,a.resize(f,S),m<=1&&(g=-1e4,p=-1e4),i.translate(g,p),r.translate(g,p);const C=a.getViewport(ae.VIEW_MAIN);return E!==Number.POSITIVE_INFINITY&&C!=null&&C.scrollToViewportPos({viewportScrollX:E}),this}}var jd=Object.getOwnPropertyDescriptor,Kd=(o,t,e,n)=>{for(var i=n>1?void 0:n?jd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},sa=(o,t)=>(e,n)=>t(e,n,o);let Zo=class extends s.Disposable{constructor(o,t,e){super(),this._context=o,this._docPageLayoutService=t,this._textSelectionManagerService=e;const n=this._context.unitId;if(s.isInternalEditorID(n)&&n!==s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(o=>o.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),L.throttleTime(0,L.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}};Zo=Kd([sa(1,s.Inject(Jo)),sa(2,s.Inject(D.DocSelectionManagerService))],Zo);var zd=Object.getOwnPropertyDescriptor,Yd=(o,t,e,n)=>{for(var i=n>1?void 0:n?zd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ct=(o,t)=>(e,n)=>t(e,n,o);let $o=class extends s.Disposable{constructor(t,e,n,i,a,r,c){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=i,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._docSelectionManagerService=c,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(t=>{if(t==null)return;const{unitId:e,docRanges:n,isEditing:i,options:a}=t;e===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,i,a))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(t=>{t!=null&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(t,{unitId:this._context.unitId,subUnitId:this._context.unitId})}))}_initialMain(t){const e=Ie(this._context),{document:n,scene:i}=e;this.disposeWithMe(n.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(t)||(n.cursor=_.CURSOR_TYPE.TEXT)})),this.disposeWithMe(n.onPointerLeave$.subscribeEvent(()=>{n.cursor=_.CURSOR_TYPE.DEFAULT,i.resetCursor()})),this.disposeWithMe(n.onPointerDown$.subscribeEvent((a,r)=>{if(this._isEditorReadOnly(t))return;const c=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);(c==null?void 0:c.getUnitId())!==t&&this._instanceSrv.setCurrentUnitForType(t);const l=this._docSkeletonManagerService.getSkeleton(),{offsetX:A,offsetY:d}=a,u=this._getTransformCoordForDocumentOffset(A,d);if(u!=null){const{pageLayoutType:m=_.PageLayoutType.VERTICAL,pageMarginLeft:h,pageMarginTop:g}=n.getOffsetConfig(),{editArea:p}=l.findEditAreaByCoord(u,m,h,g),f=this._docSkeletonManagerService.getViewModel(),S=f.getEditArea();S!==_.DocumentEditArea.BODY&&p!==_.DocumentEditArea.BODY&&p!==S&&f.setEditArea(p)}if(this._docSelectionRenderService.__onPointDown(a),this._editorService.getEditor(t)){this._setEditorFocus(t);const{offsetX:m,offsetY:h}=a;setTimeout(()=>{t===this._editorService.getFocusId()||this._docSelectionRenderService.isOnPointerEvent||(this._setEditorFocus(t),this._docSelectionRenderService.setCursorManually(m,h))},0)}a.button!==2&&r.stopPropagation()})),this.disposeWithMe(n.onDblclick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleDblClick(a)})),this.disposeWithMe(n.onTripleClick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleTripleClick(a)}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:i,scene:a}=n,{documentTransform:r}=i.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_setEditorFocus(t){this._editorService.focus(t)}_commandExecutedListener(){const t=[ue.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var n;if(t.includes(e.id)){const i=e.params,{unitId:a}=i,r=(n=this._docSelectionManagerService.__getCurrentSelection())==null?void 0:n.unitId;if(a!==r)return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(!t)return;const{unitId:e}=this._context;if(!s.isInternalEditorID(e)){this._docSelectionRenderService.focus();const a=this._context.unit.getSnapshot(),r=Is(a);this._docSelectionManagerService.replaceDocRanges([{startOffset:r,endOffset:r}],{unitId:e,subUnitId:e},!1)}}))}};$o=Yd([ct(1,s.ICommandService),ct(2,le),ct(3,s.IUniverInstanceService),ct(4,s.Inject(y.DocSelectionRenderService)),ct(5,s.Inject(D.DocSkeletonManagerService)),ct(6,s.Inject(D.DocSelectionManagerService))],$o);var qd=Object.getOwnPropertyDescriptor,Jd=(o,t,e,n)=>{for(var i=n>1?void 0:n?qd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Fe=(o,t)=>(e,n)=>t(e,n,o);let ei=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super();B(this,"_isSheetEditor",!1);this._context=t,this._contextService=e,this._docSkeletonManagerService=n,this._univerInstanceService=i,this._commandService=a,this._textSelectionManagerService=r,this._editorService=c,this._docPageLayoutService=l,this._renderManagerService=A,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),this._isSheetEditor=this._context.unitId===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY;const d=this._univerInstanceService.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_SHEET),u=d&&this._renderManagerService.getRenderById(d.getUnitId());setTimeout(()=>this.updateViewZoom(u&&this._isSheetEditor?u.scene.scaleX:1,!0),20),s.isInternalEditorID(this._context.unitId)||this._initZoomEventListener()}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const{unitId:e,scene:n}=this._context;this._editorService.isEditor(e)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(i=>{if(!i.ctrlKey||!this._contextService.getContextValue(s.FOCUSING_DOC))return;const a=this._univerInstanceService.getCurrentUniverDocInstance();if(!a)return;const{documentFlavor:r}=a.getSnapshot().documentStyle;if(r===s.DocumentFlavor.MODERN)return;const c=Math.abs(i.deltaX);let l=c<40?.2:c<80?.4:.2;l*=i.deltaY>0?-1:1,n.scaleX<1&&(l/=2);const A=a.zoomRatio;let d=+Number.parseFloat(`${A+l}`).toFixed(1);d=d>=4?4:d<=.1?.1:d,this._commandService.executeCommand(bt.id,{zoomRatio:d,unitId:a.getUnitId()}),i.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const e=this._univerInstanceService.getCurrentUniverDocInstance();e&&setTimeout(()=>{const n=this._univerInstanceService.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_SHEET),i=n&&this._renderManagerService.getRenderById(n.getUnitId()),a=this._isSheetEditor?(i==null?void 0:i.scene.scaleX)||1:e.zoomRatio;this.updateViewZoom(a,!1)})}))}_initCommandExecutedListener(){const t=[ue.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)&&e.params.unitId===this._context.unitId){const i=this._context.unit.zoomRatio||1;this.updateViewZoom(i)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{e.id===Rt.id&&this._commandService.executeCommand(bt.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(t,e=!0){var i;const n=Ie(this._context);n.scene.scale(t,t),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),e&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),(i=n.scene.getTransformer())==null||i.clearSelectedObjects()}_initZoomEventListener(){const t=this._context.scene;this.disposeWithMe(t.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey)return;const n=Math.abs(e.deltaX);let i=n<40?.2:n<80?.4:.2;i*=e.deltaY>0?-1:1,t.scaleX<1&&(i/=2);const a=this._context.unit.zoomRatio;let r=+Number.parseFloat(`${a+i}`).toFixed(1);r=r>=4?4:r<=.1?.1:r,this._commandService.executeCommand(bt.id,{zoomRatio:Math.round(r*10)/10,documentId:this._context.unitId}),e.preventDefault()}))}};ei=Jd([Fe(1,s.IContextService),Fe(2,s.Inject(D.DocSkeletonManagerService)),Fe(3,s.IUniverInstanceService),Fe(4,s.ICommandService),Fe(5,s.Inject(D.DocSelectionManagerService)),Fe(6,le),Fe(7,s.Inject(Jo)),Fe(8,_.IRenderManagerService)],ei);const Zd=s.createInterceptorKey("PRINTING_COMPONENT_COLLECT"),$d=s.createInterceptorKey("PRINTING_DOM_COLLECT");class aa extends s.Disposable{constructor(){super();B(this,"_printComponentMap",new Map);B(this,"interceptor",new s.InterceptorManager({PRINTING_COMPONENT_COLLECT:Zd,PRINTING_DOM_COLLECT:$d}));this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:e=>e}))}registerPrintComponent(e,n){this._printComponentMap.set(e,n)}getPrintComponent(e){return this._printComponentMap.get(e)}}var eA=Object.getOwnPropertyDescriptor,tA=(o,t,e,n)=>{for(var i=n>1?void 0:n?eA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Nt=(o,t)=>(e,n)=>t(e,n,o);const ra=300;y.DocStateChangeManagerService=class extends s.RxDisposable{constructor(e,n,i,a,r){super();B(this,"_docStateChange$",new L.BehaviorSubject(null));B(this,"docStateChange$",this._docStateChange$.asObservable());B(this,"_historyStateCache",new Map);B(this,"_changeStateCache",new Map);B(this,"_historyTimer",null);B(this,"_changeStateCacheTimer",null);this._undoRedoService=e,this._commandService=n,this._univerInstanceService=i,this._docStateEmitService=a,this._renderManagerService=r,this._initialize(),this._listenDocStateChange()}getStateCache(e){var n,i;return{history:(n=this._historyStateCache.get(e))!=null?n:[],collaboration:(i=this._changeStateCache.get(e))!=null?i:[]}}setStateCache(e,n){this._historyStateCache.set(e,n.history),this._changeStateCache.set(e,n.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===s.UndoCommandId||e.id===s.RedoCommandId){const n=this._univerInstanceService.getCurrentUniverDocInstance();if(n==null)return;const i=n.getUnitId();this._pushHistory(i),this._emitChangeState(i)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe(L.takeUntil(this.dispose$)).subscribe(e=>{var l;if(e==null)return;const{isCompositionEnd:n,isSync:i,syncer:a,...r}=e,c=(l=this._renderManagerService.getRenderById(i?a:e.unitId))==null?void 0:l.with(ft);if(c!=null){if(n){const A=c.fetchComposedUndoRedoMutationParams();if(A==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:d,redoMutationParams:u,previousActiveRange:m}=A;r.redoState.actions=u.actions,r.undoState.actions=d.actions,r.undoState.textRanges=[m]}this._setChangeState(r)}})}_cacheChangeState(e,n="history"){const{trigger:i,unitId:a,noHistory:r,debounce:c=!1}=e;if(r||i==null||n==="history"&&(i===s.RedoCommandId||i===s.UndoCommandId))return;const l=n==="history"?this._historyStateCache:this._changeStateCache,A=n==="history"?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(l.has(a)){const d=l.get(a);d==null||d.push(e)}else l.set(a,[e]);c?n==="history"?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{A(a)},ra)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{A(a)},ra)):A(a)}_pushHistory(e){const n=this._undoRedoService,i=this._historyStateCache.get(e);if(!Array.isArray(i)||i.length===0)return;const a=i.length,r=i[0].commandId,c=i[0],l=i[a-1],A={unitId:e,actions:i.reduce((u,m)=>s.JSONX.compose(u,m.redoState.actions),null),textRanges:l.redoState.textRanges},d={unitId:e,actions:i.reverse().reduce((u,m)=>s.JSONX.compose(u,m.undoState.actions),null),textRanges:c.undoState.textRanges};n.pushUndoRedo({unitID:e,undoMutations:[{id:r,params:d}],redoMutations:[{id:r,params:A}]}),i.length=0}_emitChangeState(e){const n=this._changeStateCache.get(e);if(!Array.isArray(n)||n.length===0)return;const i=n.length,{commandId:a,trigger:r,segmentId:c,noHistory:l,debounce:A}=n[0],d=n[0],u=n[i-1],m={unitId:e,actions:n.reduce((p,f)=>s.JSONX.compose(p,f.redoState.actions),null),textRanges:u.redoState.textRanges},h={unitId:e,actions:n.reverse().reduce((p,f)=>s.JSONX.compose(p,f.undoState.actions),null),textRanges:d.undoState.textRanges},g={commandId:a,unitId:e,trigger:r,redoState:m,undoState:h,segmentId:c,noHistory:l,debounce:A};n.length=0,this._docStateChange$.next(g)}},y.DocStateChangeManagerService=tA([Nt(0,s.Inject(s.IUndoRedoService)),Nt(1,s.ICommandService),Nt(2,s.IUniverInstanceService),Nt(3,s.Inject(D.DocStateEmitService)),Nt(4,_.IRenderManagerService)],y.DocStateChangeManagerService);var nA=Object.getOwnPropertyDescriptor,oA=(o,t,e,n)=>{for(var i=n>1?void 0:n?nA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ca=(o,t)=>(e,n)=>t(e,n,o);const la="univer-doc-main-canvas";y.DocsRenderService=class extends s.RxDisposable{constructor(t,e){super(),this._instanceSrv=t,this._renderManagerService=e,this._init()}_init(){this._renderManagerService.createRender$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderWithId(t)),this._instanceSrv.getAllUnitsForType(s.UniverInstanceType.UNIVER_DOC).forEach(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitAdded$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitDisposed$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._disposeRenderer(t))}_createRenderer(t){var i;const e=t.getUnitId(),n=(i=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:i.getUnitId();this._renderManagerService.created$.subscribe(a=>{a.unitId===n&&(a.engine.getCanvas().setId(la),a.engine.getCanvas().getContext().setId(la))}),this._renderManagerService.has(e)||this._createRenderWithId(e)}_createRenderWithId(t){this._renderManagerService.createRender(t)}_disposeRenderer(t){const e=t.getUnitId();this._renderManagerService.removeRender(e)}},y.DocsRenderService=oA([ca(0,s.IUniverInstanceService),ca(1,_.IRenderManagerService)],y.DocsRenderService);const iA={id:ze.id,preconditions:ol,binding:I.KeyCode.ENTER},sA={id:ht.id,preconditions:ee,binding:I.KeyCode.BACKSPACE},aA={id:Hn.id,preconditions:ee,binding:I.KeyCode.DELETE},rA={id:Oe.id,binding:I.KeyCode.ARROW_UP,preconditions:ee,staticParameters:{direction:s.Direction.UP}},cA={id:Oe.id,binding:I.KeyCode.ARROW_DOWN,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},lA={id:Oe.id,binding:I.KeyCode.ARROW_LEFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},dA={id:Oe.id,binding:I.KeyCode.ARROW_RIGHT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},AA={id:Re.id,binding:I.KeyCode.ARROW_UP|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.UP}},uA={id:Re.id,binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},hA={id:Re.id,binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},gA={id:Re.id,binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},mA={id:qn.id,binding:I.KeyCode.A|I.MetaKeys.CTRL_COMMAND,preconditions:o=>o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&(o.getContextValue(s.FOCUSING_DOC)||o.getContextValue(s.EDITOR_ACTIVATED))};var pA=Object.defineProperty,fA=Object.getOwnPropertyDescriptor,SA=(o,t,e)=>t in o?pA(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,IA=(o,t,e,n)=>{for(var i=n>1?void 0:n?fA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Pt=(o,t)=>(e,n)=>t(e,n,o),vA=(o,t,e)=>SA(o,t+"",e);y.UniverDocsUIPlugin=class extends s.Plugin{constructor(t=Ws,e,n,i,a,r){super(),this._config=t,this._injector=e,this._renderManagerSrv=n,this._commandService=i,this._logService=a,this._configService=r;const{menu:c,...l}=s.merge({},Ws,this._config);c&&this._configService.setConfig("menu",c,{merge:!0}),this._configService.setConfig(pn,l),this._initDependencies(e),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),s.touchDependencies(this._injector,[[y.DocStateChangeManagerService],[y.DocsRenderService]])}onRendered(){this._initUI(),this._initRenderModules(),s.touchDependencies(this._injector,[[Sn],[vn],[st],[En],[y.DocUIController]])}_initCommand(){[ht,Hn,Be,_e,Ne,Pe,Ee,we,he,Ue,Ce,Ze,Te,ye,Qt,Qn,Ye,Wt,Fn,Gt,pi,ue,tt,et,$e,Et,Ct,Tt,ge,yt,pt,bo,Mo,sn,an,es,rn,cn,nn,on,it,Lo,xo,ke,dt,ze,Yt,St,vt,to,no,Jn,Rt,pe,Ln,Ve,Hi,$n,ki,bt,qn,Vo,Oe,Re,Wi,eo,Gi,ce,Xi,kn,Kn,zn,co,lo,Ao,uo,ho,qt,ji,Ki,io,so,ao,Yn,Bs,Fo].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))}),[mt,Kt,zt].forEach(t=>this.disposeWithMe(this._commandService.registerMultipleCommand(t)))}_initializeShortcut(){[rA,cA,dA,lA,AA,uA,hA,gA,mA,sA,aA,iA,sl].forEach(t=>{this._injector.get(I.IShortcutService).registerShortcut(t)})}_initDependencies(t){s.mergeOverrideWithDependencies([[aa],[Tn],[yn],[y.DocUIController],[Sn],[En],[vn],[fn],[st],[le,{useClass:y.EditorService}],[De,{useClass:Xn}],[y.DocCanvasPopManagerService],[y.DocsRenderService],[y.DocStateChangeManagerService],[y.DocAutoFormatService],[ve]],this._config.override).forEach(n=>t.add(n))}_markDocAsFocused(){const t=this._injector.get(s.IUniverInstanceService),e=this._injector.get(le);try{const n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!n)return;const i=n.getUnitId();e.isEditor(i)||t.focusUnit(n.getUnitId())}catch(n){this._logService.warn(n)}}_initUI(){this._injector.get(fn)}_initRenderBasics(){[[D.DocSkeletonManagerService],[y.DocSelectionRenderService],[D.DocInterceptorService],[Jo],[ft],[y.DocRenderController],[ei]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}_initRenderModules(){[[y.DocEventManagerService],[gn],[mn],[y.DocBackScrollRenderController],[$o],[No],[Zo],[zo],[Ko],[Tn],[qo],[Yo],[yn]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}},vA(y.UniverDocsUIPlugin,"pluginName",si),y.UniverDocsUIPlugin=IA([s.DependentOn(_.UniverRenderEnginePlugin),Pt(1,s.Inject(s.Injector)),Pt(2,_.IRenderManagerService),Pt(3,s.ICommandService),Pt(4,s.ILogService),Pt(5,s.IConfigService)],y.UniverDocsUIPlugin);function da(o,t,e){const n=I.useDependency(s.ICommandService),i=I.useDependency(I.IShortcutService),a=w.useMemo(()=>s.generateRandomId(4),[]);w.useEffect(()=>{if(!e||!o||!t)return;const c=`sheet.operation.editor-${e.getEditorId()}-keyboard-${a}`,l=new s.DisposableCollection;return l.add(n.registerCommand({id:c,type:s.CommandType.OPERATION,handler(A,d){const{keyCode:u,metaKey:m}=d;t.handler(u,m)}})),t.keyCodes.map(A=>({id:c,binding:A.metaKey?A.keyCode|A.metaKey:A.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:A.keyCode,metaKey:A.metaKey}})).forEach(A=>{l.add(i.registerShortcut(A))}),()=>{l.dispose()}},[n,t,e,o,a,i])}const Aa=(o,t=!0,e,n)=>{const i=w.useCallback(()=>{if(o){const{scene:r,mainComponent:c}=o.render,l=o.render.with(D.DocSkeletonManagerService),{width:A,height:d}=o.getBoundingClientRect();l.getViewModel().getDataModel().updateDocumentDataPageSize(t?1/0:A,1/0),r.transformByState({width:A,height:d}),c==null||c.resize(A,d)}},[o,t]),a=w.useMemo(()=>s.debounce(()=>{var E,C;if(!e||!o||!e)return;const c=o.render.with(D.DocSkeletonManagerService).getSkeleton(),{scene:l,mainComponent:A}=o.render,d=l.getViewport(ae.VIEW_MAIN),{actualWidth:u,actualHeight:m}=c.getActualSize(),{width:h,height:g}=o.getBoundingClientRect();let p=d==null?void 0:d.getScrollBar();const f=Math.max(u,h),S=Math.max(m,g);l.transformByState({width:f,height:S}),A==null||A.resize(f,S),t?u>h?(p==null?d&&new _.ScrollBar(d,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:1/0,y:0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(C=d==null?void 0:d.getScrollBar())==null||C.dispose()):m>g?(p==null?d&&(p=new _.ScrollBar(d,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:0,y:1/0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(E=d==null?void 0:d.getScrollBar())==null||E.dispose())},30),[o,e,t,n]);return w.useEffect(()=>{if(e&&o){const r=setTimeout(()=>{i(),a()},500);return()=>{clearTimeout(r)}}},[o,e,i,a]),w.useEffect(()=>{if(e&&o){const r=o.input$.subscribe(()=>{a()});return()=>{r.unsubscribe()}}},[o,e,a]),{resize:i,checkScrollBar:a}};function EA(o){const{editorId:t,initialValue:e,container:n,autoFocus:i,isSingle:a}=o,r=w.useMemo(()=>i!=null?i:!1,[]),[c,l]=w.useState(),A=I.useDependency(le);return w.useLayoutEffect(()=>{var d,u;if(n.current){const m=typeof e=="string"?void 0:s.Tools.deepClone(e),h={body:{dataStream:typeof e=="string"?`${e}\r
`:`\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...m,documentStyle:{...m==null?void 0:m.documentStyle,pageSize:{width:a?1/0:n.current.clientWidth,height:1/0}},id:t},g=A.register({autofocus:!0,editorUnitId:t,initialSnapshot:h},n.current),p=A.getEditor(t);if(l(p),r){p.focus();const f=((u=(d=h.body)==null?void 0:d.dataStream.length)!=null?u:2)-2;p.setSelectionRanges([{startOffset:f,endOffset:f}])}return()=>{g==null||g.dispose()}}},[]),c}const CA=(o,t,e,n)=>{const i=I.useDependency(s.ICommandService),a=I.useDependency(I.IShortcutService),r=w.useRef(t);r.current=t;const c=w.useRef(n);c.current=n,w.useEffect(()=>{if(!e||!o)return;const A=`sheet.formula-embedding-editor.${e.getEditorId()}`,d=new s.DisposableCollection,u=(h,g)=>{if(c.current){c.current(h,g);return}let p=s.Direction.LEFT;h===I.KeyCode.ARROW_DOWN?p=s.Direction.DOWN:h===I.KeyCode.ARROW_UP?p=s.Direction.UP:h===I.KeyCode.ARROW_RIGHT&&(p=s.Direction.RIGHT),g===I.MetaKeys.SHIFT?i.executeCommand(Re.id,{direction:p}):i.executeCommand(Oe.id,{direction:p})};return d.add(i.registerCommand({id:A,type:s.CommandType.OPERATION,handler(h,g){const{keyCode:p}=g;u(p)}})),[{keyCode:I.KeyCode.ARROW_DOWN},{keyCode:I.KeyCode.ARROW_LEFT},{keyCode:I.KeyCode.ARROW_RIGHT},{keyCode:I.KeyCode.ARROW_UP},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT}].map(({keyCode:h,metaKey:g})=>({id:A,binding:g?h|g:h,preconditions:()=>!0,priority:900,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:h}})).forEach(h=>{d.add(a.registerShortcut(h))}),()=>{d.dispose()}},[i,e,o,a])};function TA(o,t){const e=I.useDependency(s.ICommandService);w.useEffect(()=>{if(!o)return;const n=e.onCommandExecuted(i=>{var a,r;if(i.id===D.RichTextEditingMutation.id){if(i.params.unitId!==o.getEditorId())return;const l=o.getDocumentData();t(l,s.getPlainText((r=(a=l.body)==null?void 0:a.dataStream)!=null?r:""))}});return()=>{n.dispose()}},[o,t,e])}const yA=o=>{var W;const{className:t,autoFocus:e,onFocusChange:n,initialValue:i,onClickOutside:a,keyboardEventConfig:r,moveCursor:c=!0,style:l,isSingle:A,editorId:d,onHeightChange:u,onChange:m,defaultHeight:h=32,maxHeight:g=32,icon:p,editorRef:f,placeholder:S}=o,E=I.useDependency(le),C=I.useEvent(n),T=I.useEvent(a),[R,v]=w.useState(h),O=w.useRef(null),M=w.useMemo(()=>d!=null?d:s.createInternalEditorID(`RICH_TEXT_EDITOR-${s.generateRandomId(4)}`),[d]),b=EA({editorId:M,initialValue:i,container:O,autoFocus:e,isSingle:A}),x=I.useDependency(_.IRenderManagerService).getRenderById(M),U=x==null?void 0:x.with(y.DocSelectionRenderService),F=I.useObservable(U==null?void 0:U.textSelectionInner$),V=!!((W=U==null?void 0:U.isFocusing)!=null&&W&&(F!=null&&F.textRanges.some(G=>G.collapsed))),H=w.useRef(null),[Q,j]=w.useState(()=>{var G,K;return!s.BuildTextUtils.transform.getPlainText((K=(G=b==null?void 0:b.getDocumentData().body)==null?void 0:G.dataStream)!=null?K:"")}),{checkScrollBar:X}=Aa(b,A,!0,!0);w.useLayoutEffect(()=>{if(!(!f||!b)){if(typeof f=="function"){f(b);return}f.current=b}},[b]);const k=I.useEvent(G=>{var q,z;const K=x==null?void 0:x.with(D.DocSkeletonManagerService),Y=K==null?void 0:K.getSkeleton().getActualSize();Y&&(u==null||u(Y.actualHeight),v(Math.max(h,Math.min(Y.actualHeight+10,g)))),m==null||m(G,s.getPlainText((z=(q=G.body)==null?void 0:q.dataStream)!=null?z:"")),X()});return w.useEffect(()=>{var K,Y;j(!s.BuildTextUtils.transform.getPlainText((Y=(K=b==null?void 0:b.getDocumentData().body)==null?void 0:K.dataStream)!=null?Y:""));const G=b==null?void 0:b.selectionChange$.subscribe(()=>{var q,z;j(!s.BuildTextUtils.transform.getPlainText((z=(q=b==null?void 0:b.getDocumentData().body)==null?void 0:q.dataStream)!=null?z:""))});return()=>G==null?void 0:G.unsubscribe()},[b]),I.useObservable(b==null?void 0:b.blur$),I.useObservable(b==null?void 0:b.focus$),w.useEffect(()=>{var K,Y;const G=b==null?void 0:b.getDocumentData();C==null||C(V,s.getPlainText((Y=(K=G==null?void 0:G.body)==null?void 0:K.dataStream)!=null?Y:""))},[V,C]),w.useEffect(()=>{const G=Y=>{var z,$;E.getFocusId()!==M||(($=(z=Y.target)==null?void 0:z.dataset)==null?void 0:$.editorid)===M||H.current&&!H.current.contains(Y.target)&&(T==null||T())},K=setTimeout(()=>{document.addEventListener("click",G)},100);return()=>{document.removeEventListener("click",G),clearTimeout(K)}},[b,M,E,T]),CA(V&&c,!1,b),da(V,r,b),TA(b,k),P.jsx("div",{className:t,style:l,children:P.jsxs("div",{className:J.clsx("univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2 univer-pt-1.5",J.borderClassName,{"univer-border-primary-500":V}),style:{height:R},ref:H,children:[P.jsx("div",{ref:O,className:"univer-relative univer-size-full",onMouseUp:()=>b==null?void 0:b.focus()}),p,Q?P.jsx("div",{className:"univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",children:S}):null]})})};y.AfterSpaceCommand=dt,y.AlignCenterCommand=Ct,y.AlignJustifyCommand=yt,y.AlignLeftCommand=Et,y.AlignOperationCommand=ge,y.AlignRightCommand=Tt,y.BreakLineCommand=Qt,y.BulletListCommand=et,y.ChangeListNestingLevelCommand=Yt,y.ChangeListNestingLevelType=It,y.ChangeListTypeCommand=St,y.CheckListCommand=vt,y.CoverContentCommand=ki,y.CreateDocTableCommand=bo,y.CutContentCommand=Ve,y.DOCS_COMPONENT_BACKGROUND_LAYER_INDEX=ai,y.DOCS_COMPONENT_DEFAULT_Z_INDEX=xn,y.DOCS_COMPONENT_HEADER_LAYER_INDEX=ri,y.DOCS_COMPONENT_MAIN_LAYER_INDEX=wt,y.DOCS_VIEW_KEY=de,y.DOC_UI_PLUGIN_NAME=si,y.DOC_VERTICAL_PADDING=Ho,y.DefaultDocContainerConfig=ii,y.DefaultToolbarConfig=oi,y.DeleteCommand=Ye,y.DeleteCustomBlockCommand=Wt,y.DeleteLeftCommand=ht,y.DeleteRightCommand=Hn,y.DocCopyCommand=mt,y.DocCreateTableOperation=ln,y.DocCutCommand=Kt,y.DocIMEInputManagerService=ft,y.DocPasteCommand=zt,y.DocPrintInterceptorService=aa,y.DocSelectAllCommand=qn,y.DocTableDeleteColumnsCommand=on,y.DocTableDeleteRowsCommand=nn,y.DocTableDeleteTableCommand=it,y.DocTableInsertColumnCommand=es,y.DocTableInsertColumnLeftCommand=rn,y.DocTableInsertColumnRightCommand=cn,y.DocTableInsertRowAboveCommand=sn,y.DocTableInsertRowBellowCommand=an,y.DocTableInsertRowCommand=Mo,y.DocTableTabCommand=xo,y.DocsUIMenuSchema=Ys,y.Editor=vs,y.EditorInsertTextCommandId=mi,y.EnterCommand=ze,y.HorizontalLineCommand=pt,y.IDocClipboardService=De,y.IEditorService=le,y.IMEInputCommand=Jn,y.InnerPasteCommand=Ln,y.InsertCommand=Qn,y.InsertCustomRangeCommand=Gi,y.ListOperationCommand=$e,y.MergeTwoParagraphCommand=Gt,y.MoveCursorOperation=Oe,y.MoveSelectionOperation=Re,y.NORMAL_TEXT_SELECTION_PLUGIN_NAME=pa,y.NodePositionConvertToCursor=be,y.NodePositionConvertToRectRange=vo,y.OrderListCommand=tt,y.PastePluginLark=vi,y.PastePluginUniver=Ci,y.PastePluginWord=Ti,y.QuickListCommand=no,y.RectRange=Co,y.ReplaceContentCommand=Hi,y.ReplaceSelectionCommand=eo,y.ReplaceSnapshotCommand=$n,y.ReplaceTextRunsCommand=Wi,y.ResetInlineFormatTextBackgroundColorCommand=Ze,y.RichTextEditor=yA,y.SetDocZoomRatioCommand=bt,y.SetDocZoomRatioOperation=ue,y.SetInlineFormatBoldCommand=Be,y.SetInlineFormatCommand=ye,y.SetInlineFormatFontFamilyCommand=Ue,y.SetInlineFormatFontSizeCommand=he,y.SetInlineFormatItalicCommand=_e,y.SetInlineFormatStrikethroughCommand=Pe,y.SetInlineFormatSubscriptCommand=Ee,y.SetInlineFormatSuperscriptCommand=we,y.SetInlineFormatTextBackgroundColorCommand=Te,y.SetInlineFormatTextColorCommand=Ce,y.SetInlineFormatUnderlineCommand=Ne,y.SetParagraphNamedStyleCommand=ce,y.SwitchDocModeCommand=Rt,y.TEXT_RANGE_LAYER_INDEX=Zt,y.TabCommand=ke,y.TextRange=We,y.ToggleCheckListCommand=to,y.UpdateCommand=Fn,y.VIEWPORT_KEY=ae,y.addCustomDecorationBySelectionFactory=Sa,y.addCustomDecorationFactory=li,y.calcDocRangePositions=hn,y.convertBodyToHtml=bi,y.convertPositionsToRectRanges=en,y.deleteCustomDecorationFactory=Ia,y.docDrawingPositionToTransform=Ea,y.genTableSource=wn,y.generateParagraphs=Nn,y.getAnchorBounding=Ot,y.getCanvasOffsetByEngine=Zi,y.getCommandSkeleton=re,y.getCursorWhenDelete=Xt,y.getCustomBlockIdsInSelections=hi,y.getCutActionsFromDocRanges=gi,y.getDocObject=ci,y.getDocObjectById=fa,y.getEmptyTableCell=Ht,y.getEmptyTableRow=kt,y.getLineBounding=$t,y.getOneTextSelectionRange=po,y.getRichTextEditPath=Z,y.getTableColumn=Vt,y.hasParagraphInTable=va,y.isInSameTableCell=So,y.isValidRectRange=zi,y.neoGetDocObject=Ie,y.transformToDocDrawingPosition=Ca,y.useKeyboardEvent=da,y.useResize=Aa,y.whenDocAndEditorFocused=ee,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})}));


// @univerjs/docs-ui/facade
(function(n,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("@univerjs/core"),require("@univerjs/core/facade"),require("@univerjs/docs-ui"),require("@univerjs/engine-render")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/core/facade","@univerjs/docs-ui","@univerjs/engine-render"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.UniverDocsUiFacade={},n.UniverCore,n.UniverCoreFacade,n.UniverDocsUi,n.UniverEngineRender))})(this,(function(n,e,a,v,h){"use strict";var D=Object.defineProperty;var U=(n,e,a)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var m=(n,e,a)=>U(n,typeof e!="symbol"?e+"":e,a);var _=Object.getOwnPropertyDescriptor,g=(o,t,r,i)=>{for(var s=i>1?void 0:i?_(t,r):t,c=o.length-1,u;c>=0;c--)(u=o[c])&&(s=u(s)||s);return s},d=(o,t)=>(r,i)=>t(r,i,o);n.FDocument=class{constructor(t,r,i,s,c,u){m(this,"id");this._documentDataModel=t,this._injector=r,this._univerInstanceService=i,this._commandService=s,this._resourceManagerService=c,this._renderManagerService=u,this.id=this._documentDataModel.getUnitId()}getId(){return this._documentDataModel.getUnitId()}getName(){return this.getSnapshot().title||""}getSnapshot(){const t=this._resourceManagerService.getResourcesByType(this.id,e.UniverInstanceType.UNIVER_DOC),r=this._documentDataModel.getSnapshot();return r.resources=t,r}undo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.executeCommand(e.UndoCommand.id)}redo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.executeCommand(e.RedoCommand.id)}appendText(t){const r=this.id,{body:i}=this.getSnapshot();if(!i)throw new Error("The document body is empty");const s=i.dataStream.length-2,c={startOffset:s,endOffset:s,collapsed:!0,segmentId:""},{segmentId:u}=c;return this._commandService.executeCommand(v.InsertCommand.id,{unitId:r,body:{dataStream:t},range:c,segmentId:u})}setSelection(t,r){var s;const i=(s=this._renderManagerService.getRenderById(this.getId()))==null?void 0:s.with(v.DocSelectionRenderService);i==null||i.removeAllRanges(),i==null||i.addDocRanges([{startOffset:t,endOffset:r,rangeType:e.DOC_RANGE_TYPE.TEXT}],!0)}},n.FDocument=g([d(1,e.Inject(e.Injector)),d(2,e.IUniverInstanceService),d(3,e.ICommandService),d(4,e.IResourceManagerService),d(5,h.IRenderManagerService)],n.FDocument);class I extends a.FUniver{createUniverDoc(t){const r=this._univerInstanceService.createUnit(e.UniverInstanceType.UNIVER_DOC,t);return this._injector.createInstance(n.FDocument,r)}getActiveDocument(){const t=this._univerInstanceService.getCurrentUnitForType(e.UniverInstanceType.UNIVER_DOC);return t?this._injector.createInstance(n.FDocument,t):null}getUniverDoc(t){const r=this._univerInstanceService.getUniverDocInstance(t);return r?this._injector.createInstance(n.FDocument,r):null}}a.FUniver.extend(I),Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));


// index
(function(e,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("@univerjs/docs"),require("@univerjs/docs-ui"),require("@univerjs/engine-formula"),require("@univerjs/engine-render"),require("@univerjs/network"),require("@univerjs/ui"),require("@univerjs/network/lib/facade"),require("@univerjs/docs-ui/lib/facade")):typeof define=="function"&&define.amd?define(["exports","@univerjs/docs","@univerjs/docs-ui","@univerjs/engine-formula","@univerjs/engine-render","@univerjs/network","@univerjs/ui","@univerjs/network/lib/facade","@univerjs/docs-ui/lib/facade"],n):(e=typeof globalThis<"u"?globalThis:e||self,n(e.UniverPresetDocsCore={},e.UniverDocs,e.UniverDocsUi,e.UniverEngineFormula,e.UniverEngineRender,e.UniverNetwork,e.UniverUi))})(this,(function(e,n,i,r,u,o,s){"use strict";function t(v={}){const{container:d="app",header:c,footer:f,toolbar:U,ribbonType:j,menu:a,contextMenu:g,disableAutoFocus:p}=v;return{plugins:[o.UniverNetworkPlugin,n.UniverDocsPlugin,u.UniverRenderEnginePlugin,[s.UniverUIPlugin,{container:d,header:c,footer:f,toolbar:U,ribbonType:j,menu:a,contextMenu:g,disableAutoFocus:p}],i.UniverDocsUIPlugin,r.UniverFormulaEnginePlugin]}}e.UniverDocsCorePreset=t,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
