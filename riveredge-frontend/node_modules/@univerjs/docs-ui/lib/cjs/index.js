"use strict";var ps=Object.defineProperty;var fs=(o,t,e)=>t in o?ps(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var M=(o,t,e)=>fs(o,typeof t!="symbol"?t+"":t,e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const i=require("@univerjs/core"),D=require("@univerjs/docs"),B=require("@univerjs/engine-render"),I=require("@univerjs/ui"),ao=require("@univerjs/drawing"),U=require("rxjs"),P=require("react"),ht=require("rxjs/operators"),N=require("react/jsx-runtime"),q=require("@univerjs/design");var Ss=Object.getOwnPropertyDescriptor,Is=(o,t,e,n)=>{for(var r=n>1?void 0:n?Ss(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},or=(o,t)=>(e,n)=>t(e,n,o);exports.DocAutoFormatService=class extends i.Disposable{constructor(e,n){super();M(this,"_matches",new Map);this._univerInstanceService=e,this._textSelectionManagerService=n}registerAutoFormat(e){const n=this._matches.get(e.id);return n?(n.push(e),n.sort((r,s)=>{var a,c;return((a=s.priority)!=null?a:0)-((c=r.priority)!=null?c:0)})):this._matches.set(e.id,[e]),i.toDisposable(()=>{const r=this._matches.get(e.id);if(r){const s=r.findIndex(a=>a===e);s>=0&&r.splice(s,1)}})}onAutoFormat(e,n){var l,A,d,u,m,g,h,p,f;const r=(l=this._matches.get(e))!=null?l:[],s=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),a=this._textSelectionManagerService.getDocRanges(),c=(A=a.find(S=>S.isActive))!=null?A:a[0];if(s&&c){const S=s.getSelfOrHeaderFooterModel(c.segmentId),E={unit:S,selection:c,isBody:!c.segmentId,paragraphs:i.BuildTextUtils.range.getParagraphsInRange(c,(u=(d=S.getBody())==null?void 0:d.paragraphs)!=null?u:[],(g=(m=S.getBody())==null?void 0:m.dataStream)!=null?g:""),customRanges:i.BuildTextUtils.customRange.getCustomRangesInterestsWithSelection(c,(p=(h=S.getBody())==null?void 0:h.customRanges)!=null?p:[]),commandId:e,commandParams:n},C=r.find(T=>T.match(E));return(f=C==null?void 0:C.getMutations(E))!=null?f:[]}return[]}};exports.DocAutoFormatService=Is([or(0,i.IUniverInstanceService),or(1,i.Inject(D.DocSelectionManagerService))],exports.DocAutoFormatService);const Yr={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},qr={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},Jr="DOC_UI_PLUGIN";var le=(o=>(o.MAIN="__Document_Render_Main__",o.BACKGROUND="__Document_Render_Background__",o))(le||{}),ie=(o=>(o.VIEW_MAIN="viewMain",o.VIEW_TOP="viewTop",o.VIEW_LEFT="viewLeft",o.VIEW_LEFT_TOP="viewLeftTop",o))(ie||{});const Zr=0,kt=2,$r=4,Hn=10,vs="normalTextSelectionPluginName";function Ie(o){const{mainComponent:t,scene:e,engine:n,components:r}=o,s=t,a=r.get(le.BACKGROUND);return{document:s,docBackground:a,scene:e,engine:n}}function ei(o,t){const e=o.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC);if(!e)return null;const n=e.getUnitId(),r=t.getRenderById(n);if(r==null)return;const{mainComponent:s,scene:a,engine:c,components:l}=r,A=s,d=l.get(le.BACKGROUND);return{document:A,docBackground:d,scene:a,engine:c}}function Es(o,t){const e=t.getRenderById(o);if(e==null)return;const{mainComponent:n,scene:r,engine:s,components:a}=e,c=n,l=a.get(le.BACKGROUND);return{document:c,docBackground:l,scene:r,engine:s}}function ti(o){const{unitId:t,ranges:e,id:n,type:r,segmentId:s}=o,a={id:D.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0,segmentId:s}},c=i.JSONX.getInstance(),l=i.BuildTextUtils.customDecoration.add({ranges:e,id:n,type:r});return a.params.actions=c.editOp(l.serialize()),a}function Cs(o,t){const{segmentId:e,id:n,type:r,unitId:s}=t,a=o.get(D.DocSelectionManagerService),c=o.get(i.IUniverInstanceService),l=s?c.getUnit(s,i.UniverInstanceType.UNIVER_DOC):c.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if(!l)return!1;const A=l.getUnitId(),d=a.getTextRanges({unitId:A,subUnitId:A});return!d||!l.getBody()?!1:ti({unitId:A,ranges:d,id:n,type:r,segmentId:e})}function Ts(o,t){const{unitId:e,id:n,segmentId:r}=t,a=o.get(i.IUniverInstanceService).getUnit(e);if(!a)return!1;const c={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:void 0,segmentId:r}},l=i.BuildTextUtils.customDecoration.delete({id:n,segmentId:r,documentDataModel:a});if(!l)return!1;const A=i.JSONX.getInstance();return c.params.actions=A.editOp(l.serialize()),c}function ys(o,t){return t.some(e=>o.startIndex>e.startIndex&&o.startIndex<e.endIndex)}function sn(o,t,e,n,r){const{textRuns:s=[],dataStream:a}=o,c=r&&a.startsWith("="),l={st:0,ed:0,ts:{}};if(c)return l;for(let A=s.length-1;A>=0;A--){const d=s[A],{st:u,ed:m}=d;t>u&&t<=m&&(l.st=u,l.ed=m,l.ts={...l.ts,...d.ts})}if(t===0){const A=s==null?void 0:s[0];A&&A.st===0&&(l.ts={...l.ts,...A.ts})}return n&&(l.ts={...l.ts,...n}),l}function co(o,t,e){if(e){const r=o.find(s=>t>=s.startIndex&&t<=s.endIndex+1);return r!=null&&r.wholeEntity?null:r}const n=o.find(r=>t>r.startIndex&&t<=r.endIndex);return n!=null&&n.wholeEntity?null:n}function lo(o,t){return o.filter(e=>t>e.startIndex&&t<=e.endIndex)}function bs(o){return{left:o.positionH.posOffset,top:o.positionV.posOffset,width:o.size.width,height:o.size.height}}function Rs(o,t=0,e=0){return{size:{width:o.width,height:o.height},positionH:{relativeFrom:i.ObjectRelativeFromH.MARGIN,posOffset:(o.left||0)-t},positionV:{relativeFrom:i.ObjectRelativeFromV.PAGE,posOffset:(o.top||0)-e},angle:o.angle||0}}const xs="doc.command.tab",We={id:xs,type:i.CommandType.COMMAND,async handler(o,t){const n=o.get(exports.DocAutoFormatService).onAutoFormat(We.id,t);return(await i.sequenceExecuteAsync(n,o.get(i.ICommandService))).result}},Os="doc.command.after-space",Ct={id:Os,type:i.CommandType.COMMAND,async handler(o){const e=o.get(exports.DocAutoFormatService).onAutoFormat(Ct.id);return(await i.sequenceExecuteAsync(e,o.get(i.ICommandService))).result}},$e={id:"doc.command.enter",type:i.CommandType.COMMAND,async handler(o){const e=o.get(exports.DocAutoFormatService).onAutoFormat($e.id);return(await i.sequenceExecuteAsync(e,o.get(i.ICommandService))).result}};var Ms=Object.getOwnPropertyDescriptor,Ds=(o,t,e,n)=>{for(var r=n>1?void 0:n?Ms(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},On=(o,t)=>(e,n)=>t(e,n,o);const Bs=11,_s=9,Pt={ff:"Arial",fs:Bs};let Ce=class extends i.Disposable{constructor(t,e,n){super();M(this,"_cacheStyle",null);this._textSelectionManagerService=t,this._univerInstanceService=e,this._renderManagerService=n,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){var a;const t=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if(t==null)return{...Pt};const e=t==null?void 0:t.getUnitId(),n=(a=this._renderManagerService.getRenderById(e))==null?void 0:a.with(D.DocSkeletonManagerService),r=n==null?void 0:n.getViewModel();return r==null?{...Pt}:r.getEditArea()===B.DocumentEditArea.BODY?{...Pt}:{...Pt,fs:_s}}setStyleCache(t){this._cacheStyle={...this._cacheStyle,...t}}_clearStyleCache(){this._cacheStyle=null}};Ce=Ds([On(0,i.Inject(D.DocSelectionManagerService)),On(1,i.IUniverInstanceService),On(2,B.IRenderManagerService)],Ce);function ae(o,t){var n;return(n=o.get(B.IRenderManagerService).getRenderById(t))==null?void 0:n.with(D.DocSkeletonManagerService)}function J(o,t=""){if(!t)return["body"];const{headers:e,footers:n}=o.getSnapshot();if(e==null&&n==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[t])!=null)return["headers",t,"body"];if((n==null?void 0:n[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}function Ao(o,t,e){const n=[];for(let r=0,s=o.length;r<s;r++)o[r]===i.DataStreamTreeTokenType.PARAGRAPH&&n.push({startIndex:r});if(t)for(const r of n)t.bullet&&(r.bullet=i.Tools.deepClone(t.bullet)),t.paragraphStyle&&(r.paragraphStyle=i.Tools.deepClone(t.paragraphStyle),delete r.paragraphStyle.borderBottom,t.paragraphStyle.headingId&&(r.paragraphStyle.headingId=i.generateRandomId(6)));if(e)for(const r of n)r.paragraphStyle||(r.paragraphStyle={}),r.paragraphStyle.borderBottom=e;return n}const an={id:"doc.command.break-line",type:i.CommandType.COMMAND,handler:(o,t)=>{var L,G,W,H,V;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),s=o.get(Ce),a=(L=t==null?void 0:t.textRange)!=null?L:e.getActiveTextRange(),c=e.getRectRanges();if(a==null)return!1;if(c&&c.length){const{startOffset:j}=a;return e.replaceDocRanges([{startOffset:j,endOffset:j}]),!0}const{horizontalLine:l}=t!=null?t:{},{segmentId:A}=a,d=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A!=null?A:"").getBody();if(d==null||u==null)return!1;const m=d.getUnitId(),{startOffset:g,endOffset:h}=a,f=((G=u.paragraphs)!=null?G:[]).find(j=>j.startIndex>=g);if(!f)return!1;const S=g===f.startIndex,E=f.startIndex,C=s.getDefaultStyle(),T=s.getStyleCache(),R=sn(u,h,C,T),v={dataStream:i.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Ao(i.DataStreamTreeTokenType.PARAGRAPH,f,l),textRuns:[{st:0,ed:1,ts:{...R.ts}}]};if(d==null)return!1;const b=e.getActiveTextRange();if(u==null)return!1;const{collapsed:x}=a,y=v.dataStream.length,_=[{startOffset:g+y,endOffset:g+y,style:b==null?void 0:b.style,collapsed:x}],O={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:_,debounce:!0}},w=new i.TextX,Q=i.JSONX.getInstance();if(x)g>0&&w.push({t:i.TextXActionType.RETAIN,len:g}),w.push({t:i.TextXActionType.INSERT,body:v,len:v.dataStream.length});else{const j=i.BuildTextUtils.selection.delete([a],u,0,v);w.push(...j)}(((W=f.bullet)==null?void 0:W.listType)===i.PresetListType.CHECK_LIST_CHECKED||(H=f.paragraphStyle)!=null&&H.headingId)&&(a.endOffset<E&&w.push({t:i.TextXActionType.RETAIN,len:E-a.endOffset}),w.push({t:i.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...f,paragraphStyle:{...f.paragraphStyle,...S?{headingId:void 0,namedStyleType:void 0}:null},startIndex:0,bullet:(V=f.paragraphStyle)!=null&&V.headingId?void 0:{...f.bullet,listType:i.PresetListType.CHECK_LIST}}]},coverType:i.UpdateDocsAttributeType.REPLACE})),O.params.textRanges=[{startOffset:g+y,endOffset:g+y,collapsed:x}];const k=J(d,A);return O.params.actions=Q.editOp(w.serialize(),k),!!r.syncExecuteCommand(O.id,O.params)}};var cn=(o=>(o[o.ABOVE=0]="ABOVE",o[o.BELLOW=1]="BELLOW",o))(cn||{}),uo=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(uo||{});function Ns(o,t){let e=i.DataStreamTreeTokenType.TABLE_START;const n=[],r=[];for(let s=0;s<o;s++){e+=i.DataStreamTreeTokenType.TABLE_ROW_START;for(let a=0;a<t;a++)e+=`${i.DataStreamTreeTokenType.TABLE_CELL_START}\r
${i.DataStreamTreeTokenType.TABLE_CELL_END}`,n.push({startIndex:e.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),r.push({startIndex:e.length-2});e+=i.DataStreamTreeTokenType.TABLE_ROW_END}return e+=i.DataStreamTreeTokenType.TABLE_END,{dataStream:e,paragraphs:n,sectionBreaks:r}}function ln(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function dn(o){const t=ln();return{tableCells:[...new Array(o).fill(null).map(()=>i.Tools.deepClone(t))],trHeight:{val:{v:30},hRule:i.TableRowHeightRule.AUTO}}}function An(o){return{size:{type:i.TableSizeType.SPECIFIED,width:{v:o}}}}function go(o,t,e){const n=An(e/t),r=dn(t),s=[...new Array(o).fill(null).map(()=>i.Tools.deepClone(r))],a=[...new Array(t).fill(null).map(()=>i.Tools.deepClone(n))],c=i.generateRandomId(6);return{tableRows:s,tableColumns:a,tableId:c,align:i.TableAlignmentType.START,indent:{v:0},textWrap:i.TableTextWrapType.NONE,position:{positionH:{relativeFrom:i.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:i.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:i.TableSizeType.UNSPECIFIED,width:{v:e}}}}function Tt(o,t){if(!o&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const r="";for(const s of t){const{startOffset:a,endOffset:c,segmentId:l}=s;a==null||c==null||l==null||(e=Math.min(e,a),n=Math.max(n,c))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:r}}else if(o){const{startOffset:e,endOffset:n,segmentId:r}=o;return e==null||n==null||r==null?null:{startOffset:e,endOffset:n,segmentId:r}}}function Ps(o){let t=i.DataStreamTreeTokenType.TABLE_ROW_START;const e=[],n=[];for(let r=0;r<o;r++)t+=`${i.DataStreamTreeTokenType.TABLE_CELL_START}\r
${i.DataStreamTreeTokenType.TABLE_CELL_END}`,e.push({startIndex:t.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:t.length-2});return t+=i.DataStreamTreeTokenType.TABLE_ROW_END,{dataStream:t,paragraphs:e,sectionBreaks:n}}function ws(){const o=`${i.DataStreamTreeTokenType.TABLE_CELL_START}\r
${i.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],e=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),e.push({startIndex:2}),{dataStream:o,paragraphs:t,sectionBreaks:e}}function Us(o,t,e){var u,m,g;const{startOffset:n,endOffset:r,segmentId:s}=o,a=e.getSelfOrHeaderFooterViewModel(s),c=t===0?n:r;let l=null;const A=(g=(m=(u=e.getBody())==null?void 0:u.tables)==null?void 0:m.find(h=>c>=h.startIndex&&c<=h.endIndex))==null?void 0:g.tableId;let d=0;for(const h of a.getChildren()){for(const p of h.children){const{children:f}=p,S=f[0];if(S){for(const E of S.children)if(E.startIndex<=c&&c<=E.endIndex){d=S.children.indexOf(E),l=E;break}}if(l)break}if(l)break}return l==null||A==null?null:{offset:t===0?l.startIndex:l.endIndex+1,colCount:l.children.length,tableId:A,insertRowIndex:t===0?d:d+1}}function Ls(o,t,e){var g,h,p;const{startOffset:n,endOffset:r,segmentId:s}=o,a=e.getSelfOrHeaderFooterViewModel(s),c=t===0?n:r,l=(p=(h=(g=e.getBody())==null?void 0:g.tables)==null?void 0:h.find(f=>c>=f.startIndex&&c<=f.endIndex))==null?void 0:p.tableId,A=[];let d=null,u=-1;for(const f of a.getChildren()){for(const S of f.children){const{children:E}=S,C=E[0];if(C){if(c<C.startIndex||c>C.endIndex)continue;d=C;for(const T of C.children){for(const R of T.children){const v=T.children.indexOf(R);if(c>=R.startIndex&&c<=R.endIndex){u=v;break}}if(u!==-1)break}}if(d)break}if(d)break}if(d==null||l==null||u===-1)return null;let m=0;for(const f of d.children){const S=f.children[u],E=t===0?S.startIndex:S.endIndex+1;A.push(E-m),m=E}return{offsets:A,tableId:l,columnIndex:u,rowCount:d.children.length}}function Qs(o,t,e){const n=[];let r=t[e].size.width.v,s=0;for(let a=0;a<t.length;a++)s+=t[a].size.width.v;s+=r;for(let a=0;a<t.length;a++)n.push(t[a].size.width.v/s*o);return r=r/s*o,{widths:n,newColWidth:r}}function ni(o,t){var m,g,h;const{startOffset:e,endOffset:n,segmentId:r}=o,s=t.getSelfOrHeaderFooterViewModel(r),a=(h=(g=(m=t.getBody())==null?void 0:m.tables)==null?void 0:g.find(p=>e>=p.startIndex&&n<=p.endIndex))==null?void 0:h.tableId,c=[];let l=-1,A=0,d=-1,u=!1;for(const p of s.getChildren()){for(const f of p.children){const{children:S}=f,E=S[0];if(E){if(e<E.startIndex||n>E.endIndex)continue;d=E.startIndex+3;for(const C of E.children){const T=E.children.indexOf(C),{startIndex:R,endIndex:v}=C;e>=R&&e<=v?(l=R,c.push(T),A+=v-R+1):(R>e&&v<n||n>=R&&n<=v)&&(c.push(T),A+=v-R+1),c.length===E.children.length&&(u=!0)}}if(c.length)break}if(c.length)break}return a==null||c.length===0?null:{tableId:a,rowIndexes:c,offset:l,len:A,cursor:d,selectWholeTable:u}}function Fs(o,t){var h,p,f;const{startOffset:e,endOffset:n,segmentId:r}=o,s=t.getSelfOrHeaderFooterViewModel(r),a=(f=(p=(h=t.getBody())==null?void 0:h.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null;const A=[];let d=-1,u=-1,m=-1;for(const S of s.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children)for(const v of R.children){const b=R.children.indexOf(v);e>=v.startIndex&&e<=v.endIndex&&(u=b),n>=v.startIndex&&n<=v.endIndex&&(m=b)}}if(l)break}if(l)break}if(l==null||a==null)return null;for(let S=u;S<=m;S++)A.push(S);let g=0;for(const S of l.children){const E=S.children[u],C=S.children[m];c.push({retain:E.startIndex-g,delete:C.endIndex-E.startIndex+1}),g=C.endIndex+1}return d=l.startIndex+3,{offsets:c,tableId:a,columnIndexes:A,cursor:d,selectWholeTable:A.length===l.children[0].children.length,rowCount:l.children.length}}function oi(o,t){var d,u,m;const{startOffset:e,endOffset:n,segmentId:r}=o,s=t.getSelfOrHeaderFooterViewModel(r),a=(m=(u=(d=t.getBody())==null?void 0:d.tables)==null?void 0:u.find(g=>e>=g.startIndex&&n<=g.endIndex))==null?void 0:m.tableId;let c=-1,l=0,A=-1;for(const g of s.getChildren()){for(const h of g.children){const{children:p}=h,f=p[0];if(f){if(e<f.startIndex||n>f.endIndex)continue;c=f.startIndex,l=f.endIndex-f.startIndex+1,A=f.startIndex}if(f)break}if(l>0)break}return a==null?null:{tableId:a,offset:c,len:l,cursor:A}}function Hs(o,t){var h,p,f;const{startOffset:e,endOffset:n,segmentId:r}=o,s=t.getSelfOrHeaderFooterViewModel(r),a=(f=(p=(h=t.getBody())==null?void 0:h.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null,A=-1,d=-1,u=-1,m=-1;for(const S of s.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children){const v=T.children.indexOf(R);for(const b of R.children){const x=R.children.indexOf(b);e>=b.startIndex&&e<=b.endIndex&&(d=v,u=x),n>=b.startIndex&&n<=b.endIndex&&(m=x)}}}if(l)break}if(l)break}if(l==null||a==null||d===-1)return null;const g=l.children[d];for(let S=u;S<=m;S++){const E=g.children[S];c.push({retain:E.startIndex+1,delete:E.endIndex-E.startIndex-3})}return A=l.startIndex+3,{offsets:c,tableId:a,cursor:A,rowCount:l.children.length}}var kn=(o=>(o[o.NEXT=0]="NEXT",o[o.PREV=1]="PREV",o))(kn||{});function rr(o,t,e){const{startOffset:n}=t;let r=null;for(const A of o.getChildren()){for(const d of A.children){const u=d.children[0];if(u&&n>u.startIndex&&n<u.endIndex){r=u;break}}if(r)break}if(r==null)return null;let s=-1,a=-1,c=null;for(const A of r.children){for(const d of A.children)if(n>d.startIndex&&n<d.endIndex){s=A.children.indexOf(d),a=r.children.indexOf(A),c=A;break}if(s>-1)break}if(s===-1||a===-1||c==null)return null;let l=null;if(e===0){if(l=c.children[s+1],!l){const A=r.children[a+1];A&&(l=A.children[0])}}else if(l=c.children[s-1],!l){const A=r.children[a-1];A&&(l=A.children[A.children.length-1])}if(l){const{startIndex:A,endIndex:d}=l;return{startOffset:A+1,endOffset:d-2}}}function ri(o,t){const e=[],{customBlocks:n=[]}=o;for(const r of t){const{startOffset:s,endOffset:a}=r;if(!(s==null||a==null))for(const c of n){const{startIndex:l}=c;l>=s&&l<a&&e.push(c.blockId)}}return e}function ks(o){return o.some(t=>{const{startNodePosition:e}=t;return e?(e==null?void 0:e.path.indexOf("cells"))>-1:!1})}const Vs=i.SHEET_EDITOR_UNITS,ho={id:"doc.command.inner-paste",type:i.CommandType.COMMAND,handler:async(o,t)=>{var y,_,O,w,Q,k;const{segmentId:e,textRanges:n,doc:r}=t,s=o.get(i.ICommandService),a=o.get(D.DocSelectionManagerService),c=o.get(i.IUniverInstanceService),l=a.getTextRanges(),A=a.getRectRanges(),{body:d,tableSource:u,drawings:m}=r;if(!Array.isArray(l)||l.length===0||d==null)return!1;const g=c.getCurrentUniverDocInstance(),h=g==null?void 0:g.getSelfOrHeaderFooterModel(e).getBody();if(g==null||h==null)return!1;const p=g.getUnitId(),f={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:n,segmentId:e}},S=new i.MemoryCursor;S.reset();const E=new i.TextX,C=i.JSONX.getInstance(),T=[],R=!!((y=d.tables)!=null&&y.length),v=!!((_=d.customBlocks)!=null&&_.length);if(R&&e||R&&ks(l)||l.length&&(A!=null&&A.length))return!1;for(let F=0;F<l.length;F++){const L=l[F],{startOffset:G,endOffset:W,collapsed:H}=L,V=G-S.cursor,j=i.Tools.deepClone(d);if(R)for(const Y of j.tables){const{tableId:K}=Y,Z=i.generateRandomId(6);Y.tableId=Z;const ne=i.Tools.deepClone(u[K]);ne.tableId=Z;const ue=C.insertOp(["tableSource",Z],ne);T.push(ue)}if(v&&m){const Y=(w=(O=g.getSnapshot().drawingsOrder)==null?void 0:O.length)!=null?w:0;for(const K of j.customBlocks){const{blockId:Z}=K,ne=i.generateRandomId(6);K.blockId=ne;const ue=i.Tools.deepClone(m[Z]);ue.drawingId=ne;const Me=C.insertOp(["drawings",ne],ue),ge=C.insertOp(["drawingsOrder",Y],ne);T.push(Me),T.push(ge)}}const X=co((Q=h.customRanges)!=null?Q:[],W,Vs.includes(p)),z=lo((k=h.customDecorations)!=null?k:[],W);if(X&&(j.customRanges=[{...X,startIndex:0,endIndex:d.dataStream.length-1}]),z.length&&(j.customDecorations=z.map(Y=>({...Y,startIndex:0,endIndex:d.dataStream.length-1}))),H)E.push({t:i.TextXActionType.RETAIN,len:V}),E.push({t:i.TextXActionType.INSERT,body:j,len:d.dataStream.length});else{const Y=i.BuildTextUtils.selection.delete([L],d,S.cursor,j,l.length===1);E.push(...Y)}S.reset(),S.moveCursor(W)}const b=J(g,e);return T.push(C.editOp(E.serialize(),b)),f.params.actions=T.reduce((F,L)=>i.JSONX.compose(F,L),null),!!s.syncExecuteCommand(f.id,f.params)}};function js(o,t){const{startOffset:e,endOffset:n}=o,r=t.some(a=>a.startIndex===n),s=Math.max(e,r?n-1:n);return{...o,endOffset:s,collapsed:e===s}}function Ws(o,t,e){var h,p;const n=t.getSelfOrHeaderFooterModel(e).getBody(),r=new i.TextX,s=i.JSONX.getInstance(),a=[];if(n==null)return a;const{tables:c=[]}=n,l=new i.MemoryCursor;l.reset();for(let f=0;f<o.length;f++){const S=js(o[f],c),{startOffset:E,endOffset:C,collapsed:T}=S,R=E-l.cursor;T?r.push({t:i.TextXActionType.RETAIN,len:R}):r.push(...i.BuildTextUtils.selection.delete([S],n,l.cursor,null,!1)),l.reset(),l.moveCursor(C)}const A=J(t,e);a.push(s.editOp(r.serialize(),A));const d=ri(n,o),u=(h=t.getDrawings())!=null?h:{},m=(p=t.getDrawingsOrder())!=null?p:[],g=d.sort((f,S)=>m.indexOf(f)>m.indexOf(S)?-1:m.indexOf(f)<m.indexOf(S)?1:0);if(g.length>0)for(const f of g){const S=u[f],E=m.indexOf(f);if(S==null||E<0)continue;const C=s.removeOp(["drawings",f],S),T=s.removeOp(["drawingsOrder",E],f);a.push(C),a.push(T)}return a.reduce((f,S)=>i.JSONX.compose(f,S),null)}function Gs(o,t,e,n){const r=[];if(t.getSelfOrHeaderFooterModel(n).getBody()==null)return r;const a=new i.TextX,c=i.JSONX.getInstance(),l=new i.MemoryCursor;l.reset();for(const d of o){const{startOffset:u,endOffset:m,spanEntireRow:g,spanEntireTable:h}=d;if(!(u==null||m==null))if(h){const p=oi({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,len:S,tableId:E}=p;f-l.cursor>0&&a.push({t:i.TextXActionType.RETAIN,len:f-l.cursor}),a.push({t:i.TextXActionType.DELETE,len:S});const C=c.removeOp(["tableSource",E]);r.push(C),l.moveCursorTo(f+S)}else if(g){const p=ni({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,rowIndexes:S,len:E,tableId:C}=p;f-l.cursor>0&&a.push({t:i.TextXActionType.RETAIN,len:f-l.cursor}),a.push({t:i.TextXActionType.DELETE,len:E});for(const T of S.reverse()){const R=c.removeOp(["tableSource",C,"tableRows",T]);r.push(R)}l.moveCursorTo(f+E)}else{const p=Hs({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offsets:f}=p;for(const S of f){const{retain:E,delete:C}=S;E-l.cursor>0&&a.push({t:i.TextXActionType.RETAIN,len:E-l.cursor}),a.push({t:i.TextXActionType.DELETE,len:C}),l.moveCursorTo(E+C)}}}const A=J(t,n);return r.push(c.editOp(a.serialize(),A)),r.reduce((d,u)=>i.JSONX.compose(d,u),null)}function ii(o,t,e,n,r){let s=[];if(Array.isArray(o)&&(o==null?void 0:o.length)!==0&&(s=Ws(o,e,r)),Array.isArray(t)&&(t==null?void 0:t.length)!==0){const a=Gs(t,e,n,r);s==null||s.length===0?s=a:s=i.JSONX.compose(s,i.JSONX.transform(a,s,"right"))}return s}const Ge={id:"doc.command.inner-cut",type:i.CommandType.COMMAND,handler:(o,t)=>{var p;const e=o.get(D.DocSelectionManagerService),n=o.get(i.ICommandService),r=o.get(i.IUniverInstanceService),{segmentId:s,textRanges:a,selections:c=e.getTextRanges(),rectRanges:l=e.getRectRanges()}=t;if((!Array.isArray(c)||c.length===0)&&(!Array.isArray(l)||l.length===0))return!1;const A=(p=r.getCurrentUniverDocInstance())==null?void 0:p.getUnitId();if(!A)return!1;const d=r.getUniverDocInstance(A);if(d==null)return!1;const u=ae(o,A);if(u==null)return!1;const m=u.getViewModel(),g={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:a}};return g.params.actions=ii(c,l,d,m,s),!!n.syncExecuteCommand(g.id,g.params)}};var oe=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(oe||{});const si="doc.command.insert-text",mo={id:si,type:i.CommandType.COMMAND,handler:async(o,t)=>{var v;const e=o.get(i.ICommandService),{range:n,segmentId:r,body:s,unitId:a,cursorOffset:c}=t,l=o.get(D.DocSelectionManagerService),d=o.get(i.IUniverInstanceService).getUnit(a,i.UniverInstanceType.UNIVER_DOC);if(d==null)return!1;const u=l.getActiveTextRange(),m=d.getSelfOrHeaderFooterModel((v=u==null?void 0:u.segmentId)!=null?v:"").getBody();if(m==null)return!1;const{startOffset:g,collapsed:h}=n,p=c!=null?c:s.dataStream.length,f=[{startOffset:g+p,endOffset:g+p,style:u==null?void 0:u.style,collapsed:h}],S={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:f,debounce:!0}},E=new i.TextX,C=i.JSONX.getInstance();if(h)g>0&&E.push({t:i.TextXActionType.RETAIN,len:g}),E.push({t:i.TextXActionType.INSERT,body:s,len:s.dataStream.length});else{const b=i.BuildTextUtils.selection.delete([n],m,0,s);E.push(...b)}S.params.textRanges=[{startOffset:g+p,endOffset:g+p,collapsed:h}];const T=J(d,r);return S.params.actions=C.editOp(E.serialize(),T),!!e.syncExecuteCommand(S.id,S.params)}},et={id:"doc.command.delete-text",type:i.CommandType.COMMAND,handler:async(o,t)=>{var R;const e=o.get(i.ICommandService),n=o.get(i.IUniverInstanceService),{range:r,segmentId:s,unitId:a,direction:c,len:l=1}=t,A=n.getUnit(a,i.UniverInstanceType.UNIVER_DOC),d=A==null?void 0:A.getSelfOrHeaderFooterModel(s).getBody();if(A==null||d==null)return!1;const{startOffset:u}=r;let m=c===oe.LEFT?u-l:u,g=c===oe.LEFT?u-1:u+l-1;const h=(R=d.customRanges)==null?void 0:R.find(v=>v.startIndex<=m&&v.endIndex>=g);h!=null&&h.wholeEntity&&(m=h.startIndex,g=Math.max(g,h.endIndex));const p={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:[{startOffset:m,endOffset:m,collapsed:!0}],debounce:!0}},f=new i.TextX,S=i.JSONX.getInstance();f.push({t:i.TextXActionType.RETAIN,len:m-0}),f.push({t:i.TextXActionType.DELETE,len:g-m+1});const C=J(A,s);return p.params.actions=S.editOp(f.serialize(),C),!!e.syncExecuteCommand(p.id,p.params)}},po={id:"doc.command.update-text",type:i.CommandType.COMMAND,handler:async(o,t)=>{const{range:e,segmentId:n,updateBody:r,coverType:s,unitId:a,textRanges:c}=t,l=o.get(i.ICommandService),d=o.get(i.IUniverInstanceService).getCurrentUniverDocInstance();if(d==null)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:c}},m=new i.TextX,g=i.JSONX.getInstance(),{startOffset:h,endOffset:p}=e;m.push({t:i.TextXActionType.RETAIN,len:h}),m.push({t:i.TextXActionType.RETAIN,body:r,len:p-h,coverType:s});const f=J(d,n);return u.params.actions=g.editOp(m.serialize(),f),!!l.syncExecuteCommand(u.id,u.params)}};function yt(o){var a,c,l,A;const t=o.get(i.IUniverInstanceService),n=o.get(D.DocSelectionManagerService).getActiveTextRange(),r=t.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC);return!n||!n.collapsed||!r||n.segmentId?!1:i.BuildTextUtils.range.getParagraphsInRange(n,(c=(a=r.getBody())==null?void 0:a.paragraphs)!=null?c:[],(A=(l=r.getBody())==null?void 0:l.dataStream)!=null?A:"")[0]}const un={id:"doc.command.delete-custom-block",type:i.CommandType.COMMAND,handler:async(o,t)=>{var O;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),s=e.getActiveTextRange(),a=n.getCurrentUniverDocInstance();if(s==null||a==null)return!1;const{direction:c,range:l,unitId:A,drawingId:d}=t,{startOffset:u,segmentId:m,style:g}=s,h=c===oe.LEFT?u-1:u,p=[{startOffset:h,endOffset:h,style:g}],f={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:p,prevTextRanges:[l]}},S=new i.TextX,E=i.JSONX.getInstance(),C=[];u>0&&S.push({t:i.TextXActionType.RETAIN,len:c===oe.LEFT?u-1:u}),S.push({t:i.TextXActionType.DELETE,len:1});const T=J(a,m);C.push(E.editOp(S.serialize(),T));const R=((O=a.getDrawings())!=null?O:{})[d],b=a.getDrawingsOrder().indexOf(d),x=E.removeOp(["drawings",d],R),y=E.removeOp(["drawingsOrder",b],d);return C.push(x),C.push(y),f.params.actions=C.reduce((w,Q)=>i.JSONX.compose(w,Q),null),!!r.syncExecuteCommand(f.id,f.params)}},gn={id:"doc.command.merge-two-paragraph",type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),{direction:s,range:a}=t,c=e.getActiveTextRange(),l=e.getTextRanges();if(c==null||l==null)return!1;const{segmentId:A,style:d}=c,u=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const g=m.dataStream,h=c,p=u.getUnitId(),{startOffset:f,collapsed:S}=h;if(!S)return!1;const E=s===oe.LEFT?f:f+1;let C,T;for(const k of m.paragraphs){if(k.startIndex>=E){T=k;break}C=k}if(C==null||T==null)return!1;const R=s===oe.LEFT?f-1:f,v=[{startOffset:R,endOffset:R,style:d}],b={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:v,prevTextRanges:[a]}},x=new i.TextX,y=i.JSONX.getInstance();C.startIndex>0&&x.push({t:i.TextXActionType.RETAIN,len:C.startIndex}),x.push({t:i.TextXActionType.DELETE,len:1}),T.startIndex>C.startIndex+1&&x.push({t:i.TextXActionType.RETAIN,len:T.startIndex-C.startIndex-1});const _=Object.values(i.DataStreamTreeTokenType),O=g[C.startIndex-1];(O&&!_.includes(O)||O===" ")&&x.push({t:i.TextXActionType.RETAIN,len:1,coverType:i.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...i.Tools.deepClone(C),startIndex:0}]}});const w=J(u,A);return b.params.actions=y.editOp(x.serialize(),w),!!r.syncExecuteCommand(b.id,b.params)}},ai={id:"doc.command.remove-horizontal-line",type:i.CommandType.COMMAND,handler:async o=>{var R;const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService),r=t.getActiveTextRange(),s=t.getTextRanges();if(r==null||s==null)return!1;const{segmentId:a,style:c}=r,l=e.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),A=l==null?void 0:l.getSelfOrHeaderFooterModel(a).getBody();if(l==null||A==null)return!1;const d=r,u=l.getUnitId(),{startOffset:m,collapsed:g}=d;if(!g)return!1;const h=(R=A.paragraphs)==null?void 0:R.find(v=>v.startIndex===m-1);if(h==null)return!1;const p=[{startOffset:m,endOffset:m,style:c}],f={id:D.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:p}},S=new i.TextX,E=i.JSONX.getInstance();h.startIndex>0&&S.push({t:i.TextXActionType.RETAIN,len:h.startIndex}),S.push({t:i.TextXActionType.RETAIN,len:1,coverType:i.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...i.Tools.deepClone({...h,paragraphStyle:{...h.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const C=J(l,a);return f.params.actions=E.editOp(S.serialize(),C),!!n.syncExecuteCommand(f.id,f.params)}};function hn(o,t){let e=0;if(o==null||o.length===0){if(typeof t[0].startOffset=="number"){const n=t[0],{spanEntireRow:r,spanEntireTable:s}=n;s?e=n.startOffset-3:r?n.startRow>0?e=n.startOffset-6:e=n.startOffset:e=t[0].startOffset}}else if(o.length>0&&t.length>0){const n=o[0],r=t[0];if(n.startOffset!=null&&r.startOffset!=null){if(n.startOffset<r.startOffset)e=n.startOffset;else if(n.startOffset>=r.startOffset){const{spanEntireRow:s,spanEntireTable:a}=r;a?e=r.startOffset-3:s&&(e=r.startOffset-6)}}}return e}const bt={id:"doc.command.delete-left",type:i.CommandType.COMMAND,handler:async o=>{var y,_,O,w,Q,k;const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService);let r=!0;const s=e.getCurrentUniverDocInstance();if(s==null)return!1;const a=s.getUnitId(),c=ae(o,a),l=t.getActiveTextRange(),A=t.getRectRanges(),d=t.getTextRanges(),u=c==null?void 0:c.getSkeleton();if(u==null)return!1;if(A!=null&&A.length){const F=hn(d,A),L=A[0].segmentId,G=[{startOffset:F,endOffset:F}];return n.executeCommand(Ge.id,{segmentId:L,textRanges:G})}if(l==null||d==null)return!1;const{segmentId:m,style:g,segmentPage:h}=l,p=s.getSelfOrHeaderFooterModel(m).getBody();if(p==null)return!1;const f=l,{startOffset:S,collapsed:E}=f,C=u.findNodeByCharIndex(S,m,h),T=B.hasListGlyph(C),R=B.isIndentByGlyph(C,p);let v=S;const b=u.findNodeByCharIndex(S-1,m,h);if(B.isFirstGlyph(C)&&b!==C&&(T===!0||R===!0)&&E){const F=B.getParagraphByGlyph(C,p);if(F==null)return!1;const L=F==null?void 0:F.startIndex,G={startIndex:0},W=F.paragraphStyle;if(T===!0){const V=F.paragraphStyle;if(V){G.paragraphStyle=V;const{hanging:j}=V;j&&(G.paragraphStyle.indentStart=j,G.paragraphStyle.hanging=void 0)}}else if(R===!0){const V=F.bullet;V&&(G.bullet=V),W!=null&&(G.paragraphStyle={...W},delete G.paragraphStyle.hanging,delete G.paragraphStyle.indentStart)}const H=[{startOffset:v,endOffset:v,style:g}];r=await n.executeCommand(po.id,{unitId:s.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...G}]},range:{startOffset:L,endOffset:L+1},textRanges:H,coverType:i.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(E===!0){if(b==null)return!0;if(b.content==="\r"){const F=(y=p.paragraphs)==null?void 0:y.find(L=>L.startIndex===S-1);(_=F==null?void 0:F.paragraphStyle)!=null&&_.borderBottom?r=await n.executeCommand(ai.id):r=await n.executeCommand(gn.id,{direction:oe.LEFT,range:f})}else if(b.streamType==="\b"){const F=(w=s.getSnapshot().drawings)==null?void 0:w[(O=b.drawingId)!=null?O:""];if(F==null)return!0;const L=(k=(Q=s.getBody())==null?void 0:Q.customBlocks)==null?void 0:k.find(W=>W.blockId===b.drawingId);if(F.layoutType===i.PositionedObjectLayoutType.INLINE||(L==null?void 0:L.blockType)===i.BlockType.CUSTOM){const W=s.getUnitId();r=await n.executeCommand(un.id,{direction:oe.LEFT,range:l,unitId:W,drawingId:b.drawingId})}else{const W=u.findNodeByCharIndex(S-2);if(W==null)return!0;v-=b.count,v-=W.count;const H=[{startOffset:v,endOffset:v,style:g}];r=await n.executeCommand(et.id,{unitId:s.getUnitId(),range:{...l,startOffset:l.startOffset-1,endOffset:l.endOffset-1},segmentId:m,direction:oe.LEFT,len:W.count,textRanges:H})}}else v-=b.count,r=await n.executeCommand(et.id,{unitId:s.getUnitId(),range:f,segmentId:m,direction:oe.LEFT,len:b.count})}else{const F=ci(f,[f]);r=await n.executeCommand(Ge.id,{segmentId:m,textRanges:F,selections:[f]})}return r}},fo={id:"doc.command.delete-right",type:i.CommandType.COMMAND,handler:async o=>{var C,T;const t=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService).getCurrentUniverDocInstance();if(!n)return!1;const r=ae(o,n.getUnitId()),s=o.get(i.ICommandService),a=t.getActiveTextRange(),c=t.getRectRanges(),l=t.getTextRanges(),A=r==null?void 0:r.getSkeleton();if(c!=null&&c.length){const R=hn(l,c),v=c[0].segmentId,b=[{startOffset:R,endOffset:R}];return s.executeCommand(Ge.id,{segmentId:v,textRanges:b})}if(a==null||A==null||l==null)return!1;const{segmentId:d,style:u,segmentPage:m}=a,g=n==null?void 0:n.getSelfOrHeaderFooterModel(d).getBody();if(!n||!g)return!1;const h=a,{startOffset:p,endOffset:f,collapsed:S}=h;if(p===g.dataStream.length-2&&S)return!0;let E=!1;if(S===!0){const R=A.findNodeByCharIndex(p,d,m),v=A.findNodeByCharIndex(p+1);if(R.streamType===i.DataStreamTreeTokenType.PARAGRAPH&&(v==null?void 0:v.streamType)===i.DataStreamTreeTokenType.SECTION_BREAK)return!1;if(R.content==="\r")E=await s.executeCommand(gn.id,{direction:oe.RIGHT,range:a});else if(R.streamType==="\b"){const b=(T=n.getSnapshot().drawings)==null?void 0:T[(C=R.drawingId)!=null?C:""];if(b==null)return!0;if(b.layoutType===i.PositionedObjectLayoutType.INLINE){const y=n.getUnitId();E=await s.executeCommand(un.id,{direction:oe.RIGHT,range:a,unitId:y,drawingId:R.drawingId})}else{if(v==null)return!0;const y=[{startOffset:p+1,endOffset:p+1,style:u}];E=await s.executeCommand(et.id,{unitId:n.getUnitId(),range:{...a,startOffset:p+1,endOffset:f+1},segmentId:d,direction:oe.RIGHT,textRanges:y,len:v.count})}}else{const b=[{startOffset:p,endOffset:p,style:u}];E=await s.executeCommand(et.id,{unitId:n.getUnitId(),range:h,segmentId:d,direction:oe.RIGHT,textRanges:b,len:R.count})}}else{const R=ci(h,[h]);E=await s.executeCommand(Ge.id,{segmentId:d,textRanges:R,selections:[h]})}return E}};function ci(o,t){let e=o.endOffset;for(const r of t){const{startOffset:s,endOffset:a}=r;s==null||a==null||a<=o.endOffset&&(e-=a-s)}return[{startOffset:e,endOffset:e,style:o.style}]}const So={id:"doc.command.delete-current-paragraph",type:i.CommandType.COMMAND,handler:async o=>{var A,d;const t=o.get(i.IUniverInstanceService),e=o.get(i.ICommandService),n=t.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const r=(d=(A=n.getBody())==null?void 0:A.dataStream)!=null?d:"",s=yt(o);if(!s)return!1;const a=i.BuildTextUtils.selection.delete([{startOffset:s.paragraphStart,endOffset:r[s.paragraphEnd+1]===`
`?s.paragraphEnd:s.paragraphEnd+1,collapsed:!1}],n.getBody(),0,void 0,!0),c=J(n),l={unitId:n.getUnitId(),actions:i.JSONX.getInstance().editOp(a,c),textRanges:[{startOffset:s.paragraphStart,endOffset:s.paragraphStart,collapsed:!0}]};return e.syncExecuteCommand(D.RichTextEditingMutation.id,l)}},Xs=10,Ks=6;function zs(){return i.generateRandomId(Ks)}function Ys(o){const t=o.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}class qs{constructor(){M(this,"_cache",new i.LRUMap(Xs))}set(t,e){this._cache.set(t,e)}get(t){return this._cache.get(t)}clear(){this._cache.clear()}}const Mn=new qs;function Io(o){const t=o.style,e={},n=o.tagName.toLowerCase();switch(n){case"b":case"em":case"strong":{e.bl=i.BooleanNumber.TRUE;break}case"s":{e.st={s:i.BooleanNumber.TRUE};break}case"u":{e.ul={s:i.BooleanNumber.TRUE};break}case"i":{e.it=i.BooleanNumber.TRUE;break}case"sub":case"sup":{e.va=n==="sup"?i.BaselineOffset.SUPERSCRIPT:i.BaselineOffset.SUBSCRIPT;break}}for(let r=0;r<t.length;r++){const s=t[r],a=t.getPropertyValue(s);switch(s){case"font-family":{e.ff=a.replace(/^"/g,"").replace(/"$/g,"");break}case"font-size":{const c=Number.parseInt(a);Number.isNaN(c)||(a.endsWith("pt")?e.fs=c:a.endsWith("px")&&(e.fs=B.pixelToPt(c)));break}case"font-style":{a==="italic"&&(e.it=i.BooleanNumber.TRUE);break}case"font-weight":{(Number(a)>400||String(a)==="bold")&&(e.bl=i.BooleanNumber.TRUE);break}case"text-decoration":{/underline/.test(a)?e.ul={s:i.BooleanNumber.TRUE}:/overline/.test(a)?e.ol={s:i.BooleanNumber.TRUE}:/line-through/.test(a)&&(e.st={s:i.BooleanNumber.TRUE});break}case"color":{try{const c=new i.ColorKit(a);c.isValid&&(e.cl={rgb:c.toRgbString()})}catch{}break}case"background-color":{const c=new i.ColorKit(a);c.isValid&&(e.bg={rgb:c.toRgbString()});break}}}return e}function Js(o){const t=new DOMParser,e=`<x-univer id="univer-root">${o}</x-univer>`;return t.parseFromString(e,"text/html").querySelector("#univer-root")}function ir(o,t){const e=o.tagName.toLowerCase();return typeof t=="string"?e===t:Array.isArray(t)?t.some(n=>n===e):t(o)}const sr=660,rn=class rn{constructor(){M(this,"_tableCache",[]);M(this,"_styleCache",new Map);M(this,"_styleRules",[]);M(this,"_afterProcessRules",[])}static use(t){if(this._pluginList.includes(t))throw new Error(`Univer paste plugin ${t.name} already added`);this._pluginList.push(t)}convert(t,e={}){var c;const n=rn._pluginList.find(l=>l.checkPasteType(t)),r=Js(t),a={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:(c=e==null?void 0:e.unitId)!=null?c:""};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,r.childNodes,a),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],a}_process(t,e,n){var s,a,c,l;const r=n.body;for(const A of e)if(A.nodeType===Node.TEXT_NODE){if(((s=A.nodeValue)==null?void 0:s.trim())==="")continue;const d=(a=A.nodeValue)==null?void 0:a.replace(/[\r\n]/g,"");let u;t&&this._styleCache.has(t)&&(u=this._styleCache.get(t)),r.dataStream+=d,u&&Object.getOwnPropertyNames(u).length&&r.textRuns.push({st:r.dataStream.length-d.length,ed:r.dataStream.length,ts:u})}else if(A.nodeName==="IMG"){const d=A,u=d.dataset.imageSourceType,m=u===ao.ImageSourceType.UUID?d.dataset.source:d.src;if(m&&u){const g=Number(d.dataset.width||100),h=Number(d.dataset.height||100),p=Number(d.dataset.docTransformWidth||g),f=Number(d.dataset.docTransformHeight||h),S=i.generateRandomId(6);(l=(c=n.body)==null?void 0:c.customBlocks)==null||l.push({startIndex:r.dataStream.length,blockId:S}),r.dataStream+="\b",n.drawings||(n.drawings={}),n.drawings[S]={drawingId:S,title:"",description:"",imageSourceType:u,source:m,transform:{width:g,height:h,left:0},docTransform:{size:{width:p,height:f},angle:0,positionH:{relativeFrom:i.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:i.ObjectRelativeFromV.PARAGRAPH,posOffset:0}},layoutType:i.PositionedObjectLayoutType.INLINE,drawingType:i.DrawingTypeEnum.DRAWING_IMAGE,unitId:n.id||"",subUnitId:n.id||""}}}else{if(i.skipParseTagNames.includes(A.nodeName.toLowerCase()))continue;if(A.nodeType===Node.ELEMENT_NODE){const d=A,u=this._processBeforeLink(d,n),m=t?this._styleCache.get(t):{},g=this._styleRules.find(({filter:S})=>ir(A,S)),h=g?g.getStyle(A):Io(A);this._styleCache.set(A,{...m,...h});const{childNodes:p}=A;this._processBeforeTable(A,n),this._process(A,p,n),this._processAfterTable(A,n);const f=this._afterProcessRules.find(({filter:S})=>ir(A,S));f&&f.handler(n,A),this._processAfterLink(d,n,u)}}}_processBeforeTable(t,e){var s;const n=t.tagName.toUpperCase(),r=e.body;switch(n){case"TABLE":{r.dataStream[r.dataStream.length-1]!=="\r"&&(r.dataStream+="\r",r.paragraphs==null&&(r.paragraphs=[]),(s=r.paragraphs)==null||s.push({startIndex:r.dataStream.length-1}));const a=go(0,0,sr);this._tableCache.push({table:a,startIndex:r.dataStream.length}),r.dataStream+=i.DataStreamTreeTokenType.TABLE_START;break}case"TR":{const a=dn(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(a),r.dataStream+=i.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{const a=ln(),c=this._tableCache[this._tableCache.length-1].table;c.tableRows[c.tableRows.length-1].tableCells.push(a),r.dataStream+=i.DataStreamTreeTokenType.TABLE_CELL_START;break}}}_processAfterTable(t,e){var a,c;const n=t.tagName.toUpperCase(),r=e.body;e.tableSource==null&&(e.tableSource={}),r.tables==null&&(r.tables=[]),r.sectionBreaks==null&&(r.sectionBreaks=[]);const{tableSource:s}=e;switch(n){case"TABLE":{const l=this._tableCache.pop(),{startIndex:A,table:d}=l,u=d.tableRows[0].tableCells.length,m=An(sr/u),g=[...new Array(u).fill(null).map(()=>i.Tools.deepClone(m))];d.tableColumns=g,s[d.tableId]=d,r.dataStream+=i.DataStreamTreeTokenType.TABLE_END,r.tables.push({startIndex:A,endIndex:r.dataStream.length,tableId:d.tableId});break}case"TR":{r.dataStream+=i.DataStreamTreeTokenType.TABLE_ROW_END;break}case"TD":{r.dataStream[r.dataStream.length-1]!=="\r"&&((a=r.paragraphs)==null||a.push({startIndex:r.dataStream.length}),r.dataStream+="\r"),(c=r.sectionBreaks)==null||c.push({startIndex:r.dataStream.length}),r.dataStream+=`
${i.DataStreamTreeTokenType.TABLE_CELL_END}`;break}}}_processBeforeLink(t,e){return e.body.dataStream.length}_processAfterLink(t,e,n){var a,c;const r=e.body,s=t;s.tagName.toUpperCase()==="A"&&(r.customRanges=(a=r.customRanges)!=null?a:[],r.customRanges.push({startIndex:n,endIndex:r.dataStream.length-1,rangeId:(c=s.dataset.rangeid)!=null?c:i.generateRandomId(),rangeType:i.CustomRangeType.HYPERLINK,properties:{url:s.href}}))}};M(rn,"_pluginList",[]);let tt=rn;const li={name:"univer-doc-paste-plugin-lark",checkPasteType(o){return/lark-record-clipboard/i.test(o)},stylesRules:[{filter:["s"],getStyle(o){const t=Io(o);return{st:{s:i.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter(o){return o.tagName==="DIV"&&/ace-line/i.test(o.className)},handler(o){const t=o.body;t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function di(o){const t=o.style,e={};for(let n=0;n<t.length;n++){const r=t[n],s=t.getPropertyValue(r);switch(r){case"margin-top":{const a=Number.parseInt(s);e.spaceAbove={v:/pt/.test(s)?B.ptToPixel(a):a};break}case"margin-bottom":{const a=Number.parseInt(s);e.spaceBelow={v:/pt/.test(s)?B.ptToPixel(a):a};break}case"line-height":{let a=Number.parseFloat(s);s.endsWith("%")&&(a/=100),e.lineSpacing=a;break}}}return Object.getOwnPropertyNames(e).length?e:null}const Ai={name:"univer-doc-paste-plugin-univer",checkPasteType(o){return/UniverNormal/i.test(o)},stylesRules:[],afterProcessRules:[{filter(o){return o.tagName==="P"&&/UniverNormal/i.test(o.className)},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},r=di(t);r&&(n.paragraphStyle=r),e.paragraphs.push(n),e.dataStream+="\r"}}]},ui={name:"univer-doc-paste-plugin-word",checkPasteType(o){return/word|mso/i.test(o)},stylesRules:[{filter:["b"],getStyle(o){const t=Io(o);return{bl:i.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter(o){return o.tagName==="P"},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},r=di(t);r&&(n.paragraphStyle=r),e.paragraphs.push(n),e.dataStream+="\r"}}]};function Zs(o){var n,r;const t=s=>{let a="";return Object.keys(s).forEach(c=>{s[c]!==void 0&&(a+=` ${c}=${s[c]}`)}),a},e={"data-doc-transform-height":o.docTransform.size.height,"data-doc-transform-width":o.docTransform.size.width,"data-width":(n=o.transform)==null?void 0:n.width,"data-height":(r=o.transform)==null?void 0:r.height,"data-image-source-type":o.imageSourceType,"data-source":o.imageSourceType===ao.ImageSourceType.UUID?o.source:void 0,src:o.source};return`<img  ${t(e)}></img>`}function ar(o,t){const{st:e,ed:n,ts:r={}}=t,{ff:s,fs:a,it:c,bl:l,ul:A,st:d,ol:u,bg:m,cl:g,va:h}=r;let p=o.slice(e,n);const f=[];return c===i.BooleanNumber.TRUE&&(p=`<i>${p}</i>`),h===i.BaselineOffset.SUPERSCRIPT?p=`<sup>${p}</sup>`:h===i.BaselineOffset.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(A==null?void 0:A.s)===i.BooleanNumber.TRUE&&(p=`<u>${p}</u>`),(d==null?void 0:d.s)===i.BooleanNumber.TRUE&&(p=`<s>${p}</s>`),l===i.BooleanNumber.TRUE&&(p=`<strong>${p}</strong>`),s&&f.push(`font-family: ${s}`),g&&f.push(`color: ${g.rgb}`),a&&f.push(`font-size: ${a}pt`),u&&f.push("text-decoration: overline"),m&&f.push(`background: ${m.rgb}`),f.length?`<span style="${f.join("; ")};">${p}</span>`:p}function Dn(o,t,e){const{dataStream:n,textRuns:r=[]}=o;if(t===e)return"";let s=t;const a=[];for(const c of r){const{st:l,ed:A}=c;i.Tools.hasIntersectionBetweenTwoRanges(t,e,l,A)&&(l>s?(a.push(n.slice(s,l)),a.push(ar(n,{...c,ed:Math.min(A,e)}))):a.push(ar(n,{...c,st:s,ed:Math.min(A,e)}))),s=Math.max(t,Math.min(A,e))}return s!==e&&a.push(n.slice(s,e)),a.join("")}function $s(o,t,e){const n=o.body,r=o.drawings||{},{customRanges:s=[],customBlocks:a=[]}=n||{},c=[...a],l=s.filter(g=>g.startIndex>=t&&g.endIndex<=e);let A=t,d="";const u=(g,h)=>{let p="",f=0,S=g,E=c.findIndex(C=>g<=C.startIndex&&h>=C.startIndex);if(E===-1)return p=Dn(n,g,h),{sliceHtml:p,customBlockLength:f};for(;E!==-1;){const C=c[E];c.splice(E,1),p+=Dn(n,S,C.startIndex);const T=r[C.blockId];if(T)switch(T.drawingType){case i.DrawingTypeEnum.DRAWING_IMAGE:{p+=Zs(T),f++;break}}S=C.startIndex+1,E=c.findIndex(R=>S<=R.startIndex&&h>=R.startIndex)}return p=p+Dn(n,S,h+1),{sliceHtml:p,customBlockLength:f}};l.forEach(g=>{var T,R;const{startIndex:h,endIndex:p,rangeType:f,rangeId:S}=g,E=u(A,h);d+=E.sliceHtml;const C=u(h,p+1);switch(f){case i.CustomRangeType.HYPERLINK:{d+=`<a data-rangeid="${S}" href="${(R=(T=g.properties)==null?void 0:T.url)!=null?R:""}">${C.sliceHtml}</a>`;break}default:{d+=C.sliceHtml;break}}A=p+1+(E.customBlockLength+C.customBlockLength)});const m=u(A,e);return d+=m.sliceHtml,d}function gi(o){const t=o.body||{},{paragraphs:e=[],sectionBreaks:n=[]}=t;let{dataStream:r=""}=t;r.endsWith(`\r
`)||(r+=`\r
`,e.push({startIndex:r.length-2}),n.push({startIndex:r.length-1}),t.dataStream=r,t.paragraphs=e,t.sectionBreaks=n);const s={html:""},a=B.parseDataStreamToTree(r).sectionList;for(const c of a)Je(c,o,s);return s.html}function Je(o,t,e){var n,r;switch(o.nodeType){case i.DataStreamTreeNodeType.SECTION_BREAK:{for(const s of o.children)Je(s,t,e);break}case i.DataStreamTreeNodeType.PARAGRAPH:{const{children:s,startIndex:a,endIndex:c}=o,l=(r=(n=t.body)==null?void 0:n.paragraphs.find(h=>h.startIndex===c))!=null?r:{},{paragraphStyle:A={}}=l,{spaceAbove:d,spaceBelow:u,lineSpacing:m}=A,g=[];if(d!=null&&(typeof d=="number"?g.push(`margin-top: ${d}px`):g.push(`margin-top: ${d.v}px`)),u!=null&&(typeof u=="number"?g.push(`margin-bottom: ${u}px`):g.push(`margin-bottom: ${u.v}px`)),m!=null&&g.push(`line-height: ${m}`),e.html+=`<p class="UniverNormal" ${g.length?`style="${g.join("; ")};"`:""}>`,s.length)for(const h of s)Je(h,t,e);e.html+=`${$s(t,a,c)}</p>`;break}case i.DataStreamTreeNodeType.TABLE:{const{children:s}=o;e.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const a of s)Je(a,t,e);e.html+="</tbody></table>";break}case i.DataStreamTreeNodeType.TABLE_ROW:{const{children:s}=o;e.html+='<tr class="UniverTableRow">';for(const a of s)Je(a,t,e);e.html+="</tr>";break}case i.DataStreamTreeNodeType.TABLE_CELL:{const{children:s}=o;e.html+='<td class="UniverTableCell">';for(const a of s)Je(a,t,e);e.html+="</td>";break}default:throw new Error(`Unknown node type: ${o.nodeType}`)}}class ea{convert(t){if(t.length===0)throw new Error("The bodyList length at least to be 1");let e="";for(const n of i.Tools.deepClone(t))e+=gi(n);return e}}var ta=Object.getOwnPropertyDescriptor,na=(o,t,e,n)=>{for(var r=n>1?void 0:n?ta(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},ct=(o,t)=>(e,n)=>t(e,n,o);tt.use(ui);tt.use(li);tt.use(Ai);function cr(o,t,e){var s,a,c;const n=i.getBodySlice(o,t,e+2),r=i.DataStreamTreeTokenType.TABLE_START+i.DataStreamTreeTokenType.TABLE_ROW_START+i.DataStreamTreeTokenType.TABLE_CELL_START+n.dataStream+i.DataStreamTreeTokenType.TABLE_CELL_END+i.DataStreamTreeTokenType.TABLE_ROW_END+i.DataStreamTreeTokenType.TABLE_END;return n.dataStream=r,(s=n.textRuns)==null||s.forEach(l=>{const{st:A,ed:d}=l;l.st=A+3,l.ed=d+3}),(a=n.tables)==null||a.forEach(l=>{const{startIndex:A,endIndex:d}=l;l.startIndex=A+3,l.endIndex=d+3}),(c=n.paragraphs)==null||c.forEach(l=>{const{startIndex:A}=l;l.startIndex=A+3}),n}const Ne=i.createIdentifier("doc.clipboard-service");let Vn=class extends i.Disposable{constructor(t,e,n,r,s){super();M(this,"_clipboardHooks",[]);M(this,"_htmlToUDM",new tt);M(this,"_umdToHtml",new ea);this._univerInstanceService=t,this._logService=e,this._commandService=n,this._clipboardInterfaceService=r,this._docSelectionManagerService=s}async copy(t=i.SliceBodyType.copy,e){var c,l;const{newSnapshotList:n=[],needCache:r=!1,snapshot:s,ranges:a}=(c=this._getDocumentBodyInRanges(t,e))!=null?c:{};if(n.length===0||s==null)return!1;try{const A=!!((l=a==null?void 0:a[0])!=null&&l.segmentId);this._setClipboardData(n,!A&&r)}catch(A){return this._logService.error("[DocClipboardService] copy failed",A),!1}return!0}async cut(t){return this._cut(t)}async paste(t){const e=await this._genDocDataFromClipboardItems(t);return this._paste(e)}async legacyPaste(t){let{html:e,text:n,files:r}=t;const s=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),a=(s==null?void 0:s.getUnitId())||"";if(!e&&!n&&r.length&&(e=await this._createImagePasteHtml(r)),!e&&!n)return this._logService.warn("[DocClipboardController] html and text cannot be both empty!"),!1;const c=this._genDocDataFromHtmlAndText(e,n,a);if(a===i.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)if(n){const l=i.BuildTextUtils.transform.fromPlainText(n);return this._paste({body:l})}else c.body.textRuns=[];return this._paste(c)}async _cut(t){var c,l,A,d,u;const e=(l=(c=t==null?void 0:t.filter(m=>m.rangeType===i.DOC_RANGE_TYPE.TEXT))!=null?c:this._docSelectionManagerService.getTextRanges())!=null?l:[],n=(d=(A=t==null?void 0:t.filter(m=>m.rangeType===i.DOC_RANGE_TYPE.RECT))!=null?A:this._docSelectionManagerService.getRectRanges())!=null?d:[],{segmentId:r,endOffset:s,style:a}=(u=e[0])!=null?u:{};if(r==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),e.length===0&&n.length===0)return!1;this.copy(i.SliceBodyType.cut,t);try{let m=0;if(n.length>0)m=hn(e,n);else if(s!=null){m=s;for(const h of e){const{startOffset:p,endOffset:f}=h;p==null||f==null||f<=s&&(m-=f-p)}}const g=[{startOffset:m,endOffset:m,style:a}];return this._commandService.executeCommand(Ge.id,{segmentId:r,textRanges:g,rectRanges:n,selections:e})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(t){var d,u,m;const{body:e}=t;if(e==null)return!1;let n=i.normalizeBody(e);if(!((d=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC))==null?void 0:d.getUnitId()))return!1;this._clipboardHooks.forEach(g=>{g.onBeforePaste&&(n=g.onBeforePaste(n))}),n.customRanges=(u=n.customRanges)==null?void 0:u.map(i.BuildTextUtils.customRange.copyCustomRange),(m=n.paragraphs)==null||m.forEach(g=>{var h;(h=g.paragraphStyle)!=null&&h.headingId&&(g.paragraphStyle.headingId=i.generateRandomId(6))});const s=this._docSelectionManagerService.getActiveTextRange(),{segmentId:a,endOffset:c,style:l}=s||{},A=this._docSelectionManagerService.getTextRanges();if(a==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),c==null||A==null)return!1;try{let g=c;for(const p of A){const{startOffset:f,endOffset:S}=p;f==null||S==null||S<=c&&(g+=n.dataStream.length-(S-f))}const h=[{startOffset:g,endOffset:g,style:l}];return this._commandService.executeCommand(ho.id,{doc:{...t,body:n},segmentId:a,textRanges:h})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(t,e=!0){var a,c,l,A;const n=zs(),r=(t.length>1?t.map(d=>{var u;return((u=d.body)==null?void 0:u.dataStream)||""}).join(`
`):((a=t[0].body)==null?void 0:a.dataStream)||"").replaceAll(i.DataStreamTreeTokenType.TABLE_START,"").replaceAll(i.DataStreamTreeTokenType.TABLE_END,"").replaceAll(i.DataStreamTreeTokenType.TABLE_ROW_START,"").replaceAll(i.DataStreamTreeTokenType.TABLE_ROW_END,"").replaceAll(i.DataStreamTreeTokenType.TABLE_CELL_START,"").replaceAll(i.DataStreamTreeTokenType.TABLE_CELL_END,"").replaceAll(`\r
`," ");let s=this._umdToHtml.convert(t);if(t.length===1&&e){s=s.replace(/(<[a-z]+)/,(m,g)=>`${g} data-copy-id="${n}"`);const d=t[0],u={body:d.body};if((l=(c=d.body)==null?void 0:c.customBlocks)!=null&&l.length){u.drawings={};for(const m of d.body.customBlocks){const{blockId:g}=m,h=(A=d.drawings)==null?void 0:A[g];if(h){const p=i.generateRandomId(6);m.blockId=p,u.drawings[p]={...i.Tools.deepClone(h),drawingId:p}}}}Mn.set(n,u)}return this._clipboardInterfaceService.write(r,s)}addClipboardHook(t){return this._clipboardHooks.push(t),i.toDisposable(()=>{const e=this._clipboardHooks.indexOf(t);e>-1&&this._clipboardHooks.splice(e,1)})}_getDocumentBodyInRanges(t,e){var d;const n=this._univerInstanceService.getCurrentUniverDocInstance(),r=e!=null?e:this._docSelectionManagerService.getDocRanges(),s=[];let a=!0;if(n==null||r.length===0)return;const c=r[0].segmentId,l=(d=n==null?void 0:n.getSelfOrHeaderFooterModel(c))==null?void 0:d.getBody(),A=n.getSnapshot();if(l!=null){for(const u of r){const{startOffset:m,endOffset:g,collapsed:h,rangeType:p}=u;if(h||m==null||g==null)continue;if(p===i.DOC_RANGE_TYPE.RECT){a=!1;const{spanEntireRow:E}=u;let C;C=cr(l,m,g),s.push(C);continue}const f={startOffset:m,endOffset:g},S=n.getSelfOrHeaderFooterModel(c).sliceBody(f.startOffset,f.endOffset,t);S!=null&&s.push(S)}return{newSnapshotList:s.map(u=>({...A,body:u})),needCache:a,snapshot:A,ranges:r}}}async _genDocDataFromClipboardItems(t){try{let e="",n="";const r=[];for(const s of t)for(const a of s.types)switch(a){case I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE:{n=await s.getType(a).then(c=>c&&c.text());break}case I.HTML_CLIPBOARD_MIME_TYPE:{e=await s.getType(a).then(c=>c&&c.text());break}case I.FILE__BMP_CLIPBOARD_MIME_TYPE:case I.FILE__JPEG_CLIPBOARD_MIME_TYPE:case I.FILE__WEBP_CLIPBOARD_MIME_TYPE:case I.FILE_PNG_CLIPBOARD_MIME_TYPE:{const c=await s.getType(a),l=new File([c],`pasted_image.${a.split("/")[1]}`,{type:a});r.push(l);break}}return!e&&!n&&r.length&&(e=await this._createImagePasteHtml(r)),this._genDocDataFromHtmlAndText(e,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(t,e,n){if(!t){if(e)return{body:i.BuildTextUtils.transform.fromPlainText(e)};throw new Error("[DocClipboardService] html and text cannot be both empty!")}const r=Ys(t);if(r){const a=Mn.get(r);if(a)return a}if(!n){const a=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);n=(a==null?void 0:a.getUnitId())||""}const s=this._htmlToUDM.convert(t,{unitId:n});return r&&Mn.set(r,s),s}async _createImagePasteHtml(t){var c,l;const e={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},n=async A=>{const d=new FileReader;return new Promise(u=>{d.onloadend=function(){u({source:d.result,imageSourceType:ao.ImageSourceType.BASE64})},d.readAsDataURL(A)})},r=A=>{const d=new Image,u=500;return new Promise(m=>{d.src=typeof A=="string"?A:URL.createObjectURL(A),d.onload=()=>{const g=Math.min(u,d.naturalWidth),h=d.naturalHeight/d.naturalWidth;m({width:g,height:g*h})}})},s=(l=(c=this._clipboardHooks.find(A=>A.onBeforePasteImage))==null?void 0:c.onBeforePasteImage)!=null?l:n;return await Promise.all(t.map(async(A,d)=>{var S;const u=await s(A);if(!u)return Promise.resolve();const{width:m=100,height:g=100}=await r(A),h=`paste_image_id_${d}`,p=e.body,f=e.drawings;p.dataStream+="\b",(S=p.customBlocks)==null||S.push({startIndex:d,blockId:h}),f[h]={drawingId:h,unitId:"",subUnitId:"",imageSourceType:u.imageSourceType,title:"",source:u.source,description:"",layoutType:i.PositionedObjectLayoutType.INLINE,drawingType:i.DrawingTypeEnum.DRAWING_IMAGE,transform:{width:m,height:g,angle:0},docTransform:{angle:0,size:{width:m,height:g},positionH:{relativeFrom:i.ObjectRelativeFromH.CHARACTER,posOffset:0},positionV:{relativeFrom:i.ObjectRelativeFromV.LINE,posOffset:0}}}})),this._umdToHtml.convert([e])}};Vn=na([ct(0,i.IUniverInstanceService),ct(1,i.ILogService),ct(2,i.ICommandService),ct(3,I.IClipboardInterfaceService),ct(4,i.Inject(D.DocSelectionManagerService))],Vn);function mn(o){return o.getContextValue(i.FOCUSING_DOC)||o.getContextValue(i.EDITOR_ACTIVATED)}const vo=999,It={id:I.CopyCommand.id,name:"doc.command.copy",type:i.CommandType.COMMAND,multi:!0,priority:vo,preconditions:mn,handler:async o=>o.get(Ne).copy()},Eo={id:"doc.command.copy-current-paragraph",type:i.CommandType.COMMAND,handler:async o=>{const t=o.get(Ne),e=yt(o);return e?t.copy(i.SliceBodyType.copy,[{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1}]):!1}},pn={id:I.CutCommand.id,name:"doc.command.cut",type:i.CommandType.COMMAND,multi:!0,priority:vo,preconditions:mn,handler:async o=>o.get(Ne).cut()},Co={id:"doc.command.cut-current-paragraph",type:i.CommandType.COMMAND,handler:async o=>{const t=o.get(Ne),e=yt(o);return e?t.cut([{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1,rangeType:i.DOC_RANGE_TYPE.TEXT}]):!1}},fn={id:I.PasteCommand.id,name:"doc.command.paste",type:i.CommandType.COMMAND,multi:!0,priority:vo,preconditions:mn,handler:async o=>{const t=o.get(Ne),n=await o.get(I.IClipboardInterfaceService).read();return n.length===0?!1:t.paste(n)}},Rt={id:"doc.command.horizontal-line",type:i.CommandType.COMMAND,handler:(o,t)=>o.get(i.ICommandService).syncExecuteCommand(an.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:i.DashStyleType.SOLID},textRange:t==null?void 0:t.insertRange})},To={id:"doc.command.insert-horizontal-line-bellow",type:i.CommandType.COMMAND,handler:o=>{const t=o.get(i.ICommandService),e=yt(o);return e?t.syncExecuteCommand(Rt.id,{insertRange:{startOffset:e.startIndex+1,endOffset:e.startIndex+1}}):!1}},yo={id:"doc.command.select-all",type:i.CommandType.COMMAND,handler:async o=>{var g;const t=o.get(i.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),r=e.getDocRanges(),s=(g=r.find(h=>h.isActive))!=null?g:r[0];if(n==null||s==null)return!1;const{segmentId:a}=s,c=n.getUnitId(),l=n.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(l==null)return!1;const{tables:A=[],dataStream:d}=l;if(d===`\r
`)return!0;const u=[];let m=0;for(const h of A){const{startIndex:p,endIndex:f}=h;m!==p&&u.push({startOffset:m,endOffset:p-1,rangeType:i.DOC_RANGE_TYPE.TEXT}),u.push({startOffset:p+3,endOffset:f-5,rangeType:i.DOC_RANGE_TYPE.RECT}),m=f}return m!==l.dataStream.length-2&&u.push({startOffset:m,endOffset:l.dataStream.length-2,rangeType:i.DOC_RANGE_TYPE.TEXT}),e.replaceDocRanges(u,{unitId:c,subUnitId:c},!1),!0}};class xt extends i.RxDisposable{constructor(e){super();M(this,"_previousActiveRange",null);M(this,"_undoMutationParamsCache",[]);M(this,"_redoMutationParamsCache",[]);this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:n=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:e}=this._undoMutationParamsCache[0],n={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((s,a)=>i.JSONX.compose(s,a.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((s,a)=>i.JSONX.compose(s,a.actions),null),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}const bo={id:"doc.command.ime-input",type:i.CommandType.COMMAND,handler:async(o,t)=>{var L,G,W;const{unitId:e,newText:n,oldTextLen:r,isCompositionEnd:s,isCompositionStart:a}=t,c=o.get(i.ICommandService),l=o.get(B.IRenderManagerService),A=o.get(i.IUniverInstanceService),d=o.get(Ce),u=(L=l.getRenderById(e))==null?void 0:L.with(xt),m=A.getUnit(e,i.UniverInstanceType.UNIVER_DOC);if(m==null||u==null)return!1;const g=u.getActiveRange();if(g==null)return!1;const{style:h,segmentId:p}=g,f=m.getSelfOrHeaderFooterModel(p).getBody();if(f==null)return!1;Object.assign(g,g);const{startOffset:E,endOffset:C}=g,T=n.length,R=[{startOffset:E+T,endOffset:E+T,collapsed:!0,style:h}],v={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:R}},b=d.getDefaultStyle(),x=d.getStyleCache(),y=co((G=f.customRanges)!=null?G:[],E+r,i.SHEET_EDITOR_UNITS.includes(e)),_=sn(f,a?C:E+r,b,x,i.SHEET_EDITOR_UNITS.includes(e)),O=lo((W=f.customDecorations)!=null?W:[],E+r),w=new i.TextX,Q=i.JSONX.getInstance();if(!g.collapsed&&a){const H=i.BuildTextUtils.selection.delete([g],f,0,null,!1);w.push(...H),v.params.textRanges=[{startOffset:E+T,endOffset:E+T,collapsed:!0}]}else w.push({t:i.TextXActionType.RETAIN,len:E});r>0&&w.push({t:i.TextXActionType.DELETE,len:r}),w.push({t:i.TextXActionType.INSERT,body:{dataStream:n,textRuns:_?[{..._,st:0,ed:n.length}]:[],customRanges:y?[{...y,startIndex:0,endIndex:n.length-1}]:[],customDecorations:O.map(H=>({...H,startIndex:0,endIndex:n.length-1}))},len:n.length});const k=J(m,p);v.params.actions=Q.editOp(w.serialize(),k),v.params.noHistory=!s,v.params.isCompositionEnd=s;const F=c.syncExecuteCommand(v.id,v.params);return u.pushUndoRedoMutationParams(F,v.params),!!F}};function Ae(o,t,e){return e.executeCommand(xe.id,{preCommandId:o,...t!=null?t:{}})}const lr="doc.command.set-inline-format-bold",Pe={id:lr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(lr,t,e)}},dr="doc.command.set-inline-format-italic",we={id:dr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(dr,t,e)}},Ar="doc.command.set-inline-format-underline",Ue={id:Ar,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(Ar,t,e)}},ur="doc.command.set-inline-format-strikethrough",Le={id:ur,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(ur,t,e)}},gr="doc.command.set-inline-format-subscript",Re={id:gr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(gr,t,e)}},hr="doc.command.set-inline-format-superscript",Qe={id:hr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(hr,t,e)}},mr="doc.command.set-inline-format-fontsize",he={id:mr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(mr,t,e)}},pr="doc.command.set-inline-format-font-family",_e={id:pr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(pr,t,e)}},fr="doc.command.set-inline-format-text-color",ve={id:fr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(fr,t,e)}},Sr="doc.command.set-inline-format-text-background-color",Ee={id:Sr,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(Sr,t,e)}},Ir="doc.command.reset-inline-format-text-background-color",it={id:Ir,type:i.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(i.ICommandService);return Ae(Ir,t,e)}},jn={[Pe.id]:"bl",[we.id]:"it",[Ue.id]:"ul",[Le.id]:"st",[he.id]:"fs",[_e.id]:"ff",[ve.id]:"cl",[Ee.id]:"bg",[it.id]:"bg",[Re.id]:"va",[Qe.id]:"va"},xe={id:"doc.command.set-inline-format",type:i.CommandType.COMMAND,handler:async(o,t)=>{var R;const{value:e,preCommandId:n}=t,r=o.get(i.ICommandService),s=o.get(D.DocSelectionManagerService),a=o.get(i.IUniverInstanceService),c=o.get(Ce),l=s.getDocRanges(),A=(R=l.find(v=>v.isActive))!=null?R:l[0];if(l.length===0)return!1;const{segmentId:d}=l[0],u=a.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if(u==null)return!1;const m=u.getSelfOrHeaderFooterModel(d).getBody();if(m==null)return!1;const g=u.getUnitId();let h;switch(n){case Pe.id:case we.id:case Ue.id:case Le.id:case Re.id:case Qe.id:{const v=c.getDefaultStyle(),b=mi(m,A,v);h=ra(b,n);break}case he.id:case _e.id:{h=e;break}case ve.id:case Ee.id:{h={rgb:e};break}case it.id:{h={rgb:null};break}default:throw new Error(`Unknown command: ${n} in handleInlineFormat`)}const p={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:l}},f=new i.TextX,S=i.JSONX.getInstance(),E=new i.MemoryCursor;E.reset();for(const v of l){let{startOffset:b,endOffset:x,rangeType:y}=v;if(b==null||x==null)continue;if(y===i.DOC_RANGE_TYPE.RECT&&(b=b-1),b===x){const w=c.getStyleCache(),Q=jn[n];c.setStyleCache({[Q]:(w==null?void 0:w[Q])!==void 0?hi(w,Q,n):h});continue}const _={dataStream:"",textRuns:[{st:0,ed:x-b,ts:{[jn[n]]:h}}]},O=b-E.cursor;O!==0&&f.push({t:i.TextXActionType.RETAIN,len:O}),f.push({t:i.TextXActionType.RETAIN,body:_,len:x-b}),E.reset(),E.moveCursor(x)}const C=J(u,d);return p.params.actions=S.editOp(f.serialize(),C),!!r.syncExecuteCommand(p.id,p.params)}};function oa(o){return o!==null&&typeof o=="object"}function hi(o,t,e){if(/bl|it/.test(t))return(o==null?void 0:o[t])===i.BooleanNumber.TRUE?i.BooleanNumber.FALSE:i.BooleanNumber.TRUE;if(/ul|st/.test(t))return oa(o==null?void 0:o[t])&&(o==null?void 0:o[t]).s===i.BooleanNumber.TRUE?{s:i.BooleanNumber.FALSE}:{s:i.BooleanNumber.TRUE};if(/va/.test(t))return e===Re.id?(o==null?void 0:o[t])===i.BaselineOffset.SUBSCRIPT?i.BaselineOffset.NORMAL:i.BaselineOffset.SUBSCRIPT:(o==null?void 0:o[t])===i.BaselineOffset.SUPERSCRIPT?i.BaselineOffset.NORMAL:i.BaselineOffset.SUPERSCRIPT}function mi(o,t,e){var d,u,m,g,h,p,f,S,E,C,T,R,v,b;const{startOffset:n,endOffset:r,collapsed:s}=t;if(s){const x=(d=o.textRuns)!=null?d:[];let y=null;for(let _=x.length-1;_>=0;_--){const O=x[_];if(O.st<n&&n<=O.ed){y=O;break}}return y!=null&&y.ts?{...e,...y.ts}:e}const{textRuns:a=[]}=i.getBodySlice(o,n,r),c=i.Tools.deepClone(e),l=a.map(x=>{var y;return(y=x==null?void 0:x.ts)==null?void 0:y.fs}).filter(Boolean);c.fs=c.fs?Math.max(c.fs,...l):l.length?Math.max(...l):void 0,c.fs=!c.fs||Number.isNaN(c.fs)?void 0:c.fs,c.ff=(g=(m=(u=a.find(x=>{var y;return((y=x.ts)==null?void 0:y.ff)!=null}))==null?void 0:u.ts)==null?void 0:m.ff)!=null?g:c.ff,c.it=a.length&&a.every(x=>{var y;return((y=x.ts)==null?void 0:y.it)===i.BooleanNumber.TRUE})?i.BooleanNumber.TRUE:i.BooleanNumber.FALSE,c.bl=a.length&&a.every(x=>{var y;return((y=x.ts)==null?void 0:y.bl)===i.BooleanNumber.TRUE})?i.BooleanNumber.TRUE:i.BooleanNumber.FALSE,c.ul=a.length&&a.every(x=>{var y,_;return((_=(y=x.ts)==null?void 0:y.ul)==null?void 0:_.s)===i.BooleanNumber.TRUE})?(h=a[0].ts)==null?void 0:h.ul:c.ul,c.st=a.length&&a.every(x=>{var y,_;return((_=(y=x.ts)==null?void 0:y.st)==null?void 0:_.s)===i.BooleanNumber.TRUE})?(p=a[0].ts)==null?void 0:p.st:c.st,c.bg=(E=(S=(f=a.find(x=>{var y;return((y=x.ts)==null?void 0:y.bg)!=null}))==null?void 0:f.ts)==null?void 0:S.bg)!=null?E:c.bg,c.cl=(R=(T=(C=a.find(x=>{var y;return((y=x.ts)==null?void 0:y.cl)!=null}))==null?void 0:C.ts)==null?void 0:T.cl)!=null?R:c.cl;const A=a.filter(x=>{var y;return((y=x==null?void 0:x.ts)==null?void 0:y.va)!=null});if(A.length>0&&A.length===a.length){const x=(v=A[0].ts)==null?void 0:v.va;let y=!0;for(let _=1;_<A.length;_++)if(((b=A[_].ts)==null?void 0:b.va)!==x){y=!1;break}y&&(c.va=x)}return c}function ra(o,t){const e=jn[t];return hi(o,e,t)}const Ro={id:"doc.command-replace-snapshot",type:i.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,snapshot:n,textRanges:r,segmentId:s="",options:a}=t,c=o.get(i.IUniverInstanceService),l=o.get(i.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,i.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(s).getSnapshot();if(d==null||u==null)return!1;const{body:m,tableSource:g,footers:h,headers:p,lists:f,drawings:S,drawingsOrder:E,documentStyle:C}=i.Tools.deepClone(n),{body:T,tableSource:R,footers:v,headers:b,lists:x,drawings:y,drawingsOrder:_,documentStyle:O}=u;if(m==null||T==null)return!1;if(i.Tools.diffValue(m,T)&&r)return A.replaceDocRanges(r,{unitId:e,subUnitId:e},!1),!0;const w={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:r}};a&&(w.params.options=a);const Q=[],k=i.JSONX.getInstance();if(!i.Tools.diffValue(O,C)){const L=k.replaceOp(["documentStyle"],O,C);L!=null&&Q.push(L)}if(!i.Tools.diffValue(m,T)){const L=k.replaceOp(["body"],T,m);L!=null&&Q.push(L)}if(!i.Tools.diffValue(g,R)){const L=k.replaceOp(["tableSource"],R,g);L!=null&&Q.push(L)}if(!i.Tools.diffValue(h,v)){const L=k.replaceOp(["footers"],v,h);L!=null&&Q.push(L)}if(!i.Tools.diffValue(p,b)){const L=k.replaceOp(["headers"],b,p);L!=null&&Q.push(L)}if(!i.Tools.diffValue(f,x)){const L=k.replaceOp(["lists"],x,f);L!=null&&Q.push(L)}if(!i.Tools.diffValue(S,y)){const L=k.replaceOp(["drawings"],y,S);L!=null&&Q.push(L)}if(!i.Tools.diffValue(E,_)){const L=k.replaceOp(["drawingsOrder"],_,E);L!=null&&Q.push(L)}return w.params.actions=Q.reduce((L,G)=>i.JSONX.compose(L,G),null),!!l.syncExecuteCommand(w.id,w.params)}},pi={id:"doc.command-replace-content",type:i.CommandType.COMMAND,handler:async(o,t)=>{const{unitId:e,body:n,textRanges:r,segmentId:s="",options:a}=t,c=o.get(i.IUniverInstanceService),l=o.get(i.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,i.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(s).getSnapshot().body;if(d==null||u==null)return!1;const m=Si(e,s,d,u,n);return m.params.textRanges=r,a&&(m.params.options=a),m.params.actions==null&&r?(A.replaceDocRanges(r,{unitId:e,subUnitId:e},!1),!0):!!l.syncExecuteCommand(m.id,m.params)}},fi={id:"doc.command-cover-content",type:i.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,segmentId:r="",textRanges:s}=t,a=o.get(i.IUniverInstanceService),c=o.get(i.ICommandService),l=o.get(i.IUndoRedoService),A=a.getUniverDocInstance(e),d=A==null?void 0:A.getSnapshot().body;if(A==null||d==null)return!1;const u=Si(e,r,A,d,n);return u.params.noNeedSetTextRange=!0,u.params.noHistory=!0,u.params.textRanges=s,c.syncExecuteCommand(u.id,u.params),l.clearUndoRedo(e),!0}};function ia(o,t,e,n){const r=new i.TextX,s=i.JSONX.getInstance(),a=(e==null?void 0:e.dataStream.length)-2;a>0&&r.push({t:i.TextXActionType.DELETE,len:a}),n.dataStream.length>0&&r.push({t:i.TextXActionType.INSERT,body:n,len:n.dataStream.length});const c=J(t,o);return s.editOp(r.serialize(),c)}function Si(o,t,e,n,r){const s={id:D.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:[]}},a=ia(t,e,n,r);return s.params.actions=a,s}const xo={id:"doc.command.replace-selection",type:i.CommandType.COMMAND,handler(o,t){var h;if(!t)return!1;const e=o.get(i.ICommandService),{unitId:n,body:r,textRanges:s}=t,c=o.get(i.IUniverInstanceService).getUnit(n),l=o.get(D.DocSelectionManagerService);if(!c)return!1;const A=c.getBody(),d=(h=t.selection)!=null?h:l.getActiveTextRange();if(!d||!A)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:n,actions:[],textRanges:s,debounce:!0}},m=new i.TextX,g=i.JSONX.getInstance();return m.push(...i.BuildTextUtils.selection.delete([d],A,0,r)),u.params.actions=g.editOp(m.serialize()),e.syncExecuteCommand(u.id,u.params)}},Ii={id:"doc.command.replace-text-runs",type:i.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,textRanges:r,segmentId:s="",options:a}=t,c=o.get(i.IUniverInstanceService),l=o.get(i.ICommandService),A=o.get(i.ThemeService),d=c.getUnit(e,i.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(s).getSnapshot().body;if(d==null||u==null)return!1;const m=i.BuildTextUtils.selection.replaceTextRuns({doc:d,body:n,selection:{startOffset:0,endOffset:u.dataStream.length-2,collapsed:!1},themeService:A});if(!m)return!1;const g={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:r,noHistory:!0}},h=i.JSONX.getInstance(),p=J(d,s);return g.params.actions=h.editOp(m.serialize(),p),g.params.textRanges=r,a&&(g.params.options=a),!!l.syncExecuteCommand(g.id,g.params)}},vi={id:"doc.command.insert-custom-range",type:i.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(i.ICommandService),{unitId:n,rangeId:r=i.generateRandomId(),textRanges:s,properties:a,text:c,wholeEntity:l}=t,A={unitId:n,textRanges:s,body:{dataStream:c,customRanges:[{startIndex:0,endIndex:c.length-1,rangeId:r,rangeType:i.CustomRangeType.CUSTOM,properties:a,wholeEntity:l}]}};return e.syncExecuteCommand(xo.id,A)}},st={id:"doc.command.list-operation",type:i.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,b,x,y;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),s=t.listType,a=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),c=(R=(T=t.docRange)!=null?T:e.getDocRanges())!=null?R:[];if(a==null||c.length===0)return!1;const l=c[0].segmentId,A=a.getSelfOrHeaderFooterModel(l),d=(b=(v=A.getBody())==null?void 0:v.paragraphs)!=null?b:[],u=(y=(x=A.getBody())==null?void 0:x.dataStream)!=null?y:"";if(!d.length)return!1;const m=i.BuildTextUtils.range.getParagraphsInRanges(c,d,u),g=a.getUnitId(),h={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:c,isEditing:!1}};new i.MemoryCursor().reset();const f=i.BuildTextUtils.paragraph.bullet.switch({paragraphs:m,listType:s,document:a,segmentId:l}),S=i.JSONX.getInstance(),E=J(a,l);return h.params.actions=S.editOp(f.serialize(),E),!!r.syncExecuteCommand(h.id,h.params)}},Ot={id:"doc.command.change-list-type",type:i.CommandType.COMMAND,handler:(o,t)=>{var C,T,R,v,b;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),{listType:s}=t,a=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),c=(C=t.docRange)!=null?C:e.getDocRanges();if(a==null||c==null||!c.length)return!1;const{segmentId:l}=c[0],A=a.getSelfOrHeaderFooterModel(l),d=(R=(T=A.getBody())==null?void 0:T.paragraphs)!=null?R:[],u=(b=(v=A.getBody())==null?void 0:v.dataStream)!=null?b:"";if(!d.length)return!1;const m=i.BuildTextUtils.range.getParagraphsInRanges(c,d,u),g=a.getUnitId(),h=i.BuildTextUtils.paragraph.bullet.set({paragraphs:m,listType:s,segmentId:l,document:a});if(!h)return!1;const p=i.JSONX.getInstance(),f={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:c,isEditing:!1}},S=J(a,l);return f.params.actions=p.editOp(h.serialize(),S),!!r.syncExecuteCommand(f.id,f.params)}};var pt=(o=>(o[o.increase=1]="increase",o[o.decrease=-1]="decrease",o))(pt||{});const Xt={id:"doc.command.change-list-nesting-level",type:i.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,b,x;if(!t)return!1;const{type:e}=t,n=o.get(D.DocSelectionManagerService),r=o.get(i.IUniverInstanceService),s=o.get(i.ICommandService),a=r.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(a==null||c==null)return!1;const{segmentId:l}=c,A=(T=n.getDocRanges())!=null?T:[],d=a.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(x=(b=d.getBody())==null?void 0:b.dataStream)!=null?x:"";if(!u.length)return!1;const g=i.BuildTextUtils.range.getParagraphsInRange(c,u,m),h=a.getUnitId(),p=i.JSONX.getInstance(),f=i.BuildTextUtils.paragraph.bullet.changeNestLevel({paragraphs:g,type:e,segmentId:l,document:a}),S={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:A,isEditing:!1}},E=J(a,l);return S.params.actions=p.editOp(f.serialize(),E),!!s.syncExecuteCommand(S.id,S.params)}},nt={id:"doc.command.bullet-list",type:i.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(i.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(Ot.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand(st.id,{listType:i.PresetListType.BULLET_LIST,docRange:t==null?void 0:t.docRange})}},vt={id:"doc.command.check-list",type:i.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(i.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(Ot.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand(st.id,{listType:i.PresetListType.CHECK_LIST,docRange:t==null?void 0:t.docRange})}},Oo={id:"doc.command.toggle-check-list",type:i.CommandType.COMMAND,handler:(o,t)=>{var p;if(!t)return!1;const e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService),{index:r,segmentId:s,textRanges:a}=t,c=e.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if(c==null||((p=c.getSelfOrHeaderFooterModel(s).getBody())==null?void 0:p.paragraphs)==null)return!1;const A=c.getUnitId(),d={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:a!=null?a:[],segmentId:s,isEditing:!1}},u=i.BuildTextUtils.paragraph.bullet.toggleChecklist({document:c,paragraphIndex:r,segmentId:s});if(!u)return!1;const m=i.JSONX.getInstance(),g=J(c,s);return d.params.actions=m.editOp(u.serialize(),g),!!n.syncExecuteCommand(d.id,d.params)}},ot={id:"doc.command.order-list",type:i.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(i.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(Ot.id,{listType:t.value}):e.syncExecuteCommand(st.id,{listType:i.PresetListType.ORDER_LIST})}},Mo={id:"doc.command.quick-list",type:i.CommandType.COMMAND,handler(o,t){var O,w,Q;if(!t)return!1;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),s=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),a=e.getActiveTextRange();if(s==null||a==null)return!1;const{segmentId:c,startOffset:l}=a,{listType:A,paragraph:d}=t,{paragraphStart:u,paragraphEnd:m}=d,g=new i.TextX,h=i.JSONX.getInstance(),{paragraphStyle:p={}}=d,S=(i.PRESET_LIST_TYPE[A].nestingLevel[0].paragraphProperties||{}).textStyle;let C=i.generateRandomId(6);const T=(w=(O=s.getBody())==null?void 0:O.paragraphs)!=null?w:[],R=T.findIndex(k=>k.startIndex===d.startIndex),v=T[R-1],b=T[R+1];v&&v.bullet&&v.bullet.listType.indexOf(A)===0?C=v.bullet.listId:b&&b.bullet&&b.bullet.listType.indexOf(A)===0&&(C=b.bullet.listId);const x={id:D.RichTextEditingMutation.id,params:{unitId:s.getUnitId(),actions:[],textRanges:[{startOffset:u,endOffset:u,collapsed:!0}],isEditing:!1}};g.push({t:i.TextXActionType.RETAIN,len:u}),g.push({t:i.TextXActionType.DELETE,len:l-u}),m>l&&g.push({t:i.TextXActionType.RETAIN,len:m-l}),g.push({t:i.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...p,textStyle:{...p.textStyle,...S},indentFirstLine:void 0},bullet:{...(Q=d.bullet)!=null?Q:{nestingLevel:0,textStyle:{fs:20}},listType:A,listId:C}}]}});const y=J(s,c);return x.params.actions=h.editOp(g.serialize(),y),!!r.syncExecuteCommand(x.id,x.params)}};function Do(o,t){var d,u;const e=o.get(i.ICommandService),n=yt(o);if(!n)return!1;const r=o.get(i.IUniverInstanceService).getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC);if(!r)return!1;const s=i.BuildTextUtils.selection.replace({doc:r,selection:{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0},body:{dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:{...n.paragraphStyle},bullet:{listType:t,listId:((d=n.bullet)==null?void 0:d.listType)===t?n.bullet.listId:i.generateRandomId(6),nestingLevel:((u=n.bullet)==null?void 0:u.listType)===t?n.bullet.nestingLevel:0}}]}});if(!s)return!1;const a={id:D.RichTextEditingMutation.id,params:{unitId:r.getUnitId(),actions:[],textRanges:[{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0}],isEditing:!1}},c=i.JSONX.getInstance(),l=J(r);return a.params.actions=c.editOp(s.serialize(),l),!!e.syncExecuteCommand(a.id,a.params)}const Bo={id:"doc.command.insert-bullet-list-bellow",type:i.CommandType.COMMAND,handler:o=>Do(o,i.PresetListType.BULLET_LIST)},_o={id:"doc.command.insert-order-list-bellow",type:i.CommandType.COMMAND,handler:o=>Do(o,i.PresetListType.ORDER_LIST)},No={id:"doc.command.insert-check-list-bellow",type:i.CommandType.COMMAND,handler:o=>Do(o,i.PresetListType.CHECK_LIST)},me={id:"doc.command.align-action",type:i.CommandType.COMMAND,handler:(o,t)=>{var R,v,b,x;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),{alignType:s}=t,a=n.getCurrentUniverDocInstance();if(a==null)return!1;const c=e.getDocRanges();if(c.length===0)return!1;const l=c[0].segmentId,A=a.getSelfOrHeaderFooterModel(l),d=(v=(R=A.getBody())==null?void 0:R.paragraphs)!=null?v:[],u=(x=(b=A.getBody())==null?void 0:b.dataStream)!=null?x:"";if(d==null)return!1;const m=i.BuildTextUtils.range.getParagraphsInRanges(c,d,u),g=a.getUnitId(),h=m.every(y=>{var _;return((_=y.paragraphStyle)==null?void 0:_.horizontalAlign)===s}),p={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:c}},f=new i.MemoryCursor;f.reset();const S=new i.TextX,E=i.JSONX.getInstance();for(const y of m){const{startIndex:_}=y;S.push({t:i.TextXActionType.RETAIN,len:_-f.cursor});const O={...y.paragraphStyle,horizontalAlign:h?i.HorizontalAlign.UNSPECIFIED:s};S.push({t:i.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...y,paragraphStyle:O,startIndex:0}]},coverType:i.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(_+1)}const C=J(a,l);return p.params.actions=E.editOp(S.serialize(),C),!!r.syncExecuteCommand(p.id,p.params)}},Mt={id:"doc.command.align-left",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(me.id,{alignType:i.HorizontalAlign.LEFT})},Dt={id:"doc.command.align-center",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(me.id,{alignType:i.HorizontalAlign.CENTER})},Bt={id:"doc.command.align-right",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(me.id,{alignType:i.HorizontalAlign.RIGHT})},_t={id:"doc.command.align-justify",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(me.id,{alignType:i.HorizontalAlign.JUSTIFIED})},sa=(o,t)=>{const n=o.get(i.IUniverInstanceService).getUnit(t.unitId,i.UniverInstanceType.UNIVER_DOC);return n==null||n.setZoomRatio(t.zoomRatio),{...t}},de={id:"doc.operation.set-zoom-ratio",type:i.CommandType.OPERATION,handler:(o,t)=>{const n=o.get(i.IUniverInstanceService).getUnit(t.unitId,i.UniverInstanceType.UNIVER_DOC);return n?(n.setZoomRatio(t.zoomRatio),!0):!1}},ft={type:i.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(o,t)=>{var u,m,g;const e=o.get(i.ICommandService),n=o.get(i.IUndoRedoService),r=o.get(i.IUniverInstanceService);let s=(u=r.getCurrentUniverDocInstance())==null?void 0:u.getUnitId();if(!s)return!1;let a=1;if(t&&(s=(m=t.documentId)!=null?m:s,a=(g=t.zoomRatio)!=null?g:a),!r.getUniverDocInstance(s))return!1;const l={zoomRatio:a,unitId:s},A=sa(o,l);return e.syncExecuteCommand(de.id,l)?(n.pushUndoRedo({unitID:s,undoMutations:[{id:de.id,params:A}],redoMutations:[{id:de.id,params:l}]}),!0):!1}},ce={id:"doc.command.set-paragraph-named-style",type:i.CommandType.COMMAND,handler(o,t){var h;if(!t)return!1;const n=o.get(i.IUniverInstanceService).getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const r=n.getUnitId(),s=o.get(D.DocSelectionManagerService),a=(h=t.textRanges)!=null?h:s.getTextRanges({unitId:r,subUnitId:r});if(!(a!=null&&a.length))return!1;const c=a[0].segmentId,l=i.BuildTextUtils.paragraph.style.set({document:n.getSelfOrHeaderFooterModel(c),textRanges:a,style:{namedStyleType:t.value,headingId:!t.value||t.value===i.NamedStyleType.NORMAL_TEXT?void 0:i.generateRandomId(6),spaceAbove:void 0,spaceBelow:void 0,lineSpacing:void 0},paragraphTextRun:{}}),A={id:D.RichTextEditingMutation.id,params:{actions:[],textRanges:a,unitId:r,segmentId:c}},d=i.JSONX.getInstance(),u=J(n,c);return A.params.actions=d.editOp(l.serialize(),u),!!o.get(i.ICommandService).syncExecuteCommand(A.id,A.params)}},Ei={id:"doc.command.quick-heading",type:i.CommandType.COMMAND,handler(o,t){var R,v,b,x;if(!t)return!1;const{value:e}=t,n=o.get(D.DocSelectionManagerService),r=o.get(i.IUniverInstanceService),s=o.get(i.ICommandService),a=r.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(a==null||c==null||!c.collapsed)return!1;const{segmentId:l,startOffset:A}=c,d=a.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(x=(b=d.getBody())==null?void 0:b.dataStream)!=null?x:"",g=i.BuildTextUtils.paragraph.util.getParagraphsInRange(c,u,m)[0];if(!g)return!1;const{paragraphStart:h}=g,p=new i.TextX,f=i.JSONX.getInstance(),{paragraphStyle:S={}}=g,E={id:D.RichTextEditingMutation.id,params:{unitId:a.getUnitId(),actions:[],textRanges:[{startOffset:h,endOffset:h,collapsed:!0}],isEditing:!1}};p.push({t:i.TextXActionType.RETAIN,len:h}),i.BuildTextUtils.paragraph.style.set({textRanges:[c],document:a,style:{...S,headingId:i.generateRandomId(6),namedStyleType:e},cursor:A,deleteLen:A-h,textX:p,paragraphTextRun:{}});const C=J(a,l);return E.params.actions=f.editOp(p.serialize(),C),!!s.syncExecuteCommand(E.id,E.params)}},Bn={"#":i.NamedStyleType.HEADING_1,"##":i.NamedStyleType.HEADING_2,"###":i.NamedStyleType.HEADING_3,"####":i.NamedStyleType.HEADING_4,"#####":i.NamedStyleType.HEADING_5},Po={id:"doc.command.h1-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.HEADING_1})},wo={id:"doc.command.h2-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.HEADING_2})},Uo={id:"doc.command.h3-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.HEADING_3})},Lo={id:"doc.command.h4-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.HEADING_4})},Qo={id:"doc.command.h5-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.HEADING_5})},Kt={id:"doc.command.normal-text-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.NORMAL_TEXT})},Ci={id:"doc.command.title",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.TITLE})},Ti={id:"doc.command.subtitle-heading",type:i.CommandType.COMMAND,handler:o=>o.get(i.ICommandService).syncExecuteCommand(ce.id,{value:i.NamedStyleType.SUBTITLE})};var Vt=(o=>(o[o.page=0]="page",o[o.section=1]="section",o[o.column=2]="column",o[o.line=3]="line",o[o.divide=4]="divide",o[o.glyph=5]="glyph",o))(Vt||{});const Ze={page:0,section:1,column:2,line:3,divide:4,glyph:5};function Fo(o,t){return o.page>t.page?!1:o.page<t.page?!0:o.section>t.section?!1:o.section<t.section?!0:o.column>t.column?!1:o.column<t.column?!0:o.line>t.line?!1:o.line<t.line?!0:o.divide>t.divide?!1:o.divide<t.divide?!0:o.glyph>t.glyph?!1:(o.glyph<t.glyph,!0)}function Wn(o,t){return Fo(o,t)?{start:o,end:t}:{start:t,end:o}}function Gn(o){const t=o.length;if(t===0)return;const e=o[0],n=o[t-1],r=o.length===1&&e.collapsed;return{startOffset:e.startOffset,endOffset:n.endOffset,collapsed:r}}function aa(o,t,e,n){let r=n,s=n;for(let a=0;a<o.length;a++){const l=o[a].count;a<t&&(r+=l),a<e&&(s+=l)}return{startOffset:r,endOffset:s}}function Xn(o){const{startX:t,startY:e,endX:n,endY:r}=o,s=[];return s.push({x:t,y:e}),s.push({x:n,y:e}),s.push({x:n,y:r}),s.push({x:t,y:r}),s.push({x:t,y:e}),s}class Te{constructor(t,e){M(this,"_liquid",new B.Liquid);M(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});M(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],r=[],s=[];if(t==null||e==null)return{borderBoxPointGroup:n,contentBoxPointGroup:r,cursorList:s};if(!this._isValidPosition(t,e))throw new Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);const{start:c,end:l}=Wn(t,e);return this._selectionIterator(c,l,(A,d,u,m,g,h)=>{const{lineHeight:p,asc:f,paddingTop:S,marginTop:E,marginBottom:C}=h,{glyphGroup:T,st:R}=g;if(T.length===0)return;const{x:v,y:b}=this._liquid;let x,y;const _=T[A],O=T[d],w=T[A-1],Q=(_==null?void 0:_.left)||0,k=(_==null?void 0:_.width)||0,F=(O==null?void 0:O.left)||0,L=(O==null?void 0:O.width)||0,G=(_==null?void 0:_.glyphType)===B.GlyphType.LIST,{startOffset:W,endOffset:H}=aa(T,A,d,R),V=c.glyph===A&&u?c.isBack:!0,j=l.glyph===d&&m?l.isBack:!1,X=c===l,z=V&&w!=null?w:_;if(A===0&&d===T.length-1)x={startX:v+Q+(G?k:0),startY:b,endX:v+F+(j?0:L),endY:b+p-E-C},y={startX:v+Q+(G?k:0),startY:b+S+f-z.bBox.ba,endX:v+F+(j?0:L),endY:b+S+f+z.bBox.bd};else{const Y=V&&!G;x={startX:v+Q+(Y?0:k),startY:b,endX:v+F+(j?0:L),endY:b+p-E-C},y={startX:v+Q+(Y?0:k),startY:b+S+f-z.bBox.ba,endX:v+F+(j?0:L),endY:b+S+f+z.bBox.bd}}n.push(Xn(x)),r.push(Xn(y)),s.push({startOffset:V?W:W+_.count,endOffset:j?H:H+O.count,collapsed:X})}),{borderBoxPointGroup:n,contentBoxPointGroup:r,cursorList:s}}_isValidPosition(t,e){const{segmentPage:n,pageType:r}=t,{segmentPage:s,pageType:a}=e;return r!==a?!1:r===B.DocumentSkeletonPageType.HEADER||r===B.DocumentSkeletonPageType.FOOTER?n===s:!0}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(t=0,e,n,r){r===e?this._currentStartState[t]=1:this._currentStartState[t]=0,r===n?this._currentEndState[t]=2:this._currentEndState[t]=0}_checkPreviousNodePositionState(t,e=!0){let n=t,r;for(;n>=0;){const s=Vt[n];let a;if(e?a=this._currentStartState[s]:a=this._currentEndState[s],a===void 0)return;if(r===void 0&&(r=a),a!==r)return 0;n--}return r}_getSelectionRuler(t,e,n,r,s){let a=0,c=r;const l=Vt[t],A=Vt[t+1];if(A===null||l===null)return{start_next:a,end_next:c};const d=e[l],u=n[l];this._setNodePositionState(l,d,u,s);const m=this._checkPreviousNodePositionState(t),g=this._checkPreviousNodePositionState(t,!1);return m===1&&(a=e[A]),g===2&&(c=n[A]),{start_next:a,end_next:c}}_selectionIterator(t,e,n){var T,R;const r=this._docSkeleton;if(!r)return[];const{pageType:s,path:a}=t;this._liquid.reset();const c=r.getSkeletonData();if(c==null)return[];const{pages:l,skeHeaders:A,skeFooters:d}=c,{page:u,segmentPage:m}=t,{page:g,segmentPage:h}=e;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:p,pageMarginLeft:f,pageMarginTop:S}=this._documentOffsetConfig,E=s===B.DocumentSkeletonPageType.BODY||s===B.DocumentSkeletonPageType.CELL?u:m;for(let v=0;v<E;v++){const b=l[v];this._liquid.translatePage(b,p,f,S)}const C=s===B.DocumentSkeletonPageType.BODY||s===B.DocumentSkeletonPageType.CELL?g:h;for(let v=E;v<=C;v++){const b=l[v],{headerId:x,footerId:y,pageWidth:_}=b;let O=b;if(s===B.DocumentSkeletonPageType.HEADER?O=(T=A.get(x))==null?void 0:T.get(_):s===B.DocumentSkeletonPageType.FOOTER?O=(R=d.get(y))==null?void 0:R.get(_):s===B.DocumentSkeletonPageType.CELL&&(O=B.getPageFromPath(c,a)),O==null){this._liquid.translatePage(b,p,f,S);continue}const w=O.sections,{start_next:Q,end_next:k}=this._getSelectionRuler(Ze.page,t,e,w.length-1,s===B.DocumentSkeletonPageType.BODY||s===B.DocumentSkeletonPageType.CELL?v:0);switch(this._liquid.translateSave(),s){case B.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...O,marginLeft:b.marginLeft});break;case B.DocumentSkeletonPageType.FOOTER:{const F=b.pageHeight-O.height-O.marginBottom;this._liquid.translate(b.marginLeft,F);break}case B.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(b);const F=O.parent,L=F.parent,{left:G}=O,{top:W,left:H}=L,{top:V}=F;this._liquid.translate(H+G,W+V),this._liquid.translatePagePadding(O);break}default:this._liquid.translatePagePadding(b);break}for(let F=Q;F<=k;F++){const L=w[F],G=L.columns,{start_next:W,end_next:H}=this._getSelectionRuler(Ze.section,t,e,G.length-1,F);this._liquid.translateSection(L);for(let V=W;V<=H;V++){const j=G[V],X=j.lines,{start_next:z,end_next:Y}=this._getSelectionRuler(Ze.column,t,e,X.length-1,V);this._liquid.translateColumn(j);for(let K=z;K<=Y;K++){const Z=X[K],{divides:ne}=Z,{start_next:ue,end_next:Me}=this._getSelectionRuler(Ze.line,t,e,ne.length-1,K);this._liquid.translateSave(),this._liquid.translateLine(Z,!0,!1);for(let ge=ue;ge<=Me;ge++){const xn=ne[ge];this._liquid.translateSave(),this._liquid.translateDivide(xn);const{glyphGroup:gs}=xn,{start_next:hs,end_next:ms}=this._getSelectionRuler(Ze.divide,t,e,gs.length-1,ge);let tr=!1,nr=!1;v===E&&F===Q&&V===W&&K===z&&ge===ue&&(tr=!0),v===C&&F===k&&V===H&&K===Y&&ge===Me&&(nr=!0),n&&n(hs,ms,tr,nr,xn,Z,j,L,O),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(b,p,f,S)}}}function yi(o,t){const{path:e}=o,{path:n}=t;if(e.length!==n.length||e.indexOf("cells")===-1)return!1;const r=e.indexOf("skeTables")+1,s=e.indexOf("rows")+1,a=e.indexOf("cells")+1,{tableId:c,sliceIndex:l}=B.getTableIdAndSliceIndex(e[r]),{tableId:A,sliceIndex:d}=B.getTableIdAndSliceIndex(n[r]);if(c!==A)return!1;const u=e[s],m=n[s],g=e[a],h=n[a];return!(u===m&&g===h&&l===d)}function Ho(o,t){const{path:e}=o,{path:n}=t;return e.indexOf("cells")===-1||n.indexOf("cells")===-1||e.length!==n.length?!1:i.Tools.diffValue(e,n)}function bi(o,t,e){var g,h,p,f,S,E,C,T;const{path:n}=t,{path:r}=e;if(n.indexOf("cells")===-1||r.indexOf("cells")===-1)return!1;const s=o.findGlyphByPosition(t),a=o.findGlyphByPosition(e),c=(f=(p=(h=(g=s==null?void 0:s.parent)==null?void 0:g.parent)==null?void 0:h.parent)==null?void 0:p.parent)==null?void 0:f.parent,l=(T=(C=(E=(S=a==null?void 0:a.parent)==null?void 0:S.parent)==null?void 0:E.parent)==null?void 0:C.parent)==null?void 0:T.parent;if(c==null||l==null)return!1;const A=c.parent,d=l.parent,u=A.cells.indexOf(c),m=d.cells.indexOf(l);return u===m&&A.index===d.index}function _n(o,t){if(Ho(o,t))return Fo(o,t);const{path:e}=o,{path:n}=t,r=e[e.length-5],s=n[n.length-5];if(r!==s&&typeof r=="string"&&typeof s=="string"){const d=r.split("#-#")[1],u=s.split("#-#")[1];return+d<+u}const a=e[e.length-3],c=n[n.length-3],l=e[e.length-1],A=n[n.length-1];return a<c?!0:a>c?!1:l<=A}function Ke(o){return o.sections[0].columns[0].lines.length===0}function ca(o,t,e){let n=t,r=e,s=o[n],a=o[r];for(;n<r&&(Ke(s)||Ke(a));)Ke(s)?(n++,s=o[n]):Ke(a)&&(r--,a=o[r]);if(!Ke(s)&&!Ke(a))return[s,a]}class ko{constructor(t,e){M(this,"_liquid",new B.Liquid);this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],s=this._docSkeleton.getSkeletonData();if(s==null)return;const{pages:a}=s,{segmentPage:c,page:l,pageType:A}=t,d=this._getTableRectRangeInfo(t,e);if(d==null)return;const{tableId:u,startRowIndex:m,startColumnIndex:g,endRowIndex:h,endColumnIndex:p}=d;this._liquid.reset();const{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:E}=this._documentOffsetConfig,C=A===B.DocumentSkeletonPageType.BODY||A===B.DocumentSkeletonPageType.CELL?l:c;for(let T=0;T<C;T++){const R=a[T];this._liquid.translatePage(R,f,S,E)}for(let T=C;T<a.length;T++){const R=a[T];this._liquid.translatePagePadding(R);const{skeTables:v}=R;let b=null;for(const[O,w]of v.entries())O.startsWith(u)&&(b=w);if(b==null){this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E);continue}this._liquid.translateSave(),this._liquid.translate(0,b.top);const{x,y}=this._liquid,{left:_}=b;for(const O of b.rows)if(O.index>=m&&O.index<=h){const w=ca(O.cells,g,p);if(w==null)continue;const[Q,k]=w,F={startX:x+Q.left+_,startY:y+O.top,endX:x+k.left+k.pageWidth+_,endY:y+O.top+O.height};n.push(Xn(F))}this._liquid.translateRestore(),this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E)}return{pointGroup:n,startRow:m,startColumn:g,endRow:h,endColumn:p,tableId:u}}getNodePositionGroup(t,e){const n=[],r=this._docSkeleton.findCharIndexByPosition(t),s=this._docSkeleton.findCharIndexByPosition(e);if(r==null||s==null)return;const a=r<s,c=this._getTableRectRangeInfo(t,e);if(c==null)return;const{tableId:l,startRowIndex:A,startColumnIndex:d,endRowIndex:u,endColumnIndex:m}=c,g=this._docSkeleton.getViewModel().findTableNodeById(l);if(g==null)return;const h=g.children[0].children.length;if(d===0&&m===h-1){const f=g.children[A].children[d],S=this._docSkeleton.findNodePositionByCharIndex(f.startIndex+1),E=g.children[u].children[m],C=this._docSkeleton.findNodePositionByCharIndex(E.endIndex-2);if(S==null||C==null)return;n.push({anchor:a?S:C,focus:a?C:S})}else for(let f=A;f<=u;f++){const S=g.children[f],E=S.children[d],C=S.children[m],T=this._docSkeleton.findNodePositionByCharIndex(E.startIndex+1),R=this._docSkeleton.findNodePositionByCharIndex(C.endIndex-2);if(T==null||R==null)return;n.push({anchor:a?T:R,focus:a?R:T})}return n}_getTableRectRangeInfo(t,e){const r=this._docSkeleton.getSkeletonData();if(r==null)return;const{pages:s}=r,{path:a}=t,{path:c}=e,l=B.getPageFromPath(r,a),A=B.getPageFromPath(r,c);if(l==null||A==null)return;const d=l.segmentId,u=l.parent.index,m=l.parent.cells.indexOf(l),g=(A==null?void 0:A.parent).index,h=(A==null?void 0:A.parent).cells.indexOf(A),p=Math.min(u,g),f=Math.max(u,g),S=Math.min(m,h),E=Math.max(m,h);return{pages:s,tableId:d,startRowIndex:p,startColumnIndex:S,endRowIndex:f,endColumnIndex:E}}}const la="__TestSelectionRange__",da="__TestSelectionAnchor__",vr=6,Nn=500,Aa=500,zt=3;function St(o){const t=o[0],e=t[0],n=t[2],{x:r,y:s}=e,{x:a,y:c}=n;return{left:r,top:s,width:a-r,height:c-s}}function Sn(o){return o.map(t=>{let e=1/0,n=-1/0,r=1/0,s=-1/0;return t.forEach(a=>{e=Math.min(a.x,e),n=Math.max(a.x,n),s=Math.max(a.y,s),r=Math.min(a.y,r)}),{left:e,right:n,top:r,bottom:s}})}class je{constructor(t,e,n,r,s,a=B.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){M(this,"rangeType",i.DOC_RANGE_TYPE.TEXT);M(this,"_current",!1);M(this,"_rangeShape");M(this,"_anchorShape");M(this,"_cursorList",[]);M(this,"_anchorBlinkTimer",null);this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=r,this.focusNodePosition=s,this.style=a,this._segmentId=c,this._segmentPage=l,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},Nn),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},Nn))},Aa+Nn)}get startOffset(){var r;const{startOffset:t}=(r=Gn(this._cursorList))!=null?r:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(n,t)}get endOffset(){var r;const{endOffset:t}=(r=Gn(this._cursorList))!=null?r:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(t,n)}get collapsed(){const{startOffset:t,endOffset:e}=this;return t!=null&&t===e}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:t}=Wn(this.anchorNodePosition,this.focusNodePosition);return t}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:t}=Wn(this.anchorNodePosition,this.focusNodePosition);return t}get direction(){const{collapsed:t,anchorNodePosition:e,focusNodePosition:n}=this;return t||e==null||n==null?i.RANGE_DIRECTION.NONE:Fo(e,n)?i.RANGE_DIRECTION.FORWARD:i.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(this._isEmpty())return;const n=this._document.getOffsetConfig(),{docsLeft:r,docsTop:s}=n,a=new Te(n,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup:d,cursorList:u}=a.getRangePointData(t,t);if(this._setCursorList(u),d.length===0)return;const m=St(d);return{...m,left:m.left+r,top:m.top+s}}const{borderBoxPointGroup:c,cursorList:l}=a.getRangePointData(t,e);if(this._setCursorList(l),c.length===0)return;const A=St(c);return{...A,left:A.left+r,top:A.top+s}}getAnchor(){return this._anchorShape}activeStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.strokeActive)||B.getColor(i.COLORS.black,1)})}deactivateStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.stroke)||B.getColor(i.COLORS.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t,e;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null,(e=this._anchorShape)==null||e.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(t){const{startOffset:e,endOffset:n}=this,{startOffset:r,endOffset:s}=t;return e==null||n==null||r==null||s==null?!1:e<=s&&n>=r}refresh(){var u,m;const{_document:t,_docSkeleton:e}=this,n=this.anchorNodePosition,r=this.focusNodePosition;if((u=this._anchorShape)==null||u.hide(),(m=this._rangeShape)==null||m.hide(),this._isEmpty())return;const s=t.getOffsetConfig(),{docsLeft:a,docsTop:c}=s,l=new Te(s,e);if(this._isCollapsed()){const{contentBoxPointGroup:g,cursorList:h}=l.getRangePointData(n,n);if(this._setCursorList(h),g.length>0){const p=e.findGlyphByPosition(n);this._createOrUpdateAnchor(g,a,c,p)}return}const{borderBoxPointGroup:A,cursorList:d}=l.getRangePointData(n,r);this._setCursorList(d),A.length>0&&this._createOrUpdateRange(A,a,c)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(t!=null&&e==null)return!0;if(t==null||e==null)return!1;const n=Object.keys(Ze);for(const r of n){const s=t[r],a=e[r];if(s!==a)return!1}return t.isBack===e.isBack}_createOrUpdateRange(t,e,n){var a;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const r=.3,s=new B.RegularPolygon(la+i.generateRandomId(vr),{pointsGroup:t,fill:((a=this.style)==null?void 0:a.fill)||B.getColor(i.COLORS.black,r),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=s,this._scene.addObject(s,zt)}_createOrUpdateAnchor(t,e,n,r){var p,f,S;const s=St(t),{left:a}=s;let{top:c,height:l}=s;const A=14;l<A&&(c-=A-l,l=A);const d=12;let u=a+e;const m=c+n,g=((p=r==null?void 0:r.ts)==null?void 0:p.it)===i.BooleanNumber.TRUE;if(g&&(u+=l*Math.tan(d*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:u,top:m,height:l}),this._anchorShape.show(),g?this._anchorShape.skew(-d,0):this._anchorShape.skew(0,0);return}const h=new B.Rect(da+i.generateRandomId(vr),{left:u,top:m,height:l,strokeWidth:((f=this.style)==null?void 0:f.strokeWidth)||1,stroke:((S=this.style)==null?void 0:S.strokeActive)||B.getColor(i.COLORS.black,1),evented:!1});g&&h.skew(-d,0),this._anchorShape=h,this._scene.addObject(h,zt),this.activeStatic()}_setCursorList(t){t.length!==0&&(this._cursorList=t)}}const ua="__DocTableRectRange__",ga=6;function jt(o,t,e,n,r,s=B.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,a="",c=-1){const l=t.getOffsetConfig(),d=new ko(l,e).getNodePositionGroup(n,r);return(d!=null?d:[]).map(u=>new Vo(o,t,e,u.anchor,u.focus,s,a,c))}class Vo{constructor(t,e,n,r,s,a=B.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){M(this,"rangeType",i.DOC_RANGE_TYPE.RECT);M(this,"_rangeShape");M(this,"_current",!1);M(this,"_startRow");M(this,"_startCol");M(this,"_endRow");M(this,"_endCol");M(this,"_tableId");this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=r,this.focusNodePosition=s,this.style=a,this._segmentId=c,this._segmentPage=l,this.refresh()}get startOffset(){const{startNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get endOffset(){const{endNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var a;const e=(a=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:a[this._tableId],{_startCol:n,_endCol:r}=this;if(e==null)throw new Error("Table is not found.");const{tableColumns:s}=e;return n===0&&r===s.length-1}get spanEntireColumn(){var a;const e=(a=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:a[this._tableId],{_startRow:n,_endRow:r}=this;if(e==null)throw new Error("Table is not found.");const{tableRows:s}=e;return n===0&&r===s.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return _n(t,e)?t:e}get endNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return _n(t,e)?e:t}get direction(){const{anchorNodePosition:t,focusNodePosition:e}=this;return _n(t,e)?i.RANGE_DIRECTION.FORWARD:i.RANGE_DIRECTION.BACKWARD}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null}isIntersection(t){const{startRow:e,startColumn:n,endRow:r,endColumn:s}=this,{startRow:a,startColumn:c,endRow:l,endColumn:A}=t,d={left:n,top:e,right:s,bottom:r},u={left:c,top:a,right:A,bottom:l};return i.Rectangle.hasIntersectionBetweenTwoRect(d,u)}refresh(){var f;(f=this._rangeShape)==null||f.hide();const{startNodePosition:t,endNodePosition:e,_document:n,_docSkeleton:r}=this,s=n.getOffsetConfig(),{docsLeft:a,docsTop:c}=s,A=new ko(s,r).getRangePointData(t,e);if(A==null)return;const{pointGroup:d=[],startRow:u,endRow:m,startColumn:g,endColumn:h,tableId:p}=A;(d==null?void 0:d.length)>0&&this._createOrUpdateRange(d,a,c),this._updateTableInfo(u,m,g,h,p)}_updateTableInfo(t,e,n,r,s){this._startRow=t,this._endRow=e,this._startCol=n,this._endCol=r,this._tableId=s}_createOrUpdateRange(t,e,n){var a;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const r=.3,s=new B.RegularPolygon(ua+i.generateRandomId(ga),{pointsGroup:t,fill:((a=this.style)==null?void 0:a.fill)||B.getColor(i.COLORS.black,r),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=s,this._scene.addObject(s,zt)}}function Er(o,t,e,n,r,s,a,c,l=!0,A=!0){const d=r.findNodePositionByCharIndex(o,l,a,c),u=r.findNodePositionByCharIndex(t,A,a,c);if(!(d==null||u==null))return new je(e,n,r,d,u,s,a,c)}function ha(o,t,e,n,r,s,a,c){const l=r.findNodePositionByCharIndex(o,!0,a,c),A=r.findNodePositionByCharIndex(t,!0,a,c);if(!(l==null||A==null))return new Vo(e,n,r,l,A,s,a,c)}function ma(o,t,e,n,r,s,a,c){const l=r.findNodePositionByCharIndex(o,!0,a,c),A=r.findNodePositionByCharIndex(t,!0,a,c);if(!(l==null||A==null))return Kn(l,A,e,n,r,s,a,c)}function Kn(o,t,e,n,r,s,a,c){const l=[],A=[],d=[e,n,r,o,t,s,a,c];if(bi(r,o,t)){if(Ho(o,t))return l.push(new je(...d)),{textRanges:l,rectRanges:A};{const C=jt(...d);return A.push(...C),{textRanges:l,rectRanges:A}}}if(yi(o,t)){const C=jt(...d);return A.push(...C),{textRanges:l,rectRanges:A}}const u=r.getViewModel().getSelfOrHeaderFooterViewModel(a),m=r.findCharIndexByPosition(o),g=r.findCharIndexByPosition(t);if(m==null||g==null)return;const h=m<=g?i.RANGE_DIRECTION.FORWARD:i.RANGE_DIRECTION.BACKWARD,p=Math.min(m,g),f=Math.max(m,g);let S=p,E=f;for(const C of u.getChildren())for(const T of C.children){const{startIndex:R,endIndex:v,children:b}=T,x=C.children.indexOf(T),y=C.children[x+1],_=b[0];let O=!1;if(_){const{startIndex:w,endIndex:Q,children:k}=_;let F=null,L=null;const G=k.find(H=>H.startIndex<=p&&H.endIndex>=p),W=k.find(H=>H.startIndex<=f&&H.endIndex>=f);if(p>w&&p<Q)F=r.findNodePositionByCharIndex(G.startIndex+2,!0,a,c),L=r.findNodePositionByCharIndex(Q-4,!0,a,c),S=Q+1;else if(f>w&&f<Q)F=r.findNodePositionByCharIndex(w+3,!0,a,c),L=r.findNodePositionByCharIndex(W.endIndex-3,!0,a,c),E=w-1,O=!0;else if(w>p&&Q<f){if(F=r.findNodePositionByCharIndex(w+3,!0,a,c),L=r.findNodePositionByCharIndex(Q-4,!0,a,c),S<=w-1){const H=r.findNodePositionByCharIndex(S,!0,a,c),V=r.findNodePositionByCharIndex(w-1,!1,a,c),j=h===i.RANGE_DIRECTION.FORWARD?H:V,X=h===i.RANGE_DIRECTION.FORWARD?V:H;l.push(new je(e,n,r,j,X,s,a,c))}S=Q+1}if(F&&L){const H=h===i.RANGE_DIRECTION.FORWARD?F:L,V=h===i.RANGE_DIRECTION.FORWARD?L:F;A.push(...jt(e,n,r,H,V,s,a,c))}}if(E===v+1&&!O&&y&&y.children.length&&(E=v,O=!0),E>=R&&E<=v||O){const w=r.findNodePositionByCharIndex(S,!0,a,c),Q=r.findNodePositionByCharIndex(E,!O,a,c),k=h===i.RANGE_DIRECTION.FORWARD?w:Q,F=h===i.RANGE_DIRECTION.FORWARD?Q:w;if(A.length&&i.Tools.diffValue(k,F))continue;l.push(new je(e,n,r,k,F,s,a,c))}}return{textRanges:l,rectRanges:A}}function Ri(o){const t=o==null?void 0:o.getCanvasElement();if(!t)return{left:0,top:0};const{top:e,left:n}=B.getOffsetRectForDom(t);return{left:n,top:e}}function Cr(o){var l;const t=(l=o.parent)==null?void 0:l.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const{paragraphIndex:n}=t,r=e.lines.filter(A=>A.paragraphIndex===n);let s=-1,a="",c=!1;for(const A of r)for(const d of A.divides)for(const u of d.glyphGroup)c||(s+=u.count),u===o&&(c=!0),a+=u.count>0?u.content:"";return{st:r[0].st,ed:n,content:a,nodeIndex:s}}function zn(o){const{startOffset:t,endOffset:e,collapsed:n,rangeType:r,startNodePosition:s,endNodePosition:a,direction:c,segmentId:l,segmentPage:A}=o;return{startOffset:t,endOffset:e,collapsed:n,rangeType:r,startNodePosition:s,endNodePosition:a,direction:c,segmentId:l,segmentPage:A,isActive:o.isActive()}}function pa(o){const t=zn(o),{startRow:e,startColumn:n,endRow:r,endColumn:s,tableId:a,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}=o;return{...t,startRow:e,startColumn:n,endRow:r,endColumn:s,tableId:a,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}}var fa=Object.getOwnPropertyDescriptor,Sa=(o,t,e,n)=>{for(var r=n>1?void 0:n?fa(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},wt=(o,t)=>(e,n)=>t(e,n,o);exports.DocSelectionRenderService=class extends i.RxDisposable{constructor(e,n,r,s,a){super();M(this,"_onInputBefore$",new U.Subject);M(this,"onInputBefore$",this._onInputBefore$.asObservable());M(this,"_onKeydown$",new U.Subject);M(this,"onKeydown$",this._onKeydown$.asObservable());M(this,"_onInput$",new U.Subject);M(this,"onInput$",this._onInput$.asObservable());M(this,"_onCompositionstart$",new U.BehaviorSubject(null));M(this,"onCompositionstart$",this._onCompositionstart$.asObservable());M(this,"_onCompositionupdate$",new U.BehaviorSubject(null));M(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable());M(this,"_onCompositionend$",new U.BehaviorSubject(null));M(this,"onCompositionend$",this._onCompositionend$.asObservable());M(this,"_onSelectionStart$",new U.BehaviorSubject(null));M(this,"onSelectionStart$",this._onSelectionStart$.asObservable());M(this,"onChangeByEvent$",U.merge(this._onInput$,this._onKeydown$.pipe(U.filter(e=>e.event.keyCode===I.KeyCode.BACKSPACE)),this._onCompositionend$));M(this,"_onPaste$",new U.Subject);M(this,"onPaste$",this._onPaste$.asObservable());M(this,"_textSelectionInner$",new U.BehaviorSubject(null));M(this,"textSelectionInner$",this._textSelectionInner$.asObservable());M(this,"_onFocus$",new U.Subject);M(this,"onFocus$",this._onFocus$.asObservable());M(this,"_onBlur$",new U.Subject);M(this,"onBlur$",this._onBlur$.asObservable());M(this,"_onPointerDown$",new U.Subject);M(this,"onPointerDown$",this._onPointerDown$.asObservable());M(this,"_container");M(this,"_inputParent");M(this,"_input");M(this,"_scrollTimers",[]);M(this,"_rangeList",[]);M(this,"_rangeListCache",[]);M(this,"_rectRangeList",[]);M(this,"_rectRangeListCache",[]);M(this,"_anchorNodePosition",null);M(this,"_focusNodePosition",null);M(this,"_currentSegmentId","");M(this,"_currentSegmentPage",-1);M(this,"_selectionStyle",B.NORMAL_TEXT_SELECTION_PLUGIN_STYLE);M(this,"_onPointerEvent",!1);M(this,"_viewPortObserverMap",new Map);M(this,"_isIMEInputApply",!1);M(this,"_scenePointerMoveSubs",[]);M(this,"_scenePointerUpSubs",[]);M(this,"_reserveRanges",!1);this._context=e,this._layoutService=n,this._logService=r,this._univerInstanceService=s,this._docSkeletonManagerService=a,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||document.activeElement===null}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_DOC).pipe(U.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;e.getUnitId()!==this._context.unitId&&!this._reserveRanges&&this.removeAllRanges()})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=B.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,n=!0,r){const{_currentSegmentId:s,_currentSegmentPage:a,_selectionStyle:c}=this,{scene:l,mainComponent:A}=this._context,d=A,u=this._docSkeletonManagerService.getSkeleton(),m=(g,h)=>{const p=ma(g,h,l,d,u,c,s,a);if(p==null)return;const{textRanges:f,rectRanges:S}=p;for(const E of f)this._addTextRange(E);this._addRectRanges(S)};for(const g of e){const{startOffset:h,endOffset:p,rangeType:f,startNodePosition:S,endNodePosition:E}=g;if(f===i.DOC_RANGE_TYPE.RECT){const C=ha(h,p,l,d,u,c,s,a);C&&this._addRectRanges([C])}else if(f===i.DOC_RANGE_TYPE.TEXT)try{let C=null;S&&E?C=Er(S.isBack?h:h-1,E.isBack?p:p-1,l,d,u,c,s,a,S.isBack,E.isBack):C=Er(h,p,l,d,u,c,s,a),C&&this._addTextRange(C)}catch{m(h,p)}else m(h,p)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:s,segmentPage:a,style:c,isEditing:n,options:r}),!(!e.length||(r==null?void 0:r.shouldFocus)===!1)&&this._updateInputPosition(r==null?void 0:r.forceFocus)}setCursorManually(e,n){const r=this._findNodeByCoord(e,n,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),s=this._getNodePosition(r);if(s==null){this._removeAllRanges();return}(r==null?void 0:r.node.streamType)===i.DataStreamTreeTokenType.PARAGRAPH&&(s.isBack=!0),this._createTextRangeByAnchorPosition(s),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,n,r=!1){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",(this.canFocusing||r)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){const{offsetX:n,offsetY:r}=e,s=this._findNodeByCoord(n,r,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(s==null||s.node==null)return;const a=Cr(s.node);if(a==null)return;const{content:c,st:l,nodeIndex:A}=a;if(A===-1||Intl.Segmenter==null)return;const u=new Intl.Segmenter(void 0,{granularity:"word"}).segment(c);let m=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(const{segment:h,index:p,isWordLike:f}of u)if(p<=A&&A<p+h.length&&f){m=p+l,g=p+l+h.length;break}if(Number.isFinite(m)&&Number.isFinite(g)){this.removeAllRanges();const h=[{startOffset:m,endOffset:g}];this.addDocRanges(h,!1,{forceFocus:!0})}}__handleTripleClick(e){const{offsetX:n,offsetY:r}=e,s=this._findNodeByCoord(n,r,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(s==null||s.node==null)return;const a=Cr(s.node);if(a==null)return;this.removeAllRanges();const{st:c,ed:l}=a,A=[{startOffset:c,endOffset:l}];this.addDocRanges(A,!1,{forceFocus:!0})}__onPointDown(e){var f,S;const{scene:n,mainComponent:r}=this._context,s=this._docSkeletonManagerService.getSkeleton(),{offsetX:a,offsetY:c}=e,l=this._findNodeByCoord(a,c,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(A==null||l==null){this._removeAllRanges();return}(l==null?void 0:l.node.streamType)===i.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);const d=this._textSelectionInner$.value;if(l&&e.button===2&&d){const E=s.findCharIndexByPosition(A);if(typeof E=="number"&&d.textRanges.some(C=>C.startOffset<=E&&C.endOffset>E)||typeof E=="number"&&d.rectRanges.some(C=>C.startOffset<=E&&C.endOffset>=E))return}const{segmentId:u,segmentPage:m}=l;u&&this._currentSegmentId&&u!==this._currentSegmentId&&this.setSegment(u),u&&m!==this._currentSegmentPage&&this.setSegmentPage(m),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),n.disableObjectsEvent();const g=B.ScrollTimer.create(n);this._scrollTimers.push(g),g.startScroll(a,c),this._onSelectionStart$.next((f=this._getActiveRangeInstance())==null?void 0:f.startNodePosition),(S=n.getTransformer())==null||S.clearSelectedObjects();let h=a,p=c;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(n.onPointerMove$.subscribeEvent(E=>{const{offsetX:C,offsetY:T}=E;n.setCursor(B.CURSOR_TYPE.TEXT),!(Math.sqrt((C-h)**2+(T-p)**2)<3)&&(this._moving(C,T),g.scrolling(C,T,()=>{this._moving(C,T)}),h=C,p=T)})),this._scenePointerUpSubs.push(n.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(C=>{C.unsubscribe()}),this._onPointerEvent=!1,n.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}const C=new je(n,r,s,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(C)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const C of this._rangeListCache)e.ctrlKey?C.collapsed?C.dispose():this._addTextRange(C):this._addTextRange(C);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const E={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(E),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{e==null||e.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r:e,g:n,b:r,a:s}=B.getSystemHighlightColor(),a={strokeWidth:1,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${n}, ${r}, ${s!=null?s:.3})`};this._setRangeStyle(a)}_getAllTextRanges(){return this._rangeList.map(zn)}_getAllRectRanges(){return this._rectRangeList.map(pa)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const e=this._rangeList.find(s=>s.isActive());if(e==null)return null;const{startOffset:n,endOffset:r}=e;return n==null||r==null?null:zn(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId:e}=this._context,n=document.createElement("div");n.style.position="fixed",n.style.left="0px",n.style.top="0px",n.id=`univer-doc-selection-container-${e}`;const r=document.createElement("div"),s=document.createElement("div");r.appendChild(s),n.appendChild(r),this._container=n,this._inputParent=r,this._input=s,this._initInput(),this._initInputEvents(),document.body.appendChild(n)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.dataset.uComp="editor",this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(e==null)return;const{node:n,ratioX:r,segmentPage:s}=e,c=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(n,s);if(c==null)return;let A=r<.5;return n.glyphType===B.GlyphType.LIST&&(A=!0),{...c,isBack:A}}_interactTextRanges(e){const n=[];for(const r of this._rangeList){if(e.some(s=>s.isIntersection(r))){r.dispose();continue}n.push(r)}this._rangeList=n}_interactRectRanges(e){const n=[];for(const r of this._rectRangeList){if(e.some(s=>s.isIntersection(r))){r.dispose();continue}n.push(r)}this._rectRangeList=n}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){e.length!==0&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();const{scene:n,mainComponent:r}=this._context,s=this._docSkeletonManagerService.getSkeleton(),a=new je(n,r,s,e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(a)}_updateActiveRangePosition(e){const n=this._getActiveRangeInstance();if(n==null||n.anchorNodePosition==null){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=n.anchorNodePosition,this._focusNodePosition=e;const{scene:r,mainComponent:s}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:c,_focusNodePosition:l,_selectionStyle:A,_currentSegmentId:d,_currentSegmentPage:u}=this;if(c==null||l==null||s==null)return;const m=Kn(c,l,r,s,a,A,d,u);if(m==null)return;const{textRanges:g,rectRanges:h}=m;this._addTextRangesToCache(g),this._addRectRangesToCache(h),this.deactivate()}_isEmpty(){return this._rangeList.length===0&&this._rectRangeList.length===0}_getCanvasOffset(){var n;const e=(n=this._context.scene)==null?void 0:n.getEngine();return Ri(e)}_updateInputPosition(e=!1){const n=this._getActiveRangeInstance(),r=n==null?void 0:n.getAnchor();if(!r||r&&!r.visible||this.activeViewPort==null){this.focus();return}const{left:s,top:a}=r,c=this.activeViewPort.getAbsoluteVector(B.Vector2.FromArray([s,a])),{x:l,y:A}=c;let{left:d,top:u}=this._getCanvasOffset();d+=l,u+=A,this.activate(d,u,e)}_moving(e,n){var E,C;const{_currentSegmentId:r,_currentSegmentPage:s}=this,a=this._findNodeByCoord(e,n,{strict:!0,segmentId:r,segmentPage:s}),c=this._getNodePosition(a);if(c==null||a==null)return;const l=a==null?void 0:a.node.parent,A=l==null?void 0:l.glyphGroup[l.glyphGroup.indexOf(a.node)+1];(a==null?void 0:a.node.streamType)===i.DataStreamTreeTokenType.PARAGRAPH&&(A==null?void 0:A.streamType)===i.DataStreamTreeTokenType.SECTION_BREAK&&(c.isBack=!0),this._focusNodePosition=c,this._removeAllCacheRanges();const{_anchorNodePosition:d,_selectionStyle:u}=this,{scene:m,mainComponent:g}=this._context,h=this._docSkeletonManagerService.getSkeleton();if(d==null||g==null)return;const p=Kn(d,c,m,g,h,u,r,s);if(p==null)return;const{textRanges:f,rectRanges:S}=p;this._rangeList.length>0&&f.length>0&&this._interactTextRanges(f),this._rectRangeList.length>0&&S.length>0&&this._interactRectRanges(S),this._addTextRangesToCache(f),this._addRectRangesToCache(S),this.deactivate(),(C=(E=this._context.scene)==null?void 0:E.getEngine())==null||C.setCapture()}__attachScrollEvent(){const e=this.activeViewPort;if(!e)return;const{unitId:n}=this._context;if(this._viewPortObserverMap.has(n))return;const r=e.onScrollAfter$.subscribeEvent(a=>{if(!a.viewport)return;const l=this._getActiveRangeInstance();l==null||l.activeStatic()}),s=e.onScrollEnd$.subscribeEvent(a=>{const c=a.viewport;if(!c)return;const l=c.getBounding(),A=this._getActiveRangeInstance(),d=A==null?void 0:A.getAnchor();if(!(!d||d&&!d.visible)){if(l){const{left:u,top:m,right:g,bottom:h}=l.viewBound;if(d.left<u||d.left>g||d.top<m||d.top>h){A==null||A.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(n,{scrollBefore:r,scrollStop:s})}_initInputEvents(){this.disposeWithMe(U.fromEvent(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})})),this.disposeWithMe(U.fromEvent(this._input,"input").subscribe(e=>{if(!(e.inputType==="historyUndo"||e.inputType==="historyRedo")){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}})),this.disposeWithMe(U.fromEvent(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})})),this.disposeWithMe(U.fromEvent(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})})),this.disposeWithMe(U.fromEvent(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})})),this.disposeWithMe(U.fromEvent(this._input,"paste").subscribe(e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})),this.disposeWithMe(U.fromEvent(this._input,"focus").subscribe(e=>{this._eventHandle(e,n=>{this._onFocus$.next(n)})})),this.disposeWithMe(U.fromEvent(this._input,"blur").subscribe(e=>{this._eventHandle(e,n=>{this._onBlur$.next(n)})}))}_eventHandle(e,n){const r=this._input.textContent||"";this._input.innerHTML="";const s=this._getActiveRange(),a=this._getAllTextRanges();n({event:e,content:r,activeRange:s,rangeList:a})}_getTransformCoordForDocumentOffset(e,n){const r=this._context.mainComponent,{documentTransform:s}=r.getOffsetConfig();if(this.activeViewPort==null||s==null)return;const a=this.activeViewPort.transformVector2SceneCoord(B.Vector2.FromArray([e,n]));if(a)return s.clone().invert().applyPoint(a)}_findNodeByCoord(e,n,r){const s=this._getTransformCoordForDocumentOffset(e,n);if(s==null)return;const a=this._context.mainComponent,c=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:l=B.PageLayoutType.VERTICAL,pageMarginLeft:A,pageMarginTop:d}=a.getOffsetConfig();return c.findNodeByCoord(s,l,A,d,r)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}};exports.DocSelectionRenderService=Sa([wt(1,I.ILayoutService),wt(2,i.ILogService),wt(3,i.IUniverInstanceService),wt(4,i.Inject(D.DocSkeletonManagerService))],exports.DocSelectionRenderService);const Nt={id:"doc.command.switch-mode",type:i.CommandType.COMMAND,handler:o=>{var E,C,T,R,v;const t=o.get(i.ICommandService),e=o.get(B.IRenderManagerService),n=o.get(D.DocSelectionManagerService),s=o.get(i.IUniverInstanceService).getCurrentUniverDocInstance();if(s==null)return!1;const a=s.getUnitId(),c=(E=e.getRenderById(a))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),l=(C=e.getRenderById(a))==null?void 0:C.with(exports.DocSelectionRenderService);if(c==null||l==null)return!1;const A=l==null?void 0:l.getSegment(),d=l==null?void 0:l.getSegmentPage(),u=s.getSnapshot().documentStyle.documentFlavor,m=n.getDocRanges(),g={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:u===i.DocumentFlavor.TRADITIONAL&&A?[]:m}},h=i.JSONX.getInstance(),p=[];let f;if(u===void 0?f=h.insertOp(["documentStyle","documentFlavor"],i.DocumentFlavor.MODERN):u===i.DocumentFlavor.MODERN?f=h.replaceOp(["documentStyle","documentFlavor"],u,i.DocumentFlavor.TRADITIONAL):f=h.replaceOp(["documentStyle","documentFlavor"],u,i.DocumentFlavor.MODERN),f)p.push(f);else return!1;if(u!==i.DocumentFlavor.MODERN){const b=s.getSnapshot(),{drawings:x={},body:y}=b,_=(T=y==null?void 0:y.customBlocks)!=null?T:[];for(const O in x){const w=x[O],Q=_.find(Z=>Z.blockId===O);if(Q==null)continue;const k=w.docTransform.positionV,{relativeFrom:F,posOffset:L}=k;if(F===i.ObjectRelativeFromV.PARAGRAPH)continue;const{startIndex:G}=Q,W=c.findNodeByCharIndex(G,A,d),H=(R=W==null?void 0:W.parent)==null?void 0:R.parent,V=H==null?void 0:H.parent,j=V==null?void 0:V.lines.find(Z=>Z.paragraphIndex===(H==null?void 0:H.paragraphIndex)&&Z.paragraphStart),X=(v=V==null?void 0:V.parent)==null?void 0:v.parent;if(W==null||H==null||j==null||V==null||X==null)continue;let z=0;F===i.ObjectRelativeFromV.LINE?z-=H.top:F===i.ObjectRelativeFromV.PAGE&&(z+=X.marginTop),z+=j.top;const Y={...k,relativeFrom:i.ObjectRelativeFromV.PARAGRAPH,posOffset:(L!=null?L:0)-z},K=h.replaceOp(["drawings",O,"docTransform","positionV"],k,Y);K&&p.push(K)}}return g.params.actions=p.reduce((b,x)=>i.JSONX.compose(b,x),null),!!t.syncExecuteCommand(g.id,g.params)}},Ia="doc.command.create-table",jo={id:Ia,type:i.CommandType.COMMAND,handler:async(o,t)=>{var Y,K,Z,ne,ue;const{rowCount:e,colCount:n}=t,r=o.get(D.DocSelectionManagerService),s=o.get(i.IUniverInstanceService),a=o.get(i.ICommandService),c=o.get(Ce),l=r.getActiveTextRange();if(l==null)return!1;const{segmentId:A,segmentPage:d}=l,u=s.getCurrentUniverDocInstance(),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const g=u.getUnitId(),h=ae(o,g),p=h==null?void 0:h.getSkeleton();if(p==null)return!1;const{startOffset:f}=l,E=((Y=m.paragraphs)!=null?Y:[]).find(Me=>Me.startIndex>=f),C=p.findNodeByCharIndex(f,A,d);if(C==null)return!1;const T=new i.TextX,R=i.JSONX.getInstance(),v=[],b=f+4,x=[{startOffset:b,endOffset:b,collapsed:!0}],y={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:x}};f>0&&T.push({t:i.TextXActionType.RETAIN,len:f}),T.push({t:i.TextXActionType.INSERT,body:{dataStream:i.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Ao(i.DataStreamTreeTokenType.PARAGRAPH,E)},len:1});const _=c.getDefaultStyle(),O=c.getStyleCache(),w=sn(m,f,_,O),{dataStream:Q,paragraphs:k,sectionBreaks:F}=Ns(e,n),L=(ue=(ne=(Z=(K=C.parent)==null?void 0:K.parent)==null?void 0:Z.parent)==null?void 0:ne.parent)==null?void 0:ue.parent;if(L==null)return!1;const{pageWidth:G,marginLeft:W,marginRight:H}=L,V=go(e,n,G-W-H);T.push({t:i.TextXActionType.INSERT,body:{dataStream:Q,paragraphs:k,sectionBreaks:F,textRuns:[{...w,st:0,ed:Q.length}],tables:[{startIndex:0,endIndex:Q.length,tableId:V.tableId}]},len:Q.length});const j=J(u,A);v.push(R.editOp(T.serialize(),j));const X=R.insertOp(["tableSource",V.tableId],V);return v.push(X),y.params.actions=v.reduce((Me,ge)=>i.JSONX.compose(Me,ge),null),!!a.syncExecuteCommand(y.id,y.params)}},In={id:"doc.table.delete-rows",type:i.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService),r=t.getRectRanges(),s=t.getActiveTextRange(),a=Tt(s,r);if(a==null)return!1;const{segmentId:c}=a,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=ae(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),g=new i.TextX,h=i.JSONX.getInstance(),p=ni(a,u);if(p==null)return!1;const{offset:f,rowIndexes:S,len:E,tableId:C,cursor:T,selectWholeTable:R}=p;if(R)return n.executeCommand(at.id);const v=[],b=[{startOffset:T,endOffset:T,collapsed:!0}],x={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:b}};f>0&&g.push({t:i.TextXActionType.RETAIN,len:f}),g.push({t:i.TextXActionType.DELETE,len:E});const y=J(l,c);v.push(h.editOp(g.serialize(),y));for(const O of S.reverse()){const w=h.removeOp(["tableSource",C,"tableRows",O]);v.push(w)}return x.params.actions=v.reduce((O,w)=>i.JSONX.compose(O,w),null),!!n.syncExecuteCommand(x.id,x.params)}},vn={id:"doc.table.delete-columns",type:i.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService),r=t.getRectRanges(),s=t.getActiveTextRange(),a=Tt(s,r);if(a==null)return!1;const{segmentId:c}=a,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=ae(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),g=new i.TextX,h=i.JSONX.getInstance(),p=Fs(a,u);if(p==null)return!1;const{offsets:f,columnIndexes:S,tableId:E,cursor:C,rowCount:T,selectWholeTable:R}=p;if(R)return n.executeCommand(at.id);const v=[],b=[{startOffset:C,endOffset:C,collapsed:!0}],x={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:b}};for(const O of f){const{retain:w,delete:Q}=O;w>0&&g.push({t:i.TextXActionType.RETAIN,len:w}),g.push({t:i.TextXActionType.DELETE,len:Q})}const y=J(l,c);v.push(h.editOp(g.serialize(),y)),S.reverse();for(let O=0;O<T;O++)for(const w of S){const Q=h.removeOp(["tableSource",E,"tableRows",O,"tableCells",w]);v.push(Q)}for(const O of S){const w=h.removeOp(["tableSource",E,"tableColumns",O]);v.push(w)}return x.params.actions=v.reduce((O,w)=>i.JSONX.compose(O,w),null),!!n.syncExecuteCommand(x.id,x.params)}},at={id:"doc.table.delete-table",type:i.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService),r=t.getRectRanges(),s=t.getActiveTextRange(),a=Tt(s,r);if(a==null)return!1;const{segmentId:c}=a,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=ae(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),g=new i.TextX,h=i.JSONX.getInstance(),p=oi(a,u);if(p==null)return!1;const{offset:f,len:S,tableId:E,cursor:C}=p,T=[],R=[{startOffset:C,endOffset:C,collapsed:!0}],v={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:R}};f>0&&g.push({t:i.TextXActionType.RETAIN,len:f}),g.push({t:i.TextXActionType.DELETE,len:S});const b=J(l,c);T.push(h.editOp(g.serialize(),b));const x=h.removeOp(["tableSource",E]);return T.push(x),v.params.actions=T.reduce((_,O)=>i.JSONX.compose(_,O),null),!!n.syncExecuteCommand(v.id,v.params)}},Wo="doc.command.table-insert-row",Go="doc.command.table-insert-column",va="doc.command.table-insert-row-above",Ea="doc.command.table-insert-row-bellow",Ca="doc.command.table-insert-column-left",Ta="doc.command.table-insert-column-right",En={id:va,type:i.CommandType.COMMAND,handler:async o=>o.get(i.ICommandService).executeCommand(Wo,{position:cn.ABOVE})},Cn={id:Ea,type:i.CommandType.COMMAND,handler:async o=>o.get(i.ICommandService).executeCommand(Wo,{position:cn.BELLOW})},Tn={id:Ca,type:i.CommandType.COMMAND,handler:async o=>o.get(i.ICommandService).executeCommand(Go,{position:uo.LEFT})},yn={id:Ta,type:i.CommandType.COMMAND,handler:async o=>o.get(i.ICommandService).executeCommand(Go,{position:uo.RIGHT})},Xo={id:Wo,type:i.CommandType.COMMAND,handler:async(o,t)=>{const{position:e}=t,n=o.get(D.DocSelectionManagerService),r=o.get(i.IUniverInstanceService),s=o.get(i.ICommandService),a=n.getRectRanges(),c=n.getActiveTextRange(),l=Tt(c,a);if(l==null)return!1;const{segmentId:A}=l,d=r.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=ae(o,d.getUnitId());if(m==null)return!1;const g=m.getViewModel(),h=d==null?void 0:d.getUnitId(),p=new i.TextX,f=i.JSONX.getInstance(),S=Us(l,e,g);if(S==null)return!1;const{offset:E,colCount:C,tableId:T,insertRowIndex:R}=S,v=[],b=E+2,x=[{startOffset:b,endOffset:b,collapsed:!0}],y={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:x}};E>0&&p.push({t:i.TextXActionType.RETAIN,len:E});const _=Ps(C);p.push({t:i.TextXActionType.INSERT,body:_,len:_.dataStream.length});const O=J(d,A);v.push(f.editOp(p.serialize(),O));const w=dn(C),Q=f.insertOp(["tableSource",T,"tableRows",R],w);return v.push(Q),y.params.actions=v.reduce((F,L)=>i.JSONX.compose(F,L),null),!!s.syncExecuteCommand(y.id,y.params)}},xi={id:Go,type:i.CommandType.COMMAND,handler:async(o,t)=>{var X,z,Y;const{position:e}=t,n=o.get(D.DocSelectionManagerService),r=o.get(i.IUniverInstanceService),s=o.get(i.ICommandService),a=n.getRectRanges(),c=n.getActiveTextRange(),l=Tt(c,a);if(l==null)return!1;const{segmentId:A}=l,d=r.getCurrentUniverDocInstance(),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=ae(o,d.getUnitId());if(m==null)return!1;const g=m.getViewModel(),h=d==null?void 0:d.getUnitId(),p=new i.TextX,f=i.JSONX.getInstance(),S=Ls(l,e,g);if(S==null)return!1;const{offsets:E,columnIndex:C,tableId:T,rowCount:R}=S,v=[],b=E[0]+1,x=[{startOffset:b,endOffset:b,collapsed:!0}],y={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:x}};for(const K of E){p.push({t:i.TextXActionType.RETAIN,len:K});const Z=ws();p.push({t:i.TextXActionType.INSERT,body:Z,len:Z.dataStream.length})}const _=J(d,A);v.push(f.editOp(p.serialize(),_));for(let K=0;K<R;K++){const Z=ln(),ne=f.insertOp(["tableSource",T,"tableRows",K,"tableCells",C],Z);v.push(ne)}const O=d.getSnapshot(),w=O.documentStyle,{marginLeft:Q=0,marginRight:k=0}=w,F=((z=(X=w.pageSize)==null?void 0:X.width)!=null?z:800)-Q-k,L=(Y=O==null?void 0:O.tableSource)==null?void 0:Y[T].tableColumns,{newColWidth:G,widths:W}=Qs(F,L,C);for(let K=0;K<W.length;K++){const Z=f.replaceOp(["tableSource",T,"tableColumns",K,"size","width","v"],L[K].size.width.v,W[K]);v.push(Z)}const H=An(G),V=f.insertOp(["tableSource",T,"tableColumns",C],H);return v.push(V),y.params.actions=v.reduce((K,Z)=>i.JSONX.compose(K,Z),null),!!s.syncExecuteCommand(y.id,y.params)}},Ko={id:"doc.table.tab-in-table",type:i.CommandType.COMMAND,handler:async(o,t)=>{var h;const{shift:e}=t,n=o.get(D.DocSelectionManagerService),r=n.getDocRanges(),s=o.get(i.ICommandService),c=o.get(i.IUniverInstanceService).getCurrentUniverDocInstance();if(!c)return!1;const l=(h=r.find(p=>p.isActive))!=null?h:r[0],A=c.getUnitId(),d=ae(o,A),u=d==null?void 0:d.getSkeleton(),m=u==null?void 0:u.getViewModel().getSelfOrHeaderFooterViewModel(l==null?void 0:l.segmentId);if(m==null||l==null)return!1;let g=null;if(e?g=rr(m,l,kn.PREV):g=rr(m,l,kn.NEXT),g){const{startOffset:p,endOffset:f}=g,S=[{startOffset:p,endOffset:f}];return n.replaceDocRanges(S),!0}return e===!1?await s.executeCommand(Xo.id,{position:cn.BELLOW}):!0}},Oi="COMPONENT_DOC_CREATE_TABLE_CONFIRM",Pn="doc.component.create-table-confirm",bn={id:"doc.operation.create-table",type:i.CommandType.COMMAND,handler:async o=>{const t=o.get(i.LocaleService),e=o.get(I.IConfirmService),n=o.get(i.ICommandService),r={rowCount:3,colCount:5},s=(a,c)=>{r.rowCount=a,r.colCount=c};return await e.open({id:Pn,children:{label:{name:Oi,props:{handleRowColChange:s,tableCreateParams:r}}},width:"auto",title:{title:t.t("toolbar.table.insert")},onConfirm:()=>{n.executeCommand(jo.id,r),e.close(Pn)},onClose:()=>{e.close(Pn)}}),!0}},ye={id:"doc.operation.move-cursor",type:i.CommandType.OPERATION,handler:(o,t)=>!!t},be={id:"doc.operation.move-selection",type:i.CommandType.OPERATION,handler:(o,t)=>!!t};function te({ref:o,...t}){const{icon:e,id:n,className:r,extend:s,...a}=t,c=`univerjs-icon univerjs-icon-${n} ${r||""}`.trim(),l=P.useRef(`_${Ra()}`);return Mi(e,`${n}`,{defIds:e.defIds,idSuffix:l.current},{ref:o,className:c,...a},s)}function Mi(o,t,e,n,r){return P.createElement(o.tag,{key:t,...ya(o,e,r),...n},(ba(o,e).children||[]).map((s,a)=>Mi(s,`${t}-${o.tag}-${a}`,e,void 0,r)))}function ya(o,t,e){const n={...o.attrs};e!=null&&e.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=e.colorChannel1),o.tag==="mask"&&n.id&&(n.id=n.id+t.idSuffix),Object.entries(n).forEach(([s,a])=>{s==="mask"&&typeof a=="string"&&(n[s]=a.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:r}=t;return!r||r.length===0||(o.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(([s,a])=>{typeof a=="string"&&(n[s]=a.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),n}function ba(o,t){var n;const{defIds:e}=t;return!e||e.length===0?o:o.tag==="defs"&&((n=o.children)!=null&&n.length)?{...o,children:o.children.map(r=>typeof r.attrs.id=="string"&&e&&e.includes(r.attrs.id)?{...r,attrs:{...r.attrs,id:r.attrs.id+t.idSuffix}}:r)}:o}function Ra(){return Math.random().toString(36).substring(2,8)}te.displayName="UniverIcon";const xa={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},Di=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"align-text-both-icon",ref:e,icon:xa}))});Di.displayName="AlignTextBothIcon";const Oa={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332C13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267C11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827C1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827C8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007Z"}}]},Bi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"catalogue-icon",ref:e,icon:Oa}))});Bi.displayName="CatalogueIcon";const Ma={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.50095 1.84399C2.73322 1.60765 3.11311 1.60435 3.34945 1.83662L8.00012 6.40726L12.6508 1.83662C12.8871 1.60435 13.267 1.60765 13.4993 1.84399C13.7316 2.08032 13.7283 2.46021 13.4919 2.69248L8.85611 7.24852L10.8941 9.25146C11.1382 9.17563 11.3976 9.13477 11.6667 9.13477C13.1026 9.13477 14.2667 10.2988 14.2667 11.7348C14.2667 13.1707 13.1026 14.3348 11.6667 14.3348C10.2307 14.3348 9.06665 13.1707 9.06665 11.7348C9.06665 11.0143 9.35973 10.3622 9.83319 9.89129L8.00012 8.08978L6.16708 9.89127C6.64055 10.3622 6.93364 11.0142 6.93364 11.7348C6.93364 13.1707 5.76958 14.3348 4.33364 14.3348C2.8977 14.3348 1.73364 13.1707 1.73364 11.7348C1.73364 10.2988 2.8977 9.13477 4.33364 9.13477C4.60263 9.13477 4.86208 9.17562 5.10612 9.25145L7.14413 7.24852L2.50831 2.69248C2.27197 2.46021 2.26868 2.08032 2.50095 1.84399ZM2.93364 11.7348C2.93364 10.9616 3.56044 10.3348 4.33364 10.3348C5.10684 10.3348 5.73364 10.9616 5.73364 11.7348C5.73364 12.508 5.10684 13.1348 4.33364 13.1348C3.56044 13.1348 2.93364 12.508 2.93364 11.7348ZM10.2667 11.7348C10.2667 10.9616 10.8935 10.3348 11.6667 10.3348C12.4398 10.3348 13.0667 10.9616 13.0667 11.7348C13.0667 12.508 12.4398 13.1348 11.6667 13.1348C10.8935 13.1348 10.2667 12.508 10.2667 11.7348Z",fillRule:"evenodd",clipRule:"evenodd"}}]},_i=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"cut-icon",ref:e,icon:Ma}))});_i.displayName="CutIcon";const Da={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ni=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"delete-icon",ref:e,icon:Da}))});Ni.displayName="DeleteIcon";const Ba={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105C8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105C4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324C10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324C4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188Z"}}]},Pi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"doc-setting-icon",ref:e,icon:Ba}))});Pi.displayName="DocSettingIcon";const _a={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"}}]},wi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"down-icon",ref:e,icon:_a}))});wi.displayName="DownIcon";const Na={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689C2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336C2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336C9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689C8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203C13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319C11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333C13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879Z"}}]},Ui=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"h1-icon",ref:e,icon:Na}))});Ui.displayName="H1Icon";const Pa={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689C12.8465 7.26689 13.4 7.67244 13.4 8.33356C13.4 8.62807 13.2712 8.94814 12.9954 9.32391C12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373C10.3718 12.1759 10.0667 12.7122 10.0667 13.3336C10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336C14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767C11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338C14.3122 9.55787 14.6 8.98906 14.6 8.33356C14.6 6.88362 13.3757 6.06689 12.3333 6.06689C11.291 6.06689 10.0667 6.88361 10.0667 8.33356C10.0667 8.66493 10.3353 8.93356 10.6667 8.93356C10.998 8.93356 11.2667 8.66493 11.2667 8.33356Z"}}]},Li=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"h2-icon",ref:e,icon:Pa}))});Li.displayName="H2Icon";const wa={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689C10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051C11.2283 10.1364 11.4375 10.2669 11.6667 10.2669C12.2418 10.2669 12.6786 10.4115 12.9585 10.6354C13.2204 10.845 13.4 11.166 13.4 11.6669C13.4 12.1622 13.2254 12.3937 13.0567 12.5202C12.8588 12.6686 12.5829 12.7336 12.3333 12.7336C11.7271 12.7336 11.3432 12.4858 11.1106 12.23C10.8877 11.9848 10.5082 11.9667 10.2631 12.1896C10.0179 12.4125 9.99979 12.792 10.2227 13.0372C10.6568 13.5147 11.3522 13.9336 12.3333 13.9336C12.7504 13.9336 13.3078 13.8319 13.7767 13.4802C14.2746 13.1068 14.6 12.5049 14.6 11.6669C14.6 10.8345 14.2796 10.1555 13.7081 9.69837C13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328C14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667Z"}}]},Qi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"h3-icon",ref:e,icon:wa}))});Qi.displayName="H3Icon";const Ua={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Fi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"h4-icon",ref:e,icon:Ua}))});Fi.displayName="H4Icon";const La={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492C10.7822 9.94492 10.8899 9.91238 10.9814 9.85599C10.9901 9.85195 11.0027 9.84632 11.0192 9.83936C11.0764 9.81533 11.1692 9.78033 11.2927 9.74447C11.5397 9.67268 11.8996 9.60022 12.3336 9.60022C12.4975 9.60022 12.5978 9.63412 12.6624 9.67167C12.7263 9.70877 12.79 9.76953 12.8503 9.87834C12.983 10.1181 13.0669 10.5337 13.0669 11.1669C13.0669 11.8061 12.9802 12.1936 12.8338 12.414C12.7252 12.5775 12.5275 12.7336 12.0002 12.7336C11.6445 12.7336 11.4936 12.622 11.4192 12.5328C11.3289 12.4245 11.2669 12.2453 11.2669 12.0028C11.2669 11.6714 10.9983 11.4028 10.6669 11.4028C10.3355 11.4028 10.0669 11.6714 10.0669 12.0028C10.0669 12.4244 10.1716 12.9106 10.4979 13.3016C10.8401 13.7118 11.356 13.9336 12.0002 13.9336C12.8063 13.9336 13.4419 13.6673 13.8334 13.0779C14.1869 12.5456 14.2669 11.8497 14.2669 11.1669C14.2669 10.4781 14.1841 9.81027 13.9002 9.29724C13.7521 9.02964 13.545 8.79662 13.2651 8.63403C12.986 8.4719 12.6697 8.40022 12.3336 8.40022C11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332C13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669Z"}}]},Hi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"h5-icon",ref:e,icon:La}))});Hi.displayName="H5Icon";const Qa={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},ki=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"horizontally-icon",ref:e,icon:Qa}))});ki.displayName="HorizontallyIcon";const Fa={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Vi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"left-icon",ref:e,icon:Fa}))});Vi.displayName="LeftIcon";const Ha={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},ji=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"left-justifying-icon",ref:e,icon:Ha}))});ji.displayName="LeftJustifyingIcon";const ka={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},Wi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"right-justifying-icon",ref:e,icon:ka}))});Wi.displayName="RightJustifyingIcon";const Va={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"}}]},mt=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"text-type-icon",ref:e,icon:Va}))});mt.displayName="TextTypeIcon";const ja={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263C4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837L1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263C0.880874 2.97695 0.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689C6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689C15.0605 2.83552 14.7918 2.56689 14.4605 2.56689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334C6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334C15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999C15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999 0.939453 6.76549 0.939453 7.83324C0.939453 8.90099 1.80504 9.76657 2.87279 9.76657C3.94054 9.76657 4.80612 8.90099 4.80612 7.83324C4.80612 6.76549 3.94054 5.8999 2.87279 5.8999ZM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999C3.2778 7.0999 3.60612 7.42823 3.60612 7.83324C3.60612 8.23824 3.2778 8.56657 2.87279 8.56657C2.46778 8.56657 2.13945 8.23824 2.13945 7.83324Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.939453 12.5002C0.939453 11.4325 1.80504 10.5669 2.87279 10.5669C3.94054 10.5669 4.80612 11.4325 4.80612 12.5002C4.80612 13.568 3.94054 14.4336 2.87279 14.4336C1.80504 14.4336 0.939453 13.568 0.939453 12.5002ZM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002C2.13945 12.9052 2.46778 13.2336 2.87279 13.2336C3.2778 13.2336 3.60612 12.9052 3.60612 12.5002C3.60612 12.0952 3.2778 11.7669 2.87279 11.7669Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Gi=P.forwardRef(function(t,e){return P.createElement(te,Object.assign({},t,{id:"todo-list-double-icon",ref:e,icon:ja}))});Gi.displayName="TodoListDoubleIcon";function Xi(o){var n;const{dataStream:t}=(n=o.body)!=null?n:{},e=[i.DataStreamTreeTokenType.TABLE_START,i.DataStreamTreeTokenType.TABLE_CELL_END,i.DataStreamTreeTokenType.TABLE_CELL_START,i.DataStreamTreeTokenType.TABLE_END,i.DataStreamTreeTokenType.TABLE_ROW_END,i.DataStreamTreeTokenType.TABLE_ROW_START,i.DataStreamTreeTokenType.COLUMN_BREAK,i.DataStreamTreeTokenType.PAGE_BREAK,i.DataStreamTreeTokenType.TAB,i.DataStreamTreeTokenType.DOCS_END,i.DataStreamTreeTokenType.CUSTOM_BLOCK];if(typeof t=="string")for(let r=0;r<t.length;r++){const s=t[r];if(!e.includes(s))return r}return 0}class Ki extends i.Disposable{constructor(e,n,r,s,a,c){super();M(this,"_change$",new U.Subject);M(this,"change$",this._change$.asObservable());M(this,"_input$",new U.Subject);M(this,"input$",this._input$.asObservable());M(this,"_paste$",new U.Subject);M(this,"paste$",this._paste$.asObservable());M(this,"_focus$",new U.Subject);M(this,"focus$",this._focus$.asObservable());M(this,"_blur$",new U.Subject);M(this,"blur$",this._blur$.asObservable());M(this,"_selectionChange$",new U.Subject);M(this,"selectionChange$",this._selectionChange$.asObservable());this._param=e,this._univerInstanceService=n,this._docSelectionManagerService=r,this._commandService=s,this._undoRedoService=a,this._injector=c,this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(exports.DocSelectionRenderService)}_listenSelection(){const e=this._param.render.with(exports.DocSelectionRenderService);this.disposeWithMe(e.onBlur$.subscribe(n=>{this._blur$.next(n);const r=this.getDocumentData();this._change$.next({target:this,data:r})})),this.disposeWithMe(e.onFocus$.subscribe(n=>{this._focus$.next(n)})),this.disposeWithMe(e.onPaste$.subscribe(n=>{this._paste$.next(n)})),this.disposeWithMe(U.merge(e.onInput$,e.onKeydown$.pipe(ht.filter(n=>{const r=n.event;return r.ctrlKey||r.metaKey?[I.KeyCode.X,I.KeyCode.V].includes(r.keyCode):[I.KeyCode.BACKSPACE].includes(r.keyCode)})),e.onCompositionupdate$,e.onCompositionend$,e.onPaste$).subscribe(n=>{if(n==null)return;const{content:r=""}=n,s=this.getDocumentData();this._input$.next({target:this,content:r,data:s,isComposing:n.event.type==="compositionupdate"})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(n=>{if(n==null)return;const{unitId:r,subUnitId:s,...a}=n,c=this.getEditorId();r===c&&this._selectionChange$.next(a)}))}isFocus(){const e=this._param.render.with(exports.DocSelectionRenderService);return e.isFocusing&&!!e.getActiveTextRange()}focus(){const e=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),n=this.getEditorId();(e==null||e.getUnitId()!==n)&&this._univerInstanceService.setCurrentUnitForType(n),this._param.render.with(exports.DocSelectionRenderService).focus()}blur(){this._param.render.with(exports.DocSelectionRenderService).blur()}select(){const e=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:e.body?e.body.dataStream.length-2:0}])}setSelectionRanges(e,n=!0){const r=this.getEditorId(),s={unitId:r,subUnitId:r};return this._docSelectionManagerService.replaceDocRanges(e,s,!1,{shouldFocus:n})}getSelectionRanges(){const e=this.getEditorId(),n={unitId:e,subUnitId:e};return this._docSelectionManagerService.getDocRanges(n)}getCursorPosition(){var n,r;return(r=(n=this.getSelectionRanges().find(s=>s.collapsed))==null?void 0:n.startOffset)!=null?r:-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(e,n){this._commandService.syncExecuteCommand(Ro.id,{unitId:this.getEditorId(),snapshot:e,textRanges:n})}replaceText(e,n=!0){const r=this.getDocumentData();this.setDocumentData({...r,body:{dataStream:`${e}\r
`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},typeof n=="object"?n:n?[{startOffset:e.length,endOffset:e.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const e=this.getEditorId();return this._undoRedoService.clearUndoRedo(e)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return this._param.readonly===!0}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}getSkeleton(){var n;return(n=this._injector.get(B.IRenderManagerService).getRenderById(this._getEditorId()))==null?void 0:n.with(D.DocSkeletonManagerService).getSkeleton()}isSheetEditor(){return i.isInternalEditorID(this._getEditorId())}getValue(){var r;return(((r=this._getDocDataModel().getBody())==null?void 0:r.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(e){this._param={...this._param,...e}}updateCanvasStyle(){var r;const e=this._getDocDataModel();if(e==null)return;const n={};(r=this._param.canvasStyle)!=null&&r.fontSize&&(n.textStyle==null&&(n.textStyle={}),n.textStyle.fs=this._param.canvasStyle.fontSize),e.updateDocumentStyle(n)}_getDocDataModel(){const e=this._getEditorId();return this._univerInstanceService.getUnit(e,i.UniverInstanceType.UNIVER_DOC)}_getEditorId(){var e;return((e=this._param.initialSnapshot)==null?void 0:e.id)||this._param.editorUnitId||""}}var Wa=Object.getOwnPropertyDescriptor,Ga=(o,t,e,n)=>{for(var r=n>1?void 0:n?Wa(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},He=(o,t)=>(e,n)=>t(e,n,o);const Xa=["editor","render-canvas"];exports.EditorService=class extends i.Disposable{constructor(e,n,r,s,a,c,l){super();M(this,"_editors",new Map);M(this,"_focusEditorUnitId");M(this,"_blur$",new U.Subject);M(this,"blur$",this._blur$.asObservable());M(this,"_focus$",new U.Subject);M(this,"focus$",this._focus$.asObservable());this._univerInstanceService=e,this._renderManagerService=n,this._docSelectionManagerService=r,this._contextService=s,this._commandService=a,this._undoRedoService=c,this._injector=l,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe(U.fromEvent(window,"focusin").subscribe(e=>{const n=e.target;this._blurSheetEditor(n)}))}_blurSheetEditor(e){if(Xa.some(r=>e.dataset.uComp===r))return;const n=this.getFocusEditor();n&&n.isSheetEditor()!==!0&&this.blur()}_setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){const n=this._editors.get(e);return!!(n&&n.isSheetEditor())}blur(e){const n=this.getFocusEditor();e&&(n==null||n.setSelectionRanges([])),n==null||n.blur(),this._contextService.setContextValue(i.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(i.FOCUSING_EDITOR_STANDALONE,!1),this._setFocusId(null),this._blur$.next(null)}focus(e){if(e===this._focusEditorUnitId||(this._focusEditorUnitId&&this.blur(),e==null))return;const n=this.getEditor(e);if(n==null)return;this._univerInstanceService.setCurrentUnitForType(e);const r=n.getValue().length;this._contextService.setContextValue(i.EDITOR_ACTIVATED,!0),i.isInternalEditorID(e)||this._contextService.setContextValue(i.FOCUSING_EDITOR_STANDALONE,!0),n.focus(),this._setFocusId(e),this._focus$.next({startOffset:r,endOffset:r})}dispose(){this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}register(e,n){var A,d,u,m;const{initialSnapshot:r,canvasStyle:s={}}=e,a=r.id;this._univerInstanceService.getUnit(a,i.UniverInstanceType.UNIVER_DOC)==null&&this._univerInstanceService.createUnit(i.UniverInstanceType.UNIVER_DOC,r||this._getBlank(a),{makeCurrent:!1});let l=this._renderManagerService.getRenderById(a);if(l==null&&(this._renderManagerService.create(a),l=this._renderManagerService.getRenderById(a)),l){l.engine.setContainer(n);const g=new Ki({...e,render:l,editorDom:n,canvasStyle:s},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService,this._injector);this._editors.set(a,g),e.scrollBar||(m=(u=(d=(A=l.mainComponent)==null?void 0:A.getScene())==null?void 0:d.getViewports())==null?void 0:u[0].getScrollBar())==null||m.dispose()}return i.toDisposable(()=>{this._unRegister(a)})}_unRegister(e){const n=this._editors.get(e);n!=null&&(this._renderManagerService.removeRender(e),n.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${i.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:i.VerticalAlign.TOP,horizontalAlign:i.HorizontalAlign.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}};exports.EditorService=Ga([He(0,i.IUniverInstanceService),He(1,B.IRenderManagerService),He(2,i.Inject(D.DocSelectionManagerService)),He(3,i.IContextService),He(4,i.ICommandService),He(5,i.IUndoRedoService),He(6,i.Inject(i.Injector))],exports.EditorService);const se=i.createIdentifier("univer.editor.service"),Yn="COMPONENT_DOC_HEADER_FOOTER_PANEL";function Ka(o,t,e){const{useFirstPageHeaderFooter:n,evenAndOddHeaders:r,defaultHeaderId:s,defaultFooterId:a,firstPageHeaderId:c,firstPageFooterId:l,evenPageHeaderId:A,evenPageFooterId:d}=o;return t===B.DocumentEditArea.HEADER?n===i.BooleanNumber.TRUE&&e===0?c:r===i.BooleanNumber.TRUE&&e%2===1?A:s:n===i.BooleanNumber.TRUE&&e===0?l:r===i.BooleanNumber.TRUE&&e%2===1?d:a}const za=o=>{const t=I.useDependency(i.LocaleService),e=I.useDependency(i.IUniverInstanceService),n=I.useDependency(B.IRenderManagerService),r=I.useDependency(i.ICommandService),s=I.useDependency(I.ILayoutService),{unitId:a}=o,c=n.getRenderById(a).with(exports.DocSelectionRenderService),[l,A]=P.useState({}),d=(g,h)=>{var b;A(x=>({...x,[h]:g?i.BooleanNumber.TRUE:i.BooleanNumber.FALSE}));const p=e.getUniverDocInstance(a),f=p==null?void 0:p.getSnapshot().documentStyle,S=(b=n.getRenderById(a))==null?void 0:b.with(D.DocSkeletonManagerService),E=S==null?void 0:S.getViewModel();if(f==null||E==null)return;const C=E.getEditArea();let T=!1;const R=c.getSegmentPage();let v=!1;if(h==="useFirstPageHeaderFooter"&&g===!0&&((C===B.DocumentEditArea.HEADER&&!f.firstPageHeaderId||C===B.DocumentEditArea.FOOTER&&!f.firstPageFooterId)&&(T=!0),T&&R===0&&(v=!0)),h==="evenAndOddHeaders"&&g===!0&&((C===B.DocumentEditArea.HEADER&&!f.evenPageHeaderId||C===B.DocumentEditArea.FOOTER&&!f.evenPageFooterId)&&(T=!0),T&&R%2===1&&(v=!0)),T){const y=i.generateRandomId(6);v&&c.setSegment(y),r.executeCommand(Wt,{unitId:a,segmentId:y,headerFooterProps:{[h]:g?i.BooleanNumber.TRUE:i.BooleanNumber.FALSE}})}else{const x=c.getSegmentPage(),y=c.getSegment(),_=Ka({...f,[h]:g?i.BooleanNumber.TRUE:i.BooleanNumber.FALSE},C,x);_&&_!==y&&c.setSegment(_),r.executeCommand(Wt,{unitId:a,headerFooterProps:{[h]:g?i.BooleanNumber.TRUE:i.BooleanNumber.FALSE}})}s.focus()},u=async(g,h)=>{A(p=>({...p,[h]:g})),await r.executeCommand(Wt,{unitId:a,headerFooterProps:{[h]:g}}),c.removeAllRanges(),c.blur()},m=()=>{r.executeCommand(qo.id,{unitId:a})};return P.useEffect(()=>{const g=e.getUniverDocInstance(a),h=g==null?void 0:g.getSnapshot().documentStyle;if(h){const{marginHeader:p=0,marginFooter:f=0,useFirstPageHeaderFooter:S=i.BooleanNumber.FALSE,evenAndOddHeaders:E=i.BooleanNumber.FALSE}=h;A({marginHeader:p,marginFooter:f,useFirstPageHeaderFooter:S,evenAndOddHeaders:E})}},[a]),N.jsxs("div",{className:"univer-grid univer-gap-4",children:[N.jsxs("div",{className:"univer-grid univer-gap-2",children:[N.jsx("div",{children:N.jsx(q.Checkbox,{checked:l.useFirstPageHeaderFooter===i.BooleanNumber.TRUE,onChange:g=>{d(g,"useFirstPageHeaderFooter")},children:t.t("headerFooter.firstPageCheckBox")})}),N.jsx("div",{children:N.jsx(q.Checkbox,{checked:l.evenAndOddHeaders===i.BooleanNumber.TRUE,onChange:g=>{d(g,"evenAndOddHeaders")},children:t.t("headerFooter.oddEvenCheckBox")})})]}),N.jsxs("div",{className:"univer-mb-1 univer-flex",children:[N.jsxs("div",{children:[N.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),N.jsx(q.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginHeader,onChange:g=>{u(g,"marginHeader")}})]}),N.jsxs("div",{children:[N.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),N.jsx(q.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginFooter,onChange:g=>{u(g,"marginFooter")}})]})]}),N.jsx("div",{className:"univer-flex univer-justify-end",children:N.jsx(q.Button,{onClick:m,children:t.t("headerFooter.closeHeaderFooter")})})]})},Ya=()=>{var A;const o=I.useDependency(i.LocaleService),t=I.useDependency(B.IRenderManagerService),r=I.useDependency(i.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),a=((A=t.getRenderById(r))==null?void 0:A.with(D.DocSkeletonManagerService)).getViewModel(),[c,l]=P.useState(!0);return P.useEffect(()=>{const d=a.getEditArea();l(d!==B.DocumentEditArea.BODY);const u=a.editAreaChange$.subscribe(m=>{m!=null&&l(m!==B.DocumentEditArea.BODY)});return()=>{u.unsubscribe()}},[]),N.jsx("div",{className:"univer-text-sm",children:c?N.jsx(za,{unitId:r}):N.jsx("div",{className:"univer-text-gray-400",children:o.t("headerFooter.disableText")})})},Tr=18,yr=200,wn=6,qa=4;function Ja(o,t){let{radius:e,width:n,height:r}=t;e=e!=null?e:0,n=n!=null?n:30,r=r!=null?r:30;let s=0;s=Math.min(e,n/2,r/2),o.beginPath(),o.moveTo(0,0),o.lineTo(n,0),o.lineTo(n,r-s),o.arc(n-s,r-s,s,0,Math.PI/2,!1),o.lineTo(0,r),o.lineTo(0,0),o.closePath(),t.fill&&(o.save(),o.fillStyle=t.fill,t.fillRule==="evenodd"?o.fill("evenodd"):o.fill(),o.restore())}class Yt extends B.Shape{constructor(e,n){super(e,n);M(this,"color");M(this,"text");this.color=n==null?void 0:n.color,this.text=n==null?void 0:n.text}static drawWith(e,n){const{text:r,color:s}=n;e.save(),e.font="13px Source Han Sans CN";const a=e.measureText(r).width,c=Math.min(a+2*wn,yr);Ja(e,{height:Tr,width:c,radius:4,fill:s}),e.fillStyle="rgba(58, 96, 247, 1)";const l=wn,A=Tr-qa,d=yr-2*wn;if(a>d){let u="",m=0;for(const g of r){const h=e.measureText(g).width;if(m+h<=d-e.measureText("...").width)u+=g,m+=h;else{u+="...";break}}e.fillText(u,l,A)}else e.fillText(r,l,A);e.restore()}_draw(e){Yt.drawWith(e,this)}}var Za=Object.getOwnPropertyDescriptor,$a=(o,t,e,n)=>{for(var r=n>1?void 0:n?Za(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},De=(o,t)=>(e,n)=>t(e,n,o);const br="rgba(58, 96, 247, 1)",Rr="rgba(58, 96, 247, 0.08)";var re=(o=>(o[o.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",o[o.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",o[o.DEFAULT_HEADER=2]="DEFAULT_HEADER",o[o.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",o[o.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",o[o.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",o))(re||{});function ec(o,t,e){const{documentStyle:n}=o.getDataModel().getSnapshot(),{defaultHeaderId:r,defaultFooterId:s,evenPageHeaderId:a,evenPageFooterId:c,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:u}=n;switch(t){case B.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case B.DocumentEditArea.HEADER:return u===i.BooleanNumber.TRUE&&!l?{createType:0,headerFooterId:null}:d===i.BooleanNumber.TRUE&&e%2===0&&!a?{createType:4,headerFooterId:null}:r?{createType:null,headerFooterId:r}:{createType:2,headerFooterId:null};case B.DocumentEditArea.FOOTER:return u===i.BooleanNumber.TRUE&&!A?{createType:1,headerFooterId:null}:d===i.BooleanNumber.TRUE&&e%2===0&&!c?{createType:5,headerFooterId:null}:s?{createType:null,headerFooterId:s}:{createType:3,headerFooterId:null};default:throw new Error(`Invalid editArea: ${t}`)}}let qn=class extends i.Disposable{constructor(t,e,n,r,s,a,c,l,A){super();M(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=r,this._renderManagerService=s,this._docSkeletonManagerService=a,this._docSelectionRenderService=c,this._localeService=l,this._componentManager=A,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}dispose(){super.dispose()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(D.RichTextEditingMutation.id===t.id){const e=this._context.unit,r=this._docSkeletonManagerService.getViewModel().getEditArea(),s=e.getSnapshot().documentStyle.documentFlavor;r!==B.DocumentEditArea.BODY&&s===i.DocumentFlavor.MODERN&&this._commandService.executeCommand(qo.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){this._componentManager.get(Yn)||this.disposeWithMe(this._componentManager.register(Yn,Ya))}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_initialMain(t){const e=Ie(this._context),{document:n}=e;this.disposeWithMe(n.onDblclick$.subscribeEvent(async r=>{if(this._isEditorReadOnly(t)||!this._isTraditionalMode())return;const{offsetX:s,offsetY:a}=r,{pageLayoutType:c=B.PageLayoutType.VERTICAL,pageMarginLeft:l,pageMarginTop:A}=n.getOffsetConfig(),d=this._getTransformCoordForDocumentOffset(s,a);if(d==null)return;const u=this._docSkeletonManagerService.getViewModel(),m=this._docSkeletonManagerService.getSkeleton(),g=u.getEditArea(),{editArea:h,pageNumber:p}=m.findEditAreaByCoord(d,c,l,A);if(g===h)return;u.setEditArea(h);const{createType:f,headerFooterId:S}=ec(u,h,p);if(h===B.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(s,a);else if(f!=null){const C=i.generateRandomId(6);this._docSelectionRenderService.setSegment(C),this._docSelectionRenderService.setSegmentPage(p),await this._commandService.executeCommand(zi.id,{unitId:t,createType:f,segmentId:C})}else S!=null&&(this._docSelectionRenderService.setSegment(S),this._docSelectionRenderService.setSegmentPage(p),this._docSelectionRenderService.setCursorManually(s,a))}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:r,scene:s}=n,{documentTransform:a}=r.getOffsetConfig(),c=s.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(B.Vector2.FromArray([t,e]));return a.clone().invert().applyPoint(l)}_drawHeaderFooterLabel(){const t=this._localeService;this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_DOC).subscribe(e=>{if(e==null)return;const n=e.getUnitId(),r=this._renderManagerService.getRenderById(n);if(this._editorService.isEditor(n)||this._instanceSrv.getUniverDocInstance(n)==null||r==null)return;const{mainComponent:s}=r,a=s;this.disposeWithMe(i.toDisposable(a.pageRender$.subscribe(c=>{if(this._editorService.isEditor(n)||!this._isTraditionalMode())return;const d=this._docSkeletonManagerService.getViewModel().getEditArea()===B.DocumentEditArea.BODY,{page:u,pageLeft:m,pageTop:g,ctx:h}=c,{pageWidth:p,pageHeight:f,marginTop:S,marginBottom:E}=u;if(h.save(),h.translate(m-.5,g-.5),d?(B.Rect.drawWith(h,{left:0,top:0,width:p,height:S,fill:"rgba(255, 255, 255, 0.5)"}),h.save(),h.translate(0,f-E),B.Rect.drawWith(h,{left:0,top:0,width:p,height:E,fill:"rgba(255, 255, 255, 0.5)"}),h.restore()):(h.save(),h.translate(0,S),B.Rect.drawWith(h,{left:0,top:S,width:p,height:f-S-E,fill:"rgba(255, 255, 255, 0.5)"}),h.restore()),!d){const C={dataArray:[{command:"M",points:[0,S]},{command:"L",points:[p,S]}],strokeWidth:1,stroke:br},T={dataArray:[{command:"M",points:[0,f-E]},{command:"L",points:[p,f-E]}],strokeWidth:1,stroke:br};B.Path.drawWith(h,C),B.Path.drawWith(h,T),h.translate(0,S+1),Yt.drawWith(h,{text:t.t("headerFooter.header"),color:Rr}),h.translate(0,f-S-E),Yt.drawWith(h,{text:t.t("headerFooter.footer"),color:Rr})}h.restore()})))}))}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===i.DocumentFlavor.TRADITIONAL}};qn=$a([De(1,i.ICommandService),De(2,se),De(3,i.IUniverInstanceService),De(4,B.IRenderManagerService),De(5,i.Inject(D.DocSkeletonManagerService)),De(6,i.Inject(exports.DocSelectionRenderService)),De(7,i.Inject(i.LocaleService)),De(8,i.Inject(I.ComponentManager))],qn);const zo={id:"sidebar.operation.doc-header-footer-panel",type:i.CommandType.OPERATION,handler:async(o,t)=>{const e=o.get(I.ISidebarService),n=o.get(i.LocaleService);switch(t.value){case"open":e.open({header:{title:n.t("headerFooter.panel")},children:{label:Yn},onClose:()=>{},width:400});break;case"close":default:e.close();break}return!0}};function xr(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function Un(o,t,e,n){const r=i.JSONX.getInstance(),s=6,a=o!=null?o:i.generateRandomId(s),c=t===re.DEFAULT_HEADER||t===re.FIRST_PAGE_HEADER||t===re.EVEN_PAGE_HEADER,l=r.insertOp([c?"headers":"footers",a],{[c?"headerId":"footerId"]:a,body:xr()});n.push(l);const A=i.generateRandomId(s),d=r.insertOp([c?"footers":"headers",A],{[c?"footerId":"headerId"]:A,body:xr()});n.push(d);let u="defaultHeaderId",m="defaultFooterId";switch(t){case re.DEFAULT_HEADER:u="defaultHeaderId",m="defaultFooterId";break;case re.DEFAULT_FOOTER:u="defaultFooterId",m="defaultHeaderId";break;case re.FIRST_PAGE_HEADER:u="firstPageHeaderId",m="firstPageFooterId";break;case re.FIRST_PAGE_FOOTER:u="firstPageFooterId",m="firstPageHeaderId";break;case re.EVEN_PAGE_HEADER:u="evenPageHeaderId",m="evenPageFooterId";break;case re.EVEN_PAGE_FOOTER:u="evenPageFooterId",m="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${t}`)}for(const[g,h]of[[u,a],[m,A]])if(e[g]!=null){const p=r.replaceOp(["documentStyle",g],e[g],h);n.push(p)}else{const p=r.insertOp(["documentStyle",g],h);n.push(p)}return n}const Wt="doc.command.core-header-footer",zi={id:Wt,type:i.CommandType.COMMAND,handler:async(o,t)=>{var T;const e=o.get(i.ICommandService),n=o.get(i.IUniverInstanceService),r=o.get(B.IRenderManagerService),{unitId:s,segmentId:a,createType:c,headerFooterProps:l}=t,A=(T=r.getRenderById(s))==null?void 0:T.with(D.DocSkeletonManagerService),d=n.getUniverDocInstance(s),u=A==null?void 0:A.getViewModel();if(d==null||u==null)return!1;const m=u.getEditArea(),{documentStyle:g}=d.getSnapshot(),h=(l==null?void 0:l.marginFooter)!=null||(l==null?void 0:l.marginHeader)!=null,p=[{startOffset:0,endOffset:0,collapsed:!0}],f={id:D.RichTextEditingMutation.id,params:{unitId:s,actions:[],textRanges:p,debounce:!0}};h&&(f.params.noNeedSetTextRange=!0);const S=i.JSONX.getInstance(),E=[];return c!=null&&Un(a,c,g,E),l!=null&&Object.keys(l).forEach(R=>{const v=l[R],b=g[R];if(v===b)return;let x;if(b===void 0?x=S.insertOp(["documentStyle",R],v):x=S.replaceOp(["documentStyle",R],b,v),E.push(x),R==="useFirstPageHeaderFooter"&&v===i.BooleanNumber.TRUE&&!g.firstPageHeaderId){const y=m===B.DocumentEditArea.HEADER?re.FIRST_PAGE_HEADER:re.FIRST_PAGE_FOOTER;Un(a,y,g,E)}else if(R==="evenAndOddHeaders"&&v===i.BooleanNumber.TRUE&&!g.evenPageHeaderId){const y=m===B.DocumentEditArea.HEADER?re.EVEN_PAGE_HEADER:re.EVEN_PAGE_FOOTER;Un(a,y,g,E)}}),E.length===0?!1:(f.params.actions=E.reduce((R,v)=>i.JSONX.compose(R,v),null),!!e.syncExecuteCommand(f.id,f.params))}},Yo={id:"doc.command.open-header-footer-panel",type:i.CommandType.COMMAND,handler:async(o,t)=>o.get(i.ICommandService).executeCommand(zo.id,{value:"open"})},qo={id:"doc.command.close-header-footer",type:i.CommandType.COMMAND,handler:async(o,t)=>{var h;const e=o.get(i.ICommandService),n=o.get(B.IRenderManagerService),r=o.get(D.DocSelectionManagerService),s=o.get(i.IUniverInstanceService),{unitId:a}=t,c=n.getRenderById(a);if(c==null)return!1;const{scene:l}=c,A=l.getTransformerByCreate(),d=c.with(D.DocSkeletonManagerService),u=c.with(exports.DocSelectionRenderService),m=d==null?void 0:d.getSkeleton(),g=d==null?void 0:d.getViewModel();return g==null||m==null?!1:(r.replaceDocRanges([]),A.clearSelectedObjects(),u.setSegment(""),u.setSegmentPage(-1),g.setEditArea(B.DocumentEditArea.BODY),m.calculate(),(h=c.mainComponent)==null||h.makeDirty(!0),queueMicrotask(()=>{const p=s.getUnit(a),f=p==null?void 0:p.getSnapshot();if(f==null)return;const S=Xi(f);r.replaceDocRanges([{startOffset:S,endOffset:S}])}),e.executeCommand(zo.id,{value:"close"}),!0)}},Yi="UI_PLUGIN_DOCS",qi=o=>{const{value:t,onChange:e,options:n}=o;return N.jsx("div",{className:"univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5",children:n.map(r=>N.jsx("a",{className:q.clsx("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500",q.borderClassName,{"univer-border-primary-500":t===r.value}),onClick:()=>{e(r.value)},children:N.jsx("img",{className:"univer-size-full",src:r.img,draggable:!1})},r.value))})},tc=[{value:i.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAzAAEAAgMBAQEAAAAAAAAAAAAABwkGCAoFBAMBAQADAQEAAAAAAAAAAAAAAAACAwQBBf/aAAwDAQACEAMQAAAA7+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcdPpZewDzdXrAAAAAAAAAAAA1LsjURpqk6Pb3clw8g1gAAAAAAABlxsQADmI355/r7oddHoOx3bt1T/ExEAAAAAAAH2mTgAgicZ3hKBpx842KhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAV8XQ0+theRkuAAAAAAAAAAAAjOXOevZR0wYdAxggoAAAAAycnUAAAAA5n92e/PHfNse+YYIAAAAAeoZ0AAAAAag2wwbrfemYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqn0V2sZ7AAAAAAAAAAAABThpquPzWjHyHQADISYQAAAAAAADm620dGGK/wBU8UjEAA9ok4AAAAAAAA0BuhFkuWo57AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAK1769Hbob20zsdosAAAAAAAAAAAHMbvz3kZLqHtdPUXg0D4iJAAAAAAAAe0ScADl69DPZznnU3or6sPP0jzyDQAAAAAAAZCTCACnPTVDE45Fzs2wlbJnsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAApEAABAwQCAAYCAwEAAAAAAAAGAAUXBAcICQMWAgoQFUBgASAZMDg6/9oACAEBAAEIAPqmeu33Nu3+fN6rh46sD8zlLEyk498jOzKJgwvxCv8A5Mv+r/W/TFOmE3tRfTy9+QxXcnCSuxsu16EHLycLC983D2QiXZCJdkIl2QiXZCJdkIl2QiXZCJdkIl2QiXZCJdkIl2QiXZCJdkIl2QiQK9vNYVNdPV/pvHr3PNrLDAjToF0vl58e6Kmp6KisTZRp0m7r7XWlaOTYniNxZs8GvTxKpp+Gsp6ikqI8D1Hgeo8D1Hgeo8D1Hgeo8D1Hgeo8D1Hgeo8D1Hgeo8D1Hgeo8D1Hgem4NG2qs4a+g/RtxisE0ZAP+VDer24wWByPqbd117/HiPjRyZG8WXXJ9uzt2b4p69GVmnPTbsqyM2EF2dDLkN8l7svaEmuOMXgJND/+2d+XqZONY1DblX0EhmCkMwUhmCkMwUhmCkMwUhmCkMwUhmCkMwUhmCDTIkdSRtoK/wDr0P8A+2d+SZ8k8fiC9hNjayJ5aad8balrq4oHVFA6ooHVFA6ooHVFA6ooHVFA6ooHVFA6ooHUzW+ZmNypnSk/rxpwesPidcTJy6FoAzWniYB5unmwce+4E+zqpHdp4PrP8Hyi3Ne+TPvBthgdRehU7VDGw17pSSuRKVyJSuRKVyJSuRIVuC8vj9QNdX8G4P8A1G2MVS+slE6NjHWIhZ/fmesaVEKiFRCohUQoetx7C8Ubt8J8wCEHzY8G7HOXIfVNa/IjYRjTsMe/ruxjZ3aPWu12Wr7ocXmBRf8APLx/jmwW2pYkbBq8yErMfI8ws8NA9frSw/v/AC514RcHHyc3MDkITm95hu1mTuGXo5Vnt7dX16l5S8peUvKXlLyl5S8peUvKXlLyl5S8peUvIeuP788UbT+vmMQ8ZuFeHTcAmv8ACVqiV+7UMGm3ZFrVpcHfR3pOSvanOh4YoIlFBEooIlFBEooIlFBEooIlFBEooIlFBEooIlFBEooIlFBEooIlFBEhW3zyxv1A6Vf6badct6s9qvEQpsP4sXfMGeLw+Lw/jGLT3cBpyoF84dgt/sEMnrqbKsZMwwf7N//EADkQAAAGAAMGBAMGBgMBAAAAAAECAwQFBgAHEggRE5Sl1RSV1OUJFdMQICEzQGAWFyIjJFkwMbe2/9oACAEBAAk/AP2pPKrfDz+Hdmjs5ZObXtfaVOtv0LvYMwbbMRmYR/nstWZO2xknGzISmWyKtfmIiMj5es198q3eHsLYszINpeAscTGz0HKszio0k4eXZoyEZINTiBRO2esnCDlA4gAmSVKO4N+79SqxD+VWXU3MVtjIKlSbT1+fplhMuqwYTHIYf4lvMnX4Q3DEyhE3x1SkPwxKJSyGaXxGahmJnrm9Zp5kZeXZ27PCKLIZYWJ4DxmRynO0yJbUe7+HWZ6Ym+DMLtkFBEVXBjs8+NgrMmzbK+ZEI9VVNKs4imPHKVAcOEXCp3SbFlDIPaExVWRaFXWy/kOE2IVId/2KHSWSiJJVJVI5k1E1E2axiKJnKIGIchgAxDlEDFMACAgIYn5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4n5rzR99fE/NeaPvr4l5R03U8dxEHD92uifRHPDk1pKqmIbScpTl1FHSYpTBuEAH7s7Lx0VnPeU9oTahkawuqnLVzJaipzhItFZb5bIxKKsgwh8xpuKQnCLMULjA5dun0csm+jTqbcHxRWjNogk1aNGu1uzbtmrZumVJBu3QSyxIkigikQiaSSZCppplKQhSlKABmDmjdNmL4m+VTqoEu+ddqaWe0qbStXsLt7CfxBZo+s19OyTrifkIurwoqNvGCpnwJ5JdczNNwOaJR2q3FbGyJ5fp1uyrMygWmLZkDBL2lKKPXGtk/lyge9BFOZJExq6ZFYqovHDdkrgnEbukVW66eoxNaK6ZklSayGKcuohjF1EMUxd+8pgEAHER1CU9biI6hKetxEdQlPW4iOoSnrcRHUJT1uIjqEp63ER1CU9biI6hKetxEdQlPW4iOoSnrcRHUJT1uIjqEp63ER1CU9biI6hKetxEdQlPW4iOoSnrcRvAdocThK+Mfq6OKkdFT+2s6USNqSUOX+og7t+8NxgAQ+5lbV0Noe0VBGhTmbIoOV7W8pzckKRGvlcOHKrVnHlJXYcuhi1bHMDU2tQ3inniMZW1nMV/lJbUL3lnIziTsslR7g1UaLN7DXZGPdsnsdIpLMGK5VUVwDjsma4lFVqgdPJSgn2lkK6NURzlPCpGuiMIMUpACik+EwopvhryytbGZI3CaGtqqV4ZD5KczEf3daJyQzHuzFdfKzJSgVyTtmaGaL4jssa3jqvFNEk4pp4uVUSjU5KxzEJFeMVTakdqvFUGq2U1PyUf7NeckBl7XMuYRjPpXCng/d5hsZ+pZly8zOP2s/baw/p7eKkJCIgam0PIpShgh0UlW7dp+pywoNhzVpMU4hKVmNO1KDl7rTYl44VdvmNTskgxcytbQkHCplJEIV0xM/EqRXhlyIIlT/wBily/9a2kPtW4DtDwfCV4aSujiv2qKn9tYiiRtSShy/wBRB3b94bjAAhL9Pi/RYl+nxfosS/T4v0WJfp8X6LEv0+L9FiX6fF+ixL9Pi/RYl+nxfosS/T4v0WJfp8X6LEv0+L9FiS47RfxnFS8GwS18Jg6WT/uItU1S6VUyG/pOG/duHeURAf8Aj/2KXL/1raQxnPlrK5/U2CbWa05OsbhCOcxIKBdpMXCUpI1VN4aWQbFbSsQ7ciLbWzaTMM7dkQby8aq6wddNu64PEO3MmRYOAuk4JoMqmsQN50SgbUmbeUTAG4RAwPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsPZrmGPbsOZRRw143DI4WaHRHjoKtz6ypMkTjuIsYS6VC7jAUR3gAlH/AI4+zM7XtcZrSGc2cS09Y3M4xe3aTnLbYXS8AyXRSJBRwyV1nDEj0DKpkRUbJAfc3KI0uaR2kcxIJaEm5p1aph5WGir2Ji4CXnYWrLLCxjZ2bg4dlFyLkp1WgN/FqMWLJ3IyDl1+8Nl/NWSQt+XC18W2iEXgJVCN01OYtia7et/IFiSNGRGHVqMreFbfGKx9+ONYRrD/AEEfrfqn9bLs/WrYukM8JeOUrrdS0nvje0ZhxKbhCzCsDlCMBnW4woxpURTFQqx9e9YQD7CIqOGvheGRwVQ6I8d43bn1lSUROO4ixhLpULuMBRHeACUWULy77uOGULy77uOGULy77uOGULy77uOGULy77uOG0Ym3deK4h26LsiwcBm4cE0GVerEDedEoG1Jm3lEwBuEQMH6H/WfL/wD3ecOJiKaTc0R4rDw7mQaISkslHJFWkFIyPVWI7fkYInKq8O1RVK1SMVRcSEEB+xx4Txfh/wDI4PH4fAdIOfyuKjq1cHR+YXTq1fju0jYek+54sPSfc8WHpPueLD0n3PFh6T7niZ8X4TxH+P8ALuBxOO1Xbfm+OW06eNr/ACzatOn8N+oP0OYFkQutN2enWz22y3TjIs1WewzqatU0awrypjfNk5MitqcIg1TL4UU2iJhHUc+M2c1azfNnCJhIiPoEE9jj06zIVWbs9igCnXeN1JSvNnMjbpdvcGEaqsxtURwWXAiXKsnISX7dywzpzVf58XKVolFrmSVfrNksTixRjeJWTYqRdhttWWduZZaZZMIdnD/M3z18cW5WxDmR4vwvfi1poioQFVEtlGOWVIkJgBQ6aR8w0CqqFLvEiZlkSnMAFFVMBE4TtyqebuXKR3V+yIzkqS2X2b1Uj03xItWTeV872WiZSPZyaiMbLr1ufmxrz91HNLESJXl4gj79RKR0HAwfxA6fMTc3MPm0ZEQ8RGXLKJ7JSkpJPVUGcfHR7NBZ2+fO1kWzRsiquuqmkmc4bY+yqiiiQ6qqqu0LlGmmkmmUTqKKKHt4FIQhQExzmEClKAiIgACOFS3XIzZh2ZblRNqHaJpLNyrlJmXd56AzEr9Py6ir4xKFYv01DHvNGmWzyPeyRn0dT3oMzuYumtniH2J8bwLJ084Wvh8XwyCi3D4mk+jXo069B9O/fpNu3DXure2Yr3VvbMV7q3tmK91b2zFe6t7ZivdW9sxXure2Yr3VvbMV7q3tmK91b2zFe6t7ZivdW9sxXure2Yr3VvbMV7q3tmK91b2zEN4TxfiP8j5jx+HwGq7n8rwKOrVwdH5hdOrV+O7SP3IZnY6beNvCvU+216RKc8fPVmzWjKeFnoZ8RM6ah2cpFPXbFyUihDmQXOBTlEQMGwzkh5VM96xJ3Ch5A7eWdEnkLnrsmrXi12rKldw+sOWFZaZsU+tWmUnncBP15TMYJ6WlWDxH5cWAZRbRRpXrJYox39hiFWex71okZUTAmVRy2URIZQSlOYCAY4CcSkOYC7xAph/AXsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HsLzD7t2HMYo3a+K4hG6zs6w8dm4bk0FVZIkHcdYom1KF3FAwhvEAKP3M5KNkxftlLOZxnRATl6rEla49zYmStXkaudKLZAds4LFzVZbvHbWSSWZvUDA3USOmZQo/FA2WyCYogBy7J9XExBENwGKB6mcgmL/ANhrIYu8P6imDeA7Ydv249onLlu5TyejXVMisuMnsonj1Nyi4la1RIt6+ilJNsC/i4Y0RF1CJjpcTTzqFlbA3iZeL2yrpl3s+ZPVlOLv+zeykbOSIt0i0Xs674rKHYSLamyMdf20vCRNtcWaOcS8Y2r6LyKcvliQ7eD/AHN//8QAPBEAAQMCAwUDCQQLAAAAAAAAAQIDERIhAAQxEzJAQVFgYXEUI3ORk6Gy0eEzU4HBECI0QkNUZHKCkrH/2gAIAQIBAT8A7KM5ZpTKUrHnn0rU2ZNgkAjQxBEG8mCehgiCQdRY8S02XXENj95QB7hqo/gJOMw/GaCkbrJShIGkIP6w8CZHeIxnEBLtadx5IcSeUne99/8ALicp5pt7MkCUihudCox80i3InHliz/Cy/svrhavKsqpUJC2FTCBAoIvAkwIuf7MbBzZbanzcxMjrTMTMVW8eI2iygN1GgGQnlN7+8/oS4tFQQopChCo5jofXjaLo2dRomaZtOv8A28aTfXte0w48TQBSN5ajCU85J+QOMywhkMlCivaJKioxB3SCkRYGeZNo4oKUElIUQk3KQSAT3jQ/jjN/ZZP0I+Fvi839lk/Qj4W8ULCQspVQTAVBpJ6TpyPqPFOOrcS2lUQ2mlMCLQBfroMF9wtBkkUAyBAnWYJ6SZ7YhicuX9omyoo5m4Gs2N5iN288WGkHKqevWHaBe0Qk6db8Wn9gX6cfCnH5cUHiGCxAgrrq5zAEdOWEZhSGVshKSFzc6iQAfHQR0PXs8wwp+uFJSECVFRIEX6A6QZnHkf8AUZf2n0w7l3GYKoKVaLSaknum1/EX5aHickJRmgLktEADnZWNi7905/or5YILWSU27ZbiwptB3kgFJJKdU6HXr1PE5IkJzJBghqQehAUQceVZj71fr+mEKOZYf2sFbKa0OQArRRpJAEg0wB+YHE5Z9LO0C0lQcTSQDFrz7jjaZP8Al3PaH54XmQWy0y0GkK3rlSleKrGOsza0xbCHW0sONloKWo2ctIFuZuI5Ra9+/tN//8QAOBEAAQIEAQcKBAcBAAAAAAAAAQIRAxIhMQATQEFhcYGRIjJRUmCSobHR8CNy0uEQNEJTY3PB8f/aAAgBAwEBPwDsouKsLJTzEFIVre+h9W4dOL1zlapEqV0Dx0eOIcP4RBusEnfbhQ7cQFEolN0EpO63puzmNy1IhA3LqboHsna2rGQT14ne+2EjIxQHJTEDOes/ifqxOmeR+Uztufi1c4lTNM3KZn1fgpKVM4di41HEqZpmE3S1fbU2U7XriJRc1NgKk7B64hRFLK5gBKWbSL0OsNqzpgSCwcWLVGw4g8+N8581Z3B58b5z5qxMl5XEwqQ9eGdJQElRDuoudtbccCGkLK25R102t2xynxBDlNQ82iz8NDvejZ2VqEZKP0lD766d2dn8wn+v6s7KHiCI9kytxr44VDClpW5dOjRTyvXp7PRIghs4JmLBsZb+OJ3cIiJW4Dgi4IY+/LTnMbnQfn/1OJ0ddPeHrgMuOFJqEpIUoWJYhnsbjhqzmOAVQgbFbHYSnGRhdQePrhQyUSHI4CzKpLki4D1018Oh85iw1LlKSAUl67vTEsf9xPd+2EwjNOtU6hajAbvKzYUhRiJUFkJAqn3Sul/+dpv/2Q=="},{value:i.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],nc=o=>N.jsx(qi,{...o,options:tc}),oc=[{value:i.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:i.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAA3AAEAAQQDAQEBAAAAAAAAAAAACgYHCAkDBQsCAQQBAQADAQEBAAAAAAAAAAAAAAACAwQFAQb/2gAMAwEAAhADEAAAAJ/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAOj9d54AAAAAAAAAAAA4iEB1ck3/la+UAAAAAAAAAAAtjLzz/AHsYos2/PKcwaJ//AB9tzo+jEkAAAAAAAq4yIAAMQbI+Zb3ef6Z3C6GYVcgKLAAAAAAAP7SpwAAYr2RyorkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANDeun8NgNM85KpgAAAAAAAAAAatdFeVNcsoa5aD9dO/DJcKYLFAAAAAFTl9QAAAYrWRwCthtoz2aMNdMg3HeOsKEAAAAAO0K6AAAAMMLYYRWw3N5buxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABS3vkZDfQNkdE9uua0AAAAAAAAAACyM4+MJ9NyxMG5umfHyNop8s6AAVCXhAAAAAABZGcfGE+m5YmDc3TPj5G0dKWxAAO6LnAAAAAAA6P1ph01DMGuWfNMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABqL01bdM1oAAAAAAAAAAA4yPNto857tYfRl4m6Qpjv5QWXAAAAAAAO6LnAAtrLyKn0M8C7r455vI2SsefouTH0Y+gAAAAAAFQl4QAAR+dlEgbHeAAAAAAAAAAAAPk+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf/8QAKxAAAQIGAQMCBwEBAAAAAAAABgAXAwQFBwgJFgIKEAFAFRkaIDA4YBJQ/9oACAEBAAEIAP8AtckovJOI+nuY8eBKwI0zMxN/FuunfS4CgR4E1AgzMt7e7R6T24EJ8lEt1u7rYJdWqFeI1UWlLd1sFtXUBPEmmWlPCq4ohIEZj45IRLkhEuSES5IRLkhEuSES5IRLkhEuSES5IRLkhEuSES5IRLkhEuSESBa3WZwqpcvN/bmvg3jtn7Zas2TyI9NRWSXzOoesWLhRgtjjgFZujWZx38t4HpvA9N4HpvA9N4HpvA9N4HpvA9N4HpvA9N4HpvA9N4HpvA9N4HqnBo3SpyDPyH3dOLAL0Zp9eaEP+uL9luW+Xt1T2y2omqRu4XsPCmbgzmB+e9pc9rbERWDe33XXxL8dNWeZF0wLCvHcJxQxSsLj8AK7NFkMbt/+IRmAeDKozlKG6lPyDhmCcMwThmCcMwThmCcMwThmCcMwThmCcMwThmCDTIkqpJTZCf8AwZw4x0fMvEfIHGGs6q9hFIuIFUXCbKi511bZ2VCqzce72Ftcq2zPY7X9mFP8Vmky9cpszS5tqB1NQOpqB1NQOpqB1NQOpqB1NQOpqB1NQOpqB1Ua31GodSlqpKfhy5154bZ00mn07KAH7ffWUKklHJimj0ekD1KptCoH9ccl1Nt+EmJ5Wfq5dby+rl1vLW9uhxc2hm1yQOwPt8mf1vyC89n5+yGYfkqq0xQ6DP1SUdciTrkSdciTrkSdciQrcGs1yvSFLm/zZM/rfkF57Pz9kMw/JDR/j1HnKSmhTQpoU0KaFD1uPgNYk6t+cmHKKYjZAIkf05GmZfTkaZlh9rAwZwIJDEuxN/oPmS2/6tx/rrv6PcRYsKBCiRo20XuGMUsKhEiBLARMjL3Rr/8AplJF1c9wpinmwJC4DfuBHgTUCDMy3h3k7yd5O8neTvJ3k7yd5O8neTvJ3k7yd5D1x/j1Yk6T9t1bM2ivoKTYLenaN2v1mbgiJTeHXfxAr5bwFauu18syAiI7d7Ypa2zdo7HC8sEWX8NQRJqCJNQRJqCJNQRJqCJNQRJqCJNQRJqCJNQRJqCJNQRJqCJNQRIVt9WaHXpCqTf3dGpa3EPe905zdPuv89Pp1evX6fxn/8QAPhAAAQMDAQUGAwMLBAMAAAAAAwIEBQEGBwAREhMUpQgVlNTV5RCV0xYzQAkXICEiIyQwV2C2l6jX2CUxUP/aAAgBAQAJPwD/AO0/BW4qQf2kVF72xymFq/7sS/3K7N4Cn1Ft94e/uERsLw+IHi/iTCbNmwiHcODkQEAABRUhTGKSqRiEIaVLIRakoQhNVKrRNK11dQldiOmPwdi9N4tk17nLHquel0qzq5G7FQqIVvltwZoWUZrFUmJmreaS1cPKVYGMJw2cCGdu4ARBgHAZFCCMEo6qGURRqSsZEKUhaFUUmtU1pX8RhvI+cpZmIhBWRi+QxbHXM84dE12gNlrJGMLcUnZVS6jHPFerQIiGrJ05U3bOMEZA/J/43fM3Ubeti3ISS/PBla3HLhy235q91wsAyb48uFkMSDQePRvIadbrkY2Tvi87cfKZ/DAmQ+3/AIviGzVtbVm2k1nJDNeJrSCdtGDpBXk2YTMYrHFvqdt0oi8jNQQ8C2owh4y+bLt1uJqPDWQ8GTToQ1uLHyXKYsl7iZLVRW/vvMSZHydbSxUqmih706F5wii5li0c0cNW/wAJ+a+aPvr6n5r5o++vqfmvmj76+p+a+aPvr6n5r5o++vqfmvmj76+p+a+aPvr6n5r5o++vqfmvmj76+p+a+aPvr6n5r5o++vqfmvmj76+p+a+aPvr6n5r5o++vqfmvmj76+peUdNyc9xAOH7s4V7kc8WjfEUqkK3VpStO8mu6pKVU2VpSv6VkMbjiXAHri0brbhA3vfGdzuG3Ba3hYVw8NbuFmGhEAU5b0UWIn2Yaw1yR0vCOXUeYTUGQy3uZmK/yNHarTXiMUae7E5mpQNCkTAGsECp0UasyXlJ1SLLMQVw1U2TYkdbke3asl3deLhs2cX5ky4m4OG6uy/bk4SXs1KuzLOVs0qsUNANTUh7bjYiFbNWAfjEdQlPO6iOoSnndRHUJTzuojqEp53UR1CU87qI6hKed1EdQlPO6iOoSnndRHUJTzuojqEp53UR1CU87qI6hKed1EdQlPO6iOoSnndRHUJTzuo3gOwcThF5x+Xc4olhJ+7M6IJW8Ii0/tIrs27abFUpWn6UbHjyCTs2V7OpnyWrdDw8CrJAcgJOs6AcY5UGaiZVMc9FiaIC1BRYVFSL+7sGY2yRamLbie2NlDtv8AaNm5mE7M8De7FLYkhbmOIm01/bDKzqKGQoHsvbw3rNs7JHyCYWQtSRibglzdgTtr21GiJIXBha0WGRMJ5OkWTbeduI7GN1SbUdp0ligEpo0PeK5XeWUSAwsg5XSqYi6ceZGxncziwM7YIyOw7myfhXIbEjoDq2rtiq7tVtXZGD4kDOAQNtKgaPWzhvGT0TPQUR+HePI27GuOImxoiVjlVHIwyswX7aOH3k3HOErQRm/hY++3coyfgWlzHumgnratHDceoxnGQON8a2zEuVsxKF31czmPFJ3ldTzfKZa5O7bsezNySa6lWjnZMyQ0G3SISNUFGD/KLdmztB4qzhAtyEGxmrh7M1pMso2bkZ2xGmgC3R3PFxNkt5M1VLFAx79sCgSP36n3wNwHYOT4ReGIu5xX7UJP3ZkEEreERaf2kV2bdtNiqUrSX6fF+S1L9Pi/Jal+nxfktS/T4vyWpfp8X5LUv0+L8lqX6fF+S1L9Pi/Jal+nxfktS/T4vyWpfp8X5LUlx2h+c4ouTYC3+EwdGH+8C1GVO6UaFfsrpt2bK7U1rSv8h01jk5hxtOW1CzD4ZjMbfvMKRTNg3M8bt/4hy1ti+Iu3rgcNQ7Cugxq241JUSiqSIMP/AJQjs0RUdibK+Jb8cNoKZySmz2bOIt/K+NHDsoml+wd9W+mHn3ZreqQqJB+5kWcfW1JG3JmVv+z8Y2DbwOYm7xvu4oq17cjR1pXhpcy0w6aM0ncKpwmjWhVOXh6pbtRGOtA1W/PwfY97MmL7o7N/Yplrji5GBe5qvG7JRyHM2d4qKk61cAtUbJMjYkSdTZiqWZGhkOwsrjtq6Ydl8FnG3dcHiLbqGg1OAcThG4oozIptWFNFbw1bU1VSmytaKo9mvEMfTtPZrxDH07T2a8Qx9O09mvEMfTtPZrxDH07T2a8Qx9O09mvEMfTtPZrxDH07T2a8Qx9O09mvEMfTtPZrxDH07TmUI4a8bhocGaLDXjgK3XvpEyCuuxBlVTukTsVRNa7aUqmv8nBNpZIkIQC29uXlRUpa2RbaCtRC0bwWQrQfwV4MY5LpdHy4PvgkA8ejCeQinlRpprFl/ZucW4si7dhs8ZjyJku0oehRjFUIrQkpsFuSLWgxoTyc5GyrRW6hRArWEChRcdBwcMxaxkRDQ7FtGRUVGsQobso+NjmQgNGLFo3GMDVo1CIDcKECENCEpTT+7gPnMPZNrXDd0q2jBgNJOI224l3MvgR4XTlk1K+K1ZFG0G5eNAEOoaTOQDqoqMJ9t3/TfA//AGT1hPtu/wCm+B/+yerCz5aExi21om7rgc5gtfHkBGvI2YllQzUEOay8p5AdOHw3SKkON6zjwJBsUNyUn7qn4f8Aojlf/A574/0RsX/PDfFASOGvK8NDhJFhrx3jduvfSIgV12IMqqd0idiqJrXbSlU1ZQvh33qOmUL4d96jplC+Hfeo6ZQvh33qOmUL4d96jptGDbuua4i24XaDU4DNw4RuKK9Mim1YU0VvDVtTVVKbK1oqn87+iOV/8Dnvj/RGxf8APDfFxynN8v8AxHB4/D4DoDn7rih3t7g7n3id3e3v17N2tw9J9z1cPSfc9XD0n3PVw9J9z1cPSfc9TPN8pzH8P3dwOJx2p233vPG3d3jb/wB2re3d39W3ep/OZ9429dUHLW5PR/MO2fPws4wcRkoz5tgdq+a80xdHBzDNy3dg3+I3OEyUET2OP9wvap/5x12OP9wvap/5x1g/81Fw39BsLcu2Q/OXl++u9oWMfqk2TPlMlX/eLFhwHyqn5iMbM3ZNvDMcgdg/7huRmUiOy2m4CUScXCa52rOKvpdhr4zke7LrwjVpeFUNG51GAYDYy0ma1GL8QQYQhGspSlWkYhCGmqyEIRdaJQNCaVUtaq0SlNK1rWlKVrq7bQ7THafex7+PgbfsSej7mxnjeYqpwwpL5UvOCeOYyrmDeBOY2O4F46ux87aDjJutnsZAU8HJFzFz9TJAsuUycR+tdy0yCCaRPhn6OVbUUIGSGOomdB8gNohEchrSPTRtS7bU7NvanE2ZRMzat5yooDHOSJgYUBXO4uvWXIGFCqbc7iw4/uSSZXYxkHdYeDpeLRp385MJw2cCGdu4ARBgHAZFCCMEo6qGURRqSsZEKUhaFUUmtU1pX4291b2zVvdW9s1b3VvbNW91b2zVvdW9s1b3VvbNW91b2zVvdW9s1b3VvbNW91b2zVvdW9s1b3VvbNW91b2zVvdW9s1b3VvbNQ3Kc3zH8R3jx+HwGp3P3XIh3t7g7n3id3e3v17N2v6GL8f5Zsx8lVHVr5HtCAvOCIpVUKoakZcLCQaCcjWMRQuhCQ5bmEE4CjMIa0sVYmy3FNns467P7+YdvsV5FS3Cty5irFezRncpji73yqGrEM3Eq8x+8dcjCDjbIYkNONrbnPtx9o/sh9kO63n2k+1fefcv2b7l4PeHfne//jO6+X5zn/4Tg8f9jTBOW8qTUewmWfZ/j5qVi8a4zIZTd+1Y3nLW5JRsnka72SRjbzMch+3x40MaThSR17tBtZ4mL8e4ls5n+tta2NrOt6yYAS95a1FpE23HxrFRyEKUpXCwqMYxSlKRZCkUr4PYXxD707T2F8Q+9O09hfEPvTtPYXxD707T2F8Q+9O09hfEPvTtPYXxD707T2F8Q+9O09hfEPvTtPYXxD707T2F8Q+9O09hfEPvTtPYXxD707T2F8Q+9O09hfEPvTtOYwjdrzXEQ3M7WavHZuG6NxJWQUV2LMmqt4idiaKrTbWlE1/StZiKw/zBucwiiG7Bu2h1drAlxJx0e5nDWiyN3hy2a6c36cyWjZynIpGt1LcFkuIcn4pKaLUlKVL2U3lJRVVUJqr/AN1Smq11TStdiarVWmyqq7f7M//EADwRAAECAgYFCAkDBQAAAAAAAAECEQMSAAQhMUFRExRAcbEQIjJhcoGRogUVI0JSYIKh0kNTkiQzUGLB/9oACAECAQE/AP8ANMWfB2fr2vU1aoze1m0rY3NJvl81m0pAUQCpKBmqZvKFH7UqtVgpaJOmMrAjopPUHNvWq7AA8laqsFTxJ0wVG8lpVHrHxH/W03kE0UAksFJWM0zN5kpP22iFFXBWFoLZjBQyIxHC8W01lGg0/utdjNdLvms3W3UixVxlFay5wGCRkBgON5t2rSHRaLCefvlb5vECHDSFVlaklQdMJABiEZqJsS+R8XsH9Evm+2hHBZlUn6gLW3NvFIsFUJQBZSVB0LTalacweIw3MTs9VQF1iEk3TE75QVN3tSKsxIi1m9SidwwHcGHIkz1OID+itCknIRDKRue1s22iFE0URET4VAkZi4jvDilYgkExYfOgrMyVC0Je9KsiDZbxeiUqWQlIKibgA58BSK0CAIDgxFqC4oDGQAc1D54nK3Ah9ohxosL+2spe8XpO9Jcd7PQ1yOQQFBL3yJSk+LP4Gl9p+bwHIAvJA8S1PV0f44X8l/hT1dH+OF/Jf4Uj1WJVwkrKCFEgSlRuD2ulO0I6aO2niOX0l0IXbPDaEdNHbTxHL6S6ELtnhtAJBBF4LjeKa7Wv3fJD/Cmu1r93yQ/wpFjxYwAiLmALjmpDH6QPmHQHVtM36jfQzPuns2qr1KJFIKwYcPEqDKUMkg8TZk91JEyaOUSSyy4SszUj1OJCJKAVw8CA6kjJQ/6LMS120JUpBdKik5pJB+1KvX1pITG5yTZP7yes4KGeONt1HDTOGZ3wa93yalYr61Epg81IsnYTK3P0Rl72Li6ilKWXUoqOaiSfvtOsq1TQvbPK726Npm8bOzZ80f/EADkRAAECAQgFCQgDAQAAAAAAAAECEQMAEiExQVFhcRNAkaHBBBAjMlJgcrHwFCJCgYKi0dJDUJLh/9oACAEDAQE/AP7rDW9MNM/wNMfe+3drJJAoBVgG4kSixVl0sUC60jE3HDaeaFFWGSxWLrQM7hjtEgSRSCnAtwJ1haErDKGRtGI9Zy0StJo7XrwrfZTurkhCUBkjM2nE+stamifPtmzd797zEUokQgCBQVq6oOF/qyvp00+4sXUg/Is215IWFhxQRQpJrBuPre41iKSmGoitm2kDjJCQlKUiwb7T8zTzETYySP5EqB+kO/kNYWmelSbxvsPyMoa3ExVC00EG1qiL3F3k0iQA5IAvMkdJE0je4kFKDU5tOVY/6DrKkIX1kg427RTIQIYpYnxEkbPz3wJYE3AnZL2mHcvYP2l7TDuXsH7ShxUxCQkKDB6QOBOsL6qvCfI8/Jusrw8RrC+qrwnyPPybrK8PEawQ4INRoloIXZ+5X5loIXZ+5X5kmGhBJSGJorJ8ye8Ok6XRv8L/AFVt/mnWokdKKEspWFQzPAU5SnGdOcznd7XlDjpWAFGarGo5Hgac9YIBoIBzDyicnBDooPZsOVx3ZSYu1tTWvKHycAOuk9mwZ3ndnXIACgAAYBvLWdGNNPaia+E6rypzp70f/9k="},{value:i.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],rc=o=>N.jsx(qi,{...o,options:oc}),Ji=`${Yi}_ORDER_LIST_TYPE_COMPONENT`,Zi=`${Yi}_BULLET_LIST_TYPE_COMPONENT`,ic=o=>{const e=Object.keys(i.PAGE_SIZE).find(n=>{const{width:r,height:s}=i.PAGE_SIZE[n];return o.width===r&&o.height===s});return e!=null?e:"A4"};function sc(o){const{hooks:t}=o,r=I.useDependency(i.IUniverInstanceService).getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC).getDocumentStyle(),s=I.useDependency(i.LocaleService),[a,c]=P.useState(()=>{var d,u,m,g,h;return{paperSize:ic(r.pageSize),orientation:(d=r.pageOrient)!=null?d:i.PageOrientType.PORTRAIT,margins:{top:(u=r.marginTop)!=null?u:0,bottom:(m=r.marginBottom)!=null?m:0,left:(g=r.marginLeft)!=null?g:0,right:(h=r.marginRight)!=null?h:0}}});P.useEffect(()=>{t.beforeClose=()=>a,t.beforeConfirm=()=>a},[a]);const l=d=>{c(u=>({...u,paperSize:d}))},A=(d,u)=>{c(m=>({...m,margins:{...m.margins,[d]:u||0}}))};return N.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-4",children:[N.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[N.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:s.t("page-settings.paper-size")}),N.jsx(q.Select,{value:a.paperSize,onChange:l,options:i.PAPER_TYPES.map(d=>({label:s.t(`page-settings.page-size.${d.toLocaleLowerCase()}`),value:d}))})]}),N.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[N.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:s.t("page-settings.custom-paper-size")}),N.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2.5",children:[N.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[N.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[N.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:s.t("page-settings.top")}),N.jsx(q.InputNumber,{value:a.margins.top,onChange:d=>A("top",d)})]}),N.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[N.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:s.t("page-settings.bottom")}),N.jsx(q.InputNumber,{value:a.margins.bottom,onChange:d=>A("bottom",d)})]})]}),N.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[N.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[N.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:s.t("page-settings.left")}),N.jsx(q.InputNumber,{value:a.margins.left,onChange:d=>A("left",d)})]}),N.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[N.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:s.t("page-settings.right")}),N.jsx(q.InputNumber,{value:a.margins.right,onChange:d=>A("right",d)})]})]})]})]})]})}const Jn="docs.component.page-setting",$i={id:"docs.command.page-setup",type:i.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(i.IUniverInstanceService),n=o.get(i.ICommandService),r=e.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_DOC);if(!r)return!1;const{marginLeft:s,marginRight:a,marginBottom:c,marginTop:l,pageOrient:A,pageSize:d}=t,u=i.JSONX.getInstance(),m=r.getDocumentStyle(),{marginBottom:g,marginLeft:h,marginRight:p,marginTop:f,pageOrient:S,pageSize:E}=m,C=[];if(g===void 0){const v=u.insertOp(["documentStyle","marginBottom"],c);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginBottom"],g,c);v&&C.push(v)}if(h===void 0){const v=u.insertOp(["documentStyle","marginLeft"],s);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginLeft"],h,s);v&&C.push(v)}if(p===void 0){const v=u.insertOp(["documentStyle","marginRight"],a);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginRight"],p,a);v&&C.push(v)}if(f===void 0){const v=u.insertOp(["documentStyle","marginTop"],l);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginTop"],f,l);v&&C.push(v)}if(E===void 0){const v=u.insertOp(["documentStyle","pageSize"],d);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageSize"],E,d);v&&C.push(v)}if(S===void 0){const v=u.insertOp(["documentStyle","pageOrient"],A);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageOrient"],S,A);v&&C.push(v)}const T={id:D.RichTextEditingMutation.id,params:{unitId:r.getUnitId(),actions:[],textRanges:void 0}};return T.params.actions=C.reduce((v,b)=>i.JSONX.compose(v,b),null),!!n.syncExecuteCommand(T.id,T.params)}},Jo={id:"docs.operation.open-page-setting",type:i.CommandType.OPERATION,handler:o=>{const t=o.get(I.IConfirmService),e=o.get(i.ICommandService),n=o.get(i.LocaleService),r=t.open({id:Jn,title:{label:n.t("page-settings.document-setting")},children:{label:Jn},width:528,onClose:()=>{r.dispose()},onConfirm:s=>{if(r.dispose(),!s)return;const a=i.PAGE_SIZE[s.paperSize];e.executeCommand($i.id,{pageOrient:s.orientation,marginTop:s.margins.top,marginBottom:s.margins.bottom,marginLeft:s.margins.left,marginRight:s.margins.right,pageSize:a})},confirmText:n.t("page-settings.confirm"),cancelText:n.t("page-settings.cancel")});return!0}};function ac(o){const t=o.get(i.IUniverInstanceService),e=o.get(B.IRenderManagerService);return new U.Observable(n=>{const r=t.focused$.subscribe(s=>{if(s==null||t.getUnitType(s)!==i.UniverInstanceType.UNIVER_DOC)return n.next(!0);const c=e.getRenderById(s);if(c==null)return n.next(!0);c.with(D.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(A=>{n.next(A===B.DocumentEditArea.HEADER||A===B.DocumentEditArea.FOOTER)})});return()=>r.unsubscribe()})}function cc(o){const t=o.get(i.IUniverInstanceService),e=o.get(i.ICommandService);return new U.Observable(n=>{const r=e.onCommandExecuted(l=>{if(l.id===D.RichTextEditingMutation.id){const{unitId:A}=l.params,d=t.getUnit(A);if(d==null){n.next(!0);return}const{documentStyle:u}=d.getSnapshot();n.next((u==null?void 0:u.documentFlavor)!==i.DocumentFlavor.TRADITIONAL)}}),s=t.focused$.subscribe(l=>{if(l==null)return n.next(!0);const A=t.getUniverDocInstance(l),d=A==null?void 0:A.getSnapshot().documentStyle.documentFlavor;n.next(d!==i.DocumentFlavor.TRADITIONAL)}),a=t.getCurrentUniverDocInstance();if(a==null)return n.next(!0);const c=a==null?void 0:a.getSnapshot().documentStyle.documentFlavor;return n.next(c!==i.DocumentFlavor.TRADITIONAL),()=>{r.dispose(),s.unsubscribe()}})}function lc(o){const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService);return new U.Observable(n=>{const r=t.textSelection$.subscribe(s=>{if(s==null){n.next(!0);return}const{textRanges:a}=s;if(a.length!==1){n.next(!0);return}const c=a[0],{collapsed:l,startNodePosition:A,startOffset:d}=c;if(!l||d==null){n.next(!0);return}const u=e.getCurrentUniverDocInstance();if(u==null){n.next(!0);return}const m=ae(o,u.getUnitId());if(m==null){n.next(!0);return}if(m.getViewModel().getCustomRangeRaw(d)){n.next(!0);return}if(A!=null){const{path:p}=A;if(p.indexOf("cells")!==-1){n.next(!0);return}}n.next(!1)});return()=>r.unsubscribe()})}function ee(o){const t=o.get(D.DocSelectionManagerService);return new U.Observable(e=>{const n=t.textSelection$.subscribe(r=>{if(r==null){e.next(!0);return}const{textRanges:s,rectRanges:a}=r;if(s.length===0&&a.length===0){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function dc(o){const t=o.get(i.ICommandService);return{id:Pe.id,type:I.MenuItemType.BUTTON,icon:"BoldIcon",title:"Set bold",tooltip:"toolbar.bold",activated$:new U.Observable(e=>{const n=()=>{var c;const s=pe(o);if(s==null){e.next(!1);return}const a=(c=s.ts)==null?void 0:c.bl;e.next(a===i.BooleanNumber.TRUE)},r=t.onCommandExecuted(s=>{const a=s.id;(a===D.SetTextSelectionsOperation.id||a===xe.id)&&n()});return n(),r.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function Ac(o){const t=o.get(i.ICommandService);return{id:we.id,type:I.MenuItemType.BUTTON,icon:"ItalicIcon",title:"Set italic",tooltip:"toolbar.italic",activated$:new U.Observable(e=>{const n=()=>{var c;const s=pe(o);if(s==null){e.next(!1);return}const a=(c=s.ts)==null?void 0:c.it;e.next(a===i.BooleanNumber.TRUE)},r=t.onCommandExecuted(s=>{const a=s.id;(a===D.SetTextSelectionsOperation.id||a===xe.id)&&n()});return n(),r.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function uc(o){const t=o.get(i.ICommandService);return{id:Ue.id,type:I.MenuItemType.BUTTON,icon:"UnderlineIcon",title:"Set underline",tooltip:"toolbar.underline",activated$:new U.Observable(e=>{const n=()=>{var c;const s=pe(o);if(s==null){e.next(!1);return}const a=(c=s.ts)==null?void 0:c.ul;e.next((a==null?void 0:a.s)===i.BooleanNumber.TRUE)},r=t.onCommandExecuted(s=>{const a=s.id;(a===D.SetTextSelectionsOperation.id||a===xe.id)&&n()});return n(),r.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function gc(o){const t=o.get(i.ICommandService);return{id:Le.id,type:I.MenuItemType.BUTTON,icon:"StrikethroughIcon",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new U.Observable(e=>{const n=()=>{var c;const s=pe(o);if(s==null){e.next(!1);return}const a=(c=s.ts)==null?void 0:c.st;e.next((a==null?void 0:a.s)===i.BooleanNumber.TRUE)},r=t.onCommandExecuted(s=>{const a=s.id;(a===D.SetTextSelectionsOperation.id||a===xe.id)&&n()});return n(),r.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function hc(o){const t=o.get(i.ICommandService);return{id:Re.id,type:I.MenuItemType.BUTTON,icon:"SubscriptIcon",tooltip:"toolbar.subscript",activated$:new U.Observable(e=>{const n=()=>{var c;const s=pe(o);if(s==null){e.next(!1);return}const a=(c=s.ts)==null?void 0:c.va;e.next(a===i.BaselineOffset.SUBSCRIPT)},r=t.onCommandExecuted(s=>{const a=s.id;(a===D.SetTextSelectionsOperation.id||a===xe.id)&&n()});return n(),r.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function mc(o){const t=o.get(i.ICommandService);return{id:Qe.id,type:I.MenuItemType.BUTTON,icon:"SuperscriptIcon",tooltip:"toolbar.superscript",activated$:new U.Observable(e=>{const n=()=>{var c;const s=pe(o);if(s==null){e.next(!1);return}const a=(c=s.ts)==null?void 0:c.va;e.next(a===i.BaselineOffset.SUPERSCRIPT)},r=t.onCommandExecuted(s=>{const a=s.id;(a===D.SetTextSelectionsOperation.id||a===xe.id)&&n()});return n(),r.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function pc(o){const t=o.get(i.ICommandService);return{id:_e.id,tooltip:"toolbar.font",type:I.MenuItemType.SELECTOR,label:I.FONT_FAMILY_COMPONENT,selections:[{label:{name:I.FONT_FAMILY_ITEM_COMPONENT,hoverable:!1,selectable:!1,props:{id:_e.id}}}],value$:new U.Observable(e=>{const n=i.DEFAULT_STYLES.ff,r=()=>{var l;const a=pe(o);if(a==null){e.next(n);return}const c=(l=a.ts)==null?void 0:l.ff;e.next(c!=null?c:n)},s=t.onCommandExecuted(a=>{const c=a.id;(c===D.SetTextSelectionsOperation.id||c===_e.id)&&r()});return r(),s.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function fc(o){const t=o.get(i.ICommandService);return{id:he.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:I.FONT_SIZE_COMPONENT,props:{min:1,max:400}},selections:I.FONT_SIZE_LIST,value$:new U.Observable(e=>{const n=i.DEFAULT_STYLES.fs,r=()=>{var l;const a=pe(o);if(a==null){e.next(n);return}const c=(l=a.ts)==null?void 0:l.fs;e.next(c!=null?c:n)},s=t.onCommandExecuted(a=>{const c=a.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&r()});return r(),s.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function Sc(o){const t=o.get(i.ICommandService);return{id:ce.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.heading.tooltip",label:{name:I.COMMON_LABEL_COMPONENT,props:{selections:I.HEADING_LIST}},selections:I.HEADING_LIST.map(e=>({label:{name:I.HEADING_ITEM_COMPONENT,props:{value:e.value,text:e.label}},value:e.value})),value$:new U.Observable(e=>{const n=i.NamedStyleType.NORMAL_TEXT,r=()=>{var l,A;const a=Xe(o);if(a==null){e.next(n);return}const c=(A=(l=a.paragraphStyle)==null?void 0:l.namedStyleType)!=null?A:n;e.next(c)},s=t.onCommandExecuted(a=>{const c=a.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&r()});return r(),s.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function Ic(o){const t=o.get(i.ICommandService),e=o.get(i.ThemeService);return{id:ve.id,icon:"FontColorDoubleIcon",tooltip:"toolbar.textColor.main",type:I.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new U.Observable(n=>{const r=i.DEFAULT_STYLES.cl.rgb,s=()=>{var A,d;const c=pe(o);if(!c){n.next(r);return}const l=(d=(A=c.ts)==null?void 0:A.cl)==null?void 0:d.rgb;n.next(l!=null?l:r)},a=t.onCommandExecuted(c=>{c.id===ve.id&&s()});return s(),a.dispose})}],value$:new U.Observable(n=>{const r=e.getColorFromTheme("gray.900"),s=t.onCommandExecuted(a=>{if(a.id===ve.id){const c=a.params.value;n.next(c!=null?c:r)}});return n.next(r),s.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function vc(o){return{id:Yo.id,type:I.MenuItemType.BUTTON,icon:"HeaderFooterIcon",tooltip:"toolbar.headerFooter",hidden$:U.combineLatest(I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY),cc(o),(t,e)=>t||e)}}const Ec="GridIcon",es="doc.menu.table";function Cc(o){return{id:es,type:I.MenuItemType.SUBITEMS,icon:Ec,tooltip:"toolbar.table.main",disabled$:lc(o),hidden$:U.combineLatest(I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY),ac(o),(t,e)=>t||e)}}function Tc(o){return{id:bn.id,title:"toolbar.table.insert",type:I.MenuItemType.BUTTON,hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function yc(o){const t=o.get(i.ICommandService);return{id:Mt.id,type:I.MenuItemType.BUTTON,icon:"LeftJustifyingIcon",tooltip:"toolbar.alignLeft",disabled$:ee(o),activated$:new U.Observable(e=>{const n=t.onCommandExecuted(r=>{var a;const s=r.id;if(s===D.SetTextSelectionsOperation.id||s===me.id){const c=Xe(o);if(c==null)return;const l=(a=c.paragraphStyle)==null?void 0:a.horizontalAlign;e.next(l===i.HorizontalAlign.LEFT)}});return e.next(!1),n.dispose}),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function bc(o){const t=o.get(i.ICommandService);return{id:Dt.id,type:I.MenuItemType.BUTTON,icon:"HorizontallyIcon",tooltip:"toolbar.alignCenter",activated$:new U.Observable(e=>{const n=t.onCommandExecuted(r=>{var a;const s=r.id;if(s===D.SetTextSelectionsOperation.id||s===me.id){const c=Xe(o);if(c==null)return;const l=(a=c.paragraphStyle)==null?void 0:a.horizontalAlign;e.next(l===i.HorizontalAlign.CENTER)}});return e.next(!1),n.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Rc(o){const t=o.get(i.ICommandService);return{id:Bt.id,type:I.MenuItemType.BUTTON,icon:"RightJustifyingIcon",tooltip:"toolbar.alignRight",activated$:new U.Observable(e=>{const n=t.onCommandExecuted(r=>{var a;const s=r.id;if(s===D.SetTextSelectionsOperation.id||s===me.id){const c=Xe(o);if(c==null)return;const l=(a=c.paragraphStyle)==null?void 0:a.horizontalAlign;e.next(l===i.HorizontalAlign.RIGHT)}});return e.next(!1),n.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function xc(o){const t=o.get(i.ICommandService);return{id:_t.id,type:I.MenuItemType.BUTTON,icon:"AlignTextBothIcon",tooltip:"toolbar.alignJustify",activated$:new U.Observable(e=>{const n=t.onCommandExecuted(r=>{var a;const s=r.id;if(s===D.SetTextSelectionsOperation.id||s===me.id){const c=Xe(o);if(c==null)return;const l=(a=c.paragraphStyle)==null?void 0:a.horizontalAlign;e.next(l===i.HorizontalAlign.JUSTIFIED)}});return e.next(!1),n.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Oc(o){return{id:Rt.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",tooltip:"toolbar.horizontalLine",disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}const Et=o=>new U.Observable(t=>{const e=o.get(i.IUniverInstanceService),n=o.get(D.DocSelectionManagerService);let r;const s=e.focused$.subscribe(a=>{if(r==null||r.unsubscribe(),a==null)return;const c=e.getUniverDocInstance(a);c!=null&&(r=n.textSelection$.subscribe(()=>{var d,u,m,g,h;const l=n.getDocRanges(),A=(d=l.find(p=>p.isActive))!=null?d:l[0];if(A){const p=c.getSelfOrHeaderFooterModel(A==null?void 0:A.segmentId),f=i.BuildTextUtils.range.getParagraphsInRange(A,(m=(u=p.getBody())==null?void 0:u.paragraphs)!=null?m:[],(h=(g=p.getBody())==null?void 0:g.dataStream)!=null?h:"");let S;if(f.every(E=>{var C;return S||(S=(C=E.bullet)==null?void 0:C.listType),E.bullet&&E.bullet.listType===S})){t.next(S);return}}t.next(void 0)}))});return()=>{s.unsubscribe(),r==null||r.unsubscribe()}});function Or(o){return{id:ot.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:Ji,hoverable:!1,selectable:!1},value$:Et(o)}],icon:"OrderIcon",tooltip:"toolbar.order",hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC),disabled$:ee(o),activated$:Et(o).pipe(U.map(t=>!!(t&&t.indexOf("ORDER_LIST")===0)))}}function Mr(o){return{id:nt.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:Zi,hoverable:!1,selectable:!1},value$:Et(o)}],icon:"UnorderIcon",tooltip:"toolbar.unorder",disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC),activated$:Et(o).pipe(U.map(t=>!!(t&&t.indexOf("BULLET_LIST")===0)))}}function Dr(o){return{id:vt.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",tooltip:"toolbar.checklist",disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC),activated$:Et(o).pipe(U.map(t=>!!(t&&t.indexOf("CHECK_LIST")===0)))}}function Mc(o){const t=o.get(i.ICommandService),e=o.get(i.IUniverInstanceService);return{id:Nt.id,type:I.MenuItemType.BUTTON,icon:"KeyboardIcon",tooltip:"toolbar.documentFlavor",hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC,void 0,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY),activated$:new U.Observable(n=>{var a;const r=t.onCommandExecuted(c=>{var l;if(c.id===D.RichTextEditingMutation.id){const A=e.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);n.next(((l=A==null?void 0:A.getSnapshot())==null?void 0:l.documentStyle.documentFlavor)===i.DocumentFlavor.MODERN)}}),s=e.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);return n.next(((a=s==null?void 0:s.getSnapshot())==null?void 0:a.documentStyle.documentFlavor)===i.DocumentFlavor.MODERN),()=>r.dispose()})}}function Dc(o){return{id:it.id,type:I.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon"}}function Bc(o){const t=o.get(i.ICommandService),e=o.get(i.ThemeService);return{id:Ee.id,tooltip:"toolbar.fillColor.main",type:I.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucketDoubleIcon",selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new U.Observable(n=>{const r=i.DEFAULT_STYLES.bg.rgb,s=()=>{var A,d;const c=pe(o);if(!c){n.next(r);return}const l=(d=(A=c.ts)==null?void 0:A.bg)==null?void 0:d.rgb;n.next(l!=null?l:r)},a=t.onCommandExecuted(c=>{c.id===Ee.id&&s()});return s(),a.dispose})}],value$:new U.Observable(n=>{const r=e.getColorFromTheme("primary.600"),s=t.onCommandExecuted(a=>{if(a.id===Ee.id){const c=a.params.value;n.next(c!=null?c:r)}});return n.next(r),s.dispose}),disabled$:ee(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function pe(o){var h,p,f,S;const t=o.get(i.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=o.get(Ce),r=t.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),s=e.getDocRanges(),a=(h=s.find(E=>E.isActive))!=null?h:s[0],c=n.getDefaultStyle(),l=(p=n.getStyleCache())!=null?p:{},A=Xe(o),d=(f=A==null?void 0:A.paragraphStyle)!=null&&f.namedStyleType?i.NAMED_STYLE_MAP[(S=A==null?void 0:A.paragraphStyle)==null?void 0:S.namedStyleType]:null;if(r==null||a==null)return{ts:{...c,...d,...l}};const{segmentId:u}=a,m=r.getSelfOrHeaderFooterModel(u).getBody();if(m==null)return{ts:{...c,...d,...l}};const g=mi(m,a,{});return i.Tools.deleteNull(g),{ts:{...c,...d,...g,...l}}}function Xe(o){var d,u;const t=o.get(i.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUniverDocInstance(),r=e.getDocRanges(),s=(d=r.find(m=>m.isActive))!=null?d:r[0];if(n==null||s==null)return;const{startOffset:a,segmentId:c}=s,l=(u=n.getSelfOrHeaderFooterModel(c).getBody())==null?void 0:u.paragraphs;if(l==null)return;let A=-1;for(const m of l){const{startIndex:g}=m;if(a>A&&a<=g)return m;A=g}return null}function _c(o){return{id:Jo.id,type:I.MenuItemType.BUTTON,icon:"DocumentSettingIcon",tooltip:"toolbar.pageSetup",hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}const Nc={[i.NamedStyleType.HEADING_1]:Po,[i.NamedStyleType.HEADING_2]:wo,[i.NamedStyleType.HEADING_3]:Uo,[i.NamedStyleType.HEADING_4]:Lo,[i.NamedStyleType.HEADING_5]:Qo,[i.NamedStyleType.NORMAL_TEXT]:Kt,[i.NamedStyleType.TITLE]:Ci,[i.NamedStyleType.SUBTITLE]:Ti,[i.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:Kt},ts={[i.NamedStyleType.HEADING_1]:{key:"H1Icon",component:Ui},[i.NamedStyleType.HEADING_2]:{key:"H2Icon",component:Li},[i.NamedStyleType.HEADING_3]:{key:"H3Icon",component:Qi},[i.NamedStyleType.HEADING_4]:{key:"H4Icon",component:Fi},[i.NamedStyleType.HEADING_5]:{key:"H5Icon",component:Hi},[i.NamedStyleType.NORMAL_TEXT]:{key:"TextTypeIcon",component:mt},[i.NamedStyleType.TITLE]:{key:"TextTypeIcon",component:mt},[i.NamedStyleType.SUBTITLE]:{key:"TextTypeIcon",component:mt},[i.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:{key:"TextTypeIcon",component:mt}},Fe=o=>t=>{const e=t.get(i.ICommandService),n=t.get(I.ComponentManager),r=ts[o];return n.get(r.key)||n.register(r.key,r.component),{id:Nc[o].id,type:I.MenuItemType.BUTTON,icon:r.key,tooltip:"toolbar.heading.tooltip",disabled$:ee(t),hidden$:I.getMenuHiddenObservable(t,i.UniverInstanceType.UNIVER_DOC),activated$:new U.Observable(s=>{const a=i.NamedStyleType.NORMAL_TEXT,c=()=>{var u,m;const A=Xe(t);if(A==null){s.next(a===o);return}const d=(m=(u=A.paragraphStyle)==null?void 0:u.namedStyleType)!=null?m:a;s.next(d===o)},l=e.onCommandExecuted(A=>{const d=A.id;(d===D.SetTextSelectionsOperation.id||d===he.id)&&c()});return c(),l.dispose})}},Pc=Fe(i.NamedStyleType.HEADING_1),wc=Fe(i.NamedStyleType.HEADING_2),Uc=Fe(i.NamedStyleType.HEADING_3),Lc=Fe(i.NamedStyleType.HEADING_4),Qc=Fe(i.NamedStyleType.HEADING_5),Fc=Fe(i.NamedStyleType.NORMAL_TEXT);Fe(i.NamedStyleType.TITLE);Fe(i.NamedStyleType.SUBTITLE);const Hc=o=>({id:Eo.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy"}),kc=o=>({id:Co.id,type:I.MenuItemType.BUTTON,icon:"CutIcon",title:"rightClick.cut"}),Vc=o=>({id:So.id,type:I.MenuItemType.BUTTON,icon:"DeleteIcon",title:"rightClick.delete"}),jc=o=>({id:Bo.id,type:I.MenuItemType.BUTTON,icon:"UnorderIcon",title:"rightClick.bulletList"}),Wc=o=>({id:_o.id,type:I.MenuItemType.BUTTON,icon:"OrderIcon",title:"rightClick.orderList"}),Gc=o=>({id:No.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",title:"rightClick.checkList"}),Xc=o=>({id:To.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",title:"toolbar.horizontalLine"}),ns="doc.menu.insert-bellow";function Kc(o){return{id:ns,type:I.MenuItemType.SUBITEMS,title:"rightClick.insertBellow"}}const Zn=4;var zc=Object.getOwnPropertyDescriptor,Yc=(o,t,e,n)=>{for(var r=n>1?void 0:n?zc(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Ut=(o,t)=>(e,n)=>t(e,n,o);function os(o,t){const e=Br(o.left,o.top,t),n=Br(o.right,o.bottom,t);return{left:e.x,top:e.y,right:n.x,bottom:n.y}}function Br(o,t,e){const{scaleX:n,scaleY:r}=e.getAncestorScale(),s=e.getViewport(ie.VIEW_MAIN);if(!s)return{x:o,y:t};const{viewportScrollX:a,viewportScrollY:c}=s,l=(o-a)*n,A=(t-c)*r;return{x:l,y:A}}function _r(o,t,e){const{scaleX:n,scaleY:r}=e.getAncestorScale(),s=e.getViewport(ie.VIEW_MAIN);if(!s)return{x:o,y:t};const{viewportScrollX:a,viewportScrollY:c}=s,l=o/n+a,A=t/r+c;return{x:l,y:A}}const Gt=(o,t)=>{const{scene:e,mainComponent:n,engine:r}=t,s=t.with(D.DocSkeletonManagerService).getSkeleton(),a=s.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,o.segmentPage),c=o.collapsed?o.startOffset:o.endOffset-1,l=s.findNodePositionByCharIndex(c,!0,o.segmentId,o.segmentPage),A=n;if(!l||!a)return;const d=A.getOffsetConfig(),{docsLeft:u,docsTop:m}=d,g=r.getCanvasElement(),h=g.getBoundingClientRect(),p=B.pxToNum(g.style.width),{top:f,left:S,width:E}=h,C=E/p,{scaleX:T,scaleY:R}=e.getAncestorScale(),v=new Te(d,s),{borderBoxPointGroup:b}=v.getRangePointData(a,l);return Sn(b).map(_=>os(_,e)).map(_=>({left:(_.left+u*T)*C+S,right:(_.right+u*T)*C+S,top:(_.top+m*R)*C+f,bottom:(_.bottom+m*R)*C+f}))};exports.DocCanvasPopManagerService=class extends i.Disposable{constructor(t,e,n,r){super(),this._globalPopupManagerService=t,this._renderManagerService=e,this._univerInstanceService=n,this._commandService=r}_createRectPositionObserver(t,e){const n=()=>{const{scene:l,engine:A}=e,d=typeof t=="function"?t():t,u=A.getCanvasElement(),m=u.getBoundingClientRect(),g=B.pxToNum(u.style.width),h=os(d,l),{top:p,left:f,width:S}=m,E=S/g;return{left:h.left*E+f,right:h.right*E+f,top:h.top*E+p,bottom:h.bottom*E+p}},r=n(),s=new U.BehaviorSubject(r),a=new i.DisposableCollection;a.add(this._commandService.onCommandExecuted(l=>{if(l.id===de.id||l.id===D.RichTextEditingMutation.id){const A=n();A&&s.next(A)}}));const c=e.scene.getViewport(ie.VIEW_MAIN);return c&&a.add(c.onScrollAfter$.subscribeEvent(()=>{s.next(n())})),{position:r,position$:s,disposable:a}}_createObjectPositionObserver(t,e){const n=()=>{const{left:r,top:s,width:a,height:c}=t;return{left:r,right:r+a,top:s,bottom:s+c}};return this._createRectPositionObserver(n,e)}_createRangePositionObserver(t,e){var c;const n=(c=Gt(t,e))!=null?c:[],r=new U.BehaviorSubject(n),s=new i.DisposableCollection;s.add(this._commandService.onCommandExecuted(l=>{if((l.id===de.id||l.id===D.RichTextEditingMutation.id)&&l.params.unitId===e.unitId){const d=Gt(t,e);d&&r.next(d)}}));const a=e.scene.getViewport(ie.VIEW_MAIN);return a&&s.add(a.onScrollAfter$.subscribeEvent(()=>{const l=Gt(t,e);l&&r.next(l)})),{positions:n,positions$:r,disposable:s}}attachPopupToRect(t,e,n){const r=this._renderManagerService.getRenderById(n);if(!r)throw new Error(`Current render not found, unitId: ${n}`);const{position:s,position$:a,disposable:c}=this._createRectPositionObserver(t,r),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:s,anchorRect$:a,canvasElement:r.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),a.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToObject(t,e,n){const r=this._renderManagerService.getRenderById(n);if(!r)throw new Error(`Current render not found, unitId: ${n}`);const{position:s,position$:a,disposable:c}=this._createObjectPositionObserver(t,r),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:s,anchorRect$:a,canvasElement:r.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),a.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToRange(t,e,n){if(!this._univerInstanceService.getUnit(n))throw new Error(`Document not found, unitId: ${n}`);const{direction:s="top",multipleDirection:a}=e,c=this._renderManagerService.getRenderById(n);if(!c)throw new Error(`Current render not found, unitId: ${n}`);const{positions:l,positions$:A,disposable:d}=this._createRangePositionObserver(t,c),u=A.pipe(U.map(g=>s.includes("top")?g[0]:g[g.length-1])),m=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:s.includes("top")?l[0]:l[l.length-1],anchorRect$:u,excludeRects:l,excludeRects$:A,direction:["top","bottom","horizontal"].some(g=>s.includes(g))&&l.length>1&&a!=null?a:s,canvasElement:c.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(m),A.complete(),d.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==m}}};exports.DocCanvasPopManagerService=Yc([Ut(0,i.Inject(I.ICanvasPopupService)),Ut(1,B.IRenderManagerService),Ut(2,i.IUniverInstanceService),Ut(3,i.ICommandService)],exports.DocCanvasPopManagerService);var qc=Object.getOwnPropertyDescriptor,Jc=(o,t,e,n)=>{for(var r=n>1?void 0:n?qc(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Zc=(o,t)=>(e,n)=>t(e,n,o);const $c=(o,t,e,n)=>{var m,g,h,p,f;const r=e.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,n),s=e.getSkeletonData();let a=o.endOffset-1;if(o.segmentId){const S=(f=Array.from((g=(m=s==null?void 0:s.skeFooters.get(o.segmentId))==null?void 0:m.values())!=null?g:[])[0])!=null?f:Array.from((p=(h=s==null?void 0:s.skeHeaders.get(o.segmentId))==null?void 0:h.values())!=null?p:[])[0];S&&(a=Math.min(S.ed,a))}const c=e.findNodePositionByCharIndex(a,!0,o.segmentId,n);if(!c||!r)return;const l=t.getOffsetConfig(),A=new Te(l,e),{borderBoxPointGroup:d}=A.getRangePointData(r,c);return Sn(d).map(S=>({top:S.top+l.docsTop-Zn,bottom:S.bottom+l.docsTop+Zn,left:S.left+l.docsLeft,right:S.right+l.docsLeft}))},Nr=(o,t,e,n)=>{const r=[];for(const s of o){const a=s.top;for(const c of s.columns){const l=c.left,A=s.colCount===1?n:c.width;let d=null;for(const u of c.lines){const m=u.paragraphIndex;if(u.paragraphStart){d&&(r.push(d),d=null);const g={top:t+a+u.top,left:e+l,right:e+l+A,bottom:t+a+u.top+u.lineHeight};d={paragraphStart:u.st,paragraphEnd:m,startIndex:m,rect:g,fisrtLine:{top:t+a+u.top+u.marginTop+u.paddingTop,left:e+l,right:e+l+A,bottom:t+a+u.top+u.marginTop+u.paddingTop+u.contentHeight}}}else d&&d.startIndex===m&&(d.rect.bottom=t+a+u.top+u.lineHeight)}d&&r.push(d)}}return r},el=(o,t,e,n=-1)=>{const r=e.findPositionByGlyph(o,n);if(!r)return;const s=t.getOffsetConfig(),a={...r,isBack:!0},c=new Te(s,e),{borderBoxPointGroup:l}=c.getRangePointData(a,a),d=Sn(l)[0];return{top:d.top+s.docsTop,bottom:d.bottom+s.docsTop,left:d.left+s.docsLeft,right:d.left+s.docsLeft+o.width}};function ke(o,t,e){const{left:n,right:r,top:s,bottom:a}=e;return o>=n&&o<=r&&t>=s&&t<=a}exports.DocEventManagerService=class extends i.Disposable{constructor(e,n){super();M(this,"_hoverCustomRanges$",new U.BehaviorSubject([]));M(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe(U.distinctUntilChanged((e,n)=>e.length===n.length&&e.every((r,s)=>n[s].range.rangeId===r.range.rangeId&&n[s].segmentId===r.segmentId&&n[s].segmentPageIndex===r.segmentPageIndex&&n[s].range.startIndex===r.range.startIndex))));M(this,"_clickCustomRanges$",new U.Subject);M(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable());M(this,"_hoverBullet$",new U.Subject);M(this,"hoverBullet$",this._hoverBullet$.pipe(U.distinctUntilChanged((e,n)=>(e==null?void 0:e.paragraph.startIndex)===(n==null?void 0:n.paragraph.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.segmentPageIndex)===(n==null?void 0:n.segmentPageIndex))));M(this,"_clickBullet$",new U.Subject);M(this,"clickBullets$",this._clickBullet$.asObservable());M(this,"_hoverParagraph$",new U.BehaviorSubject(null));M(this,"hoverParagraph$",this._hoverParagraph$.pipe(U.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));M(this,"hoverParagraphRealTime$",this._hoverParagraph$.asObservable());M(this,"_hoverParagraphLeft$",new U.BehaviorSubject(null));M(this,"hoverParagraphLeft$",this._hoverParagraphLeft$.pipe(U.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));M(this,"hoverParagraphLeftRealTime$",this._hoverParagraphLeft$.asObservable());M(this,"_hoverTableCell$",new U.Subject);M(this,"hoverTableCell$",this._hoverTableCell$.pipe(U.distinctUntilChanged((e,n)=>(e==null?void 0:e.rowIndex)===(n==null?void 0:n.rowIndex)&&(e==null?void 0:e.colIndex)===(n==null?void 0:n.colIndex)&&(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));M(this,"hoverTableCellRealTime$",this._hoverTableCell$.asObservable());M(this,"_hoverTable$",new U.Subject);M(this,"hoverTable$",this._hoverTable$.pipe(U.distinctUntilChanged((e,n)=>(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));M(this,"hoverTableRealTime$",this._hoverTable$.asObservable());M(this,"_customRangeDirty",!0);M(this,"_bulletDirty",!0);M(this,"_paragraphDirty",!0);M(this,"_customRangeBounds",[]);M(this,"_bulletBounds",[]);M(this,"_paragraphBounds",new Map);M(this,"_paragraphLeftBounds",[]);M(this,"_tableParagraphBounds",new Map);M(this,"_segmentParagraphBounds",new Map);M(this,"_tableCellBounds",new Map);M(this,"_tableBounds",new Map);this._context=e,this._docSkeletonManagerService=n,this._initResetDirty(),this._initEvents(),this._initPointer()}get hoverParagraph(){return this._hoverParagraph$.value}get hoverParagraphLeft(){return this._hoverParagraphLeft$.value}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=B.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(n=>{n.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(B.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0})),this.disposeWithMe(i.fromEventSubject(this._context.engine.onTransformChange$).pipe(U.filter(e=>e.type===B.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0}))}_initEvents(){this.disposeWithMe(i.fromEventSubject(this._context.scene.onPointerMove$).pipe(U.throttleTime(30)).subscribe(r=>{if(r.buttons>0){this._hoverBullet$.next(null),this._hoverCustomRanges$.next([]),this._hoverParagraph$.next(null),this._hoverParagraphLeft$.next(null),this._hoverTableCell$.next(null),this._hoverTable$.next(null);return}const{x:s,y:a}=_r(r.offsetX,r.offsetY,this._context.scene);this._hoverCustomRanges$.next(this._calcActiveRanges({x:s,y:a})),this._hoverParagraph$.next(this._calcActiveParagraph({x:s,y:a})),this._hoverParagraphLeft$.next(this._calcActiveParagraphLeft({x:s,y:a})),this._hoverBullet$.next(this._calcActiveBullet({x:s,y:a}))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));const e=i.fromEventSubject(this._context.mainComponent.onPointerDown$),n=i.fromEventSubject(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe(U.switchMap(r=>n.pipe(U.take(1),U.map(s=>({down:r,up:s})))),U.filter(({down:r,up:s})=>r.target===s.target&&s.timeStamp-r.timeStamp<300)).subscribe(({down:r})=>{if(r.button===2)return;const s=_r(r.offsetX,r.offsetY,this._context.scene),a=this._calcActiveRanges(s);a.length&&this._clickCustomRanges$.next(a.pop());const c=this._calcActiveBullet(s);c&&this._clickBullet$.next(c)}))}_buildCustomRangeBoundsBySegment(e,n=-1){var a,c,l;const r=(l=(c=(a=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:a.getBody())==null?void 0:c.customRanges)!=null?l:[],s=[];return r.forEach(A=>{const d={startOffset:A.startIndex,endOffset:A.endIndex+1,segmentId:e},u=$c(d,this._documents,this._skeleton,n);if(!u)return null;s.push({customRange:A,rects:u,segmentId:e,segmentPageIndex:n})}),s}_buildCustomRangeBounds(){var n;if(!this._customRangeDirty)return;this._customRangeDirty=!1;const e=[];e.push(...this._buildCustomRangeBoundsBySegment()),(n=this._skeleton.getSkeletonData())==null||n.pages.forEach((r,s)=>{r.headerId&&e.push(...this._buildCustomRangeBoundsBySegment(r.headerId,s)),r.footerId&&e.push(...this._buildCustomRangeBoundsBySegment(r.footerId,s))}),this._customRangeBounds=e}_calcActiveRanges(e){this._buildCustomRangeBounds();const{x:n,y:r}=e;return this._customRangeBounds.filter(a=>a.rects.some(c=>ke(n,r,c))).map(a=>({segmentId:a.segmentId,range:a.customRange,segmentPageIndex:a.segmentPageIndex,rects:a.rects}))}_buildBulletBoundsBySegment(e,n=-1){var A,d,u,m,g;const r=(A=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:A.getBody(),s=((d=r==null?void 0:r.paragraphs)!=null?d:[]).filter(h=>h.bullet&&h.bullet.listType.indexOf("CHECK_LIST")===0),a=[],c=this._skeleton.getSkeletonData();if(!c)return a;const l=h=>{var p,f,S;for(const E of h){const C=[...E.sections];if(E.skeTables){const T=Array.from(E.skeTables.values());C.push(...T.map(R=>R.rows.map(v=>v.cells.map(b=>b.sections))).flat(4))}for(const T of C)for(const R of T.columns)for(const v of R.lines)if(v.paragraphStart){const b=s.find(x=>x.startIndex===v.paragraphIndex);if(b){const x=v,y=(S=(f=(p=x==null?void 0:x.divides)==null?void 0:p[0])==null?void 0:f.glyphGroup)==null?void 0:S[0];if(!y)continue;const _=el(y,this._documents,this._skeleton,n);if(!_)continue;a.push({rect:_,segmentId:e,segmentPageIndex:n,paragraph:b})}}}return a};if(e){const h=(g=(u=c.skeFooters.get(e))==null?void 0:u.values())!=null?g:(m=c.skeHeaders.get(e))==null?void 0:m.values();return h?l(Array.from(h)):a}return l(c.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((n,r)=>{n.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.headerId,r)),n.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.footerId,r))}))}_calcActiveBullet(e){this._buildBulletBounds();const{x:n,y:r}=e;return this._bulletBounds.find(a=>ke(n,r,a.rect))}_buildParagraphBoundsBySegment(e){var c,l,A;const n=this._skeleton.getSkeletonData(),s=this._documents.getOffsetConfig();if(!n)return null;const a=d=>{const u=new Map,m=(g,h,p,f)=>{Nr(g.sections,p,f,g.pageWidth-g.marginLeft-g.marginRight).forEach(E=>{if(!u.has(E.startIndex))u.set(E.startIndex,{rect:E.rect,paragraphStart:E.paragraphStart,paragraphEnd:E.paragraphEnd,startIndex:E.startIndex,rects:[E.rect],pageIndex:h,segmentId:e,firstLine:E.fisrtLine});else{const C=u.get(E.startIndex);C&&(C.rect.bottom=E.rect.bottom,C.rects.push(E.rect))}})};for(let g=0;g<d.length;g++){const h=d[g],p=((h.pageHeight===1/0?0:h.pageHeight)+s.pageMarginTop)*g+h.marginTop+s.docsTop,f=h.marginLeft+s.docsLeft;h.skeTables&&Array.from(h.skeTables.values()).forEach(S=>{const E=S.left+f,C=S.top+p,T=E+S.width,R=C+S.height,v=S.tableId;this._tableBounds.set(v,{rect:{left:E,top:C,right:T,bottom:R},pageIndex:g,tableId:v}),S.rows.forEach((b,x)=>{b.cells.forEach((y,_)=>{const O=((h.pageHeight===1/0?0:h.pageHeight)+s.pageMarginTop)*g+S.top+s.docsTop+h.marginTop+b.top+y.marginTop,w=S.left+s.docsLeft+h.marginLeft+y.left+y.marginLeft,Q=Nr(y.sections,O,w,y.pageWidth-y.marginLeft-y.marginRight);let k=this._tableParagraphBounds.get(v);k||(k=[],this._tableParagraphBounds.set(v,k)),k.push(...Q.map(L=>({rect:L.rect,paragraphStart:L.paragraphStart,paragraphEnd:L.paragraphEnd,startIndex:L.startIndex,pageIndex:g,segmentId:e,rowIndex:x,colIndex:_,firstLine:L.fisrtLine,tableId:v})));let F=this._tableCellBounds.get(v);F||(F=[],this._tableCellBounds.set(v,F)),F.push({rect:{top:O,left:w,right:w+y.pageWidth-y.marginLeft-y.marginRight,bottom:O+y.pageHeight-y.marginBottom-y.marginTop},pageIndex:g,rowIndex:x,colIndex:_,tableId:v})})})}),m(h,g,p,f)}return u};if(e){const d=(A=(c=n.skeFooters.get(e))==null?void 0:c.values())!=null?A:(l=n.skeHeaders.get(e))==null?void 0:l.values();return d?a(Array.from(d)):null}return a(n.pages)}_buildParagraphBounds(){var n,r;if(!this._paragraphDirty)return;this._paragraphDirty=!1,this._tableParagraphBounds=new Map,this._tableCellBounds=new Map,this._tableBounds=new Map,this._paragraphBounds=(n=this._buildParagraphBoundsBySegment())!=null?n:new Map,this._paragraphLeftBounds=Array.from(this._paragraphBounds.values()).map(s=>({...s,rect:{left:s.rect.left-60,right:s.rect.left,top:s.rect.top,bottom:s.rect.bottom}}));const e=s=>{var a;this._segmentParagraphBounds.set(s,(a=this._buildParagraphBoundsBySegment(s))!=null?a:new Map)};(r=this._skeleton.getSkeletonData())==null||r.pages.forEach(s=>{s.headerId&&e(s.headerId),s.footerId&&e(s.footerId)})}_calcActiveParagraph(e){var c,l;this._buildParagraphBounds();const{x:n,y:r}=e,s=Array.from(this._tableBounds.values()).find(A=>ke(n,r,A.rect));if(this._hoverTable$.next(s),s){const A=(c=this._tableCellBounds.get(s.tableId))==null?void 0:c.find(m=>ke(n,r,m.rect));if(this._hoverTableCell$.next(A),!A)return null;const d=(l=this._tableParagraphBounds.get(A.tableId))==null?void 0:l.filter(m=>m.colIndex===A.colIndex&&m.rowIndex===A.rowIndex),u=d==null?void 0:d.find(m=>ke(n,r,m.rect));return u&&{...u,rects:[u.rect]}}let a;for(const A of this._paragraphBounds){const d=A[1];if(d.rects.some(u=>ke(n,r,u))){a=d;break}}return a}_calcActiveParagraphLeft(e){this._buildParagraphBounds();const{x:n,y:r}=e;return this._paragraphLeftBounds.find(a=>ke(n,r,a.rect))}get paragraphBounds(){return this._buildParagraphBounds(),this._paragraphBounds}findParagraphBoundByIndex(e){this._buildParagraphBounds();const n=this._paragraphBounds.get(e);return n||Array.from(this._tableParagraphBounds.values()).flat().find(s=>s.startIndex===e)}};exports.DocEventManagerService=Jc([Zc(1,i.Inject(D.DocSkeletonManagerService))],exports.DocEventManagerService);const tl=[he.id,Pe.id,we.id,Ue.id,Le.id,Re.id,Qe.id,ve.id,Ee.id];function nl(o){const{avaliableMenus:t=tl}=o,e=I.useDependency(I.IMenuManagerService),[n,r]=P.useState([]);return P.useEffect(()=>{function s(){const c=e.getFlatMenuByPositionKey(I.MenuManagerPosition.RIBBON),l=[];for(const A of t){const d=c.find(u=>u.key===A);d&&l.push(d)}r(l)}s();const a=e.menuChanged$.subscribe(s);return()=>{a.unsubscribe()}},[e]),N.jsx("div",{className:q.clsx("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:!univer-border-gray-700 dark:!univer-bg-gray-900",q.borderClassName),children:n.map(s=>s.item&&N.jsx("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:N.jsx(I.ToolbarItem,{...s.item},s.key)},s.key))})}var ol=Object.getOwnPropertyDescriptor,rl=(o,t,e,n)=>{for(var r=n>1?void 0:n?ol(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},lt=(o,t)=>(e,n)=>t(e,n,o);const Pr="univer.doc.float-menu";function il(o,t){if(o==null||t==null)return!1;const{glyph:e,...n}=o,{glyph:r,...s}=t;return i.deepCompare(n,s)}const sl=[i.DataStreamTreeTokenType.CUSTOM_BLOCK,i.DataStreamTreeTokenType.PARAGRAPH];let qt=class extends i.Disposable{constructor(t,e,n,r,s,a){super();M(this,"_floatMenu",null);this._context=t,this._docSelectionManagerService=e,this._docCanvasPopManagerService=n,this._componentManager=r,this._univerInstanceService=s,this._docSelectionRenderService=a,!i.isInternalEditorID(this._context.unitId)&&(this._registerFloatMenu(),this._initSelectionChange(),this.disposeWithMe(()=>{this._hideFloatMenu()}))}get floatMenu(){return this._floatMenu}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register(Pr,nl))}_initSelectionChange(){this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(()=>{this._hideFloatMenu()})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(t=>{var s,a;const{unitId:e,textRanges:n}=t;if(e!==this._context.unitId)return;const r=n.length>0&&n.find(c=>!c.collapsed);if(r){if(r.startOffset===((s=this._floatMenu)==null?void 0:s.start)&&r.endOffset===((a=this._floatMenu)==null?void 0:a.end))return;this._hideFloatMenu(),this._showFloatMenu(e,r);return}this._hideFloatMenu()}))}_hideFloatMenu(){var t;(t=this._floatMenu)==null||t.disposable.dispose(),this._floatMenu=null}_showFloatMenu(t,e){var a,c,l;const n=this._univerInstanceService.getUnit(t,i.UniverInstanceType.UNIVER_DOC);if(!n||n.getDisabled())return;const r=(a=n.getBody())==null?void 0:a.dataStream[e.startOffset];if(e.endOffset-e.startOffset===1&&r&&sl.includes(r))return;const s=(l=(c=n.getBody())==null?void 0:c.customRanges)==null?void 0:l.filter(A=>A.wholeEntity);if(!(s!=null&&s.some(A=>A.startIndex===e.startOffset&&A.endIndex===e.endOffset-1)))return this._floatMenu={disposable:this._docCanvasPopManagerService.attachPopupToRange(e,{componentKey:Pr,direction:e.direction==="backward"||il(e.startNodePosition,e.endNodePosition)?"top-center":"bottom-center",offset:[0,4]},t),start:e.startOffset,end:e.endOffset},i.toDisposable(()=>this._hideFloatMenu())}};qt=rl([lt(1,i.Inject(D.DocSelectionManagerService)),lt(2,i.Inject(exports.DocCanvasPopManagerService)),lt(3,i.Inject(I.ComponentManager)),lt(4,i.Inject(i.IUniverInstanceService)),lt(5,i.Inject(exports.DocSelectionRenderService))],qt);var al=Object.getOwnPropertyDescriptor,cl=(o,t,e,n)=>{for(var r=n>1?void 0:n?al(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},dt=(o,t)=>(e,n)=>t(e,n,o);let Jt=class extends i.Disposable{constructor(t,e,n,r,s,a){super();M(this,"_paragrahMenu",null);this._context=t,this._docSelectionManagerService=e,this._docEventManagerService=n,this._docPopupManagerService=r,this._docSkeletonManagerService=s,this._floatMenuService=a,!i.isInternalEditorID(this._context.unitId)&&this._init()}get activeParagraph(){var t;return(t=this._paragrahMenu)==null?void 0:t.paragraph}_isCursorInActiveParagraph(){if(!this._paragrahMenu)return!1;const t=this._docSelectionManagerService.getActiveTextRange();return!(!(t!=null&&t.collapsed)||!(t!=null&&t.collapsed)||t.startOffset<this._paragrahMenu.paragraph.paragraphStart||t.startOffset>this._paragrahMenu.paragraph.paragraphEnd)}setParagraphMenuActive(t){this._paragrahMenu&&(this._paragrahMenu.active=t,this._isCursorInActiveParagraph()||this._docSelectionManagerService.replaceDocRanges([{startOffset:this._paragrahMenu.paragraph.paragraphStart,endOffset:this._paragrahMenu.paragraph.paragraphStart}]))}_init(){const t=n=>{var s;if(this._docSkeletonManagerService.getViewModel().getEditArea()===B.DocumentEditArea.BODY&&!this._floatMenuService.floatMenu&&!this._context.unit.getDisabled()){if((s=this._paragrahMenu)!=null&&s.active)return;if(n){this.showParagraphMenu(n);return}}this.hideParagraphMenu(!0)};this.disposeWithMe(U.combineLatest([this._docEventManagerService.hoverParagraphRealTime$,this._docEventManagerService.hoverParagraphLeft$]).pipe(U.throttleTime(16)).subscribe(([n,r])=>{const s=n!=null?n:r;t(s)}));let e=0;this.disposeWithMe(this._context.scene.getViewport(ie.VIEW_MAIN).onScrollAfter$.subscribeEvent(n=>{e!==n.scrollY&&(e=n.scrollY,this.hideParagraphMenu(!0))})),this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(()=>{this.hideParagraphMenu(!0)}))}showParagraphMenu(t){var l,A,d;if(((l=this._paragrahMenu)==null?void 0:l.paragraph.startIndex)===t.startIndex)return;this.hideParagraphMenu(!0);const e=(d=(A=this._context.unit.getBody())==null?void 0:A.dataStream)!=null?d:"",n=t?e.slice(t.paragraphStart,t.paragraphEnd):"";if(n==="\b"||n==="")return;const c=this._docPopupManagerService.attachPopupToRect(t.firstLine,{componentKey:"doc.paragraph.menu",direction:"left-center",onClickOutside:()=>{this._docSelectionManagerService.textSelection$.pipe(U.first()).subscribe(()=>{this._isCursorInActiveParagraph()||this.hideParagraphMenu(!0)})},zIndex:101},this._context.unitId);this._paragrahMenu={paragraph:t,disposable:c,active:!1}}hideParagraphMenu(t=!1){this._paragrahMenu&&(this._paragrahMenu.disposable.canDispose()||t)&&(this._paragrahMenu.disposable.dispose(),this._paragrahMenu=null)}};Jt=cl([dt(1,i.Inject(D.DocSelectionManagerService)),dt(2,i.Inject(exports.DocEventManagerService)),dt(3,i.Inject(exports.DocCanvasPopManagerService)),dt(4,i.Inject(D.DocSkeletonManagerService)),dt(5,i.Inject(qt))],Jt);const ll=({popup:o})=>{var v,b;const[t,e]=P.useState(!1),n=P.useRef(null),r=I.useDependency(i.ICommandService),s=I.useDependency(I.ILayoutService),a=P.useRef(null),c=P.useRef(!1),l=I.useDependency(B.IRenderManagerService),A=I.useDependency(i.IUniverInstanceService),d=l.getRenderById(o.unitId),u=A.getUnit(o.unitId,i.UniverInstanceType.UNIVER_DOC),m=d==null?void 0:d.with(Jt),g=d==null?void 0:d.with(exports.DocEventManagerService),h=I.useObservable(g==null?void 0:g.hoverParagraph$),p=I.useObservable(g==null?void 0:g.hoverParagraphLeft$),f=(v=h!=null?h:p)==null?void 0:v.startIndex,S=P.useMemo(()=>{var x,y;return(y=(x=u==null?void 0:u.getBody())==null?void 0:x.paragraphs)==null?void 0:y.find(_=>_.startIndex===f)},[u,h]),E=(b=S==null?void 0:S.paragraphStyle)==null?void 0:b.namedStyleType,C=ts[E!=null?E:i.NamedStyleType.NORMAL_TEXT],T=P.useMemo(()=>new U.BehaviorSubject({left:0,right:0,top:0,bottom:0}),[]),R=()=>{e(!1),m==null||m.hideParagraphMenu(!0)};return N.jsxs(N.Fragment,{children:[N.jsxs("div",{"data-u-comp":"paragraph-menu",ref:a,className:q.clsx("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",q.borderClassName,{"univer-bg-gray-100 dark:!univer-bg-gray-700":t,"univer-bg-white dark:!univer-bg-gray-700":!t}),onMouseEnter:x=>{var _,O,w,Q,k,F;(_=o.onPointerEnter)==null||_.call(o,x),c.current=!0;const y=(O=a.current)==null?void 0:O.getBoundingClientRect();T.next({left:((w=y==null?void 0:y.left)!=null?w:0)-4,right:(Q=y==null?void 0:y.right)!=null?Q:0,top:(k=y==null?void 0:y.top)!=null?k:0,bottom:(F=y==null?void 0:y.bottom)!=null?F:0})},onMouseLeave:()=>{c.current=!1},onClick:()=>{e(!0),m==null||m.setParagraphMenuActive(!0)},children:[N.jsx(C.component,{className:"univer-size-4 univer-text-gray-900 dark:!univer-text-white"}),N.jsx(wi,{className:"univer-size-3 univer-text-gray-600 dark:!univer-text-gray-200"})]}),t&&N.jsx(I.RectPopup,{portal:!0,mask:!0,maskZIndex:100,anchorRect$:T,direction:"left",onMaskClick:R,children:N.jsx("section",{ref:n,onMouseEnter:x=>{var y;(y=o.onPointerEnter)==null||y.call(o,x),c.current=!0},onMouseLeave:()=>{c.current=!1},children:N.jsx(I.DesktopMenu,{style:{width:212},menuType:I.ContextMenuPosition.PARAGRAPH,onOptionSelect:x=>{const{label:y,commandId:_,value:O}=x;r&&r.executeCommand(_!=null?_:y,{value:O}),s.focus(),R()}})})})]})};function $(o){return o.getContextValue(i.FOCUSING_DOC)&&o.getContextValue(i.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(i.FOCUSING_COMMON_DRAWINGS)}function dl(o){return o.getContextValue(i.FOCUSING_DOC)&&o.getContextValue(i.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(i.FOCUSING_COMMON_DRAWINGS)}const Al={id:We.id,binding:I.KeyCode.TAB,preconditions:$},ul={id:We.id,binding:I.KeyCode.TAB|I.MetaKeys.SHIFT,preconditions:$,staticParameters:{shift:!0}},gl={id:Pe.id,binding:I.KeyCode.B|I.MetaKeys.CTRL_COMMAND,preconditions:$},hl={id:we.id,binding:I.KeyCode.I|I.MetaKeys.CTRL_COMMAND,preconditions:$},ml={id:Ue.id,binding:I.KeyCode.U|I.MetaKeys.CTRL_COMMAND,preconditions:$},pl={id:Le.id,binding:I.KeyCode.X|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:$},fl={id:Re.id,binding:I.KeyCode.COMMA|I.MetaKeys.CTRL_COMMAND,preconditions:$},Sl={id:Qe.id,binding:I.KeyCode.PERIOD|I.MetaKeys.CTRL_COMMAND,preconditions:$},Il={id:Mt.id,binding:I.KeyCode.L|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:$},vl={id:Bt.id,binding:I.KeyCode.R|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:$},El={id:Dt.id,binding:I.KeyCode.E|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:$},Cl={id:_t.id,binding:I.KeyCode.J|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:$},Tl={id:ot.id,binding:I.KeyCode.Digit7|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:$},yl={id:nt.id,binding:I.KeyCode.Digit8|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:$},Rn="docs-ui.config",wr={layout:{docContainerConfig:qr,toolbarConfig:Yr}},bl=[50,80,100,130,150,170,200,400],Rl=[10,400];function xl(){const o=I.useDependency(i.ICommandService),t=I.useDependency(i.IUniverInstanceService),e=P.useMemo(()=>t.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_DOC),[]),n=I.useObservable(e),r=P.useCallback(()=>{var A,d;if(!n)return 100;const l=((d=(A=n.getSettings())==null?void 0:A.zoomRatio)!=null?d:1)*100;return Math.round(l)},[n]),[s,a]=P.useState(()=>r());P.useEffect(()=>(a(r()),o.onCommandExecuted(A=>{if(A.id===de.id){const d=r();a(d)}}).dispose),[o,r]);function c(l){if(a(l),n==null)return;const A=l/100;o.executeCommand(de.id,{unitId:n.getUnitId(),zoomRatio:A})}return N.jsx(I.Slider,{min:Rl[0],value:s,shortcuts:bl,onChange:c})}function Ol(o){return N.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:N.jsx(xl,{})})}function Ml(){var r,s,a;const o=I.useDependency(i.IUniverInstanceService),t=I.useConfigValue(Rn),e=I.useObservable(()=>o.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),n=(a=(s=(r=t==null?void 0:t.layout)==null?void 0:r.docContainerConfig)==null?void 0:s.footer)!=null?a:!0;return e?null:n&&N.jsxs("div",{className:"univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5 univer-py-1.5",children:[N.jsx("div",{}),N.jsx(Ol,{})]})}const Dl="univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-cursor-pointer univer-pr-1 ",Bl="univer-text-base univer-font-semibold",_l="univer-text-sm univer-font-semibold",Nl="univer-text-sm",Pl=P.forwardRef((o,t)=>{const{menus:e,onClick:n,className:r,style:s,mode:a,maxHeight:c,activeId:l,open:A,onOpenChange:d,maxWidth:u,wrapperClass:m,wrapperStyle:g,iconClass:h,iconStyle:p}=o,f=a==="side-bar",S=P.useRef(null),E=P.useRef(e);E.current=e;const C=P.useMemo(()=>({scrollTo:T=>{var O;if(!E.current||E.current.findIndex(w=>w.id===T)===-1||!S.current)return;const v=document.getElementById(`univer-side-menu-${T}`);if(!v)return;const b=v.offsetTop,x=S.current.clientHeight,y=S.current.scrollHeight-x,_=Math.max(0,Math.min(b-x/2+v.clientHeight/2,y));(O=S.current)==null||O.scrollTo({behavior:"smooth",top:_})}}),[]);return P.useImperativeHandle(t,()=>C),P.useEffect(()=>{l&&C.scrollTo(l)},[l,C]),N.jsxs("div",{className:q.clsx("univer-relative",m),style:g,children:[N.jsx("div",{onClick:()=>d==null?void 0:d(!A),className:q.clsx("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-h-8 univer-w-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-sm dark:!univer-bg-gray-600 dark:!univer-text-gray-200",h),style:p,children:A?N.jsx(Vi,{}):N.jsx(Bi,{})}),N.jsx("div",{className:q.clsx(r,`
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-px-4 univer-pb-4 univer-pt-14 univer-transition-all univer-duration-300
                    `,{"univer-rounded-r-2xl univer-bg-white univer-shadow univer-backdrop-blur-[10px] dark:!univer-bg-gray-900":f}),style:{...s,transform:A?"translateX(0)":"translateX(-100%)",maxHeight:c,opacity:A?1:0,maxWidth:u!=null?u:a==="side-bar"?320:180,paddingRight:a==="float"?void 0:0},children:N.jsx("div",{ref:S,className:q.clsx("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden",q.scrollbarClassName),children:e==null?void 0:e.map(T=>N.jsx("div",{id:`univer-side-menu-${T.id}`,className:q.clsx(Dl,{[Bl]:T.isTitle,[_l]:T.level===1,[Nl]:T.level>1,"univer-text-gray-500 dark:!univer-text-gray-400":T.id!==l,"univer-text-gray-800 dark:!univer-text-gray-200":T.id===l}),style:{paddingLeft:(T.level-1)*12},onClick:()=>{n==null||n(T)},children:T.text},T.id))})})]})}),wl=o=>{switch(o){case i.NamedStyleType.HEADING_1:return 1;case i.NamedStyleType.HEADING_2:return 2;case i.NamedStyleType.HEADING_3:return 3;case i.NamedStyleType.HEADING_4:return 4;case i.NamedStyleType.HEADING_5:return 5;case i.NamedStyleType.TITLE:return 1;default:return 1}};function Ul(o,t,e,n){var c,l;if(!o)return;const r=Array.from(o.values()),s=r.findIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);if(s===-1)return;const a=r==null?void 0:r.findLastIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);for(let A=s;A<=a;A++){const d=r[A],u=t.get(d.startIndex);if((c=u==null?void 0:u.paragraphStyle)!=null&&c.headingId)return u.paragraphStyle.headingId}for(let A=s;A>=0;A--){const d=r[A],u=t.get(d.startIndex);if((l=u==null?void 0:u.paragraphStyle)!=null&&l.headingId)return u.paragraphStyle.headingId}}const Ur="__title";function Ll(){var t,e,n;const o=I.useConfigValue(Rn);return(n=(e=(t=o==null?void 0:o.layout)==null?void 0:t.docContainerConfig)==null?void 0:e.sideMenu)==null||n?N.jsx(Ql,{}):null}function Ql(){var _,O,w,Q,k,F,L,G,W;const o=I.useDependency(i.ICommandService),t=I.useDependency(i.IUniverInstanceService),e=I.useObservable(P.useMemo(()=>t.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_DOC),[])),n=I.useDependency(B.IRenderManagerService),r=(O=(_=e==null?void 0:e.getBody())==null?void 0:_.dataStream)!=null?O:"",[s,a]=P.useState(0),[c,l]=P.useState(void 0),A=(w=e==null?void 0:e.getUnitId())!=null?w:"",d=n.getRenderById(A),u=e==null?void 0:e.getTitle(),m=d==null?void 0:d.with(exports.DocEventManagerService),g=m==null?void 0:m.paragraphBounds,h=(k=(Q=d==null?void 0:d.mainComponent)==null?void 0:Q.left)!=null?k:0,p=(F=d==null?void 0:d.engine.height)!=null?F:0,f=(L=d==null?void 0:d.scene.scaleY)!=null?L:1,S=(W=(G=e==null?void 0:e.getBody())==null?void 0:G.paragraphs)!=null?W:[],E=P.useMemo(()=>{const H=new Map;return S.forEach(V=>{H.set(V.startIndex,V)}),H},[S]);I.useObservable(P.useMemo(()=>d!=null&&d.engine.onTransformChange$?i.fromEventSubject(d==null?void 0:d.engine.onTransformChange$).pipe(U.throttleTime(33)):U.of(null),[d==null?void 0:d.engine.onTransformChange$]));const C=h<180?"float":"side-bar",T=S==null?void 0:S.filter(H=>{var V;return((V=H.paragraphStyle)==null?void 0:V.namedStyleType)!==void 0&&H.paragraphStyle.namedStyleType!==i.NamedStyleType.SUBTITLE&&H.paragraphStyle.namedStyleType!==i.NamedStyleType.NORMAL_TEXT}).map(H=>{var Y;const V=wl(H.paragraphStyle.namedStyleType),j=g==null?void 0:g.get(H.startIndex);if(!j)return null;const{paragraphStart:X,paragraphEnd:z}=j;return{id:H.paragraphStyle.headingId,text:i.getPlainText(r.slice(X,z)),level:V,isTitle:((Y=H.paragraphStyle)==null?void 0:Y.namedStyleType)===i.NamedStyleType.TITLE}}).filter(H=>H==null?void 0:H.text),R=I.useEvent(H=>{const V=H.viewportScrollY,j=V+p/f,X=Ul(g,E,V,j);X&&l(X)}),v=T!=null&&T.find(H=>H.isTitle)?T:[...u?[{id:Ur,text:u,level:1,isTitle:!0}]:[],...T!=null?T:[]].filter(Boolean),[b,x]=P.useState(!0);P.useEffect(()=>{const H=i.debounce(a,100),V=o.onCommandExecuted(j=>{j.id===D.RichTextEditingMutation.id&&j.params.unitId===(e==null?void 0:e.getUnitId())&&H(z=>z+1)});return()=>{V.dispose()}},[o,e]),P.useEffect(()=>{const H=d==null?void 0:d.scene.getViewport(ie.VIEW_MAIN);if(!H)return;const V=i.fromEventSubject(H.onScrollAfter$).pipe(U.throttleTime(33)).subscribe(R);return()=>{V.unsubscribe()}},[d]);const y=I.useEvent(H=>{const V=d==null?void 0:d.scene.getViewport(ie.VIEW_MAIN);if(!V)return;if(H.id===Ur){V.scrollToViewportPos({viewportScrollY:0});return}const j=S.find(z=>{var Y;return((Y=z.paragraphStyle)==null?void 0:Y.headingId)===H.id});if(!j)return;const X=g==null?void 0:g.get(j.startIndex);X&&(V.scrollToViewportPos({viewportScrollY:X.rect.top}),l(H.id))});return!e||i.isInternalEditorID(A)||!(v!=null&&v.length)?null:N.jsx("div",{className:"univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",children:N.jsx(Pl,{menus:v,open:b,onOpenChange:x,mode:C,maxWidth:C==="float"?void 0:Math.floor(h)-10,wrapperClass:"univer-mt-12",activeId:c,onClick:y,maxHeight:p-48})})}const fe={id:"doc-paragraph-setting.command",type:i.CommandType.COMMAND,handler:async(o,t)=>{var C,T,R,v,b;const e=o.get(D.DocSelectionManagerService),n=o.get(i.IUniverInstanceService),r=o.get(i.ICommandService),s=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),a=e.getDocRanges();if(!s||a.length===0||!t)return!1;const c=a[0].segmentId,l=s.getUnitId(),A=s.getSelfOrHeaderFooterModel(c),d=(T=(C=A.getBody())==null?void 0:C.paragraphs)!=null?T:[],u=(v=(R=A.getBody())==null?void 0:R.dataStream)!=null?v:"",m=(b=i.BuildTextUtils.range.getParagraphsInRanges(a,d,u))!=null?b:[],g={id:D.RichTextEditingMutation.id,params:{unitId:l,actions:[],textRanges:a}},h=new i.MemoryCursor;h.reset();const p=new i.TextX,f=i.JSONX.getInstance();for(const x of m){const{startIndex:y}=x;p.push({t:i.TextXActionType.RETAIN,len:y-h.cursor});const _={...x.paragraphStyle,...t.paragraph};p.push({t:i.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...x,paragraphStyle:_,startIndex:0}]},coverType:i.UpdateDocsAttributeType.REPLACE}),h.moveCursorTo(y+1)}const S=J(s,c);return g.params.actions=f.editOp(p.serialize(),S),!!r.syncExecuteCommand(g.id,g.params)}},Fl=()=>{const o=I.useDependency(D.DocSelectionManagerService),t=I.useDependency(rt),e=P.useMemo(()=>o.getDocRanges(),[]);return P.useEffect(()=>{e.length||t.closePanel()},[e]),e},Hl=()=>{var l,A,d,u,m;const t=I.useDependency(i.IUniverInstanceService).getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC),e=Fl();if(!t||e.length===0)return[];const n=e[0].segmentId,r=t.getSelfOrHeaderFooterModel(n),s=(A=(l=r.getBody())==null?void 0:l.paragraphs)!=null?A:[],a=(u=(d=r.getBody())==null?void 0:d.dataStream)!=null?u:"";return(m=i.BuildTextUtils.range.getParagraphsInRanges(e,s,a))!=null?m:[]},kl=(o,t)=>{const e=I.useDependency(i.ICommandService),[n,r]=P.useState(()=>{var c,l;const a=o[0];return a?String((l=(c=a.paragraphStyle)==null?void 0:c.horizontalAlign)!=null?l:t):t});return[n,a=>(r(a),e.executeCommand(fe.id,{paragraph:{horizontalAlign:Number(a)}}))]},Vl=o=>{const t=I.useDependency(i.ICommandService),[e,n]=P.useState(()=>{var a;const s=o[0];return s?B.getNumberUnitValue((a=s.paragraphStyle)==null?void 0:a.indentStart,0):0});return[e,s=>(n(s),t.executeCommand(fe.id,{paragraph:{indentStart:{v:s}}}))]},jl=o=>{const t=I.useDependency(i.ICommandService),[e,n]=P.useState(()=>{var a;const s=o[0];return s?B.getNumberUnitValue((a=s.paragraphStyle)==null?void 0:a.indentEnd,0):0});return[e,s=>(n(s),t.executeCommand(fe.id,{paragraph:{indentEnd:{v:s}}}))]},Wl=o=>{const t=I.useDependency(i.ICommandService),[e,n]=P.useState(()=>{var a;const s=o[0];return s?B.getNumberUnitValue((a=s.paragraphStyle)==null?void 0:a.indentFirstLine,0):0});return[e,s=>(n(s),t.executeCommand(fe.id,{paragraph:{indentFirstLine:{v:s}}}))]},Gl=o=>{const t=I.useDependency(i.ICommandService),[e,n]=P.useState(()=>{var a;const s=o[0];return s?B.getNumberUnitValue((a=s.paragraphStyle)==null?void 0:a.hanging,0):0});return[e,s=>(n(s),t.executeCommand(fe.id,{paragraph:{hanging:{v:s}}}))]},Xl=o=>{const t=I.useDependency(i.ICommandService),[e,n]=P.useState(()=>{var a;const s=o[0];return s?B.getNumberUnitValue((a=s.paragraphStyle)==null?void 0:a.spaceAbove,0):0});return[e,s=>(n(s),t.executeCommand(fe.id,{paragraph:{spaceAbove:{v:s}}}))]},Kl=o=>{const t=I.useDependency(i.ICommandService),[e,n]=P.useState(()=>{var a;const s=o[0];return s?B.getNumberUnitValue((a=s.paragraphStyle)==null?void 0:a.spaceBelow,0):0});return[e,s=>(n(s),t.executeCommand(fe.id,{paragraph:{spaceBelow:{v:s}}}))]},zl=o=>{const t=I.useDependency(i.ICommandService),e=I.useDependency(B.IRenderManagerService),n=I.useDependency(i.IUniverInstanceService),r=P.useMemo(()=>{var h;const g=n.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if(g)return(h=e.getRenderById(g==null?void 0:g.getUnitId()))==null?void 0:h.with(D.DocSkeletonManagerService).getSkeleton()},[]),s=P.useMemo(()=>new U.BehaviorSubject({}),[]),[a,c]=P.useState(()=>{var h,p;const g=o[0];return g&&(p=(h=g.paragraphStyle)==null?void 0:h.lineSpacing)!=null?p:1}),l=P.useRef(a),[A,d]=P.useState(()=>{var h,p;const g=o[0];return g&&(p=(h=g.paragraphStyle)==null?void 0:h.spacingRule)!=null?p:i.SpacingRule.AUTO}),u=async g=>{c(g),s.next({lineSpacing:g,spacingRule:A})},m=async g=>{if(g!==A){let h=l.current;if(g===i.SpacingRule.AT_LEAST){const p=r==null?void 0:r.findNodeByCharIndex(o[0].startIndex),f=p==null?void 0:p.parent,S=f==null?void 0:f.parent;(S==null?void 0:S.contentHeight)!==void 0&&(h=Math.max(S.contentHeight,h))}else h>5&&(h=2);l.current=a,u(h),d(g),s.next({spacingRule:g})}};return P.useEffect(()=>{const g=s.pipe(ht.filter(h=>!!Object.keys(h).length),ht.bufferTime(16),ht.filter(h=>!!h.length),ht.map(h=>h.reduce((p,f)=>(Object.keys(f).forEach(S=>{p[S]=f[S]}),p),{}))).subscribe(h=>t.executeCommand(fe.id,{paragraph:{...h}}));return()=>g.unsubscribe()},[]),{lineSpacing:[a,u],spacingRule:[A,m]}},Ve=o=>{const{value:t,onChange:e,className:n="",min:r=0,max:s=100,step:a=1}=o,c=P.useRef(null);return N.jsx(q.InputNumber,{step:a,ref:c,min:r,max:s,value:t,onChange:l=>{e(l!=null?l:0).finally(()=>{setTimeout(()=>{var A;(A=c.current)==null||A.focus()},30)})},className:n})};function Yl(){const o=I.useDependency(i.LocaleService),t=P.useMemo(()=>[{label:o.t("toolbar.alignLeft"),value:String(i.HorizontalAlign.LEFT),icon:N.jsx(ji,{})},{label:o.t("toolbar.alignCenter"),value:String(i.HorizontalAlign.CENTER),icon:N.jsx(ki,{})},{label:o.t("toolbar.alignRight"),value:String(i.HorizontalAlign.RIGHT),icon:N.jsx(Wi,{})},{label:o.t("toolbar.alignJustify"),value:String(i.HorizontalAlign.JUSTIFIED),icon:N.jsx(Di,{})}],[]),e=Hl(),[n,r]=kl(e,t[0].value),[s,a]=Vl(e),[c,l]=jl(e),[A,d]=Wl(e),[u,m]=Gl(e),[g,h]=Xl(e),[p,f]=Kl(e),{lineSpacing:[S,E],spacingRule:[C,T]}=zl(e),R=P.useMemo(()=>C===i.SpacingRule.AUTO?{min:1,max:5,step:S<2?.5:1}:{min:1,max:100},[C,S]);return N.jsxs("div",{children:[N.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.alignment")}),N.jsx("div",{className:q.clsx("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1",q.borderClassName),children:t.map(v=>N.jsx(q.Tooltip,{title:v.label,placement:"bottom",children:N.jsx("span",{className:q.clsx("hover:univer-bg-black/60 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1",{"univer-bg-blend-color-dodge/90":n===v.value}),onClick:()=>r(v.value),children:v.icon})},v.value))}),N.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.indentation")}),N.jsxs("div",{children:[N.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[N.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.left"),"(px)"]}),N.jsx(Ve,{className:"univer-mt-4",value:s,onChange:v=>a(v!=null?v:0)})]}),N.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[N.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.right"),"(px)"]}),N.jsx(Ve,{className:"univer-mt-4",value:c,onChange:v=>l(v!=null?v:0)})]}),N.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[N.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.firstLine"),"(px)"]}),N.jsx(Ve,{className:"univer-mt-4",value:A,onChange:v=>d(v!=null?v:0)})]}),N.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[N.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.hanging"),"(px)"]}),N.jsx(Ve,{className:"univer-mt-4",value:u,onChange:v=>m(v!=null?v:0)})]})]}),N.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.spacing")}),N.jsxs("div",{children:[N.jsxs("div",{className:"univer-justify-betweenuniver-item-center univer-flex",children:[N.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.before"),"(px)"]}),N.jsx(Ve,{className:"univer-mt-4",value:g,onChange:v=>h(v!=null?v:0)})]}),N.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[N.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.after"),"(px)"]}),N.jsx(Ve,{className:"univer-mt-4",value:p,onChange:v=>f(v!=null?v:0)})]}),N.jsxs("div",{className:"item-center univer-flex univer-justify-between",children:[N.jsx("div",{className:"univer-mt-3 univer-text-xs",children:o.t("doc.paragraphSetting.lineSpace")}),N.jsxs("div",{className:"univer-mt-4 univer-flex univer-w-[162px] univer-flex-col univer-gap-1.5",children:[N.jsx(q.Select,{value:`${C}`,options:[{label:o.t("doc.paragraphSetting.multiSpace"),value:`${i.SpacingRule.AUTO}`},{label:o.t("doc.paragraphSetting.fixedValue"),value:`${i.SpacingRule.AT_LEAST}`}],onChange:v=>T(Number(v))}),N.jsx(Ve,{...R,value:S,onChange:v=>E(v!=null?v:0)})]})]})]})]})}const ql=(o,t)=>t.length===o.length&&o.some(e=>t.some(n=>n.startOffset===e.startOffset&&n.endOffset===e.endOffset));function Jl(){const o=I.useDependency(i.ICommandService),t=I.useDependency(i.LocaleService),e=I.useObservable(t.currentLocale$),[n,r]=P.useState(""),s=P.useMemo(()=>i.debounce(()=>r(i.generateRandomId(4)),300),[]),a=P.useRef([]);return P.useEffect(()=>{const c=o.onCommandExecuted(l=>{if(D.SetTextSelectionsOperation.id===l.id){const A=l.params.ranges;ql(A,a.current)||r(i.generateRandomId(4)),a.current=A}D.RichTextEditingMutation.id===l.id&&l.params.trigger!==fe.id&&s()});return()=>c.dispose()},[s]),P.useEffect(()=>{r(i.generateRandomId(4))},[e]),P.useEffect(()=>()=>s.cancel(),[s]),N.jsx(Yl,{},n)}var Zl=Object.getOwnPropertyDescriptor,$l=(o,t,e,n)=>{for(var r=n>1?void 0:n?Zl(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Ln=(o,t)=>(e,n)=>t(e,n,o);const Lr="doc_ui_paragraph-setting-panel";let rt=class extends i.Disposable{constructor(t,e,n){super();M(this,"_id");this._commandService=t,this._componentManager=e,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(Lr,Jl))}openPanel(){const t={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:Lr},width:300};this._sidebarService.open(t)}closePanel(){this._sidebarService.close(this._id)}};rt=$l([Ln(0,i.ICommandService),Ln(1,i.Inject(I.ComponentManager)),Ln(2,i.Inject(I.ISidebarService))],rt);const Zo={id:"sidebar.operation.doc-paragraph-setting-panel",type:i.CommandType.OPERATION,handler:o=>(o.get(rt).openPanel(),!0)},$o=o=>{const t=o.get(D.DocSelectionManagerService);return new U.Observable(e=>{const n=t.textSelection$.subscribe(()=>{t.getDocRanges().some(a=>a.collapsed===!1||a.rangeType===i.DOC_RANGE_TYPE.RECT)?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})};function ed(o){if(o.length<2)return!0;const t=o.map(e=>e.tableId);return t.every(e=>e===t[0])}function Qr(o,t,e){var s;const n=t.getRectRanges(),r=t.getActiveTextRange();if(n&&n.length&&ed(n)&&r==null){o.next(!1);return}if(r&&(n==null||n.length===0)){const{segmentId:a,startOffset:c,endOffset:l}=r,A=e.getCurrentUniverDocInstance(),d=(s=A==null?void 0:A.getSelfOrHeaderFooterModel(a).getBody())==null?void 0:s.tables;if(d&&d.length&&d.some(u=>{const{startIndex:m,endIndex:g}=u;return c>m&&c<g||l>m&&l<g})){o.next(!1);return}}o.next(!0)}const Oe=o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(i.IUniverInstanceService);return new U.Observable(n=>{const r=t.textSelection$.subscribe(()=>{Qr(n,t,e)});return Qr(n,t,e),()=>r.unsubscribe()})},td=o=>({id:It.name,commandId:It.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy",disabled$:$o(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}),nd=o=>({id:Zo.id,type:I.MenuItemType.BUTTON,icon:"MenuIcon",title:"doc.menu.paragraphSetting",hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}),od=o=>({id:pn.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.cut",disabled$:$o(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}),rd=o=>({id:fn.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.paste",hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}),id=o=>({id:bt.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.delete",disabled$:$o(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}),rs="doc.menu.table-insert";function sd(o){return{id:rs,type:I.MenuItemType.SUBITEMS,title:"table.insert",icon:"InsertDoubleIcon",hidden$:U.combineLatest(I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC),Oe(o),(t,e)=>t||e)}}function ad(o){return{id:En.id,type:I.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAboveDoubleIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function cd(o){return{id:Cn.id,type:I.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelowDoubleIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function ld(o){return{id:Tn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumnDoubleIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function dd(o){return{id:yn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumnDoubleIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}const is="doc.menu.table-delete";function Ad(o){return{id:is,type:I.MenuItemType.SUBITEMS,title:"table.delete",icon:"ReduceDoubleIcon",hidden$:U.combineLatest(I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC),Oe(o),(t,e)=>t||e)}}function ud(o){return{id:In.id,type:I.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRowDoubleIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function gd(o){return{id:vn.id,type:I.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumnDoubleIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}function hd(o){return{id:at.id,type:I.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridIcon",disabled$:Oe(o),hidden$:I.getMenuHiddenObservable(o,i.UniverInstanceType.UNIVER_DOC)}}const ss={[I.RibbonStartGroup.FORMAT]:{[Pe.id]:{order:0,menuItemFactory:dc},[we.id]:{order:1,menuItemFactory:Ac},[Ue.id]:{order:2,menuItemFactory:uc},[Le.id]:{order:3,menuItemFactory:gc},[Re.id]:{order:4,menuItemFactory:hc},[Qe.id]:{order:5,menuItemFactory:mc},[ce.id]:{order:5.5,menuItemFactory:Sc},[he.id]:{order:6,menuItemFactory:fc},[_e.id]:{order:7,menuItemFactory:pc},[ve.id]:{order:8,menuItemFactory:Ic},[Ee.id]:{order:9,menuItemFactory:Bc,[it.id]:{order:0,menuItemFactory:Dc}}},[I.RibbonStartGroup.LAYOUT]:{[Mt.id]:{order:2,menuItemFactory:yc},[Dt.id]:{order:3,menuItemFactory:bc},[Bt.id]:{order:4,menuItemFactory:Rc},[_t.id]:{order:5,menuItemFactory:xc},[Rt.id]:{order:6,menuItemFactory:Oc},[ot.id]:{order:7,menuItemFactory:Or},[nt.id]:{order:8,menuItemFactory:Mr},[vt.id]:{order:9,menuItemFactory:Dr},[Yo.id]:{order:10,menuItemFactory:vc},[Nt.id]:{order:11,menuItemFactory:Mc},[Jo.id]:{order:12,menuItemFactory:_c}},[I.RibbonInsertGroup.MEDIA]:{[es]:{order:2,menuItemFactory:Cc,[bn.id]:{order:0,menuItemFactory:Tc}}},[I.ContextMenuPosition.MAIN_AREA]:{[I.ContextMenuGroup.FORMAT]:{[It.name]:{order:0,menuItemFactory:td},[pn.id]:{order:1,menuItemFactory:od},[fn.id]:{order:2,menuItemFactory:rd},[bt.id]:{order:3,menuItemFactory:id}},[I.ContextMenuGroup.LAYOUT]:{[Zo.id]:{order:0,menuItemFactory:nd},[rs]:{order:1,menuItemFactory:sd,[En.id]:{order:1,menuItemFactory:ad},[Cn.id]:{order:2,menuItemFactory:cd},[Tn.id]:{order:3,menuItemFactory:ld},[yn.id]:{order:4,menuItemFactory:dd}},[is]:{order:2,menuItemFactory:Ad,[In.id]:{order:1,menuItemFactory:ud},[vn.id]:{order:2,menuItemFactory:gd},[at.id]:{order:3,menuItemFactory:hd}}}},[I.ContextMenuPosition.PARAGRAPH]:{[I.ContextMenuGroup.QUICK]:{[Po.id]:{order:0,menuItemFactory:Pc},[wo.id]:{order:1,menuItemFactory:wc},[Uo.id]:{order:2,menuItemFactory:Uc},[Lo.id]:{order:3,menuItemFactory:Lc},[Qo.id]:{order:4,menuItemFactory:Qc},[Kt.id]:{order:5,menuItemFactory:Fc},[ot.id]:{order:6,menuItemFactory:Or},[nt.id]:{order:7,menuItemFactory:Mr},[vt.id]:{order:8,menuItemFactory:Dr}},[I.ContextMenuGroup.FORMAT]:{[Eo.id]:{order:0,menuItemFactory:Hc},[Co.id]:{order:1,menuItemFactory:kc},[So.id]:{order:2,menuItemFactory:Vc}},[I.ContextMenuGroup.LAYOUT]:{[ns]:{menuItemFactory:Kc,[Bo.id]:{order:0,menuItemFactory:jc},[_o.id]:{order:1,menuItemFactory:Wc},[No.id]:{order:2,menuItemFactory:Gc},[To.id]:{order:3,menuItemFactory:Xc}}}}};var md=Object.getOwnPropertyDescriptor,pd=(o,t,e,n)=>{for(var r=n>1?void 0:n?md(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Se=(o,t)=>(e,n)=>t(e,n,o);exports.DocUIController=class extends i.Disposable{constructor(t,e,n,r,s,a,c,l,A){super(),this._injector=t,this._componentManager=e,this._commandService=n,this._layoutService=r,this._menuManagerService=s,this._uiPartsService=a,this._univerInstanceService=c,this._shortcutService=l,this._configService=A,this._init()}_initCustomComponents(){[[Zi,rc],[Ji,nc],["TodoListDoubleIcon",Gi],["doc.paragraph.menu",ll],["CutIcon",_i],["DeleteIcon",Ni],[Jn,sc],["DocumentSettingIcon",Pi]].forEach(([t,e])=>{this.disposeWithMe(this._componentManager.register(t,e))})}_initUiParts(){this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.FOOTER,()=>I.connectInjector(Ml,this._injector))),this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Ll,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(ss)}_initShortCut(){[gl,hl,ml,pl,fl,Sl,El,Cl,vl,Il,Tl,yl,Al].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[zi,Yo,zo].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(i.UniverInstanceType.UNIVER_DOC,t=>{this._injector.get(B.IRenderManagerService).getRenderById(t).with(exports.DocSelectionRenderService).focus()}))}};exports.DocUIController=pd([Se(0,i.Inject(i.Injector)),Se(1,i.Inject(I.ComponentManager)),Se(2,i.ICommandService),Se(3,I.ILayoutService),Se(4,I.IMenuManagerService),Se(5,I.IUIPartsService),Se(6,i.IUniverInstanceService),Se(7,I.IShortcutService),Se(8,i.IConfigService)],exports.DocUIController);var fd=Object.getOwnPropertyDescriptor,Sd=(o,t,e,n)=>{for(var r=n>1?void 0:n?fd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Qn=(o,t)=>(e,n)=>t(e,n,o);const Fr=1.5;exports.DocBackScrollRenderController=class extends i.RxDisposable{constructor(t,e,n,r){super(),this._context=t,this._textSelectionManagerService=e,this._editorService=n,this._docSkeletonManagerService=r,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe(U.takeUntil(this.dispose$)).subscribe(t=>{if(t==null)return;const{isEditing:e,unitId:n}=t;n!==this._context.unitId||!e||this._context.unitId!==i.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._scrollToSelection()})}scrollToRange(t){const e=this._docSkeletonManagerService.getSkeleton();if(!e)return;const{startOffset:n}=t,r=e.findNodePositionByCharIndex(n);r&&this.scrollToNode(r)}scrollToNode(t){var _;const{unitId:e,scene:n,mainComponent:r}=this._context,s=this._docSkeletonManagerService.getSkeleton();if(r==null||s==null)return;const a=r.getOffsetConfig(),{docsLeft:c,docsTop:l}=a,A=new Te(a,s),{contentBoxPointGroup:d}=A.getRangePointData(t,t),{left:u,top:m,height:g}=St(d),h=u+c,p=m+l,f=n.getViewport(ie.VIEW_MAIN),S=this._editorService.getEditor(e);if(f==null)return;const{left:E,top:C,right:T,bottom:R}=f.getBounding().viewBound;let v=0,b=0;const x=S?(_=S.params.backScrollOffset)!=null?_:0:100;p<C?v=p-C-x:p>R-g&&(v=p-R+g+x),h<E?b=h-E:h>T-Fr&&(b=h-T+Fr);const y=f.transViewportScroll2ScrollValue(b,v);f.scrollByBarDeltaValue(y)}_scrollToSelection(){const t=this._textSelectionManagerService.getActiveTextRange();if(t==null)return;const{collapsed:e,startNodePosition:n}=t;e&&this.scrollToNode(n)}};exports.DocBackScrollRenderController=Sd([Qn(1,i.Inject(D.DocSelectionManagerService)),Qn(2,se),Qn(3,i.Inject(D.DocSkeletonManagerService))],exports.DocBackScrollRenderController);var Id=Object.getOwnPropertyDescriptor,vd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Id(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},ze=(o,t)=>(e,n)=>t(e,n,o);exports.DocRenderController=class extends i.RxDisposable{constructor(t,e,n,r,s,a,c){super(),this._context=t,this._commandService=e,this._docSelectionRenderService=n,this._docSkeletonManagerService=r,this._editorService=s,this._renderManagerService=a,this._univerInstanceService=c,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(t){var a,c;const e=(a=this._renderManagerService.getRenderById(t))==null?void 0:a.with(D.DocSkeletonManagerService),n=e==null?void 0:e.getSkeleton();if(!n||!!n.getViewModel().getDataModel().getSnapshot().disabled)return;n.calculate();const s=this._editorService.getEditor(t);if(this._editorService.isEditor(t)&&!(s!=null&&s.params.scrollBar)){(c=this._context.mainComponent)==null||c.makeDirty();return}this._recalculateSizeBySkeleton(n)}_addNewRender(){const{scene:t,engine:e}=this._context,n=new B.Viewport(ie.VIEW_MAIN,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.attachControl(),t.onMouseWheel$.subscribeEvent((s,a)=>{const c=this._univerInstanceService.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if((c==null?void 0:c.getUnitId())!==this._context.unitId)return;const l=s;if(l.ctrlKey){const A=Math.abs(l.deltaX);let d=A<40?.2:A<80?.4:.2;d*=l.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):l.preventDefault()}else n.onMouseWheel(l,a)}),new B.ScrollBar(n),t.addLayer(new B.Layer(t,[],kt),new B.Layer(t,[],$r)),this._addComponent();const r=()=>t.render();this.disposeWithMe(this._context.activated$.subscribe(s=>{s?e.runRenderLoop(r):e.stopRenderLoop(r)})),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene:t,unit:e,components:n}=this._context,a={pageMarginLeft:20,pageMarginTop:20},c=new B.Documents(le.MAIN,void 0,a);c.zIndex=Hn;const l=new B.DocBackground(le.BACKGROUND,void 0,a);l.zIndex=Hn,this._context.mainComponent=c,n.set(le.MAIN,c),n.set(le.BACKGROUND,l),t.addObjects([c],kt),t.addObjects([l],Zr),this._editorService.getEditor(e.getUnitId())==null&&t.enableLayerCache(kt)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(U.takeUntil(this.dispose$)).subscribe(t=>{this._create(t)})}_create(t){var l;if(!t)return;const{mainComponent:e,components:n}=this._context,r=e,s=n.get(le.BACKGROUND);r.changeSkeleton(t),s.changeSkeleton(t);const{unitId:a}=this._context,c=this._editorService.getEditor(a);if(this._editorService.isEditor(a)&&!(c!=null&&c.params.scrollBar)){(l=this._context.mainComponent)==null||l.makeDirty();return}this._recalculateSizeBySkeleton(t)}_initCommandListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:r}=n;this.reRender(r)}}))}_recalculateSizeBySkeleton(t){var h;const{mainComponent:e,scene:n,unitId:r,components:s}=this._context,a=e,c=s.get(le.BACKGROUND),l=(h=t.getSkeletonData())==null?void 0:h.pages;if(l==null)return;let A=0,d=0;const m=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let p=0,f=l.length;p<f;p++){const S=l[p];let{pageWidth:E,pageHeight:C}=S;if(m===i.DocumentFlavor.MODERN){const T=Ed(S);E=T.pageWidth,C=T.pageHeight}a.pageLayoutType===B.PageLayoutType.VERTICAL?(d+=C,d+=a.pageMarginTop,p===f-1&&(d+=a.pageMarginTop),A=Math.max(A,E)):a.pageLayoutType===B.PageLayoutType.HORIZONTAL&&(A+=E,p!==f-1&&(A+=a.pageMarginLeft),d=Math.max(d,C))}a.resize(A,d),c.resize(A,d);const g=this._editorService.getEditor(r);(!this._editorService.isEditor(r)||g!=null&&g.params.scrollBar)&&n.resize(A,d)}};exports.DocRenderController=vd([ze(1,i.ICommandService),ze(2,i.Inject(exports.DocSelectionRenderService)),ze(3,i.Inject(D.DocSkeletonManagerService)),ze(4,se),ze(5,B.IRenderManagerService),ze(6,i.IUniverInstanceService)],exports.DocRenderController);function Ed(o){let{pageWidth:t,pageHeight:e}=o;const{marginLeft:n,marginRight:r,marginTop:s,marginBottom:a,skeDrawings:c,skeTables:l}=o;t===Number.POSITIVE_INFINITY&&(t=o.width+n+r),e===Number.POSITIVE_INFINITY&&(e=o.height+s+a);for(const A of c.values())t=Math.max(t,A.aLeft+A.width+n+r),e=Math.max(e,A.aTop+A.height+s+a);for(const A of l.values())t=Math.max(t,A.left+A.width+n+r),e=Math.max(e,A.top+A.height+s+a);return{pageWidth:t,pageHeight:e}}var Cd=Object.getOwnPropertyDescriptor,Td=(o,t,e,n)=>{for(var r=n>1?void 0:n?Cd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Fn=(o,t)=>(e,n)=>t(e,n,o);let $n=class{constructor(o,t,e){M(this,"_docContainer");M(this,"getComponent",o=>{if(this._docContainer=o,!o.getContentRef().current)throw new Error("container is not ready")});M(this,"changeLocale",o=>{this._localeService.setLocale(o)});this._localeService=o,this._injector=t,this._configService=e}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(Rn),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(o){if(this._docContainer)return o(this._docContainer)}getDocContainer(){return this._docContainer}};$n=Td([Fn(0,i.Inject(i.LocaleService)),Fn(1,i.Inject(i.Injector)),Fn(2,i.IConfigService)],$n);var yd=Object.getOwnPropertyDescriptor,bd=(o,t,e,n)=>{for(var r=n>1?void 0:n?yd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Rd=(o,t)=>(e,n)=>t(e,n,o);let Zt=class extends i.RxDisposable{constructor(t){super();M(this,"_docContainerController");this._injector=t,this._docContainerController=this._injector.createInstance($n)}};Zt=bd([Rd(0,i.Inject(i.Injector))],Zt);var xd=Object.getOwnPropertyDescriptor,Od=(o,t,e,n)=>{for(var r=n>1?void 0:n?xd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Hr=(o,t)=>(e,n)=>t(e,n,o);let $t=class extends i.Disposable{constructor(o,t){super(),this._docAutoFormatService=o,this._renderManagerService=t,this._initListTabAutoFormat(),this._initSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:We.id,match:o=>{var r;const{selection:t,paragraphs:e,unit:n}=o;if(e.length===1&&t.startOffset===e[0].paragraphStart&&e[0].bullet){const s=(r=n.getBody())==null?void 0:r.paragraphs,a=s==null?void 0:s.filter(c=>{var l;return((l=c.bullet)==null?void 0:l.listId)===e[0].bullet.listId});return(a==null?void 0:a.findIndex(c=>c.startIndex===e[0].startIndex))!==0}else if(e.length>1&&e.some(s=>s.bullet))return!0;return!1},getMutations(o){const t=o.commandParams;return[{id:Xt.id,params:{type:t!=null&&t.shift?pt.decrease:pt.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:We.id,match:o=>{const{selection:t,unit:e}=o,{startNodePosition:n,endNodePosition:r}=t,s=this._renderManagerService.getRenderById(e.getUnitId()),a=s==null?void 0:s.with(D.DocSkeletonManagerService).getSkeleton();return a==null?!1:!!(n&&r&&bi(a,n,r)||n&&!r&&n.path.indexOf("cells")>-1)},getMutations(o){const t=o.commandParams;return[{id:Ko.id,params:{shift:!!(t!=null&&t.shift)}}]},priority:99}))}_initSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:Ct.id,match:o=>{var s;const{selection:t,paragraphs:e,unit:n}=o;if(!t.collapsed||e.length!==1||!t.collapsed)return!1;const r=(s=n.getBody())==null?void 0:s.dataStream.slice(e[0].paragraphStart,t.startOffset-1);return!!(r&&(Object.keys(i.QuickListTypeMap).includes(r)||Object.keys(Bn).includes(r)))},getMutations(o){var s;const{paragraphs:t,unit:e,selection:n}=o,r=(s=e.getBody())==null?void 0:s.dataStream.slice(t[0].paragraphStart,n.startOffset-1);if(r&&Object.keys(i.QuickListTypeMap).includes(r)){const a=i.QuickListTypeMap[r];return[{id:Mo.id,params:{listType:a,paragraph:t[0]}}]}if(r&&Object.keys(Bn).includes(r)){const a=Bn[r];return[{id:Ei.id,params:{value:a}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:$e.id,match:o=>{const{paragraphs:t}=o;return!!(t.length===1&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},getMutations:o=>{const t=o.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:Xt.id,params:{type:pt.decrease}}]:[{id:st.id,params:{listType:o.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:$e.id,match:()=>!0,getMutations(){return[{id:an.id}]},priority:-9999}))}};$t=Od([Hr(0,i.Inject(exports.DocAutoFormatService)),Hr(1,B.IRenderManagerService)],$t);function Md(o){return o.rows[0].cells[0].sections[0].columns[0].lines[0]}function Dd(o){const t=o.rows[o.rows.length-1],e=t.cells[t.cells.length-1];return B.getLastLine(e)}function Bd(o,t){const{ed:e}=o,{skeTables:n}=t;let r=null;for(const s of n.values())if(s.st===e+1){r=s;break}return r}function kr(o){const t=o==null?void 0:o.parent;let e=null,n=null;if(o==null||t==null)return{lineBeforeTable:e,lineAfterTable:n};const{st:r,ed:s}=o,a=t.type===B.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return B.lineIterator(a,c=>{c.st===s+1?n=c:c.ed===r-1&&(e=c)}),{lineBeforeTable:e,lineAfterTable:n}}function as(o){return o.sections[0].columns[0].lines.length===0}function cs(o){var a,c;const t=o.parent,e=t==null?void 0:t.parent,n=e==null?void 0:e.tableId;if(t==null||e==null)return;const r=t.cells.indexOf(o);let s=e.rows[e.rows.indexOf(t)+1];if(s==null&&n.indexOf("#-#")){const[l,A]=n.split("#-#"),d=(c=(a=e.parent)==null?void 0:a.parent)==null?void 0:c.pages,u=`${l}#-#${Number.parseInt(A)+1}`;if(d)for(const m of d){const{skeTables:g}=m;if(g.has(u)){const h=g.get(u);if(h!=null&&h.rows.length){s=h.rows.find(p=>!p.isRepeatRow);break}}}}if(s!=null){const l=s.cells[r];return as(l)?cs(l):l}}function ls(o){var s,a;const t=o.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;let n=e.rows[e.rows.indexOf(t)-1];const r=t.cells.indexOf(o);if((n==null||n.isRepeatRow)&&e.tableId.indexOf("#-#")){const[c,l]=e.tableId.split("#-#"),A=(a=(s=e.parent)==null?void 0:s.parent)==null?void 0:a.pages,d=`${c}#-#${Number.parseInt(l)-1}`;if(A)for(const u of A){const{skeTables:m}=u;if(m.has(d)){const g=m.get(d);if(g!=null&&g.rows.length){n=g.rows[g.rows.length-1];break}}}}if(n!=null){const c=n.cells[r];return as(c)?ls(c):c}}function _d(o,t){const{st:e}=o,{skeTables:n}=t;let r=null;for(const s of n.values())if(s.ed===e-1){r=s;break}return r}function Nd(o){return o.sections[0].columns[0].lines[0]}function Pd(o){const t=B.getLastColumn(o);return t.lines[t.lines.length-1]}var wd=Object.getOwnPropertyDescriptor,Ud=(o,t,e,n)=>{for(var r=n>1?void 0:n?wd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Lt=(o,t)=>(e,n)=>t(e,n,o);let en=class extends i.Disposable{constructor(t,e,n,r){super();M(this,"_onInputSubscription");this._univerInstanceService=t,this._renderManagerService=e,this._textSelectionManagerService=n,this._commandService=r,this._commandExecutedListener()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_commandExecutedListener(){const t=[ye.id,be.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(!t.includes(e.id))return;const n=e.params;switch(e.id){case ye.id:return this._handleMoveCursor(n.direction);case be.id:return this._handleShiftMoveSelection(n.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(t){var C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),r=this._univerInstanceService.getCurrentUniverDocInstance();if(r==null)return;const s=(C=this._renderManagerService.getRenderById(r.getUnitId()))==null?void 0:C.with(D.DocSkeletonManagerService).getSkeleton(),a=this._getDocObject();if(e==null||s==null||a==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,direction:u,segmentId:m,startNodePosition:g,endNodePosition:h,segmentPage:p}=e;if(n.length>1){let v=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;for(const x of n)v=Math.min(v,x.startOffset),b=Math.max(b,x.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:t===i.Direction.LEFT||t===i.Direction.UP?b:v,endOffset:t===i.Direction.LEFT||t===i.Direction.UP?v:b,style:A}],!1);return}const f=d||u===i.RANGE_DIRECTION.FORWARD?c:l;let S=d||u===i.RANGE_DIRECTION.FORWARD?l:c;const E=(T=r.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)!=null?T:Number.POSITIVE_INFINITY;if(t===i.Direction.LEFT||t===i.Direction.RIGHT){const v=s.findNodeByCharIndex(S-1,m,p),b=s.findNodeByCharIndex(S,m,p);S=t===i.Direction.RIGHT?S+b.count:S-((R=v==null?void 0:v.count)!=null?R:0),S=Math.min(E-2,Math.max(0,S)),this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:S,style:A}],!1),this._scrollToFocusNodePosition(r.getUnitId(),S)}else{const v=s.findNodeByCharIndex(S,m,p),b=a.document.getOffsetConfig(),x=d?g:u===i.RANGE_DIRECTION.FORWARD?h:g,y=this._getTopOrBottomPosition(s,v,x,t===i.Direction.DOWN,!0);if(y==null){const O=t===i.Direction.UP?0:E-2;if(O===S)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:O,style:A}],!1);return}const _=new Te(b,s).getRangePointData(y,y).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:_.endOffset,style:A}],!1),this._scrollToFocusNodePosition(r.getUnitId(),_.endOffset)}}_handleMoveCursor(t){var E,C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),r=this._univerInstanceService.getCurrentUniverDocInstance();if(r==null)return!1;const s=(E=this._renderManagerService.getRenderById(r.getUnitId()))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),a=this._getDocObject();if(e==null||s==null||a==null||n==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,segmentId:u,startNodePosition:m,endNodePosition:g,segmentPage:h}=e,p=r.getSelfOrHeaderFooterModel(u).getBody();if(p==null)return;const f=(C=p.dataStream.length)!=null?C:Number.POSITIVE_INFINITY,S=(T=r.getCustomRanges())!=null?T:[];if(t===i.Direction.LEFT||t===i.Direction.RIGHT){let v;if(!e.collapsed||n.length>1){let y=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY;for(const O of n)y=Math.min(y,O.startOffset),_=Math.max(_,O.endOffset);v=t===i.Direction.LEFT?y:_}else{const y=s.findNodeByCharIndex(c-1,u,h),_=s.findNodeByCharIndex(c,u,h),O=s.findNodeByCharIndex(c+1,u,h);t===i.Direction.LEFT?v=Math.max(0,c-((R=y==null?void 0:y.count)!=null?R:1)):v=Math.min(f-2,l+_.count+((O==null?void 0:O.streamType)===i.DataStreamTreeTokenType.SECTION_BREAK?1:0))}const b=[i.DataStreamTreeTokenType.TABLE_START,i.DataStreamTreeTokenType.TABLE_END,i.DataStreamTreeTokenType.TABLE_ROW_START,i.DataStreamTreeTokenType.TABLE_ROW_END,i.DataStreamTreeTokenType.TABLE_CELL_START,i.DataStreamTreeTokenType.TABLE_CELL_END,i.DataStreamTreeTokenType.SECTION_BREAK];if(t===i.Direction.LEFT)for(;b.includes(p.dataStream[v]);)v--;else for(;b.includes(p.dataStream[v]);)v++;S.filter(y=>y.wholeEntity&&y.startIndex<v&&y.endIndex>=v).forEach(y=>{t===i.Direction.LEFT?v=Math.min(y.startIndex,v):v=Math.max(y.endIndex+1,v)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,v),endOffset:Math.max(0,v),style:A}],!1),this._scrollToFocusNodePosition(r.getUnitId(),v)}else{const v=s.findNodeByCharIndex(c,u,h),b=s.findNodeByCharIndex(l,u,h),x=a.document.getOffsetConfig(),y=this._getTopOrBottomPosition(s,t===i.Direction.UP||d?v:b,t===i.Direction.UP||d?m:g,t===i.Direction.DOWN);if(y==null){let O;d?O=t===i.Direction.UP?0:f-2:O=t===i.Direction.UP?c:l,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,O),endOffset:Math.max(0,O),style:A}],!1);return}const _=new Te(x,s).getRangePointData(y,y).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{..._,style:A}],!1),this._scrollToFocusNodePosition(r.getUnitId(),_.endOffset)}}_getTopOrBottomPosition(t,e,n,r,s=!1){if(e==null||n==null)return;const a=this._getGlyphLeftOffsetInLine(e),c=this._getNextOrPrevLine(e,r,s);if(c==null)return;const l=this._matchPositionByLeftOffset(t,c,a,n);if(l!=null)return{...l,isBack:!0}}_getGlyphLeftOffsetInLine(t){const e=t.parent;if(e==null)return Number.NEGATIVE_INFINITY;const n=e.left,{left:r}=t;return n+r}_matchPositionByLeftOffset(t,e,n,r){const s={distance:Number.POSITIVE_INFINITY};for(const c of e.divides){const l=c.left;for(const A of c.glyphGroup){if(A.streamType===i.DataStreamTreeTokenType.SECTION_BREAK)continue;const{left:d}=A,u=l+d,m=Math.abs(n-u);m<s.distance&&(s.glyph=A,s.distance=m)}}if(s.glyph==null)return;const{segmentPage:a}=r;return t.findPositionByGlyph(s.glyph,a)}_getNextOrPrevLine(t,e,n=!1){var p,f,S,E,C,T,R,v,b,x,y,_;const r=t.parent,s=r==null?void 0:r.parent,a=s==null?void 0:s.parent,c=a==null?void 0:a.parent,l=c==null?void 0:c.parent;if(r==null||s==null||a==null||c==null||l==null)return;const A=a.lines.indexOf(s);if(A===-1)return;let d;if(l.type===B.DocumentSkeletonPageType.CELL&&n){const O=Vr(l,e);if(O)return O}if(e===!0){d=a.lines[A+1];const O=Bd(s,l);if(O){const w=Md(O);w&&(d=w)}}else{d=a.lines[A-1];const O=_d(s,l);if(O){const w=Dd(O);w&&(d=w)}}if(d!=null)return d;const u=c.columns.indexOf(a);if(u===-1)return;if(e===!0)d=(p=c.columns[u+1])==null?void 0:p.lines[0];else{const O=(S=(f=c.columns)==null?void 0:f[u-1])==null?void 0:S.lines;d=O==null?void 0:O[O.length-1]}if(d!=null)return d;const m=l.sections.indexOf(c);if(m===-1)return;if(e===!0)d=(C=(E=l.sections[m-1])==null?void 0:E.columns[0])==null?void 0:C.lines[0];else{const O=(R=(T=l.sections)==null?void 0:T[m-1])==null?void 0:R.columns,w=O==null?void 0:O[O.length-1],Q=w==null?void 0:w.lines;d=Q==null?void 0:Q[Q.length-1]}if(d!=null)return d;if(l.type===B.DocumentSkeletonPageType.CELL)return Vr(l,e);const g=l.parent;if(g==null)return;const h=g.pages.indexOf(l);if(h!==-1){if(e===!0)d=(x=(b=(v=g.pages[h+1])==null?void 0:v.sections[0])==null?void 0:b.columns[0])==null?void 0:x.lines[0];else{const O=(y=g.pages[h-1])==null?void 0:y.sections;if(O==null)return;const w=(_=O[O.length-1])==null?void 0:_.columns,Q=w[w.length-1],k=Q==null?void 0:Q.lines;d=k[k.length-1]}if(d!=null)return d}}_scrollToFocusNodePosition(t,e){var r;const n=(r=this._renderManagerService.getRenderById(t))==null?void 0:r.with(exports.DocBackScrollRenderController);n!=null&&n.scrollToRange({startOffset:e,endOffset:e,collapsed:!0})}_getDocObject(){return ei(this._univerInstanceService,this._renderManagerService)}};en=Ud([Lt(0,i.IUniverInstanceService),Lt(1,B.IRenderManagerService),Lt(2,i.Inject(D.DocSelectionManagerService)),Lt(3,i.ICommandService)],en);function Vr(o,t){var n,r;let e=null;if(t===!0){const s=cs(o);if(s)e=Nd(s);else{const a=(n=o.parent)==null?void 0:n.parent,{lineAfterTable:c}=kr(a);c&&(e=c)}}else{const s=ls(o);if(s)e=Pd(s);else{const a=(r=o.parent)==null?void 0:r.parent,{lineBeforeTable:c}=kr(a);c&&(e=c)}}return e}const Ld=({handleRowColChange:o,tableCreateParams:t})=>{const e=I.useDependency(i.LocaleService),[n,r]=P.useState(3),[s,a]=P.useState(5);function c(l,A){r(l),a(A),o(l,A)}return P.useEffect(()=>{r(t.rowCount),a(t.colCount)},[t]),N.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2",children:[N.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[N.jsx("span",{children:e.t("toolbar.table.rowCount")}),N.jsx(q.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:n,onChange:l=>{c(l,s)}})]}),N.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[N.jsx("span",{children:e.t("toolbar.table.colCount")}),N.jsx(q.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:s,onChange:l=>{c(n,l)}})]})]})};var Qd=Object.getOwnPropertyDescriptor,Fd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Qd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},jr=(o,t)=>(e,n)=>t(e,n,o);let tn=class extends i.Disposable{constructor(o,t){super(),this._commandService=o,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[bn].forEach(o=>this.disposeWithMe(this._commandService.registerCommand(o)))}_initCustomComponents(){const o=this._componentManager;this.disposeWithMe(o.register(Oi,Ld))}_init(){}};tn=Fd([jr(0,i.ICommandService),jr(1,i.Inject(I.ComponentManager))],tn);var Hd=Object.getOwnPropertyDescriptor,kd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Hd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Qt=(o,t)=>(e,n)=>t(e,n,o);let eo=class extends i.Disposable{constructor(o,t,e,n,r){super(),this._context=o,this._docSkeletonManagerService=t,this._commandService=e,this._docEventManagerService=n,this._textSelectionManagerService=r,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(o=>{const t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(Oo.id,{index:o.paragraph.startIndex,segmentId:o.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(o=>{o?this._context.mainComponent.setCursor(B.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(B.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(o,t,e,n){const{documentTransform:r}=o.getOffsetConfig(),s=t.transformVector2SceneCoord(B.Vector2.FromArray([e,n]));if(s)return r.clone().invert().applyPoint(s)}};eo=kd([Qt(1,i.Inject(D.DocSkeletonManagerService)),Qt(2,i.ICommandService),Qt(3,i.Inject(exports.DocEventManagerService)),Qt(4,i.Inject(D.DocSelectionManagerService))],eo);var Vd=Object.getOwnPropertyDescriptor,jd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Vd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},At=(o,t)=>(e,n)=>t(e,n,o);let nn=class extends i.RxDisposable{constructor(o,t,e,n,r,s){super(),this._context=o,this._commandService=t,this._docClipboardService=e,this._docSelectionRenderService=n,this._contextService=r,this._editorService=s,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var o;(o=this._docSelectionRenderService)==null||o.onPaste$.pipe(U.takeUntil(this.dispose$)).subscribe(t=>{var c,l,A;if(!mn(this._contextService))return;t.event.preventDefault();const e=t.event;let n=(c=e.clipboardData)==null?void 0:c.getData(I.HTML_CLIPBOARD_MIME_TYPE);const r=(l=e.clipboardData)==null?void 0:l.getData(I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE),s=[...((A=e.clipboardData)==null?void 0:A.items)||[]].filter(d=>I.imageMimeTypeSet.has(d.type)).map(d=>d.getAsFile()).filter(d=>!!d);this._editorService.getEditor(this._context.unitId)&&(n!=null?n:"").indexOf("</table>")>-1&&(n=""),this._docClipboardService.legacyPaste({html:n,text:r,files:s})})}};nn=jd([At(1,i.ICommandService),At(2,Ne),At(3,i.Inject(exports.DocSelectionRenderService)),At(4,i.IContextService),At(5,se)],nn);var Wd=Object.getOwnPropertyDescriptor,Gd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Wd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Wr=(o,t)=>(e,n)=>t(e,n,o);const Xd=[i.DEFAULT_EMPTY_DOCUMENT_VALUE,i.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,i.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,i.DOCS_ZEN_EDITOR_UNIT_ID_KEY];let to=class extends i.Disposable{constructor(o,t,e){super(),this._context=o,this._contextMenuService=t,this._commandService=e,Xd.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,n;const t=((n=(e=this._context)==null?void 0:e.mainComponent)==null?void 0:n.onPointerDown$).subscribeEvent(r=>{r.button===2&&this._contextMenuService.triggerContextMenu(r,I.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(t)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(o=>{o.id===D.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}};to=Gd([Wr(1,I.IContextMenuService),Wr(2,i.ICommandService)],to);var Kd=Object.getOwnPropertyDescriptor,zd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Kd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Ye=(o,t)=>(e,n)=>t(e,n,o);let on=class extends i.Disposable{constructor(t,e,n,r,s,a,c){super();M(this,"_initialEditors",new Set);this._context=t,this._univerInstanceService=e,this._editorService=n,this._commandService=r,this._docSelectionRenderService=s,this._docSkeletonManagerService=a,this._renderManagerService=c,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach(t=>{const e=t.getEditorId();e===this._context.unitId&&(this._initialEditors.has(e)||(this._initialEditors.add(e),this._resize(e)))}),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(t){if(t==null)return;const e=this._editorService.getEditor(t);if((e==null?void 0:e.cancelDefaultResizeListener)===!0)return;const n=this._univerInstanceService.getUniverDocInstance(t);if(!n)return;const r=this._docSkeletonManagerService.getSkeleton();if(e==null||e.render==null||r==null||n==null)return;r.calculate();const{marginTop:s=0,marginBottom:a=0,marginLeft:c=0,marginRight:l=0}=n.getSnapshot().documentStyle,{scene:A,mainComponent:d}=e.render;let{actualHeight:u,actualWidth:m}=r.getActualSize();u+=s+a,m+=c+l;const{width:g,height:h}=e.getBoundingClientRect(),p=Math.max(m,g),f=Math.max(u,h);A.transformByState({width:p,height:f}),d==null||d.resize(p,f)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{const{unitId:t}=this._context,e=this._editorService.getEditor(t),n=this._editorService.getFocusEditor();e==null||e.isSheetEditor()||n&&n.getEditorId()===t||t.includes("range_selector")||t.includes("embedding_formula_editor")||this._editorService.blur()}))}_initialFocus(){const t=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe(U.fromEvent(window,"mousedown").subscribe(n=>{const s=n.target.classList[0]||"";i.checkForSubstrings(s,t)&&n.stopPropagation()}));const e=new i.DisposableCollection;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(i.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{if(e.dispose(),!n)return;const r=n.getUnitId(),s=this._renderManagerService.getRenderById(r),a=s==null?void 0:s.engine.getCanvas().getCanvasEle();if(a==null)return;const c=U.fromEvent(a,"mousedown").subscribe(l=>{l.stopPropagation()});e.add(c)})),this.disposeWithMe(()=>e.dispose())}_commandExecutedListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:r}=n;if(this._editorService.isSheetEditor(r)||r!==this._context.unitId)return;const s=this._editorService.getEditor(r);s&&!s.params.scrollBar&&this._resize(r)}}))}};on=zd([Ye(1,i.IUniverInstanceService),Ye(2,se),Ye(3,i.ICommandService),Ye(4,i.Inject(exports.DocSelectionRenderService)),Ye(5,i.Inject(D.DocSkeletonManagerService)),Ye(6,B.IRenderManagerService)],on);var Yd=Object.getOwnPropertyDescriptor,qd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Yd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Ft=(o,t)=>(e,n)=>t(e,n,o);let no=class extends i.Disposable{constructor(t,e,n,r,s){super();M(this,"_previousIMEContent","");M(this,"_isCompositionStart",!0);M(this,"_onStartSubscription");M(this,"_onUpdateSubscription");M(this,"_onEndSubscription");this._context=t,this._docSelectionRenderService=e,this._docImeInputManagerService=n,this._docSkeletonManagerService=r,this._commandService=s,this._initialize()}dispose(){var t,e,n;(t=this._onStartSubscription)==null||t.unsubscribe(),(e=this._onUpdateSubscription)==null||e.unsubscribe(),(n=this._onEndSubscription)==null||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(t=>{if(t==null)return;this._resetIME();const{activeRange:e}=t;e!=null&&this._docImeInputManagerService.setActiveRange(i.Tools.deepClone(e))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(t=>{this._updateContent(t,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(t=>{this._updateContent(t,!1)})}async _updateContent(t,e){if(t==null)return;const n=this._context.unitId,r=this._docSkeletonManagerService.getSkeleton(),{event:s,activeRange:a}=t;if(r==null||a==null)return;const l=s.data;l===this._previousIMEContent&&e||(await this._commandService.executeCommand(bo.id,{unitId:n,newText:l,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!e}),e?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=l):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}};no=qd([Ft(1,i.Inject(exports.DocSelectionRenderService)),Ft(2,i.Inject(xt)),Ft(3,i.Inject(D.DocSkeletonManagerService)),Ft(4,i.ICommandService)],no);var Jd=Object.getOwnPropertyDescriptor,Zd=(o,t,e,n)=>{for(var r=n>1?void 0:n?Jd(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Ht=(o,t)=>(e,n)=>t(e,n,o);let oo=class extends i.Disposable{constructor(t,e,n,r,s){super();M(this,"_onInputSubscription");this._context=t,this._docSelectionRenderService=e,this._docSkeletonManagerService=n,this._commandService=r,this._docMenuStyleService=s,this._init()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async t=>{var f,S;if(t==null)return;const{unitId:e}=this._context,{event:n,content:r="",activeRange:s}=t,a=n,c=this._docSkeletonManagerService.getSkeleton();if(a.data==null||c==null||s==null)return;const{segmentId:l}=s,d=this._context.unit.getSelfOrHeaderFooterModel(l).getBody(),u=this._docMenuStyleService.getDefaultStyle(),m=this._docMenuStyleService.getStyleCache(),g=co((f=d==null?void 0:d.customRanges)!=null?f:[],s.endOffset,i.SHEET_EDITOR_UNITS.includes(e)),h=sn(d,s.endOffset,u,m,i.SHEET_EDITOR_UNITS.includes(e)),p=lo((S=d==null?void 0:d.customDecorations)!=null?S:[],s.endOffset);await this._commandService.executeCommand(mo.id,{unitId:e,body:{dataStream:r,textRuns:h?[{...h,st:0,ed:r.length}]:[],customRanges:g?[{...g,startIndex:0,endIndex:r.length-1}]:[],customDecorations:p.map(E=>({...E,startIndex:0,endIndex:r.length-1}))},range:s,segmentId:l}),r===" "&&await this._commandService.executeCommand(Ct.id)})}};oo=Zd([Ht(1,i.Inject(exports.DocSelectionRenderService)),Ht(2,i.Inject(D.DocSkeletonManagerService)),Ht(3,i.ICommandService),Ht(4,i.Inject(Ce))],oo);class er extends i.Disposable{constructor(t){super(),this._context=t}calculatePagePosition(){var T,R;const t=Ie(this._context),n=(R=(T=this._context.unit.getSettings())==null?void 0:T.zoomRatio)!=null?R:1,{document:r,scene:s,docBackground:a}=t,c=s==null?void 0:s.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:u}=r;if(c==null||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;const{width:m,height:g}=c;let h=0,p=u,f=0,S=0,E=Number.POSITIVE_INFINITY;m>(l+d*2)*n?(h=m/2-l*n/2,h/=n,f=(m-d*2)/n,E=0):(h=d,f=l+d*2,E=(f-m/n)/2),g>A?S=(g-u*2)/n:S=A+u*2,s.resize(f,S),m<=1&&(h=-1e4,p=-1e4),r.translate(h,p),a.translate(h,p);const C=s.getViewport(ie.VIEW_MAIN);return E!==Number.POSITIVE_INFINITY&&C!=null&&C.scrollToViewportPos({viewportScrollX:E}),this}}var $d=Object.getOwnPropertyDescriptor,eA=(o,t,e,n)=>{for(var r=n>1?void 0:n?$d(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Gr=(o,t)=>(e,n)=>t(e,n,o);let ro=class extends i.Disposable{constructor(o,t,e){super(),this._context=o,this._docPageLayoutService=t,this._textSelectionManagerService=e;const n=this._context.unitId;if(i.isInternalEditorID(n)&&n!==i.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe(i.fromEventSubject(this._context.engine.onTransformChange$).pipe(U.filter(o=>o.type===B.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),U.throttleTime(0,U.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}};ro=eA([Gr(1,i.Inject(er)),Gr(2,i.Inject(D.DocSelectionManagerService))],ro);var tA=Object.getOwnPropertyDescriptor,nA=(o,t,e,n)=>{for(var r=n>1?void 0:n?tA(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},qe=(o,t)=>(e,n)=>t(e,n,o);let io=class extends i.Disposable{constructor(t,e,n,r,s,a,c){super();M(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=r,this._docSelectionRenderService=s,this._docSkeletonManagerService=a,this._docSelectionManagerService=c,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(t=>{if(t==null)return;const{unitId:e,docRanges:n,isEditing:r,options:s}=t;e===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,r,s))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(t=>{t!=null&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(t,{unitId:this._context.unitId,subUnitId:this._context.unitId})}))}_initialMain(t){const e=Ie(this._context),{document:n,scene:r}=e;this.disposeWithMe(n.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(t)||(n.cursor=B.CURSOR_TYPE.TEXT)})),this.disposeWithMe(n.onPointerLeave$.subscribeEvent(()=>{n.cursor=B.CURSOR_TYPE.DEFAULT,r.resetCursor()})),this.disposeWithMe(n.onPointerDown$.subscribeEvent((s,a)=>{if(this._isEditorReadOnly(t))return;const c=this._instanceSrv.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);(c==null?void 0:c.getUnitId())!==t&&this._instanceSrv.setCurrentUnitForType(t);const l=this._docSkeletonManagerService.getSkeleton(),{offsetX:A,offsetY:d}=s,u=this._getTransformCoordForDocumentOffset(A,d);if(u!=null){const{pageLayoutType:m=B.PageLayoutType.VERTICAL,pageMarginLeft:g,pageMarginTop:h}=n.getOffsetConfig(),{editArea:p}=l.findEditAreaByCoord(u,m,g,h),f=this._docSkeletonManagerService.getViewModel(),S=f.getEditArea();S!==B.DocumentEditArea.BODY&&p!==B.DocumentEditArea.BODY&&p!==S&&f.setEditArea(p)}if(this._docSelectionRenderService.__onPointDown(s),this._editorService.getEditor(t)){this._setEditorFocus(t);const{offsetX:m,offsetY:g}=s;setTimeout(()=>{t===this._editorService.getFocusId()||this._docSelectionRenderService.isOnPointerEvent||(this._setEditorFocus(t),this._docSelectionRenderService.setCursorManually(m,g))},0)}s.button!==2&&a.stopPropagation()})),this.disposeWithMe(n.onDblclick$.subscribeEvent(s=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleDblClick(s)})),this.disposeWithMe(n.onTripleClick$.subscribeEvent(s=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleTripleClick(s)}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:r,scene:s}=n,{documentTransform:a}=r.getOffsetConfig(),c=s.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(B.Vector2.FromArray([t,e]));return a.clone().invert().applyPoint(l)}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_setEditorFocus(t){this._editorService.focus(t)}_commandExecutedListener(){const t=[de.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var n;if(t.includes(e.id)){const r=e.params,{unitId:s}=r,a=(n=this._docSelectionManagerService.__getCurrentSelection())==null?void 0:n.unitId;if(s!==a)return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(!t)return;const{unitId:e}=this._context;if(!i.isInternalEditorID(e)){this._docSelectionRenderService.focus();const s=this._context.unit.getSnapshot(),a=Xi(s);this._docSelectionManagerService.replaceDocRanges([{startOffset:a,endOffset:a}],{unitId:e,subUnitId:e},!1)}}))}};io=nA([qe(1,i.ICommandService),qe(2,se),qe(3,i.IUniverInstanceService),qe(4,i.Inject(exports.DocSelectionRenderService)),qe(5,i.Inject(D.DocSkeletonManagerService)),qe(6,i.Inject(D.DocSelectionManagerService))],io);var oA=Object.getOwnPropertyDescriptor,rA=(o,t,e,n)=>{for(var r=n>1?void 0:n?oA(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Be=(o,t)=>(e,n)=>t(e,n,o);let so=class extends i.Disposable{constructor(t,e,n,r,s,a,c,l,A){super();M(this,"_isSheetEditor",!1);this._context=t,this._contextService=e,this._docSkeletonManagerService=n,this._univerInstanceService=r,this._commandService=s,this._textSelectionManagerService=a,this._editorService=c,this._docPageLayoutService=l,this._renderManagerService=A,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),this._isSheetEditor=this._context.unitId===i.DOCS_NORMAL_EDITOR_UNIT_ID_KEY;const d=this._univerInstanceService.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_SHEET),u=d&&this._renderManagerService.getRenderById(d.getUnitId());setTimeout(()=>this.updateViewZoom(u&&this._isSheetEditor?u.scene.scaleX:1,!0),20),i.isInternalEditorID(this._context.unitId)||this._initZoomEventListener()}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const{unitId:e,scene:n}=this._context;this._editorService.isEditor(e)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(r=>{if(!r.ctrlKey||!this._contextService.getContextValue(i.FOCUSING_DOC))return;const s=this._univerInstanceService.getCurrentUniverDocInstance();if(!s)return;const{documentFlavor:a}=s.getSnapshot().documentStyle;if(a===i.DocumentFlavor.MODERN)return;const c=Math.abs(r.deltaX);let l=c<40?.2:c<80?.4:.2;l*=r.deltaY>0?-1:1,n.scaleX<1&&(l/=2);const A=s.zoomRatio;let d=+Number.parseFloat(`${A+l}`).toFixed(1);d=d>=4?4:d<=.1?.1:d,this._commandService.executeCommand(ft.id,{zoomRatio:d,unitId:s.getUnitId()}),r.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const e=this._univerInstanceService.getCurrentUniverDocInstance();e&&setTimeout(()=>{const n=this._univerInstanceService.getCurrentUnitOfType(i.UniverInstanceType.UNIVER_SHEET),r=n&&this._renderManagerService.getRenderById(n.getUnitId()),s=this._isSheetEditor?(r==null?void 0:r.scene.scaleX)||1:e.zoomRatio;this.updateViewZoom(s,!1)})}))}_initCommandExecutedListener(){const t=[de.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)&&e.params.unitId===this._context.unitId){const r=this._context.unit.zoomRatio||1;this.updateViewZoom(r)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{e.id===Nt.id&&this._commandService.executeCommand(ft.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(t,e=!0){var r;const n=Ie(this._context);n.scene.scale(t,t),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),e&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),(r=n.scene.getTransformer())==null||r.clearSelectedObjects()}_initZoomEventListener(){const t=this._context.scene;this.disposeWithMe(t.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey)return;const n=Math.abs(e.deltaX);let r=n<40?.2:n<80?.4:.2;r*=e.deltaY>0?-1:1,t.scaleX<1&&(r/=2);const s=this._context.unit.zoomRatio;let a=+Number.parseFloat(`${s+r}`).toFixed(1);a=a>=4?4:a<=.1?.1:a,this._commandService.executeCommand(ft.id,{zoomRatio:Math.round(a*10)/10,documentId:this._context.unitId}),e.preventDefault()}))}};so=rA([Be(1,i.IContextService),Be(2,i.Inject(D.DocSkeletonManagerService)),Be(3,i.IUniverInstanceService),Be(4,i.ICommandService),Be(5,i.Inject(D.DocSelectionManagerService)),Be(6,se),Be(7,i.Inject(er)),Be(8,B.IRenderManagerService)],so);const iA=i.createInterceptorKey("PRINTING_COMPONENT_COLLECT"),sA=i.createInterceptorKey("PRINTING_DOM_COLLECT");class ds extends i.Disposable{constructor(){super();M(this,"_printComponentMap",new Map);M(this,"interceptor",new i.InterceptorManager({PRINTING_COMPONENT_COLLECT:iA,PRINTING_DOM_COLLECT:sA}));this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:e=>e}))}registerPrintComponent(e,n){this._printComponentMap.set(e,n)}getPrintComponent(e){return this._printComponentMap.get(e)}}var aA=Object.getOwnPropertyDescriptor,cA=(o,t,e,n)=>{for(var r=n>1?void 0:n?aA(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},ut=(o,t)=>(e,n)=>t(e,n,o);const Xr=300;exports.DocStateChangeManagerService=class extends i.RxDisposable{constructor(e,n,r,s,a){super();M(this,"_docStateChange$",new U.BehaviorSubject(null));M(this,"docStateChange$",this._docStateChange$.asObservable());M(this,"_historyStateCache",new Map);M(this,"_changeStateCache",new Map);M(this,"_historyTimer",null);M(this,"_changeStateCacheTimer",null);this._undoRedoService=e,this._commandService=n,this._univerInstanceService=r,this._docStateEmitService=s,this._renderManagerService=a,this._initialize(),this._listenDocStateChange()}getStateCache(e){var n,r;return{history:(n=this._historyStateCache.get(e))!=null?n:[],collaboration:(r=this._changeStateCache.get(e))!=null?r:[]}}setStateCache(e,n){this._historyStateCache.set(e,n.history),this._changeStateCache.set(e,n.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===i.UndoCommandId||e.id===i.RedoCommandId){const n=this._univerInstanceService.getCurrentUniverDocInstance();if(n==null)return;const r=n.getUnitId();this._pushHistory(r),this._emitChangeState(r)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe(U.takeUntil(this.dispose$)).subscribe(e=>{var l;if(e==null)return;const{isCompositionEnd:n,isSync:r,syncer:s,...a}=e,c=(l=this._renderManagerService.getRenderById(r?s:e.unitId))==null?void 0:l.with(xt);if(c!=null){if(n){const A=c.fetchComposedUndoRedoMutationParams();if(A==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:d,redoMutationParams:u,previousActiveRange:m}=A;a.redoState.actions=u.actions,a.undoState.actions=d.actions,a.undoState.textRanges=[m]}this._setChangeState(a)}})}_cacheChangeState(e,n="history"){const{trigger:r,unitId:s,noHistory:a,debounce:c=!1}=e;if(a||r==null||n==="history"&&(r===i.RedoCommandId||r===i.UndoCommandId))return;const l=n==="history"?this._historyStateCache:this._changeStateCache,A=n==="history"?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(l.has(s)){const d=l.get(s);d==null||d.push(e)}else l.set(s,[e]);c?n==="history"?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{A(s)},Xr)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{A(s)},Xr)):A(s)}_pushHistory(e){const n=this._undoRedoService,r=this._historyStateCache.get(e);if(!Array.isArray(r)||r.length===0)return;const s=r.length,a=r[0].commandId,c=r[0],l=r[s-1],A={unitId:e,actions:r.reduce((u,m)=>i.JSONX.compose(u,m.redoState.actions),null),textRanges:l.redoState.textRanges},d={unitId:e,actions:r.reverse().reduce((u,m)=>i.JSONX.compose(u,m.undoState.actions),null),textRanges:c.undoState.textRanges};n.pushUndoRedo({unitID:e,undoMutations:[{id:a,params:d}],redoMutations:[{id:a,params:A}]}),r.length=0}_emitChangeState(e){const n=this._changeStateCache.get(e);if(!Array.isArray(n)||n.length===0)return;const r=n.length,{commandId:s,trigger:a,segmentId:c,noHistory:l,debounce:A}=n[0],d=n[0],u=n[r-1],m={unitId:e,actions:n.reduce((p,f)=>i.JSONX.compose(p,f.redoState.actions),null),textRanges:u.redoState.textRanges},g={unitId:e,actions:n.reverse().reduce((p,f)=>i.JSONX.compose(p,f.undoState.actions),null),textRanges:d.undoState.textRanges},h={commandId:s,unitId:e,trigger:a,redoState:m,undoState:g,segmentId:c,noHistory:l,debounce:A};n.length=0,this._docStateChange$.next(h)}};exports.DocStateChangeManagerService=cA([ut(0,i.Inject(i.IUndoRedoService)),ut(1,i.ICommandService),ut(2,i.IUniverInstanceService),ut(3,i.Inject(D.DocStateEmitService)),ut(4,B.IRenderManagerService)],exports.DocStateChangeManagerService);var lA=Object.getOwnPropertyDescriptor,dA=(o,t,e,n)=>{for(var r=n>1?void 0:n?lA(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},Kr=(o,t)=>(e,n)=>t(e,n,o);const zr="univer-doc-main-canvas";exports.DocsRenderService=class extends i.RxDisposable{constructor(t,e){super(),this._instanceSrv=t,this._renderManagerService=e,this._init()}_init(){this._renderManagerService.createRender$.pipe(U.takeUntil(this.dispose$)).subscribe(t=>this._createRenderWithId(t)),this._instanceSrv.getAllUnitsForType(i.UniverInstanceType.UNIVER_DOC).forEach(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitAdded$(i.UniverInstanceType.UNIVER_DOC).pipe(U.takeUntil(this.dispose$)).subscribe(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitDisposed$(i.UniverInstanceType.UNIVER_DOC).pipe(U.takeUntil(this.dispose$)).subscribe(t=>this._disposeRenderer(t))}_createRenderer(t){var r;const e=t.getUnitId(),n=(r=this._instanceSrv.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC))==null?void 0:r.getUnitId();this._renderManagerService.created$.subscribe(s=>{s.unitId===n&&(s.engine.getCanvas().setId(zr),s.engine.getCanvas().getContext().setId(zr))}),this._renderManagerService.has(e)||this._createRenderWithId(e)}_createRenderWithId(t){this._renderManagerService.createRender(t)}_disposeRenderer(t){const e=t.getUnitId();this._renderManagerService.removeRender(e)}};exports.DocsRenderService=dA([Kr(0,i.IUniverInstanceService),Kr(1,B.IRenderManagerService)],exports.DocsRenderService);const AA={id:$e.id,preconditions:dl,binding:I.KeyCode.ENTER},uA={id:bt.id,preconditions:$,binding:I.KeyCode.BACKSPACE},gA={id:fo.id,preconditions:$,binding:I.KeyCode.DELETE},hA={id:ye.id,binding:I.KeyCode.ARROW_UP,preconditions:$,staticParameters:{direction:i.Direction.UP}},mA={id:ye.id,binding:I.KeyCode.ARROW_DOWN,preconditions:$,staticParameters:{direction:i.Direction.DOWN}},pA={id:ye.id,binding:I.KeyCode.ARROW_LEFT,preconditions:$,staticParameters:{direction:i.Direction.LEFT}},fA={id:ye.id,binding:I.KeyCode.ARROW_RIGHT,preconditions:$,staticParameters:{direction:i.Direction.RIGHT}},SA={id:be.id,binding:I.KeyCode.ARROW_UP|I.MetaKeys.SHIFT,preconditions:$,staticParameters:{direction:i.Direction.UP}},IA={id:be.id,binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.SHIFT,preconditions:$,staticParameters:{direction:i.Direction.DOWN}},vA={id:be.id,binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.SHIFT,preconditions:$,staticParameters:{direction:i.Direction.LEFT}},EA={id:be.id,binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.SHIFT,preconditions:$,staticParameters:{direction:i.Direction.RIGHT}},CA={id:yo.id,binding:I.KeyCode.A|I.MetaKeys.CTRL_COMMAND,preconditions:o=>o.getContextValue(i.FOCUSING_UNIVER_EDITOR)&&(o.getContextValue(i.FOCUSING_DOC)||o.getContextValue(i.EDITOR_ACTIVATED))};var TA=Object.defineProperty,yA=Object.getOwnPropertyDescriptor,bA=(o,t,e)=>t in o?TA(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,RA=(o,t,e,n)=>{for(var r=n>1?void 0:n?yA(t,e):t,s=o.length-1,a;s>=0;s--)(a=o[s])&&(r=a(r)||r);return r},gt=(o,t)=>(e,n)=>t(e,n,o),xA=(o,t,e)=>bA(o,t+"",e);exports.UniverDocsUIPlugin=class extends i.Plugin{constructor(t=wr,e,n,r,s,a){super(),this._config=t,this._injector=e,this._renderManagerSrv=n,this._commandService=r,this._logService=s,this._configService=a;const{menu:c,...l}=i.merge({},wr,this._config);c&&this._configService.setConfig("menu",c,{merge:!0}),this._configService.setConfig(Rn,l),this._initDependencies(e),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),i.touchDependencies(this._injector,[[exports.DocStateChangeManagerService],[exports.DocsRenderService]])}onRendered(){this._initUI(),this._initRenderModules(),i.touchDependencies(this._injector,[[$t],[en],[rt],[tn],[exports.DocUIController]])}_initCommand(){[bt,fo,Pe,we,Ue,Le,Re,Qe,he,_e,ve,it,Ee,xe,an,mo,et,un,po,gn,ai,de,ot,nt,st,Mt,Dt,Bt,me,_t,Rt,jo,Xo,En,Cn,xi,Tn,yn,In,vn,at,qo,Ko,We,Ct,$e,Xt,Ot,vt,Oo,Mo,bo,Nt,fe,ho,Ge,pi,Ro,fi,ft,yo,Zo,ye,be,Ii,xo,vi,ce,Ei,So,Eo,Co,Po,wo,Uo,Lo,Qo,Kt,Ci,Ti,Bo,_o,No,To,$i,Jo].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))}),[It,pn,fn].forEach(t=>this.disposeWithMe(this._commandService.registerMultipleCommand(t)))}_initializeShortcut(){[hA,mA,fA,pA,SA,IA,vA,EA,CA,uA,gA,AA,ul].forEach(t=>{this._injector.get(I.IShortcutService).registerShortcut(t)})}_initDependencies(t){i.mergeOverrideWithDependencies([[ds],[nn],[on],[exports.DocUIController],[$t],[tn],[en],[Zt],[rt],[se,{useClass:exports.EditorService}],[Ne,{useClass:Vn}],[exports.DocCanvasPopManagerService],[exports.DocsRenderService],[exports.DocStateChangeManagerService],[exports.DocAutoFormatService],[Ce]],this._config.override).forEach(n=>t.add(n))}_markDocAsFocused(){const t=this._injector.get(i.IUniverInstanceService),e=this._injector.get(se);try{const n=t.getCurrentUnitForType(i.UniverInstanceType.UNIVER_DOC);if(!n)return;const r=n.getUnitId();e.isEditor(r)||t.focusUnit(n.getUnitId())}catch(n){this._logService.warn(n)}}_initUI(){this._injector.get(Zt)}_initRenderBasics(){[[D.DocSkeletonManagerService],[exports.DocSelectionRenderService],[D.DocInterceptorService],[er],[xt],[exports.DocRenderController],[so]].forEach(t=>{this._renderManagerSrv.registerRenderModule(i.UniverInstanceType.UNIVER_DOC,t)})}_initRenderModules(){[[exports.DocEventManagerService],[qt],[Jt],[exports.DocBackScrollRenderController],[io],[qn],[ro],[to],[eo],[nn],[oo],[no],[on]].forEach(t=>{this._renderManagerSrv.registerRenderModule(i.UniverInstanceType.UNIVER_DOC,t)})}};xA(exports.UniverDocsUIPlugin,"pluginName",Jr);exports.UniverDocsUIPlugin=RA([i.DependentOn(B.UniverRenderEnginePlugin),gt(1,i.Inject(i.Injector)),gt(2,B.IRenderManagerService),gt(3,i.ICommandService),gt(4,i.ILogService),gt(5,i.IConfigService)],exports.UniverDocsUIPlugin);function As(o,t,e){const n=I.useDependency(i.ICommandService),r=I.useDependency(I.IShortcutService),s=P.useMemo(()=>i.generateRandomId(4),[]);P.useEffect(()=>{if(!e||!o||!t)return;const c=`sheet.operation.editor-${e.getEditorId()}-keyboard-${s}`,l=new i.DisposableCollection;return l.add(n.registerCommand({id:c,type:i.CommandType.OPERATION,handler(A,d){const{keyCode:u,metaKey:m}=d;t.handler(u,m)}})),t.keyCodes.map(A=>({id:c,binding:A.metaKey?A.keyCode|A.metaKey:A.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:B.DeviceInputEventType.Keyboard,keyCode:A.keyCode,metaKey:A.metaKey}})).forEach(A=>{l.add(r.registerShortcut(A))}),()=>{l.dispose()}},[n,t,e,o,s,r])}const us=(o,t=!0,e,n)=>{const r=P.useCallback(()=>{if(o){const{scene:a,mainComponent:c}=o.render,l=o.render.with(D.DocSkeletonManagerService),{width:A,height:d}=o.getBoundingClientRect();l.getViewModel().getDataModel().updateDocumentDataPageSize(t?1/0:A,1/0),a.transformByState({width:A,height:d}),c==null||c.resize(A,d)}},[o,t]),s=P.useMemo(()=>i.debounce(()=>{var E,C;if(!e||!o||!e)return;const c=o.render.with(D.DocSkeletonManagerService).getSkeleton(),{scene:l,mainComponent:A}=o.render,d=l.getViewport(ie.VIEW_MAIN),{actualWidth:u,actualHeight:m}=c.getActualSize(),{width:g,height:h}=o.getBoundingClientRect();let p=d==null?void 0:d.getScrollBar();const f=Math.max(u,g),S=Math.max(m,h);l.transformByState({width:f,height:S}),A==null||A.resize(f,S),t?u>g?(p==null?d&&new B.ScrollBar(d,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:1/0,y:0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(C=d==null?void 0:d.getScrollBar())==null||C.dispose()):m>h?(p==null?d&&(p=new B.ScrollBar(d,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:0,y:1/0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(E=d==null?void 0:d.getScrollBar())==null||E.dispose())},30),[o,e,t,n]);return P.useEffect(()=>{if(e&&o){const a=setTimeout(()=>{r(),s()},500);return()=>{clearTimeout(a)}}},[o,e,r,s]),P.useEffect(()=>{if(e&&o){const a=o.input$.subscribe(()=>{s()});return()=>{a.unsubscribe()}}},[o,e,s]),{resize:r,checkScrollBar:s}};function OA(o){const{editorId:t,initialValue:e,container:n,autoFocus:r,isSingle:s}=o,a=P.useMemo(()=>r!=null?r:!1,[]),[c,l]=P.useState(),A=I.useDependency(se);return P.useLayoutEffect(()=>{var d,u;if(n.current){const m=typeof e=="string"?void 0:i.Tools.deepClone(e),g={body:{dataStream:typeof e=="string"?`${e}\r
`:`\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...m,documentStyle:{...m==null?void 0:m.documentStyle,pageSize:{width:s?1/0:n.current.clientWidth,height:1/0}},id:t},h=A.register({autofocus:!0,editorUnitId:t,initialSnapshot:g},n.current),p=A.getEditor(t);if(l(p),a){p.focus();const f=((u=(d=g.body)==null?void 0:d.dataStream.length)!=null?u:2)-2;p.setSelectionRanges([{startOffset:f,endOffset:f}])}return()=>{h==null||h.dispose()}}},[]),c}const MA=(o,t,e,n)=>{const r=I.useDependency(i.ICommandService),s=I.useDependency(I.IShortcutService),a=P.useRef(t);a.current=t;const c=P.useRef(n);c.current=n,P.useEffect(()=>{if(!e||!o)return;const A=`sheet.formula-embedding-editor.${e.getEditorId()}`,d=new i.DisposableCollection,u=(g,h)=>{if(c.current){c.current(g,h);return}let p=i.Direction.LEFT;g===I.KeyCode.ARROW_DOWN?p=i.Direction.DOWN:g===I.KeyCode.ARROW_UP?p=i.Direction.UP:g===I.KeyCode.ARROW_RIGHT&&(p=i.Direction.RIGHT),h===I.MetaKeys.SHIFT?r.executeCommand(be.id,{direction:p}):r.executeCommand(ye.id,{direction:p})};return d.add(r.registerCommand({id:A,type:i.CommandType.OPERATION,handler(g,h){const{keyCode:p}=h;u(p)}})),[{keyCode:I.KeyCode.ARROW_DOWN},{keyCode:I.KeyCode.ARROW_LEFT},{keyCode:I.KeyCode.ARROW_RIGHT},{keyCode:I.KeyCode.ARROW_UP},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT}].map(({keyCode:g,metaKey:h})=>({id:A,binding:h?g|h:g,preconditions:()=>!0,priority:900,staticParameters:{eventType:B.DeviceInputEventType.Keyboard,keyCode:g}})).forEach(g=>{d.add(s.registerShortcut(g))}),()=>{d.dispose()}},[r,e,o,s])};function DA(o,t){const e=I.useDependency(i.ICommandService);P.useEffect(()=>{if(!o)return;const n=e.onCommandExecuted(r=>{var s,a;if(r.id===D.RichTextEditingMutation.id){if(r.params.unitId!==o.getEditorId())return;const l=o.getDocumentData();t(l,i.getPlainText((a=(s=l.body)==null?void 0:s.dataStream)!=null?a:""))}});return()=>{n.dispose()}},[o,t,e])}const BA=o=>{var V;const{className:t,autoFocus:e,onFocusChange:n,initialValue:r,onClickOutside:s,keyboardEventConfig:a,moveCursor:c=!0,style:l,isSingle:A,editorId:d,onHeightChange:u,onChange:m,defaultHeight:g=32,maxHeight:h=32,icon:p,editorRef:f,placeholder:S}=o,E=I.useDependency(se),C=I.useEvent(n),T=I.useEvent(s),[R,v]=P.useState(g),b=P.useRef(null),x=P.useMemo(()=>d!=null?d:i.createInternalEditorID(`RICH_TEXT_EDITOR-${i.generateRandomId(4)}`),[d]),y=OA({editorId:x,initialValue:r,container:b,autoFocus:e,isSingle:A}),O=I.useDependency(B.IRenderManagerService).getRenderById(x),w=O==null?void 0:O.with(exports.DocSelectionRenderService),Q=I.useObservable(w==null?void 0:w.textSelectionInner$),k=!!((V=w==null?void 0:w.isFocusing)!=null&&V&&(Q!=null&&Q.textRanges.some(j=>j.collapsed))),F=P.useRef(null),[L,G]=P.useState(()=>{var j,X;return!i.BuildTextUtils.transform.getPlainText((X=(j=y==null?void 0:y.getDocumentData().body)==null?void 0:j.dataStream)!=null?X:"")}),{checkScrollBar:W}=us(y,A,!0,!0);P.useLayoutEffect(()=>{if(!(!f||!y)){if(typeof f=="function"){f(y);return}f.current=y}},[y]);const H=I.useEvent(j=>{var Y,K;const X=O==null?void 0:O.with(D.DocSkeletonManagerService),z=X==null?void 0:X.getSkeleton().getActualSize();z&&(u==null||u(z.actualHeight),v(Math.max(g,Math.min(z.actualHeight+10,h)))),m==null||m(j,i.getPlainText((K=(Y=j.body)==null?void 0:Y.dataStream)!=null?K:"")),W()});return P.useEffect(()=>{var X,z;G(!i.BuildTextUtils.transform.getPlainText((z=(X=y==null?void 0:y.getDocumentData().body)==null?void 0:X.dataStream)!=null?z:""));const j=y==null?void 0:y.selectionChange$.subscribe(()=>{var Y,K;G(!i.BuildTextUtils.transform.getPlainText((K=(Y=y==null?void 0:y.getDocumentData().body)==null?void 0:Y.dataStream)!=null?K:""))});return()=>j==null?void 0:j.unsubscribe()},[y]),I.useObservable(y==null?void 0:y.blur$),I.useObservable(y==null?void 0:y.focus$),P.useEffect(()=>{var X,z;const j=y==null?void 0:y.getDocumentData();C==null||C(k,i.getPlainText((z=(X=j==null?void 0:j.body)==null?void 0:X.dataStream)!=null?z:""))},[k,C]),P.useEffect(()=>{const j=z=>{var K,Z;E.getFocusId()!==x||((Z=(K=z.target)==null?void 0:K.dataset)==null?void 0:Z.editorid)===x||F.current&&!F.current.contains(z.target)&&(T==null||T())},X=setTimeout(()=>{document.addEventListener("click",j)},100);return()=>{document.removeEventListener("click",j),clearTimeout(X)}},[y,x,E,T]),MA(k&&c,!1,y),As(k,a,y),DA(y,H),N.jsx("div",{className:t,style:l,children:N.jsxs("div",{className:q.clsx("univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2 univer-pt-1.5",q.borderClassName,{"univer-border-primary-500":k}),style:{height:R},ref:F,children:[N.jsx("div",{ref:b,className:"univer-relative univer-size-full",onMouseUp:()=>y==null?void 0:y.focus()}),p,L?N.jsx("div",{className:"univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",children:S}):null]})})};exports.AfterSpaceCommand=Ct;exports.AlignCenterCommand=Dt;exports.AlignJustifyCommand=_t;exports.AlignLeftCommand=Mt;exports.AlignOperationCommand=me;exports.AlignRightCommand=Bt;exports.BreakLineCommand=an;exports.BulletListCommand=nt;exports.ChangeListNestingLevelCommand=Xt;exports.ChangeListNestingLevelType=pt;exports.ChangeListTypeCommand=Ot;exports.CheckListCommand=vt;exports.CoverContentCommand=fi;exports.CreateDocTableCommand=jo;exports.CutContentCommand=Ge;exports.DOCS_COMPONENT_BACKGROUND_LAYER_INDEX=Zr;exports.DOCS_COMPONENT_DEFAULT_Z_INDEX=Hn;exports.DOCS_COMPONENT_HEADER_LAYER_INDEX=$r;exports.DOCS_COMPONENT_MAIN_LAYER_INDEX=kt;exports.DOCS_VIEW_KEY=le;exports.DOC_UI_PLUGIN_NAME=Jr;exports.DOC_VERTICAL_PADDING=Zn;exports.DefaultDocContainerConfig=qr;exports.DefaultToolbarConfig=Yr;exports.DeleteCommand=et;exports.DeleteCustomBlockCommand=un;exports.DeleteLeftCommand=bt;exports.DeleteRightCommand=fo;exports.DocCopyCommand=It;exports.DocCreateTableOperation=bn;exports.DocCutCommand=pn;exports.DocIMEInputManagerService=xt;exports.DocPasteCommand=fn;exports.DocPrintInterceptorService=ds;exports.DocSelectAllCommand=yo;exports.DocTableDeleteColumnsCommand=vn;exports.DocTableDeleteRowsCommand=In;exports.DocTableDeleteTableCommand=at;exports.DocTableInsertColumnCommand=xi;exports.DocTableInsertColumnLeftCommand=Tn;exports.DocTableInsertColumnRightCommand=yn;exports.DocTableInsertRowAboveCommand=En;exports.DocTableInsertRowBellowCommand=Cn;exports.DocTableInsertRowCommand=Xo;exports.DocTableTabCommand=Ko;exports.DocsUIMenuSchema=ss;exports.Editor=Ki;exports.EditorInsertTextCommandId=si;exports.EnterCommand=$e;exports.HorizontalLineCommand=Rt;exports.IDocClipboardService=Ne;exports.IEditorService=se;exports.IMEInputCommand=bo;exports.InnerPasteCommand=ho;exports.InsertCommand=mo;exports.InsertCustomRangeCommand=vi;exports.ListOperationCommand=st;exports.MergeTwoParagraphCommand=gn;exports.MoveCursorOperation=ye;exports.MoveSelectionOperation=be;exports.NORMAL_TEXT_SELECTION_PLUGIN_NAME=vs;exports.NodePositionConvertToCursor=Te;exports.NodePositionConvertToRectRange=ko;exports.OrderListCommand=ot;exports.PastePluginLark=li;exports.PastePluginUniver=Ai;exports.PastePluginWord=ui;exports.QuickListCommand=Mo;exports.RectRange=Vo;exports.ReplaceContentCommand=pi;exports.ReplaceSelectionCommand=xo;exports.ReplaceSnapshotCommand=Ro;exports.ReplaceTextRunsCommand=Ii;exports.ResetInlineFormatTextBackgroundColorCommand=it;exports.RichTextEditor=BA;exports.SetDocZoomRatioCommand=ft;exports.SetDocZoomRatioOperation=de;exports.SetInlineFormatBoldCommand=Pe;exports.SetInlineFormatCommand=xe;exports.SetInlineFormatFontFamilyCommand=_e;exports.SetInlineFormatFontSizeCommand=he;exports.SetInlineFormatItalicCommand=we;exports.SetInlineFormatStrikethroughCommand=Le;exports.SetInlineFormatSubscriptCommand=Re;exports.SetInlineFormatSuperscriptCommand=Qe;exports.SetInlineFormatTextBackgroundColorCommand=Ee;exports.SetInlineFormatTextColorCommand=ve;exports.SetInlineFormatUnderlineCommand=Ue;exports.SetParagraphNamedStyleCommand=ce;exports.SwitchDocModeCommand=Nt;exports.TEXT_RANGE_LAYER_INDEX=zt;exports.TabCommand=We;exports.TextRange=je;exports.ToggleCheckListCommand=Oo;exports.UpdateCommand=po;exports.VIEWPORT_KEY=ie;exports.addCustomDecorationBySelectionFactory=Cs;exports.addCustomDecorationFactory=ti;exports.calcDocRangePositions=Gt;exports.convertBodyToHtml=gi;exports.convertPositionsToRectRanges=jt;exports.deleteCustomDecorationFactory=Ts;exports.docDrawingPositionToTransform=bs;exports.genTableSource=go;exports.generateParagraphs=Ao;exports.getAnchorBounding=St;exports.getCanvasOffsetByEngine=Ri;exports.getCommandSkeleton=ae;exports.getCursorWhenDelete=hn;exports.getCustomBlockIdsInSelections=ri;exports.getCutActionsFromDocRanges=ii;exports.getDocObject=ei;exports.getDocObjectById=Es;exports.getEmptyTableCell=ln;exports.getEmptyTableRow=dn;exports.getLineBounding=Sn;exports.getOneTextSelectionRange=Gn;exports.getRichTextEditPath=J;exports.getTableColumn=An;exports.hasParagraphInTable=ys;exports.isInSameTableCell=Ho;exports.isValidRectRange=yi;exports.neoGetDocObject=Ie;exports.transformToDocDrawingPosition=Rs;exports.useKeyboardEvent=As;exports.useResize=us;exports.whenDocAndEditorFocused=$;
