(function(y,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("@univerjs/core"),require("@univerjs/docs"),require("@univerjs/engine-render"),require("@univerjs/ui"),require("@univerjs/drawing"),require("rxjs"),require("react"),require("rxjs/operators"),require("react/jsx-runtime"),require("@univerjs/design")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/docs","@univerjs/engine-render","@univerjs/ui","@univerjs/drawing","rxjs","react","rxjs/operators","react/jsx-runtime","@univerjs/design"],s):(y=typeof globalThis<"u"?globalThis:y||self,s(y.UniverDocsUi={},y.UniverCore,y.UniverDocs,y.UniverEngineRender,y.UniverUi,y.UniverDrawing,y.rxjs,y.React,y.rxjs.operators,y.React,y.UniverDesign))})(this,(function(y,s,D,_,I,Mn,L,w,lt,P,J){"use strict";var MA=Object.defineProperty;var xA=(y,s,D)=>s in y?MA(y,s,{enumerable:!0,configurable:!0,writable:!0,value:D}):y[s]=D;var B=(y,s,D)=>xA(y,typeof s!="symbol"?s+"":s,D);var ga=Object.getOwnPropertyDescriptor,ma=(o,t,e,n)=>{for(var i=n>1?void 0:n?ga(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ni=(o,t)=>(e,n)=>t(e,n,o);y.DocAutoFormatService=class extends s.Disposable{constructor(e,n){super();B(this,"_matches",new Map);this._univerInstanceService=e,this._textSelectionManagerService=n}registerAutoFormat(e){const n=this._matches.get(e.id);return n?(n.push(e),n.sort((i,a)=>{var r,c;return((r=a.priority)!=null?r:0)-((c=i.priority)!=null?c:0)})):this._matches.set(e.id,[e]),s.toDisposable(()=>{const i=this._matches.get(e.id);if(i){const a=i.findIndex(r=>r===e);a>=0&&i.splice(a,1)}})}onAutoFormat(e,n){var l,A,d,u,m,h,g,p,f;const i=(l=this._matches.get(e))!=null?l:[],a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=this._textSelectionManagerService.getDocRanges(),c=(A=r.find(S=>S.isActive))!=null?A:r[0];if(a&&c){const S=a.getSelfOrHeaderFooterModel(c.segmentId),E={unit:S,selection:c,isBody:!c.segmentId,paragraphs:s.BuildTextUtils.range.getParagraphsInRange(c,(u=(d=S.getBody())==null?void 0:d.paragraphs)!=null?u:[],(h=(m=S.getBody())==null?void 0:m.dataStream)!=null?h:""),customRanges:s.BuildTextUtils.customRange.getCustomRangesInterestsWithSelection(c,(p=(g=S.getBody())==null?void 0:g.customRanges)!=null?p:[]),commandId:e,commandParams:n},C=i.find(T=>T.match(E));return(f=C==null?void 0:C.getMutations(E))!=null?f:[]}return[]}},y.DocAutoFormatService=ma([ni(0,s.IUniverInstanceService),ni(1,s.Inject(D.DocSelectionManagerService))],y.DocAutoFormatService);const oi={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},ii={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},si="DOC_UI_PLUGIN";var de=(o=>(o.MAIN="__Document_Render_Main__",o.BACKGROUND="__Document_Render_Background__",o))(de||{}),ae=(o=>(o.VIEW_MAIN="viewMain",o.VIEW_TOP="viewTop",o.VIEW_LEFT="viewLeft",o.VIEW_LEFT_TOP="viewLeftTop",o))(ae||{});const ai=0,wt=2,ri=4,xn=10,pa="normalTextSelectionPluginName";function Ie(o){const{mainComponent:t,scene:e,engine:n,components:i}=o,a=t,r=i.get(de.BACKGROUND);return{document:a,docBackground:r,scene:e,engine:n}}function ci(o,t){const e=o.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!e)return null;const n=e.getUnitId(),i=t.getRenderById(n);if(i==null)return;const{mainComponent:a,scene:r,engine:c,components:l}=i,A=a,d=l.get(de.BACKGROUND);return{document:A,docBackground:d,scene:r,engine:c}}function fa(o,t){const e=t.getRenderById(o);if(e==null)return;const{mainComponent:n,scene:i,engine:a,components:r}=e,c=n,l=r.get(de.BACKGROUND);return{document:c,docBackground:l,scene:i,engine:a}}function li(o){const{unitId:t,ranges:e,id:n,type:i,segmentId:a}=o,r={id:D.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0,segmentId:a}},c=s.JSONX.getInstance(),l=s.BuildTextUtils.customDecoration.add({ranges:e,id:n,type:i});return r.params.actions=c.editOp(l.serialize()),r}function Sa(o,t){const{segmentId:e,id:n,type:i,unitId:a}=t,r=o.get(D.DocSelectionManagerService),c=o.get(s.IUniverInstanceService),l=a?c.getUnit(a,s.UniverInstanceType.UNIVER_DOC):c.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!l)return!1;const A=l.getUnitId(),d=r.getTextRanges({unitId:A,subUnitId:A});return!d||!l.getBody()?!1:li({unitId:A,ranges:d,id:n,type:i,segmentId:e})}function Ia(o,t){const{unitId:e,id:n,segmentId:i}=t,r=o.get(s.IUniverInstanceService).getUnit(e);if(!r)return!1;const c={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:void 0,segmentId:i}},l=s.BuildTextUtils.customDecoration.delete({id:n,segmentId:i,documentDataModel:r});if(!l)return!1;const A=s.JSONX.getInstance();return c.params.actions=A.editOp(l.serialize()),c}function va(o,t){return t.some(e=>o.startIndex>e.startIndex&&o.startIndex<e.endIndex)}function Ut(o,t,e,n,i){const{textRuns:a=[],dataStream:r}=o,c=i&&r.startsWith("="),l={st:0,ed:0,ts:{}};if(c)return l;for(let A=a.length-1;A>=0;A--){const d=a[A],{st:u,ed:m}=d;t>u&&t<=m&&(l.st=u,l.ed=m,l.ts={...l.ts,...d.ts})}if(t===0){const A=a==null?void 0:a[0];A&&A.st===0&&(l.ts={...l.ts,...A.ts})}return n&&(l.ts={...l.ts,...n}),l}function Dn(o,t,e){if(e){const i=o.find(a=>t>=a.startIndex&&t<=a.endIndex+1);return i!=null&&i.wholeEntity?null:i}const n=o.find(i=>t>i.startIndex&&t<=i.endIndex);return n!=null&&n.wholeEntity?null:n}function Bn(o,t){return o.filter(e=>t>e.startIndex&&t<=e.endIndex)}function Ea(o){return{left:o.positionH.posOffset,top:o.positionV.posOffset,width:o.size.width,height:o.size.height}}function Ca(o,t=0,e=0){return{size:{width:o.width,height:o.height},positionH:{relativeFrom:s.ObjectRelativeFromH.MARGIN,posOffset:(o.left||0)-t},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:(o.top||0)-e},angle:o.angle||0}}const ke={id:"doc.command.tab",type:s.CommandType.COMMAND,async handler(o,t){const n=o.get(y.DocAutoFormatService).onAutoFormat(ke.id,t);return(await s.sequenceExecuteAsync(n,o.get(s.ICommandService))).result}},dt={id:"doc.command.after-space",type:s.CommandType.COMMAND,async handler(o){const e=o.get(y.DocAutoFormatService).onAutoFormat(dt.id);return(await s.sequenceExecuteAsync(e,o.get(s.ICommandService))).result}},ze={id:"doc.command.enter",type:s.CommandType.COMMAND,async handler(o){const e=o.get(y.DocAutoFormatService).onAutoFormat(ze.id);return(await s.sequenceExecuteAsync(e,o.get(s.ICommandService))).result}};var Ta=Object.getOwnPropertyDescriptor,ya=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ta(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},_n=(o,t)=>(e,n)=>t(e,n,o);const ba=11,Oa=9,Lt={ff:"Arial",fs:ba};let ve=class extends s.Disposable{constructor(t,e,n){super();B(this,"_cacheStyle",null);this._textSelectionManagerService=t,this._univerInstanceService=e,this._renderManagerService=n,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){var r;const t=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(t==null)return{...Lt};const e=t==null?void 0:t.getUnitId(),n=(r=this._renderManagerService.getRenderById(e))==null?void 0:r.with(D.DocSkeletonManagerService),i=n==null?void 0:n.getViewModel();return i==null?{...Lt}:i.getEditArea()===_.DocumentEditArea.BODY?{...Lt}:{...Lt,fs:Oa}}setStyleCache(t){this._cacheStyle={...this._cacheStyle,...t}}_clearStyleCache(){this._cacheStyle=null}};ve=ya([_n(0,s.Inject(D.DocSelectionManagerService)),_n(1,s.IUniverInstanceService),_n(2,_.IRenderManagerService)],ve);function re(o,t){var n;return(n=o.get(_.IRenderManagerService).getRenderById(t))==null?void 0:n.with(D.DocSkeletonManagerService)}function Z(o,t=""){if(!t)return["body"];const{headers:e,footers:n}=o.getSnapshot();if(e==null&&n==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[t])!=null)return["headers",t,"body"];if((n==null?void 0:n[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}function Nn(o,t,e){const n=[];for(let i=0,a=o.length;i<a;i++)o[i]===s.DataStreamTreeTokenType.PARAGRAPH&&n.push({startIndex:i});if(t)for(const i of n)t.bullet&&(i.bullet=s.Tools.deepClone(t.bullet)),t.paragraphStyle&&(i.paragraphStyle=s.Tools.deepClone(t.paragraphStyle),delete i.paragraphStyle.borderBottom,t.paragraphStyle.headingId&&(i.paragraphStyle.headingId=s.generateRandomId(6)));if(e)for(const i of n)i.paragraphStyle||(i.paragraphStyle={}),i.paragraphStyle.borderBottom=e;return n}const Qt={id:"doc.command.break-line",type:s.CommandType.COMMAND,handler:(o,t)=>{var Q,j,X,k,W;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=o.get(ve),r=(Q=t==null?void 0:t.textRange)!=null?Q:e.getActiveTextRange(),c=e.getRectRanges();if(r==null)return!1;if(c&&c.length){const{startOffset:G}=r;return e.replaceDocRanges([{startOffset:G,endOffset:G}]),!0}const{horizontalLine:l}=t!=null?t:{},{segmentId:A}=r,d=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A!=null?A:"").getBody();if(d==null||u==null)return!1;const m=d.getUnitId(),{startOffset:h,endOffset:g}=r,f=((j=u.paragraphs)!=null?j:[]).find(G=>G.startIndex>=h);if(!f)return!1;const S=h===f.startIndex,E=f.startIndex,C=a.getDefaultStyle(),T=a.getStyleCache(),R=Ut(u,g,C,T),v={dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Nn(s.DataStreamTreeTokenType.PARAGRAPH,f,l),textRuns:[{st:0,ed:1,ts:{...R.ts}}]};if(d==null)return!1;const O=e.getActiveTextRange();if(u==null)return!1;const{collapsed:M}=r,b=v.dataStream.length,N=[{startOffset:h+b,endOffset:h+b,style:O==null?void 0:O.style,collapsed:M}],x={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:N,debounce:!0}},U=new s.TextX,F=s.JSONX.getInstance();if(M)h>0&&U.push({t:s.TextXActionType.RETAIN,len:h}),U.push({t:s.TextXActionType.INSERT,body:v,len:v.dataStream.length});else{const G=s.BuildTextUtils.selection.delete([r],u,0,v);U.push(...G)}(((X=f.bullet)==null?void 0:X.listType)===s.PresetListType.CHECK_LIST_CHECKED||(k=f.paragraphStyle)!=null&&k.headingId)&&(r.endOffset<E&&U.push({t:s.TextXActionType.RETAIN,len:E-r.endOffset}),U.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...f,paragraphStyle:{...f.paragraphStyle,...S?{headingId:void 0,namedStyleType:void 0}:null},startIndex:0,bullet:(W=f.paragraphStyle)!=null&&W.headingId?void 0:{...f.bullet,listType:s.PresetListType.CHECK_LIST}}]},coverType:s.UpdateDocsAttributeType.REPLACE})),x.params.textRanges=[{startOffset:h+b,endOffset:h+b,collapsed:M}];const V=Z(d,A);return x.params.actions=F.editOp(U.serialize(),V),!!i.syncExecuteCommand(x.id,x.params)}};var Ft=(o=>(o[o.ABOVE=0]="ABOVE",o[o.BELLOW=1]="BELLOW",o))(Ft||{}),Pn=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(Pn||{});function Ra(o,t){let e=s.DataStreamTreeTokenType.TABLE_START;const n=[],i=[];for(let a=0;a<o;a++){e+=s.DataStreamTreeTokenType.TABLE_ROW_START;for(let r=0;r<t;r++)e+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,n.push({startIndex:e.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),i.push({startIndex:e.length-2});e+=s.DataStreamTreeTokenType.TABLE_ROW_END}return e+=s.DataStreamTreeTokenType.TABLE_END,{dataStream:e,paragraphs:n,sectionBreaks:i}}function Ht(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function kt(o){const t=Ht();return{tableCells:[...new Array(o).fill(null).map(()=>s.Tools.deepClone(t))],trHeight:{val:{v:30},hRule:s.TableRowHeightRule.AUTO}}}function Vt(o){return{size:{type:s.TableSizeType.SPECIFIED,width:{v:o}}}}function wn(o,t,e){const n=Vt(e/t),i=kt(t),a=[...new Array(o).fill(null).map(()=>s.Tools.deepClone(i))],r=[...new Array(t).fill(null).map(()=>s.Tools.deepClone(n))],c=s.generateRandomId(6);return{tableRows:a,tableColumns:r,tableId:c,align:s.TableAlignmentType.START,indent:{v:0},textWrap:s.TableTextWrapType.NONE,position:{positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:s.TableSizeType.UNSPECIFIED,width:{v:e}}}}function At(o,t){if(!o&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const i="";for(const a of t){const{startOffset:r,endOffset:c,segmentId:l}=a;r==null||c==null||l==null||(e=Math.min(e,r),n=Math.max(n,c))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:i}}else if(o){const{startOffset:e,endOffset:n,segmentId:i}=o;return e==null||n==null||i==null?null:{startOffset:e,endOffset:n,segmentId:i}}}function Ma(o){let t=s.DataStreamTreeTokenType.TABLE_ROW_START;const e=[],n=[];for(let i=0;i<o;i++)t+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,e.push({startIndex:t.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:t.length-2});return t+=s.DataStreamTreeTokenType.TABLE_ROW_END,{dataStream:t,paragraphs:e,sectionBreaks:n}}function xa(){const o=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],e=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),e.push({startIndex:2}),{dataStream:o,paragraphs:t,sectionBreaks:e}}function Da(o,t,e){var u,m,h;const{startOffset:n,endOffset:i,segmentId:a}=o,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:i;let l=null;const A=(h=(m=(u=e.getBody())==null?void 0:u.tables)==null?void 0:m.find(g=>c>=g.startIndex&&c<=g.endIndex))==null?void 0:h.tableId;let d=0;for(const g of r.getChildren()){for(const p of g.children){const{children:f}=p,S=f[0];if(S){for(const E of S.children)if(E.startIndex<=c&&c<=E.endIndex){d=S.children.indexOf(E),l=E;break}}if(l)break}if(l)break}return l==null||A==null?null:{offset:t===0?l.startIndex:l.endIndex+1,colCount:l.children.length,tableId:A,insertRowIndex:t===0?d:d+1}}function Ba(o,t,e){var h,g,p;const{startOffset:n,endOffset:i,segmentId:a}=o,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:i,l=(p=(g=(h=e.getBody())==null?void 0:h.tables)==null?void 0:g.find(f=>c>=f.startIndex&&c<=f.endIndex))==null?void 0:p.tableId,A=[];let d=null,u=-1;for(const f of r.getChildren()){for(const S of f.children){const{children:E}=S,C=E[0];if(C){if(c<C.startIndex||c>C.endIndex)continue;d=C;for(const T of C.children){for(const R of T.children){const v=T.children.indexOf(R);if(c>=R.startIndex&&c<=R.endIndex){u=v;break}}if(u!==-1)break}}if(d)break}if(d)break}if(d==null||l==null||u===-1)return null;let m=0;for(const f of d.children){const S=f.children[u],E=t===0?S.startIndex:S.endIndex+1;A.push(E-m),m=E}return{offsets:A,tableId:l,columnIndex:u,rowCount:d.children.length}}function _a(o,t,e){const n=[];let i=t[e].size.width.v,a=0;for(let r=0;r<t.length;r++)a+=t[r].size.width.v;a+=i;for(let r=0;r<t.length;r++)n.push(t[r].size.width.v/a*o);return i=i/a*o,{widths:n,newColWidth:i}}function di(o,t){var m,h,g;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(g=(h=(m=t.getBody())==null?void 0:m.tables)==null?void 0:h.find(p=>e>=p.startIndex&&n<=p.endIndex))==null?void 0:g.tableId,c=[];let l=-1,A=0,d=-1,u=!1;for(const p of a.getChildren()){for(const f of p.children){const{children:S}=f,E=S[0];if(E){if(e<E.startIndex||n>E.endIndex)continue;d=E.startIndex+3;for(const C of E.children){const T=E.children.indexOf(C),{startIndex:R,endIndex:v}=C;e>=R&&e<=v?(l=R,c.push(T),A+=v-R+1):(R>e&&v<n||n>=R&&n<=v)&&(c.push(T),A+=v-R+1),c.length===E.children.length&&(u=!0)}}if(c.length)break}if(c.length)break}return r==null||c.length===0?null:{tableId:r,rowIndexes:c,offset:l,len:A,cursor:d,selectWholeTable:u}}function Na(o,t){var g,p,f;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(f=(p=(g=t.getBody())==null?void 0:g.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null;const A=[];let d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children)for(const v of R.children){const O=R.children.indexOf(v);e>=v.startIndex&&e<=v.endIndex&&(u=O),n>=v.startIndex&&n<=v.endIndex&&(m=O)}}if(l)break}if(l)break}if(l==null||r==null)return null;for(let S=u;S<=m;S++)A.push(S);let h=0;for(const S of l.children){const E=S.children[u],C=S.children[m];c.push({retain:E.startIndex-h,delete:C.endIndex-E.startIndex+1}),h=C.endIndex+1}return d=l.startIndex+3,{offsets:c,tableId:r,columnIndexes:A,cursor:d,selectWholeTable:A.length===l.children[0].children.length,rowCount:l.children.length}}function Ai(o,t){var d,u,m;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(m=(u=(d=t.getBody())==null?void 0:d.tables)==null?void 0:u.find(h=>e>=h.startIndex&&n<=h.endIndex))==null?void 0:m.tableId;let c=-1,l=0,A=-1;for(const h of a.getChildren()){for(const g of h.children){const{children:p}=g,f=p[0];if(f){if(e<f.startIndex||n>f.endIndex)continue;c=f.startIndex,l=f.endIndex-f.startIndex+1,A=f.startIndex}if(f)break}if(l>0)break}return r==null?null:{tableId:r,offset:c,len:l,cursor:A}}function Pa(o,t){var g,p,f;const{startOffset:e,endOffset:n,segmentId:i}=o,a=t.getSelfOrHeaderFooterViewModel(i),r=(f=(p=(g=t.getBody())==null?void 0:g.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null,A=-1,d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,T=C[0];if(T){if(e<T.startIndex||n>T.endIndex)continue;l=T;for(const R of T.children){const v=T.children.indexOf(R);for(const O of R.children){const M=R.children.indexOf(O);e>=O.startIndex&&e<=O.endIndex&&(d=v,u=M),n>=O.startIndex&&n<=O.endIndex&&(m=M)}}}if(l)break}if(l)break}if(l==null||r==null||d===-1)return null;const h=l.children[d];for(let S=u;S<=m;S++){const E=h.children[S];c.push({retain:E.startIndex+1,delete:E.endIndex-E.startIndex-3})}return A=l.startIndex+3,{offsets:c,tableId:r,cursor:A,rowCount:l.children.length}}var Un=(o=>(o[o.NEXT=0]="NEXT",o[o.PREV=1]="PREV",o))(Un||{});function ui(o,t,e){const{startOffset:n}=t;let i=null;for(const A of o.getChildren()){for(const d of A.children){const u=d.children[0];if(u&&n>u.startIndex&&n<u.endIndex){i=u;break}}if(i)break}if(i==null)return null;let a=-1,r=-1,c=null;for(const A of i.children){for(const d of A.children)if(n>d.startIndex&&n<d.endIndex){a=A.children.indexOf(d),r=i.children.indexOf(A),c=A;break}if(a>-1)break}if(a===-1||r===-1||c==null)return null;let l=null;if(e===0){if(l=c.children[a+1],!l){const A=i.children[r+1];A&&(l=A.children[0])}}else if(l=c.children[a-1],!l){const A=i.children[r-1];A&&(l=A.children[A.children.length-1])}if(l){const{startIndex:A,endIndex:d}=l;return{startOffset:A+1,endOffset:d-2}}}function hi(o,t){const e=[],{customBlocks:n=[]}=o;for(const i of t){const{startOffset:a,endOffset:r}=i;if(!(a==null||r==null))for(const c of n){const{startIndex:l}=c;l>=a&&l<r&&e.push(c.blockId)}}return e}function wa(o){return o.some(t=>{const{startNodePosition:e}=t;return e?(e==null?void 0:e.path.indexOf("cells"))>-1:!1})}const Ua=s.SHEET_EDITOR_UNITS,Ln={id:"doc.command.inner-paste",type:s.CommandType.COMMAND,handler:async(o,t)=>{var b,N,x,U,F,V;const{segmentId:e,textRanges:n,doc:i}=t,a=o.get(s.ICommandService),r=o.get(D.DocSelectionManagerService),c=o.get(s.IUniverInstanceService),l=r.getTextRanges(),A=r.getRectRanges(),{body:d,tableSource:u,drawings:m}=i;if(!Array.isArray(l)||l.length===0||d==null)return!1;const h=c.getCurrentUniverDocInstance(),g=h==null?void 0:h.getSelfOrHeaderFooterModel(e).getBody();if(h==null||g==null)return!1;const p=h.getUnitId(),f={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:n,segmentId:e}},S=new s.MemoryCursor;S.reset();const E=new s.TextX,C=s.JSONX.getInstance(),T=[],R=!!((b=d.tables)!=null&&b.length),v=!!((N=d.customBlocks)!=null&&N.length);if(R&&e||R&&wa(l)||l.length&&(A!=null&&A.length))return!1;for(let H=0;H<l.length;H++){const Q=l[H],{startOffset:j,endOffset:X,collapsed:k}=Q,W=j-S.cursor,G=s.Tools.deepClone(d);if(R)for(const q of G.tables){const{tableId:z}=q,$=s.generateRandomId(6);q.tableId=$;const ie=s.Tools.deepClone(u[z]);ie.tableId=$;const fe=C.insertOp(["tableSource",$],ie);T.push(fe)}if(v&&m){const q=(U=(x=h.getSnapshot().drawingsOrder)==null?void 0:x.length)!=null?U:0;for(const z of G.customBlocks){const{blockId:$}=z,ie=s.generateRandomId(6);z.blockId=ie;const fe=s.Tools.deepClone(m[$]);fe.drawingId=ie;const He=C.insertOp(["drawings",ie],fe),Se=C.insertOp(["drawingsOrder",q],ie);T.push(He),T.push(Se)}}const K=Dn((F=g.customRanges)!=null?F:[],X,Ua.includes(p)),Y=Bn((V=g.customDecorations)!=null?V:[],X);if(K&&(G.customRanges=[{...K,startIndex:0,endIndex:d.dataStream.length-1}]),Y.length&&(G.customDecorations=Y.map(q=>({...q,startIndex:0,endIndex:d.dataStream.length-1}))),k)E.push({t:s.TextXActionType.RETAIN,len:W}),E.push({t:s.TextXActionType.INSERT,body:G,len:d.dataStream.length});else{const q=s.BuildTextUtils.selection.delete([Q],d,S.cursor,G,l.length===1);E.push(...q)}S.reset(),S.moveCursor(X)}const O=Z(h,e);return T.push(C.editOp(E.serialize(),O)),f.params.actions=T.reduce((H,Q)=>s.JSONX.compose(H,Q),null),!!a.syncExecuteCommand(f.id,f.params)}};function La(o,t){const{startOffset:e,endOffset:n}=o,i=t.some(r=>r.startIndex===n),a=Math.max(e,i?n-1:n);return{...o,endOffset:a,collapsed:e===a}}function Qa(o,t,e){var g,p;const n=t.getSelfOrHeaderFooterModel(e).getBody(),i=new s.TextX,a=s.JSONX.getInstance(),r=[];if(n==null)return r;const{tables:c=[]}=n,l=new s.MemoryCursor;l.reset();for(let f=0;f<o.length;f++){const S=La(o[f],c),{startOffset:E,endOffset:C,collapsed:T}=S,R=E-l.cursor;T?i.push({t:s.TextXActionType.RETAIN,len:R}):i.push(...s.BuildTextUtils.selection.delete([S],n,l.cursor,null,!1)),l.reset(),l.moveCursor(C)}const A=Z(t,e);r.push(a.editOp(i.serialize(),A));const d=hi(n,o),u=(g=t.getDrawings())!=null?g:{},m=(p=t.getDrawingsOrder())!=null?p:[],h=d.sort((f,S)=>m.indexOf(f)>m.indexOf(S)?-1:m.indexOf(f)<m.indexOf(S)?1:0);if(h.length>0)for(const f of h){const S=u[f],E=m.indexOf(f);if(S==null||E<0)continue;const C=a.removeOp(["drawings",f],S),T=a.removeOp(["drawingsOrder",E],f);r.push(C),r.push(T)}return r.reduce((f,S)=>s.JSONX.compose(f,S),null)}function Fa(o,t,e,n){const i=[];if(t.getSelfOrHeaderFooterModel(n).getBody()==null)return i;const r=new s.TextX,c=s.JSONX.getInstance(),l=new s.MemoryCursor;l.reset();for(const d of o){const{startOffset:u,endOffset:m,spanEntireRow:h,spanEntireTable:g}=d;if(!(u==null||m==null))if(g){const p=Ai({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,len:S,tableId:E}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:S});const C=c.removeOp(["tableSource",E]);i.push(C),l.moveCursorTo(f+S)}else if(h){const p=di({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,rowIndexes:S,len:E,tableId:C}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:E});for(const T of S.reverse()){const R=c.removeOp(["tableSource",C,"tableRows",T]);i.push(R)}l.moveCursorTo(f+E)}else{const p=Pa({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offsets:f}=p;for(const S of f){const{retain:E,delete:C}=S;E-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:E-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:C}),l.moveCursorTo(E+C)}}}const A=Z(t,n);return i.push(c.editOp(r.serialize(),A)),i.reduce((d,u)=>s.JSONX.compose(d,u),null)}function gi(o,t,e,n,i){let a=[];if(Array.isArray(o)&&(o==null?void 0:o.length)!==0&&(a=Qa(o,e,i)),Array.isArray(t)&&(t==null?void 0:t.length)!==0){const r=Fa(t,e,n,i);a==null||a.length===0?a=r:a=s.JSONX.compose(a,s.JSONX.transform(r,a,"right"))}return a}const Ve={id:"doc.command.inner-cut",type:s.CommandType.COMMAND,handler:(o,t)=>{var p;const e=o.get(D.DocSelectionManagerService),n=o.get(s.ICommandService),i=o.get(s.IUniverInstanceService),{segmentId:a,textRanges:r,selections:c=e.getTextRanges(),rectRanges:l=e.getRectRanges()}=t;if((!Array.isArray(c)||c.length===0)&&(!Array.isArray(l)||l.length===0))return!1;const A=(p=i.getCurrentUniverDocInstance())==null?void 0:p.getUnitId();if(!A)return!1;const d=i.getUniverDocInstance(A);if(d==null)return!1;const u=re(o,A);if(u==null)return!1;const m=u.getViewModel(),h={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r}};return h.params.actions=gi(c,l,d,m,a),!!n.syncExecuteCommand(h.id,h.params)}};var oe=(o=>(o[o.LEFT=0]="LEFT",o[o.RIGHT=1]="RIGHT",o))(oe||{});const mi="doc.command.insert-text",Qn={id:mi,type:s.CommandType.COMMAND,handler:async(o,t)=>{var v;const e=o.get(s.ICommandService),{range:n,segmentId:i,body:a,unitId:r,cursorOffset:c}=t,l=o.get(D.DocSelectionManagerService),d=o.get(s.IUniverInstanceService).getUnit(r,s.UniverInstanceType.UNIVER_DOC);if(d==null)return!1;const u=l.getActiveTextRange(),m=d.getSelfOrHeaderFooterModel((v=u==null?void 0:u.segmentId)!=null?v:"").getBody();if(m==null)return!1;const{startOffset:h,collapsed:g}=n,p=c!=null?c:a.dataStream.length,f=[{startOffset:h+p,endOffset:h+p,style:u==null?void 0:u.style,collapsed:g}],S={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:f,debounce:!0}},E=new s.TextX,C=s.JSONX.getInstance();if(g)h>0&&E.push({t:s.TextXActionType.RETAIN,len:h}),E.push({t:s.TextXActionType.INSERT,body:a,len:a.dataStream.length});else{const O=s.BuildTextUtils.selection.delete([n],m,0,a);E.push(...O)}S.params.textRanges=[{startOffset:h+p,endOffset:h+p,collapsed:g}];const T=Z(d,i);return S.params.actions=C.editOp(E.serialize(),T),!!e.syncExecuteCommand(S.id,S.params)}},Ye={id:"doc.command.delete-text",type:s.CommandType.COMMAND,handler:async(o,t)=>{var R;const e=o.get(s.ICommandService),n=o.get(s.IUniverInstanceService),{range:i,segmentId:a,unitId:r,direction:c,len:l=1}=t,A=n.getUnit(r,s.UniverInstanceType.UNIVER_DOC),d=A==null?void 0:A.getSelfOrHeaderFooterModel(a).getBody();if(A==null||d==null)return!1;const{startOffset:u}=i;let m=c===oe.LEFT?u-l:u,h=c===oe.LEFT?u-1:u+l-1;const g=(R=d.customRanges)==null?void 0:R.find(v=>v.startIndex<=m&&v.endIndex>=h);g!=null&&g.wholeEntity&&(m=g.startIndex,h=Math.max(h,g.endIndex));const p={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:[{startOffset:m,endOffset:m,collapsed:!0}],debounce:!0}},f=new s.TextX,S=s.JSONX.getInstance();f.push({t:s.TextXActionType.RETAIN,len:m-0}),f.push({t:s.TextXActionType.DELETE,len:h-m+1});const C=Z(A,a);return p.params.actions=S.editOp(f.serialize(),C),!!e.syncExecuteCommand(p.id,p.params)}},Fn={id:"doc.command.update-text",type:s.CommandType.COMMAND,handler:async(o,t)=>{const{range:e,segmentId:n,updateBody:i,coverType:a,unitId:r,textRanges:c}=t,l=o.get(s.ICommandService),d=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(d==null)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:c}},m=new s.TextX,h=s.JSONX.getInstance(),{startOffset:g,endOffset:p}=e;m.push({t:s.TextXActionType.RETAIN,len:g}),m.push({t:s.TextXActionType.RETAIN,body:i,len:p-g,coverType:a});const f=Z(d,n);return u.params.actions=h.editOp(m.serialize(),f),!!l.syncExecuteCommand(u.id,u.params)}};function ut(o){var r,c,l,A;const t=o.get(s.IUniverInstanceService),n=o.get(D.DocSelectionManagerService).getActiveTextRange(),i=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);return!n||!n.collapsed||!i||n.segmentId?!1:s.BuildTextUtils.range.getParagraphsInRange(n,(c=(r=i.getBody())==null?void 0:r.paragraphs)!=null?c:[],(A=(l=i.getBody())==null?void 0:l.dataStream)!=null?A:"")[0]}const Wt={id:"doc.command.delete-custom-block",type:s.CommandType.COMMAND,handler:async(o,t)=>{var x;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=e.getActiveTextRange(),r=n.getCurrentUniverDocInstance();if(a==null||r==null)return!1;const{direction:c,range:l,unitId:A,drawingId:d}=t,{startOffset:u,segmentId:m,style:h}=a,g=c===oe.LEFT?u-1:u,p=[{startOffset:g,endOffset:g,style:h}],f={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:p,prevTextRanges:[l]}},S=new s.TextX,E=s.JSONX.getInstance(),C=[];u>0&&S.push({t:s.TextXActionType.RETAIN,len:c===oe.LEFT?u-1:u}),S.push({t:s.TextXActionType.DELETE,len:1});const T=Z(r,m);C.push(E.editOp(S.serialize(),T));const R=((x=r.getDrawings())!=null?x:{})[d],O=r.getDrawingsOrder().indexOf(d),M=E.removeOp(["drawings",d],R),b=E.removeOp(["drawingsOrder",O],d);return C.push(M),C.push(b),f.params.actions=C.reduce((U,F)=>s.JSONX.compose(U,F),null),!!i.syncExecuteCommand(f.id,f.params)}},Gt={id:"doc.command.merge-two-paragraph",type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{direction:a,range:r}=t,c=e.getActiveTextRange(),l=e.getTextRanges();if(c==null||l==null)return!1;const{segmentId:A,style:d}=c,u=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const h=m.dataStream,g=c,p=u.getUnitId(),{startOffset:f,collapsed:S}=g;if(!S)return!1;const E=a===oe.LEFT?f:f+1;let C,T;for(const V of m.paragraphs){if(V.startIndex>=E){T=V;break}C=V}if(C==null||T==null)return!1;const R=a===oe.LEFT?f-1:f,v=[{startOffset:R,endOffset:R,style:d}],O={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:v,prevTextRanges:[r]}},M=new s.TextX,b=s.JSONX.getInstance();C.startIndex>0&&M.push({t:s.TextXActionType.RETAIN,len:C.startIndex}),M.push({t:s.TextXActionType.DELETE,len:1}),T.startIndex>C.startIndex+1&&M.push({t:s.TextXActionType.RETAIN,len:T.startIndex-C.startIndex-1});const N=Object.values(s.DataStreamTreeTokenType),x=h[C.startIndex-1];(x&&!N.includes(x)||x===" ")&&M.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone(C),startIndex:0}]}});const U=Z(u,A);return O.params.actions=b.editOp(M.serialize(),U),!!i.syncExecuteCommand(O.id,O.params)}},pi={id:"doc.command.remove-horizontal-line",type:s.CommandType.COMMAND,handler:async o=>{var R;const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getActiveTextRange(),a=t.getTextRanges();if(i==null||a==null)return!1;const{segmentId:r,style:c}=i,l=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),A=l==null?void 0:l.getSelfOrHeaderFooterModel(r).getBody();if(l==null||A==null)return!1;const d=i,u=l.getUnitId(),{startOffset:m,collapsed:h}=d;if(!h)return!1;const g=(R=A.paragraphs)==null?void 0:R.find(v=>v.startIndex===m-1);if(g==null)return!1;const p=[{startOffset:m,endOffset:m,style:c}],f={id:D.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:p}},S=new s.TextX,E=s.JSONX.getInstance();g.startIndex>0&&S.push({t:s.TextXActionType.RETAIN,len:g.startIndex}),S.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone({...g,paragraphStyle:{...g.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const C=Z(l,r);return f.params.actions=E.editOp(S.serialize(),C),!!n.syncExecuteCommand(f.id,f.params)}};function Xt(o,t){let e=0;if(o==null||o.length===0){if(typeof t[0].startOffset=="number"){const n=t[0],{spanEntireRow:i,spanEntireTable:a}=n;a?e=n.startOffset-3:i?n.startRow>0?e=n.startOffset-6:e=n.startOffset:e=t[0].startOffset}}else if(o.length>0&&t.length>0){const n=o[0],i=t[0];if(n.startOffset!=null&&i.startOffset!=null){if(n.startOffset<i.startOffset)e=n.startOffset;else if(n.startOffset>=i.startOffset){const{spanEntireRow:a,spanEntireTable:r}=i;r?e=i.startOffset-3:a&&(e=i.startOffset-6)}}}return e}const ht={id:"doc.command.delete-left",type:s.CommandType.COMMAND,handler:async o=>{var b,N,x,U,F,V;const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService);let i=!0;const a=e.getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=re(o,r),l=t.getActiveTextRange(),A=t.getRectRanges(),d=t.getTextRanges(),u=c==null?void 0:c.getSkeleton();if(u==null)return!1;if(A!=null&&A.length){const H=Xt(d,A),Q=A[0].segmentId,j=[{startOffset:H,endOffset:H}];return n.executeCommand(Ve.id,{segmentId:Q,textRanges:j})}if(l==null||d==null)return!1;const{segmentId:m,style:h,segmentPage:g}=l,p=a.getSelfOrHeaderFooterModel(m).getBody();if(p==null)return!1;const f=l,{startOffset:S,collapsed:E}=f,C=u.findNodeByCharIndex(S,m,g),T=_.hasListGlyph(C),R=_.isIndentByGlyph(C,p);let v=S;const O=u.findNodeByCharIndex(S-1,m,g);if(_.isFirstGlyph(C)&&O!==C&&(T===!0||R===!0)&&E){const H=_.getParagraphByGlyph(C,p);if(H==null)return!1;const Q=H==null?void 0:H.startIndex,j={startIndex:0},X=H.paragraphStyle;if(T===!0){const W=H.paragraphStyle;if(W){j.paragraphStyle=W;const{hanging:G}=W;G&&(j.paragraphStyle.indentStart=G,j.paragraphStyle.hanging=void 0)}}else if(R===!0){const W=H.bullet;W&&(j.bullet=W),X!=null&&(j.paragraphStyle={...X},delete j.paragraphStyle.hanging,delete j.paragraphStyle.indentStart)}const k=[{startOffset:v,endOffset:v,style:h}];i=await n.executeCommand(Fn.id,{unitId:a.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...j}]},range:{startOffset:Q,endOffset:Q+1},textRanges:k,coverType:s.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(E===!0){if(O==null)return!0;if(O.content==="\r"){const H=(b=p.paragraphs)==null?void 0:b.find(Q=>Q.startIndex===S-1);(N=H==null?void 0:H.paragraphStyle)!=null&&N.borderBottom?i=await n.executeCommand(pi.id):i=await n.executeCommand(Gt.id,{direction:oe.LEFT,range:f})}else if(O.streamType==="\b"){const H=(U=a.getSnapshot().drawings)==null?void 0:U[(x=O.drawingId)!=null?x:""];if(H==null)return!0;const Q=(V=(F=a.getBody())==null?void 0:F.customBlocks)==null?void 0:V.find(X=>X.blockId===O.drawingId);if(H.layoutType===s.PositionedObjectLayoutType.INLINE||(Q==null?void 0:Q.blockType)===s.BlockType.CUSTOM){const X=a.getUnitId();i=await n.executeCommand(Wt.id,{direction:oe.LEFT,range:l,unitId:X,drawingId:O.drawingId})}else{const X=u.findNodeByCharIndex(S-2);if(X==null)return!0;v-=O.count,v-=X.count;const k=[{startOffset:v,endOffset:v,style:h}];i=await n.executeCommand(Ye.id,{unitId:a.getUnitId(),range:{...l,startOffset:l.startOffset-1,endOffset:l.endOffset-1},segmentId:m,direction:oe.LEFT,len:X.count,textRanges:k})}}else v-=O.count,i=await n.executeCommand(Ye.id,{unitId:a.getUnitId(),range:f,segmentId:m,direction:oe.LEFT,len:O.count})}else{const H=fi(f,[f]);i=await n.executeCommand(Ve.id,{segmentId:m,textRanges:H,selections:[f]})}return i}},Hn={id:"doc.command.delete-right",type:s.CommandType.COMMAND,handler:async o=>{var C,T;const t=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!n)return!1;const i=re(o,n.getUnitId()),a=o.get(s.ICommandService),r=t.getActiveTextRange(),c=t.getRectRanges(),l=t.getTextRanges(),A=i==null?void 0:i.getSkeleton();if(c!=null&&c.length){const R=Xt(l,c),v=c[0].segmentId,O=[{startOffset:R,endOffset:R}];return a.executeCommand(Ve.id,{segmentId:v,textRanges:O})}if(r==null||A==null||l==null)return!1;const{segmentId:d,style:u,segmentPage:m}=r,h=n==null?void 0:n.getSelfOrHeaderFooterModel(d).getBody();if(!n||!h)return!1;const g=r,{startOffset:p,endOffset:f,collapsed:S}=g;if(p===h.dataStream.length-2&&S)return!0;let E=!1;if(S===!0){const R=A.findNodeByCharIndex(p,d,m),v=A.findNodeByCharIndex(p+1);if(R.streamType===s.DataStreamTreeTokenType.PARAGRAPH&&(v==null?void 0:v.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK)return!1;if(R.content==="\r")E=await a.executeCommand(Gt.id,{direction:oe.RIGHT,range:r});else if(R.streamType==="\b"){const O=(T=n.getSnapshot().drawings)==null?void 0:T[(C=R.drawingId)!=null?C:""];if(O==null)return!0;if(O.layoutType===s.PositionedObjectLayoutType.INLINE){const b=n.getUnitId();E=await a.executeCommand(Wt.id,{direction:oe.RIGHT,range:r,unitId:b,drawingId:R.drawingId})}else{if(v==null)return!0;const b=[{startOffset:p+1,endOffset:p+1,style:u}];E=await a.executeCommand(Ye.id,{unitId:n.getUnitId(),range:{...r,startOffset:p+1,endOffset:f+1},segmentId:d,direction:oe.RIGHT,textRanges:b,len:v.count})}}else{const O=[{startOffset:p,endOffset:p,style:u}];E=await a.executeCommand(Ye.id,{unitId:n.getUnitId(),range:g,segmentId:d,direction:oe.RIGHT,textRanges:O,len:R.count})}}else{const R=fi(g,[g]);E=await a.executeCommand(Ve.id,{segmentId:d,textRanges:R,selections:[g]})}return E}};function fi(o,t){let e=o.endOffset;for(const i of t){const{startOffset:a,endOffset:r}=i;a==null||r==null||r<=o.endOffset&&(e-=r-a)}return[{startOffset:e,endOffset:e,style:o.style}]}const kn={id:"doc.command.delete-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{var A,d;const t=o.get(s.IUniverInstanceService),e=o.get(s.ICommandService),n=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const i=(d=(A=n.getBody())==null?void 0:A.dataStream)!=null?d:"",a=ut(o);if(!a)return!1;const r=s.BuildTextUtils.selection.delete([{startOffset:a.paragraphStart,endOffset:i[a.paragraphEnd+1]===`
`?a.paragraphEnd:a.paragraphEnd+1,collapsed:!1}],n.getBody(),0,void 0,!0),c=Z(n),l={unitId:n.getUnitId(),actions:s.JSONX.getInstance().editOp(r,c),textRanges:[{startOffset:a.paragraphStart,endOffset:a.paragraphStart,collapsed:!0}]};return e.syncExecuteCommand(D.RichTextEditingMutation.id,l)}},Ha=10,ka=6;function Va(){return s.generateRandomId(ka)}function Wa(o){const t=o.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}class Ga{constructor(){B(this,"_cache",new s.LRUMap(Ha))}set(t,e){this._cache.set(t,e)}get(t){return this._cache.get(t)}clear(){this._cache.clear()}}const Vn=new Ga;function Wn(o){const t=o.style,e={},n=o.tagName.toLowerCase();switch(n){case"b":case"em":case"strong":{e.bl=s.BooleanNumber.TRUE;break}case"s":{e.st={s:s.BooleanNumber.TRUE};break}case"u":{e.ul={s:s.BooleanNumber.TRUE};break}case"i":{e.it=s.BooleanNumber.TRUE;break}case"sub":case"sup":{e.va=n==="sup"?s.BaselineOffset.SUPERSCRIPT:s.BaselineOffset.SUBSCRIPT;break}}for(let i=0;i<t.length;i++){const a=t[i],r=t.getPropertyValue(a);switch(a){case"font-family":{e.ff=r.replace(/^"/g,"").replace(/"$/g,"");break}case"font-size":{const c=Number.parseInt(r);Number.isNaN(c)||(r.endsWith("pt")?e.fs=c:r.endsWith("px")&&(e.fs=_.pixelToPt(c)));break}case"font-style":{r==="italic"&&(e.it=s.BooleanNumber.TRUE);break}case"font-weight":{(Number(r)>400||String(r)==="bold")&&(e.bl=s.BooleanNumber.TRUE);break}case"text-decoration":{/underline/.test(r)?e.ul={s:s.BooleanNumber.TRUE}:/overline/.test(r)?e.ol={s:s.BooleanNumber.TRUE}:/line-through/.test(r)&&(e.st={s:s.BooleanNumber.TRUE});break}case"color":{try{const c=new s.ColorKit(r);c.isValid&&(e.cl={rgb:c.toRgbString()})}catch{}break}case"background-color":{const c=new s.ColorKit(r);c.isValid&&(e.bg={rgb:c.toRgbString()});break}}}return e}function Xa(o){const t=new DOMParser,e=`<x-univer id="univer-root">${o}</x-univer>`;return t.parseFromString(e,"text/html").querySelector("#univer-root")}function Si(o,t){const e=o.tagName.toLowerCase();return typeof t=="string"?e===t:Array.isArray(t)?t.some(n=>n===e):t(o)}const Ii=660,Rn=class Rn{constructor(){B(this,"_tableCache",[]);B(this,"_styleCache",new Map);B(this,"_styleRules",[]);B(this,"_afterProcessRules",[])}static use(t){if(this._pluginList.includes(t))throw new Error(`Univer paste plugin ${t.name} already added`);this._pluginList.push(t)}convert(t,e={}){var c;const n=Rn._pluginList.find(l=>l.checkPasteType(t)),i=Xa(t),r={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:(c=e==null?void 0:e.unitId)!=null?c:""};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,i.childNodes,r),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],r}_process(t,e,n){var a,r,c,l;const i=n.body;for(const A of e)if(A.nodeType===Node.TEXT_NODE){if(((a=A.nodeValue)==null?void 0:a.trim())==="")continue;const d=(r=A.nodeValue)==null?void 0:r.replace(/[\r\n]/g,"");let u;t&&this._styleCache.has(t)&&(u=this._styleCache.get(t)),i.dataStream+=d,u&&Object.getOwnPropertyNames(u).length&&i.textRuns.push({st:i.dataStream.length-d.length,ed:i.dataStream.length,ts:u})}else if(A.nodeName==="IMG"){const d=A,u=d.dataset.imageSourceType,m=u===Mn.ImageSourceType.UUID?d.dataset.source:d.src;if(m&&u){const h=Number(d.dataset.width||100),g=Number(d.dataset.height||100),p=Number(d.dataset.docTransformWidth||h),f=Number(d.dataset.docTransformHeight||g),S=s.generateRandomId(6);(l=(c=n.body)==null?void 0:c.customBlocks)==null||l.push({startIndex:i.dataStream.length,blockId:S}),i.dataStream+="\b",n.drawings||(n.drawings={}),n.drawings[S]={drawingId:S,title:"",description:"",imageSourceType:u,source:m,transform:{width:h,height:g,left:0},docTransform:{size:{width:p,height:f},angle:0,positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:0}},layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,unitId:n.id||"",subUnitId:n.id||""}}}else{if(s.skipParseTagNames.includes(A.nodeName.toLowerCase()))continue;if(A.nodeType===Node.ELEMENT_NODE){const d=A,u=this._processBeforeLink(d,n),m=t?this._styleCache.get(t):{},h=this._styleRules.find(({filter:S})=>Si(A,S)),g=h?h.getStyle(A):Wn(A);this._styleCache.set(A,{...m,...g});const{childNodes:p}=A;this._processBeforeTable(A,n),this._process(A,p,n),this._processAfterTable(A,n);const f=this._afterProcessRules.find(({filter:S})=>Si(A,S));f&&f.handler(n,A),this._processAfterLink(d,n,u)}}}_processBeforeTable(t,e){var a;const n=t.tagName.toUpperCase(),i=e.body;switch(n){case"TABLE":{i.dataStream[i.dataStream.length-1]!=="\r"&&(i.dataStream+="\r",i.paragraphs==null&&(i.paragraphs=[]),(a=i.paragraphs)==null||a.push({startIndex:i.dataStream.length-1}));const r=wn(0,0,Ii);this._tableCache.push({table:r,startIndex:i.dataStream.length}),i.dataStream+=s.DataStreamTreeTokenType.TABLE_START;break}case"TR":{const r=kt(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(r),i.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{const r=Ht(),c=this._tableCache[this._tableCache.length-1].table;c.tableRows[c.tableRows.length-1].tableCells.push(r),i.dataStream+=s.DataStreamTreeTokenType.TABLE_CELL_START;break}}}_processAfterTable(t,e){var r,c;const n=t.tagName.toUpperCase(),i=e.body;e.tableSource==null&&(e.tableSource={}),i.tables==null&&(i.tables=[]),i.sectionBreaks==null&&(i.sectionBreaks=[]);const{tableSource:a}=e;switch(n){case"TABLE":{const l=this._tableCache.pop(),{startIndex:A,table:d}=l,u=d.tableRows[0].tableCells.length,m=Vt(Ii/u),h=[...new Array(u).fill(null).map(()=>s.Tools.deepClone(m))];d.tableColumns=h,a[d.tableId]=d,i.dataStream+=s.DataStreamTreeTokenType.TABLE_END,i.tables.push({startIndex:A,endIndex:i.dataStream.length,tableId:d.tableId});break}case"TR":{i.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_END;break}case"TD":{i.dataStream[i.dataStream.length-1]!=="\r"&&((r=i.paragraphs)==null||r.push({startIndex:i.dataStream.length}),i.dataStream+="\r"),(c=i.sectionBreaks)==null||c.push({startIndex:i.dataStream.length}),i.dataStream+=`
${s.DataStreamTreeTokenType.TABLE_CELL_END}`;break}}}_processBeforeLink(t,e){return e.body.dataStream.length}_processAfterLink(t,e,n){var r,c;const i=e.body,a=t;a.tagName.toUpperCase()==="A"&&(i.customRanges=(r=i.customRanges)!=null?r:[],i.customRanges.push({startIndex:n,endIndex:i.dataStream.length-1,rangeId:(c=a.dataset.rangeid)!=null?c:s.generateRandomId(),rangeType:s.CustomRangeType.HYPERLINK,properties:{url:a.href}}))}};B(Rn,"_pluginList",[]);let qe=Rn;const vi={name:"univer-doc-paste-plugin-lark",checkPasteType(o){return/lark-record-clipboard/i.test(o)},stylesRules:[{filter:["s"],getStyle(o){const t=Wn(o);return{st:{s:s.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter(o){return o.tagName==="DIV"&&/ace-line/i.test(o.className)},handler(o){const t=o.body;t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function Ei(o){const t=o.style,e={};for(let n=0;n<t.length;n++){const i=t[n],a=t.getPropertyValue(i);switch(i){case"margin-top":{const r=Number.parseInt(a);e.spaceAbove={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"margin-bottom":{const r=Number.parseInt(a);e.spaceBelow={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"line-height":{let r=Number.parseFloat(a);a.endsWith("%")&&(r/=100),e.lineSpacing=r;break}}}return Object.getOwnPropertyNames(e).length?e:null}const Ci={name:"univer-doc-paste-plugin-univer",checkPasteType(o){return/UniverNormal/i.test(o)},stylesRules:[],afterProcessRules:[{filter(o){return o.tagName==="P"&&/UniverNormal/i.test(o.className)},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},i=Ei(t);i&&(n.paragraphStyle=i),e.paragraphs.push(n),e.dataStream+="\r"}}]},Ti={name:"univer-doc-paste-plugin-word",checkPasteType(o){return/word|mso/i.test(o)},stylesRules:[{filter:["b"],getStyle(o){const t=Wn(o);return{bl:s.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter(o){return o.tagName==="P"},handler(o,t){const e=o.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},i=Ei(t);i&&(n.paragraphStyle=i),e.paragraphs.push(n),e.dataStream+="\r"}}]};function ja(o){var n,i;const t=a=>{let r="";return Object.keys(a).forEach(c=>{a[c]!==void 0&&(r+=` ${c}=${a[c]}`)}),r},e={"data-doc-transform-height":o.docTransform.size.height,"data-doc-transform-width":o.docTransform.size.width,"data-width":(n=o.transform)==null?void 0:n.width,"data-height":(i=o.transform)==null?void 0:i.height,"data-image-source-type":o.imageSourceType,"data-source":o.imageSourceType===Mn.ImageSourceType.UUID?o.source:void 0,src:o.source};return`<img  ${t(e)}></img>`}function yi(o,t){const{st:e,ed:n,ts:i={}}=t,{ff:a,fs:r,it:c,bl:l,ul:A,st:d,ol:u,bg:m,cl:h,va:g}=i;let p=o.slice(e,n);const f=[];return c===s.BooleanNumber.TRUE&&(p=`<i>${p}</i>`),g===s.BaselineOffset.SUPERSCRIPT?p=`<sup>${p}</sup>`:g===s.BaselineOffset.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(A==null?void 0:A.s)===s.BooleanNumber.TRUE&&(p=`<u>${p}</u>`),(d==null?void 0:d.s)===s.BooleanNumber.TRUE&&(p=`<s>${p}</s>`),l===s.BooleanNumber.TRUE&&(p=`<strong>${p}</strong>`),a&&f.push(`font-family: ${a}`),h&&f.push(`color: ${h.rgb}`),r&&f.push(`font-size: ${r}pt`),u&&f.push("text-decoration: overline"),m&&f.push(`background: ${m.rgb}`),f.length?`<span style="${f.join("; ")};">${p}</span>`:p}function Gn(o,t,e){const{dataStream:n,textRuns:i=[]}=o;if(t===e)return"";let a=t;const r=[];for(const c of i){const{st:l,ed:A}=c;s.Tools.hasIntersectionBetweenTwoRanges(t,e,l,A)&&(l>a?(r.push(n.slice(a,l)),r.push(yi(n,{...c,ed:Math.min(A,e)}))):r.push(yi(n,{...c,st:a,ed:Math.min(A,e)}))),a=Math.max(t,Math.min(A,e))}return a!==e&&r.push(n.slice(a,e)),r.join("")}function Ka(o,t,e){const n=o.body,i=o.drawings||{},{customRanges:a=[],customBlocks:r=[]}=n||{},c=[...r],l=a.filter(h=>h.startIndex>=t&&h.endIndex<=e);let A=t,d="";const u=(h,g)=>{let p="",f=0,S=h,E=c.findIndex(C=>h<=C.startIndex&&g>=C.startIndex);if(E===-1)return p=Gn(n,h,g),{sliceHtml:p,customBlockLength:f};for(;E!==-1;){const C=c[E];c.splice(E,1),p+=Gn(n,S,C.startIndex);const T=i[C.blockId];if(T)switch(T.drawingType){case s.DrawingTypeEnum.DRAWING_IMAGE:{p+=ja(T),f++;break}}S=C.startIndex+1,E=c.findIndex(R=>S<=R.startIndex&&g>=R.startIndex)}return p=p+Gn(n,S,g+1),{sliceHtml:p,customBlockLength:f}};l.forEach(h=>{var T,R;const{startIndex:g,endIndex:p,rangeType:f,rangeId:S}=h,E=u(A,g);d+=E.sliceHtml;const C=u(g,p+1);switch(f){case s.CustomRangeType.HYPERLINK:{d+=`<a data-rangeid="${S}" href="${(R=(T=h.properties)==null?void 0:T.url)!=null?R:""}">${C.sliceHtml}</a>`;break}default:{d+=C.sliceHtml;break}}A=p+1+(E.customBlockLength+C.customBlockLength)});const m=u(A,e);return d+=m.sliceHtml,d}function bi(o){const t=o.body||{},{paragraphs:e=[],sectionBreaks:n=[]}=t;let{dataStream:i=""}=t;i.endsWith(`\r
`)||(i+=`\r
`,e.push({startIndex:i.length-2}),n.push({startIndex:i.length-1}),t.dataStream=i,t.paragraphs=e,t.sectionBreaks=n);const a={html:""},r=_.parseDataStreamToTree(i).sectionList;for(const c of r)Je(c,o,a);return a.html}function Je(o,t,e){var n,i;switch(o.nodeType){case s.DataStreamTreeNodeType.SECTION_BREAK:{for(const a of o.children)Je(a,t,e);break}case s.DataStreamTreeNodeType.PARAGRAPH:{const{children:a,startIndex:r,endIndex:c}=o,l=(i=(n=t.body)==null?void 0:n.paragraphs.find(g=>g.startIndex===c))!=null?i:{},{paragraphStyle:A={}}=l,{spaceAbove:d,spaceBelow:u,lineSpacing:m}=A,h=[];if(d!=null&&(typeof d=="number"?h.push(`margin-top: ${d}px`):h.push(`margin-top: ${d.v}px`)),u!=null&&(typeof u=="number"?h.push(`margin-bottom: ${u}px`):h.push(`margin-bottom: ${u.v}px`)),m!=null&&h.push(`line-height: ${m}`),e.html+=`<p class="UniverNormal" ${h.length?`style="${h.join("; ")};"`:""}>`,a.length)for(const g of a)Je(g,t,e);e.html+=`${Ka(t,r,c)}</p>`;break}case s.DataStreamTreeNodeType.TABLE:{const{children:a}=o;e.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const r of a)Je(r,t,e);e.html+="</tbody></table>";break}case s.DataStreamTreeNodeType.TABLE_ROW:{const{children:a}=o;e.html+='<tr class="UniverTableRow">';for(const r of a)Je(r,t,e);e.html+="</tr>";break}case s.DataStreamTreeNodeType.TABLE_CELL:{const{children:a}=o;e.html+='<td class="UniverTableCell">';for(const r of a)Je(r,t,e);e.html+="</td>";break}default:throw new Error(`Unknown node type: ${o.nodeType}`)}}class za{convert(t){if(t.length===0)throw new Error("The bodyList length at least to be 1");let e="";for(const n of s.Tools.deepClone(t))e+=bi(n);return e}}var Ya=Object.getOwnPropertyDescriptor,qa=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ya(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},gt=(o,t)=>(e,n)=>t(e,n,o);qe.use(Ti),qe.use(vi),qe.use(Ci);function Oi(o,t,e){var a,r,c;const n=s.getBodySlice(o,t,e+2),i=s.DataStreamTreeTokenType.TABLE_START+s.DataStreamTreeTokenType.TABLE_ROW_START+s.DataStreamTreeTokenType.TABLE_CELL_START+n.dataStream+s.DataStreamTreeTokenType.TABLE_CELL_END+s.DataStreamTreeTokenType.TABLE_ROW_END+s.DataStreamTreeTokenType.TABLE_END;return n.dataStream=i,(a=n.textRuns)==null||a.forEach(l=>{const{st:A,ed:d}=l;l.st=A+3,l.ed=d+3}),(r=n.tables)==null||r.forEach(l=>{const{startIndex:A,endIndex:d}=l;l.startIndex=A+3,l.endIndex=d+3}),(c=n.paragraphs)==null||c.forEach(l=>{const{startIndex:A}=l;l.startIndex=A+3}),n}const De=s.createIdentifier("doc.clipboard-service");let Xn=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_clipboardHooks",[]);B(this,"_htmlToUDM",new qe);B(this,"_umdToHtml",new za);this._univerInstanceService=t,this._logService=e,this._commandService=n,this._clipboardInterfaceService=i,this._docSelectionManagerService=a}async copy(t=s.SliceBodyType.copy,e){var c,l;const{newSnapshotList:n=[],needCache:i=!1,snapshot:a,ranges:r}=(c=this._getDocumentBodyInRanges(t,e))!=null?c:{};if(n.length===0||a==null)return!1;try{const A=!!((l=r==null?void 0:r[0])!=null&&l.segmentId);this._setClipboardData(n,!A&&i)}catch(A){return this._logService.error("[DocClipboardService] copy failed",A),!1}return!0}async cut(t){return this._cut(t)}async paste(t){const e=await this._genDocDataFromClipboardItems(t);return this._paste(e)}async legacyPaste(t){let{html:e,text:n,files:i}=t;const a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=(a==null?void 0:a.getUnitId())||"";if(!e&&!n&&i.length&&(e=await this._createImagePasteHtml(i)),!e&&!n)return this._logService.warn("[DocClipboardController] html and text cannot be both empty!"),!1;const c=this._genDocDataFromHtmlAndText(e,n,r);if(r===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)if(n){const l=s.BuildTextUtils.transform.fromPlainText(n);return this._paste({body:l})}else c.body.textRuns=[];return this._paste(c)}async _cut(t){var c,l,A,d,u;const e=(l=(c=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.TEXT))!=null?c:this._docSelectionManagerService.getTextRanges())!=null?l:[],n=(d=(A=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.RECT))!=null?A:this._docSelectionManagerService.getRectRanges())!=null?d:[],{segmentId:i,endOffset:a,style:r}=(u=e[0])!=null?u:{};if(i==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),e.length===0&&n.length===0)return!1;this.copy(s.SliceBodyType.cut,t);try{let m=0;if(n.length>0)m=Xt(e,n);else if(a!=null){m=a;for(const g of e){const{startOffset:p,endOffset:f}=g;p==null||f==null||f<=a&&(m-=f-p)}}const h=[{startOffset:m,endOffset:m,style:r}];return this._commandService.executeCommand(Ve.id,{segmentId:i,textRanges:h,rectRanges:n,selections:e})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(t){var d,u,m;const{body:e}=t;if(e==null)return!1;let n=s.normalizeBody(e);if(!((d=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:d.getUnitId()))return!1;this._clipboardHooks.forEach(h=>{h.onBeforePaste&&(n=h.onBeforePaste(n))}),n.customRanges=(u=n.customRanges)==null?void 0:u.map(s.BuildTextUtils.customRange.copyCustomRange),(m=n.paragraphs)==null||m.forEach(h=>{var g;(g=h.paragraphStyle)!=null&&g.headingId&&(h.paragraphStyle.headingId=s.generateRandomId(6))});const a=this._docSelectionManagerService.getActiveTextRange(),{segmentId:r,endOffset:c,style:l}=a||{},A=this._docSelectionManagerService.getTextRanges();if(r==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),c==null||A==null)return!1;try{let h=c;for(const p of A){const{startOffset:f,endOffset:S}=p;f==null||S==null||S<=c&&(h+=n.dataStream.length-(S-f))}const g=[{startOffset:h,endOffset:h,style:l}];return this._commandService.executeCommand(Ln.id,{doc:{...t,body:n},segmentId:r,textRanges:g})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(t,e=!0){var r,c,l,A;const n=Va(),i=(t.length>1?t.map(d=>{var u;return((u=d.body)==null?void 0:u.dataStream)||""}).join(`
`):((r=t[0].body)==null?void 0:r.dataStream)||"").replaceAll(s.DataStreamTreeTokenType.TABLE_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_END,"").replaceAll(`\r
`," ");let a=this._umdToHtml.convert(t);if(t.length===1&&e){a=a.replace(/(<[a-z]+)/,(m,h)=>`${h} data-copy-id="${n}"`);const d=t[0],u={body:d.body};if((l=(c=d.body)==null?void 0:c.customBlocks)!=null&&l.length){u.drawings={};for(const m of d.body.customBlocks){const{blockId:h}=m,g=(A=d.drawings)==null?void 0:A[h];if(g){const p=s.generateRandomId(6);m.blockId=p,u.drawings[p]={...s.Tools.deepClone(g),drawingId:p}}}}Vn.set(n,u)}return this._clipboardInterfaceService.write(i,a)}addClipboardHook(t){return this._clipboardHooks.push(t),s.toDisposable(()=>{const e=this._clipboardHooks.indexOf(t);e>-1&&this._clipboardHooks.splice(e,1)})}_getDocumentBodyInRanges(t,e){var d;const n=this._univerInstanceService.getCurrentUniverDocInstance(),i=e!=null?e:this._docSelectionManagerService.getDocRanges(),a=[];let r=!0;if(n==null||i.length===0)return;const c=i[0].segmentId,l=(d=n==null?void 0:n.getSelfOrHeaderFooterModel(c))==null?void 0:d.getBody(),A=n.getSnapshot();if(l!=null){for(const u of i){const{startOffset:m,endOffset:h,collapsed:g,rangeType:p}=u;if(g||m==null||h==null)continue;if(p===s.DOC_RANGE_TYPE.RECT){r=!1;const{spanEntireRow:E}=u;let C;C=Oi(l,m,h),a.push(C);continue}const f={startOffset:m,endOffset:h},S=n.getSelfOrHeaderFooterModel(c).sliceBody(f.startOffset,f.endOffset,t);S!=null&&a.push(S)}return{newSnapshotList:a.map(u=>({...A,body:u})),needCache:r,snapshot:A,ranges:i}}}async _genDocDataFromClipboardItems(t){try{let e="",n="";const i=[];for(const a of t)for(const r of a.types)switch(r){case I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE:{n=await a.getType(r).then(c=>c&&c.text());break}case I.HTML_CLIPBOARD_MIME_TYPE:{e=await a.getType(r).then(c=>c&&c.text());break}case I.FILE__BMP_CLIPBOARD_MIME_TYPE:case I.FILE__JPEG_CLIPBOARD_MIME_TYPE:case I.FILE__WEBP_CLIPBOARD_MIME_TYPE:case I.FILE_PNG_CLIPBOARD_MIME_TYPE:{const c=await a.getType(r),l=new File([c],`pasted_image.${r.split("/")[1]}`,{type:r});i.push(l);break}}return!e&&!n&&i.length&&(e=await this._createImagePasteHtml(i)),this._genDocDataFromHtmlAndText(e,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(t,e,n){if(!t){if(e)return{body:s.BuildTextUtils.transform.fromPlainText(e)};throw new Error("[DocClipboardService] html and text cannot be both empty!")}const i=Wa(t);if(i){const r=Vn.get(i);if(r)return r}if(!n){const r=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n=(r==null?void 0:r.getUnitId())||""}const a=this._htmlToUDM.convert(t,{unitId:n});return i&&Vn.set(i,a),a}async _createImagePasteHtml(t){var c,l;const e={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},n=async A=>{const d=new FileReader;return new Promise(u=>{d.onloadend=function(){u({source:d.result,imageSourceType:Mn.ImageSourceType.BASE64})},d.readAsDataURL(A)})},i=A=>{const d=new Image,u=500;return new Promise(m=>{d.src=typeof A=="string"?A:URL.createObjectURL(A),d.onload=()=>{const h=Math.min(u,d.naturalWidth),g=d.naturalHeight/d.naturalWidth;m({width:h,height:h*g})}})},a=(l=(c=this._clipboardHooks.find(A=>A.onBeforePasteImage))==null?void 0:c.onBeforePasteImage)!=null?l:n;return await Promise.all(t.map(async(A,d)=>{var S;const u=await a(A);if(!u)return Promise.resolve();const{width:m=100,height:h=100}=await i(A),g=`paste_image_id_${d}`,p=e.body,f=e.drawings;p.dataStream+="\b",(S=p.customBlocks)==null||S.push({startIndex:d,blockId:g}),f[g]={drawingId:g,unitId:"",subUnitId:"",imageSourceType:u.imageSourceType,title:"",source:u.source,description:"",layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,transform:{width:m,height:h,angle:0},docTransform:{angle:0,size:{width:m,height:h},positionH:{relativeFrom:s.ObjectRelativeFromH.CHARACTER,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.LINE,posOffset:0}}}})),this._umdToHtml.convert([e])}};Xn=qa([gt(0,s.IUniverInstanceService),gt(1,s.ILogService),gt(2,s.ICommandService),gt(3,I.IClipboardInterfaceService),gt(4,s.Inject(D.DocSelectionManagerService))],Xn);function jt(o){return o.getContextValue(s.FOCUSING_DOC)||o.getContextValue(s.EDITOR_ACTIVATED)}const jn=999,mt={id:I.CopyCommand.id,name:"doc.command.copy",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>o.get(De).copy()},Kn={id:"doc.command.copy-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(De),e=ut(o);return e?t.copy(s.SliceBodyType.copy,[{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1}]):!1}},Kt={id:I.CutCommand.id,name:"doc.command.cut",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>o.get(De).cut()},zn={id:"doc.command.cut-current-paragraph",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(De),e=ut(o);return e?t.cut([{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1,rangeType:s.DOC_RANGE_TYPE.TEXT}]):!1}},zt={id:I.PasteCommand.id,name:"doc.command.paste",type:s.CommandType.COMMAND,multi:!0,priority:jn,preconditions:jt,handler:async o=>{const t=o.get(De),n=await o.get(I.IClipboardInterfaceService).read();return n.length===0?!1:t.paste(n)}},pt={id:"doc.command.horizontal-line",type:s.CommandType.COMMAND,handler:(o,t)=>o.get(s.ICommandService).syncExecuteCommand(Qt.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:s.DashStyleType.SOLID},textRange:t==null?void 0:t.insertRange})},Yn={id:"doc.command.insert-horizontal-line-bellow",type:s.CommandType.COMMAND,handler:o=>{const t=o.get(s.ICommandService),e=ut(o);return e?t.syncExecuteCommand(pt.id,{insertRange:{startOffset:e.startIndex+1,endOffset:e.startIndex+1}}):!1}},qn={id:"doc.command.select-all",type:s.CommandType.COMMAND,handler:async o=>{var h;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),i=e.getDocRanges(),a=(h=i.find(g=>g.isActive))!=null?h:i[0];if(n==null||a==null)return!1;const{segmentId:r}=a,c=n.getUnitId(),l=n.getSelfOrHeaderFooterModel(r).getSnapshot().body;if(l==null)return!1;const{tables:A=[],dataStream:d}=l;if(d===`\r
`)return!0;const u=[];let m=0;for(const g of A){const{startIndex:p,endIndex:f}=g;m!==p&&u.push({startOffset:m,endOffset:p-1,rangeType:s.DOC_RANGE_TYPE.TEXT}),u.push({startOffset:p+3,endOffset:f-5,rangeType:s.DOC_RANGE_TYPE.RECT}),m=f}return m!==l.dataStream.length-2&&u.push({startOffset:m,endOffset:l.dataStream.length-2,rangeType:s.DOC_RANGE_TYPE.TEXT}),e.replaceDocRanges(u,{unitId:c,subUnitId:c},!1),!0}};class ft extends s.RxDisposable{constructor(e){super();B(this,"_previousActiveRange",null);B(this,"_undoMutationParamsCache",[]);B(this,"_redoMutationParamsCache",[]);this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:n=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:e}=this._undoMutationParamsCache[0],n={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}const Jn={id:"doc.command.ime-input",type:s.CommandType.COMMAND,handler:async(o,t)=>{var Q,j,X;const{unitId:e,newText:n,oldTextLen:i,isCompositionEnd:a,isCompositionStart:r}=t,c=o.get(s.ICommandService),l=o.get(_.IRenderManagerService),A=o.get(s.IUniverInstanceService),d=o.get(ve),u=(Q=l.getRenderById(e))==null?void 0:Q.with(ft),m=A.getUnit(e,s.UniverInstanceType.UNIVER_DOC);if(m==null||u==null)return!1;const h=u.getActiveRange();if(h==null)return!1;const{style:g,segmentId:p}=h,f=m.getSelfOrHeaderFooterModel(p).getBody();if(f==null)return!1;Object.assign(h,h);const{startOffset:E,endOffset:C}=h,T=n.length,R=[{startOffset:E+T,endOffset:E+T,collapsed:!0,style:g}],v={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:R}},O=d.getDefaultStyle(),M=d.getStyleCache(),b=Dn((j=f.customRanges)!=null?j:[],E+i,s.SHEET_EDITOR_UNITS.includes(e)),N=Ut(f,r?C:E+i,O,M,s.SHEET_EDITOR_UNITS.includes(e)),x=Bn((X=f.customDecorations)!=null?X:[],E+i),U=new s.TextX,F=s.JSONX.getInstance();if(!h.collapsed&&r){const k=s.BuildTextUtils.selection.delete([h],f,0,null,!1);U.push(...k),v.params.textRanges=[{startOffset:E+T,endOffset:E+T,collapsed:!0}]}else U.push({t:s.TextXActionType.RETAIN,len:E});i>0&&U.push({t:s.TextXActionType.DELETE,len:i}),U.push({t:s.TextXActionType.INSERT,body:{dataStream:n,textRuns:N?[{...N,st:0,ed:n.length}]:[],customRanges:b?[{...b,startIndex:0,endIndex:n.length-1}]:[],customDecorations:x.map(k=>({...k,startIndex:0,endIndex:n.length-1}))},len:n.length});const V=Z(m,p);v.params.actions=F.editOp(U.serialize(),V),v.params.noHistory=!a,v.params.isCompositionEnd=a;const H=c.syncExecuteCommand(v.id,v.params);return u.pushUndoRedoMutationParams(H,v.params),!!H}};function Ae(o,t,e){return e.executeCommand(ye.id,{preCommandId:o,...t!=null?t:{}})}const Ri="doc.command.set-inline-format-bold",Be={id:Ri,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ri,t,e)}},Mi="doc.command.set-inline-format-italic",_e={id:Mi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Mi,t,e)}},xi="doc.command.set-inline-format-underline",Ne={id:xi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(xi,t,e)}},Di="doc.command.set-inline-format-strikethrough",Pe={id:Di,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Di,t,e)}},Bi="doc.command.set-inline-format-subscript",Ee={id:Bi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Bi,t,e)}},_i="doc.command.set-inline-format-superscript",we={id:_i,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(_i,t,e)}},Ni="doc.command.set-inline-format-fontsize",he={id:Ni,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ni,t,e)}},Pi="doc.command.set-inline-format-font-family",Ue={id:Pi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Pi,t,e)}},wi="doc.command.set-inline-format-text-color",Ce={id:wi,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(wi,t,e)}},Ui="doc.command.set-inline-format-text-background-color",Te={id:Ui,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Ui,t,e)}},Li="doc.command.reset-inline-format-text-background-color",Ze={id:Li,type:s.CommandType.COMMAND,handler:async(o,t)=>{const e=o.get(s.ICommandService);return Ae(Li,t,e)}},Zn={[Be.id]:"bl",[_e.id]:"it",[Ne.id]:"ul",[Pe.id]:"st",[he.id]:"fs",[Ue.id]:"ff",[Ce.id]:"cl",[Te.id]:"bg",[Ze.id]:"bg",[Ee.id]:"va",[we.id]:"va"},ye={id:"doc.command.set-inline-format",type:s.CommandType.COMMAND,handler:async(o,t)=>{var R;const{value:e,preCommandId:n}=t,i=o.get(s.ICommandService),a=o.get(D.DocSelectionManagerService),r=o.get(s.IUniverInstanceService),c=o.get(ve),l=a.getDocRanges(),A=(R=l.find(v=>v.isActive))!=null?R:l[0];if(l.length===0)return!1;const{segmentId:d}=l[0],u=r.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(u==null)return!1;const m=u.getSelfOrHeaderFooterModel(d).getBody();if(m==null)return!1;const h=u.getUnitId();let g;switch(n){case Be.id:case _e.id:case Ne.id:case Pe.id:case Ee.id:case we.id:{const v=c.getDefaultStyle(),O=Fi(m,A,v);g=Za(O,n);break}case he.id:case Ue.id:{g=e;break}case Ce.id:case Te.id:{g={rgb:e};break}case Ze.id:{g={rgb:null};break}default:throw new Error(`Unknown command: ${n} in handleInlineFormat`)}const p={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:l}},f=new s.TextX,S=s.JSONX.getInstance(),E=new s.MemoryCursor;E.reset();for(const v of l){let{startOffset:O,endOffset:M,rangeType:b}=v;if(O==null||M==null)continue;if(b===s.DOC_RANGE_TYPE.RECT&&(O=O-1),O===M){const U=c.getStyleCache(),F=Zn[n];c.setStyleCache({[F]:(U==null?void 0:U[F])!==void 0?Qi(U,F,n):g});continue}const N={dataStream:"",textRuns:[{st:0,ed:M-O,ts:{[Zn[n]]:g}}]},x=O-E.cursor;x!==0&&f.push({t:s.TextXActionType.RETAIN,len:x}),f.push({t:s.TextXActionType.RETAIN,body:N,len:M-O}),E.reset(),E.moveCursor(M)}const C=Z(u,d);return p.params.actions=S.editOp(f.serialize(),C),!!i.syncExecuteCommand(p.id,p.params)}};function Ja(o){return o!==null&&typeof o=="object"}function Qi(o,t,e){if(/bl|it/.test(t))return(o==null?void 0:o[t])===s.BooleanNumber.TRUE?s.BooleanNumber.FALSE:s.BooleanNumber.TRUE;if(/ul|st/.test(t))return Ja(o==null?void 0:o[t])&&(o==null?void 0:o[t]).s===s.BooleanNumber.TRUE?{s:s.BooleanNumber.FALSE}:{s:s.BooleanNumber.TRUE};if(/va/.test(t))return e===Ee.id?(o==null?void 0:o[t])===s.BaselineOffset.SUBSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUBSCRIPT:(o==null?void 0:o[t])===s.BaselineOffset.SUPERSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUPERSCRIPT}function Fi(o,t,e){var d,u,m,h,g,p,f,S,E,C,T,R,v,O;const{startOffset:n,endOffset:i,collapsed:a}=t;if(a){const M=(d=o.textRuns)!=null?d:[];let b=null;for(let N=M.length-1;N>=0;N--){const x=M[N];if(x.st<n&&n<=x.ed){b=x;break}}return b!=null&&b.ts?{...e,...b.ts}:e}const{textRuns:r=[]}=s.getBodySlice(o,n,i),c=s.Tools.deepClone(e),l=r.map(M=>{var b;return(b=M==null?void 0:M.ts)==null?void 0:b.fs}).filter(Boolean);c.fs=c.fs?Math.max(c.fs,...l):l.length?Math.max(...l):void 0,c.fs=!c.fs||Number.isNaN(c.fs)?void 0:c.fs,c.ff=(h=(m=(u=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.ff)!=null}))==null?void 0:u.ts)==null?void 0:m.ff)!=null?h:c.ff,c.it=r.length&&r.every(M=>{var b;return((b=M.ts)==null?void 0:b.it)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.bl=r.length&&r.every(M=>{var b;return((b=M.ts)==null?void 0:b.bl)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.ul=r.length&&r.every(M=>{var b,N;return((N=(b=M.ts)==null?void 0:b.ul)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(g=r[0].ts)==null?void 0:g.ul:c.ul,c.st=r.length&&r.every(M=>{var b,N;return((N=(b=M.ts)==null?void 0:b.st)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(p=r[0].ts)==null?void 0:p.st:c.st,c.bg=(E=(S=(f=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.bg)!=null}))==null?void 0:f.ts)==null?void 0:S.bg)!=null?E:c.bg,c.cl=(R=(T=(C=r.find(M=>{var b;return((b=M.ts)==null?void 0:b.cl)!=null}))==null?void 0:C.ts)==null?void 0:T.cl)!=null?R:c.cl;const A=r.filter(M=>{var b;return((b=M==null?void 0:M.ts)==null?void 0:b.va)!=null});if(A.length>0&&A.length===r.length){const M=(v=A[0].ts)==null?void 0:v.va;let b=!0;for(let N=1;N<A.length;N++)if(((O=A[N].ts)==null?void 0:O.va)!==M){b=!1;break}b&&(c.va=M)}return c}function Za(o,t){const e=Zn[t];return Qi(o,e,t)}const $n={id:"doc.command-replace-snapshot",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,snapshot:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot();if(d==null||u==null)return!1;const{body:m,tableSource:h,footers:g,headers:p,lists:f,drawings:S,drawingsOrder:E,documentStyle:C}=s.Tools.deepClone(n),{body:T,tableSource:R,footers:v,headers:O,lists:M,drawings:b,drawingsOrder:N,documentStyle:x}=u;if(m==null||T==null)return!1;if(s.Tools.diffValue(m,T)&&i)return A.replaceDocRanges(i,{unitId:e,subUnitId:e},!1),!0;const U={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:i}};r&&(U.params.options=r);const F=[],V=s.JSONX.getInstance();if(!s.Tools.diffValue(x,C)){const Q=V.replaceOp(["documentStyle"],x,C);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(m,T)){const Q=V.replaceOp(["body"],T,m);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(h,R)){const Q=V.replaceOp(["tableSource"],R,h);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(g,v)){const Q=V.replaceOp(["footers"],v,g);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(p,O)){const Q=V.replaceOp(["headers"],O,p);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(f,M)){const Q=V.replaceOp(["lists"],M,f);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(S,b)){const Q=V.replaceOp(["drawings"],b,S);Q!=null&&F.push(Q)}if(!s.Tools.diffValue(E,N)){const Q=V.replaceOp(["drawingsOrder"],N,E);Q!=null&&F.push(Q)}return U.params.actions=F.reduce((Q,j)=>s.JSONX.compose(Q,j),null),!!l.syncExecuteCommand(U.id,U.params)}},Hi={id:"doc.command-replace-content",type:s.CommandType.COMMAND,handler:async(o,t)=>{const{unitId:e,body:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=Vi(e,a,d,u,n);return m.params.textRanges=i,r&&(m.params.options=r),m.params.actions==null&&i?(A.replaceDocRanges(i,{unitId:e,subUnitId:e},!1),!0):!!l.syncExecuteCommand(m.id,m.params)}},ki={id:"doc.command-cover-content",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,segmentId:i="",textRanges:a}=t,r=o.get(s.IUniverInstanceService),c=o.get(s.ICommandService),l=o.get(s.IUndoRedoService),A=r.getUniverDocInstance(e),d=A==null?void 0:A.getSnapshot().body;if(A==null||d==null)return!1;const u=Vi(e,i,A,d,n);return u.params.noNeedSetTextRange=!0,u.params.noHistory=!0,u.params.textRanges=a,c.syncExecuteCommand(u.id,u.params),l.clearUndoRedo(e),!0}};function $a(o,t,e,n){const i=new s.TextX,a=s.JSONX.getInstance(),r=(e==null?void 0:e.dataStream.length)-2;r>0&&i.push({t:s.TextXActionType.DELETE,len:r}),n.dataStream.length>0&&i.push({t:s.TextXActionType.INSERT,body:n,len:n.dataStream.length});const c=Z(t,o);return a.editOp(i.serialize(),c)}function Vi(o,t,e,n,i){const a={id:D.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:[]}},r=$a(t,e,n,i);return a.params.actions=r,a}const eo={id:"doc.command.replace-selection",type:s.CommandType.COMMAND,handler(o,t){var g;if(!t)return!1;const e=o.get(s.ICommandService),{unitId:n,body:i,textRanges:a}=t,c=o.get(s.IUniverInstanceService).getUnit(n),l=o.get(D.DocSelectionManagerService);if(!c)return!1;const A=c.getBody(),d=(g=t.selection)!=null?g:l.getActiveTextRange();if(!d||!A)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:n,actions:[],textRanges:a,debounce:!0}},m=new s.TextX,h=s.JSONX.getInstance();return m.push(...s.BuildTextUtils.selection.delete([d],A,0,i)),u.params.actions=h.editOp(m.serialize()),e.syncExecuteCommand(u.id,u.params)}},Wi={id:"doc.command.replace-text-runs",type:s.CommandType.COMMAND,handler:(o,t)=>{const{unitId:e,body:n,textRanges:i,segmentId:a="",options:r}=t,c=o.get(s.IUniverInstanceService),l=o.get(s.ICommandService),A=o.get(s.ThemeService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=s.BuildTextUtils.selection.replaceTextRuns({doc:d,body:n,selection:{startOffset:0,endOffset:u.dataStream.length-2,collapsed:!1},themeService:A});if(!m)return!1;const h={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:i,noHistory:!0}},g=s.JSONX.getInstance(),p=Z(d,a);return h.params.actions=g.editOp(m.serialize(),p),h.params.textRanges=i,r&&(h.params.options=r),!!l.syncExecuteCommand(h.id,h.params)}},Gi={id:"doc.command.insert-custom-range",type:s.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(s.ICommandService),{unitId:n,rangeId:i=s.generateRandomId(),textRanges:a,properties:r,text:c,wholeEntity:l}=t,A={unitId:n,textRanges:a,body:{dataStream:c,customRanges:[{startIndex:0,endIndex:c.length-1,rangeId:i,rangeType:s.CustomRangeType.CUSTOM,properties:r,wholeEntity:l}]}};return e.syncExecuteCommand(eo.id,A)}},$e={id:"doc.command.list-operation",type:s.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,O,M,b;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=t.listType,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(R=(T=t.docRange)!=null?T:e.getDocRanges())!=null?R:[];if(r==null||c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(O=(v=A.getBody())==null?void 0:v.paragraphs)!=null?O:[],u=(b=(M=A.getBody())==null?void 0:M.dataStream)!=null?b:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c,isEditing:!1}};new s.MemoryCursor().reset();const f=s.BuildTextUtils.paragraph.bullet.switch({paragraphs:m,listType:a,document:r,segmentId:l}),S=s.JSONX.getInstance(),E=Z(r,l);return g.params.actions=S.editOp(f.serialize(),E),!!i.syncExecuteCommand(g.id,g.params)}},St={id:"doc.command.change-list-type",type:s.CommandType.COMMAND,handler:(o,t)=>{var C,T,R,v,O;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{listType:a}=t,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(C=t.docRange)!=null?C:e.getDocRanges();if(r==null||c==null||!c.length)return!1;const{segmentId:l}=c[0],A=r.getSelfOrHeaderFooterModel(l),d=(R=(T=A.getBody())==null?void 0:T.paragraphs)!=null?R:[],u=(O=(v=A.getBody())==null?void 0:v.dataStream)!=null?O:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g=s.BuildTextUtils.paragraph.bullet.set({paragraphs:m,listType:a,segmentId:l,document:r});if(!g)return!1;const p=s.JSONX.getInstance(),f={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c,isEditing:!1}},S=Z(r,l);return f.params.actions=p.editOp(g.serialize(),S),!!i.syncExecuteCommand(f.id,f.params)}};var It=(o=>(o[o.increase=1]="increase",o[o.decrease=-1]="decrease",o))(It||{});const Yt={id:"doc.command.change-list-nesting-level",type:s.CommandType.COMMAND,handler:(o,t)=>{var T,R,v,O,M;if(!t)return!1;const{type:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null)return!1;const{segmentId:l}=c,A=(T=n.getDocRanges())!=null?T:[],d=r.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"";if(!u.length)return!1;const h=s.BuildTextUtils.range.getParagraphsInRange(c,u,m),g=r.getUnitId(),p=s.JSONX.getInstance(),f=s.BuildTextUtils.paragraph.bullet.changeNestLevel({paragraphs:h,type:e,segmentId:l,document:r}),S={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:A,isEditing:!1}},E=Z(r,l);return S.params.actions=p.editOp(f.serialize(),E),!!a.syncExecuteCommand(S.id,S.params)}},et={id:"doc.command.bullet-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.BULLET_LIST,docRange:t==null?void 0:t.docRange})}},vt={id:"doc.command.check-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.CHECK_LIST,docRange:t==null?void 0:t.docRange})}},to={id:"doc.command.toggle-check-list",type:s.CommandType.COMMAND,handler:(o,t)=>{var p;if(!t)return!1;const e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),{index:i,segmentId:a,textRanges:r}=t,c=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(c==null||((p=c.getSelfOrHeaderFooterModel(a).getBody())==null?void 0:p.paragraphs)==null)return!1;const A=c.getUnitId(),d={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r!=null?r:[],segmentId:a,isEditing:!1}},u=s.BuildTextUtils.paragraph.bullet.toggleChecklist({document:c,paragraphIndex:i,segmentId:a});if(!u)return!1;const m=s.JSONX.getInstance(),h=Z(c,a);return d.params.actions=m.editOp(u.serialize(),h),!!n.syncExecuteCommand(d.id,d.params)}},tt={id:"doc.command.order-list",type:s.CommandType.COMMAND,handler:(o,t)=>{const e=o.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(St.id,{listType:t.value}):e.syncExecuteCommand($e.id,{listType:s.PresetListType.ORDER_LIST})}},no={id:"doc.command.quick-list",type:s.CommandType.COMMAND,handler(o,t){var x,U,F;if(!t)return!1;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getActiveTextRange();if(a==null||r==null)return!1;const{segmentId:c,startOffset:l}=r,{listType:A,paragraph:d}=t,{paragraphStart:u,paragraphEnd:m}=d,h=new s.TextX,g=s.JSONX.getInstance(),{paragraphStyle:p={}}=d,S=(s.PRESET_LIST_TYPE[A].nestingLevel[0].paragraphProperties||{}).textStyle;let C=s.generateRandomId(6);const T=(U=(x=a.getBody())==null?void 0:x.paragraphs)!=null?U:[],R=T.findIndex(V=>V.startIndex===d.startIndex),v=T[R-1],O=T[R+1];v&&v.bullet&&v.bullet.listType.indexOf(A)===0?C=v.bullet.listId:O&&O.bullet&&O.bullet.listType.indexOf(A)===0&&(C=O.bullet.listId);const M={id:D.RichTextEditingMutation.id,params:{unitId:a.getUnitId(),actions:[],textRanges:[{startOffset:u,endOffset:u,collapsed:!0}],isEditing:!1}};h.push({t:s.TextXActionType.RETAIN,len:u}),h.push({t:s.TextXActionType.DELETE,len:l-u}),m>l&&h.push({t:s.TextXActionType.RETAIN,len:m-l}),h.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...p,textStyle:{...p.textStyle,...S},indentFirstLine:void 0},bullet:{...(F=d.bullet)!=null?F:{nestingLevel:0,textStyle:{fs:20}},listType:A,listId:C}}]}});const b=Z(a,c);return M.params.actions=g.editOp(h.serialize(),b),!!i.syncExecuteCommand(M.id,M.params)}};function oo(o,t){var d,u;const e=o.get(s.ICommandService),n=ut(o);if(!n)return!1;const i=o.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!i)return!1;const a=s.BuildTextUtils.selection.replace({doc:i,selection:{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0},body:{dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:{...n.paragraphStyle},bullet:{listType:t,listId:((d=n.bullet)==null?void 0:d.listType)===t?n.bullet.listId:s.generateRandomId(6),nestingLevel:((u=n.bullet)==null?void 0:u.listType)===t?n.bullet.nestingLevel:0}}]}});if(!a)return!1;const r={id:D.RichTextEditingMutation.id,params:{unitId:i.getUnitId(),actions:[],textRanges:[{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0}],isEditing:!1}},c=s.JSONX.getInstance(),l=Z(i);return r.params.actions=c.editOp(a.serialize(),l),!!e.syncExecuteCommand(r.id,r.params)}const io={id:"doc.command.insert-bullet-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.BULLET_LIST)},so={id:"doc.command.insert-order-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.ORDER_LIST)},ao={id:"doc.command.insert-check-list-bellow",type:s.CommandType.COMMAND,handler:o=>oo(o,s.PresetListType.CHECK_LIST)},ge={id:"doc.command.align-action",type:s.CommandType.COMMAND,handler:(o,t)=>{var R,v,O,M;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),{alignType:a}=t,r=n.getCurrentUniverDocInstance();if(r==null)return!1;const c=e.getDocRanges();if(c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(v=(R=A.getBody())==null?void 0:R.paragraphs)!=null?v:[],u=(M=(O=A.getBody())==null?void 0:O.dataStream)!=null?M:"";if(d==null)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),h=r.getUnitId(),g=m.every(b=>{var N;return((N=b.paragraphStyle)==null?void 0:N.horizontalAlign)===a}),p={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:c}},f=new s.MemoryCursor;f.reset();const S=new s.TextX,E=s.JSONX.getInstance();for(const b of m){const{startIndex:N}=b;S.push({t:s.TextXActionType.RETAIN,len:N-f.cursor});const x={...b.paragraphStyle,horizontalAlign:g?s.HorizontalAlign.UNSPECIFIED:a};S.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...b,paragraphStyle:x,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(N+1)}const C=Z(r,l);return p.params.actions=E.editOp(S.serialize(),C),!!i.syncExecuteCommand(p.id,p.params)}},Et={id:"doc.command.align-left",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.LEFT})},Ct={id:"doc.command.align-center",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.CENTER})},Tt={id:"doc.command.align-right",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.RIGHT})},yt={id:"doc.command.align-justify",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ge.id,{alignType:s.HorizontalAlign.JUSTIFIED})},er=(o,t)=>{const n=o.get(s.IUniverInstanceService).getUnit(t.unitId,s.UniverInstanceType.UNIVER_DOC);return n==null||n.setZoomRatio(t.zoomRatio),{...t}},ue={id:"doc.operation.set-zoom-ratio",type:s.CommandType.OPERATION,handler:(o,t)=>{const n=o.get(s.IUniverInstanceService).getUnit(t.unitId,s.UniverInstanceType.UNIVER_DOC);return n?(n.setZoomRatio(t.zoomRatio),!0):!1}},bt={type:s.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(o,t)=>{var u,m,h;const e=o.get(s.ICommandService),n=o.get(s.IUndoRedoService),i=o.get(s.IUniverInstanceService);let a=(u=i.getCurrentUniverDocInstance())==null?void 0:u.getUnitId();if(!a)return!1;let r=1;if(t&&(a=(m=t.documentId)!=null?m:a,r=(h=t.zoomRatio)!=null?h:r),!i.getUniverDocInstance(a))return!1;const l={zoomRatio:r,unitId:a},A=er(o,l);return e.syncExecuteCommand(ue.id,l)?(n.pushUndoRedo({unitID:a,undoMutations:[{id:ue.id,params:A}],redoMutations:[{id:ue.id,params:l}]}),!0):!1}},ce={id:"doc.command.set-paragraph-named-style",type:s.CommandType.COMMAND,handler(o,t){var g;if(!t)return!1;const n=o.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const i=n.getUnitId(),a=o.get(D.DocSelectionManagerService),r=(g=t.textRanges)!=null?g:a.getTextRanges({unitId:i,subUnitId:i});if(!(r!=null&&r.length))return!1;const c=r[0].segmentId,l=s.BuildTextUtils.paragraph.style.set({document:n.getSelfOrHeaderFooterModel(c),textRanges:r,style:{namedStyleType:t.value,headingId:!t.value||t.value===s.NamedStyleType.NORMAL_TEXT?void 0:s.generateRandomId(6),spaceAbove:void 0,spaceBelow:void 0,lineSpacing:void 0},paragraphTextRun:{}}),A={id:D.RichTextEditingMutation.id,params:{actions:[],textRanges:r,unitId:i,segmentId:c}},d=s.JSONX.getInstance(),u=Z(n,c);return A.params.actions=d.editOp(l.serialize(),u),!!o.get(s.ICommandService).syncExecuteCommand(A.id,A.params)}},Xi={id:"doc.command.quick-heading",type:s.CommandType.COMMAND,handler(o,t){var R,v,O,M;if(!t)return!1;const{value:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null||!c.collapsed)return!1;const{segmentId:l,startOffset:A}=c,d=r.getSelfOrHeaderFooterModel(l),u=(v=(R=d.getBody())==null?void 0:R.paragraphs)!=null?v:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"",h=s.BuildTextUtils.paragraph.util.getParagraphsInRange(c,u,m)[0];if(!h)return!1;const{paragraphStart:g}=h,p=new s.TextX,f=s.JSONX.getInstance(),{paragraphStyle:S={}}=h,E={id:D.RichTextEditingMutation.id,params:{unitId:r.getUnitId(),actions:[],textRanges:[{startOffset:g,endOffset:g,collapsed:!0}],isEditing:!1}};p.push({t:s.TextXActionType.RETAIN,len:g}),s.BuildTextUtils.paragraph.style.set({textRanges:[c],document:r,style:{...S,headingId:s.generateRandomId(6),namedStyleType:e},cursor:A,deleteLen:A-g,textX:p,paragraphTextRun:{}});const C=Z(r,l);return E.params.actions=f.editOp(p.serialize(),C),!!a.syncExecuteCommand(E.id,E.params)}},ro={"#":s.NamedStyleType.HEADING_1,"##":s.NamedStyleType.HEADING_2,"###":s.NamedStyleType.HEADING_3,"####":s.NamedStyleType.HEADING_4,"#####":s.NamedStyleType.HEADING_5},co={id:"doc.command.h1-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_1})},lo={id:"doc.command.h2-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_2})},Ao={id:"doc.command.h3-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_3})},uo={id:"doc.command.h4-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_4})},ho={id:"doc.command.h5-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.HEADING_5})},qt={id:"doc.command.normal-text-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.NORMAL_TEXT})},ji={id:"doc.command.title",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.TITLE})},Ki={id:"doc.command.subtitle-heading",type:s.CommandType.COMMAND,handler:o=>o.get(s.ICommandService).syncExecuteCommand(ce.id,{value:s.NamedStyleType.SUBTITLE})};var Jt=(o=>(o[o.page=0]="page",o[o.section=1]="section",o[o.column=2]="column",o[o.line=3]="line",o[o.divide=4]="divide",o[o.glyph=5]="glyph",o))(Jt||{});const nt={page:0,section:1,column:2,line:3,divide:4,glyph:5};function go(o,t){return o.page>t.page?!1:o.page<t.page?!0:o.section>t.section?!1:o.section<t.section?!0:o.column>t.column?!1:o.column<t.column?!0:o.line>t.line?!1:o.line<t.line?!0:o.divide>t.divide?!1:o.divide<t.divide?!0:o.glyph>t.glyph?!1:(o.glyph<t.glyph,!0)}function mo(o,t){return go(o,t)?{start:o,end:t}:{start:t,end:o}}function po(o){const t=o.length;if(t===0)return;const e=o[0],n=o[t-1],i=o.length===1&&e.collapsed;return{startOffset:e.startOffset,endOffset:n.endOffset,collapsed:i}}function tr(o,t,e,n){let i=n,a=n;for(let r=0;r<o.length;r++){const l=o[r].count;r<t&&(i+=l),r<e&&(a+=l)}return{startOffset:i,endOffset:a}}function fo(o){const{startX:t,startY:e,endX:n,endY:i}=o,a=[];return a.push({x:t,y:e}),a.push({x:n,y:e}),a.push({x:n,y:i}),a.push({x:t,y:i}),a.push({x:t,y:e}),a}class be{constructor(t,e){B(this,"_liquid",new _.Liquid);B(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});B(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],i=[],a=[];if(t==null||e==null)return{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:a};if(!this._isValidPosition(t,e))throw new Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);const{start:c,end:l}=mo(t,e);return this._selectionIterator(c,l,(A,d,u,m,h,g)=>{const{lineHeight:p,asc:f,paddingTop:S,marginTop:E,marginBottom:C}=g,{glyphGroup:T,st:R}=h;if(T.length===0)return;const{x:v,y:O}=this._liquid;let M,b;const N=T[A],x=T[d],U=T[A-1],F=(N==null?void 0:N.left)||0,V=(N==null?void 0:N.width)||0,H=(x==null?void 0:x.left)||0,Q=(x==null?void 0:x.width)||0,j=(N==null?void 0:N.glyphType)===_.GlyphType.LIST,{startOffset:X,endOffset:k}=tr(T,A,d,R),W=c.glyph===A&&u?c.isBack:!0,G=l.glyph===d&&m?l.isBack:!1,K=c===l,Y=W&&U!=null?U:N;if(A===0&&d===T.length-1)M={startX:v+F+(j?V:0),startY:O,endX:v+H+(G?0:Q),endY:O+p-E-C},b={startX:v+F+(j?V:0),startY:O+S+f-Y.bBox.ba,endX:v+H+(G?0:Q),endY:O+S+f+Y.bBox.bd};else{const q=W&&!j;M={startX:v+F+(q?0:V),startY:O,endX:v+H+(G?0:Q),endY:O+p-E-C},b={startX:v+F+(q?0:V),startY:O+S+f-Y.bBox.ba,endX:v+H+(G?0:Q),endY:O+S+f+Y.bBox.bd}}n.push(fo(M)),i.push(fo(b)),a.push({startOffset:W?X:X+N.count,endOffset:G?k:k+x.count,collapsed:K})}),{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:a}}_isValidPosition(t,e){const{segmentPage:n,pageType:i}=t,{segmentPage:a,pageType:r}=e;return i!==r?!1:i===_.DocumentSkeletonPageType.HEADER||i===_.DocumentSkeletonPageType.FOOTER?n===a:!0}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(t=0,e,n,i){i===e?this._currentStartState[t]=1:this._currentStartState[t]=0,i===n?this._currentEndState[t]=2:this._currentEndState[t]=0}_checkPreviousNodePositionState(t,e=!0){let n=t,i;for(;n>=0;){const a=Jt[n];let r;if(e?r=this._currentStartState[a]:r=this._currentEndState[a],r===void 0)return;if(i===void 0&&(i=r),r!==i)return 0;n--}return i}_getSelectionRuler(t,e,n,i,a){let r=0,c=i;const l=Jt[t],A=Jt[t+1];if(A===null||l===null)return{start_next:r,end_next:c};const d=e[l],u=n[l];this._setNodePositionState(l,d,u,a);const m=this._checkPreviousNodePositionState(t),h=this._checkPreviousNodePositionState(t,!1);return m===1&&(r=e[A]),h===2&&(c=n[A]),{start_next:r,end_next:c}}_selectionIterator(t,e,n){var T,R;const i=this._docSkeleton;if(!i)return[];const{pageType:a,path:r}=t;this._liquid.reset();const c=i.getSkeletonData();if(c==null)return[];const{pages:l,skeHeaders:A,skeFooters:d}=c,{page:u,segmentPage:m}=t,{page:h,segmentPage:g}=e;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:p,pageMarginLeft:f,pageMarginTop:S}=this._documentOffsetConfig,E=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?u:m;for(let v=0;v<E;v++){const O=l[v];this._liquid.translatePage(O,p,f,S)}const C=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?h:g;for(let v=E;v<=C;v++){const O=l[v],{headerId:M,footerId:b,pageWidth:N}=O;let x=O;if(a===_.DocumentSkeletonPageType.HEADER?x=(T=A.get(M))==null?void 0:T.get(N):a===_.DocumentSkeletonPageType.FOOTER?x=(R=d.get(b))==null?void 0:R.get(N):a===_.DocumentSkeletonPageType.CELL&&(x=_.getPageFromPath(c,r)),x==null){this._liquid.translatePage(O,p,f,S);continue}const U=x.sections,{start_next:F,end_next:V}=this._getSelectionRuler(nt.page,t,e,U.length-1,a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?v:0);switch(this._liquid.translateSave(),a){case _.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...x,marginLeft:O.marginLeft});break;case _.DocumentSkeletonPageType.FOOTER:{const H=O.pageHeight-x.height-x.marginBottom;this._liquid.translate(O.marginLeft,H);break}case _.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(O);const H=x.parent,Q=H.parent,{left:j}=x,{top:X,left:k}=Q,{top:W}=H;this._liquid.translate(k+j,X+W),this._liquid.translatePagePadding(x);break}default:this._liquid.translatePagePadding(O);break}for(let H=F;H<=V;H++){const Q=U[H],j=Q.columns,{start_next:X,end_next:k}=this._getSelectionRuler(nt.section,t,e,j.length-1,H);this._liquid.translateSection(Q);for(let W=X;W<=k;W++){const G=j[W],K=G.lines,{start_next:Y,end_next:q}=this._getSelectionRuler(nt.column,t,e,K.length-1,W);this._liquid.translateColumn(G);for(let z=Y;z<=q;z++){const $=K[z],{divides:ie}=$,{start_next:fe,end_next:He}=this._getSelectionRuler(nt.line,t,e,ie.length-1,z);this._liquid.translateSave(),this._liquid.translateLine($,!0,!1);for(let Se=fe;Se<=He;Se++){const ti=ie[Se];this._liquid.translateSave(),this._liquid.translateDivide(ti);const{glyphGroup:bA}=ti,{start_next:OA,end_next:RA}=this._getSelectionRuler(nt.divide,t,e,bA.length-1,Se);let ua=!1,ha=!1;v===E&&H===F&&W===X&&z===Y&&Se===fe&&(ua=!0),v===C&&H===V&&W===k&&z===q&&Se===He&&(ha=!0),n&&n(OA,RA,ua,ha,ti,$,G,Q,x),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(O,p,f,S)}}}function zi(o,t){const{path:e}=o,{path:n}=t;if(e.length!==n.length||e.indexOf("cells")===-1)return!1;const i=e.indexOf("skeTables")+1,a=e.indexOf("rows")+1,r=e.indexOf("cells")+1,{tableId:c,sliceIndex:l}=_.getTableIdAndSliceIndex(e[i]),{tableId:A,sliceIndex:d}=_.getTableIdAndSliceIndex(n[i]);if(c!==A)return!1;const u=e[a],m=n[a],h=e[r],g=n[r];return!(u===m&&h===g&&l===d)}function So(o,t){const{path:e}=o,{path:n}=t;return e.indexOf("cells")===-1||n.indexOf("cells")===-1||e.length!==n.length?!1:s.Tools.diffValue(e,n)}function Yi(o,t,e){var h,g,p,f,S,E,C,T;const{path:n}=t,{path:i}=e;if(n.indexOf("cells")===-1||i.indexOf("cells")===-1)return!1;const a=o.findGlyphByPosition(t),r=o.findGlyphByPosition(e),c=(f=(p=(g=(h=a==null?void 0:a.parent)==null?void 0:h.parent)==null?void 0:g.parent)==null?void 0:p.parent)==null?void 0:f.parent,l=(T=(C=(E=(S=r==null?void 0:r.parent)==null?void 0:S.parent)==null?void 0:E.parent)==null?void 0:C.parent)==null?void 0:T.parent;if(c==null||l==null)return!1;const A=c.parent,d=l.parent,u=A.cells.indexOf(c),m=d.cells.indexOf(l);return u===m&&A.index===d.index}function Io(o,t){if(So(o,t))return go(o,t);const{path:e}=o,{path:n}=t,i=e[e.length-5],a=n[n.length-5];if(i!==a&&typeof i=="string"&&typeof a=="string"){const d=i.split("#-#")[1],u=a.split("#-#")[1];return+d<+u}const r=e[e.length-3],c=n[n.length-3],l=e[e.length-1],A=n[n.length-1];return r<c?!0:r>c?!1:l<=A}function ot(o){return o.sections[0].columns[0].lines.length===0}function nr(o,t,e){let n=t,i=e,a=o[n],r=o[i];for(;n<i&&(ot(a)||ot(r));)ot(a)?(n++,a=o[n]):ot(r)&&(i--,r=o[i]);if(!ot(a)&&!ot(r))return[a,r]}class vo{constructor(t,e){B(this,"_liquid",new _.Liquid);this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],a=this._docSkeleton.getSkeletonData();if(a==null)return;const{pages:r}=a,{segmentPage:c,page:l,pageType:A}=t,d=this._getTableRectRangeInfo(t,e);if(d==null)return;const{tableId:u,startRowIndex:m,startColumnIndex:h,endRowIndex:g,endColumnIndex:p}=d;this._liquid.reset();const{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:E}=this._documentOffsetConfig,C=A===_.DocumentSkeletonPageType.BODY||A===_.DocumentSkeletonPageType.CELL?l:c;for(let T=0;T<C;T++){const R=r[T];this._liquid.translatePage(R,f,S,E)}for(let T=C;T<r.length;T++){const R=r[T];this._liquid.translatePagePadding(R);const{skeTables:v}=R;let O=null;for(const[x,U]of v.entries())x.startsWith(u)&&(O=U);if(O==null){this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E);continue}this._liquid.translateSave(),this._liquid.translate(0,O.top);const{x:M,y:b}=this._liquid,{left:N}=O;for(const x of O.rows)if(x.index>=m&&x.index<=g){const U=nr(x.cells,h,p);if(U==null)continue;const[F,V]=U,H={startX:M+F.left+N,startY:b+x.top,endX:M+V.left+V.pageWidth+N,endY:b+x.top+x.height};n.push(fo(H))}this._liquid.translateRestore(),this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E)}return{pointGroup:n,startRow:m,startColumn:h,endRow:g,endColumn:p,tableId:u}}getNodePositionGroup(t,e){const n=[],i=this._docSkeleton.findCharIndexByPosition(t),a=this._docSkeleton.findCharIndexByPosition(e);if(i==null||a==null)return;const r=i<a,c=this._getTableRectRangeInfo(t,e);if(c==null)return;const{tableId:l,startRowIndex:A,startColumnIndex:d,endRowIndex:u,endColumnIndex:m}=c,h=this._docSkeleton.getViewModel().findTableNodeById(l);if(h==null)return;const g=h.children[0].children.length;if(d===0&&m===g-1){const f=h.children[A].children[d],S=this._docSkeleton.findNodePositionByCharIndex(f.startIndex+1),E=h.children[u].children[m],C=this._docSkeleton.findNodePositionByCharIndex(E.endIndex-2);if(S==null||C==null)return;n.push({anchor:r?S:C,focus:r?C:S})}else for(let f=A;f<=u;f++){const S=h.children[f],E=S.children[d],C=S.children[m],T=this._docSkeleton.findNodePositionByCharIndex(E.startIndex+1),R=this._docSkeleton.findNodePositionByCharIndex(C.endIndex-2);if(T==null||R==null)return;n.push({anchor:r?T:R,focus:r?R:T})}return n}_getTableRectRangeInfo(t,e){const i=this._docSkeleton.getSkeletonData();if(i==null)return;const{pages:a}=i,{path:r}=t,{path:c}=e,l=_.getPageFromPath(i,r),A=_.getPageFromPath(i,c);if(l==null||A==null)return;const d=l.segmentId,u=l.parent.index,m=l.parent.cells.indexOf(l),h=(A==null?void 0:A.parent).index,g=(A==null?void 0:A.parent).cells.indexOf(A),p=Math.min(u,h),f=Math.max(u,h),S=Math.min(m,g),E=Math.max(m,g);return{pages:a,tableId:d,startRowIndex:p,startColumnIndex:S,endRowIndex:f,endColumnIndex:E}}}const or="__TestSelectionRange__",ir="__TestSelectionAnchor__",qi=6,Eo=500,sr=500,Zt=3;function Ot(o){const t=o[0],e=t[0],n=t[2],{x:i,y:a}=e,{x:r,y:c}=n;return{left:i,top:a,width:r-i,height:c-a}}function $t(o){return o.map(t=>{let e=1/0,n=-1/0,i=1/0,a=-1/0;return t.forEach(r=>{e=Math.min(r.x,e),n=Math.max(r.x,n),a=Math.max(r.y,a),i=Math.min(r.y,i)}),{left:e,right:n,top:i,bottom:a}})}class We{constructor(t,e,n,i,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.TEXT);B(this,"_current",!1);B(this,"_rangeShape");B(this,"_anchorShape");B(this,"_cursorList",[]);B(this,"_anchorBlinkTimer",null);this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},Eo),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},Eo))},sr+Eo)}get startOffset(){var i;const{startOffset:t}=(i=po(this._cursorList))!=null?i:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(n,t)}get endOffset(){var i;const{endOffset:t}=(i=po(this._cursorList))!=null?i:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(t,n)}get collapsed(){const{startOffset:t,endOffset:e}=this;return t!=null&&t===e}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:t}=mo(this.anchorNodePosition,this.focusNodePosition);return t}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:t}=mo(this.anchorNodePosition,this.focusNodePosition);return t}get direction(){const{collapsed:t,anchorNodePosition:e,focusNodePosition:n}=this;return t||e==null||n==null?s.RANGE_DIRECTION.NONE:go(e,n)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(this._isEmpty())return;const n=this._document.getOffsetConfig(),{docsLeft:i,docsTop:a}=n,r=new be(n,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup:d,cursorList:u}=r.getRangePointData(t,t);if(this._setCursorList(u),d.length===0)return;const m=Ot(d);return{...m,left:m.left+i,top:m.top+a}}const{borderBoxPointGroup:c,cursorList:l}=r.getRangePointData(t,e);if(this._setCursorList(l),c.length===0)return;const A=Ot(c);return{...A,left:A.left+i,top:A.top+a}}getAnchor(){return this._anchorShape}activeStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.strokeActive)||_.getColor(s.COLORS.black,1)})}deactivateStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.stroke)||_.getColor(s.COLORS.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t,e;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null,(e=this._anchorShape)==null||e.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(t){const{startOffset:e,endOffset:n}=this,{startOffset:i,endOffset:a}=t;return e==null||n==null||i==null||a==null?!1:e<=a&&n>=i}refresh(){var u,m;const{_document:t,_docSkeleton:e}=this,n=this.anchorNodePosition,i=this.focusNodePosition;if((u=this._anchorShape)==null||u.hide(),(m=this._rangeShape)==null||m.hide(),this._isEmpty())return;const a=t.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,l=new be(a,e);if(this._isCollapsed()){const{contentBoxPointGroup:h,cursorList:g}=l.getRangePointData(n,n);if(this._setCursorList(g),h.length>0){const p=e.findGlyphByPosition(n);this._createOrUpdateAnchor(h,r,c,p)}return}const{borderBoxPointGroup:A,cursorList:d}=l.getRangePointData(n,i);this._setCursorList(d),A.length>0&&this._createOrUpdateRange(A,r,c)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(t!=null&&e==null)return!0;if(t==null||e==null)return!1;const n=Object.keys(nt);for(const i of n){const a=t[i],r=e[i];if(a!==r)return!1}return t.isBack===e.isBack}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const i=.3,a=new _.RegularPolygon(or+s.generateRandomId(qi),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,i),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Zt)}_createOrUpdateAnchor(t,e,n,i){var p,f,S;const a=Ot(t),{left:r}=a;let{top:c,height:l}=a;const A=14;l<A&&(c-=A-l,l=A);const d=12;let u=r+e;const m=c+n,h=((p=i==null?void 0:i.ts)==null?void 0:p.it)===s.BooleanNumber.TRUE;if(h&&(u+=l*Math.tan(d*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:u,top:m,height:l}),this._anchorShape.show(),h?this._anchorShape.skew(-d,0):this._anchorShape.skew(0,0);return}const g=new _.Rect(ir+s.generateRandomId(qi),{left:u,top:m,height:l,strokeWidth:((f=this.style)==null?void 0:f.strokeWidth)||1,stroke:((S=this.style)==null?void 0:S.strokeActive)||_.getColor(s.COLORS.black,1),evented:!1});h&&g.skew(-d,0),this._anchorShape=g,this._scene.addObject(g,Zt),this.activeStatic()}_setCursorList(t){t.length!==0&&(this._cursorList=t)}}const ar="__DocTableRectRange__",rr=6;function en(o,t,e,n,i,a=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,r="",c=-1){const l=t.getOffsetConfig(),d=new vo(l,e).getNodePositionGroup(n,i);return(d!=null?d:[]).map(u=>new Co(o,t,e,u.anchor,u.focus,a,r,c))}class Co{constructor(t,e,n,i,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.RECT);B(this,"_rangeShape");B(this,"_current",!1);B(this,"_startRow");B(this,"_startCol");B(this,"_endRow");B(this,"_endCol");B(this,"_tableId");this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this.refresh()}get startOffset(){const{startNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get endOffset(){const{endNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startCol:n,_endCol:i}=this;if(e==null)throw new Error("Table is not found.");const{tableColumns:a}=e;return n===0&&i===a.length-1}get spanEntireColumn(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startRow:n,_endRow:i}=this;if(e==null)throw new Error("Table is not found.");const{tableRows:a}=e;return n===0&&i===a.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?t:e}get endNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?e:t}get direction(){const{anchorNodePosition:t,focusNodePosition:e}=this;return Io(t,e)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null}isIntersection(t){const{startRow:e,startColumn:n,endRow:i,endColumn:a}=this,{startRow:r,startColumn:c,endRow:l,endColumn:A}=t,d={left:n,top:e,right:a,bottom:i},u={left:c,top:r,right:A,bottom:l};return s.Rectangle.hasIntersectionBetweenTwoRect(d,u)}refresh(){var f;(f=this._rangeShape)==null||f.hide();const{startNodePosition:t,endNodePosition:e,_document:n,_docSkeleton:i}=this,a=n.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,A=new vo(a,i).getRangePointData(t,e);if(A==null)return;const{pointGroup:d=[],startRow:u,endRow:m,startColumn:h,endColumn:g,tableId:p}=A;(d==null?void 0:d.length)>0&&this._createOrUpdateRange(d,r,c),this._updateTableInfo(u,m,h,g,p)}_updateTableInfo(t,e,n,i,a){this._startRow=t,this._endRow=e,this._startCol=n,this._endCol=i,this._tableId=a}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const i=.3,a=new _.RegularPolygon(ar+s.generateRandomId(rr),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,i),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Zt)}}function Ji(o,t,e,n,i,a,r,c,l=!0,A=!0){const d=i.findNodePositionByCharIndex(o,l,r,c),u=i.findNodePositionByCharIndex(t,A,r,c);if(!(d==null||u==null))return new We(e,n,i,d,u,a,r,c)}function cr(o,t,e,n,i,a,r,c){const l=i.findNodePositionByCharIndex(o,!0,r,c),A=i.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return new Co(e,n,i,l,A,a,r,c)}function lr(o,t,e,n,i,a,r,c){const l=i.findNodePositionByCharIndex(o,!0,r,c),A=i.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return To(l,A,e,n,i,a,r,c)}function To(o,t,e,n,i,a,r,c){const l=[],A=[],d=[e,n,i,o,t,a,r,c];if(Yi(i,o,t)){if(So(o,t))return l.push(new We(...d)),{textRanges:l,rectRanges:A};{const C=en(...d);return A.push(...C),{textRanges:l,rectRanges:A}}}if(zi(o,t)){const C=en(...d);return A.push(...C),{textRanges:l,rectRanges:A}}const u=i.getViewModel().getSelfOrHeaderFooterViewModel(r),m=i.findCharIndexByPosition(o),h=i.findCharIndexByPosition(t);if(m==null||h==null)return;const g=m<=h?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD,p=Math.min(m,h),f=Math.max(m,h);let S=p,E=f;for(const C of u.getChildren())for(const T of C.children){const{startIndex:R,endIndex:v,children:O}=T,M=C.children.indexOf(T),b=C.children[M+1],N=O[0];let x=!1;if(N){const{startIndex:U,endIndex:F,children:V}=N;let H=null,Q=null;const j=V.find(k=>k.startIndex<=p&&k.endIndex>=p),X=V.find(k=>k.startIndex<=f&&k.endIndex>=f);if(p>U&&p<F)H=i.findNodePositionByCharIndex(j.startIndex+2,!0,r,c),Q=i.findNodePositionByCharIndex(F-4,!0,r,c),S=F+1;else if(f>U&&f<F)H=i.findNodePositionByCharIndex(U+3,!0,r,c),Q=i.findNodePositionByCharIndex(X.endIndex-3,!0,r,c),E=U-1,x=!0;else if(U>p&&F<f){if(H=i.findNodePositionByCharIndex(U+3,!0,r,c),Q=i.findNodePositionByCharIndex(F-4,!0,r,c),S<=U-1){const k=i.findNodePositionByCharIndex(S,!0,r,c),W=i.findNodePositionByCharIndex(U-1,!1,r,c),G=g===s.RANGE_DIRECTION.FORWARD?k:W,K=g===s.RANGE_DIRECTION.FORWARD?W:k;l.push(new We(e,n,i,G,K,a,r,c))}S=F+1}if(H&&Q){const k=g===s.RANGE_DIRECTION.FORWARD?H:Q,W=g===s.RANGE_DIRECTION.FORWARD?Q:H;A.push(...en(e,n,i,k,W,a,r,c))}}if(E===v+1&&!x&&b&&b.children.length&&(E=v,x=!0),E>=R&&E<=v||x){const U=i.findNodePositionByCharIndex(S,!0,r,c),F=i.findNodePositionByCharIndex(E,!x,r,c),V=g===s.RANGE_DIRECTION.FORWARD?U:F,H=g===s.RANGE_DIRECTION.FORWARD?F:U;if(A.length&&s.Tools.diffValue(V,H))continue;l.push(new We(e,n,i,V,H,a,r,c))}}return{textRanges:l,rectRanges:A}}function Zi(o){const t=o==null?void 0:o.getCanvasElement();if(!t)return{left:0,top:0};const{top:e,left:n}=_.getOffsetRectForDom(t);return{left:n,top:e}}function $i(o){var l;const t=(l=o.parent)==null?void 0:l.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const{paragraphIndex:n}=t,i=e.lines.filter(A=>A.paragraphIndex===n);let a=-1,r="",c=!1;for(const A of i)for(const d of A.divides)for(const u of d.glyphGroup)c||(a+=u.count),u===o&&(c=!0),r+=u.count>0?u.content:"";return{st:i[0].st,ed:n,content:r,nodeIndex:a}}function yo(o){const{startOffset:t,endOffset:e,collapsed:n,rangeType:i,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A}=o;return{startOffset:t,endOffset:e,collapsed:n,rangeType:i,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A,isActive:o.isActive()}}function dr(o){const t=yo(o),{startRow:e,startColumn:n,endRow:i,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}=o;return{...t,startRow:e,startColumn:n,endRow:i,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}}var Ar=Object.getOwnPropertyDescriptor,ur=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ar(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},tn=(o,t)=>(e,n)=>t(e,n,o);y.DocSelectionRenderService=class extends s.RxDisposable{constructor(e,n,i,a,r){super();B(this,"_onInputBefore$",new L.Subject);B(this,"onInputBefore$",this._onInputBefore$.asObservable());B(this,"_onKeydown$",new L.Subject);B(this,"onKeydown$",this._onKeydown$.asObservable());B(this,"_onInput$",new L.Subject);B(this,"onInput$",this._onInput$.asObservable());B(this,"_onCompositionstart$",new L.BehaviorSubject(null));B(this,"onCompositionstart$",this._onCompositionstart$.asObservable());B(this,"_onCompositionupdate$",new L.BehaviorSubject(null));B(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable());B(this,"_onCompositionend$",new L.BehaviorSubject(null));B(this,"onCompositionend$",this._onCompositionend$.asObservable());B(this,"_onSelectionStart$",new L.BehaviorSubject(null));B(this,"onSelectionStart$",this._onSelectionStart$.asObservable());B(this,"onChangeByEvent$",L.merge(this._onInput$,this._onKeydown$.pipe(L.filter(e=>e.event.keyCode===I.KeyCode.BACKSPACE)),this._onCompositionend$));B(this,"_onPaste$",new L.Subject);B(this,"onPaste$",this._onPaste$.asObservable());B(this,"_textSelectionInner$",new L.BehaviorSubject(null));B(this,"textSelectionInner$",this._textSelectionInner$.asObservable());B(this,"_onFocus$",new L.Subject);B(this,"onFocus$",this._onFocus$.asObservable());B(this,"_onBlur$",new L.Subject);B(this,"onBlur$",this._onBlur$.asObservable());B(this,"_onPointerDown$",new L.Subject);B(this,"onPointerDown$",this._onPointerDown$.asObservable());B(this,"_container");B(this,"_inputParent");B(this,"_input");B(this,"_scrollTimers",[]);B(this,"_rangeList",[]);B(this,"_rangeListCache",[]);B(this,"_rectRangeList",[]);B(this,"_rectRangeListCache",[]);B(this,"_anchorNodePosition",null);B(this,"_focusNodePosition",null);B(this,"_currentSegmentId","");B(this,"_currentSegmentPage",-1);B(this,"_selectionStyle",_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE);B(this,"_onPointerEvent",!1);B(this,"_viewPortObserverMap",new Map);B(this,"_isIMEInputApply",!1);B(this,"_scenePointerMoveSubs",[]);B(this,"_scenePointerUpSubs",[]);B(this,"_reserveRanges",!1);this._context=e,this._layoutService=n,this._logService=i,this._univerInstanceService=a,this._docSkeletonManagerService=r,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||document.activeElement===null}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;e.getUnitId()!==this._context.unitId&&!this._reserveRanges&&this.removeAllRanges()})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,n=!0,i){const{_currentSegmentId:a,_currentSegmentPage:r,_selectionStyle:c}=this,{scene:l,mainComponent:A}=this._context,d=A,u=this._docSkeletonManagerService.getSkeleton(),m=(h,g)=>{const p=lr(h,g,l,d,u,c,a,r);if(p==null)return;const{textRanges:f,rectRanges:S}=p;for(const E of f)this._addTextRange(E);this._addRectRanges(S)};for(const h of e){const{startOffset:g,endOffset:p,rangeType:f,startNodePosition:S,endNodePosition:E}=h;if(f===s.DOC_RANGE_TYPE.RECT){const C=cr(g,p,l,d,u,c,a,r);C&&this._addRectRanges([C])}else if(f===s.DOC_RANGE_TYPE.TEXT)try{let C=null;S&&E?C=Ji(S.isBack?g:g-1,E.isBack?p:p-1,l,d,u,c,a,r,S.isBack,E.isBack):C=Ji(g,p,l,d,u,c,a,r),C&&this._addTextRange(C)}catch{m(g,p)}else m(g,p)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:a,segmentPage:r,style:c,isEditing:n,options:i}),!(!e.length||(i==null?void 0:i.shouldFocus)===!1)&&this._updateInputPosition(i==null?void 0:i.forceFocus)}setCursorManually(e,n){const i=this._findNodeByCoord(e,n,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),a=this._getNodePosition(i);if(a==null){this._removeAllRanges();return}(i==null?void 0:i.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(a.isBack=!0),this._createTextRangeByAnchorPosition(a),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,n,i=!1){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",(this.canFocusing||i)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){const{offsetX:n,offsetY:i}=e,a=this._findNodeByCoord(n,i,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=$i(a.node);if(r==null)return;const{content:c,st:l,nodeIndex:A}=r;if(A===-1||Intl.Segmenter==null)return;const u=new Intl.Segmenter(void 0,{granularity:"word"}).segment(c);let m=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(const{segment:g,index:p,isWordLike:f}of u)if(p<=A&&A<p+g.length&&f){m=p+l,h=p+l+g.length;break}if(Number.isFinite(m)&&Number.isFinite(h)){this.removeAllRanges();const g=[{startOffset:m,endOffset:h}];this.addDocRanges(g,!1,{forceFocus:!0})}}__handleTripleClick(e){const{offsetX:n,offsetY:i}=e,a=this._findNodeByCoord(n,i,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=$i(a.node);if(r==null)return;this.removeAllRanges();const{st:c,ed:l}=r,A=[{startOffset:c,endOffset:l}];this.addDocRanges(A,!1,{forceFocus:!0})}__onPointDown(e){var f,S;const{scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{offsetX:r,offsetY:c}=e,l=this._findNodeByCoord(r,c,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(A==null||l==null){this._removeAllRanges();return}(l==null?void 0:l.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);const d=this._textSelectionInner$.value;if(l&&e.button===2&&d){const E=a.findCharIndexByPosition(A);if(typeof E=="number"&&d.textRanges.some(C=>C.startOffset<=E&&C.endOffset>E)||typeof E=="number"&&d.rectRanges.some(C=>C.startOffset<=E&&C.endOffset>=E))return}const{segmentId:u,segmentPage:m}=l;u&&this._currentSegmentId&&u!==this._currentSegmentId&&this.setSegment(u),u&&m!==this._currentSegmentPage&&this.setSegmentPage(m),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),n.disableObjectsEvent();const h=_.ScrollTimer.create(n);this._scrollTimers.push(h),h.startScroll(r,c),this._onSelectionStart$.next((f=this._getActiveRangeInstance())==null?void 0:f.startNodePosition),(S=n.getTransformer())==null||S.clearSelectedObjects();let g=r,p=c;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(n.onPointerMove$.subscribeEvent(E=>{const{offsetX:C,offsetY:T}=E;n.setCursor(_.CURSOR_TYPE.TEXT),!(Math.sqrt((C-g)**2+(T-p)**2)<3)&&(this._moving(C,T),h.scrolling(C,T,()=>{this._moving(C,T)}),g=C,p=T)})),this._scenePointerUpSubs.push(n.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(C=>{C.unsubscribe()}),this._onPointerEvent=!1,n.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}const C=new We(n,i,a,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(C)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const C of this._rangeListCache)e.ctrlKey?C.collapsed?C.dispose():this._addTextRange(C):this._addTextRange(C);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const E={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(E),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{e==null||e.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r:e,g:n,b:i,a}=_.getSystemHighlightColor(),r={strokeWidth:1,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${n}, ${i}, ${a!=null?a:.3})`};this._setRangeStyle(r)}_getAllTextRanges(){return this._rangeList.map(yo)}_getAllRectRanges(){return this._rectRangeList.map(dr)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const e=this._rangeList.find(a=>a.isActive());if(e==null)return null;const{startOffset:n,endOffset:i}=e;return n==null||i==null?null:yo(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId:e}=this._context,n=document.createElement("div");n.style.position="fixed",n.style.left="0px",n.style.top="0px",n.id=`univer-doc-selection-container-${e}`;const i=document.createElement("div"),a=document.createElement("div");i.appendChild(a),n.appendChild(i),this._container=n,this._inputParent=i,this._input=a,this._initInput(),this._initInputEvents(),document.body.appendChild(n)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.dataset.uComp="editor",this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(e==null)return;const{node:n,ratioX:i,segmentPage:a}=e,c=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(n,a);if(c==null)return;let A=i<.5;return n.glyphType===_.GlyphType.LIST&&(A=!0),{...c,isBack:A}}_interactTextRanges(e){const n=[];for(const i of this._rangeList){if(e.some(a=>a.isIntersection(i))){i.dispose();continue}n.push(i)}this._rangeList=n}_interactRectRanges(e){const n=[];for(const i of this._rectRangeList){if(e.some(a=>a.isIntersection(i))){i.dispose();continue}n.push(i)}this._rectRangeList=n}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){e.length!==0&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();const{scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton(),r=new We(n,i,a,e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(r)}_updateActiveRangePosition(e){const n=this._getActiveRangeInstance();if(n==null||n.anchorNodePosition==null){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=n.anchorNodePosition,this._focusNodePosition=e;const{scene:i,mainComponent:a}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:c,_focusNodePosition:l,_selectionStyle:A,_currentSegmentId:d,_currentSegmentPage:u}=this;if(c==null||l==null||a==null)return;const m=To(c,l,i,a,r,A,d,u);if(m==null)return;const{textRanges:h,rectRanges:g}=m;this._addTextRangesToCache(h),this._addRectRangesToCache(g),this.deactivate()}_isEmpty(){return this._rangeList.length===0&&this._rectRangeList.length===0}_getCanvasOffset(){var n;const e=(n=this._context.scene)==null?void 0:n.getEngine();return Zi(e)}_updateInputPosition(e=!1){const n=this._getActiveRangeInstance(),i=n==null?void 0:n.getAnchor();if(!i||i&&!i.visible||this.activeViewPort==null){this.focus();return}const{left:a,top:r}=i,c=this.activeViewPort.getAbsoluteVector(_.Vector2.FromArray([a,r])),{x:l,y:A}=c;let{left:d,top:u}=this._getCanvasOffset();d+=l,u+=A,this.activate(d,u,e)}_moving(e,n){var E,C;const{_currentSegmentId:i,_currentSegmentPage:a}=this,r=this._findNodeByCoord(e,n,{strict:!0,segmentId:i,segmentPage:a}),c=this._getNodePosition(r);if(c==null||r==null)return;const l=r==null?void 0:r.node.parent,A=l==null?void 0:l.glyphGroup[l.glyphGroup.indexOf(r.node)+1];(r==null?void 0:r.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A==null?void 0:A.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK&&(c.isBack=!0),this._focusNodePosition=c,this._removeAllCacheRanges();const{_anchorNodePosition:d,_selectionStyle:u}=this,{scene:m,mainComponent:h}=this._context,g=this._docSkeletonManagerService.getSkeleton();if(d==null||h==null)return;const p=To(d,c,m,h,g,u,i,a);if(p==null)return;const{textRanges:f,rectRanges:S}=p;this._rangeList.length>0&&f.length>0&&this._interactTextRanges(f),this._rectRangeList.length>0&&S.length>0&&this._interactRectRanges(S),this._addTextRangesToCache(f),this._addRectRangesToCache(S),this.deactivate(),(C=(E=this._context.scene)==null?void 0:E.getEngine())==null||C.setCapture()}__attachScrollEvent(){const e=this.activeViewPort;if(!e)return;const{unitId:n}=this._context;if(this._viewPortObserverMap.has(n))return;const i=e.onScrollAfter$.subscribeEvent(r=>{if(!r.viewport)return;const l=this._getActiveRangeInstance();l==null||l.activeStatic()}),a=e.onScrollEnd$.subscribeEvent(r=>{const c=r.viewport;if(!c)return;const l=c.getBounding(),A=this._getActiveRangeInstance(),d=A==null?void 0:A.getAnchor();if(!(!d||d&&!d.visible)){if(l){const{left:u,top:m,right:h,bottom:g}=l.viewBound;if(d.left<u||d.left>h||d.top<m||d.top>g){A==null||A.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(n,{scrollBefore:i,scrollStop:a})}_initInputEvents(){this.disposeWithMe(L.fromEvent(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"input").subscribe(e=>{if(!(e.inputType==="historyUndo"||e.inputType==="historyRedo")){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}})),this.disposeWithMe(L.fromEvent(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"paste").subscribe(e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"focus").subscribe(e=>{this._eventHandle(e,n=>{this._onFocus$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"blur").subscribe(e=>{this._eventHandle(e,n=>{this._onBlur$.next(n)})}))}_eventHandle(e,n){const i=this._input.textContent||"";this._input.innerHTML="";const a=this._getActiveRange(),r=this._getAllTextRanges();n({event:e,content:i,activeRange:a,rangeList:r})}_getTransformCoordForDocumentOffset(e,n){const i=this._context.mainComponent,{documentTransform:a}=i.getOffsetConfig();if(this.activeViewPort==null||a==null)return;const r=this.activeViewPort.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(r)return a.clone().invert().applyPoint(r)}_findNodeByCoord(e,n,i){const a=this._getTransformCoordForDocumentOffset(e,n);if(a==null)return;const r=this._context.mainComponent,c=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:l=_.PageLayoutType.VERTICAL,pageMarginLeft:A,pageMarginTop:d}=r.getOffsetConfig();return c.findNodeByCoord(a,l,A,d,i)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}},y.DocSelectionRenderService=ur([tn(1,I.ILayoutService),tn(2,s.ILogService),tn(3,s.IUniverInstanceService),tn(4,s.Inject(D.DocSkeletonManagerService))],y.DocSelectionRenderService);const Rt={id:"doc.command.switch-mode",type:s.CommandType.COMMAND,handler:o=>{var E,C,T,R,v;const t=o.get(s.ICommandService),e=o.get(_.IRenderManagerService),n=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=(E=e.getRenderById(r))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),l=(C=e.getRenderById(r))==null?void 0:C.with(y.DocSelectionRenderService);if(c==null||l==null)return!1;const A=l==null?void 0:l.getSegment(),d=l==null?void 0:l.getSegmentPage(),u=a.getSnapshot().documentStyle.documentFlavor,m=n.getDocRanges(),h={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:u===s.DocumentFlavor.TRADITIONAL&&A?[]:m}},g=s.JSONX.getInstance(),p=[];let f;if(u===void 0?f=g.insertOp(["documentStyle","documentFlavor"],s.DocumentFlavor.MODERN):u===s.DocumentFlavor.MODERN?f=g.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.TRADITIONAL):f=g.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.MODERN),f)p.push(f);else return!1;if(u!==s.DocumentFlavor.MODERN){const O=a.getSnapshot(),{drawings:M={},body:b}=O,N=(T=b==null?void 0:b.customBlocks)!=null?T:[];for(const x in M){const U=M[x],F=N.find($=>$.blockId===x);if(F==null)continue;const V=U.docTransform.positionV,{relativeFrom:H,posOffset:Q}=V;if(H===s.ObjectRelativeFromV.PARAGRAPH)continue;const{startIndex:j}=F,X=c.findNodeByCharIndex(j,A,d),k=(R=X==null?void 0:X.parent)==null?void 0:R.parent,W=k==null?void 0:k.parent,G=W==null?void 0:W.lines.find($=>$.paragraphIndex===(k==null?void 0:k.paragraphIndex)&&$.paragraphStart),K=(v=W==null?void 0:W.parent)==null?void 0:v.parent;if(X==null||k==null||G==null||W==null||K==null)continue;let Y=0;H===s.ObjectRelativeFromV.LINE?Y-=k.top:H===s.ObjectRelativeFromV.PAGE&&(Y+=K.marginTop),Y+=G.top;const q={...V,relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:(Q!=null?Q:0)-Y},z=g.replaceOp(["drawings",x,"docTransform","positionV"],V,q);z&&p.push(z)}}return h.params.actions=p.reduce((O,M)=>s.JSONX.compose(O,M),null),!!t.syncExecuteCommand(h.id,h.params)}},bo={id:"doc.command.create-table",type:s.CommandType.COMMAND,handler:async(o,t)=>{var q,z,$,ie,fe;const{rowCount:e,colCount:n}=t,i=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService),r=o.get(s.ICommandService),c=o.get(ve),l=i.getActiveTextRange();if(l==null)return!1;const{segmentId:A,segmentPage:d}=l,u=a.getCurrentUniverDocInstance(),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const h=u.getUnitId(),g=re(o,h),p=g==null?void 0:g.getSkeleton();if(p==null)return!1;const{startOffset:f}=l,E=((q=m.paragraphs)!=null?q:[]).find(He=>He.startIndex>=f),C=p.findNodeByCharIndex(f,A,d);if(C==null)return!1;const T=new s.TextX,R=s.JSONX.getInstance(),v=[],O=f+4,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:M}};f>0&&T.push({t:s.TextXActionType.RETAIN,len:f}),T.push({t:s.TextXActionType.INSERT,body:{dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:Nn(s.DataStreamTreeTokenType.PARAGRAPH,E)},len:1});const N=c.getDefaultStyle(),x=c.getStyleCache(),U=Ut(m,f,N,x),{dataStream:F,paragraphs:V,sectionBreaks:H}=Ra(e,n),Q=(fe=(ie=($=(z=C.parent)==null?void 0:z.parent)==null?void 0:$.parent)==null?void 0:ie.parent)==null?void 0:fe.parent;if(Q==null)return!1;const{pageWidth:j,marginLeft:X,marginRight:k}=Q,W=wn(e,n,j-X-k);T.push({t:s.TextXActionType.INSERT,body:{dataStream:F,paragraphs:V,sectionBreaks:H,textRuns:[{...U,st:0,ed:F.length}],tables:[{startIndex:0,endIndex:F.length,tableId:W.tableId}]},len:F.length});const G=Z(u,A);v.push(R.editOp(T.serialize(),G));const K=R.insertOp(["tableSource",W.tableId],W);return v.push(K),b.params.actions=v.reduce((He,Se)=>s.JSONX.compose(He,Se),null),!!r.syncExecuteCommand(b.id,b.params)}},nn={id:"doc.table.delete-rows",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=di(r,u);if(p==null)return!1;const{offset:f,rowIndexes:S,len:E,tableId:C,cursor:T,selectWholeTable:R}=p;if(R)return n.executeCommand(it.id);const v=[],O=[{startOffset:T,endOffset:T,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};f>0&&h.push({t:s.TextXActionType.RETAIN,len:f}),h.push({t:s.TextXActionType.DELETE,len:E});const b=Z(l,c);v.push(g.editOp(h.serialize(),b));for(const x of S.reverse()){const U=g.removeOp(["tableSource",C,"tableRows",x]);v.push(U)}return M.params.actions=v.reduce((x,U)=>s.JSONX.compose(x,U),null),!!n.syncExecuteCommand(M.id,M.params)}},on={id:"doc.table.delete-columns",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=Na(r,u);if(p==null)return!1;const{offsets:f,columnIndexes:S,tableId:E,cursor:C,rowCount:T,selectWholeTable:R}=p;if(R)return n.executeCommand(it.id);const v=[],O=[{startOffset:C,endOffset:C,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};for(const x of f){const{retain:U,delete:F}=x;U>0&&h.push({t:s.TextXActionType.RETAIN,len:U}),h.push({t:s.TextXActionType.DELETE,len:F})}const b=Z(l,c);v.push(g.editOp(h.serialize(),b)),S.reverse();for(let x=0;x<T;x++)for(const U of S){const F=g.removeOp(["tableSource",E,"tableRows",x,"tableCells",U]);v.push(F)}for(const x of S){const U=g.removeOp(["tableSource",E,"tableColumns",x]);v.push(U)}return M.params.actions=v.reduce((x,U)=>s.JSONX.compose(x,U),null),!!n.syncExecuteCommand(M.id,M.params)}},it={id:"doc.table.delete-table",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=t.getRectRanges(),a=t.getActiveTextRange(),r=At(a,i);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(o,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),h=new s.TextX,g=s.JSONX.getInstance(),p=Ai(r,u);if(p==null)return!1;const{offset:f,len:S,tableId:E,cursor:C}=p,T=[],R=[{startOffset:C,endOffset:C,collapsed:!0}],v={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:R}};f>0&&h.push({t:s.TextXActionType.RETAIN,len:f}),h.push({t:s.TextXActionType.DELETE,len:S});const O=Z(l,c);T.push(g.editOp(h.serialize(),O));const M=g.removeOp(["tableSource",E]);return T.push(M),v.params.actions=T.reduce((N,x)=>s.JSONX.compose(N,x),null),!!n.syncExecuteCommand(v.id,v.params)}},Oo="doc.command.table-insert-row",Ro="doc.command.table-insert-column",hr="doc.command.table-insert-row-above",gr="doc.command.table-insert-row-bellow",mr="doc.command.table-insert-column-left",pr="doc.command.table-insert-column-right",sn={id:hr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Oo,{position:Ft.ABOVE})},an={id:gr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Oo,{position:Ft.BELLOW})},rn={id:mr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Ro,{position:Pn.LEFT})},cn={id:pr,type:s.CommandType.COMMAND,handler:async o=>o.get(s.ICommandService).executeCommand(Ro,{position:Pn.RIGHT})},Mo={id:Oo,type:s.CommandType.COMMAND,handler:async(o,t)=>{const{position:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=At(c,r);if(l==null)return!1;const{segmentId:A}=l,d=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(o,d.getUnitId());if(m==null)return!1;const h=m.getViewModel(),g=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Da(l,e,h);if(S==null)return!1;const{offset:E,colCount:C,tableId:T,insertRowIndex:R}=S,v=[],O=E+2,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};E>0&&p.push({t:s.TextXActionType.RETAIN,len:E});const N=Ma(C);p.push({t:s.TextXActionType.INSERT,body:N,len:N.dataStream.length});const x=Z(d,A);v.push(f.editOp(p.serialize(),x));const U=kt(C),F=f.insertOp(["tableSource",T,"tableRows",R],U);return v.push(F),b.params.actions=v.reduce((H,Q)=>s.JSONX.compose(H,Q),null),!!a.syncExecuteCommand(b.id,b.params)}},es={id:Ro,type:s.CommandType.COMMAND,handler:async(o,t)=>{var K,Y,q;const{position:e}=t,n=o.get(D.DocSelectionManagerService),i=o.get(s.IUniverInstanceService),a=o.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=At(c,r);if(l==null)return!1;const{segmentId:A}=l,d=i.getCurrentUniverDocInstance(),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(o,d.getUnitId());if(m==null)return!1;const h=m.getViewModel(),g=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Ba(l,e,h);if(S==null)return!1;const{offsets:E,columnIndex:C,tableId:T,rowCount:R}=S,v=[],O=E[0]+1,M=[{startOffset:O,endOffset:O,collapsed:!0}],b={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};for(const z of E){p.push({t:s.TextXActionType.RETAIN,len:z});const $=xa();p.push({t:s.TextXActionType.INSERT,body:$,len:$.dataStream.length})}const N=Z(d,A);v.push(f.editOp(p.serialize(),N));for(let z=0;z<R;z++){const $=Ht(),ie=f.insertOp(["tableSource",T,"tableRows",z,"tableCells",C],$);v.push(ie)}const x=d.getSnapshot(),U=x.documentStyle,{marginLeft:F=0,marginRight:V=0}=U,H=((Y=(K=U.pageSize)==null?void 0:K.width)!=null?Y:800)-F-V,Q=(q=x==null?void 0:x.tableSource)==null?void 0:q[T].tableColumns,{newColWidth:j,widths:X}=_a(H,Q,C);for(let z=0;z<X.length;z++){const $=f.replaceOp(["tableSource",T,"tableColumns",z,"size","width","v"],Q[z].size.width.v,X[z]);v.push($)}const k=Vt(j),W=f.insertOp(["tableSource",T,"tableColumns",C],k);return v.push(W),b.params.actions=v.reduce((z,$)=>s.JSONX.compose(z,$),null),!!a.syncExecuteCommand(b.id,b.params)}},xo={id:"doc.table.tab-in-table",type:s.CommandType.COMMAND,handler:async(o,t)=>{var g;const{shift:e}=t,n=o.get(D.DocSelectionManagerService),i=n.getDocRanges(),a=o.get(s.ICommandService),c=o.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!c)return!1;const l=(g=i.find(p=>p.isActive))!=null?g:i[0],A=c.getUnitId(),d=re(o,A),u=d==null?void 0:d.getSkeleton(),m=u==null?void 0:u.getViewModel().getSelfOrHeaderFooterViewModel(l==null?void 0:l.segmentId);if(m==null||l==null)return!1;let h=null;if(e?h=ui(m,l,Un.PREV):h=ui(m,l,Un.NEXT),h){const{startOffset:p,endOffset:f}=h,S=[{startOffset:p,endOffset:f}];return n.replaceDocRanges(S),!0}return e===!1?await a.executeCommand(Mo.id,{position:Ft.BELLOW}):!0}},ts="COMPONENT_DOC_CREATE_TABLE_CONFIRM",Do="doc.component.create-table-confirm",ln={id:"doc.operation.create-table",type:s.CommandType.COMMAND,handler:async o=>{const t=o.get(s.LocaleService),e=o.get(I.IConfirmService),n=o.get(s.ICommandService),i={rowCount:3,colCount:5},a=(r,c)=>{i.rowCount=r,i.colCount=c};return await e.open({id:Do,children:{label:{name:ts,props:{handleRowColChange:a,tableCreateParams:i}}},width:"auto",title:{title:t.t("toolbar.table.insert")},onConfirm:()=>{n.executeCommand(bo.id,i),e.close(Do)},onClose:()=>{e.close(Do)}}),!0}},Oe={id:"doc.operation.move-cursor",type:s.CommandType.OPERATION,handler:(o,t)=>!!t},Re={id:"doc.operation.move-selection",type:s.CommandType.OPERATION,handler:(o,t)=>!!t};function ne({ref:o,...t}){const{icon:e,id:n,className:i,extend:a,...r}=t,c=`univerjs-icon univerjs-icon-${n} ${i||""}`.trim(),l=w.useRef(`_${Ir()}`);return ns(e,`${n}`,{defIds:e.defIds,idSuffix:l.current},{ref:o,className:c,...r},a)}function ns(o,t,e,n,i){return w.createElement(o.tag,{key:t,...fr(o,e,i),...n},(Sr(o,e).children||[]).map((a,r)=>ns(a,`${t}-${o.tag}-${r}`,e,void 0,i)))}function fr(o,t,e){const n={...o.attrs};e!=null&&e.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=e.colorChannel1),o.tag==="mask"&&n.id&&(n.id=n.id+t.idSuffix),Object.entries(n).forEach(([a,r])=>{a==="mask"&&typeof r=="string"&&(n[a]=r.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:i}=t;return!i||i.length===0||(o.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(([a,r])=>{typeof r=="string"&&(n[a]=r.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),n}function Sr(o,t){var n;const{defIds:e}=t;return!e||e.length===0?o:o.tag==="defs"&&((n=o.children)!=null&&n.length)?{...o,children:o.children.map(i=>typeof i.attrs.id=="string"&&e&&e.includes(i.attrs.id)?{...i,attrs:{...i.attrs,id:i.attrs.id+t.idSuffix}}:i)}:o}function Ir(){return Math.random().toString(36).substring(2,8)}ne.displayName="UniverIcon";const vr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},os=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"align-text-both-icon",ref:e,icon:vr}))});os.displayName="AlignTextBothIcon";const Er={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332C13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267C11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827C1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827C8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007Z"}}]},is=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"catalogue-icon",ref:e,icon:Er}))});is.displayName="CatalogueIcon";const Cr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.50095 1.84399C2.73322 1.60765 3.11311 1.60435 3.34945 1.83662L8.00012 6.40726L12.6508 1.83662C12.8871 1.60435 13.267 1.60765 13.4993 1.84399C13.7316 2.08032 13.7283 2.46021 13.4919 2.69248L8.85611 7.24852L10.8941 9.25146C11.1382 9.17563 11.3976 9.13477 11.6667 9.13477C13.1026 9.13477 14.2667 10.2988 14.2667 11.7348C14.2667 13.1707 13.1026 14.3348 11.6667 14.3348C10.2307 14.3348 9.06665 13.1707 9.06665 11.7348C9.06665 11.0143 9.35973 10.3622 9.83319 9.89129L8.00012 8.08978L6.16708 9.89127C6.64055 10.3622 6.93364 11.0142 6.93364 11.7348C6.93364 13.1707 5.76958 14.3348 4.33364 14.3348C2.8977 14.3348 1.73364 13.1707 1.73364 11.7348C1.73364 10.2988 2.8977 9.13477 4.33364 9.13477C4.60263 9.13477 4.86208 9.17562 5.10612 9.25145L7.14413 7.24852L2.50831 2.69248C2.27197 2.46021 2.26868 2.08032 2.50095 1.84399ZM2.93364 11.7348C2.93364 10.9616 3.56044 10.3348 4.33364 10.3348C5.10684 10.3348 5.73364 10.9616 5.73364 11.7348C5.73364 12.508 5.10684 13.1348 4.33364 13.1348C3.56044 13.1348 2.93364 12.508 2.93364 11.7348ZM10.2667 11.7348C10.2667 10.9616 10.8935 10.3348 11.6667 10.3348C12.4398 10.3348 13.0667 10.9616 13.0667 11.7348C13.0667 12.508 12.4398 13.1348 11.6667 13.1348C10.8935 13.1348 10.2667 12.508 10.2667 11.7348Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ss=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"cut-icon",ref:e,icon:Cr}))});ss.displayName="CutIcon";const Tr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},as=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"delete-icon",ref:e,icon:Tr}))});as.displayName="DeleteIcon";const yr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105C8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105C4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324C10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324C4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188Z"}}]},rs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"doc-setting-icon",ref:e,icon:yr}))});rs.displayName="DocSettingIcon";const br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"}}]},cs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"down-icon",ref:e,icon:br}))});cs.displayName="DownIcon";const Or={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689C2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336C2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336C9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689C8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203C13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319C11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333C13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879Z"}}]},ls=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h1-icon",ref:e,icon:Or}))});ls.displayName="H1Icon";const Rr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689C12.8465 7.26689 13.4 7.67244 13.4 8.33356C13.4 8.62807 13.2712 8.94814 12.9954 9.32391C12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373C10.3718 12.1759 10.0667 12.7122 10.0667 13.3336C10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336C14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767C11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338C14.3122 9.55787 14.6 8.98906 14.6 8.33356C14.6 6.88362 13.3757 6.06689 12.3333 6.06689C11.291 6.06689 10.0667 6.88361 10.0667 8.33356C10.0667 8.66493 10.3353 8.93356 10.6667 8.93356C10.998 8.93356 11.2667 8.66493 11.2667 8.33356Z"}}]},ds=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h2-icon",ref:e,icon:Rr}))});ds.displayName="H2Icon";const Mr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689C10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051C11.2283 10.1364 11.4375 10.2669 11.6667 10.2669C12.2418 10.2669 12.6786 10.4115 12.9585 10.6354C13.2204 10.845 13.4 11.166 13.4 11.6669C13.4 12.1622 13.2254 12.3937 13.0567 12.5202C12.8588 12.6686 12.5829 12.7336 12.3333 12.7336C11.7271 12.7336 11.3432 12.4858 11.1106 12.23C10.8877 11.9848 10.5082 11.9667 10.2631 12.1896C10.0179 12.4125 9.99979 12.792 10.2227 13.0372C10.6568 13.5147 11.3522 13.9336 12.3333 13.9336C12.7504 13.9336 13.3078 13.8319 13.7767 13.4802C14.2746 13.1068 14.6 12.5049 14.6 11.6669C14.6 10.8345 14.2796 10.1555 13.7081 9.69837C13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328C14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667Z"}}]},As=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h3-icon",ref:e,icon:Mr}))});As.displayName="H3Icon";const xr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",fillRule:"evenodd",clipRule:"evenodd"}}]},us=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h4-icon",ref:e,icon:xr}))});us.displayName="H4Icon";const Dr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492C10.7822 9.94492 10.8899 9.91238 10.9814 9.85599C10.9901 9.85195 11.0027 9.84632 11.0192 9.83936C11.0764 9.81533 11.1692 9.78033 11.2927 9.74447C11.5397 9.67268 11.8996 9.60022 12.3336 9.60022C12.4975 9.60022 12.5978 9.63412 12.6624 9.67167C12.7263 9.70877 12.79 9.76953 12.8503 9.87834C12.983 10.1181 13.0669 10.5337 13.0669 11.1669C13.0669 11.8061 12.9802 12.1936 12.8338 12.414C12.7252 12.5775 12.5275 12.7336 12.0002 12.7336C11.6445 12.7336 11.4936 12.622 11.4192 12.5328C11.3289 12.4245 11.2669 12.2453 11.2669 12.0028C11.2669 11.6714 10.9983 11.4028 10.6669 11.4028C10.3355 11.4028 10.0669 11.6714 10.0669 12.0028C10.0669 12.4244 10.1716 12.9106 10.4979 13.3016C10.8401 13.7118 11.356 13.9336 12.0002 13.9336C12.8063 13.9336 13.4419 13.6673 13.8334 13.0779C14.1869 12.5456 14.2669 11.8497 14.2669 11.1669C14.2669 10.4781 14.1841 9.81027 13.9002 9.29724C13.7521 9.02964 13.545 8.79662 13.2651 8.63403C12.986 8.4719 12.6697 8.40022 12.3336 8.40022C11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332C13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669Z"}}]},hs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"h5-icon",ref:e,icon:Dr}))});hs.displayName="H5Icon";const Br={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},gs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"horizontally-icon",ref:e,icon:Br}))});gs.displayName="HorizontallyIcon";const _r={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ms=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"left-icon",ref:e,icon:_r}))});ms.displayName="LeftIcon";const Nr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},ps=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"left-justifying-icon",ref:e,icon:Nr}))});ps.displayName="LeftJustifyingIcon";const Pr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},fs=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"right-justifying-icon",ref:e,icon:Pr}))});fs.displayName="RightJustifyingIcon";const wr={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"}}]},Mt=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"text-type-icon",ref:e,icon:wr}))});Mt.displayName="TextTypeIcon";const Ur={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263C4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837L1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263C0.880874 2.97695 0.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689C6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689C15.0605 2.83552 14.7918 2.56689 14.4605 2.56689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334C6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334C15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999C15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999 0.939453 6.76549 0.939453 7.83324C0.939453 8.90099 1.80504 9.76657 2.87279 9.76657C3.94054 9.76657 4.80612 8.90099 4.80612 7.83324C4.80612 6.76549 3.94054 5.8999 2.87279 5.8999ZM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999C3.2778 7.0999 3.60612 7.42823 3.60612 7.83324C3.60612 8.23824 3.2778 8.56657 2.87279 8.56657C2.46778 8.56657 2.13945 8.23824 2.13945 7.83324Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.939453 12.5002C0.939453 11.4325 1.80504 10.5669 2.87279 10.5669C3.94054 10.5669 4.80612 11.4325 4.80612 12.5002C4.80612 13.568 3.94054 14.4336 2.87279 14.4336C1.80504 14.4336 0.939453 13.568 0.939453 12.5002ZM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002C2.13945 12.9052 2.46778 13.2336 2.87279 13.2336C3.2778 13.2336 3.60612 12.9052 3.60612 12.5002C3.60612 12.0952 3.2778 11.7669 2.87279 11.7669Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ss=w.forwardRef(function(t,e){return w.createElement(ne,Object.assign({},t,{id:"todo-list-double-icon",ref:e,icon:Ur}))});Ss.displayName="TodoListDoubleIcon";function Is(o){var n;const{dataStream:t}=(n=o.body)!=null?n:{},e=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.COLUMN_BREAK,s.DataStreamTreeTokenType.PAGE_BREAK,s.DataStreamTreeTokenType.TAB,s.DataStreamTreeTokenType.DOCS_END,s.DataStreamTreeTokenType.CUSTOM_BLOCK];if(typeof t=="string")for(let i=0;i<t.length;i++){const a=t[i];if(!e.includes(a))return i}return 0}class vs extends s.Disposable{constructor(e,n,i,a,r,c){super();B(this,"_change$",new L.Subject);B(this,"change$",this._change$.asObservable());B(this,"_input$",new L.Subject);B(this,"input$",this._input$.asObservable());B(this,"_paste$",new L.Subject);B(this,"paste$",this._paste$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_selectionChange$",new L.Subject);B(this,"selectionChange$",this._selectionChange$.asObservable());this._param=e,this._univerInstanceService=n,this._docSelectionManagerService=i,this._commandService=a,this._undoRedoService=r,this._injector=c,this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(y.DocSelectionRenderService)}_listenSelection(){const e=this._param.render.with(y.DocSelectionRenderService);this.disposeWithMe(e.onBlur$.subscribe(n=>{this._blur$.next(n);const i=this.getDocumentData();this._change$.next({target:this,data:i})})),this.disposeWithMe(e.onFocus$.subscribe(n=>{this._focus$.next(n)})),this.disposeWithMe(e.onPaste$.subscribe(n=>{this._paste$.next(n)})),this.disposeWithMe(L.merge(e.onInput$,e.onKeydown$.pipe(lt.filter(n=>{const i=n.event;return i.ctrlKey||i.metaKey?[I.KeyCode.X,I.KeyCode.V].includes(i.keyCode):[I.KeyCode.BACKSPACE].includes(i.keyCode)})),e.onCompositionupdate$,e.onCompositionend$,e.onPaste$).subscribe(n=>{if(n==null)return;const{content:i=""}=n,a=this.getDocumentData();this._input$.next({target:this,content:i,data:a,isComposing:n.event.type==="compositionupdate"})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(n=>{if(n==null)return;const{unitId:i,subUnitId:a,...r}=n,c=this.getEditorId();i===c&&this._selectionChange$.next(r)}))}isFocus(){const e=this._param.render.with(y.DocSelectionRenderService);return e.isFocusing&&!!e.getActiveTextRange()}focus(){const e=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),n=this.getEditorId();(e==null||e.getUnitId()!==n)&&this._univerInstanceService.setCurrentUnitForType(n),this._param.render.with(y.DocSelectionRenderService).focus()}blur(){this._param.render.with(y.DocSelectionRenderService).blur()}select(){const e=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:e.body?e.body.dataStream.length-2:0}])}setSelectionRanges(e,n=!0){const i=this.getEditorId(),a={unitId:i,subUnitId:i};return this._docSelectionManagerService.replaceDocRanges(e,a,!1,{shouldFocus:n})}getSelectionRanges(){const e=this.getEditorId(),n={unitId:e,subUnitId:e};return this._docSelectionManagerService.getDocRanges(n)}getCursorPosition(){var n,i;return(i=(n=this.getSelectionRanges().find(a=>a.collapsed))==null?void 0:n.startOffset)!=null?i:-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(e,n){this._commandService.syncExecuteCommand($n.id,{unitId:this.getEditorId(),snapshot:e,textRanges:n})}replaceText(e,n=!0){const i=this.getDocumentData();this.setDocumentData({...i,body:{dataStream:`${e}\r
`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},typeof n=="object"?n:n?[{startOffset:e.length,endOffset:e.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const e=this.getEditorId();return this._undoRedoService.clearUndoRedo(e)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return this._param.readonly===!0}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}getSkeleton(){var n;return(n=this._injector.get(_.IRenderManagerService).getRenderById(this._getEditorId()))==null?void 0:n.with(D.DocSkeletonManagerService).getSkeleton()}isSheetEditor(){return s.isInternalEditorID(this._getEditorId())}getValue(){var i;return(((i=this._getDocDataModel().getBody())==null?void 0:i.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(e){this._param={...this._param,...e}}updateCanvasStyle(){var i;const e=this._getDocDataModel();if(e==null)return;const n={};(i=this._param.canvasStyle)!=null&&i.fontSize&&(n.textStyle==null&&(n.textStyle={}),n.textStyle.fs=this._param.canvasStyle.fontSize),e.updateDocumentStyle(n)}_getDocDataModel(){const e=this._getEditorId();return this._univerInstanceService.getUnit(e,s.UniverInstanceType.UNIVER_DOC)}_getEditorId(){var e;return((e=this._param.initialSnapshot)==null?void 0:e.id)||this._param.editorUnitId||""}}var Lr=Object.getOwnPropertyDescriptor,Qr=(o,t,e,n)=>{for(var i=n>1?void 0:n?Lr(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Ge=(o,t)=>(e,n)=>t(e,n,o);const Fr=["editor","render-canvas"];y.EditorService=class extends s.Disposable{constructor(e,n,i,a,r,c,l){super();B(this,"_editors",new Map);B(this,"_focusEditorUnitId");B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());this._univerInstanceService=e,this._renderManagerService=n,this._docSelectionManagerService=i,this._contextService=a,this._commandService=r,this._undoRedoService=c,this._injector=l,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe(L.fromEvent(window,"focusin").subscribe(e=>{const n=e.target;this._blurSheetEditor(n)}))}_blurSheetEditor(e){if(Fr.some(i=>e.dataset.uComp===i))return;const n=this.getFocusEditor();n&&n.isSheetEditor()!==!0&&this.blur()}_setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){const n=this._editors.get(e);return!!(n&&n.isSheetEditor())}blur(e){const n=this.getFocusEditor();e&&(n==null||n.setSelectionRanges([])),n==null||n.blur(),this._contextService.setContextValue(s.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!1),this._setFocusId(null),this._blur$.next(null)}focus(e){if(e===this._focusEditorUnitId||(this._focusEditorUnitId&&this.blur(),e==null))return;const n=this.getEditor(e);if(n==null)return;this._univerInstanceService.setCurrentUnitForType(e);const i=n.getValue().length;this._contextService.setContextValue(s.EDITOR_ACTIVATED,!0),s.isInternalEditorID(e)||this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!0),n.focus(),this._setFocusId(e),this._focus$.next({startOffset:i,endOffset:i})}dispose(){this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}register(e,n){var A,d,u,m;const{initialSnapshot:i,canvasStyle:a={}}=e,r=i.id;this._univerInstanceService.getUnit(r,s.UniverInstanceType.UNIVER_DOC)==null&&this._univerInstanceService.createUnit(s.UniverInstanceType.UNIVER_DOC,i||this._getBlank(r),{makeCurrent:!1});let l=this._renderManagerService.getRenderById(r);if(l==null&&(this._renderManagerService.create(r),l=this._renderManagerService.getRenderById(r)),l){l.engine.setContainer(n);const h=new vs({...e,render:l,editorDom:n,canvasStyle:a},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService,this._injector);this._editors.set(r,h),e.scrollBar||(m=(u=(d=(A=l.mainComponent)==null?void 0:A.getScene())==null?void 0:d.getViewports())==null?void 0:u[0].getScrollBar())==null||m.dispose()}return s.toDisposable(()=>{this._unRegister(r)})}_unRegister(e){const n=this._editors.get(e);n!=null&&(this._renderManagerService.removeRender(e),n.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${s.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:s.VerticalAlign.TOP,horizontalAlign:s.HorizontalAlign.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}},y.EditorService=Qr([Ge(0,s.IUniverInstanceService),Ge(1,_.IRenderManagerService),Ge(2,s.Inject(D.DocSelectionManagerService)),Ge(3,s.IContextService),Ge(4,s.ICommandService),Ge(5,s.IUndoRedoService),Ge(6,s.Inject(s.Injector))],y.EditorService);const le=s.createIdentifier("univer.editor.service"),Bo="COMPONENT_DOC_HEADER_FOOTER_PANEL";function Hr(o,t,e){const{useFirstPageHeaderFooter:n,evenAndOddHeaders:i,defaultHeaderId:a,defaultFooterId:r,firstPageHeaderId:c,firstPageFooterId:l,evenPageHeaderId:A,evenPageFooterId:d}=o;return t===_.DocumentEditArea.HEADER?n===s.BooleanNumber.TRUE&&e===0?c:i===s.BooleanNumber.TRUE&&e%2===1?A:a:n===s.BooleanNumber.TRUE&&e===0?l:i===s.BooleanNumber.TRUE&&e%2===1?d:r}const kr=o=>{const t=I.useDependency(s.LocaleService),e=I.useDependency(s.IUniverInstanceService),n=I.useDependency(_.IRenderManagerService),i=I.useDependency(s.ICommandService),a=I.useDependency(I.ILayoutService),{unitId:r}=o,c=n.getRenderById(r).with(y.DocSelectionRenderService),[l,A]=w.useState({}),d=(h,g)=>{var O;A(M=>({...M,[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}));const p=e.getUniverDocInstance(r),f=p==null?void 0:p.getSnapshot().documentStyle,S=(O=n.getRenderById(r))==null?void 0:O.with(D.DocSkeletonManagerService),E=S==null?void 0:S.getViewModel();if(f==null||E==null)return;const C=E.getEditArea();let T=!1;const R=c.getSegmentPage();let v=!1;if(g==="useFirstPageHeaderFooter"&&h===!0&&((C===_.DocumentEditArea.HEADER&&!f.firstPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.firstPageFooterId)&&(T=!0),T&&R===0&&(v=!0)),g==="evenAndOddHeaders"&&h===!0&&((C===_.DocumentEditArea.HEADER&&!f.evenPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.evenPageFooterId)&&(T=!0),T&&R%2===1&&(v=!0)),T){const b=s.generateRandomId(6);v&&c.setSegment(b),i.executeCommand(An,{unitId:r,segmentId:b,headerFooterProps:{[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}else{const M=c.getSegmentPage(),b=c.getSegment(),N=Hr({...f,[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE},C,M);N&&N!==b&&c.setSegment(N),i.executeCommand(An,{unitId:r,headerFooterProps:{[g]:h?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}a.focus()},u=async(h,g)=>{A(p=>({...p,[g]:h})),await i.executeCommand(An,{unitId:r,headerFooterProps:{[g]:h}}),c.removeAllRanges(),c.blur()},m=()=>{i.executeCommand(Lo.id,{unitId:r})};return w.useEffect(()=>{const h=e.getUniverDocInstance(r),g=h==null?void 0:h.getSnapshot().documentStyle;if(g){const{marginHeader:p=0,marginFooter:f=0,useFirstPageHeaderFooter:S=s.BooleanNumber.FALSE,evenAndOddHeaders:E=s.BooleanNumber.FALSE}=g;A({marginHeader:p,marginFooter:f,useFirstPageHeaderFooter:S,evenAndOddHeaders:E})}},[r]),P.jsxs("div",{className:"univer-grid univer-gap-4",children:[P.jsxs("div",{className:"univer-grid univer-gap-2",children:[P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.useFirstPageHeaderFooter===s.BooleanNumber.TRUE,onChange:h=>{d(h,"useFirstPageHeaderFooter")},children:t.t("headerFooter.firstPageCheckBox")})}),P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.evenAndOddHeaders===s.BooleanNumber.TRUE,onChange:h=>{d(h,"evenAndOddHeaders")},children:t.t("headerFooter.oddEvenCheckBox")})})]}),P.jsxs("div",{className:"univer-mb-1 univer-flex",children:[P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginHeader,onChange:h=>{u(h,"marginHeader")}})]}),P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginFooter,onChange:h=>{u(h,"marginFooter")}})]})]}),P.jsx("div",{className:"univer-flex univer-justify-end",children:P.jsx(J.Button,{onClick:m,children:t.t("headerFooter.closeHeaderFooter")})})]})},Vr=()=>{var A;const o=I.useDependency(s.LocaleService),t=I.useDependency(_.IRenderManagerService),i=I.useDependency(s.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),r=((A=t.getRenderById(i))==null?void 0:A.with(D.DocSkeletonManagerService)).getViewModel(),[c,l]=w.useState(!0);return w.useEffect(()=>{const d=r.getEditArea();l(d!==_.DocumentEditArea.BODY);const u=r.editAreaChange$.subscribe(m=>{m!=null&&l(m!==_.DocumentEditArea.BODY)});return()=>{u.unsubscribe()}},[]),P.jsx("div",{className:"univer-text-sm",children:c?P.jsx(kr,{unitId:i}):P.jsx("div",{className:"univer-text-gray-400",children:o.t("headerFooter.disableText")})})},Es=18,Cs=200,_o=6,Wr=4;function Gr(o,t){let{radius:e,width:n,height:i}=t;e=e!=null?e:0,n=n!=null?n:30,i=i!=null?i:30;let a=0;a=Math.min(e,n/2,i/2),o.beginPath(),o.moveTo(0,0),o.lineTo(n,0),o.lineTo(n,i-a),o.arc(n-a,i-a,a,0,Math.PI/2,!1),o.lineTo(0,i),o.lineTo(0,0),o.closePath(),t.fill&&(o.save(),o.fillStyle=t.fill,t.fillRule==="evenodd"?o.fill("evenodd"):o.fill(),o.restore())}class dn extends _.Shape{constructor(e,n){super(e,n);B(this,"color");B(this,"text");this.color=n==null?void 0:n.color,this.text=n==null?void 0:n.text}static drawWith(e,n){const{text:i,color:a}=n;e.save(),e.font="13px Source Han Sans CN";const r=e.measureText(i).width,c=Math.min(r+2*_o,Cs);Gr(e,{height:Es,width:c,radius:4,fill:a}),e.fillStyle="rgba(58, 96, 247, 1)";const l=_o,A=Es-Wr,d=Cs-2*_o;if(r>d){let u="",m=0;for(const h of i){const g=e.measureText(h).width;if(m+g<=d-e.measureText("...").width)u+=h,m+=g;else{u+="...";break}}e.fillText(u,l,A)}else e.fillText(i,l,A);e.restore()}_draw(e){dn.drawWith(e,this)}}var Xr=Object.getOwnPropertyDescriptor,jr=(o,t,e,n)=>{for(var i=n>1?void 0:n?Xr(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Le=(o,t)=>(e,n)=>t(e,n,o);const Ts="rgba(58, 96, 247, 1)",ys="rgba(58, 96, 247, 0.08)";var se=(o=>(o[o.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",o[o.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",o[o.DEFAULT_HEADER=2]="DEFAULT_HEADER",o[o.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",o[o.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",o[o.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",o))(se||{});function Kr(o,t,e){const{documentStyle:n}=o.getDataModel().getSnapshot(),{defaultHeaderId:i,defaultFooterId:a,evenPageHeaderId:r,evenPageFooterId:c,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:u}=n;switch(t){case _.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case _.DocumentEditArea.HEADER:return u===s.BooleanNumber.TRUE&&!l?{createType:0,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!r?{createType:4,headerFooterId:null}:i?{createType:null,headerFooterId:i}:{createType:2,headerFooterId:null};case _.DocumentEditArea.FOOTER:return u===s.BooleanNumber.TRUE&&!A?{createType:1,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!c?{createType:5,headerFooterId:null}:a?{createType:null,headerFooterId:a}:{createType:3,headerFooterId:null};default:throw new Error(`Invalid editArea: ${t}`)}}let No=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=i,this._renderManagerService=a,this._docSkeletonManagerService=r,this._docSelectionRenderService=c,this._localeService=l,this._componentManager=A,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}dispose(){super.dispose()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(D.RichTextEditingMutation.id===t.id){const e=this._context.unit,i=this._docSkeletonManagerService.getViewModel().getEditArea(),a=e.getSnapshot().documentStyle.documentFlavor;i!==_.DocumentEditArea.BODY&&a===s.DocumentFlavor.MODERN&&this._commandService.executeCommand(Lo.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){this._componentManager.get(Bo)||this.disposeWithMe(this._componentManager.register(Bo,Vr))}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_initialMain(t){const e=Ie(this._context),{document:n}=e;this.disposeWithMe(n.onDblclick$.subscribeEvent(async i=>{if(this._isEditorReadOnly(t)||!this._isTraditionalMode())return;const{offsetX:a,offsetY:r}=i,{pageLayoutType:c=_.PageLayoutType.VERTICAL,pageMarginLeft:l,pageMarginTop:A}=n.getOffsetConfig(),d=this._getTransformCoordForDocumentOffset(a,r);if(d==null)return;const u=this._docSkeletonManagerService.getViewModel(),m=this._docSkeletonManagerService.getSkeleton(),h=u.getEditArea(),{editArea:g,pageNumber:p}=m.findEditAreaByCoord(d,c,l,A);if(h===g)return;u.setEditArea(g);const{createType:f,headerFooterId:S}=Kr(u,g,p);if(g===_.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(a,r);else if(f!=null){const C=s.generateRandomId(6);this._docSelectionRenderService.setSegment(C),this._docSelectionRenderService.setSegmentPage(p),await this._commandService.executeCommand(Os.id,{unitId:t,createType:f,segmentId:C})}else S!=null&&(this._docSelectionRenderService.setSegment(S),this._docSelectionRenderService.setSegmentPage(p),this._docSelectionRenderService.setCursorManually(a,r))}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:i,scene:a}=n,{documentTransform:r}=i.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_drawHeaderFooterLabel(){const t=this._localeService;this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).subscribe(e=>{if(e==null)return;const n=e.getUnitId(),i=this._renderManagerService.getRenderById(n);if(this._editorService.isEditor(n)||this._instanceSrv.getUniverDocInstance(n)==null||i==null)return;const{mainComponent:a}=i,r=a;this.disposeWithMe(s.toDisposable(r.pageRender$.subscribe(c=>{if(this._editorService.isEditor(n)||!this._isTraditionalMode())return;const d=this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY,{page:u,pageLeft:m,pageTop:h,ctx:g}=c,{pageWidth:p,pageHeight:f,marginTop:S,marginBottom:E}=u;if(g.save(),g.translate(m-.5,h-.5),d?(_.Rect.drawWith(g,{left:0,top:0,width:p,height:S,fill:"rgba(255, 255, 255, 0.5)"}),g.save(),g.translate(0,f-E),_.Rect.drawWith(g,{left:0,top:0,width:p,height:E,fill:"rgba(255, 255, 255, 0.5)"}),g.restore()):(g.save(),g.translate(0,S),_.Rect.drawWith(g,{left:0,top:S,width:p,height:f-S-E,fill:"rgba(255, 255, 255, 0.5)"}),g.restore()),!d){const C={dataArray:[{command:"M",points:[0,S]},{command:"L",points:[p,S]}],strokeWidth:1,stroke:Ts},T={dataArray:[{command:"M",points:[0,f-E]},{command:"L",points:[p,f-E]}],strokeWidth:1,stroke:Ts};_.Path.drawWith(g,C),_.Path.drawWith(g,T),g.translate(0,S+1),dn.drawWith(g,{text:t.t("headerFooter.header"),color:ys}),g.translate(0,f-S-E),dn.drawWith(g,{text:t.t("headerFooter.footer"),color:ys})}g.restore()})))}))}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===s.DocumentFlavor.TRADITIONAL}};No=jr([Le(1,s.ICommandService),Le(2,le),Le(3,s.IUniverInstanceService),Le(4,_.IRenderManagerService),Le(5,s.Inject(D.DocSkeletonManagerService)),Le(6,s.Inject(y.DocSelectionRenderService)),Le(7,s.Inject(s.LocaleService)),Le(8,s.Inject(I.ComponentManager))],No);const Po={id:"sidebar.operation.doc-header-footer-panel",type:s.CommandType.OPERATION,handler:async(o,t)=>{const e=o.get(I.ISidebarService),n=o.get(s.LocaleService);switch(t.value){case"open":e.open({header:{title:n.t("headerFooter.panel")},children:{label:Bo},onClose:()=>{},width:400});break;case"close":default:e.close();break}return!0}};function bs(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function wo(o,t,e,n){const i=s.JSONX.getInstance(),a=6,r=o!=null?o:s.generateRandomId(a),c=t===se.DEFAULT_HEADER||t===se.FIRST_PAGE_HEADER||t===se.EVEN_PAGE_HEADER,l=i.insertOp([c?"headers":"footers",r],{[c?"headerId":"footerId"]:r,body:bs()});n.push(l);const A=s.generateRandomId(a),d=i.insertOp([c?"footers":"headers",A],{[c?"footerId":"headerId"]:A,body:bs()});n.push(d);let u="defaultHeaderId",m="defaultFooterId";switch(t){case se.DEFAULT_HEADER:u="defaultHeaderId",m="defaultFooterId";break;case se.DEFAULT_FOOTER:u="defaultFooterId",m="defaultHeaderId";break;case se.FIRST_PAGE_HEADER:u="firstPageHeaderId",m="firstPageFooterId";break;case se.FIRST_PAGE_FOOTER:u="firstPageFooterId",m="firstPageHeaderId";break;case se.EVEN_PAGE_HEADER:u="evenPageHeaderId",m="evenPageFooterId";break;case se.EVEN_PAGE_FOOTER:u="evenPageFooterId",m="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${t}`)}for(const[h,g]of[[u,r],[m,A]])if(e[h]!=null){const p=i.replaceOp(["documentStyle",h],e[h],g);n.push(p)}else{const p=i.insertOp(["documentStyle",h],g);n.push(p)}return n}const An="doc.command.core-header-footer",Os={id:An,type:s.CommandType.COMMAND,handler:async(o,t)=>{var T;const e=o.get(s.ICommandService),n=o.get(s.IUniverInstanceService),i=o.get(_.IRenderManagerService),{unitId:a,segmentId:r,createType:c,headerFooterProps:l}=t,A=(T=i.getRenderById(a))==null?void 0:T.with(D.DocSkeletonManagerService),d=n.getUniverDocInstance(a),u=A==null?void 0:A.getViewModel();if(d==null||u==null)return!1;const m=u.getEditArea(),{documentStyle:h}=d.getSnapshot(),g=(l==null?void 0:l.marginFooter)!=null||(l==null?void 0:l.marginHeader)!=null,p=[{startOffset:0,endOffset:0,collapsed:!0}],f={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:p,debounce:!0}};g&&(f.params.noNeedSetTextRange=!0);const S=s.JSONX.getInstance(),E=[];return c!=null&&wo(r,c,h,E),l!=null&&Object.keys(l).forEach(R=>{const v=l[R],O=h[R];if(v===O)return;let M;if(O===void 0?M=S.insertOp(["documentStyle",R],v):M=S.replaceOp(["documentStyle",R],O,v),E.push(M),R==="useFirstPageHeaderFooter"&&v===s.BooleanNumber.TRUE&&!h.firstPageHeaderId){const b=m===_.DocumentEditArea.HEADER?se.FIRST_PAGE_HEADER:se.FIRST_PAGE_FOOTER;wo(r,b,h,E)}else if(R==="evenAndOddHeaders"&&v===s.BooleanNumber.TRUE&&!h.evenPageHeaderId){const b=m===_.DocumentEditArea.HEADER?se.EVEN_PAGE_HEADER:se.EVEN_PAGE_FOOTER;wo(r,b,h,E)}}),E.length===0?!1:(f.params.actions=E.reduce((R,v)=>s.JSONX.compose(R,v),null),!!e.syncExecuteCommand(f.id,f.params))}},Uo={id:"doc.command.open-header-footer-panel",type:s.CommandType.COMMAND,handler:async(o,t)=>o.get(s.ICommandService).executeCommand(Po.id,{value:"open"})},Lo={id:"doc.command.close-header-footer",type:s.CommandType.COMMAND,handler:async(o,t)=>{var g;const e=o.get(s.ICommandService),n=o.get(_.IRenderManagerService),i=o.get(D.DocSelectionManagerService),a=o.get(s.IUniverInstanceService),{unitId:r}=t,c=n.getRenderById(r);if(c==null)return!1;const{scene:l}=c,A=l.getTransformerByCreate(),d=c.with(D.DocSkeletonManagerService),u=c.with(y.DocSelectionRenderService),m=d==null?void 0:d.getSkeleton(),h=d==null?void 0:d.getViewModel();return h==null||m==null?!1:(i.replaceDocRanges([]),A.clearSelectedObjects(),u.setSegment(""),u.setSegmentPage(-1),h.setEditArea(_.DocumentEditArea.BODY),m.calculate(),(g=c.mainComponent)==null||g.makeDirty(!0),queueMicrotask(()=>{const p=a.getUnit(r),f=p==null?void 0:p.getSnapshot();if(f==null)return;const S=Is(f);i.replaceDocRanges([{startOffset:S,endOffset:S}])}),e.executeCommand(Po.id,{value:"close"}),!0)}},Rs="UI_PLUGIN_DOCS",Ms=o=>{const{value:t,onChange:e,options:n}=o;return P.jsx("div",{className:"univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5",children:n.map(i=>P.jsx("a",{className:J.clsx("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500",J.borderClassName,{"univer-border-primary-500":t===i.value}),onClick:()=>{e(i.value)},children:P.jsx("img",{className:"univer-size-full",src:i.img,draggable:!1})},i.value))})},zr=[{value:s.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAyAAEAAgMBAQEAAAAAAAAAAAAABwkGCAoFAwQBAQADAQAAAAAAAAAAAAAAAAACAwQB/9oADAMBAAIQAxAAAADv4AAAAAAAAAAAAAAAAAAAAAAAAAAAABB8+ThDoAAAAAAAAAAAqz0V6b2Q8ProwxXgAAAAAAAAAAD4HNNuzyjHt82S7Ked1gPIAAAAAAABlxsQAAcz+7PlvO9F2K/6mJHwAAAAAAAB+0ycAAg2cdIrY2n57AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABh/eZhzoAAAAAAAAAAAA50dtHRdivAAAAAAAAAAA11nGlnVVJkexTLnR1ivxggoAAAAAycnUAAAAqZ0V6sWQ0NuhuPVPo4xX+YYIAAAAAeoZ0AAAARLLlQOmqwmmem1kbmM1oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGId5X1dDSa2HQbjvAAAAAAAAAAAHmFS2mrUGyPR1ivx8h0AAyEmEAAAAAAAHh9c+Wyjzjo6xX+KRiAAe0ScAAAAAAAD8ZofdDSy2F5+S4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACI5co5103P5battFd5mS4AAAAAAAAAACn7TVaznt5wNufK+d6PMV/wCIiQAAAAAAAHtEnAAgiceeLZT0m4r6CtdPR5iv88g0AAAAAAAGQkwgApU1Uw1Lli9Nlbt1fQ3jvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/8QAKRAAAAYCAQQCAgIDAAAAAAAAAAUGBwgXBAkDAQIKFhVAIGAwODY5UP/aAAgBAQABCAD/ALTfSSZF03SeJkkL9jYTs+T8I1I3jJonRjMma0p3J2TI6a+zPNy4ObQNdmxJNfY6YuN0ye/N6aH/AO7O/IeTqSYRhqhcBQcyGN81QIlHHxkFAoD7hPjvh4fZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEPZFEEKdnOYqivHy/x0P/3Z35DyJO7JexCwY19pbg4ODF4OHGxhkoVK5mRkZeRXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPBcjU2VZnDn4H4tLGlh2JVLurZoEfBp0FTtEX8/5CfqyMcNAOPhmxi3n2isz5NeG9rkb4v8Ary2Xb4tpG93FrGls9Uc/H1bcjd2XOn+U8nDZ65xa8Jg+Qpz9EEYapH/LQsjHMKk2ZZ+BYawFhrAWGsBYawFhrAWGsBYawFhrAWGsBYawFhrAI1ZKQ1UhbgZ/8O7Ka7nQI1+Oc+TLtrpLYxdtUnHZmP4/fYwfDs62t4cXd1nbyv3NHThCJOg5Kcc8Lckry6oToqhOiqE6KoToqhOiqE6KoToqhOiqE6KoToqhOgmb4mIzLGNMT+F9WLaiS7SrhjHwRfj5Q9S2AXIo+YSAkaIyvm8cgWVipEx+VtsmldsRlx+3uCrOqBQS3XXTWFsA49oEbFW8xzqnXB3E6Zc1NQy7+wd5XLgkxvm4+j6Zj2zygen5AyB2B9ORn98unR6CUKo2yCMhzzTEtdRC11ELXUQtdRC11EEq4JyeH2AV5f0FP/jahHi4/wCqJIib3d1e/wAgXVIyxUFCT/PE+YUioRUIqEVCKhCebj4E4wzb6Jjh9piX5xf3674NIzWjFnHjukdVTGu04kiZp7QpK/rr7Ps00ZmmWz5PlweQVhGqbuZNRdlKx8yWXSr+x610SBdxr5wzZ1gyO+vtqgY9uwTshs2CPNTVHNojDA6OPG5w+A6LtmLutvsy6UZuj0vSRIgZZnx5dn54t4W8LeFvC3hbwt4W8LeFvC3hbwt4W8LeFvBPOP8APHGGU/jJeSjOxEZNdSCfkqaicW+3nJl1IVomibRhG0RjOM5tn6cbqbZNFzCkIN8TkzyozweGqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEKoUQqhRCqFEEq3xyRn2AaZf4boNaL77NUKwbctTxRE8hXg4uPh4YNtfPdpyRyu2euvkr5p27O5cbQsz9m/8QAPhAAAQQBAgMGBAMFBQkAAAAABAIDBQYBAAcIEhMRFJSl1NUVldPlCSFAICIjM2AWJDBZtxAXMkFQVVe0tf/aAAgBAQAJPwD/AK1fgJrdjYEyuhbvUN2OnYawU1dtCIkqwWSLOxcYmUiZ0AZ0yLnIJyUhix8suNHqSQPl39RsNvDxPcVO+EHKSeymy21sEp0ObzHnpiXJK42zlMXWK4FIuN/EzwIOwFhi8xhIQscgiRGtkHKXbh04h4bbSNo9VhKpHVHa2TElt1YO606qy9fjWZSywEfMVIUCMl7POWeSJEjWTPiz7ppZBOfhlF30n1cAXFehD2AYyWq16NxNbU2OXwwO7ksqrySp60GHP5SS4JtlU4NL/cVLSz+oHYwY4w2K4XhpvBKxmXHXWh1v4T1VMNOvvONtZXltDjzq0pwpxec/5ily/wBWuJDSktStC3j2Ot1ZJx+T4k6u6sVXvIi+dOWiURFolsYcThzOGlOp5MYVlxCOlIzdWr8ue3ytI6ZslEiGFI5GHXmEcj7zieVl51pPZ2NuuIxhWdTcu0y1LyTTTTUkY22222Y8lDbaEvYShCE4wlCE4wlKcYxjGMY1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1PzXzQ76+p+a+aHfX1LyhQ7nfuowQeW+yvkjjFo52nXVIVyrSlaeZOeVSUqx2ZxjP7X+Ypcv8AVriQ0tb9440OMihxxYLGHHHB9qtuWXHdwbAS2ytp1kGuH3CozhhPeGFIjoyScZypbK1sMtDjDtNsDjsNoZYYYZRhtpllpvCW2mmm0pQ22hKUIQnCU4wnGMf7IvqEFPukPud+kUc7z7inXV8iDEoTzLUpXKhKUp7exKcYxjGojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqI8wlPW6iPMJT1uojzCU9bqN6BbHU6TvfD3eTqtLZc/hvFONK5mnFp/eRns7e3HYrGM4/Z2wrNBte/d0J3E3inIFghk7cG7GSM3LFWSfU+S+h6RfkrJOGLWwhhvL0mTnDeMKThM7t7J1vbfamM2U4KqLSpezS8nTK7OInHN075uQ3P1WvxsVe7CuWLiIoSqSNijEV2elAzz+8R4b5v9LXmn3yPgZ+Rqk6dTLNC2gOFtMQkdctWpYqDNOYjp+LQYIuRhzFsyISSh1EjNYfayr9UMqM4bfxdqGdeAgG0NiQVT4vdoAD82k6MZxleEqvcUoEuyuMISVNXPdaDWSpqPrwuMfp9q/8AfXv3D1ZaNqdtFnx0cJYLjKnhQ0YRKEystAhqhK6qRXaJ4PM1FlSUNCnxwBwx5QzqfxbuO/a/iTvMABapXbnhz3BA2q2Y2in5YQc9ijm0KoqZr90/smtTUXPPRJFbj5Y0Y5kUowZz4zI7iI3u3Z4H7pUh6fvyqGDg5nc7ai7iSDldet8fHJyMixxseDBSrh5RUlMnotbwExLTJ9ffnZbPTte1H4lOzsfEOIYQt1yKs7JVjngcvKdaV3WQVtxEimBcyWT2V8r60YZR26e6BbHc+k702neTqnisufw3kONK5mnFp/eRns7e3HYrGM4l/L4v0Wpfy+L9FqX8vi/Ral/L4v0Wpfy+L9FqX8vi/Ral/L4v0Wpfy+L9FqX8vi/Ral/L4v0Wpfy+L9FqS64j/fOq13MBrn6QBTzf8RkVt1PK62hX7q8dvZ2Z7U5zjP8AgiB53TNnaftxS7BJxzUxGUiSu8ooMm6FxJLTwEiTCxIsj8BGlUOQ6rQTBrlw5aOQTDSPGFxd8Tm49lp0bf7zulMcUtwqW2YLkpDNT0qXt7E1SSjIqt7dBjvOPxXfJiWGZikd7ZMEj1MhCWSfuGwcXCbSQ221rstlmblJ2SIhJOXiTJtu1WB4iXsEPJTQUmXW5Up51JlddinRl5EUxpCpWXtfFqjiZvkcKjrEQm2uw7IBklLGsuuIGQNKVo7cruLzrRGMPVo5tWE5U2Mfpb7Y5XR6ix1Noex0H2iEcinW3kY7VspwrmbV2pyrGOzOcKwbNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0bNeIB9u0TKOEC9bpoIeEWznrsOjr50tBMrz2IeVlPK4nsVhOc9uMZTn/BpcVuBtbuLDqhLXVpfDyRzRsEMGhliliOjnxUxDyYoUxAzkWUHLQc0ABLxRgkgGMQ3vnx27n7DxbrKheF/cLimsTvDzgcZ3Dwsc7RqfBU456MHcxnKQXLApl5KltlYfacWhVNfpNx3vq22tKtcFEmNh0CJq+0tajalSIamUsIQWKqoMXBxIIuR49OGXOllWG0c3Zih/2FLjYoLho4INu5G2026m0/YCCdeLsu5pDtMm7JDwE5uzMOOTQkS7JN2WsNWW91+TQuNkAHHf6vr1htuaXULLbMVSpApk7XZs1yGNmMV6sxq3h0SFhmu5/DYUFb7KS5IkZhTzeHMrTw7W3YePD3Ftu1ZNOusqm2RVsjYyKhy3ZuDnnqzUfjMUWLP5hZsVdeaYi5+PmYRB0rgJZapyYmK/tZNn8UXBvLT58nJku8OG68rHS81t61LTC+tIL23s1sjWMPNqIfmJ47cQ7HSCiMNtfqMpw+HGHlM5UnmTh0cV15vKk5/wCJOFoT2p/54/LR1ckdxZHczcarEk1avj1mJzE1mRDGi0IixnXmkPoaeXh57C+Z5XZnOMdmkuDm720viC4crh0kqbbm6xBRL5kOCY50VoeRE2DeNE40hC+qgkIPLqmmcoyvSGXCBe69NBCXFs565g46+dLTjK89iHlZTyuJ7FYTnPbjGU5ChfDne46ChfDne46ChfDne46ChfDne46ChfDne46GjGxyu9dRY7JaHsdAMghHIp015GO1bKcK5m1dqcqxjsznCsfoP+xy3/oEa/8AN28//wBmO0nviOG7Z7fbiYu7rXOQzCRlvj5qAr/eksN4wKUTaNsayNlJJKeRqbiiFMYQSKk/RHdO993/ALx0ev0+gUwT/K6rPNzdHk/mJ5ebm/Ps5c2Hyn7nqw+U/c9WHyn7nqw+U/c9WHyn7nqZ733TvH93+HdDqdcV8b+b357l5etz/wAtXNy8v5dvNj9AtTaDgyg1uJxjKm0lMLYUtOM/llScLyrGM/lnOPz/AC1erbuZW67ZrrfF2Obr7WLGQuxutSJoA0DVmTXj1jYE6YAkcMVInuLSwwO8QttpW2t72k3O4n7orafYnavc2sydKvW2fCjta/HRlSbs9RlRwJKBse4BcBByU7HSYOHVvVIOxAOqGtLynf6du0Tt7tft7ErmbRaJlbuWBWMutChhBBitESEvNS8gQLFQUFFCmS85LmBRUUEWeWww5+GP+I/YuFNLGZVXEQBsyC5COVMdt12QuwkUxMlRD1SEZHfK+OO3MaPSIhKziI8leREXUW87b21D7Ysg2OTHycRLgKS1MVqyQxzbMhB2OEJVgeSjTGkqxzMmCOlxpgJpO49p3SnNrZQTiJ4VtzdxbAdP3e6cN25OY0pymyk7NkLlLOVtJKTMRX/jLiijDj3LUytTEVBRqMfp53b8Xh6oXFDTd2OK2p3KesEPJ3vbisnxQuYGsBxFYsEdYjM12UvmcQtjMhIp6Yerz6zMKYySCbXqNQKHWyJCSkDHQK/VqjUq1GqfJJIdXkWMhYKDiQ1LWrPdwo8EbP8AKZa7MRC4Lhc3a48txJrhujW4oqFis1QQ6cJcKr4Dw4YyIdirzVAr7fcRGmhTK8bEPchEU4KK60Gfu7NbucJt6ypbrTcvXJ1uHjKjHmYR2tlJYm95Z6TAbcwnLctHxjmcrS2jLGm+t3EIozpc/T6vdmHHun1OVfJz8nLz8i+Xt7eVXZ2Zr3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ar3m32zVe82+2ahu6d77x/ePiPX6fQFfJ/ldxZ5ubo8n8xPLzc359nLn9i2jU3bXb+MwfMSTiFEnnlkPIEiK9X4xvOCJmyWGTeGioOJG/imHEtYWtgdL5DL9p4JvwpZAsKwUfh9r57YXEBxUwQhGDa7Z9yprAxDVep8w62PMBsZT8G+H4jV1av2UvMXu21TIXb7bLb6FYr9Pp9fYWxGQ0Ywtx5SEKecfLMMMLfJkZWVkSS5WZlSzZaWNNkjSinsNGWat727qcQ9hGxlayIyq7dIoNuANU0w8hxI0gxtrd/476UsJehEpx3lHemE6UhLxseaI0p3KsNpcJGcZQpzKUrVhGFLxleUoWrCe3OEqz+WTYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2jYXxB3t2iYxwcXvXUQO8Wt7PXDIHRyJdCZRnsW8nKuZxPYnCs47c4wnP7G+FG2nqW124E9uVdYK/VqUtUJd7KxGRcTt+8/DBNPAHDVsMu9MmBTLT4JjNkwyoV9GXsJ/Ff4cWWWUIaaaa4RdtG2mmm04Q2222jbTCUIQnGEoQnGEpTjGMYxjGMa4qduuJiRkjq8Xt5K0bayubVDUuJjxJjFpHl24GvV1iV+KPvRBI5JaCFANx5KUuNIfVhSly2x20MUVwQ8F0k807iMsUHT5NT+7e6dXey6pkyHl7Q7YRK/LtY5Do26TYJDA5sWtkb+pv//EAD0RAAIBAQUEBgUJCQAAAAAAAAECEQMABBIhMUBBUWETIjJxkaEjQmCBsRQzNFNzgrLB8ENQUlRykpPR8f/aAAgBAgEBPwD99MjqquRCvOE5EGNdDkRwMHaaNA1Qzl1p00PXZjplOQ3nlI/K17pUqa0DSBh0LEkmW7JBIJgHPcB5Woelu9aidUHTU+MjtD35D7xO1Xv5q5/Yj8NO1w+kAbmVwe6J+IFjkSOBPx2m9/NXP7Efhp2uXVNWsdKVJv7m0Hvg7U1R3ChmJCCFB9UZCB4CxqqKAooGlmx1SYAJHZCwTkOcZjT2XKlYxAiRIkESDoRO7ntZ9NdMXr3Yx30208DpwCnjtFMIzqHbAhPWaJga+J0HCZs14ooxWndqTIDAZxiZgN+I5id2seQvNNAtKtTXAtUGUmQrDWOWo4CNBMWuefyhDo1BifdkPxbRdaS1qyo3ZgsQMiY3Tz3xnExxs16cMVpU6dMAkBRTBbWIYkGTxyGdr5j6C79IAHlsQAAgwMoGQMa87XXqUrzVOUU+jU8Wfd44fHw2dHamwdDhZcwR+vEWN8qnMLSV/rFpjH3ySc/dZ6zuioxkIWI4ksZJJ1Mk2qVEFCnRpmc8dVoIlzouYBIXugwCPbBRJAkCSBJyAkxJO4DfavR6CoFDh+qGkCIMnIiTBynXQg2vAFSnSvIAlh0dUD6xRkfvAeGHjtIteqSUaxRJw4VOZk52o9a6XlT6hRxyJOfiFjaRqO+1/wDpB/oX4WpdS53hv42RBziCfJj4eG01qpr1MZAUkAQDllzNrw6qlKhTYMtMYnZTIao2sHeBJiOMbvZ5EZ2CICzMYAH604nQC3yMzgNegKmmDFnPDTXlFqlN6TFHEMPMbiDvB42rIrUqVdFChupUVRAWou8AaYgCfDjtF2rJR6ViDjNMrTIAIDHjmIzjMbptmTGZJPeST8STa/fsFYzUWiBU3mctec4j7532ode63pD6oWoOREz5KNopo1RwiCWOn5k8AN5sWpXSQkVbxoXPYpneFG8j/pHZszM7FmJZmMknf+vLQWu/Vu97c6FVQcyZHliHjtF1rpQLsyFiwCgggEDfnzy04W6S5/y9T/If92qtRbD0NNk1xSxadIiSdM7Vj0NCnQ0ZvS1e89lT3CJ7h7T/AP/EADcRAAIBAgIGBwYFBQAAAAAAAAECEQMhAEESMUBRYXEiMoGRscHwE0JSYHKhBDNDktFQU4LS4f/aAAgBAwEBPwD+tBgSQDdYkbp1bS9QIQoBZjqUeZy++KLuxqBzdWiBEDXIHdxxU6FRKmR6DduqfHsG1UevW+s+LY/Efl8mGBcDltNHr1vrPi2K9wiDW7juGvxG1BVUkgQWMnicBCahdogCEAm28mwvyyPD5XBB1EHK2/a+pWj3aonkw/nxbhtDEhSVEtFhx9XwKbkS1VwxvCmAOEDX2RikzaT02MlDY7xx+3G+K9vZtmrj738toquUQka7AcJz9Z4FFSJdmYkSTpW7OGKMe1qaJlYse0Yq9J6Sb20jyH/J2ggMCCJB1jAoJqlyPhLdHuEeOAiqxYCCQBwAEAQOzCqxqM7CPdQWMLvtv77kfOBMAm5gTA1nlxxTf2izoxci958MUzou9I5dJfpOV90987VRcuktrkjdipatSbfK+v3bV+H/AC/8j5YfpV6a/CCx4eoG1U0FNdGZuTOKYJZ6jAgsYUGxCjhx5ZTn8vEhQSTAGs49vmKdQr8UffdHbhWDgMpkH1BxTYh3psSY6Sk6ypy4x/O0VEL6IEaIYFgZuButz+2LAbgO4AYofqEdUudHlfyj0MVLVaTb5U8vTHaGYKCx1DEPWu0pTyX3m3Twz8J62AAoAAgDUMVb1aIzBJ7BB8jtFWm1QKAQACSZzOXdfvxo1/7i/tH+uEDidNg26BEb8hhOnUapkOgnZrI8uZ+Z/wD/2Q=="},{value:s.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAAyAAEAAgMBAQAAAAAAAAAAAAAABwkGCAoFBAEBAAMBAQAAAAAAAAAAAAAAAAIDBAEF/9oADAMBAAIQAxAAAADv4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKxr669bobzVSoz11dlPmagAAAAAAAAAAOavdn6VMOjmr3Z/hOmLDoA1JAAAAAAAMuNiAAc6e2i1LPZV5orjzvLxst0qx7Ise4WAAAAAAAfaZOAD4SqvRXatnshmcfV53N+dybgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUfaqa/b4dVPn6Pa50QUYwAAAAZOTqAAAAAcuu/PXpdX1vedp2rrn9hgp5YAAAB6hnQAAAABVJorw7vNpa5bh1zyTgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADWyccN63FrkAAAAAAAAAAABqpZHBu83kqmIeMeAMhJhAAAAAAAABoNdCK5Rs6z2+mRieKAe0ScAAAAAAAACEp8gGUfj633pmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEsuUX66b2cl1al9fnlxma0AAAAAAAAAAc127P0c4tHOXto29qlofdDp/waAIkPiAAAAAAPaJOABzUbs/Svh0c2W7POsJTLDtuee0CDTzwAAAAADISYQAadWwqI0V3AZref7ZRujVLYqE7Ys9gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//EACkQAAAGAgIBAwUAAwAAAAAAAAAFBgcIFwQJAgMWAQoQFSAwQGA3OXD/2gAIAQEAAQgA/k9rc/TDX/HIqVjf8oGb3MFA8nvw9c+zVOy9gsq5QOtNDeVN5yTCMrhRE/X2u93JWbldFrdm4094eKUbN9+zV8fcscePBtdcnDh8+SKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIeSKIIU7OcxVFePl/Zv5RKzbDMgRsuQ/bsfgr0sD3Sd9fb6t8tlejpq7Dl/7lr/G+uYS4l6w8HWWOH+kY0TsIB9mub95mrFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPFeI8V4jxXiPBcjU2VZnTn4H2GZYWnRaYExzjaMNS+G5PF1uguLi8oL8EpKXxjSw8lcJFFr7vmwbNSYbU8Z9+0WjEm3KQS6AQX/CJft1s/l5M3sjg085mrm1pZQCWnIyybPi9VJ0hVBR8LJZKQqUhlgYFhrAWGsBYawFhrAWGsBYawFhrAWGsBYawCNWSkNVIW4Gf+POM3o21bSJoxIW2/qBmvaC0QPTGQ/rIZjIyxdZpx5BlxiXm5fgmxSDlviY8Msk0y6oToqhOiqE6KoToqhOiqE6KoToqhOiqE6CZviYjMsY0xPxy106RVlm+WHJzu46LIE57SOq2K5l9rpi9ORh0RHWQKNSCbb5IJRBI7+vmFIj1iZGN6ZIekBJZZE44mNHKHK/ZnS7ixYKF0rXwbzWm/bgyhgfGGQLrfCqcE5Iz7PK8S11ELXUQtdRBKuCcnh9gFeX+ltU/wBZ8/BpN5ceGqCDfPmTnRMoi3FOU+FC3H144zDYVCKhFQhPNx9BOMM2/TkqyRXJSPT3R6PG7gchULr46NeHdrcgMjtbkZi6NSI/m30fRqI0tMtnwe/j7htMdRBxeQxZR6WwkU1KFe5mZY7jWXj0+BhFdoIn7m2XkC/nRE15/wBbef6+j/Sy1Ea/TrtTqf7k/wBiT7tA/b2Mk7+2DX8Wad9frvwmRkmlnJ/fqYp9wJT6hWKan5MnS+nmOfgC3hbwt4W8LeFvC3hbwt4W8LeFvC3gnnH+vHGGU/buR49TSbO9IUnz4aQOy1Zybv5Rks5toLv5UgOzXRrE12apUtD9TqiSb5/Ju2Z9nmpnndNUKIVQohVCiFUKIVQohVCiFUKIVQohVCiFUKIVQohVCiFUKIJVvjkjPsA0y/snfCRodgsbVjG55OuEvuAchFdkbDCEcMmsgNGNCxlZKM2mrcBEE3eJQsEkoqb+C9VpjPV+zyCEnpqm0Ws6Of8ASf/EADoQAAEEAQIEAwYCCgEFAAAAAAQCAwUGAQAHCBESExSUpRWV09TV5QkhEBYXICIjJDNAYDBYWXC1t//aAAgBAQAJPwD/AFOnjbl8Q29G4EBsdw3bbFd9YVl3WuKCcRhk0OIQGYRXoFodRRogxsc5LyT8LXEysQ5OtSYn4tY0lxM+zM2t/h0M2K2+xw/Fy6RfaGdrRrEp7EeGM8S0zA4tzNBDbThbzyXBsOqncQDm2V+4eP2i1Tiuo4UfJOqpF62dgE2S5kQcMRl+ccipasuB2GLinvFmxxxchUFHS0lAFnEbMbk8LXBjuBxMbXbWD787zUqqM7h8RRNmMPKOiaLUbMLZ4qH2vzX4yRILtcHiVljZHMSO1Za6SiUr7v8Aj4derUPuHvLuOwEvn4J20RCaTLRB60JyjD5kSbS4x4RbuXPA991Q6UYMKS/ocMylF8Rm3F4XCOoSVFe19xD99JC4JcAfw4I6maWYyxKsray27gFsdaFMpw2lKUIR+IntAlCE4wlKUpgLPhKUpxywlKcYxjGMYxjGMcsfl+5PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+p+a96HfH1PzXvQ74+peUKHc8d3GCDy32V9EcYtHW066pCulaUrT1Jz0qSlWOWcYz+7WJW4j/h88RwVn3ersC0hUsTsduJK05u5SqVKXjkwAVTY2uZew28mKTeHpwxCIiNlCGeKXZtezDFZ/WldlbukQqRyLkBMg3CpqXiMW7N0eS40EzRMweLi5LutwyYT2mtIua1IU4/8AEZ4obRu5Q67LNJakxNma1PXFdAdISplD6Rval2uUdCrW8UPJV+MibAAQQHNtFk/9xXaH/wBDaNWwmobcw8vBwCzI+ElrHLSM7YjPBxMREwkKKXIHGEKS+S5hDSWRQAzTinmRhXXE2Bi1bcboVKDu9KsI45YaZWu2IBmRjSXAZBgWRjiuw+ls2MkhRJKNMQ+BICjGDvsN6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53UR6hKfO6iPUJT53Ub2C2O52nfGHu9HdaWy5/LeKcaV1NOLT/EjPLnzxyVjGcfuR4MtDywJcZKxUmIwfGycaew4KdHyAJTbopoJorroxYhLTjBDDjjLza21qTngi2qxaUSftZEc6deSNu0meJcLwhOz5Ftd2kSAl51WEROKRiKQwloVAWBWGWWwQ4uKiwxo6NjY4ZgKPjo8JhAwYIIYyGhhAxBmmxxhh222GGG0NNIQ2hKcbYVnc4Hbq6Ru4lIGszBD7Vau0Qy+xG2SNwOSNlEiGyUQ2ytzLjeEur5t55/ltzWd09tLGsB6XqNrCyZHEFRZjR8acwttxgyPkY8xhsgKSjihDxV4z2SEYWvCq5D1CkUqAiarUarXgB4uCrlcgQWIyGhIiOFQ2MDHRseMwIIMyhLbLDSEJxyx/wCCdybvwNcBdH29jLJb+J3bVVVL3Z3yvpqYY0ij0CWRNfrZQRYj2ziMwe2DBsJIrNtkJIy0DHVuCR+IlxX8WG0NL3HoFb354eOMi8J3fYtdLt8w1EGmVa6SrWHqkY5KYh4gNMHAhS8Y7LLmMWEsIWSgZpTq4qyQsXPRi32ssPrj5gFiRCU8yrOVMuqGIby41nOctrzlGc5zj9Ml2BGPB9prwYDvR3QBXnP5jwrjqup1xav4l55c+WOScYxiX9Pi/ktS/p8X8lqX9Pi/ktS/p8X8lqX9Pi/ktS/p8X8lqX9Pi/ktS/p8X8lqX9Pi/ktSXfEf8Z3WvBgNdfaAKeb/AJjIrbqel1tCv4V458uWeac5xn/j4nt5OGfhM4GWKdCj7NcPNyTtduVvtYp7D4spbLnd2hiJ2SpbcmCek6LFAchg4SXog0cmMnzjbTL33elziV3LtdTH24o924h9x9xcy9birAIdebdOUmfmzo/9Xo+PGXHtWA8JoVm1yUMKA5k5XQ3uxRNnKK9SNrayNaNwbFH1yJLsMtTg346ECIkHmvGypQsfInIBES8SmOjZKRcbQDHmkMHBykVKBiyMZJxxTBsfIx5rCCQzgTBlujFhljOtkClDuOMPsOIdaWttaVZ0TKNkFdnuIHeEQzjsMNDo6EuhPLxzQynKupxXNWVZxyxnCcGzXmAfp2jZrzAP07Rs15gH6do2a8wD9O0bNeYB+naNmvMA/TtGzXmAfp2jZrzAP07Rs15gH6domUcIF73bQQ8ItnPfYdHX1paCZXnkh5WU9LieSsJznnjGU5/47Tv9w5cRKIUevTO8/ClunnZ+9W2KBHGBjmrSfmAsYciYBGCDQzUwyAHMkQosdESEgbHwsGPGw27m7Nl3uGqoG6XEDu1uzYb7xGWqLptvgbzCw2NzZlDi67CqsVbhy5WIqcPAx854Mf2uOa6KG6NWJ+boO3ExWZ+kkwNokq5Z4CVqsEXWAiB5oDP9U2bXZGRiJQSRFMDLaMyYgdmVDjDwYtqDqNIrcFUKrCsOkvsQ9brUWLDQcWy+a8SY81HxgQojbpZBBLiGcLfeddypav8Ab9ubXu1naCknW/8AZ7SulM/Y8CvjD5aQUsY3EXEx+Csy1lm8R8kqBrQEvMoi5NYCQCNpbTsg/uhHTRi9ubcZmUkIjMLZZiueMj5pURX3J+uTXsj2xW512vwa5aGNDNxGDoeR1f5L0eNfNouHrd3cemkSoKJSMZs1No03PwjshGuqQ2eGiQBHUQI4tKCGsKaUrGFZzomKL3F3V2zBtNtJhIxqGiXpYiRkhnFgxbK3GgmMtCtYwyhak4VhWef5/pGjHBxfC9tZDJa3s98MchfWpo1lGeS3lYT0tp5JwnGeecZVkKF8ud9R0FC+XO+o6ChfLnfUdDRjY5Xiu4sdktD2OwGQQjoU6a8jHNbKcK6m1c05VjHLOcKx/hf9H3EP/wDLLPpSUIRsfGKWtWcJSlKZiaypSlZ5YSlOMZznOc4xjGOefy1LRk7DnJcUFKw54snGlpaecHdUKcE6+KQlt9p1hzLTq8IeacbVyWhScamfCeL8P/T+zu/2+wKwN/d8cz1dXZ6/7aenq6fz5dWbD6T9z1YfSfuerD6T9z1M+L8J4j+n9ndjud8V8b+7457p6e91/wBtXV09P5c+rH+FNyFaht7tqr3tXK2GKHHLk4OPvdbka2XKx4pmcCkGAMSKyR2Sc4YcdbSh3PRnOr3d5Lbz9g1r2BN3AjHgq3fHa7bombh5CaBcFZMiwJhkacIyw06IdGPZbSxIAmhPEivbh3Lc2JEuVqu5FmujYAhXtK1Oh5IAiIiMxkOFhRmo8dxALb5SnpQiVlXX+7JLZa/1u6RVA2w29h3Zu02eXy8pkQZC0MDCBhiNESEvMShrw8ZCQcUKZLTUqWJGRgZRpTDC/wAOH8Q+O4SXncPscTjmzY7lRxW1LxyuxYSZRMaPUEjJfOXLs2stPhm0NNNPSDyQU26Mve2G5EExYqhaYlTnhZKPecdHebdYIbZMj5OMPHLiZqHkBxpSFmQT4iUEFkAiR2tluIPjW4ooGOYmLjs7wvUEm7FbdRhIwpbJO4E+hXg4Rahz4158WOEnCIpuQDVPoiMlh4J2T3+4JuJ6VDdkKhtVxOU9uoJ3DFQ2t9DNDsCiEIl5N8VkosIA+LiEzI47iq0TOuNvtMf42XSNrN/eJqW3R3phcPKaHs9T2fxV8B1kxtvDmDAJeFsl/QUwWzkUc1iIOSh18dDocHDvVZ6HXXXa07GBOV92vuBZjVwbkMtjMcuHXHZyAuMUNkJQWci5YyxnLeiinNt+E/jCJn9ngjzCjiYWgbuG3gGOr7DxXPKBY2P2yhZEppntjvT0/NSiWu9JkOuyW39v4oeKLiMtm7u4V9oU9NWoWTrEgICZWoEmfsVVqEs+7GWeX3Al3WFRDY6HrEpbTi05Q2yoGY4wccZNR3EqYkK00faqTtTFzEE7ZLJYMhJekoCpETMRGWNRRqGY42O27tconLjFXknBv0wXe8CaUH3fafb7vhn3Ge52/Z6+jr6Oro619PPl1K5c8171b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqverfbNV71b7ZqG8J4vxH9R7R7/b7Ar5P9rwLPV1dno/uJ6erq/Pl05/cykTb6O37vGx9vsJquxC1qS3HepMbUyJM5eWxwmiBpi3SjxBDzbI4VZMKe5jjvZTp1J+3u4PF5AbT0WcDy0uJn07OmbookpMIhC3FEtGwVrpEsIrpZxgOXbdcwtwjLYlBhd8eNc2Mcf3M3Dn3OvZThNgn0Dtv2XcOQbYKDlLRENHhkqgyMORcPIHQ0aeFbLKYnb43cmd4quPDdcNad0+JG+ZcKcjGi89JFT2pizu8/U6u0C2DDEF5d9py4MYOMOzXK34SoRn6S4hLJsgaW0l18zDiWySXHkJcwkBacLwleMLwla04VzxhSsfnk2F8wd9O0bC+YO+naNhfMHfTtGwvmDvp2jYXzB307RsL5g76do2F8wd9O0bC+YO+naNhfMHfTtGwvmDvp2jYXzB307RsL5g76do2F8wd9O0TGODi+K7iB3i1vZ74ZA6OhLoTKM8lvJyrqcTyThWcc84wnP7jZwcNPPgT9Vt8KgXNm26v0Dl9davFZcLbcZRIxuSjI84ZXbRMV2VnK+++yLLPuJ/En4bE7IvRn6lO8RYu21zc4uc0bsqiXH2xHINiBRbn4VCMrsatz3bg1JEkGtXv2owxNLQS7BUwORMOs1gQ05OXa7zr7khYrpaFhYYS6ZLybmMNhjqSzEQYsXXo1bcfEhJR+I9w8VOyb+3szcfdu0S/DrFXy03O1nEnHOlyVlv1Ws074VJ8rLSDUc1INgokZaTPywow8l9z8U3h+n6mFYYUu0QQfCnt1HlzVdGkhnpqJFPZ26ZeCJkY1BIbBbTzTgzryXm3W1IwrHGZb+EwbZPcqUtt/Yqy7Ey5dQZFyrLiZgdVemIps+w0luCmh4OCsiSq1Kt3CSVIOhpEy1I/wCyf//EADsRAAEDAQYCBgcFCQAAAAAAAAECAxESAAQTITFBUWEiMkBxkbEQFGBzocHwM1JygdEjNEJwgpKisuH/2gAIAQIBAT8A9k7uzjLgmlCQVrVwSOHM/qdrY10qo9W/ZzFdaq4+9Hxif0s8wW3Q2k1BdJbPEKMCdpnI+O9mro0nES4tLjqW1KoQTSiNyREqnYxHA5HtF3yu17I1pQJ5GZHx9F5zYuat6Cmd+jTHh87XHrP+4V5jtFzIVjMExjIhJOlaQY85/KNYtgu14eGquYiDxiZ0jnMc7XxQBaZSZwGwknaogT5CeeW1rj1n/cK8xZttbqqECVQTqBkOZspJQopUIUkkEcCOzaZi3rd4ppxVREbVf3RV+cz6ELWiaFFNQpMbg7WQtTagpCilQ0IsSVEkkkkkknUk6k/yJbUw21WpIdeJgNqmlAzzOyp+Y0zNmlNXpRaUw22opUULbFMEDKQNdzmYMRGhBEEg6gx4dphN2YacDaXHHZNSxUlAGgA0nPXXIzsBc3n3XMwnDSDJCEpgkZAEAGeXDW1C1uKShJUZUYSCTE65bW0yPaG7y42jDhC0TIS4moA65ZjfPvt629UlQKUhE0oSkBAJBBNI1ME5mYnKzbzjSytBAUoEGQCDJnTvz/5YkkkkySSSeJOZPtg0jEcSioJqMVHQfqeA3MCzzeE4puoLpjpDeQDpJgiYIkwe1NJC3W0K0UtKT3EgGz6EtvOITNKVQJzMdqu/27PvUf7C16/eHfxn5W01y7ShVC0LAkoUFAcYM2U8S9jQKqwuk5iRBjuys+8X3KykJMAQOXEnU/KB7OIQpaghAlSjAA+vE7W9TM0h9jE+5XnPDTXlFlJUhRSoQpJgg/Xhxs3dlLRiKUhpsmApxUVfhG/wnazl1UhGIlaHWxqpszHeNh5bx2e6dBu8vDrIbCUngVTn+RAtJmZMzM7zxnja+dJN3e3cahXNSYz/AMvhyteXkulAbkNtoCUgiIO5gE7R4WumTd5Wr7PCKTOhUQYA2J2/qHHs926TF7QOtQFAbkJmcvDx9F66LV1bOobqI3FVPzB+hZphNGM+Shqeikddw8E8AePkM7PXguAISkNtJ6rafNR3PlzOZ7M06plYWnUZEHRQOoP1kYNsW5zWGHKtcOoYc698cqYj+GzrqnnC4vU7DQAaAd3xOZzNnLzdnQkLYWQgUpAXAA7hA2Fi5c4MMLBgwcQ5HbezDrbQcraS5UmEzGRz4gwDOZGeQ9pf/8QANREAAgEBBQUFBwMFAAAAAAAAAQIRAwASITFBE0BRYXGBkaHB0RAzYHKx8PEEIjJSYnDS4f/aAAgBAwEBPwD4TqPcWQJYmFHEn78tbXK0Xtr+7O7Au9OHbFkqBkLEQVm8OBAkx2elnrObpUFVJAvECW6ZiPvlvFX3tEc58R6eyl7ysP7h4lrfqMk+beK4IuVBjcaSORj0jtttEi9eEROflnPLPS1AGHc4bRiR0xj6m36jJPmszBBebKwIYAgyDiDu+xpzNwT2x3THh7GVWi8AYMjrYqGEMJB0sAAIGAGAH+CXFRmuglEAxYZk8BjI/OeFnD0gHDswkAq5nA89O7tsDIBGonecatR1LFVSMFMFuZPD/muNqyIi4E3icASThqbBgqKWIAhc+m8tSVjexVuKmCeufrbYpBBk3oliZbAznp2CzU1ZQpGAiMcRGFgIEDIYD4wZrqloJgTA++/lZGvqGiJ0O9OSEYjMKSOoFqbFkVjmRj371U92/wAjfQ2o+6Tp5m2e8sLyleII7xFggCbOTEETkcbU0FNboJOJOPP4cJCgkmAMzbb67N7v9UYRx4R22BDAEGQcjZqoU3QrOwzCiY62WqGN0hkbQMInp+N3rYtSTRmlhyER525acLUcDUTRWw6GfS1JCgYtBZmJJH4Gs99q+LUgP5XpHEDDHph4Hhu9XCpRbS9BOgxEefd7KOL1m0LwOyfUWeob2zpiX1Oi9ef4xOFkphSWJvOc2P0HAfeAw3d0DqVPYdQeP3pa5W/jtFjK9BvR685nnNkQIoUaeJ4my0qqyVdQWMkxMntBsFrzjUWPlH+tqiM9265WDJ55Y56efxL/AP/Z"}],Yr=o=>P.jsx(Ms,{...o,options:zr}),qr=[{value:s.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],Jr=o=>P.jsx(Ms,{...o,options:qr}),xs=`${Rs}_ORDER_LIST_TYPE_COMPONENT`,Ds=`${Rs}_BULLET_LIST_TYPE_COMPONENT`,Zr=o=>{const e=Object.keys(s.PAGE_SIZE).find(n=>{const{width:i,height:a}=s.PAGE_SIZE[n];return o.width===i&&o.height===a});return e!=null?e:"A4"};function $r(o){const{hooks:t}=o,i=I.useDependency(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC).getDocumentStyle(),a=I.useDependency(s.LocaleService),[r,c]=w.useState(()=>{var d,u,m,h,g;return{paperSize:Zr(i.pageSize),orientation:(d=i.pageOrient)!=null?d:s.PageOrientType.PORTRAIT,margins:{top:(u=i.marginTop)!=null?u:0,bottom:(m=i.marginBottom)!=null?m:0,left:(h=i.marginLeft)!=null?h:0,right:(g=i.marginRight)!=null?g:0}}});w.useEffect(()=>{t.beforeClose=()=>r,t.beforeConfirm=()=>r},[r]);const l=d=>{c(u=>({...u,paperSize:d}))},A=(d,u)=>{c(m=>({...m,margins:{...m.margins,[d]:u||0}}))};return P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-4",children:[P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:a.t("page-settings.paper-size")}),P.jsx(J.Select,{value:r.paperSize,onChange:l,options:s.PAPER_TYPES.map(d=>({label:a.t(`page-settings.page-size.${d.toLocaleLowerCase()}`),value:d}))})]}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:a.t("page-settings.custom-paper-size")}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.top")}),P.jsx(J.InputNumber,{value:r.margins.top,onChange:d=>A("top",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.bottom")}),P.jsx(J.InputNumber,{value:r.margins.bottom,onChange:d=>A("bottom",d)})]})]}),P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.left")}),P.jsx(J.InputNumber,{value:r.margins.left,onChange:d=>A("left",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.right")}),P.jsx(J.InputNumber,{value:r.margins.right,onChange:d=>A("right",d)})]})]})]})]})]})}const Qo="docs.component.page-setting",Bs={id:"docs.command.page-setup",type:s.CommandType.COMMAND,handler:(o,t)=>{if(!t)return!1;const e=o.get(s.IUniverInstanceService),n=o.get(s.ICommandService),i=e.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!i)return!1;const{marginLeft:a,marginRight:r,marginBottom:c,marginTop:l,pageOrient:A,pageSize:d}=t,u=s.JSONX.getInstance(),m=i.getDocumentStyle(),{marginBottom:h,marginLeft:g,marginRight:p,marginTop:f,pageOrient:S,pageSize:E}=m,C=[];if(h===void 0){const v=u.insertOp(["documentStyle","marginBottom"],c);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginBottom"],h,c);v&&C.push(v)}if(g===void 0){const v=u.insertOp(["documentStyle","marginLeft"],a);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginLeft"],g,a);v&&C.push(v)}if(p===void 0){const v=u.insertOp(["documentStyle","marginRight"],r);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginRight"],p,r);v&&C.push(v)}if(f===void 0){const v=u.insertOp(["documentStyle","marginTop"],l);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","marginTop"],f,l);v&&C.push(v)}if(E===void 0){const v=u.insertOp(["documentStyle","pageSize"],d);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageSize"],E,d);v&&C.push(v)}if(S===void 0){const v=u.insertOp(["documentStyle","pageOrient"],A);v&&C.push(v)}else{const v=u.replaceOp(["documentStyle","pageOrient"],S,A);v&&C.push(v)}const T={id:D.RichTextEditingMutation.id,params:{unitId:i.getUnitId(),actions:[],textRanges:void 0}};return T.params.actions=C.reduce((v,O)=>s.JSONX.compose(v,O),null),!!n.syncExecuteCommand(T.id,T.params)}},Fo={id:"docs.operation.open-page-setting",type:s.CommandType.OPERATION,handler:o=>{const t=o.get(I.IConfirmService),e=o.get(s.ICommandService),n=o.get(s.LocaleService),i=t.open({id:Qo,title:{label:n.t("page-settings.document-setting")},children:{label:Qo},width:528,onClose:()=>{i.dispose()},onConfirm:a=>{if(i.dispose(),!a)return;const r=s.PAGE_SIZE[a.paperSize];e.executeCommand(Bs.id,{pageOrient:a.orientation,marginTop:a.margins.top,marginBottom:a.margins.bottom,marginLeft:a.margins.left,marginRight:a.margins.right,pageSize:r})},confirmText:n.t("page-settings.confirm"),cancelText:n.t("page-settings.cancel")});return!0}};function ec(o){const t=o.get(s.IUniverInstanceService),e=o.get(_.IRenderManagerService);return new L.Observable(n=>{const i=t.focused$.subscribe(a=>{if(a==null||t.getUnitType(a)!==s.UniverInstanceType.UNIVER_DOC)return n.next(!0);const c=e.getRenderById(a);if(c==null)return n.next(!0);c.with(D.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(A=>{n.next(A===_.DocumentEditArea.HEADER||A===_.DocumentEditArea.FOOTER)})});return()=>i.unsubscribe()})}function tc(o){const t=o.get(s.IUniverInstanceService),e=o.get(s.ICommandService);return new L.Observable(n=>{const i=e.onCommandExecuted(l=>{if(l.id===D.RichTextEditingMutation.id){const{unitId:A}=l.params,d=t.getUnit(A);if(d==null){n.next(!0);return}const{documentStyle:u}=d.getSnapshot();n.next((u==null?void 0:u.documentFlavor)!==s.DocumentFlavor.TRADITIONAL)}}),a=t.focused$.subscribe(l=>{if(l==null)return n.next(!0);const A=t.getUniverDocInstance(l),d=A==null?void 0:A.getSnapshot().documentStyle.documentFlavor;n.next(d!==s.DocumentFlavor.TRADITIONAL)}),r=t.getCurrentUniverDocInstance();if(r==null)return n.next(!0);const c=r==null?void 0:r.getSnapshot().documentStyle.documentFlavor;return n.next(c!==s.DocumentFlavor.TRADITIONAL),()=>{i.dispose(),a.unsubscribe()}})}function nc(o){const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService);return new L.Observable(n=>{const i=t.textSelection$.subscribe(a=>{if(a==null){n.next(!0);return}const{textRanges:r}=a;if(r.length!==1){n.next(!0);return}const c=r[0],{collapsed:l,startNodePosition:A,startOffset:d}=c;if(!l||d==null){n.next(!0);return}const u=e.getCurrentUniverDocInstance();if(u==null){n.next(!0);return}const m=re(o,u.getUnitId());if(m==null){n.next(!0);return}if(m.getViewModel().getCustomRangeRaw(d)){n.next(!0);return}if(A!=null){const{path:p}=A;if(p.indexOf("cells")!==-1){n.next(!0);return}}n.next(!1)});return()=>i.unsubscribe()})}function te(o){const t=o.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(i=>{if(i==null){e.next(!0);return}const{textRanges:a,rectRanges:r}=i;if(a.length===0&&r.length===0){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function oc(o){const t=o.get(s.ICommandService);return{id:Be.id,type:I.MenuItemType.BUTTON,icon:"BoldIcon",title:"Set bold",tooltip:"toolbar.bold",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.bl;e.next(r===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ic(o){const t=o.get(s.ICommandService);return{id:_e.id,type:I.MenuItemType.BUTTON,icon:"ItalicIcon",title:"Set italic",tooltip:"toolbar.italic",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.it;e.next(r===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function sc(o){const t=o.get(s.ICommandService);return{id:Ne.id,type:I.MenuItemType.BUTTON,icon:"UnderlineIcon",title:"Set underline",tooltip:"toolbar.underline",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.ul;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ac(o){const t=o.get(s.ICommandService);return{id:Pe.id,type:I.MenuItemType.BUTTON,icon:"StrikethroughIcon",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.st;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function rc(o){const t=o.get(s.ICommandService);return{id:Ee.id,type:I.MenuItemType.BUTTON,icon:"SubscriptIcon",tooltip:"toolbar.subscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUBSCRIPT)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function cc(o){const t=o.get(s.ICommandService);return{id:we.id,type:I.MenuItemType.BUTTON,icon:"SuperscriptIcon",tooltip:"toolbar.superscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=me(o);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUPERSCRIPT)},i=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===ye.id)&&n()});return n(),i.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function lc(o){const t=o.get(s.ICommandService);return{id:Ue.id,tooltip:"toolbar.font",type:I.MenuItemType.SELECTOR,label:I.FONT_FAMILY_COMPONENT,selections:[{label:{name:I.FONT_FAMILY_ITEM_COMPONENT,hoverable:!1,selectable:!1,props:{id:Ue.id}}}],value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.ff,i=()=>{var l;const r=me(o);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.ff;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===Ue.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function dc(o){const t=o.get(s.ICommandService);return{id:he.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:I.FONT_SIZE_COMPONENT,props:{min:1,max:400}},selections:I.FONT_SIZE_LIST,value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.fs,i=()=>{var l;const r=me(o);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.fs;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function Ac(o){const t=o.get(s.ICommandService);return{id:ce.id,type:I.MenuItemType.SELECTOR,tooltip:"toolbar.heading.tooltip",label:{name:I.COMMON_LABEL_COMPONENT,props:{selections:I.HEADING_LIST}},selections:I.HEADING_LIST.map(e=>({label:{name:I.HEADING_ITEM_COMPONENT,props:{value:e.value,text:e.label}},value:e.value})),value$:new L.Observable(e=>{const n=s.NamedStyleType.NORMAL_TEXT,i=()=>{var l,A;const r=Xe(o);if(r==null){e.next(n);return}const c=(A=(l=r.paragraphStyle)==null?void 0:l.namedStyleType)!=null?A:n;e.next(c)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&i()});return i(),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function uc(o){const t=o.get(s.ICommandService),e=o.get(s.ThemeService);return{id:Ce.id,icon:"FontColorDoubleIcon",tooltip:"toolbar.textColor.main",type:I.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new L.Observable(n=>{const i=s.DEFAULT_STYLES.cl.rgb,a=()=>{var A,d;const c=me(o);if(!c){n.next(i);return}const l=(d=(A=c.ts)==null?void 0:A.cl)==null?void 0:d.rgb;n.next(l!=null?l:i)},r=t.onCommandExecuted(c=>{c.id===Ce.id&&a()});return a(),r.dispose})}],value$:new L.Observable(n=>{const i=e.getColorFromTheme("gray.900"),a=t.onCommandExecuted(r=>{if(r.id===Ce.id){const c=r.params.value;n.next(c!=null?c:i)}});return n.next(i),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function hc(o){return{id:Uo.id,type:I.MenuItemType.BUTTON,icon:"HeaderFooterIcon",tooltip:"toolbar.headerFooter",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),tc(o),(t,e)=>t||e)}}const gc="GridIcon",_s="doc.menu.table";function mc(o){return{id:_s,type:I.MenuItemType.SUBITEMS,icon:gc,tooltip:"toolbar.table.main",disabled$:nc(o),hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),ec(o),(t,e)=>t||e)}}function pc(o){return{id:ln.id,title:"toolbar.table.insert",type:I.MenuItemType.BUTTON,hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function fc(o){const t=o.get(s.ICommandService);return{id:Et.id,type:I.MenuItemType.BUTTON,icon:"LeftJustifyingIcon",tooltip:"toolbar.alignLeft",disabled$:te(o),activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.LEFT)}});return e.next(!1),n.dispose}),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Sc(o){const t=o.get(s.ICommandService);return{id:Ct.id,type:I.MenuItemType.BUTTON,icon:"HorizontallyIcon",tooltip:"toolbar.alignCenter",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.CENTER)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Ic(o){const t=o.get(s.ICommandService);return{id:Tt.id,type:I.MenuItemType.BUTTON,icon:"RightJustifyingIcon",tooltip:"toolbar.alignRight",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.RIGHT)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function vc(o){const t=o.get(s.ICommandService);return{id:yt.id,type:I.MenuItemType.BUTTON,icon:"AlignTextBothIcon",tooltip:"toolbar.alignJustify",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(i=>{var r;const a=i.id;if(a===D.SetTextSelectionsOperation.id||a===ge.id){const c=Xe(o);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.JUSTIFIED)}});return e.next(!1),n.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Ec(o){return{id:pt.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",tooltip:"toolbar.horizontalLine",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}const xt=o=>new L.Observable(t=>{const e=o.get(s.IUniverInstanceService),n=o.get(D.DocSelectionManagerService);let i;const a=e.focused$.subscribe(r=>{if(i==null||i.unsubscribe(),r==null)return;const c=e.getUniverDocInstance(r);c!=null&&(i=n.textSelection$.subscribe(()=>{var d,u,m,h,g;const l=n.getDocRanges(),A=(d=l.find(p=>p.isActive))!=null?d:l[0];if(A){const p=c.getSelfOrHeaderFooterModel(A==null?void 0:A.segmentId),f=s.BuildTextUtils.range.getParagraphsInRange(A,(m=(u=p.getBody())==null?void 0:u.paragraphs)!=null?m:[],(g=(h=p.getBody())==null?void 0:h.dataStream)!=null?g:"");let S;if(f.every(E=>{var C;return S||(S=(C=E.bullet)==null?void 0:C.listType),E.bullet&&E.bullet.listType===S})){t.next(S);return}}t.next(void 0)}))});return()=>{a.unsubscribe(),i==null||i.unsubscribe()}});function Ns(o){return{id:tt.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:xs,hoverable:!1,selectable:!1},value$:xt(o)}],icon:"OrderIcon",tooltip:"toolbar.order",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),disabled$:te(o),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("ORDER_LIST")===0)))}}function Ps(o){return{id:et.id,type:I.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:Ds,hoverable:!1,selectable:!1},value$:xt(o)}],icon:"UnorderIcon",tooltip:"toolbar.unorder",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("BULLET_LIST")===0)))}}function ws(o){return{id:vt.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",tooltip:"toolbar.checklist",disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),activated$:xt(o).pipe(L.map(t=>!!(t&&t.indexOf("CHECK_LIST")===0)))}}function Cc(o){const t=o.get(s.ICommandService),e=o.get(s.IUniverInstanceService);return{id:Rt.id,type:I.MenuItemType.BUTTON,icon:"KeyboardIcon",tooltip:"toolbar.documentFlavor",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),activated$:new L.Observable(n=>{var r;const i=t.onCommandExecuted(c=>{var l;if(c.id===D.RichTextEditingMutation.id){const A=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n.next(((l=A==null?void 0:A.getSnapshot())==null?void 0:l.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN)}}),a=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);return n.next(((r=a==null?void 0:a.getSnapshot())==null?void 0:r.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN),()=>i.dispose()})}}function Tc(o){return{id:Ze.id,type:I.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon"}}function yc(o){const t=o.get(s.ICommandService),e=o.get(s.ThemeService);return{id:Te.id,tooltip:"toolbar.fillColor.main",type:I.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucketDoubleIcon",selections:[{label:{name:I.COLOR_PICKER_COMPONENT,hoverable:!1,selectable:!1},value$:new L.Observable(n=>{const i=s.DEFAULT_STYLES.bg.rgb,a=()=>{var A,d;const c=me(o);if(!c){n.next(i);return}const l=(d=(A=c.ts)==null?void 0:A.bg)==null?void 0:d.rgb;n.next(l!=null?l:i)},r=t.onCommandExecuted(c=>{c.id===Te.id&&a()});return a(),r.dispose})}],value$:new L.Observable(n=>{const i=e.getColorFromTheme("primary.600"),a=t.onCommandExecuted(r=>{if(r.id===Te.id){const c=r.params.value;n.next(c!=null?c:i)}});return n.next(i),a.dispose}),disabled$:te(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function me(o){var g,p,f,S;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=o.get(ve),i=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),a=e.getDocRanges(),r=(g=a.find(E=>E.isActive))!=null?g:a[0],c=n.getDefaultStyle(),l=(p=n.getStyleCache())!=null?p:{},A=Xe(o),d=(f=A==null?void 0:A.paragraphStyle)!=null&&f.namedStyleType?s.NAMED_STYLE_MAP[(S=A==null?void 0:A.paragraphStyle)==null?void 0:S.namedStyleType]:null;if(i==null||r==null)return{ts:{...c,...d,...l}};const{segmentId:u}=r,m=i.getSelfOrHeaderFooterModel(u).getBody();if(m==null)return{ts:{...c,...d,...l}};const h=Fi(m,r,{});return s.Tools.deleteNull(h),{ts:{...c,...d,...h,...l}}}function Xe(o){var d,u;const t=o.get(s.IUniverInstanceService),e=o.get(D.DocSelectionManagerService),n=t.getCurrentUniverDocInstance(),i=e.getDocRanges(),a=(d=i.find(m=>m.isActive))!=null?d:i[0];if(n==null||a==null)return;const{startOffset:r,segmentId:c}=a,l=(u=n.getSelfOrHeaderFooterModel(c).getBody())==null?void 0:u.paragraphs;if(l==null)return;let A=-1;for(const m of l){const{startIndex:h}=m;if(r>A&&r<=h)return m;A=h}return null}function bc(o){return{id:Fo.id,type:I.MenuItemType.BUTTON,icon:"DocumentSettingIcon",tooltip:"toolbar.pageSetup",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const Oc={[s.NamedStyleType.HEADING_1]:co,[s.NamedStyleType.HEADING_2]:lo,[s.NamedStyleType.HEADING_3]:Ao,[s.NamedStyleType.HEADING_4]:uo,[s.NamedStyleType.HEADING_5]:ho,[s.NamedStyleType.NORMAL_TEXT]:qt,[s.NamedStyleType.TITLE]:ji,[s.NamedStyleType.SUBTITLE]:Ki,[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:qt},Us={[s.NamedStyleType.HEADING_1]:{key:"H1Icon",component:ls},[s.NamedStyleType.HEADING_2]:{key:"H2Icon",component:ds},[s.NamedStyleType.HEADING_3]:{key:"H3Icon",component:As},[s.NamedStyleType.HEADING_4]:{key:"H4Icon",component:us},[s.NamedStyleType.HEADING_5]:{key:"H5Icon",component:hs},[s.NamedStyleType.NORMAL_TEXT]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.TITLE]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.SUBTITLE]:{key:"TextTypeIcon",component:Mt},[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:{key:"TextTypeIcon",component:Mt}},Qe=o=>t=>{const e=t.get(s.ICommandService),n=t.get(I.ComponentManager),i=Us[o];return n.get(i.key)||n.register(i.key,i.component),{id:Oc[o].id,type:I.MenuItemType.BUTTON,icon:i.key,tooltip:"toolbar.heading.tooltip",disabled$:te(t),hidden$:I.getMenuHiddenObservable(t,s.UniverInstanceType.UNIVER_DOC),activated$:new L.Observable(a=>{const r=s.NamedStyleType.NORMAL_TEXT,c=()=>{var u,m;const A=Xe(t);if(A==null){a.next(r===o);return}const d=(m=(u=A.paragraphStyle)==null?void 0:u.namedStyleType)!=null?m:r;a.next(d===o)},l=e.onCommandExecuted(A=>{const d=A.id;(d===D.SetTextSelectionsOperation.id||d===he.id)&&c()});return c(),l.dispose})}},Rc=Qe(s.NamedStyleType.HEADING_1),Mc=Qe(s.NamedStyleType.HEADING_2),xc=Qe(s.NamedStyleType.HEADING_3),Dc=Qe(s.NamedStyleType.HEADING_4),Bc=Qe(s.NamedStyleType.HEADING_5),_c=Qe(s.NamedStyleType.NORMAL_TEXT);Qe(s.NamedStyleType.TITLE),Qe(s.NamedStyleType.SUBTITLE);const Nc=o=>({id:Kn.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy"}),Pc=o=>({id:zn.id,type:I.MenuItemType.BUTTON,icon:"CutIcon",title:"rightClick.cut"}),wc=o=>({id:kn.id,type:I.MenuItemType.BUTTON,icon:"DeleteIcon",title:"rightClick.delete"}),Uc=o=>({id:io.id,type:I.MenuItemType.BUTTON,icon:"UnorderIcon",title:"rightClick.bulletList"}),Lc=o=>({id:so.id,type:I.MenuItemType.BUTTON,icon:"OrderIcon",title:"rightClick.orderList"}),Qc=o=>({id:ao.id,type:I.MenuItemType.BUTTON,icon:"TodoListDoubleIcon",title:"rightClick.checkList"}),Fc=o=>({id:Yn.id,type:I.MenuItemType.BUTTON,icon:"ReduceIcon",title:"toolbar.horizontalLine"}),Ls="doc.menu.insert-bellow";function Hc(o){return{id:Ls,type:I.MenuItemType.SUBITEMS,title:"rightClick.insertBellow"}}const Ho=4;var kc=Object.getOwnPropertyDescriptor,Vc=(o,t,e,n)=>{for(var i=n>1?void 0:n?kc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},un=(o,t)=>(e,n)=>t(e,n,o);function Qs(o,t){const e=Fs(o.left,o.top,t),n=Fs(o.right,o.bottom,t);return{left:e.x,top:e.y,right:n.x,bottom:n.y}}function Fs(o,t,e){const{scaleX:n,scaleY:i}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:o,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=(o-r)*n,A=(t-c)*i;return{x:l,y:A}}function Hs(o,t,e){const{scaleX:n,scaleY:i}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:o,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=o/n+r,A=t/i+c;return{x:l,y:A}}const hn=(o,t)=>{const{scene:e,mainComponent:n,engine:i}=t,a=t.with(D.DocSkeletonManagerService).getSkeleton(),r=a.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,o.segmentPage),c=o.collapsed?o.startOffset:o.endOffset-1,l=a.findNodePositionByCharIndex(c,!0,o.segmentId,o.segmentPage),A=n;if(!l||!r)return;const d=A.getOffsetConfig(),{docsLeft:u,docsTop:m}=d,h=i.getCanvasElement(),g=h.getBoundingClientRect(),p=_.pxToNum(h.style.width),{top:f,left:S,width:E}=g,C=E/p,{scaleX:T,scaleY:R}=e.getAncestorScale(),v=new be(d,a),{borderBoxPointGroup:O}=v.getRangePointData(r,l);return $t(O).map(N=>Qs(N,e)).map(N=>({left:(N.left+u*T)*C+S,right:(N.right+u*T)*C+S,top:(N.top+m*R)*C+f,bottom:(N.bottom+m*R)*C+f}))};y.DocCanvasPopManagerService=class extends s.Disposable{constructor(t,e,n,i){super(),this._globalPopupManagerService=t,this._renderManagerService=e,this._univerInstanceService=n,this._commandService=i}_createRectPositionObserver(t,e){const n=()=>{const{scene:l,engine:A}=e,d=typeof t=="function"?t():t,u=A.getCanvasElement(),m=u.getBoundingClientRect(),h=_.pxToNum(u.style.width),g=Qs(d,l),{top:p,left:f,width:S}=m,E=S/h;return{left:g.left*E+f,right:g.right*E+f,top:g.top*E+p,bottom:g.bottom*E+p}},i=n(),a=new L.BehaviorSubject(i),r=new s.DisposableCollection;r.add(this._commandService.onCommandExecuted(l=>{if(l.id===ue.id||l.id===D.RichTextEditingMutation.id){const A=n();A&&a.next(A)}}));const c=e.scene.getViewport(ae.VIEW_MAIN);return c&&r.add(c.onScrollAfter$.subscribeEvent(()=>{a.next(n())})),{position:i,position$:a,disposable:r}}_createObjectPositionObserver(t,e){const n=()=>{const{left:i,top:a,width:r,height:c}=t;return{left:i,right:i+r,top:a,bottom:a+c}};return this._createRectPositionObserver(n,e)}_createRangePositionObserver(t,e){var c;const n=(c=hn(t,e))!=null?c:[],i=new L.BehaviorSubject(n),a=new s.DisposableCollection;a.add(this._commandService.onCommandExecuted(l=>{if((l.id===ue.id||l.id===D.RichTextEditingMutation.id)&&l.params.unitId===e.unitId){const d=hn(t,e);d&&i.next(d)}}));const r=e.scene.getViewport(ae.VIEW_MAIN);return r&&a.add(r.onScrollAfter$.subscribeEvent(()=>{const l=hn(t,e);l&&i.next(l)})),{positions:n,positions$:i,disposable:a}}attachPopupToRect(t,e,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createRectPositionObserver(t,i),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToObject(t,e,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createObjectPositionObserver(t,i),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToRange(t,e,n){if(!this._univerInstanceService.getUnit(n))throw new Error(`Document not found, unitId: ${n}`);const{direction:a="top",multipleDirection:r}=e,c=this._renderManagerService.getRenderById(n);if(!c)throw new Error(`Current render not found, unitId: ${n}`);const{positions:l,positions$:A,disposable:d}=this._createRangePositionObserver(t,c),u=A.pipe(L.map(h=>a.includes("top")?h[0]:h[h.length-1])),m=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a.includes("top")?l[0]:l[l.length-1],anchorRect$:u,excludeRects:l,excludeRects$:A,direction:["top","bottom","horizontal"].some(h=>a.includes(h))&&l.length>1&&r!=null?r:a,canvasElement:c.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(m),A.complete(),d.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==m}}},y.DocCanvasPopManagerService=Vc([un(0,s.Inject(I.ICanvasPopupService)),un(1,_.IRenderManagerService),un(2,s.IUniverInstanceService),un(3,s.ICommandService)],y.DocCanvasPopManagerService);var Wc=Object.getOwnPropertyDescriptor,Gc=(o,t,e,n)=>{for(var i=n>1?void 0:n?Wc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Xc=(o,t)=>(e,n)=>t(e,n,o);const jc=(o,t,e,n)=>{var m,h,g,p,f;const i=e.findNodePositionByCharIndex(o.startOffset,!0,o.segmentId,n),a=e.getSkeletonData();let r=o.endOffset-1;if(o.segmentId){const S=(f=Array.from((h=(m=a==null?void 0:a.skeFooters.get(o.segmentId))==null?void 0:m.values())!=null?h:[])[0])!=null?f:Array.from((p=(g=a==null?void 0:a.skeHeaders.get(o.segmentId))==null?void 0:g.values())!=null?p:[])[0];S&&(r=Math.min(S.ed,r))}const c=e.findNodePositionByCharIndex(r,!0,o.segmentId,n);if(!c||!i)return;const l=t.getOffsetConfig(),A=new be(l,e),{borderBoxPointGroup:d}=A.getRangePointData(i,c);return $t(d).map(S=>({top:S.top+l.docsTop-Ho,bottom:S.bottom+l.docsTop+Ho,left:S.left+l.docsLeft,right:S.right+l.docsLeft}))},ks=(o,t,e,n)=>{const i=[];for(const a of o){const r=a.top;for(const c of a.columns){const l=c.left,A=a.colCount===1?n:c.width;let d=null;for(const u of c.lines){const m=u.paragraphIndex;if(u.paragraphStart){d&&(i.push(d),d=null);const h={top:t+r+u.top,left:e+l,right:e+l+A,bottom:t+r+u.top+u.lineHeight};d={paragraphStart:u.st,paragraphEnd:m,startIndex:m,rect:h,fisrtLine:{top:t+r+u.top+u.marginTop+u.paddingTop,left:e+l,right:e+l+A,bottom:t+r+u.top+u.marginTop+u.paddingTop+u.contentHeight}}}else d&&d.startIndex===m&&(d.rect.bottom=t+r+u.top+u.lineHeight)}d&&i.push(d)}}return i},Kc=(o,t,e,n=-1)=>{const i=e.findPositionByGlyph(o,n);if(!i)return;const a=t.getOffsetConfig(),r={...i,isBack:!0},c=new be(a,e),{borderBoxPointGroup:l}=c.getRangePointData(r,r),d=$t(l)[0];return{top:d.top+a.docsTop,bottom:d.bottom+a.docsTop,left:d.left+a.docsLeft,right:d.left+a.docsLeft+o.width}};function je(o,t,e){const{left:n,right:i,top:a,bottom:r}=e;return o>=n&&o<=i&&t>=a&&t<=r}y.DocEventManagerService=class extends s.Disposable{constructor(e,n){super();B(this,"_hoverCustomRanges$",new L.BehaviorSubject([]));B(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe(L.distinctUntilChanged((e,n)=>e.length===n.length&&e.every((i,a)=>n[a].range.rangeId===i.range.rangeId&&n[a].segmentId===i.segmentId&&n[a].segmentPageIndex===i.segmentPageIndex&&n[a].range.startIndex===i.range.startIndex))));B(this,"_clickCustomRanges$",new L.Subject);B(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable());B(this,"_hoverBullet$",new L.Subject);B(this,"hoverBullet$",this._hoverBullet$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.paragraph.startIndex)===(n==null?void 0:n.paragraph.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.segmentPageIndex)===(n==null?void 0:n.segmentPageIndex))));B(this,"_clickBullet$",new L.Subject);B(this,"clickBullets$",this._clickBullet$.asObservable());B(this,"_hoverParagraph$",new L.BehaviorSubject(null));B(this,"hoverParagraph$",this._hoverParagraph$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphRealTime$",this._hoverParagraph$.asObservable());B(this,"_hoverParagraphLeft$",new L.BehaviorSubject(null));B(this,"hoverParagraphLeft$",this._hoverParagraphLeft$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphLeftRealTime$",this._hoverParagraphLeft$.asObservable());B(this,"_hoverTableCell$",new L.Subject);B(this,"hoverTableCell$",this._hoverTableCell$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.rowIndex)===(n==null?void 0:n.rowIndex)&&(e==null?void 0:e.colIndex)===(n==null?void 0:n.colIndex)&&(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableCellRealTime$",this._hoverTableCell$.asObservable());B(this,"_hoverTable$",new L.Subject);B(this,"hoverTable$",this._hoverTable$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableRealTime$",this._hoverTable$.asObservable());B(this,"_customRangeDirty",!0);B(this,"_bulletDirty",!0);B(this,"_paragraphDirty",!0);B(this,"_customRangeBounds",[]);B(this,"_bulletBounds",[]);B(this,"_paragraphBounds",new Map);B(this,"_paragraphLeftBounds",[]);B(this,"_tableParagraphBounds",new Map);B(this,"_segmentParagraphBounds",new Map);B(this,"_tableCellBounds",new Map);B(this,"_tableBounds",new Map);this._context=e,this._docSkeletonManagerService=n,this._initResetDirty(),this._initEvents(),this._initPointer()}get hoverParagraph(){return this._hoverParagraph$.value}get hoverParagraphLeft(){return this._hoverParagraphLeft$.value}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=_.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(n=>{n.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(_.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0})),this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(e=>e.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0}))}_initEvents(){this.disposeWithMe(s.fromEventSubject(this._context.scene.onPointerMove$).pipe(L.throttleTime(30)).subscribe(i=>{if(i.buttons>0){this._hoverBullet$.next(null),this._hoverCustomRanges$.next([]),this._hoverParagraph$.next(null),this._hoverParagraphLeft$.next(null),this._hoverTableCell$.next(null),this._hoverTable$.next(null);return}const{x:a,y:r}=Hs(i.offsetX,i.offsetY,this._context.scene);this._hoverCustomRanges$.next(this._calcActiveRanges({x:a,y:r})),this._hoverParagraph$.next(this._calcActiveParagraph({x:a,y:r})),this._hoverParagraphLeft$.next(this._calcActiveParagraphLeft({x:a,y:r})),this._hoverBullet$.next(this._calcActiveBullet({x:a,y:r}))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));const e=s.fromEventSubject(this._context.mainComponent.onPointerDown$),n=s.fromEventSubject(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe(L.switchMap(i=>n.pipe(L.take(1),L.map(a=>({down:i,up:a})))),L.filter(({down:i,up:a})=>i.target===a.target&&a.timeStamp-i.timeStamp<300)).subscribe(({down:i})=>{if(i.button===2)return;const a=Hs(i.offsetX,i.offsetY,this._context.scene),r=this._calcActiveRanges(a);r.length&&this._clickCustomRanges$.next(r.pop());const c=this._calcActiveBullet(a);c&&this._clickBullet$.next(c)}))}_buildCustomRangeBoundsBySegment(e,n=-1){var r,c,l;const i=(l=(c=(r=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:r.getBody())==null?void 0:c.customRanges)!=null?l:[],a=[];return i.forEach(A=>{const d={startOffset:A.startIndex,endOffset:A.endIndex+1,segmentId:e},u=jc(d,this._documents,this._skeleton,n);if(!u)return null;a.push({customRange:A,rects:u,segmentId:e,segmentPageIndex:n})}),a}_buildCustomRangeBounds(){var n;if(!this._customRangeDirty)return;this._customRangeDirty=!1;const e=[];e.push(...this._buildCustomRangeBoundsBySegment()),(n=this._skeleton.getSkeletonData())==null||n.pages.forEach((i,a)=>{i.headerId&&e.push(...this._buildCustomRangeBoundsBySegment(i.headerId,a)),i.footerId&&e.push(...this._buildCustomRangeBoundsBySegment(i.footerId,a))}),this._customRangeBounds=e}_calcActiveRanges(e){this._buildCustomRangeBounds();const{x:n,y:i}=e;return this._customRangeBounds.filter(r=>r.rects.some(c=>je(n,i,c))).map(r=>({segmentId:r.segmentId,range:r.customRange,segmentPageIndex:r.segmentPageIndex,rects:r.rects}))}_buildBulletBoundsBySegment(e,n=-1){var A,d,u,m,h;const i=(A=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:A.getBody(),a=((d=i==null?void 0:i.paragraphs)!=null?d:[]).filter(g=>g.bullet&&g.bullet.listType.indexOf("CHECK_LIST")===0),r=[],c=this._skeleton.getSkeletonData();if(!c)return r;const l=g=>{var p,f,S;for(const E of g){const C=[...E.sections];if(E.skeTables){const T=Array.from(E.skeTables.values());C.push(...T.map(R=>R.rows.map(v=>v.cells.map(O=>O.sections))).flat(4))}for(const T of C)for(const R of T.columns)for(const v of R.lines)if(v.paragraphStart){const O=a.find(M=>M.startIndex===v.paragraphIndex);if(O){const M=v,b=(S=(f=(p=M==null?void 0:M.divides)==null?void 0:p[0])==null?void 0:f.glyphGroup)==null?void 0:S[0];if(!b)continue;const N=Kc(b,this._documents,this._skeleton,n);if(!N)continue;r.push({rect:N,segmentId:e,segmentPageIndex:n,paragraph:O})}}}return r};if(e){const g=(h=(u=c.skeFooters.get(e))==null?void 0:u.values())!=null?h:(m=c.skeHeaders.get(e))==null?void 0:m.values();return g?l(Array.from(g)):r}return l(c.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((n,i)=>{n.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.headerId,i)),n.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.footerId,i))}))}_calcActiveBullet(e){this._buildBulletBounds();const{x:n,y:i}=e;return this._bulletBounds.find(r=>je(n,i,r.rect))}_buildParagraphBoundsBySegment(e){var c,l,A;const n=this._skeleton.getSkeletonData(),a=this._documents.getOffsetConfig();if(!n)return null;const r=d=>{const u=new Map,m=(h,g,p,f)=>{ks(h.sections,p,f,h.pageWidth-h.marginLeft-h.marginRight).forEach(E=>{if(!u.has(E.startIndex))u.set(E.startIndex,{rect:E.rect,paragraphStart:E.paragraphStart,paragraphEnd:E.paragraphEnd,startIndex:E.startIndex,rects:[E.rect],pageIndex:g,segmentId:e,firstLine:E.fisrtLine});else{const C=u.get(E.startIndex);C&&(C.rect.bottom=E.rect.bottom,C.rects.push(E.rect))}})};for(let h=0;h<d.length;h++){const g=d[h],p=((g.pageHeight===1/0?0:g.pageHeight)+a.pageMarginTop)*h+g.marginTop+a.docsTop,f=g.marginLeft+a.docsLeft;g.skeTables&&Array.from(g.skeTables.values()).forEach(S=>{const E=S.left+f,C=S.top+p,T=E+S.width,R=C+S.height,v=S.tableId;this._tableBounds.set(v,{rect:{left:E,top:C,right:T,bottom:R},pageIndex:h,tableId:v}),S.rows.forEach((O,M)=>{O.cells.forEach((b,N)=>{const x=((g.pageHeight===1/0?0:g.pageHeight)+a.pageMarginTop)*h+S.top+a.docsTop+g.marginTop+O.top+b.marginTop,U=S.left+a.docsLeft+g.marginLeft+b.left+b.marginLeft,F=ks(b.sections,x,U,b.pageWidth-b.marginLeft-b.marginRight);let V=this._tableParagraphBounds.get(v);V||(V=[],this._tableParagraphBounds.set(v,V)),V.push(...F.map(Q=>({rect:Q.rect,paragraphStart:Q.paragraphStart,paragraphEnd:Q.paragraphEnd,startIndex:Q.startIndex,pageIndex:h,segmentId:e,rowIndex:M,colIndex:N,firstLine:Q.fisrtLine,tableId:v})));let H=this._tableCellBounds.get(v);H||(H=[],this._tableCellBounds.set(v,H)),H.push({rect:{top:x,left:U,right:U+b.pageWidth-b.marginLeft-b.marginRight,bottom:x+b.pageHeight-b.marginBottom-b.marginTop},pageIndex:h,rowIndex:M,colIndex:N,tableId:v})})})}),m(g,h,p,f)}return u};if(e){const d=(A=(c=n.skeFooters.get(e))==null?void 0:c.values())!=null?A:(l=n.skeHeaders.get(e))==null?void 0:l.values();return d?r(Array.from(d)):null}return r(n.pages)}_buildParagraphBounds(){var n,i;if(!this._paragraphDirty)return;this._paragraphDirty=!1,this._tableParagraphBounds=new Map,this._tableCellBounds=new Map,this._tableBounds=new Map,this._paragraphBounds=(n=this._buildParagraphBoundsBySegment())!=null?n:new Map,this._paragraphLeftBounds=Array.from(this._paragraphBounds.values()).map(a=>({...a,rect:{left:a.rect.left-60,right:a.rect.left,top:a.rect.top,bottom:a.rect.bottom}}));const e=a=>{var r;this._segmentParagraphBounds.set(a,(r=this._buildParagraphBoundsBySegment(a))!=null?r:new Map)};(i=this._skeleton.getSkeletonData())==null||i.pages.forEach(a=>{a.headerId&&e(a.headerId),a.footerId&&e(a.footerId)})}_calcActiveParagraph(e){var c,l;this._buildParagraphBounds();const{x:n,y:i}=e,a=Array.from(this._tableBounds.values()).find(A=>je(n,i,A.rect));if(this._hoverTable$.next(a),a){const A=(c=this._tableCellBounds.get(a.tableId))==null?void 0:c.find(m=>je(n,i,m.rect));if(this._hoverTableCell$.next(A),!A)return null;const d=(l=this._tableParagraphBounds.get(A.tableId))==null?void 0:l.filter(m=>m.colIndex===A.colIndex&&m.rowIndex===A.rowIndex),u=d==null?void 0:d.find(m=>je(n,i,m.rect));return u&&{...u,rects:[u.rect]}}let r;for(const A of this._paragraphBounds){const d=A[1];if(d.rects.some(u=>je(n,i,u))){r=d;break}}return r}_calcActiveParagraphLeft(e){this._buildParagraphBounds();const{x:n,y:i}=e;return this._paragraphLeftBounds.find(r=>je(n,i,r.rect))}get paragraphBounds(){return this._buildParagraphBounds(),this._paragraphBounds}findParagraphBoundByIndex(e){this._buildParagraphBounds();const n=this._paragraphBounds.get(e);return n||Array.from(this._tableParagraphBounds.values()).flat().find(a=>a.startIndex===e)}},y.DocEventManagerService=Gc([Xc(1,s.Inject(D.DocSkeletonManagerService))],y.DocEventManagerService);const zc=[he.id,Be.id,_e.id,Ne.id,Pe.id,Ee.id,we.id,Ce.id,Te.id];function Yc(o){const{avaliableMenus:t=zc}=o,e=I.useDependency(I.IMenuManagerService),[n,i]=w.useState([]);return w.useEffect(()=>{function a(){const c=e.getFlatMenuByPositionKey(I.MenuManagerPosition.RIBBON),l=[];for(const A of t){const d=c.find(u=>u.key===A);d&&l.push(d)}i(l)}a();const r=e.menuChanged$.subscribe(a);return()=>{r.unsubscribe()}},[e]),P.jsx("div",{className:J.clsx("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:!univer-border-gray-700 dark:!univer-bg-gray-900",J.borderClassName),children:n.map(a=>a.item&&P.jsx("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:P.jsx(I.ToolbarItem,{...a.item},a.key)},a.key))})}var qc=Object.getOwnPropertyDescriptor,Jc=(o,t,e,n)=>{for(var i=n>1?void 0:n?qc(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Dt=(o,t)=>(e,n)=>t(e,n,o);const Vs="univer.doc.float-menu";function Zc(o,t){if(o==null||t==null)return!1;const{glyph:e,...n}=o,{glyph:i,...a}=t;return s.deepCompare(n,a)}const $c=[s.DataStreamTreeTokenType.CUSTOM_BLOCK,s.DataStreamTreeTokenType.PARAGRAPH];let gn=class extends s.Disposable{constructor(t,e,n,i,a,r){super();B(this,"_floatMenu",null);this._context=t,this._docSelectionManagerService=e,this._docCanvasPopManagerService=n,this._componentManager=i,this._univerInstanceService=a,this._docSelectionRenderService=r,!s.isInternalEditorID(this._context.unitId)&&(this._registerFloatMenu(),this._initSelectionChange(),this.disposeWithMe(()=>{this._hideFloatMenu()}))}get floatMenu(){return this._floatMenu}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register(Vs,Yc))}_initSelectionChange(){this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(()=>{this._hideFloatMenu()})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(t=>{var a,r;const{unitId:e,textRanges:n}=t;if(e!==this._context.unitId)return;const i=n.length>0&&n.find(c=>!c.collapsed);if(i){if(i.startOffset===((a=this._floatMenu)==null?void 0:a.start)&&i.endOffset===((r=this._floatMenu)==null?void 0:r.end))return;this._hideFloatMenu(),this._showFloatMenu(e,i);return}this._hideFloatMenu()}))}_hideFloatMenu(){var t;(t=this._floatMenu)==null||t.disposable.dispose(),this._floatMenu=null}_showFloatMenu(t,e){var r,c,l;const n=this._univerInstanceService.getUnit(t,s.UniverInstanceType.UNIVER_DOC);if(!n||n.getDisabled())return;const i=(r=n.getBody())==null?void 0:r.dataStream[e.startOffset];if(e.endOffset-e.startOffset===1&&i&&$c.includes(i))return;const a=(l=(c=n.getBody())==null?void 0:c.customRanges)==null?void 0:l.filter(A=>A.wholeEntity);if(!(a!=null&&a.some(A=>A.startIndex===e.startOffset&&A.endIndex===e.endOffset-1)))return this._floatMenu={disposable:this._docCanvasPopManagerService.attachPopupToRange(e,{componentKey:Vs,direction:e.direction==="backward"||Zc(e.startNodePosition,e.endNodePosition)?"top-center":"bottom-center",offset:[0,4]},t),start:e.startOffset,end:e.endOffset},s.toDisposable(()=>this._hideFloatMenu())}};gn=Jc([Dt(1,s.Inject(D.DocSelectionManagerService)),Dt(2,s.Inject(y.DocCanvasPopManagerService)),Dt(3,s.Inject(I.ComponentManager)),Dt(4,s.Inject(s.IUniverInstanceService)),Dt(5,s.Inject(y.DocSelectionRenderService))],gn);var el=Object.getOwnPropertyDescriptor,tl=(o,t,e,n)=>{for(var i=n>1?void 0:n?el(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Bt=(o,t)=>(e,n)=>t(e,n,o);let mn=class extends s.Disposable{constructor(t,e,n,i,a,r){super();B(this,"_paragrahMenu",null);this._context=t,this._docSelectionManagerService=e,this._docEventManagerService=n,this._docPopupManagerService=i,this._docSkeletonManagerService=a,this._floatMenuService=r,!s.isInternalEditorID(this._context.unitId)&&this._init()}get activeParagraph(){var t;return(t=this._paragrahMenu)==null?void 0:t.paragraph}_isCursorInActiveParagraph(){if(!this._paragrahMenu)return!1;const t=this._docSelectionManagerService.getActiveTextRange();return!(!(t!=null&&t.collapsed)||!(t!=null&&t.collapsed)||t.startOffset<this._paragrahMenu.paragraph.paragraphStart||t.startOffset>this._paragrahMenu.paragraph.paragraphEnd)}setParagraphMenuActive(t){this._paragrahMenu&&(this._paragrahMenu.active=t,this._isCursorInActiveParagraph()||this._docSelectionManagerService.replaceDocRanges([{startOffset:this._paragrahMenu.paragraph.paragraphStart,endOffset:this._paragrahMenu.paragraph.paragraphStart}]))}_init(){const t=n=>{var a;if(this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY&&!this._floatMenuService.floatMenu&&!this._context.unit.getDisabled()){if((a=this._paragrahMenu)!=null&&a.active)return;if(n){this.showParagraphMenu(n);return}}this.hideParagraphMenu(!0)};this.disposeWithMe(L.combineLatest([this._docEventManagerService.hoverParagraphRealTime$,this._docEventManagerService.hoverParagraphLeft$]).pipe(L.throttleTime(16)).subscribe(([n,i])=>{const a=n!=null?n:i;t(a)}));let e=0;this.disposeWithMe(this._context.scene.getViewport(ae.VIEW_MAIN).onScrollAfter$.subscribeEvent(n=>{e!==n.scrollY&&(e=n.scrollY,this.hideParagraphMenu(!0))})),this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(()=>{this.hideParagraphMenu(!0)}))}showParagraphMenu(t){var l,A,d;if(((l=this._paragrahMenu)==null?void 0:l.paragraph.startIndex)===t.startIndex)return;this.hideParagraphMenu(!0);const e=(d=(A=this._context.unit.getBody())==null?void 0:A.dataStream)!=null?d:"",n=t?e.slice(t.paragraphStart,t.paragraphEnd):"";if(n==="\b"||n==="")return;const c=this._docPopupManagerService.attachPopupToRect(t.firstLine,{componentKey:"doc.paragraph.menu",direction:"left-center",onClickOutside:()=>{this._docSelectionManagerService.textSelection$.pipe(L.first()).subscribe(()=>{this._isCursorInActiveParagraph()||this.hideParagraphMenu(!0)})},zIndex:101},this._context.unitId);this._paragrahMenu={paragraph:t,disposable:c,active:!1}}hideParagraphMenu(t=!1){this._paragrahMenu&&(this._paragrahMenu.disposable.canDispose()||t)&&(this._paragrahMenu.disposable.dispose(),this._paragrahMenu=null)}};mn=tl([Bt(1,s.Inject(D.DocSelectionManagerService)),Bt(2,s.Inject(y.DocEventManagerService)),Bt(3,s.Inject(y.DocCanvasPopManagerService)),Bt(4,s.Inject(D.DocSkeletonManagerService)),Bt(5,s.Inject(gn))],mn);const nl=({popup:o})=>{var v,O;const[t,e]=w.useState(!1),n=w.useRef(null),i=I.useDependency(s.ICommandService),a=I.useDependency(I.ILayoutService),r=w.useRef(null),c=w.useRef(!1),l=I.useDependency(_.IRenderManagerService),A=I.useDependency(s.IUniverInstanceService),d=l.getRenderById(o.unitId),u=A.getUnit(o.unitId,s.UniverInstanceType.UNIVER_DOC),m=d==null?void 0:d.with(mn),h=d==null?void 0:d.with(y.DocEventManagerService),g=I.useObservable(h==null?void 0:h.hoverParagraph$),p=I.useObservable(h==null?void 0:h.hoverParagraphLeft$),f=(v=g!=null?g:p)==null?void 0:v.startIndex,S=w.useMemo(()=>{var M,b;return(b=(M=u==null?void 0:u.getBody())==null?void 0:M.paragraphs)==null?void 0:b.find(N=>N.startIndex===f)},[u,g]),E=(O=S==null?void 0:S.paragraphStyle)==null?void 0:O.namedStyleType,C=Us[E!=null?E:s.NamedStyleType.NORMAL_TEXT],T=w.useMemo(()=>new L.BehaviorSubject({left:0,right:0,top:0,bottom:0}),[]),R=()=>{e(!1),m==null||m.hideParagraphMenu(!0)};return P.jsxs(P.Fragment,{children:[P.jsxs("div",{"data-u-comp":"paragraph-menu",ref:r,className:J.clsx("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",J.borderClassName,{"univer-bg-gray-100 dark:!univer-bg-gray-700":t,"univer-bg-white dark:!univer-bg-gray-700":!t}),onMouseEnter:M=>{var N,x,U,F,V,H;(N=o.onPointerEnter)==null||N.call(o,M),c.current=!0;const b=(x=r.current)==null?void 0:x.getBoundingClientRect();T.next({left:((U=b==null?void 0:b.left)!=null?U:0)-4,right:(F=b==null?void 0:b.right)!=null?F:0,top:(V=b==null?void 0:b.top)!=null?V:0,bottom:(H=b==null?void 0:b.bottom)!=null?H:0})},onMouseLeave:()=>{c.current=!1},onClick:()=>{e(!0),m==null||m.setParagraphMenuActive(!0)},children:[P.jsx(C.component,{className:"univer-size-4 univer-text-gray-900 dark:!univer-text-white"}),P.jsx(cs,{className:"univer-size-3 univer-text-gray-600 dark:!univer-text-gray-200"})]}),t&&P.jsx(I.RectPopup,{portal:!0,mask:!0,maskZIndex:100,anchorRect$:T,direction:"left",onMaskClick:R,children:P.jsx("section",{ref:n,onMouseEnter:M=>{var b;(b=o.onPointerEnter)==null||b.call(o,M),c.current=!0},onMouseLeave:()=>{c.current=!1},children:P.jsx(I.DesktopMenu,{style:{width:212},menuType:I.ContextMenuPosition.PARAGRAPH,onOptionSelect:M=>{const{label:b,commandId:N,value:x}=M;i&&i.executeCommand(N!=null?N:b,{value:x}),a.focus(),R()}})})})]})};function ee(o){return o.getContextValue(s.FOCUSING_DOC)&&o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}function ol(o){return o.getContextValue(s.FOCUSING_DOC)&&o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!o.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}const il={id:ke.id,binding:I.KeyCode.TAB,preconditions:ee},sl={id:ke.id,binding:I.KeyCode.TAB|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{shift:!0}},al={id:Be.id,binding:I.KeyCode.B|I.MetaKeys.CTRL_COMMAND,preconditions:ee},rl={id:_e.id,binding:I.KeyCode.I|I.MetaKeys.CTRL_COMMAND,preconditions:ee},cl={id:Ne.id,binding:I.KeyCode.U|I.MetaKeys.CTRL_COMMAND,preconditions:ee},ll={id:Pe.id,binding:I.KeyCode.X|I.MetaKeys.SHIFT|I.MetaKeys.CTRL_COMMAND,preconditions:ee},dl={id:Ee.id,binding:I.KeyCode.COMMA|I.MetaKeys.CTRL_COMMAND,preconditions:ee},Al={id:we.id,binding:I.KeyCode.PERIOD|I.MetaKeys.CTRL_COMMAND,preconditions:ee},ul={id:Et.id,binding:I.KeyCode.L|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},hl={id:Tt.id,binding:I.KeyCode.R|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},gl={id:Ct.id,binding:I.KeyCode.E|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},ml={id:yt.id,binding:I.KeyCode.J|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},pl={id:tt.id,binding:I.KeyCode.Digit7|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},fl={id:et.id,binding:I.KeyCode.Digit8|I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT,preconditions:ee},pn="docs-ui.config",Ws={layout:{docContainerConfig:ii,toolbarConfig:oi}},Sl=[50,80,100,130,150,170,200,400],Il=[10,400];function vl(){const o=I.useDependency(s.ICommandService),t=I.useDependency(s.IUniverInstanceService),e=w.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[]),n=I.useObservable(e),i=w.useCallback(()=>{var A,d;if(!n)return 100;const l=((d=(A=n.getSettings())==null?void 0:A.zoomRatio)!=null?d:1)*100;return Math.round(l)},[n]),[a,r]=w.useState(()=>i());w.useEffect(()=>(r(i()),o.onCommandExecuted(A=>{if(A.id===ue.id){const d=i();r(d)}}).dispose),[o,i]);function c(l){if(r(l),n==null)return;const A=l/100;o.executeCommand(ue.id,{unitId:n.getUnitId(),zoomRatio:A})}return P.jsx(I.Slider,{min:Il[0],value:a,shortcuts:Sl,onChange:c})}function El(o){return P.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:P.jsx(vl,{})})}function Cl(){var i,a,r;const o=I.useDependency(s.IUniverInstanceService),t=I.useConfigValue(pn),e=I.useObservable(()=>o.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),n=(r=(a=(i=t==null?void 0:t.layout)==null?void 0:i.docContainerConfig)==null?void 0:a.footer)!=null?r:!0;return e?null:n&&P.jsxs("div",{className:"univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5 univer-py-1.5",children:[P.jsx("div",{}),P.jsx(El,{})]})}const Tl="univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-cursor-pointer univer-pr-1 ",yl="univer-text-base univer-font-semibold",bl="univer-text-sm univer-font-semibold",Ol="univer-text-sm",Rl=w.forwardRef((o,t)=>{const{menus:e,onClick:n,className:i,style:a,mode:r,maxHeight:c,activeId:l,open:A,onOpenChange:d,maxWidth:u,wrapperClass:m,wrapperStyle:h,iconClass:g,iconStyle:p}=o,f=r==="side-bar",S=w.useRef(null),E=w.useRef(e);E.current=e;const C=w.useMemo(()=>({scrollTo:T=>{var x;if(!E.current||E.current.findIndex(U=>U.id===T)===-1||!S.current)return;const v=document.getElementById(`univer-side-menu-${T}`);if(!v)return;const O=v.offsetTop,M=S.current.clientHeight,b=S.current.scrollHeight-M,N=Math.max(0,Math.min(O-M/2+v.clientHeight/2,b));(x=S.current)==null||x.scrollTo({behavior:"smooth",top:N})}}),[]);return w.useImperativeHandle(t,()=>C),w.useEffect(()=>{l&&C.scrollTo(l)},[l,C]),P.jsxs("div",{className:J.clsx("univer-relative",m),style:h,children:[P.jsx("div",{onClick:()=>d==null?void 0:d(!A),className:J.clsx("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-h-8 univer-w-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-sm dark:!univer-bg-gray-600 dark:!univer-text-gray-200",g),style:p,children:A?P.jsx(ms,{}):P.jsx(is,{})}),P.jsx("div",{className:J.clsx(i,`
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-px-4 univer-pb-4 univer-pt-14 univer-transition-all univer-duration-300
                    `,{"univer-rounded-r-2xl univer-bg-white univer-shadow univer-backdrop-blur-[10px] dark:!univer-bg-gray-900":f}),style:{...a,transform:A?"translateX(0)":"translateX(-100%)",maxHeight:c,opacity:A?1:0,maxWidth:u!=null?u:r==="side-bar"?320:180,paddingRight:r==="float"?void 0:0},children:P.jsx("div",{ref:S,className:J.clsx("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden",J.scrollbarClassName),children:e==null?void 0:e.map(T=>P.jsx("div",{id:`univer-side-menu-${T.id}`,className:J.clsx(Tl,{[yl]:T.isTitle,[bl]:T.level===1,[Ol]:T.level>1,"univer-text-gray-500 dark:!univer-text-gray-400":T.id!==l,"univer-text-gray-800 dark:!univer-text-gray-200":T.id===l}),style:{paddingLeft:(T.level-1)*12},onClick:()=>{n==null||n(T)},children:T.text},T.id))})})]})}),Ml=o=>{switch(o){case s.NamedStyleType.HEADING_1:return 1;case s.NamedStyleType.HEADING_2:return 2;case s.NamedStyleType.HEADING_3:return 3;case s.NamedStyleType.HEADING_4:return 4;case s.NamedStyleType.HEADING_5:return 5;case s.NamedStyleType.TITLE:return 1;default:return 1}};function xl(o,t,e,n){var c,l;if(!o)return;const i=Array.from(o.values()),a=i.findIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);if(a===-1)return;const r=i==null?void 0:i.findLastIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);for(let A=a;A<=r;A++){const d=i[A],u=t.get(d.startIndex);if((c=u==null?void 0:u.paragraphStyle)!=null&&c.headingId)return u.paragraphStyle.headingId}for(let A=a;A>=0;A--){const d=i[A],u=t.get(d.startIndex);if((l=u==null?void 0:u.paragraphStyle)!=null&&l.headingId)return u.paragraphStyle.headingId}}const Gs="__title";function Dl(){var t,e,n;const o=I.useConfigValue(pn);return(n=(e=(t=o==null?void 0:o.layout)==null?void 0:t.docContainerConfig)==null?void 0:e.sideMenu)==null||n?P.jsx(Bl,{}):null}function Bl(){var N,x,U,F,V,H,Q,j,X;const o=I.useDependency(s.ICommandService),t=I.useDependency(s.IUniverInstanceService),e=I.useObservable(w.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[])),n=I.useDependency(_.IRenderManagerService),i=(x=(N=e==null?void 0:e.getBody())==null?void 0:N.dataStream)!=null?x:"",[a,r]=w.useState(0),[c,l]=w.useState(void 0),A=(U=e==null?void 0:e.getUnitId())!=null?U:"",d=n.getRenderById(A),u=e==null?void 0:e.getTitle(),m=d==null?void 0:d.with(y.DocEventManagerService),h=m==null?void 0:m.paragraphBounds,g=(V=(F=d==null?void 0:d.mainComponent)==null?void 0:F.left)!=null?V:0,p=(H=d==null?void 0:d.engine.height)!=null?H:0,f=(Q=d==null?void 0:d.scene.scaleY)!=null?Q:1,S=(X=(j=e==null?void 0:e.getBody())==null?void 0:j.paragraphs)!=null?X:[],E=w.useMemo(()=>{const k=new Map;return S.forEach(W=>{k.set(W.startIndex,W)}),k},[S]);I.useObservable(w.useMemo(()=>d!=null&&d.engine.onTransformChange$?s.fromEventSubject(d==null?void 0:d.engine.onTransformChange$).pipe(L.throttleTime(33)):L.of(null),[d==null?void 0:d.engine.onTransformChange$]));const C=g<180?"float":"side-bar",T=S==null?void 0:S.filter(k=>{var W;return((W=k.paragraphStyle)==null?void 0:W.namedStyleType)!==void 0&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.SUBTITLE&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.NORMAL_TEXT}).map(k=>{var q;const W=Ml(k.paragraphStyle.namedStyleType),G=h==null?void 0:h.get(k.startIndex);if(!G)return null;const{paragraphStart:K,paragraphEnd:Y}=G;return{id:k.paragraphStyle.headingId,text:s.getPlainText(i.slice(K,Y)),level:W,isTitle:((q=k.paragraphStyle)==null?void 0:q.namedStyleType)===s.NamedStyleType.TITLE}}).filter(k=>k==null?void 0:k.text),R=I.useEvent(k=>{const W=k.viewportScrollY,G=W+p/f,K=xl(h,E,W,G);K&&l(K)}),v=T!=null&&T.find(k=>k.isTitle)?T:[...u?[{id:Gs,text:u,level:1,isTitle:!0}]:[],...T!=null?T:[]].filter(Boolean),[O,M]=w.useState(!0);w.useEffect(()=>{const k=s.debounce(r,100),W=o.onCommandExecuted(G=>{G.id===D.RichTextEditingMutation.id&&G.params.unitId===(e==null?void 0:e.getUnitId())&&k(Y=>Y+1)});return()=>{W.dispose()}},[o,e]),w.useEffect(()=>{const k=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!k)return;const W=s.fromEventSubject(k.onScrollAfter$).pipe(L.throttleTime(33)).subscribe(R);return()=>{W.unsubscribe()}},[d]);const b=I.useEvent(k=>{const W=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!W)return;if(k.id===Gs){W.scrollToViewportPos({viewportScrollY:0});return}const G=S.find(Y=>{var q;return((q=Y.paragraphStyle)==null?void 0:q.headingId)===k.id});if(!G)return;const K=h==null?void 0:h.get(G.startIndex);K&&(W.scrollToViewportPos({viewportScrollY:K.rect.top}),l(k.id))});return!e||s.isInternalEditorID(A)||!(v!=null&&v.length)?null:P.jsx("div",{className:"univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",children:P.jsx(Rl,{menus:v,open:O,onOpenChange:M,mode:C,maxWidth:C==="float"?void 0:Math.floor(g)-10,wrapperClass:"univer-mt-12",activeId:c,onClick:b,maxHeight:p-48})})}const pe={id:"doc-paragraph-setting.command",type:s.CommandType.COMMAND,handler:async(o,t)=>{var C,T,R,v,O;const e=o.get(D.DocSelectionManagerService),n=o.get(s.IUniverInstanceService),i=o.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getDocRanges();if(!a||r.length===0||!t)return!1;const c=r[0].segmentId,l=a.getUnitId(),A=a.getSelfOrHeaderFooterModel(c),d=(T=(C=A.getBody())==null?void 0:C.paragraphs)!=null?T:[],u=(v=(R=A.getBody())==null?void 0:R.dataStream)!=null?v:"",m=(O=s.BuildTextUtils.range.getParagraphsInRanges(r,d,u))!=null?O:[],h={id:D.RichTextEditingMutation.id,params:{unitId:l,actions:[],textRanges:r}},g=new s.MemoryCursor;g.reset();const p=new s.TextX,f=s.JSONX.getInstance();for(const M of m){const{startIndex:b}=M;p.push({t:s.TextXActionType.RETAIN,len:b-g.cursor});const N={...M.paragraphStyle,...t.paragraph};p.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...M,paragraphStyle:N,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),g.moveCursorTo(b+1)}const S=Z(a,c);return h.params.actions=f.editOp(p.serialize(),S),!!i.syncExecuteCommand(h.id,h.params)}},_l=()=>{const o=I.useDependency(D.DocSelectionManagerService),t=I.useDependency(st),e=w.useMemo(()=>o.getDocRanges(),[]);return w.useEffect(()=>{e.length||t.closePanel()},[e]),e},Nl=()=>{var l,A,d,u,m;const t=I.useDependency(s.IUniverInstanceService).getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),e=_l();if(!t||e.length===0)return[];const n=e[0].segmentId,i=t.getSelfOrHeaderFooterModel(n),a=(A=(l=i.getBody())==null?void 0:l.paragraphs)!=null?A:[],r=(u=(d=i.getBody())==null?void 0:d.dataStream)!=null?u:"";return(m=s.BuildTextUtils.range.getParagraphsInRanges(e,a,r))!=null?m:[]},Pl=(o,t)=>{const e=I.useDependency(s.ICommandService),[n,i]=w.useState(()=>{var c,l;const r=o[0];return r?String((l=(c=r.paragraphStyle)==null?void 0:c.horizontalAlign)!=null?l:t):t});return[n,r=>(i(r),e.executeCommand(pe.id,{paragraph:{horizontalAlign:Number(r)}}))]},wl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentStart,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentStart:{v:a}}}))]},Ul=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentEnd,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentEnd:{v:a}}}))]},Ll=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentFirstLine,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentFirstLine:{v:a}}}))]},Ql=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.hanging,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{hanging:{v:a}}}))]},Fl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceAbove,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceAbove:{v:a}}}))]},Hl=o=>{const t=I.useDependency(s.ICommandService),[e,n]=w.useState(()=>{var r;const a=o[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceBelow,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceBelow:{v:a}}}))]},kl=o=>{const t=I.useDependency(s.ICommandService),e=I.useDependency(_.IRenderManagerService),n=I.useDependency(s.IUniverInstanceService),i=w.useMemo(()=>{var g;const h=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(h)return(g=e.getRenderById(h==null?void 0:h.getUnitId()))==null?void 0:g.with(D.DocSkeletonManagerService).getSkeleton()},[]),a=w.useMemo(()=>new L.BehaviorSubject({}),[]),[r,c]=w.useState(()=>{var g,p;const h=o[0];return h&&(p=(g=h.paragraphStyle)==null?void 0:g.lineSpacing)!=null?p:1}),l=w.useRef(r),[A,d]=w.useState(()=>{var g,p;const h=o[0];return h&&(p=(g=h.paragraphStyle)==null?void 0:g.spacingRule)!=null?p:s.SpacingRule.AUTO}),u=async h=>{c(h),a.next({lineSpacing:h,spacingRule:A})},m=async h=>{if(h!==A){let g=l.current;if(h===s.SpacingRule.AT_LEAST){const p=i==null?void 0:i.findNodeByCharIndex(o[0].startIndex),f=p==null?void 0:p.parent,S=f==null?void 0:f.parent;(S==null?void 0:S.contentHeight)!==void 0&&(g=Math.max(S.contentHeight,g))}else g>5&&(g=2);l.current=r,u(g),d(h),a.next({spacingRule:h})}};return w.useEffect(()=>{const h=a.pipe(lt.filter(g=>!!Object.keys(g).length),lt.bufferTime(16),lt.filter(g=>!!g.length),lt.map(g=>g.reduce((p,f)=>(Object.keys(f).forEach(S=>{p[S]=f[S]}),p),{}))).subscribe(g=>t.executeCommand(pe.id,{paragraph:{...g}}));return()=>h.unsubscribe()},[]),{lineSpacing:[r,u],spacingRule:[A,m]}},Ke=o=>{const{value:t,onChange:e,className:n="",min:i=0,max:a=100,step:r=1}=o,c=w.useRef(null);return P.jsx(J.InputNumber,{step:r,ref:c,min:i,max:a,value:t,onChange:l=>{e(l!=null?l:0).finally(()=>{setTimeout(()=>{var A;(A=c.current)==null||A.focus()},30)})},className:n})};function Vl(){const o=I.useDependency(s.LocaleService),t=w.useMemo(()=>[{label:o.t("toolbar.alignLeft"),value:String(s.HorizontalAlign.LEFT),icon:P.jsx(ps,{})},{label:o.t("toolbar.alignCenter"),value:String(s.HorizontalAlign.CENTER),icon:P.jsx(gs,{})},{label:o.t("toolbar.alignRight"),value:String(s.HorizontalAlign.RIGHT),icon:P.jsx(fs,{})},{label:o.t("toolbar.alignJustify"),value:String(s.HorizontalAlign.JUSTIFIED),icon:P.jsx(os,{})}],[]),e=Nl(),[n,i]=Pl(e,t[0].value),[a,r]=wl(e),[c,l]=Ul(e),[A,d]=Ll(e),[u,m]=Ql(e),[h,g]=Fl(e),[p,f]=Hl(e),{lineSpacing:[S,E],spacingRule:[C,T]}=kl(e),R=w.useMemo(()=>C===s.SpacingRule.AUTO?{min:1,max:5,step:S<2?.5:1}:{min:1,max:100},[C,S]);return P.jsxs("div",{children:[P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.alignment")}),P.jsx("div",{className:J.clsx("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1",J.borderClassName),children:t.map(v=>P.jsx(J.Tooltip,{title:v.label,placement:"bottom",children:P.jsx("span",{className:J.clsx("hover:univer-bg-black/60 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1",{"univer-bg-blend-color-dodge/90":n===v.value}),onClick:()=>i(v.value),children:v.icon})},v.value))}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.indentation")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.left"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:a,onChange:v=>r(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.right"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:c,onChange:v=>l(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.firstLine"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:A,onChange:v=>d(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.hanging"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:u,onChange:v=>m(v!=null?v:0)})]})]}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:o.t("doc.paragraphSetting.spacing")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-justify-betweenuniver-item-center univer-flex",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.before"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:h,onChange:v=>g(v!=null?v:0)})]}),P.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[o.t("doc.paragraphSetting.after"),"(px)"]}),P.jsx(Ke,{className:"univer-mt-4",value:p,onChange:v=>f(v!=null?v:0)})]}),P.jsxs("div",{className:"item-center univer-flex univer-justify-between",children:[P.jsx("div",{className:"univer-mt-3 univer-text-xs",children:o.t("doc.paragraphSetting.lineSpace")}),P.jsxs("div",{className:"univer-mt-4 univer-flex univer-w-[162px] univer-flex-col univer-gap-1.5",children:[P.jsx(J.Select,{value:`${C}`,options:[{label:o.t("doc.paragraphSetting.multiSpace"),value:`${s.SpacingRule.AUTO}`},{label:o.t("doc.paragraphSetting.fixedValue"),value:`${s.SpacingRule.AT_LEAST}`}],onChange:v=>T(Number(v))}),P.jsx(Ke,{...R,value:S,onChange:v=>E(v!=null?v:0)})]})]})]})]})}const Wl=(o,t)=>t.length===o.length&&o.some(e=>t.some(n=>n.startOffset===e.startOffset&&n.endOffset===e.endOffset));function Gl(){const o=I.useDependency(s.ICommandService),t=I.useDependency(s.LocaleService),e=I.useObservable(t.currentLocale$),[n,i]=w.useState(""),a=w.useMemo(()=>s.debounce(()=>i(s.generateRandomId(4)),300),[]),r=w.useRef([]);return w.useEffect(()=>{const c=o.onCommandExecuted(l=>{if(D.SetTextSelectionsOperation.id===l.id){const A=l.params.ranges;Wl(A,r.current)||i(s.generateRandomId(4)),r.current=A}D.RichTextEditingMutation.id===l.id&&l.params.trigger!==pe.id&&a()});return()=>c.dispose()},[a]),w.useEffect(()=>{i(s.generateRandomId(4))},[e]),w.useEffect(()=>()=>a.cancel(),[a]),P.jsx(Vl,{},n)}var Xl=Object.getOwnPropertyDescriptor,jl=(o,t,e,n)=>{for(var i=n>1?void 0:n?Xl(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ko=(o,t)=>(e,n)=>t(e,n,o);const Xs="doc_ui_paragraph-setting-panel";let st=class extends s.Disposable{constructor(t,e,n){super();B(this,"_id");this._commandService=t,this._componentManager=e,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(Xs,Gl))}openPanel(){const t={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:Xs},width:300};this._sidebarService.open(t)}closePanel(){this._sidebarService.close(this._id)}};st=jl([ko(0,s.ICommandService),ko(1,s.Inject(I.ComponentManager)),ko(2,s.Inject(I.ISidebarService))],st);const Vo={id:"sidebar.operation.doc-paragraph-setting-panel",type:s.CommandType.OPERATION,handler:o=>(o.get(st).openPanel(),!0)},Wo=o=>{const t=o.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(()=>{t.getDocRanges().some(r=>r.collapsed===!1||r.rangeType===s.DOC_RANGE_TYPE.RECT)?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})};function Kl(o){if(o.length<2)return!0;const t=o.map(e=>e.tableId);return t.every(e=>e===t[0])}function js(o,t,e){var a;const n=t.getRectRanges(),i=t.getActiveTextRange();if(n&&n.length&&Kl(n)&&i==null){o.next(!1);return}if(i&&(n==null||n.length===0)){const{segmentId:r,startOffset:c,endOffset:l}=i,A=e.getCurrentUniverDocInstance(),d=(a=A==null?void 0:A.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:a.tables;if(d&&d.length&&d.some(u=>{const{startIndex:m,endIndex:h}=u;return c>m&&c<h||l>m&&l<h})){o.next(!1);return}}o.next(!0)}const Me=o=>{const t=o.get(D.DocSelectionManagerService),e=o.get(s.IUniverInstanceService);return new L.Observable(n=>{const i=t.textSelection$.subscribe(()=>{js(n,t,e)});return js(n,t,e),()=>i.unsubscribe()})},zl=o=>({id:mt.name,commandId:mt.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Yl=o=>({id:Vo.id,type:I.MenuItemType.BUTTON,icon:"MenuIcon",title:"doc.menu.paragraphSetting",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),ql=o=>({id:Kt.id,type:I.MenuItemType.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.cut",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Jl=o=>({id:zt.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.paste",hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Zl=o=>({id:ht.id,type:I.MenuItemType.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.delete",disabled$:Wo(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}),Ks="doc.menu.table-insert";function $l(o){return{id:Ks,type:I.MenuItemType.SUBITEMS,title:"table.insert",icon:"InsertDoubleIcon",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),Me(o),(t,e)=>t||e)}}function ed(o){return{id:sn.id,type:I.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAboveDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function td(o){return{id:an.id,type:I.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelowDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function nd(o){return{id:rn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function od(o){return{id:cn.id,type:I.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const zs="doc.menu.table-delete";function id(o){return{id:zs,type:I.MenuItemType.SUBITEMS,title:"table.delete",icon:"ReduceDoubleIcon",hidden$:L.combineLatest(I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC),Me(o),(t,e)=>t||e)}}function sd(o){return{id:nn.id,type:I.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRowDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function ad(o){return{id:on.id,type:I.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumnDoubleIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}function rd(o){return{id:it.id,type:I.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridIcon",disabled$:Me(o),hidden$:I.getMenuHiddenObservable(o,s.UniverInstanceType.UNIVER_DOC)}}const Ys={[I.RibbonStartGroup.FORMAT]:{[Be.id]:{order:0,menuItemFactory:oc},[_e.id]:{order:1,menuItemFactory:ic},[Ne.id]:{order:2,menuItemFactory:sc},[Pe.id]:{order:3,menuItemFactory:ac},[Ee.id]:{order:4,menuItemFactory:rc},[we.id]:{order:5,menuItemFactory:cc},[ce.id]:{order:5.5,menuItemFactory:Ac},[he.id]:{order:6,menuItemFactory:dc},[Ue.id]:{order:7,menuItemFactory:lc},[Ce.id]:{order:8,menuItemFactory:uc},[Te.id]:{order:9,menuItemFactory:yc,[Ze.id]:{order:0,menuItemFactory:Tc}}},[I.RibbonStartGroup.LAYOUT]:{[Et.id]:{order:2,menuItemFactory:fc},[Ct.id]:{order:3,menuItemFactory:Sc},[Tt.id]:{order:4,menuItemFactory:Ic},[yt.id]:{order:5,menuItemFactory:vc},[pt.id]:{order:6,menuItemFactory:Ec},[tt.id]:{order:7,menuItemFactory:Ns},[et.id]:{order:8,menuItemFactory:Ps},[vt.id]:{order:9,menuItemFactory:ws},[Uo.id]:{order:10,menuItemFactory:hc},[Rt.id]:{order:11,menuItemFactory:Cc},[Fo.id]:{order:12,menuItemFactory:bc}},[I.RibbonInsertGroup.MEDIA]:{[_s]:{order:2,menuItemFactory:mc,[ln.id]:{order:0,menuItemFactory:pc}}},[I.ContextMenuPosition.MAIN_AREA]:{[I.ContextMenuGroup.FORMAT]:{[mt.name]:{order:0,menuItemFactory:zl},[Kt.id]:{order:1,menuItemFactory:ql},[zt.id]:{order:2,menuItemFactory:Jl},[ht.id]:{order:3,menuItemFactory:Zl}},[I.ContextMenuGroup.LAYOUT]:{[Vo.id]:{order:0,menuItemFactory:Yl},[Ks]:{order:1,menuItemFactory:$l,[sn.id]:{order:1,menuItemFactory:ed},[an.id]:{order:2,menuItemFactory:td},[rn.id]:{order:3,menuItemFactory:nd},[cn.id]:{order:4,menuItemFactory:od}},[zs]:{order:2,menuItemFactory:id,[nn.id]:{order:1,menuItemFactory:sd},[on.id]:{order:2,menuItemFactory:ad},[it.id]:{order:3,menuItemFactory:rd}}}},[I.ContextMenuPosition.PARAGRAPH]:{[I.ContextMenuGroup.QUICK]:{[co.id]:{order:0,menuItemFactory:Rc},[lo.id]:{order:1,menuItemFactory:Mc},[Ao.id]:{order:2,menuItemFactory:xc},[uo.id]:{order:3,menuItemFactory:Dc},[ho.id]:{order:4,menuItemFactory:Bc},[qt.id]:{order:5,menuItemFactory:_c},[tt.id]:{order:6,menuItemFactory:Ns},[et.id]:{order:7,menuItemFactory:Ps},[vt.id]:{order:8,menuItemFactory:ws}},[I.ContextMenuGroup.FORMAT]:{[Kn.id]:{order:0,menuItemFactory:Nc},[zn.id]:{order:1,menuItemFactory:Pc},[kn.id]:{order:2,menuItemFactory:wc}},[I.ContextMenuGroup.LAYOUT]:{[Ls]:{menuItemFactory:Hc,[io.id]:{order:0,menuItemFactory:Uc},[so.id]:{order:1,menuItemFactory:Lc},[ao.id]:{order:2,menuItemFactory:Qc},[Yn.id]:{order:3,menuItemFactory:Fc}}}}};var cd=Object.getOwnPropertyDescriptor,ld=(o,t,e,n)=>{for(var i=n>1?void 0:n?cd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},xe=(o,t)=>(e,n)=>t(e,n,o);y.DocUIController=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super(),this._injector=t,this._componentManager=e,this._commandService=n,this._layoutService=i,this._menuManagerService=a,this._uiPartsService=r,this._univerInstanceService=c,this._shortcutService=l,this._configService=A,this._init()}_initCustomComponents(){[[Ds,Jr],[xs,Yr],["TodoListDoubleIcon",Ss],["doc.paragraph.menu",nl],["CutIcon",ss],["DeleteIcon",as],[Qo,$r],["DocumentSettingIcon",rs]].forEach(([t,e])=>{this.disposeWithMe(this._componentManager.register(t,e))})}_initUiParts(){this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.FOOTER,()=>I.connectInjector(Cl,this._injector))),this.disposeWithMe(this._uiPartsService.registerComponent(I.BuiltInUIPart.CONTENT,()=>I.connectInjector(Dl,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(Ys)}_initShortCut(){[al,rl,cl,ll,dl,Al,gl,ml,hl,ul,pl,fl,il].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[Os,Uo,Po].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(s.UniverInstanceType.UNIVER_DOC,t=>{this._injector.get(_.IRenderManagerService).getRenderById(t).with(y.DocSelectionRenderService).focus()}))}},y.DocUIController=ld([xe(0,s.Inject(s.Injector)),xe(1,s.Inject(I.ComponentManager)),xe(2,s.ICommandService),xe(3,I.ILayoutService),xe(4,I.IMenuManagerService),xe(5,I.IUIPartsService),xe(6,s.IUniverInstanceService),xe(7,I.IShortcutService),xe(8,s.IConfigService)],y.DocUIController);var dd=Object.getOwnPropertyDescriptor,Ad=(o,t,e,n)=>{for(var i=n>1?void 0:n?dd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Go=(o,t)=>(e,n)=>t(e,n,o);const qs=1.5;y.DocBackScrollRenderController=class extends s.RxDisposable{constructor(t,e,n,i){super(),this._context=t,this._textSelectionManagerService=e,this._editorService=n,this._docSkeletonManagerService=i,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{if(t==null)return;const{isEditing:e,unitId:n}=t;n!==this._context.unitId||!e||this._context.unitId!==s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._scrollToSelection()})}scrollToRange(t){const e=this._docSkeletonManagerService.getSkeleton();if(!e)return;const{startOffset:n}=t,i=e.findNodePositionByCharIndex(n);i&&this.scrollToNode(i)}scrollToNode(t){var N;const{unitId:e,scene:n,mainComponent:i}=this._context,a=this._docSkeletonManagerService.getSkeleton();if(i==null||a==null)return;const r=i.getOffsetConfig(),{docsLeft:c,docsTop:l}=r,A=new be(r,a),{contentBoxPointGroup:d}=A.getRangePointData(t,t),{left:u,top:m,height:h}=Ot(d),g=u+c,p=m+l,f=n.getViewport(ae.VIEW_MAIN),S=this._editorService.getEditor(e);if(f==null)return;const{left:E,top:C,right:T,bottom:R}=f.getBounding().viewBound;let v=0,O=0;const M=S?(N=S.params.backScrollOffset)!=null?N:0:100;p<C?v=p-C-M:p>R-h&&(v=p-R+h+M),g<E?O=g-E:g>T-qs&&(O=g-T+qs);const b=f.transViewportScroll2ScrollValue(O,v);f.scrollByBarDeltaValue(b)}_scrollToSelection(){const t=this._textSelectionManagerService.getActiveTextRange();if(t==null)return;const{collapsed:e,startNodePosition:n}=t;e&&this.scrollToNode(n)}},y.DocBackScrollRenderController=Ad([Go(1,s.Inject(D.DocSelectionManagerService)),Go(2,le),Go(3,s.Inject(D.DocSkeletonManagerService))],y.DocBackScrollRenderController);var ud=Object.getOwnPropertyDescriptor,hd=(o,t,e,n)=>{for(var i=n>1?void 0:n?ud(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},at=(o,t)=>(e,n)=>t(e,n,o);y.DocRenderController=class extends s.RxDisposable{constructor(t,e,n,i,a,r,c){super(),this._context=t,this._commandService=e,this._docSelectionRenderService=n,this._docSkeletonManagerService=i,this._editorService=a,this._renderManagerService=r,this._univerInstanceService=c,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(t){var r,c;const e=(r=this._renderManagerService.getRenderById(t))==null?void 0:r.with(D.DocSkeletonManagerService),n=e==null?void 0:e.getSkeleton();if(!n||!!n.getViewModel().getDataModel().getSnapshot().disabled)return;n.calculate();const a=this._editorService.getEditor(t);if(this._editorService.isEditor(t)&&!(a!=null&&a.params.scrollBar)){(c=this._context.mainComponent)==null||c.makeDirty();return}this._recalculateSizeBySkeleton(n)}_addNewRender(){const{scene:t,engine:e}=this._context,n=new _.Viewport(ae.VIEW_MAIN,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.attachControl(),t.onMouseWheel$.subscribeEvent((a,r)=>{const c=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if((c==null?void 0:c.getUnitId())!==this._context.unitId)return;const l=a;if(l.ctrlKey){const A=Math.abs(l.deltaX);let d=A<40?.2:A<80?.4:.2;d*=l.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):l.preventDefault()}else n.onMouseWheel(l,r)}),new _.ScrollBar(n),t.addLayer(new _.Layer(t,[],wt),new _.Layer(t,[],ri)),this._addComponent();const i=()=>t.render();this.disposeWithMe(this._context.activated$.subscribe(a=>{a?e.runRenderLoop(i):e.stopRenderLoop(i)})),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene:t,unit:e,components:n}=this._context,r={pageMarginLeft:20,pageMarginTop:20},c=new _.Documents(de.MAIN,void 0,r);c.zIndex=xn;const l=new _.DocBackground(de.BACKGROUND,void 0,r);l.zIndex=xn,this._context.mainComponent=c,n.set(de.MAIN,c),n.set(de.BACKGROUND,l),t.addObjects([c],wt),t.addObjects([l],ai),this._editorService.getEditor(e.getUnitId())==null&&t.enableLayerCache(wt)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{this._create(t)})}_create(t){var l;if(!t)return;const{mainComponent:e,components:n}=this._context,i=e,a=n.get(de.BACKGROUND);i.changeSkeleton(t),a.changeSkeleton(t);const{unitId:r}=this._context,c=this._editorService.getEditor(r);if(this._editorService.isEditor(r)&&!(c!=null&&c.params.scrollBar)){(l=this._context.mainComponent)==null||l.makeDirty();return}this._recalculateSizeBySkeleton(t)}_initCommandListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:i}=n;this.reRender(i)}}))}_recalculateSizeBySkeleton(t){var g;const{mainComponent:e,scene:n,unitId:i,components:a}=this._context,r=e,c=a.get(de.BACKGROUND),l=(g=t.getSkeletonData())==null?void 0:g.pages;if(l==null)return;let A=0,d=0;const m=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let p=0,f=l.length;p<f;p++){const S=l[p];let{pageWidth:E,pageHeight:C}=S;if(m===s.DocumentFlavor.MODERN){const T=gd(S);E=T.pageWidth,C=T.pageHeight}r.pageLayoutType===_.PageLayoutType.VERTICAL?(d+=C,d+=r.pageMarginTop,p===f-1&&(d+=r.pageMarginTop),A=Math.max(A,E)):r.pageLayoutType===_.PageLayoutType.HORIZONTAL&&(A+=E,p!==f-1&&(A+=r.pageMarginLeft),d=Math.max(d,C))}r.resize(A,d),c.resize(A,d);const h=this._editorService.getEditor(i);(!this._editorService.isEditor(i)||h!=null&&h.params.scrollBar)&&n.resize(A,d)}},y.DocRenderController=hd([at(1,s.ICommandService),at(2,s.Inject(y.DocSelectionRenderService)),at(3,s.Inject(D.DocSkeletonManagerService)),at(4,le),at(5,_.IRenderManagerService),at(6,s.IUniverInstanceService)],y.DocRenderController);function gd(o){let{pageWidth:t,pageHeight:e}=o;const{marginLeft:n,marginRight:i,marginTop:a,marginBottom:r,skeDrawings:c,skeTables:l}=o;t===Number.POSITIVE_INFINITY&&(t=o.width+n+i),e===Number.POSITIVE_INFINITY&&(e=o.height+a+r);for(const A of c.values())t=Math.max(t,A.aLeft+A.width+n+i),e=Math.max(e,A.aTop+A.height+a+r);for(const A of l.values())t=Math.max(t,A.left+A.width+n+i),e=Math.max(e,A.top+A.height+a+r);return{pageWidth:t,pageHeight:e}}var md=Object.getOwnPropertyDescriptor,pd=(o,t,e,n)=>{for(var i=n>1?void 0:n?md(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Xo=(o,t)=>(e,n)=>t(e,n,o);let jo=class{constructor(o,t,e){B(this,"_docContainer");B(this,"getComponent",o=>{if(this._docContainer=o,!o.getContentRef().current)throw new Error("container is not ready")});B(this,"changeLocale",o=>{this._localeService.setLocale(o)});this._localeService=o,this._injector=t,this._configService=e}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(pn),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(o){if(this._docContainer)return o(this._docContainer)}getDocContainer(){return this._docContainer}};jo=pd([Xo(0,s.Inject(s.LocaleService)),Xo(1,s.Inject(s.Injector)),Xo(2,s.IConfigService)],jo);var fd=Object.getOwnPropertyDescriptor,Sd=(o,t,e,n)=>{for(var i=n>1?void 0:n?fd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Id=(o,t)=>(e,n)=>t(e,n,o);let fn=class extends s.RxDisposable{constructor(t){super();B(this,"_docContainerController");this._injector=t,this._docContainerController=this._injector.createInstance(jo)}};fn=Sd([Id(0,s.Inject(s.Injector))],fn);var vd=Object.getOwnPropertyDescriptor,Ed=(o,t,e,n)=>{for(var i=n>1?void 0:n?vd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Js=(o,t)=>(e,n)=>t(e,n,o);let Sn=class extends s.Disposable{constructor(o,t){super(),this._docAutoFormatService=o,this._renderManagerService=t,this._initListTabAutoFormat(),this._initSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ke.id,match:o=>{var i;const{selection:t,paragraphs:e,unit:n}=o;if(e.length===1&&t.startOffset===e[0].paragraphStart&&e[0].bullet){const a=(i=n.getBody())==null?void 0:i.paragraphs,r=a==null?void 0:a.filter(c=>{var l;return((l=c.bullet)==null?void 0:l.listId)===e[0].bullet.listId});return(r==null?void 0:r.findIndex(c=>c.startIndex===e[0].startIndex))!==0}else if(e.length>1&&e.some(a=>a.bullet))return!0;return!1},getMutations(o){const t=o.commandParams;return[{id:Yt.id,params:{type:t!=null&&t.shift?It.decrease:It.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ke.id,match:o=>{const{selection:t,unit:e}=o,{startNodePosition:n,endNodePosition:i}=t,a=this._renderManagerService.getRenderById(e.getUnitId()),r=a==null?void 0:a.with(D.DocSkeletonManagerService).getSkeleton();return r==null?!1:!!(n&&i&&Yi(r,n,i)||n&&!i&&n.path.indexOf("cells")>-1)},getMutations(o){const t=o.commandParams;return[{id:xo.id,params:{shift:!!(t!=null&&t.shift)}}]},priority:99}))}_initSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:dt.id,match:o=>{var a;const{selection:t,paragraphs:e,unit:n}=o;if(!t.collapsed||e.length!==1||!t.collapsed)return!1;const i=(a=n.getBody())==null?void 0:a.dataStream.slice(e[0].paragraphStart,t.startOffset-1);return!!(i&&(Object.keys(s.QuickListTypeMap).includes(i)||Object.keys(ro).includes(i)))},getMutations(o){var a;const{paragraphs:t,unit:e,selection:n}=o,i=(a=e.getBody())==null?void 0:a.dataStream.slice(t[0].paragraphStart,n.startOffset-1);if(i&&Object.keys(s.QuickListTypeMap).includes(i)){const r=s.QuickListTypeMap[i];return[{id:no.id,params:{listType:r,paragraph:t[0]}}]}if(i&&Object.keys(ro).includes(i)){const r=ro[i];return[{id:Xi.id,params:{value:r}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ze.id,match:o=>{const{paragraphs:t}=o;return!!(t.length===1&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},getMutations:o=>{const t=o.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:Yt.id,params:{type:It.decrease}}]:[{id:$e.id,params:{listType:o.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ze.id,match:()=>!0,getMutations(){return[{id:Qt.id}]},priority:-9999}))}};Sn=Ed([Js(0,s.Inject(y.DocAutoFormatService)),Js(1,_.IRenderManagerService)],Sn);function Cd(o){return o.rows[0].cells[0].sections[0].columns[0].lines[0]}function Td(o){const t=o.rows[o.rows.length-1],e=t.cells[t.cells.length-1];return _.getLastLine(e)}function yd(o,t){const{ed:e}=o,{skeTables:n}=t;let i=null;for(const a of n.values())if(a.st===e+1){i=a;break}return i}function Zs(o){const t=o==null?void 0:o.parent;let e=null,n=null;if(o==null||t==null)return{lineBeforeTable:e,lineAfterTable:n};const{st:i,ed:a}=o,r=t.type===_.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return _.lineIterator(r,c=>{c.st===a+1?n=c:c.ed===i-1&&(e=c)}),{lineBeforeTable:e,lineAfterTable:n}}function $s(o){return o.sections[0].columns[0].lines.length===0}function ea(o){var r,c;const t=o.parent,e=t==null?void 0:t.parent,n=e==null?void 0:e.tableId;if(t==null||e==null)return;const i=t.cells.indexOf(o);let a=e.rows[e.rows.indexOf(t)+1];if(a==null&&n.indexOf("#-#")){const[l,A]=n.split("#-#"),d=(c=(r=e.parent)==null?void 0:r.parent)==null?void 0:c.pages,u=`${l}#-#${Number.parseInt(A)+1}`;if(d)for(const m of d){const{skeTables:h}=m;if(h.has(u)){const g=h.get(u);if(g!=null&&g.rows.length){a=g.rows.find(p=>!p.isRepeatRow);break}}}}if(a!=null){const l=a.cells[i];return $s(l)?ea(l):l}}function ta(o){var a,r;const t=o.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;let n=e.rows[e.rows.indexOf(t)-1];const i=t.cells.indexOf(o);if((n==null||n.isRepeatRow)&&e.tableId.indexOf("#-#")){const[c,l]=e.tableId.split("#-#"),A=(r=(a=e.parent)==null?void 0:a.parent)==null?void 0:r.pages,d=`${c}#-#${Number.parseInt(l)-1}`;if(A)for(const u of A){const{skeTables:m}=u;if(m.has(d)){const h=m.get(d);if(h!=null&&h.rows.length){n=h.rows[h.rows.length-1];break}}}}if(n!=null){const c=n.cells[i];return $s(c)?ta(c):c}}function bd(o,t){const{st:e}=o,{skeTables:n}=t;let i=null;for(const a of n.values())if(a.ed===e-1){i=a;break}return i}function Od(o){return o.sections[0].columns[0].lines[0]}function Rd(o){const t=_.getLastColumn(o);return t.lines[t.lines.length-1]}var Md=Object.getOwnPropertyDescriptor,xd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Md(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},In=(o,t)=>(e,n)=>t(e,n,o);let vn=class extends s.Disposable{constructor(t,e,n,i){super();B(this,"_onInputSubscription");this._univerInstanceService=t,this._renderManagerService=e,this._textSelectionManagerService=n,this._commandService=i,this._commandExecutedListener()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_commandExecutedListener(){const t=[Oe.id,Re.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(!t.includes(e.id))return;const n=e.params;switch(e.id){case Oe.id:return this._handleMoveCursor(n.direction);case Re.id:return this._handleShiftMoveSelection(n.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(t){var C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),i=this._univerInstanceService.getCurrentUniverDocInstance();if(i==null)return;const a=(C=this._renderManagerService.getRenderById(i.getUnitId()))==null?void 0:C.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,direction:u,segmentId:m,startNodePosition:h,endNodePosition:g,segmentPage:p}=e;if(n.length>1){let v=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(const M of n)v=Math.min(v,M.startOffset),O=Math.max(O,M.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:t===s.Direction.LEFT||t===s.Direction.UP?O:v,endOffset:t===s.Direction.LEFT||t===s.Direction.UP?v:O,style:A}],!1);return}const f=d||u===s.RANGE_DIRECTION.FORWARD?c:l;let S=d||u===s.RANGE_DIRECTION.FORWARD?l:c;const E=(T=i.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)!=null?T:Number.POSITIVE_INFINITY;if(t===s.Direction.LEFT||t===s.Direction.RIGHT){const v=a.findNodeByCharIndex(S-1,m,p),O=a.findNodeByCharIndex(S,m,p);S=t===s.Direction.RIGHT?S+O.count:S-((R=v==null?void 0:v.count)!=null?R:0),S=Math.min(E-2,Math.max(0,S)),this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:S,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),S)}else{const v=a.findNodeByCharIndex(S,m,p),O=r.document.getOffsetConfig(),M=d?h:u===s.RANGE_DIRECTION.FORWARD?g:h,b=this._getTopOrBottomPosition(a,v,M,t===s.Direction.DOWN,!0);if(b==null){const x=t===s.Direction.UP?0:E-2;if(x===S)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:x,style:A}],!1);return}const N=new be(O,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:N.endOffset,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),N.endOffset)}}_handleMoveCursor(t){var E,C,T,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),i=this._univerInstanceService.getCurrentUniverDocInstance();if(i==null)return!1;const a=(E=this._renderManagerService.getRenderById(i.getUnitId()))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null||n==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,segmentId:u,startNodePosition:m,endNodePosition:h,segmentPage:g}=e,p=i.getSelfOrHeaderFooterModel(u).getBody();if(p==null)return;const f=(C=p.dataStream.length)!=null?C:Number.POSITIVE_INFINITY,S=(T=i.getCustomRanges())!=null?T:[];if(t===s.Direction.LEFT||t===s.Direction.RIGHT){let v;if(!e.collapsed||n.length>1){let b=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(const x of n)b=Math.min(b,x.startOffset),N=Math.max(N,x.endOffset);v=t===s.Direction.LEFT?b:N}else{const b=a.findNodeByCharIndex(c-1,u,g),N=a.findNodeByCharIndex(c,u,g),x=a.findNodeByCharIndex(c+1,u,g);t===s.Direction.LEFT?v=Math.max(0,c-((R=b==null?void 0:b.count)!=null?R:1)):v=Math.min(f-2,l+N.count+((x==null?void 0:x.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK?1:0))}const O=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.SECTION_BREAK];if(t===s.Direction.LEFT)for(;O.includes(p.dataStream[v]);)v--;else for(;O.includes(p.dataStream[v]);)v++;S.filter(b=>b.wholeEntity&&b.startIndex<v&&b.endIndex>=v).forEach(b=>{t===s.Direction.LEFT?v=Math.min(b.startIndex,v):v=Math.max(b.endIndex+1,v)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,v),endOffset:Math.max(0,v),style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),v)}else{const v=a.findNodeByCharIndex(c,u,g),O=a.findNodeByCharIndex(l,u,g),M=r.document.getOffsetConfig(),b=this._getTopOrBottomPosition(a,t===s.Direction.UP||d?v:O,t===s.Direction.UP||d?m:h,t===s.Direction.DOWN);if(b==null){let x;d?x=t===s.Direction.UP?0:f-2:x=t===s.Direction.UP?c:l,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,x),endOffset:Math.max(0,x),style:A}],!1);return}const N=new be(M,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...N,style:A}],!1),this._scrollToFocusNodePosition(i.getUnitId(),N.endOffset)}}_getTopOrBottomPosition(t,e,n,i,a=!1){if(e==null||n==null)return;const r=this._getGlyphLeftOffsetInLine(e),c=this._getNextOrPrevLine(e,i,a);if(c==null)return;const l=this._matchPositionByLeftOffset(t,c,r,n);if(l!=null)return{...l,isBack:!0}}_getGlyphLeftOffsetInLine(t){const e=t.parent;if(e==null)return Number.NEGATIVE_INFINITY;const n=e.left,{left:i}=t;return n+i}_matchPositionByLeftOffset(t,e,n,i){const a={distance:Number.POSITIVE_INFINITY};for(const c of e.divides){const l=c.left;for(const A of c.glyphGroup){if(A.streamType===s.DataStreamTreeTokenType.SECTION_BREAK)continue;const{left:d}=A,u=l+d,m=Math.abs(n-u);m<a.distance&&(a.glyph=A,a.distance=m)}}if(a.glyph==null)return;const{segmentPage:r}=i;return t.findPositionByGlyph(a.glyph,r)}_getNextOrPrevLine(t,e,n=!1){var p,f,S,E,C,T,R,v,O,M,b,N;const i=t.parent,a=i==null?void 0:i.parent,r=a==null?void 0:a.parent,c=r==null?void 0:r.parent,l=c==null?void 0:c.parent;if(i==null||a==null||r==null||c==null||l==null)return;const A=r.lines.indexOf(a);if(A===-1)return;let d;if(l.type===_.DocumentSkeletonPageType.CELL&&n){const x=na(l,e);if(x)return x}if(e===!0){d=r.lines[A+1];const x=yd(a,l);if(x){const U=Cd(x);U&&(d=U)}}else{d=r.lines[A-1];const x=bd(a,l);if(x){const U=Td(x);U&&(d=U)}}if(d!=null)return d;const u=c.columns.indexOf(r);if(u===-1)return;if(e===!0)d=(p=c.columns[u+1])==null?void 0:p.lines[0];else{const x=(S=(f=c.columns)==null?void 0:f[u-1])==null?void 0:S.lines;d=x==null?void 0:x[x.length-1]}if(d!=null)return d;const m=l.sections.indexOf(c);if(m===-1)return;if(e===!0)d=(C=(E=l.sections[m-1])==null?void 0:E.columns[0])==null?void 0:C.lines[0];else{const x=(R=(T=l.sections)==null?void 0:T[m-1])==null?void 0:R.columns,U=x==null?void 0:x[x.length-1],F=U==null?void 0:U.lines;d=F==null?void 0:F[F.length-1]}if(d!=null)return d;if(l.type===_.DocumentSkeletonPageType.CELL)return na(l,e);const h=l.parent;if(h==null)return;const g=h.pages.indexOf(l);if(g!==-1){if(e===!0)d=(M=(O=(v=h.pages[g+1])==null?void 0:v.sections[0])==null?void 0:O.columns[0])==null?void 0:M.lines[0];else{const x=(b=h.pages[g-1])==null?void 0:b.sections;if(x==null)return;const U=(N=x[x.length-1])==null?void 0:N.columns,F=U[U.length-1],V=F==null?void 0:F.lines;d=V[V.length-1]}if(d!=null)return d}}_scrollToFocusNodePosition(t,e){var i;const n=(i=this._renderManagerService.getRenderById(t))==null?void 0:i.with(y.DocBackScrollRenderController);n!=null&&n.scrollToRange({startOffset:e,endOffset:e,collapsed:!0})}_getDocObject(){return ci(this._univerInstanceService,this._renderManagerService)}};vn=xd([In(0,s.IUniverInstanceService),In(1,_.IRenderManagerService),In(2,s.Inject(D.DocSelectionManagerService)),In(3,s.ICommandService)],vn);function na(o,t){var n,i;let e=null;if(t===!0){const a=ea(o);if(a)e=Od(a);else{const r=(n=o.parent)==null?void 0:n.parent,{lineAfterTable:c}=Zs(r);c&&(e=c)}}else{const a=ta(o);if(a)e=Rd(a);else{const r=(i=o.parent)==null?void 0:i.parent,{lineBeforeTable:c}=Zs(r);c&&(e=c)}}return e}const Dd=({handleRowColChange:o,tableCreateParams:t})=>{const e=I.useDependency(s.LocaleService),[n,i]=w.useState(3),[a,r]=w.useState(5);function c(l,A){i(l),r(A),o(l,A)}return w.useEffect(()=>{i(t.rowCount),r(t.colCount)},[t]),P.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2",children:[P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.rowCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:n,onChange:l=>{c(l,a)}})]}),P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.colCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:a,onChange:l=>{c(n,l)}})]})]})};var Bd=Object.getOwnPropertyDescriptor,_d=(o,t,e,n)=>{for(var i=n>1?void 0:n?Bd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},oa=(o,t)=>(e,n)=>t(e,n,o);let En=class extends s.Disposable{constructor(o,t){super(),this._commandService=o,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[ln].forEach(o=>this.disposeWithMe(this._commandService.registerCommand(o)))}_initCustomComponents(){const o=this._componentManager;this.disposeWithMe(o.register(ts,Dd))}_init(){}};En=_d([oa(0,s.ICommandService),oa(1,s.Inject(I.ComponentManager))],En);var Nd=Object.getOwnPropertyDescriptor,Pd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Nd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Cn=(o,t)=>(e,n)=>t(e,n,o);let Ko=class extends s.Disposable{constructor(o,t,e,n,i){super(),this._context=o,this._docSkeletonManagerService=t,this._commandService=e,this._docEventManagerService=n,this._textSelectionManagerService=i,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(o=>{const t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(to.id,{index:o.paragraph.startIndex,segmentId:o.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(o=>{o?this._context.mainComponent.setCursor(_.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(_.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(o,t,e,n){const{documentTransform:i}=o.getOffsetConfig(),a=t.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(a)return i.clone().invert().applyPoint(a)}};Ko=Pd([Cn(1,s.Inject(D.DocSkeletonManagerService)),Cn(2,s.ICommandService),Cn(3,s.Inject(y.DocEventManagerService)),Cn(4,s.Inject(D.DocSelectionManagerService))],Ko);var wd=Object.getOwnPropertyDescriptor,Ud=(o,t,e,n)=>{for(var i=n>1?void 0:n?wd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},_t=(o,t)=>(e,n)=>t(e,n,o);let Tn=class extends s.RxDisposable{constructor(o,t,e,n,i,a){super(),this._context=o,this._commandService=t,this._docClipboardService=e,this._docSelectionRenderService=n,this._contextService=i,this._editorService=a,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var o;(o=this._docSelectionRenderService)==null||o.onPaste$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{var c,l,A;if(!jt(this._contextService))return;t.event.preventDefault();const e=t.event;let n=(c=e.clipboardData)==null?void 0:c.getData(I.HTML_CLIPBOARD_MIME_TYPE);const i=(l=e.clipboardData)==null?void 0:l.getData(I.PLAIN_TEXT_CLIPBOARD_MIME_TYPE),a=[...((A=e.clipboardData)==null?void 0:A.items)||[]].filter(d=>I.imageMimeTypeSet.has(d.type)).map(d=>d.getAsFile()).filter(d=>!!d);this._editorService.getEditor(this._context.unitId)&&(n!=null?n:"").indexOf("</table>")>-1&&(n=""),this._docClipboardService.legacyPaste({html:n,text:i,files:a})})}};Tn=Ud([_t(1,s.ICommandService),_t(2,De),_t(3,s.Inject(y.DocSelectionRenderService)),_t(4,s.IContextService),_t(5,le)],Tn);var Ld=Object.getOwnPropertyDescriptor,Qd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Ld(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ia=(o,t)=>(e,n)=>t(e,n,o);const Fd=[s.DEFAULT_EMPTY_DOCUMENT_VALUE,s.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY];let zo=class extends s.Disposable{constructor(o,t,e){super(),this._context=o,this._contextMenuService=t,this._commandService=e,Fd.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,n;const t=((n=(e=this._context)==null?void 0:e.mainComponent)==null?void 0:n.onPointerDown$).subscribeEvent(i=>{i.button===2&&this._contextMenuService.triggerContextMenu(i,I.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(t)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(o=>{o.id===D.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}};zo=Qd([ia(1,I.IContextMenuService),ia(2,s.ICommandService)],zo);var Hd=Object.getOwnPropertyDescriptor,kd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Hd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},rt=(o,t)=>(e,n)=>t(e,n,o);let yn=class extends s.Disposable{constructor(t,e,n,i,a,r,c){super();B(this,"_initialEditors",new Set);this._context=t,this._univerInstanceService=e,this._editorService=n,this._commandService=i,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._renderManagerService=c,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach(t=>{const e=t.getEditorId();e===this._context.unitId&&(this._initialEditors.has(e)||(this._initialEditors.add(e),this._resize(e)))}),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(t){if(t==null)return;const e=this._editorService.getEditor(t);if((e==null?void 0:e.cancelDefaultResizeListener)===!0)return;const n=this._univerInstanceService.getUniverDocInstance(t);if(!n)return;const i=this._docSkeletonManagerService.getSkeleton();if(e==null||e.render==null||i==null||n==null)return;i.calculate();const{marginTop:a=0,marginBottom:r=0,marginLeft:c=0,marginRight:l=0}=n.getSnapshot().documentStyle,{scene:A,mainComponent:d}=e.render;let{actualHeight:u,actualWidth:m}=i.getActualSize();u+=a+r,m+=c+l;const{width:h,height:g}=e.getBoundingClientRect(),p=Math.max(m,h),f=Math.max(u,g);A.transformByState({width:p,height:f}),d==null||d.resize(p,f)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{const{unitId:t}=this._context,e=this._editorService.getEditor(t),n=this._editorService.getFocusEditor();e==null||e.isSheetEditor()||n&&n.getEditorId()===t||t.includes("range_selector")||t.includes("embedding_formula_editor")||this._editorService.blur()}))}_initialFocus(){const t=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe(L.fromEvent(window,"mousedown").subscribe(n=>{const a=n.target.classList[0]||"";s.checkForSubstrings(a,t)&&n.stopPropagation()}));const e=new s.DisposableCollection;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{if(e.dispose(),!n)return;const i=n.getUnitId(),a=this._renderManagerService.getRenderById(i),r=a==null?void 0:a.engine.getCanvas().getCanvasEle();if(r==null)return;const c=L.fromEvent(r,"mousedown").subscribe(l=>{l.stopPropagation()});e.add(c)})),this.disposeWithMe(()=>e.dispose())}_commandExecutedListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:i}=n;if(this._editorService.isSheetEditor(i)||i!==this._context.unitId)return;const a=this._editorService.getEditor(i);a&&!a.params.scrollBar&&this._resize(i)}}))}};yn=kd([rt(1,s.IUniverInstanceService),rt(2,le),rt(3,s.ICommandService),rt(4,s.Inject(y.DocSelectionRenderService)),rt(5,s.Inject(D.DocSkeletonManagerService)),rt(6,_.IRenderManagerService)],yn);var Vd=Object.getOwnPropertyDescriptor,Wd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Vd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},bn=(o,t)=>(e,n)=>t(e,n,o);let Yo=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_previousIMEContent","");B(this,"_isCompositionStart",!0);B(this,"_onStartSubscription");B(this,"_onUpdateSubscription");B(this,"_onEndSubscription");this._context=t,this._docSelectionRenderService=e,this._docImeInputManagerService=n,this._docSkeletonManagerService=i,this._commandService=a,this._initialize()}dispose(){var t,e,n;(t=this._onStartSubscription)==null||t.unsubscribe(),(e=this._onUpdateSubscription)==null||e.unsubscribe(),(n=this._onEndSubscription)==null||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(t=>{if(t==null)return;this._resetIME();const{activeRange:e}=t;e!=null&&this._docImeInputManagerService.setActiveRange(s.Tools.deepClone(e))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(t=>{this._updateContent(t,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(t=>{this._updateContent(t,!1)})}async _updateContent(t,e){if(t==null)return;const n=this._context.unitId,i=this._docSkeletonManagerService.getSkeleton(),{event:a,activeRange:r}=t;if(i==null||r==null)return;const l=a.data;l===this._previousIMEContent&&e||(await this._commandService.executeCommand(Jn.id,{unitId:n,newText:l,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!e}),e?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=l):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}};Yo=Wd([bn(1,s.Inject(y.DocSelectionRenderService)),bn(2,s.Inject(ft)),bn(3,s.Inject(D.DocSkeletonManagerService)),bn(4,s.ICommandService)],Yo);var Gd=Object.getOwnPropertyDescriptor,Xd=(o,t,e,n)=>{for(var i=n>1?void 0:n?Gd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},On=(o,t)=>(e,n)=>t(e,n,o);let qo=class extends s.Disposable{constructor(t,e,n,i,a){super();B(this,"_onInputSubscription");this._context=t,this._docSelectionRenderService=e,this._docSkeletonManagerService=n,this._commandService=i,this._docMenuStyleService=a,this._init()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async t=>{var f,S;if(t==null)return;const{unitId:e}=this._context,{event:n,content:i="",activeRange:a}=t,r=n,c=this._docSkeletonManagerService.getSkeleton();if(r.data==null||c==null||a==null)return;const{segmentId:l}=a,d=this._context.unit.getSelfOrHeaderFooterModel(l).getBody(),u=this._docMenuStyleService.getDefaultStyle(),m=this._docMenuStyleService.getStyleCache(),h=Dn((f=d==null?void 0:d.customRanges)!=null?f:[],a.endOffset,s.SHEET_EDITOR_UNITS.includes(e)),g=Ut(d,a.endOffset,u,m,s.SHEET_EDITOR_UNITS.includes(e)),p=Bn((S=d==null?void 0:d.customDecorations)!=null?S:[],a.endOffset);await this._commandService.executeCommand(Qn.id,{unitId:e,body:{dataStream:i,textRuns:g?[{...g,st:0,ed:i.length}]:[],customRanges:h?[{...h,startIndex:0,endIndex:i.length-1}]:[],customDecorations:p.map(E=>({...E,startIndex:0,endIndex:i.length-1}))},range:a,segmentId:l}),i===" "&&await this._commandService.executeCommand(dt.id)})}};qo=Xd([On(1,s.Inject(y.DocSelectionRenderService)),On(2,s.Inject(D.DocSkeletonManagerService)),On(3,s.ICommandService),On(4,s.Inject(ve))],qo);class Jo extends s.Disposable{constructor(t){super(),this._context=t}calculatePagePosition(){var T,R;const t=Ie(this._context),n=(R=(T=this._context.unit.getSettings())==null?void 0:T.zoomRatio)!=null?R:1,{document:i,scene:a,docBackground:r}=t,c=a==null?void 0:a.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:u}=i;if(c==null||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;const{width:m,height:h}=c;let g=0,p=u,f=0,S=0,E=Number.POSITIVE_INFINITY;m>(l+d*2)*n?(g=m/2-l*n/2,g/=n,f=(m-d*2)/n,E=0):(g=d,f=l+d*2,E=(f-m/n)/2),h>A?S=(h-u*2)/n:S=A+u*2,a.resize(f,S),m<=1&&(g=-1e4,p=-1e4),i.translate(g,p),r.translate(g,p);const C=a.getViewport(ae.VIEW_MAIN);return E!==Number.POSITIVE_INFINITY&&C!=null&&C.scrollToViewportPos({viewportScrollX:E}),this}}var jd=Object.getOwnPropertyDescriptor,Kd=(o,t,e,n)=>{for(var i=n>1?void 0:n?jd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},sa=(o,t)=>(e,n)=>t(e,n,o);let Zo=class extends s.Disposable{constructor(o,t,e){super(),this._context=o,this._docPageLayoutService=t,this._textSelectionManagerService=e;const n=this._context.unitId;if(s.isInternalEditorID(n)&&n!==s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(o=>o.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),L.throttleTime(0,L.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}};Zo=Kd([sa(1,s.Inject(Jo)),sa(2,s.Inject(D.DocSelectionManagerService))],Zo);var zd=Object.getOwnPropertyDescriptor,Yd=(o,t,e,n)=>{for(var i=n>1?void 0:n?zd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ct=(o,t)=>(e,n)=>t(e,n,o);let $o=class extends s.Disposable{constructor(t,e,n,i,a,r,c){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=i,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._docSelectionManagerService=c,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId:t}=this._context,e=Ie(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(t=>{if(t==null)return;const{unitId:e,docRanges:n,isEditing:i,options:a}=t;e===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,i,a))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(t=>{t!=null&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(t,{unitId:this._context.unitId,subUnitId:this._context.unitId})}))}_initialMain(t){const e=Ie(this._context),{document:n,scene:i}=e;this.disposeWithMe(n.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(t)||(n.cursor=_.CURSOR_TYPE.TEXT)})),this.disposeWithMe(n.onPointerLeave$.subscribeEvent(()=>{n.cursor=_.CURSOR_TYPE.DEFAULT,i.resetCursor()})),this.disposeWithMe(n.onPointerDown$.subscribeEvent((a,r)=>{if(this._isEditorReadOnly(t))return;const c=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);(c==null?void 0:c.getUnitId())!==t&&this._instanceSrv.setCurrentUnitForType(t);const l=this._docSkeletonManagerService.getSkeleton(),{offsetX:A,offsetY:d}=a,u=this._getTransformCoordForDocumentOffset(A,d);if(u!=null){const{pageLayoutType:m=_.PageLayoutType.VERTICAL,pageMarginLeft:h,pageMarginTop:g}=n.getOffsetConfig(),{editArea:p}=l.findEditAreaByCoord(u,m,h,g),f=this._docSkeletonManagerService.getViewModel(),S=f.getEditArea();S!==_.DocumentEditArea.BODY&&p!==_.DocumentEditArea.BODY&&p!==S&&f.setEditArea(p)}if(this._docSelectionRenderService.__onPointDown(a),this._editorService.getEditor(t)){this._setEditorFocus(t);const{offsetX:m,offsetY:h}=a;setTimeout(()=>{t===this._editorService.getFocusId()||this._docSelectionRenderService.isOnPointerEvent||(this._setEditorFocus(t),this._docSelectionRenderService.setCursorManually(m,h))},0)}a.button!==2&&r.stopPropagation()})),this.disposeWithMe(n.onDblclick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleDblClick(a)})),this.disposeWithMe(n.onTripleClick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleTripleClick(a)}))}_getTransformCoordForDocumentOffset(t,e){const n=Ie(this._context),{document:i,scene:a}=n,{documentTransform:r}=i.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_setEditorFocus(t){this._editorService.focus(t)}_commandExecutedListener(){const t=[ue.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var n;if(t.includes(e.id)){const i=e.params,{unitId:a}=i,r=(n=this._docSelectionManagerService.__getCurrentSelection())==null?void 0:n.unitId;if(a!==r)return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(!t)return;const{unitId:e}=this._context;if(!s.isInternalEditorID(e)){this._docSelectionRenderService.focus();const a=this._context.unit.getSnapshot(),r=Is(a);this._docSelectionManagerService.replaceDocRanges([{startOffset:r,endOffset:r}],{unitId:e,subUnitId:e},!1)}}))}};$o=Yd([ct(1,s.ICommandService),ct(2,le),ct(3,s.IUniverInstanceService),ct(4,s.Inject(y.DocSelectionRenderService)),ct(5,s.Inject(D.DocSkeletonManagerService)),ct(6,s.Inject(D.DocSelectionManagerService))],$o);var qd=Object.getOwnPropertyDescriptor,Jd=(o,t,e,n)=>{for(var i=n>1?void 0:n?qd(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Fe=(o,t)=>(e,n)=>t(e,n,o);let ei=class extends s.Disposable{constructor(t,e,n,i,a,r,c,l,A){super();B(this,"_isSheetEditor",!1);this._context=t,this._contextService=e,this._docSkeletonManagerService=n,this._univerInstanceService=i,this._commandService=a,this._textSelectionManagerService=r,this._editorService=c,this._docPageLayoutService=l,this._renderManagerService=A,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),this._isSheetEditor=this._context.unitId===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY;const d=this._univerInstanceService.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_SHEET),u=d&&this._renderManagerService.getRenderById(d.getUnitId());setTimeout(()=>this.updateViewZoom(u&&this._isSheetEditor?u.scene.scaleX:1,!0),20),s.isInternalEditorID(this._context.unitId)||this._initZoomEventListener()}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const{unitId:e,scene:n}=this._context;this._editorService.isEditor(e)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(i=>{if(!i.ctrlKey||!this._contextService.getContextValue(s.FOCUSING_DOC))return;const a=this._univerInstanceService.getCurrentUniverDocInstance();if(!a)return;const{documentFlavor:r}=a.getSnapshot().documentStyle;if(r===s.DocumentFlavor.MODERN)return;const c=Math.abs(i.deltaX);let l=c<40?.2:c<80?.4:.2;l*=i.deltaY>0?-1:1,n.scaleX<1&&(l/=2);const A=a.zoomRatio;let d=+Number.parseFloat(`${A+l}`).toFixed(1);d=d>=4?4:d<=.1?.1:d,this._commandService.executeCommand(bt.id,{zoomRatio:d,unitId:a.getUnitId()}),i.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t==null)return;const e=this._univerInstanceService.getCurrentUniverDocInstance();e&&setTimeout(()=>{const n=this._univerInstanceService.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_SHEET),i=n&&this._renderManagerService.getRenderById(n.getUnitId()),a=this._isSheetEditor?(i==null?void 0:i.scene.scaleX)||1:e.zoomRatio;this.updateViewZoom(a,!1)})}))}_initCommandExecutedListener(){const t=[ue.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)&&e.params.unitId===this._context.unitId){const i=this._context.unit.zoomRatio||1;this.updateViewZoom(i)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{e.id===Rt.id&&this._commandService.executeCommand(bt.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(t,e=!0){var i;const n=Ie(this._context);n.scene.scale(t,t),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),e&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),(i=n.scene.getTransformer())==null||i.clearSelectedObjects()}_initZoomEventListener(){const t=this._context.scene;this.disposeWithMe(t.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey)return;const n=Math.abs(e.deltaX);let i=n<40?.2:n<80?.4:.2;i*=e.deltaY>0?-1:1,t.scaleX<1&&(i/=2);const a=this._context.unit.zoomRatio;let r=+Number.parseFloat(`${a+i}`).toFixed(1);r=r>=4?4:r<=.1?.1:r,this._commandService.executeCommand(bt.id,{zoomRatio:Math.round(r*10)/10,documentId:this._context.unitId}),e.preventDefault()}))}};ei=Jd([Fe(1,s.IContextService),Fe(2,s.Inject(D.DocSkeletonManagerService)),Fe(3,s.IUniverInstanceService),Fe(4,s.ICommandService),Fe(5,s.Inject(D.DocSelectionManagerService)),Fe(6,le),Fe(7,s.Inject(Jo)),Fe(8,_.IRenderManagerService)],ei);const Zd=s.createInterceptorKey("PRINTING_COMPONENT_COLLECT"),$d=s.createInterceptorKey("PRINTING_DOM_COLLECT");class aa extends s.Disposable{constructor(){super();B(this,"_printComponentMap",new Map);B(this,"interceptor",new s.InterceptorManager({PRINTING_COMPONENT_COLLECT:Zd,PRINTING_DOM_COLLECT:$d}));this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:e=>e}))}registerPrintComponent(e,n){this._printComponentMap.set(e,n)}getPrintComponent(e){return this._printComponentMap.get(e)}}var eA=Object.getOwnPropertyDescriptor,tA=(o,t,e,n)=>{for(var i=n>1?void 0:n?eA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Nt=(o,t)=>(e,n)=>t(e,n,o);const ra=300;y.DocStateChangeManagerService=class extends s.RxDisposable{constructor(e,n,i,a,r){super();B(this,"_docStateChange$",new L.BehaviorSubject(null));B(this,"docStateChange$",this._docStateChange$.asObservable());B(this,"_historyStateCache",new Map);B(this,"_changeStateCache",new Map);B(this,"_historyTimer",null);B(this,"_changeStateCacheTimer",null);this._undoRedoService=e,this._commandService=n,this._univerInstanceService=i,this._docStateEmitService=a,this._renderManagerService=r,this._initialize(),this._listenDocStateChange()}getStateCache(e){var n,i;return{history:(n=this._historyStateCache.get(e))!=null?n:[],collaboration:(i=this._changeStateCache.get(e))!=null?i:[]}}setStateCache(e,n){this._historyStateCache.set(e,n.history),this._changeStateCache.set(e,n.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===s.UndoCommandId||e.id===s.RedoCommandId){const n=this._univerInstanceService.getCurrentUniverDocInstance();if(n==null)return;const i=n.getUnitId();this._pushHistory(i),this._emitChangeState(i)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe(L.takeUntil(this.dispose$)).subscribe(e=>{var l;if(e==null)return;const{isCompositionEnd:n,isSync:i,syncer:a,...r}=e,c=(l=this._renderManagerService.getRenderById(i?a:e.unitId))==null?void 0:l.with(ft);if(c!=null){if(n){const A=c.fetchComposedUndoRedoMutationParams();if(A==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:d,redoMutationParams:u,previousActiveRange:m}=A;r.redoState.actions=u.actions,r.undoState.actions=d.actions,r.undoState.textRanges=[m]}this._setChangeState(r)}})}_cacheChangeState(e,n="history"){const{trigger:i,unitId:a,noHistory:r,debounce:c=!1}=e;if(r||i==null||n==="history"&&(i===s.RedoCommandId||i===s.UndoCommandId))return;const l=n==="history"?this._historyStateCache:this._changeStateCache,A=n==="history"?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(l.has(a)){const d=l.get(a);d==null||d.push(e)}else l.set(a,[e]);c?n==="history"?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{A(a)},ra)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{A(a)},ra)):A(a)}_pushHistory(e){const n=this._undoRedoService,i=this._historyStateCache.get(e);if(!Array.isArray(i)||i.length===0)return;const a=i.length,r=i[0].commandId,c=i[0],l=i[a-1],A={unitId:e,actions:i.reduce((u,m)=>s.JSONX.compose(u,m.redoState.actions),null),textRanges:l.redoState.textRanges},d={unitId:e,actions:i.reverse().reduce((u,m)=>s.JSONX.compose(u,m.undoState.actions),null),textRanges:c.undoState.textRanges};n.pushUndoRedo({unitID:e,undoMutations:[{id:r,params:d}],redoMutations:[{id:r,params:A}]}),i.length=0}_emitChangeState(e){const n=this._changeStateCache.get(e);if(!Array.isArray(n)||n.length===0)return;const i=n.length,{commandId:a,trigger:r,segmentId:c,noHistory:l,debounce:A}=n[0],d=n[0],u=n[i-1],m={unitId:e,actions:n.reduce((p,f)=>s.JSONX.compose(p,f.redoState.actions),null),textRanges:u.redoState.textRanges},h={unitId:e,actions:n.reverse().reduce((p,f)=>s.JSONX.compose(p,f.undoState.actions),null),textRanges:d.undoState.textRanges},g={commandId:a,unitId:e,trigger:r,redoState:m,undoState:h,segmentId:c,noHistory:l,debounce:A};n.length=0,this._docStateChange$.next(g)}},y.DocStateChangeManagerService=tA([Nt(0,s.Inject(s.IUndoRedoService)),Nt(1,s.ICommandService),Nt(2,s.IUniverInstanceService),Nt(3,s.Inject(D.DocStateEmitService)),Nt(4,_.IRenderManagerService)],y.DocStateChangeManagerService);var nA=Object.getOwnPropertyDescriptor,oA=(o,t,e,n)=>{for(var i=n>1?void 0:n?nA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},ca=(o,t)=>(e,n)=>t(e,n,o);const la="univer-doc-main-canvas";y.DocsRenderService=class extends s.RxDisposable{constructor(t,e){super(),this._instanceSrv=t,this._renderManagerService=e,this._init()}_init(){this._renderManagerService.createRender$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderWithId(t)),this._instanceSrv.getAllUnitsForType(s.UniverInstanceType.UNIVER_DOC).forEach(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitAdded$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitDisposed$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._disposeRenderer(t))}_createRenderer(t){var i;const e=t.getUnitId(),n=(i=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:i.getUnitId();this._renderManagerService.created$.subscribe(a=>{a.unitId===n&&(a.engine.getCanvas().setId(la),a.engine.getCanvas().getContext().setId(la))}),this._renderManagerService.has(e)||this._createRenderWithId(e)}_createRenderWithId(t){this._renderManagerService.createRender(t)}_disposeRenderer(t){const e=t.getUnitId();this._renderManagerService.removeRender(e)}},y.DocsRenderService=oA([ca(0,s.IUniverInstanceService),ca(1,_.IRenderManagerService)],y.DocsRenderService);const iA={id:ze.id,preconditions:ol,binding:I.KeyCode.ENTER},sA={id:ht.id,preconditions:ee,binding:I.KeyCode.BACKSPACE},aA={id:Hn.id,preconditions:ee,binding:I.KeyCode.DELETE},rA={id:Oe.id,binding:I.KeyCode.ARROW_UP,preconditions:ee,staticParameters:{direction:s.Direction.UP}},cA={id:Oe.id,binding:I.KeyCode.ARROW_DOWN,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},lA={id:Oe.id,binding:I.KeyCode.ARROW_LEFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},dA={id:Oe.id,binding:I.KeyCode.ARROW_RIGHT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},AA={id:Re.id,binding:I.KeyCode.ARROW_UP|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.UP}},uA={id:Re.id,binding:I.KeyCode.ARROW_DOWN|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},hA={id:Re.id,binding:I.KeyCode.ARROW_LEFT|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},gA={id:Re.id,binding:I.KeyCode.ARROW_RIGHT|I.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},mA={id:qn.id,binding:I.KeyCode.A|I.MetaKeys.CTRL_COMMAND,preconditions:o=>o.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&(o.getContextValue(s.FOCUSING_DOC)||o.getContextValue(s.EDITOR_ACTIVATED))};var pA=Object.defineProperty,fA=Object.getOwnPropertyDescriptor,SA=(o,t,e)=>t in o?pA(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,IA=(o,t,e,n)=>{for(var i=n>1?void 0:n?fA(t,e):t,a=o.length-1,r;a>=0;a--)(r=o[a])&&(i=r(i)||i);return i},Pt=(o,t)=>(e,n)=>t(e,n,o),vA=(o,t,e)=>SA(o,t+"",e);y.UniverDocsUIPlugin=class extends s.Plugin{constructor(t=Ws,e,n,i,a,r){super(),this._config=t,this._injector=e,this._renderManagerSrv=n,this._commandService=i,this._logService=a,this._configService=r;const{menu:c,...l}=s.merge({},Ws,this._config);c&&this._configService.setConfig("menu",c,{merge:!0}),this._configService.setConfig(pn,l),this._initDependencies(e),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),s.touchDependencies(this._injector,[[y.DocStateChangeManagerService],[y.DocsRenderService]])}onRendered(){this._initUI(),this._initRenderModules(),s.touchDependencies(this._injector,[[Sn],[vn],[st],[En],[y.DocUIController]])}_initCommand(){[ht,Hn,Be,_e,Ne,Pe,Ee,we,he,Ue,Ce,Ze,Te,ye,Qt,Qn,Ye,Wt,Fn,Gt,pi,ue,tt,et,$e,Et,Ct,Tt,ge,yt,pt,bo,Mo,sn,an,es,rn,cn,nn,on,it,Lo,xo,ke,dt,ze,Yt,St,vt,to,no,Jn,Rt,pe,Ln,Ve,Hi,$n,ki,bt,qn,Vo,Oe,Re,Wi,eo,Gi,ce,Xi,kn,Kn,zn,co,lo,Ao,uo,ho,qt,ji,Ki,io,so,ao,Yn,Bs,Fo].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))}),[mt,Kt,zt].forEach(t=>this.disposeWithMe(this._commandService.registerMultipleCommand(t)))}_initializeShortcut(){[rA,cA,dA,lA,AA,uA,hA,gA,mA,sA,aA,iA,sl].forEach(t=>{this._injector.get(I.IShortcutService).registerShortcut(t)})}_initDependencies(t){s.mergeOverrideWithDependencies([[aa],[Tn],[yn],[y.DocUIController],[Sn],[En],[vn],[fn],[st],[le,{useClass:y.EditorService}],[De,{useClass:Xn}],[y.DocCanvasPopManagerService],[y.DocsRenderService],[y.DocStateChangeManagerService],[y.DocAutoFormatService],[ve]],this._config.override).forEach(n=>t.add(n))}_markDocAsFocused(){const t=this._injector.get(s.IUniverInstanceService),e=this._injector.get(le);try{const n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!n)return;const i=n.getUnitId();e.isEditor(i)||t.focusUnit(n.getUnitId())}catch(n){this._logService.warn(n)}}_initUI(){this._injector.get(fn)}_initRenderBasics(){[[D.DocSkeletonManagerService],[y.DocSelectionRenderService],[D.DocInterceptorService],[Jo],[ft],[y.DocRenderController],[ei]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}_initRenderModules(){[[y.DocEventManagerService],[gn],[mn],[y.DocBackScrollRenderController],[$o],[No],[Zo],[zo],[Ko],[Tn],[qo],[Yo],[yn]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}},vA(y.UniverDocsUIPlugin,"pluginName",si),y.UniverDocsUIPlugin=IA([s.DependentOn(_.UniverRenderEnginePlugin),Pt(1,s.Inject(s.Injector)),Pt(2,_.IRenderManagerService),Pt(3,s.ICommandService),Pt(4,s.ILogService),Pt(5,s.IConfigService)],y.UniverDocsUIPlugin);function da(o,t,e){const n=I.useDependency(s.ICommandService),i=I.useDependency(I.IShortcutService),a=w.useMemo(()=>s.generateRandomId(4),[]);w.useEffect(()=>{if(!e||!o||!t)return;const c=`sheet.operation.editor-${e.getEditorId()}-keyboard-${a}`,l=new s.DisposableCollection;return l.add(n.registerCommand({id:c,type:s.CommandType.OPERATION,handler(A,d){const{keyCode:u,metaKey:m}=d;t.handler(u,m)}})),t.keyCodes.map(A=>({id:c,binding:A.metaKey?A.keyCode|A.metaKey:A.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:A.keyCode,metaKey:A.metaKey}})).forEach(A=>{l.add(i.registerShortcut(A))}),()=>{l.dispose()}},[n,t,e,o,a,i])}const Aa=(o,t=!0,e,n)=>{const i=w.useCallback(()=>{if(o){const{scene:r,mainComponent:c}=o.render,l=o.render.with(D.DocSkeletonManagerService),{width:A,height:d}=o.getBoundingClientRect();l.getViewModel().getDataModel().updateDocumentDataPageSize(t?1/0:A,1/0),r.transformByState({width:A,height:d}),c==null||c.resize(A,d)}},[o,t]),a=w.useMemo(()=>s.debounce(()=>{var E,C;if(!e||!o||!e)return;const c=o.render.with(D.DocSkeletonManagerService).getSkeleton(),{scene:l,mainComponent:A}=o.render,d=l.getViewport(ae.VIEW_MAIN),{actualWidth:u,actualHeight:m}=c.getActualSize(),{width:h,height:g}=o.getBoundingClientRect();let p=d==null?void 0:d.getScrollBar();const f=Math.max(u,h),S=Math.max(m,g);l.transformByState({width:f,height:S}),A==null||A.resize(f,S),t?u>h?(p==null?d&&new _.ScrollBar(d,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:1/0,y:0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(C=d==null?void 0:d.getScrollBar())==null||C.dispose()):m>g?(p==null?d&&(p=new _.ScrollBar(d,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:0,y:1/0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(E=d==null?void 0:d.getScrollBar())==null||E.dispose())},30),[o,e,t,n]);return w.useEffect(()=>{if(e&&o){const r=setTimeout(()=>{i(),a()},500);return()=>{clearTimeout(r)}}},[o,e,i,a]),w.useEffect(()=>{if(e&&o){const r=o.input$.subscribe(()=>{a()});return()=>{r.unsubscribe()}}},[o,e,a]),{resize:i,checkScrollBar:a}};function EA(o){const{editorId:t,initialValue:e,container:n,autoFocus:i,isSingle:a}=o,r=w.useMemo(()=>i!=null?i:!1,[]),[c,l]=w.useState(),A=I.useDependency(le);return w.useLayoutEffect(()=>{var d,u;if(n.current){const m=typeof e=="string"?void 0:s.Tools.deepClone(e),h={body:{dataStream:typeof e=="string"?`${e}\r
`:`\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...m,documentStyle:{...m==null?void 0:m.documentStyle,pageSize:{width:a?1/0:n.current.clientWidth,height:1/0}},id:t},g=A.register({autofocus:!0,editorUnitId:t,initialSnapshot:h},n.current),p=A.getEditor(t);if(l(p),r){p.focus();const f=((u=(d=h.body)==null?void 0:d.dataStream.length)!=null?u:2)-2;p.setSelectionRanges([{startOffset:f,endOffset:f}])}return()=>{g==null||g.dispose()}}},[]),c}const CA=(o,t,e,n)=>{const i=I.useDependency(s.ICommandService),a=I.useDependency(I.IShortcutService),r=w.useRef(t);r.current=t;const c=w.useRef(n);c.current=n,w.useEffect(()=>{if(!e||!o)return;const A=`sheet.formula-embedding-editor.${e.getEditorId()}`,d=new s.DisposableCollection,u=(h,g)=>{if(c.current){c.current(h,g);return}let p=s.Direction.LEFT;h===I.KeyCode.ARROW_DOWN?p=s.Direction.DOWN:h===I.KeyCode.ARROW_UP?p=s.Direction.UP:h===I.KeyCode.ARROW_RIGHT&&(p=s.Direction.RIGHT),g===I.MetaKeys.SHIFT?i.executeCommand(Re.id,{direction:p}):i.executeCommand(Oe.id,{direction:p})};return d.add(i.registerCommand({id:A,type:s.CommandType.OPERATION,handler(h,g){const{keyCode:p}=g;u(p)}})),[{keyCode:I.KeyCode.ARROW_DOWN},{keyCode:I.KeyCode.ARROW_LEFT},{keyCode:I.KeyCode.ARROW_RIGHT},{keyCode:I.KeyCode.ARROW_UP},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND},{keyCode:I.KeyCode.ARROW_DOWN,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_LEFT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_RIGHT,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT},{keyCode:I.KeyCode.ARROW_UP,metaKey:I.MetaKeys.CTRL_COMMAND|I.MetaKeys.SHIFT}].map(({keyCode:h,metaKey:g})=>({id:A,binding:g?h|g:h,preconditions:()=>!0,priority:900,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:h}})).forEach(h=>{d.add(a.registerShortcut(h))}),()=>{d.dispose()}},[i,e,o,a])};function TA(o,t){const e=I.useDependency(s.ICommandService);w.useEffect(()=>{if(!o)return;const n=e.onCommandExecuted(i=>{var a,r;if(i.id===D.RichTextEditingMutation.id){if(i.params.unitId!==o.getEditorId())return;const l=o.getDocumentData();t(l,s.getPlainText((r=(a=l.body)==null?void 0:a.dataStream)!=null?r:""))}});return()=>{n.dispose()}},[o,t,e])}const yA=o=>{var W;const{className:t,autoFocus:e,onFocusChange:n,initialValue:i,onClickOutside:a,keyboardEventConfig:r,moveCursor:c=!0,style:l,isSingle:A,editorId:d,onHeightChange:u,onChange:m,defaultHeight:h=32,maxHeight:g=32,icon:p,editorRef:f,placeholder:S}=o,E=I.useDependency(le),C=I.useEvent(n),T=I.useEvent(a),[R,v]=w.useState(h),O=w.useRef(null),M=w.useMemo(()=>d!=null?d:s.createInternalEditorID(`RICH_TEXT_EDITOR-${s.generateRandomId(4)}`),[d]),b=EA({editorId:M,initialValue:i,container:O,autoFocus:e,isSingle:A}),x=I.useDependency(_.IRenderManagerService).getRenderById(M),U=x==null?void 0:x.with(y.DocSelectionRenderService),F=I.useObservable(U==null?void 0:U.textSelectionInner$),V=!!((W=U==null?void 0:U.isFocusing)!=null&&W&&(F!=null&&F.textRanges.some(G=>G.collapsed))),H=w.useRef(null),[Q,j]=w.useState(()=>{var G,K;return!s.BuildTextUtils.transform.getPlainText((K=(G=b==null?void 0:b.getDocumentData().body)==null?void 0:G.dataStream)!=null?K:"")}),{checkScrollBar:X}=Aa(b,A,!0,!0);w.useLayoutEffect(()=>{if(!(!f||!b)){if(typeof f=="function"){f(b);return}f.current=b}},[b]);const k=I.useEvent(G=>{var q,z;const K=x==null?void 0:x.with(D.DocSkeletonManagerService),Y=K==null?void 0:K.getSkeleton().getActualSize();Y&&(u==null||u(Y.actualHeight),v(Math.max(h,Math.min(Y.actualHeight+10,g)))),m==null||m(G,s.getPlainText((z=(q=G.body)==null?void 0:q.dataStream)!=null?z:"")),X()});return w.useEffect(()=>{var K,Y;j(!s.BuildTextUtils.transform.getPlainText((Y=(K=b==null?void 0:b.getDocumentData().body)==null?void 0:K.dataStream)!=null?Y:""));const G=b==null?void 0:b.selectionChange$.subscribe(()=>{var q,z;j(!s.BuildTextUtils.transform.getPlainText((z=(q=b==null?void 0:b.getDocumentData().body)==null?void 0:q.dataStream)!=null?z:""))});return()=>G==null?void 0:G.unsubscribe()},[b]),I.useObservable(b==null?void 0:b.blur$),I.useObservable(b==null?void 0:b.focus$),w.useEffect(()=>{var K,Y;const G=b==null?void 0:b.getDocumentData();C==null||C(V,s.getPlainText((Y=(K=G==null?void 0:G.body)==null?void 0:K.dataStream)!=null?Y:""))},[V,C]),w.useEffect(()=>{const G=Y=>{var z,$;E.getFocusId()!==M||(($=(z=Y.target)==null?void 0:z.dataset)==null?void 0:$.editorid)===M||H.current&&!H.current.contains(Y.target)&&(T==null||T())},K=setTimeout(()=>{document.addEventListener("click",G)},100);return()=>{document.removeEventListener("click",G),clearTimeout(K)}},[b,M,E,T]),CA(V&&c,!1,b),da(V,r,b),TA(b,k),P.jsx("div",{className:t,style:l,children:P.jsxs("div",{className:J.clsx("univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2 univer-pt-1.5",J.borderClassName,{"univer-border-primary-500":V}),style:{height:R},ref:H,children:[P.jsx("div",{ref:O,className:"univer-relative univer-size-full",onMouseUp:()=>b==null?void 0:b.focus()}),p,Q?P.jsx("div",{className:"univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",children:S}):null]})})};y.AfterSpaceCommand=dt,y.AlignCenterCommand=Ct,y.AlignJustifyCommand=yt,y.AlignLeftCommand=Et,y.AlignOperationCommand=ge,y.AlignRightCommand=Tt,y.BreakLineCommand=Qt,y.BulletListCommand=et,y.ChangeListNestingLevelCommand=Yt,y.ChangeListNestingLevelType=It,y.ChangeListTypeCommand=St,y.CheckListCommand=vt,y.CoverContentCommand=ki,y.CreateDocTableCommand=bo,y.CutContentCommand=Ve,y.DOCS_COMPONENT_BACKGROUND_LAYER_INDEX=ai,y.DOCS_COMPONENT_DEFAULT_Z_INDEX=xn,y.DOCS_COMPONENT_HEADER_LAYER_INDEX=ri,y.DOCS_COMPONENT_MAIN_LAYER_INDEX=wt,y.DOCS_VIEW_KEY=de,y.DOC_UI_PLUGIN_NAME=si,y.DOC_VERTICAL_PADDING=Ho,y.DefaultDocContainerConfig=ii,y.DefaultToolbarConfig=oi,y.DeleteCommand=Ye,y.DeleteCustomBlockCommand=Wt,y.DeleteLeftCommand=ht,y.DeleteRightCommand=Hn,y.DocCopyCommand=mt,y.DocCreateTableOperation=ln,y.DocCutCommand=Kt,y.DocIMEInputManagerService=ft,y.DocPasteCommand=zt,y.DocPrintInterceptorService=aa,y.DocSelectAllCommand=qn,y.DocTableDeleteColumnsCommand=on,y.DocTableDeleteRowsCommand=nn,y.DocTableDeleteTableCommand=it,y.DocTableInsertColumnCommand=es,y.DocTableInsertColumnLeftCommand=rn,y.DocTableInsertColumnRightCommand=cn,y.DocTableInsertRowAboveCommand=sn,y.DocTableInsertRowBellowCommand=an,y.DocTableInsertRowCommand=Mo,y.DocTableTabCommand=xo,y.DocsUIMenuSchema=Ys,y.Editor=vs,y.EditorInsertTextCommandId=mi,y.EnterCommand=ze,y.HorizontalLineCommand=pt,y.IDocClipboardService=De,y.IEditorService=le,y.IMEInputCommand=Jn,y.InnerPasteCommand=Ln,y.InsertCommand=Qn,y.InsertCustomRangeCommand=Gi,y.ListOperationCommand=$e,y.MergeTwoParagraphCommand=Gt,y.MoveCursorOperation=Oe,y.MoveSelectionOperation=Re,y.NORMAL_TEXT_SELECTION_PLUGIN_NAME=pa,y.NodePositionConvertToCursor=be,y.NodePositionConvertToRectRange=vo,y.OrderListCommand=tt,y.PastePluginLark=vi,y.PastePluginUniver=Ci,y.PastePluginWord=Ti,y.QuickListCommand=no,y.RectRange=Co,y.ReplaceContentCommand=Hi,y.ReplaceSelectionCommand=eo,y.ReplaceSnapshotCommand=$n,y.ReplaceTextRunsCommand=Wi,y.ResetInlineFormatTextBackgroundColorCommand=Ze,y.RichTextEditor=yA,y.SetDocZoomRatioCommand=bt,y.SetDocZoomRatioOperation=ue,y.SetInlineFormatBoldCommand=Be,y.SetInlineFormatCommand=ye,y.SetInlineFormatFontFamilyCommand=Ue,y.SetInlineFormatFontSizeCommand=he,y.SetInlineFormatItalicCommand=_e,y.SetInlineFormatStrikethroughCommand=Pe,y.SetInlineFormatSubscriptCommand=Ee,y.SetInlineFormatSuperscriptCommand=we,y.SetInlineFormatTextBackgroundColorCommand=Te,y.SetInlineFormatTextColorCommand=Ce,y.SetInlineFormatUnderlineCommand=Ne,y.SetParagraphNamedStyleCommand=ce,y.SwitchDocModeCommand=Rt,y.TEXT_RANGE_LAYER_INDEX=Zt,y.TabCommand=ke,y.TextRange=We,y.ToggleCheckListCommand=to,y.UpdateCommand=Fn,y.VIEWPORT_KEY=ae,y.addCustomDecorationBySelectionFactory=Sa,y.addCustomDecorationFactory=li,y.calcDocRangePositions=hn,y.convertBodyToHtml=bi,y.convertPositionsToRectRanges=en,y.deleteCustomDecorationFactory=Ia,y.docDrawingPositionToTransform=Ea,y.genTableSource=wn,y.generateParagraphs=Nn,y.getAnchorBounding=Ot,y.getCanvasOffsetByEngine=Zi,y.getCommandSkeleton=re,y.getCursorWhenDelete=Xt,y.getCustomBlockIdsInSelections=hi,y.getCutActionsFromDocRanges=gi,y.getDocObject=ci,y.getDocObjectById=fa,y.getEmptyTableCell=Ht,y.getEmptyTableRow=kt,y.getLineBounding=$t,y.getOneTextSelectionRange=po,y.getRichTextEditPath=Z,y.getTableColumn=Vt,y.hasParagraphInTable=va,y.isInSameTableCell=So,y.isValidRectRange=zi,y.neoGetDocObject=Ie,y.transformToDocDrawingPosition=Ca,y.useKeyboardEvent=da,y.useResize=Aa,y.whenDocAndEditorFocused=ee,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})}));
