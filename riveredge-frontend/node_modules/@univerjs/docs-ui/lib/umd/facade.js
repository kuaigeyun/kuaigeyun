(function(n,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("@univerjs/core"),require("@univerjs/core/facade"),require("@univerjs/docs-ui"),require("@univerjs/engine-render")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/core/facade","@univerjs/docs-ui","@univerjs/engine-render"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.UniverDocsUiFacade={},n.UniverCore,n.UniverCoreFacade,n.UniverDocsUi,n.UniverEngineRender))})(this,(function(n,e,a,v,h){"use strict";var D=Object.defineProperty;var U=(n,e,a)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var m=(n,e,a)=>U(n,typeof e!="symbol"?e+"":e,a);var _=Object.getOwnPropertyDescriptor,g=(o,t,r,i)=>{for(var s=i>1?void 0:i?_(t,r):t,c=o.length-1,u;c>=0;c--)(u=o[c])&&(s=u(s)||s);return s},d=(o,t)=>(r,i)=>t(r,i,o);n.FDocument=class{constructor(t,r,i,s,c,u){m(this,"id");this._documentDataModel=t,this._injector=r,this._univerInstanceService=i,this._commandService=s,this._resourceManagerService=c,this._renderManagerService=u,this.id=this._documentDataModel.getUnitId()}getId(){return this._documentDataModel.getUnitId()}getName(){return this.getSnapshot().title||""}getSnapshot(){const t=this._resourceManagerService.getResourcesByType(this.id,e.UniverInstanceType.UNIVER_DOC),r=this._documentDataModel.getSnapshot();return r.resources=t,r}undo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.executeCommand(e.UndoCommand.id)}redo(){return this._univerInstanceService.focusUnit(this.id),this._commandService.executeCommand(e.RedoCommand.id)}appendText(t){const r=this.id,{body:i}=this.getSnapshot();if(!i)throw new Error("The document body is empty");const s=i.dataStream.length-2,c={startOffset:s,endOffset:s,collapsed:!0,segmentId:""},{segmentId:u}=c;return this._commandService.executeCommand(v.InsertCommand.id,{unitId:r,body:{dataStream:t},range:c,segmentId:u})}setSelection(t,r){var s;const i=(s=this._renderManagerService.getRenderById(this.getId()))==null?void 0:s.with(v.DocSelectionRenderService);i==null||i.removeAllRanges(),i==null||i.addDocRanges([{startOffset:t,endOffset:r,rangeType:e.DOC_RANGE_TYPE.TEXT}],!0)}},n.FDocument=g([d(1,e.Inject(e.Injector)),d(2,e.IUniverInstanceService),d(3,e.ICommandService),d(4,e.IResourceManagerService),d(5,h.IRenderManagerService)],n.FDocument);class I extends a.FUniver{createUniverDoc(t){const r=this._univerInstanceService.createUnit(e.UniverInstanceType.UNIVER_DOC,t);return this._injector.createInstance(n.FDocument,r)}getActiveDocument(){const t=this._univerInstanceService.getCurrentUnitForType(e.UniverInstanceType.UNIVER_DOC);return t?this._injector.createInstance(n.FDocument,t):null}getUniverDoc(t){const r=this._univerInstanceService.getUniverDocInstance(t);return r?this._injector.createInstance(n.FDocument,r):null}}a.FUniver.extend(I),Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
