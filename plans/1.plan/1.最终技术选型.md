# RiverEdge SaaS 多组织框架 - React生态最佳实践技术选型

## 📋 技术栈概览

基于 **RiverEdge SaaS 多组织框架 (RiverEdge SaaS Multi-tenant Framework)** 的架构设计，**采用纯React生态最佳实践**，技术栈如下：

## 📑 目录

1. [技术栈概览](#技术栈概览)
2. [版本号检查清单](#版本号检查清单)
3. [后端技术栈](#后端技术栈-riveredge-core)
4. [前端技术栈](#前端技术栈-riveredge-shell)
5. [数据库技术栈](#数据库技术栈)
6. [插件系统技术栈](#插件系统技术栈)
7. [开发工具](#开发工具)
8. [部署方案](#部署方案)
9. [依赖管理](#依赖管理)
10. [技术栈优势总结](#技术栈优势总结)
11. [注意事项](#注意事项)
12. [快速开始建议](#快速开始建议)

## ⚠️ 版本号检查清单

在开始开发前，请检查以下版本号是否为**兼容性最佳的稳定组合**：

### 后端技术栈 (推荐稳定组合)
- [x] Python 3.11 LTS (长期支持版本，推荐3.11.9)
- [x] FastAPI 0.104.1 (稳定兼容版本，与 Tortoise ORM 0.20.1 完美兼容)
- [x] Uvicorn 0.30.0 (ASGI 服务器，FastAPI 官方推荐)
- [x] Pydantic 2.8.0 (稳定版，与FastAPI 0.104.1完美兼容)
- [x] Pydantic Settings 2.5.0 (配置管理，Pydantic 官方推荐)
- [x] Tortoise ORM 0.20.1 (稳定版，与FastAPI 0.104.1完美兼容)
- [x] Aerich 0.7.1 (稳定版，Tortoise ORM 数据库迁移工具)
- [x] asyncpg 0.29.0 (PostgreSQL 异步驱动，Python 3.11+ 预编译包)
- [x] psycopg2-binary 2.9.7 (PostgreSQL 同步驱动，备选方案)
- [x] Redis 5.0.1 (redis-py，使用 redis.asyncio 异步接口，支持 hiredis)
- [x] python-jose[cryptography] 3.3.0 (JWT 认证)
- [x] passlib[bcrypt] 1.7.4 (密码加密)
- [x] python-multipart 0.0.6 (表单数据处理)
- [x] httpx 0.25.2 (异步 HTTP 客户端)
- [x] loguru 0.7.2 (现代化日志库)
- [x] psutil 5.9.8 (系统资源监控)
- [x] pytest 7.4.3 (测试框架)
- [x] pytest-asyncio 0.21.1 (异步测试支持)
- [x] Inngest (工作流引擎，最新稳定版，可选)
- [x] PostgreSQL 15+ (推荐15.6)
- [x] Redis 7.2+ (推荐7.2.4)
- [x] kkfileview (文件预览服务，最新稳定版，可选)

### 前端技术栈 (React生态最佳实践组合)
- [x] React 18.3.1 (最新稳定版，性能优化)
- [x] Vite 5.4.8 (构建工具，速度极快)
- [x] React Router DOM 6.26.2 (路由管理，React官方推荐，稳定版)
- [x] Zustand 5.0.0 (状态管理，轻量级现代化，稳定版)
- [x] TanStack Query 5.51.1 (数据获取，React Query官方，稳定版)
- [x] React Hook Form 7.53.0 (表单管理，高性能，稳定版)
- [x] Ant Design 5.17.0 (LTS稳定版，长期维护)
- [x] @ant-design/pro-components 2.7.10 (兼容antd 5.x的稳定版)
- [x] TypeScript 5.6.3 (LTS稳定版，长期维护)
- [x] Vitest 2.1.8 (现代化测试框架，原生ESM支持，稳定版)
- [x] Luckysheet 2.1.13+ (Excel 在线编辑器，最新稳定版)
- [x] react-joyride 2.5.2+ (新手指引库，最新稳定版)

### 其他工具
- [x] Node.js 20.17.0 (LTS版本，性能更佳，长期维护)
- [x] pnpm 8.15.0 (稳定版，推荐)
- [x] Bun 1.0.30 (稳定版，可选替代)

> **检查方法**：
> - 访问各技术的官方网站查看最新稳定版
> - 使用 `pip list` 或 `npm list` 检查已安装版本
> - 参考各技术的官方文档确认版本兼容性

## 🔧 后端技术栈 (riveredge-core)

### 编程语言

**Python 3.11 LTS**

- **版本**: Python 3.11 LTS (长期支持版本)
- **特点**:
  - 性能显著提升（比3.10快10-60%）
  - 更好的错误提示和类型系统
  - 改进的异步支持
  - 长期维护至2027年10月
- **优势**:
  - 企业级稳定性保证
  - 语法简洁，开发效率高
  - 丰富的生态系统
  - 适合长期项目维护
  - 强大的数据处理能力

### Web 框架

**FastAPI 0.104.1**

- **版本**: FastAPI 0.104.1 (稳定兼容版本，与 Tortoise ORM 0.20.1 完美兼容)
- **特点**:
  - 基于 Starlette 和 Pydantic 构建
  - 自动生成 OpenAPI/Swagger 文档
  - 异步支持，性能优异
  - 类型提示和自动验证
  - 更好的错误处理和中间件支持
- **优势**:
  - 开发速度快，代码简洁
  - 自动生成交互式 API 文档
  - 高性能，媲美 Node.js 和 Go
  - 与 Tortoise ORM 0.20.1 完美兼容
  - 企业级稳定性和维护性
- **安装**:
  ```bash
  pip install fastapi==0.104.1
  ```

### ASGI 服务器

**Uvicorn**

- **版本**: Uvicorn 0.30.0 (稳定版，与 FastAPI 0.104.1 完美兼容)
- **特点**:
  - 基于 uvloop 和 httptools 的高性能 ASGI 服务器
  - 专为 FastAPI 设计，官方推荐
  - 支持 HTTP/1.1 和 WebSocket
  - 支持自动重载（开发环境）
  - 支持多进程部署（生产环境）
- **优势**:
  - 性能优异，异步处理能力强
  - 与 FastAPI 完美集成
  - 开发体验好，支持热重载
  - 生产环境稳定可靠
  - 官方维护，持续更新
- **安装**:
  ```bash
  pip install uvicorn[standard]==0.30.0
  ```
- **使用方式**:
  ```bash
  # 开发环境
  uvicorn main:app --reload --host 0.0.0.0 --port 8000
  
  # 生产环境（使用 gunicorn + uvicorn workers）
  gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
  ```

### 数据验证

**Pydantic v2**

- **版本**: Pydantic 2.8.0 (稳定版，与 FastAPI 0.104.1 完美兼容)
- **特点**:
  - 基于 Python 类型提示的数据验证
  - 性能提升（相比 v1 快 5-50 倍）
  - 更好的错误信息和类型推断
  - 支持 JSON Schema 生成
  - 改进的序列化性能
- **优势**:
  - 类型安全，减少运行时错误
  - 自动数据验证和转换
  - 与 FastAPI 0.104.1 完美兼容
  - 支持复杂的数据模型
  - 企业级稳定性和维护性
- **安装**:
  ```bash
  pip install pydantic==2.8.0
  pip install pydantic-settings==2.5.0
  ```

### 数据库

**PostgreSQL 15+**

- **版本**: PostgreSQL 15.x (最新稳定版)
- **特点**:
  - 功能强大的开源关系型数据库
  - 支持 JSON、数组等高级数据类型
  - 强大的事务支持
  - 优秀的并发性能
- **优势**:
  - 适合复杂查询和数据分析
  - 支持全文搜索
  - 丰富的扩展插件
  - 企业级可靠性

### ORM 框架

**Tortoise ORM 0.20.1**

- **版本**: Tortoise ORM 0.20.1 (稳定版，与 FastAPI 0.104.1 完美兼容)
- **特点**:
  - 异步 ORM，专为异步 Python 设计
  - Django ORM 风格的 API
  - 支持关系映射和查询构建
  - 自动生成模型
  - 改进的查询性能和错误处理
- **优势**:
  - 与 FastAPI 异步特性完美配合
  - 学习曲线平缓（类似 Django ORM）
  - 支持复杂查询和关系
  - 性能优异，稳定性强
  - 长期维护和社区支持
- **安装**:
  ```bash
  pip install tortoise-orm==0.20.1
  ```

### 数据库迁移

**Aerich 0.7.1**

- **版本**: Aerich 0.7.1 (兼容性最佳的稳定版本)
- **特点**:
  - Tortoise ORM 的数据库迁移工具
  - 类似 Django 的迁移系统
  - 支持版本控制和回滚
- **优势**:
  - 与 Tortoise ORM 0.20.1 无缝集成
  - 自动生成迁移文件
  - 支持团队协作
  - 支持版本控制和回滚
- **安装**:
  ```bash
  pip install aerich==0.7.1
  ```

### 缓存

**Redis 7+**

- **版本**: Redis 7.2+ (最新版本)
- **特点**:
  - 高性能内存数据库
  - 支持多种数据结构
  - 支持持久化
- **用途**:
  - 会话存储
  - 缓存热点数据
  - 分布式锁
  - 消息队列
- **Python 客户端**:
  ```bash
  pip install redis[hiredis]==5.0.1  # redis-py，内置异步支持（redis.asyncio），支持 hiredis 性能优化
  ```
  - **异步接口**: 使用 `redis.asyncio` 模块（redis-py 4.2.0+ 内置）
  - **优势**:
    - 官方维护，稳定可靠
    - 兼容 Python 3.13
    - 统一 API，同步和异步使用同一套接口
    - 支持 hiredis 性能优化

### 认证与安全

**JWT (JSON Web Tokens)**

- **库**: python-jose
- **安装**:
  ```bash
  pip install python-jose[cryptography]==3.3.0
  pip install passlib[bcrypt]==1.7.4
  pip install python-multipart==0.0.6  # 表单数据处理
  ```

### API 文档

**自动生成 (FastAPI 内置)**

- FastAPI 自动生成 OpenAPI/Swagger 文档
- 访问地址: `http://localhost:8000/docs`
- 交互式 API 测试界面

### 工作流引擎

**Inngest**

- **版本**: Inngest (最新稳定版)
- **特点**:
  - 现代化的后台任务和工作流引擎
  - 支持复杂的异步工作流编排
  - 内置重试、错误处理和状态管理
  - 支持定时任务和事件驱动
  - 提供可视化工作流监控
- **优势**:
  - 简化后台任务开发
  - 可靠的任务执行和重试机制
  - 支持复杂工作流编排
  - 提供完善的监控和调试工具
  - 与 FastAPI 完美集成
- **适用场景**:
  - 异步任务处理（邮件发送、数据导入导出等）
  - 复杂业务流程编排（订单处理、审批流程等）
  - 定时任务（数据同步、报表生成等）
  - 事件驱动任务（用户注册后处理、数据变更通知等）
- **安装**:
  ```bash
  pip install inngest
  ```
- **使用方式**:
  ```python
  import inngest
  
  # 创建 Inngest 客户端
  client = inngest.Inngest(app_id="riveredge-core")
  
  # 定义工作流函数
  @client.create_function(
      fn_id="process-order",
      trigger=inngest.TriggerEvent(event="order/created"),
  )
  async def process_order(ctx, step):
      # 工作流逻辑
      pass
  ```

### 文件预览服务

**kkfileview**

- **版本**: kkfileview (最新稳定版)
- **特点**:
  - 基于 Java 的文件预览服务
  - 支持多种文件格式预览（Office、PDF、图片、视频等）
  - 提供 RESTful API 接口
  - 支持在线预览和文件转换
  - 支持 Docker 部署
- **优势**:
  - 支持格式丰富，覆盖常见办公文档
  - 预览效果优秀，接近原生体验
  - 部署简单，支持容器化
  - 性能稳定，适合企业级应用
  - 开源免费，可商业使用
- **适用场景**:
  - Office 文档在线预览（Word、Excel、PPT）
  - PDF 文件预览
  - 图片和视频预览
  - 文件格式转换
- **部署方式**:
  ```bash
  # Docker 部署
  docker run -d -p 8012:8012 keking/kkfileview:latest
  ```
- **集成方式**:
  - 前端通过 iframe 嵌入预览页面
  - 后端通过 API 调用预览服务
  - 支持文件上传后自动预览

### 数据库驱动

**asyncpg 0.29.0 + psycopg2-binary 2.9.7**

- **版本**: 
  - asyncpg 0.29.0 (PostgreSQL 异步驱动，Python 3.11+ 预编译包)
  - psycopg2-binary 2.9.7 (PostgreSQL 同步驱动，备选方案)
- **特点**:
  - asyncpg：高性能异步 PostgreSQL 驱动
  - psycopg2-binary：成熟的同步驱动，作为备选方案
- **优势**:
  - asyncpg 性能优异，专为异步设计
  - psycopg2-binary 稳定可靠，兼容性好
  - 支持 Python 3.11+ 预编译包
- **安装**:
  ```bash
  pip install asyncpg==0.29.0
  pip install psycopg2-binary==2.9.7  # 备选方案
  ```

### 系统监控

**psutil 5.9.8**

- **版本**: psutil 5.9.8 (跨平台系统资源监控库)
- **特点**:
  - 跨平台系统资源监控
  - 支持 CPU、内存、磁盘、网络等监控
  - 性能优异，资源占用低
- **优势**:
  - 官方维护，稳定可靠
  - 跨平台支持（Windows、Linux、macOS）
  - 丰富的监控指标
- **适用场景**:
  - 系统资源监控
  - 性能分析
  - 健康检查
- **安装**:
  ```bash
  pip install psutil==5.9.8
  ```

### 其他后端工具

- **HTTP 客户端**: `httpx 0.25.2` (异步 HTTP 客户端，FastAPI 官方推荐)
- **日志**: `loguru 0.7.2` (现代化日志库)
- **配置管理**: `pydantic-settings 2.5.0` (Pydantic 官方配置管理)
- **测试框架**: `pytest 7.4.3` + `pytest-asyncio 0.21.1` (Python 官方推荐测试框架)
- **CLI 工具**: `typer` (FastAPI 作者开发，官方推荐 CLI 库，可选)
- **异步文件操作**: `aiofiles` (FastAPI 官方推荐，异步文件读写，可选)
- **表单处理**: `python-multipart 0.0.6` (FastAPI 官方推荐，处理表单数据和文件上传)
- **WebSocket 和后台任务**: `starlette` (FastAPI 基于 Starlette，可直接使用其功能)

### 官方推荐库说明

#### Typer - 命令行工具

**FastAPI 作者 Sebastián Ramírez 开发**

- **版本**: Typer (最新稳定版)
- **特点**:
  - 语法与 FastAPI 类似
  - 自动生成帮助文档
  - 类型提示支持
  - 易于测试
- **优势**:
  - 开发体验与 FastAPI 一致
  - 自动生成 CLI 帮助文档
  - 类型安全，减少错误
  - 官方维护，持续更新
- **适用场景**:
  - 管理脚本（数据库迁移、数据导入导出等）
  - CLI 工具（用户管理、系统配置等）
  - 开发工具（代码生成、测试等）
- **安装**:
  ```bash
  pip install typer[all]
  ```

#### aiofiles - 异步文件操作

**FastAPI 官方推荐**

- **版本**: aiofiles (最新稳定版)
- **特点**:
  - 异步文件读写
  - 支持异步上下文管理器
  - 与 asyncio 完美集成
  - 性能优异
- **优势**:
  - 提升文件操作性能
  - 与 FastAPI 异步特性完美配合
  - 支持大文件处理
  - 官方维护，稳定可靠
- **适用场景**:
  - 文件上传处理
  - 日志文件写入
  - 配置文件读取
  - 大文件处理
- **安装**:
  ```bash
  pip install aiofiles
  ```

#### Starlette - Web 框架基础

**FastAPI 基于 Starlette 构建**

- **版本**: Starlette (FastAPI 已包含)
- **特点**:
  - WebSocket 支持
  - 后台任务
  - 启动和关闭事件
  - 中间件系统
  - 静态文件服务
- **优势**:
  - 已间接使用（FastAPI 基于 Starlette）
  - 可以直接使用其功能
  - 官方维护，稳定可靠
- **适用场景**:
  - WebSocket 实时通信
  - 后台任务处理
  - 应用生命周期管理
- **使用方式**:
  ```python
  from fastapi import FastAPI, BackgroundTasks
  from starlette.websockets import WebSocket
  
  app = FastAPI()
  
  # WebSocket 支持
  @app.websocket("/ws")
  async def websocket_endpoint(websocket: WebSocket):
      await websocket.accept()
      # WebSocket 逻辑
      pass
  
  # 后台任务
  @app.post("/task")
  async def create_task(background_tasks: BackgroundTasks):
      background_tasks.add_task(send_notification)
      return {"status": "ok"}
  ```

## 🎨 前端技术栈 (riveredge-shell)

> **纯React生态最佳实践**: 完全基于React官方生态，使用现代化的工具链，确保技术栈的灵活性和可控性，同时保持Ant Design组件库的统一性。

### 核心框架

**React 18.3.1**

- **版本**: React 18.3.1 (最新稳定版，性能优化)
- **特点**:
  - Concurrent Features (并发特性)
  - Automatic Batching (自动批处理)
  - Suspense 改进
  - 更好的 TypeScript 支持
  - 性能优化和内存使用改进
- **优势**:
  - 组件化开发，代码复用性强
  - 庞大的生态系统和社区支持
  - 虚拟 DOM + Fiber 架构，性能优异
  - React官方维护，长期稳定
  - 企业级项目首选的稳定版本
- **安装**:
  ```bash
  npm install react@^18.3.1 react-dom@^18.3.1
  ```

### 构建工具

**Vite 5.4.8**

- **版本**: Vite 5.4.8 (最新稳定版)
- **特点**:
  - 基于 ESM 的快速构建工具
  - 原生 ES 模块支持
  - 闪电般的冷启动速度
  - 真正的按需编译
  - 优化的生产构建
  - 丰富的插件生态
- **优势**:
  - 开发服务器启动速度极快 (<100ms)
  - 热更新响应迅速
  - 零配置开箱即用
  - 支持 TypeScript、JSX、CSS 等
  - 现代化的构建体验
  - 完全替代 Webpack 的最佳选择
- **安装**:
  ```bash
  npm install -D vite@^5.4.8
  ```

### 路由管理

**React Router DOM 6.26.2**

- **版本**: React Router DOM 6.26.2 (React官方路由解决方案，稳定版)
- **特点**:
  - React 官方路由解决方案
  - 基于 React Hooks 的现代化 API
  - 支持嵌套路由
  - 支持动态路由和路由参数
  - 支持路由守卫和权限控制
  - 支持代码分割和懒加载
- **优势**:
  - React 官方维护，稳定可靠
  - API 设计现代化，使用 Hooks
  - 支持所有现代路由功能
  - 与 React 生态完美集成
  - 轻量级，无额外依赖
- **核心特性**:
  - `<BrowserRouter>`: 浏览器路由
  - `<Routes>` 和 `<Route>`: 路由配置
  - `useNavigate`: 编程式导航
  - `useParams`: 路由参数获取
  - `useLocation`: 位置信息获取
  - `Outlet`: 嵌套路由渲染
- **安装**:
  ```bash
  npm install react-router-dom@^6.26.2
  ```

### 状态管理

**Zustand 5.0.0**

- **版本**: Zustand 5.0.0 (轻量级现代化状态管理，稳定版)
- **特点**:
  - 轻量级状态管理库 (<1KB)
  - 基于 React Hooks 的现代化 API
  - 支持异步操作
  - 支持状态持久化
  - 支持状态中间件
  - TypeScript 友好
- **优势**:
  - 零配置，开箱即用
  - API 简洁直观
  - 性能优异，无额外渲染
  - 支持复杂状态逻辑
  - 完全可控，不强制模式
  - 比 Redux 更轻量，比 Context 更强大
- **核心概念**:
  - `create`: 创建状态存储
  - `useStore`: 使用状态的 Hook
  - `set`: 更新状态函数
  - `get`: 获取状态函数
- **使用场景**: 用户信息、应用配置、UI 状态、缓存数据等
- **安装**:
  ```bash
  npm install zustand@^5.0.0
  ```

### 数据获取

**TanStack Query 5.51.1 (React Query)**

- **版本**: TanStack Query 5.51.1 (智能服务端状态管理，稳定版，前身为 React Query)
- **特点**:
  - 强大的数据获取和缓存库
  - 支持服务端状态管理
  - 自动请求重试和错误处理
  - 智能缓存和后台更新
  - 支持分页和无限滚动
  - 支持乐观更新
- **优势**:
  - 减少样板代码，提升开发效率
  - 智能缓存，减少不必要的请求
  - 内置错误处理和重试机制
  - 支持实时数据更新
  - TypeScript 支持完善
  - 适用于所有数据获取场景
- **核心特性**:
  - `useQuery`: 数据获取 Hook
  - `useMutation`: 数据变更 Hook
  - `useInfiniteQuery`: 无限滚动
  - `QueryClient`: 查询客户端配置
  - 自动缓存失效和后台更新
- **安装**:
  ```bash
  npm install @tanstack/react-query@^5.51.1
  ```

### 表单管理

**React Hook Form 7.53.0**

- **版本**: React Hook Form 7.53.0 (高性能表单库，稳定版)
- **特点**:
  - 高性能的表单库
  - 基于 React Hooks
  - 最小的重新渲染
  - 内置验证支持
  - 支持复杂表单场景
  - TypeScript 友好
- **优势**:
  - 性能极佳，最少的重新渲染
  - API 简洁直观
  - 内置多种验证规则
  - 支持异步验证
  - 与 UI 库解耦，可与 Ant Design 完美配合
  - 比 Formik 和 Redux Form 更轻量高效
- **核心特性**:
  - `useForm`: 表单控制 Hook
  - `register`: 字段注册
  - `handleSubmit`: 表单提交处理
  - `formState`: 表单状态
  - `watch`: 监听字段变化
  - `setValue`: 编程式设置值
- **安装**:
  ```bash
  npm install react-hook-form@^7.53.0
  ```

### UI 组件库

**Ant Design 5.17.0 + Ant Design Pro Components 2.7.10**

- **版本**:
  - Ant Design 5.17.0 (LTS稳定版，长期维护)
  - @ant-design/pro-components 2.7.10 (与antd 5.x完美兼容的稳定版)
- **特点**:
  - 企业级 UI 设计语言
  - 丰富的组件库
  - 支持主题定制
  - TypeScript 支持完善
  - Pro Components 提供高级业务组件
  - 改进的性能和稳定性
- **优势**:
  - 组件质量高，设计规范统一
  - 文档完善，示例丰富
  - 适合企业级应用
  - 与 React Hook Form 无缝集成
  - Pro Components 大幅提升开发效率
  - 企业级项目首选的稳定组合
  - 长期维护和安全性保证
- **核心组件**:
  - `ProTable`: 高级表格组件，支持搜索、筛选、分页
  - `ProForm`: 高级表单组件，支持多种布局和验证
  - `ProCard`: 卡片容器组件
  - `ProLayout`: 页面布局组件
  - `ProList`: 列表组件
  - `ProDescriptions`: 描述列表组件
  - `ProSkeleton`: 骨架屏组件
- **安装**:
  ```bash
  npm install antd@^5.17.0
  npm install @ant-design/pro-components@^2.7.10
  ```

### 类型系统

**TypeScript 5.6.3**

- **版本**: TypeScript 5.6.3 (LTS稳定版，长期维护)
- **特点**:
  - 静态类型检查
  - 更好的 IDE 支持
  - 提升代码可维护性
  - 与 React 18.3.1 完美兼容
  - 改进的类型推断和错误提示
  - 更好的性能和稳定性
  - 支持新的 ECMAScript 特性
- **安装**:
  ```bash
  npm install -D typescript@^5.6.3
  ```

### 权限管理

**自定义 Context + React Router 守卫**

- **方案**: 基于 React Context + React Router 的权限系统
- **特点**:
  - 轻量级，无额外依赖
  - 完全可控的权限逻辑
  - 支持动态权限加载
  - 支持路由级权限控制
  - 支持组件级权限控制
- **优势**:
  - 避免第三方权限库的复杂性
  - 与应用架构完美集成
  - 性能优异
  - 易于维护和扩展
- **实现方式**:
  - 使用 Context 管理权限状态
  - 使用 React Router 的路由守卫
  - 支持权限指令和权限组件

### 国际化

**React i18next 14.1.3**

- **版本**: React i18next 14.1.3 (最新稳定版)
- **特点**:
  - React 国际化解决方案的标准
  - 支持多种语言切换
  - 支持命名空间
  - 支持插值和复数形式
  - 支持懒加载翻译文件
  - 丰富的插件生态
- **优势**:
  - 功能强大，生态完善
  - 支持复杂国际化场景
  - 与 React 生态完美集成
  - 性能优异，支持代码分割
  - 企业级项目首选方案
- **核心特性**:
  - `useTranslation`: 翻译 Hook
  - `Trans`: 翻译组件
  - `i18n.changeLanguage`: 语言切换
  - 支持 JSON 和其他格式的翻译文件
- **安装**:
  ```bash
  npm install react-i18next@^14.1.3 i18next@^23.15.2
  ```

### HTTP 客户端

**Fetch API + TanStack Query**

- **推荐**: 使用现代化的 Fetch API + TanStack Query
- **备选**: Axios 1.7.7 如果需要高级功能
- **特点**:
  - 浏览器原生支持 (Fetch)
  - 轻量级，无额外依赖
  - 支持请求/响应拦截器
  - 支持取消请求
  - 支持超时控制
- **优势**:
  - 与 TanStack Query 完美配合
  - 减少 HTTP 客户端库的复杂性
  - 现代化的 API 设计
  - 更好的 TypeScript 支持
- **备选安装 (如果需要)**:
  ```bash
  npm install axios@^1.7.7
  ```

### Excel 处理

**Luckysheet**

- **版本**: Luckysheet (最新稳定版)
- **特点**:
  - 功能强大的在线 Excel 编辑器
  - 支持 Excel 导入、编辑、导出
  - 提供丰富的 Excel 功能（公式、图表、筛选等）
  - 支持多人协作编辑
  - 完全基于前端实现，无需后端处理
- **优势**:
  - 功能完整，接近原生 Excel 体验
  - 性能优异，支持大数据量处理
  - 易于集成，提供 React 组件
  - 开源免费，可商业使用
  - 支持自定义扩展
- **适用场景**:
  - Excel 数据导入和编辑
  - 在线表格编辑
  - 数据批量录入
  - 报表模板编辑
- **安装**:
  ```bash
  npm install luckysheet
  ```
- **使用方式**:
  ```tsx
  import React, { useEffect, useRef } from 'react';
  import 'luckysheet/dist/plugins/css/pluginsCss.css';
  import 'luckysheet/dist/plugins/plugins.css';
  import 'luckysheet/dist/css/luckysheet.css';
  import 'luckysheet/dist/assets/iconfont/iconfont.css';
  import luckysheet from 'luckysheet';

  export default function ExcelEditor() {
    const containerRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
      if (containerRef.current) {
        luckysheet.create({
          container: containerRef.current.id,
          // 配置选项
        });
      }
    }, []);

    return <div id="luckysheet" ref={containerRef} />;
  }
  ```

### 文件预览

**kkfileview 集成**

- **特点**:
  - 通过 iframe 嵌入 kkfileview 预览服务
  - 支持多种文件格式预览
  - 提供统一的预览体验
- **使用方式**:
  ```tsx
  import { Modal } from 'antd';

  export default function FilePreview({ fileUrl }: { fileUrl: string }) {
    const previewUrl = `${KKFILEVIEW_URL}/onlinePreview?url=${encodeURIComponent(fileUrl)}`;
    
    return (
      <Modal
        title="文件预览"
        open={true}
        width={1200}
        footer={null}
        onCancel={() => {}}
      >
        <iframe
          src={previewUrl}
          style={{ width: '100%', height: '800px', border: 'none' }}
        />
      </Modal>
    );
  }
  ```

### 新手指引

**JoyRider**

- **版本**: react-joyride (最新稳定版)
- **特点**:
  - 功能强大的用户引导库
  - 支持步骤式引导和工具提示
  - 提供丰富的自定义选项
  - 支持键盘导航和自动定位
  - TypeScript 支持完善
- **优势**:
  - 易于集成，API 简洁
  - 支持复杂的引导流程
  - 提供完善的回调函数
  - 性能优异，不影响页面性能
  - 与 React 生态完美集成
- **适用场景**:
  - 新用户引导
  - 功能功能介绍
  - 操作步骤提示
  - 产品亮点展示
- **安装**:
  ```bash
  npm install react-joyride
  ```
- **使用方式**:
  ```tsx
  import Joyride, { Step } from 'react-joyride';

  const steps: Step[] = [
    {
      target: '.my-first-step',
      content: '这是第一步引导',
    },
    {
      target: '.my-second-step',
      content: '这是第二步引导',
    },
  ];

  export default function OnboardingGuide() {
    const [run, setRun] = useState(false);

    return (
      <Joyride
        steps={steps}
        run={run}
        continuous={true}
        showProgress={true}
        showSkipButton={true}
        callback={(data) => {
          if (data.status === 'finished' || data.status === 'skipped') {
            setRun(false);
          }
        }}
      />
    );
  }
  ```

### 其他前端工具

- **代码规范**: ESLint + Prettier
- **CSS 方案**: UnoCSS (原子化CSS引擎，推荐) 或 Tailwind CSS 或 CSS Modules (按项目需求选择)
- **图标库**: `@ant-design/icons` (阿里系图标库，包含丰富的工业图标)
- **日期处理**: `dayjs` (轻量级，API 与 moment.js 兼容)
- **工具函数**: `lodash-es` (按需引入，支持 tree-shaking)
- **CSS-in-JS**: `styled-components` 或 `emotion` (可选)
- **图表库**: `@ant-design/charts` (阿里系图表库，基于 AntV G2Plot)
  - 支持折线图、柱状图、饼图、仪表盘等
  - 适合 MES 系统的数据可视化需求
  - **商业使用**: AntV 采用 MIT 许可证，可免费用于商业项目
- **富文本编辑器**: `@ant-design/pro-editor` (Pro 系列编辑器组件)
- **Landing 页面**: `ant-design-landing` (官网首页和 SaaS 介绍页模板)
- **动画库**: `framer-motion` (现代化的动画库，性能优异)
- **移动端框架**: `antd-mobile` (Ant Design Mobile，移动端 UI 组件库)
- **表单验证**: `zod` (TypeScript 优先的模式验证)
- **打印模板设计**: `react-to-print` (React 打印库，主要方案) + `jspdf` + `html2canvas` (PDF 生成补充方案)
- **测试工具**: `@testing-library/react` (React 官方推荐的测试库，与 Vitest 配合使用)
- **开发工具**: `React DevTools` (React 官方开发工具，浏览器扩展)

### 前端官方推荐库说明

#### React Testing Library - 测试工具

**React 官方推荐的测试库**

- **版本**: @testing-library/react (最新稳定版)
- **特点**:
  - 专注于用户行为测试
  - 与 React 组件完美集成
  - 易于使用和维护
  - 官方推荐
- **优势**:
  - 测试更接近用户实际使用
  - 与 Vitest 完美配合
  - 官方维护，持续更新
  - 丰富的测试工具和辅助函数
- **适用场景**:
  - 组件单元测试
  - 集成测试
  - 用户交互测试
- **安装**:
  ```bash
  npm install -D @testing-library/react @testing-library/jest-dom
  ```
- **使用方式**:
  ```typescript
  import { render, screen } from '@testing-library/react';
  import { describe, it, expect } from 'vitest';
  import UserCard from './UserCard';

  describe('UserCard', () => {
    it('renders user name', () => {
      render(<UserCard userName="张三" />);
      expect(screen.getByText('张三')).toBeInTheDocument();
    });
  });
  ```

#### React DevTools - 开发工具

**React 官方开发工具**

- **类型**: 浏览器扩展
- **特点**:
  - 组件树查看
  - Props 和 State 检查
  - 性能分析
  - 官方维护
- **优势**:
  - 开发调试必备工具
  - 性能优化分析
  - 组件状态检查
  - 官方维护，稳定可靠
- **适用场景**:
  - 开发调试
  - 性能优化
  - 组件分析
- **安装**:
  - Chrome: [Chrome Web Store](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi)
  - Firefox: [Firefox Add-ons](https://addons.mozilla.org/en-US/firefox/addon/react-devtools/)

### Ant Design Landing - 官网首页和 SaaS 介绍页

**Ant Design Landing** 是基于 Ant Design 设计体系的静态页面解决方案，适用于快速构建高质量的着陆页、官网首页和 SaaS 软件介绍页。

#### 商业使用许可

- ✅ **MIT 许可证**: Ant Design Landing 采用 MIT 开源许可证
- ✅ **可商业使用**: 允许在商业项目中免费使用，无需支付许可费用
- ✅ **无限制**: 可自由使用、修改和分发

#### 主要特点

1. **设计一致性**
   - 延续 Ant Design 设计语言
   - 与 SaaS 产品风格保持一致
   - 提升品牌形象和用户体验

2. **丰富的模板库**
   - 提供多种预设模板和组件
   - 涵盖常见的页面布局和功能
   - 满足不同业务需求

3. **易于定制**
   - 支持根据需求进行定制
   - 可调整样式、布局和内容
   - 打造独特的品牌页面

4. **响应式设计**
   - 所有模板支持响应式布局
   - 确保在不同设备上良好显示
   - 适配 PC、平板、移动端

#### 适用场景

1. **SaaS 软件介绍主页**
   - 产品功能介绍
   - 特性展示
   - 价格方案
   - 客户案例
   - 联系方式

2. **客户简易官网首页**
   - 公司介绍
   - 服务展示
   - 产品展示
   - 新闻动态
   - 联系方式

3. **营销着陆页**
   - 活动推广页面
   - 产品发布页
   - 注册引导页

#### 使用方式

**使用方式**:
1. 访问 [Ant Design Landing 编辑器](https://landing.ant.design/) 在线编辑并下载
2. 或使用本地开发：
```bash
npm install ant-design-landing
# 或使用模板
npx create-landing-page my-landing
```

#### 核心功能模块

Landing 页面通常包含以下模块：

1. **Hero Section** - 首屏展示
   - 主标题和副标题
   - CTA 按钮（注册/试用）
   - 背景图片或视频

2. **Features** - 功能特性
   - 产品核心功能展示
   - 图标 + 文字说明
   - 多列布局

3. **Pricing** - 价格方案
   - 不同套餐展示
   - 价格对比
   - 购买按钮

4. **Testimonials** - 客户评价
   - 客户案例展示
   - 用户评价
   - 合作伙伴 Logo

5. **FAQ** - 常见问题
   - 问题列表
   - 折叠展开
   - 帮助用户快速了解

6. **Contact** - 联系方式
   - 联系表单
   - 地址信息
   - 社交媒体链接

7. **Footer** - 页脚
   - 版权信息
   - 友情链接
   - 备案信息

#### 与主系统集成

**部署方案**:
- Landing 页面可独立部署为静态站点（riveredge-land）
- 使用 Nginx 或 CDN 提供服务
- 与主系统（riveredge-shell）分离

**推荐项目结构**:
```
riveredge/
├── riveredge-core/          # 后端核心系统
├── riveredge-shell/          # 前端管理系统
├── riveredge-land/           # 着陆页/官网（土地）
│   ├── src/
│   │   ├── pages/
│   │   │   ├── Home/         # 首页
│   │   │   ├── Features/     # 功能页
│   │   │   └── Pricing/      # 价格页
│   │   └── components/        # Landing 组件
│   └── package.json
└── riveredge-seed/           # 应用插件集合（单数形式）
```

#### 安装和配置

```bash
# 方式一：使用官方模板
npx create-landing-page my-landing

# 方式二：在现有项目中安装
npm install ant-design-landing

# 方式三：使用在线编辑器
# 访问 https://landing.ant.design/ 在线编辑并下载
```

#### 最佳实践

1. **性能优化**
   - 图片懒加载
   - 代码分割
   - CDN 加速静态资源

2. **SEO 优化**
   - 添加 meta 标签
   - 结构化数据
   - 语义化 HTML

3. **分析统计**
   - 集成 Google Analytics
   - 集成百度统计
   - 追踪转化率

4. **A/B 测试**
   - 测试不同版本
   - 优化转化率
   - 数据驱动决策

#### 总结

- **商业使用**: ✅ 完全免费，MIT 许可证
- **适用场景**: SaaS 介绍页、官网首页、营销着陆页
- **技术栈统一**: 基于 Ant Design，与主系统保持一致
- **开发效率**: 提供丰富模板，快速搭建专业页面
- **推荐使用**: 适合作为 SaaS 软件的门面，提升品牌形象

### Ant Motion - 动画库

**Ant Motion** 是 Ant Design 的动画组件库，提供丰富的动画效果，用于增强用户界面的动态表现和交互体验。

#### 商业使用许可

- ✅ **MIT 许可证**: Ant Motion 采用 MIT 开源许可证
- ✅ **可商业使用**: 允许在商业项目中免费使用，无需支付许可费用
- ✅ **无限制**: 可自由使用、修改和分发

#### 主要特点

1. **丰富的动画效果**
   - 提供多种预设动画（淡入淡出、滑动、缩放等）
   - 支持自定义动画配置
   - 流畅的动画过渡效果

2. **易于使用**
   - 基于 React，API 简洁
   - 组件化设计，开箱即用
   - 支持 TypeScript

3. **性能优化**
   - 使用 CSS3 动画，性能优异
   - 支持硬件加速
   - 减少重绘和回流

4. **与 Ant Design 集成**
   - 与 Ant Design 组件完美配合
   - 设计风格统一
   - 无缝集成

#### 适用场景

1. **页面过渡动画**
   - 路由切换动画
   - 页面加载动画
   - 组件进入/退出动画

2. **交互反馈动画**
   - 按钮点击反馈
   - 表单验证动画
   - 操作成功/失败提示

3. **数据展示动画**
   - 数字递增动画
   - 图表加载动画
   - 列表项动画

4. **Landing 页面动画**
   - 首屏动画效果
   - 滚动触发动画
   - 元素渐入动画

#### 核心组件

1. **Animate** - 基础动画组件
   - 支持多种动画类型
   - 可配置动画参数

2. **QueueAnim** - 队列动画
   - 元素依次出现
   - 适合列表动画

3. **TweenOne** - 补间动画
   - 精确控制动画过程
   - 支持复杂动画序列

4. **ScrollAnim** - 滚动动画
   - 滚动触发动画
   - 适合 Landing 页面

#### 安装和使用

```bash
# 安装 Ant Motion
npm install ant-motion
```

**基础使用示例**:

```tsx
import { Animate } from 'ant-motion';
import { Button } from 'antd';

export default function AnimatedButton() {
  return (
    <Animate
      component="div"
      animation={{
        x: [0, 100],
        opacity: [0, 1],
      }}
      duration={1000}
    >
      <Button type="primary">点击我</Button>
    </Animate>
  );
}
```

**队列动画示例**:

```tsx
import { QueueAnim } from 'ant-motion';

export default function AnimatedList() {
  const data = ['项目1', '项目2', '项目3'];

  return (
    <QueueAnim>
      {data.map((item, index) => (
        <div key={index}>{item}</div>
      ))}
    </QueueAnim>
  );
}
```

**滚动触发动画示例**:

```tsx
import { ScrollAnim } from 'ant-motion';

export default function LandingPage() {
  return (
    <ScrollAnim
      component="div"
      animation={{
        y: [0, -50],
        opacity: [0, 1],
      }}
      scrollEventThrottle={16}
    >
      <div>滚动到这里时触发动画</div>
    </ScrollAnim>
  );
}
```

#### 最佳实践

1. **适度使用动画**
   - 不要过度使用动画，避免干扰用户
   - 动画应该增强体验，而不是分散注意力

2. **性能优化**
   - 使用 CSS3 动画而非 JavaScript 动画
   - 避免在动画中触发重排和重绘
   - 使用 `will-change` 属性优化性能

3. **可访问性**
   - 尊重用户的动画偏好设置（prefers-reduced-motion）
   - 提供关闭动画的选项

4. **移动端优化**
   - 在移动端减少复杂动画
   - 优化动画性能，避免卡顿

#### 总结

- **商业使用**: ✅ 完全免费，MIT 许可证
- **适用场景**: 页面过渡、交互反馈、数据展示、Landing 页面
- **技术栈统一**: 与 Ant Design 完美集成
- **开发效率**: 提供丰富预设动画，快速实现动效
- **推荐使用**: 适度使用动画，提升用户体验和品牌形象

### Ant Design Mobile - 移动端框架

**Ant Design Mobile** 是 Ant Design 的移动端版本，专注于移动设备的 UI 设计，提供一套完整的移动端组件库。

#### 商业使用许可

- ✅ **MIT 许可证**: Ant Design Mobile 采用 MIT 开源许可证
- ✅ **可商业使用**: 允许在商业项目中免费使用，无需支付许可费用
- ✅ **无限制**: 可自由使用、修改和分发

#### 主要特点

1. **移动端优化**
   - 专为移动设备设计
   - 触摸友好的交互
   - 响应式布局

2. **丰富的组件库**
   - 提供完整的移动端 UI 组件
   - 覆盖常见移动端场景
   - 与 Ant Design 设计语言一致

3. **性能优异**
   - 轻量级，体积小
   - 优化渲染性能
   - 支持按需加载

4. **跨平台支持**
   - 支持 React Native
   - 支持 H5 移动端
   - 支持小程序（部分组件）

#### 适用场景

1. **MES 移动端应用**
   - 生产现场数据录入
   - 移动端工单查看
   - 设备巡检应用
   - 质量检验移动端

2. **SaaS 移动端**
   - 移动端管理后台
   - 移动端数据查看
   - 移动端操作界面

3. **客户移动端应用**
   - 客户移动端门户
   - 移动端订单查看
   - 移动端报表查看

#### 核心组件

1. **基础组件**
   - Button（按钮）
   - Input（输入框）
   - Textarea（文本域）
   - Switch（开关）
   - Checkbox（复选框）
   - Radio（单选框）

2. **导航组件**
   - NavBar（导航栏）
   - TabBar（标签栏）
   - Tabs（标签页）
   - SideBar（侧边栏）

3. **数据展示**
   - List（列表）
   - Card（卡片）
   - Image（图片）
   - Badge（徽标）
   - Tag（标签）

4. **数据录入**
   - Form（表单）
   - Picker（选择器）
   - DatePicker（日期选择）
   - Cascader（级联选择）
   - Uploader（上传）

5. **反馈组件**
   - Toast（轻提示）
   - Dialog（对话框）
   - ActionSheet（动作面板）
   - Loading（加载）
   - PullToRefresh（下拉刷新）

6. **业务组件**
   - Calendar（日历）
   - ImageViewer（图片查看器）
   - InfiniteScroll（无限滚动）
   - ErrorBlock（错误提示）

#### 安装和使用

```bash
# 安装 Ant Design Mobile
npm install antd-mobile

# 如果使用 React Native
npm install antd-mobile-rn
```

**基础使用示例**:

```tsx
import { Button, List, Card } from 'antd-mobile';
import { SearchOutline } from 'antd-mobile-icons';

export default function MobileApp() {
  return (
    <div>
      <Card title="移动端页面">
        <List>
          <List.Item
            prefix={<SearchOutline />}
            onClick={() => {
              console.log('点击了列表项');
            }}
          >
            列表项
          </List.Item>
        </List>
        <Button color="primary" block>
          主要按钮
        </Button>
      </Card>
    </div>
  );
}
```

**移动端表单示例**:

```tsx
import { Form, Input, Button, Picker } from 'antd-mobile';

export default function MobileForm() {
  const [form] = Form.useForm();

  return (
    <Form form={form} layout="vertical">
      <Form.Item name="name" label="姓名">
        <Input placeholder="请输入姓名" />
      </Form.Item>
      <Form.Item name="phone" label="手机号">
        <Input type="tel" placeholder="请输入手机号" />
      </Form.Item>
      <Form.Item name="department" label="部门">
        <Picker columns={[['生产部', '质量部', '设备部']]}>
          {(value) => value || '请选择部门'}
        </Picker>
      </Form.Item>
      <Button color="primary" block onClick={() => form.submit()}>
        提交
      </Button>
    </Form>
  );
}
```

**移动端列表示例**:

```tsx
import { List, Card, Badge } from 'antd-mobile';

export default function WorkOrderList() {
  const orders = [
    { id: '1', no: 'WO001', status: 'processing', product: '产品A' },
    { id: '2', no: 'WO002', status: 'completed', product: '产品B' },
  ];

  return (
    <List>
      {orders.map(order => (
        <List.Item
          key={order.id}
          prefix={<Badge content={order.status === 'processing' ? '进行中' : '已完成'} />}
          extra={order.no}
        >
          {order.product}
        </List.Item>
      ))}
    </List>
  );
}
```

#### 与主系统集成

**部署方案**:
- 创建独立的移动端项目（riveredge-leaf）
- 使用 React Native 或 H5
- 与主系统 API 对接

**推荐项目结构**:
```
riveredge/
├── riveredge-core/          # 后端核心系统（根）
├── riveredge-shell/          # 前端管理系统（壳）
├── riveredge-seed/           # 应用插件集合（种子，单数形式）
├── riveredge-land/           # 着陆页/官网（土地）
└── riveredge-leaf/           # 移动端应用（叶子）
```

#### 移动端最佳实践

1. **性能优化**
   - 使用虚拟列表处理长列表
   - 图片懒加载
   - 代码分割和按需加载

2. **用户体验**
   - 优化触摸交互
   - 提供加载状态反馈
   - 错误处理和提示

3. **适配**
   - 适配不同屏幕尺寸
   - 处理横竖屏切换
   - 适配不同操作系统

4. **离线支持**
   - 使用 Service Worker
   - 数据缓存策略
   - 离线功能提示

#### 总结

- **商业使用**: ✅ 完全免费，MIT 许可证
- **适用场景**: MES 移动端、SaaS 移动端、客户移动端应用
- **技术栈统一**: 与 Ant Design 设计语言一致
- **开发效率**: 提供完整移动端组件，快速开发
- **推荐使用**: 适合需要移动端支持的项目，提升移动端用户体验

### 表单自定义字段方案

**表单自定义字段**是 MES 系统中的重要功能，允许用户根据业务需求动态配置表单字段。

#### Formily 表单解决方案

**Formily** 是阿里巴巴开源的企业级表单解决方案，提供完整的表单自定义字段功能。

- **特点**:
  - 阿里系表单解决方案，与 Ant Design 生态一致
  - 提供可视化表单设计器
  - 支持复杂字段联动和条件渲染
  - 适合企业级表单应用
- **安装**:
  ```bash
  npm install @formily/core @formily/react @formily/antd-v5
  ```
- **后端实现**:
  - 使用 Pydantic 动态创建模型
  - 使用 PostgreSQL JSONB 存储字段配置
  - 支持 JSON Schema 验证

**详细方案请参考**: [表单自定义字段方案.md](../4.branch/表单自定义字段方案.md)

### 打印模板设计方案

**打印模板设计**是 MES 系统中的重要功能，用于生成各种报表、单据和标签。

#### 技术方案

**Ant Design Pro 现状**: Ant Design Pro **没有专门的打印模板设计器原生组件**。

**主要方案：react-to-print**
- 轻量级 React 打印库
- 与 Ant Design 完美集成
- 支持打印预览
- 可自定义打印样式
- **安装**: `npm install react-to-print`

**补充方案：jsPDF + html2canvas（PDF 生成）**
- 当需要生成 PDF 文件时使用
- 精确控制格式
- **安装**: `npm install jspdf html2canvas`

**后端实现**:
- 使用 PostgreSQL JSONB 存储打印模板配置
- 使用 Pydantic 验证模板结构
- 提供模板管理 API

**详细方案请参考**: [打印模板设计方案.md](../4.branch/打印模板设计方案.md)

### 主子表模型支持

**主子表模型**是 MES 系统中的常见需求，例如订单-订单明细、生产计划-生产任务等。

#### 官方原生支持 ✅

**当前技术选型对主子表模型有完整的官方原生支持**：

**后端支持**：
- ✅ **Tortoise ORM**：支持 ForeignKey 关系、反向关系（ReverseRelation）、预加载、级联操作、事务支持
- ✅ **Pydantic v2**：支持嵌套 Schema、自动数据验证、类型安全
- ✅ **FastAPI**：自动接收和验证嵌套数据、自动生成 API 文档

**前端支持**：
- ✅ **ProTable**：支持 expandable 展开行展示子表数据
- ✅ **ProForm**：支持 ProFormList 嵌套表单编辑主子表数据
- ✅ **ProDescriptions**：支持嵌套展示主子表详情
- ✅ **Ant Design 基础组件**：Table expandable、Form.List

**优势**：
- ✅ 无需引入额外的第三方库
- ✅ 官方原生支持，稳定可靠
- ✅ 类型安全，开发体验好
- ✅ 文档完善，示例丰富

**详细分析请参考**: [主子表模型支持分析.md](../4.branch/主子表模型支持分析.md)

### AntV 数据可视化方案说明

**AntV 商业使用许可**:
- ✅ **MIT 许可证**: AntV 采用 MIT 开源许可证
- ✅ **可商业使用**: 允许在商业项目中免费使用，无需支付许可费用
- ✅ **无限制**: 可自由使用、修改和分发

**当前技术栈中的 AntV 使用**:
- `@ant-design/charts` 基于 **AntV G2Plot** 构建
- 已间接使用 AntV 生态，无需额外引入

**AntV 产品线使用**:
1. **G2Plot** (已通过 @ant-design/charts 使用)
   - 统计图表库，适合常规数据可视化
   - 支持折线图、柱状图、饼图、仪表盘等
   - **MES 适用**: 生产趋势、产量统计、设备状态等

2. **G6** (按需引入)
   - 图关系可视化引擎
   - 适合网络图、流程图、组织架构图
   - **MES 适用**: 设备关系图、工艺流程图、BOM 结构图
   - **安装**: `npm install @antv/g6@^5.0.0`

3. **X6** (按需引入)
   - 图编辑引擎，支持节点拖拽、连线等
   - 适合流程图编辑器、拓扑图编辑器
   - **MES 适用**: 工艺路线设计器、生产流程图编辑器
   - **安装**: `npm install @antv/x6@^2.0.0`

**总结**:
- **商业使用**: ✅ 完全免费，MIT 许可证
- **基础图表**: 使用 `@ant-design/charts` (已包含，基于 G2Plot)
- **图可视化**: 按需引入 `@antv/g6` 或 `@antv/x6`
- **技术栈统一**: 全部使用 AntV 生态，保持技术栈一致性

### B 端 MES 项目推荐组件

针对制造执行系统（MES）项目，以下 Ant Design Pro 组件特别适用：

#### 核心业务组件

1. **ProTable** - 数据表格
   - 生产订单列表、工单管理、质量检验记录
   - 支持搜索、筛选、排序、分页
   - 支持批量操作、导出功能
   - 适合大量数据展示和操作

2. **ProForm** - 高级表单
   - 生产计划录入、工艺参数配置
   - 支持多种布局（水平、垂直、内联）
   - 支持表单联动、动态字段
   - 支持表单验证和提交

3. **ProCard** - 卡片容器
   - 生产看板、设备状态卡片
   - 支持多卡片布局
   - 支持折叠、分割等功能

4. **ProList** - 列表组件
   - 生产任务列表、设备列表
   - 支持多种列表样式
   - 支持搜索、筛选、排序

5. **ProDescriptions** - 描述列表
   - 订单详情、设备信息展示
   - 支持响应式布局
   - 支持自定义渲染

#### 数据可视化组件

6. **@ant-design/charts** - 图表库（基于 AntV G2Plot，MIT 许可证，可商业使用）
   - **折线图**: 生产趋势分析、设备运行曲线
   - **柱状图**: 产量统计、质量分析
   - **饼图**: 设备状态分布、质量合格率
   - **仪表盘**: 设备运行效率、OEE 指标
   - **热力图**: 生产热力图、设备利用率
   - **面积图**: 产能分析、库存变化

7. **@antv/g6** - 图关系可视化（按需引入）
   - 设备关系图、工艺流程图
   - BOM 结构可视化
   - 生产流程网络图

8. **@antv/x6** - 图编辑引擎（按需引入）
   - 工艺路线设计器
   - 生产流程图编辑器
   - 设备布局设计器

9. **Statistic** (Ant Design) - 统计数值
   - 实时产量、设备状态、质量指标
   - 支持数字动画效果
   - 适合看板展示

#### 布局和导航组件

10. **ProLayout** - 页面布局
   - 系统主框架布局
   - 支持侧边栏、顶部导航
   - 支持响应式布局
   - 支持主题切换

11. **PageContainer** (Pro Components) - 页面容器
   - 统一页面头部样式
   - 支持面包屑导航
   - 支持操作按钮区域

#### 高级功能组件

12. **ProSkeleton** - 骨架屏
    - 数据加载时的占位效果
    - 提升用户体验

13. **WaterMark** (Ant Design) - 水印
    - 数据报表水印
    - 防止数据泄露

14. **Timeline** (Ant Design) - 时间轴
    - 生产流程跟踪
    - 工艺步骤展示
    - 质量追溯

15. **Steps** (Ant Design) - 步骤条
    - 生产流程步骤
    - 工单审批流程
    - 质量检验流程

16. **Tabs** (Ant Design) - 标签页
    - 多维度数据展示
    - 设备详情多标签
    - 订单信息分类展示

17. **Tree** (Ant Design) - 树形控件
    - 设备树、BOM 结构
    - 组织架构
    - 分类管理

18. **Transfer** (Ant Design) - 穿梭框
    - 权限分配
    - 设备分配
    - 人员调配

#### 实时数据组件

19. **Badge** (Ant Design) - 徽标数
    - 设备告警数量
    - 待处理任务数
    - 消息通知

20. **Alert** (Ant Design) - 警告提示
    - 设备异常告警
    - 质量异常提醒
    - 系统通知

21. **Progress** (Ant Design) - 进度条
    - 生产进度展示
    - 设备运行状态
    - 任务完成度

#### 数据录入组件

22. **DatePicker / RangePicker** (Ant Design) - 日期选择
    - 生产日期选择
    - 时间范围查询
    - 计划时间设置

23. **TimePicker** (Ant Design) - 时间选择
    - 班次时间设置
    - 设备运行时间

24. **Select** (Ant Design) - 选择器
    - 设备选择
    - 工艺路线选择
    - 人员选择

25. **Cascader** (Ant Design) - 级联选择
    - 多级分类选择
    - 区域-车间-产线选择

26. **Upload** (Ant Design) - 上传
    - 工艺文件上传
    - 质量报告上传
    - 图片上传

#### 展示组件

27. **Table** (Ant Design) - 基础表格
    - 简单数据展示
    - 与 ProTable 配合使用

28. **Card** (Ant Design) - 卡片
    - 设备状态卡片
    - 生产指标卡片

29. **Tag** (Ant Design) - 标签
    - 设备状态标签
    - 质量等级标签
    - 订单状态标签

30. **Tooltip** (Ant Design) - 文字提示
    - 设备信息提示
    - 操作说明提示

31. **Popover** (Ant Design) - 气泡卡片
    - 快速操作菜单
    - 详细信息展示

#### MES 专用场景组件组合

**生产看板场景**:
- ProCard + Statistic + Charts + Progress
- 实时展示生产数据、设备状态、质量指标

**工单管理场景**:
- ProTable + ProForm + Steps + Timeline
- 工单列表、创建、审批、跟踪

**设备监控场景**:
- Charts + Badge + Alert + Tree
- 设备状态监控、告警管理、设备树

**质量管理场景**:
- ProTable + Charts + Descriptions + Upload
- 质量数据录入、统计分析、报告上传

**生产计划场景**:
- ProTable + ProForm + Calendar + Gantt (需第三方)
- 生产计划制定、排程、跟踪

**安装 MES 相关组件**:
```bash
# 核心组件
npm install @ant-design/pro-components@^2.0.0
npm install @ant-design/charts@^2.0.0
npm install antd@^6.0.0
npm install @ant-design/icons@^6.0.0

# 表单自定义字段
npm install @formily/core@^2.3.0 @formily/react@^2.3.0 @formily/antd-v5@^2.3.0

# 打印模板设计
npm install react-to-print@^2.15.0

# AntV 图可视化（按需引入）
npm install @antv/g6@^5.0.0  # 图关系可视化
npm install @antv/x6@^2.0.0  # 图编辑器
```

## 🔌 插件系统技术栈

### 前端插件

- **模块加载**: ES Modules (动态 import)
- **构建工具**: Vite (现代化构建工具)
- **插件规范**: 自定义 manifest.json

### 后端插件

- **插件加载**: Python 动态导入 (`importlib`)
- **插件接口**: 基于 Python ABC (抽象基类)
- **路由注册**: FastAPI 动态路由注册

## 🗄️ 数据库技术栈

### 主数据库

**PostgreSQL 15+**

- 关系型数据存储
- 用户、角色、权限等核心数据
- 插件数据表（使用命名空间隔离）

### 缓存

**Redis 7+**

- 会话存储
- 缓存热点数据
- 分布式锁

## 🛠️ 开发工具

### 版本控制

- **Git**: 分布式版本控制系统
- **GitHub / GitLab**: 代码托管和协作平台

### 包管理

- **后端**: `pip` + `poetry`
- **前端**: `pnpm`

### IDE 推荐

- **VS Code**: 轻量级，插件丰富，支持前后端开发

### 代码质量

- **后端**:
  - `black` (代码格式化)
  - `ruff` (代码检查)
  - `mypy` (类型检查)
- **前端**:
  - `ESLint` (代码检查)
  - `Prettier` (代码格式化)
  - `TypeScript` (类型检查)

### API 测试

- **FastAPI 自动文档**: 内置 Swagger UI
- **Postman**: API 测试工具

### 数据库管理

- **DBeaver**: 跨平台数据库管理工具
- **Redis Insight**: Redis 管理工具

## 🚀 部署方案

### 容器化部署

**Docker + Docker Compose**

- **开发环境**: Docker Compose
- **生产环境**: Docker + Kubernetes

### 传统部署

- **后端**:
  - `uvicorn` + `gunicorn` (ASGI 服务器)
  - `nginx` (反向代理)
  - `supervisor` (进程管理)
  - `kkfileview` (文件预览服务，Docker 部署)
- **前端**:
  - `nginx` (静态文件服务)

## 📦 依赖管理

### 后端依赖示例 (requirements.txt)

```txt
# Web 框架 - 稳定兼容版本
fastapi==0.104.1
uvicorn[standard]==0.30.0

# 数据验证 - 稳定兼容版本
pydantic==2.8.0
pydantic-settings==2.5.0

# ORM 和数据库 - 稳定兼容版本
tortoise-orm==0.20.1  # 与FastAPI 0.104.1完美兼容
aerich==0.7.1
asyncpg==0.29.0  # Python 3.11+ 预编译包
psycopg2-binary==2.9.7  # 同步备选方案

# 缓存
redis[hiredis]==5.0.1

# 认证和安全
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6

# HTTP 客户端
httpx==0.25.2

# 日志
loguru==0.7.2

# 系统监控
psutil==5.9.8  # 跨平台系统资源监控库（CPU、内存、磁盘、网络等）

# 测试框架
pytest==7.4.3
pytest-asyncio==0.21.1

# 可选依赖
# inngest>=0.0.0  # 工作流引擎（可选）
# typer[all]>=0.9.0  # CLI 工具（可选）
# aiofiles>=23.0.0  # 异步文件操作（可选）
```

### 前端依赖示例 (package.json)

#### 主系统依赖 (riveredge-shell)

```json
{
  "dependencies": {
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^6.26.2",
    "zustand": "^5.0.0",
    "@tanstack/react-query": "^5.51.1",
    "react-hook-form": "^7.53.0",
    "antd": "^5.17.0",
    "@ant-design/pro-components": "^2.7.10",
    "@ant-design/icons": "^5.4.0",
    "@ant-design/charts": "^2.1.0",
    "react-i18next": "^14.1.3",
    "i18next": "^23.15.2",
    "react-to-print": "^2.15.0",
    "jspdf": "^2.5.1",
    "html2canvas": "^1.4.1",
    "luckysheet": "^2.1.13",
    "react-joyride": "^2.5.2",
    "dayjs": "^1.11.13",
    "lodash-es": "^4.17.21",
    "framer-motion": "^11.5.4",
    "zod": "^3.23.8"
  },
  "devDependencies": {
    "@types/react": "^18.3.1",
    "@types/react-dom": "^18.3.1",
    "@types/lodash-es": "^4.17.12",
    "typescript": "^5.6.3",
    "vite": "^5.4.8",
    "@vitejs/plugin-react": "^4.3.1",
    "eslint": "^9.11.1",
    "prettier": "^3.3.3",
    "@types/node": "^22.7.0",
    "vitest": "^2.1.8",
    "@vitest/ui": "^2.1.8",
    "jsdom": "^25.0.1",
    "@testing-library/react": "^14.0.0",
    "@testing-library/jest-dom": "^6.1.0",
    "unocss": "^0.60.0",
    "@unocss/preset-uno": "^0.60.0",
    "@unocss/preset-icons": "^0.60.0"
  }
}
```

#### Landing 页面依赖 (riveredge-land)

```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "antd": "^5.17.0",
    "@ant-design/icons": "^5.3.0",
    "ant-design-landing": "^2.0.0",
    "ant-motion": "^2.0.0"
  },
  "devDependencies": {
    "typescript": "^5.5.4",
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0"
  }
}
```

#### 移动端依赖 (riveredge-leaf)

```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "antd-mobile": "^5.37.0",
    "antd-mobile-icons": "^0.3.0",
    "ant-motion": "^2.0.0"
  },
  "devDependencies": {
    "typescript": "^5.5.4",
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0"
  }
}
```

#### 表单自定义字段依赖

```json
{
  "dependencies": {
    "@formily/core": "^2.3.0",
    "@formily/react": "^2.3.0",
    "@formily/antd-v5": "^2.3.0"
  }
}
```

#### 打印模板设计依赖

```json
{
  "dependencies": {
    "react-to-print": "^2.15.0",
    "jspdf": "^2.5.0",
    "html2canvas": "^1.4.0"
  }
}
```

**说明**:
- `ant-motion`: Ant Design 动画库，用于增强页面动效
- `antd-mobile`: Ant Design Mobile 移动端组件库
- `antd-mobile-icons`: Ant Design Mobile 图标库

#### 依赖说明
- `@ant-design/pro-components`: Ant Design Pro 高级业务组件（ProTable、ProForm、ProCard 等）
- `@ant-design/charts`: 阿里系图表库（基于 G2Plot，适合 MES 数据可视化）
- `antd`: Ant Design 基础组件库（所有 UI 组件的基础）
- `@ant-design/icons`: 阿里系图标库（包含丰富的工业、制造相关图标）
- `ant-design-landing`: Landing 页面模板库（官网首页和 SaaS 介绍页）
- `ant-motion`: Ant Design 动画库（增强页面动效）
- `antd-mobile`: Ant Design Mobile 移动端组件库（移动端应用）
- `@formily/*`: Formily 表单解决方案（表单自定义字段）
- `react-to-print`: React 打印库（打印模板设计）
- `jspdf` + `html2canvas`: PDF 生成库（打印模板设计补充方案）
- `luckysheet`: Excel 在线编辑器（Excel 导入、编辑、导出）
- `react-joyride`: 新手指引库（用户引导和功能介绍）
- `vitest`: 现代化测试框架（原生ESM支持，速度极快）
- `unocss`: 原子化CSS引擎（高性能，支持按需生成）
- **全部使用 Ant Design 系列组件，保持技术栈统一**

## ✅ 技术栈优势总结

### 后端优势

1. **高性能**: FastAPI 异步特性 + PostgreSQL 优秀性能
2. **开发效率**: Python 简洁语法 + FastAPI 自动文档
3. **类型安全**: Pydantic v2 数据验证 + Python 类型提示
4. **可扩展性**: Tortoise ORM 灵活的数据模型设计

### 前端优势

1. **现代化技术栈**: 完全基于React官方生态，使用最新的稳定版本
2. **最佳开发体验**: Vite 5.4 提供秒级冷启动和热更新，开发效率大幅提升
3. **轻量级架构**: 抛弃重型框架，采用轻量级现代化库，包体积更小
4. **完全可控**: 自主选择和组合最佳实践库，避免框架约束
5. **高性能**: React 18.3 + Vite 5 + 现代化库，提供卓越的运行性能
6. **类型安全**: TypeScript 5.6 + Zod 提供端到端的类型安全
7. **灵活的状态管理**: Zustand 轻量级但功能强大的状态管理方案
8. **智能数据获取**: TanStack Query 提供智能缓存和请求管理
9. **高性能表单**: React Hook Form 提供最小重新渲染的表单解决方案
10. **组件丰富**: Ant Design 5.17.0 + Pro Components 提供完整的企业级组件
11. **现代化测试**: Vitest 提供原生ESM支持的快速测试框架
12. **原子化CSS**: UnoCSS 提供高性能的原子化CSS引擎，支持按需生成
13. **国际化支持**: React i18next 提供企业级的多语言解决方案
14. **权限灵活**: 自定义权限系统，完全可控且轻量级
15. **MES 适配**: 丰富的工业场景组件，完美适合制造执行系统

### 整体优势

1. **技术栈现代化**: 全部采用最新稳定版本，性能优异
2. **开发效率高**: 前后端都有完善的现代化工具链支持
3. **可维护性强**: TypeScript 5.5.4 + Python 类型提示 + Zod 模式验证
4. **生态成熟**: 所有技术都是React生态的成熟解决方案
5. **轻量级架构**: 抛弃重型框架，采用最佳实践组合，包体积更小
6. **完全可控**: 自主选择技术栈，完全控制项目架构
7. **高性能**: Vite + React 18.2.0 + 现代化库提供卓越性能
8. **组件丰富**: Ant Design + Pro Components 提供完整的企业级组件

## 📝 注意事项

1. **版本兼容性**: 确保所有依赖版本兼容，建议使用锁文件
2. **Python 版本**: 建议使用 Python 3.11 LTS (长期支持至2027年10月)
3. **Node.js 版本**: 建议使用 Node.js 20 LTS (性能更佳，长期维护)
4. **数据库版本**: PostgreSQL 15+ 以获得最佳性能
5. **定期更新**: 关注各技术栈的版本更新，及时升级到稳定版
6. **组件选择**: **全部使用 Ant Design 系列组件**，包括基础组件（antd）和高级组件（@ant-design/pro-components）
7. **状态管理**: 使用 Zustand 管理全局状态，TanStack Query 管理服务端状态
8. **路由配置**: 使用 React Router DOM v6，支持嵌套路由和权限守卫
9. **表单处理**: 使用 React Hook Form + Zod 进行表单验证和数据处理
10. **数据获取**: 使用 TanStack Query 进行服务端状态管理和缓存
11. **测试框架**: 使用 Vitest 进行单元测试和集成测试，原生ESM支持，速度极快
12. **CSS 方案**: 推荐使用 UnoCSS 原子化CSS引擎，支持按需生成和极高性能
13. **国际化**: 使用 React i18next，支持多语言切换和动态加载
14. **权限控制**: 自定义基于 Context 的权限系统，支持路由级和组件级控制
15. **Pro Components**: 充分利用 Pro Components 减少重复代码，提升开发效率
16. **MES 项目**: 针对制造执行系统，优先使用 ProTable、ProForm、Charts 等组件
17. **图表选择**: 使用 `@ant-design/charts` 进行数据可视化，避免使用其他图表库
18. **图标使用**: 统一使用 `@ant-design/icons`，包含丰富的工业制造相关图标
19. **AntV 商业使用**: ✅ AntV 采用 MIT 许可证，可免费用于商业项目，无需支付许可费用
20. **AntV 引入**: 已通过 `@ant-design/charts` 使用 G2Plot，按需引入 `@antv/g6`（图关系可视化）或 `@antv/x6`（图编辑器）
21. **Landing 页面**: 使用 `ant-design-landing` 构建 SaaS 介绍主页和客户官网首页，MIT 许可证，可免费商业使用
22. **Landing 部署**: Landing 页面可独立部署为静态站点，或集成到主系统中
23. **动画库**: 使用 `framer-motion` 增强页面动效，适度使用动画提升用户体验，MIT 许可证
24. **移动端框架**: 使用 `antd-mobile` 开发移动端应用，支持 MES 移动端、SaaS 移动端等场景，MIT 许可证
25. **动画使用**: 适度使用动画，避免过度动画影响性能和用户体验
26. **移动端部署**: 移动端应用作为独立项目部署（riveredge-leaf）
27. **表单自定义字段**: 使用 React Hook Form + 自定义组件实现表单自定义字段功能
28. **表单字段存储**: 使用 PostgreSQL JSONB 存储字段配置，后端使用 Pydantic 动态模型验证
29. **打印模板设计**: 使用 `react-to-print` 实现打印功能，需要 PDF 时使用 `jspdf` + `html2canvas`
30. **打印模板存储**: 使用 PostgreSQL JSONB 存储打印模板配置，支持模板管理和复用
31. **技术栈稳定性**: 优先选择长期维护的LTS版本和稳定版，避免使用过新或实验性版本
32. **兼容性优先**: 选择版本时优先考虑兼容性，其次是性能，最后是新特性
33. **Vite 配置**: 充分利用 Vite 插件系统，配置路径别名、环境变量等
34. **代码分割**: 使用 React.lazy 和 Suspense 实现路由级代码分割
35. **性能优化**: 使用 React.memo、useMemo、useCallback 等进行组件优化
36. **ASGI 服务器**: 使用 Uvicorn 作为 FastAPI 的 ASGI 服务器，开发环境使用 `--reload`，生产环境使用 gunicorn + uvicorn workers
37. **工作流引擎**: 使用 Inngest 处理异步任务和复杂工作流，支持重试、错误处理和状态管理
38. **Excel 处理**: 使用 Luckysheet 实现 Excel 在线编辑和导入导出功能
39. **文件预览**: 使用 kkfileview 提供文件预览服务，支持 Office、PDF、图片等多种格式
40. **新手指引**: 使用 react-joyride 实现新用户引导和功能介绍，提升用户体验

## 🚀 快速开始建议

### 前端项目初始化

```bash
# 使用 Vite 创建 React + TypeScript 项目
npm create vite@latest riveredge-shell -- --template react-ts
cd riveredge-shell

# 安装核心依赖
npm install react-router-dom@^6.26.2
npm install zustand@^5.0.0
npm install @tanstack/react-query@^5.51.1
npm install react-hook-form@^7.53.0
npm install zod@^3.23.8

# 安装 UI 组件库
npm install antd@^5.17.0
npm install @ant-design/pro-components@^2.7.10
npm install @ant-design/icons@^5.4.0
npm install @ant-design/charts@^2.1.0

# 安装国际化支持
npm install react-i18next@^14.1.3 i18next@^23.15.2

# 安装工具库
npm install dayjs@^1.11.13 lodash-es@^4.17.21
npm install framer-motion@^11.5.4

# 安装开发依赖
npm install -D @vitejs/plugin-react@^4.3.1
npm install -D @types/node@^22.7.0
npm install -D eslint@^9.11.1 prettier@^3.3.3

# 安装测试框架 (Vitest)
npm install -D vitest@^2.1.8 @vitest/ui@^2.1.8 jsdom@^25.0.1

# 安装 CSS 框架 (UnoCSS，推荐)
npm install -D unocss@^0.60.0 @unocss/preset-uno@^0.60.0 @unocss/preset-icons@^0.60.0

# 安装打印相关依赖 (可选)
npm install react-to-print@^2.15.0 jspdf@^2.5.1 html2canvas@^1.4.1

# 安装 Excel 处理依赖
npm install luckysheet@^2.1.13

# 安装新手指引依赖
npm install react-joyride@^2.5.2
```

### 后端项目初始化

```bash
# 创建 Python 虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

**详细的项目结构和代码示例请参考**：
- [2.架构设计文档.md](./2.架构设计文档.md) - 项目结构和模块划分
- [4.框架开发计划.md](./4.框架开发计划.md) - 详细开发步骤和代码示例

---

**最后更新**：2025-01-XX (新增 Uvicorn、Inngest、Luckysheet、kkfileview、JoyRider 技术栈)
