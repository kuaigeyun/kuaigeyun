# 第六阶段建设进度

## 📋 概述

本文档跟踪第六阶段（监控运维）的建设进度。

**建设时间**：5 周  
**状态**：⏳ **待开始**

---

## 📊 总体进度

**总体进度**：0%（0个模块完成：操作日志、登录日志、在线用户、数据备份；全部待开始）

**状态**：⏳ **待开始**

---

## 📋 模块建设进度

| 模块 | 模型 | Schema | Service | API | 迁移 | 中间件 | 前端服务 | 前端页面 | 路由 | 菜单 | 状态 |
|------|------|--------|---------|-----|------|--------|----------|----------|------|------|------|
| **1. 操作日志** | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ 待开始 |
| **2. 登录日志** | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ 待开始 |
| **3. 在线用户** | - | ⏳ | ⏳ | ⏳ | - | - | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ 待开始 |
| **4. 数据备份** | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ | ⏳ 待开始 |

**说明**：
- ✅ 已完成
- ⏳ 待开始
- - 不需要（复用其他模块或从 Redis 读取）

---

## 🚀 详细建设进度

### 1. 操作日志（第1优先级）

**预计时间**：1 周  
**状态**：⏳ 待开始

**依赖**：无（独立功能）

#### 后端开发

- [ ] 创建数据库模型
  - [ ] `models/operation_log.py`（操作日志模型）
  - [ ] 更新 `models/__init__.py`

- [ ] 创建 Schema
  - [ ] `schemas/operation_log.py`（操作日志 Schema）
  - [ ] 更新 `schemas/__init__.py`

- [ ] 创建 Service
  - [ ] `services/operation_log_service.py`（操作日志服务）

- [ ] 创建操作日志中间件
  - [ ] `middleware/operation_log_middleware.py`（自动记录中间件）
  - [ ] 在 `maintree/main.py` 中注册中间件

- [ ] 创建 API
  - [ ] `api/operation_logs/operation_logs.py`（操作日志管理 API）
  - [ ] 更新 `maintree/main.py` 注册路由

- [ ] 数据库迁移
  - [ ] 创建操作日志表迁移

#### 前端开发

- [ ] 创建前端服务
  - [ ] `services/operationLog.ts`（操作日志服务）

- [ ] 创建前端页面
  - [ ] `pages/system/operation-logs/list/index.tsx`（操作日志页面）
  - [ ] 添加路由配置
  - [ ] 添加菜单配置

---

### 2. 登录日志（第2优先级）

**预计时间**：1 周  
**状态**：⏳ 待开始

**依赖**：用户管理（需要用户信息）

#### 后端开发

- [ ] 创建数据库模型
  - [ ] `models/login_log.py`（登录日志模型）
  - [ ] 更新 `models/__init__.py`

- [ ] 创建 Schema
  - [ ] `schemas/login_log.py`（登录日志 Schema）
  - [ ] 更新 `schemas/__init__.py`

- [ ] 创建 Service
  - [ ] `services/login_log_service.py`（登录日志服务）

- [ ] 在登录接口中记录日志
  - [ ] 修改 `soil/api/v1/auth.py`，在登录成功/失败时记录日志

- [ ] 创建 API
  - [ ] `api/login_logs/login_logs.py`（登录日志管理 API）
  - [ ] 更新 `maintree/main.py` 注册路由

- [ ] 数据库迁移
  - [ ] 创建登录日志表迁移

#### 前端开发

- [ ] 创建前端服务
  - [ ] `services/loginLog.ts`（登录日志服务）

- [ ] 创建前端页面
  - [ ] `pages/system/login-logs/list/index.tsx`（登录日志页面）
  - [ ] 添加路由配置
  - [ ] 添加菜单配置

---

### 3. 在线用户（第3优先级）

**预计时间**：1 周  
**状态**：⏳ 待开始

**依赖**：用户管理、Redis（需要会话存储）

#### 后端开发

- [ ] 创建 Schema
  - [ ] `schemas/online_user.py`（在线用户 Schema）
  - [ ] 更新 `schemas/__init__.py`

- [ ] 创建 Service
  - [ ] `services/online_user_service.py`（在线用户服务，从 Redis 读取会话信息）

- [ ] 创建 API
  - [ ] `api/online_users/online_users.py`（在线用户管理 API）
  - [ ] 更新 `maintree/main.py` 注册路由

**注意**：不需要新建模型和迁移，直接从 Redis 读取会话信息。

#### 前端开发

- [ ] 创建前端服务
  - [ ] `services/onlineUser.ts`（在线用户服务）

- [ ] 创建前端页面
  - [ ] `pages/system/online-users/list/index.tsx`（在线用户页面）
  - [ ] 添加路由配置
  - [ ] 添加菜单配置

---

### 4. 数据备份（第4优先级）

**预计时间**：2 周  
**状态**：⏳ 待开始

**依赖**：Inngest（定时备份任务）、文件管理（备份文件存储）

#### 后端开发

- [ ] 创建数据库模型
  - [ ] `models/data_backup.py`（数据备份模型）
  - [ ] 更新 `models/__init__.py`

- [ ] 创建 Schema
  - [ ] `schemas/data_backup.py`（数据备份 Schema）
  - [ ] 更新 `schemas/__init__.py`

- [ ] 创建 Service
  - [ ] `services/data_backup_service.py`（数据备份服务，包含备份和恢复逻辑）

- [ ] 创建 Inngest 函数
  - [ ] `inngest/functions/data_backup.py`（定时备份任务函数）

- [ ] 创建 API
  - [ ] `api/data_backups/data_backups.py`（数据备份管理 API）
  - [ ] 更新 `maintree/main.py` 注册路由

- [ ] 数据库迁移
  - [ ] 创建数据备份表迁移

#### 前端开发

- [ ] 创建前端服务
  - [ ] `services/dataBackup.ts`（数据备份服务）

- [ ] 创建前端页面
  - [ ] `pages/system/data-backups/list/index.tsx`（数据备份页面）
  - [ ] 添加路由配置
  - [ ] 添加菜单配置

---

## 📚 相关文档

- [README.md](./README.md)
- [1.操作日志最佳实践.md](./1.操作日志最佳实践.md)
- [2.登录日志最佳实践.md](./2.登录日志最佳实践.md)
- [3.在线用户最佳实践.md](./3.在线用户最佳实践.md)
- [4.数据备份最佳实践.md](./4.数据备份最佳实践.md)
- [前端页面布局规范.md](./前端页面布局规范.md)
- [系统级功能文件结构规划.md](./系统级功能文件结构规划.md)

---

**最后更新**：2025-01-XX

