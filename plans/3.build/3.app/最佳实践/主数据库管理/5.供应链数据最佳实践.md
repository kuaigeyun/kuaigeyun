# 供应链数据最佳实践

## 📋 概述

本文档详细说明供应链数据模块（客户、供应商）的开发最佳实践，结合 RiverEdge SaaS 框架规范和 DDD 应用层设计规范。

## 🎯 模块说明

供应链数据模块用于管理供应链相关的基础数据，包含：
- **客户（Customer）**：客户基础信息
- **供应商（Supplier）**：供应商基础信息

## 🏗️ 技术架构

### 后端架构（传统分层）

```
riveredge-backend/src/apps/master_data/
├── api/
│   └── supply_chain.py               # 供应链数据 API
├── services/
│   └── supply_chain_service.py      # 供应链数据服务
├── models/
│   └── supply_chain.py              # 供应链数据模型
└── schemas/
    └── supply_chain_schemas.py      # 供应链数据 Schema
```

## 📐 数据库设计规范

### 客户表（seed_master_data_customers）

```sql
CREATE TABLE seed_master_data_customers (
    id SERIAL PRIMARY KEY,
    uuid VARCHAR(36) NOT NULL UNIQUE,
    tenant_id INTEGER NOT NULL,
    code VARCHAR(50) NOT NULL,
    name VARCHAR(200) NOT NULL,
    short_name VARCHAR(100),
    contact_person VARCHAR(100),
    phone VARCHAR(20),
    email VARCHAR(100),
    address TEXT,
    category VARCHAR(50),
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL,
    UNIQUE(tenant_id, code),
    INDEX idx_tenant_id (tenant_id),
    INDEX idx_code (code),
    INDEX idx_uuid (uuid),
    INDEX idx_category (category)
);
```

### 供应商表（seed_master_data_suppliers）

```sql
CREATE TABLE seed_master_data_suppliers (
    id SERIAL PRIMARY KEY,
    uuid VARCHAR(36) NOT NULL UNIQUE,
    tenant_id INTEGER NOT NULL,
    code VARCHAR(50) NOT NULL,
    name VARCHAR(200) NOT NULL,
    short_name VARCHAR(100),
    contact_person VARCHAR(100),
    phone VARCHAR(20),
    email VARCHAR(100),
    address TEXT,
    category VARCHAR(50),
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    deleted_at TIMESTAMP NULL,
    UNIQUE(tenant_id, code),
    INDEX idx_tenant_id (tenant_id),
    INDEX idx_code (code),
    INDEX idx_uuid (uuid),
    INDEX idx_category (category)
);
```

## ✅ 检查清单

### 开发前准备

- [ ] 确认数据库表结构设计
- [ ] 确认客户/供应商分类设计
- [ ] 确认联系信息验证规则

### 开发中

- [ ] 遵循命名规范
- [ ] 所有查询必须包含 `tenant_id` 过滤
- [ ] 客户和供应商结构相似，可考虑代码复用
- [ ] 编写完整的注释（中文）
- [ ] 编写单元测试（覆盖率 > 80%）

### 开发后

- [ ] 完整功能测试
- [ ] 性能测试
- [ ] 文档完善
- [ ] 代码审查

## 📚 相关文档

- [主数据管理APP开发计划](./主数据管理APP开发计划.md)
- [工厂数据最佳实践](./1.工厂数据最佳实践.md)

---

**最后更新**：2025-01-11

