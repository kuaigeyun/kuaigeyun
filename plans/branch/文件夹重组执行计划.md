# æ–‡ä»¶å¤¹é‡ç»„æ‰§è¡Œè®¡åˆ’

## ğŸ“‹ æ‰§è¡Œæ¦‚è¿°

æ ¹æ®æ–°çš„å‘½åå“²å­¦ï¼Œå°† `riveredge-core` å’Œ `riveredge-shell` æ‹†åˆ†ä¸ºæ›´ç»†ç²’åº¦çš„æ¨¡å—ã€‚

**æ‰§è¡Œæ—¥æœŸ**ï¼š2025-11-27  
**å¤‡ä»½çŠ¶æ€**ï¼šâœ… å·²åˆ›å»ºå¤‡ä»½åˆ†æ”¯ `backup/before-rename-20251127_081835`

---

## ğŸ¯ é‡ç»„ç›®æ ‡

### æ¶æ„å±‚çº§åˆ’åˆ†

æ ¹æ®æ–°çš„å‘½åå“²å­¦ï¼Œå°†ä»£ç æŒ‰æ¶æ„å±‚çº§é‡æ–°ç»„ç»‡ï¼š

```
ç³»ç»Ÿçº§ (System Level)
â”œâ”€â”€ root (æ ¹) - ç³»ç»Ÿçº§åç«¯ API
â”‚   â”œâ”€â”€ API æœåŠ¡
â”‚   â”œâ”€â”€ æ•°æ®æŒä¹…åŒ–
â”‚   â”œâ”€â”€ è®¤è¯æˆæƒ
â”‚   â””â”€â”€ æ ¸å¿ƒåŸºç¡€è®¾æ–½
â””â”€â”€ stem (èŒ) - ç³»ç»Ÿçº§å‰ç«¯æ¡†æ¶
    â”œâ”€â”€ å‰ç«¯åŸºç¡€æ¡†æ¶
    â”œâ”€â”€ æ’ä»¶åŠ è½½å™¨
    â”œâ”€â”€ è·¯ç”±ç®¡ç†
    â””â”€â”€ çŠ¶æ€ç®¡ç†

åº”ç”¨çº§ (Application Level)
â”œâ”€â”€ core (æ ¸å¿ƒ) - åº”ç”¨çº§åç«¯æ ¸å¿ƒ
â”‚   â”œâ”€â”€ ä¸šåŠ¡é€»è¾‘å¤„ç†
â”‚   â”œâ”€â”€ æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â””â”€â”€ æœåŠ¡å±‚
â””â”€â”€ shell (å£³) - åº”ç”¨çº§å‰ç«¯ç•Œé¢
    â”œâ”€â”€ UI ç»„ä»¶åº“
    â”œâ”€â”€ ç”¨æˆ·äº¤äº’ç•Œé¢
    â””â”€â”€ é¡µé¢å¸ƒå±€
```

---

## ğŸ“¦ æ‹†åˆ†æ–¹æ¡ˆ

### riveredge-core â†’ riveredge-root + riveredge-core

#### riveredge-rootï¼ˆç³»ç»Ÿçº§åç«¯ï¼‰

**èŒè´£**ï¼šç³»ç»Ÿçº§åç«¯ APIã€åŸºç¡€è®¾æ–½

**åŒ…å«å†…å®¹**ï¼š
- `src/app/` - FastAPI åº”ç”¨é…ç½®ï¼ˆmain.py, config.py, middleware.pyï¼‰
- `src/api/` - API è·¯ç”±å±‚ï¼ˆç³»ç»Ÿçº§ APIï¼‰
- `src/core/` - æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼ˆdatabase.py, security.py, cache.py ç­‰ï¼‰
- `src/utils/logger.py` - æ—¥å¿—å·¥å…·
- `scripts/` - éƒ¨ç½²å’Œè¿ç»´è„šæœ¬
- `requirements.txt` - ä¾èµ–ç®¡ç†
- `pyproject.toml` - é¡¹ç›®é…ç½®

**ä¸åŒ…å«**ï¼š
- `src/models/` - æ•°æ®æ¨¡å‹ï¼ˆå±äºåº”ç”¨çº§ï¼‰
- `src/services/` - ä¸šåŠ¡æœåŠ¡ï¼ˆå±äºåº”ç”¨çº§ï¼‰
- `src/schemas/` - Schema å®šä¹‰ï¼ˆå±äºåº”ç”¨çº§ï¼‰
- `migrations/` - æ•°æ®åº“è¿ç§»ï¼ˆå±äºåº”ç”¨çº§ï¼‰

#### riveredge-coreï¼ˆåº”ç”¨çº§åç«¯ï¼‰

**èŒè´£**ï¼šåº”ç”¨çº§åç«¯æ ¸å¿ƒã€ä¸šåŠ¡é€»è¾‘

**åŒ…å«å†…å®¹**ï¼š
- `src/models/` - æ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆTortoise ORMï¼‰
- `src/services/` - ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚
- `src/schemas/` - Pydantic Schemaï¼ˆæ•°æ®éªŒè¯ï¼‰
- `migrations/` - Aerich æ•°æ®åº“è¿ç§»
- `tests/` - æµ‹è¯•æ–‡ä»¶

**ä¾èµ–å…³ç³»**ï¼š
- ä¾èµ– `riveredge-root` æä¾›çš„åŸºç¡€è®¾æ–½
- é€šè¿‡å¯¼å…¥ä½¿ç”¨ `riveredge-root` çš„æ¨¡å—

---

### riveredge-shell â†’ riveredge-stem + riveredge-shell

#### riveredge-stemï¼ˆç³»ç»Ÿçº§å‰ç«¯ï¼‰

**èŒè´£**ï¼šç³»ç»Ÿçº§å‰ç«¯æ¡†æ¶ã€åŸºç¡€è®¾æ–½

**åŒ…å«å†…å®¹**ï¼š
- `src/app.tsx` - åº”ç”¨å…¥å£
- `src/main.tsx` - ä¸»å…¥å£
- `src/layouts/` - ç³»ç»Ÿçº§å¸ƒå±€
- `src/models/` - çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰
- `src/access.ts` - æƒé™æ§åˆ¶
- `src/utils/` - å·¥å…·å‡½æ•°ï¼ˆç³»ç»Ÿçº§ï¼‰
- `vite.config.ts` - æ„å»ºé…ç½®
- `tsconfig.json` - TypeScript é…ç½®
- `package.json` - ä¾èµ–ç®¡ç†

**ä¸åŒ…å«**ï¼š
- `src/components/` - ä¸šåŠ¡ç»„ä»¶ï¼ˆå±äºåº”ç”¨çº§ï¼‰
- `src/pages/` - ä¸šåŠ¡é¡µé¢ï¼ˆå±äºåº”ç”¨çº§ï¼‰
- `src/services/` - ä¸šåŠ¡æœåŠ¡ï¼ˆå±äºåº”ç”¨çº§ï¼‰

#### riveredge-shellï¼ˆåº”ç”¨çº§å‰ç«¯ï¼‰

**èŒè´£**ï¼šåº”ç”¨çº§å‰ç«¯ç•Œé¢ã€ä¸šåŠ¡åŠŸèƒ½

**åŒ…å«å†…å®¹**ï¼š
- `src/components/` - UI ç»„ä»¶åº“ï¼ˆä¸šåŠ¡ç»„ä»¶ï¼‰
- `src/pages/` - ç”¨æˆ·äº¤äº’ç•Œé¢ï¼ˆä¸šåŠ¡é¡µé¢ï¼‰
- `src/services/` - ä¸šåŠ¡æœåŠ¡ï¼ˆAPI è°ƒç”¨ï¼‰
- `src/types/` - ä¸šåŠ¡ç±»å‹å®šä¹‰
- `src/locales/` - å›½é™…åŒ–èµ„æº

**ä¾èµ–å…³ç³»**ï¼š
- ä¾èµ– `riveredge-stem` æä¾›çš„åŸºç¡€æ¡†æ¶
- é€šè¿‡å¯¼å…¥ä½¿ç”¨ `riveredge-stem` çš„æ¨¡å—

---

## ğŸ“‹ æ‰§è¡Œæ­¥éª¤

### é˜¶æ®µä¸€ï¼šåˆ›å»ºæ–°æ–‡ä»¶å¤¹ç»“æ„

1. åˆ›å»º `riveredge-root/` ç›®å½•
2. åˆ›å»º `riveredge-core/` ç›®å½•ï¼ˆæ–°çš„åº”ç”¨çº§åç«¯ï¼‰
3. åˆ›å»º `riveredge-stem/` ç›®å½•
4. åˆ›å»º `riveredge-shell/` ç›®å½•ï¼ˆæ–°çš„åº”ç”¨çº§å‰ç«¯ï¼‰

### é˜¶æ®µäºŒï¼šè¿ç§» riveredge-core ä»£ç 

#### 2.1 è¿ç§»åˆ° riveredge-root

**æ–‡ä»¶åˆ—è¡¨**ï¼š
- `src/app/` â†’ `riveredge-root/src/app/`
- `src/api/` â†’ `riveredge-root/src/api/`
- `src/core/` â†’ `riveredge-root/src/core/`
- `src/utils/logger.py` â†’ `riveredge-root/src/utils/logger.py`
- `scripts/` â†’ `riveredge-root/scripts/`
- `requirements.txt` â†’ `riveredge-root/requirements.txt`
- `pyproject.toml` â†’ `riveredge-root/pyproject.toml`
- `README.md` â†’ `riveredge-root/README.md`
- `start-backend.sh` â†’ `riveredge-root/start-backend.sh`

#### 2.2 è¿ç§»åˆ° riveredge-coreï¼ˆæ–°ï¼‰

**æ–‡ä»¶åˆ—è¡¨**ï¼š
- `src/models/` â†’ `riveredge-core/src/models/`
- `src/services/` â†’ `riveredge-core/src/services/`
- `src/schemas/` â†’ `riveredge-core/src/schemas/`
- `migrations/` â†’ `riveredge-core/migrations/`
- `tests/` â†’ `riveredge-core/tests/`

**éœ€è¦åˆ›å»º**ï¼š
- `riveredge-core/pyproject.toml` - é¡¹ç›®é…ç½®
- `riveredge-core/requirements.txt` - ä¾èµ–ç®¡ç†ï¼ˆä¾èµ– riveredge-rootï¼‰
- `riveredge-core/README.md` - é¡¹ç›®è¯´æ˜

### é˜¶æ®µä¸‰ï¼šè¿ç§» riveredge-shell ä»£ç 

#### 3.1 è¿ç§»åˆ° riveredge-stem

**æ–‡ä»¶åˆ—è¡¨**ï¼š
- `src/app.tsx` â†’ `riveredge-stem/src/app.tsx`
- `src/main.tsx` â†’ `riveredge-stem/src/main.tsx`
- `src/layouts/` â†’ `riveredge-stem/src/layouts/`
- `src/models/` â†’ `riveredge-stem/src/models/`
- `src/access.ts` â†’ `riveredge-stem/src/access.ts`
- `src/utils/` â†’ `riveredge-stem/src/utils/`
- `vite.config.ts` â†’ `riveredge-stem/vite.config.ts`
- `tsconfig.json` â†’ `riveredge-stem/tsconfig.json`
- `tsconfig.node.json` â†’ `riveredge-stem/tsconfig.node.json`
- `package.json` â†’ `riveredge-stem/package.json`
- `index.html` â†’ `riveredge-stem/index.html`
- `README.md` â†’ `riveredge-stem/README.md`

#### 3.2 è¿ç§»åˆ° riveredge-shellï¼ˆæ–°ï¼‰

**æ–‡ä»¶åˆ—è¡¨**ï¼š
- `src/components/` â†’ `riveredge-shell/src/components/`
- `src/pages/` â†’ `riveredge-shell/src/pages/`
- `src/services/` â†’ `riveredge-shell/src/services/`
- `src/types/` â†’ `riveredge-shell/src/types/`
- `src/locales/` â†’ `riveredge-shell/src/locales/`
- `src/global.less` â†’ `riveredge-shell/src/global.less`
- `public/` â†’ `riveredge-shell/public/`

**éœ€è¦åˆ›å»º**ï¼š
- `riveredge-shell/package.json` - ä¾èµ–ç®¡ç†ï¼ˆä¾èµ– riveredge-stemï¼‰
- `riveredge-shell/README.md` - é¡¹ç›®è¯´æ˜
- `riveredge-shell/vite.config.ts` - æ„å»ºé…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ğŸ”§ ä¾èµ–å…³ç³»å¤„ç†

### åç«¯ä¾èµ–å…³ç³»

**riveredge-coreï¼ˆæ–°ï¼‰ä¾èµ– riveredge-root**ï¼š
- å¯¼å…¥ `riveredge-root` çš„æ¨¡å—
- ä½¿ç”¨ `riveredge-root` æä¾›çš„åŸºç¡€è®¾æ–½
- é€šè¿‡ç›¸å¯¹å¯¼å…¥æˆ–åŒ…å¯¼å…¥è®¿é—®

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨ Python åŒ…ç®¡ç†ï¼ˆæ¨èï¼‰
   - å°† `riveredge-root` å®‰è£…ä¸ºå¯ç¼–è¾‘åŒ…
   - åœ¨ `riveredge-core` çš„ `requirements.txt` ä¸­æ·»åŠ ï¼š`-e ../riveredge-root`
2. ä½¿ç”¨ç›¸å¯¹å¯¼å…¥ï¼ˆå¼€å‘æ—¶ï¼‰
   - åœ¨ `PYTHONPATH` ä¸­æ·»åŠ  `riveredge-root/src`
   - ä½¿ç”¨ç»å¯¹å¯¼å…¥ï¼š`from root.app.config import settings`

### å‰ç«¯ä¾èµ–å…³ç³»

**riveredge-shellï¼ˆæ–°ï¼‰ä¾èµ– riveredge-stem**ï¼š
- å¯¼å…¥ `riveredge-stem` çš„æ¨¡å—
- ä½¿ç”¨ `riveredge-stem` æä¾›çš„åŸºç¡€æ¡†æ¶
- é€šè¿‡ npm åŒ…æˆ– monorepo ç®¡ç†

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨ npm workspaceï¼ˆæ¨èï¼‰
   - åœ¨æ ¹ç›®å½•åˆ›å»º `package.json`ï¼Œé…ç½® workspaces
   - ä½¿ç”¨ `npm install` å®‰è£…æ‰€æœ‰ä¾èµ–
2. ä½¿ç”¨ç›¸å¯¹å¯¼å…¥ï¼ˆå¼€å‘æ—¶ï¼‰
   - åœ¨ `tsconfig.json` ä¸­é…ç½®è·¯å¾„åˆ«å
   - ä½¿ç”¨è·¯å¾„åˆ«åå¯¼å…¥ï¼š`import { ... } from '@stem/...'`

---

## âš ï¸ é£é™©è¯„ä¼°

### é«˜é£é™©é¡¹

1. **ä»£ç è¿ç§»**ï¼š
   - âš ï¸ éœ€è¦å¤§é‡æ–‡ä»¶ç§»åŠ¨
   - âš ï¸ éœ€è¦æ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„
   - âš ï¸ å¯èƒ½é—æ¼æŸäº›å¼•ç”¨

2. **ä¾èµ–å…³ç³»**ï¼š
   - âš ï¸ éœ€è¦å¤„ç†æ¨¡å—é—´çš„ä¾èµ–
   - âš ï¸ éœ€è¦æ›´æ–°æ„å»ºé…ç½®
   - âš ï¸ å¯èƒ½å½±å“ CI/CD

3. **æµ‹è¯•éªŒè¯**ï¼š
   - âš ï¸ éœ€è¦å…¨é¢æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
   - âš ï¸ éœ€è¦éªŒè¯ä¾èµ–å…³ç³»
   - âš ï¸ éœ€è¦æ›´æ–°æµ‹è¯•é…ç½®

---

## ğŸ“Š å·¥ä½œé‡ä¼°ç®—

| é˜¶æ®µ | å·¥ä½œé‡ | æ—¶é—´ä¼°ç®— | é£é™© |
|------|--------|---------|------|
| **é˜¶æ®µä¸€ï¼šåˆ›å»ºæ–°ç»“æ„** | â­â­ | 0.5 å¤© | ä½ |
| **é˜¶æ®µäºŒï¼šè¿ç§»åç«¯ä»£ç ** | â­â­â­â­ | 2-3 å¤© | é«˜ |
| **é˜¶æ®µä¸‰ï¼šè¿ç§»å‰ç«¯ä»£ç ** | â­â­â­â­ | 2-3 å¤© | é«˜ |
| **é˜¶æ®µå››ï¼šæ›´æ–°ä¾èµ–å…³ç³»** | â­â­â­ | 1-2 å¤© | ä¸­ |
| **é˜¶æ®µäº”ï¼šæµ‹è¯•éªŒè¯** | â­â­â­ | 1-2 å¤© | ä¸­ |
| **æ€»è®¡** | **â­â­â­â­â­** | **6-10 å¤©** | **é«˜** |

---

## ğŸ¯ æ¨èæ‰§è¡Œæ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šåˆ†é˜¶æ®µæ‰§è¡Œï¼ˆæ¨èï¼‰âœ…

**é˜¶æ®µ 1**ï¼šå…ˆæ‹†åˆ†åç«¯ï¼ˆ2-3 å¤©ï¼‰
- åˆ›å»º `riveredge-root` å’Œ `riveredge-core`
- è¿ç§»ä»£ç 
- æ›´æ–°ä¾èµ–å…³ç³»
- æµ‹è¯•éªŒè¯

**é˜¶æ®µ 2**ï¼šå†æ‹†åˆ†å‰ç«¯ï¼ˆ2-3 å¤©ï¼‰
- åˆ›å»º `riveredge-stem` å’Œ `riveredge-shell`
- è¿ç§»ä»£ç 
- æ›´æ–°ä¾èµ–å…³ç³»
- æµ‹è¯•éªŒè¯

**ä¼˜åŠ¿**ï¼š
- âœ… åˆ†é˜¶æ®µæ‰§è¡Œï¼Œé£é™©å¯æ§
- âœ… æ¯ä¸ªé˜¶æ®µå¯ä»¥ç‹¬ç«‹æµ‹è¯•
- âœ… å¯ä»¥éšæ—¶å›æ»š

---

## ğŸ“ æ‰§è¡Œæ£€æŸ¥æ¸…å•

### åç«¯æ‹†åˆ†æ£€æŸ¥

- [ ] åˆ›å»º `riveredge-root/` ç›®å½•ç»“æ„
- [ ] åˆ›å»º `riveredge-core/` ç›®å½•ç»“æ„
- [ ] è¿ç§»ç³»ç»Ÿçº§ä»£ç åˆ° `riveredge-root/`
- [ ] è¿ç§»åº”ç”¨çº§ä»£ç åˆ° `riveredge-core/`
- [ ] æ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„
- [ ] æ›´æ–° `requirements.txt` å’Œ `pyproject.toml`
- [ ] æ›´æ–°æ„å»ºå’Œéƒ¨ç½²è„šæœ¬
- [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- [ ] æ›´æ–°æ–‡æ¡£

### å‰ç«¯æ‹†åˆ†æ£€æŸ¥

- [ ] åˆ›å»º `riveredge-stem/` ç›®å½•ç»“æ„
- [ ] åˆ›å»º `riveredge-shell/` ç›®å½•ç»“æ„
- [ ] è¿ç§»ç³»ç»Ÿçº§ä»£ç åˆ° `riveredge-stem/`
- [ ] è¿ç§»åº”ç”¨çº§ä»£ç åˆ° `riveredge-shell/`
- [ ] æ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„
- [ ] æ›´æ–° `package.json` å’Œæ„å»ºé…ç½®
- [ ] é…ç½® npm workspace æˆ–è·¯å¾„åˆ«å
- [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
- [ ] æ›´æ–°æ–‡æ¡£

---

## ğŸš€ å¼€å§‹æ‰§è¡Œ

**å‡†å¤‡å°±ç»ªåï¼Œå¯ä»¥å¼€å§‹æ‰§è¡Œæ–‡ä»¶å¤¹é‡ç»„å·¥ä½œã€‚**

**å»ºè®®**ï¼š
1. å…ˆå®Œæˆé˜¶æ®µä¸€ï¼ˆåˆ›å»ºæ–°ç»“æ„ï¼‰
2. åˆ›å»ºè¯¦ç»†çš„æ–‡ä»¶è¿ç§»æ¸…å•
3. åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
4. å†åœ¨ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œ

---

**æœ€åæ›´æ–°**ï¼š2025-11-27

